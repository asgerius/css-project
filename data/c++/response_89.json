[{"tags": ["c++", "linux", "g++", "dynamic-linking"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1474501011, "post_id": 39628032, "comment_id": 66561573, "body": "Briefly, no. But, when you linked <code>libbar.so</code>, it could have been provided the <code>-lfoo</code> on the link line. Then, the linker would have pulled in <code>libfoo.so</code> for you when you only put <code>-lbar</code>."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1474501194, "post_id": 39628032, "comment_id": 66561613, "body": "Not with direct linkage, like that. Use <code>dlopen()</code> with the <code>RTLD_LAZY</code> flag, and <code>dlsym()</code>. This won&#39;t directly work with <code>C++</code> code, it will be necessary to trampoline your way via <code>C</code>-linkage functions, which is why I&#39;m not giving this as an offishul answer. But it is theoretically doable."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1474501220, "post_id": 39628032, "comment_id": 66561617, "body": "Something&#39;s calling those <code>Foo</code> functions somewhere"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1474501285, "post_id": 39628032, "comment_id": 66561636, "body": "Yes, but that &quot;something&quot; will not get executed, so with lazy-loading you can get away with it."}, {"owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "edited": false, "score": 0, "creation_date": 1474502266, "post_id": 39628032, "comment_id": 66561839, "body": "you didn&#39;t provide implementation for classes foo and bar, include string in bar1.hpp"}, {"owner": {"reputation": 147, "user_id": 6142668, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fd520d8dd458faa59a81455d72539845?s=128&d=identicon&r=PG&f=1", "display_name": "T Lytle", "link": "https://stackoverflow.com/users/6142668/t-lytle"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1474570310, "post_id": 39628032, "comment_id": 66596774, "body": "@jxh I believe this is what I want. I want my end user to not have to specify all of the other libraries."}], "answers": [{"tags": [], "owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "is_accepted": false, "score": 0, "last_activity_date": 1474503117, "creation_date": 1474503117, "answer_id": 39628326, "question_id": 39628032, "link": "https://stackoverflow.com/questions/39628032/c-linking-issue/39628326#39628326", "title": "C++ Linking Issue", "body": "<p>where is foo.cpp and bar.cpp? you didn't implement classes foo and bar:</p>\n\n<pre><code>// foo.cpp\n#include \"Foo.hpp\"\n\nFoo::Foo(int X, int Y) : x(X), y(Y){}\nint Foo::add()const{return x + y;}\n\n\n// Bar1.cpp\n\n#include \"bar1.hpp\"\n\nBar1::Bar1(const std::string&amp; STR) : str(STR){}\nconst std::string&amp; Bar1::getString() const{return str;}\n\n\n// Bar2.cpp\n\n#include \"foo.hpp\"\n\nBar2::Bar2(int X, int Y) : x(X), y(Y) {z = x + y;}  \nint Bar2::getInt() const{ return z;}\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 6142668, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fd520d8dd458faa59a81455d72539845?s=128&d=identicon&r=PG&f=1", "display_name": "T Lytle", "link": "https://stackoverflow.com/users/6142668/t-lytle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474571181, "creation_date": 1474500633, "last_edit_date": 1474571181, "question_id": 39628032, "link": "https://stackoverflow.com/questions/39628032/c-linking-issue", "title": "C++ Linking Issue", "body": "<p>Let's say I have a shared library called libfoo.so that also depends on another shared library called libbar.so. In libfoo.so, the only capability it provides is a class that stores two integers and can return the value of those two integers added together.</p>\n\n<p>libfoo.so:</p>\n\n<pre><code>// Foo.hpp\n\nclass Foo\n{\n  int x, y;\npublic:\n  Foo(int x, int y);\n  int add() const;\n};\n</code></pre>\n\n<p>Now, in libbar.so, there are two classes: a Bar1 class that simply stores a string and a Bar2 class that stores an integer that is calculated by creating a Foo object and using the add() function to generate a new integer.</p>\n\n<pre><code>// Bar1.hpp\n\nclass Bar1\n{\n  std::string str;\npublic:\n  Bar1(const std::string&amp; str);\n  const std::string&amp; getString() const;\n};\n\n\n// Bar2.hpp\n\n#include \"foo.hpp\"\n\nclass Bar2\n{\n  int z;\npublic:\n  Bar2(int x, int y);\n  int getInt() const;\n};\n</code></pre>\n\n<p>Now, I want to write a program that uses Bar1. I do not care about Bar2. My very simple program looks like this:</p>\n\n<pre><code>// Test.cpp\n\n#include &lt;iostream&gt;\n\n#include \"Bar1.hpp\"\n\nusing namespace std;\n\nint main()\n{\n  Bar1 bar1(\"Hello\");\n  cout &lt;&lt; bar1.getString() &lt;&lt; endl;\n}\n</code></pre>\n\n<p>I compile this program like so:</p>\n\n<pre><code>g++ -c test.cpp -o test.o\ng++ -o test test.o -lbar\n</code></pre>\n\n<p>The error that is generated is:</p>\n\n<pre><code>undefined reference to 'Foo::Foo(int, int)' \nundefined reference to 'Foo::add() const' \n</code></pre>\n\n<p>This can be fixed by specifying '-lfoo' to the linker. However, I am now linking in a library that my binary will never use. </p>\n\n<p>Is there a way to clean this up where the compiler understands that my binary does not care about resolving these symbols since I never use Bar2 anywhere in my program? </p>\n\n<p>EDIT:</p>\n\n<p>Adding the implementations of the classes. I didn't think that it mattered. Here they are:</p>\n\n<pre><code>// Foo.cpp\n\n#include \"Foo.hpp\"\n\nFoo::Foo(int new_x, int new_y)\n{\n  x = new_x;\n  y = new_y;\n}\n\nint Foo::add() const\n{\n  return x + y;\n}\n</code></pre>\n\n<p>And here is Bar1.cpp:</p>\n\n<pre><code>// Bar1.cpp\n\n#include \"Bar1.hpp\"\n\nBar1::Bar1(const std::string&amp; the_str)\n{\n  str = the_str;\n}\n\nconst std::string&amp; Bar1::getString() const\n{\n  return str;\n}\n</code></pre>\n\n<p>And here is Bar2.cpp:</p>\n\n<pre><code>// Bar2.cpp\n\n#include \"Bar2.hpp\"\n\nBar2::Bar2(int x, int y)\n{\n  Foo foo(x, y);\n  z = foo.add();\n}\n\nint Bar2::getInt() const\n{\n  return z;\n}\n</code></pre>\n\n<p>Note that it should be obvious that I am writing these classes like this purely for experimentation purposes. I am playing around with the linker and how a developer would link to libraries and use them. </p>\n"}, {"tags": ["c++", "templates", "macros"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 3, "creation_date": 1474500278, "post_id": 39627942, "comment_id": 66561409, "body": "C++ is not a swiss army knife. It can&#39;t do everything. If this is truly what you want (and I kind of see why you&#39;d want it), and all the values of switch statements have some logical pattern to them, then use the right tool for the right job: write a simple Perl script, or using a scripting language of your choice to robo-generate all of your spaghetti code, and integrate it into your build system. If that&#39;s good enough for <code>lex&#47;flex</code> and <code>yacc&#47;bison</code>, it&#39;s good enough here."}, {"owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "edited": false, "score": 0, "creation_date": 1474500400, "post_id": 39627942, "comment_id": 66561429, "body": "use concatenation operator"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1474500520, "post_id": 39627942, "comment_id": 66561452, "body": "Lookup tables.  Design a structure that contains the key and a pointer to a function that processes the key.  Place into a map or vector.  Search for the key then if the key is found, execute the <i>associated</i> function by dereferencing the function pointer."}, {"owner": {"reputation": 63, "user_id": 3223013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53bb71f8da1f6feac2c6d7b73a14d9f?s=128&d=identicon&r=PG&f=1", "display_name": "pemcode", "link": "https://stackoverflow.com/users/3223013/pemcode"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474529817, "post_id": 39627942, "comment_id": 66570522, "body": "@Thomas Matthews This is exactly what my OP means by the following comment...  I also tried to do it by replacing the switch() statements with arrays of function pointers (to the printf()&#39;s)... But then I still had the copy-paste code problem when filling the arrays...  Instead of TestSwitch01() TestSwitch02() etc, I end up needing FillArray01() FillArray02() etc"}, {"owner": {"reputation": 63, "user_id": 3223013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53bb71f8da1f6feac2c6d7b73a14d9f?s=128&d=identicon&r=PG&f=1", "display_name": "pemcode", "link": "https://stackoverflow.com/users/3223013/pemcode"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1474530878, "post_id": 39627942, "comment_id": 66571192, "body": "@Sam Varshavchik that&#39;s actually my best idea so far and it&#39;s what I&#39;m currently doing for the old version of my code...  However, I&#39;m still wondering if there&#39;s some way to do it in actual C++ code (rather than generating C++ code with Perl or Python).  I thought there might be some trick like #include foo001.h, then forward declare template void TestSwitch&lt;1&gt;(), then #include foo2.h then forward declare template void TestSwitch&lt;2&gt;() though I couldnt get that to compile..."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 3223013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53bb71f8da1f6feac2c6d7b73a14d9f?s=128&d=identicon&r=PG&f=1", "display_name": "pemcode", "link": "https://stackoverflow.com/users/3223013/pemcode"}, "edited": false, "score": 0, "creation_date": 1474529488, "post_id": 39628143, "comment_id": 66570298, "body": "That&#39;s exactly what my OP means by &quot;macro pseudo-function&quot;...  I want to avoid writing a macro pseudo-function because you can&#39;t step into that (with a debugger), plus it&#39;s hard to read (also syntax highlighting and intellisense won&#39;t work).  The \\&#39;s at the end of each line are weird syntax but more importantly Visual Studio (and I assume gdb) lack support for debugging these or doing proper intellisense and syntax highlighting I guess because macros are preprocessor string-replace rather than &quot;real&quot; C++ code."}, {"owner": {"reputation": 3864, "user_id": 620908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2abd643ecb33f1a18a7a4f976cef0dbe?s=128&d=identicon&r=PG", "display_name": "Adrian Colomitchi", "link": "https://stackoverflow.com/users/620908/adrian-colomitchi"}, "reply_to_user": {"reputation": 63, "user_id": 3223013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53bb71f8da1f6feac2c6d7b73a14d9f?s=128&d=identicon&r=PG&f=1", "display_name": "pemcode", "link": "https://stackoverflow.com/users/3223013/pemcode"}, "edited": false, "score": 0, "creation_date": 1474530483, "post_id": 39628143, "comment_id": 66570922, "body": "@pemcode &quot;more importantly Visual Studio (and I assume gdb) lack support for debugging these&quot;. You know, utilities generating code that compiles afterwars aren&#39;t so an outlandish idea. So, I suppose that you can write a C++ utility which read those &quot;#define VAL_A&quot; headers and then dumps them packed as a function definition in a file called &quot;my_func_X.cpp&quot;."}], "tags": [], "owner": {"reputation": 3864, "user_id": 620908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2abd643ecb33f1a18a7a4f976cef0dbe?s=128&d=identicon&r=PG", "display_name": "Adrian Colomitchi", "link": "https://stackoverflow.com/users/620908/adrian-colomitchi"}, "is_accepted": false, "score": 0, "last_activity_date": 1474501622, "creation_date": 1474501622, "answer_id": 39628143, "question_id": 39627942, "link": "https://stackoverflow.com/questions/39627942/c-function-switch-statement-or-array-abstract-over-macro-values/39628143#39628143", "title": "C++ function switch statement or array abstract over macro values", "body": "<p><a href=\"http://www.drdobbs.com/the-new-c-x-macros/184401387\" rel=\"nofollow\">XMacros</a> - they were trending... let me see... yeap, 2001.</p>\n\n<p>On the line of:</p>\n\n<p>\"generate_testswitch.h\"</p>\n\n<pre><code>#define IMPLEMENT_TEST_SWITCH(N) void TestSwitch#N(uint32 val) \\\n{ \\\n    printf(\"%u: \", op); \\\n    switch (val) \\\n    { \\\n    case VAL_A: printf(\"aaa\\n\"); break; \\\n    case VAL_B: printf(\"bbb\\n\"); break; \\\n    case VAL_C: printf(\"ccc\\n\"); break; \\\n    default: printf(\"ddd\\n\"); \\\n    } \\\n}\n</code></pre>\n\n<p>\"testswitch1.c\"</p>\n\n<pre><code>// you may isolate these in yet another header\n#define VAL_A 0\n#define VAL_B 1\n#define VAL_C 2\n\n#include \"generate_testswitch.h\"\n\nIMPLEMENT_TEST_SWITCH(01)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 3223013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53bb71f8da1f6feac2c6d7b73a14d9f?s=128&d=identicon&r=PG&f=1", "display_name": "pemcode", "link": "https://stackoverflow.com/users/3223013/pemcode"}, "edited": false, "score": 0, "creation_date": 1474860595, "post_id": 39628212, "comment_id": 66687553, "body": "This is my favorite answer so far.  I&#39;d probably write a python script to convert my #define header files to enum&#39;s"}], "tags": [], "owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "is_accepted": true, "score": 2, "last_activity_date": 1474502306, "creation_date": 1474502306, "answer_id": 39628212, "question_id": 39627942, "link": "https://stackoverflow.com/questions/39627942/c-function-switch-statement-or-array-abstract-over-macro-values/39628212#39628212", "title": "C++ function switch statement or array abstract over macro values", "body": "<p>A properly C++ solution for this would be to do away with the <code>#define</code>s and use enums within structs:</p>\n\n<pre><code>struct Foo {\n    enum { VAL_A = 0, VAL_B = 1, VAL_C = 2 };\n};\n\nstruct Bar {\n    enum { VAL_A = 10, VAL_B = 11, VAL_C = 12 };\n};\n\ntemplate&lt;typename T&gt;\nvoid TestSwitch(int op)\n{\n    std::cout &lt;&lt; op &lt;&lt; \": \";\n    switch (op) {\n        case T::VAL_A: std::cout &lt;&lt; \"aaa\\n\"; break;\n        case T::VAL_B: std::cout &lt;&lt; \"bbb\\n\"; break;\n        case T::VAL_C: std::cout &lt;&lt; \"ccc\\n\"; break;\n        default: break;\n    }\n}\n</code></pre>\n\n<p>Demo: <a href=\"http://ideone.com/u3kTtF\" rel=\"nofollow\">http://ideone.com/u3kTtF</a></p>\n\n<p>You could also replace the <code>struct</code> with just an <code>enum class</code> but then you can only have values, the struct option gives you the chance to include other values that describe things about <code>T</code> that might later be useful.</p>\n\n<p>enum class Demo: <a href=\"http://ideone.com/DBZuyn\" rel=\"nofollow\">http://ideone.com/DBZuyn</a></p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 3223013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53bb71f8da1f6feac2c6d7b73a14d9f?s=128&d=identicon&r=PG&f=1", "display_name": "pemcode", "link": "https://stackoverflow.com/users/3223013/pemcode"}, "edited": false, "score": 0, "creation_date": 1474529377, "post_id": 39631549, "comment_id": 66570229, "body": "there are 5000 of the values, so even with variadic templates, it would be pretty insane calling  TestSwitch&lt;int, 10, 11, 12, ...&gt;(42) where the ... is (5000-3 = 4997) integers typed out - it&#39;s very long and cumbersome.  In my real example there&#39;s 20x20 = 400 versions of TestSwitch(), so I&#39;d have 400 of these template calls with 5000 template parameters to each one.  At that point I might as well just do the copy-paste method which I was hoping to avoid."}, {"owner": {"reputation": 63, "user_id": 3223013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53bb71f8da1f6feac2c6d7b73a14d9f?s=128&d=identicon&r=PG&f=1", "display_name": "pemcode", "link": "https://stackoverflow.com/users/3223013/pemcode"}, "edited": false, "score": 0, "creation_date": 1474529383, "post_id": 39631549, "comment_id": 66570235, "body": "I&#39;m hoping there&#39;s a way that I can #include my two #define macro files that define different versions of 5000 #define VAL_*&#39;s...  And use this to generate two separate TestSwitch() functions.  Otherwise I have to copy-paste TestSwitch() as TestSwitch001() using #include foo001.h&#39;s #defines, and then and TestSwitch002() which is an exact copy-paste of TestSwitch001() code except that it&#39;s in a different file that #include&#39;s foo002.h."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 63, "user_id": 3223013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53bb71f8da1f6feac2c6d7b73a14d9f?s=128&d=identicon&r=PG&f=1", "display_name": "pemcode", "link": "https://stackoverflow.com/users/3223013/pemcode"}, "edited": false, "score": 0, "creation_date": 1474530355, "post_id": 39631549, "comment_id": 66570841, "body": "@pemcode Added more details to the answer. You don&#39;t have to explicitly define all the 5000 values if they represent a range. Let me know if it works fine for you."}, {"owner": {"reputation": 63, "user_id": 3223013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53bb71f8da1f6feac2c6d7b73a14d9f?s=128&d=identicon&r=PG&f=1", "display_name": "pemcode", "link": "https://stackoverflow.com/users/3223013/pemcode"}, "edited": false, "score": 0, "creation_date": 1474531676, "post_id": 39631549, "comment_id": 66571663, "body": "The simplified example in my OP uses a range, but the values in my actual header files (which come from a third party) do not include a range."}], "tags": [], "owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "is_accepted": false, "score": 0, "last_activity_date": 1474530223, "last_edit_date": 1474530223, "creation_date": 1474524884, "answer_id": 39631549, "question_id": 39627942, "link": "https://stackoverflow.com/questions/39627942/c-function-switch-statement-or-array-abstract-over-macro-values/39631549#39631549", "title": "C++ function switch statement or array abstract over macro values", "body": "<blockquote>\n  <p>I considered using a template function, but with 5000 <code>VAL_*</code> macros, it would be pretty insane... <code>template void &lt;uint32 VAL_A, uint32 VAL_B ... VAL_4999&gt; TestSwitch(...)</code>.</p>\n</blockquote>\n\n<p>For you tagged the question as <code>c++</code>, I assume the latest revision of the standard can be used (or at least C++11).<br>\nBecause of that, no, it wouldn't be pretty insane to use a template.<br>\nYou can do something like this with variadic templates:</p>\n\n<pre><code>template&lt;typename T, T... V&gt;\nvoid TestSwitch(uint32_t val) {\n    // ...\n}\n</code></pre>\n\n<p>Thus you can invoke it as:</p>\n\n<pre><code>TestSwitch&lt;int, 10, 11, 12&gt;(42);\n</code></pre>\n\n<p>I've not clear what you want to do with those values, so it's hard to say how the body of the function must be written.<br>\nAs a toy example, it follows an implementation that checks if <code>val</code> is contained in <code>V...</code>:</p>\n\n<pre><code>template&lt;typename T, T... V&gt;\nvoid TestSwitch(uint32_t val) {\n    bool found = false;\n    int arr[] = { 0, (found = found || (val == V), 0 )... };\n    (void)arr;\n    std::cout &lt;&lt; \"found: \" &lt;&lt; found &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Other problems could require a recursion with an empty case and so on.</p>\n\n<hr>\n\n<p>As long as you deal with ranges, you can also do something like this:</p>\n\n<pre><code>#include &lt;cstddef&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;std::size_t B, std::size_t... I&gt;\nvoid TestSwitch(uint32_t val, std::index_sequence&lt;I...&gt;) {\n    bool found = false;\n    int arr[] = { 0, (found = found || (val == (B+I)), 0 )... };\n    (void)arr;\n    std::cout &lt;&lt; \"found: \" &lt;&lt; found &lt;&lt; std::endl;\n}\n\ntemplate&lt;std::size_t B, std::size_t N&gt;\nvoid TestSwitch(uint32_t val) {\n    TestSwitch&lt;B&gt;(val, std::make_index_sequence&lt;N&gt;{});\n}\n\nint main() {\n    TestSwitch&lt;40, 3&gt;(42);\n    TestSwitch&lt;40, 3&gt;(0);\n}\n</code></pre>\n\n<p>In this case, we invoke <code>TestSwitch</code> using the <em>base</em> (that is, the start value) and the length of the range, then we rely on <code>std::make_index_sequence</code> and one more function to generate the range itself and do the work.</p>\n"}], "owner": {"reputation": 63, "user_id": 3223013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53bb71f8da1f6feac2c6d7b73a14d9f?s=128&d=identicon&r=PG&f=1", "display_name": "pemcode", "link": "https://stackoverflow.com/users/3223013/pemcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 39628212, "answer_count": 3, "score": 1, "last_activity_date": 1474530223, "creation_date": 1474500036, "last_edit_date": 1474524246, "question_id": 39627942, "link": "https://stackoverflow.com/questions/39627942/c-function-switch-statement-or-array-abstract-over-macro-values", "title": "C++ function switch statement or array abstract over macro values", "body": "<p>Consider the following code:</p>\n\n<pre><code>#define VAL_A 0\n#define VAL_B 1\n#define VAL_C 2\n\nvoid TestSwitch01(uint32 val)\n{\n    printf(\"%u: \", op);\n    switch (val)\n    {\n    case VAL_A: printf(\"aaa\\n\"); break;\n    case VAL_B: printf(\"bbb\\n\"); break;\n    case VAL_C: printf(\"ccc\\n\"); break;\n    default: printf(\"ddd\\n\");\n    }\n}\n\n#define VAL_A 10\n#define VAL_B 11\n#define VAL_C 12\n\nvoid TestSwitch02(uint32 op)\n{\n    printf(\"%u: \", op);\n    switch (val)\n    {\n    case VAL_A: printf(\"aaa\\n\"); break;\n    case VAL_B: printf(\"bbb\\n\"); break;\n    case VAL_C: printf(\"ccc\\n\"); break;\n    default: printf(\"ddd\\n\");\n    }\n}\n</code></pre>\n\n<p>In this example, I have three <code>VAL_*</code> macros and two <code>TestSwitch*()</code> functions.  However, suppose I have this pattern but with 5000 <code>VAL_*</code> macros and 20 <code>TestSwitch*()</code> functions (in other words - 20 different versions of <code>VAL_A</code> - 0, 10, etc).  Also, I have the <code>#define</code>'s in separate files...  So <code>foo001.h</code> has the (0 1 2) <code>VAL</code>'s and <code>foo002.h</code> has the (10 11 12) <code>VAL</code>'s.</p>\n\n<p>I don't want to copy-paste 20 versions of the function because it's the same function.  So really I want to write a function that abstracts over the macro.</p>\n\n<p>Obviously I could use variables, but I don't want to do that because the variables would be set at run-time and that would be slow.  I want write C++ code that will get the compiler to generate 20 versions of <code>TestSwitch*()</code> each corresponding to one of the 20 different sets of 5000 <code>VAL*</code> macros.</p>\n\n<p>I want to avoid writing a macro pseudo-function because you can't step into that, plus it's hard to read (also syntax highlighting and intellisense won't work).</p>\n\n<p>I considered using a template function, but with 5000 <code>VAL_*</code> macros, it would be pretty insane...  <code>template void &lt;uint32 VAL_A, uint32 VAL_B ... VAL_4999&gt; TestSwitch(...)</code>.</p>\n\n<p>I also tried to do it by replacing the <code>switch()</code> statements with arrays of function pointers (to the <code>printf()</code>'s)...  But then I still had the copy-paste code problem when filling the arrays.</p>\n\n<p>I feel like C++ has the tools to do what I'm trying to do, but I'm not sure how...  Any ideas?</p>\n\n<p>Basically I want to generate 20 copies of function <code>TestSwitchXX()</code> - one for each set of 5000 <code>VAL_*</code>'s.</p>\n\n<p>Maybe there's some trick using multiple files and <code>#include</code>'s and <code>#if</code>'s?</p>\n"}, {"tags": ["c++", "opengl", "qt5", "opengl-extensions", "qopenglfunctions"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 3, "creation_date": 1474502091, "post_id": 39627811, "comment_id": 66561804, "body": "FYI: Don&#39;t ever use <code>glGenBuffersARB</code>. <code>glGenBuffers</code> has been core OpenGL for nearly <i>fifteen years</i>."}, {"owner": {"reputation": 7471, "user_id": 1035897, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3eccb41827ff628fa4143045e40c1b8c?s=128&d=identicon&r=PG", "display_name": "Lennart Rolland", "link": "https://stackoverflow.com/users/1035897/lennart-rolland"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1474502375, "post_id": 39627811, "comment_id": 66561855, "body": "I just realized that, sorry it was a really bad example, but I think the question is still good. Just imagine I was talking about another extension that is relevant today! (that is the extension that my existing OpenGL code uses)."}], "answers": [{"comments": [{"owner": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "edited": false, "score": 1, "creation_date": 1474727570, "post_id": 39628255, "comment_id": 66655148, "body": "It&#39;s technically incorrect to say that wrappers <code>QOpenGLBuffer</code> is a lowest-common-denominator. While not supporting <i>all</i> the possible buffer object features, it actually checks for extensions, so for instance it supports ranged maps. (Then, it also has other fundamental problems). QOpenGLTexture supports immutable storage, texture views and similar."}, {"owner": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "edited": false, "score": 0, "creation_date": 1474727909, "post_id": 39628255, "comment_id": 66655250, "body": "About extensions, there&#39;s actually the QtOpenGLExtensions library (<code>QT += openglextensions</code>), that you can use just like <code>QOpenGLFunctions</code>. Like <code>auto f = new QOpenGLExtension_KHR_debug; f-&gt;initializeOpenGLFunctions(); f-&gt;glDebugMessage...</code>. I&#39;ve no idea why it&#39;s not documented, likely a bug (since it&#39;s autogenerated)."}], "tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 3, "last_activity_date": 1474502640, "creation_date": 1474502640, "answer_id": 39628255, "question_id": 39627811, "link": "https://stackoverflow.com/questions/39627811/how-to-use-extension-like-glgenbuffersarb-in-qt5/39628255#39628255", "title": "How to use extension like glGenBuffersARB in Qt5?", "body": "<blockquote>\n  <p>But then I would have to prefix every single line of existing OpenGL code with <code>functions-&gt;</code> which I would rather not do.</p>\n</blockquote>\n\n<p>You could of course use <code>QOpenGLContext::getProcAddress</code> to load the function pointers yourself. But the only interface that Qt provides that handles function loading for you is the <code>QOpenGLFunctions_*</code> one. Not only that, they don't really cover extensions.</p>\n\n<p>You could use Qt's OpenGL wrapper classes like <code>QOpenGLBuffer</code> and so forth. But those are a lowest-common-denominator sort of thing. They don't wrap everything you could do with buffers using modern OpenGL. And again, they don't cover <em>extensions</em>; only stuff that's core functionality.</p>\n\n<p>And there's plenty of OpenGL not wrapped by such objects, so it's not exactly a comprehensive solution.</p>\n\n<p>Better to stick with a proper <a href=\"https://www.opengl.org/wiki/OpenGL_Loading_Library\" rel=\"nofollow\">OpenGL Loading Library</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 558, "user_id": 4275865, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0wLdH.jpg?s=128&g=1", "display_name": "Barry Rogerson", "link": "https://stackoverflow.com/users/4275865/barry-rogerson"}, "is_accepted": true, "score": 1, "last_activity_date": 1600045055, "last_edit_date": 1600045055, "creation_date": 1600044377, "answer_id": 63876859, "question_id": 39627811, "link": "https://stackoverflow.com/questions/39627811/how-to-use-extension-like-glgenbuffersarb-in-qt5/63876859#63876859", "title": "How to use extension like glGenBuffersARB in Qt5?", "body": "<p>The way to have GL functions be available to the class in Qt5, without needing to use a helper, is to make your GL class derive from a subclass of <a href=\"https://doc.qt.io/qt-5/qabstractopenglfunctions.html\" rel=\"nofollow noreferrer\">QAbstractOpenGLFunctions</a>. For example your header file might look something like this:</p>\n<pre><code>#include &lt;QOpenGLFunctions_1_1&gt;\nclass MyGLClass : protected QOpenGLFunctions_1_1\n{\n    ...\n}\n</code></pre>\n<p>Then in your initialize method you need to initialize\nthe OpenGL functions like so:</p>\n<pre><code>void MyGLClass::initialize()\n{\n    if (!initializeOpenGLFunctions()) {\n        qFatal(&quot;initializeOpenGLFunctions failed&quot;);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7471, "user_id": 1035897, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3eccb41827ff628fa4143045e40c1b8c?s=128&d=identicon&r=PG", "display_name": "Lennart Rolland", "link": "https://stackoverflow.com/users/1035897/lennart-rolland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 63876859, "answer_count": 2, "score": 1, "last_activity_date": 1600045055, "creation_date": 1474499093, "last_edit_date": 1495540306, "question_id": 39627811, "link": "https://stackoverflow.com/questions/39627811/how-to-use-extension-like-glgenbuffersarb-in-qt5", "title": "How to use extension like glGenBuffersARB in Qt5?", "body": "<p>I am trying desperately to understand the architecture of <strong>OpenGL</strong> support in <strong>Qt5</strong>.</p>\n\n<p>My current problem is this: I have some existing OpenGL code (desktop, <em>not OpenGL ES</em>) that uses some OpenGL extensions, including <code>glGenBuffersARB</code>. Outside Qt5 getting access to the functions for extensions like this is trivial, for example by using <strong>GLEW</strong> I could simply do this:</p>\n\n<pre><code>glewInit();\n</code></pre>\n\n<p>And everything would just magically work as expected, and I could start to use <code>glGenBuffersARB</code> straight away. If I was ever worried, I could throw in a call to <code>glewIsSupported</code> to be sure it was supported.</p>\n\n<p>But in Qt5 there is a warning that GLEW and <code>QOpenGLFunctions</code> don't play well together (copied from <code>qopenglfunctions.h</code>):</p>\n\n<pre><code>#ifdef __GLEW_H__\n#if defined(Q_CC_GNU)\n#warning qopenglfunctions.h is not compatible with GLEW, GLEW defines will be undefined\n#warning To use GLEW with Qt, do not include &lt;qopengl.h&gt; or &lt;QOpenGLFunctions&gt; after glew.h\n#endif\n#endif\n</code></pre>\n\n<p>So let's say that I for the sake of this question and to satisfy the curiosity ditch GLEW completely and rely solely on Qt5 for a pure Qt5 approach. How would I get my existing OpenGL code that relies on glGenBuffersARB to work without manually binding each and every extension function manually?</p>\n\n<p>NOTE: I know I can follow tips in <a href=\"https://stackoverflow.com/questions/23865864/qopenglfunctions-missing-important-opengl-functions\">this</a> answer and do this:</p>\n\n<pre><code>auto functions = context-&gt;versionFunctions&lt;QOpenGLFunctions_3_3_Core&gt;();\nif (!functions) error();\nfunctions-&gt;initializeOpenGLFunctions();\nfunctions-&gt;glGenBuffersARB(...);\n</code></pre>\n\n<p>But then I would have to prefix every single line of existing OpenGL code with <code>functions-&gt;</code> which I would rather not do.</p>\n"}, {"tags": ["c++", "c++11", "operator-overloading", "libconfig"], "answers": [{"tags": [], "owner": {"reputation": 13260, "user_id": 6612932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3mwe.jpg?s=128&g=1", "display_name": "rgmt", "link": "https://stackoverflow.com/users/6612932/rgmt"}, "is_accepted": true, "score": 1, "last_activity_date": 1474546365, "creation_date": 1474546365, "answer_id": 39638748, "question_id": 39627708, "link": "https://stackoverflow.com/questions/39627708/c-passing-class-instance-as-float-variable-in-libconfig-lookupvalue/39638748#39638748", "title": "c++ passing class instance as float variable in libconfig++ :: lookupValue()", "body": "<p>Your problem is about const-ness: you're trying to convert <code>std</code> to a non-const reference while your <code>operator double</code> is const and relies on <code>getFactor</code> which returns a const reference.</p>\n\n<p>The following code works as intended:</p>\n\n<pre><code>class SensorTrainData\n{\n    public:\n        SensorTrainData() : trainingRangeFactor(2.0f) {}\n        SensorTrainData( const double &amp; _factor ) { setFactor(_factor); }\n\n        SensorTrainData &amp; operator=(const double&amp; other)\n        {\n            setFactor(other);\n            return *this;\n        }\n\n        operator double&amp;()\n        {\n            return getFactor();\n        }\n\n    private:\n\n        void setFactor( const double &amp; factor ) { trainingRangeFactor = factor; }\n        double &amp; getFactor() { return trainingRangeFactor; }\n\n        double trainingRangeFactor; \n};\n</code></pre>\n\n<p>The obvious drawback is that you're now exposing <code>trainingRangeFactor</code> as a non-const reference.</p>\n"}], "owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 39638748, "answer_count": 1, "score": 0, "last_activity_date": 1476786867, "creation_date": 1474498335, "last_edit_date": 1476786867, "question_id": 39627708, "link": "https://stackoverflow.com/questions/39627708/c-passing-class-instance-as-float-variable-in-libconfig-lookupvalue", "title": "c++ passing class instance as float variable in libconfig++ :: lookupValue()", "body": "<p>I have this small class that revolves around a single double variable</p>\n\n<pre><code>class SensorTrainData\n{\n    public:\n        SensorTrainData() : trainingRangeFactor(2.0f) {}\n        SensorTrainData( const double &amp; _factor ) { setFactor(_factor); }\n\n        SensorTrainData &amp; operator=(const double&amp; other)\n        {\n             setFactor(other);\n             return *this;\n         }\n\n         operator double() const\n         {\n             return getFactor();\n         }\n\n    private:\n\n        void setFactor( const double &amp; factor );\n        const double &amp; getFactor() const { return trainingRangeFactor; }\n\n        double trainingRangeFactor; \n};\n</code></pre>\n\n<p>These user function <code>double()</code>  and the operator \"=\" overload allow me to do respectively</p>\n\n<pre><code>SensorTrainData std(3.0f);\ndouble d = std;\n\ndouble k = 4.0f;\nstd = k;\n</code></pre>\n\n<p>I am using <code>libconfig++</code> and I want to be able to pass the variable <code>std</code> directly in the <code>libconfig::lookupValue(\"varName\" , std)</code> in order to pick value \"varName\", which was read in from a config (text) file.</p>\n\n<p>Unfortunately, the compiler says I cannot pass a <code>SensorTrainData &amp;</code> . </p>\n\n<pre><code>src/sensor.cpp:1048:45: error: no matching function for call to \u2018libconfig::Setting::lookupValue(const char [12], enalu::SensorTrainData&amp;) const\u2019\nsrc/sensor.cpp:1048:45: note: candidates are:\n...\n....\n/usr/include/libconfig.h++:255:8: note: bool libconfig::Setting::lookupValue(const char*, double&amp;) const\n/usr/include/libconfig.h++:255:8: note:   no known conversion for argument 2 from \u2018enalu::SensorTrainData\u2019 to \u2018double&amp;\u2019\n</code></pre>\n\n<p>of course I could do</p>\n\n<pre><code>double foo = 0.0f;\nlibconfig::lookupValue(\"varName\" , foo); //load varName from file into foo\nstd = foo;\n</code></pre>\n\n<p>But I want to avoid the extra typing and code lines etc. </p>\n\n<p>IS there an operator overload trick I could use to do that?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c++", "pthreads"], "comments": [{"owner": {"reputation": 457352, "user_id": 87234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FkjBe.png?s=128&g=1", "display_name": "GManNickG", "link": "https://stackoverflow.com/users/87234/gmannickg"}, "edited": false, "score": 1, "creation_date": 1474509574, "post_id": 39627669, "comment_id": 66563375, "body": "Use C++ properly and make it a non-issue. Clean things up in destructors."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1474500964, "post_id": 39627709, "comment_id": 66561563, "body": "Also sucks when you come along ten years later with vague memories of this code, package it up into a library for some other project, and then, after much debugging, realize the library locks up because you were younger, stupider and lazier a decade earlier."}], "tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": true, "score": 4, "last_activity_date": 1474501081, "last_edit_date": 1495535269, "creation_date": 1474498342, "answer_id": 39627709, "question_id": 39627669, "link": "https://stackoverflow.com/questions/39627669/is-it-necessary-to-unlock-a-mutex-at-the-end-of-main/39627709#39627709", "title": "Is it necessary to unlock a mutex at the end of main?", "body": "<p>At the end of the <code>main</code> all of the program resources will be cleaned up by the OS. There will likely not be any negative consequences in not releasing this mutex. The real question is though, <strong>why would you not release it?</strong> There is no benefit gained by not releasing it, and you get into the good habit of having an unlock for every lock (ie. good resource management).</p>\n\n<p>This is for your specific code, you need to be much more careful if it is the opened thread that forgets to release the mutex, see <a href=\"https://stackoverflow.com/questions/4424193/what-happens-to-mutex-when-the-thread-which-acquired-it-exits\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "is_accepted": false, "score": 1, "last_activity_date": 1474511050, "creation_date": 1474511050, "answer_id": 39629274, "question_id": 39627669, "link": "https://stackoverflow.com/questions/39627669/is-it-necessary-to-unlock-a-mutex-at-the-end-of-main/39629274#39629274", "title": "Is it necessary to unlock a mutex at the end of main?", "body": "<p>There are two sides to this issue:</p>\n\n<ol>\n<li>Should you exercise the good-health habit of unlocking a mutex when you're done with it?</li>\n<li>Should you have to waste your (hopefully) valuable time explicitly unlocking things?</li>\n</ol>\n\n<p>This is C++ so you have the option of RAII and doing something similar to what the C++11 <code>&lt;thread&gt;</code> header does:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;utility&gt;\n#include &lt;pthread.h&gt;\n\nstruct mutex_lock_t {\n    pthread_mutex_t* mutex_ { nullptr };\npublic:\n    mutex_lock_t() = default;\n    mutex_lock_t(pthread_mutex_t&amp; mutex) : mutex_(&amp;mutex) { pthread_mutex_lock(mutex_); }\n    void unlock()\n    {\n        if (mutex_) { pthread_mutex_unlock(std::exchange(mutex_, nullptr)); }\n    }\n    ~mutex_lock_t() noexcept { unlock(); }\n\n    mutex_lock_t(const mutex_lock_t&amp;) = delete;\n    mutex_lock_t(mutex_lock_t&amp;&amp;) = delete;\n    mutex_lock_t operator=(const mutex_lock_t&amp;) = delete;\n    mutex_lock_t operator=(mutex_lock_t&amp;&amp;) = delete;\n};\n\nint main()\n{\n    pthread_mutex_t mutex {};\n    pthread_mutex_init(&amp;mutex, nullptr);\n    mutex_lock_t lock(mutex);\n    std::cout &lt;&lt; \"end of main\\n\";\n}  // auto unlock at end of scope\n</code></pre>\n\n<p>The advantage here is that \"do I have to\" is no-longer a question, you just are. </p>\n\n<p>If you don't, then a typical mutex is held in process memory and will simply cease to exist along with anything that might have access to it when the process terminates.</p>\n\n<p>But if, in the future, your program changes and uses a mutex in shared memory with other processes, then it's better to depend on RAII cleanup rather than process cleanup.</p>\n"}], "owner": {"reputation": 13, "user_id": 6860644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc36fabf32696867fad84d364a5de0a?s=128&d=identicon&r=PG&f=1", "display_name": "Georgessw", "link": "https://stackoverflow.com/users/6860644/georgessw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 963, "favorite_count": 0, "accepted_answer_id": 39627709, "answer_count": 2, "score": 1, "last_activity_date": 1474511050, "creation_date": 1474498060, "question_id": 39627669, "link": "https://stackoverflow.com/questions/39627669/is-it-necessary-to-unlock-a-mutex-at-the-end-of-main", "title": "Is it necessary to unlock a mutex at the end of main?", "body": "<p>Take the following code as an example. In pthread_con_wait, activeMutex is locked. Then is the line \"pthread_mutex_unlock(&amp;activeMutex)\" necessary? Because the main function will end soon. Or the mutex will be automatically unlocked after main is finished if I delete that line.</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nint activeThreads = 0;\n\npthread_mutex_t coutMutex;\npthread_mutex_t activeMutex;\npthread_cond_t  allDoneCondition;\n\nvoid* Thread(void* v)\n{\n  unsigned long myId = (unsigned long)v;\n\n  pthread_mutex_lock(&amp;coutMutex);\n  cout &lt;&lt; \"Hello from thread \" &lt;&lt; myId &lt;&lt; endl;\n  pthread_mutex_unlock(&amp;coutMutex);\n  pthread_mutex_lock(&amp;activeMutex);\n  activeThreads--;\n  if (activeThreads == 0)\n   {\n     pthread_cond_signal(&amp;allDoneCondition);\n   }\n  pthread_mutex_unlock(&amp;activeMutex);\n}\n\nint main(int argc, char** argv)\n{\n  int totalThreads = 8;\n  pthread_mutex_init(&amp;coutMutex, 0);\n  pthread_mutex_init(&amp;activeMutex, 0);\n  pthread_cond_init(&amp;allDoneCondition, 0);\n\n  pthread_mutex_lock(&amp;activeMutex);\n  activeThreads = totalThreads;\n  for (int i = 0; i &lt; totalThreads; ++i)\n    {\n      pthread_t t;\n      pthread_create(&amp;t, 0, Thread,  (void*)i);\n    }\n  cout &lt;&lt; \"Hello from main before exit\" &lt;&lt; endl;\n  pthread_cond_wait(&amp;allDoneCondition, &amp;activeMutex);\n  pthread_mutex_unlock(&amp;activeMutex);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "compression", "zlib", "heap-memory"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 1, "creation_date": 1474498130, "post_id": 39627654, "comment_id": 66560917, "body": "Your post  in its current form is too broad and not a good fit for Stack Overflow. Please visit the <a href=\"http://stackoverflow.com/help\">help center</a> and read the section <a href=\"http://stackoverflow.com/help/how-to-ask\">how do I ask a good question</a>."}, {"owner": {"reputation": 457, "user_id": 60629, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/znZlm.jpg?s=128&g=1", "display_name": "JGood", "link": "https://stackoverflow.com/users/60629/jgood"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1474506755, "post_id": 39627654, "comment_id": 66562733, "body": "@CaptainObvlious: updated the question to be less vague for you by simplifying and pointing out an example might be log files.. Still can&#39;t find anything on Stackoverflow that matches and am looking into Adler&#39;s answer. Which seems to be spot on."}, {"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 1, "creation_date": 1474508921, "post_id": 39627654, "comment_id": 66563234, "body": "@CaptainObvlious The question didn&#39;t seem too broad to me. It was quite simple and specific. &quot;How do you append to a zlib stream?&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1905, "user_id": 2094844, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/NE8It.jpg?s=128&g=1", "display_name": "Sagar", "link": "https://stackoverflow.com/users/2094844/sagar"}, "edited": false, "score": 0, "creation_date": 1520236868, "post_id": 39627707, "comment_id": 85216514, "body": "<code>gzappend</code> takes <code>gzip</code> file as an input, but what if I want to append data to zlib compressed file ? Please correct me if I am wrong."}], "tags": [], "owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "is_accepted": true, "score": 1, "last_activity_date": 1474498327, "creation_date": 1474498327, "answer_id": 39627707, "question_id": 39627654, "link": "https://stackoverflow.com/questions/39627654/append-to-compressed-file-using-zlib/39627707#39627707", "title": "Append to compressed file using zlib", "body": "<p>It sounds like you are trying to keep something like a compressed log, appending small amounts of data each time. For that you can look at <a href=\"https://github.com/madler/zlib/blob/master/examples/gzlog.h\" rel=\"nofollow\"><code>gzlog.h</code></a> and <a href=\"https://github.com/madler/zlib/blob/master/examples/gzlog.c\" rel=\"nofollow\"><code>gzlog.c</code></a> for an example of how to do this.</p>\n\n<p>You can also look at <a href=\"https://github.com/madler/zlib/blob/master/examples/gzappend.c\" rel=\"nofollow\"><code>gzappend</code></a>, which appends data to a gzip file.</p>\n\n<p>These are all easily adaptable to a zlib stream.</p>\n"}, {"tags": [], "owner": {"reputation": 457, "user_id": 60629, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/znZlm.jpg?s=128&g=1", "display_name": "JGood", "link": "https://stackoverflow.com/users/60629/jgood"}, "is_accepted": false, "score": 0, "last_activity_date": 1488322858, "creation_date": 1488322858, "answer_id": 42520356, "question_id": 39627654, "link": "https://stackoverflow.com/questions/39627654/append-to-compressed-file-using-zlib/42520356#42520356", "title": "Append to compressed file using zlib", "body": "<p>Mark Adler's answer was very close to what I needed, but due to already being entrenched in the zlib library and on an embedded device with limited resources I was/am stuck. </p>\n\n<p>I ended up simply appending a delimiter to each section of data (ex: @@delimiter@@) and once ready to read the finished file, (different application) it seeks these sections and creates an array object of the compressed sections that are then individually decompressed. </p>\n\n<p>I am still marking Adler's answer as correct, as it was useful info that will be of more help to other programmers. </p>\n"}], "owner": {"reputation": 457, "user_id": 60629, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/znZlm.jpg?s=128&g=1", "display_name": "JGood", "link": "https://stackoverflow.com/users/60629/jgood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1180, "favorite_count": 1, "accepted_answer_id": 39627707, "answer_count": 2, "score": 1, "last_activity_date": 1488322858, "creation_date": 1474497975, "last_edit_date": 1474506505, "question_id": 39627654, "link": "https://stackoverflow.com/questions/39627654/append-to-compressed-file-using-zlib", "title": "Append to compressed file using zlib", "body": "<p>Looking around I have found the question being asked, but not great answers. If this is a stackoverflow duplicate (sorry!)</p>\n\n<p>My goal is to have a zlib compressed file that I append to using C/C++ at different intervals (such as a log file). Due to buffer size constraints I was hoping to avoid having to keep the entire file in memory for appending new items. </p>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 1577, "user_id": 6776535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c515e458c92c554943b271a6789f0372?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Pr&#233;vost", "link": "https://stackoverflow.com/users/6776535/robert-pr%c3%a9vost"}, "edited": false, "score": 0, "creation_date": 1474500034, "post_id": 39627607, "comment_id": 66561354, "body": "I&#39;m going to guess that all the files other than *3.1.0.dylib are symlinks.  Otherwise, the files should be binary identical.  Is either true?"}, {"owner": {"reputation": 1, "user_id": 6668710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7d3f2b944ecefab3d858d5c9ebbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Gela", "link": "https://stackoverflow.com/users/6668710/gela"}, "reply_to_user": {"reputation": 1577, "user_id": 6776535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c515e458c92c554943b271a6789f0372?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Pr&#233;vost", "link": "https://stackoverflow.com/users/6776535/robert-pr%c3%a9vost"}, "edited": false, "score": 0, "creation_date": 1474500539, "post_id": 39627607, "comment_id": 66561454, "body": "How do I check if they&#39;re binary identical? I tried opening it using a text editor but it is a bunch of question marks for the most part. @RobertPr&#233;vost"}, {"owner": {"reputation": 1577, "user_id": 6776535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c515e458c92c554943b271a6789f0372?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Pr&#233;vost", "link": "https://stackoverflow.com/users/6776535/robert-pr%c3%a9vost"}, "edited": false, "score": 0, "creation_date": 1474501664, "post_id": 39627607, "comment_id": 66561721, "body": "You can just use <code>diff</code>."}, {"owner": {"reputation": 1, "user_id": 6668710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7d3f2b944ecefab3d858d5c9ebbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Gela", "link": "https://stackoverflow.com/users/6668710/gela"}, "reply_to_user": {"reputation": 1577, "user_id": 6776535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c515e458c92c554943b271a6789f0372?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Pr&#233;vost", "link": "https://stackoverflow.com/users/6776535/robert-pr%c3%a9vost"}, "edited": false, "score": 0, "creation_date": 1474502140, "post_id": 39627607, "comment_id": 66561816, "body": "Actually I just noticed that there are tiny arrows right next to the library icons other than the *3.1.0.dylib libraries (updated the post with a screenshot). So I assume you are correct that the other two are possibly symlinks. Does this mean I can safely ignore them and just use the main one? @RobertPr&#233;vost"}, {"owner": {"reputation": 1577, "user_id": 6776535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c515e458c92c554943b271a6789f0372?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Pr&#233;vost", "link": "https://stackoverflow.com/users/6776535/robert-pr%c3%a9vost"}, "edited": false, "score": 0, "creation_date": 1474502506, "post_id": 39627607, "comment_id": 66561878, "body": "You probably should keep all of them and link to the one without the version number (see <a href=\"http://unix.stackexchange.com/questions/475/how-do-so-shared-object-numbers-work\">here</a> for more explanation)."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6668710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7d3f2b944ecefab3d858d5c9ebbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Gela", "link": "https://stackoverflow.com/users/6668710/gela"}, "edited": false, "score": 0, "creation_date": 1474557872, "post_id": 39638406, "comment_id": 66589398, "body": "To clarify, does this mean that these libraries are independent of each other and that I do not need all 3?"}, {"owner": {"reputation": 3122, "user_id": 1874627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eV76W.jpg?s=128&g=1", "display_name": "saurabheights", "link": "https://stackoverflow.com/users/1874627/saurabheights"}, "reply_to_user": {"reputation": 1, "user_id": 6668710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7d3f2b944ecefab3d858d5c9ebbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Gela", "link": "https://stackoverflow.com/users/6668710/gela"}, "edited": false, "score": 0, "creation_date": 1474567588, "post_id": 39638406, "comment_id": 66595295, "body": "@Gela: Yes, they are symlinks or shortcuts to the same file. The arrow you noticed, tells you that. Also, if you build opencv with opencv_world, you will have lib_opencv_world.3.1.0.dylib as well. This library contains everything( libcore, libimgproc, libcallib, etc.. )"}, {"owner": {"reputation": 1, "user_id": 6668710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7d3f2b944ecefab3d858d5c9ebbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Gela", "link": "https://stackoverflow.com/users/6668710/gela"}, "reply_to_user": {"reputation": 3122, "user_id": 1874627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eV76W.jpg?s=128&g=1", "display_name": "saurabheights", "link": "https://stackoverflow.com/users/1874627/saurabheights"}, "edited": false, "score": 0, "creation_date": 1474568359, "post_id": 39638406, "comment_id": 66595701, "body": "Thank you. I used the prebuilt binaries on Windows and used opencv_world300.lib there but since there were no prebuilt binaries for Mac, I had to build the source myself and ended up with separate libraries. Do you know how I can get the same opencv_world library in Mac? That would actually be the ideal solution for me since I am building the same exact project on multiple platforms. @saurabheights"}, {"owner": {"reputation": 3122, "user_id": 1874627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eV76W.jpg?s=128&g=1", "display_name": "saurabheights", "link": "https://stackoverflow.com/users/1874627/saurabheights"}, "reply_to_user": {"reputation": 1, "user_id": 6668710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7d3f2b944ecefab3d858d5c9ebbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Gela", "link": "https://stackoverflow.com/users/6668710/gela"}, "edited": false, "score": 0, "creation_date": 1474571680, "post_id": 39638406, "comment_id": 66597553, "body": "@Gela: Although there are no pre-built binaries for Mac, brew provides it. Install brew and run <code>brew info opencv</code>. Run and READ it. A simple command would be <code>brew install opencv --with-java --without-python</code>. Next, for install opencv world, AFAIK brew does not supports it. If you are using cmake/ ccmake, it has BUILD_OPENCV_WORLD option which needs to be turned ON."}], "tags": [], "owner": {"reputation": 1383, "user_id": 1658810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/DlcF2.png?s=128&g=1", "display_name": "Chris Britt", "link": "https://stackoverflow.com/users/1658810/chris-britt"}, "is_accepted": true, "score": 0, "last_activity_date": 1474545424, "creation_date": 1474545424, "answer_id": 39638406, "question_id": 39627607, "link": "https://stackoverflow.com/questions/39627607/three-instances-of-each-opencv-3-1-0-library/39638406#39638406", "title": "Three instances of each openCV 3.1.0 library", "body": "<p>When you build the opencv library it creates the actual *.dylib binary (libopencv_LibName.3.1.0.dylib) that contains the release, the major, and minor version. (Release = 3, Major = 1, Minor = 0). This allows you to have a dynamic style of linking to a specific version of the library. (For example, opencv often is not completely compatible between release versions. (From 2.x.x to 3.x.x), however it often is compatible between major/minor versions.(3.0.x to 3.1.x) )</p>\n\n<p>By linking to the 3.1.0 version, you are locking in on requiring that specific version of the libary. (If you update opencv, it will still be using openCV 3.1.0).</p>\n\n<p>However if you link to the 3.1 version, it is only caring about the Release and Major version, but will allow minor version updates. (Currently the 3.1 is a symlink to 3.1.0, but if you installed 3.1.1, it would now reference the 3.1.1 library.) I generally find it best to link to this one as it will allow you to update for bug fixes, but will not break any functionality. </p>\n\n<p>Finally there is the version-less symlink, this one will always reference the latest version of opencv you have installed. Currently it references 3.1.0, but if you installed 3.1.1 it will now reference 3.1.1. This would not be bad, but if you were to install 4.0.0, it would now be referencing this binary and likely break some of the API. </p>\n"}], "owner": {"reputation": 1, "user_id": 6668710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7d3f2b944ecefab3d858d5c9ebbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Gela", "link": "https://stackoverflow.com/users/6668710/gela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 39638406, "answer_count": 1, "score": 0, "last_activity_date": 1474545424, "creation_date": 1474497664, "last_edit_date": 1474502028, "question_id": 39627607, "link": "https://stackoverflow.com/questions/39627607/three-instances-of-each-opencv-3-1-0-library", "title": "Three instances of each openCV 3.1.0 library", "body": "<p>I was able to install and build openCV following the instructions here (<a href=\"http://charliegerard.github.io/blog/Installing-OpenCV/\" rel=\"nofollow\">http://charliegerard.github.io/blog/Installing-OpenCV/</a>). But after successfully creating the dynamic libraries I noticed in the lib directory there are 3 instances of <em>each</em> library named in the following format:</p>\n\n<p>libopencv_LibName.3.1.0.dylib </p>\n\n<p>libopencv_LibName.3.1.dylib</p>\n\n<p>libopencv_LibName.dylib</p>\n\n<p><a href=\"http://i.stack.imgur.com/fsfXq.png\" rel=\"nofollow\">Screenshot of the libraries</a></p>\n\n<p>My next step is to single out only the header files and libraries I need for my project, and I'm not sure if I really need all 3 instances of every library in use. Why does make create all these extras? And which ones do I need?</p>\n\n<p><b>Additional Info:</b></p>\n\n<p>OS: OSX El Capitan</p>\n\n<p>IDE: Xcode 7.3.1</p>\n"}, {"tags": ["c++", "arrays", "function", "row"], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1474496775, "creation_date": 1474496775, "answer_id": 39627491, "question_id": 39627385, "link": "https://stackoverflow.com/questions/39627385/changing-values-of-a-row-in-a-2d-array-using-for-loops/39627491#39627491", "title": "Changing Values of a Row in a 2D Array Using For Loops", "body": "<p>In your case the first index corresponds to a row and the second index corresponds to a column.</p>\n\n<p>Use</p>\n\n<pre><code>void zero_row (int a [4][5], int row){\n    for (int j = 0; j &lt; 5; j++) {  // 5 instead of 4\n        a[row][j] = 0;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 320, "user_id": 5327708, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/jW4mm.jpg?s=128&g=1", "display_name": "Gavin Youker", "link": "https://stackoverflow.com/users/5327708/gavin-youker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1176, "favorite_count": 0, "accepted_answer_id": 39627491, "answer_count": 1, "score": 1, "last_activity_date": 1474496775, "creation_date": 1474496069, "question_id": 39627385, "link": "https://stackoverflow.com/questions/39627385/changing-values-of-a-row-in-a-2d-array-using-for-loops", "title": "Changing Values of a Row in a 2D Array Using For Loops", "body": "<p>I have a function called <code>zero_row</code>. This function inserts the value of zero into all a row that is specified. The function takes to variables. <code>a</code> (the array) and <code>row</code> (the row in the array). Here is my function</p>\n\n<pre><code>void zero_row (int a [4][5], int row){\n    for (int i = 0; i &lt; 4; i++) {\n        a[i][j] = 0;\n    }\n}\n</code></pre>\n\n<p>I know how to set values of the entire array to zero. As i have a function to do this as well.</p>\n\n<pre><code>void zero_all (int a [4][5]) {\n    for (int i = 0; i &lt; 4; i++) {\n        for (int j = 0; j &lt; 5; j++) {\n            my_arr[i][j] = 0;\n        }\n    }\n}\n</code></pre>\n\n<p>I cant seem to figure out how to do this using the variable <code>row</code>. I want to use this variable so I can later change the row in my main function, like so: <code>zero_row(a, 3);</code>. Can anyone help?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "pointers", "precision", "ieee-754"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1474500656, "post_id": 39627367, "comment_id": 66561483, "body": "A few suggestions: 1. You might want make certain that your system uses IEEE754 floats before you sink too much time debugging. 2. <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">Get familiar with endian</a>. 3. Wholeheartedly recommend better names. <code>d</code> is utterly non descriptive. It provides no hints to the purpose of <code>d</code>. This often slows debugging."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1474500675, "post_id": 39627367, "comment_id": 66561490, "body": "<code>df</code> is a pointer to <code>char</code>.  <code>*df</code> is the <code>char</code> it currently points to. You&#39;re allowed to use char pointers to pretend that some larger object is made up of chars."}, {"owner": {"reputation": 11, "user_id": 6827394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad44c2bd10c3d8a81c70aeef6db8f3f3?s=128&d=identicon&r=PG", "display_name": "Zoey A", "link": "https://stackoverflow.com/users/6827394/zoey-a"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1474518329, "post_id": 39627367, "comment_id": 66565500, "body": "@user4581301 yes I agree with I need better descriptive names."}, {"owner": {"reputation": 11, "user_id": 6827394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad44c2bd10c3d8a81c70aeef6db8f3f3?s=128&d=identicon&r=PG", "display_name": "Zoey A", "link": "https://stackoverflow.com/users/6827394/zoey-a"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1474518409, "post_id": 39627367, "comment_id": 66565521, "body": "@M.M thanks for clarification!"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1474520726, "post_id": 39627367, "comment_id": 66566118, "body": "The purpose of the assignment is probably to get you thinking about how to determine exactness as you&#39;re building the value. Determining it afterwards sounds like extra work."}, {"owner": {"reputation": 11, "user_id": 6827394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad44c2bd10c3d8a81c70aeef6db8f3f3?s=128&d=identicon&r=PG", "display_name": "Zoey A", "link": "https://stackoverflow.com/users/6827394/zoey-a"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1474527973, "post_id": 39627367, "comment_id": 66569352, "body": "@MarkRansom yes the extra work did make me think hard on precision and how the computers store numbers. It&#39;s a lot of googling and wiki reading since all this is new to me."}], "answers": [{"comments": [{"owner": {"reputation": 1577, "user_id": 6776535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c515e458c92c554943b271a6789f0372?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Pr&#233;vost", "link": "https://stackoverflow.com/users/6776535/robert-pr%c3%a9vost"}, "edited": false, "score": 2, "creation_date": 1474501196, "post_id": 39628038, "comment_id": 66561614, "body": "I&#39;m not sure that <code>std::to_string</code> will work.  Without being able to change the number of decimals to display, I&#39;m able to print out 0.1 exactly as inputed even though 0.1 is not exactly representable as a float."}, {"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "reply_to_user": {"reputation": 1577, "user_id": 6776535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c515e458c92c554943b271a6789f0372?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Pr&#233;vost", "link": "https://stackoverflow.com/users/6776535/robert-pr%c3%a9vost"}, "edited": false, "score": 0, "creation_date": 1474501391, "post_id": 39628038, "comment_id": 66561661, "body": "Hm right, I forgot Rounding/Dragon/Grisu ... then, the hard solution (building manual calculations with digit arrays etc.) seems the only way."}, {"owner": {"reputation": 11, "user_id": 6827394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad44c2bd10c3d8a81c70aeef6db8f3f3?s=128&d=identicon&r=PG", "display_name": "Zoey A", "link": "https://stackoverflow.com/users/6827394/zoey-a"}, "edited": false, "score": 0, "creation_date": 1474518640, "post_id": 39628038, "comment_id": 66565573, "body": "Thanks for suggestion! The messy part are the indices, but I finally got that figured out for the for loops."}], "tags": [], "owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "is_accepted": false, "score": 0, "last_activity_date": 1474500683, "creation_date": 1474500683, "answer_id": 39628038, "question_id": 39627367, "link": "https://stackoverflow.com/questions/39627367/rounding-error-of-binary32/39628038#39628038", "title": "Rounding error of binary32", "body": "<p>Basic idea: Convert your number <code>d</code> back to a string (eg. with <code>to_string</code>) and compare it to the input. If the strings are different, there was some loss because of the limitations of <code>float</code>.  </p>\n\n<p>Of course, this means your input always has to be in the same string format that to_string uses. No additional unneeded 0's, no whitespaces, etc.  </p>\n\n<p>...<br>\nThat said, doing the float conversion without cast (but with manually parsing the input and calculating the IEEE754 bits) is more work initally, but in return, it sovled this problem automatically. And, as noted in the comments, your cast might not work the way you want.</p>\n"}], "owner": {"reputation": 11, "user_id": 6827394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad44c2bd10c3d8a81c70aeef6db8f3f3?s=128&d=identicon&r=PG", "display_name": "Zoey A", "link": "https://stackoverflow.com/users/6827394/zoey-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1474527760, "creation_date": 1474496006, "last_edit_date": 1474527760, "question_id": 39627367, "link": "https://stackoverflow.com/questions/39627367/rounding-error-of-binary32", "title": "Rounding error of binary32", "body": "<p>As part of a homework, I'm writing a program that takes a float decimal number as input entered from terminal, and return IEEE754 <em>binary32</em> of that number AND return 1 if the binary exactly represents the number, 0 otherwise. We are only allowed to use iostream and cmath. </p>\n\n<p>I already wrote the part that returns <em>binary32</em> format, but I don't understand how to see if there's rounding to that format.</p>\n\n<p>My idea to see the rounding was to calculate the decimal number back from <em>binary32</em> form and compare it with the original number. But I am having difficulty with saving the returned binary32 as some type of data, since I can't use the vector header. I've tried using for loops and <code>pow</code>, but I still get the indices wrong. </p>\n\n<p>Also, I'm having trouble understanding what exactly is <code>df</code> or <code>*df</code>? I wrote the code myself, but I only know that I needed to convert address pointed to <code>float</code> to address pointed to <code>char</code>.</p>\n\n<p>My other idea was to compare <em>binary32</em> and <em>binary 64</em>, which gives more precision. And again, I don't know how to do this without using vector?</p>\n\n<pre><code>int main(int argc, char* argv[]){\n    int i ,j;\n    float num;\n\n    num = atof(argv[1]);\n\n    char* numf = (char*)(&amp;num);\n\n    for (i = sizeof(float) - 1; i &gt;= 0; i--){\n        for (j = 7; j &gt;= 0; j--)\n            if (numf[i] &amp; (1 &lt;&lt; j)) {\n                cout &lt;&lt; \"1\";\n            }else{\n                cout &lt;&lt; \"0\";\n            }\n    }\n    cout &lt;&lt; endl;\n}\n</code></pre>\n\n<p>//////\nUpdate:\nSince there's no other way around without using header files, I hard coded for loops to convert <em>binary32</em> back to decimal.</p>\n\n<p>Since x = 1.b31b30...b0 * 2^p. One for loop for finding the exponent and one for loop for finding the significand. </p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1474494357, "post_id": 39626973, "comment_id": 66559631, "body": "[OT]: For matrix, prefer <code>std::vector&lt;int&gt;</code> over <code>vector&lt;std::vector&lt;int&gt;&gt;</code> over <code>int**</code>. (The first one require simple math to transform index as wanted)."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1474494848, "post_id": 39626973, "comment_id": 66559868, "body": "[OT]: <code>std::map</code> has its own <code>find</code> function. It appears you might want to take the time to research <code>iterators</code> and <code>references</code> in C++. See also <a href=\"http://pastebin.com/hJ4Frmep\" rel=\"nofollow noreferrer\">pastebin.com/hJ4Frmep</a>"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1474494339, "post_id": 39627031, "comment_id": 66559620, "body": "And to the point of his problem, each iteration of the <code>for</code> loop ends and restarts the scope. So it can use the same address every time through the loop."}, {"owner": {"reputation": 13, "user_id": 3025945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57b88efe2328a330fa353ed86175279e?s=128&d=identicon&r=PG&f=1", "display_name": "user3025945", "link": "https://stackoverflow.com/users/3025945/user3025945"}, "edited": false, "score": 0, "creation_date": 1474495125, "post_id": 39627031, "comment_id": 66559978, "body": "I guess I don&#39;t understand how using a different data type removes the behavior you&#39;re describing? I admit I usually code in Python so this sort of thing is a bit new to me. EDIT: It worked regardless, so thanks anyway."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1474495421, "post_id": 39627031, "comment_id": 66560079, "body": "I edited my answer like this: When you insert the pair in the vector, the data is copied, not only the pointer: it is safe."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 2, "last_activity_date": 1474495408, "last_edit_date": 1474495408, "creation_date": 1474494169, "answer_id": 39627031, "question_id": 39626973, "link": "https://stackoverflow.com/questions/39626973/c-vector-values-keep-changing/39627031#39627031", "title": "C++ vector values keep changing?", "body": "<p>That is bad:</p>\n\n<pre><code> for (int j = 0; j &lt; width; j++) {\n     blockList.push_back(grid[i][j]);\n     int pos[2] = {i, j};\n     vector&lt;int*&gt; v;\n     v.push_back(pos);\n     blockLocations[grid[i][j]] = v;\n  }\n</code></pre>\n\n<p>You create a <code>pos</code> variable locally and store its reference. When you go out of scope of the <code>for</code> loop it is invalid / data can be replaced by something else.</p>\n\n<p>(actually as Barmar pointed out, since the <code>pos</code> address is always the same within the loop, the values change at each iteration)</p>\n\n<p>You could use a <code>std::pair&lt;int,int&gt;</code> to store your values instead.\nWhen you insert the pair in the vector, the data is copied, not only the pointer: it is safe.</p>\n\n<pre><code>typedef std::pair&lt;int,int&gt; IntIntPair;\n\nIntIntPair pos(i,j);\nstd::vector&lt;IntIntPair&gt; v;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3025945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57b88efe2328a330fa353ed86175279e?s=128&d=identicon&r=PG&f=1", "display_name": "user3025945", "link": "https://stackoverflow.com/users/3025945/user3025945"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 39627031, "answer_count": 1, "score": 1, "last_activity_date": 1474495408, "creation_date": 1474493850, "question_id": 39626973, "link": "https://stackoverflow.com/questions/39626973/c-vector-values-keep-changing", "title": "C++ vector values keep changing?", "body": "<p>This is a real simple problem. I'm writing a sliding block puzzle game for an exercise.</p>\n\n<pre><code>1, 1, 1, 1, 1,\n1, 0, 3, 4, 1,\n1, 0, 2, 2, 1,\n1, 1, 1, 1, 1,\n</code></pre>\n\n<p>It receives input as in the form above, with '0' representing empty spaces, '1' representing walls, and all other numbers representing blocks.</p>\n\n<p>Here is the class definition and constructor for the game state:</p>\n\n<pre><code>class GameState {\n\n   public:\n      GameState(int hght, int wdth);\n      GameState(const GameState &amp;obj);\n      ~GameState();\n      int getHeight();\n      int getWidth();\n      int getElem(int i, int j);\n      void setElem(int i, int j, int val);\n      void display();\n      void readFile(char* filename);\n      bool checkSolved();\n      map&lt;int, vector&lt;int*&gt; &gt; blockLocations;\n      vector&lt;int&gt; blockList;\n      void getBlockLocations();\n      void findBlock(int n);\n   private:\n      int **grid;\n      int height, width;\n      void allocate() {\n         grid = new int*[height];\n         for(int i = 0; i &lt; height; i++)\n         {\n            grid[i] = new int[width];\n         }\n      }\n};\n\nGameState::GameState(int hght, int wdth) {\n   height = hght;\n   width = wdth;\n   allocate();\n   for(int i = 0; i &lt; hght; i++) {\n      for (int j = 0; j &lt; wdth; j++) {\n         grid[i][j] = 0;\n      }\n   }\n};\n</code></pre>\n\n<p>Essentially, the grid is represented by a two-dimensional pointer array of integers.  <code>height</code> and <code>width</code> are self-explanatory; <code>blockLocations</code> is a map that maps a block number to its point-wise coordinates of the form (y, x). For the time being, if a block occupies multiple spaces only the lowest rightmost space is listed. The matrix initializes as being nothing but zeros; the actual values are read in from a csv.</p>\n\n<p>All of these methods are defined, but the two methods of concern are <code>getBlockLocations()</code> and <code>findBlock(int n)</code>.</p>\n\n<pre><code>void GameState::getBlockLocations() {\n   for (int i = 0; i &lt; height; i++) {\n      for (int j = 0; j &lt; width; j++) {\n         blockList.push_back(grid[i][j]);\n         int pos[2] = {i, j};\n         vector&lt;int*&gt; v;\n         v.push_back(pos);\n         blockLocations[grid[i][j]] = v;\n      }\n   }\n}\n\nvoid GameState::findBlock(int n) {\n   vector&lt;int&gt;::iterator it;\n   it = find(blockList.begin(), blockList.end(), n);\n   if (it != blockList.end()) {\n      vector&lt;int*&gt; * posList = &amp;blockLocations[n];\n      for (int itr = 0; itr &lt; posList-&gt;size(); itr++) {\n         vector&lt;int*&gt; curPos = *posList;\n         cout &lt;&lt; curPos[itr][0] &lt;&lt; \", \" &lt;&lt; curPos[itr][1] &lt;&lt; endl;\n      }\n   }\n}\n</code></pre>\n\n<p>The problem comes up when I actually run this. As a case example, when I run <code>getBlockLocations()</code>, it correctly stores the coordinate for '2' as (2, 3). However, when I ask the program to display the location of that block with <code>findBlock(2)</code>, the resulting output is something along the lines of (16515320, 0). It's different every time but never correct. I don't see the pointer mistake I'm making to get incorrect values like this.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1474493637, "post_id": 39626903, "comment_id": 66559307, "body": "no, because <code>Point</code> isn&#39;t a namespace"}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 1, "creation_date": 1474493701, "post_id": 39626903, "comment_id": 66559334, "body": "Don&#39;t put the function definitions in a .cpp file, just put them in the class definition."}], "answers": [{"tags": [], "owner": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "is_accepted": false, "score": 0, "last_activity_date": 1474493890, "creation_date": 1474493890, "answer_id": 39626984, "question_id": 39626903, "link": "https://stackoverflow.com/questions/39626903/c-class-method-call-in-cpp-without/39626984#39626984", "title": "C++ class method call in .cpp without ::", "body": "<p>You can't avoid \"the <code>Point::Point</code> part,\" unless you declare the construction inline in the class declaration.  The first \"Point\" defines the scope of the function, and the second \"Point\" is the name of the constructor function.</p>\n\n<p>However, you could define the constructor(s) inline, like so:</p>\n\n<pre><code>class Point\n{\n  Point()\n  {\n    x = 0;\n    y = 0;\n  }\n  Point(int newX, int newY);\n  {\n    x = newX;\n    y = newY;\n  }\n  // ...\n};\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>class Point\n{\n  Point() : x(0), y(0) {}\n  Point(int newX, int newY) : x(newX), y(newY) {}\n  // ...\n};\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>class Point\n{\n  Point(int newX = 0, int newY = 0) : x(newX), y(newY) {}\n  // ...\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "is_accepted": false, "score": 1, "last_activity_date": 1474493967, "creation_date": 1474493967, "answer_id": 39626996, "question_id": 39626903, "link": "https://stackoverflow.com/questions/39626903/c-class-method-call-in-cpp-without/39626996#39626996", "title": "C++ class method call in .cpp without ::", "body": "<p>You aren't <em>required</em> to separate your declaration and definition, and these functions are incredibly trivial. So including them in the class definition may actually allow the compiler to perform numerous additional optimizations.</p>\n\n<p>So you could discard the .cpp entirely and the header becomes:</p>\n\n<pre><code>#ifndef POINT_H_\n#define POINT_H_\n\nclass Point\n{\n    int x_ { 0 };\n    int y_ { 0 };\n\npublic:\n    Point() = default;\n    Point(int x, int y) : x_(x), y_(y) {}\n\n    int getX() const { return x_; }\n    int getY() const { return y_; }\n    void setX(int x) { x_ = x; }\n    void setY(int y) { y_ = y; }\n    void moveBy(int x, int y) { x_ += x, y_ += y; }\n    Point reverse() const { return Point(y_, x_); }\n};\n\n#endif\n</code></pre>\n\n<p>But you can't avoid the \"Point::\" part when defining the members outside of the class declaration.</p>\n"}, {"tags": [], "owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "is_accepted": false, "score": 1, "last_activity_date": 1474494338, "creation_date": 1474494338, "answer_id": 39627067, "question_id": 39626903, "link": "https://stackoverflow.com/questions/39626903/c-class-method-call-in-cpp-without/39627067#39627067", "title": "C++ class method call in .cpp without ::", "body": "<p>If you want to avoid typing the \"<code>Point::</code>\" in front of the <code>getX</code>, <code>getY</code> etc., then the answer is <em>\"no\"</em>, unfortunately. In C++ and the name of any class (like \"<code>Point</code>\") is not a <em>namespace</em>, it's a <em>scope</em>.</p>\n\n<p>What you can only do is <em>inlining</em> the method, defining into the class declaration.</p>\n\n<pre><code>class Point {\n  public:\n    void a_method() {\n      // all the code here!\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 883, "user_id": 5749193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b8d54b2958b795cc4694215f9dd73f87?s=128&d=identicon&r=PG&f=1", "display_name": "dequec64", "link": "https://stackoverflow.com/users/5749193/dequec64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1474494338, "creation_date": 1474493524, "question_id": 39626903, "link": "https://stackoverflow.com/questions/39626903/c-class-method-call-in-cpp-without", "title": "C++ class method call in .cpp without ::", "body": "<p>I'm new to progamming in C++. I have a good background with Java but C++ is different on many things and I have a question about one of the regarding .h and .cpp files.</p>\n\n<p>I have the following files for a point object with x and y position:</p>\n\n<p>Point.h</p>\n\n<pre><code>#ifndef POINT_H_\n#define POINT_H_\n\nclass Point{\nPoint();\nPoint(int newX, int newY);\n\npublic:\n    int getX();\n    int getY();\n    void setX(int newX);\n    void setY(int newY);\n    void moveBy(int moveX, int moveY);\n    Point reverse();\nprivate:\n    int x;\n    int y;\n};\n#endif\n</code></pre>\n\n<p>Point.cpp</p>\n\n<pre><code>#include \"Point.h\"\n\nusing namespace Point;\n\nPoint::Point(int newX, int newY){\n    x = newX;\n    y = newY;\n}\nint Point::getX(){\n    return x;\n}\nint Point::getY(){\n    return y;\n}\nvoid Point::setX(int newX){\n    x = newX;\n}\nvoid Point::setY(int newY){\n    y = newY;\n}\nvoid Point::moveBy(int moveX, int moveY){\n    x += moveX;\n    y += moveY;\n}\nPoint Point::reverse(){\n    return Point(y,x);\n}\n</code></pre>\n\n<p>I was wondering if there was a way of avoinding the <code>Point::Point</code> part like with std::cout by using namespace.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c++", "language-lawyer", "virtual-functions", "dereference", "member-pointers"], "answers": [{"comments": [{"owner": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "edited": false, "score": 0, "creation_date": 1474494262, "post_id": 39626993, "comment_id": 66559593, "body": "So in other words the reason lays in precedence of the scope operator?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "edited": false, "score": 0, "creation_date": 1474494356, "post_id": 39626993, "comment_id": 66559629, "body": "@W.F.: Not at all. The reason is that the purpose of the scope resolution is to resolve scopes, but <code>foo_member</code> is already in the current scope, and <i>not</i> in the scope of <code>FooParent</code>. So if anything, the reason is perhaps your misunderstanding of the concept of a &quot;scope&quot;."}, {"owner": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "edited": false, "score": 0, "creation_date": 1474494724, "post_id": 39626993, "comment_id": 66559814, "body": "Maybe so... But the the concept limits possibility of direct access to virtual member functions using pointers..."}, {"owner": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "edited": false, "score": 0, "creation_date": 1474495017, "post_id": 39626993, "comment_id": 66559938, "body": "And yes you can say that the limit is there for a reason but hey in this case why to give this kind of access from outside overloaded function at all?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "edited": false, "score": 1, "creation_date": 1474495823, "post_id": 39626993, "comment_id": 66560219, "body": "Oh, wait, now I understand what you want to do: You want to perform the direct, static base function call without the virtual dispatch. I didn&#39;t get that in your original question. Let me think about that."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "edited": false, "score": 1, "creation_date": 1474496885, "post_id": 39626993, "comment_id": 66560558, "body": "@W.F.: I suppose it&#39;s the other way round: The feature to <i>disable</i> the virtual call mechanism only exists in the limited form of using the explicit qualification in the class member access expression, but not in the pointer-to-member expressions. (If you think that&#39;s a really useful and necessary feature, feel free to propose it as a language extension.)"}, {"owner": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "edited": false, "score": 0, "creation_date": 1474497184, "post_id": 39626993, "comment_id": 66560643, "body": "Actually I already knew about the lambda trick, just wanted to discuss the scope of scope :) I&#39;m not feeling very comfortable when the language limits me when I want to express some basic things... But I guess it&#39;s good there are workarounds to get rid of barriers :)"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "edited": false, "score": 1, "creation_date": 1474497386, "post_id": 39626993, "comment_id": 66560703, "body": "@W.F.: If you can, please keep track of how often this particular problem comes up over the next, say, three years. If you feel that the language would be significantly enriched if this were a feature, it&#39;s entirely feasible to propose this as an extension. We&#39;d mostly want to see good motivating cases where the existing solution is either unbearably worse, or where a core language feature would make code less error prone and easier to understand."}, {"owner": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "edited": false, "score": 0, "creation_date": 1474497467, "post_id": 39626993, "comment_id": 66560725, "body": "I understand. Thanks for your time and effort!"}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": true, "score": 4, "last_activity_date": 1474496120, "last_edit_date": 1474496120, "creation_date": 1474493941, "answer_id": 39626993, "question_id": 39626901, "link": "https://stackoverflow.com/questions/39626901/why-cant-one-use-scope-resolution-with-member-pointer-dereference/39626993#39626993", "title": "Why can&#39;t one use scope resolution with member pointer dereference?", "body": "<p>The name of the variable you declared is <code>foo_member</code>, inside your local block scope. It is <em>not</em> a name <code>Foo::foo_member</code>, i.e. the class <code>Foo</code> has no member <code>foo_member</code>. By contrast, the name <code>bar</code> lives in the scope of the class <code>Foo</code>, and also in the scope of the class <code>FooParent</code>.</p>\n\n<p>So the scope resolution mechanism works as expected: it resolves the scope.</p>\n\n<p>[<em>Update</em>:] There is no mechanism to disable virtual dispatch through a member function pointer. You can call a member function of the base subobject like this:</p>\n\n<pre><code> void (FooParent::*p)() = &amp;FooParent::bar;\n (static_cast&lt;FooParent&amp;&gt;(foo).*p)();\n</code></pre>\n\n<p>But the call still ends up getting dispatched virtually. The virtuality of the member function is baked into the member function pointer value. The next best thing you can do is to use a lambda:</p>\n\n<pre><code>auto q = [](FooParent &amp; f) { f.FooParent::bar(); };\nq(foo);\n</code></pre>\n"}], "owner": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 39626993, "answer_count": 1, "score": 1, "last_activity_date": 1474497154, "creation_date": 1474493519, "last_edit_date": 1474497154, "question_id": 39626901, "link": "https://stackoverflow.com/questions/39626901/why-cant-one-use-scope-resolution-with-member-pointer-dereference", "title": "Why can&#39;t one use scope resolution with member pointer dereference?", "body": "<p>Consider a simple example:</p>\n\n<pre><code>struct FooParent {\n   virtual void bar() { }\n};\n\nstruct Foo: FooParent {\n   void bar() { }\n};\n\nint main() {\n   Foo foo;\n   void (Foo::*foo_member)() = &amp;FooParent::bar;\n   //(foo.*FooParent::foo_member)();\n   foo.FooParent::bar();\n}\n</code></pre>\n\n<p>As you can see one can use scope resolution on the <code>foo</code> object when calling bar member function while there is no way to explicitly declare the scope for member function pointer. I accept that the syntax should be prohibited when using <code>-&gt;*</code> as the operator can be overloaded in sometimes unexpected way, but I cannot understand the reason behind preventing explicit scope resolution when dereferencing with <code>.*</code>.</p>\n\n<p>I am trying to disable virtual dispatch for a member pointer that points to a base class's virtual function.</p>\n"}, {"tags": ["c++", "wxwidgets", "scintilla", "wxstyledtextctrl"], "comments": [{"owner": {"reputation": 889, "user_id": 1521241, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/01090d621800a51df9188fc8cdb28178?s=128&d=identicon&r=PG", "display_name": "macroland", "link": "https://stackoverflow.com/users/1521241/macroland"}, "edited": false, "score": 0, "creation_date": 1474764006, "post_id": 39626899, "comment_id": 66664664, "body": "I should answer my question: Although it might not be the best approach, one way would be to inspect the lengths of RawText which is wxCharBuffer and the text is wxString. wxCharBuffer includes additional characters to accomodate non-ascii characters."}], "answers": [{"comments": [{"owner": {"reputation": 889, "user_id": 1521241, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/01090d621800a51df9188fc8cdb28178?s=128&d=identicon&r=PG", "display_name": "macroland", "link": "https://stackoverflow.com/users/1521241/macroland"}, "edited": false, "score": 0, "creation_date": 1474853433, "post_id": 39693145, "comment_id": 66686176, "body": "You are right about the <code>WordStartPosition</code> and <code>WordEndPosition</code>. However, <code>GetTextRange</code> did not work for me when there was non-ASCII in the text. <code>GetTextRangeRaw</code> seemed to be a better way to inspect non-ASCII as if you stream it to std::cout, you can see the non-ASCII characters."}], "tags": [], "owner": {"reputation": 1909, "user_id": 6846682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3c2ebd1b28002c046bf050077617596?s=128&d=identicon&r=PG&f=1", "display_name": "New Pagodi", "link": "https://stackoverflow.com/users/6846682/new-pagodi"}, "is_accepted": true, "score": 0, "last_activity_date": 1474849519, "creation_date": 1474849519, "answer_id": 39693145, "question_id": 39626899, "link": "https://stackoverflow.com/questions/39626899/wxstyledtextctrl-non-ascii-characters/39693145#39693145", "title": "wxStyledTextCtrl non ASCII characters", "body": "<p>You've probably answered this question by now, but in the experiments I've done, WordStartPosition and WordEndPosition still work with non-ASCII characters.  The data internally in the control is stored in UTF-8 format, and those functions give the number of bytes in that data where the word starts and ends.  If that's not what's happening for you, can you post a sample where they don't work?</p>\n\n<p>As for determining which characters are and aren't ASCII, something like the following seems to work (assuming a is the start and b is the end position):</p>\n\n<pre><code>wxString s = m_stc-&gt;GetTextRange(a,b);\n\nfor (wxString::const_iterator i = s.begin(); i != s.end(); ++i)\n{\n    wxUniChar uni_ch = *i;\n\n    if(uni_ch.IsAscii())\n    {\n        //something\n    }\n    else\n    {\n        //something else\n    }\n}\n</code></pre>\n\n<p>One thing I did notice is that if you use a value for a or b that falls in the middle of one of the non-ASCII characters, the resulting string will be empty.  I hope this of some help if you haven't already found a solution.</p>\n"}], "owner": {"reputation": 889, "user_id": 1521241, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/01090d621800a51df9188fc8cdb28178?s=128&d=identicon&r=PG", "display_name": "macroland", "link": "https://stackoverflow.com/users/1521241/macroland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 39693145, "answer_count": 1, "score": 0, "last_activity_date": 1474849519, "creation_date": 1474493509, "question_id": 39626899, "link": "https://stackoverflow.com/questions/39626899/wxstyledtextctrl-non-ascii-characters", "title": "wxStyledTextCtrl non ASCII characters", "body": "<p>I realized that in wxStyledTextCtrl if the user's comments  contains non-ASCII characters, the positions reported by <code>WordStartPosition</code> and <code>WordEndPosition</code> are wrong. What is a good way of dealing with non-ASCII characters in wxStyledTextCtrl? How can I identify the characters that are non-ASCII?</p>\n"}, {"tags": ["c++", "linux", "command-line-arguments"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 5, "creation_date": 1474492482, "post_id": 39626689, "comment_id": 66558764, "body": "&quot;I know that&quot; followed by unsubstantiated speculation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1474492642, "post_id": 39626689, "comment_id": 66558828, "body": "&quot;But has I tested, it is allowed to change argv[1] to &quot;/tmp/log/&quot; (size increased) in program.&quot; Yes, the C standards allow you to modify the strings pointed to by <code>argv</code> (<a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a>, section 5.1.2.2.1, clause 2, last constraint), but &quot;increasing their size&quot; is probably UB. You should assume that there is exactly as much modifiable <code>char[]</code> as there is a zero-terminated string."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1474492898, "post_id": 39626689, "comment_id": 66558954, "body": "If you <code>argv[1] = &quot;&#47;tmp&#47;log&quot;)</code>, you&#39;re not increasing the size of the string pointed to by <code>argv[1]</code>, you&#39;re replacing one pointer with another. I doubt that <code>strcat(argv[1], &quot;&#47;log&quot;)</code> would be as successful."}, {"owner": {"reputation": 99, "user_id": 6860767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985aa6798591be0c0519461ef769637b?s=128&d=identicon&r=PG&f=1", "display_name": "techiek7", "link": "https://stackoverflow.com/users/6860767/techiek7"}, "edited": false, "score": 0, "creation_date": 1474493181, "post_id": 39626689, "comment_id": 66559088, "body": "what about cin&gt;&gt;argv[1]. I mean I tested it. How does that work?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1474493224, "post_id": 39626689, "comment_id": 66559103, "body": "@techiek7 Is this a C or a C++ question?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1474493456, "post_id": 39626689, "comment_id": 66559224, "body": "@techiek7 That overwrites the string, so if the input is longer than the original argument, it will be UB."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 1, "creation_date": 1474493686, "post_id": 39626689, "comment_id": 66559328, "body": "I know that SO really loves to downvote people, but given that a platform was specified, and that that platform is open source, there is a verifiable answer to this question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1474494843, "post_id": 39626689, "comment_id": 66559865, "body": "&quot;But as I tested, it is allowed to change <code>argv[1]</code> to <code>&quot;&#47;tmp&#47;log&#47;&quot;</code>&quot; is a description of what you did.  Posting the <i>code</i> is better evidence and makes for a better question and answer.  It also adds clarity"}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1474494963, "post_id": 39626689, "comment_id": 66559914, "body": "@MooingDuck, argument passing is controlled by the kernel on Linux. It has no other dependency."}], "answers": [{"tags": [], "owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "is_accepted": false, "score": 1, "last_activity_date": 1474493840, "creation_date": 1474493840, "answer_id": 39626970, "question_id": 39626689, "link": "https://stackoverflow.com/questions/39626689/how-much-memory-is-allocated-for-argv/39626970#39626970", "title": "How much memory is allocated for argv[]?", "body": "<p>On Linux, parameters are populated by <a href=\"http://lxr.free-electrons.com/source/fs/binfmt_elf.c#L294\" rel=\"nofollow\"><code>create_elf_tables</code></a>. For this specific platform at least, you are correct that the values are stored on the stack.</p>\n\n<p>Linux only uses exactly as much memory as is necessary to store arguments and (initial) environment variables on the stack; if you try to use more than what is already there, you're overwriting something else (or crashing).</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1474494527, "post_id": 39626981, "comment_id": 66559716, "body": "Note you have referenced the <i>proposed</i> C standard."}], "tags": [], "owner": {"reputation": 750, "user_id": 607567, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2cdaf11bb9df57dba9722b7ca291ab17?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/607567/marco"}, "is_accepted": false, "score": 0, "last_activity_date": 1474493875, "creation_date": 1474493875, "answer_id": 39626981, "question_id": 39626689, "link": "https://stackoverflow.com/questions/39626689/how-much-memory-is-allocated-for-argv/39626981#39626981", "title": "How much memory is allocated for argv[]?", "body": "<p>The standard states that the argv can be modified since it is a special internal.</p>\n\n<p>177 \u2014  The parameters argc and argv and the strings pointed to by the argv array shall be modifiable by the program, and retain their last-stored values between program startup and program termination, so it is allocated only what you need at the assignment or replacement.</p>\n\n<p>Standard text:\n<a href=\"http://c0x.coding-guidelines.com/5.1.2.2.1.html\" rel=\"nofollow\">http://c0x.coding-guidelines.com/5.1.2.2.1.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 6860767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985aa6798591be0c0519461ef769637b?s=128&d=identicon&r=PG&f=1", "display_name": "techiek7", "link": "https://stackoverflow.com/users/6860767/techiek7"}, "edited": false, "score": 1, "creation_date": 1474521600, "post_id": 39627113, "comment_id": 66566443, "body": "This answers it very well. Additionally I tried to print 100 characters after starting address of argv[0][0].  Arguments and the environment are actually stored contiguously. Thank you."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 1, "last_activity_date": 1474495052, "last_edit_date": 1474495052, "creation_date": 1474494552, "answer_id": 39627113, "question_id": 39626689, "link": "https://stackoverflow.com/questions/39626689/how-much-memory-is-allocated-for-argv/39627113#39627113", "title": "How much memory is allocated for argv[]?", "body": "<p>To answer your question, the total maximum size available to argument strings and the passed environment can be obtained with:</p>\n\n<pre><code>getconf ARG_MAX\n</code></pre>\n\n<p>from the command line or the syconf equivalent from C (see <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/basedefs/limits.h.html\" rel=\"nofollow\">http://pubs.opengroup.org/onlinepubs/009695399/basedefs/limits.h.html</a> for more information).\n(On my Linux box, the limit is 2097152).</p>\n\n<p>Your example happens to work because the arguments and the environment are realistically stored contiguously, so appending to a string will overwrite what comes after it (following arguments, or the environment).\nAnd that's why it's a bad idea to try and expand the argv strings like that. If you want to modify them, either edit them or shrink them, but trying to expand them is a call for trouble.</p>\n"}], "owner": {"reputation": 99, "user_id": 6860767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985aa6798591be0c0519461ef769637b?s=128&d=identicon&r=PG&f=1", "display_name": "techiek7", "link": "https://stackoverflow.com/users/6860767/techiek7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 944, "favorite_count": 0, "closed_date": 1474496933, "accepted_answer_id": 39627113, "answer_count": 3, "score": 1, "last_activity_date": 1474495052, "creation_date": 1474492406, "last_edit_date": 1474493414, "question_id": 39626689, "link": "https://stackoverflow.com/questions/39626689/how-much-memory-is-allocated-for-argv", "closed_reason": "Duplicate", "title": "How much memory is allocated for argv[]?", "body": "<p>I know command line arguments are character arrays and they are stored on stack. But I want to know actual memory allocated for of each argument. e.g. suppose I passed directory name \"/tmp\" as command line argument. This will be stored in argv[1]. But as I tested, it is allowed to change argv[1] to \"/tmp/log/\" (size increased) in program. How is this possible ?</p>\n"}, {"tags": ["c++", "v8", "embedded-v8"], "answers": [{"comments": [{"owner": {"reputation": 2252, "user_id": 1672986, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e242f8881f17c6bc32f2ad1119e5ca24?s=128&d=identicon&r=PG", "display_name": "markt1964", "link": "https://stackoverflow.com/users/1672986/markt1964"}, "edited": false, "score": 0, "creation_date": 1474560725, "post_id": 39630744, "comment_id": 66591450, "body": "Thank you, although I just tried this suggestion, and unfortunately, it did not work.  I have updated the description above with the things that I have tried so far."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "reply_to_user": {"reputation": 2252, "user_id": 1672986, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e242f8881f17c6bc32f2ad1119e5ca24?s=128&d=identicon&r=PG", "display_name": "markt1964", "link": "https://stackoverflow.com/users/1672986/markt1964"}, "edited": false, "score": 1, "creation_date": 1474597715, "post_id": 39630744, "comment_id": 66606426, "body": "Chrome is multi-process, so they don&#39;t have to worry about javascript crashing a process.. since that&#39;s only for that one tab and it would be invalid anyhow."}, {"owner": {"reputation": 2252, "user_id": 1672986, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e242f8881f17c6bc32f2ad1119e5ca24?s=128&d=identicon&r=PG", "display_name": "markt1964", "link": "https://stackoverflow.com/users/1672986/markt1964"}, "edited": false, "score": 1, "creation_date": 1474609626, "post_id": 39630744, "comment_id": 66609504, "body": "Well... that&#39;s a bit of a b!tch... it means that v8 may not be the best choice for a js engine."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "reply_to_user": {"reputation": 2252, "user_id": 1672986, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e242f8881f17c6bc32f2ad1119e5ca24?s=128&d=identicon&r=PG", "display_name": "markt1964", "link": "https://stackoverflow.com/users/1672986/markt1964"}, "edited": false, "score": 1, "creation_date": 1474612121, "post_id": 39630744, "comment_id": 66610499, "body": "I would suggest posting to v8-users mailing list.  <a href=\"https://groups.google.com/forum/#!forum/v8-users\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!forum/v8-users</a>  if you don&#39;t I may.  What I read said that it would be difficult (lots of work, not necessarily technically difficult) to detect whether there is a &quot;real&quot; out of memory situation or a &quot;artificial&quot; (meaning exceedign some user-defined bound) out of memory situation  and behave differently in the two situations."}, {"owner": {"reputation": 2252, "user_id": 1672986, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e242f8881f17c6bc32f2ad1119e5ca24?s=128&d=identicon&r=PG", "display_name": "markt1964", "link": "https://stackoverflow.com/users/1672986/markt1964"}, "edited": false, "score": 0, "creation_date": 1474993668, "post_id": 39630744, "comment_id": 66757103, "body": "Wow... so it looks like the only thing that v8 is good for is running javascipr inside of a separate process, why even bother having isolates then?   It&#39;s a bizarre restriction because the OS is certainly capable of terminating the process if it consumes too much memory anyways, and a process can always artificially lower its own resource limits below what the OS allows it to.   I cannot for the life of me fathom why the response to what is detected as an OOM situation by v8 would not be simply responded to with an invocation of TerminateExcecution on the offending Isolate."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "reply_to_user": {"reputation": 2252, "user_id": 1672986, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e242f8881f17c6bc32f2ad1119e5ca24?s=128&d=identicon&r=PG", "display_name": "markt1964", "link": "https://stackoverflow.com/users/1672986/markt1964"}, "edited": false, "score": 1, "creation_date": 1475007674, "post_id": 39630744, "comment_id": 66765047, "body": "it was built to support chrome.   it works well for chrome."}, {"owner": {"reputation": 2252, "user_id": 1672986, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e242f8881f17c6bc32f2ad1119e5ca24?s=128&d=identicon&r=PG", "display_name": "markt1964", "link": "https://stackoverflow.com/users/1672986/markt1964"}, "edited": false, "score": 0, "creation_date": 1475773638, "post_id": 39630744, "comment_id": 67089127, "body": "Separate processes for each thread that needs js is simply infeasible for me because I would require a lot of communication between them and my main program instead of simply issuing function calls from custom native js functions running in different threads that are running javascript, each with their own isolate. I initially chose to use v8 in my project because it seemed to have what I needed, but I am only discovering some two years later or so that it is not. It&#39;s going to be painful changing to a new js engine now, but not as painful as dealing with a program that an end-user can crash."}], "tags": [], "owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "is_accepted": true, "score": 3, "last_activity_date": 1528505398, "last_edit_date": 1528505398, "creation_date": 1474521251, "answer_id": 39630744, "question_id": 39626567, "link": "https://stackoverflow.com/questions/39626567/how-to-tell-that-a-v8-isolate-instance-uses-too-much-memory/39630744#39630744", "title": "How to tell that a v8 isolate instance uses too much memory?", "body": "<p>Edit: authoritative response from the V8 team -- you can't.  But they'll accept a patch.</p>\n\n<p>v8::Isolate::SetFatalErrorHandler() should allow you to not crash.   But, my understanding is that the isolate is still unusable after the fact.  Probably no way of getting around that, since the isolate will be left in an unrecoverable statea.</p>\n\n<p><a href=\"http://v8.paulfryzel.com/docs/master/classv8_1_1_isolate.html#a131f1e2e6a80618ac3c8c266a041851d\" rel=\"nofollow noreferrer\">http://v8.paulfryzel.com/docs/master/classv8_1_1_isolate.html#a131f1e2e6a80618ac3c8c266a041851d</a></p>\n\n<p>(maybe.   there seems to be a lot of stuff going on about this in the 2013-2014 timeframe where people at google said the right thing to do was to just let v8 kill the process -- to which a lot of people thought was dumb.   I don't see any resolution)</p>\n\n<p>edit: Mailing list response was that you cannot do this.   They will accept a patch if it doesn't have a performance impact.</p>\n\n<p>edit: There was just another thread on this and someone posted what seems to be a pretty good way to avoid OOM in non-malicious situations:</p>\n\n<p><a href=\"https://groups.google.com/forum/#!topic/v8-users/vKn1hVs8KNQ\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/v8-users/vKn1hVs8KNQ</a></p>\n\n<blockquote>\n  <p>I set the heap limit to 8x the limit I actually want. Then, after each\n  call into the isolate, I check if the memory usage has gone over the\n  intended limit. If so, I invoke garbage collection. If it's <em>still</em>\n  over the limit after that, then I terminate the isolate at that point.</p>\n  \n  <p>Meanwhile, we also enforce a CPU time limit of 50ms. In practice, a\n  script that allocates tons of memory tends to run out of CPU time\n  before it can hit the 8x heap limit (especially as the GC slows things\n  down when approaching the limit).</p>\n</blockquote>\n"}], "owner": {"reputation": 2252, "user_id": 1672986, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e242f8881f17c6bc32f2ad1119e5ca24?s=128&d=identicon&r=PG", "display_name": "markt1964", "link": "https://stackoverflow.com/users/1672986/markt1964"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 790, "favorite_count": 0, "accepted_answer_id": 39630744, "answer_count": 1, "score": 4, "last_activity_date": 1528505398, "creation_date": 1474491855, "last_edit_date": 1474560498, "question_id": 39626567, "link": "https://stackoverflow.com/questions/39626567/how-to-tell-that-a-v8-isolate-instance-uses-too-much-memory", "title": "How to tell that a v8 isolate instance uses too much memory?", "body": "<p>I am using Google's v8 engine for embedding javascript in my application.  At certain times, I will be invoking user-supplied code, and I want to ensure that it does not behave badly by allocating too much memory.   Currently, when the javascript tries to make or resize an array to be too large, for example, I get an unceremonious message:</p>\n\n<pre><code>#\n# Fatal error in CALL_AND_RETRY_LAST\n# Allocation failed - process out of memory\n#\n</code></pre>\n\n<p>And then entire process crashes with a SIGILL.   Obviously, this is not acceptable.  I require the ability to run user-supplied code, however... and it is not feasible to manually vet all code before it is executed by the engine.</p>\n\n<p>What I would ideally like to do in this case is simply terminate the isolate that was consuming too much memory (without affecting any other isolates that may be running).  Is there any way to designate a maximum amount of memory that a js program is allowed to use before it fails, and so if it exceeds that limit, instead of crashing the process, the invocation of the Run or Call commands would simply return an error or set some status flag indicating that it was abnormally terminated.</p>\n\n<p>Things I have tried so far:</p>\n\n<p>Setting a custom array_buffer allocator when the isolate is created, which tracks how much memory is being used and terminates the isolate when the memory usage gets too high>   The Allocate function of my allocator does not ever get called.</p>\n\n<p>Calling AddMemoryAllocationCallback with a function that tracks memory usage and tries to terminate the isolate via TerminateExecution() when the allocations exceeds a certain amount.  This function does get called, but I get an out of memory error after this function only has reported a couple of megabytes being used, while I know for a fact that the data being created by the bad behaving v8 function is <em>FAR</em> larger than that.</p>\n\n<p>Setting a fatal error handler via SetFatalErrorHandler and trying to invoke TerminateExecution there.   This function does get called, but it does not prevent the process from crashing.</p>\n\n<p>Is there anything else I can try?</p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474491920, "post_id": 39626565, "comment_id": 66558456, "body": "And your question is actually?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474492047, "post_id": 39626565, "comment_id": 66558525, "body": "If your file contains values in text format, you may want to use <code>ifile &gt;&gt; result;</code>."}, {"owner": {"reputation": 7, "user_id": 6733872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02d6090523add61a032a5bf106aca3e?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan958", "link": "https://stackoverflow.com/users/6733872/rayan958"}, "edited": false, "score": 0, "creation_date": 1474492058, "post_id": 39626565, "comment_id": 66558536, "body": "How can I do this, retrieve line by line 3 values by 3 values?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1474492132, "post_id": 39626565, "comment_id": 66558583, "body": "what is &quot;3 values by 3 values&quot; ? Maybe it would help if you outline the format of the data in the file"}, {"owner": {"reputation": 7, "user_id": 6733872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02d6090523add61a032a5bf106aca3e?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan958", "link": "https://stackoverflow.com/users/6733872/rayan958"}, "edited": false, "score": 0, "creation_date": 1474492182, "post_id": 39626565, "comment_id": 66558612, "body": "first line 4 5 6 5 6 7 8 9 0 second line 4 5 2 3 4 5 6 8 0 and have 4 5 6 after 5 6 7 after 8 9 0 at the first line . The same way for the second line"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474492260, "post_id": 39626565, "comment_id": 66558653, "body": "You could search the internet for &quot;c++ read file matrix&quot;."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1474492267, "post_id": 39626565, "comment_id": 66558657, "body": "The notation <code>(image)[i][j]</code> is not exactly wrong, but it is not the way you should be writing array access; you should use just <code>image[i][j]</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1474492308, "post_id": 39626565, "comment_id": 66558679, "body": "Please edit your sample data and discussion about it into the question where you can format it (you can, and should, edit your own question).  What do you want to happen if the first line contains 4 values instead of 3?  If it contains 2 values instead of 3?  Or, given the comments about 9 values on the first line, what should happen if there are just 8 values, or 10 values?  It seems clear to me that you should be reading a line into a string and then parsing the string, rather than reading values one at a time because that doesn&#39;t care about line boundaries."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1474492345, "post_id": 39626565, "comment_id": 66558702, "body": "so each line in the file is a 3x3 matrix ?"}], "answers": [{"tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 1, "last_activity_date": 1474492403, "creation_date": 1474492403, "answer_id": 39626688, "question_id": 39626565, "link": "https://stackoverflow.com/questions/39626565/read-array-line-by-line-3-values-by-3-values/39626688#39626688", "title": "Read array line by line 3 values by 3 values", "body": "<p>Try this:</p>\n\n<pre><code>for (unsigned int row = 0; row &lt; 3; ++row)\n{\n    for (unsigned int column = 0; column &lt; 3; ++column)\n    {\n        inFile &gt;&gt; image[row][column];\n    }\n}\n</code></pre>\n\n<p>Since your values are separated by \"white space\", which is spaces, tabs or newlines, this should work regardless of whether all values are on one line or many.</p>\n\n<p><strong>Edit 1: A safer alternative</strong><br>\nThe above assumes there is always 9 values and they are all valid integers.\nIf something goes awry, the above won't work.  The following is a more robust method.</p>\n\n<pre><code>unsigned int row = 0;\nunsigned int column = 0;\nbool all_values_read = false;\nint value = 0;\nwhile ((inFile &gt;&gt; value) &amp;&amp; !all_values_read)\n{\n  image[row][column] = value;\n  ++column;\n  if (column &gt;= 3)\n  {\n      column = 0;\n      ++row;\n      if (row &gt;= 3)\n      {\n         all_values_read = true;\n      }\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 514, "user_id": 3796896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e336ab34fb3526b8f5f1edc5099bdb?s=128&d=identicon&r=PG&f=1", "display_name": "acornagl", "link": "https://stackoverflow.com/users/3796896/acornagl"}, "edited": false, "score": 0, "creation_date": 1474492681, "post_id": 39626704, "comment_id": 66558847, "body": "Of course, you need also to provide all the necessary checks. The attached code is just an idea!"}, {"owner": {"reputation": 7, "user_id": 6733872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02d6090523add61a032a5bf106aca3e?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan958", "link": "https://stackoverflow.com/users/6733872/rayan958"}, "edited": false, "score": 0, "creation_date": 1474492681, "post_id": 39626704, "comment_id": 66558848, "body": "no count++ please?"}, {"owner": {"reputation": 514, "user_id": 3796896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e336ab34fb3526b8f5f1edc5099bdb?s=128&d=identicon&r=PG&f=1", "display_name": "acornagl", "link": "https://stackoverflow.com/users/3796896/acornagl"}, "reply_to_user": {"reputation": 7, "user_id": 6733872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02d6090523add61a032a5bf106aca3e?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan958", "link": "https://stackoverflow.com/users/6733872/rayan958"}, "edited": false, "score": 0, "creation_date": 1474492746, "post_id": 39626704, "comment_id": 66558896, "body": "Feel free to edit ;)"}], "tags": [], "owner": {"reputation": 514, "user_id": 3796896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e336ab34fb3526b8f5f1edc5099bdb?s=128&d=identicon&r=PG&f=1", "display_name": "acornagl", "link": "https://stackoverflow.com/users/3796896/acornagl"}, "is_accepted": false, "score": 0, "last_activity_date": 1474492522, "creation_date": 1474492522, "answer_id": 39626704, "question_id": 39626565, "link": "https://stackoverflow.com/questions/39626565/read-array-line-by-line-3-values-by-3-values/39626704#39626704", "title": "Read array line by line 3 values by 3 values", "body": "<p>You could implement something like follows:</p>\n\n<pre><code>int count = 0;\nfor(int i=0; i&lt;_height; i++) {\n    for(int j=0; j&lt;_width; j = j +3) {\n        result = ifile.get(i,j);\n        (image)[i][count]= (int)result;\n        count += 1;\n        // Display the array which contains data\n        cout &lt;&lt; (image)[i][count] &lt;&lt; \" \";\n    }\n    count = 0;\n    cout &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Where the <code>get(int i, int j)</code> function is a function that recovers the three values (or less if the line ends before <code>j+3</code>) starting from the position <code>j</code> of the <code>i-th</code> row.</p>\n"}], "owner": {"reputation": 7, "user_id": 6733872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02d6090523add61a032a5bf106aca3e?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan958", "link": "https://stackoverflow.com/users/6733872/rayan958"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1474503591, "answer_count": 2, "score": -2, "last_activity_date": 1474494453, "creation_date": 1474491852, "last_edit_date": 1474492205, "question_id": 39626565, "link": "https://stackoverflow.com/questions/39626565/read-array-line-by-line-3-values-by-3-values", "closed_reason": "Needs details or clarity", "title": "Read array line by line 3 values by 3 values", "body": "<p>I want to read my array line by line 3 values by 3 values. So when I recover 3 values put in my matrix etc etc...</p>\n\n<pre><code>for(int i=0; i&lt;_height; i++) {\n    for(int j=0; j&lt;_width; j++) {\n        result = ifile.get();\n        (image)[i][j]= (int)result;\n        // Display the array which contains data\n        cout &lt;&lt; (image)[i][j] &lt;&lt; \" \";\n    }\n    cout &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-c++", "intel-pin"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1474494474, "post_id": 39626443, "comment_id": 66559688, "body": "That code is rather brutally unfriendly to C++.  Why you&#39;d consider compiling it with /clr in effect is very hard to guess.  You just can&#39;t."}, {"owner": {"reputation": 1051, "user_id": 2093195, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d3c2c0866e1e1d5935b70f59fcf7fbc?s=128&d=identicon&r=PG", "display_name": "Heyji", "link": "https://stackoverflow.com/users/2093195/heyji"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1474538084, "post_id": 39626443, "comment_id": 66575722, "body": "@Hans Passant: I edited the question. I did not compiled it with /clr, but with /clr:oldSyntax, as requested by the compiler."}], "answers": [{"tags": [], "owner": {"reputation": 1051, "user_id": 2093195, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d3c2c0866e1e1d5935b70f59fcf7fbc?s=128&d=identicon&r=PG", "display_name": "Heyji", "link": "https://stackoverflow.com/users/2093195/heyji"}, "is_accepted": true, "score": 0, "last_activity_date": 1474569530, "creation_date": 1474569530, "answer_id": 39646553, "question_id": 39626443, "link": "https://stackoverflow.com/questions/39626443/pin-3-0-compilation-error-because-of-value-symbol/39646553#39646553", "title": "PIN 3.0 compilation error because of &#39;__value&#39; symbol", "body": "<p>This is apparently a \"bug\" in visual c++ as reported <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/adabf801-8006-47bd-9495-972e04df5c78/use-of-value-as-a-variable-name-in-unmanaged-c-code?forum=vcgeneral\" rel=\"nofollow\">here</a></p>\n\n<p>The solution is to add the following preprocessor definition:</p>\n\n<pre><code>/D__value=_value\n</code></pre>\n"}], "owner": {"reputation": 1051, "user_id": 2093195, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d3c2c0866e1e1d5935b70f59fcf7fbc?s=128&d=identicon&r=PG", "display_name": "Heyji", "link": "https://stackoverflow.com/users/2093195/heyji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 39646553, "answer_count": 1, "score": 0, "last_activity_date": 1474569530, "creation_date": 1474491361, "last_edit_date": 1474538227, "question_id": 39626443, "link": "https://stackoverflow.com/questions/39626443/pin-3-0-compilation-error-because-of-value-symbol", "title": "PIN 3.0 compilation error because of &#39;__value&#39; symbol", "body": "<p>I am porting my tool to PIN 3.0 using Visual c++ 2012 because I now have Windows 10. I followed the porting guide provided <a href=\"https://software.intel.com/sites/default/files/managed/8e/f5/PinCRT.pdf\" rel=\"nofollow\">here</a></p>\n\n<p>However, I ran into an error: </p>\n\n<pre><code>error C4890: '__value': use of this keyword requires the command line option: /clr:oldSyntax\n</code></pre>\n\n<p>When turning this /clr:oldSyntax option on, plus adding RTTI availability (/GR instead of /GR-) as otherwise it is not compatible with /clr:oldSyntax, I get more or less the same issue: </p>\n\n<pre><code>error C2059: syntax error: '__value'\n</code></pre>\n\n<p>this error is located in the file type_trait.h (header file of the PIN 3.0 Library)</p>\n\n<pre><code>#ifdef _STLP_STATIC_CONST_INIT_BUG\n    static const bool __value;\n#else\n    static const bool __value = sizeof(__test&lt;_Tp&gt;(0)) == sizeof(__select_types::__t1);\n#endif\n</code></pre>\n\n<p>Is this a common issue, and if so is there any workaround ? Or did I missed something in the porting guide ? I understand that the name __value introduced in this PIN 3.0 header is in conclict. </p>\n"}, {"tags": ["c++", "parsing", "yaml-cpp"], "comments": [{"owner": {"reputation": 29797, "user_id": 112, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8cff214f16c7c8e73244a8ed8dea7e0e?s=128&d=identicon&r=PG", "display_name": "Jesse Beder", "link": "https://stackoverflow.com/users/112/jesse-beder"}, "edited": false, "score": 1, "creation_date": 1474552086, "post_id": 39626433, "comment_id": 66585179, "body": "Did you solve this? If so, you can actually write an answer below and mark it &quot;accepted&quot;."}, {"owner": {"reputation": 47, "user_id": 2452959, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WUfrQ.jpg?s=128&g=1", "display_name": "CompSciGuy139", "link": "https://stackoverflow.com/users/2452959/compsciguy139"}, "reply_to_user": {"reputation": 29797, "user_id": 112, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8cff214f16c7c8e73244a8ed8dea7e0e?s=128&d=identicon&r=PG", "display_name": "Jesse Beder", "link": "https://stackoverflow.com/users/112/jesse-beder"}, "edited": false, "score": 0, "creation_date": 1475679550, "post_id": 39626433, "comment_id": 67041599, "body": "Sorry, I was on vacation.  I did and I will.  Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 2452959, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WUfrQ.jpg?s=128&g=1", "display_name": "CompSciGuy139", "link": "https://stackoverflow.com/users/2452959/compsciguy139"}, "is_accepted": true, "score": 0, "last_activity_date": 1475680288, "creation_date": 1475680288, "answer_id": 39877758, "question_id": 39626433, "link": "https://stackoverflow.com/questions/39626433/yams-cpp-nested-sequence-returning-map-instead-of-value/39877758#39877758", "title": "yams-cpp nested sequence returning map instead of value", "body": "<p>The answer that I found rests in that I was unclear on what I was getting.</p>\n\n<p>In the <code>config.yaml</code> file I was expecting the following:</p>\n\n<pre><code>foo.Type() == Map\nbar.Type() == Sequence\nbaz.Type() == Sequence\n</code></pre>\n\n<p>but what I was getting was:</p>\n\n<pre><code>foo.Type() == Map\nbar.Type() == Map\nbaz.Type() == Sequence\n</code></pre>\n\n<p>all I had to do to resolve this issue was to change the config file.</p>\n\n<pre><code>foo:\n  bar:\n    - baz: [1, 2, 3, 4]\n    - bam: \"some_string_value\"\n</code></pre>\n\n<p>Then it parsed exactly as I had expected.  </p>\n\n<p>So the issue was the format of the config file and not in the parsing logic.</p>\n"}], "owner": {"reputation": 47, "user_id": 2452959, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WUfrQ.jpg?s=128&g=1", "display_name": "CompSciGuy139", "link": "https://stackoverflow.com/users/2452959/compsciguy139"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 39877758, "answer_count": 1, "score": 0, "last_activity_date": 1475680288, "creation_date": 1474491330, "last_edit_date": 1474496193, "question_id": 39626433, "link": "https://stackoverflow.com/questions/39626433/yams-cpp-nested-sequence-returning-map-instead-of-value", "title": "yams-cpp nested sequence returning map instead of value", "body": "<p>I am trying to parse the following config.yaml file. </p>\n\n<p><code>config.yaml</code></p>\n\n<pre><code>foo:\n  bar:\n    baz: [1, 2, 3, 4]\n    bam: \"some_string_value\"\n</code></pre>\n\n<p><code>test.cpp</code></p>\n\n<pre><code>YAML::Node configObj = YAML::LoadFile(\"cfig.yaml\"); // loads file just fine\n\nYAML::Node fooObj = configObj[\"foo\"]; // this Node object is a Map\n\n// iterate over foo node to get bar node\nfor( auto it = fooObj.begin(); it != fooObj.end(); ++it){\n    YAML::Node barMap = it-&gt;second; // this Node object is a Map\n\n    // iterate over bar node to get bad node\n    for( auto i = barMap.begin(); i != barMap.end(); ++i){\n        YAML::Node bazMap = i-&gt;second; // this node is a sequence\n\n        for( std::size_t i=0; i&lt;bazMap.size(); i++         \n            auto index = bazMap[i].as&lt;int&gt;(); // &lt;&lt;&lt; This is the problem\n        }\n    }\n}\n</code></pre>\n\n<p>The problem as far as I can see is that I am expecting index to be an int but <code>bazMap[i].as&lt;int&gt;()</code> I am expecting to be 1 the first loop, 2 the second, etc.  What I am getting instead is <code>bazMap[i].as&lt;int&gt;()</code> is of type map.  What am I missing in my understanding here?</p>\n\n<p>Thanks,</p>\n\n<p>Bruce</p>\n\n<p><strong>Update</strong> The answer was that I stopped early in my nested for loops.  </p>\n"}, {"tags": ["c++", "c++11", "boost", "c++14"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1474490863, "post_id": 39626291, "comment_id": 66557903, "body": "Looks legit. The usual warning applies that <code>T::op</code> needs to be correct when called concurrently."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1474490958, "post_id": 39626291, "comment_id": 66557963, "body": "But the shared_ptr is never initialized to anything? And you&#39;re forced to do it at file-level scope?"}, {"owner": {"reputation": 8259, "user_id": 989331, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c4c3527050ad17163da4b5c459ee46?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/989331/martin"}, "edited": false, "score": 0, "creation_date": 1474491050, "post_id": 39626291, "comment_id": 66558002, "body": "all the variables are initialized in the real program."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1474491335, "post_id": 39626291, "comment_id": 66558151, "body": "yes, it&#39;s fine. the reference counting in the shared_ptr is atomic and the locked copy stays in scope for the duration of the op, so the object can&#39;t be destroyed during the op. You can probably do away with the mutex by using the atomic_swap/atomic_load and atomic_store overloads for shared_ptr&lt;&gt;. Need to think about that before I put it in an answer though."}, {"owner": {"reputation": 8259, "user_id": 989331, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c4c3527050ad17163da4b5c459ee46?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/989331/martin"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474491901, "post_id": 39626291, "comment_id": 66558441, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 read the code in the example better. It&#39;s minimal, complete and verified. It&#39;s just not the real case."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474492110, "post_id": 39626291, "comment_id": 66558574, "body": "@Martin At least I can <a href=\"http://coliru.stacked-crooked.com/a/d6515265d766e8da\" rel=\"nofollow noreferrer\">confirm that</a>.I just said such statement smells fishy."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474492739, "post_id": 39626291, "comment_id": 66558890, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 It doesn&#39;t initialize <code>t</code>, so the weak_ptr.lock always fails, but also a quick look at godbolt shows that the compiler eliminates the call to <code>op()</code> entirely, so even if it didn&#39;t fail we couldn&#39;t disambiguate. <i>HOWEVER</i> I think for the purposes of annotating the question it&#39;s fine. I&#39;m only making these points to clarify that @Martin should not rely on this code as a proof..."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1474493555, "post_id": 39626291, "comment_id": 66559271, "body": "@kfsone I said it smells fishy :)"}], "answers": [{"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 1, "last_activity_date": 1474491987, "creation_date": 1474491987, "answer_id": 39626599, "question_id": 39626291, "link": "https://stackoverflow.com/questions/39626291/synchronous-destruction-through-stdshared-ptrtreset/39626599#39626599", "title": "Synchronous destruction through std::shared_ptr&lt;T&gt;::reset()", "body": "<p>Yes, it's fine. The reference counting in the shared_ptr is atomic and the locked copy stays in scope for the duration of the op, so the object can't be destroyed during the op.</p>\n\n<p>In this case the mutex is not actually protecting the lifetime of T, but sequencing calls to <code>op()</code> and destruction. If you don't mind multiple concurrent calls to <code>op()</code>, or the destruction time being indeterminate (i.e. after the last running <code>op()</code> has completed) then you can do away with it, since <code>std::shared_ptr&lt;&gt;::reset()</code> and <code>std::weak_ptr&lt;&gt;::lock()</code> are both thread-safe.</p>\n\n<p>However, I would advise caution as the author clearly meant for calls to <code>op()</code> to be serialised.</p>\n"}], "owner": {"reputation": 8259, "user_id": 989331, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c4c3527050ad17163da4b5c459ee46?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/989331/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 39626599, "answer_count": 1, "score": 1, "last_activity_date": 1474491987, "creation_date": 1474490746, "last_edit_date": 1474491787, "question_id": 39626291, "link": "https://stackoverflow.com/questions/39626291/synchronous-destruction-through-stdshared-ptrtreset", "title": "Synchronous destruction through std::shared_ptr&lt;T&gt;::reset()", "body": "<p>Consider the following simplified program modelling a real scenario where different users can make concurrent requests to the same resource:</p>\n\n<pre><code>#include &lt;thread&gt;\n#include &lt;memory&gt;\n#include &lt;mutex&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nstruct T {\n    void op() { /* some stuff */ }\n    ~T() noexcept { /* some stuff */ }\n};\n\nstd::shared_ptr&lt;T&gt; t;\nstd::mutex mtx;\nstd::weak_ptr&lt;T&gt; w{t};\nenum action { destroy, op};\n\nvoid request(action a) {\n    if (a == action::destroy) {\n        lock_guard&lt;mutex&gt; lk{mtx};\n        t.reset();\n        std::cout &lt;&lt; \"*t certainly destroyed\\n\";\n    } else if (a == action::op) {\n        lock_guard&lt;mutex&gt; lk{mtx};\n        if (auto l = w.lock()) {\n            l-&gt;op();\n        }\n    }\n}\n\nint main() {\n    // At some point in time and different points in the program,\n    // two different users make two different concurrent requests\n    std::thread th1{request, destroy}; std::thread th2{request, op};\n\n    // ....\n    th2.join();\n    th1.join();\n}\n</code></pre>\n\n<p>I am not asking if the program is formally correct - I think it is, but I have never seen this approach for guaranteeing a <strong>synchronous destruction</strong> of a resource shared via smart pointers. I personally think it is fine and has a valid use.</p>\n\n<p>However, I am wondering if others think the same and, in case, if there are more elegant alternatives apart from the classic synchronization with <code>unique_lock</code>s and condition variables and from introducing modifications (e.g. atomic flags) to <code>T</code>.</p>\n\n<p>It would be ideal if I could even get rid of the <code>mtx</code> somehow.</p>\n"}, {"tags": ["c++", "macos", "openssl", "linker-errors"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1474495677, "post_id": 39626170, "comment_id": 66560171, "body": "You should state your linker error rather than printing your OpenSSL version. After <code>sudo make install</code>, run <code>sudo ln -s &#47;usr&#47;local&#47;ssl&#47;macos-x86_64&#47;bin&#47;openssl &#47;usr&#47;local&#47;bin&#47;openssl</code>. That should put your <code>openssl</code> program on-path. If you are compiling and linking, then the headers are located at <code>&#47;usr&#47;local&#47;ssl&#47;macos-x86_64&#47;include</code>, and the libraries are located at <code>&#47;usr&#47;local&#47;ssl&#47;macos-x86_64&#47;lib</code>. Use them in your <code>CFLAGS</code> and <code>LDFLAGS</code>."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1474616698, "post_id": 39626170, "comment_id": 66613176, "body": "<b><i><code>Operation not permitted</code></i></b> - you need to state more about your setup and problem. <a href=\"http://www.google.com/search?q=&quot;Operation+not+permitted&quot;+linker\" rel=\"nofollow noreferrer\">&quot;Operation not permitted&quot; linker</a> sems to indicate it has something to do with C++11 and multi-threading. I fail to see what that has to do with OpenSSL. I don&#39;t normally ask for one, but you probably need to follow <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1474616908, "post_id": 39626170, "comment_id": 66613301, "body": "Also see <a href=\"http://stackoverflow.com/q/8649828\">What is the correct link options to use std::thread in GCC under linux?</a> and <a href=\"http://stackoverflow.com/q/7090623\">C++0x thread static linking problem</a>. I&#39;m guessing your issue and the cited questions have a lot in common."}], "owner": {"reputation": 1880, "user_id": 2001811, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/8GTU7.jpg?s=128&g=1", "display_name": "blue_zinc", "link": "https://stackoverflow.com/users/2001811/blue-zinc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 405, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474617052, "creation_date": 1474490307, "last_edit_date": 1474617052, "question_id": 39626170, "link": "https://stackoverflow.com/questions/39626170/operation-not-permitted-when-linking-openssl-1-1-0-on-os-x", "title": "&quot;Operation not permitted&quot; when linking OpenSSL 1.1.0 on OS X", "body": "<p>I built OpenSSL 1.1.0 on OS X:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>./Configure darwin64-x86_64-cc shared enable-ec_nistp_64_gcc_128 \\\n    no-ssl2 no-ssl3 no-comp --openssldir=/usr/local/ssl/macos-x86_64\nmake depend\nsudo make install\n</code></pre>\n\n<p>I'm having trouble linking this in my system. It's still showing me an older version.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>openssl version\nOpenSSL 1.0.2h  3 May 2016\n\n-rwxr-xr-x   1 root   wheel    922496 Jul  8 22:51 openssl\n</code></pre>\n\n<p>The linking error I get is:</p>\n\n<pre><code>Operation not permitted\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c++", "boost"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1474489543, "post_id": 39625804, "comment_id": 66557192, "body": "So you want a circular log buffer? If so, then write a log class that will do that - wrap around at 1000 lines and start overwriting the first ones. A :std::vector would do, so would a std::array and a number of other classes. But <i>you</i> need to manage the wrap-around/circular logic. It&#39;s not rocket sience though; fairly simple to implement - just wrap your writing offset at 1000 lines back to the beginning."}, {"owner": {"reputation": 303, "user_id": 5176361, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a9bc72bffc79050d52ada840987533c1?s=128&d=identicon&r=PG", "display_name": "Cibin William", "link": "https://stackoverflow.com/users/5176361/cibin-william"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1474492540, "post_id": 39625804, "comment_id": 66558790, "body": "@jesper Thanks for the reply.Can you suggest any link.ilike to do it with boost log.ya you areare right I need circular log buffer."}, {"owner": {"reputation": 303, "user_id": 5176361, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a9bc72bffc79050d52ada840987533c1?s=128&d=identicon&r=PG", "display_name": "Cibin William", "link": "https://stackoverflow.com/users/5176361/cibin-william"}, "edited": false, "score": 0, "creation_date": 1474492711, "post_id": 39625804, "comment_id": 66558864, "body": "@Eichhornchen Thanks for the reply.Ya you are right ,no need of opencv tag here.I removed it.I need circular buffer log using boost log"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1474492714, "post_id": 39625804, "comment_id": 66558867, "body": "Why the insistance on boost::log?"}, {"owner": {"reputation": 303, "user_id": 5176361, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a9bc72bffc79050d52ada840987533c1?s=128&d=identicon&r=PG", "display_name": "Cibin William", "link": "https://stackoverflow.com/users/5176361/cibin-william"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1474513604, "post_id": 39625804, "comment_id": 66564349, "body": "@jesper  I am working in opencv project,I already used boost in the project .so I insisit boost::log."}, {"owner": {"reputation": 303, "user_id": 5176361, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a9bc72bffc79050d52ada840987533c1?s=128&d=identicon&r=PG", "display_name": "Cibin William", "link": "https://stackoverflow.com/users/5176361/cibin-william"}, "edited": false, "score": 0, "creation_date": 1474521514, "post_id": 39625804, "comment_id": 66566419, "body": "or else please suggest any efficicient circular buffer log"}], "owner": {"reputation": 303, "user_id": 5176361, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a9bc72bffc79050d52ada840987533c1?s=128&d=identicon&r=PG", "display_name": "Cibin William", "link": "https://stackoverflow.com/users/5176361/cibin-william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474492585, "creation_date": 1474488886, "last_edit_date": 1474492585, "question_id": 39625804, "link": "https://stackoverflow.com/questions/39625804/in-boost-log-keywordrotation-size-when-adding-new-lines-how-to-delete-the-fir", "title": "In boost log keyword::rotation_size ,when adding new lines how to delete the first line", "body": "<p>What I do:</p>\n\n<p>1.I added log file to my c++ code with reference to the link <a href=\"http://www.boost.org/doc/libs/1_54_0/libs/log/example/doc/tutorial_file.cpp\" rel=\"nofollow\">http://www.boost.org/doc/libs/1_54_0/libs/log/example/doc/tutorial_file.cpp</a>.</p>\n\n<p>2.The log file is generated ,and when it reach the maximum rotation_size ,the whole line deleted and started from first.</p>\n\n<p>What I need to do:</p>\n\n<p>1.I need to add log in to the log file ,so that if I add 1000 lines (which reaches maximum rotation_size).when I add the next line (1001th line), I don't want to clear all the 1000 lines added before.I want to delete only the first line and want the latest 1000 lines.</p>\n\n<p>How to do that?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1474488875, "post_id": 39625767, "comment_id": 66556824, "body": "Do a minimum of research before posting a new question here please!"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 5, "creation_date": 1474488908, "post_id": 39625767, "comment_id": 66556846, "body": "<code>||</code> does not work the way you think!"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1545977140, "post_id": 39625767, "comment_id": 94746880, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3217842/c-program-converts-fahrenheit-to-celsius\">C++ program converts fahrenheit to celsius</a>"}], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474488970, "post_id": 39625792, "comment_id": 66556884, "body": "Wouldn&#39;t a comment suffice? How does this relate to the question title?"}, {"owner": {"reputation": 9, "user_id": 6850319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3787e04c870e9248075cd1da681e8649?s=128&d=identicon&r=PG&f=1", "display_name": "chris free", "link": "https://stackoverflow.com/users/6850319/chris-free"}, "edited": false, "score": 0, "creation_date": 1474489005, "post_id": 39625792, "comment_id": 66556905, "body": "Thank you my friend"}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1474489035, "post_id": 39625792, "comment_id": 66556928, "body": "It spells out that the code posted wasn&#39;t doing what the OP thought it was."}, {"owner": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "edited": false, "score": 1, "creation_date": 1474491568, "post_id": 39625792, "comment_id": 66558274, "body": "Or <code>if (toupper(unit) == &#39;C&#39;)</code>.  Or even <code>if (strchr(&quot;Cc&quot;, unit))</code>."}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1474491689, "post_id": 39625792, "comment_id": 66558334, "body": "Yes any of those would be better."}], "tags": [], "owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "is_accepted": false, "score": 3, "last_activity_date": 1474488847, "creation_date": 1474488847, "answer_id": 39625792, "question_id": 39625767, "link": "https://stackoverflow.com/questions/39625767/c-fahrenheit-or-celsius-converter/39625792#39625792", "title": "c++ Fahrenheit or Celsius converter", "body": "<p>This might work better:</p>\n\n<pre><code>if ( unit == 'c' || unit == 'C')\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6850319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3787e04c870e9248075cd1da681e8649?s=128&d=identicon&r=PG&f=1", "display_name": "chris free", "link": "https://stackoverflow.com/users/6850319/chris-free"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1510822508, "creation_date": 1474488788, "last_edit_date": 1510822508, "question_id": 39625767, "link": "https://stackoverflow.com/questions/39625767/c-fahrenheit-or-celsius-converter", "title": "c++ Fahrenheit or Celsius converter", "body": "<p>Hi Just wondering why this is not working, as of right now it prints out just the Fahrenheit one no matter if i select c or f. plz help</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main()\n{\n\n    char unit;\n    float degrees = 0.0;\n    float Farenheit, Celsius;\n\n   cout &lt;&lt; \"Enter the temperature unit you are currently in (f or c): \";\n   cin &gt;&gt; unit;\n   cout &lt;&lt; \"Enter the temperature in degrees: \";\n   cin &gt;&gt; degrees;\n\n   if ( unit == 'c' || 'C')\n   {\n      Farenheit = (degrees - 32) / 9 * 5.0;\n      cout &lt;&lt; \"The degrees in Farenheit are: \" &lt;&lt; Farenheit &lt;&lt; endl;\n   }\n\n   else if ( unit == 'f' || 'F')\n   {\n      Celsius = (degrees - 32) * 5.0/9;\n      cout &lt;&lt; \"The degrees in Celsius is: \" &lt;&lt; Celsius &lt;&lt; endl;\n   }\n\n   return 0;\n   }\n</code></pre>\n"}, {"tags": ["c++", "struct"], "comments": [{"owner": {"reputation": 4007, "user_id": 1020484, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94c933a9303bcc5b6445fc9e310bcf57?s=128&d=identicon&r=PG", "display_name": "lcs", "link": "https://stackoverflow.com/users/1020484/lcs"}, "edited": false, "score": 1, "creation_date": 1474488979, "post_id": 39625765, "comment_id": 66556890, "body": "<code>struct fraction {int numerator = NULL, denominator = NULL;};</code> Unrelated, but don&#39;t use the <code>NULL</code> constant as <code>0</code>, use <code>0</code> if that is what you want. It isn&#39;t guaranteed to be <code>0L</code>"}, {"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 0, "creation_date": 1474489347, "post_id": 39625765, "comment_id": 66557092, "body": "<code>void init(fraction&amp; x) { ...}</code>"}, {"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 0, "creation_date": 1474489384, "post_id": 39625765, "comment_id": 66557107, "body": "void init(fraction x) {     x.numerator = 0;     x.denominator = 0; } don&#39;t work, because of passing by value, do like David by refference, and is bad style in C++ (should be a method)"}], "answers": [{"comments": [{"owner": {"reputation": 8646, "user_id": 6242376, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/582463495261362/picture?type=large", "display_name": "Matt Corby", "link": "https://stackoverflow.com/users/6242376/matt-corby"}, "edited": false, "score": 0, "creation_date": 1474490338, "post_id": 39625922, "comment_id": 66557627, "body": "Thanks! I always get confused on what to make a pointer or where to put address operators..."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1492702073, "post_id": 39625922, "comment_id": 74100994, "body": "<code>&amp;</code> here is not the address operator, but the thing that makes a reference declarator."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 4, "last_activity_date": 1474489339, "creation_date": 1474489339, "answer_id": 39625922, "question_id": 39625765, "link": "https://stackoverflow.com/questions/39625765/how-to-initialize-a-struct-with-a-function-in-c/39625922#39625922", "title": "How to initialize a struct with a function in C++?", "body": "<blockquote>\n  <p>but I just get 0/0 every time no matter what. I think it's a pass by value/reference problem but i'm not sure how to go about fixing this.</p>\n</blockquote>\n\n<p>That's the correct diagnosis. You are passing the <code>fraction</code> by value. The changes are made to the copy, not the original object. Change the functions to:</p>\n\n<pre><code>void init(fraction&amp; x);\nvoid init(fraction&amp; x, int a);\nvoid init(fraction&amp; x, int a, int b);\n</code></pre>\n\n<p>You have the same problem with <code>read</code> and <code>reduce</code>. Change them to:</p>\n\n<pre><code>void read(fraction&amp; x);\nvoid reduce(fraction&amp; x);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "is_accepted": false, "score": 2, "last_activity_date": 1492701946, "last_edit_date": 1492701946, "creation_date": 1474489505, "answer_id": 39625967, "question_id": 39625765, "link": "https://stackoverflow.com/questions/39625765/how-to-initialize-a-struct-with-a-function-in-c/39625967#39625967", "title": "How to initialize a struct with a function in C++?", "body": "<p>Since you're doing this in C++, the best way is to have a constructor for your <code>struct</code>:</p>\n\n<pre><code>struct fraction\n{\n    int a_, b_;\n    fraction(int a = 0, int b = 1): a_(a), b_(b){}\n}\n</code></pre>\n\n<p>Then you won't need any other <em>function</em> to initialize your structure, you'll simply do</p>\n\n<pre><code>fraction frac{1,2}; // 1/2\n</code></pre>\n\n<p>In fact, in C++11 you don't even need a constructor, you can just use in-class initialization and if you want to change the values you rely on the fact that the <code>struct</code> is an aggregate and you can use <a href=\"http://en.cppreference.com/w/cpp/language/aggregate_initialization\" rel=\"nofollow noreferrer\">aggregate initialization</a>:</p>\n\n<pre><code>struct fraction\n{\n    int a_ = 0, b_ = 1;\n};\n\nfraction frac1; // default\nfraction frac2{1,2}; // 1/2, aggregate initialization\n</code></pre>\n\n<p>Also think about overloading operators, like <code>operator+</code> etc for your fraction, so you can write proper C++ code (not C in C++). In fact writing a <code>fraction</code> class is a typical exercise when learning C++.</p>\n\n<p>Side note: your </p>\n\n<pre><code>int numerator = NULL, denominator = NULL;\n</code></pre>\n\n<p>happens to compile, because <code>NULL</code> is a compile-time constant equal to zero. But it's VERY BAD practice. NULL was reserved for null pointers in C++03 and not for initializing variables with zero. C++11 deprecated it and now one uses <a href=\"http://en.cppreference.com/w/cpp/language/nullptr\" rel=\"nofollow noreferrer\"><code>nullptr</code></a>, which is not an <code>int</code> anymore, so un-wanted conversions won't happen.</p>\n"}], "owner": {"reputation": 8646, "user_id": 6242376, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/582463495261362/picture?type=large", "display_name": "Matt Corby", "link": "https://stackoverflow.com/users/6242376/matt-corby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "accepted_answer_id": 39625922, "answer_count": 2, "score": 1, "last_activity_date": 1492701946, "creation_date": 1474488782, "question_id": 39625765, "link": "https://stackoverflow.com/questions/39625765/how-to-initialize-a-struct-with-a-function-in-c", "title": "How to initialize a struct with a function in C++?", "body": "<p>I want to make a program that does fraction calculations, and i've made a fraction struct with 2 properties: numerator and denominator. I want to be able to initialize those properties using a function i've overloaded twice called <code>init(fraction x)</code>. The overloads are as follows:</p>\n\n<pre><code>init(fraction x) //Initializes a fraction struct with numerator and denominator equal to 0\ninit(fraction x, int a) //initializes fraction struct to a/1\ninit(fraction x, int a, int b) //initializes fraction struct to a/b\n</code></pre>\n\n<p>Then I try to test it and output a fraction like so</p>\n\n<pre><code>int main() {\n\nfraction a;\ninit(a,1);\n\ncout &lt;&lt; \"The fraction is: \";\nprint(a); \ncout &lt;&lt; endl;\n\nreturn 0;\n}\n</code></pre>\n\n<p>but I just get 0/0 every time no matter what. I think it's a pass by value/reference problem but i'm not sure how to go about fixing this. Here's all my code:</p>\n\n<p>Header.h</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nstruct fraction {\n    int numerator = NULL, denominator = NULL;\n};\n\nvoid init(fraction x);                          // set fraction to 0\nvoid init(fraction x, int n);                // set fraction to n/1\nvoid init(fraction x, int a, int b);       // set fraction to a/b\nfraction add(fraction a, fraction b);                        // adds a and b and returns the sum (a and b unchanged)\nfraction sub(fraction a, fraction b);                        // subtracts a and b and returns difference\nfraction mul(fraction a, fraction b);                        // multiplies a and b and returns the product\nfraction div(fraction a, fraction b);             // divides a and b and returns the quotient\nvoid print(fraction x);                                    // prints the fraction (no improper fractions)\nvoid read(fraction x);                                    // reads fraction 3 / 5 into x\nvoid reduce(fraction x);                               // simplifies x to lowest common terms\nint gcd(int a, int b);                                       // finds greatest common divisor of a and b\n</code></pre>\n\n<p>Source.cpp</p>\n\n<pre><code>#include \"Header.h\"\n\nvoid init(fraction x) {\n    x.numerator = 0;\n    x.denominator = 0;\n}\n\nvoid init(fraction x, int n) {\n    x.numerator = n;\n    x.denominator = 1;\n}\n\nvoid init(fraction x, int a, int b) {\n    x.numerator = a;\n    x.denominator = b;\n}\n\n\nfraction add(fraction a, fraction b) {\n    return a;\n}\n\n\nfraction sub(fraction a, fraction b) {\n    return a;\n}\n\nfraction mul(fraction a, fraction b) {\n    return a;\n}\n\nfraction div(fraction a, fraction b) {\n    return a;\n}\n\nvoid print(fraction x) {\n    cout &lt;&lt; x.numerator &lt;&lt; '/' &lt;&lt; x.denominator;\n}\n\nvoid read(fraction x) {\n\n}\n\nvoid reduce(fraction x) {\n\n}\n\nint gcd(int a, int b) {\n    return a;\n}\n</code></pre>\n\n<p>Main.cpp</p>\n\n<pre><code>#include \"Header.h\"\n\nint main() {\n\nfraction a;\na.numerator = a.denominator = 1;\ninit(a,1, 2);\n\ncout &lt;&lt; \"The fraction is: \";\nprint(a); \ncout &lt;&lt; endl;\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "game-engine"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1474488861, "post_id": 39625703, "comment_id": 66556815, "body": "You need to be a <i>lot</i> more specific in your question. Plus, provide details on what you&#39;ve tried/researched. Also, post code."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1474488873, "post_id": 39625703, "comment_id": 66556823, "body": "What do you think you should use? What are the pros and cons of pointers in your opinion?"}], "answers": [{"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1474488872, "creation_date": 1474488872, "answer_id": 39625801, "question_id": 39625703, "link": "https://stackoverflow.com/questions/39625703/inputing-char-for-a-symmetric-cipher-to-be-used-in-a-game/39625801#39625801", "title": "inputing char for a symmetric cipher to be used in a game", "body": "<p>use std::vector</p>\n\n<p>Place to start, think what the translate function would look like. That tells you the shape of the data you need. Initially hard code the translation table in a test program otherwise you will get distracted with worrying about talking to the user.</p>\n\n<p>Once you understand the tx table you will need and how t store it then worry about inputting it.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 6851293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q9wb9.png?s=128&g=1", "display_name": "James Nimmo", "link": "https://stackoverflow.com/users/6851293/james-nimmo"}, "is_accepted": true, "score": 0, "last_activity_date": 1474657213, "creation_date": 1474657213, "answer_id": 39667818, "question_id": 39625703, "link": "https://stackoverflow.com/questions/39625703/inputing-char-for-a-symmetric-cipher-to-be-used-in-a-game/39667818#39667818", "title": "inputing char for a symmetric cipher to be used in a game", "body": "<p>I have the answer. Here some test code that uses the first three letters of the alphabet.</p>\n\n<pre><code>int i = 0, j = 0;\nstring alp[] = { \"a\", \"b\", \"c\" }, alpc[] = { \"0\", \"1\", \"2\" };\n\nwhile (i &lt;= 2) {\n    cout &lt;&lt; \"Enter the letter substitution: \" &lt;&lt; alp[i] &lt;&lt; \" = \";\n    cin &gt;&gt; alpc[i];\n    for (j = 0; j &lt; i; ++j) {\n        while (alpc[j] == alpc[i]) {\n            cout &lt;&lt; \"Please enter a non-redundant letter substitution: \";\n            cin &gt;&gt; alpc[i];\n        }\n\n    }\n    ++i;\n    }\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6851293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q9wb9.png?s=128&g=1", "display_name": "James Nimmo", "link": "https://stackoverflow.com/users/6851293/james-nimmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 39667818, "answer_count": 2, "score": -1, "last_activity_date": 1474657213, "creation_date": 1474488559, "last_edit_date": 1474656940, "question_id": 39625703, "link": "https://stackoverflow.com/questions/39625703/inputing-char-for-a-symmetric-cipher-to-be-used-in-a-game", "title": "inputing char for a symmetric cipher to be used in a game", "body": "<p>I am looking for a simple function that would allow an user (player) to assign letters of the alphabet to other letters. For example: \"a = n\" . Then placing theses letters in an array: alb[n,..]. Should I use pointers? </p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 3, "creation_date": 1474488243, "post_id": 39625579, "comment_id": 66556449, "body": "10 to the 19&#39;th power is a <b>really big</b> number..."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474488280, "post_id": 39625579, "comment_id": 66556472, "body": "<i>&quot;What might be the issue ?&quot;</i> The second number parameter obviously."}], "answers": [{"tags": [], "owner": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "is_accepted": false, "score": 3, "last_activity_date": 1474488450, "creation_date": 1474488450, "answer_id": 39625678, "question_id": 39625579, "link": "https://stackoverflow.com/questions/39625579/c-overflow-in-implicit-constant-conversion-woverflow/39625678#39625678", "title": "C++ : overflow in implicit constant conversion [-Woverflow]", "body": "<p>long long max value is only 9223372036854 775 807\nand pow(10,19) is bigger number 10000000000000000000</p>\n"}, {"comments": [{"owner": {"reputation": 310, "user_id": 4770722, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/599b2c8e7bfc746a9d3ce7a7dcf1b626?s=128&d=identicon&r=PG&f=1", "display_name": "mach", "link": "https://stackoverflow.com/users/4770722/mach"}, "edited": false, "score": 0, "creation_date": 1474489312, "post_id": 39625680, "comment_id": 66557076, "body": "So if I want to use the result of something like 10^100, how should I store that ?"}, {"owner": {"reputation": 3184, "user_id": 6710751, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qmR1W.jpg?s=128&g=1", "display_name": "Striezel", "link": "https://stackoverflow.com/users/6710751/striezel"}, "reply_to_user": {"reputation": 310, "user_id": 4770722, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/599b2c8e7bfc746a9d3ce7a7dcf1b626?s=128&d=identicon&r=PG&f=1", "display_name": "mach", "link": "https://stackoverflow.com/users/4770722/mach"}, "edited": false, "score": 0, "creation_date": 1474489481, "post_id": 39625680, "comment_id": 66557166, "body": "You should store it as a floating-point value, e.g. <code>float</code>, <code>double</code> or <code>long double</code>, depending on the version of <a href=\"http://en.cppreference.com/w/cpp/numeric/math/pow\" rel=\"nofollow noreferrer\">pow()</a> that you are using."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1474490825, "post_id": 39625680, "comment_id": 66557883, "body": "@JesperJuhl Or <a href=\"http://www.boost.org/doc/libs/1_60_0/libs/multiprecision/doc/html/index.html\" rel=\"nofollow noreferrer\">boost multi-precision</a>. I find it extremely easy to use (at least the arbitrarily long integer part, see e.g. the example on the end of the page <a href=\"http://www.boost.org/doc/libs/1_60_0/libs/multiprecision/doc/html/boost_multiprecision/tut/ints/cpp_int.html\" rel=\"nofollow noreferrer\">here</a>)."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1474491027, "post_id": 39625680, "comment_id": 66557992, "body": "@vsoftco - there are multiple options, sure. My point was merely, &quot;when the basic types are not enough, use an arbitrary precision library&quot; and I just gave one example."}], "tags": [], "owner": {"reputation": 3184, "user_id": 6710751, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qmR1W.jpg?s=128&g=1", "display_name": "Striezel", "link": "https://stackoverflow.com/users/6710751/striezel"}, "is_accepted": true, "score": 10, "last_activity_date": 1474489265, "last_edit_date": 1474489265, "creation_date": 1474488461, "answer_id": 39625680, "question_id": 39625579, "link": "https://stackoverflow.com/questions/39625579/c-overflow-in-implicit-constant-conversion-woverflow/39625680#39625680", "title": "C++ : overflow in implicit constant conversion [-Woverflow]", "body": "<p>The problem is that <code>long long</code>is too small to hold the result of <code>pow(10,19)</code>.</p>\n\n<p><code>long long</code> is usually 64 bits, and a 64 bit integer can hold approx. 1.8*10^19 different values. However, since it is signed, you only get the half of it (the other half is for negative values). And the half of that is 0.9*10^19, which is apparently less than 10^19.</p>\n\n<p>Another issue (but not the reason of the warning / overflow) here is that the <code>pow()</code> function returns a floating-point value. So even if the result would fit into <code>long long</code> - which it does not - you might loose some precision and not get the exact integer result.</p>\n\n<p>Edit: Of course, you could use <code>unsigned long long</code> for this case instead. That would be enough for 10^19, but not for 10^20. So you are just defering the problem to a later time when you are using similarily large numbers that don't fit into <code>unsigned long long</code>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4407569"}, "is_accepted": false, "score": 5, "last_activity_date": 1474488570, "creation_date": 1474488570, "answer_id": 39625708, "question_id": 39625579, "link": "https://stackoverflow.com/questions/39625579/c-overflow-in-implicit-constant-conversion-woverflow/39625708#39625708", "title": "C++ : overflow in implicit constant conversion [-Woverflow]", "body": "<pre><code>log2(10^18) ~ 59.80\nlog2(10^19) ~ 63.12\n</code></pre>\n\n<p>A signed <code>long long</code> is likely to be 64bit with 1bit reserved for the sign, thus 10^18 nicely fits, but 10^19 doesnt.</p>\n\n<p>The C++ standard also only gurantees that numbers up to <code>2^63-1</code> can be stored in a <code>long long</code>.</p>\n\n<p><code>pow</code> is also operating on floating points. Its result will not be exact. Therefore saving it to an integer is likely a mistake anyway.</p>\n"}], "owner": {"reputation": 310, "user_id": 4770722, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/599b2c8e7bfc746a9d3ce7a7dcf1b626?s=128&d=identicon&r=PG&f=1", "display_name": "mach", "link": "https://stackoverflow.com/users/4770722/mach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13134, "favorite_count": 2, "accepted_answer_id": 39625680, "answer_count": 3, "score": 1, "last_activity_date": 1474490699, "creation_date": 1474488130, "last_edit_date": 1474490699, "question_id": 39625579, "link": "https://stackoverflow.com/questions/39625579/c-overflow-in-implicit-constant-conversion-woverflow", "title": "C++ : overflow in implicit constant conversion [-Woverflow]", "body": "<pre><code>long long sum;\nsum=pow(10,19);\ncout&lt;&lt;sum;\n</code></pre>\n\n<p>Above code in <strong>C++</strong> gives the error:</p>\n\n<blockquote>\n  <p>overflow in implicit constant conversion [-Woverflow]</p>\n</blockquote>\n\n<p>While following code runs fine:</p>\n\n<pre><code>long long sum;\nsum=pow(10,18);\ncout&lt;&lt;sum;\n</code></pre>\n\n<p>What might be the issue ?</p>\n"}, {"tags": ["c++", "file", "stringstream"], "comments": [{"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1474487798, "post_id": 39625468, "comment_id": 66556217, "body": "Why don&#39;t you read into <code>line</code> directly and skip line_c, <code>std::getline(std::cin, line)</code>?"}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1474487882, "post_id": 39625468, "comment_id": 66556264, "body": "What happens when you run it in the debugger?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1474487896, "post_id": 39625468, "comment_id": 66556268, "body": "<i>&quot;I am debugging this issue now for 15 minutes ...&quot;</i> I&#39;m not so sure if this makes it valid to ask a question at Stack Overflow. Usually you&#39;re expected to put more efforts before you come here."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1474488050, "post_id": 39625468, "comment_id": 66556351, "body": "15min to debug a problem is <i>nothing</i> - try hours, days, weeks or even months for really tricky issues."}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1474488085, "post_id": 39625468, "comment_id": 66556375, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 Ah, then I think I go home. I thought coming to stackoverflow is OK if you have a problem, but thanks for clearing stuff up... I dont find a solution for this on my own. I googled and tried and never came across this error. In linux it runs fine tho..."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1474488152, "post_id": 39625468, "comment_id": 66556406, "body": "When you get this error walk back the callstack to the line of you code causing the error."}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1474488188, "post_id": 39625468, "comment_id": 66556424, "body": "that is the problem. I did, i have the stack right here, i stepped through it. it happens as soon as the <code>stringstream</code> gets implicitly deleted... The first line gets read correctly and even the values <code>a, b, c, d</code> are filled in correctly"}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1474488593, "post_id": 39625468, "comment_id": 66556642, "body": "Is it a possiblity that there is a multithreading issue? i made sure that this functions only gets called once (outside of it is a mutex), but ive read now multiple times that STL + multithreading might be an issue"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1474488826, "post_id": 39625468, "comment_id": 66556788, "body": "The <code>load()</code> function you have shown is self-contained, everything is local and thus there is no multi-threading issue with it.  However, if you are storing each read <code>entry_t</code> into your <code>entry_list</code> (which you did not show), and multiple threads are accessing <code>entry_list</code> at the same time, then you have a concurrency issue. But that should not be causing the <code>std::stringstream</code> destructor to crash, unless you are corrupting memory along the way. Which I don&#39;t see this code doing. As for the actual error, &quot;<i>reading location 0x00000004</i>&quot; implies a NULL pointer is being dereferenced."}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1474488970, "post_id": 39625468, "comment_id": 66556885, "body": "Okay, but switching from /MDd to /MTd in Visual Studio fixes the issue o_O"}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1474491567, "post_id": 39625468, "comment_id": 66558273, "body": "@Nidhoegger Does not repro: <a href=\"http://rextester.com/LQMO95021\" rel=\"nofollow noreferrer\">rextester.com/LQMO95021</a>. The problem lies in code you are not showing us, for instance we have no clue what the definition of macro_storage_t is, etc. What you need to do - for yourself - is boil this down to an <a href=\"http://stackoverflow.com/help/mcve\">MVCE</a>."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1474492210, "post_id": 39625468, "comment_id": 66558627, "body": "@Nidhoegger Also here&#39;s a simpler version of the code: <a href=\"http://rextester.com/UPWY7366\" rel=\"nofollow noreferrer\">rextester.com/UPWY7366</a>"}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1474488390, "post_id": 39625621, "comment_id": 66556534, "body": "Then you likely either have a bad installation, or the compiler is producing bad codegen."}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1474488416, "post_id": 39625621, "comment_id": 66556544, "body": "Do you have an idea what I can do about it?"}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1474490633, "post_id": 39625621, "comment_id": 66557767, "body": "@RemyLebeau In the original code he has written <code>if (line.find(&quot;VERSION&quot;) == std::string::npos)</code> but your code looks for lines beginning with VERSION rather than not including it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 1, "creation_date": 1474490652, "post_id": 39625621, "comment_id": 66557779, "body": "@Nidhoegger You probably have undefined behavior somewhere else in the program. Use a memory debugging tool like <code>valgrind</code>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1474491148, "post_id": 39625621, "comment_id": 66558053, "body": "@kfsone: the original code looks for <code>&quot;VERSION&quot;</code> on <i>every line that is read</i>. If it is not found on a line, that line is assumed to be (but is not validated as) a 4-int line. But only the first line will ever have <code>&quot;VERSION&quot;</code> on it, so my code checks only the first line. If <code>&quot;VERSION&quot;</code> is found on the first line, all subsequent lines are assumed (and validated) to be 4-int lines, otherwise they are not read. This way, there is less overhead used as <code>&quot;VERSION&quot;</code> is not being checked over and over."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1474488675, "last_edit_date": 1474488675, "creation_date": 1474488276, "answer_id": 39625621, "question_id": 39625468, "link": "https://stackoverflow.com/questions/39625468/access-violation-when-using-stdstringstream-on-windows/39625621#39625621", "title": "Access violation when using std::stringstream on windows", "body": "<p>Try this instead:</p>\n\n<pre><code>void macro_storage_t::load(std::string filename)\n{\n    std::ifstream file(filename);\n    if (file.is_open())\n    {\n        clear();\n\n        std::string line;\n        if (std::getline(file, line))\n        {       \n            if (line.substr(0, 8) == \"VERSION \")\n            {\n                // optional: read the actual version number from the line,\n                // if it affects how the following values must be read...\n\n                while (std::getline(file, line))\n                {\n                    std::istringstream ss(line);\n                    int a, b, c, d;\n\n                    if (ss &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d)\n                    {\n                        entry_t entry;\n\n                        entry.timestamp = a;\n                        entry.type = static_cast&lt;entry_type_t&gt;(b);\n                        entry.button = static_cast&lt;button_t&gt;(c);\n                        entry.key = static_cast&lt;BYTE&gt;(d);\n\n                        entry_list_.push_back(entry);\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 955, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1474488675, "creation_date": 1474487706, "last_edit_date": 1474488275, "question_id": 39625468, "link": "https://stackoverflow.com/questions/39625468/access-violation-when-using-stdstringstream-on-windows", "title": "Access violation when using std::stringstream on windows", "body": "<p>I am currently implementing a rudimentary file load function. When using a <code>std::stringstream</code> the program crashes with a access violation in the <code>stringstream</code> destructor. Here is the function:</p>\n\n<pre><code>void macro_storage_t::load(std::string filename)\n{\n    std::ifstream file(filename);\n    if (file.is_open())\n    {\n        clear();\n\n        char line_c[4096];\n        while (file.getline(line_c, 4096))\n        {       \n\n            std::string line(line_c);\n            if (line.find(\"VERSION\") == std::string::npos)\n            {\n                std::stringstream ss(std::stringstream::in | std::stringstream::out);\n                int a, b, c, d;\n\n                ss &lt;&lt; line;\n                ss &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d;\n                entry_t entry;\n                entry.timestamp = a;\n                entry.type = static_cast&lt;entry_type_t&gt;(b);\n                entry.button = static_cast&lt;button_t&gt;(c);\n                entry.key = static_cast&lt;BYTE&gt;(d);\n\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>The file it loads looks like this (shortened for better readability):</p>\n\n<pre><code>VERSION 1\n0 14 254 0\n</code></pre>\n\n<p>and is saved with this function:</p>\n\n<pre><code>void macro_storage_t::save(std::string filename)\n{\n    std::ofstream file(filename, std::ios::trunc);\n    if (file.is_open())\n    {\n        file &lt;&lt; \"VERSION \" &lt;&lt; MACRO_VERSION &lt;&lt; std::endl;\n        for (std::vector&lt;entry_t&gt;::iterator it = entry_list_.begin(); it != entry_list_.end(); ++it)\n        {\n            entry_t entry = *it;\n            file &lt;&lt; (int)entry.timestamp &lt;&lt; \" \" &lt;&lt; (int)entry.type &lt;&lt; \" \" &lt;&lt; (int)entry.button &lt;&lt; \" \" &lt;&lt; (int)entry.key &lt;&lt; std::endl;\n        }\n        file.close();\n    }\n}\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>Unhandled exception at 0x0f99a9ee (msvcp100d.dll) in FLAP.exe: 0xC0000005: Access violation reading location 0x00000004.\n</code></pre>\n\n<p>The error happens as soon as the <code>stringstream</code> gets deleted implicitly...</p>\n\n<p>I use Visual Studio 2010 on Windows 7.</p>\n"}, {"tags": ["c++", "arrays", "class", "oop", "dynamic-allocation"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1474487640, "post_id": 39625403, "comment_id": 66556129, "body": "You really should store the matrix in a one dimensional vector."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1474487657, "post_id": 39625403, "comment_id": 66556139, "body": "will somebody smack you if you use <code>vector&lt;vector&lt;int&gt; &gt;</code> instead?"}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1474487706, "post_id": 39625403, "comment_id": 66556166, "body": "@Jean-Fran&#231;oisFabre Only someone who cares a lot about cache locality. 1D vectors are better."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1474487797, "post_id": 39625403, "comment_id": 66556215, "body": "@vsoftco right about that. I did not see your comment :) I was talking about <code>int **</code> versus <code>vector&lt;vector&gt;</code> and all the memory problems it solves. I agree that 1D vectors are better, but you have to wrap them into an object or you constantly shoot yourself in the foot with index computations."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1474487867, "post_id": 39625403, "comment_id": 66556257, "body": "@Jean-Fran&#231;oisFabre Yes I knew you were relating to <code>int**</code> :) Right about the indexing, but if you don&#39;t want to complicate (using a proxy class) one can re-define <code>operator()(size_t, size_t)</code> for indexing."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1474487882, "post_id": 39625403, "comment_id": 66556262, "body": "Yeah the OP is not sure about how to do what he wants, let&#39;s bomb him with the vector VS array, 1D vs 2D stuff..One step at a time guys! :)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1474487908, "post_id": 39625403, "comment_id": 66556273, "body": "don&#39;t forget to use SSE2 for vectorized complex multiplications :)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1474488233, "post_id": 39625403, "comment_id": 66556442, "body": "isn&#39;t there some templates sources like Template Numerical Toolkit to define vectors &amp; matrices without coding something that crashes?"}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1474489036, "post_id": 39625403, "comment_id": 66556931, "body": "@Jean-Fran&#231;oisFabre <a href=\"http://eigen.tuxfamily.org/index.php?title=Main_Page\" rel=\"nofollow noreferrer\">Eigen</a> is a VERY good/fast templated C++ matrix library."}], "answers": [{"comments": [{"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 1, "creation_date": 1474487674, "post_id": 39625446, "comment_id": 66556146, "body": "Actually OP just has to remove <code>int**</code>. Good catch!"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1474487827, "post_id": 39625446, "comment_id": 66556233, "body": "Thanks @vsoftco, I updated my answer though to make it super-clear to everyone! ;)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1474487968, "post_id": 39625446, "comment_id": 66556306, "body": "and don&#39;t forget to create a copy constructor and an assignment operator that does not just copy the pointer value but duplicates the data, without memory leaks. Good luck, it&#39;s not that easy."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1474488035, "post_id": 39625446, "comment_id": 66556339, "body": "another trick: name your class members differently: <code>m_matrix</code>, <code>_matrix</code>  to avoid mixups like this."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1474488321, "post_id": 39625446, "comment_id": 66556499, "body": "@Jean-Fran&#231;oisFabre You should really avoid names starting with a leading underscore.  In certain cases using them is UB so it is just best to avoid the situation entirely."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1474488364, "post_id": 39625446, "comment_id": 66556522, "body": "Oh @NathanOliver has a point here, better not use the leading underscore, he is right!"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1474488441, "post_id": 39625446, "comment_id": 66556560, "body": "Right! I dropped them in favour of <code>m_matrix</code> anyway. Somebody must have told me that before :)"}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1474488504, "post_id": 39625446, "comment_id": 66556589, "body": "@Jean-Fran&#231;oisFabre Here are the rules: <a href=\"http://stackoverflow.com/a/228797/3093378\">stackoverflow.com/a/228797/3093378</a>. So <code>_identifier</code> (with lower case <code>i</code>) should be fine, as long as it&#39;s not in the global namespace. I used this convention and now I was super worried that I&#39;d need to refactor..."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1474489264, "post_id": 39625446, "comment_id": 66557044, "body": "of course! if defined as a C-like symbol it would be a nightmare to the linker. I was using Visual C++ 98 at the time, so I had worse worries :)"}, {"owner": {"reputation": 107, "user_id": 5591115, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/j76fd.jpg?s=128&g=1", "display_name": "PixelPusher", "link": "https://stackoverflow.com/users/5591115/pixelpusher"}, "edited": false, "score": 0, "creation_date": 1474491539, "post_id": 39625446, "comment_id": 66558259, "body": "Thanks for the help and all the tips."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 107, "user_id": 5591115, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/j76fd.jpg?s=128&g=1", "display_name": "PixelPusher", "link": "https://stackoverflow.com/users/5591115/pixelpusher"}, "edited": false, "score": 0, "creation_date": 1474492243, "post_id": 39625446, "comment_id": 66558644, "body": "@TimBotelho you are welcomed. Is there a reason for not accepting my answer? :/"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 4, "last_activity_date": 1474487718, "last_edit_date": 1474487718, "creation_date": 1474487639, "answer_id": 39625446, "question_id": 39625403, "link": "https://stackoverflow.com/questions/39625403/referencing-a-2d-array-in-a-class-function-in-c/39625446#39625446", "title": "Referencing a 2d array in a class function in C++", "body": "<p>How could you?</p>\n\n<pre><code>int** matrixArray = new int*[matrixSize];\n</code></pre>\n\n<p>is a <strong>local variable</strong> inside the constructor, thus <code>matrixArray</code> is only visible inside the constructor.</p>\n\n<p>Use the data member instead and you will be fine, and since you already have defined that member, you should just do this:</p>\n\n<pre><code>matrixArray = new int*[matrixSize];\n</code></pre>\n\n<p>Don't forget to delete your memory in the destructor! ;)</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 5591115, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/j76fd.jpg?s=128&g=1", "display_name": "PixelPusher", "link": "https://stackoverflow.com/users/5591115/pixelpusher"}, "edited": false, "score": 0, "creation_date": 1474491363, "post_id": 39625727, "comment_id": 66558169, "body": "Thanks for the point by point critique. I&#39;m trying to learn best practices and this really helped."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "reply_to_user": {"reputation": 107, "user_id": 5591115, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/j76fd.jpg?s=128&g=1", "display_name": "PixelPusher", "link": "https://stackoverflow.com/users/5591115/pixelpusher"}, "edited": false, "score": 0, "creation_date": 1474491714, "post_id": 39625727, "comment_id": 66558349, "body": "@TimBotelho Glad it helped! It&#39;s important to have some understanding of arrays and dynamic memory allocation, but modern C++ saves you a <i>lot</i> of the pain these things cause. Be sure to bookmark <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">vector</a>, <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow noreferrer\">unique_ptr</a> and <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow noreferrer\">shared_ptr</a> for later reading - but not too late - save yourself a lot of pain :)"}], "tags": [], "owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "is_accepted": false, "score": 1, "last_activity_date": 1474488633, "creation_date": 1474488633, "answer_id": 39625727, "question_id": 39625403, "link": "https://stackoverflow.com/questions/39625403/referencing-a-2d-array-in-a-class-function-in-c/39625727#39625727", "title": "Referencing a 2d array in a class function in C++", "body": "<p>You've made a very common mistake, failing to distinguish between locally scoped variables/parameters and member variables.</p>\n\n<pre><code>int** matrixArray = new int*[matrixSize];\n</code></pre>\n\n<p>Because this expression starts with a type, it is a <em>declaration</em> of a new, local variable, which is \"hiding\" the class member (you would have to use <code>this-&gt;matrixArray</code> to access it, and it would not be initialized). Your compiler <em>should</em> be giving you a \"shadow variable\" warning.</p>\n\n<p>A common practice is to give member variables a distinguisher: some people prefix them with \"m_\", some put a trailing \"_\", so your code would become:</p>\n\n<pre><code>class matrix\n{\n    int **matrixArray_ = nullptr;  //1\n    int matrixSize_ = 0;  //2\n\npublic:\n    matrix(int matrixSize);\n    ~matrix();  //7\n    void printMatrix() const;\n    void makeMagicSquare();\n    int size() const { return matrixSize_; }  //3\n};\n\nmatrix::matrix(int const matrixSize)\n    : matrixSize_(matrixSize)  //4\n{\n    matrixArray_ = new int*[matrixSize_];  //5\n    for(int i = 0; i&lt;matrixSize_; i++) {\n        matrixArray_[i] = new int[matrixSize_] ();  //6\n    }\n}\n\nmatrix::~matrix()  //7\n{\n    if (!_matrixArray)\n        return;\n    for (int i = 0; i &lt; matrixSize_; ++i) {\n        delete [] matrixArray_[i];\n    }\n    delete [] matrixArray_;\n}\n\nvoid matrix::printMatrix() const\n{\n    for(int row = 0; row &lt; matrixSize_; row++) {\n        for(int col = 0; col &lt; matrixSize_; col++) {\n            cout &lt;&lt; \"test\" &lt;&lt; \"  \";\n            cout &lt;&lt; matrixArray_[row][col] &lt;&lt; endl;\n        }// end col\n        cout &lt;&lt; endl;\n    }//end row\n}\n</code></pre>\n\n<p>1: Added '_' suffix and might as well make sure we don't accidentally get garbage here,</p>\n\n<p>2: Added '_' suffix and I made private so it doesn't get tweaked from outside,</p>\n\n<p>3: Added a 'size()' accessor member function,</p>\n\n<p>4: Use initializer list to copy \"matrixSize\" parameter to \"matrixSize_\" member,</p>\n\n<p>5: Removed the 'int**' and note we're using 'matrixArray_' - member,</p>\n\n<p>6: The <code>()</code> after the <code>new int[matrixSize_]</code> tells the compiler to default \ninitialize the columns for us (sets them to zero) In modern C++ this would be <code>{}</code> instead, but then I'm not sure if you're using a modern C++ compiler and both work.</p>\n\n<p>7: Added a destructor to release the memory used</p>\n\n<p>For similar reasons, I would encourage you to consider making your type names distinct: <code>class Matrix</code> or <code>class matrix_t</code>.</p>\n"}], "owner": {"reputation": 107, "user_id": 5591115, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/j76fd.jpg?s=128&g=1", "display_name": "PixelPusher", "link": "https://stackoverflow.com/users/5591115/pixelpusher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1474488633, "creation_date": 1474487496, "last_edit_date": 1474487757, "question_id": 39625403, "link": "https://stackoverflow.com/questions/39625403/referencing-a-2d-array-in-a-class-function-in-c", "title": "Referencing a 2d array in a class function in C++", "body": "<p>Can't access a 2D array that I created in the constructor in the printMatrix class function. When I call the function in main with a simple cout &lt;&lt; \"test\"; it will print that. If I try to print the values of matrixArray[][] it prints nothing and quits the program. Am I not referencing the 2d array correctly? </p>\n\n<pre><code>class matrix\n{\n    int **matrixArray;\n\npublic:\n    int matrixSize = 0;\n    matrix(int matrixSize);\n    void printMatrix();\n    void makeMagicSquare();\n};\nmatrix::matrix(int const matrixSize)\n{\n    this-&gt;matrixSize = matrixSize ;\n\n\n    int** matrixArray = new int*[matrixSize];\n        for(int i = 0; i&lt;matrixSize; i++){\n           matrixArray[i] = new int[matrixSize];\n        }\n\n\n    for(int row = 0; row &lt; matrixSize ;row++)\n            {\n                for(int col = 0; col &lt; matrixSize; col++)\n                {\n                    matrixArray[row][col] =0;\n                    cout &lt;&lt; matrixArray[row][col] &lt;&lt; \"  \";\n                }//End for Col\n                cout &lt;&lt; endl;\n            }//End for Row\n\n}\n//printMatrix Function \nvoid matrix::printMatrix(){\n\nfor(int row = 0; row &lt; matrixSize;row++)\n        {\n            for(int col = 0; col &lt; matrixSize; col++)\n            {\n                cout &lt;&lt; \"test\" &lt;&lt; \"  \";\n                //Not able to print  from print function\n                cout &lt;&lt; matrixArray[row][col] &lt;&lt; endl;\n            }// end col\n            cout &lt;&lt; endl;\n        }//end row\n\n}\n</code></pre>\n"}, {"tags": ["c++", "macos", "gcc", "truecrypt"], "comments": [{"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1474496314, "post_id": 39625388, "comment_id": 66560378, "body": "Based on where the ^ is located, %r10 is an &quot;unknown token&quot;?  That only seems possible if (somehow) you were compiling for 32bit.  Or perhaps the caret is in the wrong place and it&#39;s the mm1 it doesn&#39;t recognize?"}], "answers": [{"tags": [], "owner": {"reputation": 350, "user_id": 4952917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9dbf95ef3c17d3118f5b42d995ec09c?s=128&d=identicon&r=PG&f=1", "display_name": "Erich Kuester", "link": "https://stackoverflow.com/users/4952917/erich-kuester"}, "is_accepted": true, "score": 0, "last_activity_date": 1496940647, "last_edit_date": 1496940647, "creation_date": 1496848945, "answer_id": 44416789, "question_id": 39625388, "link": "https://stackoverflow.com/questions/39625388/issues-compiling-veracrypt-on-mac-os-x-el-capitan-10-11-5/44416789#44416789", "title": "Issues compiling Veracrypt on Mac OS X El Capitan 10.11.5", "body": "<p>The inline code for the nasm assembler is not correctly expanded, see also this\n<a href=\"https://github.com/veracrypt/VeraCrypt/issues/126\" rel=\"nofollow noreferrer\">issue in veracrypt repository</a>. The culprits are located in cpu.h (lines 259 until 263 in the 1.19 release). You can try to substitute these with</p>\n\n<pre><code>#define GNU_AS1(x) #x \";\"\n#define GNU_AS2(x, y) #x \", \" #y \";\"\n#define GNU_AS3(x, y, z) #x \", \" #y \", \" #z \";\"\n#define GNU_ASL(x) \"\\n\\t#x:\"\n#define GNU_ASJ(x, y, z) #x \" \" #y #z \";\"\n</code></pre>\n\n<p>but it could be that in the final test for encryption you will get an error for TestPkcs5.</p>\n\n<p>Addendum 2017-06-08: The latest git clone of <a href=\"https://github.com/veracrypt/VeraCrypt\" rel=\"nofollow noreferrer\">veracrypt</a> compiles without problems, the inline assembly in the whirlpool hashing function is disabled now.</p>\n"}], "owner": {"reputation": 35, "user_id": 3276799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f9d42b2e89750ecda3466a46fd0302?s=128&d=identicon&r=PG", "display_name": "BrandonRachal", "link": "https://stackoverflow.com/users/3276799/brandonrachal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 44416789, "answer_count": 1, "score": 0, "last_activity_date": 1496940647, "creation_date": 1474487450, "question_id": 39625388, "link": "https://stackoverflow.com/questions/39625388/issues-compiling-veracrypt-on-mac-os-x-el-capitan-10-11-5", "title": "Issues compiling Veracrypt on Mac OS X El Capitan 10.11.5", "body": "<p>I'm having issues compiling Veracrypt on El Capitan</p>\n\n<p>This is the error I get:</p>\n\n<pre><code>../Crypto/Whirlpool.c:511:3: error: unknown token in expression\n                KSH(2, 3, 2, 1, 0, 7)\n                ^\n../Crypto/Whirlpool.c:452:2: note: expanded from macro 'KSH'\n        KSH##op(b, [AS_REG_6+2*2048+8*WORD_REG(di)])\\\n        ^\n&lt;scratch space&gt;:264:1: note: expanded from here\nKSH2\n^\n../Crypto/Whirlpool.c:445:2: note: expanded from macro 'KSH2'\n        AS2(movq        [SSE2_workspace+8*a], mm##a)\n        ^\n/Users/whatnots/Desktop/veracrypt/src/Crypto/cpu.h:149:23: note: expanded from macro 'AS2'\n    #define AS2(x, y) GNU_AS2(x, y)\n                      ^\n/Users/whatnots/Desktop/veracrypt/src/Crypto/cpu.h:144:27: note: expanded from macro 'GNU_AS2'\n    #define GNU_AS2(x, y) #x \", \" #y \";\" NEW_LINE\n                          ^\n&lt;scratch space&gt;:270:2: note: expanded from here\n\"movq [%3+8*1]\"\n ^\n&lt;inline asm&gt;:162:7: note: instantiated into assembly here\nmovq [%r10+8*1], mm1;\n      ^\nfatal error: too many errors emitted, stopping now [-ferror-limit=]\n20 errors generated.\n</code></pre>\n\n<p>Here is my gcc info:</p>\n\n<pre><code>Configured with: --prefix=/Library/Developer/CommandLineTools/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\nApple LLVM version 7.3.0 (clang-703.0.31)\nTarget: x86_64-apple-darwin15.5.0\nThread model: posix\nInstalledDir: /Library/Developer/CommandLineTools/usr/bin\n</code></pre>\n\n<p>This compiles fine on Ubuntu 16.04. Not sure what i need to do. I've install all the required software and I've even tried two higher versions of gcc.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 8, "creation_date": 1474485574, "post_id": 39624872, "comment_id": 66554975, "body": "Uh, can you clarify? Your question is <i>way</i> to unclear. What do you mean by <code>splice</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "is_accepted": false, "score": 1, "last_activity_date": 1474485817, "creation_date": 1474485817, "answer_id": 39624952, "question_id": 39624872, "link": "https://stackoverflow.com/questions/39624872/what-is-the-stl-code-for-splice/39624952#39624952", "title": "What is the STL code for splice?", "body": "<p>Did you look at <a href=\"http://en.cppreference.com/w/cpp/container/list/splice\" rel=\"nofollow\"><code>std::list::splice</code></a>?</p>\n\n<blockquote>\n  <p>Transfers elements from one list to another.\n  No elements are copied or moved, only the internal pointers of the list nodes are re-pointed. The behavior is undefined if: get_allocator() != other.get_allocator(). No iterators or references become invalidated, the iterators to moved elements remain valid, but now refer into *this, not into other.</p>\n</blockquote>\n\n<p>Note that when splicing in a range, the time is linear, rather than O(1).</p>\n"}], "owner": {"reputation": 1, "user_id": 6860381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3314eb8aa52b089c364952267e70cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny rogers", "link": "https://stackoverflow.com/users/6860381/kenny-rogers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1474486483, "answer_count": 1, "score": -7, "last_activity_date": 1474485817, "creation_date": 1474485534, "question_id": 39624872, "link": "https://stackoverflow.com/questions/39624872/what-is-the-stl-code-for-splice", "closed_reason": "Needs details or clarity", "title": "What is the STL code for splice?", "body": "<p>In order to write my program I need the stl library to write my code but i can t for the life of me find the code to splice in STL format.</p>\n\n<pre><code>template &lt;class T&gt;\nvoid List&lt;T&gt;::splice(List&lt;T&gt;::Iterator position,\n  List&lt;T&gt;::Iterator start, List&lt;T&gt;::Iterator end) {\n\n}\n</code></pre>\n"}, {"tags": ["c++", "pointers", "vector"], "comments": [{"owner": {"reputation": 995, "user_id": 6184382, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/H1k2B.jpg?s=128&g=1", "display_name": "Lloyd", "link": "https://stackoverflow.com/users/6184382/lloyd"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1474486097, "post_id": 39624866, "comment_id": 66555269, "body": "Yes, should probably remove that cout since it doesn&#39;t have to do with the question. It was just for testing purposes"}, {"owner": {"reputation": 995, "user_id": 6184382, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/H1k2B.jpg?s=128&g=1", "display_name": "Lloyd", "link": "https://stackoverflow.com/users/6184382/lloyd"}, "edited": false, "score": 0, "creation_date": 1474487249, "post_id": 39624866, "comment_id": 66555908, "body": "I was testing if it was the same vector as I send to the method it should be removed from the block code now, anyways there willl be multiple fishes added to the vector which is why I don&#39;t only send one fish to there.  Thanks for your comment"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4407569"}, "edited": false, "score": 0, "creation_date": 1474487285, "post_id": 39624866, "comment_id": 66555924, "body": "regarding extra question: The function you wrote is part of the <code>Fish</code> class (<code>Fish::</code>), so it is allowed to modify any data member of <code>Fish</code>, even private ones. Otherwise private data members would be rather pointless. You do not need pointers to access or modify data members. Where did you get that from? The data member names refer automatically refer to the data members of the instance that the member function was called on."}, {"owner": {"reputation": 995, "user_id": 6184382, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/H1k2B.jpg?s=128&g=1", "display_name": "Lloyd", "link": "https://stackoverflow.com/users/6184382/lloyd"}, "edited": false, "score": 0, "creation_date": 1474489393, "post_id": 39624866, "comment_id": 66557113, "body": "I read somewhere that the methods got a copy of a variable but I probably misunderstood it, thank you ^.^&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 0, "last_activity_date": 1474487278, "creation_date": 1474487278, "answer_id": 39625335, "question_id": 39624866, "link": "https://stackoverflow.com/questions/39624866/collection-of-pointers-pointing-to-objects-clarification/39625335#39625335", "title": "collection of pointers pointing to objects, clarification", "body": "<p>Since the argument to <code>movementController</code> is a pointer, you need to indirect through it to access the vector. And since the elements of the vector are pointers, you need to indirect through them. So the code in <code>movementController</code> could be something like:</p>\n\n<pre><code>void EntityControl::movementController(std::vector&lt;Fish*&gt; * fishInputVector)\n{\n    for (auto fish_ptr : *fishInputVector) {\n        unsigned int x = rand() % xContainer;\n        unsigned int y = rand() % yContainer;\n        unsigned int z = rand() % zContainer;\n        fish_ptr-&gt;changePosition(x, y, z);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 524, "user_id": 2647513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de473566ab716b5ed2b7bcb7b6967fad?s=128&d=identicon&r=PG", "display_name": "user2647513", "link": "https://stackoverflow.com/users/2647513/user2647513"}, "edited": false, "score": 0, "creation_date": 1474488039, "post_id": 39625394, "comment_id": 66556342, "body": "You&#39;re right, I missed that. I think @Barmar was getting at the same point that I was, however his answer was indeed more correct as far as working examples go."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1474559945, "post_id": 39625394, "comment_id": 66590925, "body": "They&#39;re pretty much equivalent. Mine just uses a more concise syntax using the C++11 <code>for-range</code> feature. If they need to support older C++ implementations, your version would be necessary."}], "tags": [], "owner": {"reputation": 524, "user_id": 2647513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de473566ab716b5ed2b7bcb7b6967fad?s=128&d=identicon&r=PG", "display_name": "user2647513", "link": "https://stackoverflow.com/users/2647513/user2647513"}, "is_accepted": false, "score": 0, "last_activity_date": 1474488161, "last_edit_date": 1474488161, "creation_date": 1474487465, "answer_id": 39625394, "question_id": 39624866, "link": "https://stackoverflow.com/questions/39624866/collection-of-pointers-pointing-to-objects-clarification/39625394#39625394", "title": "collection of pointers pointing to objects, clarification", "body": "<p>I'm not 100% sure that I understand your question, but you seem to misunderstand pointers.</p>\n\n<p>I believe you are attempting to do what's called \"dereferencing\". That's an operation which allows you to call methods on objects that pointers refer to. Your method should read as follows:</p>\n\n<pre><code>void EntityControl::movementController(std::vector&lt;Fish*&gt; * fishInputVector)\n{\n    for(int i = 0; i &lt; fishInputVector-&gt;size(); i++)\n    {\n        unsigned int x = rand() % xContainer;\n        unsigned int y = rand() % yContainer;\n        unsigned int z = rand() % zContainer;\n        fishInputVector-&gt;at(i)-&gt;changePosition(x,y,z);\n    }\n}\n</code></pre>\n\n<p>I've changed two things here: I am referencing the ith element of the <code>fishInputVector</code>, which is a pointer. Next, I am using the dereference operator, <code>-&gt;</code>, which allows you to access functions/variables on the variable that the pointer is pointing to.</p>\n"}], "owner": {"reputation": 995, "user_id": 6184382, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/H1k2B.jpg?s=128&g=1", "display_name": "Lloyd", "link": "https://stackoverflow.com/users/6184382/lloyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 39625335, "answer_count": 2, "score": 0, "last_activity_date": 1474488161, "creation_date": 1474485507, "last_edit_date": 1474486492, "question_id": 39624866, "link": "https://stackoverflow.com/questions/39624866/collection-of-pointers-pointing-to-objects-clarification", "title": "collection of pointers pointing to objects, clarification", "body": "<p>I am quite new to c++ so I have a lot of problems with pointers, although I understand the concept. The problem is that I am making a vector of pointers in my main:</p>\n\n<p><strong>main/Aquarium.cpp</strong>:</p>\n\n<pre><code>using namespace std;\n#include \"EntityControl.h\"\n#include &lt;Windows.h&gt;\n\nint main() {\n\n    EntityControl entity;\n    vector&lt;Fish*&gt; fishVector;\n    Fish q;\n    cout &lt;&lt; \"fish q = \" &lt;&lt; &amp;q &lt;&lt; endl;\n    fishVector.push_back(&amp;q);\n\n        entity.movementController(&amp;fishVector);\n        cout &lt;&lt; &amp;fishVector &lt;&lt; endl;\n        system(\"pause\");\n     return 0;\n}\n</code></pre>\n\n<p>As you can see I add the location where you can find the fish to the fishVector, I then want to do something with the object in my EntityControl class. But I don't know how to do this, I tried getting it with a for loop but when trying to cout the result, the location is different than the fish in main.cpp.</p>\n\n<p><strong>EntityControl.cpp</strong></p>\n\n<pre><code>#include \"EntityControl.h\"\n\n\nvoid EntityControl::movementController(std::vector&lt;Fish*&gt; * fishInputVector)\n{\n        unsigned int x = rand() % xContainer;\n        unsigned int y = rand() % yContainer;\n        unsigned int z = rand() % zContainer;\n        //i.changePosition(x, y, z);\n}\n\nEntityControl::~EntityControl()\n{\n}\n</code></pre>\n\n<p>There were a few posts of this on stackoverflow, but I didn't understand the answers. I thought I needed some extra help. So if you can explain it as easily as you can then I would be very grateful.</p>\n\n<p><strong>problem clarification</strong>: adding the memory location of a Fish object to a vector (or any collection that suffices) in main then receiving the memory location and working with the object that the memory location points to in EntityControl.cpp</p>\n\n<p><strong>extra questions</strong>:\nI thought I needed a pointer to change the actual variable value in a class but,</p>\n\n<pre><code>void Fish::changePosition(int addX, int addY, int addZ)\n{\n    xLocation = addX;\n    yLocation = addY;\n    zLocation = addZ;\n\n    //std::cout &lt;&lt;\"VALUE =\"&lt;&lt; getX();\n}\n</code></pre>\n\n<p>seems to work fine, could you explain this? (x,y,z locations are private global variables in the Fish class)</p>\n\n<ul>\n<li><p>If I make a pointer, should I delete the object/variable that it's\npointing to? does it stay in the memory ?</p></li>\n<li><p>Are there any good resources I can read that might help me?</p></li>\n</ul>\n\n<p><strong>last note</strong>\nIf anyone can help me, thank you very much. This problem has been driving me crazy for hours.</p>\n"}, {"tags": ["c++", "conways-game-of-life"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 2, "creation_date": 1474485516, "post_id": 39624857, "comment_id": 66554935, "body": "Can you please provide the error messages?"}, {"owner": {"reputation": 1769, "user_id": 1551489, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/GWyPi.jpg?s=128&g=1", "display_name": "pawel.panasewicz", "link": "https://stackoverflow.com/users/1551489/pawel-panasewicz"}, "edited": false, "score": 1, "creation_date": 1474485916, "post_id": 39624857, "comment_id": 66555170, "body": "TDD (TestDrivenDevelopment) should be your friend here. Decompose problem/code into functions and test them idependently. You will find bugs and fix your code. It could be much faster way than attaching debbuger or starving at code :)"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1474487676, "post_id": 39624857, "comment_id": 66556149, "body": "Why do you put <code>main</code> inside namespace gamearray? Why do you polute the global namespace with <code>using namespace std</code>? Why is there no opening brace <code>{</code> after <code>main()</code>? (Does this even compile?), You may want to learn about <code>else if</code>,  <code>else</code> after an <code>if</code> that always returns is pretty redundant, You could work on your formating (recommend <a href=\"http://clang.llvm.org/docs/ClangFormat.html\" rel=\"nofollow noreferrer\">clang-format</a>), don&#39;t use <code>system</code>; please, there&#39;s lots more to point out - I guess the best advice is: read a <i>good</i> C++ book (or two)."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6134878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-bLqS5wusO8A/AAAAAAAAAAI/AAAAAAAAADE/cknJejkNhZg/photo.jpg?sz=128", "display_name": "Tamanna Islam", "link": "https://stackoverflow.com/users/6134878/tamanna-islam"}, "edited": false, "score": 0, "creation_date": 1474486338, "post_id": 39624986, "comment_id": 66555416, "body": "This is the task given to me. My code must read a text.file as an array and this array should be used as the input of the code."}, {"owner": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "reply_to_user": {"reputation": 51, "user_id": 6134878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-bLqS5wusO8A/AAAAAAAAAAI/AAAAAAAAADE/cknJejkNhZg/photo.jpg?sz=128", "display_name": "Tamanna Islam", "link": "https://stackoverflow.com/users/6134878/tamanna-islam"}, "edited": false, "score": 0, "creation_date": 1474486551, "post_id": 39624986, "comment_id": 66555549, "body": "you declare  string mArray[10]  but you use array[][] why?"}, {"owner": {"reputation": 51, "user_id": 6134878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-bLqS5wusO8A/AAAAAAAAAAI/AAAAAAAAADE/cknJejkNhZg/photo.jpg?sz=128", "display_name": "Tamanna Islam", "link": "https://stackoverflow.com/users/6134878/tamanna-islam"}, "edited": false, "score": 0, "creation_date": 1474487073, "post_id": 39624986, "comment_id": 66555813, "body": "14 expected initializer before &#39;ifstream&#39; 15 expected unqualified-id before if these are the errors"}], "tags": [], "owner": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "is_accepted": true, "score": 0, "last_activity_date": 1474486386, "last_edit_date": 1474486386, "creation_date": 1474485924, "answer_id": 39624986, "question_id": 39624857, "link": "https://stackoverflow.com/questions/39624857/reading-from-file-txt-to-array-of-strings-and-using-it-to-play-conways-game-of/39624986#39624986", "title": "Reading from file.txt to array of strings and using it to play Conway&#39;s game of Life", "body": "<p>aftert main you are missing {\nin first and second loop you have i loop twice</p>\n\n<p>why do you need to copy ?</p>\n\n<p>you can use this function fscanf() to read your file</p>\n\n<p>e.g.</p>\n\n<pre><code>File= fopen(FileName, \"r\");\n             if( File == NULL ){\n            printf(\"Impossible to open  file %s ! \\n\",FileName);\n        }\n\nif( File != NULL)\n{\n   char text[255];\n   while(!feof(File))\n   {\n      fscanf(File,\"%s\\n\",&amp;text);\n      ....\n   }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6134878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-bLqS5wusO8A/AAAAAAAAAAI/AAAAAAAAADE/cknJejkNhZg/photo.jpg?sz=128", "display_name": "Tamanna Islam", "link": "https://stackoverflow.com/users/6134878/tamanna-islam"}, "is_accepted": false, "score": 1, "last_activity_date": 1474550609, "creation_date": 1474550609, "answer_id": 39640305, "question_id": 39624857, "link": "https://stackoverflow.com/questions/39624857/reading-from-file-txt-to-array-of-strings-and-using-it-to-play-conways-game-of/39640305#39640305", "title": "Reading from file.txt to array of strings and using it to play Conway&#39;s game of Life", "body": "<pre><code>/*\n * spielm.cpp\n *\n *  Created on: 22.09.2016\n *      Author: fislam\n */\n\n\n    #include &lt;iostream&gt;\n    #include &lt;string&gt;\n    #include &lt;fstream&gt;\n    #include &lt;cstring&gt;\n    using namespace std;\n\n\n    void GetFile();\n    bool MakeArray();\n    char ChgArray();\n    //char GameBoard();\n\n    const int ROW1 =10;\n    const int COL1 =10;\n    const int BOARD_ROWS(10);\n    const int BOARD_COLS(10);\n    ifstream myfile;\n    string filename;\n    char live = 'X';\n    char dead = '.';\n\n    char board [BOARD_ROWS][BOARD_COLS];\n\n    int main()\n    {\n        int q;\n\n        //GetFile();\n        if ( MakeArray() ){\n\n          for ( int i(0); i &lt;10; i++)\n             ChgArray();\n        }\n        else {\n          cout &lt;&lt; \"Error parsing input file\" &lt;&lt; endl;\n        }\n\n        cin &gt;&gt; q;\n        return 0;\n    }\n\n\n    void GetFile()\n    {\n        cout&lt;&lt;\"Enter the filename: \\n\";\n        cin&gt;&gt;filename;\n        return;\n    }\n\n    bool MakeArray()\n    {\n        bool ret(false);\n        char val;\n        int  totCnt = BOARD_ROWS*BOARD_COLS;\n        myfile.open (/*filename.c_str()*/\"c_str.txt\");\n        if ( myfile.is_open() ) {\n           for (int r=0; r&lt;ROW1; r++)\n           {\n              for (int c=0; c&lt;COL1; c++)\n              {\n                 myfile&gt;&gt;val;\n                 if ( val == dead || val == live ) {\n                    board[r-1][c-1] = val;\n                    totCnt--;\n                 }\n              }\n           }\n           if ( !totCnt ) {\n             ret = true;\n           }\n           myfile.close();\n        }\nreturn ret;\n    }\n    char getNextState(char b[BOARD_ROWS][BOARD_COLS], int r, int c)\n    {\n       char ret;\n\n       return ret;\n    }\n    char ChgArray()\n    {\n        char boardTmp[BOARD_ROWS][BOARD_COLS];\n        for (int r=0; r&lt;BOARD_ROWS; r++)\n        {\n            for (int c=0; c&lt;BOARD_COLS; c++)\n            {\n\n                boardTmp[r][c] = getNextState(board,r,c);\n\n                cout &lt;&lt; boardTmp[r][c];\n            }\n            cout&lt;&lt;endl;\n        }\n\n        memcpy(board,boardTmp,sizeof(board));\n        cout &lt;&lt; endl;\n\n    }\n</code></pre>\n\n<p>Instead of the previous I wrote new. and it worked</p>\n"}], "owner": {"reputation": 51, "user_id": 6134878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-bLqS5wusO8A/AAAAAAAAAAI/AAAAAAAAADE/cknJejkNhZg/photo.jpg?sz=128", "display_name": "Tamanna Islam", "link": "https://stackoverflow.com/users/6134878/tamanna-islam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 39624986, "answer_count": 2, "score": -2, "last_activity_date": 1474550609, "creation_date": 1474485484, "question_id": 39624857, "link": "https://stackoverflow.com/questions/39624857/reading-from-file-txt-to-array-of-strings-and-using-it-to-play-conways-game-of", "title": "Reading from file.txt to array of strings and using it to play Conway&#39;s game of Life", "body": "<p>I am coding a Conway's Game of Life.My task is  reading from file.txt to array of strings.And then using this array as the input array of the game. I have written a code about it. But it is full of error. I don't know what is the correct way to do this.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;fstream&gt;\n\n    using namespace std;\nnamespace gamearray {\n  int main() \n\n\n    ifstream file_(\"file.txt\");\n    if(file.is_open())\n    {\n        string myArray[10];\n\n        for(int i = 0; i &lt; 10; ++i)\n        {\n        for(int i = 0; i &lt; 10; i++)\n\n            file &gt;&gt; array1[j][i];\n        }\n    }\nreturn 0; \n}\n\nvoid copy(int array1[10][10], int array2[10][10])\n{\n  for(int j = 0; j &lt; 10; j++)\n  {\n        for(int i = 0; i &lt; 10; i++)\n            array2[j][i] = array1[j][i];\n    }\n}\n\n\nvoid life(int array[10][10], char choice)\n{\n\n  int temp[10][10];\n  copy(array, temp);\n    for(int j = 0; j &lt; 10; j++)\n    {\n        for(int i = 0; i &lt; 10; i++)\n        {\n            if(choice == 'm')\n            {\n\n                int count = 0;\n                count = array[j-1][i] +\n                    array[j-1][i-1] +\n                    array[j][i-1] +\n                    array[j+1][i-1] +\n                    array[j+1][i] +\n                    array[j+1][i+1] +\n                    array[j][i+1] +\n                    array[j-1][i+1];\n\n        if(count &lt; 2 || count &gt; 3)\n                    temp[j][i] = 0;\n\n        if(count == 2)\n                    temp[j][i] = array[j][i];\n\n        if(count == 3)\n                    temp[j][i] = 1;\n            }\n\n\n        }\n    }\n\n  copy(temp, array);\n}\n\n\nbool compare(int array1[10][10], int array2[10][10])\n{\n    int count = 0;\n    for(int j = 0; j &lt; 10; j++)\n    {\n        for(int i = 0; i &lt; 10; i++)\n        {\n            if(array1[j][i]==array2[j][i])\n                count++;\n        }\n    }\n\n    if(count == 10*10)\n      return true;\n    else\n      return false;\n}\n\n\nvoid print(int array[10][10])\n{\n    for(int j = 0; j &lt; 10; j++)\n    {\n        for(int i = 0; i &lt; 10; i++)\n        {\n            if(array[j][i] == 1)\n                cout &lt;&lt; '*';\n            else\n                cout &lt;&lt; ' ';\n        }\n        cout &lt;&lt; endl;\n    }\n}\n\n\nint main()\n{gamearray::main(); \n\nint gen0[10][10];\nint todo[10][10];\nint backup[10][10];\nchar neighborhood;\nchar again;\nchar cont;\nbool comparison;\n\n\n{do\n    {\n\n  do\n        {\n    cout &lt;&lt; \"Which neighborhood would you like to use (m): \";\n          cin &gt;&gt; neighborhood;\n        }while(neighborhood != 'm');\n\n  system(\"CLS\");\n  int i = 0;\n\n  do\n        {\n\n            srand(time(NULL));\n\n            for(int j = 0; j &lt; 10; j++)\n            {\n                for (int i = 0; i &lt; 10; i++)\n                    gen0[j][i] = rand() % 2;\n            }\n\n\n\n    if(i == 0)\n                copy(gen0, todo);\n            copy(todo, backup);\n            print(todo);\n          life(todo, neighborhood);\n          i++;\n\n\n    system(\"sleep .5\");\n\n    if(i % 10 == 1 &amp;&amp; i != 1)\n    {\n      cout &lt;&lt; endl;\n\n      do\n      {\n        cout &lt;&lt; \"Would you like to continue this simulation? (y/n): \";\n        cin &gt;&gt; cont;\n      }while(cont != 'y' &amp;&amp; cont != 'n');\n      if(cont == 'n')\n        break;\n    }\n\n    comparison = compare(todo, backup);\n    if(comparison == false)\n      system(\"CLS\");\n    if(comparison == true)\n      cout &lt;&lt; endl;\n        }while(comparison == false);\n  do\n     {\n       cout &lt;&lt; \"Would you like to run another simulation? (y/n): \";\n          cin &gt;&gt; again;\n     }while(again != 'y' &amp;&amp; again != 'n');\n    }while(again == 'y');\n\n    return 0;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "sockets", "select", "grpc"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1474485444, "post_id": 39624822, "comment_id": 66554895, "body": "Any tutorial on using <code>select()</code> should show its basic use."}, {"owner": {"reputation": 49, "user_id": 4938506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb769c5acb75e2e89e7162b7fb69fd6?s=128&d=identicon&r=PG&f=1", "display_name": "rkrten", "link": "https://stackoverflow.com/users/4938506/rkrten"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1474485921, "post_id": 39624822, "comment_id": 66555172, "body": "Actually, select() isn&#39;t the problem (I know how to use it) -- the problem is which functions do I call in gRPC to &quot;process&quot; the file descriptor that popped, and guarantee that gRPC doesn&#39;t block waiting for more data."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1474486089, "post_id": 39624822, "comment_id": 66555257, "body": "It might not be possible. The high-level approach that many RPC libraries provide may not allow you to separate the I/O and function-calling steps."}, {"owner": {"reputation": 49, "user_id": 4938506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb769c5acb75e2e89e7162b7fb69fd6?s=128&d=identicon&r=PG&f=1", "display_name": "rkrten", "link": "https://stackoverflow.com/users/4938506/rkrten"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1474551141, "post_id": 39624822, "comment_id": 66584579, "body": "Hi Barmar, you are correct. According to <a href=\"https://groups.google.com/forum/#!topic/grpc-io/9LzMrNUTKAM\" rel=\"nofollow noreferrer\">gRPC discussion group</a> what I&#39;m trying to do can&#39;t be done. :-("}, {"owner": {"reputation": 1618, "user_id": 18408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4012cb8a467eccb07fc5e1df1160d062?s=128&d=identicon&r=PG", "display_name": "Captain Segfault", "link": "https://stackoverflow.com/users/18408/captain-segfault"}, "edited": false, "score": 0, "creation_date": 1475016616, "post_id": 39624822, "comment_id": 66768838, "body": "Something of an aside, but select() is evil and you should (almost) never call it, because poll() is very portable and doesn&#39;t randomly blow up if you have too many FDs in your process.  The one exception is if you need pselect() -- sadly, ppoll() isn&#39;t very portable."}], "answers": [{"tags": [], "owner": {"reputation": 1618, "user_id": 18408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4012cb8a467eccb07fc5e1df1160d062?s=128&d=identicon&r=PG", "display_name": "Captain Segfault", "link": "https://stackoverflow.com/users/18408/captain-segfault"}, "is_accepted": false, "score": 1, "last_activity_date": 1475016551, "creation_date": 1475016551, "answer_id": 39735517, "question_id": 39624822, "link": "https://stackoverflow.com/questions/39624822/how-do-i-use-select-and-grpc-to-create-a-server/39735517#39735517", "title": "How do I use select() and gRPC to create a server?", "body": "<p>You can't do it, at this point (and probably ever).</p>\n\n<p>One of the big weaknesses of event loops, including direct use of select()/poll() style APIs, is that they aren't composable in any natural way short of direct integration between the two.</p>\n\n<p>We could theoretically add such functionality for Linux -- exporting an epoll_fd with a timerfd which becomes readable if it would be productive to call into a completion queue, but doing so would impose substantial constraints and architectural overhead on the rest of the stack just to support this usecase only on Linux. Everywhere else would require a background thread to manage that fd's readability.</p>\n"}], "owner": {"reputation": 49, "user_id": 4938506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb769c5acb75e2e89e7162b7fb69fd6?s=128&d=identicon&r=PG&f=1", "display_name": "rkrten", "link": "https://stackoverflow.com/users/4938506/rkrten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1475016551, "creation_date": 1474485351, "question_id": 39624822, "link": "https://stackoverflow.com/questions/39624822/how-do-i-use-select-and-grpc-to-create-a-server", "title": "How do I use select() and gRPC to create a server?", "body": "<p>I need to use gRPC but in a single-threaded application (with additional socket channels). Naively, I'm thinking of using select() and depending on which file descriptor pops, calling gRPC to handle the message. My question is, can someone give me a rough (5-10 lines of code) outline skeleton on what I need to call after the select() pops?</p>\n\n<p>Looking at Google's \"hello world\" example in the synchronous case implies a thread pool (which I can't use), and in the asynchronous case shows the main loop blocking -- which doesn't work for me because I need to handle other socket operations.</p>\n"}, {"tags": ["c++", "pointers", "syntax", "operators", "declaration"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 5, "creation_date": 1474484654, "post_id": 39624586, "comment_id": 66554486, "body": "Same exact thing."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1474484768, "post_id": 39624586, "comment_id": 66554540, "body": "That looks like a declaration. A declaration that says that<code>arglist</code> is a pointer to a pointer to a <code>char</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1474484801, "post_id": 39624586, "comment_id": 66554553, "body": "... in both cases."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 4, "creation_date": 1474485393, "post_id": 39624586, "comment_id": 66554878, "body": "The <code>*</code> symbol is used for several different things. In your case it is not being used as a <i>dereferencing</i> operator, it is being used to declare a <i>pointer type</i>. The same symbol <code>*</code> can then be used on such a <i>pointer type</i> to <i>dereference</i> it. So: <code>int* p;</code> declares <code>p</code> an <i>int pointer</i> but <code>int i = *p;</code> <b>dereferences</b> p to extract the <code>int</code> that it points to."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1474485485, "post_id": 39624586, "comment_id": 66554919, "body": "Oh @Galik is right, there was such a thing but someone edited it out?!?!, I will rollback."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1474486361, "post_id": 39624586, "comment_id": 66555430, "body": "<code>**</code> is not an operator. It&#39;s <b>two</b> operators, a <code>*</code> and a <code>*</code>."}], "answers": [{"comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 3, "creation_date": 1474486414, "post_id": 39624685, "comment_id": 66555464, "body": "And, just for fun, <code>char* *arglist</code> is also exactly the same."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474487141, "post_id": 39624685, "comment_id": 66555844, "body": "@PeteBecker thank you for the upvote! Sure they are, and for sure, people should be encouraged to use that <i>just for fun</i>! :)"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474488525, "post_id": 39624685, "comment_id": 66556600, "body": "Re: &quot;<code>char** arglist;</code>, since it partitions the type of the variable&quot; -- with the caution, of course, that the partition is visual, not syntactic. <code>char* x, y;</code> defines <code>y</code> as <code>char</code>, not <code>char*</code>."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474492271, "post_id": 39624685, "comment_id": 66558660, "body": "Correct @PeteBecker!"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 3, "last_activity_date": 1474487469, "last_edit_date": 1495535244, "creation_date": 1474484961, "answer_id": 39624685, "question_id": 39624586, "link": "https://stackoverflow.com/questions/39624586/c-pointer-defererence-declaration-syntax/39624685#39624685", "title": "C++ Pointer Defererence Declaration Syntax", "body": "<blockquote>\n  <p>.. are they both accomplishing the same thing?</p>\n</blockquote>\n\n<p><strong>YES</strong>.</p>\n\n<hr>\n\n<p>This:</p>\n\n<pre><code>char **arglist;\n</code></pre>\n\n<p>is exactly the same as this:</p>\n\n<pre><code>char** arglist;\n</code></pre>\n\n<p>It's a type of syntax, choose one approach and <em>stick</em> to it, so that your code looks homogeneous.</p>\n\n<p>Notice that in your case <code>**</code> is not being used as a dereferencing operator, it is being used to declare a pointer type, as Galik <a href=\"https://stackoverflow.com/a/39624880/2411320\">mentioned</a>.</p>\n\n<p>Also notice that <code>**</code> consists of two star operators. In other words there is not such thing as a <code>**</code> operator.</p>\n\n<p>As a final remark, I also prefer: <code>char** arglist;</code>, since it partitions the type of the variable, from the name of the variable.</p>\n\n<hr>\n\n<p>As Kamil mentioned, this:</p>\n\n<pre><code>char**arglist;\n</code></pre>\n\n<p>would be equivalent, but please do <em>not</em> do this, it affects readability!</p>\n"}, {"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 2, "creation_date": 1474485098, "post_id": 39624693, "comment_id": 66554711, "body": "Yeah, but my keyboard has the space key! :)"}], "tags": [], "owner": {"reputation": 170, "user_id": 3625245, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002491760564/picture?type=large", "display_name": "Kamil", "link": "https://stackoverflow.com/users/3625245/kamil"}, "is_accepted": false, "score": 2, "last_activity_date": 1474484971, "creation_date": 1474484971, "answer_id": 39624693, "question_id": 39624586, "link": "https://stackoverflow.com/questions/39624586/c-pointer-defererence-declaration-syntax/39624693#39624693", "title": "C++ Pointer Defererence Declaration Syntax", "body": "<p>There are no diffrences .<code>char**arglist</code> is as good as others.</p>\n"}, {"tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": false, "score": 2, "last_activity_date": 1474485045, "creation_date": 1474485045, "answer_id": 39624720, "question_id": 39624586, "link": "https://stackoverflow.com/questions/39624586/c-pointer-defererence-declaration-syntax/39624720#39624720", "title": "C++ Pointer Defererence Declaration Syntax", "body": "<p>There is no difference whatsover. It depends on the programmer, some prefer <code>char* ptr;</code> and some <code>char *ptr;</code>.</p>\n\n<p>The same goes for any qualifier that can be added to the type:</p>\n\n<ul>\n<li><code>const int a = 0;</code> and <code>int const a = 0;</code></li>\n<li><code>const int&amp; a = b;</code> and <code>int const&amp; a = b;</code></li>\n<li><code>int &amp;&amp;a = 0;</code> and <code>int &amp;&amp; a = 0;</code></li>\n</ul>\n\n<p>They all mean the same thing in each case.</p>\n"}, {"tags": [], "owner": {"reputation": 637, "user_id": 4692381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5987e748b7ea74525369ec51f4ea8848?s=128&d=identicon&r=PG&f=1", "display_name": "Stalemate Of Tuning", "link": "https://stackoverflow.com/users/4692381/stalemate-of-tuning"}, "is_accepted": false, "score": 4, "last_activity_date": 1474485115, "creation_date": 1474485115, "answer_id": 39624746, "question_id": 39624586, "link": "https://stackoverflow.com/questions/39624586/c-pointer-defererence-declaration-syntax/39624746#39624746", "title": "C++ Pointer Defererence Declaration Syntax", "body": "<p>They are the same thing, it's just style.</p>\n\n<p>You can even do </p>\n\n<pre><code>char ** arglist\n</code></pre>\n\n<p>The white space gets stripped during run-time. I personally prefer <code>char** arglist</code> because it helps me better visualize what the object is.</p>\n"}, {"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 1, "creation_date": 1474485714, "post_id": 39624777, "comment_id": 66555042, "body": "I personally prefer that too, +1 for Kiril having the potential of being a good colleague, I guess! :)"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1474486428, "post_id": 39624777, "comment_id": 66555474, "body": "Declaring lists of variables is more a <code>C</code> legacy thing so it is not something you should really see in <code>C++</code> code. In <code>C++</code> it has always been encouraged to declare variable at the point of use. Traditionally in <code>C</code> all the declarations had to go at the top of the function - hence the long lists of declarations."}], "tags": [], "owner": {"reputation": 35343, "user_id": 435800, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4f40d75bd1227e2a57c77864047cd9f7?s=128&d=identicon&r=PG", "display_name": "Kiril Kirov", "link": "https://stackoverflow.com/users/435800/kiril-kirov"}, "is_accepted": true, "score": 7, "last_activity_date": 1474485540, "last_edit_date": 1474485540, "creation_date": 1474485237, "answer_id": 39624777, "question_id": 39624586, "link": "https://stackoverflow.com/questions/39624586/c-pointer-defererence-declaration-syntax/39624777#39624777", "title": "C++ Pointer Defererence Declaration Syntax", "body": "<p>They are exactly the same. But they are not \"dereferencing a dereference\" in this case, they define a <em>pointer to pointer to <code>char</code></em>.</p>\n\n<hr>\n\n<p>I personally prefer <code>char** arglist</code> because the <code>**</code> is like a part of the type and it's like: </p>\n\n<pre><code>type var_name; // where `type` is `char**` and `var_name` is arglist\n</code></pre>\n\n<p>BUT, on the other side, it may be misleading, because the following:</p>\n\n<pre><code>char** arglist1, arglist2;\n</code></pre>\n\n<p>defines <code>char**</code> variable named <code>arglist1</code>, AND a <code>char</code> variable named <code>arglist2</code>.</p>\n\n<p>So, in order to define 2 variables with type <code>char**</code>, you need</p>\n\n<pre><code>char **arglist1, **arglist2;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>char** arglist1, **arglist2;\n</code></pre>\n\n<p>or, of cource:</p>\n\n<pre><code>char**arglist1, **arglist2;\n</code></pre>\n\n<p>all three are the same, it's a matter of personal preference.</p>\n"}, {"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 1, "creation_date": 1474485645, "post_id": 39624880, "comment_id": 66555015, "body": "Bravo for catching that, even though it was wrongly discarded from OP&#39;s post from another user."}], "tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": false, "score": 3, "last_activity_date": 1474485816, "last_edit_date": 1474485816, "creation_date": 1474485568, "answer_id": 39624880, "question_id": 39624586, "link": "https://stackoverflow.com/questions/39624586/c-pointer-defererence-declaration-syntax/39624880#39624880", "title": "C++ Pointer Defererence Declaration Syntax", "body": "<p>Both syntaxes are identical. But neither one is <em>dereferencing</em> in your examples.</p>\n\n<p>The <code>*</code> symbol is used for several different things. In your case it is not being used as a <em>dereferencing</em> operator, it is being used to declare a <em>pointer type</em>. The same symbol <code>*</code> can then be used on such a <em>pointer type</em> to <em>dereference</em> it. So: <code>int* p;</code> declares <code>p</code> to be of compound type <em>int pointer</em> but <code>int i = *p;</code> <strong>dereferences</strong> p to extract the <code>int</code> that it points to.</p>\n"}], "owner": {"reputation": 3657, "user_id": 1446890, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a48016e6eadd411b8a360abd21cf1805?s=128&d=identicon&r=PG", "display_name": "Adam Templeton", "link": "https://stackoverflow.com/users/1446890/adam-templeton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 39624777, "answer_count": 6, "score": 3, "last_activity_date": 1474487469, "creation_date": 1474484634, "last_edit_date": 1474485531, "question_id": 39624586, "link": "https://stackoverflow.com/questions/39624586/c-pointer-defererence-declaration-syntax", "title": "C++ Pointer Defererence Declaration Syntax", "body": "<p>Incredibly new to C++, and have a (probably fairly dumb) question:</p>\n\n<p>I've seen the <code>**</code> operator (which I understand is dereferencing a dereference) used in both contexts:</p>\n\n<p><code>char **arglist</code></p>\n\n<p><code>char** arglist</code></p>\n\n<p>Is there a meaningful difference between the syntaxes, or are they both accomplishing the same thing?</p>\n"}, {"tags": ["c++", "pointers", "shared-ptr", "void-pointers"], "answers": [{"comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1474483756, "post_id": 39624224, "comment_id": 66554005, "body": "I will always upvote a correct answer that conveys the design perfection of the shared_ptr. +1 :)"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1474484058, "post_id": 39624224, "comment_id": 66554170, "body": "@RichardHodges I prefer <code>std::unique_ptr</code> as they are free in term of overhead ;). As for the answer, good job @rodrigo, it pretty much covers everything."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1474484144, "post_id": 39624224, "comment_id": 66554206, "body": "The <code>shared_ptr</code> <i>does</i> hold a pointer, the one returned from <code>shared_ptr::get()</code>.  But this is not the same pointer that is passed to the deleter."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1474484344, "post_id": 39624224, "comment_id": 66554331, "body": "Thanks for the clarification @BenVoigt. I guess the deleter and the pointer to be deleted must be held in the control block, and the one returned <code>shared_ptr::get()</code> in the shared pointer directly. I&#39;m I right?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1474484446, "post_id": 39624224, "comment_id": 66554391, "body": "@GuillaumeRacicot: Yes.  Because there can be many different instances of <code>shared_ptr</code> pointing to different parts of the object (so <code>get()</code> returns a different value for each), but if all those parts share a common lifetime, all those <code>shared_ptr</code> instances must share the control block."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1474484549, "post_id": 39624224, "comment_id": 66554438, "body": "@BenVoigt: That depends on what you mean with <i>hold</i>. It does not hold a pointer to <code>B</code> directly, but through an intermediate struct (in the GCC implementation that is <code>_Sp_counted_base</code>, that is an abstract class with a couple of implementations, one holds a pointer to <code>B</code>, another conteins the <code>B</code> object itself, built with placement <code>new</code>."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1474484744, "post_id": 39624224, "comment_id": 66554526, "body": "@rodrigo: I&#39;m not talking about the pointer to <code>B</code> -- that one <i>is</i> in the control block.  But the <code>A*</code> or <code>void*</code> returned by <code>ptr.get()</code> or <code>vptr.get()</code> is <i>not</i> in the control block, it is part of the <code>shared_ptr</code> instance."}], "tags": [], "owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "is_accepted": true, "score": 6, "last_activity_date": 1474484160, "last_edit_date": 1474484160, "creation_date": 1474483284, "answer_id": 39624224, "question_id": 39624080, "link": "https://stackoverflow.com/questions/39624080/can-upcasting-a-shared-ptrt-to-a-shared-ptrvoid-lead-to-undefined-behaviour/39624224#39624224", "title": "Can upcasting a shared_ptr&lt;T&gt; to a shared_ptr&lt;void&gt; lead to undefined behaviour?", "body": "<p>The code is correct.</p>\n\n<p><code>std::shared_ptr</code> internally saves the real pointer and the real deleter as they are in the constructor, so no matter how you downcast it, as long as the downcast is valid the deleter will be right.</p>\n\n<p>The <code>shared_ptr</code> actually does not hold a pointer to the object, but a pointer to an intermediate struct that holds the actual object, the reference counter and the deleter. It doesn't matter if you cast the <code>shared_ptr</code>, that intermediate struct does not change. It cannot change because your <code>vptr</code> and <code>ptr</code>, although of different types, share the reference counter (and the object and the deleter, of course).</p>\n\n<p>BTW, that intermediate struct is the reason for the <code>make_shared</code> optimization: it allocates both the intermediate struct and the object itself in the same memory block and avoids the extra allocation.</p>\n\n<p>To illustrate how smart pointers can be, I have written a program with plain pointers that crashes (with GCC 6.2.1) because of your problem:</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;iostream&gt;\n\nstruct A\n{\n    int a;\n    A() :a(1) {}\n    ~A()\n    {\n        std::cout &lt;&lt; \"~A \" &lt;&lt; a &lt;&lt; std::endl;\n    }\n};\n\nstruct X\n{\n    int x;\n    X() :x(3) {}\n    ~X()\n    {\n        std::cout &lt;&lt; \"~X \" &lt;&lt; x &lt;&lt; std::endl;\n    }\n};\n\nstruct B : X, A\n{\n    int b;\n    B() : b(2) {}\n    ~B()\n    {\n        std::cout &lt;&lt; \"~B \" &lt;&lt; b &lt;&lt; std::endl;\n    }\n};\n\nint main()\n{\n    A* a = new B;\n    void * v = a;\n    delete (B*)v; //crash!\n\n    return 0;    \n}\n</code></pre>\n\n<p>Actually it prints the wrong integer values, which proves the UB.</p>\n\n<pre><code>~B 0\n~A 2\n~X 1\n*** Error in `./a.out': free(): invalid pointer: 0x0000000001629c24 ***\n</code></pre>\n\n<p>But the version with smart pointers works just fine:</p>\n\n<pre><code>int main()\n{\n    std::shared_ptr&lt;void&gt; vptr;\n\n    {\n        std::shared_ptr&lt;A&gt; ptr = std::make_shared&lt;B&gt;();\n        vptr = ptr;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>It prints as expected:</p>\n\n<pre><code>~B 2\n~A 1\n~X 3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": false, "score": 4, "last_activity_date": 1474484024, "last_edit_date": 1474484024, "creation_date": 1474483292, "answer_id": 39624226, "question_id": 39624080, "link": "https://stackoverflow.com/questions/39624080/can-upcasting-a-shared-ptrt-to-a-shared-ptrvoid-lead-to-undefined-behaviour/39624226#39624226", "title": "Can upcasting a shared_ptr&lt;T&gt; to a shared_ptr&lt;void&gt; lead to undefined behaviour?", "body": "<p>The <code>shared_ptr</code> always passes the original pointer to the deleter, not the one obtained through <code>vptr.get()</code>.  This is necessary not only to make this case work, but also to have pointers to member subobjects and owned objects as embodied in the constructor overload <code>shared_ptr&lt;T&gt;::shared_ptr(const shared_ptr&lt;T&gt;&amp;, element_type*)</code>.</p>\n\n<p>So this is safe.</p>\n"}], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 1, "accepted_answer_id": 39624224, "answer_count": 2, "score": 3, "last_activity_date": 1474484160, "creation_date": 1474482780, "last_edit_date": 1474483749, "question_id": 39624080, "link": "https://stackoverflow.com/questions/39624080/can-upcasting-a-shared-ptrt-to-a-shared-ptrvoid-lead-to-undefined-behaviour", "title": "Can upcasting a shared_ptr&lt;T&gt; to a shared_ptr&lt;void&gt; lead to undefined behaviour?", "body": "<p>Shared pointers are quite smart. They remember the type they where first constructed with in order to delete them correctly. Take that for example:</p>\n\n<pre><code>struct A { virtual void test() = 0; };\nstruct B : A { void test() override {} };\n\nvoid someFunc() {\n    std::shared_ptr&lt;A&gt; ptr1;\n\n    ptr1 = std::make_shared&lt;B&gt;();\n\n    // Here at the end of the scope, B is deleted correctly\n}\n</code></pre>\n\n<p>However, there seems to be a problem with void pointers: for a downcast of a void pointer to be valid, one must downcast it to the type it was originally upcasted from.</p>\n\n<p>For example:</p>\n\n<pre><code>void* myB = new B;\n\n// Okay, well defined\ndoStuff(static_cast&lt;B*&gt;(myB));\n\n// uh oh, not good!\n// For the same instance of a child object, a pointer to the base and\n// a pointer to the child can be differrent.\ndoStuff(static_cast&lt;A*&gt;(myB));\n</code></pre>\n\n<p>With <code>std::shared_ptr</code>, when you use <code>std::make_shared</code>, the deleter must look similar to this function: <code>[](B* ptr){ delete ptr; }</code>. Since the pointer (in the first example) is holding a <code>B</code> instance in a pointer to <code>A</code> and deletes it correctly, it must downcast it in some way.</p>\n\n<p>My question is: is the following code snippet invokes undefined behaviour?</p>\n\n<pre><code>void someFunc() {\n    {\n        std::shared_ptr&lt;void&gt; ptr = std::make_shared&lt;B&gt;();\n\n        // Deleting the pointer seems okay to me,\n        // the shared_ptr knows that a B was originally allocated with a B and\n        // will send the void pointer to the deleter that's delete a B.\n    }\n\n    std::shared_ptr&lt;void&gt; vptr;\n\n    {\n        std::shared_ptr&lt;A&gt; ptr = std::make_shared&lt;B&gt;();\n\n        // ptr is pointing to the base, which can be \n        // different address than the pointer to the child.\n\n        // assigning the pointer to the base to the void pointer.\n        // according to my current knowledge of void pointers, \n        // any future use of the pointer must cast it to a A* or end up in UB.\n        vptr = ptr;\n    }\n\n    // is the pointer deleted correctly or it tries to\n    // cast the void pointer to a B pointer without downcasting to a A* first?\n    // Or is it well defined and std::shared_ptr uses some dark magic unknown to me?\n}\n</code></pre>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1474483624, "post_id": 39623543, "comment_id": 66553923, "body": "<code>&quot;can the compiler do &quot;something smart&quot; in this case&quot;</code>. With optimization, I expect generated code to be identical to the one for <code>std::cout &lt;&lt; 1 &lt;&lt; &quot;, &quot; &lt;&lt; 2 &lt;&lt; std::endl;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1889, "user_id": 1820428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7dc1b1b726ed9ae7eacf41e3fd576883?s=128&d=identicon&r=PG", "display_name": "Toby Sharp", "link": "https://stackoverflow.com/users/1820428/toby-sharp"}, "edited": false, "score": 0, "creation_date": 1474534576, "post_id": 39623576, "comment_id": 66573387, "body": "But would <code>foo&lt;1&gt;()</code> and <code>foo&lt;2&gt;()</code> count as two different specializations/instantiations?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 1889, "user_id": 1820428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7dc1b1b726ed9ae7eacf41e3fd576883?s=128&d=identicon&r=PG", "display_name": "Toby Sharp", "link": "https://stackoverflow.com/users/1820428/toby-sharp"}, "edited": false, "score": 0, "creation_date": 1474541079, "post_id": 39623576, "comment_id": 66577685, "body": "@TobySharp: Those are two different specializations (because they have different template arguments). I was responding you having &quot;lots of calls like <code>foo&lt;398&gt;()</code>; only <i>one</i> instance of <code>foo&lt;398&gt;</code> is created and then used repeatedly. Separate instances are created for separate specializations."}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": true, "score": 1, "last_activity_date": 1474481033, "creation_date": 1474481033, "answer_id": 39623576, "question_id": 39623543, "link": "https://stackoverflow.com/questions/39623543/do-template-functions-of-integer-types-lead-to-multiple-compiled-instances/39623576#39623576", "title": "Do template functions of integer types lead to multiple compiled instances?", "body": "<p>Within each translation unit, there is a magic <em>point of instantiation</em> for each template specialization, and each template specialization is instantiated at most <em>once</em> per translation unit.</p>\n\n<p>There's still a very interesting problem of how <em>different</em> translation units link together (and indeed the linker needs to know how C++ works and deduplicate), but at least intra-TU there's only one version of the function.</p>\n\n<p>(The instantiation point is when the second phase of the two-phase lookup happens. So you only get an error once (at instantiation time), not for every time you use the specialization.)</p>\n"}, {"comments": [{"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 1, "creation_date": 1474482185, "post_id": 39623773, "comment_id": 66553159, "body": "godbolt provides a more instructive example: <a href=\"https://godbolt.org/g/DYXtHs\" rel=\"nofollow noreferrer\">godbolt.org/g/DYXtHs</a>  Scroll down to line 45 of the generated code to see that two instantiations are present."}, {"owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "reply_to_user": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1474483308, "post_id": 39623773, "comment_id": 66553758, "body": "@xaxxon nice! I didn&#39;t know that website and I don&#39;t have a linux terminal available right now. thanks"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 1, "creation_date": 1474484359, "post_id": 39623773, "comment_id": 66554338, "body": "Addressing the &quot;something smart&quot; question, compiled with -O2 I&#39;d expect to see no functions generated at all (unless their address was taken)."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1474484698, "post_id": 39623773, "comment_id": 66554502, "body": "Well, sure, when you <b>take the addresses</b> of template functions you get different addresses for different instances. That does <b>not</b> mean that simply calling them has to produce two separate instances."}, {"owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474484874, "post_id": 39623773, "comment_id": 66554595, "body": "@PeteBecker maybe on a trivial example like this one it is possible to optimize them away. In an everyday example though, one that for some reason requires an integral template parameter instead of a regular one, different instances will probably be created."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1474485003, "post_id": 39623773, "comment_id": 66554664, "body": "Sorry, this doesn&#39;t really address the question. A compiler (and linker) can optimize identical object code of several template instantiations into a single copy. This is called <i>Identical COMDAT Folding</i> (<a href=\"https://msdn.microsoft.com/en-us/library/bxwfs976.aspx\" rel=\"nofollow noreferrer\">with Microsoft&#39;s compiler</a>)."}, {"owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474485256, "post_id": 39623773, "comment_id": 66554795, "body": "@IInspectable, is that guaranteed on every case? Can you provide a live example?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1474485350, "post_id": 39623773, "comment_id": 66554859, "body": "@imreal -- regardless of what you think real-world examples might do, your example does not address the question. Your example <b>requires</b> separate instantiations, hence, cannot be used to determine whether, in general, it is possible to not generate separate instantiations."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1474485606, "post_id": 39623773, "comment_id": 66554994, "body": "@imreal: Live examples? Just compile any source base using templates, and toggle the switch on and off. Observe the sizes of the generated binaries, and look around the image with tools like DUMPBIN. Another live example: Step into template code in Visual Studio. When ICF is at work you have to manually pick the specific instantiation from a list of possible candidates. When you see that dialog pop up, you know that there is a 1-to-many mapping between object code and source code."}, {"owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474485633, "post_id": 39623773, "comment_id": 66555009, "body": "@PeteBecker I am not used to make assumptions as to how code will be changed to, end up being used, optimizations or anything that is not guaranteed on the standard."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1474485769, "post_id": 39623773, "comment_id": 66555077, "body": "@imreal - the standard does not require separate instantiations. It requires that the addresses of different instantiations be different, but that&#39;s only meaningful <b>if you take the address</b> of two or more instantiations. If you don&#39;t take their addresses, you cannot tell whether they are in the same location, so the compiler is free to do pretty much anything it wants, as long as the resulting code works correctly. Formally, that&#39;s the &quot;as if&quot; rule: the compiler has to produce the result <b>as if</b> it had done what&#39;s formally required, but doesn&#39;t have to actually do what&#39;s required."}, {"owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474486189, "post_id": 39623773, "comment_id": 66555327, "body": "@PeteBecker Ok we agree, in the exact specific example provided by the OP it IS possible to optimize it. But I don&#39;t know how the real code looks like or what do his templates do, or which compiler/optimizations he uses, so I don&#39;t think it is wise to mislead him into assuming anything."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1474486286, "post_id": 39623773, "comment_id": 66555384, "body": "@imreal - but your answer <b>is</b> misleading, since it says that the compiler <b>can never</b> optimize these things away."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1474488129, "post_id": 39623773, "comment_id": 66556395, "body": "You still seem completely confused, how ICF works (and similar schemes). For ICF, the compiler will <b>always</b> generate object code for each instantiation. It&#39;s the linker that determines, whether the generated object code for several objects is identical, and merges them into a single copy (if otherwise possible). And sure, turning off optimizations turns off optimizations. That&#39;s not entirely surprising."}, {"owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474488861, "post_id": 39623773, "comment_id": 66556814, "body": "@IInspectable I think I&#39;ve been very clear in that I know that it is POSSIBLE to optimize the original code. But I also provided an example that prevents that optimization from happening (even with -O3). So it is not an optimization that can be relied on. Maybe if you write a huge ugly comment in the code instructing other developers to not take the address of that function or change it in any way."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474490624, "post_id": 39623773, "comment_id": 66557764, "body": "@IInspectable in clang -no-deduplication turns it off.   it can take a VERY long time.   I have a project that goes from a 5s link to 150s link by allowing deduplication in clang.  The binary increases by ~2.5% by making the link 30x worse."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474490775, "post_id": 39623773, "comment_id": 66557857, "body": "You provided an example, where the optimization would have violated language rules. The optimizer has to stay within the limits of the as-if rule. There are many other ways that prevent the optimizer from doing anything to the code. None of that warrants an answer, that an optimization wouldn&#39;t be possible for general, complex code (as yours implies). Anyway, I voted on your proposed answer, and explained why <i>down</i> is the correct vote. There is no reason for me to repeat this."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 1, "creation_date": 1474490877, "post_id": 39623773, "comment_id": 66557910, "body": "@xaxxon: Clang produces larger binaries when deduplication is enabled? That doesn&#39;t sound right."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474490913, "post_id": 39623773, "comment_id": 66557934, "body": "@IInspectable sorry, there were lots of negatives in my previous statement.   The project builds much slower and very slightly larger with deduplication turned on.  This particular project is VERY heavily templated.  Someone over on the official llvm irc channel helped me figure out what was going on.  Also, this is only the case with -O0.   Once a lot of the functions are inlined, it gets much better.   Of course -flto kills the linker time."}], "tags": [], "owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "is_accepted": false, "score": -1, "last_activity_date": 1474486423, "last_edit_date": 1474486423, "creation_date": 1474481742, "answer_id": 39623773, "question_id": 39623543, "link": "https://stackoverflow.com/questions/39623543/do-template-functions-of-integer-types-lead-to-multiple-compiled-instances/39623773#39623773", "title": "Do template functions of integer types lead to multiple compiled instances?", "body": "<p>Yes, every instantiation with a different number will generate new binary code. This is a modified version of your example that proves that both functions have different addresses.</p>\n\n<pre><code>int main()\n{\n    int (*p1)() = &amp;foo&lt;1&gt;;\n    int (*p2)() = &amp;foo&lt;3&gt;;\n\n    std::cout &lt;&lt; (void*)(p1) &lt;&lt; \", \" &lt;&lt; (void*)(p2) &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Here is a live example: <a href=\"http://ideone.com/w5peQV\" rel=\"nofollow\">http://ideone.com/w5peQV</a></p>\n\n<p>EDIT: Better example by @xaxxon <a href=\"http://godbolt.org/g/DYXtHs\" rel=\"nofollow\">http://godbolt.org/g/DYXtHs</a> </p>\n\n<p>DISCLAIMER: Your original example and other trivial examples like it ARE optimizable by the compiler, the function will probably be optimized away.<br>\nBut if you take addresses of your functions, have more complex code or simply disable optimizations, it is not guaranteed that it will be optimized away and your compiler WILL generate code for each instantiation.</p>\n"}], "owner": {"reputation": 1889, "user_id": 1820428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7dc1b1b726ed9ae7eacf41e3fd576883?s=128&d=identicon&r=PG", "display_name": "Toby Sharp", "link": "https://stackoverflow.com/users/1820428/toby-sharp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 39623576, "answer_count": 2, "score": 0, "last_activity_date": 1474486423, "creation_date": 1474480897, "last_edit_date": 1474481113, "question_id": 39623543, "link": "https://stackoverflow.com/questions/39623543/do-template-functions-of-integer-types-lead-to-multiple-compiled-instances", "title": "Do template functions of integer types lead to multiple compiled instances?", "body": "<p>In the code below, does each instantiation of the template function lead to separate compiled object code? In other words, if I had lots of function calls like <code>foo&lt;398&gt;()</code> would this explode the size of the binary, or can the compiler do \"something smart\" in this case?</p>\n\n<p>Sorry for a slightly vagueish question. Pointers to the appropriate docs welcome.</p>\n\n<pre><code>template &lt;int N&gt;\nint foo()\n{\n   return N;\n}\nint main()\n{\n  int a = foo&lt;1&gt;();\n  int b = foo&lt;2&gt;();\n  std::cout &lt;&lt; a &lt;&lt; \", \" &lt;&lt; b &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1474480788, "post_id": 39623493, "comment_id": 66552449, "body": "This is not well-formed C++."}, {"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 2, "creation_date": 1474480862, "post_id": 39623493, "comment_id": 66552486, "body": "You explicitly create an array of length 1 and then try to access the second element..."}, {"owner": {"reputation": 31, "user_id": 6655073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ccb37831667a41c31b0c73cecf65eee?s=128&d=identicon&r=PG&f=1", "display_name": "Colonbracket", "link": "https://stackoverflow.com/users/6655073/colonbracket"}, "edited": false, "score": 0, "creation_date": 1474480871, "post_id": 39623493, "comment_id": 66552492, "body": "yeah im just starting out with c++.. :)"}, {"owner": {"reputation": 775, "user_id": 1990747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e768662f51a5df9eb2f247a5ddfc90e?s=128&d=identicon&r=PG", "display_name": "Tim Beaudet", "link": "https://stackoverflow.com/users/1990747/tim-beaudet"}, "edited": false, "score": 0, "creation_date": 1474481367, "post_id": 39623493, "comment_id": 66552742, "body": "You mean to use <code>cout &lt;&lt; &quot;Your score is: &quot; &lt;&lt; players[0] &lt;&lt; endl;</code>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1474481393, "post_id": 39623493, "comment_id": 66552757, "body": "One problem with updated code is you create an array of size 1. I would use <code>std::vector</code> instead."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1474481401, "post_id": 39623493, "comment_id": 66552760, "body": "Sorry but this doesn&#39;t seem like a reusable question"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1474481982, "post_id": 39623493, "comment_id": 66553057, "body": "The question doesn&#39;t say <code>Player[1]</code>. Don&#39;t alter the question to fit the answer!"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1474482686, "post_id": 39623493, "comment_id": 66553421, "body": "@Colonbracket  <b>Do not use variable length arrays</b>.  They are not standard, and also lead to other issues (like blowing out the stack if the number of entries in the array is too large).  Instead use <code>std::vector</code>.  If you had used <code>std::vector</code> (along with <code>at()</code> to access your items), you wouldn&#39;t have gotten a segmentation fault, but instead, this error, <a href=\"http://ideone.com/g3YEso\" rel=\"nofollow noreferrer\">explicitly stating what&#39;s wrong</a>."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474489201, "post_id": 39623493, "comment_id": 66557001, "body": "I upvoted your question because I don&#39;t see many programs that people write that confuse them.  I like to believe that people write programs that they can understand (or only use features that they understand)."}], "answers": [{"comments": [{"owner": {"reputation": 775, "user_id": 1990747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e768662f51a5df9eb2f247a5ddfc90e?s=128&d=identicon&r=PG", "display_name": "Tim Beaudet", "link": "https://stackoverflow.com/users/1990747/tim-beaudet"}, "edited": false, "score": 0, "creation_date": 1474481171, "post_id": 39623519, "comment_id": 66552636, "body": "While that would fix the problem, it isn&#39;t what you want. When you try to access the array for the first player, you want to access players[0]. For the second player, it would be players[1]."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474482324, "post_id": 39623519, "comment_id": 66553220, "body": "Are you seriously suggesting, that the fix is to adjust the index, instead of - say - stop the entire array-of-size-1 madness?"}], "tags": [], "owner": {"reputation": 775, "user_id": 1990747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e768662f51a5df9eb2f247a5ddfc90e?s=128&d=identicon&r=PG", "display_name": "Tim Beaudet", "link": "https://stackoverflow.com/users/1990747/tim-beaudet"}, "is_accepted": false, "score": 3, "last_activity_date": 1474480812, "creation_date": 1474480812, "answer_id": 39623519, "question_id": 39623493, "link": "https://stackoverflow.com/questions/39623493/c-my-program-has-confused-me-greatly/39623519#39623519", "title": "C++ My program has confused me greatly", "body": "<p>C++ arrays are 0 based.</p>\n\n<p><code>players[1]</code> is accessing a location outside the range of the array.</p>\n\n<p>You will want: <code>players[0]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 775, "user_id": 1990747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e768662f51a5df9eb2f247a5ddfc90e?s=128&d=identicon&r=PG", "display_name": "Tim Beaudet", "link": "https://stackoverflow.com/users/1990747/tim-beaudet"}, "edited": false, "score": 1, "creation_date": 1474481271, "post_id": 39623612, "comment_id": 66552692, "body": "Using extra space to avoid access overflow is not the best advice, you should be able to create an array of a desired size and use it properly by indexing from 0 to arraySize - 1"}, {"owner": {"reputation": 31, "user_id": 6655073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ccb37831667a41c31b0c73cecf65eee?s=128&d=identicon&r=PG&f=1", "display_name": "Colonbracket", "link": "https://stackoverflow.com/users/6655073/colonbracket"}, "edited": false, "score": 0, "creation_date": 1474481368, "post_id": 39623612, "comment_id": 66552743, "body": "Sorry the code i gave in my post was outdated and has now been updated. I had already changed it to player[0], but thanks for being helpful. However now it just prints out a &quot;@&quot; instead of the message?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1474482495, "post_id": 39623612, "comment_id": 66553311, "body": "<i>&quot;Which causes Access Overflow for the program.&quot;</i> - No. It&#39;s undefined behavior. You cannot produce a definitive answer to a construct, that isn&#39;t defined. <i>&quot;Always take some extra indices in case of array size to avoid access overflow.&quot;</i> - Now frankly, <b>that</b> was the reason to down vote on this proposed answer. You cannot possibly be serious about this."}, {"owner": {"reputation": 410, "user_id": 3731282, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/92cb257edc3646a5323f2af0f3a5a699?s=128&d=identicon&r=PG&f=1", "display_name": "nimteaj", "link": "https://stackoverflow.com/users/3731282/nimteaj"}, "edited": false, "score": 0, "creation_date": 1474488173, "post_id": 39623612, "comment_id": 66556417, "body": "I appreciate the mention of &quot;taking extra spaces&quot;, I have updated the answer. Always used to take extra spaces, but after all it&#39;s really a bad idea, I should not have included that into my answer."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474537992, "post_id": 39623612, "comment_id": 66575661, "body": "Still bogus, I mean, what the hell is an <i>&quot;Access Overflow&quot;</i>? A library granting too much access to an object, so that the client code overflows? And a statement that attributes verifiable and reproducible outcome to code that exhibits undefined behavior is just wrong, no matter how you slice it."}, {"owner": {"reputation": 410, "user_id": 3731282, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/92cb257edc3646a5323f2af0f3a5a699?s=128&d=identicon&r=PG&f=1", "display_name": "nimteaj", "link": "https://stackoverflow.com/users/3731282/nimteaj"}, "edited": false, "score": 0, "creation_date": 1474650019, "post_id": 39623612, "comment_id": 66633564, "body": "I have got your point and updated the answer. Also I found <a href=\"http://stackoverflow.com/questions/1239938/accessing-an-array-out-of-bounds-gives-no-error-why\">this post</a> very helpful."}], "tags": [], "owner": {"reputation": 410, "user_id": 3731282, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/92cb257edc3646a5323f2af0f3a5a699?s=128&d=identicon&r=PG&f=1", "display_name": "nimteaj", "link": "https://stackoverflow.com/users/3731282/nimteaj"}, "is_accepted": false, "score": 0, "last_activity_date": 1474649932, "last_edit_date": 1474649932, "creation_date": 1474481132, "answer_id": 39623612, "question_id": 39623493, "link": "https://stackoverflow.com/questions/39623493/c-my-program-has-confused-me-greatly/39623612#39623612", "title": "C++ My program has confused me greatly", "body": "<p>Definitely it crashes for the below line:</p>\n\n<pre><code>players[1]=players[1]+x+y;\n</code></pre>\n\n<p>Because size of <code>players</code> array is 1, so it has only index <strong>0</strong>. And in above line, it tries to access index <strong>1</strong>. Take a look at <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\" rel=\"nofollow\" title=\"Buffer Overflow\">Buffer Overflow</a> and array index out of bounds.</p>\n\n<ul>\n<li>Try to define an array with constant size.</li>\n<li>If you need a dynamic array, use linked list or vector.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 775, "user_id": 1990747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e768662f51a5df9eb2f247a5ddfc90e?s=128&d=identicon&r=PG", "display_name": "Tim Beaudet", "link": "https://stackoverflow.com/users/1990747/tim-beaudet"}, "edited": false, "score": 0, "creation_date": 1474481841, "post_id": 39623719, "comment_id": 66552972, "body": "I&#39;m pretty sure the array is declared correctly, it couldn&#39;t be a member without const size, and if the size is too large for stack it could fail. Probably not a good habit to do, agreed, but I&#39;m not sure there is anything incorrect about it in this, or original, context."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 775, "user_id": 1990747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e768662f51a5df9eb2f247a5ddfc90e?s=128&d=identicon&r=PG", "display_name": "Tim Beaudet", "link": "https://stackoverflow.com/users/1990747/tim-beaudet"}, "edited": false, "score": 1, "creation_date": 1474481952, "post_id": 39623719, "comment_id": 66553038, "body": "@TimBeaudet: It&#39;s definitely incorrect. Arrays cannot have runtime bounds."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 775, "user_id": 1990747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e768662f51a5df9eb2f247a5ddfc90e?s=128&d=identicon&r=PG", "display_name": "Tim Beaudet", "link": "https://stackoverflow.com/users/1990747/tim-beaudet"}, "edited": false, "score": 0, "creation_date": 1474482543, "post_id": 39623719, "comment_id": 66553340, "body": "@TimBeaudet: And it&#39;s not a member :)"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 0, "last_activity_date": 1474482073, "last_edit_date": 1474482073, "creation_date": 1474481559, "answer_id": 39623719, "question_id": 39623493, "link": "https://stackoverflow.com/questions/39623493/c-my-program-has-confused-me-greatly/39623719#39623719", "title": "C++ My program has confused me greatly", "body": "<pre><code>cout &lt;&lt; (\"Your score is\" + players[1]) &lt;&lt; endl;\n</code></pre>\n\n<p>Here you're trying to use direct string concatenation, but you can't concatenate a string literal with an integer like that. You end up doing pointer arithmetic, which is definitely not what you intended.</p>\n\n<p>You should instead use <code>cout</code>'s built-in formatting:</p>\n\n<pre><code>cout &lt;&lt; \"Your score is\" &lt;&lt; players[1] &lt;&lt; endl;\n</code></pre>\n\n<p>Your next problem is that <code>players</code> is not declared correctly; an array cannot have runtime bounds, and <code>numplayers</code> (despite having only the one initial value) is ultimately a \"runtime\" variable. You would be better off with a <code>std::vector</code> if the size of the array is going to change later; otherwise make <code>numplayers</code> a <code>constexpr</code>.</p>\n\n<p>Your last problem is that, if the array declaration <em>were</em> valid, you'd be trying to access the second element of a one-element array! The first element is <code>players[0]</code>, not <code>players[1]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 319, "user_id": 5408945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb66f912dedbe170da54892afa002906?s=128&d=identicon&r=PG&f=1", "display_name": "Awais", "link": "https://stackoverflow.com/users/5408945/awais"}, "is_accepted": false, "score": 0, "last_activity_date": 1474484060, "creation_date": 1474484060, "answer_id": 39624419, "question_id": 39623493, "link": "https://stackoverflow.com/questions/39623493/c-my-program-has-confused-me-greatly/39624419#39624419", "title": "C++ My program has confused me greatly", "body": "<p>There are many things you're doing not good.</p>\n\n<ul>\n<li>I believe you're using C++, there is no known way to me about creating arrays of dynamic size i.e. <code>int players[numplayers]</code>. In C++ either we can create array of fixed size i.e. <code>int players[10]</code> or use <em>pointer</em> to an array for dynamically allocated memory e.g. <code>int* players = new int[numplayers]</code>. This allocates an array of size <code>numplayers</code> and an <em>int pointer</em> named players is pointing to it. We can use this pointer as normal array e.g. printing 1st index of array is written as <code>player[0]</code> or another syntax is <code>*(player + 0)</code>. Remember to delete this dynamically allocated memory at the end of program i.e. <code>delete[] player</code>.</li>\n<li>Second thing is when you have allocated an array and are using its value for computation, always initialize it to 0 as newly allocated array contains garbage value and it will affect your computations. code for initializing it to zero may be like this:</li>\n</ul>\n\n<p>Here is the loop:</p>\n\n<pre><code>for(int i = 0 ; i &lt; numplayers ; i++){\n    player[i]=0;\n    //another syntax is : *(player + i) = 0;\n}\n</code></pre>\n\n<ul>\n<li><em>C++</em> does not concat as you did in your <code>std::cout</code> statement. Make it like this:\n<code>cout &lt;&lt; \"Your score is\" &lt;&lt; players[0] &lt;&lt; endl;</code></li>\n<li><p>In C++, arrays always start with index zero, so 1st index will be 0 in this case. So your program will work well if it is like this:</p>\n\n<pre><code>int numplayers = 1;\nint* players = new int[numplayers];\nint x = 0, y = 0;\nsrand(time(0));\nx = (rand() % 6 + 1);\ny = (rand() % 6 + 1);\nplayers[0] = 0;\nplayers[0] = players[0] + x + y;\ncout &lt;&lt; \"Your score is\" &lt;&lt; players[0] &lt;&lt; endl;\ndelete[] players;\n\nreturn 0;\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 6655073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ccb37831667a41c31b0c73cecf65eee?s=128&d=identicon&r=PG&f=1", "display_name": "Colonbracket", "link": "https://stackoverflow.com/users/6655073/colonbracket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "closed_date": 1474493614, "answer_count": 4, "score": -6, "last_activity_date": 1474649932, "creation_date": 1474480714, "last_edit_date": 1474481995, "question_id": 39623493, "link": "https://stackoverflow.com/questions/39623493/c-my-program-has-confused-me-greatly", "closed_reason": "Not suitable for this site", "title": "C++ My program has confused me greatly", "body": "<p>Here it is:</p>\n\n<pre><code>#include &lt;iostream&gt;    \n#include &lt;cstdlib&gt; // for rand() and srand()\n#include &lt;ctime&gt;\nusing namespace \nint main()\n{\n   //cout &lt;&lt; \"How many players?\" &lt;&lt; endl;\n    int numplayers=1;\n   //cin &gt;&gt; numplayers;\n\n    int players[numplayers];\n    int x=0,y=0;\n    srand(time(0));\n    x=(rand() % 6 + 1);\n    y=(rand() % 6 + 1);\n    players[1]=players[1]+x+y;\n    cout &lt;&lt; (\"Your score is\" + players[1]) &lt;&lt; endl;\n    cin &gt;&gt; numplayers;       \n}\n</code></pre>\n\n<p>Ok My original problem was that this always crashed, now it prints \"@\"??? </p>\n"}, {"tags": ["c++", "error-handling", "combinations"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1474480763, "post_id": 39623451, "comment_id": 66552436, "body": "Integer overflow? Have you tried using e.g. <code>long</code>? Or <code>long long</code>? Or the <code>unsigned variants</code>? And please learn how to use a debugger and step through the code line by line to see what&#39;s happening, while monitoring the variables and their values."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1474480870, "post_id": 39623451, "comment_id": 66552489, "body": "Also, since the division you make is an integer division, assigning it to a floating-point variable doesn&#39;t matter, you won&#39;t get any decimals anyway."}, {"owner": {"reputation": 319, "user_id": 5408945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb66f912dedbe170da54892afa002906?s=128&d=identicon&r=PG&f=1", "display_name": "Awais", "link": "https://stackoverflow.com/users/5408945/awais"}, "edited": false, "score": 0, "creation_date": 1474481756, "post_id": 39623451, "comment_id": 66552934, "body": "<code>subs</code> is being set to <code>45</code> in this case. <code>factsubs</code> is 1. when you try to multiply it with <code>init</code> in a loop which eventually increments to <code>45</code> causes integer overflow for <code>factsubs</code>, its value goes to minus numbers and eventually after some multiplication it is set to <code>0</code>. Now <code>init * 0 = 0</code>. You may use <code>long long</code> for <code>finalAnswer</code> and <code>factsubs</code> that may work on it. Remember if it works, the problem will regenerate with higher values."}], "answers": [{"comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 2, "creation_date": 1474482433, "post_id": 39623792, "comment_id": 66553279, "body": "The size of an <code>int</code> (or any other type) doesn&#39;t depend on the compiler. It depends on the architecture."}], "tags": [], "owner": {"reputation": 11, "user_id": 4628809, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-42uWYdi7ZzA/AAAAAAAAAAI/AAAAAAAAADo/40HIP2Hiuqs/photo.jpg?sz=128", "display_name": "VVI C And C 15", "link": "https://stackoverflow.com/users/4628809/vvi-c-and-c-15"}, "is_accepted": false, "score": 0, "last_activity_date": 1474481803, "creation_date": 1474481803, "answer_id": 39623792, "question_id": 39623451, "link": "https://stackoverflow.com/questions/39623451/division-by-zero-occurred-when-doing-combinations/39623792#39623792", "title": "Division by zero occurred when doing combinations", "body": "<p>10! is very big: 3.628.800 - if this one is big, just imagine 50!</p>\n\n<p>Depending on what compiler you are using, you might handle preety good 15! using long long. However that is not big enough - so you need to do something else... You can make an algorithm for multiplication that returns a character array - there is no way to return a long int or something else like that.</p>\n"}, {"tags": [], "owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1474529835, "last_edit_date": 1474529835, "creation_date": 1474482560, "answer_id": 39624008, "question_id": 39623451, "link": "https://stackoverflow.com/questions/39623451/division-by-zero-occurred-when-doing-combinations/39624008#39624008", "title": "Division by zero occurred when doing combinations", "body": "<p>You need to change the multiply-at-one-go approach.</p>\n\n<ul>\n<li>Don't calculate <code>N!</code> at one go.</li>\n<li>Use the fact that division of any two positive integers reduces the end result, so favor division to have the lower intermediate values.</li>\n</ul>\n\n<p><strong>Expand</strong> the expression of <code>N!/(N-K)! * K!</code> to accommodate as much of division operation in <strong><em>intermediate</em></strong> steps as possible to lessen the chance of overflow. </p>\n\n<p>Do not go for calculation of <code>N!</code> or <code>(N-K)!</code> or <code>K!</code> separately, you are more likely to face the overflow problem. Instead use the fact that <em>eventually</em> you need to divide the big numbers, why not do it <strong>before</strong> it becomes <strong>BIG</strong>!</p>\n\n<p>More hints:</p>\n\n<pre><code>N!/(N-K)! = multiply i[N..N-K+1] one by one //not i[N..1] \n</code></pre>\n\n<p>and, check if any factor(<code>f</code>) of value <code>j from [2..K]</code> perfectly divides the intermediate-product-value(<code>p</code>), if yes, do the division : <code>p = p/f</code> and <code>j = j/f</code>. </p>\n"}], "owner": {"reputation": 43, "user_id": 6858834, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/3a11940f78762fc5a6dda2fcacd60a05?s=128&d=identicon&r=PG&f=1", "display_name": "chloe.t", "link": "https://stackoverflow.com/users/6858834/chloe-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1474529835, "creation_date": 1474480553, "last_edit_date": 1474487788, "question_id": 39623451, "link": "https://stackoverflow.com/questions/39623451/division-by-zero-occurred-when-doing-combinations", "title": "Division by zero occurred when doing combinations", "body": "<p>I'm trying to compute math combinations. The formula I'm using is <code>N! / K! (N-K)!</code>. </p>\n\n<p>I am able to get the right answer (<code>10</code>) with <code>N=5</code>, <code>K=2</code>, and <code>120</code> from <code>N=10</code>, <code>K=3</code>. </p>\n\n<p>BUT when I tried to test with bigger number like <code>N=50</code>, <code>K=5.</code> The integer division by zero error popped out. </p>\n\n<p>I tried to define <code>finalAns</code> with <code>long int</code> but it does not work as well. Any ideas?</p>\n\n<pre><code>int N;\nint init;\nint K;\nint factN = 1;\nint factK = 1;\ndouble finalAns;\n\ncout &lt;&lt; \"Input of N = \";\ncin &gt;&gt; N;\ncout &lt;&lt; \"Input of K = \";\ncin &gt;&gt; K;\n\nint subs = N - K;\nint factsubs = 1;\n\nfor (init = 1; init &lt;= N; init++)\n{\n\n    factN = factN * init;\n}\nfor (init = 1; init &lt;= K; init++)\n{\n\n    factK = factK * init;\n}\ncout &lt;&lt; \"K is \" &lt;&lt; factK &lt;&lt; endl;\nfor (init = 1; init &lt;= subs; init++)\n{\n\n    factsubs = factsubs * init;\n}\n\nfinalAns = factN / (factK * factsubs);\ncout &lt;&lt; N &lt;&lt; \"C\" &lt;&lt; K &lt;&lt; \" is \" &lt;&lt; finalAns &lt;&lt; endl;\n</code></pre>\n"}, {"tags": ["c++", "c++11", "shared-ptr"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 3, "creation_date": 1474480443, "post_id": 39623390, "comment_id": 66552292, "body": "Well, the pointer arithmetic is wrong: <code>p.get()</code> is not a pointer to an element of an array of <code>A</code>."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1474480865, "post_id": 39623390, "comment_id": 66552487, "body": "Also, your deleter has undefined behaviour. (That&#39;s arguably your deleter&#39;s fault and could be fixed, but it goes to show how complicated this gets.)"}, {"owner": {"reputation": 1058, "user_id": 3348786, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/81dfe78a5a5efc504c9cb01ffb412391?s=128&d=identicon&r=PG&f=1", "display_name": "AntiElephant", "link": "https://stackoverflow.com/users/3348786/antielephant"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1474481171, "post_id": 39623390, "comment_id": 66552637, "body": "@KerrekSB Oh, is that to say <code>p.get()+1</code> would move the address the wrong &quot;amount&quot; (size of an A object instead of the size of a B object) and I probably haven&#39;t moved across one B object worth (that would be some sort of undefined behaviour surely)? I&#39;m guessing that&#39;s then the problem faced with the deleter too.  If that&#39;s true, I&#39;m guessing in general derived-to-base conversions of arrays of derived-type must be a bad idea."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1474481299, "post_id": 39623390, "comment_id": 66552706, "body": "Yes, those would be practical problems you&#39;d face at implementation level, but it&#39;s all just undefined behaviour as far as the language rules are concerned."}, {"owner": {"reputation": 1058, "user_id": 3348786, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/81dfe78a5a5efc504c9cb01ffb412391?s=128&d=identicon&r=PG&f=1", "display_name": "AntiElephant", "link": "https://stackoverflow.com/users/3348786/antielephant"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1474481548, "post_id": 39623390, "comment_id": 66552822, "body": "@KerrekSB I see, thank you."}], "owner": {"reputation": 1058, "user_id": 3348786, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/81dfe78a5a5efc504c9cb01ffb412391?s=128&d=identicon&r=PG&f=1", "display_name": "AntiElephant", "link": "https://stackoverflow.com/users/3348786/antielephant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1474481862, "answer_count": 0, "score": 1, "last_activity_date": 1474481600, "creation_date": 1474480342, "last_edit_date": 1474481600, "question_id": 39623390, "link": "https://stackoverflow.com/questions/39623390/type-problems-of-shared-pointer-to-dynamic-array-of-derived-type", "closed_reason": "Duplicate", "title": "Type problems of shared pointer to dynamic array of derived type?", "body": "<p>From Effective Modern C++ by Scott Meyers, in reference to shared_ptrs to dynamic arrays (Item 19). </p>\n\n<blockquote>\n  <p>For one thing, std::shared_ptr offers no operator[], so indexing into the array requires awkward expressions based on pointer arithmetic. For another, std::shared_ptr supports derived-to-base pointer conversions that make sense for single objects, <strong>but that open holes in the type system when applied to arrays</strong>. (For this reason, the std::unique_ptr API prohibits such conversions.)</p>\n</blockquote>\n\n<pre><code>class A{\npublic:\n    virtual ~A() = default;\n    virtual void test(){ std::cout &lt;&lt; \"Ayyyyy\" &lt;&lt; std::endl;}\n\n};\n\nclass B : public A {\npublic:\n    virtual void test() override  {std::cout &lt;&lt; \"Beeeeeee\" &lt;&lt; std::endl;}\n\n};\n\nint main(){\n\n    std::shared_ptr&lt;A&gt; p(new B[10], [](A* a){ delete [] a;});\n\n    (p.get() + 2)-&gt;test();\n\n}\n</code></pre>\n\n<p>Indexing can get awkward, but what type of \"holes\" are opened in the type system by using a shared pointer to an array with derived-to-base conversion? I'm struggling to think of an example. Whatever issues are faced with derived-to-base pointer conversions, I don't see how the use of array could have caused them. The example above works fine, so what level of complexity is needed before I start seeing issues with this?</p>\n\n<p>I know it's better to just use std::array or std::vector anyway instead of pointing to a dynamic array, but I was just curious about this point. </p>\n"}, {"tags": ["c++", "arrays", "sorting", "data-structures", "parameters"], "comments": [{"owner": {"reputation": 1194, "user_id": 3795597, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bdc0769eb951ee2c673e99c40f0af87d?s=128&d=identicon&r=PG&f=1", "display_name": "MayeulC", "link": "https://stackoverflow.com/users/3795597/mayeulc"}, "edited": false, "score": 1, "creation_date": 1474481088, "post_id": 39623373, "comment_id": 66552600, "body": "This doesn&#39;t seem to be a duplicate, but maybe the question could be worded differently. I think the OP here wants to access some fields of the structure based on a parameter in the function. Array passing is already solved."}, {"owner": {"reputation": 1194, "user_id": 3795597, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bdc0769eb951ee2c673e99c40f0af87d?s=128&d=identicon&r=PG&f=1", "display_name": "MayeulC", "link": "https://stackoverflow.com/users/3795597/mayeulc"}, "edited": false, "score": 0, "creation_date": 1474481311, "post_id": 39623373, "comment_id": 66552713, "body": "look at <a href=\"https://stackoverflow.com/questions/14418595/c-method-for-iterating-through-a-structs-members-like-an-array\" title=\"c method for iterating through a structs members like an array\">stackoverflow.com/questions/14418595/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 6859892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ca324112f65cc6c65f7b477dd70f309?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/6859892/austin"}, "reply_to_user": {"reputation": 1194, "user_id": 3795597, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bdc0769eb951ee2c673e99c40f0af87d?s=128&d=identicon&r=PG&f=1", "display_name": "MayeulC", "link": "https://stackoverflow.com/users/3795597/mayeulc"}, "edited": false, "score": 0, "creation_date": 1474481432, "post_id": 39623373, "comment_id": 66552776, "body": "Correct. My wording was not great, but I am trying to access fields of the structure within the sorting function and am not sure how to do so."}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1474548183, "post_id": 39623373, "comment_id": 66582420, "body": "You don&#39;t pass the member data as an argument, you pass a pointer to a function that compares two students, or you pass a pointer to an implementation of an interface with a virtual -&gt;compareStudents method.  The sort function will use this instead of the less-than operator."}, {"owner": {"reputation": 1194, "user_id": 3795597, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bdc0769eb951ee2c673e99c40f0af87d?s=128&d=identicon&r=PG&f=1", "display_name": "MayeulC", "link": "https://stackoverflow.com/users/3795597/mayeulc"}, "reply_to_user": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1474610972, "post_id": 39623373, "comment_id": 66610006, "body": "@MattTimmermans: Well, I don&#39;t see the problem in using an union with an array here."}], "answers": [{"tags": [], "owner": {"reputation": 94, "user_id": 5306495, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zA_hch-dee4/AAAAAAAAAAI/AAAAAAAABc8/pQiKydilpxQ/photo.jpg?sz=128", "display_name": "Rajmani Arya", "link": "https://stackoverflow.com/users/5306495/rajmani-arya"}, "is_accepted": false, "score": 0, "last_activity_date": 1476211040, "creation_date": 1476211040, "answer_id": 39984362, "question_id": 39623373, "link": "https://stackoverflow.com/questions/39623373/how-do-i-pass-member-data-from-an-array-of-a-structure-into-a-function/39984362#39984362", "title": "How do I pass member data from an array of a structure into a function?", "body": "<p>No You can't write a single generic function for sorting, You need to have compare function for each field or You need to keep track of member by which you want to sort by sending one more argument and inside sorting do check for which tag which field to be compared and then swap.</p>\n\n<p>The best way to sort to use compare function per field.</p>\n\n<pre><code>bool compareCurrentGrade (const Student &amp; a, const Student &amp; b) {\n   return a.currentGrade &lt; b.currentGrade;\n}\n</code></pre>\n\n<p>And then use sort function defined in <code>#include &lt;algorithm&gt;</code></p>\n\n<pre><code>sort(studentarr, startoffset, endoffset, compareCurrentGrade);\n</code></pre>\n\n<p>to know more about sort <a href=\"http://www.cplusplus.com/reference/algorithm/sort/\" rel=\"nofollow\">See</a></p>\n\n<p>If you don't want to use external sort libray modules then you have to write\nsorting functions per field.</p>\n"}], "owner": {"reputation": 11, "user_id": 6859892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ca324112f65cc6c65f7b477dd70f309?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/6859892/austin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476211040, "creation_date": 1474480264, "last_edit_date": 1474480738, "question_id": 39623373, "link": "https://stackoverflow.com/questions/39623373/how-do-i-pass-member-data-from-an-array-of-a-structure-into-a-function", "title": "How do I pass member data from an array of a structure into a function?", "body": "<p>EDIT: This was marked as a duplicate question, but the question linked is not what I am asking. I know how to pass an array of a structure into a function. I am seeking help on how to pass member data from elements in that array to a function.</p>\n\n<p>I have a homework assignment in C++ where I was tasked to create a structure for keeping track of a student's information:</p>\n\n<pre><code>struct Student {\n  string name;\n  double idNumber;\n  double currentGrade;\n  double lastGrade;\n  double overallGPA;\n};\n</code></pre>\n\n<p>The user is prompted to enter the number of students that they will be entering data for which creates an array of the structure based on this input. The program then loops over each element, prompting the user to enter the member data for each instance of the structure.</p>\n\n<p>Once all of the data is entered, I am tasked with sorting the array based on the member variable the user chooses. I have written the sorting function for sorting by name variable, and I have written a general function for sorting the array based on a double variable, but I am unsure how I can use only one function for all four double variables.</p>\n\n<p>Essentially, is there a way I can use this function:</p>\n\n<pre><code>void doubleSort(Student arr[], int arrSize) {\n    // bubble sort: high -&gt; low\n    Student temp;\n    for(int i = 0; i &lt; arrSize; i++) {\n\n        for(int j = 0; j &lt; arrSize; j++) {\n\n            if(arr[j] &lt; arr[i]) {\n                // swap values\n                temp = arr[i];\n                arr[i] = arr[j];\n                arr[j] = temp;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>But pass member data as an arguement, i.e. idNumber, in order to avoid writing a sorting function for each individual member variable? </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1474479951, "post_id": 39623245, "comment_id": 66552029, "body": "This is not well-formed C++."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1474483948, "post_id": 39623245, "comment_id": 66554121, "body": "@Kerrek SB - Not to mention that it is <i>horrible</i> C++; <code>using namespace ...</code>, raw pointers rather than smart pointers, C style casts, incorrect <code>main</code> declaration, sub-optimal formatting (arguable, sure), <code>endl</code> used where <code>\\n</code> would do... Ohh yes, and then there&#39;s the UB that wrecks everything. Its actually somewhat impressive that so much fail could be crammed into so few lines. (Sorry OP)"}], "answers": [{"comments": [{"owner": {"reputation": 4469, "user_id": 1251099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af9183d81b1160ccd54790c233a7b0c7?s=128&d=identicon&r=PG", "display_name": "user180574", "link": "https://stackoverflow.com/users/1251099/user180574"}, "edited": false, "score": 0, "creation_date": 1474480063, "post_id": 39623288, "comment_id": 66552096, "body": "That&#39;s exactly the second part of my question: how to enforce the checking."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 4469, "user_id": 1251099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af9183d81b1160ccd54790c233a7b0c7?s=128&d=identicon&r=PG", "display_name": "user180574", "link": "https://stackoverflow.com/users/1251099/user180574"}, "edited": false, "score": 0, "creation_date": 1474480082, "post_id": 39623288, "comment_id": 66552110, "body": "@user180574: Nowhere in your question are you asking that."}, {"owner": {"reputation": 4469, "user_id": 1251099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af9183d81b1160ccd54790c233a7b0c7?s=128&d=identicon&r=PG", "display_name": "user180574", "link": "https://stackoverflow.com/users/1251099/user180574"}, "edited": false, "score": 0, "creation_date": 1474480109, "post_id": 39623288, "comment_id": 66552124, "body": "as in the title"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 4469, "user_id": 1251099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af9183d81b1160ccd54790c233a7b0c7?s=128&d=identicon&r=PG", "display_name": "user180574", "link": "https://stackoverflow.com/users/1251099/user180574"}, "edited": false, "score": 0, "creation_date": 1474480166, "post_id": 39623288, "comment_id": 66552162, "body": "@user180574: Can you please a) make your question self-contained (the title isn&#39;t part of the question), and b) be specific about what exactly you want? But be warned, we can generally only provide guidance for C++ programs with defined behaviour. It&#39;s very hard to guarantee that any one specific thing will happen when anything can happen."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 4469, "user_id": 1251099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af9183d81b1160ccd54790c233a7b0c7?s=128&d=identicon&r=PG", "display_name": "user180574", "link": "https://stackoverflow.com/users/1251099/user180574"}, "edited": false, "score": 0, "creation_date": 1474482193, "post_id": 39623288, "comment_id": 66553166, "body": "@user180574 To quote the standard &quot;Undefined behavior: behavior for which this International Standard imposes no requirements.&quot;. So, since the compiler is allowed to do <b>anything</b> to your <i>entire</i> program once you invoke UB, the answer is simply &quot;you cannot&quot;. The solution is to never invoke UB (by knowing the rules and what you are doing)."}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": true, "score": 5, "last_activity_date": 1474479990, "creation_date": 1474479990, "answer_id": 39623288, "question_id": 39623245, "link": "https://stackoverflow.com/questions/39623245/memory-access-why-it-doesnt-crash-and-how-to-enforce-it/39623288#39623288", "title": "memory access: why it doesn&#39;t crash and how to enforce it?", "body": "<p>Yes, accessing <code>d</code> <em>is</em> illegal, and your code has undefined behaviour.</p>\n\n<p>There is no concept of \"crash\" in C++, so it does not make sense to ask for a portable way to create a \"crash\". If the behaviour of a program is undefined, it is not portable, and the language rules do not tell you what the program is doing.</p>\n"}, {"comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1474480114, "post_id": 39623314, "comment_id": 66552128, "body": "It&#39;s not just the result of the access that is undefined. The behaviour of the entire program is undefined."}, {"owner": {"reputation": 775, "user_id": 1990747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e768662f51a5df9eb2f247a5ddfc90e?s=128&d=identicon&r=PG", "display_name": "Tim Beaudet", "link": "https://stackoverflow.com/users/1990747/tim-beaudet"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1474480187, "post_id": 39623314, "comment_id": 66552172, "body": "Yes the entire program will be undefined, but the reason, is from the cast and attempt to access something that may or may not exist."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474485033, "post_id": 39623314, "comment_id": 66554685, "body": "The cast does <b>not</b> convert the <code>B</code> object into a <code>D</code> object. If it did, that would (probably) be fine. What it does is convert the <code>B*</code> into a <code>D*</code> which still points to the original <code>B</code> object, and that&#39;s asking for trouble."}, {"owner": {"reputation": 775, "user_id": 1990747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e768662f51a5df9eb2f247a5ddfc90e?s=128&d=identicon&r=PG", "display_name": "Tim Beaudet", "link": "https://stackoverflow.com/users/1990747/tim-beaudet"}, "edited": false, "score": 0, "creation_date": 1474485203, "post_id": 39623314, "comment_id": 66554768, "body": "Good point, I was not very clear with that although it is what I meant, I&#39;ve updated the answer."}], "tags": [], "owner": {"reputation": 775, "user_id": 1990747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e768662f51a5df9eb2f247a5ddfc90e?s=128&d=identicon&r=PG", "display_name": "Tim Beaudet", "link": "https://stackoverflow.com/users/1990747/tim-beaudet"}, "is_accepted": false, "score": 0, "last_activity_date": 1474485158, "last_edit_date": 1474485158, "creation_date": 1474480083, "answer_id": 39623314, "question_id": 39623245, "link": "https://stackoverflow.com/questions/39623245/memory-access-why-it-doesnt-crash-and-how-to-enforce-it/39623314#39623314", "title": "memory access: why it doesn&#39;t crash and how to enforce it?", "body": "<p>It is illegal, but you are casting which tells the compiler you know what you are doing (don't do this without knowing the consequences) and cthat converts your pointer from B* to a D* while still actually being a B obhect at the location pointed to. So the results here are <strong>UNDEFINED</strong> since you are accessing out of bounds.</p>\n\n<p>Also it would be good to prefer C++ style casts, vs C style casts (you are using a C-style cast) as they are generally a bit safer.</p>\n"}, {"comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474489534, "post_id": 39623559, "comment_id": 66557185, "body": "Please clarify.  There is only room allocated for an instance of class B. If class D is bigger than B, then memory is accessed that wasn&#39;t allocated.  There is no information about how the memory for the program is allocated.  If the OS only allocates as necessary, then trouble exists."}], "tags": [], "owner": {"reputation": 1098, "user_id": 6497438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95d4986f27a3f0a255bf095e3b1fd3de?s=128&d=identicon&r=PG&f=1", "display_name": "evan", "link": "https://stackoverflow.com/users/6497438/evan"}, "is_accepted": false, "score": 0, "last_activity_date": 1474480952, "creation_date": 1474480952, "answer_id": 39623559, "question_id": 39623245, "link": "https://stackoverflow.com/questions/39623245/memory-access-why-it-doesnt-crash-and-how-to-enforce-it/39623559#39623559", "title": "memory access: why it doesn&#39;t crash and how to enforce it?", "body": "<p>What you are doing usually won't cause a crash because of the way that memory allocation is typically handled behind the scenes.</p>\n\n<p>And there are third party products that can check for errors of this kind (a buffer overrun in this case). Just search for \"memory debuggers c++\". Most tools for Windows are commercial, but there may be free ones available.</p>\n"}], "owner": {"reputation": 4469, "user_id": 1251099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af9183d81b1160ccd54790c233a7b0c7?s=128&d=identicon&r=PG", "display_name": "user180574", "link": "https://stackoverflow.com/users/1251099/user180574"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 39623288, "answer_count": 3, "score": -1, "last_activity_date": 1474485158, "creation_date": 1474479848, "question_id": 39623245, "link": "https://stackoverflow.com/questions/39623245/memory-access-why-it-doesnt-crash-and-how-to-enforce-it", "title": "memory access: why it doesn&#39;t crash and how to enforce it?", "body": "<p>I expect the following code would generate certain memory access fault but it doesn't. Is there way to enforce it during compilation?</p>\n\n<pre><code>#include &lt;iostream&gt;\nclass B {};\nclass D : public B\n{ public: int d; };\n\nusing namespace std;\n\nmain()\n{\n    B *pB = new B;\n    ((D*)pB)-&gt;d = 2;\n    cout &lt;&lt; ((D*)pB)-&gt;d &lt;&lt; endl;\n}\n</code></pre>\n\n<p>As I understand, casting pointer to D does not change memory allocation so accessing \"d\" should be illegal, right?</p>\n"}, {"tags": ["c++", "makefile", "g++"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 2, "creation_date": 1474480068, "post_id": 39623185, "comment_id": 66552101, "body": "I&#39;m unable to reproduce this. Can you perhaps create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> with an online compiler, and then link it here?"}, {"owner": {"reputation": 1194, "user_id": 3795597, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bdc0769eb951ee2c673e99c40f0af87d?s=128&d=identicon&r=PG&f=1", "display_name": "MayeulC", "link": "https://stackoverflow.com/users/3795597/mayeulc"}, "edited": false, "score": 1, "creation_date": 1474480329, "post_id": 39623185, "comment_id": 66552240, "body": "Of course, I do not have the same code as you, but it seems to be working fine for me (g++ 6.2.1). You might want to look if you have some hidden characters somewhere, or try with a newer version."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1474483289, "post_id": 39623185, "comment_id": 66553749, "body": "Does it make a difference if you move the <code>-DDATA_CACHE_LOCATION=&quot;\\&quot;&#47;a&#47;b&#47;c</code> earlier in the commandline (like before the file(s) being compiled)?"}, {"owner": {"reputation": 693, "user_id": 1226434, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8dd56978d06ac2846c07168752070911?s=128&d=identicon&r=PG", "display_name": "Taylor Kline", "link": "https://stackoverflow.com/users/1226434/taylor-kline"}, "edited": false, "score": 0, "creation_date": 1474491747, "post_id": 39623185, "comment_id": 66558365, "body": "Thank you for the help. Considering the difficulty in reproducing, I instead conditionally symlinked the cache file into the current directory using a shell script in the <code>makefile</code>."}], "owner": {"reputation": 693, "user_id": 1226434, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8dd56978d06ac2846c07168752070911?s=128&d=identicon&r=PG", "display_name": "Taylor Kline", "link": "https://stackoverflow.com/users/1226434/taylor-kline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474479663, "creation_date": 1474479663, "question_id": 39623185, "link": "https://stackoverflow.com/questions/39623185/g-preprocessor-define-still-listed-as-an-undeclared-identifier", "title": "g++ preprocessor define still listed as an undeclared identifier", "body": "<p>I have added a g++ preprocessor define for a variable called <code>DATA_CACHE_LOCATION</code> as such:</p>\n\n<pre><code>g++-4.8 -pedantic -std=c++11 -Wall -Weffc++ -fprofile-arcs -ftest-coverage file1.c++ file2.c++ -o file -lgtest -lgtest_main -pthread -lboost_serialization -DDATA_CACHE_LOCATION=\"\\\"/a/b/c/d.bin\\\"\"\n</code></pre>\n\n<p>However, when attempting to run some tests, I run into the error:</p>\n\n<pre><code>file1.c++:50:41: error: use of undeclared identifier\n      'DATA_CACHE_LOCATION'\n  DataCache data_cache = get_data_cache(DATA_CACHE_LOCATION);\n</code></pre>\n\n<p>Why would this be an undeclared identifier when I have defined it using a preprocessor macro?</p>\n"}, {"tags": ["c++", "performance"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1474479717, "post_id": 39623140, "comment_id": 66551919, "body": "So you build with optimizations enabled? Is there any difference if you hint to the compiler that the function could be make <code>inline</code>? How about <code>constexpr</code>? And what do you mean by &quot;slower&quot;? How have you measured? What&#39;s the difference?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1474479733, "post_id": 39623140, "comment_id": 66551933, "body": "If arguments are known at compile-time, then making the function <code>constexpr</code> might be a good idea."}, {"owner": {"reputation": 803, "user_id": 5531385, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wpokHCJQEJ4/AAAAAAAAAAI/AAAAAAAAEZU/ih9fDr0oG-Q/photo.jpg?sz=128", "display_name": "Victor Havin", "link": "https://stackoverflow.com/users/5531385/victor-havin"}, "edited": false, "score": 0, "creation_date": 1474480361, "post_id": 39623140, "comment_id": 66552256, "body": "How do you measure performance and what is the difference? f(p, MIN) includes p.first, so naturally it takes more time."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 2, "creation_date": 1474482365, "post_id": 39623140, "comment_id": 66553240, "body": "Note that <code>f(p, MIN)</code> and <code>p.first</code> are subtly different. The first is an prvalue, and the second is an lvalue."}], "answers": [{"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 1, "last_activity_date": 1474485609, "creation_date": 1474485609, "answer_id": 39624894, "question_id": 39623140, "link": "https://stackoverflow.com/questions/39623140/performance-comparison-when-arguments-are-pre-known/39624894#39624894", "title": "performance comparison when arguments are pre-known?", "body": "<p>Questions of performance are impossible to answer through prediction. It entirely depends on what optimisations the compiler is able to make.</p>\n\n<p>In this contrived case:</p>\n\n<pre><code>#include &lt;utility&gt;\n\nenum Limit {MIN, MAX};\n\ninline int f(std::pair&lt;int, int&gt; p, Limit l)\n{\n    return l == MIN ? p.first : p.second;\n}\n\nextern void emit(int);\nint main()\n{\n  auto p = std::make_pair(4, 5);\n  emit(f(p, MIN));\n  emit(p.first);\n}\n</code></pre>\n\n<p>There is no difference whatsoever:</p>\n\n<pre><code>main:                                   # @main\n        pushq   %rax\n\n        movl    $4, %edi\n        callq   emit(int)\n\n        movl    $4, %edi\n        callq   emit(int)\n\n        xorl    %eax, %eax\n        popq    %rcx\n        retq\n</code></pre>\n"}], "owner": {"reputation": 11861, "user_id": 1899020, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c6f377132e8aad22b97bfcc85adffdb?s=128&d=identicon&r=PG", "display_name": "user1899020", "link": "https://stackoverflow.com/users/1899020/user1899020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 39624894, "answer_count": 1, "score": 0, "last_activity_date": 1474485609, "creation_date": 1474479532, "last_edit_date": 1474481794, "question_id": 39623140, "link": "https://stackoverflow.com/questions/39623140/performance-comparison-when-arguments-are-pre-known", "title": "performance comparison when arguments are pre-known?", "body": "<p>I have a function</p>\n\n<pre><code>enum Limit {MIN, MAX};\n\ninline int f(pair&lt;int, int&gt; p, Limit l)\n{\n    return l == MIN ? p.first : p.second;\n}\n</code></pre>\n\n<p>Compare the computatinal time of <code>f(p, MIN)</code> and <code>p.first</code>, is the first one slower even with a good compiler in release version?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1474479592, "post_id": 39623137, "comment_id": 66551849, "body": "C++ doesn&#39;t require evaluating from left to right."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 6855417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0bcf09e097324c6d55ca2780c0ba77?s=128&d=identicon&r=PG&f=1", "display_name": "sir_lantzelot", "link": "https://stackoverflow.com/users/6855417/sir-lantzelot"}, "is_accepted": false, "score": 1, "last_activity_date": 1474479755, "last_edit_date": 1592644375, "creation_date": 1474479755, "answer_id": 39623215, "question_id": 39623137, "link": "https://stackoverflow.com/questions/39623137/incrementing-fi-and-gi-in-the-same-equation-output-the-same-i-value/39623215#39623215", "title": "Incrementing f(++i) and g(++i) in the same equation output the same i value?", "body": "<p>From <a href=\"https://stackoverflow.com/questions/7870648/multiple-postfix-increment-operator-in-an-expressionc\">this</a>:</p>\n<p>Writing to the same variable twice without an intervening sequence point is undefined behaviour.  From the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf\" rel=\"nofollow noreferrer\">spec</a>, <strong>J.2 Undefined behaviour</strong>:</p>\n<blockquote>\n<p>Between two sequence points, an object is modified more than once, or is modified and the prior value is read other than to determine the value to be stored (6.5).</p>\n</blockquote>\n<p>The reference is to <strong>6.5 Expressions</strong>, paragraph 5:</p>\n<blockquote>\n<p>Between the previous and next sequence point an object shall have its stored value modified at most once by the evaluation of an expression. Furthermore, the prior value shall be read only to determine the value to be stored.</p>\n</blockquote>\n<p>Annex C of the C spec has a handy list of all of the sequence points:</p>\n<blockquote>\n<p>The following are the sequence points described in 5.1.2.3:</p>\n<ul>\n<li>The call to a function, after the arguments have been evaluated (6.5.2.2).</li>\n<li>The end of the first operand of the following operators: logical AND <strong><code>&amp;&amp;</code></strong> (6.5.13); logical OR <strong><code>||</code></strong> (6.5.14); conditional <strong><code>?</code></strong> (6.5.15); comma <strong><code>,</code></strong> (6.5.17).</li>\n<li>The end of a full declarator: declarators (6.7.5);</li>\n<li>The end of a full expression: an initializer (6.7.8); the expression in an expression statement (6.8.3); the controlling expression of a selection statement (<strong><code>if</code></strong> or <strong><code>switch</code></strong>) (6.8.4); the controlling expression of a <strong><code>while</code></strong> or <strong><code>do</code></strong> statement (6.8.5); each of the expressions of a <strong><code>for</code></strong> statement (6.8.5.3); the expression in a <strong><code>return</code></strong> statement (6.8.6.4).</li>\n<li>Immediately before a library function returns (7.1.4).</li>\n<li>After the actions associated with each formatted input/output function conversion specifier (7.19.6, 7.24.2).</li>\n<li>Immediately before and immediately after each call to a comparison function, and also between any call to a comparison function and any movement of the objects passed as arguments to that call (7.20.5).</li>\n</ul>\n</blockquote>\n"}], "owner": {"reputation": 193, "user_id": 2779767, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/553fa330e847fab4ae6a65afc0b8a471?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/2779767/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1474479611, "answer_count": 1, "score": -1, "last_activity_date": 1474483085, "creation_date": 1474479515, "last_edit_date": 1474483085, "question_id": 39623137, "link": "https://stackoverflow.com/questions/39623137/incrementing-fi-and-gi-in-the-same-equation-output-the-same-i-value", "closed_reason": "Duplicate", "title": "Incrementing f(++i) and g(++i) in the same equation output the same i value?", "body": "<p>I am taking a compiler class and was given the equation: </p>\n\n<pre><code>int i = 5, j = 9, k;\nk = f(++i) + g(++i) + j + 45;\n</code></pre>\n\n<p>I made a function for f and g and they both take in (int i) and return i.\nIn the result, f and g both returned i = 7. </p>\n\n<p><strong>I was wondering why f and g both output i = 7, but not f is i = 6  and g is i = 7.</strong> </p>\n\n<p>When I run it in Visual Studios, g's output runs first and then f. </p>\n\n<p><strong>Shouldn't f(++i) go first then g(++i)? Since f(++i) appears first from left to right of the equation.?</strong></p>\n"}, {"tags": ["c++", "c", "google-chrome", "google-chrome-extension", "google-nativeclient"], "answers": [{"comments": [{"owner": {"reputation": 453, "user_id": 4743133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1645f846ef7aee07092bfd003337b?s=128&d=identicon&r=PG", "display_name": "Sun Dro", "link": "https://stackoverflow.com/users/4743133/sun-dro"}, "edited": false, "score": 0, "creation_date": 1474481161, "post_id": 39623360, "comment_id": 66552628, "body": "Thanks but when player will be released in production, I cant tell users to use chrome from Dev channel.. :("}], "tags": [], "owner": {"reputation": 1087, "user_id": 92554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bab2622df953f1abc15d8acdc8359957?s=128&d=identicon&r=PG", "display_name": "bbudge", "link": "https://stackoverflow.com/users/92554/bbudge"}, "is_accepted": false, "score": 0, "last_activity_date": 1474480221, "creation_date": 1474480221, "answer_id": 39623360, "question_id": 39623111, "link": "https://stackoverflow.com/questions/39623111/adjust-volume-in-google-native-client/39623360#39623360", "title": "Adjust Volume In Google Native-Client", "body": "<p>The web page containing the plugin could use the chrome.audio API to do this. Unfortunately, this will only work in Dev channel Chrome.</p>\n\n<p><a href=\"https://developer.chrome.com/apps/audio\" rel=\"nofollow\">https://developer.chrome.com/apps/audio</a></p>\n"}], "owner": {"reputation": 453, "user_id": 4743133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1645f846ef7aee07092bfd003337b?s=128&d=identicon&r=PG", "display_name": "Sun Dro", "link": "https://stackoverflow.com/users/4743133/sun-dro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474543077, "creation_date": 1474479448, "last_edit_date": 1474543077, "question_id": 39623111, "link": "https://stackoverflow.com/questions/39623111/adjust-volume-in-google-native-client", "title": "Adjust Volume In Google Native-Client", "body": "<p>I've wrote media/stream player using google chrome native-client (nacl). The problem is that Pepper audio API does not have function to control audio level. Is there any way to adjust volume with nacl while playback? </p>\n\n<p>[EDIT]</p>\n\n<p>I've fixed this problem with the manually change volume in the audio sample buffer.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474478772, "post_id": 39622905, "comment_id": 66551373, "body": "Sorry, my Vulcan Mind Meld doesn&#39;t work at far distances.  What are these <i>extras</i> you are talking about?  (Please modify your post.)"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474478831, "post_id": 39622905, "comment_id": 66551397, "body": "You should tell the User how to quit the program, like entering &quot;-1&quot;."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474478897, "post_id": 39622905, "comment_id": 66551420, "body": "For a more difficult game, you should <i>seed</i> the random number generator so it doesn&#39;t use the same sequence each time."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474478968, "post_id": 39622905, "comment_id": 66551461, "body": "I highly recommend you get in the habit of using braces, &#39;{}` after <code>if</code> statements.  It will prevent nasty defects from being injected.  Many coding guidelines demand this."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474479051, "post_id": 39622905, "comment_id": 66551513, "body": "Also, remove the &quot;stdafx.h&quot; and choose a configuration for your projects that don&#39;t use <i>precompiled headers</i>.  For small programs, the precompiled header feature may be more burdensome."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474479107, "post_id": 39622905, "comment_id": 66551542, "body": "Please post the requirements of the <code>numCheck</code> function.  Talk to your instructor if you don&#39;t understand or have incomplete requirements."}, {"owner": {"reputation": 1, "user_id": 6859798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jMF6X.jpg?s=128&g=1", "display_name": "Angie Mansfield", "link": "https://stackoverflow.com/users/6859798/angie-mansfield"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474479514, "post_id": 39622905, "comment_id": 66551807, "body": "I took all of the code in the main and added it to a function abouve and called it in the main, but now I need to make sure the uses guesses a number between 1-100 and send an error message if needed and output how many guesses it took them to get the right answer"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6859798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jMF6X.jpg?s=128&g=1", "display_name": "Angie Mansfield", "link": "https://stackoverflow.com/users/6859798/angie-mansfield"}, "edited": false, "score": 0, "creation_date": 1474480177, "post_id": 39623053, "comment_id": 66552168, "body": "The -1 is to exit the program. I tried it your way and it no longer worked."}, {"owner": {"reputation": 13815, "user_id": 6575931, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CumJFhlEBdA/AAAAAAAAAAI/AAAAAAAAi5U/sqexnazvXek/photo.jpg?sz=128", "display_name": "Uriel", "link": "https://stackoverflow.com/users/6575931/uriel"}, "reply_to_user": {"reputation": 1, "user_id": 6859798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jMF6X.jpg?s=128&g=1", "display_name": "Angie Mansfield", "link": "https://stackoverflow.com/users/6859798/angie-mansfield"}, "edited": false, "score": 0, "creation_date": 1474480298, "post_id": 39623053, "comment_id": 66552226, "body": "ok, so change it back. but i would normally expect the program to terminate when the user enters the right choice, and not wait for him to input -1."}, {"owner": {"reputation": 1, "user_id": 6859798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jMF6X.jpg?s=128&g=1", "display_name": "Angie Mansfield", "link": "https://stackoverflow.com/users/6859798/angie-mansfield"}, "edited": false, "score": 0, "creation_date": 1474486504, "post_id": 39623053, "comment_id": 66555516, "body": "It is what my teacher wants. Thank you for your help."}], "tags": [], "owner": {"reputation": 13815, "user_id": 6575931, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CumJFhlEBdA/AAAAAAAAAAI/AAAAAAAAi5U/sqexnazvXek/photo.jpg?sz=128", "display_name": "Uriel", "link": "https://stackoverflow.com/users/6575931/uriel"}, "is_accepted": false, "score": 1, "last_activity_date": 1474479671, "last_edit_date": 1474479671, "creation_date": 1474479251, "answer_id": 39623053, "question_id": 39622905, "link": "https://stackoverflow.com/questions/39622905/hilow-computer-generated-guessing-game/39623053#39623053", "title": "HiLow Computer Generated Guessing Game", "body": "<p>Before you work on the extras, lets get started with fixing the program.</p>\n\n<h1>What is wrong?</h1>\n\n<ol>\n<li><p><strong><code>=</code> operator vs. <code>==</code> operator</strong></p>\n\n<p><code>else if (num = guess) cout &lt;&lt;\"Congratulations you guessed corectly!!\" &lt;&lt; endl;</code></p></li>\n</ol>\n\n<p><code>num = guess</code> will ssign <code>guess</code> to <code>num</code> and return true. That will make sure you get this output on the first time, if no other input were chosen.</p>\n\n<ol start=\"2\">\n<li><p><strong>user experience / logic exception</strong></p>\n\n<p><code>while (guess != -1);</code> </p></li>\n</ol>\n\n<p>well, you ask a user to guess from 1 to 100 and wait till they hit the -1. that's kinda cruel.</p>\n\n<ol start=\"3\">\n<li><p><strong>uninitialized input</strong></p>\n\n<p><code>int guess;</code></p></li>\n</ol>\n\n<p>compilers use to yell at you if you don't initialize these before you input.</p>\n\n<h1>How to fix?</h1>\n\n<pre><code>int main()\n{\n    srand(time(NULL));\n    int num = rand() % 100 + 1;\n    int guess = 0;                           // Problem 3\n\n    do {\n        cout &lt;&lt; \"Pick a number 1-100: \";\n        cin &gt;&gt; guess;\n        if (num == guess)                    // Problem 1\n            cout &lt;&lt;\"Congratulations! you guessed corectly!!\" &lt;&lt; endl;\n        else if (num &lt; guess) \n            cout &lt;&lt;\"Too High\" &lt;&lt; endl;\n        else \n            cout &lt;&lt;\"Too Low\" &lt;&lt; endl;\n        } \n    while (guess != num);                    // Problem 2   \n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>Now you can move on to continue with adding some more features.</p>\n"}], "owner": {"reputation": 1, "user_id": 6859798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jMF6X.jpg?s=128&g=1", "display_name": "Angie Mansfield", "link": "https://stackoverflow.com/users/6859798/angie-mansfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "closed_date": 1474479342, "answer_count": 1, "score": -3, "last_activity_date": 1474494315, "creation_date": 1474478653, "last_edit_date": 1474494315, "question_id": 39622905, "link": "https://stackoverflow.com/questions/39622905/hilow-computer-generated-guessing-game", "closed_reason": "Needs details or clarity", "title": "HiLow Computer Generated Guessing Game", "body": "<p>I have to create a HiLow game where the user has to guess the random number generated by the computer. I have to implement at least one function, to check the number I guess. And output how many guesses it took to get the answer right. The game works, but I do not have a couple of things, I need to output an error message if the user enters a number out of range and to output the number of guesses it took to get the correct answer. I am not sure where to get started. Here is my code so far. </p>\n\n<p>Requirements from professor: Write the Console Application Program or Game called HiLow. In this game the computer generates a random number with values ranging from 1 to 100. Then it asks the user for their guess. If the player guesses high or low, the computer gives back Too High or Too Low and asks for a new guess. When the correct answer is given, the player is congratulated, told how many guesses it took to get the right answer, and asked to play again.Tell the user to enter \u20131 for a guess when they want to quit playing.Implement one function. \u2013</p>\n\n<pre><code>// Angela Mansfield\n// Assignment HiLow\n// CIS 227\n// 9/23/16\n\n#include \"stdafx.h\"\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nusing std::getline;\nusing std::cin;\nusing std::cout;\nusing std::endl; \nusing std::string;\n\n\n// check number method add all of work here call from main\ndouble numCheck() {\n    int num = rand();\n    int guess;\n\n    //sets random number to the variable num \n    srand(time(NULL));\n    num = rand() % 100 + 1;\n\n    do {\n        cout &lt;&lt; \"Pick a number 1-100: \";            //can I check the number here??\n        cin &gt;&gt; guess;\n        //have to enter number 2 times\n        if (num &lt; guess) {cout &lt;&lt; \"Too High\" &lt;&lt; endl;}\n        else if (num &gt; guess) {cout &lt;&lt; \"Too Low\" &lt;&lt; endl;}\n        else if (num = guess) {cout &lt;&lt; \"Congratulations you guessed correctly!!\" &lt;&lt; endl;}\n    } while (guess != -1);\n\n\n    return 0;\n}\n\nint main()\n{\n    numCheck();\n\n\n}\n</code></pre>\n"}, {"tags": ["c++", "performance", "optimization", "quicksort", "bubble-sort"], "comments": [{"owner": {"reputation": 4599, "user_id": 2055064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/815c89ab1784fd780fe7faf44ebfc79f?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2055064/thomas"}, "edited": false, "score": 3, "creation_date": 1474478819, "post_id": 39622902, "comment_id": 66551393, "body": "It depends. For very small collections bubblesort can be faster,  but most of the the time quicksort will be quicker."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1474478862, "post_id": 39622902, "comment_id": 66551411, "body": "cross site dupe/related: <a href=\"http://cs.stackexchange.com/questions/3/why-is-quicksort-better-than-other-sorting-algorithms-in-practice\" title=\"why is quicksort better than other sorting algorithms in practice\">cs.stackexchange.com/questions/3/&hellip;</a>.  Also you really should use google first.  Lots of information on this out there already."}, {"owner": {"reputation": 1533, "user_id": 3209112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bSvXj.jpg?s=128&g=1", "display_name": "ABcDexter", "link": "https://stackoverflow.com/users/3209112/abcdexter"}, "edited": false, "score": 0, "creation_date": 1474479332, "post_id": 39622902, "comment_id": 66551683, "body": "Yes, and yes, quicksort can not always be relied upon, especially because of the choice of pivot."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1474480036, "post_id": 39622902, "comment_id": 66552080, "body": "&quot;Is Quicksort faster than Bubblesort?&quot; - for non-trivially sized sets to be sorted: <b>Yes</b> in <i>most</i> cases. But, in most situations, if sorting is not <i>the most</i> performance critical part of your application, you should probably just not worry too much and just use <code>std::sort</code> :)"}, {"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 1, "creation_date": 1474547918, "post_id": 39622902, "comment_id": 66582241, "body": "Those big-O arguments only apply when <i>n</i> is large, so that any constant factors or overhead are swamped out. When <i>n</i> is small, the constant factors and overhead can dominate. Even among algorithms with the same big-O, the constant factors and overhead dominate. They don&#39;t bother mentioning that in classrooms. Also, that worst-case performance of quicksort is easily remedied by trivial changes."}, {"owner": {"reputation": 1036, "user_id": 5472865, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JqseZ.png?s=128&g=1", "display_name": "Guilherme Fidelis", "link": "https://stackoverflow.com/users/5472865/guilherme-fidelis"}, "edited": false, "score": 0, "creation_date": 1491332427, "post_id": 39622902, "comment_id": 73502567, "body": "I edited my question. Please, I would like the discussion to be reopened."}], "answers": [{"comments": [{"owner": {"reputation": 4439, "user_id": 1552837, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6d0b1a02d358e5c38d1c9006b4d624b3?s=128&d=identicon&r=PG", "display_name": "Alex W", "link": "https://stackoverflow.com/users/1552837/alex-w"}, "edited": false, "score": 0, "creation_date": 1474479188, "post_id": 39622980, "comment_id": 66551598, "body": "Re: point 2---But many of these &#39;edge-case&#39; inefficiencies can be easily caught via a few simple changes to pure quicksort"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 4439, "user_id": 1552837, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6d0b1a02d358e5c38d1c9006b4d624b3?s=128&d=identicon&r=PG", "display_name": "Alex W", "link": "https://stackoverflow.com/users/1552837/alex-w"}, "edited": false, "score": 0, "creation_date": 1474479269, "post_id": 39622980, "comment_id": 66551642, "body": "@AlexW: <a href=\"http://stackoverflow.com/q/11175478/315052\">Introsort</a> for example."}, {"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "reply_to_user": {"reputation": 4439, "user_id": 1552837, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6d0b1a02d358e5c38d1c9006b4d624b3?s=128&d=identicon&r=PG", "display_name": "Alex W", "link": "https://stackoverflow.com/users/1552837/alex-w"}, "edited": false, "score": 0, "creation_date": 1474479407, "post_id": 39622980, "comment_id": 66551741, "body": "@AlexW Edited to clarify. But it&#39;s common to just pick a different sort that avoids the problem, like heap sort."}, {"owner": {"reputation": 1036, "user_id": 5472865, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JqseZ.png?s=128&g=1", "display_name": "Guilherme Fidelis", "link": "https://stackoverflow.com/users/5472865/guilherme-fidelis"}, "edited": false, "score": 0, "creation_date": 1474479962, "post_id": 39622980, "comment_id": 66552033, "body": "Bubblesort will stop as soon as its done, making Bubblesort faster in such cases."}, {"owner": {"reputation": 319, "user_id": 5408945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb66f912dedbe170da54892afa002906?s=128&d=identicon&r=PG&f=1", "display_name": "Awais", "link": "https://stackoverflow.com/users/5408945/awais"}, "edited": false, "score": 0, "creation_date": 1474482069, "post_id": 39622980, "comment_id": 66553102, "body": "Quick Sort worst case will be<code>nlog(n)</code> if it is made sure that pivot will be selected in about middle of array."}], "tags": [], "owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "is_accepted": false, "score": 3, "last_activity_date": 1474479292, "last_edit_date": 1474479292, "creation_date": 1474478912, "answer_id": 39622980, "question_id": 39622902, "link": "https://stackoverflow.com/questions/39622902/in-which-situations-is-quicksort-faster-than-bubblesort-why/39622980#39622980", "title": "In which situations is Quicksort faster than Bubblesort? Why?", "body": "<blockquote>\n  <p>So usually, this means that Quicksort will tend to be faster than Bubblesort?</p>\n</blockquote>\n\n<p><strong>Yes.</strong> Much, much faster.</p>\n\n<blockquote>\n  <p>Remembering that when the list is in almost-sorted order already, Quicksort is going to keep recursing.</p>\n</blockquote>\n\n<p><strong>Right.</strong> Quicksort's worst case is a big problem, so without modification it's not usually the algorithm of choice for real world use.</p>\n"}], "owner": {"reputation": 1036, "user_id": 5472865, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JqseZ.png?s=128&g=1", "display_name": "Guilherme Fidelis", "link": "https://stackoverflow.com/users/5472865/guilherme-fidelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "closed_date": 1474483795, "answer_count": 1, "score": -1, "last_activity_date": 1491332699, "creation_date": 1474478648, "last_edit_date": 1491332699, "question_id": 39622902, "link": "https://stackoverflow.com/questions/39622902/in-which-situations-is-quicksort-faster-than-bubblesort-why", "closed_reason": "Needs details or clarity", "title": "In which situations is Quicksort faster than Bubblesort? Why?", "body": "<p><strong>Quicksort:</strong></p>\n\n<pre><code>void Quicksort(int array[], int left, int right){\n     int pivot = left, i,ch,j;\n     for(i=left+1;i&lt;=right;i++){\n         j = i;\n         if(array[j] &lt; array[pivot]){\n          ch = array[j];\n          while(j &gt; pivot){\n             array[j] = array[j-1];\n             j--;\n          }\n          array[j] = ch;\n          pivot++;\n         }  \n     }\n     if(pivot-1 &gt;= left){\n         quick(array,left,pivot-1);\n     }\n     if(pivot+1 &lt;= right){\n         quick(array,pivot+1,right);\n     }\n  }\n</code></pre>\n\n<p><strong>Bubblesort:</strong></p>\n\n<pre><code>void Bubblesort(int array[])\n{\n    int length = array.length;\n    int i,j,r,aux;\n    for(i=length-1; i &gt;= 1; i--) \n    {  \n        for(j=0; j &lt; i ; j++) \n        {\n            if(array[j]&gt;array[j+1]) \n            {\n                aux = array[j];\n                array[j] = array[j+1];\n                array[j+1] = aux;\n            }\n        }\n    }\n\n    for(k = 0; k &lt; length; ++k)\n    {\n        printf(\"%d\\n\",array[k]);\n    }\n}\n</code></pre>\n\n<p><strong>Worst case:</strong></p>\n\n<p>Quicksort: n\u00b2</p>\n\n<p>Bubblesort: n\u00b2</p>\n\n<p><strong>Average case:</strong></p>\n\n<p>Quicksort: nlog(n)</p>\n\n<p>Bubblesort: n\u00b2</p>\n\n<p>So usually, this means that Quicksort will tend to be faster than Bubblesort. </p>\n\n<p>But in which situations is Quicksort faster than Bubblesort?</p>\n\n<p>Remembering that when the list is in almost-sorted order already, Quicksort is going to keep recursing and for very small collections bubblesort can be faster.</p>\n"}, {"tags": ["python", "c++", "audio", "scipy", "signal-processing"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1474479335, "post_id": 39622871, "comment_id": 66551688, "body": "What is the value of <code>len(data) * ratio</code>?"}, {"owner": {"reputation": 2241, "user_id": 6505146, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-K2CFTSiAj0w/AAAAAAAAAAI/AAAAAAAAABI/SCn-x79VV6Y/photo.jpg?sz=128", "display_name": "Arash Howaida", "link": "https://stackoverflow.com/users/6505146/arash-howaida"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1474481263, "post_id": 39622871, "comment_id": 66552689, "body": "for my particular .wav its 441263. It&#39;s a &quot;big&quot; number, but then again it&#39;s not astronomical, so it begs the question is it the journey or the destination that is hurting the computational feasibility."}, {"owner": {"reputation": 62045, "user_id": 1461210, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa93b9461ed24899945403cae69e02ee?s=128&d=identicon&r=PG", "display_name": "ali_m", "link": "https://stackoverflow.com/users/1461210/ali-m"}, "edited": false, "score": 0, "creation_date": 1474481799, "post_id": 39622871, "comment_id": 66552950, "body": "Could you show your imports please. Where did <code>resample</code> come from? From <code>scipy.signal</code>?"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1474485004, "post_id": 39622871, "comment_id": 66554665, "body": "@ArashHowaida: From the documentation: &quot;As noted, resample uses FFT transformations, which can be very slow if the number of input or output samples is large and prime; see scipy.fftpack.fft.&quot; 441263 is both large and prime."}], "answers": [{"comments": [{"owner": {"reputation": 2241, "user_id": 6505146, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-K2CFTSiAj0w/AAAAAAAAAAI/AAAAAAAAABI/SCn-x79VV6Y/photo.jpg?sz=128", "display_name": "Arash Howaida", "link": "https://stackoverflow.com/users/6505146/arash-howaida"}, "edited": false, "score": 0, "creation_date": 1474517936, "post_id": 39625702, "comment_id": 66565384, "body": "I will try this poly phase method, I&#39;m optimistic about things now. I have a question though, can zero flush or significant digits still impact performance for this kind of computation? Would resample_poly and resample both benefit? Or is the large/prime number aspect drowning out &quot;denormals&quot;. Just wondering if &quot;denormals&quot; are still a factor."}, {"owner": {"reputation": 62045, "user_id": 1461210, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa93b9461ed24899945403cae69e02ee?s=128&d=identicon&r=PG", "display_name": "ali_m", "link": "https://stackoverflow.com/users/1461210/ali-m"}, "reply_to_user": {"reputation": 2241, "user_id": 6505146, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-K2CFTSiAj0w/AAAAAAAAAAI/AAAAAAAAABI/SCn-x79VV6Y/photo.jpg?sz=128", "display_name": "Arash Howaida", "link": "https://stackoverflow.com/users/6505146/arash-howaida"}, "edited": false, "score": 0, "creation_date": 1474547594, "post_id": 39625702, "comment_id": 66581968, "body": "Please don&#39;t put code in the comments. If you need to add clarification you should edit your question instead."}], "tags": [], "owner": {"reputation": 62045, "user_id": 1461210, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa93b9461ed24899945403cae69e02ee?s=128&d=identicon&r=PG", "display_name": "ali_m", "link": "https://stackoverflow.com/users/1461210/ali-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1474488556, "creation_date": 1474488556, "answer_id": 39625702, "question_id": 39622871, "link": "https://stackoverflow.com/questions/39622871/flush-to-zero-and-or-significant-digits-in-python-floats/39625702#39625702", "title": "Flush to zero and/or significant digits in python floats", "body": "<p>As AndyG already commented, <a href=\"http://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.resample.html#scipy.signal.resample\" rel=\"nofollow\">the documentation for <code>scipy.signal.resample</code></a> warns you that</p>\n\n<blockquote>\n  <p>... resample uses FFT transformations, which can be very slow if the number of input samples is large and prime, see <code>scipy.fftpack.fft</code>.</p>\n</blockquote>\n\n<p>441263 is both large and prime.</p>\n\n<p>If you have a version of scipy >= 0.18.0 you could try <a href=\"http://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.resample_poly.html#scipy.signal.resample_poly\" rel=\"nofollow\"><code>resample_poly</code></a> instead:</p>\n\n<blockquote>\n  <p>This polyphase method will likely be faster than the Fourier method in scipy.signal.resample when the number of samples is large and prime, or when the number of samples is large and up and down share a large greatest common denominator.</p>\n</blockquote>\n\n<p>For example:</p>\n\n<pre><code>import numpy\nfrom scipy.signal import resample, resample_poly\n\nx = np.random.randn(441263)\n\n%timeit resample(x, x.shape[0] // 4)\n# 1 loop, best of 3: 2min 18s per loop\n\n%timeit resample_poly(x, 10, 40)\n# 100 loops, best of 3: 9.05 ms per loop\n</code></pre>\n"}], "owner": {"reputation": 2241, "user_id": 6505146, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-K2CFTSiAj0w/AAAAAAAAAAI/AAAAAAAAABI/SCn-x79VV6Y/photo.jpg?sz=128", "display_name": "Arash Howaida", "link": "https://stackoverflow.com/users/6505146/arash-howaida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474602474, "creation_date": 1474478555, "last_edit_date": 1474602474, "question_id": 39622871, "link": "https://stackoverflow.com/questions/39622871/flush-to-zero-and-or-significant-digits-in-python-floats", "title": "Flush to zero and/or significant digits in python floats", "body": "<p>I'm trying to conduct an ICA application using audio files (.wavs). When using scipy wavfile, I have noticed from using cprofile, that my load_wav function performs very poorly. It takes 30 minutes to process a 44100 stereo .wav file at a CPU speed of 4.5 Ghz. Bear in mind, the .wav file is only 10 seconds in duration. Here is my function for reference:</p>\n\n<pre><code>def load_wav(filename,samplerate=44100):\n\n    # load file\n    rate, data = wavfile.read(filename)\n\n    # convert stereo to mono\n    if len(data.shape) &gt; 1:\n        data = data[:,0]/2 + data[:,1]/2\n\n    # re-interpolate samplerate    \n    ratio = float(samplerate) / float(rate)\n    data = resample(data, len(data) * ratio)\n\n    return samplerate, data.astype(np.int16)\n</code></pre>\n\n<p>it's primarily the re-interpolate section that takes forever. I researched what I could on it, and it seems that not all computers are adept at dealing with numerous floats. Some floats may be close to zero but not quite. In my audio example, this could be the result of pauses in a person's speech, or could happen at the beginning or end of a file, and the list goes on. </p>\n\n<p>So to get down to it, can someone share something like this c++ workaround in Python? They call this issue \"denormals\" and they suggest flush to zero.</p>\n\n<p><a href=\"http://blog.audio-tk.com/2016/09/20/audio-toolkit-handling-denormals/?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+eifelle%2FCPPV+%28Matt%27s+blog%29\" rel=\"nofollow\">http://blog.audio-tk.com/2016/09/20/audio-toolkit-handling-denormals/?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+eifelle%2FCPPV+%28Matt%27s+blog%29</a></p>\n\n<p>And it would also be peace of mind to know whether or not zero is the only number to be wary of. Maybe, I should set significant digits for all numbers? Would that make a difference in audio applications? If so, how would that look in Python? Obviously we may want to avoid going overboard, like using integers only, which would probably result in a lot of sound degradation.</p>\n\n<p>Anyway, I think you get the idea of my question, I want the computation speed to be within reason, but still be able to have a half decent numpy representation of the .wav.</p>\n\n<p>Please help out if you can,</p>\n\n<p>Thank you</p>\n\n<p>\nImports are as follows:</p>\n\n<pre><code>import numpy as np\nfrom scipy.io import wavfile\nfrom scipy.signal import resample\n</code></pre>\n\n<p>also if you want to view the jupyter notebook to see the ICA application in its entirety, you can do so here:\n<a href=\"http://web.archive.org/web/20150314223948/http://shogun-toolbox.org/static/notebook/current/bss_audio.html\" rel=\"nofollow\">http://web.archive.org/web/20150314223948/http://shogun-toolbox.org/static/notebook/current/bss_audio.html</a></p>\n\n<p>**the link uses Python 2.7, I'm using Python 3.5, so things may vary slightly.</p>\n\n<p>--Edit</p>\n\n<p>Well. sorry for the confusion. The answer to why the shape of X changed is due to the fact the example notebook took the dot product differently than the way I was used to. They used <code>S=(np.c_[s1,s2,s3]).T</code>  then <code>np.dot(A,S)</code>. I usually use <code>S=np.c_[s1,s2,s3]</code> then <code>np.dot(S,A.T)</code>. So all I had to do was transform a few things to get the desired shape of X. Classic case of not looking before I leaped. I was wrong to have blamed <code>np.delete(data,-1)</code> for causing that shape mishap. It has proven to work for handling primes, guaranteeing data will be an even number. I will delete some of my unnecessary comments to restore clarity to my post.</p>\n\n<p>The verdict is still out on flush to zero / significant digit thresholds in terms of audio processing code efficiency. I hope this particular aspect of my question is revisited sometime soon. Until then, I will be using <code>np.delete(data,-1)</code> as a quick and dirty solution when dealing with large/prime numbers.</p>\n"}, {"tags": ["c++", "performance", "c++11", "memory", "vector"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1474478482, "post_id": 39622833, "comment_id": 66551227, "body": "Try a) adding <code>reserve</code> calls to the destinations, and b) removing the <code>erase</code> (no need for that)."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1474478779, "post_id": 39622833, "comment_id": 66551377, "body": "Add <code>reserve()</code> on both destination vectors. Get rid of the <code>std::move()</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1474479015, "post_id": 39622833, "comment_id": 66551488, "body": "Doing that breaks the OP&#39;s requirements."}, {"owner": {"reputation": 97, "user_id": 3287358, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/qifR1.jpg?s=128&g=1", "display_name": "Murray", "link": "https://stackoverflow.com/users/3287358/murray"}, "edited": false, "score": 0, "creation_date": 1474479080, "post_id": 39622833, "comment_id": 66551528, "body": "Why don&#39;t I need <code>erase</code> or <code>move</code>?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1474479143, "post_id": 39622833, "comment_id": 66551563, "body": "@Murray: Erasing is pure wasted work with zero benefit whatsoever."}, {"owner": {"reputation": 10955, "user_id": 1915854, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/gIC27.jpg?s=128&g=1", "display_name": "Serge Rogatch", "link": "https://stackoverflow.com/users/1915854/serge-rogatch"}, "edited": false, "score": 1, "creation_date": 1474479341, "post_id": 39622833, "comment_id": 66551691, "body": "With <code>erase</code> your algorithm is slow because complexity is O(N*N), because you erase at the beginning, while a <code>vector</code> is slow at erasing at the beginning (requires O(N)), but it&#39;s fast at erasing at the end (O(1))."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 3287358, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/qifR1.jpg?s=128&g=1", "display_name": "Murray", "link": "https://stackoverflow.com/users/3287358/murray"}, "edited": false, "score": 0, "creation_date": 1474482916, "post_id": 39623007, "comment_id": 66553557, "body": "The solution works very well in general, but I have a file that generates a <code>string_weight</code> vector of ~40 millions entries. In this case, on my poor memory linux laptop, swap space is getting involved when the unpacking starts and a lot of pain happens..."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 97, "user_id": 3287358, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/qifR1.jpg?s=128&g=1", "display_name": "Murray", "link": "https://stackoverflow.com/users/3287358/murray"}, "edited": false, "score": 0, "creation_date": 1474483421, "post_id": 39623007, "comment_id": 66553810, "body": "@Murray: Can you change the algorithm to write directly to two separate vectors?"}, {"owner": {"reputation": 97, "user_id": 3287358, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/qifR1.jpg?s=128&g=1", "display_name": "Murray", "link": "https://stackoverflow.com/users/3287358/murray"}, "edited": false, "score": 0, "creation_date": 1474483663, "post_id": 39623007, "comment_id": 66553947, "body": "unfortunately I can&#39;t :("}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 97, "user_id": 3287358, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/qifR1.jpg?s=128&g=1", "display_name": "Murray", "link": "https://stackoverflow.com/users/3287358/murray"}, "edited": false, "score": 2, "creation_date": 1474485216, "post_id": 39623007, "comment_id": 66554778, "body": "@Murray: Can you change the consumer so it can read from the single vector using two projectors?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 97, "user_id": 3287358, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/qifR1.jpg?s=128&g=1", "display_name": "Murray", "link": "https://stackoverflow.com/users/3287358/murray"}, "edited": false, "score": 0, "creation_date": 1474485312, "post_id": 39623007, "comment_id": 66554825, "body": "Also, 40M entries is hardly a lot. Assuming 3 words for the string and 1 for the size, that&#39;s 32 x 40M bytes, i.e. just over 1GB. That&#39;s an entirely havable amount of memory..."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1474565262, "post_id": 39623007, "comment_id": 66594018, "body": "Projections is definitely the way to go if at all possible."}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 7, "last_activity_date": 1474479042, "creation_date": 1474479042, "answer_id": 39623007, "question_id": 39622833, "link": "https://stackoverflow.com/questions/39622833/elegant-way-for-space-efficient-unpacking-of-a-vector-of-pairs-in-two-vectors/39623007#39623007", "title": "Elegant way for space efficient unpacking of a vector of pairs in two vectors", "body": "<p>Try this:</p>\n\n<pre><code>std::vector&lt;std::string&gt; strings;\nstd::vector&lt;std::size_t&gt; weights;\n\nstrings.reserve(string_weight.size());\nweights.reserve(string_weight.size());\n\nfor (auto &amp; p : string_weights)\n{\n     strings.push_back(std::move(p.first));\n     weights.push_back(p.second);\n}\n</code></pre>\n\n<p>A few variations:</p>\n\n<ul>\n<li><p>pre-construct the weights vector:</p>\n\n<pre><code>std::vector&lt;std::size_t&gt; weights(string_weight.size());\n\n// ...\n\nweights[i] = string_weights[i].second;\n</code></pre>\n\n<p>This may be better because it avoids repeated size checking, but costs you the initial zeroing out. (This could be avoided with a raw dynamic array, or a non-constructing allocator.)</p></li>\n<li><p>pre-construct the strings vector:</p>\n\n<pre><code>std::vector&lt;std::string&gt; strings(string_weight.size());\n\n// ...\n\nstrings[i] = std::move(string_weights[i].first);\n// or\nstrings[i].swap(string_weights[i].first);\n</code></pre>\n\n<p>Similarly, this avoids repeated range checking.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1474483839, "post_id": 39623161, "comment_id": 66554053, "body": "This doesn&#39;t solve the OP&#39;s memory woes. Poping from a vector does not free memory.  Freeing the memory causes a memory spike the OP was hoping to avoid."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1474485564, "post_id": 39623161, "comment_id": 66554966, "body": "@Yakk provided solution at least not worse than OP used by memory consumption (actually should be better because memory allocated on target vectors at once). I doubt memory usage can be improved without changing data types (and/or algorythm) as shrinking source vector in process most possible would make it worse."}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 2, "last_activity_date": 1474480328, "last_edit_date": 1474480328, "creation_date": 1474479594, "answer_id": 39623161, "question_id": 39622833, "link": "https://stackoverflow.com/questions/39622833/elegant-way-for-space-efficient-unpacking-of-a-vector-of-pairs-in-two-vectors/39623161#39623161", "title": "Elegant way for space efficient unpacking of a vector of pairs in two vectors", "body": "<p>Erasing element in the beginning of <code>std::vector</code> is expensive operation. You may use 3 possibilities to speed it up:</p>\n\n<ol>\n<li>use <code>std::deque</code> instead of <code>std::vector</code> for pairs, it has O(1) for deleting element in front</li>\n<li><p>clear vector of pairs after loop</p></li>\n<li><p>resize target vectors in advance and copy elements backwards</p></li>\n</ol>\n\n<p>example:</p>\n\n<pre><code>std::vector&lt;std::string&gt; strings( string_weight.size() );\nauto tit1 = strings.rbegin();\nstd::vector&lt;size_t&gt; weights( string_weight.size() );\nauto tit2 = weigths.rbegin();\nfor (auto it = string_weight.rbegin(); string_weight.size(); it++, string_weight.pop_back()) {\n     *tit1++ = std::move(it-&gt;first);\n     *tit2++ = std::move(it-&gt;second);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27522, "user_id": 6394138, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/u64Lc.png?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/6394138/leon"}, "is_accepted": false, "score": 3, "last_activity_date": 1474480604, "last_edit_date": 1474480604, "creation_date": 1474479638, "answer_id": 39623178, "question_id": 39622833, "link": "https://stackoverflow.com/questions/39622833/elegant-way-for-space-efficient-unpacking-of-a-vector-of-pairs-in-two-vectors/39623178#39623178", "title": "Elegant way for space efficient unpacking of a vector of pairs in two vectors", "body": "<p>Removing elements from a <code>std::vector</code> doesn't free any memory (that is directly owned by the container itself). Even if it did free up memory (which can be achieved by calling <a href=\"http://en.cppreference.com/w/cpp/container/vector/shrink_to_fit\" rel=\"nofollow\"><code>shrink_to_fit()</code></a> after <code>erase()</code>) that would still require to temporarily (approximately) double the memory usage, since the reallocation would need to happen similar to how a <code>std::vector</code> is resized when it is grown - a new (somewhat smaller) block of memory would need to be allocated, the elements copied to that new area, and only then the old allocation would be released.</p>\n\n<p>So (unless you can replace the source <code>std::vector</code> with a <code>std::deque</code>) you should forget about lowering the high-watermark memory usage during this conversion.</p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1474483070, "creation_date": 1474483070, "answer_id": 39624166, "question_id": 39622833, "link": "https://stackoverflow.com/questions/39622833/elegant-way-for-space-efficient-unpacking-of-a-vector-of-pairs-in-two-vectors/39624166#39624166", "title": "Elegant way for space efficient unpacking of a vector of pairs in two vectors", "body": "<p>Alternatively to create new vectors, you may create views. so with <a href=\"https://ericniebler.github.io/range-v3/index.html\" rel=\"nofollow\">range-v3</a>, you may do:</p>\n\n<pre><code>const auto strings = string_weights | ranges::view::keys;\nconst auto weights = string_weights | ranges::view::values;\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/793910baa0e19d3d\" rel=\"nofollow\">Demo</a></p>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 3287358, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/qifR1.jpg?s=128&g=1", "display_name": "Murray", "link": "https://stackoverflow.com/users/3287358/murray"}, "edited": false, "score": 0, "creation_date": 1474487048, "post_id": 39624322, "comment_id": 66555796, "body": "I&#39;ve got why my solution is bad, thank you to pointing out. The first solution looks like similiar to the one provided by Kerrek, for the second I need more time &amp; practice with C++. I&#39;m still learning, btw"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1582108998, "post_id": 39624322, "comment_id": 106660885, "body": "If you copied backwards, you could remove elements from the end of a src std::vector.  In theory if you had a std::vector that could use <code>realloc</code> under the hood and shrink an existing allocation, instead of allocating a new smaller one and copying, you could release a few pages at a time to the free list.  But in practice all mainstream C++ implementations have <code>std::vector</code> that are hampered by <code>new</code>/<code>delete</code> not providing a try_realloc interface, making it impossible for them to be efficient."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1582109183, "post_id": 39624322, "comment_id": 106660974, "body": "If you were using POSIX <code>mmap</code> /<code>munmap</code> to manage memory, this would be an easy problem: just copy forward and <code>munmap</code> chunks of pages after you&#39;re done reading them.  And count on lazy allocation of the destination to not actually need new physical memory until you write it.  The very weak abstractions in C++ is really frustrating for many things that computers should be able to do efficiently.  (Especially for stuff that could easily just be a fallback where not implemented, like a <code>try_realloc</code>) ."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 2, "last_activity_date": 1474484699, "last_edit_date": 1474484699, "creation_date": 1474483638, "answer_id": 39624322, "question_id": 39622833, "link": "https://stackoverflow.com/questions/39622833/elegant-way-for-space-efficient-unpacking-of-a-vector-of-pairs-in-two-vectors/39624322#39624322", "title": "Elegant way for space efficient unpacking of a vector of pairs in two vectors", "body": "<p>You should first just try moving your content over.  Usually most of the space used by a <code>std::string</code> is not within the string itself.</p>\n\n<p>So you simply:</p>\n\n<pre><code>template&lt;template&lt;class...&gt;class Tuple, class...Ts&gt;\nusing vec_of_tup = std::vector&lt;Tuple&lt;Ts...&gt;&gt;;\ntemplate&lt;template&lt;class...&gt;class Tuple, class...Ts&gt;\nusing tup_of_vec = Tuple&lt; std::vector&lt;Ts&gt;... &gt;;\n\nvec_of_tup&lt;std::pair, std::string, std::size_t&gt; in;\ntup_of_vec&lt;std::pair, std::string, std::size_t&gt; out;\n\nout.first.reserve(in.size());\nout.second.reserve(in.size());\n\nfor(auto&amp;&amp; e:in) {\n  out.first.push_back( std::move(e.first) );\n  out.second.push_back( std::move(e.second) );\n}\ndecltype(in){}.swap(in); // forced clear\n</code></pre>\n\n<p>This does use more peak memory, as both vectors are in existence at the same time.  But data used for the strings (above a certain short size) is not double allocated, as we move it from one container to another.</p>\n\n<p>Only the \"bookkeeping\" data of the string is kept around twice.</p>\n\n<p>Avoiding that is nearly impossible.  Shrinking the memory used by the source vector requires reallocating a buffer of the new size.  If you do this after copying over K elements to the destination vectors, your memory use directly in the vectors is N+K before.  You have to create a new buffer of size (N-K) to copy the elements over to.  So you are using N+K+N-K = 2N memory.</p>\n\n<p>And if you are using 2N memory, you could just use the above solution and avoid the needless copies.</p>\n\n<p>Your code appears to use about 2.8N memory in the \"bookkeeping\" part of the string <em>and</em> does N^2/K element copies.  It is abysmally bad.</p>\n\n<p>Possibly your problem is you are using <code>std::vector</code> for ridiculously large N.  The benefits of <code>std::vector</code> start to fade when you are using vector sizes that approach that of the memory available on the system.</p>\n\n<p>An approach might be something like implementing a deque with a controlled block size, instead of the default small one.  Say 10 pages of memory per block.</p>\n\n<p>Now erase from the front/back is efficient, and your memory is reasonably contiguous with one page fault every few thousand element reads instead of pure node based containers with a page fault every element read.  You can move part of the container around without trashing your memory, as when you finish moving a block it is freed.</p>\n\n<p>Your optimization route is fraught, find another one.</p>\n\n<p>This is an initial spike.  It is not exception safe:</p>\n\n<pre><code>template&lt;class T, std::size_t block_size_guess = 10*4096&gt;\nstruct block_vector {\n  template&lt;class...Args&gt;\n  void emplace_back( Args&amp;&amp;...args ) {\n    if (!last_block_used) {\n      blocks.emplace_back();\n    }\n    new( (void*)get_ptr( size() ) ) T(std::forward&lt;Args&gt;(args)...);\n    last_block_used = (last_block_used+1)%block_size;\n  }\n  template&lt;class...Args&gt;\n  void emplace_front( Args&amp;&amp;...args ) {\n    if (!first_block_unused) {\n      blocks.emplace_front();\n      first_block_unused = block_size;\n    }\n    --first_block_unused;\n    new( (void*)get_ptr( 0 ) ) T(std::forward&lt;Args&gt;(args)...);\n  }\n\n  std::size_t size() const {\n    if (last_block_used) // if zero, it means the last block is full\n      return blocks.size() * block_size - first_block_unused + last_block_used - block_size;\n    else\n      return blocks.size() * block_size - first_block_unused;\n  }\n  T&amp; operator[]( std::size_t i ) { return *get_ptr(i); }\n  T const&amp; operator[]( std::size_t i ) const { return *get_ptr(i); }\n  // todo: iterators, front(), back(), erase( it, it ), erase( it ), etc.\nprivate:\n  enum {\n    block_calc = block_size_guess/sizeof(T),\n    block_size = block_calc?block_calc:1,\n  };\n  using raw_block = std::array&lt; std::array&lt;unsigned char, sizeof(T)&gt;, block_size &gt;;\n  std::deque&lt;raw_block&gt; blocks;\n  std::size_t first_block_unused = 0;\n  std::size_t last_block_used = 0;\n\n  using block = std::array&lt; T, block_size &gt;;\n\n  block&amp; get_block( std::size_t b ) {\n    return reinterpret_cast&lt;block&amp;&gt;(blocks[b]);\n  }\n  block const&amp; get_block( std::size_t b ) const {\n    return reinterpret_cast&lt;block const&amp;&gt;(blocks[b]);\n  }\n  static std::size_t outer( std::size_t i ) { return (i+first_block_unused)/block_size; }\n  static std::size_t inner( std::size_t i ) { return (i+first_block_unused)%block-size; }\n  T* get_ptr( std::size_t i ) {\n    return std::addressof( get_block( outer(i) )[ inner(i) ] );\n  }\n  T const* get_ptr( std::size_t i ) const {\n    return std::addressof( get_block( outer(i) )[ inner(i) ] );\n  }\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 0, "last_activity_date": 1474485102, "creation_date": 1474485102, "answer_id": 39624740, "question_id": 39622833, "link": "https://stackoverflow.com/questions/39622833/elegant-way-for-space-efficient-unpacking-of-a-vector-of-pairs-in-two-vectors/39624740#39624740", "title": "Elegant way for space efficient unpacking of a vector of pairs in two vectors", "body": "<p>Sorry to be the harbinger of doom here, but,</p>\n\n<p>If you are memory-constrained, you will need to either:</p>\n\n<ol>\n<li>batch-process the file, or </li>\n<li>if possible, treat the file as a random-access data store.</li>\n</ol>\n\n<p>Unless you <code>reserve</code> memory in the destination vectors, they will likely resize a few times while being filled. This will not only <em>over-allocate</em> memory but will also <em>encourage fragmentation</em> - the enemy of contiguous memory allocation (upon which <code>std::vector</code> depends, mandated by the standard).</p>\n\n<p>Additionally, once the initial vector has been populated (even if you did it efficiently by reserving the right amount of space) it will never shrink without calling <code>shrink_to_fit</code>. Even then, there is no guarantee that it will shrink. And worse, if it did, while doing so, it would consume more memory during the operation.</p>\n"}, {"tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 0, "last_activity_date": 1582111475, "creation_date": 1582111475, "answer_id": 60299274, "question_id": 39622833, "link": "https://stackoverflow.com/questions/39622833/elegant-way-for-space-efficient-unpacking-of-a-vector-of-pairs-in-two-vectors/60299274#60299274", "title": "Elegant way for space efficient unpacking of a vector of pairs in two vectors", "body": "<p><strong>If it weren't for all the levels of abstraction in C++, you could do this in-place</strong>.</p>\n\n<p>None of this is possible for the memory owned by a <code>std::vector</code> in C++, of course.  And even in assembly, you'd need a way to tell your memory allocator that your one big allocation is now two smaller allocations.  If you wanted to be <em>able</em> to do this in C++, you'd maybe use a union of arrays or something, or placement new to repurpose raw memory you got from an allocator.</p>\n\n<p>I post this just as an illustration of how much it sucks to have levels of abstraction that make efficient code impossible.  (e.g. C++ new/delete doesn't even have a try_realloc that could let <code>vector</code> <em>attempt</em> to grow or shrink in-place; all the mainstream C++ implementations have a std::vector that always just allocates and copies without even trying to see if there is free address space contiguous with the existing allocation when growing.)  IDK why ISO C++ still hasn't added anything which could allow efficient memory management (besides <code>std::malloc</code> / <code>std::realloc</code> which aren't compatible with new/delete).</p>\n\n<p>If you want to grow a std::vector without writing the new elements (because you want to <code>read()</code> into that memory or something), you need a vector using a custom allocator to not construct the elements.</p>\n\n<hr>\n\n<p><code>std::string</code> can be <code>std::move</code>ed, which just boils down to copying the object representation.  And <code>size_t</code> is trivially copyable.</p>\n\n<p>Given the size ratios of the pair of objects, calculate the byte offset of the end of the first output array.  e.g. assuming a 32-byte <code>std::string</code> (3 pointers plus extra space for inline small strings, like libstdc++ on x86-64 uses), and an 8-byte <code>size_t</code>, the ratio is 4:1.  Assuming alignment doesn't require extra padding in each pair, that means the source vector has 40-byte elements.</p>\n\n<p>So for a 10M element source array (400M bytes), the string array will be 10 M elements, 320M bytes, and the size_t array will be 80M bytes.</p>\n\n<p>When we're done, the string array will be the first 320MB of the pair array, and the size_t array will be the next 80MB.  We can calculate ahead of time a pointer to that destination.  The location is <em>also</em> the start of a pair that needs to be read before we overwrite that memory</p>\n\n<p><strong>I'll first explain a 1:1 size ratio of objects in a pair.</strong></p>\n\n<ul>\n<li>load 2 pairs, one from the start of the whole, and from the offset where the 2nd array will start.  (i.e. <code>tmp0 = vec[pos0]; tmp1 = vec[pos1]</code>)</li>\n<li>store the first member of each tmp pair into the space where the first pair was.</li>\n<li>store the second member of each tmp pair into the space where the second was.</li>\n</ul>\n\n<p>Repeat until done, incrementing positions.  Allocating or touching any new memory for this is a total waste of CPU cycles, and will cause unnecessary memory pressure.  On CPUs with SIMD, these loads and shuffles can be nicely vectorized and hopefully run at near-memcpy speed, and fully benefit from the destination being hot in cache vs. copying to new cold memory.</p>\n\n<p><strong>For pairs of uneven sizes</strong>, you need to load e.g. 4 pairs from the start for every 1 pair from the middle.  4x 40 = 5x 32, so again we can put the new data back without overwriting anything we haven't read yet.  And in the high part, 1x 40B = 5x 8B.</p>\n\n<p>In C++ you could use a local tmp array and a compiler could still plausibly optimize this into registers for small array sizes.</p>\n\n<hr>\n\n<p>Alternatively, don't create a huge vector of pairs in the first place.  Read from the file in medium-sized chunks (like 8kiB is a good size that fits comfortably into L1d cache) and parse lines into 2 vectors.</p>\n"}], "owner": {"reputation": 97, "user_id": 3287358, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/qifR1.jpg?s=128&g=1", "display_name": "Murray", "link": "https://stackoverflow.com/users/3287358/murray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1512, "favorite_count": 0, "answer_count": 7, "score": 3, "last_activity_date": 1582111475, "creation_date": 1474478421, "question_id": 39622833, "link": "https://stackoverflow.com/questions/39622833/elegant-way-for-space-efficient-unpacking-of-a-vector-of-pairs-in-two-vectors", "title": "Elegant way for space efficient unpacking of a vector of pairs in two vectors", "body": "<p>I have a big vector of <code>std::pair&lt;std::string,size_t&gt;</code> elements and I want to unpack it in two vectors using small extra memory overhead (I don't want the memory space occupation doubled, i.e. erasing the vector of pairs after the unpacking) and possibly as fast as possible. The following solution is unacceptably slow:</p>\n\n<pre><code>std::vector&lt;std::pair&lt;std::string, size_t&gt;&gt; string_weight;\nget_from_file(\"mybigfile.txt\", string_weight); //it just fills the string_weight vector\n//... do stuff...\nstd::vector&lt;std::string&gt; strings;\nstd::vector&lt;size_t&gt; weights;\nfor (auto it = string_weight.begin(); it != string_weight.end() ; it = string_weight.erase(it)) {\n     strings.push_back(std::move(it-&gt;first));\n     weights.push_back(std::move(it-&gt;second));\n}\n</code></pre>\n\n<p>Therefore I tried to modify the previous solution just changing the for loop in the following way:</p>\n\n<pre><code>for (auto it = string_weight.begin(), it2 = it; it != string_weight.end() ; it = string_weight.erase(it, it2)) {\n        size_t delta = 100000;\n        for ( it2 = it ; it2 != string_weight.end() &amp;&amp; it2 != it+delta; it2++ ) {\n            strings.push_back(std::move(it2-&gt;first));\n            weights.push_back(std::move(it2-&gt;second));\n        }\n    }\n</code></pre>\n\n<p>This is faster but the completion time is proportional to the value I choose for <code>delta</code> and I don't like it. Can you help me giving a solution or pointing out some useful technique?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c++", "visual-studio", "com"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1474478348, "post_id": 39622640, "comment_id": 66551169, "body": "@PeteBecker the parameter for that function (<code>GetBool</code>) is a function taking bool, which wont work with a member function."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1474478680, "post_id": 39622640, "comment_id": 66551330, "body": "You can&#39;t do that. Non-static class member functions aren&#39;t functions, e.g. they cannot be <i>called</i> like functions can be called."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1474478996, "post_id": 39622640, "comment_id": 66551477, "body": "Voted to close as <b>unclear what you&#39;re asking</b>. See <a href=\"http://stackoverflow.com/a/39622968/464581\">my comment-as-answer</a> for some hopefully helpful commentary about that."}], "answers": [{"comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1474478802, "post_id": 39622938, "comment_id": 66551385, "body": "Even if you change that you can&#39;t call a member function without an instance."}, {"owner": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1474479095, "post_id": 39622938, "comment_id": 66551536, "body": "@Borgleader : that&#39;s right; answer fixed (I hope with no mistake)"}, {"owner": {"reputation": 1719, "user_id": 5306861, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ZbylG.png?s=128&g=1", "display_name": "codeDom", "link": "https://stackoverflow.com/users/5306861/codedom"}, "edited": false, "score": 0, "creation_date": 1474482448, "post_id": 39622938, "comment_id": 66553286, "body": "@shrike I get error <code>expected a member name</code> on this line: <code>setting-&gt;(*func)(&amp;b);</code>"}, {"owner": {"reputation": 1719, "user_id": 5306861, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ZbylG.png?s=128&g=1", "display_name": "codeDom", "link": "https://stackoverflow.com/users/5306861/codedom"}, "edited": false, "score": 0, "creation_date": 1474523869, "post_id": 39622938, "comment_id": 66567326, "body": "@shrike Excellent! Thank you."}], "tags": [], "owner": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "is_accepted": true, "score": 1, "last_activity_date": 1474495884, "last_edit_date": 1474495884, "creation_date": 1474478753, "answer_id": 39622938, "question_id": 39622640, "link": "https://stackoverflow.com/questions/39622640/c-visual-studio-2015-non-standard-syntax-use-to-create-a-pointer-to-memb/39622938#39622938", "title": "C++ Visual Studio 2015 \u201cnon-standard syntax; use &#39;&amp;&#39; to create a pointer to member\u201d", "body": "<p>The correct definition for a pointer to <strong>member</strong> function is:</p>\n\n<pre><code>typedef HRESULT(ITaskSettings::*FuncOfBoll)(_Out_ VARIANT_BOOL* b);\n</code></pre>\n\n<p>Then, you should pass the pointer to the object instance to function <code>GetBool</code>:</p>\n\n<pre><code>static bool GetBool(ITaskSettings* setting, FuncOfBoll func)\n{\n    VARIANT_BOOL b = VARIANT_FALSE;\n    HRESULT hr = (setting-&gt;*func)(&amp;b);\n    ...\n}\n</code></pre>\n\n<p>Or, with template:</p>\n\n<pre><code>template&lt;class C&gt;\nstatic bool GetBool(C* p, HRESULT(C::*func)(_Out_ VARIANT_BOOL*))\n{\n    VARIANT_BOOL b = VARIANT_FALSE;\n    HRESULT hr = (p-&gt;*func)(&amp;b);\n    ...\n}\n</code></pre>\n\n<p>Invocation:</p>\n\n<pre><code>void test(ITaskSettings* settings)\n{\n    currentSetttings = settings;\n    bool b = GetBool(settings, &amp;ITaskSettings::mb_function);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1474479134, "last_edit_date": 1474479134, "creation_date": 1474478831, "answer_id": 39622958, "question_id": 39622640, "link": "https://stackoverflow.com/questions/39622640/c-visual-studio-2015-non-standard-syntax-use-to-create-a-pointer-to-memb/39622958#39622958", "title": "C++ Visual Studio 2015 \u201cnon-standard syntax; use &#39;&amp;&#39; to create a pointer to member\u201d", "body": "<p>I am guessing that <code>get_StopIfGoingOnBatteries</code> is a member function of<code>ITaskSettings</code>. Such a function cannot be used when the expected argument type is <code>FuncOfBoll</code>. You'll need to create a wrapper function and use it.</p>\n\n<pre><code>ITaskSettings* currentSetttings = NULL;\n\nHRESULT GetBoolWrapper(_Out_ VARIANT_BOOL* b)\n{\n   return currentSetttings-&gt;get_StopIfGoingOnBatteries(b);\n}\n\nvoid test(ITaskSettings* settings)\n{\n   currentSetttings = settings;\n   bool b = GetBool(GetBoolWrapper);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "is_accepted": false, "score": 0, "last_activity_date": 1474478871, "creation_date": 1474478871, "answer_id": 39622968, "question_id": 39622640, "link": "https://stackoverflow.com/questions/39622640/c-visual-studio-2015-non-standard-syntax-use-to-create-a-pointer-to-memb/39622968#39622968", "title": "C++ Visual Studio 2015 \u201cnon-standard syntax; use &#39;&amp;&#39; to create a pointer to member\u201d", "body": "<p><sup>This is not really an answer, the question as written doesn't admit an answer, but this is too long &amp; detailed for comment.</sup></p>\n\n<p>You don't show a full examples, so there has to be <strong>guesswork</strong>.</p>\n\n<p>Apparently, judging by the error message, <code>settings</code> is a pointer to class type object, where that class has a member function <code>get_StopIfGoingOnBatteries</code>.</p>\n\n<p>And apparently, judging by the use of <code>-&gt;</code> operator, it's a non-<code>static</code> member function. You could still use <code>-&gt;</code> if it were <code>static</code>, but that would be unnatural. So let's say it's a non-<code>static</code> member function.</p>\n\n<p>Then you can't easily form a raw pointer to function that calls that member function, because you need a <code>this</code>-pointer for the call. It could just use a dummy object, if creation of such object is cheap, or it could use a global instance or pointer to instance. But better change something in your design, and/or explain more clearly what you want.</p>\n"}], "owner": {"reputation": 1719, "user_id": 5306861, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ZbylG.png?s=128&g=1", "display_name": "codeDom", "link": "https://stackoverflow.com/users/5306861/codedom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1133, "favorite_count": 0, "accepted_answer_id": 39622938, "answer_count": 3, "score": 0, "last_activity_date": 1474495884, "creation_date": 1474477834, "question_id": 39622640, "link": "https://stackoverflow.com/questions/39622640/c-visual-studio-2015-non-standard-syntax-use-to-create-a-pointer-to-memb", "title": "C++ Visual Studio 2015 \u201cnon-standard syntax; use &#39;&amp;&#39; to create a pointer to member\u201d", "body": "<p>I work with TaskScheduler COM, this is my code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>typedef HRESULT(*FuncOfBoll)(_Out_ VARIANT_BOOL* b);\n\nstatic bool GetBool(FuncOfBoll func)\n{\n    VARIANT_BOOL b = VARIANT_FALSE;\n    HRESULT hr = func(&amp;b);\n    if (FAILED(hr)) return FALSE;\n    return b == VARIANT_TRUE;\n}\n\nvoid test(ITaskSettings* settings)\n{\n    bool b = GetBool(settings-&gt;get_StopIfGoingOnBatteries); // &lt;= The error here\n    // ...\n}\n</code></pre>\n\n<p>and I get the following error:</p>\n\n<blockquote>\n  <p>Error C3867   'ITaskSettings::get_StopIfGoingOnBatteries': non-standard\n  syntax; use '&amp;' to create a pointer to member</p>\n</blockquote>\n\n<p>What is my mistake and how to correct it?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1474477689, "post_id": 39622508, "comment_id": 66550817, "body": "<a href=\"http://en.cppreference.com/w/cpp/language/user_literal\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/user_literal</a>"}], "answers": [{"comments": [{"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 48, "creation_date": 1474477562, "post_id": 39622509, "comment_id": 66550757, "body": "It was a simple and terrible abuse of macros. Never do this."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1474477611, "post_id": 39622509, "comment_id": 66550788, "body": "Don&#39;t use the preprocessor for this. Since you&#39;re programming in C++, you should really use <a href=\"http://en.cppreference.com/w/cpp/language/user_literal\" rel=\"nofollow noreferrer\">user-defined literals</a>."}, {"owner": {"reputation": 5009, "user_id": 1183123, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/95444bd24a37e2beb187c89067aaacf1?s=128&d=identicon&r=PG", "display_name": "PermanentGuest", "link": "https://stackoverflow.com/users/1183123/permanentguest"}, "edited": false, "score": 1, "creation_date": 1474477613, "post_id": 39622509, "comment_id": 66550789, "body": "yeah, quite not c++. But I guess it was cute when the code was written 10/15 years ago"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 21, "creation_date": 1474478626, "post_id": 39622509, "comment_id": 66551301, "body": "It would have been better 10 - 15 years ago to use something like <code>16 * MBYTE</code>,  and preferably defined a MBYTE as a static constant if it didn&#39;t need to be used in constant expressions.  One problem with your macro is that <code>var &#47; 1 MByte</code> doesn&#39;t divide <code>var</code> by a megabyte like it seems, it multiplies it by a megabyte instead."}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "edited": false, "score": 16, "creation_date": 1474478924, "post_id": 39622509, "comment_id": 66551438, "body": "If you have to keep using macros, at the very least, this should <i>really</i> be something like <code>#define KByte(x) ((x) * 1024)</code>, <code>#define MByte(x) ((x) * 1024 * 1024)</code>, and <code>#define GByte(x) ((x) * 1024 * 1024 * 1024)</code>, so it&#39;s less likely to break something.  Sure, that means a bit of refactoring, but it&#39;s better than any of the insanity that can happen if you misuse the current macros."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1474535295, "post_id": 39622509, "comment_id": 66573814, "body": "Yeah there&#39;s really nothing &quot;clever&quot; about this!"}, {"owner": {"reputation": 14815, "user_id": 216111, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f6b5ef485ac16233e1536193245fc55?s=128&d=identicon&r=PG", "display_name": "josefx", "link": "https://stackoverflow.com/users/216111/josefx"}, "edited": false, "score": 3, "creation_date": 1474630743, "post_id": 39622509, "comment_id": 66621363, "body": "100ull MByte / 16 MByte gives 6871947673600, without the ull it would just overflow. Use with caution."}], "tags": [], "owner": {"reputation": 5009, "user_id": 1183123, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/95444bd24a37e2beb187c89067aaacf1?s=128&d=identicon&r=PG", "display_name": "PermanentGuest", "link": "https://stackoverflow.com/users/1183123/permanentguest"}, "is_accepted": false, "score": 6, "last_activity_date": 1474477416, "creation_date": 1474477416, "answer_id": 39622509, "question_id": 39622508, "link": "https://stackoverflow.com/questions/39622508/how-to-write-a-literal-constant-like-size-t-s-16-mbyte/39622509#39622509", "title": "How to write a literal constant like &quot;size_t s = 16 MByte&quot;?", "body": "<p>It was a simple and clever use of the good old macros.</p>\n\n<pre><code>#define KByte *1024\n#define MByte *1024*1024\n#define GByte *1024*1024*1024\n</code></pre>\n\n<p>So <code>size_t poolSize = 16 MByte;</code> gets translated into </p>\n\n<pre><code>size_t poolSize = 16 *1024*1024;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65373, "user_id": 819272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/o7w9X.png?s=128&g=1", "display_name": "TemplateRex", "link": "https://stackoverflow.com/users/819272/templaterex"}, "edited": false, "score": 24, "creation_date": 1474485758, "post_id": 39622579, "comment_id": 66555073, "body": "MiB would be more accurate"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 65373, "user_id": 819272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/o7w9X.png?s=128&g=1", "display_name": "TemplateRex", "link": "https://stackoverflow.com/users/819272/templaterex"}, "edited": false, "score": 8, "creation_date": 1474491769, "post_id": 39622579, "comment_id": 66558380, "body": "@TemplateRex: I used to argue that some 15+ years ago. But those unit designations never caught on. We&#39;re caught in frozen history, as with much else."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1474509152, "post_id": 39622579, "comment_id": 66563296, "body": "It seems like MiB / GiB / TiB do sometimes still get used in disk and file size / usage.  Probably it&#39;s more relevant there because non-power-of-two sizes are common, and because 1.024^n gets farther and farther away from 1 with larger prefixes."}, {"owner": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "edited": false, "score": 15, "creation_date": 1474514936, "post_id": 39622579, "comment_id": 66564677, "body": "They won&#39;t catch on unless we keep insisting on their use."}, {"owner": {"reputation": 35704, "user_id": 4958, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ca82d17e7496d3c20b9c8038f87ae49?s=128&d=identicon&r=PG", "display_name": "ShreevatsaR", "link": "https://stackoverflow.com/users/4958/shreevatsar"}, "edited": false, "score": 1, "creation_date": 1474515042, "post_id": 39622579, "comment_id": 66564704, "body": "This lets you write <code>16_MByte</code> but not <code>16 MByte</code>, I think. Which is not a problem, but is worth pointing out."}, {"owner": {"reputation": 99643, "user_id": 445517, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/57e2ba76e6290c4e9e19821a068bc8c1?s=128&d=identicon&r=PG", "display_name": "CodesInChaos", "link": "https://stackoverflow.com/users/445517/codesinchaos"}, "edited": false, "score": 4, "creation_date": 1474531600, "post_id": 39622579, "comment_id": 66571622, "body": "Defining <i>M</i> as something different from million is far more evil than any macro."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 13, "creation_date": 1474535048, "post_id": 39622579, "comment_id": 66573691, "body": "Why do you take <code>unsigned long long</code>, but return a value that is over a <i>million</i> times larger as just a <code>long</code>? Surely return <code>unsigned long long</code> at least?"}, {"owner": {"reputation": 311858, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 2, "creation_date": 1474538240, "post_id": 39622579, "comment_id": 66575829, "body": "For yet more binary/decimal fun, consider a telco E1 &quot;2 Mbps&quot; leased line.  These actually run at 2048000 bps.  That&#39;s not 2*10^6, nor 2^21, but 2^11 * 10^3."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1474554534, "post_id": 39622579, "comment_id": 66587037, "body": "@LightnessRacesinOrbit: The <code>unsigned long long</code> formal argument is forced by the rules of C++. See the linked to documentation over at cpprefence.com."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1474559101, "post_id": 39622579, "comment_id": 66590325, "body": "@Cheersandhth.-Alf: I know, but the return type is up to you."}, {"owner": {"reputation": 44734, "user_id": 964243, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/fL1rH.png?s=128&g=1", "display_name": "Boann", "link": "https://stackoverflow.com/users/964243/boann"}, "reply_to_user": {"reputation": 65373, "user_id": 819272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/o7w9X.png?s=128&g=1", "display_name": "TemplateRex", "link": "https://stackoverflow.com/users/819272/templaterex"}, "edited": false, "score": 1, "creation_date": 1474647819, "post_id": 39622579, "comment_id": 66632401, "body": "@TemplateRex No-one says &quot;mebibyte&quot;. It sounds stupid."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1474681952, "post_id": 39622579, "comment_id": 66644798, "body": "At the time I wrote this answer I only thought about illustrating the basic concept &amp; syntax, with no extraneous issues. But from the comments it looks like some people at least would like some more production-like code, instead or in addition. For that, I&#39;d use <code>constexpr</code> to support compile time constants, and I&#39;d use a conditional expression with range checking and possible throwing to make sure the range of the return type isn&#39;t exceeded. However, that only kicks in at compile time when the <code>constexpr</code> nature is forced by being used as such. I don&#39;t know how to make this perfect."}, {"owner": {"reputation": 31937, "user_id": 2642204, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/AIjBF.jpg?s=128&g=1", "display_name": "BartoszKP", "link": "https://stackoverflow.com/users/2642204/bartoszkp"}, "edited": false, "score": 2, "creation_date": 1474887452, "post_id": 39622579, "comment_id": 66700120, "body": "@Cheersandhth.-Alf (Re: MiB) Git correctly uses KiB etc."}], "tags": [], "owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "is_accepted": true, "score": 88, "last_activity_date": 1474477936, "last_edit_date": 1474477936, "creation_date": 1474477636, "answer_id": 39622579, "question_id": 39622508, "link": "https://stackoverflow.com/questions/39622508/how-to-write-a-literal-constant-like-size-t-s-16-mbyte/39622579#39622579", "title": "How to write a literal constant like &quot;size_t s = 16 MByte&quot;?", "body": "<p>In modern C++ you should <a href=\"http://en.cppreference.com/w/cpp/language/user_literal\">define a literal notation</a>, e.g.</p>\n\n<pre><code>auto operator\"\"_MB( unsigned long long const x )\n    -&gt; long\n{ return 1024L*1024L*x; }\n</code></pre>\n\n<p>Then write</p>\n\n<pre><code>long const poolSize = 16_MB;\n</code></pre>\n\n<p>Don't use macros, they're <strong>Evil&trade;</strong>. In so many ways.</p>\n\n<hr>\n\n<p>Disclaimer: code not touched by compiler's hands.</p>\n"}, {"comments": [{"owner": {"reputation": 847, "user_id": 1302745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8debbb66e700fbf086da321417bbb0a5?s=128&d=identicon&r=PG", "display_name": "akaltar", "link": "https://stackoverflow.com/users/1302745/akaltar"}, "edited": false, "score": 41, "creation_date": 1474503811, "post_id": 39625300, "comment_id": 66562206, "body": "I really hope this is a joke."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 847, "user_id": 1302745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8debbb66e700fbf086da321417bbb0a5?s=128&d=identicon&r=PG", "display_name": "akaltar", "link": "https://stackoverflow.com/users/1302745/akaltar"}, "edited": false, "score": 0, "creation_date": 1474542962, "post_id": 39625300, "comment_id": 66578858, "body": "@akaltar: look up <code>std::ratio</code>/<code>std::chrono</code>."}], "tags": [], "owner": {"reputation": 6885, "user_id": 5405086, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/PxgGr.png?s=128&g=1", "display_name": "xinaiz", "link": "https://stackoverflow.com/users/5405086/xinaiz"}, "is_accepted": false, "score": 12, "last_activity_date": 1474487503, "last_edit_date": 1474487503, "creation_date": 1474487144, "answer_id": 39625300, "question_id": 39622508, "link": "https://stackoverflow.com/questions/39622508/how-to-write-a-literal-constant-like-size-t-s-16-mbyte/39625300#39625300", "title": "How to write a literal constant like &quot;size_t s = 16 MByte&quot;?", "body": "<p>Of course you should use template metaprogramming for this problem:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate&lt;long long N, long long M&gt;\nstruct is_power_of\n{ \n    static constexpr bool value = (N%M != 0)? false : is_power_of&lt;N/M, M&gt;::value;\n};\n\ntemplate&lt;long long M&gt;\nstruct is_power_of&lt;0, M&gt; : public std::false_type { };\ntemplate&lt;long long M&gt;\nstruct is_power_of&lt;1, M&gt; : public std::true_type { };\n\ntemplate&lt;long long N, typename = typename std::enable_if&lt;is_power_of&lt;N, 1024&gt;::value&gt;::type&gt;\nstruct bytes\n{\n    enum {value = N, next = value * 1024};   \n    template&lt;long long M&gt;\n    struct compile_time_get\n    {\n        enum {value = N*M};\n    };\n    static long long run_time_get(long long x) {return N*x;}\n};\n\ntypedef bytes&lt;1&gt; byte;\ntypedef bytes&lt;byte::next&gt; kilo_byte;\ntypedef bytes&lt;kilo_byte::next&gt; mega_byte;\ntypedef bytes&lt;mega_byte::next&gt; giga_byte;\ntypedef bytes&lt;giga_byte::next&gt; tera_byte;\ntypedef bytes&lt;tera_byte::next&gt; peta_byte;\ntypedef bytes&lt;peta_byte::next&gt; eksa_byte;\n\nint main()\n{\n    std::cout &lt;&lt; kilo_byte::compile_time_get&lt;3&gt;::value &lt;&lt; std::endl;\n    int input = 5;\n    std::cout &lt;&lt; mega_byte::run_time_get(input) &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>3072\n5242880\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/f4874e9e4d14ef23\">LIVE</a></p>\n"}, {"tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": false, "score": 6, "last_activity_date": 1474537965, "creation_date": 1474537965, "answer_id": 39635810, "question_id": 39622508, "link": "https://stackoverflow.com/questions/39622508/how-to-write-a-literal-constant-like-size-t-s-16-mbyte/39635810#39635810", "title": "How to write a literal constant like &quot;size_t s = 16 MByte&quot;?", "body": "<p>If you are going to be doing it a lot, then a user defined literal is the way to go.  OTOH, for one-offs (and to support older compilers and other languages), I'd go with the direct:</p>\n\n<pre><code>size_t poolSize = 16ul*1024*1024;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25596, "user_id": 3140, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/84dbc773c808111cc4ce138bff33f482?s=128&d=identicon&r=PG", "display_name": "Jacob Krall", "link": "https://stackoverflow.com/users/3140/jacob-krall"}, "edited": false, "score": 0, "creation_date": 1474552422, "post_id": 39640477, "comment_id": 66585440, "body": "These are just numbers, so why would you use macros instead of <code>const</code>?"}, {"owner": {"reputation": 15176, "user_id": 390363, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/662dda87a8ad559dca5570b7786cf6fb?s=128&d=identicon&r=PG", "display_name": "aragaer", "link": "https://stackoverflow.com/users/390363/aragaer"}, "reply_to_user": {"reputation": 25596, "user_id": 3140, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/84dbc773c808111cc4ce138bff33f482?s=128&d=identicon&r=PG", "display_name": "Jacob Krall", "link": "https://stackoverflow.com/users/3140/jacob-krall"}, "edited": false, "score": 1, "creation_date": 1474552852, "post_id": 39640477, "comment_id": 66585774, "body": "Because I can write these in header and then include that header in multiple files without worrying about how linker would handle the storage and other complex stuff. Text substitution is easy to understand."}, {"owner": {"reputation": 44559, "user_id": 411022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9905bf9a7b8d5a587c1bdff07ef2e801?s=128&d=identicon&r=PG", "display_name": "Ilmari Karonen", "link": "https://stackoverflow.com/users/411022/ilmari-karonen"}, "edited": false, "score": 7, "creation_date": 1474553120, "post_id": 39640477, "comment_id": 66586002, "body": "There should really be parentheses around <code>1024*1024</code>, otherwise you&#39;ll get weird behavior if and when somebody does <code>double rate = 1.0 &#47; MB</code>. The rule of thumb with <code>#define</code> is, if in doubt, <i>always</i> add extra parentheses."}, {"owner": {"reputation": 15176, "user_id": 390363, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/662dda87a8ad559dca5570b7786cf6fb?s=128&d=identicon&r=PG", "display_name": "aragaer", "link": "https://stackoverflow.com/users/390363/aragaer"}, "edited": false, "score": 0, "creation_date": 1474556389, "post_id": 39640477, "comment_id": 66588378, "body": "Correct. Fixed."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 4, "creation_date": 1474559201, "post_id": 39640477, "comment_id": 66590396, "body": "@aragaer: Text substitution is actually a lot <i>harder</i> to rationalise about, and particularly to debug. A simple <code>static constexpr const unsigned int KB = 1024</code> in a header will do."}, {"owner": {"reputation": 15176, "user_id": 390363, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/662dda87a8ad559dca5570b7786cf6fb?s=128&d=identicon&r=PG", "display_name": "aragaer", "link": "https://stackoverflow.com/users/390363/aragaer"}, "edited": false, "score": 0, "creation_date": 1474562109, "post_id": 39640477, "comment_id": 66592322, "body": "Well, since it is <code>C++</code>, that would be correct. Unfortunately most my experience is with <code>C</code>. Which explains why <code>define</code> is what I usually saw in the code."}], "tags": [], "owner": {"reputation": 15176, "user_id": 390363, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/662dda87a8ad559dca5570b7786cf6fb?s=128&d=identicon&r=PG", "display_name": "aragaer", "link": "https://stackoverflow.com/users/390363/aragaer"}, "is_accepted": false, "score": 1, "last_activity_date": 1474556381, "last_edit_date": 1474556381, "creation_date": 1474551053, "answer_id": 39640477, "question_id": 39622508, "link": "https://stackoverflow.com/questions/39622508/how-to-write-a-literal-constant-like-size-t-s-16-mbyte/39640477#39640477", "title": "How to write a literal constant like &quot;size_t s = 16 MByte&quot;?", "body": "<p>All the examples I saw were more like </p>\n\n<pre><code>#define KB 1024\n#define MB (1024*1024)\n\nsize_t poolSize = 16*MB;\n</code></pre>\n\n<p>No magic, no questions, just works.</p>\n"}], "owner": {"reputation": 5009, "user_id": 1183123, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/95444bd24a37e2beb187c89067aaacf1?s=128&d=identicon&r=PG", "display_name": "PermanentGuest", "link": "https://stackoverflow.com/users/1183123/permanentguest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5480, "favorite_count": 7, "accepted_answer_id": 39622579, "answer_count": 5, "score": 43, "last_activity_date": 1474556381, "creation_date": 1474477416, "last_edit_date": 1474533777, "question_id": 39622508, "link": "https://stackoverflow.com/questions/39622508/how-to-write-a-literal-constant-like-size-t-s-16-mbyte", "title": "How to write a literal constant like &quot;size_t s = 16 MByte&quot;?", "body": "<p>Today in our code base found the following line and liked its elegance for writing a memory size.  Was wondering for few minutes about how this was compiling.</p>\n\n<pre><code>size_t poolSize = 16 MByte;\n</code></pre>\n\n<p>One solution is given as my own answer. Any other solutions?</p>\n"}, {"tags": ["c++", "cmake", "gnu-make"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1474477666, "post_id": 39622247, "comment_id": 66550812, "body": "You could copy the executable somewhere else where CMake won&#39;t delete it."}, {"owner": {"reputation": 1577, "user_id": 6776535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c515e458c92c554943b271a6789f0372?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Pr&#233;vost", "link": "https://stackoverflow.com/users/6776535/robert-pr%c3%a9vost"}, "edited": false, "score": 0, "creation_date": 1474511042, "post_id": 39622247, "comment_id": 66563738, "body": "Is it alright if the test runs every time you build even if it succeeded previously or the executable and its dependencies did not change?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1474549489, "post_id": 39622247, "comment_id": 66583419, "body": "@Florian: Given question explicitely says that <code>I would like the build to fail.</code>, so just ignoring the error isn&#39;t suitable for the asker needs. Also, the question you reference as duplicate operates on configuration (<code>cmake</code>) stage, given question operates on build(<code>make</code>) stage."}, {"owner": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1474550400, "post_id": 39622247, "comment_id": 66584036, "body": "@Tsyvarev Sorry, didn&#39;t see the part of the question where the build should fail. What about just moving the custom command to a new/separate custom target that has a dependency to <code>UnitTest</code>?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1474552522, "post_id": 39622247, "comment_id": 66585523, "body": "@Florian: <code>What about just moving the custom command to a new ...</code> - Then the effect of <i>POST_BUILD</i> command will be lost - running the test only if it is rebuilt. I think about the test (or wrapper around it) which produces some file instead of failing. Then another target, which runs unconditionally, may check files created by tests and return a verdict."}, {"owner": {"reputation": 8889, "user_id": 3493731, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0ccfa8c5c786e748c8cf4f1d3bae9694?s=128&d=identicon&r=PG&f=1", "display_name": "MuertoExcobito", "link": "https://stackoverflow.com/users/3493731/muertoexcobito"}, "edited": false, "score": 0, "creation_date": 1474554269, "post_id": 39622247, "comment_id": 66586843, "body": "Running the tests even if the executable is not rebuilt is acceptable. It sounds like I will have to make another target. If somebody wants to make that into an answer, I&#39;d accept it."}], "answers": [{"tags": [], "owner": {"reputation": 1577, "user_id": 6776535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c515e458c92c554943b271a6789f0372?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Pr&#233;vost", "link": "https://stackoverflow.com/users/6776535/robert-pr%c3%a9vost"}, "is_accepted": true, "score": 2, "last_activity_date": 1474557656, "creation_date": 1474557656, "answer_id": 39642957, "question_id": 39622247, "link": "https://stackoverflow.com/questions/39622247/cmake-add-custom-command-failure-target-gets-deleted/39642957#39642957", "title": "cmake add_custom_command failure, target gets deleted", "body": "<p>The solution that I was alluding to was to use <code>add_custom_target</code> instead of <code>add_custom_command</code>.  While it will not delete the executable if the test fails and the build process as a whole fails if runUnitTest fails, this target does not get built as a result of building the UnitTest target specifically.</p>\n\n<pre><code>add_executable(UnitTest unittest.cpp)\nadd_custom_target(runUnitTest UnitTest COMMAND $&lt;TARGET_FILE:UnitTest&gt; DEPENDS UnitTest)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 1178599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c945530933e6bc12417eeb6f0af66233?s=128&d=identicon&r=PG", "display_name": "ddiepo", "link": "https://stackoverflow.com/users/1178599/ddiepo"}, "is_accepted": false, "score": 0, "last_activity_date": 1544201902, "creation_date": 1544201902, "answer_id": 53673873, "question_id": 39622247, "link": "https://stackoverflow.com/questions/39622247/cmake-add-custom-command-failure-target-gets-deleted/53673873#53673873", "title": "cmake add_custom_command failure, target gets deleted", "body": "<p>I struggled with this same problem:  I have a unit test I only want to run in the following conditions:</p>\n\n<ol>\n<li>The test has been modified.</li>\n<li>The code under test has been modified.</li>\n<li>The test failed its previous execution.</li>\n</ol>\n\n<p>In the event the test is run and fails I want the test binary to remain for debugging.</p>\n\n<p>The solution I ended up with uses a flag file to indicate the test has run and no longer needs to execute again.  Note the flag must live in the binary directory so that other builds are not impacted.  However the WORKING_DIRECTORY is set so the test can access read-only data files relative to its source location.  Here's what it all looks like -- I stuck this in a macro so all my various unit tests can invoke this, the only input to the macro is the test executable:</p>\n\n<pre><code>set (TEST_FLAG_FILE ${CMAKE_CURRENT_BINARY_DIR}/${TEST_EXECUTABLE}.PASSED)\n\n# This isn't normally needed since a rebuild will have a newer time stamp.\n# But it adds robustness to handle changes to the system clock.\nadd_custom_command(TARGET ${TEST_EXECUTABLE} \n    COMMENT \"Unit test ${TEST_EXECUTABLE} rebuilt; clearing flag ${TEST_FLAG_FILE}.\" \n    COMMAND ${CMAKE_COMMAND} -E remove -f ${TEST_FLAG_FILE}\n    POST_BUILD \n    WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR})\n\n# This command only runs if the flag isn't present or is older than the executable.\nadd_custom_command(OUTPUT ${TEST_FLAG_FILE}\n    COMMENT \"Unit Test Execution: ${TEST_EXECUTABLE}\" \n    COMMAND ${TEST_EXECUTABLE}\n    COMMAND ${CMAKE_COMMAND} -E touch ${TEST_FLAG_FILE}\n    MAIN_DEPENDENCY ${TEST_EXECUTABLE} \n    WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR})\n\n# Any \"make all\" will evaluate the preceding custom command.\nadd_custom_target(run_${TEST_EXECUTABLE} ALL DEPENDS ${TEST_FLAG_FILE})\n</code></pre>\n"}], "owner": {"reputation": 8889, "user_id": 3493731, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0ccfa8c5c786e748c8cf4f1d3bae9694?s=128&d=identicon&r=PG&f=1", "display_name": "MuertoExcobito", "link": "https://stackoverflow.com/users/3493731/muertoexcobito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2526, "favorite_count": 0, "accepted_answer_id": 39642957, "answer_count": 2, "score": 5, "last_activity_date": 1544201902, "creation_date": 1474476508, "last_edit_date": 1495535443, "question_id": 39622247, "link": "https://stackoverflow.com/questions/39622247/cmake-add-custom-command-failure-target-gets-deleted", "title": "cmake add_custom_command failure, target gets deleted", "body": "<p>I am building a test executable using CMake. During the build process, I would like to run the executable, which returns whether the tests pass or not. If not, I would like the build to fail. However, when I use <code>add_custom_command(... POST_BUILD ... )</code>, and use a <code>Makefile</code> generator, the test executable will be deleted (explain in this question: <a href=\"https://stackoverflow.com/questions/588550/why-does-gnu-make-delete-a-file\">Why does GNU make delete a file</a>). </p>\n\n<p>Is there a way to have CMake treat the executable as a <code>.PRECIOUS</code>, or otherwise change the CMakeLists.txt such that the executable doesn't get deleted if the tests fail?</p>\n\n<p>For reference, my CMakeList.txt looks like the following (simplified from actual):</p>\n\n<pre><code>add_executable(UnitTest unittest.cpp)\nadd_custom_command(TARGET UnitTest POST_BUILD COMMAND $&lt;TARGET_FILE:UnitTest&gt;)\n</code></pre>\n"}, {"tags": ["c++", "hashmap", "char"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1474476510, "post_id": 39622206, "comment_id": 66550140, "body": "Welcome to Stack Overflow! It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming.  Further reading: <b><a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a></b>"}, {"owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 0, "creation_date": 1474490910, "post_id": 39622206, "comment_id": 66557932, "body": "This code is hard to debug....code shows strange behavior... check out <a href=\"http://code.geeksforgeeks.org/pPUDRe\" rel=\"nofollow noreferrer\">code.geeksforgeeks.org/pPUDRe</a>"}], "answers": [{"tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": false, "score": 0, "last_activity_date": 1474507669, "creation_date": 1474507669, "answer_id": 39628861, "question_id": 39622206, "link": "https://stackoverflow.com/questions/39622206/hashmap-print-function-not-updating-sets/39628861#39628861", "title": "Hashmap Print Function Not Updating Sets", "body": "<p>You're passing a character pointer to <code>set</code>, and storing that pointer in your map.  Then you change what's in <code>key</code>, which will <em>change the value of the first key that you've already stored</em>, and store the same pointer again in your map.  So both keys will have the same value.</p>\n\n<p>This can also lead to pointers in the map pointing at invalid memory regions if they get deleted or the calling function returns, taking the passed in array out of scope.</p>\n\n<p>You'll need to make a copy of your key when you store it in your hash map.</p>\n"}], "owner": {"reputation": 27, "user_id": 6854626, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/10d0ccaa768d8c949a952fa52f8be54d?s=128&d=identicon&r=PG&f=1", "display_name": "user6854626", "link": "https://stackoverflow.com/users/6854626/user6854626"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1474507669, "creation_date": 1474476352, "last_edit_date": 1474476606, "question_id": 39622206, "link": "https://stackoverflow.com/questions/39622206/hashmap-print-function-not-updating-sets", "title": "Hashmap Print Function Not Updating Sets", "body": "<p>My hashmap print function appears to be faulty. It is printing the correct values, but the incorrect keys. In the code below, I get user input for two key/value pairs and it only prints out the key of the second input. </p>\n\n<p>For example, for the first pair, I will input 12/\"e\", and the second pair, I will input 15/\"f\" and the output will be f | 12, f| 15. Does anybody know what is going on? I think it might be something with the char array, and I would use strings, but I can only use primitives for this task. The size of the char array for 100 is just an arbitrarily big number that I thought would not be exceeded by a user key. Thanks!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\ntypedef struct _node\n{\n    char *key;\n    int value;          /* For this, value will be of type int */\n    struct _node *next; /* pointer to the next node in the list */\n} node;\n\n/* HashMap class */\nclass HashMap\n{\nprivate:\n    node ** hashTable;\n    int numSlots;\npublic:\n    /* Initializes a hashmap given its set size */\n    HashMap(int size)\n    {\n        numSlots = size;\n        hashTable = new node*[size] ;\n        for (int i = 0; i &lt; size; i++)\n        {\n            hashTable[i] = NULL;\n        }\n    }\n\n    /*** Hash function. ***/\n\n    int hash(char *s)\n    {\n        int i;\n        int sum = 0;\n\n        for (i = 0; * (s + i) != '\\0'; i++)\n        {\n            sum += *(s + i);\n        }\n\n        return (sum % numSlots);\n    }\n\n    /* Create a single node. */\n    node *create_node(char *key, int value)\n    {\n        node *result = new node();\n        result-&gt;key = key;\n        result-&gt;value = value;\n        result-&gt;next = NULL;\n\n        return result;\n    }\n\n    /*\n     *Stores given key/value pair in hashmap\n     *returns boolean for success/failure\n     */\n\n    void set (char* key, int value)\n    {\n        int keyValue = hash(key);\n        node *current = hashTable[keyValue];\n        node *original = current;\n        node *newNode;\n        if (current == NULL)\n        {\n            hashTable[keyValue] = create_node(key, value);\n        }\n        else\n        {\n            while (current != NULL)\n            {\n                current = current -&gt; next;\n            }\n\n            if (current == NULL)\n            {\n                newNode = create_node(key, value);\n                newNode -&gt; next = original;\n                hashTable[keyValue] = newNode;\n            }\n        }\n    }\n\n    /* Prints hash table */\n\n    void print_hash_table()\n    {\n        int i;\n        node *listIterator = NULL;\n\n        for (i = 0 ; i &lt; numSlots ; i++)\n        {\n            listIterator = hashTable[i];\n\n            if (listIterator != NULL)\n            {\n                cout &lt;&lt; listIterator-&gt;key &lt;&lt; \" | \";\n                while (listIterator != NULL)\n                {\n                    cout &lt;&lt; listIterator-&gt;value &lt;&lt; \" \";\n                    listIterator = listIterator -&gt; next;\n                }\n                cout &lt;&lt; endl;\n            }\n\n\n        }\n\n    }\n};\n\n\nint main()\n{\n    HashMap hash (128);\n    char key[100];\n    int value;\n\n    cout &lt;&lt; \"Enter element to be inserted: \";\n    cin &gt;&gt; value;\n    cout &lt;&lt; \"Enter key at which element to be inserted: \";\n    cin &gt;&gt; key;\n    hash.set(key, value);\n    cout &lt;&lt; \"Enter element to be inserted: \";\n    cin &gt;&gt; value;\n    cout &lt;&lt; \"Enter key at which element to be inserted: \";\n    cin &gt;&gt; key;\n    hash.set(key, value);\n    hash.print_hash_table();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "python-2.7", "c++11", "gcc", "distutils"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4407569"}, "edited": false, "score": 0, "creation_date": 1474476849, "post_id": 39622184, "comment_id": 66550350, "body": "The source file ends in <code>.c</code> and <code>gcc</code> usually is the C compiler invokation, but <code>blitz.h</code> seems to be a C++-only header. What is it supposed to be? If C++, the invokation should be with <code>g++</code> and the ending <code>.cpp</code>. Whether <code>build_ext</code> supports C++, I don&#39;t know."}, {"owner": {"reputation": 575, "user_id": 3647036, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f3661a33cf28c7e8f6835d7e0feee311?s=128&d=identicon&r=PG&f=1", "display_name": "maurizio", "link": "https://stackoverflow.com/users/3647036/maurizio"}, "edited": false, "score": 0, "creation_date": 1474480072, "post_id": 39622184, "comment_id": 66552103, "body": "@Eichh&#246;rnchen Good point. I forgot about the fact that <code>PyDSTool</code> is generating <code>.C</code> files. Indeed replacing in the code the extension, seems to slightly move forward although it still does not compile."}], "answers": [{"tags": [], "owner": {"reputation": 575, "user_id": 3647036, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f3661a33cf28c7e8f6835d7e0feee311?s=128&d=identicon&r=PG&f=1", "display_name": "maurizio", "link": "https://stackoverflow.com/users/3647036/maurizio"}, "is_accepted": false, "score": 1, "last_activity_date": 1481591205, "last_edit_date": 1481591205, "creation_date": 1474513516, "answer_id": 39629597, "question_id": 39622184, "link": "https://stackoverflow.com/questions/39622184/gcc-with-std-c11-does-not-see-c-header-files-via-pydstool/39629597#39629597", "title": "GCC with -std=c++11 does not see C++ header files (via PyDSTool)", "body": "<p>Just for the sake of completeness. The issue I pointed out above does not have an easy workaround. <code>PyDSTool</code> <code>C</code>-based integrators (i.e. Radau and Dopri) cannot be compiled with source code for the equations in <code>C++</code> but only in <code>C</code>. So either you recast your code in plain <code>C</code> or try to edit <code>PyDSTool</code> integrators and recast them in <code>C++</code>. The first option is likely the only one currently possible (at least to some non-experts as who is writing).</p>\n"}], "owner": {"reputation": 575, "user_id": 3647036, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f3661a33cf28c7e8f6835d7e0feee311?s=128&d=identicon&r=PG&f=1", "display_name": "maurizio", "link": "https://stackoverflow.com/users/3647036/maurizio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481591205, "creation_date": 1474476276, "question_id": 39622184, "link": "https://stackoverflow.com/questions/39622184/gcc-with-std-c11-does-not-see-c-header-files-via-pydstool", "title": "GCC with -std=c++11 does not see C++ header files (via PyDSTool)", "body": "<p>I am on a complex project built in <code>python2.7</code> that uses the <a href=\"http://www.ni.gsu.edu/~rclewley/PyDSTool/ProjectOverview.html\" rel=\"nofollow\"><code>PyDSTool</code> package</a> for analysis of dynamical system. <code>PyDSTool</code> provides two C-based integrators - Radau and Dopri - which I want to use to integrate my system of equations whose source is coded in a bunch of <code>C/C++</code> files.</p>\n\n<p>I have little control on the package, and when I instantiate the integrator, I can only add headers <code>*.H</code> files, source files (<code>*.C</code>, <code>*.CPP</code>) and pass the directories to include in the search path of the compiler as well as libraries to link to.</p>\n\n<p>Since a consistent part of the code is based on <code>C++11</code> I am passing to the compiler also the argument <code>-std=C++11</code>.</p>\n\n<p>Eventually, <code>/PyDSTool/Generators/mixins.py</code> launch a <code>setup</code> command (line 185) which in turn runs the command <code>build_ext</code> from <code>distutils</code> to which all the above flags are appended. </p>\n\n<p>For the sake of clarity: the flags that I am appending are:</p>\n\n<pre><code>compile options: '-I/usr/lib64/python2.7/site-packages/numpy/core/include -I/home/maurizio/Dropbox/StabilityAnalysis_tmp -I/usr/local/pydstool/PyDSTool/integrator -I/usr/include/python2_7 -I/usr/include/numpy -I/home/maurizio/Dropbox/Ongoing_Projects/pycustommodules -I/home/maurizio/Dropbox/Ongoing_Projects/c_libraries -I/home/maurizio/Dropbox/Ongoing_Projects/c_libraries/models -I/home/maurizio/Dropbox/Ongoing_Projects/DePitta_PNAS/Software/Stability_Analysis/ -I/usr/lib64/python2.7/site-packages/numpy/core/include -I/usr/include/python2.7 -c'\nextra options: '-std=c++11 -w -Wno-return-type -Wall -lpython2.7 -lm -lgsl -lgslcblas -D__DOPRI__'\n</code></pre>\n\n<p>The resulting compilation command as issued by <code>PyDSTool</code> reads:</p>\n\n<pre><code>error: Command \"gcc -pthread -fno-strict-aliasing -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -DNDEBUG -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/usr/lib64/python2.7/site-packages/numpy/core/include -I/home/maurizio/Dropbox/StabilityAnalysis_tmp -I/usr/local/pydstool/PyDSTool/integrator -I/usr/include/python2_7 -I/usr/include/numpy -I/home/maurizio/Dropbox/Ongoing_Projects/pycustommodules -I/home/maurizio/Dropbox/Ongoing_Projects/c_libraries -I/home/maurizio/Dropbox/Ongoing_Projects/c_libraries/models -I/home/maurizio/Dropbox/Ongoing_Projects/DePitta_PNAS/Software/Stability_Analysis/ -I/usr/lib64/python2.7/site-packages/numpy/core/include -I/usr/include/python2.7 -c /home/maurizio/Dropbox/StabilityAnalysis_tmp/dop853_temp/ei_network_vf.c -o /home/maurizio/Dropbox/StabilityAnalysis_tmp/dop853_temp/home/maurizio/Dropbox/StabilityAnalysis_tmp/dop853_temp/ei_network_vf.o -std=c++11 -w -Wno-return-type -Wall -lpython2.7 -lm -lgsl -lgslcblas -D__DOPRI__\" failed with exit status 1\n</code></pre>\n\n<p>Once looking into the <code>build.log</code> file automatically generated by <code>PyDSTool</code>, it turns out that the exit status is due to the fact that the compiler does not see the <code>C++</code> libraries that are in several routines/libs used by my code, e.g.</p>\n\n<pre><code>/usr/include/blitz/blitz.h:45:18: fatal error: string: No such file or directory\n #include &lt;string&gt;\n                  ^\nCompilation Terminated\n</code></pre>\n\n<p>Now, it is not a problem of my code, because if I compile my code as a standalone in python or through <code>scipy.weave</code> with the same compile and extra options pasted above, it works. It is a problem of making <code>PyDSTool</code> build the code within the integrator. As I am NOT practical with <code>distutils</code> and all <code>gcc</code> options I hope there is some expert here that could provide me with some insight. I suspect in fact that I am missing some options or whatever to pass to the compiler.  </p>\n"}, {"tags": ["c++", "windows", "visual-studio", "io", "driver"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1474476346, "post_id": 39622126, "comment_id": 66550043, "body": "I somehow doubt that the code you show is the code you&#39;re running. Mainly because the code in your question will not build. Please create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> and show us."}, {"owner": {"reputation": 25994, "user_id": 786653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b710188acb0d8cd30d6cb44061cc15?s=128&d=identicon&r=PG", "display_name": "user786653", "link": "https://stackoverflow.com/users/786653/user786653"}, "edited": false, "score": 2, "creation_date": 1474477345, "post_id": 39622126, "comment_id": 66550648, "body": "The second to last argument <code>lpNumberOfBytesRead</code> isn&#39;t optional (must not be null). From <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365467\" rel=\"nofollow noreferrer\">msdn</a>: &quot;This parameter can be NULL only when the lpOverlapped parameter is not NULL.&quot;"}, {"owner": {"reputation": 101, "user_id": 6381964, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154204489437726/picture?type=large", "display_name": "Jake Samz", "link": "https://stackoverflow.com/users/6381964/jake-samz"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1474477797, "post_id": 39622126, "comment_id": 66550870, "body": "@JoachimPileborg  The only actual error was the fact that I capitalized the &#39;M&#39; in &quot;Main&quot;."}, {"owner": {"reputation": 101, "user_id": 6381964, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154204489437726/picture?type=large", "display_name": "Jake Samz", "link": "https://stackoverflow.com/users/6381964/jake-samz"}, "reply_to_user": {"reputation": 25994, "user_id": 786653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b710188acb0d8cd30d6cb44061cc15?s=128&d=identicon&r=PG", "display_name": "user786653", "link": "https://stackoverflow.com/users/786653/user786653"}, "edited": false, "score": 0, "creation_date": 1474478176, "post_id": 39622126, "comment_id": 66551055, "body": "@user786653 Same error still. Editing post."}, {"owner": {"reputation": 25994, "user_id": 786653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b710188acb0d8cd30d6cb44061cc15?s=128&d=identicon&r=PG", "display_name": "user786653", "link": "https://stackoverflow.com/users/786653/user786653"}, "edited": false, "score": 0, "creation_date": 1474478381, "post_id": 39622126, "comment_id": 66551183, "body": "<code>LPDWORD bytesRead = 0;</code> ... <code>bytesRead,</code> ... it&#39;s stil <code>NULL</code>. Try<code>DWORD bytesRead = 0;</code> .... <code>&amp;bytesRead</code> instead."}, {"owner": {"reputation": 101, "user_id": 6381964, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154204489437726/picture?type=large", "display_name": "Jake Samz", "link": "https://stackoverflow.com/users/6381964/jake-samz"}, "reply_to_user": {"reputation": 25994, "user_id": 786653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b710188acb0d8cd30d6cb44061cc15?s=128&d=identicon&r=PG", "display_name": "user786653", "link": "https://stackoverflow.com/users/786653/user786653"}, "edited": false, "score": 0, "creation_date": 1474478875, "post_id": 39622126, "comment_id": 66551415, "body": "@user786653 I thought of that too, but the variations of <code>bytesRead</code> all give me an error code of 1."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 2, "creation_date": 1474495352, "post_id": 39622126, "comment_id": 66560057, "body": "you got <code>STATUS_INVALID_DEVICE_REQUEST</code> i think (it converted to 1) - are driver implemented IRP_MJ_READ ? then you use FILE_FLAG_NO_BUFFERING - so you must read aligned o sector size - are 32 bytes - multiple your sector size ? and are you support cache ? if no - what sense in this flag ? and post not converted win32 errors but NTSTATUS values"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1474503897, "post_id": 39622126, "comment_id": 66562229, "body": "I agree with RbMm.  The problem is most likely in the driver, not the application.  (Assuming you&#39;ve fixed the problem with the bytesRead argument.)"}, {"owner": {"reputation": 101, "user_id": 6381964, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154204489437726/picture?type=large", "display_name": "Jake Samz", "link": "https://stackoverflow.com/users/6381964/jake-samz"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1474547107, "post_id": 39622126, "comment_id": 66581600, "body": "@RbMm Oh dang! I forgot about registering/implementing IRP_MJ_READ. I&#39;ll try it right away and let you know if that fixes things."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1474547251, "post_id": 39622126, "comment_id": 66581713, "body": "@JakeSamz - if you not register IRP_MJ_READ in driver object of course will be called default handler, which return STATUS_INVALID_DEVICE_REQUEST. and for what you use FILE_FLAG_NO_BUFFERING ? (just interesting)"}], "owner": {"reputation": 101, "user_id": 6381964, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154204489437726/picture?type=large", "display_name": "Jake Samz", "link": "https://stackoverflow.com/users/6381964/jake-samz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 825, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1474478273, "creation_date": 1474476104, "last_edit_date": 1474478273, "question_id": 39622126, "link": "https://stackoverflow.com/questions/39622126/why-would-calling-readfile-return-error-code-1", "title": "Why would calling ReadFile() return error code 1?", "body": "<p>Currently, I am attempting to access my driver and read data from it. According to the MSDN, one way to do this is by calling the <code>CreateFile</code>, passing in the file path of the PDO for the driver and using <code>ReadFile</code> and <code>WriteFile</code> functions to read from and write to the file respectively.</p>\n\n<p>My code is simple:</p>\n\n<pre><code>int main()\n{\n\n    CHAR readBuffer[32];\n\n    HANDLE handle = INVALID_HANDLE_VALUE;\n    LPDWORD bytesRead = 0;\n\n    // File path to my custom device. Valid path.\n    LPCWSTR filePath = L\"\\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\00000010\";\n\n    // Obtain handle to Device File for custom driver\n    handle = CreateFile(filePath, GENERIC_READ | GENERIC_WRITE,\n                    FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING,\n                    FILE_FLAG_NO_BUFFERING, NULL);\n\n    DWORD error = GetLastError();\n    if(handle != INVALID_HANDLE_VALUE)\n    {\n        cout &lt;&lt; \"File Exists! \\n\";\n    }\n    else\n        cout &lt;&lt; \"Cannot Open File with error: \" &lt;&lt; error &lt;&lt; \" \\n\";\n\n    // Call to CreateFile succeeds.\n    // Below here is where I have the issues----------------------------------\n\n    cout &lt;&lt; \"\\nAttempting to Read 32 bits from opened file... \\n\";\n\n    // Attempt to Read data from the device \n    BOOL success = ReadFile(handle, readBuffer, sizeof(readBuffer), bytesRead, NULL);\n    if (success)\n        cout &lt;&lt; \"Read File status is: \" &lt;&lt; success &lt;&lt; \" \\n\";\n    else\n    {\n        error = GetLastError();\n        cout &lt;&lt; \"Read File status is: \" &lt;&lt; success &lt;&lt; \" with error code: \" &lt;&lt; error &lt;&lt; \"\\n\";\n    }\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>As stated in the code, the <code>CreateFile</code> function succeeds at opening the PDO that is relative to the driver. For the last output line, I am getting:</p>\n\n<pre><code>Read File status is: 0 with error code: 1\n</code></pre>\n\n<p>This means that the <code>ReadFile</code> function is not completing properly. On the MSDN, the error code 1 is <code>ERROR_INVALID_FUNCTION</code> and, in this case, it is in regards to the call to <code>ReadFile</code>.</p>\n\n<p>I understand there are \"better\" ways of doing this, however the way I am attempting to access my driver should be the simplest way. In addition, I have tried to run it in \"Administrator Mode\" like people suggested in other similar posts, but to no avail.</p>\n\n<p>What in my call to the <code>ReadFile</code> function could cause this? Additionally, what causes this vague error (other than the function being invalid)?</p>\n\n<p>Thank you in advance for your time and help with this issue.</p>\n"}, {"tags": ["c++", "c++11", "sfinae"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 2, "creation_date": 1474476001, "post_id": 39622051, "comment_id": 66549850, "body": "You can always omit the definition (instead of <code>= delete;</code>)"}, {"owner": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1474476121, "post_id": 39622051, "comment_id": 66549917, "body": "Yes you can, but then you get a not so nice <code>undefined reference to</code> error from the compiler (in the case you ignore the interface)."}, {"owner": {"reputation": 5994, "user_id": 5698738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tnZ9.jpg?s=128&g=1", "display_name": "Aganju", "link": "https://stackoverflow.com/users/5698738/aganju"}, "edited": false, "score": 1, "creation_date": 1474476822, "post_id": 39622051, "comment_id": 66550336, "body": "I think in Stroustup&#39;s book (The C++ Programming Language 2013) he describes about that approach, with a similar example. It looks good to me, but I am hardly qualified to assess it."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1474477236, "post_id": 39622051, "comment_id": 66550579, "body": "Out of interest, why use inheritance at all, if <code>sound()</code> is not to be polymorphic?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1474477393, "post_id": 39622051, "comment_id": 66550671, "body": "Might you be looking for <code>virtual std::string sound() const = 0</code> ?  To make the function &quot;pure virtual&quot; and thus force derived classes to provide an implementation?"}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1474477455, "post_id": 39622051, "comment_id": 66550708, "body": "You might want to ask a more specific question than &quot;any opinions ?&quot;; see <a href=\"https://stackoverflow.com/help/dont-ask\">here</a>"}, {"owner": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 0, "creation_date": 1474495028, "post_id": 39622051, "comment_id": 66559945, "body": "As I have mentioned, I am not looking for a pure virtual method solution. I want to use inheritance to provide the client of the function an interface definition of the template type."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1474499086, "post_id": 39622051, "comment_id": 66561138, "body": "You could just omit <code>sound</code> entirely from the base class, since it is not used anywhere"}], "answers": [{"comments": [{"owner": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 0, "creation_date": 1474496163, "post_id": 39622566, "comment_id": 66560334, "body": "Thank you for this nice solution. Is there a way to describe the interface of the type TAnimal ?"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 1, "creation_date": 1474497218, "post_id": 39622566, "comment_id": 66560655, "body": "@erikzenker if you mean &quot;is there a name for this kind of traits-based SFNAE&quot;, I&#39;m not sure what the technical name would be. If you mean &quot;what is TAnimal&quot;? Then in this case I&#39;d say it was the &quot;concept of an animal&quot;, and the trait is indicating that the class represents a model of that concept. The traits and policies we create around the TAnimal describe its conceptual behaviour, abilities and properties."}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 1, "last_activity_date": 1474477594, "creation_date": 1474477594, "answer_id": 39622566, "question_id": 39622051, "link": "https://stackoverflow.com/questions/39622051/using-delete-for-interface-description/39622566#39622566", "title": "Using = delete for interface description", "body": "<p>Another way, avoiding the complication of inheritance, is to create a type trait:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate&lt;class T&gt;\nstruct is_animal : std::false_type {};\n\nclass Cat {\npublic:\n    std::string sound() const {\n        return std::string(\"Meow\");\n    }\n};\ntemplate&lt;&gt; struct is_animal&lt;Cat&gt; : std::true_type {};\n\nclass WildCat : public Cat {\npublic:\n    // Overwrites Cat sound method\n    std::string sound() const {\n        return std::string(\"Rarr\");\n    }\n\n};\ntemplate&lt;&gt; struct is_animal&lt;WildCat&gt; : std::true_type {};\n\nclass Dog {\npublic:\n    std::string sound() const {\n        return std::string(\"Wuff\");\n    }\n};\ntemplate&lt;&gt; struct is_animal&lt;Dog&gt; : std::true_type {};\n\n\nclass Car {\npublic:\n    std::string sound() const {\n        return std::string(\"Brum\");\n    }\n};\n\n\n\n// Sfinae tests for proper inheritance\ntemplate&lt;class TAnimal,\ntypename = std::enable_if_t&lt;is_animal&lt;TAnimal&gt;::value&gt; &gt;\nvoid listenTo(TAnimal const &amp; a ) {\n    std::cout &lt;&lt; a.sound() &lt;&lt; std::endl;\n}\n\n\nint main(){\n\n    // Objects of type IAnimal can not be instanciated\n    // IAnimal a;\n\n    // Cats and Dogs behave like IAnimals\n    Cat cat;\n    WildCat wildCat;\n    Dog dog;\n    Car car;\n\n    listenTo(cat);\n    listenTo(wildCat);\n    listenTo(dog);\n\n    // A car is no animal -&gt; compile time error\n    // listenTo(car);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 0, "creation_date": 1474496099, "post_id": 39625160, "comment_id": 66560311, "body": "Wow a really complex solution, but I kind of like it. It is a lot of boilerplate code. Thus, is there a way to shorten it maybe by a library or macros you know ?"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1474497448, "post_id": 39625160, "comment_id": 66560718, "body": "This tests for the member function sound(), but the car has this too, and you can&#39;t listenTo() a car (defined in the OP&#39;s question). You still need a trait or tag to indicate that it&#39;s listenTo()-able."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 1, "creation_date": 1474502866, "post_id": 39625160, "comment_id": 66561983, "body": "@erikzen half of it is a library, namely the <code>can_apply</code>.  It is a dozen lines.  C++20 may have an equivalent tenplate called <code>is_detected</code>.  To write <code>can_x</code> you need one <code>using X=decltype</code> template line.  It can be as complex as you like, or as simple.  That is you defining the &quot;contract&quot; of the concept, like your <code>=delete</code> base class does.  So 2 lines per feature in the concept, and a line or so to glue them into one named concept (<code>is_animal</code> for example).  You could use some macros to drop it to one line per feature, but I wouldn&#39;t."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 1, "last_activity_date": 1474486625, "creation_date": 1474486625, "answer_id": 39625160, "question_id": 39622051, "link": "https://stackoverflow.com/questions/39622051/using-delete-for-interface-description/39625160#39625160", "title": "Using = delete for interface description", "body": "<pre><code>namespace details {\n  template&lt;template&lt;class...&gt;class Z, class always_void, class...Ts&gt;\n  struct can_apply:std::false_type{};\n  template&lt;template&lt;class...&gt;class Z, class...Ts&gt;\n  struct can_apply&lt;Z, std::void_t&lt;Z&lt;Ts...&gt;&gt;, Ts...&gt;:std::true_type{};\n}\ntemplate&lt;template&lt;class...&gt;class Z, class...Ts&gt;\nusing can_apply=details::can_apply&lt;Z,void,Ts...&gt;;\n</code></pre>\n\n<p>This is a meta type trait that helps write other type traits.</p>\n\n<pre><code>template&lt;class T&gt;\nusing sound_result = decltype( std::declval&lt;T&gt;().sound() );\n</code></pre>\n\n<p><code>sound_result&lt;T&gt;</code> is the result of <code>t.sound()</code> where <code>t</code> is of type <code>T</code>.</p>\n\n<pre><code>template&lt;class T&gt;\nusing can_sound = can_apply&lt;sound_result, T&gt;;\n</code></pre>\n\n<p><code>can_sound&lt;T&gt;</code> is a true type if and only if <code>t.sound()</code> is valid to call.</p>\n\n<p>We can now say that animals are things that can sound.</p>\n\n<pre><code>template&lt;bool b&gt;\nusing bool_t = std::integral_constant&lt;bool, b&gt;;\n\ntemplate&lt;class T&gt;\nusing is_animal = bool_t&lt; can_sound&lt;T&gt;{} &gt;; // add more requirements\n\ntemplate&lt;class TAnimal,\n  std::enable_if_t&lt; is_animal&lt;TAnimal const&amp;&gt;{}, int&gt; =0\n&gt;\nvoid listenTo(TAnimal const &amp; a ) {\n  std::cout &lt;&lt; a.sound() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>We get an error saying there is no matching overload if we try to <code>listenTo(0)</code> or somesuch.</p>\n\n<p>Requiring that <code>.sound()</code> return something streamable can be written as well.</p>\n\n<pre><code>template&lt;class T&gt;\nusing stream_result = decltype( std::declval&lt;std::ostream&amp;&gt;() &lt;&lt; std::declval&lt;T&gt;() );\n\ntemplate&lt;class T&gt;\nusing can_stream = can_apply&lt; stream_result, T &gt;;\n\ntemplate&lt;class T&gt;\nusing stream_sound_result = stream_result&lt; sound_result&lt; T &gt; &gt;;\n\ntemplate&lt;class T&gt;\nusing can_stream_sound = can_apply&lt; stream_sound_result, T &gt;;\n</code></pre>\n\n<p>Now we can upgrade our animal test:</p>\n\n<pre><code>template&lt;class T&gt;\nusing is_animal = bool_t&lt; can_stream_sound&lt;T&gt;{} &gt;;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 0, "creation_date": 1474495831, "post_id": 39626670, "comment_id": 66560222, "body": "Thanks for your solution. I have the problem that I need to have a look at the definition of the listenTo function to figure out the requirements of the type TAnimal. Do you have an idea to improve it regarding the requirements ?"}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 0, "creation_date": 1474495966, "post_id": 39626670, "comment_id": 66560268, "body": "@erikzenker I suspect I didn&#39;t understand the question in the comment. What&#39;s exactly problem? You have to look at <code>listenTo</code> for... What? I don&#39;t get you, sorry."}, {"owner": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 0, "creation_date": 1474496578, "post_id": 39626670, "comment_id": 66560470, "body": "Well, I will try to explain it slightly different. The function <code>listenTo</code> requires the type <code>TAnimal</code> to provide the method <code>sound</code>. This requirement is &quot;hidden&quot; in the body of this function. Thus, when I want to provide a new type for <code>listenTo</code>, then I need to skim through its function body notice that I need to implement <code>sound</code> and then implement it. I would like to have some kind of central interface description I could look at (like it is done with pure virtual methods)."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 1, "creation_date": 1474522997, "post_id": 39626670, "comment_id": 66566955, "body": "@erikzenker Added more details to the answer (at the end of). To sum up, you can extend <code>check</code> and put there your requirements."}], "tags": [], "owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "is_accepted": false, "score": 1, "last_activity_date": 1474522955, "last_edit_date": 1474522955, "creation_date": 1474492300, "answer_id": 39626670, "question_id": 39622051, "link": "https://stackoverflow.com/questions/39622051/using-delete-for-interface-description/39626670#39626670", "title": "Using = delete for interface description", "body": "<p>You didn't ask for an alternative solution. Instead, you asked for an opinion about your solution.<br>\nWell, here is my opinion, hoping it can help you.</p>\n\n<hr>\n\n<p>That's a weak sfinae expression. You can easily break it using:</p>\n\n<pre><code>listenTo&lt;Car, void&gt;(car);\n</code></pre>\n\n<p>At least, I'd suggest you to rewrite your function as it follows:</p>\n\n<pre><code>template&lt;class TAnimal&gt;\nstd::enable_if_t&lt;std::is_base_of&lt;IAnimal, TAnimal&gt;::value&gt;\nlistenTo(TAnimal const &amp; a ) {\n    std::cout &lt;&lt; a.sound() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>That said, as it stands, you don't really need to use neither <code>std::enable_if_t</code> nor any other sfinae expression.<br>\nIn this case, a <code>static_assert</code> is more than enough:</p>\n\n<pre><code>template&lt;class TAnimal&gt;\nvoid listenTo(TAnimal const &amp; a ) {\n    static_assert(std::is_base_of&lt;IAnimal, TAnimal&gt;::value, \"!\");\n    std::cout &lt;&lt; a.sound() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>This way you can also remove the useless definition of <code>sound</code> from <code>IAnimal</code> and still you'll have a nice compilation error.</p>\n\n<hr>\n\n<p>Now, if you want to drop also the <code>IAnimal</code> interface, a possible solution (that hasn't been mentioned by other answer) follows:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate&lt;typename&gt; struct tag {};\ntemplate&lt;typename... T&gt; struct check;\n\ntemplate&lt;typename T, typename... U&gt;\nstruct check&lt;T, U...&gt;: check&lt;U...&gt; {\n    using check&lt;U...&gt;::verify;\n    static constexpr bool verify(tag&lt;T&gt;) { return true; }\n};\n\ntemplate&lt;&gt;\nstruct check&lt;&gt; {\n    template&lt;typename T&gt;\n    static constexpr bool verify(tag&lt;T&gt;) { return false; }\n};\n\nclass Cat {\npublic:\n    std::string sound() const { return std::string(\"Meow\"); }\n};\n\nclass WildCat {\npublic:\n     std::string sound() const { return std::string(\"Rarr\"); }\n};\n\nclass Dog {\npublic:\n    std::string sound() const { return std::string(\"Wuff\"); }\n};\n\nclass Car {\npublic:\n    std::string sound() const { return std::string(\"Brum\"); }\n};\n\nusing AnimalCheck = check&lt;Cat, WildCat, Dog&gt;;\n\ntemplate&lt;class TAnimal&gt;\nvoid listenTo(TAnimal const &amp; a ) {\n    static_assert(AnimalCheck::verify(tag&lt;TAnimal&gt;{}), \"!\");\n    std::cout &lt;&lt; a.sound() &lt;&lt; std::endl;\n}\n\nint main(){\n    Cat cat;\n    WildCat wildCat;\n    Dog dog;\n    Car car;\n\n    listenTo(cat);\n    listenTo(wildCat);\n    listenTo(dog);\n\n    // A car is no animal -&gt; compile time error\n    //listenTo(car);\n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>As requested in the comments, you can <em>centralize</em> the check of the existence of the method to be called in the <code>check</code> class.<br>\nAs an example:</p>\n\n<pre><code>template&lt;typename T, typename... U&gt;\nstruct check&lt;T, U...&gt;: check&lt;U...&gt; {\n    static constexpr auto test()\n    -&gt; decltype(std::declval&lt;T&gt;().sound(), bool{})\n    { return true; }\n\n    static_assert(test(), \"!\");\n\n    using check&lt;U...&gt;::verify;\n    static constexpr bool verify(tag&lt;T&gt;) { return true; }\n};\n</code></pre>\n\n<p>Or a more compact version:</p>\n\n<pre><code>template&lt;typename T, typename... U&gt;\nstruct check&lt;T, U...&gt;: check&lt;U...&gt; {\n    static_assert(decltype(std::declval&lt;T&gt;().sound(), std::true_type{}){}, \"!\");\n\n    using check&lt;U...&gt;::verify;\n    static constexpr bool verify(tag&lt;T&gt;) { return true; }\n};\n</code></pre>\n\n<p>This is somehow a way of checking for a concept by using only features from the current revision of the language.<br>\nNote that <em>concepts</em> would have helped to do the same somehow and somewhere in the code, but they are not part of the standard yet.</p>\n"}, {"comments": [{"owner": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 0, "creation_date": 1474494715, "post_id": 39626923, "comment_id": 66559809, "body": "You are right that it is some kind of strange. I know how pure virtual methods allow to force the implementation of these methods, but as I mentioned I don&#39;t want to use pure virtual methods (e.g. because of performance reasons)."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "reply_to_user": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 0, "creation_date": 1474495027, "post_id": 39626923, "comment_id": 66559944, "body": "@erikzenker <a href=\"http://stackoverflow.com/a/449832/257645\">stackoverflow.com/a/449832/257645</a> I&#39;ve worked on some pretty massive-scale systems and done a lot of perf work, I&#39;m still waiting for the time where I say &quot;Aha! It&#39;s this virtual function call!&quot;"}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "reply_to_user": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 0, "creation_date": 1474495090, "post_id": 39626923, "comment_id": 66559967, "body": "Well, unless you&#39;re using mid 90s hardware and a matching compiler."}, {"owner": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "edited": false, "score": 0, "creation_date": 1474495610, "post_id": 39626923, "comment_id": 66560149, "body": "The link you have provided says it clear: virtual methods have a performance impact, especially when they are called very often."}], "tags": [], "owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "is_accepted": false, "score": 0, "last_activity_date": 1474493633, "creation_date": 1474493633, "answer_id": 39626923, "question_id": 39622051, "link": "https://stackoverflow.com/questions/39622051/using-delete-for-interface-description/39626923#39626923", "title": "Using = delete for interface description", "body": "<p><code>delete</code>ing a function removes it, it doesn't introduce a dependency on it. It says \"this class <em>does not</em> have this function\". So as far as implementing/annotating an interface goes, it's a bizarre way to achieve the goal. It's a bit like building a full-cockpit F-32 simulator and telling a very confused first test pilot \"well we removed all the buttons so you'll know what actually exists in a real plane\".</p>\n\n<p>The way interfaces are implemented in C++ is with virtual functions, and you annotate a virtual function as being \"pure\" (to be implemented) by giving them a body of \"0\", like this:</p>\n\n<pre><code>struct IFace {\n    virtual void sound() = 0;\n};\n</code></pre>\n\n<p>This makes it impossible to create a concrete instance of <code>IFace</code> or any class that derives from it, until you reach a part of the hierarchy where <code>sound()</code> is implemented:</p>\n\n<pre><code>struct IAudible {\n    virtual void sound() const = 0;\n};\n\nstruct Explosion : public IAudible {\n    // note the 'override' keyword, optional but helpful\n    virtual void sound() const override { std::cout &lt;&lt; \"Boom\\n\"; }\n};\n\nstruct Word : public IAudible {\n};\n\nvoid announce(const IAudible&amp; audible) {\n    audible.sound();\n}\n\nint main() {\n    Explosion e;\n    announce(e);\n}\n</code></pre>\n\n<p>Demo here: <a href=\"http://ideone.com/mGnw6o\" rel=\"nofollow\">http://ideone.com/mGnw6o</a></p>\n\n<p>But if we try to instantiate \"Word\", we get a compiler error: <a href=\"http://ideone.com/jriyay\" rel=\"nofollow\">http://ideone.com/jriyay</a></p>\n\n<pre><code>prog.cpp: In function 'int main()':\nprog.cpp:21:14: error: cannot declare variable 'w' to be of abstract type 'Word'\n         Word w;\nprog.cpp:11:12: note:   because the following virtual functions are pure within 'Word':\n     struct Word : public IAudible {\n            ^\nprog.cpp:4:22: note:    virtual void IAudible::sound() const\n         virtual void sound() const = 0;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 2, "last_activity_date": 1506489511, "last_edit_date": 1506489511, "creation_date": 1474499541, "answer_id": 39627873, "question_id": 39622051, "link": "https://stackoverflow.com/questions/39622051/using-delete-for-interface-description/39627873#39627873", "title": "Using = delete for interface description", "body": "<p>C++ doesn't have yet <a href=\"https://en.wikipedia.org/wiki/Concepts_(C%2B%2B)\" rel=\"nofollow noreferrer\">Concepts</a> :-( but gcc-6 implements it:</p>\n\n<pre><code>template &lt;class T&gt;\nconcept bool Animal() { \n    return requires(const T&amp; a) {\n        {a.sound()} -&gt; std::string;\n    };\n}\n\nvoid listenTo(const Animal&amp; animal) {\n    std::cout &lt;&lt; animal.sound() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/033243d971d5de1c\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<p>But you can create traits relatively easily with <a href=\"https://stackoverflow.com/questions/45249985/how-to-require-an-exact-function-signature-in-the-detection-idiom/45250180#45250180\"><code>is-detected</code></a>:</p>\n\n<pre><code>typename &lt;typename T&gt;\nusing sound_type = decltype(std::declval&lt;const T&amp;&gt;().sound());\n\ntemplate &lt;typename T&gt;\nusing has_sound = is_detected&lt;sound_type, T&gt;;\n\ntemplate &lt;typename T&gt;\nusing is_animal = has_sound&lt;T&gt;;\n// or std::conditional_t&lt;has_sound&lt;T&gt;::value /*&amp;&amp; other_conditions*/,\n//                       std::true_type, std::false_type&gt;;\n</code></pre>\n\n<p>And then regular SFINAE:</p>\n\n<pre><code>template&lt;class T&gt;\nstd::enable_if_t&lt;is_animal&lt;T&gt;::value&gt;\nlistenTo(const T&amp; animal) {\n    std::cout &lt;&lt; animal.sound() &lt;&lt; std::endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 662, "user_id": 1791962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/363cb978474dbf488c19c3139f981996?s=128&d=identicon&r=PG", "display_name": "erikzenker", "link": "https://stackoverflow.com/users/1791962/erikzenker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "accepted_answer_id": 39627873, "answer_count": 5, "score": 3, "last_activity_date": 1506489511, "creation_date": 1474475822, "last_edit_date": 1474476464, "question_id": 39622051, "link": "https://stackoverflow.com/questions/39622051/using-delete-for-interface-description", "title": "Using = delete for interface description", "body": "<p>I am trying to provide an interface description for a free function <code>listenTo(SomeAnimal)</code> that should operate on types that fulfil particular type requirements (it should be an animal). The function arguments should not use the mechanism of interface inheritance with pure virtual methods. </p>\n\n<p>I hacked a solution where the free function checks the argument type via an sfinae statement for a base class. To guarantee that the argument implements the interface of the base class I deleted the base class methods using <code>= delete</code>. I did not find any similar solution on the internet, thus, I am not sure if it makes sense, but it works. </p>\n\n<p>Here it is, any opinions ? </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\nclass IAnimal {\npublic:\n    // Interface that needs to be implemented\n    std::string sound() const = delete;\nprotected:\n    IAnimal(){}\n};\n\n\nclass Cat : public IAnimal {\npublic:\n    // Implements deleted method\n    std::string sound() const {\n        return std::string(\"Meow\");\n    }\n\n};\n\nclass WildCat : public Cat {\npublic:\n    // Overwrites Cat sound method\n    std::string sound() const {\n        return std::string(\"Rarr\");\n    }\n\n};\n\nclass Dog : public IAnimal{\npublic:\n    // Implements deleted method\n    std::string sound() const {\n        return std::string(\"Wuff\");\n    }\n};\n\n\nclass Car {\npublic:\n    // Implements deleted method\n    std::string sound() const {\n        return std::string(\"Brum\");\n    }\n};\n\n\n\n// Sfinae tests for proper inheritance\ntemplate&lt;class TAnimal,\n         typename = std::enable_if_t&lt;std::is_base_of&lt;IAnimal, TAnimal&gt;::value&gt; &gt;\nvoid listenTo(TAnimal const &amp; a ) {\n    std::cout &lt;&lt; a.sound() &lt;&lt; std::endl;\n}\n\n\nint main(){\n\n    // Objects of type IAnimal can not be instanciated\n    // IAnimal a;\n\n    // Cats and Dogs behave like IAnimals\n    Cat cat;\n    WildCat wildCat;\n    Dog dog;\n    Car car;\n\n    listenTo(cat);\n    listenTo(wildCat);\n    listenTo(dog);\n\n    // A car is no animal -&gt; compile time error\n    // listenTo(car);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "exception-handling", "seh"], "comments": [{"owner": {"reputation": 25994, "user_id": 786653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b710188acb0d8cd30d6cb44061cc15?s=128&d=identicon&r=PG", "display_name": "user786653", "link": "https://stackoverflow.com/users/786653/user786653"}, "edited": false, "score": 0, "creation_date": 1474478693, "post_id": 39621959, "comment_id": 66551334, "body": "<code>&#47;EHa</code> is required for C++/CLI code, so at least some of your code will need to be compiled with this flag. I don&#39;t know whether it&#39;s even possible to mix files compiled with <code>&#47;EHs(c)</code> and <code>&#47;EHa</code>, but it sounds risky to me, so I&#39;d personally avoid it."}, {"owner": {"reputation": 1113, "user_id": 4183920, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/373d5add81b78be87653a7987bf06fde?s=128&d=identicon&r=PG&f=1", "display_name": "PerryC", "link": "https://stackoverflow.com/users/4183920/perryc"}, "reply_to_user": {"reputation": 25994, "user_id": 786653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b710188acb0d8cd30d6cb44061cc15?s=128&d=identicon&r=PG", "display_name": "user786653", "link": "https://stackoverflow.com/users/786653/user786653"}, "edited": false, "score": 0, "creation_date": 1474480548, "post_id": 39621959, "comment_id": 66552330, "body": "@user786653 I don&#39;t think it is. It&#39;s one flavor or the other. I&#39;m fairly sure if we chose <code>&#47;EHa</code>, everything has to be compiled with <code>&#47;EHa</code>."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1474482101, "post_id": 39621959, "comment_id": 66553120, "body": "You have to use /EHa iff you use the non-standard <code>__try&#47;__except</code> keywords in your code.  Or <code>catch(...)</code> which now catches everything.  Catching and handling a managed exception that way is possible.  But not terribly wise, there is absolutely nothing you can do to <i>actually</i> handle it.  You can&#39;t even generate a reasonable error message.  The state of the managed code is unpredictable, continuing to call it is risky.  YMMV."}], "owner": {"reputation": 1113, "user_id": 4183920, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/373d5add81b78be87653a7987bf06fde?s=128&d=identicon&r=PG&f=1", "display_name": "PerryC", "link": "https://stackoverflow.com/users/4183920/perryc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1513483553, "creation_date": 1474475500, "last_edit_date": 1513483553, "question_id": 39621959, "link": "https://stackoverflow.com/questions/39621959/for-mixed-unmanaged-and-managed-c-code-do-we-need-to-be-compiling-with-eha-ex", "title": "For mixed unmanaged and managed C++ code do we need to be compiling with /EHa exception handling? What is the default?", "body": "<p>We have a process with mixed <code>/clr</code> (managed) code and unmanaged code and we're trying to determine what exception handling model to use. I think we (might?) need to be using <code>/EHa</code>. Right now we're specifying <code>&lt;ExceptionHandling&gt;Async&lt;/ExceptionHandling&gt;</code> which is the same as compiling with <code>/EHa</code> in our C++ project files. This way we catch all exceptions, including structured exceptions, and treat all exceptions as fatal in a top level <code>catch(...)</code> block (because they might be access violations or other things that would put the program into an undefined state).</p>\n\n<p>I'm confused reading <a href=\"https://msdn.microsoft.com/en-us/library/1deeycx5.aspx\" rel=\"nofollow\">/EH (Exception Handling Model)</a>, specifically:</p>\n\n<blockquote>\n  <p>The /EHa compiler option is used to support asynchronous structured\n  exception handling (SEH) with the native C++ catch(...) clause. To\n  implement SEH without specifying /EHa, you may use the __try,\n  __except, and __finally syntax. Although Windows and Visual C++ support SEH, we strongly recommend that you use ISO-standard C++\n  exception handling (/EHs or /EHsc) because it makes code more portable\n  and flexible. Nevertheless, in existing code or for particular kinds\n  of programs\u2014for example, in code compiled to support the common\n  language runtime (/clr (Common Language Runtime Compilation))\u2014you\n  still <strong>might</strong> have to use SEH. For more information, see Structured\n  Exception Handling (C/C++).</p>\n</blockquote>\n\n<p>This says that we <strong>might</strong> have to use <code>/EHa</code>. Then I go up to the top of the page, trying to figure out what the default exception handling model is (and if it is equivalent to <code>/EHa</code>), and I'm unsure...it seems very similar but there are slightly different descriptions, the default exception handling model is described as:</p>\n\n<blockquote>\n  <p>If /EH is not specified, the compiler catches both asynchronous\n  structured exceptions and C++ exceptions, but does not destroy C++\n  objects that go out of scope because of an asynchronous exception.</p>\n</blockquote>\n\n<p><strong>Do we need to specify /EHa because we have mixed managed (<code>/clr</code>) and unmanged code that must communicate at a point during exception handling?</strong></p>\n\n<p><strong>Is the default exception handling model for C++ projects in VS2015 equivalent to <code>/EHa</code>?</strong></p>\n"}, {"tags": ["c++", "com", "excel-automation"], "answers": [{"comments": [{"owner": {"reputation": 3217, "user_id": 385646, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/50JbM.png?s=128&g=1", "display_name": "MikMik", "link": "https://stackoverflow.com/users/385646/mikmik"}, "edited": false, "score": 0, "creation_date": 1474524365, "post_id": 39623067, "comment_id": 66567534, "body": "Sometimes I feel like a complete newbie... How didn&#39;t I come up with that? I don&#39;t know if it will be the best solution, but it should have occurred to me..."}], "tags": [], "owner": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "is_accepted": false, "score": 2, "last_activity_date": 1474479301, "creation_date": 1474479301, "answer_id": 39623067, "question_id": 39621888, "link": "https://stackoverflow.com/questions/39621888/how-to-forward-declare-com-ptr-t-pointers/39623067#39623067", "title": "How to forward-declare _com_ptr_t pointers?", "body": "<p>If you really want to do it that way.  I would create a baseclass that does not have the m_app pointer.  Have all the functions be virtual. (Yes, this is basically creating an \"interface\". (Call it CExcelApp ...)</p>\n\n<p>Derive a class from the first.  In it you add the m_app variable and override all your virtual functions.  You don't expose this class to your users. (Call it CExcelAppImp ... or whatever)</p>\n\n<p>In your base class make a static function that instantiates an instance of CExcelApp, but in the implementation, it would instantiate CExcelAppImp.</p>\n\n<pre><code>class CExcelApp\n{\nprotected:\n   CExcelApp(); // make your constructors protected\n\npublic:\nstatic CExcelApp* CreateInstance();\n};\n\n// in your implementation\n\nCExcelApp CExcelApp::CreateInstance()\n{\n   return new CExcelAppImp();\n}\n</code></pre>\n\n<p>This is just one way...</p>\n"}], "owner": {"reputation": 3217, "user_id": 385646, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/50JbM.png?s=128&g=1", "display_name": "MikMik", "link": "https://stackoverflow.com/users/385646/mikmik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474479301, "creation_date": 1474475288, "question_id": 39621888, "link": "https://stackoverflow.com/questions/39621888/how-to-forward-declare-com-ptr-t-pointers", "title": "How to forward-declare _com_ptr_t pointers?", "body": "<p>I want to create a library to wrap Excel Automation and expose just some of its vast functionality.\nI'm using the #import mechanism to work with Excel's COM, so right now I have:</p>\n\n<pre><code>// EXCELAPP.H\n#import \"C:\\\\PathTo\\\\mso.dll\" //...\n#import \"C:\\\\PathTo\\\\VBE6EXT.OLB\" //...\n#import \"C:\\\\PathTo\\\\EXCEL.EXE\" //...\n\nclass ExcelApp\n{\npublic:\n    ExcelApp();\n    ~ExcelApp();\n\n    void CloseExcel();\n\n    void ShowWindow();\n    void HideWindow();\n    // ...\n\nprivate:\n    Excel::_ApplicationPtr m_app;\n};\n</code></pre>\n\n<p>This is in a static library project, and I'm using it just fine from my program.</p>\n\n<p>The thing is, I would like to \"hide\" from the users of the library how it is implemented. The implementation could change in the future. Also, having the imports in the .h file exposes all the COM interface to the users of the library and I don't want them (my future-self included) to abuse it.</p>\n\n<p>So I thought of doing something like the PImpl idiom, but I would need to at least forward-declare m_app, and I have no idea how to do that.</p>\n\n<p>So, is there any way to forward declare _com_ptr_t pointers like Excel::_ApplicationPtr? Or is there a better way to do what I'm trying to do?</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "edited": false, "score": 0, "creation_date": 1474476049, "post_id": 39621807, "comment_id": 66549873, "body": "Create symbolic link using the network ip address ,without requiring to map drive letter"}, {"owner": {"reputation": 7482, "user_id": 313175, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/17983e85ea926e9e985c00d1a771f24a?s=128&d=identicon&r=PG", "display_name": "Alexander V", "link": "https://stackoverflow.com/users/313175/alexander-v"}, "edited": false, "score": 0, "creation_date": 1474584769, "post_id": 39621807, "comment_id": 66603534, "body": "Why does the program fail while accessing the directory/files via UNC? Is there and error, specific reason? For instance if that is about very long path, than we can deal with it."}], "owner": {"reputation": 67, "user_id": 4996460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0779076381616ffeaf467816eab69236?s=128&d=identicon&r=PG&f=1", "display_name": "coop_d", "link": "https://stackoverflow.com/users/4996460/coop-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474475347, "creation_date": 1474475034, "last_edit_date": 1474475347, "question_id": 39621807, "link": "https://stackoverflow.com/questions/39621807/how-do-i-programmatically-manipulate-files-on-a-shared-drive-without-mapping", "title": "How do I programmatically manipulate files on a shared drive without mapping?", "body": "<p>I want to be able to delete and move files and folders located on a shared drive. The path would be something like \\\\some-pc\\folder\\</p>\n\n<p>Due to the number of shared drives, mapping is not really an option.</p>\n\n<p>Currently my program uses rename to move shared folders and their contents to a local folder, but when given a unc path, this fails. I can read the file. I'm testing using a shared folder from my own PC, so I should have the proper permissions.</p>\n\n<p>I've been using Qt libraries, and TR2 filesystem.</p>\n"}, {"tags": ["c++", "visual-studio", "visual-studio-2015", "nuget", "nuget-package"], "answers": [{"tags": [], "owner": {"reputation": 3390, "user_id": 6593307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97a33fcc6f030a3e168eb5ef1b756a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Weiwei", "link": "https://stackoverflow.com/users/6593307/weiwei"}, "is_accepted": true, "score": 3, "last_activity_date": 1474525983, "creation_date": 1474525983, "answer_id": 39631831, "question_id": 39621797, "link": "https://stackoverflow.com/questions/39621797/where-are-nuget-package-manager-include-directories-set-in-vs-2015/39631831#39631831", "title": "Where are nuget package manager include directories set in VS 2015?", "body": "<p>From NuGet 2.5, C++ project recognizes the installed packages through MSBuild properties and targets files from NuGet package. After installing packages in C++ project, the MSBuild files are imported into your project file. So the projects will know how to find and use the contents of the NuGet Packages.</p>\n\n<p>To make MSBuild integration better, NuGet has created a new convention for automatically importing MSBuild properties and targets from a NuGet package. Alongside the existing \\content, \\lib, and \\tools folders, NuGet now recognizes a new top-level folder: \\build. You could open the Eigen package that you have installed through <a href=\"https://npe.codeplex.com/releases/view/624769\" rel=\"nofollow noreferrer\">NuGet Package Explorer</a>, there has a \\build folder and a Eigen.targets file which contains MSBuild properties.</p>\n\n<p>Please refer to the MSBuild Integration part from below link:</p>\n\n<p><a href=\"http://blog.nuget.org/20130426/native-support.html\" rel=\"nofollow noreferrer\">http://blog.nuget.org/20130426/native-support.html</a> \n<a href=\"https://i.stack.imgur.com/biSN1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/biSN1.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 696, "user_id": 3967585, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a870c8c88c4aa792cbdfdccb00a79d85?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/3967585/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3301, "favorite_count": 0, "accepted_answer_id": 39631831, "answer_count": 1, "score": 2, "last_activity_date": 1474525983, "creation_date": 1474475005, "question_id": 39621797, "link": "https://stackoverflow.com/questions/39621797/where-are-nuget-package-manager-include-directories-set-in-vs-2015", "title": "Where are nuget package manager include directories set in VS 2015?", "body": "<p>i am currently trying my first steps with nuget package manager (3.4.3.855) in VS 2015 (Enterprise). For my C++/Qt project i managed to find some libraries i need and they seem to be correctly downloaded to <code>&lt;myprojectDir&gt;/packages/&lt;package_name&gt;/...</code> folders.</p>\n\n<p>However, it is a mystery to me, where and how include folders for headers and/or libs are specified for the project? </p>\n\n<p>I mean, for example with the Eigen library, after importing the nuget package i can just <code>#include &lt;Eigen/core&gt;</code>, which is located in </p>\n\n<p><code>&lt;myprojectDir&gt;\\packages\\Eigen.3.2.9\\build\\native\\include</code></p>\n\n<p>and everything works fine, but i neither have the <code>packages\\Eigen.3.2.9\\build\\native\\include</code>-path popping up in the <code>VC++ Directories-&gt;Include Directories</code> list in the property pages nor is there a custom property page in the project properties (yes, i did not click the solution properties ;) ) as seen e.g. in <a href=\"https://www.youtube.com/watch?v=FIY4FZDIt8Q\" rel=\"nofollow\">this</a> example video with the zlib package. I do not even have this property page if I install the zlib package.</p>\n\n<p>While it seems to work somehow under the hood for Eigen, it does not for the Visual Leak Detector (vld) package... so knowing how things work would be great ;)</p>\n\n<p>Thanks for any help...</p>\n"}, {"tags": ["c++", "c++11", "gcc", "language-lawyer"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 7, "creation_date": 1474474077, "post_id": 39621477, "comment_id": 66548740, "body": "I&#39;m leaning towards a GCC bug : <code>this</code> shouldn&#39;t <i>ever</i> be null."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1474474178, "post_id": 39621477, "comment_id": 66548796, "body": "I&#39;m wondering what VS2015 does :) Can someone check please?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 3, "creation_date": 1474474343, "post_id": 39621477, "comment_id": 66548890, "body": "@Rakete1111 Works on MSVS 2015 update 3."}, {"owner": {"reputation": 12134, "user_id": 100724, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/28c55fab931fa7153f0625a09b441674?s=128&d=identicon&r=PG", "display_name": "Viktor Sehr", "link": "https://stackoverflow.com/users/100724/viktor-sehr"}, "edited": false, "score": 2, "creation_date": 1474474997, "post_id": 39621477, "comment_id": 66549281, "body": "Seems weird to me that you can even capture this like that."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 12134, "user_id": 100724, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/28c55fab931fa7153f0625a09b441674?s=128&d=identicon&r=PG", "display_name": "Viktor Sehr", "link": "https://stackoverflow.com/users/100724/viktor-sehr"}, "edited": false, "score": 1, "creation_date": 1474475269, "post_id": 39621477, "comment_id": 66549440, "body": "@ViktorSehr Why is that? <code>std::function&lt;void(T)&gt; f = [this](T v) { x = v; };</code> is just syntactic sugar for <code>f([this](T v) { x = v; })</code>"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1474478215, "post_id": 39621477, "comment_id": 66551079, "body": "I didn&#39;t even thought that code was possible"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1474480838, "post_id": 39621477, "comment_id": 66552471, "body": "Notes that are not directly about the bug you spotted: that one danger is that <code>f</code> captures <code>this</code> by pointer.  It is then copied whenever <code>A</code> is copied.  So <code>A&lt;int&gt; a = A&lt;int&gt;{};</code> can (in C++14 or 11) have an <code>a.f()</code> that follows a dangling pointer.  (And in general this can happen in other cases).  Second, note that ODR violations are really easy here (but I think the standard is working to patch them), what is the type of the object stored within <code>f</code>?  The same or different in two source files that include the above header?"}, {"owner": {"reputation": 1026, "user_id": 3951057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3f346fcd1bd1c8a929481f4975994?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233; Sassi", "link": "https://stackoverflow.com/users/3951057/andr%c3%a9-sassi"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1474487126, "post_id": 39621477, "comment_id": 66555837, "body": "@Yakk, about the ODR, the type should be the same in all translation units (<code>std::function&lt;void(T)&gt;</code>), the difference is only in the returning type of the initializer expression, not in the data member type. I believe the compiler has the freedom to generate a slightly different version of the implicit constructor in each TU, but all of them are equivalent and interchangeable (the internal type might be different in instances created from different TUs, but that is just an implementation detail). So I think there is no violation of the ODR here."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1474488273, "post_id": 39621477, "comment_id": 66556463, "body": "@Andr&#233;Sassi Not <code>std::function</code>&#39;s type, but the type of the thing <i>stored within std::function</i>, which is exposed through <code>std::function</code>&#39;s interface.  The problem is that the code run in your constructor that constructs the <code>std::function</code> in its initializer list <i>differs between translation units</i>, which is an ODR violation."}, {"owner": {"reputation": 1026, "user_id": 3951057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3f346fcd1bd1c8a929481f4975994?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233; Sassi", "link": "https://stackoverflow.com/users/3951057/andr%c3%a9-sassi"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1474490676, "post_id": 39621477, "comment_id": 66557796, "body": "@Yakk, I was considering the type of the thing within to be an implementation detail, because I wasn&#39;t aware of <code>std::function::target_type()</code>, which exposes it. So yes, different TUs might (if the implementation defines each lambda type independently of enclosing class type) construct objects <code>a</code> and <code>b</code> such that <code>a.f.target_type() != b.f.target_type()</code>."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1474502968, "post_id": 39621477, "comment_id": 66562006, "body": "@andre the problem is the ODR doesn&#39;t say &quot;oh well, you get different versions&quot; but &quot;program ill formed no diagnostic required&quot;."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1474572319, "post_id": 39621477, "comment_id": 66597931, "body": "This is probably a compiler bug. Please file a ticket treating it as such. I can&#39;t see anything wrong here (indicating Clang &amp; VS are correct), or anything that should differ between brace-or-equal initialisation &amp; the in-constructor form (indicating GCC is buggily inconsistent). The draft Standard I have here, N4594, just says &quot;A brace-or-equal-initializer for a non-static data member specifies a default member initializer for the member&quot;. Member initialisers can get the value of <code>this</code>. It doesn&#39;t say brace-or-equal initialisers are unable to use <code>this</code> or any other difference. Why would it?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1474628154, "post_id": 39621477, "comment_id": 66619836, "body": "Further reason to <a href=\"https://gcc.gnu.org/bugzilla/enter_bug.cgi?product=gcc\" rel=\"nofollow noreferrer\">go to the GCC Bugzilla and report this as a bug</a>: on another GCC version, the code explicitly causes an internal compiler error and... asks the user to file a bug. See this comment: <a href=\"http://stackoverflow.com/questions/39621477/segmentation-fault-for-lambda-function-in-non-static-data-member-initializer/39633433?noredirect=1#comment66615448_39633433\" title=\"segmentation fault for lambda function in non static data member initializer\">stackoverflow.com/questions/39621477/&hellip;</a>"}, {"owner": {"reputation": 1026, "user_id": 3951057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3f346fcd1bd1c8a929481f4975994?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233; Sassi", "link": "https://stackoverflow.com/users/3951057/andr%c3%a9-sassi"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1474631003, "post_id": 39621477, "comment_id": 66621537, "body": "@underscore_d, thanks. I think you are right, the inconsistency between the two initializer forms suggests its really a bug. I&#39;m already in the proccess to file the bug report (account creation there seems to be manual due to spam), then I&#39;ll post the link to the report here."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1474632765, "post_id": 39621477, "comment_id": 66622648, "body": "@Andr&#233;Sassi Cool, thanks!"}, {"owner": {"reputation": 1015, "user_id": 694123, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/64c8d04db904e1a06ad2173e3bfd323c?s=128&d=identicon&r=PG", "display_name": "Dmitry Volosnykh", "link": "https://stackoverflow.com/users/694123/dmitry-volosnykh"}, "edited": false, "score": 0, "creation_date": 1528918946, "post_id": 39621477, "comment_id": 88693595, "body": "@Andr&#233;Sassi Have you succeeded in filing a bug report? No link here so far."}], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1474571491, "post_id": 39633433, "comment_id": 66597457, "body": "whether something does or does not work on VS usually doesn&#39;t indicate much useful about that thing&#39;s legality... :P and cpp.sh uses GCC 4.9.2, but since you changed the code, i&#39;m not sure that means much either."}, {"owner": {"reputation": 1449, "user_id": 1850903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d27cf790dfacdfb2e6baea68806df0f4?s=128&d=identicon&r=PG", "display_name": "O_Z", "link": "https://stackoverflow.com/users/1850903/o-z"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1474620870, "post_id": 39633433, "comment_id": 66615448, "body": "running original code on  cpp.sh gives:7:35: internal compiler error: in tsubst_copy, at cp/pt.c:12569 Please submit a full bug report, So I guess it&#39;s a bug"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1474628186, "post_id": 39633433, "comment_id": 66619860, "body": "Thanks for that. Hopefully the OP will <a href=\"https://gcc.gnu.org/bugzilla/enter_bug.cgi?product=gcc\" rel=\"nofollow noreferrer\">go to the GCC Bugzilla and report it as such</a>."}], "tags": [], "owner": {"reputation": 1449, "user_id": 1850903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d27cf790dfacdfb2e6baea68806df0f4?s=128&d=identicon&r=PG", "display_name": "O_Z", "link": "https://stackoverflow.com/users/1850903/o-z"}, "is_accepted": false, "score": 0, "last_activity_date": 1474621002, "last_edit_date": 1474621002, "creation_date": 1474531180, "answer_id": 39633433, "question_id": 39621477, "link": "https://stackoverflow.com/questions/39621477/segmentation-fault-for-lambda-function-in-non-static-data-member-initializer/39633433#39633433", "title": "Segmentation fault for lambda function in non-static data member initializer", "body": "<p>Your code compiles and runs on VS2015 (windows).\nSo this is probably a compiler error.</p>\n\n<p>Also, if you will remove the template it works on <a href=\"http://cpp.sh/\" rel=\"nofollow\">http://cpp.sh/</a>\nTry this code:</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\nstruct A {\n      int x = 0;\n      std::function&lt;void(int)&gt; f = [this](int v) { x = v; };\n};\n\nint main() {\n      A  a;\n      a.f(1);\n      std::cout &lt;&lt; a.x &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>running original code on  cpp.sh gives:</p>\n\n<pre><code> internal compiler error: in tsubst_copy, at cp/pt.c:12569\nPlease submit a full bug report\n</code></pre>\n\n<p>So I guess it's a bug</p>\n"}, {"tags": [], "owner": {"reputation": 469, "user_id": 7684908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L59lm.jpg?s=128&g=1", "display_name": "jraynal", "link": "https://stackoverflow.com/users/7684908/jraynal"}, "is_accepted": false, "score": 1, "last_activity_date": 1489072467, "creation_date": 1489072467, "answer_id": 42698920, "question_id": 39621477, "link": "https://stackoverflow.com/questions/39621477/segmentation-fault-for-lambda-function-in-non-static-data-member-initializer/42698920#42698920", "title": "Segmentation fault for lambda function in non-static data member initializer", "body": "<p>You cannot do:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct A {\n    T x = 0;\n    std::function&lt;void(T)&gt; f = [this](T v) { x = v; };\n};\n</code></pre>\n\n<p>As <code>this</code> does not exist when you define <code>f</code>. You need to initilize <code>f</code> in a constructor, such as:</p>\n\n<pre><code>A(){ f = [this](T v){ x=v; } }\n</code></pre>\n\n<p>It worked with G++4.8.</p>\n"}], "owner": {"reputation": 1026, "user_id": 3951057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3f346fcd1bd1c8a929481f4975994?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233; Sassi", "link": "https://stackoverflow.com/users/3951057/andr%c3%a9-sassi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 4, "answer_count": 2, "score": 20, "last_activity_date": 1489072467, "creation_date": 1474473876, "question_id": 39621477, "link": "https://stackoverflow.com/questions/39621477/segmentation-fault-for-lambda-function-in-non-static-data-member-initializer", "title": "Segmentation fault for lambda function in non-static data member initializer", "body": "<p>I am unsure about a possible GCC bug in initialization of a <code>std::function</code> from a lambda function capturing <code>this</code> in a non-static data member initializer. Is this allowed by the C++ standard or is this UB?</p>\n\n<p>Given the following code:</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate &lt;typename T&gt;\nstruct A {\n      T x = 0;\n      std::function&lt;void(T)&gt; f = [this](T v) { x = v; };\n};\n\nint main() {\n      A&lt;int&gt; a;\n      a.f(1);\n      std::cout &lt;&lt; a.x &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>In my understanding, it should print <code>1</code>. However, when built with GCC 5.4.0 or GCC 6.2.0, <code>a.f(1)</code> emits a segmentation fault, because the captured <code>this</code> pointer is null.</p>\n\n<p>The following alternatives work as I expected:</p>\n\n<ul>\n<li><p>Using constructor initializer list:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct B {\n    B() : f([this](T v) { x = v; }) {}\n    T x = 0;\n    std::function&lt;void(T)&gt; f;\n};\n</code></pre></li>\n<li><p>Without template:</p>\n\n<pre><code>struct C {\n    int x = 0;\n    std::function&lt;void(int)&gt; f = [this](int v) { x = v; };\n};\n</code></pre></li>\n</ul>\n\n<p>Also, when built with Clang 3.8.0, all three versions behave as I expect, which doesn't mean it is not UB.</p>\n"}, {"tags": ["c++", "mfc", "main", "exit"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1474474799, "post_id": 39621425, "comment_id": 66549159, "body": "Why do you need to wait for a response from an <b>advisory</b> message anyway? It&#39;s a fire and forget kind of thing. It&#39;s not like you would check if destructors run in C++ either. Sometimes there&#39;s just no conceivable way to handle failure, and this is one of them."}, {"owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "edited": false, "score": 0, "creation_date": 1474476257, "post_id": 39621425, "comment_id": 66549994, "body": "boost::asio will be a good starting point for this"}, {"owner": {"reputation": 410, "user_id": 2608530, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/4ctKm.png?s=128&g=1", "display_name": "rtischer8277", "link": "https://stackoverflow.com/users/2608530/rtischer8277"}, "reply_to_user": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "edited": false, "score": 0, "creation_date": 1474482367, "post_id": 39621425, "comment_id": 66553242, "body": "@seccpur boost::asio seems to be an alternative to the CAsyncSocket IO approach I have taken. No need to switch systems since the current tcp io is already fully implemented and tested in my app."}, {"owner": {"reputation": 410, "user_id": 2608530, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/4ctKm.png?s=128&g=1", "display_name": "rtischer8277", "link": "https://stackoverflow.com/users/2608530/rtischer8277"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474482411, "post_id": 39621425, "comment_id": 66553264, "body": "@IInspectable sending a reply to the sender is part of the design of my system so it doesn&#39;t matter whether the value of the message is advisory or, say, the transmission of encrypted data."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474482920, "post_id": 39621425, "comment_id": 66553560, "body": "Sounds like a broken design then. It&#39;s almost like saying that you are using <code>std::list</code> everywhere, because you get O(1) insertion everywhere (even when you don&#39;t need it). And you now need a way to pass that <code>std::list</code> to an API that expects a contiguous array."}, {"owner": {"reputation": 410, "user_id": 2608530, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/4ctKm.png?s=128&g=1", "display_name": "rtischer8277", "link": "https://stackoverflow.com/users/2608530/rtischer8277"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1474486151, "post_id": 39621425, "comment_id": 66555304, "body": "@IInspectable your job w/r/t this question is not to shoot at my io design. That is irrelevant. Please try to find something substantive to say about the question as posed."}, {"owner": {"reputation": 2689, "user_id": 1687639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a6dd18900e2bfd6dffec21ee358f31?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Oicles", "link": "https://stackoverflow.com/users/1687639/christopher-oicles"}, "edited": false, "score": 0, "creation_date": 1474502102, "post_id": 39621425, "comment_id": 66561808, "body": "This is tagged &quot;mfc&quot;, but I&#39;m having a hard time grasping your App&#39;s structure in this context from your description.  For a normal Dialog App, MFC doesn&#39;t expose a <code>main</code> function, rather you override <code>CWinappEx::InitInstance</code> and there is a call to your dialog class&#39; <code>DoModal</code> function.  Maybe you have a console app which somehow uses MFC to pop up a dialog?  I don&#39;t know.  There should be a place after the window closes, but before termination where you could block to wait for a response, but without a clear description we can only provide vague guesses at a solution."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 2689, "user_id": 1687639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a6dd18900e2bfd6dffec21ee358f31?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Oicles", "link": "https://stackoverflow.com/users/1687639/christopher-oicles"}, "edited": false, "score": 0, "creation_date": 1474535952, "post_id": 39621425, "comment_id": 66574258, "body": "@ChristopherOicles: Any MFC application will abstract the message loop implementation away. You won&#39;t have a say in this. Implementing this requirement using a custom message loop based on <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684242.aspx\" rel=\"nofollow noreferrer\">MsgWaitForMultipleObjects</a> would be a walk in the park. With MFC you&#39;ll have to implement a kludge, one way or another. Anyway, it&#39;s probably not my job to explain these useless details, according to the OP."}, {"owner": {"reputation": 410, "user_id": 2608530, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/4ctKm.png?s=128&g=1", "display_name": "rtischer8277", "link": "https://stackoverflow.com/users/2608530/rtischer8277"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474549908, "post_id": 39621425, "comment_id": 66583694, "body": "@IInspectable You misrepresent MFC. MFC does a service in abstracting the message loop away which is convenient in most cases. Since MFC is written in native C++ which lately has been upgraded with C++11, C++14 and even some of C++17, you have access to any and all global and system functions, C and even Assembler if needed which of course includes <code>MsgWaitForMultipleObjects</code>."}, {"owner": {"reputation": 410, "user_id": 2608530, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/4ctKm.png?s=128&g=1", "display_name": "rtischer8277", "link": "https://stackoverflow.com/users/2608530/rtischer8277"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474551508, "post_id": 39621425, "comment_id": 66584804, "body": "@IInspectable I can see your point that if you had direct control of the message loop, you could easily wait for all multiple objects, one event being <code>OnCancel</code> and the other <code>TxSocket::OnReceive</code>. Is that your point? Wouldn\u2019t the loop block until both events had fired?"}, {"owner": {"reputation": 410, "user_id": 2608530, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/4ctKm.png?s=128&g=1", "display_name": "rtischer8277", "link": "https://stackoverflow.com/users/2608530/rtischer8277"}, "reply_to_user": {"reputation": 2689, "user_id": 1687639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a6dd18900e2bfd6dffec21ee358f31?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Oicles", "link": "https://stackoverflow.com/users/1687639/christopher-oicles"}, "edited": false, "score": 0, "creation_date": 1474551884, "post_id": 39621425, "comment_id": 66585042, "body": "@ChristopherOicles My real app is written in MFC, but my problem description only abstracts the problem in terms of the Main function. I should have included either MFC <code>OK</code> or <code>Cancel</code> handler code. I have added an <b>Edit 1</b> note to clarify."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474552566, "post_id": 39621425, "comment_id": 66585558, "body": "<i>&quot;Wouldn\u2019t the loop block until both events had fired?&quot;</i> - As <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684242.aspx\" rel=\"nofollow noreferrer\">documented</a>, you have full control over that: <i>&quot;bWaitAll: If this parameter is TRUE, the function returns when the states of all objects in the pHandles array have been set to signaled and an input event has been received. If this parameter is FALSE, the function returns when the state of any one of the objects is set to signaled or an input event has been received.&quot;</i>"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474552750, "post_id": 39621425, "comment_id": 66585693, "body": "<i>&quot;You misrepresent MFC. [blah blah] you have access to any and all global and system functions, C and even Assembler if needed which of course includes MsgWaitForMultipleObjects.&quot;</i> - That&#39;s not going to help you undo the structure, that&#39;s set in stone (compiled to object code). You <b>can</b> call <code>MsgWaitForMultipleObjects</code> (or any other Windows API). You <b>cannot</b> call it in the right place, though. If you find that this is misrepresenting the <b>fixed</b> structure of an MFC application, feel free to solve your pressing issue, so that you get to keep your broken IO design."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474552877, "post_id": 39621425, "comment_id": 66585800, "body": "As an aside: MFC is pre-98 (i.e. pre-standard) C++, really. Nothing has changed in that department. You still have to manually delete MFC exceptions that you happen to catch."}, {"owner": {"reputation": 2689, "user_id": 1687639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a6dd18900e2bfd6dffec21ee358f31?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Oicles", "link": "https://stackoverflow.com/users/1687639/christopher-oicles"}, "edited": false, "score": 0, "creation_date": 1474566334, "post_id": 39621425, "comment_id": 66594659, "body": "Ok, don&#39;t call the default <code>OnCancel</code> from your <code>OnCancel</code> handler (this is actually what is ending your app), then when your <code>CAsyncSocket</code> handler verifies a response from Her, it can initiate the dialog&#39;s destruction.  The simplest way would be to call your dialog&#39;s <code>EndDialog(IDCANCEL)</code>. But a cleaner way would be to add a custom message to your dialog which cleans up anything and calls <code>EndDialog</code> or CDIalog::OnCancel.  Also, you should probably use a timer to implement a timeout in case the response from Her is not received."}, {"owner": {"reputation": 410, "user_id": 2608530, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/4ctKm.png?s=128&g=1", "display_name": "rtischer8277", "link": "https://stackoverflow.com/users/2608530/rtischer8277"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474637044, "post_id": 39621425, "comment_id": 66625525, "body": "@IInspectable MFC is a rather concise and fast C++ interface to the Windows OS (see \u201cProgramming Windows with MFC\u201d by Jeff Prosise). Available ISO C++ standard programming idioms has been constantly updated since 1998. In fact, as the C++ standard matures, the percentage of my app\u2019s code that is Windows-specific C++ MFC is less and less. There is no danger of the programming power of C++ MFC becoming obsolete except one: if Microsoft were to abandon Windows, at which point I and millions of other C++ MFC app owners, would move to another OS or microkernel taking our standard code with us."}, {"owner": {"reputation": 410, "user_id": 2608530, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/4ctKm.png?s=128&g=1", "display_name": "rtischer8277", "link": "https://stackoverflow.com/users/2608530/rtischer8277"}, "reply_to_user": {"reputation": 2689, "user_id": 1687639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a6dd18900e2bfd6dffec21ee358f31?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Oicles", "link": "https://stackoverflow.com/users/1687639/christopher-oicles"}, "edited": false, "score": 0, "creation_date": 1474638435, "post_id": 39621425, "comment_id": 66626554, "body": "@Christopher Oicles <i>when your CAsyncSocket handler verifies a response from Her, it can initiate the dialog&#39;s destruction</i> Please elevate your response to answer. Not sure I need to handle the OnCancel as a user-defined message though. Rather just remove the terminating <code>CDialog::OnCancel</code>. Key however is your observation that real handling has to occur when the Her response has arrived and not before. I will add a timer. I will also make a note in the posting as to how it turns out for my case."}, {"owner": {"reputation": 2689, "user_id": 1687639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a6dd18900e2bfd6dffec21ee358f31?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Oicles", "link": "https://stackoverflow.com/users/1687639/christopher-oicles"}, "edited": false, "score": 0, "creation_date": 1474663155, "post_id": 39621425, "comment_id": 66639923, "body": "I don&#39;t really have the time to make this an answer, and really you did all the work, so I would fully support and upvote a self-answer from you which goes over what you needed to do to get your app working.  (Leave out any of my suggestions which weren&#39;t helpful or applicable -- like you probably didn&#39;t need to use custom messages)."}, {"owner": {"reputation": 2689, "user_id": 1687639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a6dd18900e2bfd6dffec21ee358f31?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Oicles", "link": "https://stackoverflow.com/users/1687639/christopher-oicles"}, "edited": false, "score": 0, "creation_date": 1474665472, "post_id": 39621425, "comment_id": 66640965, "body": "Oh and by the way, it sounds like your I/O design is the standard way MFC does I/O, so there&#39;s nothing broken about it, excepting that MFC itself might be considered &quot;broken.&quot;  MFC has a ton of overridable handlers and member functions, I&#39;ve always been able to find a callback located where I wanted to add my own code (albeit a bit of research was needed to find out about some of the less commonly used ones).  MFC is probably on a slow road to deprecation, but there are few alternatives which offer its convenience and control on a low level.  WTL, maybe, but it lacks support."}], "owner": {"reputation": 410, "user_id": 2608530, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/4ctKm.png?s=128&g=1", "display_name": "rtischer8277", "link": "https://stackoverflow.com/users/2608530/rtischer8277"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1474551828, "creation_date": 1474473731, "last_edit_date": 1495541703, "question_id": 39621425, "link": "https://stackoverflow.com/questions/39621425/how-can-i-keep-the-main-thread-from-exiting-until-i-receive-a-reply-from-a-conne", "title": "How can I keep the Main thread from exiting until I receive a reply from a connected tcp socket?", "body": "<p>Here is my context. <code>MyApp</code> exits normally by clicking on either the <code>OK</code> or the <code>Cancel</code> dialog button. <code>MyApp</code> also maintains a TCP connection to another app, <code>HerApp</code>. Before <code>MyApp</code> can normally exit by clicking on one of these buttons, it needs to inform <code>HerApp</code> that it is going offline. This advisory message is sent to <code>HerApp</code> via a socket defined using this derived class: <code>class TxSocket : public CAsyncSocket</code>. <code>HerApp</code>s TCP listener replies which comes in on <code>MyApps</code>s <code>TxSocket::OnReceive</code>.</p>\n\n<p>My problem is <code>MyApp</code> ends before the TCP <code>OnReceive</code> occurs. </p>\n\n<p>I have thought of several approaches. Obviously, I cannot block the Main thread while the socket interaction completes because it too is running on the Main thread. I can\u2019t let the Main thread go out of scope either because normal app exit in C++ means all its resources are cleaned up including resources used in any other threads (see cppreference <strong>Main function</strong>: \u201c\u2026 destroys the objects with automatic storage duration\u2026\u201d ), so just launching another thread, which has automatic storage, merely to send the advisory message and wait for a receipt, is out of the question too. Statics are destroyed too so no help there. As a result, these techniques can\u2019t be used either: use of <code>std::thread</code> in conjunction with <code>std::packaged_task</code>, the use of <code>std::async</code> or the setting and retrieving of <code>std::promise</code>s and <code>std::future</code>s because the <code>get_future</code> object\u2019s <code>get()</code> would block the Main thread too. I could create an intermediary thread that creates these flag objects, but again, they would all get prematurely destroyed on <code>MyApp</code>s exit. The [What happens to a detached thread when main() exits?] (<a href=\"https://stackoverflow.com/questions/19744250/what-happens-to-a-detached-thread-when-main-exits\">What happens to a detached thread when main() exits?</a>) posting explores what happens when you detach a thread, but I found the answers to be non-definitive, at least for me as an app developer.</p>\n\n<p>I need help finding a good and simple C++ approach to solving this synchronization problem which, I predict, will be quite common once we get past the Web HTML era.</p>\n\n<p><strong>Edit 1</strong>:\nIn order to clarify the context of my problem, here my MFC on cancel handler:</p>\n\n<pre><code>void MyAppDlg::OnCancel()\n{\n  myApp-&gt;UseTcpioEngineToSendHerAppAdvisoryMsgThatMyAppHasCanceledExpectConfirmationReply(); // fails because connection and io objects get destroyed before completion\n\n  CDialog::OnCancel();\n} // all automatic static etc storage is destroyed and exit is called\n</code></pre>\n"}, {"tags": ["c++", "switch-statement"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474473391, "post_id": 39621305, "comment_id": 66548297, "body": "<code>command&lt;x&gt;;</code> actually looks like a NOP?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 12, "creation_date": 1474473411, "post_id": 39621305, "comment_id": 66548316, "body": "You only need the braces if you&#39;re going to use local variables within the case block."}, {"owner": {"reputation": 432, "user_id": 2151022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae4eef9b7f12f48e84498fa34eab76d?s=128&d=identicon&r=PG", "display_name": "Jacob", "link": "https://stackoverflow.com/users/2151022/jacob"}, "edited": false, "score": 3, "creation_date": 1474473475, "post_id": 39621305, "comment_id": 66548358, "body": "Similar to this question: <a href=\"http://stackoverflow.com/questions/4241545/c-switch-case-curly-braces-after-every-case\" title=\"c switch case curly braces after every case\">stackoverflow.com/questions/4241545/&hellip;</a>"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474473511, "post_id": 39621305, "comment_id": 66548389, "body": "Upvoted because this is a valid question; I&#39;ve often thought about it."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1474473559, "post_id": 39621305, "comment_id": 66548418, "body": "@ThomasMatthews C&#39;mon, it&#39;s pretty obvious when you&#39;ll need braces or not."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1474473619, "post_id": 39621305, "comment_id": 66548460, "body": "Actually, my question is whether the <code>break</code> should be inside the braces or not."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1474473658, "post_id": 39621305, "comment_id": 66548487, "body": "Also related: <a href=\"http://stackoverflow.com/questions/7044574/about-the-braces-in-case-statement-in-switch\" title=\"about the braces in case statement in switch\">stackoverflow.com/questions/7044574/&hellip;</a>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1474473749, "post_id": 39621305, "comment_id": 66548543, "body": "@ThomasMatthews It doesn&#39;t matter, but I personally prefer to keep it outside."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474473941, "post_id": 39621305, "comment_id": 66548659, "body": "<i>@\u0412\u043b\u0430\u0434 \u041c\u0430\u0440\u0442</i> <i>&quot;Any version is working ...&quot;</i> Not really, it depends what you need to have inside the <code>case</code> section. Your (pseudoi) code sample is meaningless."}, {"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1474475259, "post_id": 39621305, "comment_id": 66549435, "body": "Compare <a href=\"http://coliru.stacked-crooked.com/a/818cba8dde9517bc\" rel=\"nofollow noreferrer\">this</a> vs <a href=\"http://coliru.stacked-crooked.com/a/a409eafbd3e4bcb5\" rel=\"nofollow noreferrer\">this</a>"}], "owner": {"reputation": 11, "user_id": 4465623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570173e9efcf8523d337f94e6f8f2f75?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u043b\u0430\u0434 \u041c\u0430\u0440\u0442", "link": "https://stackoverflow.com/users/4465623/%d0%92%d0%bb%d0%b0%d0%b4-%d0%9c%d0%b0%d1%80%d1%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "closed_date": 1474473788, "answer_count": 0, "score": 1, "last_activity_date": 1474473311, "creation_date": 1474473311, "question_id": 39621305, "link": "https://stackoverflow.com/questions/39621305/switch-statement-c-with-some-commands", "closed_reason": "Duplicate", "title": "switch statement C++ with some commands", "body": "<p>I have a question.\nHow more correct use operator switch with blocks of commands:</p>\n\n<pre><code>switch(a)\n{\n   case 1: \n        {\n         command1;\n         command2;\n         commandN;\n         break;\n        }\n   case 2: \n        {\n         command3;\n         command4;\n         commandN;\n         break;\n        }\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>switch(a)\n{\n   case 1: \n         command1;\n         command2;\n         commandN;\n         break;\n\n   case 2:       \n         command3;\n         command4;\n         commandN;\n         break;     \n}\n</code></pre>\n\n<p>Use or not { ... } in case? Any version is working, but how more correctly?\nThanks.</p>\n"}, {"tags": ["c++", "inheritance", "casting", "multiple-inheritance"], "comments": [{"owner": {"reputation": 3124, "user_id": 354633, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kx0E0.jpg?s=128&g=1", "display_name": "antred", "link": "https://stackoverflow.com/users/354633/antred"}, "edited": false, "score": 0, "creation_date": 1474473600, "post_id": 39621301, "comment_id": 66548452, "body": "A C-style cast in not necessarily the same as a reinterpret_cast. In C++ a C-style cast will only equate to a reinterpret_cast or a const_cast if a static_cast won&#39;t do. I hope I&#39;m not over-simplifying things, but I believe that is the gist of the matter."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 6, "creation_date": 1474473869, "post_id": 39621301, "comment_id": 66548618, "body": "<i>&quot;I always read that C-style casts in C++ were the same as reinterpret_cast.&quot;</i> - Either you don&#39;t remember correctly, or you were particularly unlucky with your choice of reading material."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1474475648, "post_id": 39621301, "comment_id": 66549635, "body": "Prefer to use the C++ casts <i>always</i>. They more explicitly say what you want to do <i>and</i> they are easier to search for in source code. Of course, the <i>very best</i> is to design the code so no (or very few) casts are ever needed."}], "answers": [{"comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 151, "user_id": 1846536, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/25edbafe5ff7c8edef603b162f198f35?s=128&d=identicon&r=PG", "display_name": "lufinkey", "link": "https://stackoverflow.com/users/1846536/lufinkey"}, "edited": false, "score": 3, "creation_date": 1474474069, "post_id": 39621382, "comment_id": 66548732, "body": "@Finke: Obviously, the order was set by the standards committee. The order is listed in section [cast.expr], paragraph 4. C describes cast behavior with type conversion as well."}, {"owner": {"reputation": 457352, "user_id": 87234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FkjBe.png?s=128&g=1", "display_name": "GManNickG", "link": "https://stackoverflow.com/users/87234/gmannickg"}, "reply_to_user": {"reputation": 151, "user_id": 1846536, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/25edbafe5ff7c8edef603b162f198f35?s=128&d=identicon&r=PG", "display_name": "lufinkey", "link": "https://stackoverflow.com/users/1846536/lufinkey"}, "edited": false, "score": 7, "creation_date": 1474474071, "post_id": 39621382, "comment_id": 66548734, "body": "@Finke: Says the person who assumed their compiler had a bug because they couldn&#39;t be bothered to read any documentation. This behavior is much better than always <code>reinterpret_cast</code>ing, and is closer to how casts work in C anyway. Things like <code>(int)5.5</code> wouldn&#39;t even work if C-style casts were just short-hand for <code>reinterpret_cast</code>, and if we pretend that <code>reinterpret_cast</code> did just bit-wise type-punning on demand the result of that expression would be useless almost all of the time."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 151, "user_id": 1846536, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/25edbafe5ff7c8edef603b162f198f35?s=128&d=identicon&r=PG", "display_name": "lufinkey", "link": "https://stackoverflow.com/users/1846536/lufinkey"}, "edited": false, "score": 5, "creation_date": 1474474140, "post_id": 39621382, "comment_id": 66548775, "body": "@Finke: This is documented behavior (and hasn&#39;t changed ever). I suppose it&#39;s less dumb than using a language feature without bothering to understand what it does."}], "tags": [], "owner": {"reputation": 993, "user_id": 6858837, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f56ccb5125aaaad6dd7bb752be8f3494?s=128&d=identicon&r=PG&f=1", "display_name": "Trevir", "link": "https://stackoverflow.com/users/6858837/trevir"}, "is_accepted": false, "score": 8, "last_activity_date": 1474473585, "creation_date": 1474473585, "answer_id": 39621382, "question_id": 39621301, "link": "https://stackoverflow.com/questions/39621301/c-style-casting-in-c-giving-weird-behavior/39621382#39621382", "title": "C-Style casting in C++ giving weird behavior", "body": "<p>C-Style casting isn't the same as reinterpret_cast. </p>\n\n<p>A summary of the cast can be found here:\n<a href=\"http://en.cppreference.com/w/cpp/language/explicit_cast\">http://en.cppreference.com/w/cpp/language/explicit_cast</a></p>\n\n<p>with the following order: </p>\n\n<blockquote>\n  <p>a) const_cast(expression);</p>\n  \n  <p>b) static_cast(expression), with extensions: pointer or reference to a derived class is additionally allowed to be cast to pointer or reference to unambiguous base class (and vice versa) even if the base class is inaccessible (that is, this cast ignores the private inheritance specifier). Same applies to casting pointer to member to pointer to member of unambigous non-virtual base;</p>\n  \n  <p>c) static_cast (with extensions) followed by const_cast;</p>\n  \n  <p>d) reinterpret_cast(expression);</p>\n  \n  <p>e) reinterpret_cast followed by const_cast.</p>\n</blockquote>\n"}], "owner": {"reputation": 151, "user_id": 1846536, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/25edbafe5ff7c8edef603b162f198f35?s=128&d=identicon&r=PG", "display_name": "lufinkey", "link": "https://stackoverflow.com/users/1846536/lufinkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "answer_count": 1, "score": -7, "last_activity_date": 1474473662, "creation_date": 1474473299, "last_edit_date": 1474473547, "question_id": 39621301, "link": "https://stackoverflow.com/questions/39621301/c-style-casting-in-c-giving-weird-behavior", "title": "C-Style casting in C++ giving weird behavior", "body": "<p>I always read that C-style casts in C++ were the same as reinterpret_cast. However, I just tested this code in Visual Studio, and it appears that C-style casting is performing the same behavior as static cast. Does anybody know why? This seems like a bug...</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nclass Thing1\n{\n    std::string theString;\n\npublic:\n    Thing1(const std::string&amp; theString) : theString(theString)\n    {\n        //\n    }\n\n    std::string getTheString()\n    {\n        return theString;\n    }\n};\n\nclass Thing2\n{\n    std::string theString;\n\npublic:\n    Thing2(const std::string&amp; theString) : theString(theString)\n    {\n        //\n    }\n\n    std::string getTheString()\n    {\n        return theString;\n    }\n};\n\nclass Thing3 : public Thing1, public Thing2\n{\npublic:\n    Thing3(const std::string&amp; theString1, const std::string&amp; theString2) : Thing1(theString1), Thing2(theString2)\n    {\n        //\n    }\n};\n\nint main()\n{\n    Thing3* thing3 = new Thing3(\"string1\", \"string2\");\n    uintptr_t t3ptr = (uintptr_t)thing3;\n    uintptr_t t1ptr = (uintptr_t)((Thing1*)thing3);\n    uintptr_t t2ptr = (uintptr_t)((Thing2*)thing3);\n    std::cout &lt;&lt; t1ptr &lt;&lt; std::endl;\n    std::cout &lt;&lt; t2ptr &lt;&lt; std::endl;\n    std::cout &lt;&lt; t3ptr &lt;&lt; std::endl;\n    std::cin.ignore();\n    return 0;\n}\n</code></pre>\n\n<p>This code gives the output:</p>\n\n<pre><code>17563752\n17563780\n17563752\n</code></pre>\n"}, {"tags": ["c++", "arrays", "algorithm", "graph", "stl"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1474473381, "post_id": 39621277, "comment_id": 66548290, "body": "You are comparing apples to oranges.  If you need a queue structure why use something that is not a queue?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1474473474, "post_id": 39621277, "comment_id": 66548357, "body": "Accessing elements in an array and in a vector are both O(1). The time difference is, if anything, negligible. What <i>does</i> differ is that a vector is <i>dynamic</i>, when you add elements to a vector it might need to resize itself, which includes copying the existing data. That can be slow. If you know approximately the number of elements needed, you can reserve that amount for the vector and the speed difference goes back to just about zero. If you want a container with a compile-time fixed number of elements, use <code>std::array</code> instead."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1474473569, "post_id": 39621277, "comment_id": 66548428, "body": "One is static, the other is dynamic."}, {"owner": {"reputation": 457352, "user_id": 87234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FkjBe.png?s=128&g=1", "display_name": "GManNickG", "link": "https://stackoverflow.com/users/87234/gmannickg"}, "edited": false, "score": 1, "creation_date": 1474473681, "post_id": 39621277, "comment_id": 66548497, "body": "There are too many missing details here. Did you compile with optimizations? Did you use a data structure that gave you more functionality than you needed? Does your code still have as much functionality?"}, {"owner": {"reputation": 89, "user_id": 6840957, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e5231d172c4403137a46585d2c10d19f?s=128&d=identicon&r=PG&f=1", "display_name": "Bibek Bhattarai", "link": "https://stackoverflow.com/users/6840957/bibek-bhattarai"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1474473847, "post_id": 39621277, "comment_id": 66548602, "body": "@NathanOliver considering I have plenty of memory, if queue is dynamic and wastes time resizing as said by Joachim, then using array with maximum required size could be option if it really is faster. I want to know  for sure."}, {"owner": {"reputation": 89, "user_id": 6840957, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e5231d172c4403137a46585d2c10d19f?s=128&d=identicon&r=PG&f=1", "display_name": "Bibek Bhattarai", "link": "https://stackoverflow.com/users/6840957/bibek-bhattarai"}, "reply_to_user": {"reputation": 457352, "user_id": 87234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FkjBe.png?s=128&g=1", "display_name": "GManNickG", "link": "https://stackoverflow.com/users/87234/gmannickg"}, "edited": false, "score": 0, "creation_date": 1474473967, "post_id": 39621277, "comment_id": 66548676, "body": "@GManNickG I just changed the data container from queue(I am using pop_front and push_back functions only) to array. And I did not compile with optimizations"}, {"owner": {"reputation": 457352, "user_id": 87234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FkjBe.png?s=128&g=1", "display_name": "GManNickG", "link": "https://stackoverflow.com/users/87234/gmannickg"}, "edited": false, "score": 4, "creation_date": 1474474233, "post_id": 39621277, "comment_id": 66548834, "body": "If you didn&#39;t compile with optimizations, asking about performance is meaningless. You tied both the compiler&#39;s hands behind its back. Was this a dynamic array you changed to, or fixed-size?"}, {"owner": {"reputation": 89, "user_id": 6840957, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e5231d172c4403137a46585d2c10d19f?s=128&d=identicon&r=PG&f=1", "display_name": "Bibek Bhattarai", "link": "https://stackoverflow.com/users/6840957/bibek-bhattarai"}, "reply_to_user": {"reputation": 457352, "user_id": 87234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FkjBe.png?s=128&g=1", "display_name": "GManNickG", "link": "https://stackoverflow.com/users/87234/gmannickg"}, "edited": false, "score": 0, "creation_date": 1474474525, "post_id": 39621277, "comment_id": 66548993, "body": "@GManNickG fixed size and it is not circular. Just an array of size of maximum number of elements possible"}, {"owner": {"reputation": 457352, "user_id": 87234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FkjBe.png?s=128&g=1", "display_name": "GManNickG", "link": "https://stackoverflow.com/users/87234/gmannickg"}, "edited": false, "score": 0, "creation_date": 1474475133, "post_id": 39621277, "comment_id": 66549361, "body": "@BibekBhattarai: So this falls under the &quot;the data structure did too much&quot; category. That said I&#39;d like to see the results with optimizations turned on. But if you have a max element count and <code>std::queue</code> does not, it will keep trying to grow things as much as it needs and that has bookkeeping overhead. If you needed that behavior, then <code>std::queue</code> would be better than array. Boost has a <code>circular_buffer</code> class, for example, which is closer to what most people want when they have some hard cap on element count. If you posted more code  (but minimal) we could review the options."}], "answers": [{"comments": [{"owner": {"reputation": 46684, "user_id": 1527, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2180b1a962bf46e58fa9746cb4ebfb91?s=128&d=identicon&r=PG", "display_name": "Pete Kirkham", "link": "https://stackoverflow.com/users/1527/pete-kirkham"}, "edited": false, "score": 0, "creation_date": 1474621649, "post_id": 39622974, "comment_id": 66615952, "body": "Implementations of std::queue tend to allocate contiguous memory blocks of increasing size, (e.g. a block for the first 16 elements, then a block for he next 32 elements) which are as large or larger than the cache line size. So the difference becomes is whether or not subsequent cache misses are sequential or not, which generally is less of an impact."}], "tags": [], "owner": {"reputation": 1921, "user_id": 6317147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376fccc260dbc5e810117896b2bdf3a9?s=128&d=identicon&r=PG", "display_name": "Gregg", "link": "https://stackoverflow.com/users/6317147/gregg"}, "is_accepted": false, "score": 1, "last_activity_date": 1474478888, "creation_date": 1474478888, "answer_id": 39622974, "question_id": 39621277, "link": "https://stackoverflow.com/questions/39621277/why-is-array-considered-better-than-stl-containers/39622974#39622974", "title": "Why is array considered better than STL containers?", "body": "<p>The array is faster for most machines, because the contiguous elements of an array can be loaded in the same cache line (or pre loaded to the cache on a pre-need basis). Since a L1 cache read is 200 times faster than a main memory access, anything that requires a pointer fetch, will likely not be in cache and takes the much longer main memory fetch cycle.</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=YQs6IC-vgmo\" rel=\"nofollow\">https://www.youtube.com/watch?v=YQs6IC-vgmo</a></p>\n"}], "owner": {"reputation": 89, "user_id": 6840957, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e5231d172c4403137a46585d2c10d19f?s=128&d=identicon&r=PG&f=1", "display_name": "Bibek Bhattarai", "link": "https://stackoverflow.com/users/6840957/bibek-bhattarai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474560782, "creation_date": 1474473212, "last_edit_date": 1474560782, "question_id": 39621277, "link": "https://stackoverflow.com/questions/39621277/why-is-array-considered-better-than-stl-containers", "title": "Why is array considered better than STL containers?", "body": "<p><code>array</code> vs. <code>std::queue</code>, which is better in terms of time and why?</p>\n\n<p>I have written one graph processing algorithm in which frontier vertices are stored in <code>std::queue</code> and are accessed using <code>push_back()</code> and <code>pop_front()</code>. When I re-implemented the frontier with array with front and end pointers pointing to the start and end of the frontier vertices, I get the better result in terms of time. Is array really faster than queue for large enough size of data?</p>\n"}, {"tags": ["c++", "templates", "c++11", "variadic-templates", "variadic-functions"], "comments": [{"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1474555614, "post_id": 39621158, "comment_id": 66587802, "body": "it is possible to restrict the arguments to a certain type. Do you want an answer on this? Do you require the arguments to be exactly <code>T</code> or something convertible to <code>T</code>?"}, {"owner": {"reputation": 2416, "user_id": 1007758, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/208fa8b23525defef40f19ea51230bef?s=128&d=identicon&r=PG", "display_name": "Jacob Krieg", "link": "https://stackoverflow.com/users/1007758/jacob-krieg"}, "reply_to_user": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1474574471, "post_id": 39621158, "comment_id": 66599117, "body": "@bolov Yes, please, that would be extremely useful! I will +1"}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1474628449, "post_id": 39621158, "comment_id": 66620027, "body": "I created a new post with exactly this: <a href=\"http://stackoverflow.com/questions/39659127/restrict-variadic-template-arguments/39659128#39659128\" title=\"restrict variadic template arguments\">stackoverflow.com/questions/39659127/&hellip;</a>"}, {"owner": {"reputation": 2416, "user_id": 1007758, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/208fa8b23525defef40f19ea51230bef?s=128&d=identicon&r=PG", "display_name": "Jacob Krieg", "link": "https://stackoverflow.com/users/1007758/jacob-krieg"}, "reply_to_user": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1474735350, "post_id": 39621158, "comment_id": 66657570, "body": "@bolov great post, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": false, "score": 17, "last_activity_date": 1474473029, "creation_date": 1474473029, "answer_id": 39621214, "question_id": 39621158, "link": "https://stackoverflow.com/questions/39621158/limit-the-number-of-parameters-in-a-variadic-template-parameter-pack/39621214#39621214", "title": "Limit the number of parameters in a variadic template parameter pack", "body": "<blockquote>\n  <p>Is it possible to make to compiler give an error if a template function with a parameter pack has the number of arguments higher than a compile-time determined value?</p>\n</blockquote>\n\n<p>Yes, use <a href=\"http://en.cppreference.com/w/cpp/language/static_assert\"><code>static_assert</code></a>:</p>\n\n<pre><code>template &lt;class ...Args&gt;\nvoid setRequestArguments(const Args&amp;... args)\n{\n    static_assert(sizeof...(args) &lt;= 10, \"You can't have more than 10 arguments!\");\n    //Stuff...\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 3, "creation_date": 1474473423, "post_id": 39621288, "comment_id": 66548326, "body": "That really is an interesting way using SFINAE :)"}], "tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": true, "score": 24, "last_activity_date": 1601106344, "last_edit_date": 1601106344, "creation_date": 1474473265, "answer_id": 39621288, "question_id": 39621158, "link": "https://stackoverflow.com/questions/39621158/limit-the-number-of-parameters-in-a-variadic-template-parameter-pack/39621288#39621288", "title": "Limit the number of parameters in a variadic template parameter pack", "body": "<p>To make the function not callable when there's too many arguments, you can constraint the function with sfinae. That way, if there's another overload that accepts more arguments, the compiler will be able to select the correct overload.</p>\n<p>A simple <code>std::enable_if</code> with the condition will suffice:</p>\n<pre><code>template &lt;class ...Args, std::enable_if_t&lt;(sizeof...(Args) &lt;= 10)&gt;* = nullptr&gt;\nvoid setRequestArguments(const Args&amp;... args)\n{\n    const std::vector&lt;QGenericArgument&gt; vec = {args... };\n}\n</code></pre>\n<p>For the sake of readability, you can put the constraint in the trailing return type of your function:</p>\n<pre><code>template &lt;class ...Args&gt;\nauto setRequestArguments(const Args&amp;... args) -&gt; std::enable_if_t&lt;(sizeof...(args) &lt;= 10)&gt;\n{\n    const std::vector&lt;QGenericArgument&gt; vec = {args... };\n}\n</code></pre>\n<hr />\n<p>Here's an updated version for C++20 using <code>requires</code> and terse template syntax:</p>\n<pre><code>auto setRequestArguments(const auto&amp;... args) requires (sizeof...(args) &lt;= 10) -&gt; void {\n    const std::vector&lt;QGenericArgument&gt; vec = {args... };\n}\n</code></pre>\n"}], "owner": {"reputation": 2416, "user_id": 1007758, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/208fa8b23525defef40f19ea51230bef?s=128&d=identicon&r=PG", "display_name": "Jacob Krieg", "link": "https://stackoverflow.com/users/1007758/jacob-krieg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2427, "favorite_count": 3, "accepted_answer_id": 39621288, "answer_count": 2, "score": 14, "last_activity_date": 1601106344, "creation_date": 1474472853, "last_edit_date": 1474574516, "question_id": 39621158, "link": "https://stackoverflow.com/questions/39621158/limit-the-number-of-parameters-in-a-variadic-template-parameter-pack", "title": "Limit the number of parameters in a variadic template parameter pack", "body": "<p>I have a template function that takes a variable number of arguments. Since you can't force the arguments to be of a certain type I would like at least to force the number of arguments not to be higher that a compile-time determined number(e.g. 10).</p>\n\n<p>Is it possible to make to compiler give an error if a template function with a parameter pack has the number of arguments higher than a compile-time determined value?   </p>\n\n<pre><code>template &lt;class ...Args&gt;\nvoid setRequestArguments(const Args&amp;... args)\n{\n    const std::vector&lt;QGenericArgument&gt; vec = { args... };\n    qDebug() &lt;&lt; sizeof...(args);\n    // Do stuff...\n    // for (unsigned i = 0; i &lt; vec.size(); ++i) {\n    //     qDebug() &lt;&lt; vec[i].name();\n    // }\n}\n</code></pre>\n\n<p>What I want to use it for is for a generic container for all arguments in an <code>QMetaObject::invokeMethod</code> wrapper function.</p>\n"}, {"tags": ["c++", "types", "enums", "language-lawyer"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1474472762, "post_id": 39621098, "comment_id": 66547878, "body": "Upvoted as promised. I can&#39;t see anything in <a href=\"http://en.cppreference.com/w/cpp/language/enum\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/enum</a>"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1474472922, "post_id": 39621098, "comment_id": 66547989, "body": "Seems like <code>int</code> would be a more interesting question, because then the computation of <code>bar + 1</code> causes UB."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1474472995, "post_id": 39621098, "comment_id": 66548039, "body": "@KerrekSB: that&#39;s essentially the crux of my answer on the linked question."}, {"owner": {"reputation": 1820, "user_id": 6797552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196e325077d7a6e974c49ccaea2681c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shmuel H.", "link": "https://stackoverflow.com/users/6797552/shmuel-h"}, "edited": false, "score": 0, "creation_date": 1474473133, "post_id": 39621098, "comment_id": 66548119, "body": "The value of <code>UINT_MAX + 1</code> is defined. <code>oops</code> is an unsigned int enum.  Why wouldn&#39;t it be defined?"}, {"owner": {"reputation": 1820, "user_id": 6797552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196e325077d7a6e974c49ccaea2681c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shmuel H.", "link": "https://stackoverflow.com/users/6797552/shmuel-h"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1474473209, "post_id": 39621098, "comment_id": 66548163, "body": "@Bathsheba I don&#39;t know, maybe he has a point."}, {"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "reply_to_user": {"reputation": 1820, "user_id": 6797552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196e325077d7a6e974c49ccaea2681c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shmuel H.", "link": "https://stackoverflow.com/users/6797552/shmuel-h"}, "edited": false, "score": 1, "creation_date": 1474473393, "post_id": 39621098, "comment_id": 66548298, "body": "@ShmuelH. I thought so but shouldn&#39;t it compile with gcc then?"}, {"owner": {"reputation": 2954, "user_id": 5508296, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/l6uTa.jpg?s=128&g=1", "display_name": "sjrowlinson", "link": "https://stackoverflow.com/users/5508296/sjrowlinson"}, "edited": false, "score": 1, "creation_date": 1474473504, "post_id": 39621098, "comment_id": 66548383, "body": "Compilation fails using GCC 6.1.0. too."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 4, "creation_date": 1474473539, "post_id": 39621098, "comment_id": 66548406, "body": "Hum. UINT_MAX + 1 is obviously a compile time evaluable constant expression, but given that it can&#39;t fit into an <code>unsigned</code>, the C++ standard wants the compiler to pick a long long as the enum type, but can&#39;t since you&#39;ve forced it to be an <code>unsigned</code>. To me that explains the compiler errors and could even be the answer. The line in the standard &quot;If the underlying type is fixed, the values can be converted to their promoted underlying type&quot; also has something to do with it methinks."}, {"owner": {"reputation": 1820, "user_id": 6797552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196e325077d7a6e974c49ccaea2681c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shmuel H.", "link": "https://stackoverflow.com/users/6797552/shmuel-h"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1474473864, "post_id": 39621098, "comment_id": 66548616, "body": "@Bathsheba Yes, but if it would compile with some compiler, it should be defined."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 4, "creation_date": 1474473963, "post_id": 39621098, "comment_id": 66548673, "body": "@Bathsheba Just tested to see and if you do not limit the type you just get a warning: <a href=\"http://coliru.stacked-crooked.com/a/a8306b64279b700c\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/a8306b64279b700c</a>"}, {"owner": {"reputation": 1820, "user_id": 6797552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196e325077d7a6e974c49ccaea2681c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shmuel H.", "link": "https://stackoverflow.com/users/6797552/shmuel-h"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1474474124, "post_id": 39621098, "comment_id": 66548758, "body": "@NathanOliver With gcc (6.2.1), you don&#39;t even get a warning."}, {"owner": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "edited": false, "score": 2, "creation_date": 1474474218, "post_id": 39621098, "comment_id": 66548823, "body": "[dcl.enum]/2 and 7 seem to be relevant here. <i>&quot;if the initializing value of an enumerator cannot be represented by the underlying type, the program is ill-formed.&quot;</i> is interesting, but I am not really sure if it applies. Currently trying to fugure standartese there."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1474478679, "post_id": 39621098, "comment_id": 66551327, "body": "Visual Studio 2013 here: there is a warning for <code>unsigned</code>, but for <code>enum foo : unsigned long long</code> with <code>bar = ULLONG_MAX</code>, there is no warning, even though the value overflow behavior stays the same."}], "answers": [{"comments": [{"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 1, "creation_date": 1474530201, "post_id": 39624765, "comment_id": 66570755, "body": "I like your answer but is it truely undefined if the underlying type is unsigned? You have quoted <code>[dcl.enum]&#47;7</code>yourself which should (as overflow is designed for unsigned types) lead to the value that exceeds the range first to become 0 again..."}, {"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 1, "creation_date": 1474530521, "post_id": 39624765, "comment_id": 66570954, "body": "Also I am not sure that <code>bool</code> is the best choice here as the underlying data is neither signed nor unsigned and it doesn&#39;t overflow either (AFAIK), It&#39;s a pretty special case."}, {"owner": {"reputation": 1820, "user_id": 6797552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196e325077d7a6e974c49ccaea2681c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shmuel H.", "link": "https://stackoverflow.com/users/6797552/shmuel-h"}, "reply_to_user": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 1, "creation_date": 1474531204, "post_id": 39624765, "comment_id": 66571373, "body": "@SimonKraemer I thought like you, but you should keep in mind that an enumerator value&#39;s type is not the same as its underlying-type. In other words, the standard should have said that an  enumerator value should be converted into its *underlying-type (see the <code>The difference between initializer (e.g. undefined=2) and &quot;implicit&quot; initializer (e.g. True=true, undefined)</code> section)."}, {"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1474531391, "post_id": 39624765, "comment_id": 66571502, "body": "Thanks for clarifying."}, {"owner": {"reputation": 1820, "user_id": 6797552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196e325077d7a6e974c49ccaea2681c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shmuel H.", "link": "https://stackoverflow.com/users/6797552/shmuel-h"}, "reply_to_user": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 1, "creation_date": 1474531534, "post_id": 39624765, "comment_id": 66571591, "body": "@SimonKraemer And just a point for fun: It would clear as day that in a case of a <code>not-fixed underlying type enum</code>, it would be ill-formed - with a regular <code>unsigned int</code>: the standard says it explicitly in [dcl.enum]/7."}], "tags": [], "owner": {"reputation": 1820, "user_id": 6797552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196e325077d7a6e974c49ccaea2681c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shmuel H.", "link": "https://stackoverflow.com/users/6797552/shmuel-h"}, "is_accepted": true, "score": 19, "last_activity_date": 1474487700, "last_edit_date": 1474487700, "creation_date": 1474485202, "answer_id": 39624765, "question_id": 39621098, "link": "https://stackoverflow.com/questions/39621098/what-happens-if-an-enum-cannot-fit-into-an-unsigned-integral-type/39624765#39624765", "title": "What happens if an enum cannot fit into an unsigned integral type?", "body": "<p>This is a very interesting question. The simple answer is that this is literally undefined: the standard doesn't say anything about this case. </p>\n\n<p>To have a better example, consider this <code>enum</code>:</p>\n\n<pre><code> enum foo : bool { True=true, undefined };\n</code></pre>\n\n<p>According to the standard:</p>\n\n<blockquote>\n  <p>[<em>dcl.enum</em>]/<em>2</em>: [...] An <em>enumerator-definition</em> without an <em>initializer</em> gives the <em>enumerator</em> the value obtained by increasing the value of the <em>previous enumerator</em> by one.</p>\n</blockquote>\n\n<p>Therefore, the value of <code>foo::undefined</code> in our example is <code>2</code> (<code>true+1</code>). Which can not be represented as a <code>bool</code>.</p>\n\n<h3>Is it ill-formed?</h3>\n\n<p><strong>No</strong>, according to the standard, it is perfectly valid, only <em>not-fixed underlying type</em> have a restriction about not being able to represent all of the enumerator values:</p>\n\n<blockquote>\n  <p>[<em>dcl.enum</em>]/<em>7</em>: For an enumeration whose underlying type is not fixed, [...] If no integral type can represent all the enumerator values, the enumeration is ill-formed.</p>\n</blockquote>\n\n<p>It says nothing about a <em>fixed underlying type</em> that can not represent all the enumerator values.</p>\n\n<h3>What is the value of original question's <code>oops</code> and <code>undefined</code>?</h3>\n\n<p>It is <strong>undefined</strong>: the standard doesn't say anything about this case.</p>\n\n<p>Possible values for <code>foo::undefined</code>:</p>\n\n<ul>\n<li>Highest possible value (<code>true</code>): <code>undefined</code> and <code>oops</code> should be <em>underlying type</em>'s maximum value.</li>\n<li>Lowest possible value (<code>false</code>): the <em>underlying type</em>'s minimum value. Note: In signed integers, it would not match the current behavior for Integer overflow (undefined behavior).</li>\n<li>Random value (?): the compiler will choose an value.</li>\n</ul>\n\n<p>The problem with all of these values is that it may result two fields with the same value (e.g. <code>foo::True == foo::undefined</code>).</p>\n\n<h3>The difference between <em>initializer</em> (e.g. <code>undefined=2</code>) and \"implicit\" initializer (e.g. <code>True=true, undefined</code>)</h3>\n\n<p>According to the standard:</p>\n\n<blockquote>\n  <p>[<em>dcl.enum</em>]/<em>5</em>: If the underlying type is fixed, the type of each enumerator prior to the closing brace is the <em>underlying type</em> and the <em>constant-expression</em> in the <em>enumerator-definition</em> shall be a converted constant expression of the underlying type.</p>\n</blockquote>\n\n<p>In other words:</p>\n\n<pre><code> enum bar : bool { undefined=2 };\n</code></pre>\n\n<p>is equivalent to </p>\n\n<pre><code> enum bar : bool { undefined=static_cast&lt;bool&gt;(2) };\n</code></pre>\n\n<p>And then <code>bar::undefined</code> will be <code>true</code>. In an \"implicit\" initializer, it would not be the case: this standard paragraph say it about only <em>initializer</em>, and not about \"implicit\" initializer.</p>\n\n<h3>Summary</h3>\n\n<ol>\n<li>With this way, it is possible for an <code>enum</code> with a <em>fixed-underlying-type</em> to have unrepresentable values.</li>\n<li>Their value is undefined by the standard.</li>\n</ol>\n\n<p>According to the question and comments, this is not valid in GCC and clang but valid for MSVS-2015 (with a warning).</p>\n"}], "owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1014, "favorite_count": 3, "accepted_answer_id": 39624765, "answer_count": 1, "score": 45, "last_activity_date": 1474487700, "creation_date": 1474472680, "last_edit_date": 1495540906, "question_id": 39621098, "link": "https://stackoverflow.com/questions/39621098/what-happens-if-an-enum-cannot-fit-into-an-unsigned-integral-type", "title": "What happens if an enum cannot fit into an unsigned integral type?", "body": "<p>As requested by <a href=\"https://stackoverflow.com/users/2380830/bathsheba\">Bathsheba</a> and as a follow up question to <a href=\"https://stackoverflow.com/questions/39620802/what-happens-if-an-enum-cannot-fit-into-an-integral-type\">\"What happens if an enum cannot fit into an integral type?\"</a>:</p>\n\n<p>Asuming an enum is defined as follows :</p>\n\n<pre><code>enum foo : unsigned int\n{\n    bar = UINT_MAX,\n    oops\n};\n</code></pre>\n\n<p>Is the value of <code>oops</code> defined or isn't it?</p>\n\n<hr>\n\n<p>MSVS2015 compilation:</p>\n\n<pre><code>warning C4340: 'oops': value wrapped from positive to negative value\nwarning C4309: 'initializing': truncation of constant value\nwarning C4369: 'oops':  enumerator value '4294967296' cannot be represented as 'unsigned int', value is '0'\n</code></pre>\n\n<p>MSVS2015 output:</p>\n\n<pre><code>bar = 4294967295\noops= 0\n</code></pre>\n\n<hr>\n\n<p>gcc 4.9.2 compilation:</p>\n\n<pre><code>9 : note: in expansion of macro 'UINT_MAX'\nbar = UINT_MAX,\n^\n10 : error: enumerator value 4294967296l is outside the range of underlying type 'unsigned int'\noops\n^\nCompilation failed\n</code></pre>\n\n<p>gcc 4.9.2 output</p>\n\n<pre><code>//compilation failed\n</code></pre>\n"}, {"tags": ["c++", "types", "enums", "size"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 6, "creation_date": 1474472009, "post_id": 39620802, "comment_id": 66547406, "body": "If you make an <code>enum</code> that large, your source file wouldn&#39;t fit on disk :-)"}, {"owner": {"reputation": 294, "user_id": 3893750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56d5df0a643d5eab6e840fc33fc9e85c?s=128&d=identicon&r=PG&f=1", "display_name": "Bear", "link": "https://stackoverflow.com/users/3893750/bear"}, "edited": false, "score": 1, "creation_date": 1474472042, "post_id": 39620802, "comment_id": 66547423, "body": "I was envisioning a truly horrifying header file with more than 2^64 names in the enum. Would that not work?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1474472117, "post_id": 39620802, "comment_id": 66547470, "body": "It&#39;s surprisingly simple to contrive it, see my answer."}], "answers": [{"comments": [{"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 4, "creation_date": 1474472274, "post_id": 39620865, "comment_id": 66547569, "body": "Is it also UB when the enum&#39;s underlying type is <code>unsigned</code>?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1474472299, "post_id": 39620865, "comment_id": 66547587, "body": "Oh that is a beautiful question. Please ask it! I will instantly upvote that."}, {"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 2, "creation_date": 1474472700, "post_id": 39620865, "comment_id": 66547848, "body": "<a href=\"http://stackoverflow.com/questions/39621098/what-happens-if-an-enum-cannot-fit-into-an-unsigned-integral-type\" title=\"what happens if an enum cannot fit into an unsigned integral type\">stackoverflow.com/questions/39621098/&hellip;</a>"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 10, "last_activity_date": 1474472022, "creation_date": 1474472022, "answer_id": 39620865, "question_id": 39620802, "link": "https://stackoverflow.com/questions/39620802/what-happens-if-an-enum-cannot-fit-into-an-integral-type/39620865#39620865", "title": "What happens if an enum cannot fit into an integral type?", "body": "<p>The behaviour of</p>\n\n<pre><code>enum foo : int\n{\n    bar = INT_MAX,\n    oops\n};\n</code></pre>\n\n<p>and similar is <em>undefined</em>.</p>\n\n<p>I've cheated a little here by forcing the type to an <code>int</code>, but the same applies to the largest integral type available on your platform.</p>\n"}], "owner": {"reputation": 294, "user_id": 3893750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56d5df0a643d5eab6e840fc33fc9e85c?s=128&d=identicon&r=PG&f=1", "display_name": "Bear", "link": "https://stackoverflow.com/users/3893750/bear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 1, "accepted_answer_id": 39620865, "answer_count": 1, "score": 12, "last_activity_date": 1474472022, "creation_date": 1474471836, "last_edit_date": 1495540904, "question_id": 39620802, "link": "https://stackoverflow.com/questions/39620802/what-happens-if-an-enum-cannot-fit-into-an-integral-type", "title": "What happens if an enum cannot fit into an integral type?", "body": "<p>I came across <a href=\"https://stackoverflow.com/questions/1122096/what-is-the-underlying-type-of-a-c-enum\">this question</a> about the underlying types of enums, where an answers quotes Standard C++ 7.2/5 as:</p>\n\n<blockquote>\n  <p>The underlying type of an enumeration is an integral type that can represent all the enumerator values defined in the enumeration. It is implementation-defined which integral type is used as the underlying type for an enumeration except that the underlying type shall not be larger than int unless the value of an enu- merator cannot fit in an int or unsigned int.</p>\n</blockquote>\n\n<p>This is pretty clear for all reasonable cases. <strong>But what happens if I make an enum so ridiculously large that it can't even fit in a long long?</strong></p>\n\n<p>(I don't know why this would ever happen in practice, but maybe I'm feeling destructive and have a free afternoon)</p>\n\n<p><strong>Is this behavior defined by the standard?</strong></p>\n"}, {"tags": ["c++", "templates", "reinterpret-cast", "typename"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1474473600, "post_id": 39620787, "comment_id": 66548451, "body": "What is the point to declare and assign value to <code>array</code> in different statements?"}], "answers": [{"comments": [{"owner": {"reputation": 852, "user_id": 5189849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/beb1b76043c40b325a8b0bed6280d7be?s=128&d=identicon&r=PG&f=1", "display_name": "Szymon Marczak", "link": "https://stackoverflow.com/users/5189849/szymon-marczak"}, "edited": false, "score": 0, "creation_date": 1474472422, "post_id": 39620962, "comment_id": 66547662, "body": "Is it possible to add float and double?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 852, "user_id": 5189849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/beb1b76043c40b325a8b0bed6280d7be?s=128&d=identicon&r=PG&f=1", "display_name": "Szymon Marczak", "link": "https://stackoverflow.com/users/5189849/szymon-marczak"}, "edited": false, "score": 0, "creation_date": 1474472515, "post_id": 39620962, "comment_id": 66547734, "body": "@SzymonMarczak If you want integers and floating point types then you want to use <a href=\"http://en.cppreference.com/w/cpp/types/is_arithmetic\" rel=\"nofollow noreferrer\"><code>std::is_arithmetic</code></a>"}, {"owner": {"reputation": 852, "user_id": 5189849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/beb1b76043c40b325a8b0bed6280d7be?s=128&d=identicon&r=PG&f=1", "display_name": "Szymon Marczak", "link": "https://stackoverflow.com/users/5189849/szymon-marczak"}, "edited": false, "score": 0, "creation_date": 1474472550, "post_id": 39620962, "comment_id": 66547759, "body": "Thanks very much :)"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 5, "last_activity_date": 1474472650, "last_edit_date": 1474472650, "creation_date": 1474472252, "answer_id": 39620962, "question_id": 39620787, "link": "https://stackoverflow.com/questions/39620787/filter-typenames-in-c/39620962#39620962", "title": "Filter typenames in C++", "body": "<p>You can do this using <a href=\"http://en.cppreference.com/w/cpp/types/is_integral\" rel=\"nofollow\"><code>std::is_integral</code></a> and SFINAE.  This will remove the template from consideration if the type is not a integer type.  It would look something like</p>\n\n<pre><code>template&lt;typename T, typename std::enable_if&lt;std::is_integral&lt;T&gt;::value&gt;::type* = nullptr&gt;\nvoid put(T value)\n{\n    // code\n}\n</code></pre>\n\n<p><kbd><a href=\"http://coliru.stacked-crooked.com/a/2997058890f9a79e\" rel=\"nofollow\">Live Example</a></kbd></p>\n\n<p>If instead you want allow all integral and floating point types then you can use <a href=\"http://en.cppreference.com/w/cpp/types/is_arithmetic\" rel=\"nofollow\"><code>std::is_arithmetic</code></a> like</p>\n\n<pre><code>template&lt;typename T, typename std::enable_if&lt;std::is_arithmetic&lt;T&gt;::value&gt;::type* = nullptr&gt;\nvoid put(T value)\n{\n    // code\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": false, "score": 1, "last_activity_date": 1474472260, "creation_date": 1474472260, "answer_id": 39620965, "question_id": 39620787, "link": "https://stackoverflow.com/questions/39620787/filter-typenames-in-c/39620965#39620965", "title": "Filter typenames in C++", "body": "<p>It seems you need a function that accept only any integral types.</p>\n\n<p>There is an existing type trait for that un the <a href=\"http://en.cppreference.com/w/cpp/header/type_traits\" rel=\"nofollow\"><code>&lt;type_traits&gt;</code></a> header called <a href=\"http://en.cppreference.com/w/cpp/types/is_integral\" rel=\"nofollow\"><code>std::is_integral</code></a>. You can use it with <code>std::enable_if</code> to produce the expected constraint:</p>\n\n<pre><code>template&lt;typename T, std::enable_if_t&lt;std::is_integral&lt;T&gt;::value, int&gt; = 0&gt;\nvoid put(T value) {\n    constexpr int size = sizeof(value);\n\n    uint8_t *array;\n    array = reinterpret_cast&lt;uint8_t *&gt;(&amp;value);\n\n    if (littleEndian) {\n        for (int i = 0; i &lt; size; i++) {\n            arr.push_back(array[i]);\n        }\n    } else {\n        for (int i = size - 1; i &gt;= 0; i--) {\n            arr.push_back(array[i]);\n        }\n    }\n}\n</code></pre>\n\n<p>Your function is now not callable with non integral types.</p>\n\n<p>Be aware that if there's another overload of the function, the compiler will try it too. That means that if you have another function that accept any floating types, the compiler will select the appropriated overload.</p>\n"}], "owner": {"reputation": 852, "user_id": 5189849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/beb1b76043c40b325a8b0bed6280d7be?s=128&d=identicon&r=PG&f=1", "display_name": "Szymon Marczak", "link": "https://stackoverflow.com/users/5189849/szymon-marczak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 1, "accepted_answer_id": 39620962, "answer_count": 2, "score": 1, "last_activity_date": 1474472650, "creation_date": 1474471802, "last_edit_date": 1474472527, "question_id": 39620787, "link": "https://stackoverflow.com/questions/39620787/filter-typenames-in-c", "title": "Filter typenames in C++", "body": "<p>This is my converter to byte array (vector).</p>\n\n<pre><code>template&lt;typename T&gt;\nvoid put(T value) {\n    int size = sizeof(value);\n\n    uint8_t *array;\n    array = reinterpret_cast&lt;uint8_t *&gt;(&amp;value);\n\n    if (littleEndian) {\n        for (int i = 0; i &lt; size; i++) {\n            arr.push_back(array[i]);\n        }\n    } else {\n        for (int i = size - 1; i &gt;= 0; i--) {\n            arr.push_back(array[i]);\n        }\n    }\n}\n</code></pre>\n\n<p>As you can see, this function accepts all variable types. Is it possible to filter typenames? E.g. I want to allow only <code>uint8_t, int8_t, uint16_t, int16_t etc. + float and double too</code>? I don't want to make 10 <code>if</code> statements, because it doesn't look clean.</p>\n"}, {"tags": ["c++", "shared-libraries", "static-libraries"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474471638, "post_id": 39620697, "comment_id": 66547148, "body": "Specific compiler? GCC?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474472633, "post_id": 39620697, "comment_id": 66547811, "body": "Which <code>.a</code> file you&#39;re referring to in particular? The stub that&#39;s generated for a <code>.so</code>, or a static library generated for the same source code?"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1474474143, "post_id": 39620697, "comment_id": 66548776, "body": "Both the .a and the .so file contain code.  Consider panicking only when the .so file gets <i>bigger</i> than the .a file, you then have to figure out where that extra code came from."}], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474471852, "post_id": 39620791, "comment_id": 66547287, "body": "I&#39;m not sure that fully explains it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6420285"}, "is_accepted": true, "score": 3, "last_activity_date": 1474471809, "creation_date": 1474471809, "answer_id": 39620791, "question_id": 39620697, "link": "https://stackoverflow.com/questions/39620697/why-the-so-file-always-smaller-than-the-a-filethe-source-is-identical/39620791#39620791", "title": "Why the .so file always smaller than the .a file?(the source is identical.)", "body": "<p>The link stage (which generates the shared object file) will trim out unused functions etc. and perform other compaction.</p>\n\n<p>The compilation phase (which generates the .a) will not.</p>\n"}], "owner": {"reputation": 61, "user_id": 2095533, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6bab59da39792672d1288449ca26dac0?s=128&d=identicon&r=PG", "display_name": "ji ding", "link": "https://stackoverflow.com/users/2095533/ji-ding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 39620791, "answer_count": 1, "score": 1, "last_activity_date": 1474471809, "creation_date": 1474471535, "last_edit_date": 1474471687, "question_id": 39620697, "link": "https://stackoverflow.com/questions/39620697/why-the-so-file-always-smaller-than-the-a-filethe-source-is-identical", "title": "Why the .so file always smaller than the .a file?(the source is identical.)", "body": "<p>I use a .a file in my project,when I use the source files in the project and the .a file to generate a .so file, I found the generated .so file is smaller than the .a file,</p>\n\n<p>What is the reason for this?</p>\n"}, {"tags": ["c++", "xcode", "opencv", "build"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1474471582, "post_id": 39620558, "comment_id": 66547108, "body": "It would help to see the actual commands that generated the errors... but it looks like either you&#39;re not linking to the libraries you use, or they&#39;re not built for x86_64"}, {"owner": {"reputation": 599, "user_id": 5227674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yJ0RF.png?s=128&g=1", "display_name": "Marcel T", "link": "https://stackoverflow.com/users/5227674/marcel-t"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1474527143, "post_id": 39620558, "comment_id": 66568905, "body": "That could be possible for the fast methods, (which are in my project folder) but when I build openCV I configured cmake that it will be build for x86_64"}], "answers": [{"comments": [{"owner": {"reputation": 599, "user_id": 5227674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yJ0RF.png?s=128&g=1", "display_name": "Marcel T", "link": "https://stackoverflow.com/users/5227674/marcel-t"}, "edited": false, "score": 0, "creation_date": 1474526514, "post_id": 39622615, "comment_id": 66568589, "body": "EDIT: Ok I added the Linker flags from an opencv tutorial and now I only get the errors with the fast Methods. I checked if &quot;Always Search User Paths&quot; is ob Yes. The Fast methods and Header are included in my Project Folder. I will add the .h File into my Question probably there is sth. wrong?"}, {"owner": {"reputation": 599, "user_id": 5227674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yJ0RF.png?s=128&g=1", "display_name": "Marcel T", "link": "https://stackoverflow.com/users/5227674/marcel-t"}, "edited": false, "score": 0, "creation_date": 1474527943, "post_id": 39622615, "comment_id": 66569324, "body": "In the compile sources there are the .c files from fast."}], "tags": [], "owner": {"reputation": 491, "user_id": 5447209, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--8IGIth8-YM/AAAAAAAAAAI/AAAAAAAAAIQ/pVr6l_vI1hk/photo.jpg?sz=128", "display_name": "Jvinniec", "link": "https://stackoverflow.com/users/5447209/jvinniec"}, "is_accepted": true, "score": 2, "last_activity_date": 1474477754, "creation_date": 1474477754, "answer_id": 39622615, "question_id": 39620558, "link": "https://stackoverflow.com/questions/39620558/xcode-build-failed-undefined-symbols-for-architecture-x86-64/39622615#39622615", "title": "XCode Build Failed &quot;undefined Symbols for architecture x86_64&quot;", "body": "<p>It sounds as though you've only add the header search paths for these dependencies under your projects \"Build Settings\" -> \"Search Paths\" -> \"User Header Search Paths\" field. This will enable xcode to know that these classes exist while you are developing, but wont enable your project to build. You should also make sure that your project knows where to find the libraries where the openCV and fast9 symbols you're using are defined (i.e. where the <code>.so</code> files are for these two dependencies). You can do this by adding the appropriate linker flags under \"Build Settings\" -> \"Linking\" -> \"Other Linker Flags\". ALSO make sure that these fields are set for the TARGET you are trying to compile, not just the PROJECT.</p>\n\n<p>If you arent sure what the linker flags are, here is a brief example. I want to link the following library:</p>\n\n<p><code>/path/to/some/project/lib/libfoo.so</code></p>\n\n<p>I would add the following to the \"Other Linker Flags\" field:</p>\n\n<p><code>-L/path/to/some/project/lib -lfoo</code></p>\n\n<p>Basically <code>-L</code> precedes the directory and <code>-l</code> precedes the name of the library without the 'lib' and '.so'.</p>\n\n<p>Note: Whenever I include external dependencies in my xcode projects I also set \"Build Settings\" -> \"Search Paths\" -> \"Always Search User Paths\" to \"Yes\" just in case any of the dependencies include headers with angle brackets like <code>#include &lt;header.h&gt;</code>.</p>\n"}], "owner": {"reputation": 599, "user_id": 5227674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yJ0RF.png?s=128&g=1", "display_name": "Marcel T", "link": "https://stackoverflow.com/users/5227674/marcel-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1867, "favorite_count": 0, "accepted_answer_id": 39622615, "answer_count": 1, "score": 0, "last_activity_date": 1474532785, "creation_date": 1474471167, "last_edit_date": 1474532785, "question_id": 39620558, "link": "https://stackoverflow.com/questions/39620558/xcode-build-failed-undefined-symbols-for-architecture-x86-64", "title": "XCode Build Failed &quot;undefined Symbols for architecture x86_64&quot;", "body": "<p><strong>SOLVED: FOR OPENCV SOLUTION LOOK UP ANSWER FROM Jvinniec FOR THE FAST.H SOLUTION LOOK UP EDIT</strong></p>\n\n<p>I looked up several similar Questions and did not find a Solution for my Code yet. The error I get looks like this:</p>\n\n<pre><code>Undefined symbols for architecture x86_64:\n\"fast9_score(unsigned char const*, int, xy*, int, int)\", referenced from:\n  detectCornersFast(unsigned char const*, int, int, int, int, int*) in main.o\n\"fast9_detect(unsigned char const*, int, int, int, int, int*)\", referenced from:\n  detectCornersFast(unsigned char const*, int, int, int, int, int*) in main.o\n\"nonmax_suppression(xy const*, int const*, int, int*)\", referenced from:\n  detectCornersFast(unsigned char const*, int, int, int, int, int*) in main.o\n\"cv::namedWindow(cv::String const&amp;, int)\", referenced from:\n  _main in main.o\n\"cv::GaussianBlur(cv::_InputArray const&amp;, cv::_OutputArray const&amp;, cv::Size_&lt;int&gt;, double, double, int)\", referenced from:\n  _main in main.o\n\"cv::Mat::deallocate()\", referenced from:\n  cv::Mat::release() in main.o\n\"cv::Mat::copySize(cv::Mat const&amp;)\", referenced from:\n  cv::Mat::operator=(cv::Mat const&amp;) in main.o\n  cv::Mat::Mat(cv::Mat const&amp;) in main.o\n\"cv::String::deallocate()\", referenced from:\n  cv::String::~String() in main.o\n\"cv::String::allocate(unsigned long)\", referenced from:\n  cv::String::String(char const*) in main.o\n  cv::String::String(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;) in main.o\n\"cv::imread(cv::String const&amp;, int)\", referenced from:\n  _main in main.o\n\"cv::imshow(cv::String const&amp;, cv::_InputArray const&amp;)\", referenced from:\n  _main in main.o\n\"cv::resize(cv::_InputArray const&amp;, cv::_OutputArray const&amp;, cv::Size_&lt;int&gt;, double, double, int)\", referenced from:\n  _main in main.o\n\"cv::waitKey(int)\", referenced from:\n  _main in main.o\n\"cv::fastFree(void*)\", referenced from:\n  cv::Mat::~Mat() in main.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>The Architecture I am using in XCode is Universal. I builded and added the search paths for openCV and the fast9 Methods are in the fast.h header. I tried to delete the derived data of the Project but nothing helped. Here my Code of the main.cpp:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n#include &lt;string&gt;\n#include \"opencv2/opencv.hpp\"\n#include \"fast.h\"\n\nusing namespace std;\nusing namespace cv;\n\ntypedef unsigned char byte;\n\nMat src; Mat dst; Mat tmp;\nint rows; int cols;\nbyte* image;\nxy* nonmax;\n\nbyte * matToBytes(Mat image){\n\nint size = image.total() * image.elemSize();\nbyte * bytes = new byte[size];\nstd::memcpy(bytes, image.data, size * sizeof(byte));\n\nreturn bytes;\n\n}\n\nxy* detectCornersFast(const byte* im, int xsize, int ysize, int stride, int b, int* ret_num_corners){\n\nxy* corners;\nint num_corners; \nint* scores;    \nxy* nonmax;\n\ncorners = fast9_detect(im, xsize, ysize, stride, b, &amp;num_corners); \nscores = fast9_score(im, stride, corners, num_corners, b);    \nnonmax = nonmax_suppression(corners, scores, num_corners, ret_num_corners);\n\nfree(corners);   \nfree(scores);\n\nreturn nonmax;\n\n}\n\nint main(int argc, const char * argv[]) {\n\n// insert code here...\n\nvector&lt;Mat&gt; img; \nvector&lt;int&gt; num_corners;\nvector&lt;xy*&gt; nms;\n\nsrc = imread(argv[1],1);\n\nimg.push_back(src);\ndouble factor = sqrt(2);\n\nfor(int i = 0; i &lt; 5; i++){  \n\n    int ret_num_corners;\n    rows = src.rows/factor;\n    cols = src.cols/factor;\n\n    resize(src, tmp, Size(rows,cols),0,0, INTER_NEAREST);\n\n    GaussianBlur(tmp, dst, Size(5,5),0,0);\n\n    image = matToBytes(dst);\n\n    nonmax = detectCornersFast(image, tmp.rows, tmp.cols, tmp.rows, 20, &amp;ret_num_corners);\n\n    img.push_back(dst);\n    nms.push_back(nonmax);\n    num_corners.push_back(ret_num_corners);\n\n    src = dst;\n\n}\n\nfor(int i = 0; i &lt;img.size(); i++){\n\n    string name = \"Display Window \" + std::to_string(i);\n    cout &lt;&lt; \"Number of Corners\" &lt;&lt; num_corners[i] &lt;&lt; endl;\n    cout &lt;&lt; \"Nonmax Supression\" &lt;&lt; nms[i] &lt;&lt; endl;\n    namedWindow(name, WINDOW_AUTOSIZE); \n    imshow(name, img[i]);  \n}\n\nwaitKey();\nreturn 0; \n}\n</code></pre>\n\n<p><strong>EDIT:</strong>\nFor OpenCV helped to add the Linker Flags from this Tutorial: <a href=\"https://www.youtube.com/watch?v=XJeP1juuHHY\" rel=\"nofollow\">OpenCV</a>\nThe Methods from fast are in a .c File which is in my Project Folder. Also the .h file is there. I just post the .h File here because .c File is far too long because its mechanically generated.</p>\n\n<p><strong>SOLUTION:</strong>\nIt was my Mistake with the fast methods. I totally forgot to add <code>Extern \"C\" {}</code> in the main.cpp at the <code>#include \"fast.h\"</code>because it calls C files and not C++ Files.</p>\n\n<p>fast.h</p>\n\n<pre><code>#ifndef FAST_H\n#define FAST_H\n\ntypedef struct { int x, y; } xy; \ntypedef unsigned char byte;\n\nint fast9_corner_score(const byte* p, const int pixel[], int bstart);\n\nxy* fast9_detect(const byte* im, int xsize, int ysize, int stride, int b, int* ret_num_corners);\n\nint* fast9_score(const byte* i, int stride, xy* corners, int num_corners, int b);\n\nxy* fast9_detect_nonmax(const byte* im, int xsize, int ysize, int stride, int b, int* ret_num_corners);\n\nxy* nonmax_suppression(const xy* corners, const int* scores, int num_corners, int* ret_num_nonmax);\n\n#endif\n</code></pre>\n"}, {"tags": ["c++", "tensorflow"], "answers": [{"comments": [{"owner": {"reputation": 3292, "user_id": 2709093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042262218/picture?type=large", "display_name": "James K", "link": "https://stackoverflow.com/users/2709093/james-k"}, "edited": false, "score": 0, "creation_date": 1474645829, "post_id": 39664725, "comment_id": 66631368, "body": "Try to include more than a link. While linking to the docs is useful, write your answer in such a way that it can stand alone"}], "tags": [], "owner": {"reputation": 44, "user_id": 6871313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6mb1O.png?s=128&g=1", "display_name": "Rasmus Munk Larsen", "link": "https://stackoverflow.com/users/6871313/rasmus-munk-larsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1474645249, "creation_date": 1474645249, "answer_id": 39664725, "question_id": 39620501, "link": "https://stackoverflow.com/questions/39620501/how-to-iterate-over-the-rows-columns-and-planes-of-a-tensor/39664725#39664725", "title": "How to iterate over the rows, columns and planes of a tensor?", "body": "<p>The Eigen Tensor library is documented ate the bottom of this page:</p>\n\n<p><a href=\"https://bitbucket.org/eigen/eigen/src/f6382682565c946d46612fe0e36e486bba1371ce/unsupported/Eigen/CXX11/src/Tensor/?at=default\" rel=\"nofollow\">https://bitbucket.org/eigen/eigen/src/f6382682565c946d46612fe0e36e486bba1371ce/unsupported/Eigen/CXX11/src/Tensor/?at=default</a></p>\n\n<p>From your question, I think you'll want to look at the chip and slice operations.</p>\n"}], "owner": {"reputation": 5371, "user_id": 72784, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d7f633334011a5923b4dc743075b57eb?s=128&d=identicon&r=PG", "display_name": "piotr", "link": "https://stackoverflow.com/users/72784/piotr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 39664725, "answer_count": 1, "score": 5, "last_activity_date": 1474645249, "creation_date": 1474471039, "last_edit_date": 1474471232, "question_id": 39620501, "link": "https://stackoverflow.com/questions/39620501/how-to-iterate-over-the-rows-columns-and-planes-of-a-tensor", "title": "How to iterate over the rows, columns and planes of a tensor?", "body": "<p>I'm trying to iterate over the output tensor in a custom operator. So far I only see the approach to flatten the tensor and iterate over it.</p>\n\n<p>Is there a better way so I can iterate over the rows, columns and planes?</p>\n\n<pre><code>auto output = output_tensor-&gt;flat&lt;float&gt;();\n\n// I would like to iterate through the dimensions here\nconst int N = output.size();\nfor (int i = 0; i &lt; N; i++) {\n   output(i) = 0;\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "qt"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1474474731, "post_id": 39620362, "comment_id": 66549121, "body": "Why are you checking if queue is empty by polling? The standard way to have a queue like that is to use condition variable, in Qt&#39;s case <a href=\"http://doc.qt.io/qt-5/qwaitcondition.html\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qwaitcondition.html</a>"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1474474956, "post_id": 39620362, "comment_id": 66549255, "body": "About read-write lock, what do you think is &quot;reading&quot; in your use case? Note that taking an item from queue is &quot;writing&quot; (queue is modified)."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1474475166, "post_id": 39620362, "comment_id": 66549381, "body": "About Qt threading, even if you override <code>QThread</code> (which I think is reasonable if you want to have your own queue), I would advice putting all code which is intended to run in the thread in it&#39;s own separate classes, so that only thing in the <code>QThread</code> subcalss which runs in the thread is the <code>run()</code> method. This is because <code>QThread</code> object itself does not live in the thread it controls, and it can get difficult to separate code and variables which are meant to run in a specific thread, or which are supposed to be thread safe."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1474475361, "post_id": 39620362, "comment_id": 66549497, "body": "About <code>enqueueRecord</code>, if your <code>run()</code> method does not call it directly or indirectly, then it is not called in that thread. It doesn&#39;t get magically called by itself!"}, {"owner": {"reputation": 2952, "user_id": 3200088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/WlD9X.jpg?s=128&g=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/3200088/gio"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1474475711, "post_id": 39620362, "comment_id": 66549666, "body": "@hyde, Thx for your comments, this make it a bit more clear. Regarding reading / writing; With reading I refer to getting items from the queue, with writing putting items on the queue."}, {"owner": {"reputation": 25560, "user_id": 2068642, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/DYTnZ.jpg?s=128&g=1", "display_name": "TheDarkKnight", "link": "https://stackoverflow.com/users/2068642/thedarkknight"}, "edited": false, "score": 0, "creation_date": 1474532085, "post_id": 39620362, "comment_id": 66571916, "body": "QThread is more like a thread controller. Unless you want to change how threading works in Qt, you&#39;d be better off not inheriting from QThread. A great example of how to use this class is described <a href=\"https://mayaposch.wordpress.com/2011/11/01/how-to-really-truly-use-qthreads-the-full-explanation/\" rel=\"nofollow noreferrer\">here</a>."}], "owner": {"reputation": 2952, "user_id": 3200088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/WlD9X.jpg?s=128&g=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/3200088/gio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 731, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474470674, "creation_date": 1474470674, "question_id": 39620362, "link": "https://stackoverflow.com/questions/39620362/qt-threading-ensuring-order-of-message-queue-dequeue-and-understanding-thread", "title": "Qt threading, ensuring order of message queue / dequeue and understanding thread space", "body": "<p>I'm practicing with Qt (5.5) threads. In the example below the order in which messages are queued / dequeued is of importance. My idea is to create a ProducerThread intance, initalised to a member of a different class. Through this member calls will be made to <code>ProducerThread::enqueRecord</code> in order to enqueue messages to the ProducerThread's member queue which is of Qt's type <code>QQueue</code>.</p>\n\n<p>I have the following two questions:</p>\n\n<p>(1) I'm thinking about ensuring the order in which messages are queued / dequeued by making use of a <code>QReadWriteLock</code>. Is this the recommended approach?</p>\n\n<p>(2) I'm not sure if the calls to enqueueRecord are executed on the main application's thread or on the ProducerThread. As explained above, I was thinking of creating an initializing a class member with an instance of ProducerThread, and then I will call make calls to the enqueueRecord method through that member.</p>\n\n<pre><code>ProducerThread::ProducerThread(QObject *parent):\n    _parent(parent)\n    _running(false);\n{\n    //..\n}\n\nProducerThread::~ProducerThread()\n{\n    //..\n}\n\nvoid ProducerThread::enqueueRecord(QString record)\n{\n    queue.enqueue();\n    if (!_running) {\n        start();\n    }\n}\n\nProducerThread::run()\n{\n    _running = true;\n    while (!recordQueue.isEmpty()) {\n        qDebug() &lt;&lt; recordQueue.dequeue(); // TODO\n        QThread::msleep(1000);\n    }\n    _running = false;\n}\n</code></pre>\n"}, {"tags": ["c++", "gcc", "x11", "xlib"], "answers": [{"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 8, "last_activity_date": 1589349789, "last_edit_date": 1589349789, "creation_date": 1474474942, "answer_id": 39621778, "question_id": 39620150, "link": "https://stackoverflow.com/questions/39620150/xdrawstring-incorrect-encoding/39621778#39621778", "title": "XDrawString incorrect encoding", "body": "<p>X11 predates Unicode by several millennia (in Internet years). Your program probably uses UTF-8, and X11 by default does not. Try <a href=\"https://linux.die.net/man/3/xutf8drawstring\" rel=\"nofollow noreferrer\">Xutf8DrawString</a>.</p>\n\n<p>Alternatively, figure out which encodings your fonts use (xlsfonts will tell you, because the encoding is a part of XLFD, but it looks like KOI8-R to me) and use that encoding for your string.</p>\n\n<p>It should be noted that real programs rarely use server-side fonts these days. See <a href=\"https://www.x.org/wiki/guide/fonts/#index2h2\" rel=\"nofollow noreferrer\">this</a> for more info.</p>\n"}], "owner": {"reputation": 174, "user_id": 1378713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abea6af5522216c7550394f9855e6f83?s=128&d=identicon&r=PG", "display_name": "dima.rus", "link": "https://stackoverflow.com/users/1378713/dima-rus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1589349789, "creation_date": 1474470081, "question_id": 39620150, "link": "https://stackoverflow.com/questions/39620150/xdrawstring-incorrect-encoding", "title": "XDrawString incorrect encoding", "body": "<p>I want to display cyrillic symbols with <code>XDrawString()</code>, but on screen they are shown in wrong encoding.</p>\n\n<p>I have installed <code>xfonts-cyrillic</code> in my system (ubuntu 14.04), but still any font from <code>xlsfonts</code> list shows wrong result.</p>\n\n<p>My code (main.cpp):</p>\n\n<pre><code>#include &lt;X11/Xlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int, char**)\n{\n    Display *d = XOpenDisplay(0);\n    Window r = DefaultRootWindow(d);\n    Window w = XCreateSimpleWindow(d, r, 0, 0, 256, 256, 0, 0, 0xffffff);\n    GC gc = DefaultGC(d, 0);\n\n    XMapRaised(d, w);\n    XSelectInput(d, w, ExposureMask);\n\n    Font font = XLoadFont(d, \"9x15-cyrillic\");\n    XSetFont(d, gc, font);\n\n    const char *msg = \"\u0442\u0443\u0442 \u0442\u0435\u043a\u0441\u0442\"; // cyrillic symbols\n\n    while (1)\n    {\n        XEvent e;\n        XNextEvent(d, &amp;e);\n        XDrawString(d, w, gc, 16, 16, msg, (int) strlen(msg));\n    }\n}\n</code></pre>\n\n<p>Compile:</p>\n\n<pre><code>g++ -Wall -g -std=c++11 main.cpp -L/usr/lib/X11 -lX11 -o output\n</code></pre>\n\n<p>My result is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9l9tk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9l9tk.png\" alt=\"enter image description here\"></a></p>\n\n<p>Why in result window text is in wrong encoding? What I'm missing?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 3, "creation_date": 1474469971, "post_id": 39620085, "comment_id": 66546034, "body": "What is <code>vptr</code>?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 3, "creation_date": 1474470019, "post_id": 39620085, "comment_id": 66546065, "body": "Yes, the compiler is responsible for implementing the language rules. The rules say how member function calls are to be dispatched. So the compiler has to generate code that effects those dispatch rules."}], "answers": [{"tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 2, "last_activity_date": 1474472537, "last_edit_date": 1474472537, "creation_date": 1474472101, "answer_id": 39620906, "question_id": 39620085, "link": "https://stackoverflow.com/questions/39620085/how-exactly-does-c-runtime-use-the-vptr-to-choose-the-right-function-who-takes/39620906#39620906", "title": "How exactly does C++ runtime use the vptr to choose the right function.Who takes care of this?", "body": "<p>Consider code something like this:</p>\n\n<pre><code>class A {\n    int x;\npublic:\n    virtual void foo() { std::cout &lt;&lt; \"base::foo()\\n\"; }\n    virtual void bar() = 0;\n    virtual ~A() {}\n};\n\nclass B : public A {\n    int y;\npublic: \n    virtual void bar() { std::cout &lt;&lt; \"Derived::bar()\"; }\n    virtual void baz() { std::cout &lt;&lt; \"Added function\"; }\n};\n\nint main() { \n    A a;\n    B b;\n}\n</code></pre>\n\n<p>This is going to result in a layout something on this general order:</p>\n\n<p><a href=\"https://i.stack.imgur.com/awACu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/awACu.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, each object contains its own copy of the object's data, which is an amalgamation of all the data defined in that class and all its base classes. When it contains at least one virtual function, it has a vtable pointer. That points to a table somewhere in the generated code. That table, in turn, contains pointers to the virtual functions for the class. The key to this working is that (for virtual functions that are common between them) the base class and derived class store those pointers at the same offsets in the vtable. When you invoke a virtual function, the compiler generates code to \"chase\" the vtable pointer, then invoke the function at the right offset in the vtable.</p>\n\n<p>Although it's not shown directly here, when each member function (virtual or otherwise) is called, the address of the variable is typically passed as a hidden parameter that's named <code>this</code> inside the function. References to members can use <code>this</code> implicitly (so an assignment like <code>somember=a;</code> is really equivalent to <code>this-&gt;somemember = a;</code>).</p>\n\n<p>Note: this is depicting how things are <em>typically</em> done--at least in theory, an implementation is free to do things entirely differently, as long as what it does meets the requirements in the standard. That said, every implementation of which I'm aware works <em>fairly</em> similarly.</p>\n"}], "owner": {"reputation": 29, "user_id": 2291793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c51a1b68d97d9d9252eea9324bd852f7?s=128&d=identicon&r=PG", "display_name": "shrabana kumar", "link": "https://stackoverflow.com/users/2291793/shrabana-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1474472537, "creation_date": 1474469940, "question_id": 39620085, "link": "https://stackoverflow.com/questions/39620085/how-exactly-does-c-runtime-use-the-vptr-to-choose-the-right-function-who-takes", "title": "How exactly does C++ runtime use the vptr to choose the right function.Who takes care of this?", "body": "<p>I am confused how vptr resolves virtual function call at run time if there are more virtual functions in a class. Who takes care of that. And who creates vtable . is it compiler?</p>\n"}, {"tags": ["android", "c++", "xamarin", "visual-studio-2015", "tango"], "comments": [{"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1474471738, "post_id": 39620084, "comment_id": 66547215, "body": "<a href=\"https://github.com/dannyyy/GoogleProjectTangoBinding\" rel=\"nofollow noreferrer\">github.com/dannyyy/GoogleProjectTangoBinding</a>"}, {"owner": {"reputation": 11, "user_id": 6858845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bc885451ac08a0e19ac6e3b33bb24e?s=128&d=identicon&r=PG&f=1", "display_name": "XiaoHouZi", "link": "https://stackoverflow.com/users/6858845/xiaohouzi"}, "reply_to_user": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1474531801, "post_id": 39620084, "comment_id": 66571738, "body": "A very useful link, thanks, but not appropriate to my question as it is a c# package not native code in c++."}], "owner": {"reputation": 11, "user_id": 6858845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bc885451ac08a0e19ac6e3b33bb24e?s=128&d=identicon&r=PG&f=1", "display_name": "XiaoHouZi", "link": "https://stackoverflow.com/users/6858845/xiaohouzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1474469934, "creation_date": 1474469934, "question_id": 39620084, "link": "https://stackoverflow.com/questions/39620084/connect-project-tango-library-so-in-visual-studio-xamarin-project", "title": "connect project tango library .so in visual studio xamarin project", "body": "<p>i am trying to write an app for the Google Tango device using Xamarin in VS2015.  I have created the native activity and put in the basic tango config and connect to service code.  I added the tango libraries in the project settings so intellisense likes it but, the build gives me an error:</p>\n\n<p>undefined reference to 'TangoService_connect'   d:\\Documents\\Visual Studio 2015\\Projects\\Android3\\Android3\\Android3.NativeActivity\\CCActivity.cpp   </p>\n\n<p>the C API comes with a .h and three folder for the various arch's (ARM, x86) containing .so files, and I guess these are not correctly referenced in the settings, how do I do this?</p>\n"}, {"tags": ["c++", "gdb"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 2678087, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100004078764575/picture?type=large", "display_name": "Dmitry  Bakhtiyarov", "link": "https://stackoverflow.com/users/2678087/dmitry-bakhtiyarov"}, "edited": false, "score": 0, "creation_date": 1474472908, "post_id": 39620444, "comment_id": 66547978, "body": "Looks like that using <code>_GLIBCXX_USE_CXX11_ABI</code> in my code also require using it for all dependent libraries :-(  Second workarounds don&#39;t work - my gdb v7.11 crashed at calling quote-enclosing function name"}], "tags": [], "owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "is_accepted": true, "score": 5, "last_activity_date": 1474470893, "creation_date": 1474470893, "answer_id": 39620444, "question_id": 39620026, "link": "https://stackoverflow.com/questions/39620026/gdb-cant-call-function/39620444#39620444", "title": "gdb can&#39;t call function", "body": "<p>gdb does not yet support C++11 ABI tags introduced in gcc 5. See these bugs:</p>\n\n<ul>\n<li><a href=\"https://sourceware.org/bugzilla/show_bug.cgi?id=19436\" rel=\"noreferrer\">https://sourceware.org/bugzilla/show_bug.cgi?id=19436</a></li>\n<li><a href=\"https://sourceware.org/bugzilla/show_bug.cgi?id=18601\" rel=\"noreferrer\">https://sourceware.org/bugzilla/show_bug.cgi?id=18601</a></li>\n</ul>\n\n<p>The simplest workaround for you is probably to disable new gcc ABI by defining the macro <code>_GLIBCXX_USE_CXX11_ABI</code> to 0, see <a href=\"https://gcc.gnu.org/gcc-5/changes.html#libstdcxx\" rel=\"noreferrer\">https://gcc.gnu.org/gcc-5/changes.html#libstdcxx</a>.</p>\n\n<p>Or alternatively you can try to apply workarounds from <a href=\"https://sourceware.org/bugzilla/show_bug.cgi?id=18601#c1\" rel=\"noreferrer\">https://sourceware.org/bugzilla/show_bug.cgi?id=18601#c1</a> though they look a bit weird.</p>\n"}], "owner": {"reputation": 181, "user_id": 2678087, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100004078764575/picture?type=large", "display_name": "Dmitry  Bakhtiyarov", "link": "https://stackoverflow.com/users/2678087/dmitry-bakhtiyarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 932, "favorite_count": 0, "accepted_answer_id": 39620444, "answer_count": 1, "score": 1, "last_activity_date": 1474470893, "creation_date": 1474469808, "question_id": 39620026, "link": "https://stackoverflow.com/questions/39620026/gdb-cant-call-function", "title": "gdb can&#39;t call function", "body": "<p>I have some problems with debugging my app - when I try to call parser::extractString(...) from gdb shell it return </p>\n\n<blockquote>\n  <p>No symbol \"extractString\" in namespace \"parser\".</p>\n</blockquote>\n\n<p>When I execute</p>\n\n<blockquote>\n  <p>info functions extractString</p>\n</blockquote>\n\n<p>I have this output</p>\n\n<blockquote>\n  <p>All functions matching regular expression \"extractString\":</p>\n  \n  <p>File /home/dmitriy/Sources/transceiver/parser/json.cpp:\n  std::__cxx11::string\n  parser::extractString[abi:cxx11](rapidjson::GenericValue,\n  parser::MultithreadAllocator> const&amp;);</p>\n  \n  <p>Non-debugging symbols: 0x0000000000506500 \n  parser::extractString[abi:cxx11](rapidjson::GenericValue,\n  parser::MultithreadAllocator> const&amp;)@plt 0x00007ffff77e3640 \n  parser::extractString[abi:cxx11](rapidjson::GenericValue,\n  parser::MultithreadAllocator> const&amp;)@plt</p>\n</blockquote>\n\n<p>What is the problem with calling this function? Function extractString defined in static library and called from the application without any problem. </p>\n"}, {"tags": ["c++", "c++11", "c++14"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1474469830, "post_id": 39619976, "comment_id": 66545930, "body": "Another option is to have the loop depend on a global variable (<code>bool keep-running</code>) instead of being an infinite loop. Globals are generally bad practice, but in a case like this, they&#39;ll probably lead to cleaner code than the alternative."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1474469855, "post_id": 39619976, "comment_id": 66545943, "body": "Sounds like you need a condition variable.  The function that keeps running checks the variable and if it is true then the function returns, otherwise it keeps running.  Then you just need to set the variable when you wan the threads to end."}, {"owner": {"reputation": 21, "user_id": 4596571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195e7e5446ca41b200ad28295849233e?s=128&d=identicon&r=PG&f=1", "display_name": "JOOF", "link": "https://stackoverflow.com/users/4596571/joof"}, "edited": false, "score": 0, "creation_date": 1474470383, "post_id": 39619976, "comment_id": 66546307, "body": "the problem is the method I&#39;m calling doesn&#39;t have a while(1) and I can&#39;t check for the variable in the middle of t like this and I want it to be abstracted from print method."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1474472386, "post_id": 39619976, "comment_id": 66547635, "body": "@JOOF: This sounds very much like an XY problem. What are you trying to do that you think asynchronous termination of a function is a reasonable solution?"}, {"owner": {"reputation": 21, "user_id": 4596571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195e7e5446ca41b200ad28295849233e?s=128&d=identicon&r=PG&f=1", "display_name": "JOOF", "link": "https://stackoverflow.com/users/4596571/joof"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1474473263, "post_id": 39619976, "comment_id": 66548199, "body": "@NicolBolas I have a system that gets input every 16ms and I want to do a processing on it and say if the processing took more than about 13ms leave it and go do a backup plan. and I want it to be abstracted from the ones who write the processing method."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1474473625, "post_id": 39619976, "comment_id": 66548465, "body": "You sorta can do this with pthreads (pthread_kill and pthread_exit from the signal handler), but you are very restricted about what you can do in the thread you exit this way. Calling anything from the standard library is probably out. Don&#39;t even think about doing this with C++ threads."}, {"owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "edited": false, "score": 0, "creation_date": 1474474614, "post_id": 39619976, "comment_id": 66549056, "body": "If one thinks deeper, this question is a nice one. It will be difficult even to implement with a conditional variable."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1474480522, "post_id": 39619976, "comment_id": 66552323, "body": "@JOOF: Put that information in your question. Also, that&#39;s not possible."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1474490536, "post_id": 39619976, "comment_id": 66557716, "body": "Have you considered doing the backup and primary plan, with the primary plan in a different thread.  If the primary plan hasn&#39;t delivered a result within the time frame you need, you use the already-computed backup plan?"}, {"owner": {"reputation": 21, "user_id": 4596571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195e7e5446ca41b200ad28295849233e?s=128&d=identicon&r=PG&f=1", "display_name": "JOOF", "link": "https://stackoverflow.com/users/4596571/joof"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1474620359, "post_id": 39619976, "comment_id": 66615133, "body": "@Yakk yes I have. But I need to call the primary plan every 16milliseconds. Then there could be lots of threads computing the result i dont need and it decreases the performance of the program"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4596571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195e7e5446ca41b200ad28295849233e?s=128&d=identicon&r=PG&f=1", "display_name": "JOOF", "link": "https://stackoverflow.com/users/4596571/joof"}, "edited": false, "score": 0, "creation_date": 1474470775, "post_id": 39620249, "comment_id": 66546598, "body": "the problem is the deadline is 16millisecondes and I want it to be efficient and the function I&#39;m calling is heavy &amp; I&#39;m doing it every 16milliseconds!"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 0, "last_activity_date": 1474470434, "creation_date": 1474470434, "answer_id": 39620249, "question_id": 39619976, "link": "https://stackoverflow.com/questions/39619976/how-to-stop-a-function-from-running-from-outside-in-c/39620249#39620249", "title": "How to stop a function from running from outside in c++", "body": "<p>Here are two and 3/4 approaches.</p>\n\n<p>The first requires that the code you want to halt cooperates.  It either polls some variable while it runs, or it calls a function periodically that could throw an exception to halt execution.  <code>boost</code> interruptable threads follow the second model.</p>\n\n<p>The second requires you to launch a new process, marshall your data over to the function, and use IPC to get the information back.  If the function doesn't return in time, you kill the child process.</p>\n\n<p>The third \"half\" involves rewriting the code in a different language, or using C++ as a scripting language.  You run the code in an interpreter that does the first or second solution for you.</p>\n\n<hr>\n\n<p>Now, a practical alternative (a 1/4 solution) is to make sure the function is purely functional, run it in a separate thread with a semi-reliable abort message (like the first one), and discard its return value if it takes too long.  This doesn't do what you want, but is far easier.</p>\n"}, {"comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 1, "creation_date": 1474470906, "post_id": 39620366, "comment_id": 66546672, "body": "This will still keep the <code>std::async</code> alive even after the timeout expires though, the main thread will just continue."}, {"owner": {"reputation": 21, "user_id": 4596571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195e7e5446ca41b200ad28295849233e?s=128&d=identicon&r=PG&f=1", "display_name": "JOOF", "link": "https://stackoverflow.com/users/4596571/joof"}, "edited": false, "score": 0, "creation_date": 1474471096, "post_id": 39620366, "comment_id": 66546787, "body": "but how can I end the running function?"}, {"owner": {"reputation": 993, "user_id": 6858837, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f56ccb5125aaaad6dd7bb752be8f3494?s=128&d=identicon&r=PG&f=1", "display_name": "Trevir", "link": "https://stackoverflow.com/users/6858837/trevir"}, "edited": false, "score": 0, "creation_date": 1474471384, "post_id": 39620366, "comment_id": 66546975, "body": "Well, there is no save way to cancel the thread from outside once started. What is possible to include a cancellation flag in the startup, outlined in <a href=\"http://stackoverflow.com/a/33315162/6858837\">stackoverflow.com/a/33315162/6858837</a>."}, {"owner": {"reputation": 21, "user_id": 4596571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195e7e5446ca41b200ad28295849233e?s=128&d=identicon&r=PG&f=1", "display_name": "JOOF", "link": "https://stackoverflow.com/users/4596571/joof"}, "edited": false, "score": 0, "creation_date": 1474471834, "post_id": 39620366, "comment_id": 66547273, "body": "problem is with my deadline. its 16millisecons and I can&#39;t delay in finishing it"}], "tags": [], "owner": {"reputation": 993, "user_id": 6858837, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f56ccb5125aaaad6dd7bb752be8f3494?s=128&d=identicon&r=PG&f=1", "display_name": "Trevir", "link": "https://stackoverflow.com/users/6858837/trevir"}, "is_accepted": false, "score": 2, "last_activity_date": 1474472120, "last_edit_date": 1474472120, "creation_date": 1474470677, "answer_id": 39620366, "question_id": 39619976, "link": "https://stackoverflow.com/questions/39619976/how-to-stop-a-function-from-running-from-outside-in-c/39620366#39620366", "title": "How to stop a function from running from outside in c++", "body": "<p>I think your are looking for something like std::future.</p>\n\n<p><a href=\"http://en.cppreference.com/w/cpp/thread/future/wait_for\" rel=\"nofollow\">http://en.cppreference.com/w/cpp/thread/future/wait_for</a></p>\n\n<p>You can start the function in another thread and wait until the function returns or has a timeout. </p>\n\n<p>For your example:</p>\n\n<pre><code>std::future&lt; void &gt; future = std::async( std::launch::async, print );\n\nauto status = future.wait_for( std::chrono::seconds( 10 ) );\nif ( status == std::future_status::deferred )\n{\n    std::cout &lt;&lt; \"deferred\\n\";\n}\nelse if ( status == std::future_status::timeout )\n{\n    std::cout &lt;&lt; \"timeout\\n\";\n}\nelse if ( status == std::future_status::ready )\n{\n    std::cout &lt;&lt; \"ready!\\n\";\n}\n</code></pre>\n\n<p>However this doesn't cause the detached thread to end. For this it is necessary to include a flag on startup, so the detached thread can cleanup and exit savely on its own. </p>\n\n<pre><code>void run(const std::atomic_bool&amp; cancelled)\n{\n    int a;\n    for (int i = 0; i &lt; 2000; i++)\n    {\n        cout &lt;&lt; i &lt;&lt; endl;\n        if (cancelled)\n            return;\n    }\n}\n\nstd::atomic_bool cancellation_token = false;\nstd::future&lt; void &gt; future = std::async( std::launch::async, \n                                         run,\n                                         std::ref(cancellation_token) );\n\nauto status = future.wait_for( std::chrono::seconds( 10 ) );\nif ( status == std::future_status::deferred )\n{\n    std::cout &lt;&lt; \"deferred\\n\";\n}\nelse if ( status == std::future_status::timeout )\n{\n    std::cout &lt;&lt; \"timeout\\n\";\n    cancellation_token = true;\n}\nelse if ( status == std::future_status::ready )\n{\n    std::cout &lt;&lt; \"ready!\\n\";\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 4596571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195e7e5446ca41b200ad28295849233e?s=128&d=identicon&r=PG&f=1", "display_name": "JOOF", "link": "https://stackoverflow.com/users/4596571/joof"}, "edited": false, "score": 0, "creation_date": 1474471357, "post_id": 39620490, "comment_id": 66546953, "body": "I want the print method ends exactly after I&#39;m telling it. and the print function was just an example"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 21, "user_id": 4596571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195e7e5446ca41b200ad28295849233e?s=128&d=identicon&r=PG&f=1", "display_name": "JOOF", "link": "https://stackoverflow.com/users/4596571/joof"}, "edited": false, "score": 0, "creation_date": 1474471421, "post_id": 39620490, "comment_id": 66547002, "body": "@JOOF That&#39;s not possible without terminating a <code>boost::thread</code>."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 21, "user_id": 4596571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195e7e5446ca41b200ad28295849233e?s=128&d=identicon&r=PG&f=1", "display_name": "JOOF", "link": "https://stackoverflow.com/users/4596571/joof"}, "edited": false, "score": 0, "creation_date": 1474472335, "post_id": 39620490, "comment_id": 66547604, "body": "@JOOF: How do you define &quot;exactly&quot;? You cannot end the execution of a function without that function&#39;s <i>consent</i>. Which requires you to somehow communicate with it. Which requires that function to <i>participate</i> in that communication. The only other alternative is OS thread termination."}, {"owner": {"reputation": 21, "user_id": 4596571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195e7e5446ca41b200ad28295849233e?s=128&d=identicon&r=PG&f=1", "display_name": "JOOF", "link": "https://stackoverflow.com/users/4596571/joof"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1474473402, "post_id": 39620490, "comment_id": 66548306, "body": "@NicolBolas I mean about after a short time(less than 1ms)"}], "tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": false, "score": 0, "last_activity_date": 1474471382, "last_edit_date": 1474471382, "creation_date": 1474471012, "answer_id": 39620490, "question_id": 39619976, "link": "https://stackoverflow.com/questions/39619976/how-to-stop-a-function-from-running-from-outside-in-c/39620490#39620490", "title": "How to stop a function from running from outside in c++", "body": "<p>There's a way with atomics used as semaphores but this will emit full blown memory barriers and thus decrease the performance because of the <code>load</code> every iteration :</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include &lt;chrono&gt;\n#include &lt;atomic&gt;\n\nstd::atomic&lt;bool&gt; printFinished { false };\nstd::atomic&lt;bool&gt; shouldPrintRun { true };\n\nvoid print()\n{\n    while (shouldPrintRun.load() /* &amp;&amp; your normal stop condition*/)\n    {\n        //work..\n    }\n    printFinished.store(true);\n}\n\n\nint main()\n{\n    std::thread t(print);\n    std::this_thread::sleep_for(std::chrono::seconds(10));\n    if (!printFinished.load())\n    {\n        shouldPrintRun.store(false);\n        t.join();\n        std::cout &lt;&lt; \"help!\";\n    }\n    return 0;\n}\n</code></pre>\n\n<p>If you don't want your function that's ran on another thread to check back if it needs to stop then terminating that thread is the <em>only</em> option.</p>\n"}, {"tags": [], "owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "is_accepted": false, "score": 0, "last_activity_date": 1474479003, "last_edit_date": 1474479003, "creation_date": 1474474227, "answer_id": 39621583, "question_id": 39619976, "link": "https://stackoverflow.com/questions/39619976/how-to-stop-a-function-from-running-from-outside-in-c/39621583#39621583", "title": "How to stop a function from running from outside in c++", "body": "<p>A possible solution is that you have to make that the lengthy function into small &amp; short incremental function which will continue the task still every time it is call from the last time it left of. The code below which can be run in a thread will do similar job of a time slicer and can be terminated at will. </p>\n\n<pre><code>void Process()\n{       \n    bool flag = true;\n    while (running)\n    {\n        std::chrono::high_resolution_clock::time_point time1 = std::chrono::high_resolution_clock::now();\n        std::chrono::milliseconds span(16);\n        while ( (std::chrono::high_resolution_clock::now() - time1 ) &lt; span)\n        {\n            flag ? incremental_function1() : incremental_function2();\n\n            if (!running) return;\n        }\n        flag = (!flag);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 1, "last_activity_date": 1474556125, "last_edit_date": 1474556125, "creation_date": 1474483805, "answer_id": 39624357, "question_id": 39619976, "link": "https://stackoverflow.com/questions/39619976/how-to-stop-a-function-from-running-from-outside-in-c/39624357#39624357", "title": "How to stop a function from running from outside in c++", "body": "<blockquote>\n  <p>I want it to be abstracted from the ones who write the processing method.</p>\n</blockquote>\n\n<p>Standard C++ does not have a way to forcibly interrupt the control flow of a function from outside of that function's call graph (a function it calls can throw, but someone can't throw <em>for them</em>).</p>\n\n<p>OS-specific thread systems have ways to terminate a thread. However, this leaves the program potentially in an undefined state, as the destructors for any stack variables have not been called. And since you didn't know where it was in that processing when you killed it, you can't effectively clean up after it. Even a C program cannot guarantee that an arbitrary function can be terminated; it would have to be one which did not dynamically allocate memory or other resources that have to be cleaned up.</p>\n\n<p>You can compensate for this by coding your function very carefully. But that requires that the person who wrote that function to code it <em>very carefully</em>. And thus, there isn't an abstraction, since the person writing the function has to know what the rules are and is required to follow them.</p>\n\n<p>So the only solution that works requires <em>cooperation</em>. The function must either be written in such a way that it can safely be stopped via those OS-dependent features, or it must be written to periodically check some value and stop <em>itself</em>.</p>\n"}], "owner": {"reputation": 21, "user_id": 4596571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195e7e5446ca41b200ad28295849233e?s=128&d=identicon&r=PG&f=1", "display_name": "JOOF", "link": "https://stackoverflow.com/users/4596571/joof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2767, "favorite_count": 2, "answer_count": 5, "score": 0, "last_activity_date": 1474620770, "creation_date": 1474469683, "last_edit_date": 1474620770, "question_id": 39619976, "link": "https://stackoverflow.com/questions/39619976/how-to-stop-a-function-from-running-from-outside-in-c", "title": "How to stop a function from running from outside in c++", "body": "<p>I want to run a function and tell if the function didn't finish after n milliseconds, stop that function and start another one. something like this code:</p>\n\n<pre><code>void run()\n{\n    //do something that doesn't have while(1)\n}\n\n\nvoid main()\n{\n    run();\n    if(runFunctionDidntFinishInSeconds(10)\n    {\n        endPrintFunction();\n        backupPlan();\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I searched out and found boost::timed_join function. here's my code:</p>\n\n<pre><code>void run()\n{\n    int a;\n    for (int i = 0; i &lt; 2000; i++)\n        cout &lt;&lt; i &lt;&lt; endl;\n}\n\n\nint main()\n{\n    boost::thread t = new boost::thread(&amp;run);\n    if (t.timed_join(boost::posix_time::microseconds(10000))){\n        cout &lt;&lt; \"done\" &lt;&lt; endl;\n    }\n    else{\n        cout &lt;&lt; endl &lt;&lt; \"not done\" &lt;&lt; endl;\n    }\n\n\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>but it doesn't stop thread 't' from running. I went to terminate the thread, but it's not a good option.\nI want the 'a' function to finish the exact time I'm telling it to.\n The system gets input every 16ms and I want to do a processing on it and say if the processing took more than about 13ms leave it and go do a backup plan. and I want it to be abstracted from the ones who write the processing method. So putting a while loop on the top of it brings me delay.\nWhat should i do?\nThe least I think I need is to be abled to reset the processing thread to do what it had needed to do again!</p>\n"}, {"tags": ["c++", "boost", "server", "client", "boost-asio"], "comments": [{"owner": {"reputation": 296, "user_id": 6575005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5058c81a441b16971c9854011810166d?s=128&d=identicon&r=PG&f=1", "display_name": "Wum", "link": "https://stackoverflow.com/users/6575005/wum"}, "edited": false, "score": 0, "creation_date": 1474469066, "post_id": 39619538, "comment_id": 66545482, "body": "If you like to see the console output add a <code>std::cin.get()</code> at the end of your <code>while</code> loop."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 296, "user_id": 6575005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5058c81a441b16971c9854011810166d?s=128&d=identicon&r=PG&f=1", "display_name": "Wum", "link": "https://stackoverflow.com/users/6575005/wum"}, "edited": false, "score": 1, "creation_date": 1474469791, "post_id": 39619538, "comment_id": 66545908, "body": "@Wum Huh, what? I&#39;d rather open two terminals and run the server in one and the client in the other."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4407569"}, "edited": false, "score": 0, "creation_date": 1474471883, "post_id": 39619538, "comment_id": 66547314, "body": "This server just sends the current date and time to the client after successful connection and then terminates it. The client <i>does not</i> show the message and just exits. (see @DmitryBakhtiyarov&#39;s answer) There is not more to it."}, {"owner": {"reputation": 296, "user_id": 6575005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5058c81a441b16971c9854011810166d?s=128&d=identicon&r=PG&f=1", "display_name": "Wum", "link": "https://stackoverflow.com/users/6575005/wum"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474619907, "post_id": 39619538, "comment_id": 66614877, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6, of course you could do this. But I expected him to run the apps in an IDE where the terminal per default closes automatically after the program having finished. As a quick help he could simply add <code>std::cin.get()</code> resulting in the terminal staying open until he pushes the any key."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 296, "user_id": 6575005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5058c81a441b16971c9854011810166d?s=128&d=identicon&r=PG&f=1", "display_name": "Wum", "link": "https://stackoverflow.com/users/6575005/wum"}, "edited": false, "score": 0, "creation_date": 1474620385, "post_id": 39619538, "comment_id": 66615150, "body": "@wum Running client/server stuff from the IDE is just silly. So what you want to discuss? And even if running from the IDE in debug mode, a breakpoint should suffice. No need for unnecessary <code>std::cin.get()</code>statements. Keep an eye of what you advise and why please"}, {"owner": {"reputation": 296, "user_id": 6575005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5058c81a441b16971c9854011810166d?s=128&d=identicon&r=PG&f=1", "display_name": "Wum", "link": "https://stackoverflow.com/users/6575005/wum"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474620861, "post_id": 39619538, "comment_id": 66615442, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 As I already said I meant a quick help - sentences like &quot;dont see any more that flash console&quot; make me feel the question poster is not very comfortable with coding in general. But I agree, of course a breakpoint suffices. Why do you think running client/server stuff from IDE is silly? How would you debug this?"}, {"owner": {"reputation": 83, "user_id": 5139619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/985c8fe846c8c64fab9b300616578cdb?s=128&d=identicon&r=PG&f=1", "display_name": "basjak", "link": "https://stackoverflow.com/users/5139619/basjak"}, "edited": false, "score": 0, "creation_date": 1474715813, "post_id": 39619538, "comment_id": 66651829, "body": "am very comfortable with coding but not comfortable at all with this boost library (asio). documentation is very poor and not comprehensive."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5139619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/985c8fe846c8c64fab9b300616578cdb?s=128&d=identicon&r=PG&f=1", "display_name": "basjak", "link": "https://stackoverflow.com/users/5139619/basjak"}, "edited": false, "score": 0, "creation_date": 1474488360, "post_id": 39620389, "comment_id": 66556520, "body": "but no connection is happening otherwise no exception is thrown."}], "tags": [], "owner": {"reputation": 181, "user_id": 2678087, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100004078764575/picture?type=large", "display_name": "Dmitry  Bakhtiyarov", "link": "https://stackoverflow.com/users/2678087/dmitry-bakhtiyarov"}, "is_accepted": true, "score": 0, "last_activity_date": 1474470738, "creation_date": 1474470738, "answer_id": 39620389, "question_id": 39619538, "link": "https://stackoverflow.com/questions/39619538/boost-library-client-server-application/39620389#39620389", "title": "Boost library client-server application", "body": "<pre><code> for (;;)\n    {\n        ...\n\n        if (error_code == asio::error::eof)\n            break; //Connection closed.\n        else\n            throw system::system_error(error_code);\n        //code after this line will never be executed\n\n        cout.write(buf.data(), len);\n    }\n</code></pre>\n\n<p>Your client don't write any data in console - execution of loop will be breaked over throwing exception or break command</p>\n"}], "owner": {"reputation": 83, "user_id": 5139619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/985c8fe846c8c64fab9b300616578cdb?s=128&d=identicon&r=PG&f=1", "display_name": "basjak", "link": "https://stackoverflow.com/users/5139619/basjak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 39620389, "answer_count": 1, "score": 0, "last_activity_date": 1474473422, "creation_date": 1474468418, "last_edit_date": 1474473422, "question_id": 39619538, "link": "https://stackoverflow.com/questions/39619538/boost-library-client-server-application", "title": "Boost library client-server application", "body": "<p>I built simple boost application from boost documentation website but still don't know how to use it yet.</p>\n\n<pre><code>1- Server application:\n#include &lt;ctime&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;boost/asio.hpp&gt;\n\nusing boost::asio::ip::tcp;\n\nstd::string make_daytime_string()\n{\n    using namespace std; // For time_t, time and ctime;\n    time_t now = time(0);\n    return ctime(&amp;now);\n}\n\nint main()\n{\n    try\n    {\n        boost::asio::io_service io_service;\n\n        tcp::acceptor acceptor(io_service, tcp::endpoint(tcp::v4(), 13));\n\n        for (;;)\n        {\n            tcp::socket socket(io_service);\n            acceptor.accept(socket);\n\n            std::string message = make_daytime_string();\n\n            boost::system::error_code ignored_error;\n            boost::asio::write(socket, boost::asio::buffer(message), ignored_error);\n        }\n    }\n    catch (std::exception&amp; e)\n    {\n        std::cerr &lt;&lt; e.what() &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>2- client application:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;exception&gt;\n#include \"boost\\array.hpp\"\n#include \"boost\\asio.hpp\"\n\nusing namespace std;\nusing namespace boost;\nusing boost::asio::ip::tcp;\n\nint main(int argc, char *argv[])\n{\n    try\n    {\n        if (argc != 2)\n        {\n            cerr &lt;&lt; \"usage: client &lt;host&gt;\" &lt;&lt; endl;\n            return 1;\n        }\n\n        asio::io_service io_service;\n\n        tcp::resolver resolver(io_service);\n\n        tcp::resolver::query query(argv[1], \"daytime\");\n\n        tcp::resolver::iterator endpoint_iterator = resolver.resolve(query);\n\n        tcp::socket socket(io_service);\n\n        asio::connect(socket, endpoint_iterator);\n\n        for (;;)\n        {\n            boost::array&lt;char, 128&gt; buf;\n            system::error_code error_code;\n\n            size_t len = socket.read_some(asio::buffer(buf), error_code);\n\n            if (error_code == asio::error::eof)\n                break; //Connection closed.\n            else\n                throw system::system_error(error_code);\n\n            cout.write(buf.data(), len);\n        }\n    }\n    catch (std::exception&amp; e)\n    {\n        cerr &lt;&lt; e.what() &lt;&lt; endl;\n    }\n\n    while (true)\n    {\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>so, what next? </p>\n\n<p>I exe then the client but dont see any more that flash console application.</p>\n\n<p>(note: both application are compiled fine and no problem with the configuration.</p>\n"}, {"tags": ["c++", "visual-studio-2012", "icons"], "answers": [{"comments": [{"owner": {"reputation": 1566, "user_id": 4847311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90fbb34e156577e5c3a5b3b3d1b30f83?s=128&d=identicon&r=PG", "display_name": "Sven Nilsson", "link": "https://stackoverflow.com/users/4847311/sven-nilsson"}, "edited": false, "score": 0, "creation_date": 1474468264, "post_id": 39619346, "comment_id": 66544959, "body": "typo maybe, &quot;specified member&quot; perhaps"}], "tags": [], "owner": {"reputation": 993, "user_id": 6858837, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f56ccb5125aaaad6dd7bb752be8f3494?s=128&d=identicon&r=PG&f=1", "display_name": "Trevir", "link": "https://stackoverflow.com/users/6858837/trevir"}, "is_accepted": true, "score": 2, "last_activity_date": 1474468635, "last_edit_date": 1474468635, "creation_date": 1474467853, "answer_id": 39619346, "question_id": 39619191, "link": "https://stackoverflow.com/questions/39619191/lock-icon-with-autos-variables-in-visual-studio-what-does-it-denote/39619346#39619346", "title": "Lock icon with Autos variables in Visual studio. What does it denote?", "body": "<p>The window auto is referring to the current code line +- some lines (depending on the language used). \nIt shows every variable accessible from that context.</p>\n\n<p>The lock is indicating that the according variable is a protected member of a class. It can only be accessed by its own class or classes inherited from it. </p>\n\n<p>e.G. the context you are currently observing has three protected members ( m_playbackAborted, m_recordingState and m_state). </p>\n"}], "owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1294, "favorite_count": 0, "accepted_answer_id": 39619346, "answer_count": 1, "score": 3, "last_activity_date": 1474468969, "creation_date": 1474467458, "last_edit_date": 1474468969, "question_id": 39619191, "link": "https://stackoverflow.com/questions/39619191/lock-icon-with-autos-variables-in-visual-studio-what-does-it-denote", "title": "Lock icon with Autos variables in Visual studio. What does it denote?", "body": "<p><a href=\"https://i.stack.imgur.com/J7JxJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J7JxJ.png\" alt=\"Lock symbols\"></a></p>\n\n<p>What does the <em>small lock icon</em> in <code>Auto</code> window denote in visual studio?  </p>\n\n<p>I often see them while debugging, but have no idea what they denote.</p>\n"}, {"tags": ["c++", "arrays", "algorithm"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 3, "creation_date": 1474467340, "post_id": 39619121, "comment_id": 66544254, "body": "Because your code is too slow for hackerrank."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 3, "creation_date": 1474467533, "post_id": 39619121, "comment_id": 66544414, "body": "Please refrain asking questions about online code judge engines here. It&#39;s very  unlikely that anyone could tell you where you failed from their test cases, as these aren&#39;t disclosed usually. Even if what you tested was running at your local environment, you may have missed to test some edge cases which are applied in the online challenge. Be creative and try to find them. Additionally there&#39;s probably no value for such questions in the long term, other than cheating the online contest, and nothing is learned."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474467833, "post_id": 39619121, "comment_id": 66544643, "body": "Hint: you don&#39;t have to do the rotations. Just adjust the value of <code>m</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1474467988, "post_id": 39619121, "comment_id": 66544760, "body": "Some summation and modulo arithmetic makes this <i>much</i> simpler, and would probably eliminate a majority of the code. You should not have to rotate on each input rotation value. The purpose of the task is to figure out how to do <i>one</i> rotation ( btw <code>std::rotate</code> would be handy for that), and in reality, you don&#39;t even need to do the rotation. Once you have the final end-result rotation the query indexes can simply be adjusted against that."}, {"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1474468104, "post_id": 39619121, "comment_id": 66544833, "body": "The whole point of these coding challenges is to find a better way. Sure, you can easily brute-force through all the rotations for your test cases, but you are doing massive amounts of completely unnecessary work. Then you hit their test cases which are much bigger. So, what Pete just said, and I think the &quot;modulo&quot; operator might be handy. It looks like a percent sign."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1474468270, "post_id": 39619121, "comment_id": 66544961, "body": "Once you find yourself writing nested loops over the data, you&#39;re in trouble with many of these coding challenges.  You&#39;re basically implementing an <code>O(n*n)</code> approach, and those approaches usually result in timing out."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1474469260, "post_id": 39619121, "comment_id": 66545617, "body": "If I ask you to solve it by hand, are you sure that you will rewrite the full shifted array? That you will shift it <i>k</i> times? Can&#39;t you see something more subtle to do?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5435802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--dkfaWET6UQ/AAAAAAAAAAI/AAAAAAAAACE/xe0T6s6sqg0/photo.jpg?sz=128", "display_name": "Rohan Shahane", "link": "https://stackoverflow.com/users/5435802/rohan-shahane"}, "edited": false, "score": 0, "creation_date": 1474514520, "post_id": 39620013, "comment_id": 66564576, "body": "Thank you! The answer is very helpful! Also thank you for being so kind and helpful!! Much respect!"}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 1, "last_activity_date": 1474470236, "last_edit_date": 1474470236, "creation_date": 1474469785, "answer_id": 39620013, "question_id": 39619121, "link": "https://stackoverflow.com/questions/39619121/why-am-i-getting-terminated-due-to-timeout-error-here/39620013#39620013", "title": "Why am I getting &#39;Terminated due to timeout&#39; error here?", "body": "<p>The reason is that you don't really need to perform the rotation, you can use The Ancient Power of Mathematics.<br>\n(Performing the rotation can require 10 billion <code>arr[i]=arr[i-1]</code>s, and doing that 500 times would take a while.)</p>\n\n<p>If you start with the sequence</p>\n\n<pre><code>Element: | 12 | 34 | ... | 56 | 78 |           (1)\nIndex:      0    1   ...   k-1   k\n</code></pre>\n\n<p>and right-rotate by one, you get</p>\n\n<pre><code>Element: | 78 | 12 | 34 | ... | 56 |           (2)\nIndex:      0    1    2   ...    k\n</code></pre>\n\n<p>or, changing the viewpoint just a little bit:</p>\n\n<pre><code>Element: | 12 | 34 | ... | 56 | 78 |           (3)\nIndex:      1    2   ...    k    0\n</code></pre>\n\n<p>There's a fairly simple relationship between the indices of the elements in (1) and (3), and you only need some arithmetic to get from one to the other.</p>\n\n<p>Discovering the relationship and performing the arithmetic left as an exercise.</p>\n"}], "owner": {"reputation": 29, "user_id": 5435802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--dkfaWET6UQ/AAAAAAAAAAI/AAAAAAAAACE/xe0T6s6sqg0/photo.jpg?sz=128", "display_name": "Rohan Shahane", "link": "https://stackoverflow.com/users/5435802/rohan-shahane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 661, "favorite_count": 0, "closed_date": 1474481849, "accepted_answer_id": 39620013, "answer_count": 1, "score": -3, "last_activity_date": 1474470236, "creation_date": 1474467297, "question_id": 39619121, "link": "https://stackoverflow.com/questions/39619121/why-am-i-getting-terminated-due-to-timeout-error-here", "closed_reason": "Not suitable for this site", "title": "Why am I getting &#39;Terminated due to timeout&#39; error here?", "body": "<p>I'm solving <a href=\"https://www.hackerrank.com/challenges/circular-array-rotation\" rel=\"nofollow\">this problem</a> on Hackerrank.</p>\n\n<p>John Watson performs an operation called a right circular rotation on an array of integers, [a[0],a[ 1]......a[n]].After performing one right circular rotation operation, the array is transformed from [a[0],a[ 1]......a[n]] to [a[n- 1],a[0]......a[n-2]].</p>\n\n<p>Watson performs this operation 'k' times. To test Sherlock's ability to identify the current element at a particular position in the rotated array, Watson asks  'q' queries, where each query consists of a single integer, 'm', for which you must print the element at index  in the rotated array (i.e., the value of a[m] ).</p>\n\n<p>Input Format</p>\n\n<p>The first line contains 3 space-separated integers,'n' ,'k' , and , 'q' respectively. \nThe second line contains 'n' space-separated integers, where each integer      'i' describes array element a[n] (where 0&lt;=i\n\n<p>Output Format</p>\n\n<p>For each query, print the value of the element at index 'm' of the rotated array on a new line.</p>\n\n<pre><code>#include &lt;cmath&gt;\n#include &lt;cstdio&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\n\n\nint main() {\n/* Enter your code here. Read input from STDIN. Print output to STDOUT */   \nint n,k,q,temp;\ncin&gt;&gt;n&gt;&gt;k&gt;&gt;q;       //Input of n,k,q;\nint arr[n],qur[q];\nfor(int i=0;i&lt;n;i++)    //Input of array\n{\n    cin&gt;&gt;arr[i];\n}\n    for(int i=0;i&lt;q;i++)    //Input of query numbers\n{\n        cin&gt;&gt;qur[i];\n}\n\nfor(int z=0;z&lt;k;z++)\n{\n    temp = arr[n-1];\n    for(int i=n-1;i&gt;0;i--)\n    {\n        arr[i]=arr[i-1];\n    }\n    arr[0]=temp;\n}\n\nfor(int i=0;i&lt;q;i++)\n{\n    cout&lt;&lt;arr[qur[i]]&lt;&lt;endl;\n}\n\n\nreturn 0;\n }\n</code></pre>\n\n<p>The code's logic seems to be flawless. I'm a newbie.Thanks in advance.</p>\n"}, {"tags": ["c++", "arrays", "templates"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 5, "creation_date": 1474466826, "post_id": 39618840, "comment_id": 66543862, "body": "Recursion should only be used when it&#39;s necessary. If you dump the recursion, you can simply change <code>double x;</code> to <code>double x[N];</code> and everything will be much simpler."}, {"owner": {"reputation": 370, "user_id": 6222968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1109bd55a5c05ec45c07e85d89e2dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chudinov", "link": "https://stackoverflow.com/users/6222968/alex-chudinov"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474467088, "post_id": 39618840, "comment_id": 66544065, "body": "Agreed. But, it is still interesting if it is possible to do the operator[] here. I mean theoretically."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474467263, "post_id": 39618840, "comment_id": 66544202, "body": "Yes, it can be done. Roughly: <code>return </code>index == 0 ? x : <code>static_cast&lt;Array&lt;N-1&gt;*&gt;(this).operator[](index - 1);</code>. Not tested."}, {"owner": {"reputation": 370, "user_id": 6222968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1109bd55a5c05ec45c07e85d89e2dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chudinov", "link": "https://stackoverflow.com/users/6222968/alex-chudinov"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474470168, "post_id": 39618840, "comment_id": 66546165, "body": "Yes, but I need O(1) complexity if it is possible."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1474470834, "post_id": 39618840, "comment_id": 66546632, "body": "It would be an interesting exercise to <i>prove</i> that it cannot be done without some array of length N somewhere."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474471086, "post_id": 39618840, "comment_id": 66546782, "body": "@AlexChudinov - if you need O(1) don&#39;t use recursion."}, {"owner": {"reputation": 370, "user_id": 6222968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1109bd55a5c05ec45c07e85d89e2dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chudinov", "link": "https://stackoverflow.com/users/6222968/alex-chudinov"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474477353, "post_id": 39618840, "comment_id": 66550651, "body": "@PeteBecker @n.m. Yes, it is just intereting, probably, nothing more. And I am still wander if it could be done, because we actually have such an array of xs belonging to different Arrays in memory, is it? May be some trick can be used like <code>reinterpret_cast</code> to <code>double*</code>?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474478152, "post_id": 39618840, "comment_id": 66551041, "body": "@AlexChudinov - the language definition does not require that that cast does anything sensible. It <b>might</b> work with your compiler and the particular compiler options that you use, but if you rely on it, you must either have documentation from the compiler implementor that it will work or you must test every compiler configuration that you use."}, {"owner": {"reputation": 1219, "user_id": 1570382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5df4ccca14f01074d08aad327208b5b?s=128&d=identicon&r=PG", "display_name": "SergV", "link": "https://stackoverflow.com/users/1570382/sergv"}, "edited": false, "score": 0, "creation_date": 1474643260, "post_id": 39618840, "comment_id": 66629827, "body": "@AlexChudinov, Are you sure that &quot; the Array is a kind of a POD data&quot;? Add next line to your code - &quot;static_assert(std::is_pod&lt;Array&lt;5&gt; &gt;::value, &quot;Array is not POD!!!&quot;);&quot;. Opinion of the compiler is very important too :-)"}, {"owner": {"reputation": 370, "user_id": 6222968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1109bd55a5c05ec45c07e85d89e2dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chudinov", "link": "https://stackoverflow.com/users/6222968/alex-chudinov"}, "reply_to_user": {"reputation": 1219, "user_id": 1570382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5df4ccca14f01074d08aad327208b5b?s=128&d=identicon&r=PG", "display_name": "SergV", "link": "https://stackoverflow.com/users/1570382/sergv"}, "edited": false, "score": 0, "creation_date": 1474646313, "post_id": 39618840, "comment_id": 66631597, "body": "@SergV <a href=\"https://ideone.com/A2bCsu\" rel=\"nofollow noreferrer\">It is not POD</a>. Because it has a base class, has it?"}], "answers": [{"comments": [{"owner": {"reputation": 370, "user_id": 6222968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1109bd55a5c05ec45c07e85d89e2dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chudinov", "link": "https://stackoverflow.com/users/6222968/alex-chudinov"}, "edited": false, "score": 0, "creation_date": 1474470108, "post_id": 39619117, "comment_id": 66546127, "body": "Thank you, but, I still wander if there is any way to do an operator[] of O(1) complexity? That was the main idea of my question, because O(n) is a quite strightforward."}], "tags": [], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "is_accepted": false, "score": 3, "last_activity_date": 1474469046, "last_edit_date": 1474469046, "creation_date": 1474467286, "answer_id": 39619117, "question_id": 39618840, "link": "https://stackoverflow.com/questions/39618840/operator-for-a-template-based-array-of-o1-complexity/39619117#39619117", "title": "operator[] for a template based array of O(1) complexity", "body": "<p>As mentioned by @PeterBecker in comments, using recursion here is probably not a good idea, but for the sake of the exercise, you could simply do:</p>\n\n<pre><code>// Generic case:\ndouble&amp; operator[] (size_t i) {\n    if (i == N - 1) {\n        return x;\n    }\n    return Array&lt;N - 1&gt;::operator[](i);\n}\n\n// Trivial case:\ndouble&amp; operator[](size_t i) {\n    if (i != 0) { // If you don't care about strange behavior, you can remove this.\n        throw std::out_of_range(\"Oops!\");\n    }\n    return x; \n}\n</code></pre>\n\n<p>Note that this is recursive and will give you access in <code>O(n)</code> (if not optimized by the compiler) while any decent <code>std::array</code> (<code>std::vector</code>) implementation is required to be <code>O(1)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 370, "user_id": 6222968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1109bd55a5c05ec45c07e85d89e2dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chudinov", "link": "https://stackoverflow.com/users/6222968/alex-chudinov"}, "edited": false, "score": 0, "creation_date": 1474632865, "post_id": 39658625, "comment_id": 66622708, "body": "Nice idea, but compiler will do with your code something like it will do with the @Holt &#39;s example. Because, the <code>switch</code> is the same as a lot of <code>if</code> put one by another. You can consider it as an O(1) only because it has a finite number of states, but in fact it still has O(n)."}, {"owner": {"reputation": 1219, "user_id": 1570382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5df4ccca14f01074d08aad327208b5b?s=128&d=identicon&r=PG", "display_name": "SergV", "link": "https://stackoverflow.com/users/1570382/sergv"}, "reply_to_user": {"reputation": 370, "user_id": 6222968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1109bd55a5c05ec45c07e85d89e2dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chudinov", "link": "https://stackoverflow.com/users/6222968/alex-chudinov"}, "edited": false, "score": 0, "creation_date": 1474638740, "post_id": 39658625, "comment_id": 66626754, "body": "@AlexChudinov, usual implementation in this case - jump table. So it is O(1). There is not any &quot;if else&quot;. It is very old optimization of first C compilers. See for example - <a href=\"http://stackoverflow.com/questions/2596320/how-does-switch-compile-in-visual-c-and-how-optimized-and-fast-is-it\" title=\"how does switch compile in visual c and how optimized and fast is it\">stackoverflow.com/questions/2596320/&hellip;</a> . You can see assembler listing too."}, {"owner": {"reputation": 370, "user_id": 6222968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1109bd55a5c05ec45c07e85d89e2dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chudinov", "link": "https://stackoverflow.com/users/6222968/alex-chudinov"}, "edited": false, "score": 0, "creation_date": 1474646818, "post_id": 39658625, "comment_id": 66631881, "body": "OK! Sorry, I did a too hasty consumption. So, the <b>switch</b> can be optimized like an array of double ponters which are pointing to probably different locations in memory. Awesome!"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 370, "user_id": 6222968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1109bd55a5c05ec45c07e85d89e2dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chudinov", "link": "https://stackoverflow.com/users/6222968/alex-chudinov"}, "edited": false, "score": 0, "creation_date": 1474883124, "post_id": 39658625, "comment_id": 66697330, "body": "@AlexChudinov more like &quot;increment instruction pointer by N bytes&quot; where there is a lookup table from possible arguments to values of N"}], "tags": [], "owner": {"reputation": 1219, "user_id": 1570382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5df4ccca14f01074d08aad327208b5b?s=128&d=identicon&r=PG", "display_name": "SergV", "link": "https://stackoverflow.com/users/1570382/sergv"}, "is_accepted": true, "score": 1, "last_activity_date": 1474882987, "last_edit_date": 1474882987, "creation_date": 1474626768, "answer_id": 39658625, "question_id": 39618840, "link": "https://stackoverflow.com/questions/39618840/operator-for-a-template-based-array-of-o1-complexity/39658625#39658625", "title": "operator[] for a template based array of O(1) complexity", "body": "<p><strong>switch</strong> operator has usually O(1) complexity. You can use it in operator[] function. For example:</p>\n\n<pre><code>template &lt;&gt; double&amp;  Array&lt;3&gt;::operator[](size_t i)\n{\n    switch (i)\n   {\n        case 0: return Array&lt;0+1&gt;::x;\n        case 1: return Array&lt;1+1&gt;::x;\n        case 2: return Array&lt;2+1&gt;::x;\n   }\n}\n</code></pre>\n\n<p>You can use macro for generation <strong>switch</strong> in operator[] for some <strong>M</strong>. Good tool for such generation is <a href=\"http://www.boost.org/doc/libs/1_61_0/libs/preprocessor/doc/\" rel=\"nofollow\">boost preprocessor</a>. See documentation about BOOST_PP_REPEAT.</p>\n\n<pre><code>//this macro generate one line of switch \n#define DECL(z, n, text) case n: return Array&lt;n+1&gt;::x;\n\n//this macro generate operator[] for  Array&lt;M&gt;\n#define DEF_OPER(z,M,text)\\\ntemplate &lt;&gt; double&amp;  Array&lt;M&gt;::operator[](size_t i)\\\n{\\\n    switch (i)\\\n    {\\\n        BOOST_PP_REPEAT(M, DECL, );\\\n    }\\\n}\\\n\n//generate template &lt;&gt; double&amp;  Array&lt;3&gt;::operator[](size_t i)\nDEF_OPER(, 3, )\n</code></pre>\n\n<p>To generate  operator[] for all possible N you can use <a href=\"http://www.boost.org/doc/libs/1_61_0/libs/preprocessor/doc/\" rel=\"nofollow\">BOOST_PP_REPEAT_FROM_TO</a>:</p>\n\n<pre><code>#define MAX_ARRAY_N 15\n//This macro generate all operator[] from Array&lt;2&gt; to Array&lt;MAX_ARRAY_N&gt;\nBOOST_PP_REPEAT_FROM_TO(2, MAX_ARRAY_N, DEF_OPER, );\n</code></pre>\n\n<p>It is modification of your code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include &lt;boost/preprocessor.hpp&gt;\nusing namespace std;\n\ntemplate &lt;int N&gt; struct Array : Array &lt;N - 1&gt;\n{\n    double x;\n    double&amp;  operator[](size_t i);   //!!!\n    //Prints vector\n    ostream&amp; print(ostream&amp; out) const\n    {\n        static_cast&lt;const Array&lt;N - 1&gt;*&gt;(this)-&gt;print(out);\n        out &lt;&lt; \", \" &lt;&lt; x;\n        return out;\n    }\n//Vector in place summation, without looping\n    Array&amp; operator+=(const Array&amp; v)\n    {\n        x += v.x;\n        *static_cast&lt;Array&lt;N - 1&gt;*&gt;(this) += static_cast&lt;const Array&lt;N - 1&gt;&amp;&gt;(v);\n        return *this;\n    }\n};\ntemplate &lt;&gt; struct Array&lt;1&gt;\n{\n    double x;\n    double&amp;  operator[](size_t i) { return x; }   //!!!\n//Prints vector\n    ostream&amp; print(ostream&amp; out) const\n    {\n        out &lt;&lt; x;\n        return out;\n    }\n//Vector in place summation, without looping\n    Array&amp; operator+=(const Array&amp; v)\n    {\n        x += v.x;\n        return *this;\n    }\n};\n\n//this macro generate one line of switch \n#define DECL(z, n, text) case n: return Array&lt;n+1&gt;::x;\n\n//this macro generate operator[] for  Array&lt;M&gt;\n#define DEF_OPER(z,M,text)\\\ntemplate &lt;&gt; double&amp;  Array&lt;M&gt;::operator[](size_t i)\\\n{\\\n    switch (i)\\\n    {\\\n        BOOST_PP_REPEAT(M, DECL, );\\\n    }\\\n}\\\n\n#define MAX_ARRAY_N 15\n//This macro generate all operator[] from Array&lt;2&gt; to Array&lt;MAX_ARRAY_N&gt;\nBOOST_PP_REPEAT_FROM_TO(2, MAX_ARRAY_N, DEF_OPER, );\n\ntemplate&lt;int N&gt;\nostream&amp; operator&lt;&lt;(ostream&amp; out, const Array&lt;N&gt;&amp; v)\n{\n    out &lt;&lt; \"(\"; v.print(out); out &lt;&lt; \")\";\n    return out;\n}\n\nint main()\n{\n    Array&lt;3&gt; vec;\n    vec[0] = 1; vec[1] = 2; vec[2] = 3;\n\n    cout &lt;&lt; vec &lt;&lt; endl;\n    cout &lt;&lt; (vec += vec) &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>If you do not want to use boost you can implement such macro yourself. Disadvantage of this method - you must know max size of Array in compile time. </p>\n\n<p>P.S.\nThis code was tested in VC++ 2015 and boost 1.61</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Alex Chudinov suggested in comments that <strong>switch</strong> operator has O(N) complexity. Even the first C compilers had very good implementation of <strong>switch</strong>. The reason quite simple - there are a lot of code with hundreds or thousands <strong>case</strong> in <strong>switch</strong> operator. </p>\n\n<p>I found very useful  article about code which compiler generate for <strong>switch</strong> - <a href=\"http://www.codeproject.com/Articles/100473/Something-You-May-Not-Know-About-the-Switch-Statem\" rel=\"nofollow\">Something You May Not Know About the Switch</a> </p>\n"}], "owner": {"reputation": 370, "user_id": 6222968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1109bd55a5c05ec45c07e85d89e2dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chudinov", "link": "https://stackoverflow.com/users/6222968/alex-chudinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 39658625, "answer_count": 2, "score": 1, "last_activity_date": 1474892633, "creation_date": 1474466595, "last_edit_date": 1474892633, "question_id": 39618840, "link": "https://stackoverflow.com/questions/39618840/operator-for-a-template-based-array-of-o1-complexity", "title": "operator[] for a template based array of O(1) complexity", "body": "<p>I want to make an array type using template's recursion as in the code chunk below. <a href=\"https://ideone.com/CQqgUQ\" rel=\"nofollow\">This is code dump on ideone</a>. </p>\n\n<p>Acctually, I can not figure out how to create the <code>double&amp; operator[](int)</code> and <code>const double&amp; operator[](int) const</code> of O(1) complexity for this type of an array. Do you have any assumtions of how it could be done without changing the main ideology? Is it even possible?</p>\n\n<p>Please, help.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sstream&gt;\nusing namespace std;\n\ntemplate &lt;int N&gt; struct Array : Array &lt;N - 1&gt;\n{\n    double x;\n\n    template&lt;int M&gt; double&amp; comp() { return Array&lt;M&gt;::x; }\n    template&lt;int M&gt; const double&amp; comp() const { return Array&lt;M&gt;::x; }\n\n    //Prints vector\n    ostream&amp; print(ostream&amp; out) const\n    {\n        static_cast&lt;const Array&lt;N-1&gt;*&gt;(this)-&gt;print(out);\n        out &lt;&lt; \", \" &lt;&lt;x;\n        return out;\n    }\n\n    //Vector in place summation, without looping\n    Array&amp; operator+=(const Array&amp; v)\n    {\n        x+=v.x;\n        *static_cast&lt;Array&lt;N-1&gt;*&gt;(this) += \n            static_cast&lt;const Array&lt;N-1&gt;&amp;&gt;(v);\n        return *this;\n    }\n};\n\ntemplate &lt;&gt; struct Array&lt;1&gt;\n{\n    double x;\n\n    template&lt;int M&gt; double&amp; comp() { return Array&lt;M&gt;::x; }\n    template&lt;int M&gt; const double&amp; comp() const { return Array&lt;M&gt;::x; }\n\n    //Prints vector\n    ostream&amp; print(ostream&amp; out) const\n    {\n        out &lt;&lt; x;\n        return out;\n    }\n\n    //Vector in place summation, without looping\n    Array&amp; operator+=(const Array&amp; v)\n    {\n        x+=v.x;\n        return *this;\n    }\n};\n\ntemplate&lt;int N&gt;\nostream&amp; operator&lt;&lt;(ostream&amp; out, const Array&lt;N&gt;&amp; v)\n{\n    out &lt;&lt; \"(\"; v.print(out); out &lt;&lt; \")\";\n    return out;\n}\n\nint main() \n{\n   Array&lt;3&gt; vec;\n\n   //Here I want to do something like: vec[0] = 1; vec[1] = 2; vec[3] = 3;\n   //instead of what you see \n   vec.comp&lt;1&gt;() = 1; vec.comp&lt;2&gt;() = 2; vec.comp&lt;3&gt;() = 3;\n\n   cout &lt;&lt; vec &lt;&lt; endl;\n\n   cout &lt;&lt; (vec+=vec) &lt;&lt; endl;\n\n   return 0;\n}\n</code></pre>\n\n<p><strong>UPDATE1</strong></p>\n\n<p>What do you think about this <a href=\"https://ideone.com/bpQXDo\" rel=\"nofollow\">thing</a>:</p>\n\n<pre><code> double&amp; operator[] (int i) {\n    return reinterpret_cast&lt;double*&gt;(this)[i];\n }\n</code></pre>\n\n<p>? And I still wander if it could be done using not such a tricky way.</p>\n\n<p><strong>UPDATE2</strong></p>\n\n<p>OK! After @SergV input I decided that, probably, the best way is to use <strong>switch</strong>, cause it looks not so tricky as <code>reinterpret_cast</code> and could give the O(1) complexity somethimes. Thanks a lot to @SergV for a lot of new information. New for me, ofcause.</p>\n\n<p><strong>UPDATE3</strong></p>\n\n<p><a href=\"https://ideone.com/4hVIiZ\" rel=\"nofollow\">Why not to do your own jump table?</a></p>\n"}, {"tags": ["c++", "qt", "google-people"], "comments": [{"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1474468354, "post_id": 39618775, "comment_id": 66545026, "body": "Looks like this isn&#39;t really an error: <a href=\"https://httpstatuses.com/203\" rel=\"nofollow noreferrer\">httpstatuses.com/203</a>"}, {"owner": {"reputation": 339, "user_id": 6301817, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QA1pK.jpg?s=128&g=1", "display_name": "Jendorski Labs", "link": "https://stackoverflow.com/users/6301817/jendorski-labs"}, "reply_to_user": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1474484857, "post_id": 39618775, "comment_id": 66554586, "body": "Indeed, but i couldn&#39;t receive any content.. from your link, i&#39;m guessing the network was transformed into a proxy, thereby preventing data to be received."}], "owner": {"reputation": 339, "user_id": 6301817, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QA1pK.jpg?s=128&g=1", "display_name": "Jendorski Labs", "link": "https://stackoverflow.com/users/6301817/jendorski-labs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474467787, "creation_date": 1474466455, "last_edit_date": 1474467787, "question_id": 39618775, "link": "https://stackoverflow.com/questions/39618775/error-203-when-using-google-people-api", "title": "Error 203 when using Google People API", "body": "<p>The Google People API allows to read and manage contacts. i tried executing a code that would allow for me to obtain, however, i get error 203. Here is my code </p>\n\n<pre><code>QUrl url(\"https://people.googleapis.com/v1/{resourceName=people/me}/connections\");\nurl.addQueryItem(\"pageToken\", nextPageToken);\n\nQNetworkRequest* request = new QNetworkRequest( url );\nrequest-&gt;setHeader( QNetworkRequest::ContentTypeHeader, \"application/json\" );\nrequest-&gt;setRawHeader( \"Authorization\", QString( \"Bearer %1\" ).arg( this-&gt;_oAuth2-&gt;token() ).toLatin1() );\n\nreturn this-&gt;m_networkManager-&gt;get(*request);\n</code></pre>\n\n<p>However, i get error 203.\nWhat am i doing wrong?.</p>\n"}, {"tags": ["c++", "algorithm", "data-structures"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1474466087, "post_id": 39618553, "comment_id": 66543275, "body": "Why would you use <code>reserve</code> here in the first place. And for that matter, why would you use a vector at all? To take a series of numbers and find their average you need 1. an accumulator, and 2. a counter."}, {"owner": {"reputation": 8756, "user_id": 416274, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa38a4e372afb202e6ab7eb1619372a8?s=128&d=identicon&r=PG", "display_name": "Robinson", "link": "https://stackoverflow.com/users/416274/robinson"}, "edited": false, "score": 1, "creation_date": 1474466102, "post_id": 39618553, "comment_id": 66543283, "body": "You need resize, not reserve.  Reserve doesn&#39;t resize, so data[I] is invalid until you&#39;ve pushed.  What you need to do is call resize and then remove the line with the push_back."}, {"owner": {"reputation": 21, "user_id": 6214911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ea639eb3867f1825da63f0f5fab672?s=128&d=identicon&r=PG&f=1", "display_name": "bellaxnov", "link": "https://stackoverflow.com/users/6214911/bellaxnov"}, "edited": false, "score": 0, "creation_date": 1474466878, "post_id": 39618553, "comment_id": 66543907, "body": "I&#39;ve already implemented a function resize, this is another function that I have to write. Do i set max_size to a certain value? But I dont think I can because I dont know how many values are in the file."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1474572551, "post_id": 39618553, "comment_id": 66598054, "body": "I rolled back your edit, since it changed the question to something completely different. Ask a new question."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6214911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ea639eb3867f1825da63f0f5fab672?s=128&d=identicon&r=PG&f=1", "display_name": "bellaxnov", "link": "https://stackoverflow.com/users/6214911/bellaxnov"}, "edited": false, "score": 0, "creation_date": 1474480161, "post_id": 39619055, "comment_id": 66552160, "body": "Is there a way I can use &#39;resize&#39; and &#39;reserve&#39;?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 21, "user_id": 6214911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ea639eb3867f1825da63f0f5fab672?s=128&d=identicon&r=PG&f=1", "display_name": "bellaxnov", "link": "https://stackoverflow.com/users/6214911/bellaxnov"}, "edited": false, "score": 0, "creation_date": 1474484266, "post_id": 39619055, "comment_id": 66554287, "body": "@bellaxnov - only if you know how many elements you&#39;re going to end up with. For this code, you really don&#39;t need either of them."}, {"owner": {"reputation": 21, "user_id": 6214911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ea639eb3867f1825da63f0f5fab672?s=128&d=identicon&r=PG&f=1", "display_name": "bellaxnov", "link": "https://stackoverflow.com/users/6214911/bellaxnov"}, "edited": false, "score": 0, "creation_date": 1474521120, "post_id": 39619055, "comment_id": 66566281, "body": "If I were to use them, how would I find how many elements are there?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 21, "user_id": 6214911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ea639eb3867f1825da63f0f5fab672?s=128&d=identicon&r=PG&f=1", "display_name": "bellaxnov", "link": "https://stackoverflow.com/users/6214911/bellaxnov"}, "edited": false, "score": 0, "creation_date": 1474545538, "post_id": 39619055, "comment_id": 66580590, "body": "@bellaxnov - what problem are you trying to solve with <code>resize</code> or <code>reserve</code>? You can&#39;t tell, without reading the file, how many elements it holds. <code>vector</code> does a good job of managing memory as it expands, and that&#39;s the best you can do if you don&#39;t now in advance how much data you&#39;re going to have."}, {"owner": {"reputation": 21, "user_id": 6214911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ea639eb3867f1825da63f0f5fab672?s=128&d=identicon&r=PG&f=1", "display_name": "bellaxnov", "link": "https://stackoverflow.com/users/6214911/bellaxnov"}, "edited": false, "score": 0, "creation_date": 1474571986, "post_id": 39619055, "comment_id": 66597756, "body": "What exactly does reserve and resize do? What&#39;s the difference."}, {"owner": {"reputation": 2954, "user_id": 5508296, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/l6uTa.jpg?s=128&g=1", "display_name": "sjrowlinson", "link": "https://stackoverflow.com/users/5508296/sjrowlinson"}, "reply_to_user": {"reputation": 21, "user_id": 6214911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ea639eb3867f1825da63f0f5fab672?s=128&d=identicon&r=PG&f=1", "display_name": "bellaxnov", "link": "https://stackoverflow.com/users/6214911/bellaxnov"}, "edited": false, "score": 0, "creation_date": 1474572838, "post_id": 39619055, "comment_id": 66598220, "body": "@bellaxnov See specific details here <a href=\"http://en.cppreference.com/w/cpp/container/vector/reserve\" rel=\"nofollow noreferrer\"><code>std::vector::reserve</code></a> and here <a href=\"http://en.cppreference.com/w/cpp/container/vector/resize\" rel=\"nofollow noreferrer\"><code>std::vector::resize</code></a> ."}], "tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": false, "score": 2, "last_activity_date": 1474467104, "creation_date": 1474467104, "answer_id": 39619055, "question_id": 39618553, "link": "https://stackoverflow.com/questions/39618553/finding-size-of-the-vector/39619055#39619055", "title": "Finding size of the vector", "body": "<p>Don't bother with <code>resize</code> and <code>reserve</code>. Read a value into a local variable of type <code>int</code>, then use <code>data.push_back()</code> to append it to the vector. The vector will resize itself as necessary:</p>\n\n<pre><code>int value;\nwhile (std::cin &gt;&gt; value)\n    data.push_back(value);\n</code></pre>\n\n<p>That will correctly handle any number of input values. But see the comment by @WhozCraig -- using a vector is overkill for the problem as stated.</p>\n"}], "owner": {"reputation": 21, "user_id": 6214911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ea639eb3867f1825da63f0f5fab672?s=128&d=identicon&r=PG&f=1", "display_name": "bellaxnov", "link": "https://stackoverflow.com/users/6214911/bellaxnov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1474572413, "creation_date": 1474465916, "last_edit_date": 1474572413, "question_id": 39618553, "link": "https://stackoverflow.com/questions/39618553/finding-size-of-the-vector", "title": "Finding size of the vector", "body": "<p>I'm trying to read in numbers from a file and take the average of all the numbers but i'm unsure how to include the data.resize() and data.reserve() part into my code. I have to use resize and reserve. When I set current_size or max_size to data.size() to 0. Is there another way to find the size of the vector?</p>\n\n<pre><code>//   1) Read in the size of the data to be read (use type size_t)\n//   2) Use data.resize() to set the current size of the vector\n//   3) Use a for loop to read in the specified number of values,\n//      storing them into the vector using a subscript\nvoid readWithResize(vector&lt;int&gt; &amp;data) {\n    cout &lt;&lt; \"Using resize!\" &lt;&lt; endl;\n\n    if (cin){\n        size_t current_size;\n        current_size = data.size();\n        //cin &gt;&gt; current_size;\n        cout &lt;&lt; \"current_size = \" &lt;&lt; current_size &lt;&lt; endl;\n        data.resize(current_size);\n        for (size_t i = 0; i &lt; current_size; i++){\n            cin &gt;&gt; data[i];\n            data.push_back(data[i]);\n            cout &lt;&lt; data[i] &lt;&lt; \" \";\n            cout &lt;&lt; current_size &lt;&lt; endl;\n        }\n\n    }\n\n//   1) Read in the size of the data to be read (use type size_t)\n//   2) Use data.reserve() to set the maximum size of the vector\n//   3) Use a for loop to read in the specified number of values,\n//      storing them into the vector using data.push_back()\nvoid reserve(vector&lt;int&gt; &amp;data) {\n\n    cout &lt;&lt; \"Using reserve!\" &lt;&lt; endl;\n\n    if (cin){\n        size_t max_size;\n        //max_size = 12;\n\n        data.reserve(max_size);\n        cout &lt;&lt; \"max_size = \" &lt;&lt; max_size &lt;&lt; endl;\n\n        for (size_t i = 0; i &lt; max_size; i++){\n            cin &gt;&gt; data[i];\n            data.push_back(data[i]);\n            cout &lt;&lt; data[i] &lt;&lt; \" \";\n        }\n\n    }\n</code></pre>\n"}, {"tags": ["c++", "unions", "strict-aliasing"], "comments": [{"owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "edited": false, "score": 0, "creation_date": 1474475179, "post_id": 39618259, "comment_id": 66549387, "body": "I mean via UB it lets you write to one field and read from another that aliases it.  From what I have found online and seen MSVC behaves this way and needs to otherwise it would break a lot of Win32 code."}, {"owner": {"reputation": 4660, "user_id": 12149471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb9107b3d75e1de3585ba0f14e9d632?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas Wenzel", "link": "https://stackoverflow.com/users/12149471/andreas-wenzel"}, "edited": false, "score": 0, "creation_date": 1572210645, "post_id": 39618259, "comment_id": 103481134, "body": "In the <a href=\"https://clang.llvm.org/docs/AttributeReference.html\" rel=\"nofollow noreferrer\">Clang documentation for attributes</a>, I cannot find <code>may_alias</code> in the list. I can only find it in the corresponding <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.0.2/gcc/Type-Attributes.html\" rel=\"nofollow noreferrer\">GCC documentation</a>. Are you sure that Clang also supports it?"}], "owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1605668769, "creation_date": 1474465207, "last_edit_date": 1605668769, "question_id": 39618259, "link": "https://stackoverflow.com/questions/39618259/attempting-to-standardise-a-may-alias-idiom-in-c", "title": "Attempting to standardise a may_alias idiom in C++?", "body": "<p>From my understanding GCC and Clang both support: <code>__attribute__((may_alias))</code></p>\n<p>So I believe for example if I wanted to define a fallback type for say a 128-bit SSE type that works across GCC/Clang/MSVC on x64/ARM I could do something like:</p>\n<pre><code>#ifdef _MSC_VER\n#define UNIONALIAS union\n#else\n#define UNIONALIAS union __attribute__((may_alias))\n#endif\n\n\nUNIONALIAS VI128\n{\n    uint64_t uint64[2];\n    uint32_t uint32[4];\n    uint16_t uint16[8];\n    uint8_t uint8[16];\n    int64_t int64[2];\n    int32_t int32[4];\n    int16_t int16[8];\n    int8_t int8[16];\n};\n</code></pre>\n<p>Now as far as I understand it currently all versions of MSVC will allow you via undefined behaviour to ignore strict aliasing rules and access the different types within that union and get what you 'would hope for' despite the C++ standard providing no guarantee etc.  With the attribute tag on GCC/Clang this will likely future proof the code on those compilers despite not being standard C++.</p>\n<p>I suspect if something like this became a standard idiom then future versions of MSVC would surely take it into account even if they didn't adopt compatible attribute syntax - maybe they have something planned already?  Also maybe any future C++ standard would also make room to allow for a suitable transition if it directly added support for <code>may_alias</code>?</p>\n<p>I use a fallback SSE type as an example but maybe an integer AVX2 one would have been better.  But the point remains is sometimes you do want to do things like this and the <code>memcpy</code> route may not be viable due to performance in debug builds and sometimes it can cause a lot of excessive typing and contorted effort really.</p>\n<p>Apart from it being non standard (!) is there any major flaw in this approach, or my understanding current compiler behaviour regards this?</p>\n"}, {"tags": ["c++", "opengl", "glsl", "glfw"], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 2696085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bb3abac8b54dd80f47c9573c654f7159?s=128&d=identicon&r=PG&f=1", "display_name": "ACraftyMarmoset", "link": "https://stackoverflow.com/users/2696085/acraftymarmoset"}, "is_accepted": true, "score": 0, "last_activity_date": 1474534039, "creation_date": 1474534039, "answer_id": 39634321, "question_id": 39618093, "link": "https://stackoverflow.com/questions/39618093/glfwswapinterval-causing-flickering-broken-drawing/39634321#39634321", "title": "glfwSwapInterval() causing flickering/broken drawing", "body": "<p>I managed to find the cause of the problem, eventually.</p>\n\n<p>As it turns out, it wasn't caused by glfwSwapInterval() - however, setting it to 0 simply seems to mask the problem due to the much higher framerate.</p>\n\n<p>In my vertex shader, I was passing in the position as a vec2, and setting gl_Position as follows:</p>\n\n<pre><code>#version 330 core\n\nlayout (location = 0) in vec2 position;\n\nvoid main()\n{\n    gl_Position.xy = position;\n    gl_Position.z = 0.0f;\n    // gl_Position.w does not get set -&gt; left as an undefined value?\n}\n</code></pre>\n\n<p>As a result, the w component of gl_Position was not being set. Setting this to 1.0f resolved the problem:</p>\n\n<pre><code>#version 330 core\n\nlayout (location = 0) in vec2 position;\n\nvoid main()\n{\n    gl_Position = vec4(position, 0.0f, 1.0f); // Works\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 2696085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bb3abac8b54dd80f47c9573c654f7159?s=128&d=identicon&r=PG&f=1", "display_name": "ACraftyMarmoset", "link": "https://stackoverflow.com/users/2696085/acraftymarmoset"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 39634321, "answer_count": 1, "score": -1, "last_activity_date": 1474534143, "creation_date": 1474464803, "last_edit_date": 1474534143, "question_id": 39618093, "link": "https://stackoverflow.com/questions/39618093/glfwswapinterval-causing-flickering-broken-drawing", "title": "glfwSwapInterval() causing flickering/broken drawing", "body": "<p>I'm currently working on a small 2D platformer project using OpenGL, trying to do most things from scratch as a learning exercise.</p>\n\n<p>The problem I'm having at the moment seems to be related to using glfwSwapInterval(n);. When I set the swap interval to 0 (i.e., no vsync), a GameObject I'm rendering renders perfectly fine, and moves around smoothly. Setting it to 1 causes the object to either not be rendered, or to flicker and the corners jump around. Setting it to higher values worsens the problem.</p>\n\n<p>The code I believe is relevant is below.</p>\n\n<p>game.cpp (main game class):</p>\n\n<pre><code>void Game::runGame()\n{\n    // Some init things here but not important\n    while (!glfwWindowShouldClose(_disp.getWindow()))\n    {\n        // delta is set up here\n        glfwPollEvents();\n        for (auto&amp; obj : _gobs) { obj-&gt;update(delta) };\n        _disp.checkInput(_cont.getKeys()); // Only checks for Esc press to close window\n        _disp.render(_gobs);\n    }\n    _disp.close();\n}\n</code></pre>\n\n<p>display.cpp (handles window creation):</p>\n\n<pre><code>bool Display::initGL()\n{\n    // Majority of window creation code is above here, but generic and probably irrelevant\n    glViewport(0, 0, _scrWidth, _scrHeight);\n    glfwSwapInterval(0); // Seems to cause flickering with nonzero values\n    glfwSetInputMode(_window, GLFW_CURSOR, GLFW_CURSOR_DISABLED);\n\n    return true;\n}\n\nvoid Display::render(std::vector&lt;std::shared_ptr&lt;GameObject&gt;&gt; gobs)\n{\n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n    for (auto&amp; obj : gobs) { obj-&gt;render(); }\n    glfwSwapBuffers(_window);\n}\n</code></pre>\n\n<p>gameobject.cpp (object class):</p>\n\n<pre><code>void GameObject::render()\n{\n    if (_vaoid)\n    {\n        _shader.use();\n        glBindVertexArray(_vaoid);\n            glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0);\n        glBindVertexArray(0);\n    }\n}\n</code></pre>\n\n<p>Does anybody have any ideas on what could be causing this? It feels like I must have missed out a window hint or something similar but I couldn't find any documentation that mentions that.</p>\n\n<p>Edit: Shader code causing the problem:\nbasicvert.vs:</p>\n\n<pre><code>#version 330 core\n\nlayout (location = 0) in vec2 position;\n\nvoid main()\n{\n    gl_Position.xy = position;\n    gl_Position.z = 0.0f;\n}\n</code></pre>\n"}, {"tags": ["c++", "ios", "xcode", "macos", "cocos2d-x"], "comments": [{"owner": {"reputation": 1111, "user_id": 834459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e439ef4645473b8a95fb2cf36ab15559?s=128&d=identicon&r=PG", "display_name": "Vidur", "link": "https://stackoverflow.com/users/834459/vidur"}, "edited": false, "score": 0, "creation_date": 1474523595, "post_id": 39617703, "comment_id": 66567200, "body": "Did you already try logging the full path to see if it pointed to the right file?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6858535, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210231762409119/picture?type=large", "display_name": "Marcos Torres", "link": "https://stackoverflow.com/users/6858535/marcos-torres"}, "is_accepted": false, "score": 0, "last_activity_date": 1475179776, "creation_date": 1475179776, "answer_id": 39779128, "question_id": 39617703, "link": "https://stackoverflow.com/questions/39617703/unable-to-read-plist-files-from-a-command-line-target-using-xcode/39779128#39779128", "title": "Unable to read plist files from a command line target using XCode", "body": "<p>Well I've found that command-line applications doesn't support bundle model. I've found it here: <a href=\"https://developer.apple.com/library/content/documentation/CoreFoundation/Conceptual/CFBundles/AboutBundles/AboutBundles.html\" rel=\"nofollow\">https://developer.apple.com/library/content/documentation/CoreFoundation/Conceptual/CFBundles/AboutBundles/AboutBundles.html</a></p>\n\n<p>Now I'm writing all my test cases using XCTest (default unit test framework for XCode).</p>\n"}], "owner": {"reputation": 1, "user_id": 6858535, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210231762409119/picture?type=large", "display_name": "Marcos Torres", "link": "https://stackoverflow.com/users/6858535/marcos-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475179776, "creation_date": 1474463859, "question_id": 39617703, "link": "https://stackoverflow.com/questions/39617703/unable-to-read-plist-files-from-a-command-line-target-using-xcode", "title": "Unable to read plist files from a command line target using XCode", "body": "<p>I'm working on a iOS mobile game using cocos2d-x 3.10 and cocos studio on Mac.</p>\n\n<p>I'm using Catch as a unit test framework. In order to use Catch I've added a new target to the original XCode project. In this target I've created my \"testXXX.cpp\" files which contains the code of the unit tests that I want to run.</p>\n\n<p>I'm having some troubles in one of my unit tests. I'm trying to test a method. Inside this method I'm using cocos2d FileUtils to reach two .plist files that configure some behaviour in the game. Here is the code that I'm using:</p>\n\n<pre><code>std::string fullPathLevels = cocos2d::FileUtils::getInstance()-&gt;fullPathForFilename(OIR_CONFIG_LEVELS);\nstd::string fullPathRhythmTable = cocos2d::FileUtils::getInstance()-&gt;fullPathForFilename(OIR_CONFIG_RHYTHMS);\n\nthis-&gt;Levels = cocos2d::FileUtils::getInstance()-&gt;getValueMapFromFile(fullPathLevels);\nthis-&gt;rhythmTable = cocos2d::FileUtils::getInstance()-&gt;getValueMapFromFile(fullPathRhythmTable);\n</code></pre>\n\n<p>It works fine when I build the code aiming mobile or desktop target BUT when I change to the \"command line\" target that I've created to test using Catch then the plist files can't be found.</p>\n\n<p>I've already added the plist files to the target membership and they appear on the \"Copy Bundle Resources\" section in Build Phases...</p>\n"}, {"tags": ["c++", "visual-studio-2010", "migration", "32bit-64bit", "zeromq"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474463796, "post_id": 39617594, "comment_id": 66541632, "body": "Use the runnable code snippet for runnable code only please."}, {"owner": {"reputation": 3, "user_id": 2791460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eabf81ae6782fff220cd097b6f43445?s=128&d=identicon&r=PG&f=1", "display_name": "mony", "link": "https://stackoverflow.com/users/2791460/mony"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474464135, "post_id": 39617594, "comment_id": 66541846, "body": "ok. Is it proper now ?"}, {"owner": {"reputation": 3, "user_id": 2791460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eabf81ae6782fff220cd097b6f43445?s=128&d=identicon&r=PG&f=1", "display_name": "mony", "link": "https://stackoverflow.com/users/2791460/mony"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474885267, "post_id": 39617594, "comment_id": 66698756, "body": "I found the solution. While using already compiled binary, it is working properly."}], "owner": {"reputation": 3, "user_id": 2791460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eabf81ae6782fff220cd097b6f43445?s=128&d=identicon&r=PG&f=1", "display_name": "mony", "link": "https://stackoverflow.com/users/2791460/mony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474464168, "creation_date": 1474463607, "last_edit_date": 1474464168, "question_id": 39617594, "link": "https://stackoverflow.com/questions/39617594/zeromq-migration-32-bit-to-64-bit-runtime-error", "title": "ZeroMQ Migration 32 bit to 64 bit runtime error", "body": "<p>I have a Client Server project running in Visual Studio 2010 using ZeroMQ. I am able to build and run the project in 32 bit environment. While migration from 32 bit to 64 bit i am getting a Runtime error stating - </p>\n\n<blockquote>\n  <p>Unhandled exception at 0x000007feed3be117 (libzmq.dll) in ClockClientTester.exe: 0xC00000FD: Stack overflow.</p>\n</blockquote>\n\n<p>In the stack it is showing error in map</p>\n\n<pre><code>libzmq.dll!std::map&lt;unsigned short,zmq::select_t::family_entry_t,   std::less&lt;unsigned short&gt;,std::allocator&lt;std::pair&lt;unsigned short const ,zmq::select_t::family_entry_t&gt; &gt; &gt;::operator[](const unsigned short &amp; _Keyval)  Line 210 + 0x15 bytes\n</code></pre>\n\n<p>Any suggestion would be appreciated.\nThanks</p>\n"}, {"tags": ["c++", "linux", "port", "netstat"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474463262, "post_id": 39617324, "comment_id": 66541247, "body": "There are more commands you can use like <code>whereis netstat</code> or so, and check the output."}, {"owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "edited": false, "score": 0, "creation_date": 1474464765, "post_id": 39617324, "comment_id": 66542281, "body": "Note that you&#39;ll have to handle the case where the port becomes unavailable between your check and the time you use it.  Depending on the context, checking that it is available is then useless or it can be better to take the ownership of the port at the time you want to check (and release if it is finally not used)."}, {"owner": {"reputation": 1090, "user_id": 5428089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99553cd40613c219df839d5e30c15e3e?s=128&d=identicon&r=PG&f=1", "display_name": "karastojko", "link": "https://stackoverflow.com/users/5428089/karastojko"}, "edited": false, "score": 0, "creation_date": 1474470070, "post_id": 39617324, "comment_id": 66546107, "body": "Is there a specific reason why not to use <code>bind()</code>?"}, {"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "reply_to_user": {"reputation": 1090, "user_id": 5428089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99553cd40613c219df839d5e30c15e3e?s=128&d=identicon&r=PG&f=1", "display_name": "karastojko", "link": "https://stackoverflow.com/users/5428089/karastojko"}, "edited": false, "score": 0, "creation_date": 1474536966, "post_id": 39617324, "comment_id": 66574935, "body": "@karastojko, basically I will be opening a Tcl Comm Server on that port by firing a Tcl command (using <code>Tcl_Eval</code>) after checking the port&#39;s availability. So, I don&#39;t want to bind the port, as I have to close immediately after binding."}, {"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "reply_to_user": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "edited": false, "score": 0, "creation_date": 1474537219, "post_id": 39617324, "comment_id": 66575108, "body": "@AProgrammer, that case has been welly handle. I have used some concepts of <code>critical section</code> and <code>mutex</code>."}, {"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1474537283, "post_id": 39617324, "comment_id": 66575157, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6, I was thinking of not firing another shell command. Anyways, thanks for your input."}], "answers": [{"tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": true, "score": 4, "last_activity_date": 1474463617, "creation_date": 1474463617, "answer_id": 39617598, "question_id": 39617324, "link": "https://stackoverflow.com/questions/39617324/find-if-a-port-is-available-to-use-in-linux-using-c/39617598#39617598", "title": "Find if a port is available to use in linux using c++", "body": "<p>An even better idea is to make your code work completely without <code>netstat</code> altogether.</p>\n\n<p>On Linux, all that <code>netstat</code> does (for your use case) is read the contents of <code>/proc/net/tcp</code>, which enumerates all ports in use.</p>\n\n<p>All you have to do is open <code>/proc/net/tcp</code> yourself, and parse it. This becomes just an ordinary, boring, file parsing code. Can't get much more \"crash-proof\" than that.</p>\n\n<p>You will find the documentation of the format of <code>/proc/net/tcp</code> in Linux manual pages.</p>\n\n<p>In the unlikely event that you need to check <code>UDP</code> ports, this would be <code>/proc/net/udp</code>.</p>\n\n<p>Of course, there is a race window between the time you check <code>/proc/net/tcp</code>, where someone can grab the port. But that's also true with <code>netstat</code> as well, and since that's going to be a much slower process, this will actually be an improvement, and reduce the race window significantly.</p>\n"}, {"tags": [], "owner": {"reputation": 17784, "user_id": 1646322, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d9fd7a75e0d8ace7bb3276476786c2c0?s=128&d=identicon&r=PG", "display_name": "Ruslan Osmanov", "link": "https://stackoverflow.com/users/1646322/ruslan-osmanov"}, "is_accepted": false, "score": 0, "last_activity_date": 1474464511, "creation_date": 1474464511, "answer_id": 39617972, "question_id": 39617324, "link": "https://stackoverflow.com/questions/39617324/find-if-a-port-is-available-to-use-in-linux-using-c/39617972#39617972", "title": "Find if a port is available to use in linux using c++", "body": "<p>Since you're asking for a way to check if <code>netstat</code> command is available, I won't try to suggest the other ways in C++. The shell way is checking return code of the following command:</p>\n\n<pre><code>command -v netstat\n</code></pre>\n\n<p>If <code>netstat</code> binary is available in <code>$PATH</code>, then the command returns <code>0</code>. In Bash it usually looks like this:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>command -v netstat\nif [ $? -eq 0 ]; then\n  netstat # ...\nelse\n  echo &gt;&amp;2 \"Error: netstat is not available\"\nfi\n</code></pre>\n\n<p>Or simply</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>command -v netstat &gt;/dev/null &amp;&amp; netstat # ...\n</code></pre>\n"}], "owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1893, "favorite_count": 0, "accepted_answer_id": 39617598, "answer_count": 2, "score": 3, "last_activity_date": 1474464511, "creation_date": 1474462906, "question_id": 39617324, "link": "https://stackoverflow.com/questions/39617324/find-if-a-port-is-available-to-use-in-linux-using-c", "title": "Find if a port is available to use in linux using c++", "body": "<p>I am working on a C++ Project. To fulfill one of the requirement, I need to check if a port is available for using in my application anytime. To fulfill this , I have come to this following solution. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;stdexcept&gt;\n#include &lt;string&gt;\n#include &lt;stdio.h&gt;\n\n\nstd::string _executeShellCommand(std::string command) {\n    char buffer[256];\n    std::string result = \"\";\n    const char * cmd = command.c_str();\n    FILE* pipe = popen(cmd, \"r\");\n    if (!pipe) throw std::runtime_error(\"popen() failed!\");\n\n    try {\n        while (!feof(pipe)) \n            if (fgets(buffer, 128, pipe) != NULL)\n                result += buffer;\n    } catch (...) {\n        pclose(pipe);\n        throw;\n    }\n    pclose(pipe);\n    return result;\n}\n\nbool _isAvailablePort(unsigned short usPort){\n    char shellCommand[256], pcPort[6];\n    sprintf(shellCommand, \"netstat -lntu | awk '{print $4}' | grep ':' | cut -d \\\":\\\" -f 2 | sort | uniq | grep %hu\", usPort);\n    sprintf(pcPort, \"%hu\", usPort);\n\n    std::string output =  _executeShellCommand(std::string(shellCommand));\n\n    if(output.find(std::string(pcPort)) != std::string::npos)\n            return false;\n    else\n            return true;\n\n}   \n\n\nint main () {\n    bool res = _isAvailablePort(5678);\n    return 0;\n}\n</code></pre>\n\n<p>Here Basically the <code>_executeShellCommand</code> function can excute any shell command anytime and can return the <code>stdout</code> output as return string. </p>\n\n<p>And I am executing the following shell command in that function. </p>\n\n<pre><code>netstat -lntu | awk '{print $4}' | grep ':' | cut -d \\\":\\\" -f 2 | sort | uniq | grep portToCheck\n</code></pre>\n\n<p>So, if the port is already in use, the <code>_executeShellCommand</code> will return the PortValue itself, else it will return Blank. So, checking the returned string, I can decide.</p>\n\n<p>So far so good.</p>\n\n<p>Now, I want to be make my Project completely Crash-proof. So, before firing the <code>netstat</code> command, I want to make sure if it really exists or not. I want help in this case. I know, It's kind of stupid to doubt the availability of <code>netstat</code> command in a linux machine. I am just thinking of some user who removed <code>netstat</code> binary from his machine for some reason. </p>\n\n<p>N.B. : I don't want make a <code>bind()</code> call to chack if the port is available or not. Also, it will be best if I can check if <code>netstat</code> command is available without calling <code>_executeShellCommand</code> for another time (i.e. without executing another Shell Command).  </p>\n"}, {"tags": ["c++", "dll", "singleton", "in-memory", "make-shared"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1474461857, "post_id": 39616820, "comment_id": 66540224, "body": "You should not inline <code>static SingletonFSVSp GetInstance()</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1474462068, "post_id": 39616820, "comment_id": 66540385, "body": "Do note that neither of these are singletons.  They both have public constructors meaning you can make as many instances as you want."}, {"owner": {"reputation": 4591, "user_id": 1798187, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/TtMsV.jpg?s=128&g=1", "display_name": "idanshmu", "link": "https://stackoverflow.com/users/1798187/idanshmu"}, "edited": false, "score": 0, "creation_date": 1474462069, "post_id": 39616820, "comment_id": 66540386, "body": "@DieterL&#252;cking is that related to the problem or just a general comment? 10x."}, {"owner": {"reputation": 4591, "user_id": 1798187, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/TtMsV.jpg?s=128&g=1", "display_name": "idanshmu", "link": "https://stackoverflow.com/users/1798187/idanshmu"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1474462096, "post_id": 39616820, "comment_id": 66540405, "body": "@NathanOliver correct I&#39;ll update the question"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1474463134, "post_id": 39616820, "comment_id": 66541148, "body": "@idanshmu ... the static variable of that inline function (not put into a specific translation unit)  is the problem."}, {"owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "edited": false, "score": 0, "creation_date": 1474606196, "post_id": 39616820, "comment_id": 66608509, "body": "GetInstance() should return SingletonCSMSp&amp; and std::unique_ptr seems more appropriate than std::shared_ptr in your program. Otherwise SingletonFSV seems better because member variable spInstance in SingletonCSM is redundant as you can always use SingletonFSV ::GetInstance() to access the singleton."}], "answers": [{"comments": [{"owner": {"reputation": 4591, "user_id": 1798187, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/TtMsV.jpg?s=128&g=1", "display_name": "idanshmu", "link": "https://stackoverflow.com/users/1798187/idanshmu"}, "edited": false, "score": 0, "creation_date": 1474462386, "post_id": 39617036, "comment_id": 66540623, "body": "OK. but how does it explain the problem? I would expect <code>SingletonFSV</code> to work always while <code>SingletonCSM</code> may crash occasionally. but the problem is the other way around"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "reply_to_user": {"reputation": 4591, "user_id": 1798187, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/TtMsV.jpg?s=128&g=1", "display_name": "idanshmu", "link": "https://stackoverflow.com/users/1798187/idanshmu"}, "edited": false, "score": 0, "creation_date": 1474462721, "post_id": 39617036, "comment_id": 66540844, "body": "@idanshmu Yes I can&#39;t answer your third question. I misread your problem and assumed the function static method solved it. This sounds like a job for your debugger because, in principle, using a static member is problematic and to be avoided whereas using a function static is considered the safe option."}], "tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": true, "score": 2, "last_activity_date": 1474463301, "last_edit_date": 1474463301, "creation_date": 1474462140, "answer_id": 39617036, "question_id": 39616820, "link": "https://stackoverflow.com/questions/39616820/singleton-impl-using-static-class-member-vs-static-member-variable/39617036#39617036", "title": "Singleton - Impl. using static class member vs. static member variable", "body": "<p>When you put a <code>static</code> variable inside a function it is created the first time the function is called so it is guaranteed to have been instantiated to <strong>all</strong> callers of the function.</p>\n\n<p>Members that are declared <code>static</code> could be instantiated before or after you call your function because the initialization order <em>between translation units</em> is undefined. So a global object or <code>static</code> object could try to access a static member <em>before</em> its been initialized by the runtime system.</p>\n\n<p>So to your questions:</p>\n\n<blockquote>\n  <ol>\n  <li>Can we consider both impl. as a valid impl. of the design pattern?</li>\n  <li>Are both, functionally, the same?</li>\n  </ol>\n</blockquote>\n\n<p>No. Using a <code>static</code> member is dangerous because a caller to <code>SingletonCSM::GetInstance()</code> can access a non-created object if the <code>nullptr</code> initialization has not taken place before the call. The <code>static</code> function method is the recommended method because it guarantees initialization has completed for every caller. </p>\n\n<blockquote>\n  <p>I just don't understand what was the problem and why was it solved?</p>\n</blockquote>\n\n<p>In your case moving to the more dangerous method appears to have stopped your crash. I can not explain why that is. But you may not have removed the problem, it may be that you have undefined behavior elsewhere that has simply stopped manifesting in this case but that may resurface later with a different change.</p>\n"}], "owner": {"reputation": 4591, "user_id": 1798187, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/TtMsV.jpg?s=128&g=1", "display_name": "idanshmu", "link": "https://stackoverflow.com/users/1798187/idanshmu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 876, "favorite_count": 0, "accepted_answer_id": 39617036, "answer_count": 1, "score": 2, "last_activity_date": 1474463301, "creation_date": 1474461591, "last_edit_date": 1474462145, "question_id": 39616820, "link": "https://stackoverflow.com/questions/39616820/singleton-impl-using-static-class-member-vs-static-member-variable", "title": "Singleton - Impl. using static class member vs. static member variable", "body": "<p>Bring you two different implantation of singleton design pattern:</p>\n\n<h3>static class member</h3>\n\n<pre><code>class SingletonCSM;\nusing SingletonCSMSp = std::shared_ptr &lt; SingletonCSM &gt; ;\n\nclass SingletonCSM\n{\npublic:\n\n    ~SingletonCSM()  { spInstance = nullptr; }\n\n    static SingletonCSMSp GetInstance()\n    {\n        if (!spInstance)\n            spInstance = std::make_shared&lt;SingletonCSM&gt;();\n\n        return spInstance;\n    }\n\nprivate:\n\n    SingletonCSM() {}\n\n    // will be intilized in the cpp: SingletonCSMSp SingletonCSM::spInstance = nullptr;\n    static SingletonCSMSp spInstance; \n};\n</code></pre>\n\n<h3>static member variable</h3>\n\n<pre><code>class SingletonFSV;\nusing SingletonFSVSp = std::shared_ptr &lt; SingletonFSV &gt; ;\n\nclass SingletonFSV\n{\npublic:\n\n    ~SingletonFSV() {}\n\n    static SingletonFSVSp GetInstance()\n    {\n        static SingletonFSVSp spInstance = std::make_shared&lt;SingletonFSV&gt;();\n        return spInstance;\n    }\n\nprivate:\n\n    SingletonFSV() {}\n\n};\n</code></pre>\n\n<p>I always use the first impl. <code>SingletonCSM</code>. I came across, in our code, an impl. like <code>SingletonFSV</code></p>\n\n<h1>Questions</h1>\n\n<ol>\n<li>Can we consider both impl. as a valid impl. of the design pattern?</li>\n<li>Are both, functionally, the same? </li>\n</ol>\n\n<hr>\n\n<h1>Motivation</h1>\n\n<h3>Background</h3>\n\n<p>Class <code>SingletonFSV</code> was implemented as a part of a DLL project. This DLL, compiled in <code>VS 2013</code>, is loaded in memory by an exe file and run.</p>\n\n<h3>Problem</h3>\n\n<p>I've upgrade my <code>VS</code> to <code>VS 2015</code>, compiled the DLL project and run the exe. All of a sudden, it crashed. While debugging, I've notice that the crash happened in the DLL itself. <code>make_shared</code> called withing <code>GetInstance()</code> returned <code>nullptr</code> and naturally caused segmentation fault.</p>\n\n<h3>Solution</h3>\n\n<p>I've changed <code>SingletonFSV</code> impl. to <code>SingletonCSM</code> and the crash stopped. <code>make_shared</code> returned a valid pointer and the problem was solved.</p>\n\n<h3>Question</h3>\n\n<p>I just don't understand what was the problem and why was it solved?</p>\n"}, {"tags": ["c++", "qt", "winapi", "g++", "manifest"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1474464690, "post_id": 39616658, "comment_id": 66542216, "body": "What is the corrupted manifest?"}, {"owner": {"reputation": 13, "user_id": 2600754, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001710840958/picture?type=large", "display_name": "Bartosz Jarzyna", "link": "https://stackoverflow.com/users/2600754/bartosz-jarzyna"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1474465139, "post_id": 39616658, "comment_id": 66542540, "body": "It&#39;s included in the question. XML just stops before all the nodes are closed"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1474468346, "post_id": 39616658, "comment_id": 66545018, "body": "We would need to see the code that generates the manifest resource then."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474468989, "post_id": 39616658, "comment_id": 66545429, "body": "... as well as the code (or tools) used to extract the manifest."}, {"owner": {"reputation": 13, "user_id": 2600754, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001710840958/picture?type=large", "display_name": "Bartosz Jarzyna", "link": "https://stackoverflow.com/users/2600754/bartosz-jarzyna"}, "edited": false, "score": 0, "creation_date": 1474469194, "post_id": 39616658, "comment_id": 66545565, "body": "There&#39;s no code generating the manifest. I guess gcc generates some default manifest. To extract the manifest I used sigcheck program with -m option"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 2600754, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001710840958/picture?type=large", "display_name": "Bartosz Jarzyna", "link": "https://stackoverflow.com/users/2600754/bartosz-jarzyna"}, "is_accepted": false, "score": 0, "last_activity_date": 1474531562, "creation_date": 1474531562, "answer_id": 39633544, "question_id": 39616658, "link": "https://stackoverflow.com/questions/39616658/corrupted-winapi-executable-manifest/39633544#39633544", "title": "Corrupted winapi executable manifest", "body": "<p>Not sure what caused the issue, seems like compiler fault, however it can be worked around by creating winapi resource out of xml file containing a valid manifest. I'll describe the procedure for future reference.</p>\n\n<p>Create a new manifest.rc file, which looks like this:</p>\n\n<pre><code>#include &lt;windows.h&gt;\nRT_MANIFEST BINARY  MOVEABLE PURE \"manifest.xml\"\n</code></pre>\n\n<p>Then create a manifest.xml file containing a valid manifest XML file and add to Makefile:</p>\n\n<pre><code>manifest.o: manifest.rc\n    windres manifest.rc manifest.o\n</code></pre>\n\n<p>Don't forget to add manifest.o to main program recipe in the Makefile:</p>\n\n<pre><code>final.exe: sad.o res.o manifest.o\n    g++ -o final.exe -static-libgcc sad.o res.o resource.o manifest.o -lcomctl32 -lshlwapi -mwindows\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 2600754, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001710840958/picture?type=large", "display_name": "Bartosz Jarzyna", "link": "https://stackoverflow.com/users/2600754/bartosz-jarzyna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474531562, "creation_date": 1474461162, "last_edit_date": 1474510418, "question_id": 39616658, "link": "https://stackoverflow.com/questions/39616658/corrupted-winapi-executable-manifest", "title": "Corrupted winapi executable manifest", "body": "<p>I am developing a Qt application working with XML files. To increase performance, I'm using the pugixml parser instead of Qt's dom parser. After compiling, my application and all dependencies (dll files, helper programs) are packed as a resource of a winapi application to create a single exe file.</p>\n\n<p>Everything was working fine until I needed to replace <code>QString::toStdString()</code> with <code>QString::toStdWString()</code>. The reason for that is reading files with extended letters in names (<code>\u0105\u0119\u015b\u0107\u0142\u00f3\u017a\u017c\u0144</code>) into pugixml. I run <code>pugixml::document::load_file()</code> with data loaded previously by a Qt recursive directory loop. <code>QString</code>s which contain filenames are converted to <code>std::wstring</code> and then to <code>const wchar_t*</code> with <code>qstring.toStdWString().c_str()</code>.</p>\n\n<p>After replacing <code>string</code>s with <code>wstring</code>s, the unpacked executable was working well.  However, after packing it, the final .exe file has a corrupted manifest that looks like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\"&gt;\n  &lt;trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\"&gt;\n    &lt;security&gt;\n      &lt;requestedPrivileges&gt;\n        &lt;requestedExecutionLevel level=\"asInvoker\"/&gt;\n      &lt;/requestedPrivileges&gt;\n    &lt;/security&gt;\n  &lt;/trustInfo&gt;\n  &lt;compatibility xmlns=\"urn:schemas-microsoft-com:compatibility.v1\"&gt;\n    &lt;application&gt;\n      &lt;!--The ID below indicates application support for Windows Vista --&gt;\n      &lt;supportedOS Id=\"{e2011457-1546-43c5-a5fe-008deee3d3f0}\"/&gt;\n      &lt;!--The ID below indicates below indicates application support for Windows\n 7 --&gt;\n      &lt;supportedOS Id=\"{35138b9a-5d96-4fbd-8e2d-a2440225f93a}\"/&gt;\n      &lt;!--The ID below indicates application support for Windows 8 --&gt;\n      &lt;supportedOS Id=\"{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}\"/&gt;\n      &lt;!--The ID below indicates application support for Windows 8.1 --&gt;\n      &lt;supportedOS Id=\"{1f676c76-80e1-4239-95bb-83d0f6d0da78}\"/&gt;\n      &lt;!--The ID below indicates application support for Windows 10 --&gt;\n      &lt;supportedOS Id=\"{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}\"/&gt;\n    &lt;/application&gt;\n  &lt;/compatibili\n</code></pre>\n\n<p>I am using Windows 7 64bit, compiling with MinGw -w64 shell.  The makefile of the final package looks like this:</p>\n\n<pre><code>all: final.exe\n\nfinal.exe: sad.o res.o\n    g++ -o final.exe -static-libgcc sad.o res.o resource.o -lcomctl32 -lshlwapi -mwindows\n\nsad.o: sad.cpp\n    g++ -c sad.cpp\n\nres.o: sad.rc resource.h resource.cpp\n    windres sad.rc res.o\n    g++ -c resource.cpp\n\nclean:\n    rm -f *o final.exe\n</code></pre>\n\n<p>(<code>res.o</code> contains the program and all dependencies packed by windres, <code>sad.cpp</code> contains the winapi program that calls my application from resource).</p>\n"}, {"tags": ["c++", "windows", "winapi", "signals"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1474462542, "post_id": 39616404, "comment_id": 66540734, "body": "I don&#39;t see any error checking. How can you be so sure that any of these function calls actually succeed?"}, {"owner": {"reputation": 450, "user_id": 2805328, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/eab068a023ea2409ff15f3c2fe303a92?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2805328/ben"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1474466028, "post_id": 39616404, "comment_id": 66543228, "body": "@DavidHeffernan I&#39;ve checked the values returned by the functions, they are all not zero, meaning they succeeded."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1474467862, "post_id": 39616404, "comment_id": 66544665, "body": "The documentation of <code>AttachConsole</code> does suggest that you can only attach to <i>other</i> consoles after calling <code>FreeConsole</code>. But that suggestion might be unintended; usually such restrictions are spelled out explicitly."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474468145, "post_id": 39616404, "comment_id": 66544865, "body": "<i>&quot;Works&quot;</i> and <i>&quot;doesn&#39;t work&quot;</i> are too fuzzy to make anything of it. From the sounds of it, though, it appears that this other process is the problem (as evidenced by the manual test). Anyway, you need to properly spell out the expected behavior as well as the observed behavior."}, {"owner": {"reputation": 450, "user_id": 2805328, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/eab068a023ea2409ff15f3c2fe303a92?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2805328/ben"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474488959, "post_id": 39616404, "comment_id": 66556878, "body": "@IInspectable well I&#39;m not sure what you&#39;re expecting, but the expected behaviour is that calling abort() will send ctrl+c to the processes console and close it, and the observed behaviour is that that happens correctly the first time I run the process, but after that nothing happens."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474491355, "post_id": 39616404, "comment_id": 66558166, "body": "I expected to see some sort of evidence, that sending the signal fails, or attaching to the console fails, or that the other process simply fails to respond to it. There are most likely other ways for this to fail. Your description isn&#39;t any more helpful than saying <i>&quot;something went wrong&quot;</i>."}, {"owner": {"reputation": 450, "user_id": 2805328, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/eab068a023ea2409ff15f3c2fe303a92?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2805328/ben"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1474497629, "post_id": 39616404, "comment_id": 66560770, "body": "@IInspectable What do you mean &quot;evidence&quot;? How am I supposed to give evidence, when as I said before, all of the function calls return nonzero and don&#39;t give any error messages?"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1474582462, "post_id": 39616404, "comment_id": 66602759, "body": "At this point I think we need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to make any progress.  Can you reproduce the issue with a built-in child process, e.g., <code>findstr.exe</code> ?  That would simplify things."}, {"owner": {"reputation": 450, "user_id": 2805328, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/eab068a023ea2409ff15f3c2fe303a92?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2805328/ben"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1474619646, "post_id": 39616404, "comment_id": 66614739, "body": "@HarryJohnston I&#39;ve added a complete example to the original post."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1474684483, "post_id": 39616404, "comment_id": 66645147, "body": "Your MCVE as posted still has the bug that I already pointed out.  I&#39;ve added some working code to my answer."}], "answers": [{"comments": [{"owner": {"reputation": 450, "user_id": 2805328, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/eab068a023ea2409ff15f3c2fe303a92?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2805328/ben"}, "edited": false, "score": 0, "creation_date": 1474554087, "post_id": 39628528, "comment_id": 66586706, "body": "Yes, process.exe is a child process. I changed that line to <code>SetConsoleCtrlHandler(0, false);</code>, added a <code>bool f(DWORD){return true;}</code> function, and added <code>SetConsoleCtrlHandler((PHANDLER_ROUTINE)f, false);</code> in main, and I&#39;m still getting the same behaviour as before. I&#39;ve added a link to the first post that shows how the child process is being created, in case that&#39;s the problem."}, {"owner": {"reputation": 450, "user_id": 2805328, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/eab068a023ea2409ff15f3c2fe303a92?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2805328/ben"}, "edited": false, "score": 0, "creation_date": 1474744999, "post_id": 39628528, "comment_id": 66660537, "body": "Thanks! Adding the handler routine function correctly solved the problem. I am having a different, quite strange, problem now though, in that the main process also terminates unless I add a <code>qDebug() &lt;&lt; &quot;some text&quot;;</code> line immediately after calling GenerateConsoleCtrlEvent..."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 450, "user_id": 2805328, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/eab068a023ea2409ff15f3c2fe303a92?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2805328/ben"}, "edited": false, "score": 0, "creation_date": 1474756572, "post_id": 39628528, "comment_id": 66663339, "body": "That <i>does</i> sound like an interaction with Qt, you might need someone familiar with the framework to help with that.  Perhaps post a new question, making sure to include the MCVE and to tag it appropriately.  In case it helps, though, I did find that the parent died if I removed the handler too soon - that&#39;s why my code doesn&#39;t do so until the next call to abortProcess()."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 450, "user_id": 2805328, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/eab068a023ea2409ff15f3c2fe303a92?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2805328/ben"}, "edited": false, "score": 0, "creation_date": 1474756736, "post_id": 39628528, "comment_id": 66663371, "body": "... perhaps abortProcess() should block until the call to HandlerRoutine() has been made?  You could do that using an event object, probably best to use a native one rather than Qt."}], "tags": [], "owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "is_accepted": true, "score": 2, "last_activity_date": 1474684418, "last_edit_date": 1474684418, "creation_date": 1474504782, "answer_id": 39628528, "question_id": 39616404, "link": "https://stackoverflow.com/questions/39616404/c-c-windows-issues-with-attachconsole-and-freeconsole-only-working-once/39628528#39628528", "title": "(C/C++, Windows) Issues with AttachConsole and FreeConsole only working once", "body": "<p>Given the symptoms you describe, my psychic debugging powers tell me that the target process (\"process.exe\") is a child of your process.  Assuming that to be the case, this is your problem:</p>\n\n<pre><code>SetConsoleCtrlHandler(0, true);\n</code></pre>\n\n<p>As described in <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686016(v=vs.85).aspx\" rel=\"nofollow\">the documentation</a>:</p>\n\n<blockquote>\n  <p>If the HandlerRoutine parameter is NULL, a TRUE value causes the calling process to ignore CTRL+C input, and a FALSE value restores normal processing of CTRL+C input. <strong>This attribute of ignoring or processing CTRL+C is inherited by child processes.</strong></p>\n</blockquote>\n\n<p>(Emphasis mine.)  This means that the child processes are being launched with the option to ignore control-C already turned on.</p>\n\n<p>Instead of configuring the process to ignore control-C altogether, assign a control-C handler function that returns <code>TRUE</code>; such a handler will not be inherited by child processes.  Alternatively, if your application is single-threaded, you could just restore the normal configuration before exiting abort():</p>\n\n<pre><code>SetConsoleCtrlHandler(0, FALSE);\n</code></pre>\n\n<hr>\n\n<p>You have now posted a MCVE.  Note that I don't have Qt installed, so I had to simplify the code in order to test it.  It was easy enough to reproduce the problem caused by the abort() function disabling control-C processing, but as soon as I corrected that, the code worked perfectly.  Here is the simplified and corrected code, which works perfectly on my system:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n\nvoid fail(char *msg)\n{\n    MessageBoxA(NULL, msg, \"Oops\", MB_OK);\n    ExitProcess(1);\n}\n\nPROCESS_INFORMATION p;\n\nBOOL WINAPI HandlerRoutine(\n  _In_ DWORD dwCtrlType\n)\n{\n    if (dwCtrlType == CTRL_C_EVENT) return TRUE;\n    return FALSE;\n}\n\n\nvoid abortProcess(void)\n{\n    static BOOL handler_assigned = FALSE;\n    if (handler_assigned)\n    {\n        if (!SetConsoleCtrlHandler(HandlerRoutine, false)) fail(\"Removing handler routine failed\");\n    }\n    if (!AttachConsole(p.dwProcessId)) fail(\"AttachConsole\");\n    if (!SetConsoleCtrlHandler(HandlerRoutine, true)) fail(\"SetConsoleCtrlHandler\");\n    handler_assigned = TRUE;\n    if (!GenerateConsoleCtrlEvent(CTRL_C_EVENT, 0)) fail(\"GenerateConsoleCtrlEvent\");\n    if (!FreeConsole()) fail(\"FreeConsole\");\n}\n\nDWORD WINAPI startProcess(LPVOID * dummy)\n{\n    ZeroMemory(&amp;p, sizeof(p));\n    STARTUPINFOA s;\n    SECURITY_ATTRIBUTES sec;\n    HANDLE read = NULL;\n    HANDLE write = NULL;\n\n    ZeroMemory(&amp;sec, sizeof(sec));\n    sec.nLength = sizeof(SECURITY_ATTRIBUTES);\n    sec.bInheritHandle = true;\n    sec.lpSecurityDescriptor = NULL;\n\n    if(!CreatePipe(&amp;read, &amp;write, &amp;sec, 0)) fail(\"CreatePipe error\");\n    if(!SetHandleInformation(read, HANDLE_FLAG_INHERIT, 0)) fail(\"SetHandleInformation error\");\n\n    ZeroMemory(&amp;s, sizeof(s));\n    s.cb = sizeof(s);\n    s.hStdOutput = write;\n    s.hStdError = write;\n    s.hStdInput = GetStdHandle(STD_INPUT_HANDLE);\n    s.dwFlags |= STARTF_USESTDHANDLES;\n\n    if(!CreateProcessA(\"test1.exe\", \"helloworld\", NULL, NULL, true, CREATE_NO_WINDOW, NULL, NULL, &amp;s, &amp;p)) \n    {\n        fail(\"CreateProcessA error \");\n    }\n\n    CloseHandle(write);\n\n    char buff[65];\n    DWORD bytesRead;\n\n    while(true){\n        if(!ReadFile(read, buff, 64, &amp;bytesRead, NULL)){\n            DWORD dw = GetLastError();\n            if (dw == 0x0000006d) break;\n            fail(\"ReadFile error\");\n        }\n        if(bytesRead &gt; 0){\n            buff[64] = '\\0';\n            MessageBoxA(NULL, buff, \"Output\", MB_OK);\n        }\n    }\n\n    MessageBox(NULL, L\"Child has exited\", L\"Good news\", MB_OK);\n    CloseHandle(p.hProcess);\n    CloseHandle(p.hThread);\n    return 0;\n}\n\nint CALLBACK WinMain(\n  _In_ HINSTANCE hInstance,\n  _In_ HINSTANCE hPrevInstance,\n  _In_ LPSTR     lpCmdLine,\n  _In_ int       nCmdShow\n)\n{\n    HANDLE thread;\n\n    for (;;)\n    {\n        MessageBox(NULL, L\"Press OK to launch child\", L\"so39616404\", MB_OK);\n        thread = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)startProcess, NULL, 0, NULL);\n        if (thread == NULL) fail(\"CreateThread error\");\n        MessageBox(NULL, L\"Press OK to kill child\", L\"so39616404\", MB_OK);\n        abortProcess();\n        if (WaitForSingleObject(thread, INFINITE) != WAIT_OBJECT_0) fail(\"Wait error\");\n    }\n}\n</code></pre>\n\n<p>Note that it proved necessary to reconfigure the handler routine after attaching to each new console, otherwise the parent process died along with the child when the control-C was generated.  I'm not sure whether it is actually necessary to remove the handler routine before re-adding it, but it seems safest.</p>\n\n<p>If your MCVE still doesn't work, please edit your post to show the corrected version.  (There <em>might</em> be some sort of undesired interaction with Qt, I suppose.)</p>\n"}], "owner": {"reputation": 450, "user_id": 2805328, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/eab068a023ea2409ff15f3c2fe303a92?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2805328/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 930, "favorite_count": 3, "accepted_answer_id": 39628528, "answer_count": 1, "score": -1, "last_activity_date": 1474684418, "creation_date": 1474460393, "last_edit_date": 1495541969, "question_id": 39616404, "link": "https://stackoverflow.com/questions/39616404/c-c-windows-issues-with-attachconsole-and-freeconsole-only-working-once", "title": "(C/C++, Windows) Issues with AttachConsole and FreeConsole only working once", "body": "<p>I'm trying to send a ctrl+C signal to the console of another process when a button is clicked, by attaching the current process to its console, sending a ctrl+C signal, then freeing the current process from a console. This works fine the first time, but doesn't do anything the second time.</p>\n\n<pre><code>void abort(){\n    AttachConsole(processInfo.dwProcessId); //processInfo is of type PROCESS_INFORMATION\n    SetConsoleCtrlHandler(0, true);\n    GenerateConsoleCtrlEvent(CTRL_C_EVENT, 0);\n    FreeConsole();\n}\n</code></pre>\n\n<p>Also, even manually clicking in the console and pressing ctrl+C works the first time but not the second. Closing the console manually always works.</p>\n\n<p>process.exe is a child process, and is created in exactly the same way as in <a href=\"https://stackoverflow.com/a/10888698/2805328\">this post</a>.</p>\n\n<hr>\n\n<p>Full code to recreate the problem (using Qt 4.8 with vs2010 compiler on windows 10 for gui/threading):</p>\n\n<p>main.cpp:</p>\n\n<pre><code>#include \"dialog.h\"\n#include &lt;QApplication&gt;\n\nint main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n    Dialog w;\n    w.show();\n\n    return a.exec();\n}\n</code></pre>\n\n<p>dialog.h:</p>\n\n<pre><code>#ifndef DIALOG_H\n#define DIALOG_H\n\n#include &lt;QDialog&gt;\n#include \"ui_dialog.h\"\n#include \"worker.h\"\n\nnamespace Ui {\nclass Dialog;\n}\n\nclass Dialog : public QDialog\n{\n    Q_OBJECT\n\npublic:\n    explicit Dialog(QWidget *parent = 0):\n        QDialog(parent),\n        ui(new Ui::Dialog),\n        w(new worker()),\n        t(new QThread(this))\n    {\n        ui-&gt;setupUi(this);\n        connect(ui-&gt;startButton, SIGNAL(clicked(bool)), this, SLOT(startProcess()));\n        connect(ui-&gt;abortButton, SIGNAL(clicked(bool)), this, SLOT(abortProcess()));\n        connect(w, SIGNAL(finished()), t, SLOT(quit()));\n\n        w-&gt;setup(t);\n        w-&gt;moveToThread(t);\n    }\n\n    ~Dialog(){delete ui;}\n\nprivate slots:\n    void startProcess(){\n        t-&gt;start();\n    }\n\n    void abortProcess(){\n        w-&gt;abort();\n        t-&gt;quit();\n    }\n\nprivate:\n    Ui::Dialog *ui;\n    worker *w;\n    QThread *t;\n\n};\n\n#endif // DIALOG_H\n</code></pre>\n\n<p>worker.h:</p>\n\n<pre><code>#ifndef WORKER_H\n#define WORKER_H\n\n#include &lt;QDebug&gt;\n#include &lt;QObject&gt;\n#include &lt;QThread&gt;\n#include &lt;Windows.h&gt;\n\nclass worker : public QObject\n{\n    Q_OBJECT\npublic:\n    explicit worker(QObject *parent = 0):QObject(parent){}\n    void setup(QThread *t){\n        connect(t, SIGNAL(started()), this, SLOT(startProcess()));\n    }\n    void abort(){\n        if(!AttachConsole(p.dwProcessId)) qDebug() &lt;&lt; \"AttachConsole\" &lt;&lt; GetLastError();\n        if(!SetConsoleCtrlHandler(0, true)) qDebug() &lt;&lt; \"SetConsoleCtrlHandler\" &lt;&lt; GetLastError();\n        if(!GenerateConsoleCtrlEvent(CTRL_C_EVENT, 0)) qDebug() &lt;&lt; \"GenerateConsoleCtrlEvent\" &lt;&lt; GetLastError();\n        if(!FreeConsole()) qDebug() &lt;&lt; \"FreeConsole\" &lt;&lt; GetLastError();\n    }\n\nprivate slots:\n    void startProcess(){\n        ZeroMemory(&amp;p, sizeof(p));\n        STARTUPINFOA s;\n        SECURITY_ATTRIBUTES sec;\n        HANDLE read = NULL;\n        HANDLE write = NULL;\n\n        ZeroMemory(&amp;sec, sizeof(sec));\n        sec.nLength = sizeof(SECURITY_ATTRIBUTES);\n        sec.bInheritHandle = true;\n        sec.lpSecurityDescriptor = NULL;\n\n        if(!CreatePipe(&amp;read, &amp;write, &amp;sec, 0)) qDebug() &lt;&lt; \"CreatePipe error\" &lt;&lt; GetLastError();\n        if(!SetHandleInformation(read, HANDLE_FLAG_INHERIT, 0)) qDebug() &lt;&lt; \"SetHandleInformation error\" &lt;&lt; GetLastError();\n\n        ZeroMemory(&amp;s, sizeof(s));\n        s.cb = sizeof(s);\n        s.hStdOutput = write;\n        s.hStdError = write;\n        s.hStdInput = GetStdHandle(STD_INPUT_HANDLE);\n        s.dwFlags |= STARTF_USESTDHANDLES;\n\n        if(!CreateProcessA(\"helloworld.exe\", \"helloworld\", NULL, NULL, true, CREATE_NO_WINDOW, NULL, NULL, &amp;s, &amp;p)) qDebug() &lt;&lt; \"CreateProcessA error \" &lt;&lt; GetLastError() &lt;&lt; \"\\n\";\n\n        CloseHandle(write);\n\n        char buff[65];\n        DWORD bytesRead;\n\n        while(true){\n            if(!ReadFile(read, buff, 64, &amp;bytesRead, NULL)){\n                qDebug() &lt;&lt; \"ReadFile error\";\n                break;\n            }\n            if(bytesRead &gt; 0){\n                buff[64] = '\\0';\n                qDebug() &lt;&lt; QByteArray(buff);\n            }\n        }\n\n        CloseHandle(p.hProcess);\n        CloseHandle(p.hThread);\n\n        emit finished();\n    }\n\nprivate:\n    PROCESS_INFORMATION p;\n\nsignals:\n    void finished();\n\n};\n\n#endif // WORKER_H\n</code></pre>\n\n<p>The UI just contains 2 buttons, startButton and abortButton. helloworld.exe is just a program that prints \"Hello world!\" and then waits for input. When startButton is clicked, the process is created, and the output is redirected to my program correctly. When abortButton is clicked, the process is terminated correctly. startProcess works perfectly the second time as well, but now, clicking abortButton does not work. The abort() function is called, and no error messages are printed, but the helloworld process fails to terminate, and the QThread t does not quit.</p>\n"}, {"tags": ["c++", "object-construction"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1474460914, "post_id": 39616384, "comment_id": 66539530, "body": "2) yes, why does your base class need to know about the derived one in its constructor?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1474461024, "post_id": 39616384, "comment_id": 66539607, "body": "The derived class is not constructed until after its base classes are constructed. This is UB."}, {"owner": {"reputation": 4713, "user_id": 6799654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbfa65b345b86c22a77eb3f457c99f35?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Guseynov", "link": "https://stackoverflow.com/users/6799654/alexey-guseynov"}, "edited": false, "score": 0, "creation_date": 1474461213, "post_id": 39616384, "comment_id": 66539737, "body": "You operate fData before it&#39;s constructor has been called, so it is an UB."}, {"owner": {"reputation": 270, "user_id": 5755285, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be990ea29fb756edb0b98baa1a021d47?s=128&d=identicon&r=PG&f=1", "display_name": "Tongxuan Liu", "link": "https://stackoverflow.com/users/5755285/tongxuan-liu"}, "edited": false, "score": 0, "creation_date": 1474469172, "post_id": 39616384, "comment_id": 66545549, "body": "Base class try to initial derived class member variable or even change derived class&#39;s member variable is a kind of breaking encapsulation."}], "answers": [{"tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 3, "last_activity_date": 1474461660, "last_edit_date": 1474461660, "creation_date": 1474461191, "answer_id": 39616671, "question_id": 39616384, "link": "https://stackoverflow.com/questions/39616384/initialize-derived-class-member-variable-before-calling-base-class-constructor/39616671#39616671", "title": "Initialize Derived class member variable before calling Base class constructor. Is this UB?", "body": "<blockquote>\n  <p>I would like to initialize a member variable of a Derived class, and after that pass it to the Base class constructor.</p>\n</blockquote>\n\n<p>In C++, the order of construction is of the base part(s) before the derived parts. This is because it is far more common for the derived parts to (potentially) be constructed in terms of the base parts. In order to make this well-defined, the base-then-derived order is specified. Using derived in the base is undefined, therefore.</p>\n\n<p>If you want your base to use derived members, there's a way to ensure the order is OK. Make the \"members\" base classes too. Note that <a href=\"http://www.boost.org/doc/libs/1_39_0/libs/utility/base_from_member.html\" rel=\"nofollow\"><code>boost::base_from_member</code></a> is built exactly for making this more convenient.</p>\n\n<p>Say you have some</p>\n\n<pre><code>class member_type{};\n</code></pre>\n\n<p>And you'd like to have <code>derived</code> have a <code>member_type</code> member, and derive from <code>base</code>. Then you could use:</p>\n\n<pre><code>class derived : \n    private boost::base_from_member&lt;member_type&gt;,\n    public base {\n    using my_member_type = private boost::base_from_member&lt;member_type&gt;;\n\npublic:\n    derived();\n};\n</code></pre>\n\n<p>Note that now <code>derived</code> subclasses both <code>my_member_type</code> and <code>base</code> (in that order). Hence, the latter can use the former in its construction.</p>\n\n<pre><code>derived::derived() : \n    my_member_type{3},\n    base{my_member_type::member} {\n}\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5470310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f52f7dae806c10a689e2b0ac4f70b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Iurii Sorokin", "link": "https://stackoverflow.com/users/5470310/iurii-sorokin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2357, "favorite_count": 3, "accepted_answer_id": 39616671, "answer_count": 1, "score": 5, "last_activity_date": 1474461660, "creation_date": 1474460342, "last_edit_date": 1474460777, "question_id": 39616384, "link": "https://stackoverflow.com/questions/39616384/initialize-derived-class-member-variable-before-calling-base-class-constructor", "title": "Initialize Derived class member variable before calling Base class constructor. Is this UB?", "body": "<p>I would like to initialize a member variable of a Derived class, and after that pass it to the Base class constructor. I came up with the solution below (also here: <a href=\"http://cpp.sh/4uu4q\" rel=\"noreferrer\">http://cpp.sh/4uu4q</a>)</p>\n\n<p>1) Does the following code have a defined or an undefined behavior (UB) ? </p>\n\n<p>2) Is what I am attempting to do an indication of a bad design?</p>\n\n<pre><code>struct Data {\n    int fValue;\n\n    Data( int value = -1 ) : fValue( value )\n    {}\n};\n\n\nstruct Base {\n    Base( const std::unique_ptr&lt;Data&gt; &amp; derivedData ) {\n        std::cout &lt;&lt; \"Constructing Base derivedData=\" &lt;&lt; derivedData-&gt;fValue &lt;&lt; std::endl;\n    }\n};\n\n\nstruct Derived : public Base {\n    std::unique_ptr&lt;Data&gt; fData = std::move( fData );\n\n    Derived() : Base( ConstructData() )\n    {}\n\n    const std::unique_ptr&lt;Data&gt; &amp; ConstructData() {\n        fData.release();\n        fData.reset( new Data(777) );\n        std::cout &lt;&lt; \"in ConstructData: fData-&gt;fValue =\" &lt;&lt; fData-&gt;fValue &lt;&lt; std::endl;\n        return fData;\n    }\n};\n\n\nint main() {\n    Derived d;\n    std::cout &lt;&lt; \"In main: d.fData-&gt;fValue =\" &lt;&lt; d.fData-&gt;fValue &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1474460734, "post_id": 39616314, "comment_id": 66539409, "body": "It gives freedom to compiler writers to organise data with different access controls differently. What the original rationale for that was I cannot tell you - probably extremely historic (back to the days when c++ was basically a pre-processor for c)."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1474460939, "post_id": 39616314, "comment_id": 66539549, "body": "PODness is about layout, not access. Only non-static data members participate in layout. (And the layout is grouped by access level and indeterminate across different access levels.)"}], "answers": [{"tags": [], "owner": {"reputation": 3852, "user_id": 155191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a7azq.jpg?s=128&g=1", "display_name": "Leandro T. C. Melo", "link": "https://stackoverflow.com/users/155191/leandro-t-c-melo"}, "is_accepted": true, "score": 1, "last_activity_date": 1474510362, "creation_date": 1474510362, "answer_id": 39629187, "question_id": 39616314, "link": "https://stackoverflow.com/questions/39616314/method-access-control-and-pod/39629187#39629187", "title": "Method access control and POD", "body": "<p>Functions don't play a significant role because they are not stored within the object. A member function is just a plain function with a implicit parameter (<em>this</em>) inserted by the compiler. Only non-static <strong>data</strong> members are laid in memory as part of the object.</p>\n\n<p>As the docs mention, one of the requirements of a POD is that access control for all non-static data members is the same. Even though your <code>OK</code> struct has a private integer, it's the only one, so that's not a problem. But if you add a public <code>int b;</code> you should see the same result as for your <code>KO</code> type (regardless of the <code>Bar</code> and <code>Foo</code> functions). </p>\n"}], "owner": {"reputation": 1988, "user_id": 4717805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-xAnHpORfxvE/AAAAAAAAAAI/AAAAAAAAACE/QzOPrCINbew/photo.jpg?sz=128", "display_name": "Zouch", "link": "https://stackoverflow.com/users/4717805/zouch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 39629187, "answer_count": 1, "score": 1, "last_activity_date": 1474510362, "creation_date": 1474460164, "question_id": 39616314, "link": "https://stackoverflow.com/questions/39616314/method-access-control-and-pod", "title": "Method access control and POD", "body": "<p>According to <a href=\"http://en.cppreference.com/w/cpp/concept/StandardLayoutType\" rel=\"nofollow\">the docs</a></p>\n\n<blockquote>\n  <p>All non-static data members have the same access control</p>\n</blockquote>\n\n<p>and <a href=\"http://ideone.com/r9EXg0\" rel=\"nofollow\">this piece of code</a></p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct KO\n{\n    int a;\nprivate:\n    int b;\n};\n\nstruct OK\n{\n    void Foo() { a = 42; }\nprivate:\n    void Bar() { a = 43; }\n\n    int a;\n};\n\nint main() {\n    // your code goes here\n    std::cout &lt;&lt; std::boolalpha;\n    std::cout &lt;&lt; std::is_pod&lt;KO&gt;::value &lt;&lt; std::endl;\n    std::cout &lt;&lt; std::is_pod&lt;OK&gt;::value &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>a structure is not a POD when data members have different access control, but no mention is done about function members, and they actually are PODs despite having different access controls. </p>\n\n<p>Why is that ? What is the difference between data and function access controls in C++ structs ?</p>\n"}, {"tags": ["c++", "eigen3", "odeint"], "answers": [{"tags": [], "owner": {"reputation": 6610, "user_id": 6541659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b9f448206061d0711752562bfaf0546?s=128&d=identicon&r=PG&f=1", "display_name": "aichao", "link": "https://stackoverflow.com/users/6541659/aichao"}, "is_accepted": true, "score": 0, "last_activity_date": 1474491036, "creation_date": 1474491036, "answer_id": 39626366, "question_id": 39616247, "link": "https://stackoverflow.com/questions/39616247/using-several-eigen-matrices-as-statetypes-in-boost-odeint/39626366#39626366", "title": "using several eigen matrices as statetypes in boost/odeint", "body": "<p>The issue is that you did not define the <code>operator+</code> between <code>double</code> and <code>state</code>. Add the following, and the code should at least compile.</p>\n\n<pre><code>state operator+( const state &amp;lhs , double rhs ){\n  return state( lhs.M1+rhs ,lhs.M2+rhs);\n}\n\nstate operator+( double lhs , const state &amp;rhs ){\n  return state( lhs+rhs.M1 ,lhs+rhs.M2);\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6742641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f707c6eee6dd5055f35312aea90c0b13?s=128&d=identicon&r=PG&f=1", "display_name": "somnium", "link": "https://stackoverflow.com/users/6742641/somnium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 1, "accepted_answer_id": 39626366, "answer_count": 1, "score": 2, "last_activity_date": 1603449540, "creation_date": 1474459973, "last_edit_date": 1603449540, "question_id": 39616247, "link": "https://stackoverflow.com/questions/39616247/using-several-eigen-matrices-as-statetypes-in-boost-odeint", "title": "using several eigen matrices as statetypes in boost/odeint", "body": "<p>I am working on a physics problem for which I have to evolve parameters according to ODEs. From time to time they have to manipulated so that I would like to have a data type that can be used with routines such as diagonalisation,... Therefore, I implemented a class with eigen::Matrix as members and want to perform the integration with odeint. For a single eigen::matrix this worked fine. I made a minimal example:</p>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;cmath&gt;\n#include &lt;string&gt;\n\n#include &lt;Eigen/Core&gt; \n#include &lt;boost/numeric/odeint.hpp&gt;\n#include &lt;boost/numeric/odeint/external/eigen/eigen_algebra.hpp&gt;\n\n// define vector_space_algebra for Eigen::Matrix\nnamespace boost::numeric::odeint {\n  template&lt;typename B,int S1,int S2,int O, int M1, int M2&gt;\n  struct algebra_dispatcher&lt; Eigen::Matrix&lt;B,S1,S2,O,M1,M2&gt; &gt;{\n    typedef vector_space_algebra algebra_type;\n  };\n}\n\n// define abs() for Eigen::Matrix\nnamespace Eigen {\n  template&lt;typename D, int Rows, int Cols&gt;\n  Matrix&lt;D, Rows, Cols&gt; abs(Matrix&lt;D, Rows, Cols&gt; const&amp; m) {\n    return m.cwiseAbs();\n  }\n}\n\ntypedef Eigen::Matrix&lt;double, 3,3&gt; mat;\nusing namespace Eigen;\nusing namespace std;\n\nclass state {\n public:\n\n  // state components\n  Eigen::Matrix&lt;double, 3,3&gt; M1, M2;\n\n  // constructors\n  state() : M1(), M2() {};      // constructors\n  state(mat M1in, mat M2in) : M1(M1in), M2(M2in) {};\n\n\n  // in place addition and multiplication\n  state operator+=(const state &amp; X){\n    M1 += X.M1; M2 += X.M2;\n    return *this;\n  }\n\n  state operator*=(const double a){\n    M1 *= a; M2 *= a;\n    return *this;\n  }\n\n  // ODE\n  void operator() ( const state &amp; X , state &amp; dX, const double ){\n    dX.M1 = X.M1*X.M2.adjoint()*X.M2;\n    dX.M2 = X.M2*X.M1.adjoint()*X.M1;\n  }\n};\n\n\n// vector space operations\n\nstate operator+( const state &amp;lhs , const state &amp;rhs ){\n  return state( lhs.M1+rhs.M1 ,lhs.M2+rhs.M2);\n}\n\nstate operator*( const state &amp;lhs , const double &amp;rhs ){\n  return state( lhs.M1*rhs ,lhs.M2*rhs);\n}\n\nstate operator*( const double &amp;lhs , const state &amp;rhs ){\n  return state( lhs*rhs.M1 ,lhs*rhs.M2);\n}\n\nstate operator/( const state &amp;lhs , const state &amp;rhs ){\n  return state( lhs.M1.cwiseQuotient(rhs.M1), lhs.M2.cwiseQuotient(rhs.M2) );\n}\nstate abs( const state &amp;X ){\n  return state( abs(X.M1) , abs(X.M2) );\n}\n\n\n// lp infinity norm\nnamespace boost::numeric::odeint {\n  template&lt;&gt;\n  struct vector_space_norm_inf&lt; state &gt; {\n    typedef double result_type;\n    double operator()( const state &amp;X ) const {\n      return max( X.M1.lpNorm&lt;Infinity&gt;() , X.M2.lpNorm&lt;Infinity&gt;() );\n    }\n  };\n}\n\n\n//write to std output\nvoid write( state &amp;x , const double t ){\n  cout &lt;&lt; t &lt;&lt; &quot;\\t&quot; &lt;&lt; x.M1 &lt;&lt; &quot;\\t&quot; &lt;&lt; x.M2 &lt;&lt; &quot;\\n&quot;;\n}\n\n\n//\n// int main\n//\nint main(int argc, char* argv[]){\n\n  // set values\n  mat M1, M2;\n  double t_end = 1;\n  double t_start = 10;\n\n  M1 &lt;&lt; 0.1,0,0, 0,0.2,0.1 ,0.2,0,0.3;\n  M2 &lt;&lt; 0.5,0,0, 0,0.6,0, 0,0,0.7;\n\n  state values(M1,M2);\n\n  using namespace boost::numeric::odeint;\n\n  // type definition for numerical integration\n  typedef runge_kutta_dopri5&lt; state , double, state , double,     vector_space_algebra &gt; stepper;\n\n  // integration\n  int steps = integrate_adaptive( make_controlled&lt;stepper&gt;( 1E-10 , 1E-10     ) , state() , values , t_start , t_end , 0.01);\n\n  //output\n  write(values,t_end);\n  return(0);\n}\n</code></pre>\n<p>Basically, this is the example taken from <a href=\"https://github.com/headmyshoulder/odeint-v2/blob/master/examples/my_vector.cpp\" rel=\"nofollow noreferrer\">here</a></p>\n<p>When I comment out the line starting with &quot;int steps&quot;, g++ on mac (I know, thats something different, what the errors are way more readable...) compiles without errors. Otherwise, I get</p>\n<pre><code>In file included from minimal.cpp:7:\nIn file included from /usr/local/include/boost/numeric/odeint.hpp:25:\nIn file included from /usr/local/include/boost/numeric/odeint/util/ublas_wrapper.hpp:30:\n/usr/local/include/boost/numeric/odeint/algebra/default_operations.hpp:443:76: error: \n      invalid operands to binary expression ('double' and 'state')\n  ...m_eps_abs + m_eps_rel * ( m_a_x * abs( get_unit_value( t1 ) ) + m_a_dxdt * abs( get_unit_value( t2 ) ) )...\n</code></pre>\n<p>Since it is not declared in that file, I did not understand, what the function <code>get_unit_value()</code> does or wants from me. It seems to have something to do with the error estimation or at least with performing a certain step in the integration. How can I fix it?</p>\n"}, {"tags": ["c++", "templates", "function-pointers", "c++03"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1474460347, "post_id": 39616058, "comment_id": 66539156, "body": "It looks like you are trying to re-implement a portion of std::bind. In C++03 this portion is provided by std::bind1st."}, {"owner": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1474460648, "post_id": 39616058, "comment_id": 66539359, "body": "@n.m. yeah, I&#39;m aware that this is similar. In my use case, the constant argument is not always the first, I need some functionality to specify the index of the &quot;variable argument&quot; which will be specified in the function operator of the returned function object. I&#39;m able to do this part already, I&#39;m just stuck with the type inference for function objects. Not sure one could do the same for <code>std::bind</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "edited": false, "score": 0, "creation_date": 1474460452, "post_id": 39616316, "comment_id": 66539224, "body": "Ooopsy I wanted to do it exactly the same like but it apparently needs c++11"}, {"owner": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "edited": false, "score": 0, "creation_date": 1474460459, "post_id": 39616316, "comment_id": 66539232, "body": "This works but it seems difficult to use. I&#39;d like <code>Infer</code> to infer the types automatically, rather than by the caller having to write them out."}, {"owner": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "reply_to_user": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "edited": false, "score": 0, "creation_date": 1474460564, "post_id": 39616316, "comment_id": 66539304, "body": "@theswine are you sure you need c++03 approach?"}, {"owner": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "edited": false, "score": 0, "creation_date": 1474460751, "post_id": 39616316, "comment_id": 66539416, "body": "I have a huge project which is in C++03, I&#39;m not going to migrate everything to C++11 because of this feature which is relatively minor in the scope of the project. I&#39;m not sure why wouldn&#39;t your approach work in C++03 though, just drop the curly brackets in the second and third last lines of the code and replace them by round ones. Is there something else?"}, {"owner": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "edited": false, "score": 0, "creation_date": 1474460908, "post_id": 39616316, "comment_id": 66539526, "body": "I&#39;m not sure it adds anything new though."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "edited": false, "score": 0, "creation_date": 1474461194, "post_id": 39616316, "comment_id": 66539728, "body": "@theswine Just modified, I suspect the easiest way to have it working with C++03 is by using an intermediate function and that&#39;s all."}, {"owner": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "edited": false, "score": 0, "creation_date": 1474461248, "post_id": 39616316, "comment_id": 66539760, "body": "@skypjack The problem now is that the inner function knows the types. But how do you get them out?"}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "edited": false, "score": 0, "creation_date": 1474461327, "post_id": 39616316, "comment_id": 66539823, "body": "@theswine By calling directly the outer function if the default method is not the one you want to use. I don&#39;t get the problem, it looks like you want to provide a default choice, but also you don&#39;t want to provide it. I guess I missed something from your question and I apologize for this."}, {"owner": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "edited": false, "score": 0, "creation_date": 1474461426, "post_id": 39616316, "comment_id": 66539890, "body": "@skypjack No need to appologise :). What I want out is a function object which I can pass to e.g. <code>std::transform</code> or whatever, as in the case of <code>CMyWrapper</code>."}], "tags": [], "owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "is_accepted": false, "score": 1, "last_activity_date": 1474461069, "last_edit_date": 1474461069, "creation_date": 1474460167, "answer_id": 39616316, "question_id": 39616058, "link": "https://stackoverflow.com/questions/39616058/retrieve-argument-type-of-function-operator-of-an-object/39616316#39616316", "title": "Retrieve argument type of function operator of an object", "body": "<p>I'm not sure I got the question, but probably you mean something like this?</p>\n\n<pre><code>struct X {};\nstruct Y {};\n\ntemplate &lt;class R, class A0, class A1, class F, R(F::*)(const A0 &amp;, const A1 &amp;) = &amp;F::operator()&gt;\nvoid Infer(F f) { }\n\nstruct S {\n    void operator()(const X &amp;, const Y &amp;) { }\n    void foo(const X &amp;, const Y &amp;) { }\n};\n\nint main() {\n    Infer&lt;void, X, Y&gt;(S{});\n    Infer&lt;void, X, Y, S, &amp;S::foo&gt;(S{});\n}\n</code></pre>\n\n<p>As from the comments, this should work in C++03:</p>\n\n<pre><code>struct X {};\nstruct Y {};\n\ntemplate &lt;class R, class A0, class A1, class F&gt;\nvoid Infer(F f, R(F::*ptr)(const A0 &amp;, const A1 &amp;)) { (f.*ptr)(A0(), A1()); }\n\ntemplate&lt;class F&gt;\nvoid Infer(F f) {\n    Infer(f, &amp;F::operator());\n}\n\nstruct S {\n    void operator()(const X &amp;, const Y &amp;) { }\n    void foo(const int &amp;, const char &amp;) { }\n};\n\nint main() {\n    Infer(S());\n    Infer(S(), &amp;S::foo);\n}\n</code></pre>\n\n<p>This way, you can either specify the method to be called or rely on an intermediate function that explicitly pushes it as an argument.</p>\n"}, {"comments": [{"owner": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "edited": false, "score": 0, "creation_date": 1474460323, "post_id": 39616343, "comment_id": 66539145, "body": "Right, I see I oversimplified the example. Assuming that <code>Infer</code> would need to return the same type as <code>F::operator ()</code>, how would I get that to the outer function? It is easz to get it in the inner."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "edited": false, "score": 0, "creation_date": 1474461595, "post_id": 39616343, "comment_id": 66540014, "body": "@theswine I don&#39;t know if there is a way to do what you want (according to Barry there is not). I updated my answer providing a way to do like Barry but without modifying the functors."}], "tags": [], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "is_accepted": false, "score": 1, "last_activity_date": 1474461553, "last_edit_date": 1495535244, "creation_date": 1474460232, "answer_id": 39616343, "question_id": 39616058, "link": "https://stackoverflow.com/questions/39616058/retrieve-argument-type-of-function-operator-of-an-object/39616343#39616343", "title": "Retrieve argument type of function operator of an object", "body": "<p>You can simply use an intermediate function:</p>\n\n<pre><code>template &lt;class F, class R, class A0, class A1&gt;\nvoid Infer(F f, R (F::*fun)(const A0 &amp;a0, const A1 &amp;a1));\n\ntemplate &lt;class F&gt;\nvoid Infer(F f) {\n    Infer(f, &amp;F::operator());\n}\n\nInfer(CMyFunObj());\n</code></pre>\n\n<p>If you need to infer the type, you can do <a href=\"https://stackoverflow.com/a/39616486/2666289\">as Barry says</a>, and if you do not want to modify your functors, you can use an external helper class:</p>\n\n<pre><code>template &lt;class U&gt;\nstruct result_type;\n\ntemplate &lt;typename F&gt;\ntypename result_type&lt;F&gt;::type Infer(F f) {\n    return Infer(f, &amp;F::operator());\n}\n</code></pre>\n\n<p>And then later:</p>\n\n<pre><code>struct CMyFunObj {\n    double operator ()(const double&amp; x, const double&amp; y) { return x + y; }\n};\n\ntemplate &lt;&gt;\nstruct result_type&lt;CMyFunObj&gt; {\n    typedef double type;\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "edited": false, "score": 0, "creation_date": 1474465589, "post_id": 39616486, "comment_id": 66542862, "body": "Eh, after a bit of trudging with <code>typeof</code>, I get <code>sorry, unimplemented: mangling typeof, use decltype instead</code>. Seems like it indeed can&#39;t be done."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 2, "last_activity_date": 1474460688, "creation_date": 1474460688, "answer_id": 39616486, "question_id": 39616058, "link": "https://stackoverflow.com/questions/39616058/retrieve-argument-type-of-function-operator-of-an-object/39616486#39616486", "title": "Retrieve argument type of function operator of an object", "body": "<p>In C++03, you can't really infer the type like that (unless you want to use like <code>typeof</code>), so you have to actually provide it:</p>\n\n<pre><code>struct CMyFunObj {\n    typedef double result_type;\n    double operator()(const double &amp;x, const double &amp;y);\n};\n</code></pre>\n\n<p>And now you can use that additional bit of information:</p>\n\n<pre><code>template &lt;class F, class A0&gt;\nCMyWrapper&lt;typename F::result_type, F, A0&gt;\nSupplyConstArg(F f, A0 const&amp; a0) {\n    return CMyWrapper&lt;typename F::result_type, F, A0&gt;(f, a0);\n}\n\nSupplyConstArg(CMyFunObj(), 4.0)(5.0);\n</code></pre>\n\n<p>You don't need the type <code>A1</code> in <code>CMyWrapper</code>, that can be a template argument on its <code>operator()</code>. </p>\n"}], "owner": {"reputation": 9813, "user_id": 1140976, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2dd40d188157475a45d618547c65d81?s=128&d=identicon&r=PG", "display_name": "the swine", "link": "https://stackoverflow.com/users/1140976/the-swine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 39616486, "answer_count": 3, "score": 2, "last_activity_date": 1474462973, "creation_date": 1474459379, "last_edit_date": 1474462973, "question_id": 39616058, "link": "https://stackoverflow.com/questions/39616058/retrieve-argument-type-of-function-operator-of-an-object", "title": "Retrieve argument type of function operator of an object", "body": "<p>I have a wrapper which transforms functions taking several arguments into functions taking just a single argument (values for the other arguments are provided). This code works with <em>functions</em>:</p>\n\n<pre><code>template &lt;class R, class F, class A0, class A1&gt;\nclass CMyWrapper {\n     F m_f;\n     A0 m_default_a0;\n\npublic:\n     CMyWrapper(F f, const A0 &amp;default_a0)\n         :m_f(f), m_default_a0(default_a0)\n     {}\n\n     R operator ()(const A1 &amp;a1) const\n     {\n         return m_f(m_default_a0, a1);\n     }\n};\n\ntemplate &lt;class R, class A0, class A1&gt;\nCMyWrapper&lt;R, R (*)(const A0&amp;, const A1&amp;), A0, A1&gt;\n    SupplyConstArg(R (*fun)(const A0&amp;, const A1&amp;), const A0 &amp;default_a0)\n{\n    return CMyWrapper&lt;R, R (*)(const A0&amp;, const A1&amp;), A0, A1&gt;(fun, default_a0);\n}\n\ndouble MyFunc(const double &amp;x, const double &amp;y); // some function\n</code></pre>\n\n<p>so now I can do e.g. <code>SupplyConstArg(MyFunc, 1.23)(4.56)</code> which calls <code>MyFunc(1.23, 4.56)</code> (the left part of this expression is a function object which supplies a constant first argument). So far so good.</p>\n\n<p>However, I have some difficulties in writing a similar function working for <em>function objects</em> rather than functions (I'd like to avoid function pointers for performance reasons where possible). Assuming:</p>\n\n<pre><code>struct CMyFunObj {\n    double operator ()(const double &amp;x, const double &amp;y);\n};\n</code></pre>\n\n<p>my problem is <strong>how do I match the return type or the types of the arguments, given an instance of such function object</strong>? So far, I came up with:</p>\n\n<pre><code>template &lt;class F, class R, class A0, class A1&gt;\nR Infer(F f, R (F::*fun)(const A0 &amp;a0, const A1 &amp;a1) = &amp;F::operator ());\n</code></pre>\n\n<p>which sort of works, but only if the second argument is also specified, e.g. by calling:</p>\n\n<pre><code>Infer(CMyFunObj(), &amp;CMyFunObj::operator ());\n</code></pre>\n\n<p>but not if I omit the second argument and rely on the default value. Any ideas how to do it in C++03?</p>\n"}, {"tags": ["c++", "c++11", "random"], "answers": [{"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 7, "last_activity_date": 1474460528, "last_edit_date": 1474460528, "creation_date": 1474459546, "answer_id": 39616125, "question_id": 39615931, "link": "https://stackoverflow.com/questions/39615931/making-own-random-number-class-compitible-with-uniform-int-distribution/39616125#39616125", "title": "Making own random number class compitible with uniform_int_distribution", "body": "<p>Modelling the UniformRandomBitGenerator concept should do it:</p>\n\n<p><a href=\"http://en.cppreference.com/w/cpp/concept/UniformRandomBitGenerator\" rel=\"noreferrer\">http://en.cppreference.com/w/cpp/concept/UniformRandomBitGenerator</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/oYp71.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/oYp71.png\" alt=\"Screenshot of the concept&#39;s requirements\"></a></p>\n\n<p>Something like this:</p>\n\n<pre><code>#include &lt;limits&gt;\n\nclass MersenneTwister\n{\npublic:\n    void initialize(unsigned int seed);\n    unsigned int extract();\n\n    //\n    // model the concept here\n    //\n\n    using result_type = unsigned int;\n    static constexpr result_type min() { return std::numeric_limits&lt;result_type&gt;::min(); }\n    static constexpr result_type max() { return std::numeric_limits&lt;result_type&gt;::max(); }\n    result_type operator()()\n    {\n        return extract();\n    }\n\nprivate:\n    unsigned int twist();\n    unsigned int _x[624];\n    signed int _index;\n};\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 5410553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d78e6816b28fed17e3d16932b13c97af?s=128&d=identicon&r=PG&f=1", "display_name": "DoeUS", "link": "https://stackoverflow.com/users/5410553/doeus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 39616125, "answer_count": 1, "score": 0, "last_activity_date": 1474460528, "creation_date": 1474459061, "question_id": 39615931, "link": "https://stackoverflow.com/questions/39615931/making-own-random-number-class-compitible-with-uniform-int-distribution", "title": "Making own random number class compitible with uniform_int_distribution", "body": "<p>I created a class which is implementing MersenneTwister algorithm to generate pseudo-random numbers. My question is how can I make my generator work with default std::uniform_int_distribution? Header of my class is given below:</p>\n\n<pre><code>class MersenneTwister\n{\npublic:\n    void initialize(unsigned int seed);\n    unsigned int extract();\n\nprivate:\n    unsigned int twist();\n    unsigned int _x[624];\n    signed int _index;\n};\n</code></pre>\n"}, {"tags": ["c++", "algorithm", "graph-algorithm", "flood-fill"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1474458372, "post_id": 39615622, "comment_id": 66537898, "body": "You pass <code>gameGrid</code> and <code>checked</code> by copy instead of by const references..."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1474458414, "post_id": 39615622, "comment_id": 66537918, "body": "I think you will have better answer on <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 195, "user_id": 3560330, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1612bb4174235e68972b3533aff6051b?s=128&d=identicon&r=PG&f=1", "display_name": "bi0phaz3", "link": "https://stackoverflow.com/users/3560330/bi0phaz3"}, "edited": false, "score": 0, "creation_date": 1474458505, "post_id": 39615622, "comment_id": 66537966, "body": "gameGrid is static it&#39;s just a test only the function manipulates it to check the area. Also checked is supposed to be local I don&#39;t know why I put that as a function param"}, {"owner": {"reputation": 22622, "user_id": 148897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7u1oT.jpg?s=128&g=1", "display_name": "Henrik", "link": "https://stackoverflow.com/users/148897/henrik"}, "edited": false, "score": 1, "creation_date": 1474460705, "post_id": 39615622, "comment_id": 66539393, "body": "Is this your real code? <code>if(checked[curPoint.toPair()]) break;</code> looks odd."}, {"owner": {"reputation": 195, "user_id": 3560330, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1612bb4174235e68972b3533aff6051b?s=128&d=identicon&r=PG&f=1", "display_name": "bi0phaz3", "link": "https://stackoverflow.com/users/3560330/bi0phaz3"}, "edited": false, "score": 0, "creation_date": 1474501269, "post_id": 39615622, "comment_id": 66561631, "body": "Yeah it is, I have a function called toPair for my coordinate structs because maps dno&#39;t work well with objects"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1474527061, "post_id": 39615622, "comment_id": 66568854, "body": "may be a silly questions but 1. Are You filling 2D grid or some kind of graph (people here are forgetting to specify that especially for graphs without realizing that the difference is a big one)?  2. Are you also changing the cell values or just counting the area involved?"}, {"owner": {"reputation": 195, "user_id": 3560330, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1612bb4174235e68972b3533aff6051b?s=128&d=identicon&r=PG&f=1", "display_name": "bi0phaz3", "link": "https://stackoverflow.com/users/3560330/bi0phaz3"}, "edited": false, "score": 0, "creation_date": 1474543661, "post_id": 39615622, "comment_id": 66579322, "body": "Sorry if it wasn&#39;t clear, it is a graph but the nodes are adjacent to each other like a grid. I&#39;m just counting the cell area, I&#39;m not changing the cell values except in the function copy to track which cells have been checked"}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 3560330, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1612bb4174235e68972b3533aff6051b?s=128&d=identicon&r=PG&f=1", "display_name": "bi0phaz3", "link": "https://stackoverflow.com/users/3560330/bi0phaz3"}, "edited": false, "score": 0, "creation_date": 1474459787, "post_id": 39616101, "comment_id": 66538826, "body": "No observable difference, but technically yes it should be faster"}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "reply_to_user": {"reputation": 195, "user_id": 3560330, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1612bb4174235e68972b3533aff6051b?s=128&d=identicon&r=PG&f=1", "display_name": "bi0phaz3", "link": "https://stackoverflow.com/users/3560330/bi0phaz3"}, "edited": false, "score": 0, "creation_date": 1474459908, "post_id": 39616101, "comment_id": 66538886, "body": "have you compiled it on release mode with optimizations on?"}, {"owner": {"reputation": 195, "user_id": 3560330, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1612bb4174235e68972b3533aff6051b?s=128&d=identicon&r=PG&f=1", "display_name": "bi0phaz3", "link": "https://stackoverflow.com/users/3560330/bi0phaz3"}, "edited": false, "score": 0, "creation_date": 1474460496, "post_id": 39616101, "comment_id": 66539258, "body": "I have compiled it with optimizations on, but without it on, it shouldn&#39;t be this slow. My unoptimised A* pathfinding does like 500 nodes/millisecond + visualisation"}], "tags": [], "owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "is_accepted": false, "score": 3, "last_activity_date": 1474459483, "creation_date": 1474459483, "answer_id": 39616101, "question_id": 39615622, "link": "https://stackoverflow.com/questions/39615622/how-do-i-make-my-flood-fill-algorithm-more-efficient/39616101#39616101", "title": "How do I make my flood fill algorithm more efficient?", "body": "<p>For starter, you copy a <code>std::map</code> object 6 times for nothing.</p>\n\n<p>try passing the map object as const reference rather than pass it by value (=copy)</p>\n"}, {"comments": [{"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "edited": false, "score": 0, "creation_date": 1474461909, "post_id": 39616793, "comment_id": 66540261, "body": "Also iterating through a map means accessing the RAM in random order, whereas with an array you are accessing the RAM sequentially."}, {"owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "reply_to_user": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "edited": false, "score": 0, "creation_date": 1474462032, "post_id": 39616793, "comment_id": 66540356, "body": "@GuyGreer especially with scanline flooding."}], "tags": [], "owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "is_accepted": false, "score": 1, "last_activity_date": 1493830343, "last_edit_date": 1493830343, "creation_date": 1474461506, "answer_id": 39616793, "question_id": 39615622, "link": "https://stackoverflow.com/questions/39615622/how-do-i-make-my-flood-fill-algorithm-more-efficient/39616793#39616793", "title": "How do I make my flood fill algorithm more efficient?", "body": "<p>Can you try with a 2D array of booleans instead of a map (which takes O(log N) operations to look up) for \"gameGrid\" object? Maybe switching to a hashtable could give similar performance if an array is not an option?</p>\n\n<p>If there are 1024 points in a map, this should be multiplying the benchmark speed by 10-11.</p>\n\n<p>If this is not enough, you can have multiple threads and multiple stages (synchronizing) to compute 1, 4, 16, 20, 20, 20, 16, 4, 1, 1, 4, 16, 2, 4... tiles at a time and finish quicker.</p>\n\n<p>Try something like this (scanline fill?) on the array:</p>\n\n<pre><code>   while(canMove(right)){enqueue} // Sequential memory access\n   reset horizontal pos, enable reverse prefetching\n   while(canMove(left)){enqueue} // Sequential memory access\n\n....\n\n   then repeat for verticals\n</code></pre>\n\n<p>Then repeat with alternating horizontal+vertical computations until done. This pattern should be giving x2 memory performance multiplier, and on top of that a 10-11x array access timing upgrade, because it will not access to structs (pair) from memory, just a single byte.</p>\n\n<p>As another way, you could also start multiple fill points at random places and iterate until one of them touches original flood, add its points to original points area, move all its work the original floot thread, and in the end release all non-touching floods. This could use cache more frequently maybe? But it needs more cores. Also trying a gpgpu version wouldn't hurt.</p>\n\n<p>Note: This would implicitly enforce another optimization that @David Haim suggested. With all this optimizations, you must be seeing the exponential speedup that you mentioned about your A* algorithm.</p>\n"}], "owner": {"reputation": 195, "user_id": 3560330, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1612bb4174235e68972b3533aff6051b?s=128&d=identicon&r=PG&f=1", "display_name": "bi0phaz3", "link": "https://stackoverflow.com/users/3560330/bi0phaz3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1493830343, "creation_date": 1474458161, "last_edit_date": 1474543562, "question_id": 39615622, "link": "https://stackoverflow.com/questions/39615622/how-do-i-make-my-flood-fill-algorithm-more-efficient", "title": "How do I make my flood fill algorithm more efficient?", "body": "<p>I have a flood fill function in my code that just returns a number on the cells filled. But it is excruciatingly slow, my A* pathfinding algorithm is exponentially faster than it. Here is the snippet:</p>\n\n<pre><code>   bool withinBoundaries(_2D::Point p) {\n//cerr &lt;&lt; \"Checking if x: \" &lt;&lt; p.x &lt;&lt; \" y: \" &lt;&lt; p.y &lt;&lt; \" is within boundaries\" &lt;&lt; endl;\nif (p.x &lt;= 29 &amp;&amp; p.y &lt;= 19 &amp;&amp; p.x &gt;= 0 &amp;&amp; p.y &gt;= 0) {\n    return true;\n}\nreturn false;\n}\n\n\nbool canMove(_2D::Point point, _2D::Point offset, map&lt;pair&lt;int, int&gt;, bool&gt; gameGrid) {\nif (!gameGrid[(point + offset).toPair()] &amp;&amp; withinBoundaries(point + offset)) return true;\nelse return false;\n}\n\nint floodFillGetArea(_2D::Point point, map&lt;pair&lt;int, int&gt;, bool&gt; gameGrid) {\n    map&lt;pair&lt;int, int&gt;, bool&gt; checked;\n    map&lt;pair&lt;int, int&gt;, bool&gt; gameGridCopy = gameGrid;\n    deque&lt;_2D::Point&gt; openPoints;\n    openPoints.push_back(point);\n    int count = 0;\n\n    while (!openPoints.empty()) {\n    _2D::Point curPoint = openPoints.back();\n    openPoints.pop_back();\n    if(checked[curPoint.toPair()]) break;\n    gameGridCopy[curPoint.toPair()] = true;\n    count++;\n    if (canMove(curPoint, _2D::Point::UP(), gameGridCopy)) {\n\n        openPoints.push_back(curPoint + _2D::Point::UP());\n    }\n    if (canMove(curPoint, _2D::Point::RIGHT(), gameGridCopy)) {\n        openPoints.push_back(curPoint + _2D::Point::RIGHT());\n    }\n    if (canMove(curPoint, _2D::Point::DOWN(), gameGridCopy)) {\n        openPoints.push_back(curPoint + _2D::Point::DOWN());\n    }\n    if (canMove(curPoint, _2D::Point::LEFT(), gameGridCopy)) {\n        openPoints.push_back(curPoint + _2D::Point::LEFT());\n    }\n    checked[curPoint.toPair()] = true;\n}\nreturn count;\n}\n</code></pre>\n\n<p>This checks a node every second, why is it so slow? And _2D::Point is just an object with int x and int y. Also it creates open nods when they are already labelled as being checked, why?</p>\n"}, {"tags": ["c++", "opencv", "android-ndk", "opencv-stitching"], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 3554530, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2ff759e551c506b5d34e62c06f8193ca?s=128&d=identicon&r=PG&f=1", "display_name": "skm", "link": "https://stackoverflow.com/users/3554530/skm"}, "is_accepted": true, "score": 1, "last_activity_date": 1476182783, "creation_date": 1476182783, "answer_id": 39975569, "question_id": 39615478, "link": "https://stackoverflow.com/questions/39615478/opencv-3-1-stitch-images-in-order-they-were-taken/39975569#39975569", "title": "OpenCV 3.1 Stitch images in order they were taken", "body": "<p>So I found out that the issue here is not with the order the images are stitched but rather the rotation that is estimated for the camera parameters in the Homography Based Estimator and the Bundle Ray Adjuster.</p>\n\n<p>Those rotation angles are estimated considering a self rotating camera and my use case envolves an user rotating the camera (which means that will be some translation too. \nBecause of that (i guess) horizontal angles (around Y axis) are highly overestimated which means that the algorithm considers the set of images cover >= 360 degrees which results in some overlapped areas that shouldnt be overlapped.</p>\n\n<p>Still havent found a solution for that problem though.</p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 2802815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3KWAL.jpg?s=128&g=1", "display_name": "selpak", "link": "https://stackoverflow.com/users/2802815/selpak"}, "is_accepted": false, "score": 1, "last_activity_date": 1500276116, "creation_date": 1500276116, "answer_id": 45138186, "question_id": 39615478, "link": "https://stackoverflow.com/questions/39615478/opencv-3-1-stitch-images-in-order-they-were-taken/45138186#45138186", "title": "OpenCV 3.1 Stitch images in order they were taken", "body": "<p>matcher() takes UMat as mask instead of Mat object, so try the following code:</p>\n\n<pre><code>vector&lt;MatchesInfo&gt; pairwise_matches;\nBestOf2NearestMatcher matcher(try_gpu, match_conf);\nMat matchMask(features.size(),features.size(),CV_8U,Scalar(0));\nfor (int i = 0; i &lt; num_images -1; ++i)\n{\n    matchMask.at&lt;char&gt;(i,i+1) =1;\n} \n\nUMat umask = matchMask.getUMat(ACCESS_READ);\n\nmatcher(features, pairwise_matches, umask);\nmatcher.collectGarbage();\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 3554530, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2ff759e551c506b5d34e62c06f8193ca?s=128&d=identicon&r=PG&f=1", "display_name": "skm", "link": "https://stackoverflow.com/users/3554530/skm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 39975569, "answer_count": 2, "score": 2, "last_activity_date": 1500276116, "creation_date": 1474457715, "question_id": 39615478, "link": "https://stackoverflow.com/questions/39615478/opencv-3-1-stitch-images-in-order-they-were-taken", "title": "OpenCV 3.1 Stitch images in order they were taken", "body": "<p>I am building an Android app to create panoramas. The user captures a set of images and those images\nare sent to my native stitch function that was based on <a href=\"https://github.com/opencv/opencv/blob/master/samples/cpp/stitching_detailed.cpp\" rel=\"nofollow\">https://github.com/opencv/opencv/blob/master/samples/cpp/stitching_detailed.cpp</a>.\nSince the images are in order, I would like to match each image only to the next image in the vector.</p>\n\n<p>I found an Intel article that was doing just that with following code:</p>\n\n<pre><code>vector&lt;MatchesInfo&gt; pairwise_matches;\nBestOf2NearestMatcher matcher(try_gpu, match_conf);\nMat matchMask(features.size(),features.size(),CV_8U,Scalar(0));\nfor (int i = 0; i &lt; num_images -1; ++i)\n{\n    matchMask.at&lt;char&gt;(i,i+1) =1;\n}\nmatcher(features, pairwise_matches,matchMask);\nmatcher.collectGarbage();\n</code></pre>\n\n<p>Problem is, this wont compile. Im guessing its because im using OpenCV 3.1. \nThen I found somewhere that this code would do the same:</p>\n\n<pre><code>int range_width = 2;\nBestOf2NearestRangeMatcher matcher(range_width, try_cuda, match_conf);\nmatcher(features, pairwise_matches);\nmatcher.collectGarbage();\n</code></pre>\n\n<p>And for most of my samples this works fine. However sometimes, especially when im stitching \na large set of images (around 15), some objects appear on top of eachother and in places they shouldnt.\nI've also noticed that the \"beginning\" (left side) of the end result is not the first image in the vector either\nwhich is strange. </p>\n\n<p>I am using \"orb\" as features_type and \"ray\" as ba_cost_func. Seems like I cant use SURF on OpenCV 3.1.\nThe rest of my initial parameters look like this:</p>\n\n<pre><code>bool try_cuda = false;\ndouble compose_megapix = -1; //keeps resolution for final panorama\nfloat match_conf = 0.3f; //0.3 default for orb\nstring ba_refine_mask = \"xxxxx\";\nbool do_wave_correct = true;\nWaveCorrectKind wave_correct = detail::WAVE_CORRECT_HORIZ;\nint blend_type = Blender::MULTI_BAND;\nfloat blend_strength = 5;\n\ndouble work_megapix = 0.6;\ndouble seam_megapix = 0.08;\nfloat conf_thresh = 0.5f;\nint expos_comp_type = ExposureCompensator::GAIN_BLOCKS;\nstring seam_find_type = \"dp_colorgrad\";\nstring warp_type = \"spherical\";\n</code></pre>\n\n<p>So could anyone enlighten me as to why this is not working and how I should match my features? Any help or direction would be much appreciated!</p>\n\n<p><strong>TL;DR</strong> : I want to stitch images in the order they were taken, but above codes are not working for me, how can I do that?</p>\n"}, {"tags": ["c++", "qt", "qml"], "answers": [{"comments": [{"owner": {"reputation": 4799, "user_id": 6842725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d760417ddd74d615520fcdabd6c42ef?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Krammer", "link": "https://stackoverflow.com/users/6842725/kevin-krammer"}, "edited": false, "score": 0, "creation_date": 1474489476, "post_id": 39616864, "comment_id": 66557162, "body": "I personally wouldn&#39;t use performance as the primary decision on which side to implement things on, but reliability and testability. Tools for static code analysis, etc, are much more mature for C++, etc. Not even takling about JavaScript requiring 100% branch coverage just to be certain that there are not syntax errors."}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "reply_to_user": {"reputation": 4799, "user_id": 6842725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d760417ddd74d615520fcdabd6c42ef?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Krammer", "link": "https://stackoverflow.com/users/6842725/kevin-krammer"}, "edited": false, "score": 0, "creation_date": 1474489850, "post_id": 39616864, "comment_id": 66557356, "body": "My primary problem with QML hasn&#39;t been performance but memory usage, it is a hog, so I usually end up consolidating rather large QML files into a single C++ type. But the most important metric IMO is development time, and in this aspect QML is a tremendous saver, that&#39;s the only reason I am using it. I went from 95% C++ to 95% QML usage in production, and it is not only faster to develop but also faster to pinpoint bugs, since instead of hard crashes you get &quot;something went wrong on this line&quot;, which is that much better than manual debugging."}, {"owner": {"reputation": 4799, "user_id": 6842725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d760417ddd74d615520fcdabd6c42ef?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Krammer", "link": "https://stackoverflow.com/users/6842725/kevin-krammer"}, "edited": false, "score": 0, "creation_date": 1474492683, "post_id": 39616864, "comment_id": 66558850, "body": "Right, as long as one stays in QML and use declarative features it is fine, the problem I was pointing out is doing actual processing. Only very few people commit to the strict test driven development necessary to keep JavaScript functions working and maintainable. Even bindings can be difficult in that regard as they are basically also JS functions and typos do not always lead to warnings"}, {"owner": {"reputation": 191, "user_id": 9295478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff90be965a7c702179a4d4d136bf085?s=128&d=identicon&r=PG&f=1", "display_name": "GDevT", "link": "https://stackoverflow.com/users/9295478/gdevt"}, "edited": false, "score": 0, "creation_date": 1549284936, "post_id": 39616864, "comment_id": 95836032, "body": "QML has many advantages, most of all that it&#39;s extremely fast for development. You can also make own C++ components available for QML, so there&#39;s no limit to what you can do. We&#39;ve created a summary of what we&#39;ve learned from creating many QML-driven apps for enterprise customers or own projects. You can find the developer guide with architecture best practices and tips for QML-driven apps <a href=\"https://v-play.net/apps/avoid-cpp-models-qt\" rel=\"nofollow noreferrer\">here</a>."}], "tags": [], "owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "is_accepted": true, "score": 0, "last_activity_date": 1474463579, "last_edit_date": 1474463579, "creation_date": 1474461742, "answer_id": 39616864, "question_id": 39615242, "link": "https://stackoverflow.com/questions/39615242/qml-application-vs-qml-c-application/39616864#39616864", "title": "QML application vs QML/C++ application", "body": "<p>QML is faster for prototyping. The rule of thumb is, if possible, make it in QML, then if you have performance problems, port the functionality to C++. </p>\n\n<p>As Bluetooth is fairly low in bandwidth and hardware demand you might get away with doing it in QML.</p>\n\n<p>Two things which may mandate using C++:</p>\n\n<ul>\n<li>if your data requires more complex parsing</li>\n<li>as the documentation states \"If excessive amounts of data are sent, the function may block sending.\"</li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 6857990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VfX0u.jpg?s=128&g=1", "display_name": "ch4d0w", "link": "https://stackoverflow.com/users/6857990/ch4d0w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 835, "favorite_count": 0, "closed_date": 1474480216, "accepted_answer_id": 39616864, "answer_count": 1, "score": 1, "last_activity_date": 1474887933, "creation_date": 1474457080, "last_edit_date": 1474887933, "question_id": 39615242, "link": "https://stackoverflow.com/questions/39615242/qml-application-vs-qml-c-application", "closed_reason": "Opinion-based", "title": "QML application vs QML/C++ application", "body": "<p>I'm developing a Qt desktop application that interacts with a Bluetooth device. The interface of this application should be developed in QML.</p>\n\n<p>This application should contain 2 modules:</p>\n\n<ol>\n<li>A front end module: UI that will be developed in QML.</li>\n<li>A back end module: Interaction and control of the Bluetooth device.</li>\n</ol>\n\n<p>As the Qt framework contains an implementation of Bluetooth in QML (<code>BluetoothDiscoveryModel</code>, <code>BluetoothSocket</code> and <code>BluetoothService</code>) and C++ (<code>QBluetooth</code>...), I was wondering what do I choose between QML and C++ to implement the back end module, in terms of:</p>\n\n<ul>\n<li>Performance.</li>\n<li>Architecture of the application.</li>\n</ul>\n\n<p>And is it safe to combine QML and C++?</p>\n"}, {"tags": ["c++", "templates", "c++11", "vector", "generic-programming"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1474455943, "post_id": 39614767, "comment_id": 66536289, "body": "&quot;the same type&quot; shown is not a type. It&#39;s a function. <code>template&lt;template&lt;typename&gt; class Container&gt;</code> is not a valid template declaration. Your question is unclear."}, {"owner": {"reputation": 2597, "user_id": 768656, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/TgeZI.png?s=128&g=1", "display_name": "Benjamin Maurer", "link": "https://stackoverflow.com/users/768656/benjamin-maurer"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1474457783, "post_id": 39614767, "comment_id": 66537532, "body": "@SamVarshavchik Yes, the template declaration is invalid, the question is to find a valid one :) &quot;the same type&quot; doesn&#39;t refer to the function, the &quot;algorithm that should work with&quot; refers to the function. &quot;same type&quot; refers to std::pair&lt;int, double&gt;. Meaning any container of those pairs, that supports push_back."}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1474456059, "creation_date": 1474456059, "answer_id": 39614853, "question_id": 39614767, "link": "https://stackoverflow.com/questions/39614767/function-of-generic-container-of-specific-specialization/39614853#39614853", "title": "function of generic container of specific specialization", "body": "<p>You may do</p>\n\n<pre><code>template&lt;template &lt;typename ...&gt; class Container&gt;\nbool findpeaks(cv::Mat &amp;m, Container&lt;std::pair&lt;int, double&gt;&gt; &amp;peaks) {\n    // do stuff\n    peaks.push_back(std::make_pair(1, 1.0));\n\n    return true;\n}\n</code></pre>\n\n<p>Your problem is that <code>std::vector</code> has 2 template parameters, the type <code>T</code> and an allocator.</p>\n\n<p>But you can do even simpler:</p>\n\n<pre><code>template&lt;typename Container&gt;\nbool findpeaks(cv::Mat&amp; m, Container&amp; peaks) {\n    // do stuff\n    peaks.push_back(std::make_pair(1, 1.0));\n\n    return true;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "is_accepted": false, "score": 4, "last_activity_date": 1474456745, "last_edit_date": 1474456745, "creation_date": 1474456075, "answer_id": 39614857, "question_id": 39614767, "link": "https://stackoverflow.com/questions/39614767/function-of-generic-container-of-specific-specialization/39614857#39614857", "title": "function of generic container of specific specialization", "body": "<p><a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow\">std::vector</a> has two template parameters.</p>\n\n<blockquote>\n<pre><code>template&lt;  \n    class T,\n    class Allocator = std::allocator&lt;T&gt;\n&gt; class vector;\n</code></pre>\n</blockquote>\n\n<p>And <code>QVector</code> has one. You can do it with <a href=\"http://en.cppreference.com/w/cpp/language/parameter_pack\" rel=\"nofollow\">variadic template</a>:</p>\n\n<pre><code>template&lt;template &lt;typename...&gt; class Container&gt;\nbool findpeaks(cv::Mat &amp;m, Container&lt;std::pair&lt;int, double&gt;&gt; &amp;peaks) {\n    // do stuff\n    peaks.push_back(std::make_pair(1, 1.0));\n\n    return true;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2597, "user_id": 768656, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/TgeZI.png?s=128&g=1", "display_name": "Benjamin Maurer", "link": "https://stackoverflow.com/users/768656/benjamin-maurer"}, "edited": false, "score": 0, "creation_date": 1474458103, "post_id": 39614906, "comment_id": 66537737, "body": "While that is a simpler solution, I&#39;d like to have std::pair&lt;..&gt; in the signature, to make clear that this is what you&#39;re getting :)"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 2597, "user_id": 768656, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/TgeZI.png?s=128&g=1", "display_name": "Benjamin Maurer", "link": "https://stackoverflow.com/users/768656/benjamin-maurer"}, "edited": false, "score": 0, "creation_date": 1474466691, "post_id": 39614906, "comment_id": 66543755, "body": "@BenjaminMaurer You can express this in a sfinae constraint instead of the function parameters."}, {"owner": {"reputation": 2597, "user_id": 768656, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/TgeZI.png?s=128&g=1", "display_name": "Benjamin Maurer", "link": "https://stackoverflow.com/users/768656/benjamin-maurer"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1474467839, "post_id": 39614906, "comment_id": 66544649, "body": "@GuillaumeRacicot mhh, I&#39;m not sure how I would go about doing that :)"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 2597, "user_id": 768656, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/TgeZI.png?s=128&g=1", "display_name": "Benjamin Maurer", "link": "https://stackoverflow.com/users/768656/benjamin-maurer"}, "edited": false, "score": 0, "creation_date": 1474468897, "post_id": 39614906, "comment_id": 66545373, "body": "@BenjaminMaurer I&#39;ve written an answer that explain how to do this. Don&#39;t forget to upvote this one (Barry&#39;s one) too, as it raises pretty good points."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 4, "last_activity_date": 1474456229, "creation_date": 1474456229, "answer_id": 39614906, "question_id": 39614767, "link": "https://stackoverflow.com/questions/39614767/function-of-generic-container-of-specific-specialization/39614906#39614906", "title": "function of generic container of specific specialization", "body": "<p>Do you actually need <code>Container</code> to be a class template? Just make it a normal type:</p>\n\n<pre><code>template&lt;class Container&gt;\nboolean findpeaks(cv::Mat &amp;m, Container&amp; peaks) {\n    // do stuff\n    peaks.push_back(std::make_pair(1, 1.0));\n\n    return true;\n}\n</code></pre>\n\n<p>This will let you use other containers that are potentially not templates. Like, <code>struct MySpecialPairContainer { ... };</code></p>\n"}, {"comments": [{"owner": {"reputation": 2597, "user_id": 768656, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/TgeZI.png?s=128&g=1", "display_name": "Benjamin Maurer", "link": "https://stackoverflow.com/users/768656/benjamin-maurer"}, "edited": false, "score": 0, "creation_date": 1474466210, "post_id": 39617373, "comment_id": 66543367, "body": "Don&#39;t get me wrong, this is some cool stuff. If I was writing this as part of a general purpose library for the general public that might make sense. But here, this is waaaay over-engineered. The code base simply mixes std::vector and QVector and I didn&#39;t want to commit to one. Even if I did, it wouldn&#39;t be horrible. But by adding the variadic template bit, I add one line and the caller doesn&#39;t have to care."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 2597, "user_id": 768656, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/TgeZI.png?s=128&g=1", "display_name": "Benjamin Maurer", "link": "https://stackoverflow.com/users/768656/benjamin-maurer"}, "edited": false, "score": 0, "creation_date": 1474466349, "post_id": 39617373, "comment_id": 66543498, "body": "@BenjaminMaurer Take a <code>std::function&lt;void(std::pair&lt;int, double&gt; const&amp;)&gt;</code> as your sink.  Getting the code out of the header is usually worth it, and the glue is tiny."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 1, "last_activity_date": 1474463008, "creation_date": 1474463008, "answer_id": 39617373, "question_id": 39614767, "link": "https://stackoverflow.com/questions/39614767/function-of-generic-container-of-specific-specialization/39617373#39617373", "title": "function of generic container of specific specialization", "body": "<p>In general, you shouldn't over specify.  If I wrote:</p>\n\n<pre><code>struct my_thing {\n  void push_back( std::pair&lt;int, double&gt; const&amp; ) {}\n};\n</code></pre>\n\n<p>shouldn't I be able to pass <code>my_thing</code> to your <code>findpeaks</code>?</p>\n\n<p>There is absolutely no need for the <code>template&lt;class...&gt;class Container</code> template within the function, so requring it in the interface is an overspecification.</p>\n\n<p>What you need is a sink (graph theoretical sink -- a sink is where things flow into, and don't flow out of) that consumes pairs of <code>int, double</code>.  Ideally you want to be able to pass in a container without extra boilerplate.</p>\n\n<pre><code>template&lt;class T&gt;\nstruct sink:std::function&lt;void(T)&gt; {\n  using std::function&lt;T&gt;::function;\n  // more\n};\n</code></pre>\n\n<p>now your function looks like:</p>\n\n<pre><code>bool findpeaks(cv::Mat &amp;m, sink&lt;std::pair&lt;int, double&gt;const&amp;&gt; peaks) {\n  // do stuff\n  peaks(std::make_pair(1, 1.0));\n\n  return true;\n}\n</code></pre>\n\n<p>and as a bonus, you can now put it into a cpp file instead of a header.  (The dispatching costs for a <code>std::function</code> are modest).</p>\n\n<p>This does require that you wrap the second parameter up at the call site:</p>\n\n<pre><code>std::vector&lt;std::pair&lt;int, double&gt;&gt; v;\nif(findpeaks( matrix, [&amp;](auto&amp;&amp; e){v.push_back(decltype(e)(e));} ) {\n  // ...\n</code></pre>\n\n<p>which you might not like.  Because we didn't use a naked <code>std::function</code> but instead a <code>sink</code>, we can get around this.  First we write a metatrait, then some traits.</p>\n\n<pre><code>namespace details {\n  template&lt;template&lt;class...&gt;class Z, class alwaysvoid, class...Ts&gt;\n  struct can_apply:std::false_type{};\n  template&lt;template&lt;class...&gt;class Z, class...Ts&gt;\n  struct can_apply&lt;Z, std::void_t&lt;Z&lt;Ts...&gt;&gt;, Ts...&gt;:std::true_type{};\n}\ntemplate&lt;template&lt;class...&gt;class Z, class...Ts&gt;\nusing can_apply=details::can_apply&lt;Z, void, Ts...&gt;;\n</code></pre>\n\n<p>This is a meta trait that lets us write other traits.</p>\n\n<pre><code>template&lt;class C, class X&gt;\nusing push_back_result = decltype( std::declval&lt;C&gt;().push_back( std::declval&lt;X&gt;() ) );\n\ntemplate&lt;class C, class X&gt;\nusing can_push_back = can_apply&lt; push_back_result, C, X &gt;;\n</code></pre>\n\n<p>now we have a trait <code>can_push_back</code> that is <code>true_type</code> if and only if you can push an <code>X</code> into the container <code>C</code>.</p>\n\n<p>We now augment sink:</p>\n\n<pre><code>template&lt;class T, class Base=std::function&lt;void(T)&gt;&gt;\nstruct sink:Base {\n  using Base::Base;\n  template&lt;class C,\n    std::enable_if_t&lt; can_push_back&lt; C&amp;, T &gt;{}, int&gt; =0\n  &gt;\n  sink( C&amp; c ):\n    Base( [&amp;](auto&amp;&amp; t){ c.push_back(decltype(t)(t)); } )\n  {}\n  sink()=default;\n  sink(sink const&amp;)=default;\n  sink(sink &amp;&amp;)=default;\n  sink&amp; operator=(sink const&amp;)=default;\n  sink&amp; operator=(sink &amp;&amp;)=default;\n};\n</code></pre>\n\n<p>This newly augmented <code>sink</code> now can be passed a container that supports <code>.push_back(T)</code> and automatically writes a function that solves the problem for you.</p>\n\n<pre><code>std::vector&lt;std::pair&lt;int, double&gt;&gt; v;\nif(findpeaks( matrix, v ) {\n  // ...\n</code></pre>\n\n<p>That just works.</p>\n\n<p>We can do the same for containers that support <code>.insert(T)</code>, and after that we can use <code>std::set&lt;T&gt;</code> or even <code>std::map&lt;int, double&gt;</code> as a sink for your algorithm:</p>\n\n<pre><code>std::set&lt;std::pair&lt;int, double&gt;&gt; s;\nif(findpeaks( matrix, s ) {\n  // ...\nstd::map&lt;int, double&gt; m;\nif(findpeaks( matrix, m ) {\n  // ...\n</code></pre>\n\n<p>Finally, this also supports mocking.  You can write a test-sink that helps unit-test your <code>findpeaks</code> algorithm directly.</p>\n\n<p>I find the concept of <code>sink</code> used sufficiently often that having a <code>sink</code> type that supports these kind of things makes my code clearer, and reduces its dependency on any one kind of container.</p>\n\n<p>Performance wise, the cost of the type erasure in <code>std:function</code> is modest.  if you really need performance improvement, swapping <code>sink&lt;X&gt;</code> for <code>sink&lt;X, F&gt;</code> where <code>F</code> is a free parameter is possible, and writing <code>make_sink</code> that creates a <code>sink</code> where <code>Base</code> is a lambda, should work with near zero changes in the body of the code.  But before you do that, you can work on higher level optimizations, like having the output into <code>sink</code> be processed in a streaming manner, or fed to an async queue, or the like.</p>\n"}, {"comments": [{"owner": {"reputation": 2597, "user_id": 768656, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/TgeZI.png?s=128&g=1", "display_name": "Benjamin Maurer", "link": "https://stackoverflow.com/users/768656/benjamin-maurer"}, "edited": false, "score": 1, "creation_date": 1474469631, "post_id": 39619165, "comment_id": 66545785, "body": "You are missing a closing bracket &#39;)&#39;  after make_pair. Other than that, take my upvote for your arcane template magic you C++ wizard."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 2597, "user_id": 768656, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/TgeZI.png?s=128&g=1", "display_name": "Benjamin Maurer", "link": "https://stackoverflow.com/users/768656/benjamin-maurer"}, "edited": false, "score": 0, "creation_date": 1474470275, "post_id": 39619165, "comment_id": 66546236, "body": "@BenjaminMaurer thanks for pointing out the error. Should be fixed by now."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1474478601, "post_id": 39619165, "comment_id": 66551290, "body": "<i>Concept</i> might help in the future."}], "tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": true, "score": 1, "last_activity_date": 1474470172, "last_edit_date": 1474470172, "creation_date": 1474467399, "answer_id": 39619165, "question_id": 39614767, "link": "https://stackoverflow.com/questions/39614767/function-of-generic-container-of-specific-specialization/39619165#39619165", "title": "function of generic container of specific specialization", "body": "<p>Just as expressed with @Barry's answer, I don't think you need a template template parameter here.</p>\n\n<p>However, you seem to have concern about expressing \"a container that supports <code>push_back</code> with a pair of...\"</p>\n\n<p>I suggest you to express this constraint in a sfinae constraint expression instead. Even if your parameter is explicitly requiring <code>std::pair</code> to be in the first template parameter of a class, it doesn't mean it has a <code>push_back</code> function, and doesn't mean the supposedly existing <code>push_back</code> is taking a <code>std::pair</code> as parameter.</p>\n\n<p>Arguments of a function is currently a bad way of expressing what a template type should be able to do, or should be. You'll have to wait for concepts for that.</p>\n\n<p>In the meantime, you can use a sfinae constraint in your function signature that explicitly express that you need a type that has a member <code>push_back</code> function that accept a <code>std::pair</code>:</p>\n\n<pre><code>template&lt;class Container&gt;\nauto findpeaks(cv::Mat &amp;m, Container&amp; peaks)\n        // Using trailing return type\n        -&gt; first_t&lt;bool, decltype(peaks.push_back(std::make_pair(1, 1.0)))&gt;\n        // Here's the constraint -^    that expression need to be valid\n    {\n\n    // do stuff\n    peaks.push_back(std::make_pair(1, 1.0));\n\n    return true;\n}\n</code></pre>\n\n<p><code>first_t</code> can be implemented that way:</p>\n\n<pre><code>template&lt;typename T, typename...&gt;\nusing first_t = T;\n</code></pre>\n\n<p>For the function to exist, the expression inside the <code>decltype</code> must be valid. If the contraint is not satified, the compiler will try other overloads of the function <code>findpeaks</code>.</p>\n"}], "owner": {"reputation": 2597, "user_id": 768656, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/TgeZI.png?s=128&g=1", "display_name": "Benjamin Maurer", "link": "https://stackoverflow.com/users/768656/benjamin-maurer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 946, "favorite_count": 0, "closed_date": 1474480319, "accepted_answer_id": 39619165, "answer_count": 5, "score": 3, "last_activity_date": 1475413638, "creation_date": 1474455818, "last_edit_date": 1475413638, "question_id": 39614767, "link": "https://stackoverflow.com/questions/39614767/function-of-generic-container-of-specific-specialization", "closed_reason": "Duplicate", "title": "function of generic container of specific specialization", "body": "<p>I'm trying to write an algorithm that should work with different containers (std::vector, QVector) containing the same type:</p>\n\n<pre><code>template&lt;class Container&gt;\nboolean findpeaks(cv::Mat &amp;m, Container&lt;std::pair&lt;int, double&gt;&gt; &amp;peaks) {\n    // do stuff\n    peaks.push_back(std::make_pair(1, 1.0));\n\n    return true;\n}\n</code></pre>\n\n<p>This one gives me</p>\n\n<blockquote>\n  <p>'Container' is not a template</p>\n</blockquote>\n\n<pre><code>template&lt;template&lt;typename&gt; class Container&gt;\n</code></pre>\n\n<p>I get:</p>\n\n<blockquote>\n  <p>error: no matching function for call to 'findpeaks(cv::MatExpr, std::vector >&amp;)'</p>\n  \n  <p>...</p>\n  \n  <p>note:   template argument deduction/substitution failed:</p>\n  \n  <p>error: wrong number of template arguments (2, should be 1)</p>\n</blockquote>\n\n<p>Calling code:</p>\n\n<pre><code>cv::Mat m(data, true);\nstd::vector&lt;std::pair&lt;int, double&gt;&gt; peaks;\n\nQVERIFY(daf::findpeaks(m.t(), peaks));\n</code></pre>\n\n<p>I've also tried something like this:</p>\n\n<pre><code>template&lt;template&lt; template&lt;typename, typename&gt; typename &gt; class Container&gt;\n</code></pre>\n\n<blockquote>\n  <p>warning: ISO C++ forbids typename key in template template parameter; use -std=c++1z or -std=gnu++1z [-Wpedantic]</p>\n</blockquote>\n\n<p>And some more errors...</p>\n"}]