[{"tags": ["c++", "c", "pointers", "video", "ffmpeg"], "comments": [{"owner": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 2, "creation_date": 1562820831, "post_id": 56980003, "comment_id": 100499033, "body": "See metadata.c example."}, {"owner": {"reputation": 3341, "user_id": 3204706, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GIk0b.jpg?s=128&g=1", "display_name": "Tina J", "link": "https://stackoverflow.com/users/3204706/tina-j"}, "reply_to_user": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 0, "creation_date": 1562857250, "post_id": 56980003, "comment_id": 100518797, "body": "@Gyan Thanks. Yes <code>av_dict_get(frame-&gt;metadata, &quot;myfreezekey&quot;, tag, 0)</code> was a life saver! But I see the filter metadata <code>[freezedetect @ 0x25b91c0] lavfi.freezedetect.freeze_start: 5.005</code> is also printed by default! Any ways to disable that?"}, {"owner": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 1, "creation_date": 1562858959, "post_id": 56980003, "comment_id": 100519798, "body": "No, that&#39;s supplied by the filter and formatted by av_log"}, {"owner": {"reputation": 3341, "user_id": 3204706, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GIk0b.jpg?s=128&g=1", "display_name": "Tina J", "link": "https://stackoverflow.com/users/3204706/tina-j"}, "reply_to_user": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 0, "creation_date": 1562861920, "post_id": 56980003, "comment_id": 100521322, "body": "@Gyan Got it. It&#39;s weird. I remove <code>av_log</code> in the <code>set_meta</code> function of the filter C file. And make. But still see the same logs printed. Shouldn&#39;t it work?"}], "owner": {"reputation": 3341, "user_id": 3204706, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GIk0b.jpg?s=128&g=1", "display_name": "Tina J", "link": "https://stackoverflow.com/users/3204706/tina-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1562820652, "creation_date": 1562802896, "last_edit_date": 1562820652, "question_id": 56980003, "link": "https://stackoverflow.com/questions/56980003/problems-in-my-sample-c-code-using-ffmpeg-api", "title": "Problems in my sample C code using FFmpeg API", "body": "<p>I've been trying to change an FFmpeg's example code <a href=\"https://github.com/FFmpeg/FFmpeg/blob/master/doc/examples/filtering_video.c\" rel=\"nofollow noreferrer\">HERE</a> to call <strong>other</strong> filters using its C APIs. Say the filter be <code>freezedetect=n=-60dB:d=8</code> which normally runs like this:</p>\n\n<pre><code>ffmpeg -i small.mp4 -vf \"freezedetect=n=-60dB:d=8\" -map 0:v:0 -f null -\n</code></pre>\n\n<p>And prints outputs like this:</p>\n\n<pre><code>[freezedetect @ 0x25b91c0] lavfi.freezedetect.freeze_start: 5.005\n[freezedetect @ 0x25b91c0] lavfi.freezedetect.freeze_duration: 2.03537\n[freezedetect @ 0x25b91c0] lavfi.freezedetect.freeze_end: 7.04037\n</code></pre>\n\n<p>However, the original example displays frames, not these metadata information. How can I change the code to print this metadata information (and not the frames)? </p>\n\n<p>I've been trying to change the <code>display_frame</code> function below into a <code>display_metadata</code> function. Looks like the <code>frame</code> variable has a <code>metadata</code> dictionary which looks promising, but my attempts failed to use it. I'm also new to C language.</p>\n\n<p>Original <code>display_frame</code> function:</p>\n\n<pre><code>static void display_frame(const AVFrame *frame, AVRational time_base)\n{\n    int x, y;\n    uint8_t *p0, *p;\n    int64_t delay;\n\n    if (frame-&gt;pts != AV_NOPTS_VALUE) {\n        if (last_pts != AV_NOPTS_VALUE) {\n            /* sleep roughly the right amount of time;\n             * usleep is in microseconds, just like AV_TIME_BASE. */\n            delay = av_rescale_q(frame-&gt;pts - last_pts,\n                                 time_base, AV_TIME_BASE_Q);\n            if (delay &gt; 0 &amp;&amp; delay &lt; 1000000)\n                usleep(delay);\n        }\n        last_pts = frame-&gt;pts;\n    }\n\n    /* Trivial ASCII grayscale display. */\n    p0 = frame-&gt;data[0];\n    puts(\"\\033c\");\n    for (y = 0; y &lt; frame-&gt;height; y++) {\n        p = p0;\n        for (x = 0; x &lt; frame-&gt;width; x++)\n            putchar(\" .-+#\"[*(p++) / 52]);\n        putchar('\\n');\n        p0 += frame-&gt;linesize[0];\n    }\n    fflush(stdout);\n}\n</code></pre>\n\n<p>My new <code>display_metadata</code> function that needs to be completed:</p>\n\n<pre><code>static void display_metadata(const AVFrame *frame)\n{\n\n//    printf(\"%d\\n\",frame-&gt;height);\n\n    AVDictionary* dic = frame-&gt;metadata;\n\n    printf(\"%d\\n\",*(dic-&gt;count));\n\n//    fflush(stdout);\n} \n</code></pre>\n"}, {"tags": ["c++", "oop", "static", "constants"], "comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1562805693, "post_id": 56979888, "comment_id": 100496268, "body": "For the particular case you show, the choice is based on coding style  i.e. it is completely arbitrary and subjective.    There are cases in which the definition outside is required, such as if the type of the member is incomplete within the class definition.   If the member is private, there is a case for not having its initialiser visible in the class definition (which would mean - for example - defining that member in a source file, not in a header file that defines the class, so the member initialisation is not visible to users of the class)."}], "answers": [{"tags": [], "owner": {"reputation": 6746, "user_id": 8185995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d69271095c22ec7a2f5cad43ea3ac0?s=128&d=identicon&r=PG&f=1", "display_name": "robthebloke", "link": "https://stackoverflow.com/users/8185995/robthebloke"}, "is_accepted": false, "score": 0, "last_activity_date": 1562802384, "creation_date": 1562802384, "answer_id": 56979945, "question_id": 56979888, "link": "https://stackoverflow.com/questions/56979888/should-i-initialize-static-const-data-member-with-in-class-initilizer-or-in-its/56979945#56979945", "title": "Should I initialize static const data member with in-class initilizer or in its definition outside class?", "body": "<p>You'd be better off just using constexpr, which means you can keep it all within the class definition</p>\n\n<pre><code>class Circle{\npublic:\n    //...\nprivate:\n    static constexpr double PI_ = 3.14; // 1\n};\n</code></pre>\n"}], "owner": {"reputation": 2310, "user_id": 9185253, "user_type": "registered", "profile_image": "https://graph.facebook.com/114451586026362/picture?type=large", "display_name": "Maestro", "link": "https://stackoverflow.com/users/9185253/maestro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562803083, "creation_date": 1562801919, "last_edit_date": 1562803083, "question_id": 56979888, "link": "https://stackoverflow.com/questions/56979888/should-i-initialize-static-const-data-member-with-in-class-initilizer-or-in-its", "title": "Should I initialize static const data member with in-class initilizer or in its definition outside class?", "body": "<p>If I have a class that has a static const data member then what is the best way to initialize it:</p>\n\n<pre><code>class Circle{\n    public:\n        //...\n    private:\n        static const double PI_ = 3.14; // 1\n        //static const double PI_; // 2\n};\n\ndouble Circle::PI_; // 1   is this redundant?\n//double Circle::PI_ = 3.14;\n</code></pre>\n\n<p>As you can see above in first time I initialized <code>PI_</code> with in-class initializer and then I defined it outside the class without any initializer.</p>\n\n<p>And in the second I just declared it inside the class without initializer and defined it outside the class with an initializer.</p>\n\n<ul>\n<li>Which is the best way?</li>\n<li>Is the definition of <code>PI_</code> outside the class redundant as long as I provided an in-class initializer? </li>\n<li><p>Can I say that providing an in-class initializer for a const static data member is considered a \"definition\" rather than \"declaration\"?</p></li>\n<li><p>Also in \"C++ primer 5th ed:</p>\n\n<p>\"<code>*If the member is used only in contexts where the compiler can substitute the member\u2019s value, then an initialized const or constexpr static need not be separately defined. However, if we use the member in a context in which the value cannot be substituted, then there must be a definition for that member.\nFor example, if the only use we make of period is to define the dimension of\ndaily_tbl, there is no need to define period outside of Account. However, if we\nomit the definition, it is possible that even seemingly trivial changes to the program might cause the program to fail to compile because of the missing definition. For example, if we pass Account::period to a function that takes a const int&amp;, then period must be defined.*</code>\"</p></li>\n</ul>\n\n<p>But I tried it and worked without definition outside the class?!!!</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c++", "ifstream"], "comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1562801340, "post_id": 56979799, "comment_id": 100495473, "body": "This is wrong: <code>&amp;h.label</code>.  Better: <code>h.label</code>.  Or equivalently, <code>&amp;h.label[0]</code>.  Make your changes, and see if that helps.  Read this for more details: <a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\">What is Array Decaying?</a>"}, {"owner": {"reputation": 2581, "user_id": 5141304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dH8FwSGAMts/AAAAAAAAAAI/AAAAAAAAABY/L6D_xatTkV4/photo.jpg?sz=128", "display_name": "Cruz Jean", "link": "https://stackoverflow.com/users/5141304/cruz-jean"}, "edited": false, "score": 0, "creation_date": 1562802148, "post_id": 56979799, "comment_id": 100495604, "body": "so your second set of couts are immediately after the first ones (where you read the data)?"}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 1, "creation_date": 1562802159, "post_id": 56979799, "comment_id": 100495605, "body": "We need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, which is a full program and the necessary input files that we can use to reproduce the problem without having to fill in anything. You can and should omit parts of the code not relevant to the problem, but the result should still be a complete program and it should still reproduce the problem. Currently, it appears that your problem is in some parts of your code which you didn&#39;t show."}, {"owner": {"reputation": 6746, "user_id": 8185995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d69271095c22ec7a2f5cad43ea3ac0?s=128&d=identicon&r=PG&f=1", "display_name": "robthebloke", "link": "https://stackoverflow.com/users/8185995/robthebloke"}, "reply_to_user": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1562803872, "post_id": 56979799, "comment_id": 100495934, "body": "@paulsm4 In this specific context, &amp;h.label, h.label, and &amp;h are all the same memory location, so that isn&#39;t the problem. I agree though, the additional &amp; isn&#39;t a particularly good style. Personally I&#39;d just read the entire header in one go:  fileIn.read(reinterpret_cast&lt;char*&gt;(&amp;h), sizeof(h));"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562804116, "post_id": 56979799, "comment_id": 100495981, "body": "You are only showing half of the story.  How were those items saved?  You need to save the items first before you can read them."}, {"owner": {"reputation": 1274, "user_id": 5757434, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/97d471e38b8d44ee7252657fa1f98816?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Williams", "link": "https://stackoverflow.com/users/5757434/thomas-williams"}, "edited": false, "score": 0, "creation_date": 1562804322, "post_id": 56979799, "comment_id": 100496019, "body": "I have now added my full, code. I can&#39;t add the test.dst though because that is a binary file and there is no way to add binary files here. &amp; is a memory location. The file is a DST file which is a dakoma file. The items I am getting in are fine, and I am using them. It is just the cout which is corrupted, but only if I cout twice, or after the header"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562804457, "post_id": 56979799, "comment_id": 100496040, "body": "If it&#39;s a binary file, why aren&#39;t you reading the entire struct in one read?  Why are you breaking up the reads into several lines?  In addition to that, I see no null-termination handling at all in your code for those char arrays."}, {"owner": {"reputation": 1274, "user_id": 5757434, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/97d471e38b8d44ee7252657fa1f98816?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Williams", "link": "https://stackoverflow.com/users/5757434/thomas-williams"}, "edited": false, "score": 0, "creation_date": 1562804568, "post_id": 56979799, "comment_id": 100496061, "body": "Because I followed a tutorial and this is how it was done. I didn&#39;t know you could read it all in one go"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1562804741, "post_id": 56979799, "comment_id": 100496100, "body": "<code>cout &lt;&lt; &quot;Label: &quot; &lt;&lt; h.label</code> means to read a null-terminated string from the location of <code>h.label</code>  , but your code never placed such a string there"}, {"owner": {"reputation": 1274, "user_id": 5757434, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/97d471e38b8d44ee7252657fa1f98816?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Williams", "link": "https://stackoverflow.com/users/5757434/thomas-williams"}, "edited": false, "score": 0, "creation_date": 1562804860, "post_id": 56979799, "comment_id": 100496122, "body": "But the fileIn is reading it into that label, or am I wrong. The first set of couts show correctly though. It is only when I have to output the second lot of couts that it shows corruption. Actually if I don&#39;t output the first lot the second lot are still corrupted though"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562804868, "post_id": 56979799, "comment_id": 100496125, "body": "@ThomasWilliams <code>fileIn.read(reinterpret_cast&lt;char *&gt;(&amp;h), sizeof(h));</code> -- This will work, but note that this will only will work for POD types (which your struct is), and that your struct&#39;s members line up with the data in the file (i.e. probably needs to be byte packed)."}, {"owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "edited": false, "score": 0, "creation_date": 1562804907, "post_id": 56979799, "comment_id": 100496133, "body": "<code>cout</code> takes some characters for the sake of formatting, such a choosing hex format for an integer to follow, or switching back to decimal.  Have you checked your string to ensure it has none being interpreted?  (I don&#39;t know details of how that works)"}, {"owner": {"reputation": 1274, "user_id": 5757434, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/97d471e38b8d44ee7252657fa1f98816?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Williams", "link": "https://stackoverflow.com/users/5757434/thomas-williams"}, "edited": false, "score": 0, "creation_date": 1562804923, "post_id": 56979799, "comment_id": 100496138, "body": "The data works fine. I am using this to build an svg and everything works as it should.The only thing that fails is the cout."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1562805012, "post_id": 56979799, "comment_id": 100496160, "body": "Are your strings null-terminated?  Again, your code shows nothing in terms of ensuring this.  That&#39;s probably why <code>cout</code> is going haywire.  If you give <code>cout</code> a character array, it is assuming it is a null-terminated string."}, {"owner": {"reputation": 1274, "user_id": 5757434, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/97d471e38b8d44ee7252657fa1f98816?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Williams", "link": "https://stackoverflow.com/users/5757434/thomas-williams"}, "edited": false, "score": 0, "creation_date": 1562805100, "post_id": 56979799, "comment_id": 100496176, "body": "HI Paul, they are just a header in a binary file. I doubt they are null terminated. However as you can see from my picture, the first lot of couts output correclty, the second lot do not. What can I do to solve this null termination?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562805386, "post_id": 56979799, "comment_id": 100496219, "body": "If they&#39;re not null terminated, then you need to come up with a way to determine where the actual end of the string you read in is.  The <code>sizeof</code> will not give you this information -- all it does is return the number of bytes your <code>char</code> array consists of.  So you need to inspect your string (not just the displayable characters, all the characters using your debugger), and come up with a way to determine the real length of the string.  Probably a loop until your char array value at a certain index equals something, and then that&#39;s where you stick the null."}, {"owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "edited": false, "score": 0, "creation_date": 1562805433, "post_id": 56979799, "comment_id": 100496228, "body": "<code>fileIn.read()</code> is a basic problem here.  You are telling it to use each entire field (fixed size), without knowing the variable size of data that will come in."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562805775, "post_id": 56979799, "comment_id": 100496277, "body": "@ThomasWilliams -- In the file, the character array positions that are not filled -- are these space characters?  If so, then possibly <code>cout.write(h.label, sizeof(label));</code> and similar would work.  But only if the excess positions in the array are spaces."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "reply_to_user": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "edited": false, "score": 0, "creation_date": 1562808003, "post_id": 56979799, "comment_id": 100496653, "body": "@donjuedo <code>cout</code>, or more correctly, the stream insertion operator (<code>&lt;&lt;</code>), outputs the given string exactly the way it is character by character. It does not interpret the characters in any way (except for the null terminator). You might be confusing this with C I/O format specifiers or string literal escape sequences."}, {"owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "reply_to_user": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1562846721, "post_id": 56979799, "comment_id": 100512079, "body": "@AlexanderZhang, Here is detailed description of what I was thinking of: <a href=\"https://en.cppreference.com/w/cpp/io/manip\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/manip</a>    But looking more closely at the OP, this idea does seem off track."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "reply_to_user": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "edited": false, "score": 0, "creation_date": 1562869113, "post_id": 56979799, "comment_id": 100524550, "body": "@donjuedo Those are separate types which aren&#39;t part of any inserted string."}, {"owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "reply_to_user": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1562871425, "post_id": 56979799, "comment_id": 100525549, "body": "@AlexanderZhang, Ah, right.  I see what you mean now."}], "answers": [{"comments": [{"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1562817865, "post_id": 56981451, "comment_id": 100498376, "body": "I was going to mention more about how the <code>pragma pack 2</code> <i>could</i> cause the odd-length buffers to possibly have a terminating null byte, or junk, by virtue of padding to 2-byte alignment.  But the answer is long winded as is and the behaviour is implementation specific."}, {"owner": {"reputation": 1274, "user_id": 5757434, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/97d471e38b8d44ee7252657fa1f98816?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Williams", "link": "https://stackoverflow.com/users/5757434/thomas-williams"}, "edited": false, "score": 0, "creation_date": 1562877555, "post_id": 56981451, "comment_id": 100527912, "body": "It looks like you have answered the question and I totally understand what you mean, but I am having a small problem with the line fileIn.read(&amp;raw, sizeof(raw)) as I am getting an error //no matching function for call to std::basic_ifstream&lt;char&gt;::read(RawHeader*, unsigned int). I am going to have my tea and have another look later. I may have typed something in wrong. So it looks like that one line would replace all my fileIn.read lines in one go. Once I get it to work that will be excellent. Will get back to you in a couple of hours once I have tried a few things."}, {"owner": {"reputation": 1274, "user_id": 5757434, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/97d471e38b8d44ee7252657fa1f98816?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Williams", "link": "https://stackoverflow.com/users/5757434/thomas-williams"}, "edited": false, "score": 0, "creation_date": 1562962639, "post_id": 56981451, "comment_id": 100559200, "body": "I didn&#39;t have time to get back straight away. I worked out that it needed char, but I am still a little stuck as I am compiling in codeblocks and strnlen_s only works in MSVC. I am going to tick you anyway because your answer is correct. I just need an alternative to the strnlen_s. I have tried std::string test(raw.label, sizeof(raw.label)); and that works to a point, just need to make it into a function now and it should be ok."}, {"owner": {"reputation": 1274, "user_id": 5757434, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/97d471e38b8d44ee7252657fa1f98816?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Williams", "link": "https://stackoverflow.com/users/5757434/thomas-williams"}, "edited": false, "score": 0, "creation_date": 1562963652, "post_id": 56981451, "comment_id": 100559520, "body": "Ok I found a way to do it slightly different but it works h.label = std::string(raw.label, sizeof(raw.label));. Tried to put it in a function but not quite working like that, but it works straight."}, {"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "reply_to_user": {"reputation": 1274, "user_id": 5757434, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/97d471e38b8d44ee7252657fa1f98816?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Williams", "link": "https://stackoverflow.com/users/5757434/thomas-williams"}, "edited": false, "score": 0, "creation_date": 1562978116, "post_id": 56981451, "comment_id": 100562345, "body": "@ThomasWilliams <code>h.label = std::string(raw.label, sizeof(raw.label));</code> does <b>not</b> work correctly if there is a null terminator in the string. <code>{&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;\\0&#39;, &#39;x&#39;, &#39;x&#39;, &#39;x&#39; }</code> will get converted to a string with length 7, but that some code (including the visual studio debugger) will display as <code>abc</code> and other code (including cout) will display as <code>abc xxx</code>.  I strongly suggest using an approach that does not embed trailing nulls or spaces or junk."}, {"owner": {"reputation": 1274, "user_id": 5757434, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/97d471e38b8d44ee7252657fa1f98816?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Williams", "link": "https://stackoverflow.com/users/5757434/thomas-williams"}, "edited": false, "score": 0, "creation_date": 1563022501, "post_id": 56981451, "comment_id": 100569355, "body": "Yeh I agree. I am looking for an alternative to using strnlen_s, but so far haven&#39;t found one. I have never used templates before either. I usually write functions. A template looks like a single class, but never came across them in c++ before, but then the language changes so much over the years."}], "tags": [], "owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "is_accepted": true, "score": 2, "last_activity_date": 1562939875, "last_edit_date": 1562939875, "creation_date": 1562817549, "answer_id": 56981451, "question_id": 56979799, "link": "https://stackoverflow.com/questions/56979799/c-cout-corruption/56981451#56981451", "title": "C++ cout corruption", "body": "<p>Using arrays to store strings is dangerous because if you allocate 20 characters to store the label and the label happens to be 20 characters long, then there is no room to store a NUL (0) terminating character.  Once the bytes are stored in the array there's nothing to tell functions that are expecting null-terminated strings (like cout) where the end of the string is.</p>\n\n<p>Your label has 20 chars.  That's enough to store the first 20 letters of the alphabet:\n<code>ABCDEFGHIJKLMNOPQRST</code></p>\n\n<p>But this is not a null-terminated string.  This is just an array of characters.  In fact, in memory, the byte right after the <code>T</code> will be the first byte of the next field, which happens to be your 11-character <code>st</code> array.  Let's say those 11 characters are: <code>abcdefghijk</code>.</p>\n\n<p>Now the bytes in memory look like this:\n<code>ABCDEFGHIJKLMNOPQRSTabcdefghijk</code></p>\n\n<p>There's no way to tell where <code>label</code> ends and <code>st</code> begins.  When you pass a pointer to the first byte of the array that is intended to be interpreted as a null-terminated string by convention, the implementation will happily start scanning until it finds a null terminating character (0).  Which, on subsequent reuses of the structure, it may not!  There's a serious risk of overrunning the buffer (reading past the end of the buffer), and potentially even the end of your virtual memory block, ultimately causing an access violation / segmentation fault.</p>\n\n<p>When your program first ran, the memory of the header structure was all zeros (because you initialized with {}) and so after reading the label field from disk, the bytes after the <code>T</code> were already zero, so your first cout worked correctly.  There happened to be a terminating null character at <code>st[0]</code>.  You then overwrite this when you read the <code>st</code> field from disk.  When you come back to output <code>label</code> again, the terminator is gone, and some characters of <code>st</code> will get interpreted as belonging to the string.</p>\n\n<p>To fix the problem you probably want to use a different, more practical data structure to store your strings that allows for convenient string functions.  And use your raw header structure just to represent the file format.</p>\n\n<p>You can still read the data from disk into memory using fixed sized buffers, this is just for staging purposes (to get it into memory) but then store the data into a different structure that uses std::string variables for convenience and later use by your program.</p>\n\n<p>For this you'll want these two structures:</p>\n\n<pre><code>#pragma pack(push,2)\nstruct RawHeader  // only for file IO\n{\n    char label[20];\n    char st[11];\n    char co[7];\n    char plusXExtends[9];\n    char minusXExtends[9];\n    char plusYExtends[9];\n};\n#pragma pack(pop)\n\nstruct Header  // A much more practical Header struct than the raw one\n{\n    std::string label;\n    std::string st;\n    std::string co;\n    std::string plusXExtends;\n    std::string minusXExtends;\n    std::string plusYExtends;\n};\n</code></pre>\n\n<p>After you read the first structure, you'll transfer the fields by assigning the variables. Here's a helper function to do it.</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;string.h&gt;\n\ntemplate &lt;int n&gt; std::string arrayToString(const char(&amp;raw)[n]) {\n    return std::string(raw, strnlen_s(raw, n));\n}\n</code></pre>\n\n<p>In your function:</p>\n\n<pre><code>Header h;\nRawHeader raw;\n\nfileIn.read((char*)&amp;raw, sizeof(raw));\n// Now marshal all the fields from the raw header over to the practical header.\nh.label         = arrayToString(raw.label);\nh.st            = arrayToString(raw.st);\nh.st            = arrayToString(raw.st);\nh.co            = arrayToString(raw.co);\nh.plusXExtends  = arrayToString(raw.plusXExtends);\nh.minusXExtends = arrayToString(raw.minusXExtends);\nh.plusYExtends  = arrayToString(raw.plusYExtends);\n</code></pre>\n\n<p>It's worth mentioning that you also have the option of keeping the raw structure around and not copying your raw char arrays to std::strings when you read the file.  But you must then be certain that when you want to use the data, you always to compute and pass lengths of the strings to functions that will deal with those buffers as string data.  (Similar to what my <code>arrayToString</code> helper does anyway.)</p>\n"}], "owner": {"reputation": 1274, "user_id": 5757434, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/97d471e38b8d44ee7252657fa1f98816?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Williams", "link": "https://stackoverflow.com/users/5757434/thomas-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 1, "accepted_answer_id": 56981451, "answer_count": 1, "score": 0, "last_activity_date": 1562939875, "creation_date": 1562801123, "last_edit_date": 1592644375, "question_id": 56979799, "link": "https://stackoverflow.com/questions/56979799/c-cout-corruption", "title": "C++ cout corruption", "body": "<p>I am reading a file header using ifstream.\nEdit: I was asked to put the full minimal program, so here it is.</p>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n\n\nusing namespace std;\n\n#pragma pack(push,2)\n\nstruct Header\n{\n    char label[20];\n    char st[11];\n    char co[7];\n    char plusXExtends[9];\n    char minusXExtends[9];\n    char plusYExtends[9];\n};\n\n#pragma pack(pop)\n\nint main(int argc,char* argv[])\n{\n    string fileName;\n    fileName = &quot;test&quot;;\n\n    string fileInName = fileName + &quot;.dst&quot;;\n\n    ifstream fileIn(fileInName.c_str(), ios_base::binary|ios_base::in);\n    if (!fileIn)\n    {\n       cout &lt;&lt; &quot;File Not Found&quot; &lt;&lt; endl;\n       return 0;\n    }\n\n    Header h={};\n    if (fileIn.is_open()) {\n                cout &lt;&lt; &quot;\\n&quot; &lt;&lt; endl;\n                fileIn.read(reinterpret_cast&lt;char *&gt;(&amp;h.label), sizeof(h.label));\n                cout &lt;&lt; &quot;Label: &quot; &lt;&lt; h.label &lt;&lt; endl;\n                fileIn.read(reinterpret_cast&lt;char *&gt;(&amp;h.st), sizeof(h.st));\n                cout &lt;&lt; &quot;Stitches: &quot; &lt;&lt; h.st &lt;&lt; endl;\n                fileIn.read(reinterpret_cast&lt;char *&gt;(&amp;h.co), sizeof(h.co));\n                cout &lt;&lt; &quot;Colour Count: &quot;  &lt;&lt; h.co &lt;&lt; endl;\n                fileIn.read(reinterpret_cast&lt;char *&gt;(&amp;h.plusXExtends),sizeof(h.plusXExtends));\n                cout &lt;&lt; &quot;Extends: &quot;  &lt;&lt; h.plusXExtends &lt;&lt; endl;\n                fileIn.read(reinterpret_cast&lt;char *&gt;(&amp;h.minusXExtends),sizeof(h.minusXExtends));\n                cout &lt;&lt; &quot;Extends: &quot;  &lt;&lt; h.minusXExtends &lt;&lt; endl;\n                fileIn.read(reinterpret_cast&lt;char *&gt;(&amp;h.plusYExtends),sizeof(h.plusYExtends));\n                cout &lt;&lt; &quot;Extends: &quot;  &lt;&lt; h.plusYExtends &lt;&lt; endl;\n\n// This will output corrupted\n                cout &lt;&lt; endl &lt;&lt; endl;\n                cout &lt;&lt; &quot;Label: &quot; &lt;&lt; h.label &lt;&lt; endl;\n                cout &lt;&lt; &quot;Stitches: &quot; &lt;&lt; h.st &lt;&lt; endl;\n                cout &lt;&lt; &quot;Colour Count: &quot;  &lt;&lt; h.co &lt;&lt; endl;\n                cout &lt;&lt; &quot;Extends: &quot;  &lt;&lt; h.plusXExtends &lt;&lt; endl;\n                cout &lt;&lt; &quot;Extends: &quot;  &lt;&lt; h.minusXExtends &lt;&lt; endl;\n                cout &lt;&lt; &quot;Extends: &quot;  &lt;&lt; h.plusYExtends &lt;&lt; endl;\n    }\n\n\n    fileIn.close();\n\n    cout &lt;&lt; &quot;\\n&quot;;\n    //cin.get();\n    return 0;\n}\n\n\nifstream fileIn(fileInName.c_str(), ios_base::binary|ios_base::in);\n</code></pre>\n<p>Then I use a struct to store the header items</p>\n<p>The actual struct is longer than this. I shortened it because I didn't need the whole struct for the question.\nAnyway as I read the struct I do a cout to see what I am getting. This part is fine.</p>\n<p>As expected my cout shows the Label, Stitches, Colour Count no problem.\nThe problem is that if I want to do another cout after it has read the header I am getting corruption in the output. For instance if I put the following lines right after the above code eg</p>\n<p>Instead of seeing Label, Stitches and Colour Count I get strange symbols, and corrupt output. Sometimes you can see the output of the h.label, with some corruption, but the labels are Stitches are written over. Sometimes with strange symbols, but sometimes with text from the previous cout. I think either the data in the struct is getting corrupted, or the cout output is getting corrupted, and I don't know why. The longer the header the more the problem becomes apparent. I would really like to do all the couts at the end of the header, but if I do that I see a big mess instead of what should be outputting.</p>\n<p>My question is why is my cout becoming corrupted?</p>\n<p><a href=\"https://i.stack.imgur.com/5TvV7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5TvV7.jpg\" alt=\"Corruption\" /></a></p>\n"}, {"tags": ["c++", "random", "bit-manipulation"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1562801020, "post_id": 56979752, "comment_id": 100495420, "body": "You can still produce random number between [0-15*15*15*15[ and using <code>r%15 + 1</code>, <code>r&#47;15 % 15 + 1</code>, <code>r &#47; 15 &#47; 15 % 15 + 1</code> and <code>r &#47; 15 &#47; 15 &#47; 15 % 15 + 1</code>."}, {"owner": {"reputation": 3109, "user_id": 424556, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/797a7d84d47b3488d76300f31f857cef?s=128&d=identicon&r=PG", "display_name": "nbonneel", "link": "https://stackoverflow.com/users/424556/nbonneel"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1562801300, "post_id": 56979752, "comment_id": 100495469, "body": "if it is possible to avoid divisions and modulo I would prefer .. (they are quite costly : I&#39;m not even sure if generating four  32bit random number would be less costly than this solution with 6 divisions and 4 modulos). I&#39;d certainly prefer bitwise operations... but for sure, if that&#39;s even remotely possible!"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1562801519, "post_id": 56979752, "comment_id": 100495503, "body": "With constant folding, there is actually only 3 divisions. and last modulo is superfluous too. Alternatively, there is function to compute <code>r&#47;15</code> and <code>r%15</code> at once too."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1562802815, "post_id": 56979752, "comment_id": 100495709, "body": "You can simply throw away any zero values. This will get you, on average, about 15 random values from each 64-bit random input."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1562820838, "post_id": 56979752, "comment_id": 100499037, "body": "division is slow but division by a constant can be converted to a multiplication so it&#39;ll be fast. See <a href=\"https://stackoverflow.com/q/41183935/995714\">Why does GCC use multiplication by a strange number in implementing integer division?</a>"}, {"owner": {"reputation": 2289, "user_id": 2356414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff4a2241e2dcfc50615e4b7c709bd17?s=128&d=identicon&r=PG", "display_name": "KABoissonneault", "link": "https://stackoverflow.com/users/2356414/kaboissonneault"}, "edited": false, "score": 0, "creation_date": 1562943583, "post_id": 56979752, "comment_id": 100551805, "body": "Distributions don&#39;t have to throw away unused bits. The <code>operator()</code> is not <code>const</code>, and therefore distributions can cache unused bits and use them on the next number generation"}], "answers": [{"comments": [{"owner": {"reputation": 3109, "user_id": 424556, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/797a7d84d47b3488d76300f31f857cef?s=128&d=identicon&r=PG", "display_name": "nbonneel", "link": "https://stackoverflow.com/users/424556/nbonneel"}, "edited": false, "score": 0, "creation_date": 1562802766, "post_id": 56979958, "comment_id": 100495697, "body": "I also tried it in the meantime and it indeed seems to be faster! thanks !"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1562809132, "post_id": 56979958, "comment_id": 100496863, "body": "<code>15 * 15 * 15 * 15 - 1</code> is just <code>50624</code>, so you&#39;re only using 16 bits at a time. You could get 8 values from  the range 1..15 from each 32-bit value using <code>2562890624</code> as the upper bound. Or you could generate 32-bit values directly, use bit-shifting to extract 4-bit values, and manually discard any 0 values. Does <code>uniform_int_distribution</code> necessarily yield just one number from each pseudo-random 32-bit value, or is it smart enough to break it up into multiple values internally?"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 4, "last_activity_date": 1562919406, "last_edit_date": 1562919406, "creation_date": 1562802486, "answer_id": 56979958, "question_id": 56979752, "link": "https://stackoverflow.com/questions/56979752/random-numbers-between-1-and-15/56979958#56979958", "title": "Random numbers between 1 and 15", "body": "<p>Instead of</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::mt19937 gen(seed);\nstd::uniform_int_distribution&lt;&gt; dis(1, 15);\n\nauto r1 = dis(gen);\nauto r2 = dis(gen);\nauto r3 = dis(gen);\nauto r4 = dis(gen);\n</code></pre>\n\n<p>You might do:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::mt19937 gen(seed);\nstd::uniform_int_distribution&lt;&gt; dis(0, 15 * 15 * 15 * 15 - 1); // Assuming int at least 16 bits\n\nauto r = dis(gen);\n\nauto r1 = r % 15 + 1; r /= 15;\nauto r2 = r % 15 + 1; r /= 15;\nauto r3 = r % 15 + 1; r /= 15;\nauto r4 = r + 1;\n</code></pre>\n\n<p><a href=\"http://quick-bench.com/CTktVvWTQShE4Xd-5e60CEP7TbU\" rel=\"nofollow noreferrer\">Quick benchmark</a> (second version 2.5 times faster than first one)</p>\n"}, {"tags": [], "owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": 1, "last_activity_date": 1562943228, "creation_date": 1562943228, "answer_id": 57009453, "question_id": 56979752, "link": "https://stackoverflow.com/questions/56979752/random-numbers-between-1-and-15/57009453#57009453", "title": "Random numbers between 1 and 15", "body": "<p>As mentioned by <a href=\"https://stackoverflow.com/users/721269/david-schwartz\">David Schwartz</a> in the comment section</p>\n\n<blockquote>\n  <p>You can simply throw away any zero values. This will get you, on average, about 15 random values from each 64-bit random input.</p>\n</blockquote>\n\n<p>Implementing a simple rejection sampling technique for this particular use case instead of using the more general <code>std::uniform_int_distribution</code> should be more efficient (e.g. see this <a href=\"http://quick-bench.com/LWwRUinxAYs3lw06ueeIfgPz9AM\" rel=\"nofollow noreferrer\">Quick Bench</a> comparing the standard class with the following).</p>\n\n<pre><code>class uniform_1_to_15_distribution\n{\n    uint64_t value_{};        // So that one could use std::mt19937_64 too\npublic:\n    uniform_1_to_15_distribution() = default;\n\n    template &lt;class Gen&gt; int operator() (Gen &amp;g)\n    {\n        for (;;)\n        {\n            // When all the bits have been used (or only useless zeroes remain)\n            if( value_ == uint64_t{} )\n            {\n                // Get a new value from the generator\n                value_ = g();\n                continue;\n            }\n\n            // Pick the 4 LS bits\n            int ret = value_ &amp; 0xF;\n\n            // \"Consume\" the state\n            value_ &gt;&gt;= 4;\n\n            // Reject 0. Only value in range [1, 15] are accepted.\n            if ( ret == 0 )\n            {\n                continue;\n            }        \n            return ret;\n        }\n    }\n};\n</code></pre>\n\n<p>The distribution can be tested <a href=\"https://wandbox.org/permlink/MyTR2ufo5TIN4FCu\" rel=\"nofollow noreferrer\">HERE</a>.</p>\n"}], "owner": {"reputation": 3109, "user_id": 424556, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/797a7d84d47b3488d76300f31f857cef?s=128&d=identicon&r=PG", "display_name": "nbonneel", "link": "https://stackoverflow.com/users/424556/nbonneel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 56979958, "answer_count": 2, "score": 5, "last_activity_date": 1562943228, "creation_date": 1562800664, "last_edit_date": 1562801012, "question_id": 56979752, "link": "https://stackoverflow.com/questions/56979752/random-numbers-between-1-and-15", "title": "Random numbers between 1 and 15", "body": "<p>I generate many many random numbers that need to be between 1 and 15 (included) in C++. Of course, I can generate zillons of \n<code>std::uniform_int_distribution&lt;std::mt19937::result_type&gt; random(1, 15);</code>\nbut this is a waste since this mersenn twister generates 32 bits (or even 64 using mt19937_64) of random values, and I would only keep 4 bits and throw away all the rest, and in my case, performance is an issue and random number generation is a significant contributor.</p>\n\n<p>My idea was thus to generate for example a single 64-bit random value between 0 and 2^64-1, and select 4 bits among them. The issue is that I can't find a way to have the generated values between 1 and 15.\nExample:</p>\n\n<pre><code>unsigned long long int r = uniform(generator); // between 0 and 2^64-1\nunsigned int r1 = (r+1)&amp;15;     // first desired random value\nunsigned int r2 = ((r&gt;&gt;4)+1)&amp;15; //second desired random value \nunsigned int r3 = ((r&gt;&gt;8)+1)&amp;15; //third desired random value \n...\n</code></pre>\n\n<p>Here, this version of course doesn't work : despite the +1, the generated values are still between 0 and 15 (since if <code>r&amp;15</code> happens to be <code>0xb1111</code> then adding 1 produces the result <code>0xb0000</code>).</p>\n\n<p>Also, I would like the distribution to remain uniform (for instance, I wouldn't want to bias the least significant bit to occur more often, which could be the case with something like <code>(r&amp;15+1)|((r&amp;15 +1) &gt;&gt; 4)</code> since the value <code>0xb0001</code> would occur twice often).</p>\n"}, {"tags": ["c++", "c++17", "inline", "thread-local-storage", "translation-unit"], "answers": [{"tags": [], "owner": {"reputation": 6761, "user_id": 802362, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e1ed0c2043db6eb30095426cd8f96692?s=128&d=identicon&r=PG", "display_name": "Baptiste Wicht", "link": "https://stackoverflow.com/users/802362/baptiste-wicht"}, "is_accepted": false, "score": 2, "last_activity_date": 1606807551, "creation_date": 1606807551, "answer_id": 65086278, "question_id": 56979608, "link": "https://stackoverflow.com/questions/56979608/c17-inline-thread-local-vs-thread-local/65086278#65086278", "title": "c++17 inline + thread_local vs thread_local", "body": "<p>If you include this header file in multiple compilation units, you will get multiple definitions of <code>obj2</code>. But <code>obj1</code> will work fine because the linker will guarantee only one definition will exist and all compilation units will use the same definition (and hence the same address).</p>\n<p>So, your code should use <code>extern</code> for <code>obj2</code> and define it in a single compilation unit. But <code>inline</code> already does that for you for <code>obj1</code>.</p>\n<blockquote>\n<p>Does this mean it's possible for <code>obj2</code> to get different address values\nin different translation units?</p>\n</blockquote>\n<p>In that particular case, no, since it won't compile. But if you add <code>static</code> to <code>obj2</code>, you will get one address per compilation unit.</p>\n<blockquote>\n<p>What would be the situation to highlight we should use <code>obj1</code> rather\nthan <code>obj2</code>?</p>\n</blockquote>\n<p>You should never use <code>obj2</code> like this, <code>obj1</code> is the correct way. If you want to avoid <code>inline</code>, you could use <code>extern</code> for <code>obj2</code>.</p>\n"}], "owner": {"reputation": 2102, "user_id": 2828925, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/18abe23c6b1123371f171f55be659ef5?s=128&d=identicon&r=PG&f=1", "display_name": "Jes", "link": "https://stackoverflow.com/users/2828925/jes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1606807551, "creation_date": 1562799245, "last_edit_date": 1562820025, "question_id": 56979608, "link": "https://stackoverflow.com/questions/56979608/c17-inline-thread-local-vs-thread-local", "title": "c++17 inline + thread_local vs thread_local", "body": "<p>I am wondering what exactly the difference between the following two declarations is if both are written in a single header file:</p>\n\n<pre><code>inline thread_local MyClass obj1;  // inline with thread_local\nthread_local MyClass obj2;         // no inline\n</code></pre>\n\n<p>As specified in C++17, adding inline to a variable forces all translation units to see the same address of that variable. Does this mean it's possible for <code>obj2</code> to get different address values in different translation units? What would be the situation to highlight we should use <code>obj1</code> rather than <code>obj2</code>?</p>\n"}, {"tags": ["c++", "function", "overloading", "declaration"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1562799358, "post_id": 56979566, "comment_id": 100495086, "body": "Overloaded or not, the usual rules still apply. A function must be declared before it can be used. <code>void Foo (B input)</code> is unknown when <code>Foo(b);</code> is invoked in <code>void Foo (A input)</code>."}, {"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 0, "creation_date": 1562799709, "post_id": 56979566, "comment_id": 100495145, "body": "You did not just declare those functions, you defined them too. There&#39;s a difference in the form of forward declarations; they can be used to solve your problem."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 5, "last_activity_date": 1562800228, "last_edit_date": 1562800228, "creation_date": 1562799612, "answer_id": 56979647, "question_id": 56979566, "link": "https://stackoverflow.com/questions/56979566/does-the-order-of-overloaded-function-declaration-matter-in-c/56979647#56979647", "title": "Does the order of overloaded function declaration matter in c++?", "body": "<p>Declaration order of overloads does not matter in the sense that following are equivalent:</p>\n\n<pre><code>// 1.\nvoid foo(int);\nvoid foo(double);\nfoo(42);\n\n// 2.\nvoid foo(double);\nvoid foo(int);\nfoo(42);\n</code></pre>\n\n<p>Declaration order of overloads does matter in the sense that following are not equivalent:</p>\n\n<pre><code>// 3.\nvoid foo(int);\nfoo(42);\nvoid foo(double);\n\n// 4.\nvoid foo(double);\nfoo(42);\nvoid foo(int);\n</code></pre>\n\n<p>Concisely: Only functions that have been declared before the function call take part in overload resolution.</p>\n\n<hr>\n\n<p>In your example program <code>Foo(A)</code> either has infinite recursion (if <code>B</code> implicitly converts to <code>A</code>), or the program is ill-formed since you haven't declared <code>Foo(B)</code> before the call.</p>\n\n<blockquote>\n  <p>Does the compiler only check whether function has been defined</p>\n</blockquote>\n\n<p>In general, compiler does not to check at all whether a function has been defined. However, function must be declared before it can be called.</p>\n"}, {"tags": [], "owner": {"reputation": 272, "user_id": 3935459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddca196f5c4d842e3f5b2a8274bd3953?s=128&d=identicon&r=PG&f=1", "display_name": "JesseC", "link": "https://stackoverflow.com/users/3935459/jessec"}, "is_accepted": true, "score": 3, "last_activity_date": 1562800080, "creation_date": 1562800080, "answer_id": 56979686, "question_id": 56979566, "link": "https://stackoverflow.com/questions/56979566/does-the-order-of-overloaded-function-declaration-matter-in-c/56979686#56979686", "title": "Does the order of overloaded function declaration matter in c++?", "body": "<p>Short answer is yes - the order matters.  (Also, it really has nothing to do with overloads - you could rename <code>Foo(B)</code> to <code>Goo(B)</code>.)</p>\n\n<p>One common remedy for your particular problem is to forward-declare <code>Foo(B)</code>:</p>\n\n<pre><code>// Forward declaration\nvoid Foo(B);\n\nvoid Foo (A input) {\n   B b = B();\n   Foo(b);     // Compiler now knows about Foo(B), so this is fine.\n}\n\nvoid Foo (B input) {\n    // ...\n}\n</code></pre>\n\n<p>The compiler needs to know about that particular function - it must have been <em>declared</em> before it's use.  However, it can be <em>defined</em> elsewhere.  At link time, all the compiler output is gathered and symbols are \"linked\" together - the linker will figure out how to produce the right instructions to call <code>Foo(B)</code> from that line, or possibly inline it, etc.</p>\n\n<p>There may be times where the function must be forward-declared.  E.g.</p>\n\n<pre><code>void Foo() {\n   if (condition) Goo();\n}\n\nvoid Goo() {\n   if (condition) Foo();\n}\n</code></pre>\n\n<p>Both <code>Foo</code> and <code>Goo</code> need to know about each other, so you might declare both before <code>Foo()</code>'s definition (or put them in a header, if appropriate).</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "is_accepted": false, "score": 1, "last_activity_date": 1562801466, "creation_date": 1562801466, "answer_id": 56979831, "question_id": 56979566, "link": "https://stackoverflow.com/questions/56979566/does-the-order-of-overloaded-function-declaration-matter-in-c/56979831#56979831", "title": "Does the order of overloaded function declaration matter in c++?", "body": "<blockquote>\n  <p>Does the order of overloaded function declaration matter in c++?</p>\n</blockquote>\n\n<p>Short answer: Yes. Order matters in C++. Take the following example:</p>\n\n<pre><code>i = 45;\nint i;\n</code></pre>\n\n<p>This would cause an error (assuming that there is no other <code>i</code> in a higher scope, of course). It doesn't matter if it is a variable, function, class, or something else; in C++ a symbol must be declared before it is used. Even if it is an overloaded function, any overload you use in the definition must come first.</p>\n\n<p><strong>A Neat Trick</strong></p>\n\n<p>While you must declare a function before it is used, you don't have to <strong>define</strong> a function before it is used. I'm sure an example will help:</p>\n\n<pre><code>void Foo (A input);\nvoid Foo (B input);\n</code></pre>\n\n<p>These are function declarations. Notice it is missing a definition--that is, an implementation. This just tells the compiler that such a function is there. It doesn't have to know what it does yet, only that it is there.</p>\n\n<p>How does this help us? Well, consider the following program (which works, btw):</p>\n\n<pre><code>void Foo (A input);\nvoid Foo (B input);\n\nint main() {\n   A a = A();\n   Foo(a);\n   return 0;\n}\n\nvoid Foo (A input) {\n   B b = B();\n   Foo(b);\n}\nvoid Foo (B input) {\n   printf(\"%s\", input.toString());\n}\n</code></pre>\n\n<p>Notice anything interesting about this program? We can call <code>Foo(A)</code> in <code>main()</code> before it is defined. That's the nice thing about putting the declaration of <code>Foo(A)</code> above the definition of <code>main()</code>. The compiler knows that <code>Foo(A)</code> exists, so we can call it from <code>main()</code> even if we don't have its definition yet.</p>\n\n<p>The really fun thing about using the declarations like this, is that <strong>once we have the declarations</strong>, <strong>we can put the definitions in any order</strong>. So we can do, for instance, this:</p>\n\n<pre><code>void Foo (A input);\nvoid Foo (B input);\n\nint main() {\n   A a = A();\n   Foo(a);\n   return 0;\n}\n\nvoid Foo (B input) {\n   printf(\"%s\", input.toString());\n}\n\nvoid Foo (A input) {\n   B b = B();\n   Foo(b);\n}\n</code></pre>\n\n<p>Or this:</p>\n\n<pre><code>void Foo (A input);\nvoid Foo (B input);\n\nvoid Foo (A input) {\n   B b = B();\n   Foo(b);\n}\n\nint main() {\n   A a = A();\n   Foo(a);\n   return 0;\n}\n\n\nvoid Foo (B input) {\n   printf(\"%s\", input.toString());\n}\n</code></pre>\n\n<p>Or even this:</p>\n\n<pre><code>void Foo (B input) {\n   printf(\"%s\", input.toString());\n}\n\nint main() {\n   A a = A();\n   Foo(a);\n   return 0;\n}\n\nvoid Foo (A input) {\n   B b = B();\n   Foo(b);\n}\n</code></pre>\n\n<p>Because it all comes <strong>after the declarations</strong>, <strong>the definition order does not matter</strong> in this case.</p>\n\n<hr>\n\n<p>Worth mentioning before I leave: if we have a block of declarations like this:</p>\n\n<pre><code>void Foo (A input);\nvoid Foo (B input);\n</code></pre>\n\n<p>Re-arranging the order of this block doesn't matter. So, we could do this as well:</p>\n\n<pre><code>void Foo (B input);\nvoid Foo (A input);\n</code></pre>\n\n<p>As long as these declarations come before all the definitions, we are still good.</p>\n"}], "owner": {"reputation": 79, "user_id": 11673103, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T0bgE5EUZjY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1xBML98s-ZBNvp5vCa8FHp2gY3A/mo/photo.jpg?sz=128", "display_name": "Mikan", "link": "https://stackoverflow.com/users/11673103/mikan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 56979686, "answer_count": 3, "score": 3, "last_activity_date": 1562801466, "creation_date": 1562798844, "last_edit_date": 1562799749, "question_id": 56979566, "link": "https://stackoverflow.com/questions/56979566/does-the-order-of-overloaded-function-declaration-matter-in-c", "title": "Does the order of overloaded function declaration matter in c++?", "body": "<p>I currently define a function that gets overloaded multiple times. For some of the overloaded definitions, it calls the same function with different type of input. So, function Foo gets defined to take type A, but within the body of the function, it calls Foo on type B. However, Foo on type B gets defined after A gets defined.</p>\n\n<p>I am currently getting error on compile time and I think this is due to the ordering of the overloading definition. I do not have clear error message or debugging tools, so I would like to know if the above scenario does indeed cause an error.</p>\n\n<pre><code>void Foo (A input) {\n   B b = B();\n   Foo(b);\n}\n\nvoid Foo (B input) {\n   printf(\"%s\", input.toString());\n}\n\nint main() {\n   A a = A();\n   Foo(a);\n   return 0;\n}\n\n//code has been oversimplified\n</code></pre>\n\n<p>I think the question can be bottled down to \"does the compiler only check whether function has been defined or does it check whether the function has been defined on particular input?\"</p>\n"}, {"tags": ["c++", "linux", "encryption", "openssl"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1562798975, "post_id": 56979490, "comment_id": 100494991, "body": "What line of code does the segfault happen on?"}, {"owner": {"reputation": 39, "user_id": 11767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a774d5ef499130445b85fc28307ded?s=128&d=identicon&r=PG&f=1", "display_name": "Mattinna", "link": "https://stackoverflow.com/users/11767209/mattinna"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1562800476, "post_id": 56979490, "comment_id": 100495336, "body": "@stark while debugging, the segfault seems to appear in the first line of the void file_encrypt_decrypt function: EVP_CIPHER_block_size () from target:/usr/local/lib/libcrypto.so.1.1"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1562800650, "post_id": 56979490, "comment_id": 100495365, "body": "Means you are passing it a bad parameter"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1562803765, "post_id": 56979490, "comment_id": 100495914, "body": "You might also be interested in <a href=\"https://wiki.openssl.org/index.php/EVP_Authenticated_Encryption_and_Decryption\" rel=\"nofollow noreferrer\">EVP Authenticated Encryption and Decryption</a> on the OpenSSL wiki. Also see <a href=\"https://wiki.openssl.org/index.php/EVP_Symmetric_Encryption_and_Decryption#C.2B.2B_Programs\" rel=\"nofollow noreferrer\">EVP Symmetric Encryption and Decryption | C++ Programs</a> on the wiki."}, {"owner": {"reputation": 39, "user_id": 11767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a774d5ef499130445b85fc28307ded?s=128&d=identicon&r=PG&f=1", "display_name": "Mattinna", "link": "https://stackoverflow.com/users/11767209/mattinna"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1562803864, "post_id": 56979490, "comment_id": 100495932, "body": "@jww indeed, i&#39;ve made a naming error, changed it for AES_256_KEY_SIZE and it is defined as #define AES_256_KEY_SIZE  32"}, {"owner": {"reputation": 39, "user_id": 11767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a774d5ef499130445b85fc28307ded?s=128&d=identicon&r=PG&f=1", "display_name": "Mattinna", "link": "https://stackoverflow.com/users/11767209/mattinna"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1562804491, "post_id": 56979490, "comment_id": 100496045, "body": "@jww I&#39;ve read those them but there&#39;s no example on how to tag a password to an encrypted file"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1562804631, "post_id": 56979490, "comment_id": 100496079, "body": "Well, you should explain what tagging is. I don&#39;t know what it is. The code provided on the wiki shows you how to encrypt and decrypt using OpenSSL&#39;s EVP interfaces."}, {"owner": {"reputation": 39, "user_id": 11767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a774d5ef499130445b85fc28307ded?s=128&d=identicon&r=PG&f=1", "display_name": "Mattinna", "link": "https://stackoverflow.com/users/11767209/mattinna"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1562805103, "post_id": 56979490, "comment_id": 100496177, "body": "@jww I meant having a code that accepts a password from the user and then encrypts/decrypts the file"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1562805314, "post_id": 56979490, "comment_id": 100496205, "body": "OK, so the terminology usually is... a tag refers to an authentication tag. It is the HMAC, CMAC, &lt;favorite MAC&gt; or authentication tag in an authenticated encryption mode of operations. Deriving a key from a password and using it to key a cipher is referred to as key derivation."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1562808016, "post_id": 56979490, "comment_id": 100496655, "body": "The OpenSSL wiki now has a page on key derivation at <a href=\"https://wiki.openssl.org/index.php/EVP_Key_Derivation\" rel=\"nofollow noreferrer\">EVP Key Derivation</a>. The example uses Krawczyk and Eronen&#39;s HKDF. You should consider using it to derive your Key and IV. In your case, you would derive 48-bytes: 32-bytes for the key, and 16-bytes for the IV."}, {"owner": {"reputation": 39, "user_id": 11767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a774d5ef499130445b85fc28307ded?s=128&d=identicon&r=PG&f=1", "display_name": "Mattinna", "link": "https://stackoverflow.com/users/11767209/mattinna"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1562808655, "post_id": 56979490, "comment_id": 100496768, "body": "@jww ok but can I integrate that crypted password into the file? I thought the EVP_BytesToKey function implemented that?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1562809127, "post_id": 56979490, "comment_id": 100496861, "body": "<code>EVP_BytesToKey</code> is the old, non-standard KDF used in OpenSSL. It is not recommend for new applications. Also see the <a href=\"https://www.openssl.org/docs/manmaster/man3/EVP_BytesToKey.html\" rel=\"nofollow noreferrer\"><code>EVP_BytesToKey(3)</code> man page</a>."}, {"owner": {"reputation": 39, "user_id": 11767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a774d5ef499130445b85fc28307ded?s=128&d=identicon&r=PG&f=1", "display_name": "Mattinna", "link": "https://stackoverflow.com/users/11767209/mattinna"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1562811070, "post_id": 56979490, "comment_id": 100497167, "body": "@jww I cannot compile the test.c presented at the EVP Key Derivation wiki, gives  me the error: <code>error: unknown type name \u2018EVP_KDF_CTX\u2019</code>. My openssl version is : <code>openssl version -a : OpenSSL 1.1.1c  28 May 2019</code> and I cannot find the EVP_KDF_CTX type when doing <code>nm -gC libcrypto.a | grep &quot;EVP_KDF_CTX&quot;</code> on ubuntu 16.04. any ideas? thanks"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1562811424, "post_id": 56979490, "comment_id": 100497231, "body": "Interesting. I&#39;m not sure what is going on. I built the program on the wiki page using OpenSSL Master. Maybe <code>EVP_KDF</code> is going into the next release? Ping @MattCaswell. He is one of the OpenSSL devs. He may be able to help."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a774d5ef499130445b85fc28307ded?s=128&d=identicon&r=PG&f=1", "display_name": "Mattinna", "link": "https://stackoverflow.com/users/11767209/mattinna"}, "edited": false, "score": 0, "creation_date": 1562811715, "post_id": 56980655, "comment_id": 100497291, "body": "Ok I understand, so the encryption and decryption has to happen at the same time for this to work, but what if I wanted to encrypt a file with a password and then decrypt it with the same password with 2 different runs of the program? thanks"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 39, "user_id": 11767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a774d5ef499130445b85fc28307ded?s=128&d=identicon&r=PG&f=1", "display_name": "Mattinna", "link": "https://stackoverflow.com/users/11767209/mattinna"}, "edited": false, "score": 0, "creation_date": 1562813961, "post_id": 56980655, "comment_id": 100497684, "body": "That&#39;s how I&#39;ve been trying to use your program, but it does not seem to work. I assume your next step (after fixing this problem) is figure out the next thing that is incorrect. Also see tutorials like <a href=\"https://cs.baylor.edu/~donahoo/tools/gdb/tutorial.html\" rel=\"nofollow noreferrer\">How to Debug Using GDB</a>. Here&#39;s a few to get you started. <code>g++ -g</code> builds with debug info. <code>gdb test.exe</code> loads your program. <code>b main</code> sets a breakpoint in <code>main</code>. <code>r &lt;filename&gt; 1</code> runs the program to encrypt a file. <code>r &lt;filename&gt; 0</code> runs the program to decrypt a file. <code>n</code> executes the next line. <code>s</code> steps into a function."}], "tags": [], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "is_accepted": false, "score": 1, "last_activity_date": 1562810631, "last_edit_date": 1562810631, "creation_date": 1562809978, "answer_id": 56980655, "question_id": 56979490, "link": "https://stackoverflow.com/questions/56979490/decrypt-a-file-with-a-password-with-c-openssl/56980655#56980655", "title": "Decrypt a file with a password with c++/openssl", "body": "<p>Here's your program under GDB during decryption:</p>\n\n<pre><code>(gdb) r NEWS 0\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\nEnter password: test\n\nDecrypting File\nname_encrypted: NEWS\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x000000000040ee20 in EVP_CIPHER_block_size ()\n(gdb) bt full\n#0  0x000000000040ee20 in EVP_CIPHER_block_size ()\nNo symbol table info available.\n#1  0x000000000040447d in file_encrypt_decrypt (params=0x67be70, ifp=0x685e50,\n    ofp=0x686080) at test.c:81\n        cipher_block_size = 0x0\n        in_buf = \"\\022\\000;9Z\\310\\333T\\354\\251bH\\361\\253:\\203Q\\001\\312\\063ZL\\225\\003p2f\\000\\000\\000\\000\\000\\340\\322\\377\\377\\377\\177\", '\\000' &lt;repeats 18 times&gt;, \"\\240Ec\", '\\000' &lt;repeats 13 times&gt;, \"\\347\\026\\376\\367\\377\\177\\000\\000\\001\", '\\000' &lt;repeats 15 times&gt;, \"\\360\\226\\243T9\\035\\215\\066\\bQ\\243\\367\\377\\177\\000\\000\\320\\321\\377\\377\\377\\177\\000\\000\\236\\203\\376\\367\\377\\177\\000\\000\\021\\327\\377\\377\\377\\177\\000\\000\\000\\000\\000\\000\\000\\000\\000\\000@\u05e2\\367\\377\\177\\000\\000GrZ\\000\\000\\000\\000\\000\\021\\327\\377\\377\\377\\177\\000\\000\\377\\377\\377\\377\\000\\000\\000\\000\\025\\000\\000\\000\\000\\000\\000\\000p\\001\\001\\000\\000\\000\\000\\000\\320,j\\000\\000\\000\\000\\000`\"...\n        out_buf = &lt;error reading variable out_buf (value requires 6840449 bytes, which is more than max-value-size)&gt;\n        num_bytes_read = 0x0\n        out_len = 0xf6af024b\n        ctx = 0x686080\n#2  0x0000000000404e1f in main (argc=0x3, argv=0x7fffffffd3c8) at test.c:257\n        f_input = 0x685e50\n        f_enc = 0x7fffffffd3e8\n        f_dec = 0x686080\n</code></pre>\n\n<p>Then, checkout frame 1. frame 0 is not interesting; it is just OpenSSL library code crashing on a bad parameter:</p>\n\n<pre><code>(gdb) frame 1\n#1  0x000000000040447d in file_encrypt_decrypt (params=0x67be70, ifp=0x685e50,\n    ofp=0x686080) at test.c:81\n81          int cipher_block_size = EVP_CIPHER_block_size(params-&gt;cipher_type);\n(gdb) p params\n$1 = (cipher_params_t *) 0x67be70\n(gdb) p params-&gt;cipher_type\n$2 = (const EVP_CIPHER *) 0x0\n</code></pre>\n\n<p>Your cipher object is NULL. You need to create a cipher object and assign it to <code>params</code>. Or you need to provide a real object to <code>EVP_CIPHER_block_size</code>.</p>\n\n<hr>\n\n<p>Here is what you are doing during encryption:</p>\n\n<pre><code>190         if (*argv[2] == '1') {\n(gdb)\n192             printf(\"\\nEncrypting File\\n\");\n(gdb)\n\nEncrypting File\n195             params-&gt;encrypt = 1;\n(gdb)\n198             params-&gt;cipher_type = EVP_aes_256_cbc();\n</code></pre>\n\n<p>I'm guessing decryption is missing the call to <code>params-&gt;cipher_type = EVP_aes_256_cbc();</code>.</p>\n\n<p>You should probably hoist this out of the <code>if/else</code> block so both encryption and decryption executes it.</p>\n\n<pre><code>/* Set the cipher type you want for encryption-decryption */\nparams-&gt;cipher_type = EVP_aes_256_cbc();\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a774d5ef499130445b85fc28307ded?s=128&d=identicon&r=PG&f=1", "display_name": "Mattinna", "link": "https://stackoverflow.com/users/11767209/mattinna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1149, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562810631, "creation_date": 1562798241, "last_edit_date": 1562803700, "question_id": 56979490, "link": "https://stackoverflow.com/questions/56979490/decrypt-a-file-with-a-password-with-c-openssl", "title": "Decrypt a file with a password with c++/openssl", "body": "<p>I'm trying to decrypt a file previously encrypted with the same code in c++ and openssl. Unfortunately, I get a segfault and I can't figure out the exact problem.</p>\n\n<p>I'm able to encrypt an image file but the segfault occurs when trying to decrypt it.</p>\n\n<p>It seems the problem lies in this function:</p>\n\n<pre><code>void file_encrypt_decrypt(cipher_params_t *params, FILE *ifp, FILE *ofp)\n{\n    /* Allow enough space in output buffer for additional block */\n    int cipher_block_size = EVP_CIPHER_block_size(params-&gt;cipher_type);\n    unsigned char in_buf[BUFSIZE], out_buf[BUFSIZE + cipher_block_size];\n\n    int num_bytes_read =  0, out_len = 0;\n    EVP_CIPHER_CTX *ctx;\n\n    ctx = EVP_CIPHER_CTX_new();\n    if(ctx == NULL){\n        fprintf(stderr, \"ERROR: EVP_CIPHER_CTX_new failed. OpenSSL error: %s\\n\", \n                ERR_error_string(ERR_get_error(), NULL));\n        cleanup(params, ifp, ofp, ERR_EVP_CTX_NEW);\n    }\n\n    /* Don't set key or IV right away; we want to check lengths */\n    if(!EVP_CipherInit_ex(ctx, params-&gt;cipher_type, NULL, NULL, NULL, params-&gt;encrypt)){\n        fprintf(stderr, \"ERROR: EVP_CipherInit_ex failed. OpenSSL error: %s\\n\", \n                ERR_error_string(ERR_get_error(), NULL));\n        cleanup(params, ifp, ofp, ERR_EVP_CIPHER_INIT);\n    }\n\n    OPENSSL_assert(EVP_CIPHER_CTX_key_length(ctx) == AES_256_KEY_SIZE);\n    OPENSSL_assert(EVP_CIPHER_CTX_iv_length(ctx) == AES_BLOCK_SIZE);\n\n    /* Now we can set key and IV */\n    if(!EVP_CipherInit_ex(ctx, NULL, NULL, params-&gt;key, params-&gt;iv, params-&gt;encrypt)){\n        fprintf(stderr, \"ERROR: EVP_CipherInit_ex failed. OpenSSL error: %s\\n\", \n                ERR_error_string(ERR_get_error(), NULL));\n        EVP_CIPHER_CTX_cleanup(ctx);\n        cleanup(params, ifp, ofp, ERR_EVP_CIPHER_INIT);\n    }\n\n    while(1){\n        // Read in data in blocks until EOF. Update the ciphering with each read.\n        num_bytes_read = fread(in_buf, sizeof(unsigned char), BUFSIZE, ifp);\n\n        if (ferror(ifp)){\n            fprintf(stderr, \"ERROR: fread error: %s\\n\", strerror(errno));\n            EVP_CIPHER_CTX_cleanup(ctx);\n            cleanup(params, ifp, ofp, errno);\n        }\n        if(!EVP_CipherUpdate(ctx, out_buf, &amp;out_len, in_buf, num_bytes_read)){\n            fprintf(stderr, \"ERROR: EVP_CipherUpdate failed. OpenSSL error: %s\\n\", \n                    ERR_error_string(ERR_get_error(), NULL));\n            EVP_CIPHER_CTX_cleanup(ctx);\n            cleanup(params, ifp, ofp, ERR_EVP_CIPHER_UPDATE);\n        }\n        fwrite(out_buf, sizeof(unsigned char), out_len, ofp);\n        if (ferror(ofp)) {\n            fprintf(stderr, \"ERROR: fwrite error: %s\\n\", strerror(errno));\n            EVP_CIPHER_CTX_cleanup(ctx);\n            cleanup(params, ifp, ofp, errno);\n        }\n        if (num_bytes_read &lt; BUFSIZE) {\n            /* Reached End of file */\n            break;\n        }\n    }\n\n    /* Now cipher the final block and write it out to file */\n    if(!EVP_CipherFinal_ex(ctx, out_buf, &amp;out_len)){\n        fprintf(stderr, \"ERROR: EVP_CipherFinal_ex failed. OpenSSL error: %s\\n\", \n                ERR_error_string(ERR_get_error(), NULL));\n        EVP_CIPHER_CTX_cleanup(ctx);\n        cleanup(params, ifp, ofp, ERR_EVP_CIPHER_FINAL);\n    }\n    fwrite(out_buf, sizeof(unsigned char), out_len, ofp);\n    if (ferror(ofp)) {\n        fprintf(stderr, \"ERROR: fwrite error: %s\\n\", strerror(errno));\n        EVP_CIPHER_CTX_cleanup(ctx);\n        cleanup(params, ifp, ofp, errno);\n    }\n    EVP_CIPHER_CTX_cleanup(ctx);\n}\n</code></pre>\n\n<p>I suspect the key lengths aren't the same and the issue occurs along theses lines :</p>\n\n<pre><code>OPENSSL_assert(EVP_CIPHER_CTX_key_length(ctx) == AES_256_KEY_SIZE);\nOPENSSL_assert(EVP_CIPHER_CTX_iv_length(ctx) == AES_BLOCK_SIZE);\n</code></pre>\n\n<p>The password entered is used in here in main() (see below):</p>\n\n<pre><code>if (EVP_BytesToKey(EVP_aes_256_cbc(), EVP_sha256(), (unsigned char*)salt, (unsigned char*)pwd, sizeof(pwd), 1, params-&gt;key, params-&gt;iv) == 0) {\n        perror(\"Error: EVP_BytesToKey\\n\");\n    }\n</code></pre>\n\n<p>For the sake of completion, here's a working example for encrypting a file (excluding the function above (void file_encrypt_decrypt)):</p>\n\n<pre><code>#define _XOPEN_SOURCE\n#include &lt;crypt.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;unistd.h&gt;\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n#include &lt;iomanip&gt;\n#include &lt;fstream&gt;\n#include &lt;vector&gt;\n#include &lt;cstdint&gt;\n\n#include &lt;openssl/evp.h&gt;\n#include &lt;openssl/err.h&gt;\n#include &lt;openssl/aes.h&gt;\n#include &lt;openssl/rand.h&gt;\n#include &lt;openssl/sha.h&gt;\n\n#define ERR_EVP_CIPHER_INIT     -1\n#define ERR_EVP_CIPHER_UPDATE   -2\n#define ERR_EVP_CIPHER_FINAL    -3\n#define ERR_EVP_CTX_NEW         -4\n\n#define AES_256_KEY_SIZE        32 \n#define AES_BLOCK_SIZE          16\n#define BUFSIZE                 1024\n\ntypedef struct _cipher_params_t {\n    unsigned char *key;\n    unsigned char *iv;\n    unsigned int encrypt;\n    const EVP_CIPHER *cipher_type;\n} cipher_params_t;\n\nvoid cleanup(cipher_params_t *params, FILE *ifp, FILE *ofp, int rc)\n{\n    free(params);\n    fclose(ifp);\n    fclose(ofp);\n    exit(rc);\n}\n\nstd::string sha256(const std::string str)\n{\n    unsigned char hash[SHA256_DIGEST_LENGTH];\n    SHA256_CTX sha256;\n    SHA256_Init(&amp;sha256);\n    SHA256_Update(&amp;sha256, str.c_str(), str.size());\n    SHA256_Final(hash, &amp;sha256);\n    std::stringstream ss;\n    for(int i = 0; i &lt; SHA256_DIGEST_LENGTH; ++i) {\n        ss &lt;&lt; std::hex &lt;&lt; std::setw(2) &lt;&lt; std::setfill('0') &lt;&lt; (int)hash[i];\n    }\n    return ss.str();\n}\n\nchar *take_pwd(char *salt)\n{\n    int MAX_SIZE = 80;\n    char password[MAX_SIZE];\n    char *encrypted_password;\n    int i = 0;\n    char c;\n    printf(\"Enter password: \");\n    while ((c = getchar()) != '\\n' &amp;&amp; i &lt; MAX_SIZE) {\n        password[i++] = c;\n    }\n    std::string salt_str = sha256(salt);\n    encrypted_password = crypt(password, const_cast&lt;char *&gt;(salt_str.c_str()));\n    encrypted_password[MAX_SIZE] = '\\0';\n    return encrypted_password;\n}\n\nint main(int argc, char *argv[]) \n{\n    FILE *f_input, *f_enc, *f_dec;\n\n    /* Make sure user provides the input file */\n    if (argc != 3) {\n        printf(\"Usage: %s /path/to/file + 0 (decrypt) or 1 (encrypt)\\n\", argv[0]);\n        return -1;\n    }\n\n    cipher_params_t *params = (cipher_params_t *)malloc(sizeof(cipher_params_t));\n    if (!params) {\n        /* Unable to allocate memory on heap*/\n        fprintf(stderr, \"ERROR: malloc error: %s\\n\", strerror(errno));\n        return errno;\n    }\n\n    /* Key to use for encrpytion and decryption */\n    unsigned char key[AES_256_KEY_SIZE];\n\n    /* Initialization Vector */\n    unsigned char iv[AES_BLOCK_SIZE];\n\n    char salt[] = \"$1$........\";\n    char *pwd = take_pwd(salt);\n\n    if (EVP_BytesToKey(EVP_aes_256_cbc(), EVP_sha256(), (unsigned char*)salt, (unsigned char*)pwd, sizeof(pwd), 1, params-&gt;key, params-&gt;iv) == 0) {\n        perror(\"Error: EVP_BytesToKey\\n\");\n    }\n\n    params-&gt;key = key;\n    params-&gt;iv = iv;\n\n    char *file_name = argv[1];\n\n    if (*argv[2] == '1') { \n\n        printf(\"\\nEncrypting File\\n\");\n\n        /* Indicate that we want to encrypt */\n        params-&gt;encrypt = 1;\n\n        /* Set the cipher type you want for encryption-decryption */\n        params-&gt;cipher_type = EVP_aes_256_cbc();\n\n        /* Open the input file for reading in binary (\"rb\" mode) */\n        f_input = fopen(argv[1], \"rb\");\n        if (!f_input) {\n            /* Unable to open file for reading */\n            fprintf(stderr, \"ERROR: fopen error: %s\\n\", strerror(errno));\n            return errno;\n        }\n\n        /* Open and truncate file to zero length or create ciphertext file for writing */\n        std::string name_of_file = file_name;\n        std::string encrypted = \"_encrypted_\";\n        std::size_t position_of_dot = name_of_file.find_last_of(\".\");\n        if (position_of_dot != std::string::npos) {\n            name_of_file.insert(position_of_dot, encrypted);\n        }\n\n        f_enc = fopen(name_of_file.c_str(), \"wb\");\n        if (!f_enc) {\n            /* Unable to open file for writing */\n            fprintf(stderr, \"ERROR: fopen error: %s\\n\", strerror(errno));\n            return errno;\n        }\n\n        /* Encrypt the given file */\n        file_encrypt_decrypt(params, f_input, f_enc);\n\n        /* Encryption done, close the file descriptors */\n        fclose(f_input);\n        fclose(f_enc);\n    } else if (*argv[2] == '0') {\n\n        printf(\"\\nDecrypting File\\n\");\n\n        /* Decrypt the file */\n        /* Indicate that we want to decrypt */\n        params-&gt;encrypt = 0;\n\n        /* Open the encrypted file for reading in binary (\"rb\" mode) */\n\n        printf(\"name_encrypted: %s\\n\", file_name);\n        f_input = fopen(file_name, \"rb\");\n\n        if (!f_input) {\n            /* Unable to open file for reading */\n            fprintf(stderr, \"ERROR: fopen error: %s\\n\", strerror(errno));\n            return errno;\n        }\n\n        /* Open and truncate file to zero length or create decrypted file for writing */\n        f_dec = fopen(\"decrypted_file\", \"wb\");\n        if (!f_dec) {\n            /* Unable to open file for writing */\n            fprintf(stderr, \"ERROR: fopen error: %s\\n\", strerror(errno));\n            return errno;\n        }   \n\n        /* Decrypt the given file */\n        file_encrypt_decrypt(params, f_input, f_dec);\n\n        /* Close the open file descriptors */\n        fclose(f_input);\n        fclose(f_dec);\n    }\n    /* Free the memory allocated to our structure */\n    free(params);\n    return 0;\n}\n</code></pre>\n\n<p>I compiled and executed the code for encryption as such (the arg 1 is for encryption):</p>\n\n<pre><code>g++ -Wall -std=c++11 encrypt.cpp -o encrypt -lssl -lcrypto -lcrypt\n./encrypt \"~/path/to/image/file.jpg\" 1\n</code></pre>\n\n<p>and for decryption (0):</p>\n\n<pre><code>./encrypt \"~/path/to/image/file_encrypted_.jpg\" 0\n</code></pre>\n\n<p>The segfault seems to appear in the first line of the void file_encrypt_decrypt function: </p>\n\n<pre><code>EVP_CIPHER_block_size () from target:/usr/local/lib/libcrypto.so.1.1\n</code></pre>\n"}, {"tags": ["c++", "kotlin", "io"], "answers": [{"comments": [{"owner": {"reputation": 3999, "user_id": 101954, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/37gU2.jpg?s=128&g=1", "display_name": "CW Holeman II", "link": "https://stackoverflow.com/users/101954/cw-holeman-ii"}, "edited": false, "score": 0, "creation_date": 1562879602, "post_id": 56992576, "comment_id": 100528662, "body": "How about the hiding of the regex and formatting details from the user of College?"}, {"owner": {"reputation": 4397, "user_id": 9164471, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IY5Hr42LB7Q/AAAAAAAAAAI/AAAAAAAAAHc/sk_5_2q1nCU/photo.jpg?sz=128", "display_name": "Rene", "link": "https://stackoverflow.com/users/9164471/rene"}, "reply_to_user": {"reputation": 3999, "user_id": 101954, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/37gU2.jpg?s=128&g=1", "display_name": "CW Holeman II", "link": "https://stackoverflow.com/users/101954/cw-holeman-ii"}, "edited": false, "score": 0, "creation_date": 1562919016, "post_id": 56992576, "comment_id": 100538618, "body": "I just extend my answer with some ideas to hide the details."}, {"owner": {"reputation": 3999, "user_id": 101954, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/37gU2.jpg?s=128&g=1", "display_name": "CW Holeman II", "link": "https://stackoverflow.com/users/101954/cw-holeman-ii"}, "edited": false, "score": 0, "creation_date": 1562947614, "post_id": 56992576, "comment_id": 100553896, "body": "The &#39;Registry for parsers&#39; addresses the question that popped up.  Can the .register() be hidden in the class?"}, {"owner": {"reputation": 3999, "user_id": 101954, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/37gU2.jpg?s=128&g=1", "display_name": "CW Holeman II", "link": "https://stackoverflow.com/users/101954/cw-holeman-ii"}, "edited": false, "score": 0, "creation_date": 1563150956, "post_id": 56992576, "comment_id": 100593157, "body": "I am trying it. I have describe the results I get in <a href=\"https://stackoverflow.com/questions/57015559/eclipse-kotlin-identifying-just-some-needed-imports\" title=\"eclipse kotlin identifying just some needed imports\">stackoverflow.com/questions/57015559/&hellip;</a> . Any ideas?"}, {"owner": {"reputation": 4397, "user_id": 9164471, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IY5Hr42LB7Q/AAAAAAAAAAI/AAAAAAAAAHc/sk_5_2q1nCU/photo.jpg?sz=128", "display_name": "Rene", "link": "https://stackoverflow.com/users/9164471/rene"}, "reply_to_user": {"reputation": 3999, "user_id": 101954, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/37gU2.jpg?s=128&g=1", "display_name": "CW Holeman II", "link": "https://stackoverflow.com/users/101954/cw-holeman-ii"}, "edited": false, "score": 0, "creation_date": 1563169369, "post_id": 56992576, "comment_id": 100596134, "body": "It looks like you missed the &quot;org.jetbrains.kotlin:kotlin-stdlib&quot; and maybe the &quot;org.jetbrains.kotlin:kotlin-reflect&quot; in your dependencies."}], "tags": [], "owner": {"reputation": 4397, "user_id": 9164471, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IY5Hr42LB7Q/AAAAAAAAAAI/AAAAAAAAAHc/sk_5_2q1nCU/photo.jpg?sz=128", "display_name": "Rene", "link": "https://stackoverflow.com/users/9164471/rene"}, "is_accepted": false, "score": 0, "last_activity_date": 1563099615, "last_edit_date": 1563099615, "creation_date": 1562858600, "answer_id": 56992576, "question_id": 56979307, "link": "https://stackoverflow.com/questions/56979307/kotlin-load-a-collection-of-a-class-from-a-file/56992576#56992576", "title": "Kotlin load a collection of a class from a file?", "body": "<p>There are many ways to parse a file and split the lines in Kotlin / Java. \nThe next example uses a Regex to split the line into an id and the name for the college:</p>\n\n<pre><code>data class College(val id: String, val name: String)\n\nval colleges = File(\"input.txt\").useLines { lines -&gt;\n    val regex = Regex(\"(\\\\d+) (.+)\")\n    lines.mapNotNull { line -&gt;\n        regex.matchEntire(line)?.let {\n            College(it.groupValues[1], it.groupValues[2])\n        }\n    }.toList()\n}\n</code></pre>\n\n<p>If you need to read from the standard input, then replace the third line with:</p>\n\n<pre><code>val colleges = InputStreamReader(System.`in`).useLines { lines -&gt;\n</code></pre>\n\n<p><strong>Update: Hide details</strong></p>\n\n<p>There is no general way to parse text files into object in Java / Kotlin. For XML and Json files exists some standard APIs and you can register Serializer/Deserializer for each type. </p>\n\n<p>If you need such an abstraction for simple line oriented text files you have to build it yourself. The next examples may give you an idea:</p>\n\n<pre><code>fun &lt;T : Any&gt; File.parseLines(lineParser: (String) -&gt; T?): List&lt;T&gt; =\n    useLines { it.mapNotNull(lineParser).toList() }\n</code></pre>\n\n<p>The function extend the <code>File</code> class with a <code>parseLines</code> method.</p>\n\n<p>The implementation of the line parser for class <code>College</code> would be like this:</p>\n\n<pre><code>val collegeLineParser: (String) -&gt; College? = { line -&gt;\n    val regex = Regex(\"(\\\\d+) (.+)\")\n    regex.matchEntire(line)?.let {\n        College(it.groupValues[1], it.groupValues[2])\n    }\n}\n</code></pre>\n\n<p>Or if you like to cache the <code>RegEx</code>:</p>\n\n<pre><code>val collegeLineParserCachedRegex = object : (String) -&gt; College? {\n    val regex = Regex(\"(\\\\d+) (.+)\")\n    override fun invoke(line: String): College? =\n        regex.matchEntire(line)?.let {\n            College(it.groupValues[1], it.groupValues[2])\n        }\n}\n</code></pre>\n\n<p>Now you can invoke the method <code>parseLines</code> on a <code>File</code>: </p>\n\n<pre><code>val colleges = File(\"input.txt\").parseLines(collegeLineParser)\n</code></pre>\n\n<p><strong>Update: Registry for parsers</strong></p>\n\n<p>If you do not like to provide the <code>lineParser</code> for every call, you can create a registry: </p>\n\n<pre><code>object LineParserRegistry {\n    val parsers = ConcurrentHashMap&lt;KClass&lt;*&gt;, (String) -&gt; Any?&gt;()\n\n    inline fun &lt;reified T&gt; register(noinline parser : (String) -&gt; T?) {\n        parsers[T::class] = parser\n    }\n\n    inline fun &lt;reified T&gt; get(): (String) -&gt; T? {\n        // force companion initializer\n        Class.forName(T::class.java.name)\n        return parsers[T::class] as (String) -&gt; T??\n    }\n}\n\ninline fun &lt;reified T : Any&gt; File.parseLines(): List&lt;T&gt; =\n    useLines { it.mapNotNull(LineParserRegistry.get&lt;T&gt;()).toList() }\n</code></pre>\n\n<p>If you like to register the parsers automatically you need to add an companion object with an <code>init</code> method:</p>\n\n<pre><code>data class College(val id: String, val name: String) {\n    companion object {\n        init {\n            val collegeLineParser: (String) -&gt; College? = { line -&gt;\n                val regex = Regex(\"(\\\\d+) (.+)\")\n                regex.matchEntire(line)?.let {\n                    College(it.groupValues[1], it.groupValues[2])\n                }\n            }\n            LineParserRegistry.register(collegeLineParser)\n        }\n    }\n}\n</code></pre>\n\n<p>This <code>init</code> method is invoked the first time the <code>College</code> class is used. But reflection does not count, therefore we had to add <code>Class.forName(T::class.java.name)</code> into the <code>get</code> method of the registry. This call forces the initialization of the companion object.</p>\n\n<p>Now you can call the parser without any preparations: </p>\n\n<pre><code>val colleges = File(\"input.txt\").parseLines&lt;College&gt;()\n</code></pre>\n"}], "owner": {"reputation": 3999, "user_id": 101954, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/37gU2.jpg?s=128&g=1", "display_name": "CW Holeman II", "link": "https://stackoverflow.com/users/101954/cw-holeman-ii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563099615, "creation_date": 1562796754, "question_id": 56979307, "link": "https://stackoverflow.com/questions/56979307/kotlin-load-a-collection-of-a-class-from-a-file", "title": "Kotlin load a collection of a class from a file?", "body": "<p>In C++ I can load a collection of a class from a file using a friend <a href=\"https://en.cppreference.com/w/cpp/io/basic_istream/operator_gtgt2\" rel=\"nofollow noreferrer\">operator>></a> overload:</p>\n\n<pre><code>friend std::istream&amp; operator&gt;&gt;(std::istream&amp; is_a, College&amp; college_a) {\n    return is_a &gt;&gt; college_a.id_,\n        is_a.get(),\n        std::getline(is_a,college_a.name_);\n}\n\nstd::set&lt;College&gt; colleges {};\nstd::copy(std::istream_iterator&lt;College&gt; {std::cin},\n    std::istream_iterator&lt;College&gt; {},\n    std::inserter(colleges, colleges.begin())); \n</code></pre>\n\n<p>from a file like this:</p>\n\n<pre><code>0707 Rowan Technical College\n0980 University of Saskatchewan\n1058 Belmont University\n1072 Belmont Technical College\n</code></pre>\n\n<p>How would this be done with Kotlin?</p>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 3, "last_activity_date": 1562797475, "last_edit_date": 1562797475, "creation_date": 1562796987, "answer_id": 56979335, "question_id": 56979305, "link": "https://stackoverflow.com/questions/56979305/object-does-not-name-a-type-whats-going-on/56979335#56979335", "title": "(object) does not name a type. Whats going on?", "body": "<p>You cannot use statements</p>\n\n<pre><code>tekstura.loadFromFile(\"trawa.png\"); //&lt;---- here it says \"tekstura does not name a type\"\nTenBlok.setTexture(tekstura); //&lt;---- here it says \"TenBlok does not name a type\"\n</code></pre>\n\n<p>in the class definition. They are not declarations. You can have such statements inside the definition of a member function, but not the class itself.</p>\n\n<p>A simpler class that will fail with similar errors:</p>\n\n<pre><code>struct Foo\n{\n   int i;\n   i = 10;\n};\n</code></pre>\n\n<p>To initialize <code>i</code> (or execute similar statements), use a constructor.</p>\n\n<pre><code>struct Foo\n{\n   int i;\n   Foo() { i = 10; }  // For demonstration. It will be better to initialize\n                      // i using Foo() : i(10) {}\n};\n</code></pre>\n\n<p>For you class, you probably need:</p>\n\n<pre><code>class Trawa : public blok\n{\n   int id = 0;\n   sf::Texture tekstura;\n\n   Trawa() : blok(0, 0)  // Assume position to be (0, 0)\n   {\n      tekstura.loadFromFile(\"trawa.png\");\n      TenBlok.setTexture(tekstura);\n   }\n};\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11767271, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_6UDaGSUhw4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf6NnFrFAOGURwMhIucHluM3pI5Bw/photo.jpg?sz=128", "display_name": "kowlad", "link": "https://stackoverflow.com/users/11767271/kowlad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562797475, "creation_date": 1562796748, "question_id": 56979305, "link": "https://stackoverflow.com/questions/56979305/object-does-not-name-a-type-whats-going-on", "title": "(object) does not name a type. Whats going on?", "body": "<p>I think the code shows the problem best</p>\n\n<pre><code>class blok\n{ public:\n    sf::RectangleShape TenBlok;\n    int x,y;\n    blok(int posX ,int posY)\n {\n     x = posX;\n     y = posY;\n }\n void place(int x,int y)\n {\n        TenBlok.setPosition((float)x,(float)y)\n }\n};\n</code></pre>\n\n<p>[...]</p>\n\n<pre><code>class Trawa : public blok\n{\n\nint id = 0;\nsf::Texture tekstura;\ntekstura.loadFromFile(\"trawa.png\"); //&lt;---- here it says \"tekstura does not name a type\"\nTenBlok.setTexture(tekstura); //&lt;---- here it says \"TenBlok does not name a type\"\n\n};\n</code></pre>\n\n<p>Error says that the object doesnt name a type, but oddly enough CodeBlocks sees bother tekstura and TenBlok as vaild objects becouse id hints functions those objects contain</p>\n"}, {"tags": ["c++", "regex"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1562797022, "post_id": 56979289, "comment_id": 100494506, "body": "I would use <code>R&quot;((?:https|http):\\&#47;\\&#47;media\\.discordapp\\.net\\&#47;.*?\\.(?:png|gi&zwnj;&#8203;f|jpeg|jpg))&quot;</code> <a href=\"https://regex101.com/r/1ThKVy/1\" rel=\"nofollow noreferrer\">Demo</a>"}, {"owner": {"reputation": 11, "user_id": 11767223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5034f1f3387a97ea3b77646d7fee651f?s=128&d=identicon&r=PG&f=1", "display_name": "Derbanister", "link": "https://stackoverflow.com/users/11767223/derbanister"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1562798714, "post_id": 56979289, "comment_id": 100494936, "body": "unfortunately not working&lt;br&gt; &lt;img src=&quot;<a href=\"https://cdn.discordapp.com/attachments/539138991031844864/598643321115508767/Screenshot_18.png\" rel=\"nofollow noreferrer\">cdn.discordapp.com/attachments/539138991031844864/&hellip;</a>&quot;  width=&quot;100&quot; height=&quot;600&quot;&gt;"}, {"owner": {"reputation": 2167, "user_id": 10504469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MomS5.jpg?s=128&g=1", "display_name": "Jin Lee", "link": "https://stackoverflow.com/users/10504469/jin-lee"}, "edited": false, "score": 0, "creation_date": 1562804005, "post_id": 56979289, "comment_id": 100495964, "body": "Your link doesn&#39;t seem to work."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11767223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5034f1f3387a97ea3b77646d7fee651f?s=128&d=identicon&r=PG&f=1", "display_name": "Derbanister", "link": "https://stackoverflow.com/users/11767223/derbanister"}, "edited": false, "score": 0, "creation_date": 1562799128, "post_id": 56979389, "comment_id": 100495025, "body": "But my compiller say &quot;identifier  R not defined&quot;"}, {"owner": {"reputation": 11, "user_id": 11767223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5034f1f3387a97ea3b77646d7fee651f?s=128&d=identicon&r=PG&f=1", "display_name": "Derbanister", "link": "https://stackoverflow.com/users/11767223/derbanister"}, "edited": false, "score": 0, "creation_date": 1562843801, "post_id": 56979389, "comment_id": 100510399, "body": "I did it &quot;((?:https|http):\\\\/\\\\/media\\\\.discordapp\\\\.net\\\\/.*?\\\\.(?:p&zwnj;&#8203;ng|gif|jpeg|jpg))&quot; without raw string literal and it worked."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 0, "last_activity_date": 1562797391, "creation_date": 1562797391, "answer_id": 56979389, "question_id": 56979289, "link": "https://stackoverflow.com/questions/56979289/how-to-get-urls-by-regex-c/56979389#56979389", "title": "How to get urls by regex c++?", "body": "<p>You might do:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void checkString(std::string x,std::regex e){\n    std::smatch m;\n\n    while (regex_search(x, m, e))\n    {\n        std::cout &lt;&lt; m.str() &lt;&lt; '\\n';\n        x = m.suffix();\n    }\n}\n\nint main(){\n    std::regex e(R\"((?:https|http):\\/\\/media\\.discordapp\\.net\\/.*?\\.(?:png|gif|jpeg|jpg))\");\n\n    std::string example=\"dadasdasdhttps://media.discordapp.net/Js1VPuxC5xs.pngdsdhttps://media.discordapp.net/Js1VPuxC5xs.gifsdhttps://media.discordapp.net/Js1VPuxC5xs.jpegsddshttps://media.discordapp.net/Js1VPuxC5xs.jpg\";\n\n    checkString(example,e);\n} \n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/f99bd7e278f59537\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11767223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5034f1f3387a97ea3b77646d7fee651f?s=128&d=identicon&r=PG&f=1", "display_name": "Derbanister", "link": "https://stackoverflow.com/users/11767223/derbanister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56979389, "answer_count": 1, "score": 0, "last_activity_date": 1562797391, "creation_date": 1562796637, "question_id": 56979289, "link": "https://stackoverflow.com/questions/56979289/how-to-get-urls-by-regex-c", "title": "How to get urls by regex c++?", "body": "<p>I can't parse all url's from string. I want to push all url's to array.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;regex&gt;\n\nvoid checkString(std::string x,std::regex e){\n  std::smatch m;\n  std::regex_search (x,m,e);\n  std::cout&lt;&lt;m.position(0);\n}\nvoid run(void){\n    std::regex e(\"((https)|(http))\\:\\/\\/media.discordapp.net\\/.*\\.(((png)|(gif))|((jpeg)|(jpg)))\");\n\n    std::string example=\"dadasdasdhttps://media.discordapp.net/Js1VPuxC5xs.pngdsdhttps://media.discordapp.net/Js1VPuxC5xs.gifsdhttps://media.discordapp.net/Js1VPuxC5xs.jpegsddshttps://media.discordapp.net/Js1VPuxC5xs.jpg\";\n\n    checkString(example,e);\n}    \n</code></pre>\n\n<p>I expect the output of:<br>\n<a href=\"https://media.discordapp.net/Js1VPuxC5xs.png\" rel=\"nofollow noreferrer\">https://media.discordapp.net/Js1VPuxC5xs.png</a> <br>\n<a href=\"https://media.discordapp.net/Js1VPuxC5xs.gif\" rel=\"nofollow noreferrer\">https://media.discordapp.net/Js1VPuxC5xs.gif</a> <br>\n<a href=\"https://media.discordapp.net/Js1VPuxC5xs.jpeg\" rel=\"nofollow noreferrer\">https://media.discordapp.net/Js1VPuxC5xs.jpeg</a> <br>\n<a href=\"https://media.discordapp.net/Js1VPuxC5xs.jpg\" rel=\"nofollow noreferrer\">https://media.discordapp.net/Js1VPuxC5xs.jpg</a> <br></p>\n"}, {"tags": ["c++", "arrays", "undefined-behavior"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1562796656, "post_id": 56979248, "comment_id": 100494430, "body": "You got UB with out of bound access."}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 10, "creation_date": 1562797034, "post_id": 56979248, "comment_id": 100494507, "body": "<code>What&#39;s going on?!</code> apparently one of the runtime library developers has a sense of humor for dealing with stack corruption.  As UB is UB this behavior is correct."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 3, "creation_date": 1562797531, "post_id": 56979248, "comment_id": 100494630, "body": "I absolutely love this. What compiler and what version do you use? I need to see it with my own eyes"}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1562797679, "post_id": 56979248, "comment_id": 100494675, "body": "@Yksisarvinen - It&#39;s an internally maintained fork of clang."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "edited": false, "score": 0, "creation_date": 1562797736, "post_id": 56979248, "comment_id": 100494691, "body": "To those marking this question as &quot;unclear what you&#39;re asking&quot;, could you please clarify how I might improve my question? I provided an example that anybody can compile and a clear description of the behavior I&#39;m seeing."}, {"owner": {"reputation": 552, "user_id": 11038454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118900695ae8e562f696c0dd14feb0d7?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/11038454/tony"}, "edited": false, "score": 0, "creation_date": 1562798442, "post_id": 56979248, "comment_id": 100494881, "body": "Array over boundary, and the result is undetermined Behavior."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1562798460, "post_id": 56979248, "comment_id": 100494887, "body": "@DaveS - That sounds like it might be an answer."}, {"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 11, "creation_date": 1562799832, "post_id": 56979248, "comment_id": 100495169, "body": "I want this question to stay here forever and redirect any further questions regarding UB to this one as a warning. Please."}, {"owner": {"reputation": 7041, "user_id": 314290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5ffde821f0f9670e601b19f1731a6849?s=128&d=identicon&r=PG", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/314290/mikhail"}, "edited": false, "score": 0, "creation_date": 1562800800, "post_id": 56979248, "comment_id": 100495386, "body": "Voting to close because it can&#39;t be reproduced"}, {"owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 0, "creation_date": 1562825487, "post_id": 56979248, "comment_id": 100500534, "body": "I missed this good UB"}], "owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 4, "closed_date": 1562801041, "answer_count": 0, "score": 10, "last_activity_date": 1562865057, "creation_date": 1562796377, "last_edit_date": 1562865057, "question_id": 56979248, "link": "https://stackoverflow.com/questions/56979248/why-does-this-simple-program-result-in-puppies-puppies-puppies-to-the-console", "closed_reason": "Needs details or clarity", "title": "Why does this simple program result in &quot;puppies puppies puppies&quot; to the console?", "body": "<p>This weird thing happened, and I managed to condense it down to just this small program:</p>\n\n<pre><code>int main()\n{\n    int a[20];\n    a[21] = 5;\n    return 0;\n}\n</code></pre>\n\n<p>this program results in <code>puppies puppies puppies</code> continuously scrolling by on the terminal until I hit control-C. What's going on?!</p>\n\n<p><strong>Edit:</strong> What is unclear about this question? Please tell me so I can improve it.</p>\n"}, {"tags": ["c++", "windows", "c++14", "variadic-templates", "stdtuple"], "answers": [{"tags": [], "owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "is_accepted": false, "score": 3, "last_activity_date": 1562796140, "creation_date": 1562796140, "answer_id": 56979216, "question_id": 56979172, "link": "https://stackoverflow.com/questions/56979172/stdtuple-duplicate-type-t-in-getttuple-compile-time-assertion-failure/56979216#56979216", "title": "std::tuple duplicate type T in get&lt;T&gt;(tuple) - Compile time assertion failure", "body": "<p>The example can be simlpified to the following:</p>\n\n<pre><code>auto t = std::make_tuple(1, 's', 2);\nstd::get&lt;int&gt;(t);\n</code></pre>\n\n<p>here, we have a <code>t</code> of a type <code>std::tuple&lt;int, char, int&gt;</code>. <code>std::get</code> can also work with types (alongside indexes), unless you have a duplicate type. <code>std::get&lt;char&gt;</code> will work since there is only one <code>char</code> in the <code>t</code>, but <code>std::get&lt;int&gt;</code> will not work, since it does not know <em>which</em> <code>int</code> to fetch - the <code>1</code> or the <code>2</code>?</p>\n\n<p>This is what's happening here: </p>\n\n<pre><code>void func() {\n    func_tuple(std::get&lt;Args&gt;(m_tuple_args)...);\n}\n</code></pre>\n\n<p>the <code>std::get&lt;Args&gt;</code>, after expansion, will not work if <code>Args...</code> contain at least one duplicate type, because it will simply <em>not know <strong>which</strong> one to fetch</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 6432, "user_id": 1655229, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0zT5b.png?s=128&g=1", "display_name": "PinkTurtle", "link": "https://stackoverflow.com/users/1655229/pinkturtle"}, "edited": false, "score": 0, "creation_date": 1562871261, "post_id": 56979225, "comment_id": 100525467, "body": "It worked for me using a helper func and <code>index_sequence_for</code>. Thanks! I think when using <code>std::apply</code> for a class instance method, one has to prepend the actual instance to the tuple so that it becomes the 1st argument to the function/callable - but I couldnt afford that extra copy ;)"}], "tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": true, "score": 2, "last_activity_date": 1562796415, "last_edit_date": 1562796415, "creation_date": 1562796237, "answer_id": 56979225, "question_id": 56979172, "link": "https://stackoverflow.com/questions/56979172/stdtuple-duplicate-type-t-in-getttuple-compile-time-assertion-failure/56979225#56979225", "title": "std::tuple duplicate type T in get&lt;T&gt;(tuple) - Compile time assertion failure", "body": "<p>Use <a href=\"https://en.cppreference.com/w/cpp/utility/apply\" rel=\"nofollow noreferrer\">C++17 <code>std::apply()</code></a> to pass all the elements of a tuple to a function.</p>\n\n<pre><code>std::apply([&amp;](auto... x){ func_tuple(x...); }, m_tuple_args);\n</code></pre>\n\n<p>You insist on staying with C++14?<br>\nNo problem, cppreference.com shows a short and simple production-quality example-implementation.</p>\n\n<p>Alternatively, you can work directly with <a href=\"https://en.cppreference.com/w/cpp/utility/integer_sequence\" rel=\"nofollow noreferrer\"><code>std::make_index_sequence</code></a> to get unique indices instead of duplicated types.</p>\n"}, {"comments": [{"owner": {"reputation": 6432, "user_id": 1655229, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0zT5b.png?s=128&g=1", "display_name": "PinkTurtle", "link": "https://stackoverflow.com/users/1655229/pinkturtle"}, "edited": false, "score": 0, "creation_date": 1562799257, "post_id": 56979570, "comment_id": 100495062, "body": "Thanks, this clarifies the use of std::index_sequence for me. I don&#39;t want to use a helper function tho so I will use C++17&#39;s apply or.... you meationed the <i>numeric version of std::get()</i>, what does this mean and can I unwrap a parameters pack with it in C++14? Thanks! Edit: just read the doc no need to answer :]"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 6432, "user_id": 1655229, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0zT5b.png?s=128&g=1", "display_name": "PinkTurtle", "link": "https://stackoverflow.com/users/1655229/pinkturtle"}, "edited": false, "score": 0, "creation_date": 1562799665, "post_id": 56979570, "comment_id": 100495139, "body": "@PinkTurtle - for &quot;numeric version of <code>std::get()</code>&quot; I mean the version of <code>std::get&lt;&gt;()</code> that receive a <code>std::size_t</code>, instead of a type, as template parameter (cases from (1) to (4) in <a href=\"https://en.cppreference.com/w/cpp/utility/tuple/get\" rel=\"nofollow noreferrer\">this page</a>. I don&#39;t full understand your following question but you can see the way to unpack a parameter pack in C++11 (and newer versions) is the usual: you can see it in <code>func_helper()</code>. The problem, here, is generate the parameter pack of indexes; you need <code>std::make_index_sequence</code> or <code>std::index_sequence_for</code> (that are almost the same). (continue)"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 6432, "user_id": 1655229, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0zT5b.png?s=128&g=1", "display_name": "PinkTurtle", "link": "https://stackoverflow.com/users/1655229/pinkturtle"}, "edited": false, "score": 0, "creation_date": 1562799855, "post_id": 56979570, "comment_id": 100495175, "body": "@PinkTurtle - (continue) Unfortunately <code>std::index_sequence</code> are available only starting from C++14 and I don&#39;t see a way to generate the index sequence without defining an helper functions. Starting from C++17, you can use <code>std::apply()</code> that take care of generate the index sequence and use <code>std::get&lt;&gt;()</code>, numeric version."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 1, "last_activity_date": 1562798854, "creation_date": 1562798854, "answer_id": 56979570, "question_id": 56979172, "link": "https://stackoverflow.com/questions/56979172/stdtuple-duplicate-type-t-in-getttuple-compile-time-assertion-failure/56979570#56979570", "title": "std::tuple duplicate type T in get&lt;T&gt;(tuple) - Compile time assertion failure", "body": "<blockquote>\n  <p>Why does this happen [?]</p>\n</blockquote>\n\n<p>All goes well when the <code>Args...</code> types are all differents.</p>\n\n<p>You get an error when types collides.</p>\n\n<p>This is because <code>std::get&lt;T&gt;(tuple_val)</code>, where <code>T</code> is a type, \"Fails to compile unless the tuple has exactly one element of that type\" (as you can read in <a href=\"https://en.cppreference.com/w/cpp/utility/tuple/get\" rel=\"nofollow noreferrer\">this page</a>). And this seems reasonable to me.</p>\n\n<p>So all goes well with</p>\n\n<pre><code>store_in_tuple&lt;int, float, double, size_t&gt; \n</code></pre>\n\n<p>because all types are differents, and you get an error from</p>\n\n<pre><code>store_in_tuple&lt;int, float, double, int&gt;\n</code></pre>\n\n<p>because the two calls to <code>std::get&lt;int&gt;(m_tuple_args)</code> fail.</p>\n\n<blockquote>\n  <p>and is there a workaround ?</p>\n</blockquote>\n\n<p>Use the numeric version of <code>std::get()</code>, that is ever available, also when types collides.</p>\n\n<p>The usual way in C++14 pass through an helper function with <code>std::index_sequence</code> and <code>std::make_index_sequence</code> (or <code>std::index_sequence_for</code>).</p>\n\n<p>Seems complicated but it's very simple</p>\n\n<pre><code>template &lt;std::size_t ... Is&gt;\nvoid func_helper (std::index_sequence&lt;Is...&gt; const)\n { func_tuple(std::get&lt;Is&gt;(m_tuple_args)...); }\n\nvoid func ()\n { func_helper(std::index_sequence_for&lt;Args...&gt;{}); }\n</code></pre>\n\n<p>If you can use C++17, you can use <code>std::apply()</code> that (I suppose) use <code>std::index_sequence</code> under the hood.</p>\n"}], "owner": {"reputation": 6432, "user_id": 1655229, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0zT5b.png?s=128&g=1", "display_name": "PinkTurtle", "link": "https://stackoverflow.com/users/1655229/pinkturtle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 1, "accepted_answer_id": 56979225, "answer_count": 3, "score": 2, "last_activity_date": 1562799228, "creation_date": 1562795825, "last_edit_date": 1562799228, "question_id": 56979172, "link": "https://stackoverflow.com/questions/56979172/stdtuple-duplicate-type-t-in-getttuple-compile-time-assertion-failure", "title": "std::tuple duplicate type T in get&lt;T&gt;(tuple) - Compile time assertion failure", "body": "<p>I am storing the variadic arguments to an object constructor inside a <code>std::tuple</code> and so far so good. But when calling an object function using the stored arguments and <code>std::get&lt;&gt;()</code>, I will be thrown a <strong>compile-time</strong> assertion failure that I simply don't understand. This will happen <strong>only when all arguments are not each of a different type</strong>.</p>\n\n<p>The compiler error message is:</p>\n\n<blockquote>\n  <p>msvc\\14.16.27023\\include\\tuple(934): error C2338: duplicate type T in\n  get(tuple)</p>\n</blockquote>\n\n<p>mcve below:</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\ntemplate&lt;class... Args&gt;\nstruct store_in_tuple {\n\n    tuple&lt;Args...&gt; m_tuple_args;\n\n    store_in_tuple(Args... args) : m_tuple_args{ args... } {}\n\n    void func() {\n        func_tuple(std::get&lt;Args&gt;(m_tuple_args)...);\n    }\n\n    void func_tuple(Args... args) {}\n};\n\nint main(int argc, char** argv) {\n\n    store_in_tuple&lt;int, float, double, int&gt; sit1(1, 2.0f, 3.0, 4);\n    sit1.func(); // &lt;- not ok\n\n    store_in_tuple&lt;int, float, double, size_t&gt; sit2(1, 2.0f, 3.0, 4);\n    sit2.func(); // &lt;- ok\n\n    return 0;\n}\n</code></pre>\n\n<p>Why does this happen and is there a workaround ?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "edited": false, "score": 1, "creation_date": 1562794767, "post_id": 56978985, "comment_id": 100493907, "body": "A <code>FieldEncoder</code> should declare a virtual destructor."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562794779, "post_id": 56978985, "comment_id": 100493913, "body": "TL;DR of the dupe: <code>FieldEncoder</code> needs a virtual destructor to be destroyed polymorphicly."}, {"owner": {"reputation": 1, "user_id": 11767169, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9cUwu4KL2u4/AAAAAAAAAAI/AAAAAAAAAFI/7rTFx75lBjY/photo.jpg?sz=128", "display_name": "Marek Paprota", "link": "https://stackoverflow.com/users/11767169/marek-paprota"}, "edited": false, "score": 0, "creation_date": 1562795629, "post_id": 56978985, "comment_id": 100494151, "body": "Thank you very much! I didn&#39;t even think about having virtual destructor..."}, {"owner": {"reputation": 2581, "user_id": 5141304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dH8FwSGAMts/AAAAAAAAAAI/AAAAAAAAABY/L6D_xatTkV4/photo.jpg?sz=128", "display_name": "Cruz Jean", "link": "https://stackoverflow.com/users/5141304/cruz-jean"}, "edited": false, "score": 0, "creation_date": 1562803721, "post_id": 56978985, "comment_id": 100495909, "body": "Just to clarify further, the general saying is: if you&#39;re going to be making something that can be inherited, either make the dtor public and virtual (a leaf type) or protected and non-virtual (a non-leaf type)."}], "owner": {"reputation": 1, "user_id": 11767169, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9cUwu4KL2u4/AAAAAAAAAAI/AAAAAAAAAFI/7rTFx75lBjY/photo.jpg?sz=128", "display_name": "Marek Paprota", "link": "https://stackoverflow.com/users/11767169/marek-paprota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "closed_date": 1562794734, "answer_count": 0, "score": 0, "last_activity_date": 1562794637, "creation_date": 1562794637, "question_id": 56978985, "link": "https://stackoverflow.com/questions/56978985/unique-ptrabstractbase-make-uniquederrived-compiles-and-runs-but-crashe", "closed_reason": "Duplicate", "title": "unique_ptr&lt;AbstractBase&gt; = make_unique&lt;Derrived&gt;() compiles and runs, but crashes with exit code 132", "body": "<p>Given following class structure, I'm not able execute this line of code without program to crash at the end of the function. </p>\n\n<p>For:</p>\n\n<pre><code>unique_ptr&lt;BufferedFieldEncoder&gt; p = make_unique&lt;GenericFieldEncoder&gt;();\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>Process finished with exit code 132 (interrupted by signal 4: SIGILL)\n</code></pre>\n\n<p>but this line works fine (no crash):</p>\n\n<pre><code>unique_ptr&lt;FieldEncoder&gt; p = make_unique&lt;GenericFieldEncoder&gt;(); \n</code></pre>\n\n<p>This is how my class structure looks like</p>\n\n<pre><code>class FieldEncoder {\npublic:\n    virtual void encode(const string &amp;data, const FieldEncoderMode &amp;mode) = 0;\n}; \n</code></pre>\n\n<pre><code>\nclass BufferedFieldEncoder : public FieldEncoder {\nprotected:\n    vector&lt;uint8_t&gt; m_buffer;\npublic:\n    vector&lt;uint8_t&gt; &amp;getBuffer() {\n        return m_buffer;\n    }\n};\n\n</code></pre>\n\n<pre><code>class GenericFieldEncoder : public BufferedFieldEncoder {\nprivate:\n    const unique_ptr&lt;Something&gt; something; (maybe this line is necessary)\n\npublic:\n    explicit GenericFieldEncoder(); // initialisation of 'something'\n\n    void encode(const string &amp;data, const FieldEncoderMode &amp;mode) override;\n};\n</code></pre>\n\n<p>How can I create an instance of derived class and store it in unique_ptr of abstract derived class? </p>\n\n<pre><code>unique_ptr&lt;BufferedFieldEncoder&gt; p = make_unique&lt;GenericFieldEncoder&gt;();\n</code></pre>\n\n<p>I'm no c++ expert as you can see :) </p>\n"}, {"tags": ["c++", "struct", "compiler-errors"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562794409, "post_id": 56978918, "comment_id": 100493801, "body": "[Off topic] Do not use a <code>char*</code> to point to string literals.  It was deprecated in C++03 and removed in C++11.  Either use a <code>const char*</code> or a <code>std::string</code>/<code>std::string_view</code>"}, {"owner": {"reputation": 4756, "user_id": 10001688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kvhzK.jpg?s=128&g=1", "display_name": "Michael Bianconi", "link": "https://stackoverflow.com/users/10001688/michael-bianconi"}, "edited": false, "score": 2, "creation_date": 1562794549, "post_id": 56978918, "comment_id": 100493847, "body": "You need to wrap each menuItem array in an additional <code>{</code> (<code>{{&quot;Help&quot;, 7},         {&quot;About&quot;, 9},         {&quot;Update ..&quot;, 9}}</code>)."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1562794867, "post_id": 56978918, "comment_id": 100493939, "body": "What do you expect from <code>menuItem item[];</code>? should it be <code>std::vector</code> instead?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1562795553, "post_id": 56978918, "comment_id": 100494126, "body": "Remember that size of arrays in C++ has to be determined at compile time."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1562798612, "post_id": 56978918, "comment_id": 100494914, "body": "And in C, flexible array members can generally only be used with dynamically allocated structures, not an array of structures, because you have to allocate enough additional memory for the flexible array."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1562799455, "post_id": 56978918, "comment_id": 100495105, "body": "<code>menuItem item[];</code> is not allowed in Standard C++, you must specify a size (or use a different construct altogether)"}], "answers": [{"comments": [{"owner": {"reputation": 100, "user_id": 7748778, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZIe0U5I6BuI/AAAAAAAAAAI/AAAAAAAAF00/tOyNmPSVU-Y/photo.jpg?sz=128", "display_name": "Pranav Patil", "link": "https://stackoverflow.com/users/7748778/pranav-patil"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562798281, "post_id": 56979080, "comment_id": 100494843, "body": "My bad, just laziness on my part."}, {"owner": {"reputation": 3, "user_id": 9540072, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "robb30", "link": "https://stackoverflow.com/users/9540072/robb30"}, "edited": false, "score": 0, "creation_date": 1562839869, "post_id": 56979080, "comment_id": 100508120, "body": "The menu is basically static (won&#39;t be changed during runtime ( - yet)). Therefore i could set all sizes. But i just thought there was another way.  Since it will be use on an embedded system, i&#39;ve care about memory. Thanks!"}], "tags": [], "owner": {"reputation": 100, "user_id": 7748778, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZIe0U5I6BuI/AAAAAAAAAAI/AAAAAAAAF00/tOyNmPSVU-Y/photo.jpg?sz=128", "display_name": "Pranav Patil", "link": "https://stackoverflow.com/users/7748778/pranav-patil"}, "is_accepted": true, "score": 1, "last_activity_date": 1562798347, "last_edit_date": 1562798347, "creation_date": 1562795248, "answer_id": 56979080, "question_id": 56978918, "link": "https://stackoverflow.com/questions/56978918/cpp-too-many-initializers-struct-in-struct-in-array/56979080#56979080", "title": "cpp too many initializers - struct in struct in array", "body": "<p>First, wrap the menuItem item[] array in {} because currently it thinks there are many arrays rather than just one.</p>\n\n<p>Next, change the char * to const char * as was mentioned.</p>\n\n<p>Now for the flexible  amount of menuItem structs, use a vector rather than an array. </p>\n\n<pre><code>#include &lt;vector&gt; \n\nstruct menuItem {\n    const char *name;\n    int value;\n};\n\nstruct topMenu {\n    int menuIcon;\n    const char *Name;\n    std::vector&lt;menuItem&gt; item;\n};\n\ntopMenu menuRoot[] = {\n    { 0, \"File\", {\n        {\"Open ...\", 1},\n        {\"Open ...\", 1},\n        {\"Open ...\", 1},\n        {\"Open ...\", 1},\n    }\n    },\n    { 0, \"Help\", {\n        {\"Open ...\", 1},\n        {\"Open ...\", 1},\n        {\"Open ...\", 1}, }\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9540072, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "robb30", "link": "https://stackoverflow.com/users/9540072/robb30"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 56979080, "answer_count": 1, "score": 0, "last_activity_date": 1562798347, "creation_date": 1562794278, "question_id": 56978918, "link": "https://stackoverflow.com/questions/56978918/cpp-too-many-initializers-struct-in-struct-in-array", "title": "cpp too many initializers - struct in struct in array", "body": "<p>I'm new to cpp since a few days and struggling with the following definition:</p>\n\n<pre><code>struct menuItem {\n    char* name;\n    int value;\n};\n\nstruct topMenu {\n    int menuIcon;\n    char* Name;\n    menuItem item[];\n};\n\ntopMenu menuRoot[] = {\n    { 0, \"File\", \n        {\"Open ...\", 1},\n        {\"New ...\", 4},\n        {\"Close\", 1},\n        {\"Exit\", 3}\n\n    },\n    { 0, \"Edit\", \n        {\"Cut \", 3},\n        {\"Copy\", 8},\n        {\"Paste\", 2},\n        {\"Find\", 1},\n        {\"Replace\", 6}\n\n    },\n    { 0, \"Help\", \n        {\"Help\", 7},\n        {\"About\", 9},\n        {\"Update ..\", 9}\n    }  \n};\n</code></pre>\n\n<p>I receive the error</p>\n\n<pre><code>33:1: error: too many initializers for 'menuItem [0]'\n33:1: error: too many initializers for 'topMenu'\n33:1: error: too many initializers for 'menuItem [0]'\n33:1: error: too many initializers for 'topMenu'\n33:1: error: too many initializers for 'menuItem [0]'\n33:1: error: too many initializers for 'topMenu'\n</code></pre>\n\n<p>Sorry, i'm a little bit stuck ... maybe its just to late :)\nThanks in advance.</p>\n"}, {"tags": ["c++", "c++builder-xe7"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562813017, "post_id": 56978910, "comment_id": 100497523, "body": "<code>InputValidation</code> is a variable name, not a type. That is why you can&#39;t use it as a parameter type. Jarod&#39;s answer shows you how to declare <code>InputValidation</code> as a type"}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1562820493, "post_id": 56979032, "comment_id": 100498969, "body": "This will still allow general <code>int</code> values to be passed to the method"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 4, "last_activity_date": 1562919288, "last_edit_date": 1562919288, "creation_date": 1562794928, "answer_id": 56979032, "question_id": 56978910, "link": "https://stackoverflow.com/questions/56978910/how-to-pass-an-enum-to-a-method-without-passing-it-as-an-integer/56979032#56979032", "title": "How to pass an enum to a method without passing it as an integer", "body": "<p>Your enum definition is wrong, it should be:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>enum /*class*/ InputValidation\n{\n    inputValidation_Zipcode,\n    inputValidation_String,\n    inputValidation_Number\n};\n</code></pre>\n\n<p>Then you might use:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>bool methodName(InputValidation inputenum);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314, "user_id": 11751217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eWsMd.jpg?s=128&g=1", "display_name": "abonneville", "link": "https://stackoverflow.com/users/11751217/abonneville"}, "is_accepted": false, "score": 1, "last_activity_date": 1562812918, "last_edit_date": 1562812918, "creation_date": 1562795113, "answer_id": 56979051, "question_id": 56978910, "link": "https://stackoverflow.com/questions/56978910/how-to-pass-an-enum-to-a-method-without-passing-it-as-an-integer/56979051#56979051", "title": "How to pass an enum to a method without passing it as an integer", "body": "<p>Give scoped enum a try by adding <code>class</code> as follows:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>enum class InputValidation\n{\n    inputValidation_Zipcode,\n    inputValidation_String,\n    inputValidation_Number\n};\n</code></pre>\n\n<p>For more information:\n<a href=\"https://en.cppreference.com/w/cpp/language/enum\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/enum</a></p>\n"}], "owner": {"reputation": 193, "user_id": 994642, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xqgpH.jpg?s=128&g=1", "display_name": "j.gooch", "link": "https://stackoverflow.com/users/994642/j-gooch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 56979032, "answer_count": 2, "score": 1, "last_activity_date": 1562919288, "creation_date": 1562794249, "question_id": 56978910, "link": "https://stackoverflow.com/questions/56978910/how-to-pass-an-enum-to-a-method-without-passing-it-as-an-integer", "title": "How to pass an enum to a method without passing it as an integer", "body": "<p>I Have an enum which contains 3 different values </p>\n\n<pre><code>enum\n{\n    inputValidation_Zipcode,\n    inputValidation_String,\n    inputValidation_Number\n} InputValidation;\n</code></pre>\n\n<p>I am trying to pass one of these three enum values to a method, and have tried the following. </p>\n\n<pre><code>bool methodName(enum InputValidation inputenum)\n\nbool methodName(InputValidation inputenum) \n</code></pre>\n\n<p>and ofc </p>\n\n<pre><code>bool methodName(int inpoutenum) \n</code></pre>\n\n<p>(All three called as methodName(InputValidation_Number) )</p>\n\n<p>I know the last one will \"work\" but allows ALL integers as arguments. How can I Write a method to only accept the inputValidation values?</p>\n"}, {"tags": ["c++", "dll", "com", "atl", "visual-studio-2019"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562796248, "post_id": 56978900, "comment_id": 100494322, "body": "<code>while (!terminated)</code> and then you just have to figure out how to set <code>terminated</code> to <code>true</code> when you want to kick out. You&#39;ll still be at the mercy of however long <code>tobii_wait_for_callbacks</code> waits for a callback."}, {"owner": {"reputation": 8188, "user_id": 1390192, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2011214205e164fbfd409cf42a0d23c9?s=128&d=identicon&r=PG", "display_name": "tmighty", "link": "https://stackoverflow.com/users/1390192/tmighty"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562797713, "post_id": 56978900, "comment_id": 100494686, "body": "@user4581301 Can I still call voids from the consuming app while the ATL DLL processes the while statement?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 3, "creation_date": 1562813109, "post_id": 56978900, "comment_id": 100497542, "body": "@tmighty you can if the <code>while</code> loop is run in a separate thread"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1562827172, "post_id": 56978900, "comment_id": 100501311, "body": "Can you consider an ATL COM exe instead of a DLL?"}, {"owner": {"reputation": 8188, "user_id": 1390192, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2011214205e164fbfd409cf42a0d23c9?s=128&d=identicon&r=PG", "display_name": "tmighty", "link": "https://stackoverflow.com/users/1390192/tmighty"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562960533, "post_id": 56978900, "comment_id": 100558495, "body": "@RemyLebeau Can you point me to a link on how to do that?"}], "owner": {"reputation": 8188, "user_id": 1390192, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2011214205e164fbfd409cf42a0d23c9?s=128&d=identicon&r=PG", "display_name": "tmighty", "link": "https://stackoverflow.com/users/1390192/tmighty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562794210, "creation_date": 1562794210, "question_id": 56978900, "link": "https://stackoverflow.com/questions/56978900/alternative-to-while-statement", "title": "Alternative to while statement", "body": "<p>I'm dealing with an eye tracker. This is a device that watches the user's pupils. \nThey have a really basic example, and in their sample code, they wait for callbacks this way:</p>\n\n<pre><code>int is_running = 1000; // in this sample, exit after some iterations\nwhile( --is_running &gt; 0 )\n{\n    error = tobii_wait_for_callbacks( NULL, 1, &amp;device );\n    assert( error == TOBII_ERROR_NO_ERROR || error == TOBII_ERROR_TIMED_OUT );\n\n    error = tobii_device_process_callbacks( device );\n    assert( error == TOBII_ERROR_NO_ERROR );\n}\n</code></pre>\n\n<p>I need to encapsulate their sample code in an ATL COM DLL, and I wonder what I could use if I want to run the code as long as the DLL is alive. \nI don't want to use a fixed value like they did.</p>\n\n<p>Do I have to use an endless while loop? </p>\n\n<p>I come from event driven Visual Basic and while statements sound like something that blocks other things while they're being executed.</p>\n\n<p>The full (short) C++ code can be inspected <a href=\"https://developer.tobii.com/consumer-eye-trackers/stream-engine/getting-started/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Thank you very much for the help!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1562794160, "post_id": 56978869, "comment_id": 100493721, "body": "\ud83d\udeab\ud83d\udcf8 Please post code, errors, sample data or textual output here as plain-text, not as images that can be hard to read, can\u2019t be copy-pasted to help test code or use in answers, and are barrier to those who depend on screen readers. You can edit your question to add the code in the body of your question. For easy formatting use the <code>{}</code> button to mark blocks of code, or indent with four spaces for the same effect. The contents of a <b>screenshot can\u2019t be searched, run as code, or copied and edited to create a solution.</b>"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1562794619, "post_id": 56978869, "comment_id": 100493870, "body": "Did you forget the <code>,</code> in your fold expression? <code>(_assign_single&lt;Indices, Keys&gt;(buffer) , ...);</code>"}, {"owner": {"reputation": 1, "user_id": 6205159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae94e23f9aeeb5d6d9458b910a59646?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Vedel Rasmussen", "link": "https://stackoverflow.com/users/6205159/oliver-vedel-rasmussen"}, "edited": false, "score": 0, "creation_date": 1562795519, "post_id": 56978869, "comment_id": 100494121, "body": "That was just an oversight by me, normally it was there but i forgot to add it back before i posted it here"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1562801069, "post_id": 56978869, "comment_id": 100495429, "body": "Cannot reproduce, once that comma is added, see <a href=\"https://rextester.com/HGY71389\" rel=\"nofollow noreferrer\">rextester.com/HGY71389</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6205159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae94e23f9aeeb5d6d9458b910a59646?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Vedel Rasmussen", "link": "https://stackoverflow.com/users/6205159/oliver-vedel-rasmussen"}, "edited": false, "score": 0, "creation_date": 1562795560, "post_id": 56979025, "comment_id": 100494129, "body": "It was normally there but i forgot to add it back before i posted here, still no luck and the same errors are still appearing"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 1, "user_id": 6205159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae94e23f9aeeb5d6d9458b910a59646?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Vedel Rasmussen", "link": "https://stackoverflow.com/users/6205159/oliver-vedel-rasmussen"}, "edited": false, "score": 0, "creation_date": 1562821466, "post_id": 56979025, "comment_id": 100499194, "body": "@oliver Yet people cannot reproduce with the comma there.  Pkease generate a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that actually reproduces your issue and post another question with it."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 0, "last_activity_date": 1562794866, "creation_date": 1562794866, "answer_id": 56979025, "question_id": 56978869, "link": "https://stackoverflow.com/questions/56978869/parameter-pack-must-be-expanded-in-this-context-after-switching-to-visual-studio/56979025#56979025", "title": "parameter pack must be expanded in this context after switching to Visual Studio 2019", "body": "<pre><code>   (_assign_single&lt;Indices, Keys&gt;(buffer) ...);\n</code></pre>\n\n<p>needs to be</p>\n\n<pre><code>   (_assign_single&lt;Indices, Keys&gt;(buffer), ...);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6205159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae94e23f9aeeb5d6d9458b910a59646?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Vedel Rasmussen", "link": "https://stackoverflow.com/users/6205159/oliver-vedel-rasmussen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562794866, "creation_date": 1562793998, "last_edit_date": 1562794168, "question_id": 56978869, "link": "https://stackoverflow.com/questions/56978869/parameter-pack-must-be-expanded-in-this-context-after-switching-to-visual-studio", "title": "parameter pack must be expanded in this context after switching to Visual Studio 2019", "body": "<p>Unfortunately after I switched to Visual Studio 2019 i've stumpled upon an error i just can't seem to fix.</p>\n\n<p>Basically my program keeps telling me about a parameter pack i need to expand in this certain context. I've tried to look at various other posts but i just can't seem to understand it properly</p>\n\n<p>Below you can see the error codes im getting</p>\n\n<p><a href=\"https://i.stack.imgur.com/KThhE.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/KThhE.png</a></p>\n\n<p>And here is the code that is outputting the error</p>\n\n<pre><code>template&lt;std::uint64_t... Keys&gt;\nclass key_list \n{\n    template&lt;std::size_t Index, std::uint64_t Key&gt;\n    static void _assign_single(XORSTR_VOLATILE std::uint64_t* buffer)\n    {\n        buffer[Index] = Key;\n    }\n\npublic:\n    template&lt;std::size_t... Indices&gt;\n    static void assign(XORSTR_VOLATILE std::uint64_t* buffer, std::index_sequence&lt;Indices...&gt;)\n    {\n        (_assign_single&lt;Indices, Keys&gt;(buffer) ...);\n    }\n};\n</code></pre>\n\n<p>Any help would be gratefully appreciated :)</p>\n\n<p>EDIT: Formatting</p>\n"}, {"tags": ["c++", "compiler-errors"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 4, "creation_date": 1562793999, "post_id": 56978834, "comment_id": 100493669, "body": "The error is about the fact that <code>cPlayerBasicData</code> is merely declared, but not actually defined anywhere."}, {"owner": {"reputation": 2296, "user_id": 1785730, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/130fbc040e6e248bd4e7659bc9bf78ee?s=128&d=identicon&r=PG", "display_name": "user1785730", "link": "https://stackoverflow.com/users/1785730/user1785730"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1562794227, "post_id": 56978834, "comment_id": 100493747, "body": "Actually cPlayerBasicData is defined in playerbasicdata.h. I don&#39;t know how they are supposed to come together."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 1, "creation_date": 1562794380, "post_id": 56978834, "comment_id": 100493796, "body": "Declaring it, one could make pointers to it, but actually instantiating it requires more information that is not preceding in one&#39;s compilation unit."}, {"owner": {"reputation": 2296, "user_id": 1785730, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/130fbc040e6e248bd4e7659bc9bf78ee?s=128&d=identicon&r=PG", "display_name": "user1785730", "link": "https://stackoverflow.com/users/1785730/user1785730"}, "edited": false, "score": 0, "creation_date": 1562794479, "post_id": 56978834, "comment_id": 100493823, "body": "When compiling with gcc it did not care about this error. Could this be because basicPlayerData is not instantiated?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 3, "creation_date": 1562795355, "post_id": 56978834, "comment_id": 100494071, "body": "They are supposed to come together by way of <code>#include &quot;playerbasicdata.h&quot;</code> , of course."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1562795832, "post_id": 56978834, "comment_id": 100494196, "body": "@user1785730 yes, it would have to not be instantiated if it compiled correctly."}, {"owner": {"reputation": 2296, "user_id": 1785730, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/130fbc040e6e248bd4e7659bc9bf78ee?s=128&d=identicon&r=PG", "display_name": "user1785730", "link": "https://stackoverflow.com/users/1785730/user1785730"}, "edited": false, "score": 0, "creation_date": 1562796096, "post_id": 56978834, "comment_id": 100494271, "body": "What is the most conservative way of dealing with this error? (This is not my code and it&#39;s huge. I don&#39;t want to fix everything.)"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 2, "creation_date": 1562796220, "post_id": 56978834, "comment_id": 100494316, "body": "Comment out <code>model.h:221</code>, but that&#39;s probably going to lead to more errors. @IgorTandetnik&#39;s solution of finding a header file that defines it and including it before <code>map.cpp:32</code> is probably the most promising."}, {"owner": {"reputation": 2296, "user_id": 1785730, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/130fbc040e6e248bd4e7659bc9bf78ee?s=128&d=identicon&r=PG", "display_name": "user1785730", "link": "https://stackoverflow.com/users/1785730/user1785730"}, "edited": false, "score": 0, "creation_date": 1562796491, "post_id": 56978834, "comment_id": 100494388, "body": "Ok thanks, that did the trick."}], "owner": {"reputation": 2296, "user_id": 1785730, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/130fbc040e6e248bd4e7659bc9bf78ee?s=128&d=identicon&r=PG", "display_name": "user1785730", "link": "https://stackoverflow.com/users/1785730/user1785730"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562806351, "creation_date": 1562793736, "last_edit_date": 1562806351, "question_id": 56978834, "link": "https://stackoverflow.com/questions/56978834/compilation-error-variable-has-incomplete-type", "title": "compilation error: variable has incomplete type", "body": "<p>This is the make error:</p>\n\n<pre><code>In file included from /Users/ingmar/src/maxr/src/game/data/map/map.cpp:32:\n/Users/ingmar/src/maxr/src/game/data/model.h:221:22: error: variable has incomplete type\n      'cPlayerBasicData'\n                                cPlayerBasicData basicPlayerData;\n                                                 ^\n/Users/ingmar/src/maxr/src/game/data/player/player.h:48:7: note: forward declaration of\n      'cPlayerBasicData'\nclass cPlayerBasicData;\n      ^\n</code></pre>\n\n<p>I'll try to include the relevant code.</p>\n\n<p>model.h:</p>\n\n<pre><code>...\n#include \"game/data/player/player.h\"\n...\nclass cPlayerBasicData;\n...\nclass cModel\n{\n    ...\n    template&lt;typename T&gt;\n    void load(T&amp; archive)\n    {\n        ...\n        for (auto&amp; player : playerList)\n        {\n            if (player == nullptr)\n            {\n                cPlayerBasicData basicPlayerData; // &lt;- this is line 221\n                player = std::make_shared&lt;cPlayer&gt;(basicPlayerData, *unitsData);\n            }\n</code></pre>\n\n<p>player.h:</p>\n\n<pre><code>...\nclass cPlayerBasicData; // &lt;- this is line 48\n...\nclass cPlayer\n{\n    ...\n</code></pre>\n\n<p>player.h is included in model.h, thus cPlayerBasicData is effectively forward declared twice. Is this what the error is about?</p>\n"}, {"tags": ["c++", "templates", "enable-if"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562793015, "post_id": 56978625, "comment_id": 100493338, "body": "related/dupe: <a href=\"https://stackoverflow.com/questions/15427667/sfinae-working-in-return-type-but-not-as-template-parameter\" title=\"sfinae working in return type but not as template parameter\">stackoverflow.com/questions/15427667/&hellip;</a>"}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 2, "creation_date": 1562793648, "post_id": 56978625, "comment_id": 100493567, "body": "<code>typename = enable_if_t&lt;...&gt;</code> can&#39;t be used to disambiguate two functions, because both would have the same default template argument."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "edited": false, "score": 0, "creation_date": 1562792997, "post_id": 56978669, "comment_id": 100493330, "body": "@lightxbulb it doesn&#39;t work in a sense that it doesn&#39;t remove a function from a set of overload candidates."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1562793089, "post_id": 56978669, "comment_id": 100493364, "body": "How does it not?  AFAIK it only doesn&#39;t work when you are trying to overload the function with multiple function templates."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562793136, "post_id": 56978669, "comment_id": 100493384, "body": "@NathanOliver I have added some clarifying statement, this is exactly what I meant, and this is (at least in my experience) the very reason to use enable_if."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562793398, "post_id": 56978669, "comment_id": 100493472, "body": "I think you might need to clarify it a bit more.  It works <a href=\"http://coliru.stacked-crooked.com/a/dcebab35f1368e5f\" rel=\"nofollow noreferrer\">here</a> in an overloaded context.  It&#39;s only when you try and add multiple template overloads it fails like <a href=\"http://coliru.stacked-crooked.com/a/a15a6f1d0eaff4ab\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1562794048, "post_id": 56978669, "comment_id": 100493694, "body": "@SergeyA I think this is a strange point of view that seems to be contradicted by the standard. See [temp.deduct]/6-8, [temp.over]/1. Deduction is considered to fail, therefore there is no candidate."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1562794156, "post_id": 56978669, "comment_id": 100493719, "body": "@Brian I removed my comment for now. I need to do a bit more research on this and I don&#39;t have time right now."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 1, "last_activity_date": 1562793511, "last_edit_date": 1562793511, "creation_date": 1562792926, "answer_id": 56978669, "question_id": 56978625, "link": "https://stackoverflow.com/questions/56978625/difference-between-typename-enable-if-t-and-enable-if-t-bool-tr/56978669#56978669", "title": "Difference between `typename = enable_if_t&lt;...&gt;` and `enable_if_t&lt;...,bool&gt; = true`", "body": "<p>Yes, there is difference. The first one doesn't work, while the second works. The reason for that is that default template parameters are not part of function signature.</p>\n\n<p>By \"work\" I mean that the first version doesn't remove the function from the set of candidate overloads, which is usually desired goal when enable_if is used.</p>\n\n<p>An example can be found here (Courtesy of @NathanOliver):\n<a href=\"http://coliru.stacked-crooked.com/a/a15a6f1d0eaff4ab\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/a15a6f1d0eaff4ab</a></p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 4, "last_activity_date": 1562796585, "creation_date": 1562796585, "answer_id": 56979280, "question_id": 56978625, "link": "https://stackoverflow.com/questions/56978625/difference-between-typename-enable-if-t-and-enable-if-t-bool-tr/56979280#56979280", "title": "Difference between `typename = enable_if_t&lt;...&gt;` and `enable_if_t&lt;...,bool&gt; = true`", "body": "<p>There are minor differences, but both can be used for SFINAE.</p>\n\n<p><code>typename = enable_if_t&lt;...&gt;</code> forms doesn't allow \"simple\" overloads:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename T, typename = enable_if_t&lt;cond&lt;T&gt;::value&gt;&gt;\nvoid foo();\n\ntemplate &lt;typename T, typename = enable_if_t&lt;!cond&lt;T&gt;::value&gt;&gt;\nvoid foo(); // Error: redeclaration of same function as default are not part of signature\n            // Both are just template &lt;typename, typename&gt; void foo()\n</code></pre>\n\n<p><code>enable_if_t&lt;cond, bool&gt; = true</code> doesn't suffer of that:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename T, enable_if_t&lt;cond&lt;T&gt;::value, bool&gt; = true&gt;\nvoid foo();\n\ntemplate &lt;typename T, enable_if_t&lt;!cond&lt;T&gt;::value, bool&gt; = true&gt;\nvoid foo();\n</code></pre>\n\n<p>Another issue with <code>typename = enable_if_t&lt;...&gt;</code> is that usage might be hijacked:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename T, typename = enable_if_t&lt;cond&lt;T&gt;::value&gt;&gt;\nvoid foo();\n\ntemplate &lt;typename T, typename = enable_if_t&lt;cond&lt;T&gt;::value&gt;&gt;\nvoid bar(T);\n\n\nfoo&lt;int&gt;();   // Regular usage, SFINAE occurs\nbar(42);      // Regular usage, SFINAE occurs\nbar&lt;int&gt;(42); // Possible usage, SFINAE still occurs\n// But\nfoo&lt;int, void&gt;();   // No substitution fails here, so no SFINAE\nbar&lt;int, void&gt;(42); // No substitution fails here, so no SFINAE\n</code></pre>\n"}], "owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 56978669, "answer_count": 2, "score": 0, "last_activity_date": 1562796585, "creation_date": 1562792710, "last_edit_date": 1562793014, "question_id": 56978625, "link": "https://stackoverflow.com/questions/56978625/difference-between-typename-enable-if-t-and-enable-if-t-bool-tr", "title": "Difference between `typename = enable_if_t&lt;...&gt;` and `enable_if_t&lt;...,bool&gt; = true`", "body": "<p>Is there any difference between using <code>typename = enable_if_t&lt;...&gt;</code> and <code>enable_if_t&lt;...,bool&gt; = true</code> for SFINAE? I am asking specifically since I stumbled upon what seems like a bug: <a href=\"https://stackoverflow.com/questions/56978499/compiler-error-with-a-fold-expression-in-enable-if-t?noredirect=1#56978499\">Compiler error with a fold expression in enable_if_t</a></p>\n\n<p>So I got curious whether there is any actual difference between the two.</p>\n"}, {"tags": ["c++", "sfml"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11767048, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T55VSru8NLc/AAAAAAAAAAI/AAAAAAAAAqc/CrPqXAn_qpQ/photo.jpg?sz=128", "display_name": "Bende", "link": "https://stackoverflow.com/users/11767048/bende"}, "edited": false, "score": 0, "creation_date": 1562794087, "post_id": 56978713, "comment_id": 100493703, "body": "Thanks for your solution, but I&#39;m only a beginner at c++, I&#39;d rather not mess around with namespaces just yet"}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "reply_to_user": {"reputation": 45, "user_id": 11767048, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T55VSru8NLc/AAAAAAAAAAI/AAAAAAAAAqc/CrPqXAn_qpQ/photo.jpg?sz=128", "display_name": "Bende", "link": "https://stackoverflow.com/users/11767048/bende"}, "edited": false, "score": 1, "creation_date": 1562794357, "post_id": 56978713, "comment_id": 100493786, "body": "@Bende a namespace doesn&#39;t do anything. It just adds <code>Lovedek::</code> before the name. The benefit is that the variable is global, so you can access it from anywhere in the code."}, {"owner": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "edited": false, "score": 0, "creation_date": 1562794479, "post_id": 56978713, "comment_id": 100493821, "body": "@StackDanny Declaring it as a private static class member is a safer and cleaner design if only that class needs the texture though. A global texture could be modified by other code."}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "reply_to_user": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "edited": false, "score": 0, "creation_date": 1562794770, "post_id": 56978713, "comment_id": 100493909, "body": "@Romen well ok, <i>private</i> static members: in that case, yes, absolutely. But as OP had it with a public static member I had to disagree. But sure - I can see how a private static texture makes sense!"}], "tags": [], "owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "is_accepted": false, "score": 0, "last_activity_date": 1562793682, "last_edit_date": 1562793682, "creation_date": 1562793161, "answer_id": 56978713, "question_id": 56978556, "link": "https://stackoverflow.com/questions/56978556/how-to-use-sfml-textures-as-static-data-members/56978713#56978713", "title": "How to use SFML Textures as static data members?", "body": "<p>Forget about <code>static</code> and classes here. What you want is a namespace:</p>\n\n<pre><code>namespace Lovedek\n{\n    sf::Texture texture;\n}\n</code></pre>\n\n<p>So yeah, it's basically a global variable. Generally bad design, but if you need an object that is accessible from anywhere, you might already do it correctly (with a namespace). Now you can load that outside:</p>\n\n<pre><code>Lovedek::texture.loadFromFile(\"bullet_graphics.png\",sf::IntRect(0, 0, 2, 10));\n</code></pre>\n\n<p>so the information is saved into <code>Lovedek::texture</code>. When you now want to apply that to an <code>sf::Sprite</code> just go:</p>\n\n<pre><code>sf::Sprite sprite;\nsprite.setTexture(Lovedek::texture);\n</code></pre>\n\n<p>It's very straightforward usage. A \"pure static class\" would be very against the idea of how classes generally should be used. </p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 11767048, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T55VSru8NLc/AAAAAAAAAAI/AAAAAAAAAqc/CrPqXAn_qpQ/photo.jpg?sz=128", "display_name": "Bende", "link": "https://stackoverflow.com/users/11767048/bende"}, "edited": false, "score": 0, "creation_date": 1562794022, "post_id": 56978760, "comment_id": 100493679, "body": "Thank you so much! I&#39;ve actually tried doing your private approach, I only missed the initializing line from the cpp file."}], "tags": [], "owner": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "is_accepted": true, "score": 0, "last_activity_date": 1562793730, "last_edit_date": 1562793730, "creation_date": 1562793413, "answer_id": 56978760, "question_id": 56978556, "link": "https://stackoverflow.com/questions/56978556/how-to-use-sfml-textures-as-static-data-members/56978760#56978760", "title": "How to use SFML Textures as static data members?", "body": "<pre><code>sf::Texture Lovedek::texture.loadFromFile(\"bullet_graphics.png\",sf::IntRect(0, 0, 2, 10));\n</code></pre>\n\n<p>This line has some syntax errors in itself, but it is not loading the texture in the right place anyways.</p>\n\n<p>First you need to initialize a static class variable somewhere, usually in the cpp file for that class.</p>\n\n<pre><code>// In your header for Lovedek\nclass Lovedek\n{\n    ...\n    static sf::Texture texture;    // Declare the static texture\n    ...\n};\n\n// In your cpp file for Lovedek\n\nsf::Texture Lovedek::texture;   // Initialize the static texture\n</code></pre>\n\n<p>Then think about <em>when</em> you want to load the texture, probably near the beginning of your <code>main</code> function, or in some sort of setup function right?</p>\n\n<p>You can either make <code>Lovedek::texture</code> public and load the texture outside the class, or you can keep it private and implement something like a <code>LoadAssets()</code> static method to do that.</p>\n\n<p>For the public approach:</p>\n\n<pre><code>// Make Lovedek::texture a public class member\n\n// Then put this somewhere in your game's setup (before starting the game loop)\n\nLovedek::texture.loadFromFile(\"bullet_graphics.png\", sf::IntRect(0, 0, 2, 10));\n</code></pre>\n\n<p>For the private approach:</p>\n\n<pre><code>// Change your Lovedek class\nclass Lovedek\n{\n    static sf::Texture texture;\npublic:\n    static void LoadAssets()\n    {\n        texture.loadFromFile(\"bullet_graphics.png\", sf::IntRect(0, 0, 2, 10));\n    }\n}\n\n// Then put this somewhere in your game's setup (before starting the game loop)\n\nLovedek::LoadAssets();\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11767048, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T55VSru8NLc/AAAAAAAAAAI/AAAAAAAAAqc/CrPqXAn_qpQ/photo.jpg?sz=128", "display_name": "Bende", "link": "https://stackoverflow.com/users/11767048/bende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 56978760, "answer_count": 2, "score": 1, "last_activity_date": 1562793730, "creation_date": 1562792376, "question_id": 56978556, "link": "https://stackoverflow.com/questions/56978556/how-to-use-sfml-textures-as-static-data-members", "title": "How to use SFML Textures as static data members?", "body": "<p>I'm writing Space Invaders in c++ using SFML. My plan is to load the texture of the bullet only once and then use it for every sprite. Thus I've started learning about static data members, but I don't know how to load the texture.</p>\n\n<p>I've tried declaring the data member inside the class and then loading outside</p>\n\n<pre><code>class Lovedek\n{\n    sf::Sprite sprite;\n    static sf::Texture texture;\n};\n\nsf::Texture Lovedek::texture.loadFromFile(\"bullet_graphics.png\",sf::IntRect(0, 0, 2, 10));\n</code></pre>\n\n<p>It keeps saying <code>error: expected initializer before '.' token</code>.</p>\n\n<p>Now I know that I'm supposed to be using a =operator, but I can't load with that.\nOr if anyone knows a better way to load only once, I'd appreciate it.</p>\n"}, {"tags": ["c++", "templates", "c++17", "enable-if", "fold-expression"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562792313, "post_id": 56978499, "comment_id": 100493097, "body": "I believe this is a parsing issue with MSVS.  There was a Q like this a month or 2 ago I&#39;ll try and find and see if that was what was found out"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562794185, "post_id": 56978499, "comment_id": 100493733, "body": "Well I found the <a href=\"https://stackoverflow.com/questions/56649481/templated-function-pointer-arrays-in-visual-studio\">post I was thinking of</a>, but it was using an array instead of a fold expression.  Might be the same issue or it might not."}, {"owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562794466, "post_id": 56978499, "comment_id": 100493815, "body": "@NathanOliver That&#39;s from a year ago, even if it&#39;s the same issue, it would mean that it was either not reported, or they haven&#39;t fixed it. I filed a bug report with MS, hopefully they&#39;ll fix it."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562794545, "post_id": 56978499, "comment_id": 100493845, "body": "That was from last month.  Jun 18 does not mean June of 2018 but June 18th."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562794596, "post_id": 56978499, "comment_id": 100493863, "body": "It would have Jun 18 &#39;18 if it was from June 18th of last year."}, {"owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562794735, "post_id": 56978499, "comment_id": 100493904, "body": "@NathanOliver Thank you for clarifying. I guess I am not used to how stack works."}], "answers": [{"comments": [{"owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "edited": false, "score": 0, "creation_date": 1562793306, "post_id": 56978711, "comment_id": 100493435, "body": "I was originally trying to get at least something working so that does help quite a bit. I guess I&#39;ll file another compiler bug with msvc though (that&#39;s the third this week unfortunately)."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1562793424, "post_id": 56978711, "comment_id": 100493481, "body": "I have to disagree. I find the fold expression clearer. This is a simple case, and every programmer knows what <code>&amp;&amp;</code> is, but &quot;conjunction&quot; takes some thinking and maybe some googling to figure out. IMO, <code>conjunction</code> is only really worthwhile when you need its short-circuiting."}, {"owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1562793754, "post_id": 56978711, "comment_id": 100493599, "body": "@Justin Not every programmer knows what a fold expression is either. And if somebody actually doesn&#39;t know what conjunction is, it&#39;s probably a good idea to look it up either way. My point is that it&#39;s subjective which looks better. I prefer the fold simply because I am used to Haskell and I don&#39;t like too many <code>&lt;&gt;</code>, but that is not to say that it&#39;s superior to the other variant imo."}], "tags": [], "owner": {"reputation": 1240, "user_id": 3585575, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W47ui.png?s=128&g=1", "display_name": "KyleKnoepfel", "link": "https://stackoverflow.com/users/3585575/kyleknoepfel"}, "is_accepted": false, "score": 3, "last_activity_date": 1562793158, "creation_date": 1562793158, "answer_id": 56978711, "question_id": 56978499, "link": "https://stackoverflow.com/questions/56978499/compiler-error-with-a-fold-expression-in-enable-if-t/56978711#56978711", "title": "Compiler error with a fold expression in enable_if_t", "body": "<p>At the risk of being slightly off topic, I'm not sure a fold expression is the best option here.  I encourage you to use the <code>std::conjunction</code> variant, which MSVS supports:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>- std::enable_if_t&lt;((std::is_convertible_v&lt;Args&amp;, B&amp;&gt; &amp;&amp; ...)), bool&gt; = true&gt;\n+ std::enable_if_t&lt;std::conjunction_v&lt;std::is_convertible&lt;Args&amp;, B&amp;&gt;...&gt;, bool&gt; = true&gt;\n</code></pre>\n\n<p>True, it's more verbose, but maybe clearer.  I defer to @NathanOliver to track down the potential MSVS bug as originally asked.</p>\n\n<p>(Would have put this as a comment, but thought the code block was clearer.)</p>\n"}], "owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562793158, "creation_date": 1562792083, "last_edit_date": 1562792315, "question_id": 56978499, "link": "https://stackoverflow.com/questions/56978499/compiler-error-with-a-fold-expression-in-enable-if-t", "title": "Compiler error with a fold expression in enable_if_t", "body": "<p>I have the following code, where I am using a fold expression to evaluate whether all pack parameters are convertible to the first function argument. For some reason it fails to compile on msvc when I make what seems like a very trivial change:</p>\n\n<pre><code>#include &lt;type_traits&gt;\n\n#define TRY 1\n\n#if TRY == 1\n\ntemplate&lt;typename B, typename... Args,\nstd::enable_if_t&lt;((std::is_convertible_v&lt;Args&amp;, B&amp;&gt; &amp;&amp; ...)), bool&gt; = true&gt;\nvoid fn(B b, Args...args) {}\n\n#else\n\ntemplate&lt;typename B, typename... Args,\ntypename = std::enable_if_t&lt;(std::is_convertible_v&lt;Args&amp;, B&amp;&gt; &amp;&amp; ...)&gt;&gt;\nvoid fn(B b, Args...args) {}\n\n#endif\n\nint main()\n{\n    fn(5, 4, 2);\n    return 0;\n}\n</code></pre>\n\n<p>Change <code>TRY</code> to <code>0</code> to have it compile, demo at: <a href=\"https://godbolt.org/z/EGvQ-N\" rel=\"nofollow noreferrer\">https://godbolt.org/z/EGvQ-N</a></p>\n\n<p>Is there an important difference between the two variants that I am missing, or is this a compiler bug?</p>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1562791802, "post_id": 56978429, "comment_id": 100492900, "body": "FWIW You really shouldn&#39;t use a pointer as the key of an associative container."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1562792006, "post_id": 56978429, "comment_id": 100492984, "body": "Do you expect a function that expects an <code>int *</code> to be able to accept a <code>const int *</code>?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562792302, "post_id": 56978429, "comment_id": 100493090, "body": "@NathanOliver why? <code>std::less</code> is guaranteed to give us total ordering for pointers."}, {"owner": {"reputation": 21, "user_id": 11767051, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6gV-eQcSguc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqWqWHmcQntNPST6joOBsQBRrqyA/photo.jpg?sz=128", "display_name": "Pusto Pusto", "link": "https://stackoverflow.com/users/11767051/pusto-pusto"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1562792534, "post_id": 56978429, "comment_id": 100493171, "body": "@jxh that&#39;s the thing, it shouldn&#39;t expect something mutable, it only needs to read the variable, nothing more! This is simply common sense..."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1562792587, "post_id": 56978429, "comment_id": 100493184, "body": "It will accept a <code>int * const</code>. But a <code>const int *</code> is different"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562792844, "post_id": 56978429, "comment_id": 100493284, "body": "@PustoPusto it&#39;s not a bug, but an oversight in C++ prior to C++14."}, {"owner": {"reputation": 21, "user_id": 11767051, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6gV-eQcSguc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqWqWHmcQntNPST6joOBsQBRrqyA/photo.jpg?sz=128", "display_name": "Pusto Pusto", "link": "https://stackoverflow.com/users/11767051/pusto-pusto"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1562793049, "post_id": 56978429, "comment_id": 100493351, "body": "@jxh but it doesn&#39;t matter... As I said, there&#39;s really no logical reason for this not to work"}, {"owner": {"reputation": 21, "user_id": 11767051, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6gV-eQcSguc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqWqWHmcQntNPST6joOBsQBRrqyA/photo.jpg?sz=128", "display_name": "Pusto Pusto", "link": "https://stackoverflow.com/users/11767051/pusto-pusto"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562793122, "post_id": 56978429, "comment_id": 100493379, "body": "@SergeyA how does an oversight differ from a bug? really"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1562793192, "post_id": 56978429, "comment_id": 100493406, "body": "A custom comparator might want to modify the key."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562793262, "post_id": 56978429, "comment_id": 100493425, "body": "I think @NathanOliver&#39;s point is why are you using a pointer for a key? It just doesn&#39;t make a lot of sense."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562793482, "post_id": 56978429, "comment_id": 100493501, "body": "@SergeyA I&#39;m not saying it will be a problem, it just normally people thing it will sort on what it is pointing at, no the address held by the pointer.  For a lot of new programmers it causes a lot of mistakes."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1562793550, "post_id": 56978429, "comment_id": 100493531, "body": "@PustoPusto You can call it a bug if you want. Regardless, it got fixed in C++14."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1562793564, "post_id": 56978429, "comment_id": 100493537, "body": "&quot;Looks and smells like a bug...&quot;  It is definitely a bug in the code."}, {"owner": {"reputation": 21, "user_id": 11767051, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6gV-eQcSguc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqWqWHmcQntNPST6joOBsQBRrqyA/photo.jpg?sz=128", "display_name": "Pusto Pusto", "link": "https://stackoverflow.com/users/11767051/pusto-pusto"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562793834, "post_id": 56978429, "comment_id": 100493627, "body": "@SergeyA how? <a href=\"https://wandbox.org/permlink/xy30CoMI5dypCLtP\" rel=\"nofollow noreferrer\">wandbox.org/permlink/xy30CoMI5dypCLtP</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562793845, "post_id": 56978429, "comment_id": 100493629, "body": "@NathanOliver I can think of a case or two where the actual address of an object would be used to verify object equality. It is some special case, no questions."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562793911, "post_id": 56978429, "comment_id": 100493647, "body": "@PustoPusto how what? You have two answers below which show how to achieve your goals. Also, I think you might want to change your attitude. Your last comment was way out of line."}], "answers": [{"tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": false, "score": 3, "last_activity_date": 1562792568, "creation_date": 1562792568, "answer_id": 56978597, "question_id": 56978429, "link": "https://stackoverflow.com/questions/56978429/why-cant-mapfind-a-pointer-to-a-const/56978597#56978597", "title": "Why can&#39;t map::find a pointer to a const?", "body": "<blockquote>\n  <p>Looks and smells like a bug...</p>\n</blockquote>\n\n<p>Why would it be a bug?</p>\n\n<p>The parameter of <code>find</code> is a const reference to the key type (const reference to <code>int *</code>).</p>\n\n<p>You can't bind <code>const int *</code> to such a reference, since <code>const int *</code> can't be implicitly converted to <code>int *</code>.</p>\n\n<hr>\n\n<p>Since C++14 you could fix that by using a transparent comparator: <code>std::map&lt;int*, char, std::less&lt;&gt;&gt;</code>.</p>\n\n<p>With a transparent comaprator <code>find</code> becomes a template. It will work with any parameter type, as long as it can be compared with the key type.</p>\n"}, {"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1562792626, "post_id": 56978599, "comment_id": 100493204, "body": "Ninja&#39;d by 4 seconds. :P"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1562792769, "post_id": 56978599, "comment_id": 100493256, "body": "@HolyBlackCat let&#39;s resolve our differences with shooting contest and see how can draw their Smith &amp; Wesson faster? :P Also, where do you see timestamp with one second precision?"}, {"owner": {"reputation": 5867, "user_id": 9125195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75fc90d1f6de6ff28c739b85bdb82f4c?s=128&d=identicon&r=PG&f=1", "display_name": "Sid S", "link": "https://stackoverflow.com/users/9125195/sid-s"}, "edited": false, "score": 0, "creation_date": 1562794255, "post_id": 56978599, "comment_id": 100493755, "body": "@SergeyA, Just hover over the timestamp.  Works that way in Chrome on a Windows laptop, at least."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 2, "last_activity_date": 1562792688, "last_edit_date": 1562792688, "creation_date": 1562792572, "answer_id": 56978599, "question_id": 56978429, "link": "https://stackoverflow.com/questions/56978429/why-cant-mapfind-a-pointer-to-a-const/56978599#56978599", "title": "Why can&#39;t map::find a pointer to a const?", "body": "<p>The default version of <code>std::map&lt;int*, char&gt;</code> uses <code>less&lt;int*&gt;</code> as comparator, which, in turn, has function <code>()(const int*, const int*)</code> defined in it.</p>\n\n<p>This function will not accept <code>int*</code></p>\n\n<p>However, if you use <code>less&lt;&gt;</code>, it will work:</p>\n\n<pre><code>std::map&lt;int*, char, std::less&lt;&gt;&gt; m;\n</code></pre>\n\n<p>The reason for that is that <code>std::less&lt;void&gt;</code> defines a template function,</p>\n\n<pre><code>template&lt; class T, class U&gt;\nconstexpr auto operator()( T&amp;&amp; lhs, U&amp;&amp; rhs ) const\n</code></pre>\n\n<p>And this works just fine when compares const vs non-const pointers.</p>\n"}], "owner": {"reputation": 21, "user_id": 11767051, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6gV-eQcSguc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqWqWHmcQntNPST6joOBsQBRrqyA/photo.jpg?sz=128", "display_name": "Pusto Pusto", "link": "https://stackoverflow.com/users/11767051/pusto-pusto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562792688, "creation_date": 1562791718, "question_id": 56978429, "link": "https://stackoverflow.com/questions/56978429/why-cant-mapfind-a-pointer-to-a-const", "title": "Why can&#39;t map::find a pointer to a const?", "body": "<p>briefly, why does it not compile</p>\n\n<pre><code>#include &lt;map&gt;\nint main()\n{\n    std::map&lt;int*, char&gt; m;\n    const int *x = nullptr;\n    m.find(x);\n}\n</code></pre>\n\n<p>What could possibly be the reason for that not to be a valid piece of code?</p>\n\n<p>Why does it matter to <code>find</code> whether it's a pointer or a pointer to a const??</p>\n\n<p>Looks and smells like a bug...</p>\n\n<p>And no thanks, no <code>const_cast</code></p>\n"}, {"tags": ["c++", "cmath"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1562791567, "post_id": 56978365, "comment_id": 100492817, "body": "I don&#39;t know, but <code>abs</code> is in <code>&lt;stdlib.h&gt;</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1562791613, "post_id": 56978365, "comment_id": 100492833, "body": "Use <code>std::abs</code> and you shouldn&#39;t have a problem."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1562791631, "post_id": 56978365, "comment_id": 100492835, "body": "@melpomene since <code>C++17</code>, <code>std::abs</code> is defined in <code>&lt;cmath&gt;</code>. <a href=\"https://en.cppreference.com/w/cpp/numeric/math/abs\" rel=\"nofollow noreferrer\">Source</a>."}, {"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1562791705, "post_id": 56978365, "comment_id": 100492863, "body": "I get the same error when I use <code>std::abs</code> but the error disappears and the code works when I use <code>#include &lt;cstdlib&gt;</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562791768, "post_id": 56978365, "comment_id": 100492887, "body": "Can&#39;t reproduce with latest C++, please indicate dialect."}, {"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562791935, "post_id": 56978365, "comment_id": 100492950, "body": "@SergeyA I think I&#39;m using C++11 though I don&#39;t know how to find out."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1562792929, "post_id": 56978365, "comment_id": 100493305, "body": "@AkThao what compiler are you using?"}, {"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1562792974, "post_id": 56978365, "comment_id": 100493319, "body": "@Chipster I&#39;m using G++. <code>LLVM version 9.0.0</code> comes up when I type <code>g++ --version</code> in terminal."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1562793055, "post_id": 56978365, "comment_id": 100493354, "body": "@AkThao Ugh. I&#39;m not familiar with it to tell you how to find out. But maybe someone else is. In order to help that person, could you also indicate what version of the compiler you are using?"}, {"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1562793564, "post_id": 56978365, "comment_id": 100493536, "body": "I think I found the version. It&#39;s G++ 4.2.1."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1562793652, "post_id": 56978365, "comment_id": 100493570, "body": "So the bug goes away when you use C++ header files in a C++ program, but is present if you use C header files in a C++ program.  Hmmmm."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1562793763, "post_id": 56978365, "comment_id": 100493606, "body": "@Eljay Well you&#39;re not supposed to use the <code>.h</code> C header files in C++."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1562793775, "post_id": 56978365, "comment_id": 100493610, "body": "If you&#39;re on macOS and you didn&#39;t go out of your way to install GCC, <code>gcc</code> and <code>g++</code> are aliased to <code>clang</code> and <code>clang++</code>. You can get the compiler version with <code>clang --version</code>."}, {"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "reply_to_user": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1562794025, "post_id": 56978365, "comment_id": 100493681, "body": "@zneak I get <code>Apple LLVM version 9.0.0 (clang-900.0.39.2) Target: x86_64-apple-darwin16.7.0 Thread model: posix InstalledDir: &#47;Applications&#47;Xcode.app&#47;Contents&#47;Developer&#47;Toolchains&#47;XcodeD&zwnj;&#8203;efault.xctoolchain&#47;u&zwnj;&#8203;sr&#47;bin</code> when using <code>clang --version</code>. I assume the first line is the compiler version."}], "answers": [{"comments": [{"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1562791790, "post_id": 56978411, "comment_id": 100492894, "body": "So does that mean abs(int) is not defined in <code>&lt;cmath&gt;</code> and if so, why not?"}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "reply_to_user": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1562791952, "post_id": 56978411, "comment_id": 100492953, "body": "@AkThao, the reasons are probably historic, as C originally did not have floating-point types. My guess is that floating-point support used to be optional, and they started by having it all in <code>math.h</code>. I can&#39;t name off the top of my head a function in math.h that doesn&#39;t mainly use floating-point types, and I can only name a handful of functions outside of it that use them."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "reply_to_user": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 1, "creation_date": 1562792475, "post_id": 56978411, "comment_id": 100493151, "body": "I now have a slightly better answer: <code>std::abs</code> was only introduced in C++17. Prior to that, you had to use <code>std::fabs</code> to get a floating-point absolute value, and your same program would have complained that <code>abs</code> did not exist instead (possibly highlighting better that you were missing the correct <code>#include</code>)."}, {"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1562792819, "post_id": 56978411, "comment_id": 100493274, "body": "Is <code>fabs</code> the same as <code>abs(float)</code>, <code>abs(double)</code> and <code>abs(long double)</code>? Also, since using <code>std::abs</code> doesn&#39;t fix my code, does that mean I&#39;m using a version earlier than C++17? On a slightly related note, how do I check what version of C++ I&#39;m using (typing <code>C++ --version</code> into the terminal only gives compiler information)?"}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "reply_to_user": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 1, "creation_date": 1562793237, "post_id": 56978411, "comment_id": 100493419, "body": "<code>abs</code> and <code>fabs</code> are overloaded functions which perform different operations given different argument types. <code>fabs</code> is overloaded for all floating-point types, and <code>abs</code> is (in C++17, or as an extension in previous versions of C++) overloaded for all numeric types (integers and floating-point). Calling <code>abs(double)</code> should be the same as calling <code>fabs(double)</code>."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "reply_to_user": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1562793387, "post_id": 56978411, "comment_id": 100493465, "body": "Regarding the C++ version you&#39;re using, I don&#39;t know if there&#39;s a very easy way to get an answer. The <code>__cplusplus</code> constant gives you a year and a month, but because platforms are allowed to define extensions, you can find yourself with C++17 capabilities in an environment that calls itself C++98, for instance. You can tell Clang that you want a specific dialect using the <code>--std=[...]</code> argument, where typical values would be <code>c++14</code>, <code>c++17</code>, or <code>gnu++14</code>, <code>gnu++17</code>. (The GNU versions include extensions defined by GCC.)"}], "tags": [], "owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "is_accepted": true, "score": 9, "last_activity_date": 1562791828, "last_edit_date": 1562791828, "creation_date": 1562791671, "answer_id": 56978411, "question_id": 56978365, "link": "https://stackoverflow.com/questions/56978365/how-to-fix-error-call-to-abs-is-ambiguous/56978411#56978411", "title": "How to fix &quot;error: call to &#39;abs&#39; is ambiguous&quot;", "body": "<p>The full error message is:</p>\n\n<pre><code>$ clang++ test.cpp\ntest.cpp:8:10: error: call to 'abs' is ambiguous\n    *b = abs(num1 - num2);\n         ^~~\n.../include/c++/v1/math.h:769:1: note: candidate function\nabs(float __lcpp_x) _NOEXCEPT {return ::fabsf(__lcpp_x);}\n^\n.../include/c++/v1/math.h:769:1: note: candidate function\nabs(double __lcpp_x) _NOEXCEPT {return ::fabs(__lcpp_x);}\n^\n.../include/c++/v1/math.h:769:1: note: candidate function\nabs(long double __lcpp_x) _NOEXCEPT {return ::fabsl(__lcpp_x);}\n^\n1 error generated.\n</code></pre>\n\n<p>The three overloads of <code>abs</code> that you have from <code>&lt;cmath&gt;</code> are <code>abs(float)</code>, <code>abs(double)</code> and <code>abs(long double)</code>; it's ambiguous because you have an <code>int</code> argument and the compiler doesn't know which floating-point type to convert to.</p>\n\n<p><code>abs(int)</code> is defined in <code>&lt;cstdlib&gt;</code>, so <code>#include &lt;cstdlib&gt;</code> will resolve your problem.</p>\n\n<p>If you're using Xcode, you can get more details about the error in the Issues navigator (\u23185) and clicking the triangle next to your issue.</p>\n"}, {"comments": [{"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 1, "creation_date": 1562792510, "post_id": 56978525, "comment_id": 100493163, "body": "I&#39;m using a C++ compiler, but for some reason, using <code>std::abs</code> doesn&#39;t seem to make a difference. It only works when I use <code>#include &lt;cstdlib&gt;</code>."}, {"owner": {"reputation": 154, "user_id": 5392861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5d7ff1d144bd40c8811c17a7d454ff?s=128&d=identicon&r=PG&f=1", "display_name": "NewMe", "link": "https://stackoverflow.com/users/5392861/newme"}, "reply_to_user": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1563040992, "post_id": 56978525, "comment_id": 100573588, "body": "That is weird.. I&#39;ve tried two online C++ compilers and both works with just std::abs. Please look:  <a href=\"https://ideone.com/wls3Tp\" rel=\"nofollow noreferrer\">ideone.com/wls3Tp</a>  <a href=\"https://onlinegdb.com/BJzbpcDZH\" rel=\"nofollow noreferrer\">onlinegdb.com/BJzbpcDZH</a>"}, {"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1563098419, "post_id": 56978525, "comment_id": 100582195, "body": "It could be that I&#39;m using an older version of C++. In the comments to the above answer, zneak said that <code>std::abs</code> was only introduced in C++17 and before that, <code>std::fabs</code> had to be used. This is what I&#39;m experiencing, <code>std::abs</code> does not work but <code>std::fabs</code> does. In the terminal, I tried to specify the dialect using <code>-std=c++17</code>, but it returned an error saying <code>invalid value &#39;c++17&#39;</code>."}, {"owner": {"reputation": 823, "user_id": 2128797, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dacdb96daa34c81dbc949b2fe7bea470?s=128&d=identicon&r=PG", "display_name": "Laurie Stearn", "link": "https://stackoverflow.com/users/2128797/laurie-stearn"}, "edited": false, "score": 0, "creation_date": 1584256205, "post_id": 56978525, "comment_id": 107377078, "body": "Using VS2019 defaults with a new C++ Windows Desktop Application. Only <code>#include &lt;cstdlib&gt;</code> or <code>#include &lt;cmath&gt;</code> gets abs for float. <code>stdlib.h</code> seems not to want to accept a float argument. :("}], "tags": [], "owner": {"reputation": 154, "user_id": 5392861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5d7ff1d144bd40c8811c17a7d454ff?s=128&d=identicon&r=PG&f=1", "display_name": "NewMe", "link": "https://stackoverflow.com/users/5392861/newme"}, "is_accepted": false, "score": 2, "last_activity_date": 1562792218, "creation_date": 1562792218, "answer_id": 56978525, "question_id": 56978365, "link": "https://stackoverflow.com/questions/56978365/how-to-fix-error-call-to-abs-is-ambiguous/56978525#56978525", "title": "How to fix &quot;error: call to &#39;abs&#39; is ambiguous&quot;", "body": "<p>if your using C compiler you should include</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n</code></pre>\n\n<p>and use abs without std::.\nIf you use C++ compiler then you should change abs to std::abs.</p>\n\n<p>Hope it helps:)</p>\n"}, {"tags": [], "owner": {"reputation": 325, "user_id": 4550701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3753f6ff97f080dc9840145e4da9ff5?s=128&d=identicon&r=PG", "display_name": "ana", "link": "https://stackoverflow.com/users/4550701/ana"}, "is_accepted": false, "score": 3, "last_activity_date": 1602947989, "creation_date": 1602947989, "answer_id": 64404054, "question_id": 56978365, "link": "https://stackoverflow.com/questions/56978365/how-to-fix-error-call-to-abs-is-ambiguous/64404054#64404054", "title": "How to fix &quot;error: call to &#39;abs&#39; is ambiguous&quot;", "body": "<p>For me, <code>#include &lt;cstdlib&gt;</code> didn't solve the issue, maybe because I didn't have to include anything to use <code>abs</code>. So, in case it helps someone else, with explicit casting, it worked well for me like in the next code:</p>\n<pre><code>*b = abs(int(num1 - num2));\n</code></pre>\n"}], "owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12494, "favorite_count": 1, "accepted_answer_id": 56978411, "answer_count": 3, "score": 4, "last_activity_date": 1602947989, "creation_date": 1562791422, "question_id": 56978365, "link": "https://stackoverflow.com/questions/56978365/how-to-fix-error-call-to-abs-is-ambiguous", "title": "How to fix &quot;error: call to &#39;abs&#39; is ambiguous&quot;", "body": "<p>I'm running a simple C++ program from HackerRank about pointers and it works fine on the website. However,\nwhen I run it on MacOS, I get <code>error: call to 'abs' is ambiguous</code> and I'm not sure exactly what is ambiguous.</p>\n\n<p>I've looked at other answers to similar issues,  but the error message tends to be <code>Ambiguous overload call to abs(double)</code>, which is not the issue I'm having, since I haven't used any doubles. I've also tried including the header files <code>cmath</code> and <code>math.h</code>, but the problem persists.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cmath&gt;\n\nvoid update(int *a,int *b) {\n    int num1 = *a;\n    int num2 = *b;\n    *a = num1 + num2;\n    *b = abs(num1 - num2);\n}\n\nint main() {\n    int a, b;\n    int *pa = &amp;a, *pb = &amp;b;\n\n    scanf(\"%d %d\", &amp;a, &amp;b);\n    update(pa, pb);\n    printf(\"%d\\n%d\", a, b);\n\n    return 0;\n}\n</code></pre>\n\n<p>My issue occurs with line 8.</p>\n"}, {"tags": ["c++", "arduino"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1562792071, "post_id": 56978245, "comment_id": 100493010, "body": "Scale back your ambitions. Back up your code and try to reproduce the error with less and less code until you have reduced your way back to the code that does work. The error will likely be in the code that was last removed, and that is much less code to have to puzzle out. Use <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> as inspiration. In general, start with working code and add slowly and carefully, testing each change  You&#39;ll rarely find yourself in a position where you have a hundred lines of code and no clue where the error is because usually the error will be in or exposed by the code just added.."}, {"owner": {"reputation": 162, "user_id": 10833108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwFrJ.jpg?s=128&g=1", "display_name": "Martin Lukas", "link": "https://stackoverflow.com/users/10833108/martin-lukas"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562794842, "post_id": 56978245, "comment_id": 100493931, "body": "well now I know that the error is being cause by the getTemperature function"}, {"owner": {"reputation": 2639, "user_id": 7994837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d3c6ba4c6f0d695832df4b32b03814?s=128&d=identicon&r=PG&f=1", "display_name": "Delta_G", "link": "https://stackoverflow.com/users/7994837/delta-g"}, "edited": false, "score": 2, "creation_date": 1562796135, "post_id": 56978245, "comment_id": 100494286, "body": "If the code is large and doing lots of things then it may be taking too long between calling the encoder function and you may be missing pulses.  In this case it may be better to use an interrupt to read the encoder.  This is one of those places where the pulses are short enough that interrupts are reasonable."}, {"owner": {"reputation": 162, "user_id": 10833108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwFrJ.jpg?s=128&g=1", "display_name": "Martin Lukas", "link": "https://stackoverflow.com/users/10833108/martin-lukas"}, "edited": false, "score": 0, "creation_date": 1562799203, "post_id": 56978245, "comment_id": 100495050, "body": "I just figured it out, ended up doing for loop where I always called the encoderRead function 100 times :D guess I&#39;ll have to take a look on interrupts, thanks for the tip"}], "answers": [{"tags": [], "owner": {"reputation": 162, "user_id": 10833108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwFrJ.jpg?s=128&g=1", "display_name": "Martin Lukas", "link": "https://stackoverflow.com/users/10833108/martin-lukas"}, "is_accepted": true, "score": 0, "last_activity_date": 1587469937, "creation_date": 1587469937, "answer_id": 61342899, "question_id": 56978245, "link": "https://stackoverflow.com/questions/56978245/how-to-read-rotary-encoder/61342899#61342899", "title": "How to read rotary encoder", "body": "<p>The code was too long, arduino was missing signals, interrupts are required for such long code to work with rotart encoder.</p>\n"}], "owner": {"reputation": 162, "user_id": 10833108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwFrJ.jpg?s=128&g=1", "display_name": "Martin Lukas", "link": "https://stackoverflow.com/users/10833108/martin-lukas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 61342899, "answer_count": 1, "score": 0, "last_activity_date": 1587469937, "creation_date": 1562790848, "last_edit_date": 1562795131, "question_id": 56978245, "link": "https://stackoverflow.com/questions/56978245/how-to-read-rotary-encoder", "title": "How to read rotary encoder", "body": "<p>Hello I'm wondering why doesn't this code work, since the encoder is working 100% and I'm sure that the chunk of code that is supposed to do the reading part is working as well, please check the code if you can, there has to be some kind of really dumb mistake I guess .. or is it possible that the arduino uno isn't capable of reading so many pins ? Here is the code</p>\n\n<p>Problem is being cause by the getTemperature function</p>\n\n<pre><code>#include &lt;OneWire.h&gt;\n#include &lt;DallasTemperature.h&gt;\n#include &lt;LiquidCrystal.h&gt;\n\n#define LDR A0\n#define Fan 3\n#define ONE_WIRE_BUS 2\n#define BACKLIGHT 5\n    #define outputA 6\n    #define outputB 7\n\nLiquidCrystal lcd(13, 12, 11, 10, 9, 8);\nOneWire oneWire(ONE_WIRE_BUS);\nDallasTemperature sensors(&amp;oneWire);\n\nfloat temperature = 0;\n\nint start = 0 , start1 = 0;\nunsigned long timer = 0;\nunsigned long tx;\n\n    int counter = 0;\n    int aState, aLastState;\n\nvoid setup(void)\n{\n  Serial.begin(9600);\n  sensors.begin();\n  lcd.begin(16, 2);\n  pinMode(Fan , OUTPUT);\n  pinMode(A1,INPUT);\n  pinMode(BACKLIGHT,OUTPUT);\n  pinMode(4,INPUT_PULLUP);\n  setEncoder();  \n}\n\n\nboolean isMin=true;\nint temp1=4,temp2=15;\nlong pressed=millis();\nvoid loop(void)\n{\n  encoderRead();\n  getTemperature();\n  if(digitalRead(4)==LOW&amp;&amp;millis()-pressed&gt;=1000){\n    isMin = !isMin;\n    pressed=millis();\n    tx=millis();\n  }\n  if(isMin){\n    //temp2 = map(counter , 0 , 100 , 1 , 60);                       //For setting 15 min time from range of 1-60 minutes\n    //tx=millis();\n  }else{\n    //temp1 = map(counter , 0 , 100 , 1 , 24);                       //For setting 5 hour time from range of 1-24 hour\n    //tx=millis();\n  }\n  String s = \"HODINY: \"+String(temp1)+\"\\nMINUTY: \"+String(temp2);\n  Serial.println(s);\n  Serial.println(counter);\n  String t1 , t2;\n\n  if (temp1 &lt; 10)\n    t1 = \" \" + String(temp1);\n  else\n    t1 = String(temp1);\n\n  if (temp2 &lt; 10)\n    t2 = \" \" + String(temp2);\n  else\n    t2 = String(temp2);\n\n  if (millis() - tx &lt; 600000) {                                            //LCD displays stops every 10 minutes (600000milli seconds)\n    lcd.setCursor(0, 0);\n    lcd.print(\"Temp: \" + String(temperature));\n    lcd.setCursor(0, 1);\n    lcd.print(\"T1: \" + String(t1) + \" H T2: \" + String(t2) + \" M\");\n    digitalWrite(BACKLIGHT,HIGH);\n  }\n  else\n    digitalWrite(BACKLIGHT,LOW);                                          //No data on display\n\n                                                                          //1. LDR - detects LIGHTS ON (daytime)\n  if (analogRead(LDR) &gt;= 700 &amp;&amp; start == 0) {                             //If it is day time\n    start = 1;                                                             //Set start (day) as 1\n    start1 = 0;                                                            //Set start1 (night) as 0\n    timer = millis();                                                      //Reset timer\n    digitalWrite(Fan , HIGH);                                               //Arduino has FANS OFF\n    //Serial.println(\"ZACAL SOM CAST JEDNA\");\n  }\n                                                                           //1. LDR - detects LIGHTS OFF (night time)\n  else if (analogRead(LDR) &lt;700 &amp;&amp; start1 == 0) {                        //If it is night time\n    start = 0;                                                             //Set start (day) as 0\n    start1 = 1;                                                            //Set start1 (night) as 1\n    timer = millis();                                                      //Reset timer\n    digitalWrite(Fan , LOW);                                              //Turn ON Fan When nite time is detected Arduino has FANS ON\n    //Serial.println(\"ZACAL SOM CAST DVA\");\n  }\n\n  //DAYTIME PROGRAM\n  if (start == 1) {\n    digitalWrite(Fan , HIGH);                                               //2. Arduino has FANS OFF and waits for temp to reach &gt;90 deg (temperature rises during daytime)\n    getTemperature();                                                      //3. Once &gt;90 deg, Arduino runs \"Timer A\" for 15 minutes (set by pot #A)\n    //Serial.println(temperature);\n    if (temperature &gt;= 90)                                                 //If temperature is greater then 90\n    {\n      start = 2;                                                           //Go to step 2\n      timer = millis();                                                    //Reset timer\n    }\n  }\n  else if (start == 2) {                                                   //Step2- If it is day time and temperature is greater 90 and timer is then 1-60 minutes set by pot\n    if((millis() - timer)/1000 &lt;= temp2 * 60) {                           //Wait for timer 'A' to expire, Arduino has fans off\n        //Serial.println((millis() - timer)/1000);\n        digitalWrite(Fan , HIGH);\n        //Serial.println(\"CAKAM TIME A\");\n    }else{\n    getTemperature();\n    digitalWrite(Fan,LOW);\n    start = 3;                                                             //Go to step 3\n    timer = millis();                                                      //Reset timer\n    }                       \n  }\n  else if (start == 3 &amp;&amp; (millis() - timer)/1000 &lt;= temp1  * 3600) {        //Step3-If it is day time and timer is less then 1-24 hour set by pot\n    getTemperature();                                                      //5. Also immediately after 15 minute \u201cTimer A\u201d expires, Arduino runs \u201cTimer B\u201d that runs for 4 hours (set by pot#B).\n    if(temperature&gt;=77){                                                   //When temperature is more than 77deg turn on the FAN\n      getTemperature();\n      digitalWrite(Fan,LOW);\n      //Serial.println(\"ZNIZUJEM TIMER B\");\n    }\n    else if (temperature &lt; 77){                                             //If regular daytime temperature is less then 76 turn OFF FAN\n      digitalWrite(Fan , HIGH);                                              //Turn OFF Fan\n      //Serial.println(\"STOJIM\");\n      getTemperature();\n    }\n    //Serial.println(\"CAKAM TIMER B\");\n  }\n  else if(start ==3) {                                                      //If it is day time and timer is greater then 1-24 hour set by pot\n    start = 1;                                                              //6. Once 4 hour \u201cTimer B\u201d expires and temperatures have been regulated at &gt;78 &lt;77 during this time, FAN OFF. LOOP TO #2 above (daytime program).\n    //Serial.println(\"ZNOVA ZACINAM DEN\");\n  }\n\n  //NIGHT TIME PROGRAM\n  if (start1 == 1 &amp;&amp; (millis() - timer)/1000 &lt; temp1 * 3600) {              //Step1-If it is night time and timer is less then 1-24 hour set by pot\n    getTemperature();                                                       //3. Also, as soon as nite time is detected by LDR \u201cTimer B\u201d (set by pot #B) is to run for 4 hours.\n    if (temperature &gt;= 70) {                                                //If temperature is greater then 70 turn ON FAN\n      //Serial.println(\"ZNIZUJEM NOC\");\n      digitalWrite(Fan , LOW);                                             //Turn ON Fan\n    }\n    else if (temperature &lt;= 69){                                             //If temperature is less= then 69 turn OFF FAN\n      //Serial.println(\"ZVYSUJEM NOC\");                         \n      digitalWrite(Fan , HIGH);                                              //Turn OFF Fan\n    }\n  }\n  else if (start1 == 1 &amp;&amp; (millis() - timer)/1000 &gt;= temp1 * 3600) {        //If it is night and timer is greater then 1-24 hour set by pot\n    getTemperature();\n    if (temperature &gt;= 66) {                                                //Timer 'B' expired, FANs on until temp is lower than 66deg.\n      //Serial.println(\"KONIEC BCKA IDEM CAKAT NA MENEJ AKO 66\");                                             \n      digitalWrite(Fan , LOW);                                                \n      getTemperature();\n    }\n                                                                            //Once temperature is lower than 66deg = Arduino runs \u201cTimer A\u201d for 15 minutes (set by pot #A)\n    else if(temperature &lt; 66){\n      digitalWrite(Fan , HIGH);                                              //Turn OFF Fan\n      start1 = 3;                                                           //Go to step 2\n      //Serial.println(\"MENEJ AKO 66\");\n      timer = millis();                                                     //Reset timer\n    }\n  }\n  else if (start1 == 3 &amp;&amp; (millis() - timer)/1000 &gt; temp2 * 60) {           //If it is night time and timer is greater then 1-60 minutes set by pot\n                                                                            //7. After \u201cTimer A\u201d expires, LOOP TO #2 (night time program)\n    start1 = 1;                                                             //Go to step 1 night time\n    timer = millis();                                                       //Reset timer\n    //Serial.println(\"ZACINAM ZNOVA NOCICKU\");\n  }\n}\n\nvoid getTemperature(){\n  sensors.requestTemperatures();\n  temperature = sensors.getTempFByIndex(0);\n}\nvoid encoderRead(){\n  aState = digitalRead(outputA);\n  if(aState != aLastState){\n    if(digitalRead(outputB)!=aState){\n      if(counter&lt;=100){\n        counter++;\n      }\n    }else{\n      if(counter&gt;=0){\n       counter--;\n      }\n    }\n  }\n  aLastState = aState;\n}\nvoid setEncoder(){\n  pinMode(outputA,INPUT);\n  pinMode(outputB,INPUT);\n  aLastState = digitalRead(outputA);\n}\n</code></pre>\n\n<p>And this is the code that I've tested and the readigs were just fine</p>\n\n<pre><code>#define outputA 6\n#define outputB 7\n\nint counter = 0;\nint aState,aLastState;\nvoid setup(void)\n{\n  Serial.begin(9600);\n  pinMode(4,INPUT_PULLUP);\n  setEncoder();  \n}\n\nvoid loop() {\n  encoderRead();\n  Serial.println(counter);\n}\n\nvoid encoderRead(){\n  aState = digitalRead(outputA);\n  if(aState != aLastState){\n    if(digitalRead(outputB)!=aState){\n      if(counter&lt;=100){\n        counter++;\n      }\n    }else{\n      if(counter&gt;=0){\n       counter--;\n      }\n    }\n  }\n  aLastState = aState;\n}\nvoid setEncoder(){\n  pinMode(outputA,INPUT);\n  pinMode(outputB,INPUT);\n  aLastState = digitalRead(outputA);\n}\n</code></pre>\n"}, {"tags": ["c++"], "owner": {"reputation": 3403, "user_id": 1128412, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e2dc24197f584b1004109596ea4b4140?s=128&d=identicon&r=PG", "display_name": "Juan Enrique Mu&#241;oz Zolotoochin", "link": "https://stackoverflow.com/users/1128412/juan-enrique-mu%c3%b1oz-zolotoochin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1562791173, "answer_count": 0, "score": 3, "last_activity_date": 1562794728, "creation_date": 1562790638, "last_edit_date": 1562794728, "question_id": 56978203, "link": "https://stackoverflow.com/questions/56978203/convert-stdvariant-to-another-stdvariant-with-sub-set-of-types", "closed_reason": "Duplicate", "title": "Convert std::variant to another std::variant with sub-set of types", "body": "<p>Given a variable of type <code>std::variant&lt;A,B,C&gt;</code>, I've checked that it does <em>not</em> contain <code>C</code>. How can I convert it to a <code>std::variant&lt;A,B&gt;</code>?</p>\n\n<pre><code>std::variant&lt;A,B&gt; convert(std::variant&lt;A,B,C&gt; value) {\n  if (std::holds_alternative&lt;C&gt;(value)) {\n    // die.\n  }\n\n  return ... // what to do here?\n}\n</code></pre>\n\n<p>I know how to do the opposite (convert to a super set variant) using a visitor as described <a href=\"https://stackoverflow.com/questions/47203255/convert-stdvariant-to-another-stdvariant-with-super-set-of-types\">here</a>, but that approach does not work for this case.</p>\n"}, {"tags": ["c++", "c++11", "reverse-iterator"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 5, "creation_date": 1562790107, "post_id": 56978043, "comment_id": 100492223, "body": "<code>--a.rbegin()</code> exhibits undefined behavior."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562790108, "post_id": 56978043, "comment_id": 100492224, "body": "<code>--a.rbegin()</code> is undefined behavior."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1562790169, "post_id": 56978043, "comment_id": 100492254, "body": "\u201cNot less than key\u201d means \u201cequal or greater\u201d, so 8 is the first that fits. 5 is less than. And as far as I know decrementing an iterative that\u2019s at the beginning is undefined behavior."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1562790170, "post_id": 56978043, "comment_id": 100492255, "body": "<code>lower_bound</code> returns the first element that is &gt;= the one you are searching for."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1562790190, "post_id": 56978043, "comment_id": 100492260, "body": "For your second question, it returns &quot;not less than key&quot;.  Is 5 not less than 6?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1562791331, "post_id": 56978043, "comment_id": 100492703, "body": "What do you expect to find before the very first element???"}], "answers": [{"tags": [], "owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "is_accepted": true, "score": 2, "last_activity_date": 1562792827, "last_edit_date": 1562792827, "creation_date": 1562790791, "answer_id": 56978233, "question_id": 56978043, "link": "https://stackoverflow.com/questions/56978043/c11-reverse-iterator-and-lower-bound/56978233#56978233", "title": "c++11 reverse iterator and lower_bound", "body": "<p>--a.rbegin() is a UB.</p>\n\n<p><code>lower_bound(val)</code> returns an iterator pointing to the first element in the range\u00a0which does not compare less than\u00a0<code>val</code>. <code>5</code> is not \"not less than <code>6</code>\" so you get the iterator to <code>8</code> correctly</p>\n"}], "owner": {"reputation": 475, "user_id": 5699669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b09e5582c4459539142d4c3b5184df8?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel ", "link": "https://stackoverflow.com/users/5699669/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 0, "accepted_answer_id": 56978233, "answer_count": 1, "score": 0, "last_activity_date": 1562792827, "creation_date": 1562789931, "question_id": 56978043, "link": "https://stackoverflow.com/questions/56978043/c11-reverse-iterator-and-lower-bound", "title": "c++11 reverse iterator and lower_bound", "body": "<p>I have the following example program:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;map&gt;\n\nint main()\n{\n  std::map&lt;int, int&gt; a;\n  a[8] = 1;\n  a[5] = 1;\n  a[1] = 1;\n  a[2] = 1;\n\n  std::cout &lt;&lt; a.begin()-&gt;first &lt;&lt; std::endl;\n\n  std::cout &lt;&lt; a.rbegin()-&gt;first &lt;&lt; std::endl;\n  std::cout &lt;&lt; (++a.rbegin())-&gt;first &lt;&lt; std::endl;\n  std::cout &lt;&lt; (--a.rbegin())-&gt;first &lt;&lt; std::endl;\n\n  std::cout &lt;&lt; (a.lower_bound(6))-&gt;first &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>When I execute it I get this output:</p>\n\n<pre><code>1\n8\n5\n5\n8\n</code></pre>\n\n<p>I have two questions. The first is why <code>++a.rbegin()</code> and <code>--a.rbegin()</code> iterate in the same direction? Is the iterator returned from <code>a.rbegin()</code> not a bidirectional iterator? </p>\n\n<p>The second question is why does <code>a.lower_bound(6)-&gt;first</code> return 8 instead of 5? Based on <a href=\"https://en.cppreference.com/w/cpp/container/map/lower_bound\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/container/map/lower_bound</a>, it should return an iterator to the first element \"not less than key\". So I would have thought 5 would be returned since 8 > 6.</p>\n"}, {"tags": ["c++", "design-patterns", "crtp", "cloneable"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 2, "creation_date": 1562789491, "post_id": 56977929, "comment_id": 100491980, "body": "Derived class not overriding it has nothing to do with safety. lack of virtual destructor in base class and use of naked pointers does."}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1562789564, "post_id": 56977929, "comment_id": 100492002, "body": "@VTT for such trivial classes it is ok"}, {"owner": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "edited": false, "score": 3, "creation_date": 1562790075, "post_id": 56977929, "comment_id": 100492210, "body": "No, it\u2019s not ok but a major cause for undefined behaviour!"}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "reply_to_user": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "edited": false, "score": 0, "creation_date": 1562790277, "post_id": 56977929, "comment_id": 100492295, "body": "@datell first of all, there are no destructors in the example, even compiler-generated ones. So I don&#39;t believe you this is an UB"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1562790970, "post_id": 56977929, "comment_id": 100492554, "body": "It is UB, see <a href=\"https://stackoverflow.com/questions/461203/when-to-use-virtual-destructors\">when-to-use-virtual-destructors</a>."}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1562791489, "post_id": 56977929, "comment_id": 100492783, "body": "@Jarod42, well, that&#39;s interesting. Though I&#39;m not sure if there is a compiler for which it indeed causes problems (e.g., no compiler warns about such things, as well as UBsan)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1562791544, "post_id": 56977929, "comment_id": 100492804, "body": "@NikitaPetrenko hmm, you sure about there not even being compiler generated ones?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562791553, "post_id": 56977929, "comment_id": 100492810, "body": "If there are no destructors, then what is <code>delete b_clone;</code> calling?"}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562792154, "post_id": 56977929, "comment_id": 100493038, "body": "@user4581301 what is <code>int* ptr; delete ptr;</code> calling? E.g., you cannot call <code>ptr-&gt;~int()</code>."}, {"owner": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "edited": false, "score": 0, "creation_date": 1562792710, "post_id": 56977929, "comment_id": 100493237, "body": "@NikitaPetrenko Thats the same question as &quot;what is <code>int main() { int a; }</code> calling?&quot; Of course not a dtor but thats since <code>int</code> is a pod. To make it clear: All the classes above do have dtors: The default ones."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1562792765, "post_id": 56977929, "comment_id": 100493254, "body": "@NikitaPetrenko I mean yes, you can never call a destructor directly (to my knowledge, anyway), but that doesn&#39;t they don&#39;t still exist. They have to exist. Deletion is impossible otherwise."}, {"owner": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "edited": false, "score": 0, "creation_date": 1562793146, "post_id": 56977929, "comment_id": 100493390, "body": "@Chipster Of course you can it manually call it if a user defined type is used. <code>int</code> and other PODs don&#39;t have dtors. However this is ot here."}, {"owner": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "edited": false, "score": 0, "creation_date": 1562793225, "post_id": 56977929, "comment_id": 100493416, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12632747/forcing-a-derived-class-to-overload-a-virtual-method-in-a-non-abstract-base-clas\">Forcing a derived class to overload a virtual method in a non-abstract base class</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562793231, "post_id": 56977929, "comment_id": 100493418, "body": "@Chipster Manual destruction is important to <a href=\"https://en.cppreference.com/w/cpp/language/new#Placement_new\" rel=\"nofollow noreferrer\">placement new</a>. And you can delete the destructor. Can&#39;t think of a good use-case for doing this though."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562793311, "post_id": 56977929, "comment_id": 100493438, "body": "But apparently other people could: <a href=\"https://stackoverflow.com/questions/40742918/uses-of-destructor-delete\">Uses of destructor = delete;</a>"}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "reply_to_user": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "edited": false, "score": 0, "creation_date": 1562793383, "post_id": 56977929, "comment_id": 100493464, "body": "@datell it is not a duplicate -- the question you linked asks about a more general problem"}, {"owner": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "edited": false, "score": 0, "creation_date": 1562793418, "post_id": 56977929, "comment_id": 100493478, "body": "@NikitaPetrenko It actually talks about the exactly same problem and your&#39;s reduces to this one imo."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562793487, "post_id": 56977929, "comment_id": 100493504, "body": "@user4581301 I mean <code>delete</code> calls the destructor, but you wouldn&#39;t really ever do something like the OP suggested, correct? I mean syntax wise."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562793942, "post_id": 56977929, "comment_id": 100493656, "body": "@Chipster There are times when you want to delete the object without giving back the memory. The allocation could be expensive (so you use a resource pool instead) or risky (fragmentation for one thing) or impossible (on some critical systems access to the dynamic datastore is cut off after program initialization to prevent uncontrolled memory usage) and you want to reuse the memory. C++ is a Swiss army knife and there are tools in it that you&#39;re likely to never use."}], "answers": [{"tags": [], "owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1562789963, "last_edit_date": 1562789963, "creation_date": 1562789335, "answer_id": 56977930, "question_id": 56977929, "link": "https://stackoverflow.com/questions/56977929/improving-safety-of-clone-pattern/56977930#56977930", "title": "Improving safety of Clone pattern", "body": "<p>This is an elaboration of one of the answers, suggesting runtime check using typeid:\n<a href=\"https://stackoverflow.com/questions/12632747/forcing-a-derived-class-to-overload-a-virtual-method-in-a-non-abstract-base-clas\">Forcing a derived class to overload a virtual method in a non-abstract base class</a></p>\n\n<p>Using CRTP, one can come up with the following basic idea:</p>\n\n<p>Create class <code>Cloneable&lt;Derived&gt;</code>, which manages cloning for <code>Derived</code>, and adds all the needed runtime checks (seems like that compile-time checks are not possible even with CRTP). </p>\n\n<p>However, it is not trivial, and one also has to manage inheritance through <code>Cloneable</code>, as described:</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;cassert&gt;\n#include &lt;type_traits&gt;\n#include &lt;typeinfo&gt;\n\nclass CloneableInterface {\npublic:\n    virtual std::unique_ptr&lt;CloneableInterface&gt; Clone() const = 0;\n};\n\ntemplate &lt;class... inherit_from&gt;\nstruct InheritFrom : public inherit_from... {\n};\n\ntemplate &lt;class Derived, class AnotherBase = void, bool base_is_cloneable = std::is_base_of_v&lt;CloneableInterface, AnotherBase&gt;&gt;\nclass Cloneable;\n\n// three identical implementations, only the inheritance is different\n\n// \"no base is defined\" case\ntemplate &lt;class Derived&gt;\nclass Cloneable&lt;Derived, void, false&gt; : public CloneableInterface {\npublic:\n    std::unique_ptr&lt;CloneableInterface&gt; Clone() const override {\n        assert(typeid(*this) == typeid(Derived));\n    return std::make_unique&lt;Derived&gt;(static_cast&lt;const Derived&amp;&gt;(*this));\n    }\n};\n\n// Base is defined, and already provides CloneableInterface\ntemplate &lt;class Derived, class AnotherBase&gt;\nclass Cloneable&lt;Derived, AnotherBase, true&gt; : public AnotherBase {\n   ...\n};\n\n// Base is defined, but has no CloneableInterface\ntemplate &lt;class Derived, class AnotherBase&gt;\nclass Cloneable&lt;Derived, AnotherBase, false&gt; : public AnotherBase, public CloneableInterface {\n    ...\n};\n</code></pre>\n\n<p>Usage example:</p>\n\n<pre><code>class Base : public Cloneable&lt;Base&gt; {\n};\n\n// Just some struct to test multiple inheritance\nstruct Other {\n};\n\nstruct Derived : Cloneable&lt;Derived, InheritFrom&lt;Base, Other&gt;&gt; {\n};\n\nstruct OtherBase {\n};\n\nstruct OtherDerived : Cloneable&lt;OtherDerived, InheritFrom&lt;OtherBase&gt;&gt; {\n};\n\nint main() {\n    // compiles and runs\n    auto base_ptr = std::make_unique&lt;Base&gt;();\n    auto derived_ptr = std::make_unique&lt;Derived&gt;();\n    auto base_clone = base_ptr-&gt;Clone();\n    auto derived_clone = derived_ptr-&gt;Clone();\n\n    auto otherderived_ptr = std::make_unique&lt;OtherDerived&gt;();\n    auto otherderived_clone = otherderived_ptr-&gt;Clone();\n}\n</code></pre>\n\n<p>Any critics and improvement suggestions are welcome!</p>\n"}, {"comments": [{"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 0, "creation_date": 1562793287, "post_id": 56978608, "comment_id": 100493429, "body": "Well, ok, I get your joke about delegating all the responsibility to the one who calls it, but this is not a pattern improvement in any way :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 0, "creation_date": 1562793350, "post_id": 56978608, "comment_id": 100493451, "body": "Maybe I&#39;m misunderstanding your problems with the current pattern. What are your issues with the current pattern?"}, {"owner": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "edited": false, "score": 1, "creation_date": 1562793480, "post_id": 56978608, "comment_id": 100493500, "body": "@Chipster The problem is that you could forget to override in B."}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 0, "creation_date": 1562793732, "post_id": 56978608, "comment_id": 100493593, "body": "I think I misunderstood. That actually seems very legit, though I&#39;ve never worked with <code>std::any</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "edited": false, "score": 0, "creation_date": 1562793754, "post_id": 56978608, "comment_id": 100493600, "body": "@datell I recon. My philosophy was that no matter if a child object overrides it or not, it can only return an <code>A*</code>, not a <code>B*</code> as you would expect. This solves that issue. I suppose there is still nothing in my solution keeping you from not overriding the function, though. Might have to think on that."}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 0, "creation_date": 1562794205, "post_id": 56978608, "comment_id": 100493739, "body": "@Chipster though I think it is not very good, because it might be very hard to debug -- consider that you have a <code>class Graph</code> of clonable <code>Nodes</code>, and you wish to copy it, but some user forgot to override -- he&#39;ll get a trash instead of a good graph, and the bug might be hard to localize. My solution has no such problem"}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 0, "creation_date": 1562796149, "post_id": 56978608, "comment_id": 100494293, "body": "@Chipster I wanted to say that the bug may be not even evident -- provided that one never calls <code>std::any_cast</code>"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1562796173, "post_id": 56978608, "comment_id": 100494301, "body": "<i>&quot;it can only return an <code>A*</code>, not a <code>B*</code> as you would expect. This solves that issue.&quot;</i> You think so? The entire point of <code>Clone</code> is that caller doesn&#39;t know the actual (dynamic) type of the object it&#39;s called on (otherwise you could just use a copy constructor). Since you don&#39;t know the correct type, how are you going to call <code>std::any_cast</code>?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "is_accepted": false, "score": 0, "last_activity_date": 1562792626, "creation_date": 1562792626, "answer_id": 56978608, "question_id": 56977929, "link": "https://stackoverflow.com/questions/56977929/improving-safety-of-clone-pattern/56978608#56978608", "title": "Improving safety of Clone pattern", "body": "<p>C++17 and newer offers an <a href=\"https://en.cppreference.com/w/cpp/utility/any\" rel=\"nofollow noreferrer\"><code>std::any</code></a>. You could in theory, then, make a clone function that returns an <code>std::any*</code> instead:</p>\n\n<pre><code>struct A {\n    virtual std::any* Clone() const {\n        return new A(*this);\n    }\n}\n\nstruct B : A {\n    int value;\n    // I suppose it doesn't have to be virtual here, \n    // but just in case we want to inherit the cloning capability from B as well\n    virtual std::any* Clone() const { // Note: you still need to override this function\n        return new B(*this);          // in the lower levels, though\n    }\n};\n// Note: I'm still on MSVS2010, so this C++17 code is untested.\n// Particularly problematic could be this main\nint main() {\n   B b;\n   // Here is the clone\n   auto b_clone = std::any_cast&lt;B*&gt;(b.Clone());\n   delete b_clone;\n}\n</code></pre>\n\n<p>Again, this is untested, but it should work in theory.</p>\n"}], "owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 56977930, "answer_count": 2, "score": 2, "last_activity_date": 1562795230, "creation_date": 1562789335, "last_edit_date": 1562795230, "question_id": 56977929, "link": "https://stackoverflow.com/questions/56977929/improving-safety-of-clone-pattern", "title": "Improving safety of Clone pattern", "body": "<p>If one wants to implement <code>Clone</code> pattern in C++, he might not be sure about safety, because derived class may forget to override it:</p>\n\n<pre><code>struct A {\n    virtual A* Clone() const {\n        return new A(*this);\n    }\n}\n\nstruct B : A {\n    int value;\n};\n\nint main() {\n   B b;\n   // oops\n   auto b_clone = b.Clone();\n   delete b_clone;\n}\n</code></pre>\n\n<p>What are the possible ways to improve <code>Clone</code> pattern in C++ in this regard?</p>\n\n<p>A more general question has been asked:\n<a href=\"https://stackoverflow.com/questions/12632747/forcing-a-derived-class-to-overload-a-virtual-method-in-a-non-abstract-base-clas\">Forcing a derived class to overload a virtual method in a non-abstract base class</a></p>\n\n<p>However, it seems to be too general to have a good solution in C++ -- the discussion is about possible ways to enforce method override. I'm more interested in discovering a useful pattern, which might help in the exact case of using Cloneable pattern.</p>\n"}, {"tags": ["c++", "listview", "winapi", "multipleselection"], "comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1562788933, "post_id": 56977766, "comment_id": 100491786, "body": "Related, if not dupe: <a href=\"https://stackoverflow.com/q/56619044/7571258\">stackoverflow.com/q/56619044/7571258</a>"}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 1, "creation_date": 1562792881, "post_id": 56977766, "comment_id": 100493293, "body": "You don&#39;t need to do anything special to get the marquee behaviour. No need to handle that notification at all."}, {"owner": {"reputation": 41, "user_id": 8437281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dac81c0b18520f98489d9a9a69bcff42?s=128&d=identicon&r=PG", "display_name": "makhlouf", "link": "https://stackoverflow.com/users/8437281/makhlouf"}, "edited": false, "score": 0, "creation_date": 1562794110, "post_id": 56977766, "comment_id": 100493706, "body": "I checked the post mentioned by zett42 and found that my program received LVN_MARQUEEBEGIN message when I started selection outside the items as mentioned in the pucher post."}, {"owner": {"reputation": 41, "user_id": 8437281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dac81c0b18520f98489d9a9a69bcff42?s=128&d=identicon&r=PG", "display_name": "makhlouf", "link": "https://stackoverflow.com/users/8437281/makhlouf"}, "edited": false, "score": 1, "creation_date": 1562794515, "post_id": 56977766, "comment_id": 100493836, "body": "I commented the lines handling LVN_MARQUEEBEGIN and found the selection works as Jonathan Potter mentioned. My problem was I adjusted the listview column widths to use the full window space. So there is no place to start selection unless I rearrange the column width. So, I will have to follow the &quot;ugly hack&quot; suggested by Anders in pucher post."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1562794818, "post_id": 56977766, "comment_id": 100493928, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/56619044/clistctrl-select-multiple-lines-with-the-mouse\">CListCtrl select multiple lines with the mouse</a>"}], "owner": {"reputation": 41, "user_id": 8437281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dac81c0b18520f98489d9a9a69bcff42?s=128&d=identicon&r=PG", "display_name": "makhlouf", "link": "https://stackoverflow.com/users/8437281/makhlouf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562788574, "creation_date": 1562788574, "question_id": 56977766, "link": "https://stackoverflow.com/questions/56977766/how-to-implement-multiple-selection-in-listview-with-lvn-marqueebegin", "title": "How to implement multiple selection in listview with LVN_MARQUEEBEGIN", "body": "<p>I have a listview with multiple selection enabled. The user can get multiple selection by clicking several items while pressing the shift or Ctrl keys. What I try to implement is to get multiple selection by pressing and holding down the mouse left button and dragging over the items to select them.</p>\n\n<p>I tried to respond to LVN_MARQUEEBEGIN as per Microsoft documentation. My program never receive this message. The documentation does not tell how to respond to this message.</p>\n\n<p>Here is a sample of my code:</p>\n\n<pre><code>static int  Count ;\nstatic int  SelectedItem ;\n\ncase WM_NOTIFY :\n\n  switch ((reinterpret_cast &lt;NMHDR *&gt; (lParam))-&gt;code) {\n\n    case NM_CLICK:\n        #define pnmitem ((NMITEMACTIVATE *) lParam)\n        if (SelectedItem == pnmitem-&gt;iItem) {  // item clicked again\n            SelectedItem = -1 ;\n            ListView_SetItemState (hwndListView,-1,0,0x000F) ;\n        } /* if (SelectedItem == pnmitem-&gt;iItem) */\n        else {\n            if (pnmitem-&gt;iItem != -1)\n                SelectedItem = pnmitem-&gt;iItem ;\n        } /* else */\n\n        Count = ListView_GetSelectedCount (hwndListView) ;\n        switch (Count) {\n            case 0 :\n                EnableWindow (hwndMerge,false) ;\n                EnableWindow (hwndSplit,false) ;\n                break ;\n            case 1 :\n                EnableWindow (hwndMerge,false) ;\n                EnableWindow (hwndSplit,true) ;\n                break ;\n            default :\n                EnableWindow (hwndMerge,true) ;\n                EnableWindow (hwndSplit,true) ;\n        } /* switch (Count) */\n        return true ;\n\n    case LVN_MARQUEEBEGIN :\n        ;\n        ;\n        return 0 ;\n\n  } /* switch ((reinterpret_cast &lt;NMHDR *&gt; (lParam))-&gt;code) */\n  break ; \n</code></pre>\n\n<ol>\n<li>Is LVN_MARQUEEBEGIN is the right message to use in my case.</li>\n<li>It seems to me there should be another message when selection is done. Or why Microsoft called it xxxbegin. But I could not find that other message.</li>\n<li>Can any one advise me where I can find an example or sample code for the use of LVN_MARQUEEBEGIN.</li>\n</ol>\n\n<p>Thank you all</p>\n"}, {"tags": ["c++", "unit-testing", "visual-studio-code", "googletest"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1562788688, "post_id": 56977621, "comment_id": 100491700, "body": "&#39;set it up&#39;, you mean install googletest on ubuntu, or set up vscodium to use googletest, or both?"}, {"owner": {"reputation": 35, "user_id": 11673108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68a5c14062aa62bf0ff8375cac8e60cb?s=128&d=identicon&r=PG&f=1", "display_name": "greenbur", "link": "https://stackoverflow.com/users/11673108/greenbur"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1562789006, "post_id": 56977621, "comment_id": 100491811, "body": "set up vscodium to use googletest. I believe I have installed googletest already but am not sure how to set it up in vscodium. That being said if you wanted to explain both I wouldn&#39;t be mad :)"}], "owner": {"reputation": 35, "user_id": 11673108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68a5c14062aa62bf0ff8375cac8e60cb?s=128&d=identicon&r=PG&f=1", "display_name": "greenbur", "link": "https://stackoverflow.com/users/11673108/greenbur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562797018, "creation_date": 1562787774, "last_edit_date": 1562797018, "question_id": 56977621, "link": "https://stackoverflow.com/questions/56977621/how-to-set-up-googletest-in-vscodium-in-ubuntu", "title": "How to set up Googletest in VSCodium in Ubuntu", "body": "<p>I am trying to set up googletest for unit testing on my c++ project in vscodium. Though every tutorial I've seen hasn't shown how to actually set it up. So I am hoping one of you know how to set it up.</p>\n"}, {"tags": ["c++", "string", "fstream", "iostream", "non-ascii-characters"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562787611, "post_id": 56977564, "comment_id": 100491230, "body": "What OS are you using?"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 2, "creation_date": 1562788206, "post_id": 56977564, "comment_id": 100491496, "body": "The question is unanswerable without a lot of information about your system and how the console is set up and the precise contents of the file you are trying to read (e.g. the encoding and character set being used). C++ has no platform independent support for international characters."}, {"owner": {"reputation": 1, "user_id": 11766753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/279f7bf30eab34398154bf8537b78158?s=128&d=identicon&r=PG&f=1", "display_name": "Lengard", "link": "https://stackoverflow.com/users/11766753/lengard"}, "edited": false, "score": 0, "creation_date": 1562792362, "post_id": 56977564, "comment_id": 100493112, "body": "I&#39;m using Windows 10"}, {"owner": {"reputation": 1, "user_id": 11766753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/279f7bf30eab34398154bf8537b78158?s=128&d=identicon&r=PG&f=1", "display_name": "Lengard", "link": "https://stackoverflow.com/users/11766753/lengard"}, "edited": false, "score": 0, "creation_date": 1562792484, "post_id": 56977564, "comment_id": 100493153, "body": "The file is a normal text i wrote. I can send you a part if that helps L&#39;unica razza non generata naturalmente, bens&#236; nata dai vari esperimenti condotti dal Non sono abituati ad indossare vestiti, vista la loro capacit&#224; di far crescere la pelliccia del loro spirito animale sul loro corpo."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1566479195, "post_id": 56977564, "comment_id": 101675408, "body": "Having to make some assumptions here but, as you have a number of non-ASCII characters in your data, the text file has probably been saved in Unicode format, with each character being 16-bits. Try using the wide-character version: <code>wifstream</code>."}], "owner": {"reputation": 1, "user_id": 11766753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/279f7bf30eab34398154bf8537b78158?s=128&d=identicon&r=PG&f=1", "display_name": "Lengard", "link": "https://stackoverflow.com/users/11766753/lengard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1566479398, "creation_date": 1562787537, "question_id": 56977564, "link": "https://stackoverflow.com/questions/56977564/printing-different-characters-from-the-one-read", "title": "Printing different characters from the one read", "body": "<p>I'm trying to create a text-based game using C++, just for fun and training. I wrote on a .txt the races of a fantasy world. But when I try to print them into the console, it doesn't print correctly the accented characters, changing them with others. For example, the '\u00e0' is always changed with the '\u00d3', or the '\u00e9' is always changed with the '\u00da'.</p>\n\n<p>I tried swapping the characters, for example the '\u00da' with the '\u00e9', but it changes into another character (in this case, a weird symbol which i can't even find, it's like this '\u00ac' but with the vertical line on the left).</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>ifstream racesF(\"std/races.txt\");\ncout &lt;&lt; racesF.rdbuf() &lt;&lt; endl;\n</code></pre>\n\n<p>This is the part of code which reads and prints the file.</p>\n"}, {"tags": ["c++", "mongodb", "ssl", "mongo-cxx-driver"], "answers": [{"tags": [], "owner": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "is_accepted": true, "score": 1, "last_activity_date": 1562790211, "last_edit_date": 1562790211, "creation_date": 1562789610, "answer_id": 56977976, "question_id": 56977425, "link": "https://stackoverflow.com/questions/56977425/error-connecting-mongocxx-to-mongodb-server-ssl-support-not-available/56977976#56977976", "title": "Error connecting mongocxx to mongodb server: SSL support not available", "body": "<p>You got this error because one or both of the C and C++ drivers was configured without SSL support. The C++ driver build defaults to SSL support (look for the <code>MONGOCXX_ENABLE_SSL</code> CMake option). So the most likely explanation is that the underlying C driver was built without SSL, and the second most likely explanation is that the C driver does have SSL support built in, but it was explicitly set to off when building the C++ driver. You can verify the state of the C driver by looking for the value of <code>MONGOC_ENABLE_SSL</code> in the C driver headers. If it is enabled, it should look like this:</p>\n\n<pre><code>$ find /usr/local/Cellar/mongo-c-driver/1.14.0/include -type f -name \"*.h\" | xargs grep 'MONGOC_ENABLE_SSL '\n/usr/local/Cellar/mongo-c-driver/1.14.0/include/libmongoc-1.0/mongoc/mongoc-config.h: * MONGOC_ENABLE_SSL is set from configure to determine if we are\n/usr/local/Cellar/mongo-c-driver/1.14.0/include/libmongoc-1.0/mongoc/mongoc-config.h:#define MONGOC_ENABLE_SSL 1\n/usr/local/Cellar/mongo-c-driver/1.14.0/include/libmongoc-1.0/mongoc/mongoc-config.h:#if MONGOC_ENABLE_SSL != 1\n</code></pre>\n\n<p>Of course, you should replace the path to the include directory above with the actual location where you have the C driver installed.</p>\n\n<p>If you see anything other than <code>#define MONGOC_ENABLE_SSL 1</code> in there, then your C driver doesn't have SSL support enabled and you will need to rebuild it to have it.</p>\n"}], "owner": {"reputation": 1385, "user_id": 8202606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aP46CW5acPM/AAAAAAAAAAI/AAAAAAAAACY/J6U8GUmqfng/photo.jpg?sz=128", "display_name": "Federico Caccia", "link": "https://stackoverflow.com/users/8202606/federico-caccia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 56977976, "answer_count": 1, "score": 2, "last_activity_date": 1562790211, "creation_date": 1562786896, "last_edit_date": 1562789918, "question_id": 56977425, "link": "https://stackoverflow.com/questions/56977425/error-connecting-mongocxx-to-mongodb-server-ssl-support-not-available", "title": "Error connecting mongocxx to mongodb server: SSL support not available", "body": "<p>Using mongocxx 3.3 or mongo cxx 3.4 stable versions, I\u00b4m trying to connect to a mongo atlas instance. This is my basic code:</p>\n\n<pre><code>#include &lt;mongocxx/client.hpp&gt;\n#include &lt;mongocxx/instance.hpp&gt;\n\nmongocxx::instance inst{};    \nmongocxx::uri uri = mongocxx::uri(\"mongodb+srv://...\");\nmongocxx::client conn(uri);\nmongocxx::database db = conn[\"test\"];\n</code></pre>\n\n<p>And I have tested several alternatives, like using client options (like explained here: <a href=\"http://mongocxx.org/mongocxx-v3/configuration/\" rel=\"nofollow noreferrer\">http://mongocxx.org/mongocxx-v3/configuration/</a>), and also setting a pem file path like explained here: <a href=\"https://stackoverflow.com/questions/52759683/mongocxx-fails-to-connect-to-mongodb-with-ssl\">Mongocxx fails to connect to mongoDB with SSL</a>.</p>\n\n<p>I always have the following error:</p>\n\n<pre><code>terminate called after throwing an instance of 'mongocxx::v_noabi::exception'\nwhat():  SSL support not available\nAborted (core dumped)\n</code></pre>\n"}, {"tags": ["c++", "vector", "tuples", "c++17", "move-semantics"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1562787930, "post_id": 56977339, "comment_id": 100491377, "body": "moving from const is generally a copy."}], "answers": [{"tags": [], "owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "is_accepted": true, "score": 5, "last_activity_date": 1562787535, "last_edit_date": 1562787535, "creation_date": 1562787042, "answer_id": 56977452, "question_id": 56977339, "link": "https://stackoverflow.com/questions/56977339/create-vector-of-tuples-from-two-vectors-by-move/56977452#56977452", "title": "Create vector of tuples from two vectors by move", "body": "<p>You forgot to use <code>std::move</code> here:</p>\n\n<pre><code>[](auto&amp;&amp; lhs_val, auto&amp;&amp; rhs_val) {\n    return std::make_tuple(std::move(lhs_val), std::move(rhs_val));\n});\n</code></pre>\n\n<p>Remember, everything named is an lvalue.</p>\n\n<p>In addition, you have to fix your iterators:</p>\n\n<pre><code>std::transform(lhs.begin(),\n               lhs.end(),\n               rhs.begin(),\n               ret.begin(),\n               [](auto&amp;&amp; lhs_val, auto&amp;&amp; rhs_val) {\n    return std::make_tuple(std::move(lhs_val), std::move(rhs_val));\n});\n</code></pre>\n\n<p>You cannot make a move-iterator out of const iterator, this is analogous to <code>std::move</code> applied on a <code>const</code> type. In fact, we can do without move-iterators and just get our lambda called with lvalue references, from which we can then move.</p>\n"}, {"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 5, "last_activity_date": 1562787508, "creation_date": 1562787508, "answer_id": 56977558, "question_id": 56977339, "link": "https://stackoverflow.com/questions/56977339/create-vector-of-tuples-from-two-vectors-by-move/56977558#56977558", "title": "Create vector of tuples from two vectors by move", "body": "<p>You use const iterators and you don't <code>std::move</code>the elements into the tuple. Both of which forces the copy. Change to this:</p>\n\n<pre><code>std::transform(std::make_move_iterator(lhs.begin()),\n               std::make_move_iterator(lhs.end()),\n               std::make_move_iterator(rhs.begin()),\n               ret.begin(),\n               [](auto&amp;&amp; lhs_val, auto&amp;&amp; rhs_val) {\n    return std::make_tuple(std::move(lhs_val), std::move(rhs_val));\n});\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562889847, "post_id": 56977627, "comment_id": 100530947, "body": "It&#39;s in these golden nuggets I find reason to be here. That&#39;s a very easy way to use the language to ones favour. I&#39;m a &quot;debug-printer&quot; by nature myself - but it&#39;ll never beat this."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 3, "last_activity_date": 1562787810, "creation_date": 1562787810, "answer_id": 56977627, "question_id": 56977339, "link": "https://stackoverflow.com/questions/56977339/create-vector-of-tuples-from-two-vectors-by-move/56977627#56977627", "title": "Create vector of tuples from two vectors by move", "body": "<p>The question was already answered, but I'd like to point out that you'd have much better luck of troubleshooting your issue if you ditch the printout, and instead rely on compiler diagnostic. You might also simplify the code a bit. So what you end up with is:</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct MyType\n{\n    constexpr MyType();\n    constexpr MyType(const T&amp; ) = delete;\n    constexpr MyType(const MyType&amp; ) = delete;\n\n    constexpr MyType(MyType&amp;&amp; ) noexcept;\n    ~MyType() = default;\n\n};\n\ntemplate&lt;typename LhsT, typename RhsT&gt;\nconstexpr auto operator+(std::vector&lt;MyType&lt;LhsT&gt;&gt;&amp;&amp; lhs, std::vector&lt;MyType&lt;RhsT&gt;&gt;&amp;&amp; rhs)\n{\n\n    std::vector&lt;std::tuple&lt;MyType&lt;LhsT&gt;, MyType&lt;RhsT&gt;&gt;&gt; ret(lhs.size());\n\n    std::transform(std::make_move_iterator(lhs.cbegin()),\n                   std::make_move_iterator(lhs.cend()),\n                   std::make_move_iterator(rhs.cbegin()),\n                   ret.begin(),\n                   [](MyType&lt;int&gt;&amp;&amp; lhs_val, MyType&lt;float&gt;&amp;&amp; rhs_val) {   \n        return std::make_tuple(std::move(lhs_val), std::move(rhs_val));\n    });\n    return ret;\n}\n\nint main()\n{\n    std::vector&lt;MyType&lt;int&gt;&gt; int_vec(1);\n    std::vector&lt;MyType&lt;float&gt;&gt; float_vec(1);\n\n    auto int_float_tp_vec = std::move(int_vec) + std::move(float_vec);\n}\n</code></pre>\n\n<p>And a very clear message:</p>\n\n<blockquote>\n  <p>error: binding reference of type 'MyType&amp;&amp;' to 'const\n  MyType' discards qualifiers</p>\n</blockquote>\n\n<p>That immediately points out to incorrect usage of const iterators.</p>\n"}], "owner": {"reputation": 1229, "user_id": 9226753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28247b27eef49240c767833514e2ab50?s=128&d=identicon&r=PG&f=1", "display_name": "kanstar", "link": "https://stackoverflow.com/users/9226753/kanstar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 56977452, "answer_count": 3, "score": 2, "last_activity_date": 1562787810, "creation_date": 1562786458, "last_edit_date": 1562786829, "question_id": 56977339, "link": "https://stackoverflow.com/questions/56977339/create-vector-of-tuples-from-two-vectors-by-move", "title": "Create vector of tuples from two vectors by move", "body": "<p>I want to create a <code>std::vector</code> of <code>std::tuple</code>'s (<code>std::vector&lt;std::tuple&lt;Ts...&gt;&gt;</code>) from two <code>std::vector</code>'s by moving the data of the <code>std::vector</code>s.</p>\n\n<p>Let's assume I have a struct similar to this (added <code>std::cout</code>s to showcase the problem).</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct MyType\n{\n    constexpr MyType() { std::cout &lt;&lt; \"default constructor\\n\"; }\n    constexpr MyType(const T&amp; data) : m_data(data)\n    {\n        std::cout &lt;&lt; \"data constructor\\n\";\n    }\n    constexpr MyType(const MyType&amp; other) : m_data(other.m_data)\n    {\n        std::cout &lt;&lt; \"copy constructor\\n\"; \n    }\n\n    constexpr MyType(MyType&amp;&amp; other) noexcept : m_data(std::move(other.m_data))\n    {\n        std::cout &lt;&lt; \"move constructor\\n\";\n    }\n    ~MyType() = default;\n\n    constexpr MyType&amp; operator=(const MyType&amp; other)\n    {\n        std::cout &lt;&lt; \"copy operator\\n\";\n        m_data = other.m_data;\n        return *this;\n    }\n    constexpr MyType&amp; operator=(MyType&amp;&amp; other) noexcept\n    {\n        std::cout &lt;&lt; \"move operator\\n\";\n        m_data = std::move(other.m_data);\n        return *this;\n    }\n\nprivate:\n    T m_data{};\n};\n</code></pre>\n\n<p>Now we can define a <code>operator+</code> for rvalue references of <code>std::vector&lt;MyType&lt;T&gt;&gt;</code>:</p>\n\n<pre><code>template&lt;typename LhsT, typename RhsT&gt;\nconstexpr auto operator+(std::vector&lt;MyType&lt;LhsT&gt;&gt;&amp;&amp; lhs, std::vector&lt;MyType&lt;RhsT&gt;&gt;&amp;&amp; rhs)\n{\n    if(lhs.size() != rhs.size())\n        throw std::runtime_error(\"\");\n\n    std::vector&lt;std::tuple&lt;MyType&lt;LhsT&gt;, MyType&lt;RhsT&gt;&gt;&gt; ret(lhs.size());\n\n    std::cout &lt;&lt; \"before transform\\n\";\n    std::transform(std::make_move_iterator(lhs.cbegin()),\n                   std::make_move_iterator(lhs.cend()),\n                   std::make_move_iterator(rhs.cbegin()),\n                   ret.begin(),\n                   [](auto&amp;&amp; lhs_val, auto&amp;&amp; rhs_val) {\n        return std::make_tuple(lhs_val, rhs_val);\n    });\n    std::cout &lt;&lt; \"after transform\\n\";\n    return ret;\n}\n</code></pre>\n\n<p>Now here I am facing the problem. When running this code</p>\n\n<pre><code>int main()\n{\n    std::vector&lt;MyType&lt;int&gt;&gt; int_vec(1);\n    std::vector&lt;MyType&lt;float&gt;&gt; float_vec(1);\n\n    std::cout &lt;&lt; \"before move operator+\\n\";\n    auto int_float_tp_vec = std::move(int_vec) + std::move(float_vec);\n    std::cout &lt;&lt; \"after move operator+\\n\";\n}\n</code></pre>\n\n<p>the output is this:</p>\n\n<pre><code>default constructor\ndefault constructor\nbefore move operator+\ndefault constructor\ndefault constructor\nbefore transform\ncopy constructor\ncopy constructor\nmove operator\nmove operator\nafter transform\nafter move operator+\n</code></pre>\n\n<p>The question is: why is the <code>copy constructor</code> called? Is using <code>std::make_tuple</code> the wrong approach here? How can I do this without calling the <code>copy constructor</code> nor the <code>copy operator</code>?</p>\n\n<h3><a href=\"https://godbolt.org/z/aHHTDX\" rel=\"nofollow noreferrer\">LIVE DEMO</a></h3>\n"}, {"tags": ["c++", "templates", "boost", "template-meta-programming", "c++03"], "answers": [{"comments": [{"owner": {"reputation": 390, "user_id": 6778220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2017416e6f7cacc38c8564e371514e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/6778220/newbie"}, "edited": false, "score": 0, "creation_date": 1562786560, "post_id": 56977295, "comment_id": 100490825, "body": "oh, thanks, but does not solve the problem with &quot;const typename .... disable_if..... cannot be overloaded&quot;"}, {"owner": {"reputation": 4419, "user_id": 2254782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93806dc8873fdb424d2df0f57b54d8e?s=128&d=identicon&r=PG", "display_name": "alexrider", "link": "https://stackoverflow.com/users/2254782/alexrider"}, "reply_to_user": {"reputation": 390, "user_id": 6778220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2017416e6f7cacc38c8564e371514e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/6778220/newbie"}, "edited": false, "score": 0, "creation_date": 1562786828, "post_id": 56977295, "comment_id": 100490932, "body": "Have you provided TypeToReturn there as well?"}, {"owner": {"reputation": 4419, "user_id": 2254782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93806dc8873fdb424d2df0f57b54d8e?s=128&d=identicon&r=PG", "display_name": "alexrider", "link": "https://stackoverflow.com/users/2254782/alexrider"}, "reply_to_user": {"reputation": 390, "user_id": 6778220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2017416e6f7cacc38c8564e371514e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/6778220/newbie"}, "edited": false, "score": 0, "creation_date": 1562787904, "post_id": 56977295, "comment_id": 100491365, "body": "<a href=\"https://godbolt.org/z/0lLydC\" rel=\"nofollow noreferrer\">godbolt.org/z/0lLydC</a> You can use slightly different approach to using enable/disable_if"}, {"owner": {"reputation": 390, "user_id": 6778220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2017416e6f7cacc38c8564e371514e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/6778220/newbie"}, "edited": false, "score": 0, "creation_date": 1562793866, "post_id": 56977295, "comment_id": 100493633, "body": "@alexrider this will not work for int arrays? <a href=\"https://godbolt.org/z/PaHGYQ\" rel=\"nofollow noreferrer\">godbolt.org/z/PaHGYQ</a>  (maybe not the best) for that case it is not &quot;integral&quot; so I would like to return const &amp;"}, {"owner": {"reputation": 390, "user_id": 6778220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2017416e6f7cacc38c8564e371514e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/6778220/newbie"}, "edited": false, "score": 0, "creation_date": 1562793931, "post_id": 56977295, "comment_id": 100493654, "body": "I mean when TypeToReturn will be array, so operator() should return const TypeToReturn&amp;"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1562803318, "post_id": 56977295, "comment_id": 100495816, "body": "<code>someParameterNotImportant</code> is <code>int&amp;</code> in OP case. you change that too. (and using SFINAE on that parameter would disallow conversion operator for example)"}], "tags": [], "owner": {"reputation": 4419, "user_id": 2254782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93806dc8873fdb424d2df0f57b54d8e?s=128&d=identicon&r=PG", "display_name": "alexrider", "link": "https://stackoverflow.com/users/2254782/alexrider"}, "is_accepted": false, "score": 1, "last_activity_date": 1562792505, "last_edit_date": 1562792505, "creation_date": 1562786251, "answer_id": 56977295, "question_id": 56977220, "link": "https://stackoverflow.com/questions/56977220/boostenable-if-on-member-function-overload-return-type/56977295#56977295", "title": "boost::enable_if on member function, overload return type", "body": "<p>You need to provide a type to the enable_if</p>\n\n<pre><code>typename boost::enable_if&lt;boost::is_integral&lt;TypeToReturn&gt;, TypeToReturn &gt;::type \n</code></pre>\n\n<p>otherwise it defaults to void</p>\n\n<p>And to make it working for real you need to either make operator's template functions by themselves to allow SFINAE to kick in thru this won't work for the c++03 as stated in tags.</p>\n\n<pre><code>template &lt;typename Ret = TypeToReturn&gt;\ntypename boost::enable_if&lt;boost::is_integral&lt;Ret&gt;,Ret &gt;::type \noperator()(int&amp; someParameterNotImportant) const\n</code></pre>\n\n<p>Or use dummy variable and make operators differ by the parameters instead of return value. But still keeping it template. This will work for the c++03 </p>\n\n<pre><code>template&lt;typename T&gt;\n    TypeToReturn operator()(T&amp; someParameterNotImportant, typename boost::enable_if&lt;boost::is_integral&lt;TypeToReturn&gt;,T &gt;::type* = 0) const\n</code></pre>\n\n<p>You may also add check for the T being int here to issue compile time error if it isn't.</p>\n"}, {"comments": [{"owner": {"reputation": 390, "user_id": 6778220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2017416e6f7cacc38c8564e371514e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/6778220/newbie"}, "edited": false, "score": 0, "creation_date": 1562788783, "post_id": 56977730, "comment_id": 100491742, "body": "this is probably not applicable in c++03 with this default template arguments?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 390, "user_id": 6778220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2017416e6f7cacc38c8564e371514e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/6778220/newbie"}, "edited": false, "score": 1, "creation_date": 1562790414, "post_id": 56977730, "comment_id": 100492335, "body": "@Newbie: Indeed, version restriction added."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1562795797, "last_edit_date": 1562795797, "creation_date": 1562788375, "answer_id": 56977730, "question_id": 56977220, "link": "https://stackoverflow.com/questions/56977220/boostenable-if-on-member-function-overload-return-type/56977730#56977730", "title": "boost::enable_if on member function, overload return type", "body": "<p>SFINAE applies to template methods. your are not.</p>\n\n<p>In C++11, we can have default template for function to handle that:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename First,\n         typename TypeToReturn = typename Holder&lt;First&gt;::type&gt;\nstruct SuperClass\n{\n    template &lt;typename T = TypeToReturn&gt;\n    typename boost::enable_if&lt;boost::is_integral&lt;T&gt;, T&gt;::type \n    operator()(int&amp; someParameterNotImportant) const\n    {\n        // stuff\n    }\n\n    template &lt;typename T = TypeToReturn&gt;\n    const typename boost::disable_if&lt;boost::is_integral&lt;T&gt;, T&gt;::type&amp;\n    operator()(int&amp; someParameterNotImportant) const\n    {\n        // stuff\n    }\n};\n</code></pre>\n\n<p>C++17 would allow simpler syntax with <code>if constexpr</code>,</p>\n\n<p>and C++20 would allows <code>requires</code> to discard the method thanks to traits.</p>\n\n<p>In C++03, I would suggest tag dispatching instead:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename First,\n         typename TypeToReturn&gt;\nTypeToReturn helper(int&amp; someParameterNotImportant, boost::true_type)\n{\n// stuff\n}\n\ntemplate&lt;typename First,\n         typename TypeToReturn&gt;\nconst TypeToReturn&amp; helper(int&amp; someParameterNotImportant, boost::false_type)\n{\n// stuff\n}\n\n\ntemplate&lt;typename First,\n         typename TypeToReturn = typename Holder&lt;First&gt;::type&gt;\nstruct SuperClass\n{\n    typename boost::conditional&lt;boost::is_integral&lt;TypeToReturn&gt;::value,\n                                TypeToReturn,\n                                const TypeToReturn&amp;&gt;::type \n    operator()(int&amp; someParameterNotImportant) const\n    {\n        return helper&lt;First, TypeToReturn&gt;(someParameterNotImportant,\n                                           boost::is_integral&lt;TypeToReturn&gt;());\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 390, "user_id": 6778220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2017416e6f7cacc38c8564e371514e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/6778220/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562795797, "creation_date": 1562785926, "last_edit_date": 1562789483, "question_id": 56977220, "link": "https://stackoverflow.com/questions/56977220/boostenable-if-on-member-function-overload-return-type", "title": "boost::enable_if on member function, overload return type", "body": "<p>I want to be able to use <code>boost::enable_if</code> to turn off/on some methods.</p>\n\n<p>For integral types I want to return <code>TypeToReturn</code> from <code>operator()</code>\nFor other types I want to return <code>const TypeToReturn&amp;</code></p>\n\n<p>This is my attempt:</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct Holder{\n    typedef T type;\n};\n\n\ntemplate&lt;typename First,\n         typename TypeToReturn = typename Holder&lt;First&gt;::type&gt;\n\nstruct SuperClass{\n\n    typename boost::enable_if&lt;boost::is_integral&lt;TypeToReturn&gt; &gt;::type \n    operator()(int&amp; someParameterNotImportant) const\n    {\n        // stuff\n    }\n\n    const typename boost::disable_if&lt;boost::is_integral&lt;TypeToReturn&gt; &gt;::type&amp;\n    operator()(int&amp; someParameterNotImportant) const\n    {\n        // stuff\n    }\n};\n</code></pre>\n\n<p>I am getting errors that these functions cannot be overloaded etc.</p>\n\n<p>I am not even sure if this attempt is step in good direction. </p>\n\n<p>EDIT: After first suggestion I am adding code after correction,\nstill gives problem that \"const typename boost::disable_if..... cannot be overloaded\"</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct Holder{\n    typedef T type;\n};\n\n\ntemplate&lt;typename First,\n         typename TypeToReturn = typename Holder&lt;First&gt;::type&gt;\n\nstruct SuperClass{\n\n    typename boost::enable_if&lt;boost::is_integral&lt;TypeToReturn&gt;, TypeToReturn &gt;::type \n    operator()(int&amp; someParameterNotImportant) const\n    {\n        // stuff\n    }\n\n    const typename boost::disable_if&lt;boost::is_integral&lt;TypeToReturn&gt;, TypeToReturn &gt;::type&amp;\n    operator()(int&amp; someParameterNotImportant) const\n    {\n        // stuff\n    }\n};\n</code></pre>\n"}, {"tags": ["python", "c++", "qt", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 11766544, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cJ42lSzI-5w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR8SBiLSCxbapJNPRvFGkE1n3XFQ/photo.jpg?sz=128", "display_name": "Maciekx7", "link": "https://stackoverflow.com/users/11766544/maciekx7"}, "edited": false, "score": 0, "creation_date": 1562787334, "post_id": 56977288, "comment_id": 100491114, "body": "what does number 3 in pip mean? When I paste it in terminal, it says &#39;-bash: syntax error near unexpected token `3&#39;&#39;"}, {"owner": {"reputation": 954, "user_id": 4788501, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203945492863253/picture?type=large", "display_name": "Josef Korbel", "link": "https://stackoverflow.com/users/4788501/josef-korbel"}, "reply_to_user": {"reputation": 105, "user_id": 11766544, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cJ42lSzI-5w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR8SBiLSCxbapJNPRvFGkE1n3XFQ/photo.jpg?sz=128", "display_name": "Maciekx7", "link": "https://stackoverflow.com/users/11766544/maciekx7"}, "edited": false, "score": 0, "creation_date": 1562787407, "post_id": 56977288, "comment_id": 100491141, "body": "Its either pip if you have python2 installed or pip3 if you have python3 installed"}, {"owner": {"reputation": 105, "user_id": 11766544, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cJ42lSzI-5w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR8SBiLSCxbapJNPRvFGkE1n3XFQ/photo.jpg?sz=128", "display_name": "Maciekx7", "link": "https://stackoverflow.com/users/11766544/maciekx7"}, "edited": false, "score": 0, "creation_date": 1562787608, "post_id": 56977288, "comment_id": 100491225, "body": "I have both python2 and python3 installed. (python --version is 2.7.16 and python3 --version is 3.7.3) I wrote &quot;pip install requests&quot; and it isn&#39;t still working on qt and pip(3) not working in terminal at all"}, {"owner": {"reputation": 954, "user_id": 4788501, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203945492863253/picture?type=large", "display_name": "Josef Korbel", "link": "https://stackoverflow.com/users/4788501/josef-korbel"}, "reply_to_user": {"reputation": 105, "user_id": 11766544, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cJ42lSzI-5w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR8SBiLSCxbapJNPRvFGkE1n3XFQ/photo.jpg?sz=128", "display_name": "Maciekx7", "link": "https://stackoverflow.com/users/11766544/maciekx7"}, "edited": false, "score": 0, "creation_date": 1562787641, "post_id": 56977288, "comment_id": 100491242, "body": "<code>pip3 install requests</code>"}, {"owner": {"reputation": 105, "user_id": 11766544, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cJ42lSzI-5w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR8SBiLSCxbapJNPRvFGkE1n3XFQ/photo.jpg?sz=128", "display_name": "Maciekx7", "link": "https://stackoverflow.com/users/11766544/maciekx7"}, "edited": false, "score": 0, "creation_date": 1562788180, "post_id": 56977288, "comment_id": 100491480, "body": "I&#39;ve changed my c++/qt code to &quot;python3 file_name&quot; and it&#39;s now saying &quot;command is not found&quot;"}], "tags": [], "owner": {"reputation": 954, "user_id": 4788501, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203945492863253/picture?type=large", "display_name": "Josef Korbel", "link": "https://stackoverflow.com/users/4788501/josef-korbel"}, "is_accepted": false, "score": 0, "last_activity_date": 1562786206, "creation_date": 1562786206, "answer_id": 56977288, "question_id": 56977156, "link": "https://stackoverflow.com/questions/56977156/how-to-use-python-script-in-c-qt-code-web-scraping-aspect/56977288#56977288", "title": "How to use python script in c++ (qt) code? (web-scraping aspect)", "body": "<p>You have to install <code>requests</code> by <code>pip(3) install requests</code></p>\n"}], "owner": {"reputation": 105, "user_id": 11766544, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cJ42lSzI-5w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR8SBiLSCxbapJNPRvFGkE1n3XFQ/photo.jpg?sz=128", "display_name": "Maciekx7", "link": "https://stackoverflow.com/users/11766544/maciekx7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1612734650, "creation_date": 1562785594, "last_edit_date": 1612734650, "question_id": 56977156, "link": "https://stackoverflow.com/questions/56977156/how-to-use-python-script-in-c-qt-code-web-scraping-aspect", "title": "How to use python script in c++ (qt) code? (web-scraping aspect)", "body": "<p>I want to build a gui application which allows to convert money with real-time exchange rate. I'm using MacOs and QtCreator (I have also PyCharm and VS Code, but I especially want to use QtCreator to make my gui)</p>\n\n<p>Firstly I've created a Python script which gets me a real-time exchange rate from a stooq page. I did it, because I wanted to learn web Scraping. \nSecondly, I've wanted to make a qui for it and I've already known how to use and write an application in Qt Creator in C++. So, I've created an app. First idea was to connect a python script to my c++ qt project. I've searched in the internet, but all I'd found were ideas to create dynamic library from python script. I don't know how to do it, especially in QtDesigner. \nSo, I made a brainstorm and I came to an idea. Why not saving an input to my python script from QtWindow to txt file, then calling python script and finally, save an output from python script to another txt file. Now I would just read real-time exchange rate from my txt file.</p>\n\n<p>But I faced a problem. When I'm calling my python script, compiler says that I don't have packages used in script (requests and beautifullsoup). I checked that I have installed that libraries on my computer (terminal -> 'brew install requests', 'brew install bs4')\nUnless I have it installed, Qt doesn't see it.</p>\n\n<p>Do you have any idea how to say Qt that I have that stuff already installed or can you tell me an easier way to do add python script to c++ qt code or can you tell me an easier way to make web scraping? Because, based on my web searching, I did't find another that easy way to make Gui as Qt.</p>\n\n<p>(Oh, and one more quick question: How can I tell Qt a path to file? As you can see in my code, I had to past full path, because Qt didn't see my file (I pasted in both in source folder, compile folder and a folder below) Remember - I'm using Mac. I know that on Windows only a filename would work.</p>\n\n<p>Function in Qt c++ calling Python script:</p>\n\n<pre><code>void MainWindow::PythonScriptOpen()\n{\n    std::string filename = \"/Users/username/Desktop/programming/Currency_converter/Currency_Converter/currency_converter.py\";\n    std::string command = \"python \";\n    command += filename;\n    system(command.c_str());\n}\n</code></pre>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>Traceback (most recent call last):   File\n  \"/Users/username/Desktop/programming/Currency_converter/Currency_Converter/currency_converter.py\",\n  line 3, in \n      import requests ImportError: No module named requests</p>\n</blockquote>\n"}, {"tags": ["c++", "build", "cmake"], "answers": [{"comments": [{"owner": {"reputation": 2643, "user_id": 3736306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b04e15baa8fe1cfac912948db67b919d?s=128&d=identicon&r=PG&f=1", "display_name": "yuqli", "link": "https://stackoverflow.com/users/3736306/yuqli"}, "edited": false, "score": 0, "creation_date": 1562786185, "post_id": 56977205, "comment_id": 100490671, "body": "Thanks for the prompt reply. Does this mean it&#39;s not the build system&#39;s job to figure out the <code>#include</code> path for the <code>.hpp</code> files? As that&#39;s the job of the compiler?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 2643, "user_id": 3736306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b04e15baa8fe1cfac912948db67b919d?s=128&d=identicon&r=PG&f=1", "display_name": "yuqli", "link": "https://stackoverflow.com/users/3736306/yuqli"}, "edited": false, "score": 1, "creation_date": 1562786444, "post_id": 56977205, "comment_id": 100490777, "body": "@yuqli CMake figures out include paths by means of &#39;target_link_library&#39; for headers provided by app or libraries it uses, and compiler uses predefined default paths for everything else. But that has nothing to do with executable building, so that&#39;s why <code>add_executable</code> doesn&#39;t have it."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 3, "last_activity_date": 1562785806, "creation_date": 1562785806, "answer_id": 56977205, "question_id": 56977126, "link": "https://stackoverflow.com/questions/56977126/cmake-add-executable-use-cpp-file-or-hpp-file/56977205#56977205", "title": "CMake add_executable() use .cpp file or .hpp file?", "body": "<p>Header files, which <em>often</em> have .h or .hpp extension, although not always - for example, C++ standard library headers have no extensions - are \"copy-pasted\" by compiler into every .cpp (or .C, or .cc) which has <code>#include</code> directive to include the file.</p>\n\n<p>Because of that, build system, such as CMake, doesn't have to know about them when the final executable is built - their contents is already accounted for by literal inclusion of their code into .cpp file.</p>\n\n<p>However, build systems need to know about those files when dependencies are specified - to ensure that the whole application is rebuilt whenever any of those files is updated, and also to provide the proper inclusion path to the compilation command.</p>\n"}], "owner": {"reputation": 2643, "user_id": 3736306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b04e15baa8fe1cfac912948db67b919d?s=128&d=identicon&r=PG&f=1", "display_name": "yuqli", "link": "https://stackoverflow.com/users/3736306/yuqli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 759, "favorite_count": 0, "accepted_answer_id": 56977205, "answer_count": 1, "score": 1, "last_activity_date": 1562785806, "creation_date": 1562785429, "question_id": 56977126, "link": "https://stackoverflow.com/questions/56977126/cmake-add-executable-use-cpp-file-or-hpp-file", "title": "CMake add_executable() use .cpp file or .hpp file?", "body": "<p>I've read a bunch questions on this site about the usage of <code>add_executable</code> function in <code>CMake</code>, but have not found an exact answer to my confusion.</p>\n\n<p>My question is why we only add <code>.cpp</code> files in the <code>add_executable</code> function but not <code>.hpp</code> files? </p>\n\n<p>I understand header files are like \"indices\" for functions and classes in the corresponding <code>.cpp</code> files. But if we don't include them in the <code>add_executable</code> function, how are they used in the build process? </p>\n\n<p>For example, will the <code>A.hpp</code> file be used when another source file import <code>A.hpp</code>? But then <code>A.hpp</code> is not in the <code>add_executable</code> function... How does the program know where to find <code>A.hpp</code>?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "object-lifetime", "placement-new"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562785199, "post_id": 56977042, "comment_id": 100490280, "body": "Please check the formatting of your question. It&#39;s not clear to me where the question text ends and where the code is supposed to start."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562785219, "post_id": 56977042, "comment_id": 100490292, "body": "It&#39;s unclear to me what you are asking.  What part of the code do you think be invalid but the standard says it&#39;s okay?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562785316, "post_id": 56977042, "comment_id": 100490330, "body": "There are cases where you can placement <code>new</code> over a live object but, if I remember correctly, none of those cases apply to polymorphic objects."}, {"owner": {"reputation": 117, "user_id": 11358686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e9106d778ba934bacf9b3d6fd411c2?s=128&d=identicon&r=PG&f=1", "display_name": "minex", "link": "https://stackoverflow.com/users/11358686/minex"}, "edited": false, "score": 0, "creation_date": 1562785397, "post_id": 56977042, "comment_id": 100490351, "body": "<b>void B::mutate() {       new (this) D2;    // reuses storage \u2014 ends the lifetime of *this       f();              // undefined behavior</b>       ... = this;       // OK, this points to valid memory     } it says f() is undefined behaviour, but it shall not because the condition for the rule does not hold in the first place! Since D2 ends the liftime of original object and starts the lifetime of the new object! Hence using pointer to this shall be well defined"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562785626, "post_id": 56977042, "comment_id": 100490438, "body": "<code>f()</code> is using <code>*this</code> but it can&#39;t because <code>*this</code> was destroyed."}, {"owner": {"reputation": 117, "user_id": 11358686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e9106d778ba934bacf9b3d6fd411c2?s=128&d=identicon&r=PG&f=1", "display_name": "minex", "link": "https://stackoverflow.com/users/11358686/minex"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562785818, "post_id": 56977042, "comment_id": 100490518, "body": "@NathanOliver. But didn&#39;t this code below ended the lifetime of the original object and then started the lifetime of the new object.  Standard says this cannot be used if this is not reused, but it clears is after placement new ---&gt;&gt;&gt;  new (this) D2;    // reuses storage \u2014 ends the lifetime of *this"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562785866, "post_id": 56977042, "comment_id": 100490542, "body": "@minex I&#39;m writing up an answer right now to clear up you confusion."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1564107744, "post_id": 56977042, "comment_id": 100930351, "body": "@Fran&#231;oisAndrieux The ability to use placement new has nothing to do with polymorphism."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1564149348, "post_id": 56977042, "comment_id": 100947263, "body": "@curiousguy I said that there are cases where you cannot placement <code>new</code> <i>over an object that is still within it&#39;s lifetime</i> and that one of those cases is if the object&#39;s type is polymorphic. You must call the destructor explicitly before you do that, unless the desctructor is trivial. Though now I realize that a polymorphic type doesn&#39;t strictly require that the base class&#39; destructor be <code>virtual</code>, so a polymorphic object <i>might</i> sometimes be trivial."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1564162738, "post_id": 56977042, "comment_id": 100953864, "body": "@Fran&#231;oisAndrieux Consider the case of pure memory resources (no resources other than dynamic allocation inside the process space) and process termination. Do you claim it&#39;s a bug to not cleanup at process termination? Now consider allocation inside an &quot;arena&quot; that is going away. Would you want to restore the arena to its empty state? That would seem silly and wasteful. Why would anyone care about properly calling dtors in general?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1564163454, "post_id": 56977042, "comment_id": 100954132, "body": "@Fran&#231;oisAndrieux IOW, what makes you believe calling a dtor has any real world meaning if the object is being erased anyway? Except for a sense of symmetry between construction and destruction. Calling useless dtors has never been required. Hopefully!"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1564164510, "post_id": 56977042, "comment_id": 100954557, "body": "@curiousguy To the first reply : that has nothing to do with what I said. This shifts the discussion to an entirely new place. I in no way made the claim you ask about in that reply. To the second reply : I said the opposite, you <b>don&#39;t</b> need call trivial destructors."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1564166112, "post_id": 56977042, "comment_id": 100955189, "body": "@Fran&#231;oisAndrieux In complex C++ code, many objects have non trivial dtors but they don&#39;t manage resources other than memory. Do these dtors need to be called?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1564166324, "post_id": 56977042, "comment_id": 100955263, "body": "@curiousguy It seems, once again, you are baiting me into an argument that&#39;s not related to the initial topic. I&#39;m afraid, this time, I must decline."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1564166366, "post_id": 56977042, "comment_id": 100955278, "body": "@Fran&#231;oisAndrieux You are wrong, period. There is no reason to call a dtor if you don&#39;t need to do the cleanup."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1564166478, "post_id": 56977042, "comment_id": 100955320, "body": "@curiousguy That&#39;s what I said... <b>&quot; you don&#39;t need call trivial destructors&quot;</b>. Edit : looks like I missed a &quot;to&quot; in &quot;don&#39;t need to call&quot;."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1564166722, "post_id": 56977042, "comment_id": 100955413, "body": "@Fran&#231;oisAndrieux No it isn&#39;t what you said at all. Please read my comments again. You only need to call a dtor if you depend on the cleanup it would do if called. Like a function called <code>cleanup_stuff</code>."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 11358686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e9106d778ba934bacf9b3d6fd411c2?s=128&d=identicon&r=PG&f=1", "display_name": "minex", "link": "https://stackoverflow.com/users/11358686/minex"}, "edited": false, "score": 0, "creation_date": 1562786218, "post_id": 56977246, "comment_id": 100490685, "body": "That &quot;Otherwise&quot; indeed made my mental model work :) Thanks a lot!"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1562786603, "last_edit_date": 1592644375, "creation_date": 1562786053, "answer_id": 56977246, "question_id": 56977042, "link": "https://stackoverflow.com/questions/56977042/reusing-objects-space-by-another-object/56977246#56977246", "title": "reusing object&#39;s space by another object", "body": "<blockquote>\n<p>but it is clearly reused in their own code snippet.</p>\n<pre><code>new (this) D2;    // reuses storage \u2014 ends the lifetime of *this\nf();              // undefined behavior**\n... = this;       // OK, this points to valid memory\n</code></pre>\n</blockquote>\n<p>Correct. Because the stoarge has been reused, the &quot;Otherwise&quot; clause applies:</p>\n<blockquote>\n<p>... Otherwise, such a pointer refers to allocated storage ([basic.stc.dynamic.deallocation]), and using the pointer as if the pointer were of type void*, is well-defined.</p>\n</blockquote>\n<p>Calling <code>f()</code> through a <code>void*</code> is not possible, so it is not allowed by that clause. Otherwise, calling member functions of an object whose lifetime has ended is undefined (outside of the destructor).</p>\n<p><code>... = this;</code> on the other hand <em>is</em> something that can be done with a <code>void*</code>.</p>\n<p>Note that <code>(new (this) D2)-&gt;f()</code> would be well-defined.</p>\n"}, {"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562786576, "post_id": 56977267, "comment_id": 100490834, "body": "If <code>auto x = this;</code> is legal after the placement new, is dereferencing <code>x</code> legal?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1562786639, "post_id": 56977267, "comment_id": 100490857, "body": "@Fran&#231;oisAndrieux No.  <code>this</code> can&#39;t be used anymore except to get its value.  Treat placement new as making the pointer invalid for access use."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562786803, "post_id": 56977267, "comment_id": 100490925, "body": "@Fran&#231;oisAndrieux What you can do though is use <a href=\"https://en.cppreference.com/w/cpp/utility/launder\" rel=\"nofollow noreferrer\"><code>std::launder</code></a> with <code>this</code> to call <code>f()</code> like <code>std::launder&lt;D2&gt;(this)-&gt;f();</code>"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1562786804, "post_id": 56977267, "comment_id": 100490926, "body": "@Fran&#231;oisAndrieux Well, dereferencing i.e. indirecting is permitted, as per the rule quoted in the question, <i>but the resulting lvalue may only be used in limited ways, as described [further in that rule]</i>."}, {"owner": {"reputation": 117, "user_id": 11358686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e9106d778ba934bacf9b3d6fd411c2?s=128&d=identicon&r=PG&f=1", "display_name": "minex", "link": "https://stackoverflow.com/users/11358686/minex"}, "edited": false, "score": 0, "creation_date": 1562787276, "post_id": 56977267, "comment_id": 100491097, "body": "@NathanOliver. According to the standart, this pointer can still be used if roughly speaking this all happens to the same class <a href=\"https://timsong-cpp.github.io/cppwp/n4659/basic.life#8\" rel=\"nofollow noreferrer\">timsong-cpp.github.io/cppwp/n4659/basic.life#8</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 117, "user_id": 11358686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e9106d778ba934bacf9b3d6fd411c2?s=128&d=identicon&r=PG&f=1", "display_name": "minex", "link": "https://stackoverflow.com/users/11358686/minex"}, "edited": false, "score": 0, "creation_date": 1562787547, "post_id": 56977267, "comment_id": 100491205, "body": "@minex The pointers aren&#39;t the same type though.  <code>this</code> pointed to a <code>D1</code>, and now there is a <code>D2</code> there."}, {"owner": {"reputation": 117, "user_id": 11358686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e9106d778ba934bacf9b3d6fd411c2?s=128&d=identicon&r=PG&f=1", "display_name": "minex", "link": "https://stackoverflow.com/users/11358686/minex"}, "edited": false, "score": 0, "creation_date": 1562787659, "post_id": 56977267, "comment_id": 100491251, "body": "@NathanOliver. That is right, just a further exploration. How tricky things are in C++!"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562787745, "post_id": 56977267, "comment_id": 100491290, "body": "C++ offers many ways to shot ones&#39; self in the foot.  It makes life exciting that way ;)"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1564108218, "post_id": 56977267, "comment_id": 100930432, "body": "If you take the literal meaning of the std, pointers are trivial types, which means <code>std::launder</code> is the identity function: it&#39;s never needed!"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1564164599, "post_id": 56977267, "comment_id": 100954597, "body": "@curiousguy It&#39;s not because it&#39;s an identity function that it doesn&#39;t change how the compiler behaves. Look at <code>reinterpret_cast</code>."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1564166313, "post_id": 56977267, "comment_id": 100955257, "body": "@Fran&#231;oisAndrieux Well officially <code>reinterpret_cast</code> doesn&#39;t change &quot;how the compile behaves&quot; (regarding pointers to objects); you can only use it to store a value in another type and convert back. Anyway the std text about pointers fails completely to describe the inherent C++ language that ppl intuitively understand. That makes asking language lawyer question quite silly because the correct answer is often &quot;disregard the std text&quot; which isn&#39;t considered acceptable here (SO doesn&#39;t tolerate different viewpoint)."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 3, "last_activity_date": 1562786134, "creation_date": 1562786134, "answer_id": 56977267, "question_id": 56977042, "link": "https://stackoverflow.com/questions/56977042/reusing-objects-space-by-another-object/56977267#56977267", "title": "reusing object&#39;s space by another object", "body": "<p>When you do</p>\n\n<pre><code>f();\n</code></pre>\n\n<p>in a member function what you are really doing is</p>\n\n<pre><code>this-&gt;f();\n</code></pre>\n\n<p>So in the example when they do </p>\n\n<pre><code>new (this) D2; \n</code></pre>\n\n<p>it ends the lifetime of the thing pointer to by <code>this</code> and creates a new <code>D2</code> in it's place.  That makes you think that <code>this-&gt;f();</code> is okay since <code>this</code> now points to an object that has had it's lifetime started but you are forgetting that <code>this</code> is a pointer to an object that has had it's lifetime ended.  You can't use it to refer to the new object that you made.</p>\n\n<p>In order to be able to call <code>f()</code> legally what you would need to do is capture the pointer returned by <code>new</code> and use it to access the new object</p>\n\n<pre><code>void B::mutate() {\n  auto np = new (this) D2;    // reuses storage \u2014 ends the lifetime of *this\n  f();              // undefined behavior**\n  np-&gt;f()           // OK, np points to a valid object\n  ... = this;       // OK, this points to valid memory\n}\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 11358686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e9106d778ba934bacf9b3d6fd411c2?s=128&d=identicon&r=PG&f=1", "display_name": "minex", "link": "https://stackoverflow.com/users/11358686/minex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 2, "accepted_answer_id": 56977246, "answer_count": 2, "score": 3, "last_activity_date": 1564107692, "creation_date": 1562785035, "last_edit_date": 1564107692, "question_id": 56977042, "link": "https://stackoverflow.com/questions/56977042/reusing-objects-space-by-another-object", "title": "reusing object&#39;s space by another object", "body": "<p>I was looking to re-use allocated space within the base class from this pointer and C++ Standard does not approve. However, the wording of the standard seems to be wrong. It puts a condition \"and before the storage which the object occupied is reused or released\", but it is clearly reused in their own code snippet. Where I am getting it wrong?</p>\n\n<pre><code>void B::mutate() {\n  new (this) D2;    // reuses storage \u2014 ends the lifetime of *this!! REUSED AS WELL SO CONDITION SO RESTRICTIONS DON'T HOLD ANYMORE!\n  f();              // undefined behavior\n</code></pre>\n\n<blockquote>\n  <p>Before the lifetime of an object has started but after the storage which the object will occupy has been allocated41 or, after the lifetime of an object has ended and before the storage which the object occupied is reused or released, any pointer that represents the address of the storage location where the object will be or was located may be used but only in limited ways. For an object under construction or destruction, see [class.cdtor]. Otherwise, such a pointer refers to allocated storage ([basic.stc.dynamic.deallocation]), and using the pointer as if the pointer were of type void*, is well-defined. Indirection through such a pointer is permitted but the resulting lvalue may only be used in limited ways, as described below. The program has undefined behavior if:</p>\n  \n  <p>(6.1)\n      the object will be or was of a class type with a non-trivial destructor and the pointer is used as the operand of a delete-expression,</p>\n  \n  <p>(6.2)\n      the pointer is used to access a non-static data member or call a non-static member function of the object, or</p>\n  \n  <p>(6.3)\n      the pointer is implicitly converted ([conv.ptr]) to a pointer to a virtual base class, or</p>\n  \n  <p>(6.4)\n      the pointer is used as the operand of a static_\u00adcast, except when the conversion is to pointer to cv void, or to pointer to cv void and subsequently to pointer to cv char, cv unsigned char, or cv std\u200b::\u200bbyte ([cstddef.syn]), or</p>\n  \n  <p>(6.5)\n      the pointer is used as the operand of a dynamic_\u00adcast.</p>\n  \n  <p>[\u2009Example:</p>\n\n<pre><code>    #include &lt;cstdlib&gt;\n    struct B {\n      virtual void f();\n      void mutate();\n      virtual ~B();\n    };\n\n    struct D1 : B { void f(); };\n    struct D2 : B { void f(); };\n\n   /* RELEVANT PART STARTS */ void B::mutate() {\n      new (this) D2;    // reuses storage \u2014 ends the lifetime of *this\n      f();              // undefined behavior \n      /* RELEVANT PART ENDS */\n      ... = this;       // OK, this points to valid memory\n    }\n\n   void g() {\n      void* p = std::malloc(sizeof(D1) + sizeof(D2));\n      B* pb = new (p) D1;\n      pb-&gt;mutate();\n      *pb;              // OK: pb points to valid memory\n      void* q = pb;     // OK: pb points to valid memory\n      pb-&gt;f();          // undefined behavior, lifetime of *pb has ended\n    }\n</code></pre>\n</blockquote>\n"}, {"tags": ["c++", "opencv", "neural-network"], "answers": [{"tags": [], "owner": {"reputation": 107, "user_id": 1277317, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/66ad3ec63d1945982d2983942799cad1?s=128&d=identicon&r=PG", "display_name": "user1277317", "link": "https://stackoverflow.com/users/1277317/user1277317"}, "is_accepted": false, "score": 0, "last_activity_date": 1562881160, "creation_date": 1562881160, "answer_id": 56997633, "question_id": 56976977, "link": "https://stackoverflow.com/questions/56976977/how-to-use-cnn-in-opencv-via-c/56997633#56997633", "title": "How to use CNN in openCV via C++?", "body": "<p>In openCV almost all functions are designed to work with 3D matrices. So the easiest way for me to work with CV_32F 4D matrices is to work with them directly. The following code works correctly and quickly:</p>\n\n<pre><code>Net net = readNet(\"e://xor.pb\");\n\nconst int sizes[] = {1,1,60,162};\nMat tenz = Mat::zeros(4, sizes, CV_32F);\n\n\nfloat* dataB=(float*)tenz.data;\n\nint x=1;\nint y=2;\ndataB[y*tenz.size[2]+x]=0.5f;\n\nx=1;\ny=3;\ndataB[y*tenz.size[2]+x]=1.0f;\n\n\ntry\n{\n    net.setInput(tenz , \"input_layer_my_input_1\");\n\n    Mat prob = net.forward(\"output_layer_my/MatMul\");\n}\ncatch( cv::Exception&amp; e )\n{\n    const char* err_msg = e.what();\n    qDebug()&lt;&lt;\"err_msg\"&lt;&lt;err_msg;\n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 1277317, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/66ad3ec63d1945982d2983942799cad1?s=128&d=identicon&r=PG", "display_name": "user1277317", "link": "https://stackoverflow.com/users/1277317/user1277317"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562881160, "creation_date": 1562784754, "question_id": 56976977, "link": "https://stackoverflow.com/questions/56976977/how-to-use-cnn-in-opencv-via-c", "title": "How to use CNN in openCV via C++?", "body": "<p>Here <a href=\"https://stackoverflow.com/a/49817506/1277317\">https://stackoverflow.com/a/49817506/1277317</a>\nthere is an example of how to use a convolution network in OpenCV. But this example is in Python.\nHow to do the same in C++? \nNamely, how to do this in C++: </p>\n\n<pre><code>net = cv.dnn.readNetFromTensorflow('model.pb')\nnet.setInput(inp.transpose(0, 3, 1, 2))\ncv_out = net.forward()\n</code></pre>\n\n<p>?</p>\n\n<p>And how to create Mat for the setInput function for an image size: 60x162x1? I use float for the data just like in the python example.\nNow I have this code and it gives incorrect results:</p>\n\n<pre><code>Net net = readNet(\"e://xor.pb\");\n\nfloat x0[60][162];\n\nfor(int i=0;i&lt;60;i++)\n{\n    for(int j=0;j&lt;162;j++)\n    {\n        x0[i][j]=0;\n    }\n}\nx0[5][59]=0.5;\nx0[5][60]=1;\nx0[5][61]=1;\nx0[5][62]=0.5;\n\nMat aaa = cv::Mat(60,162, CV_32F, x0);\n\nMat inputBlob = dnn::blobFromImage(aaa, 1.0, Size(60,162));\n\nnet.setInput(inputBlob , \"conv2d_input\");\n\nMat prob = net.forward(\"activation_2/Softmax\");\n\nfor(int i=0;i&lt;prob.cols;i++)\n{\n    qDebug()&lt;&lt;i&lt;&lt;prob.at&lt;float&gt;(0,i);\n}\n</code></pre>\n"}, {"tags": ["c++", "winapi", "combobox", "mfc", "gdi"], "comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1562786742, "post_id": 56976947, "comment_id": 100490902, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10031621/cbs-dropdownlist-combo-fails-to-respond-to-wm-ctlcolor-under-windows-ux-themi\">CBS_DROPDOWNLIST combo fails to respond to WM_CTLCOLOR... under Windows UX theming</a>"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1562787358, "post_id": 56976947, "comment_id": 100491128, "body": "You can change the colour of the text and background by making the combobox owner draw.  I know no way to change the colour of the arrow."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1562867408, "post_id": 56976947, "comment_id": 100523844, "body": "I think you have the names mixed up. Dropdown is the one with edit box, it won&#39;t work this method. Droplist has no edit box and it should work, provided you have the old 3-D look. The attached image shows modern UI look, so in that case neither listbox will show any change unless they are ownerdraw."}], "answers": [{"comments": [{"owner": {"reputation": 552, "user_id": 7828978, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e231594bf369281e7b5c93eee08186cc?s=128&d=identicon&r=PG&f=1", "display_name": "Emile", "link": "https://stackoverflow.com/users/7828978/emile"}, "edited": false, "score": 0, "creation_date": 1562852290, "post_id": 56982546, "comment_id": 100515713, "body": "But this ComboBox is the DropDown Style ?"}], "tags": [], "owner": {"reputation": 1670, "user_id": 7341904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3fly.jpg?s=128&g=1", "display_name": "Santosh Dhanawade", "link": "https://stackoverflow.com/users/7341904/santosh-dhanawade"}, "is_accepted": false, "score": 0, "last_activity_date": 1563179471, "last_edit_date": 1563179471, "creation_date": 1562825175, "answer_id": 56982546, "question_id": 56976947, "link": "https://stackoverflow.com/questions/56976947/ccombobox-how-to-change-the-color-of-the-static-with-drop-list-style/56982546#56982546", "title": "CComboBox - How to change the color of the static with Drop List Style", "body": "<p>Don't know arrow color can be changed or not but, color of combobox can be changed. With help of <code>OnChildNotify()</code> function, you can retrieve child <code>HDC</code> and then particular child <code>HDC</code> can be changed.</p>\n\n<pre><code>/////////////////////////////////////////////////////////////////////////////\n// CMyComboBox message handlers\n\nBOOL CMyComboBox::OnChildNotify(UINT message, WPARAM wParam, LPARAM lParam, LRESULT* pLResult) \n{\n    // TODO: Add your specialized code here and/or call the base class\n\n    if(WM_CTLCOLOREDIT != message)\n        return CComboBox::OnChildNotify(message, wParam, lParam, pLResult);\n\n    HDC hdcChild = (HDC)wParam;\n    if(NULL != hdcChild)\n    {\n        SetBkMode(hdcChild, TRANSPARENT);\n        SetTextColor(hdcChild, RGB(255, 255, 0));\n        SetBkColor(hdcChild, RGB(255, 0, 0));\n        *pLResult = (LRESULT)(m_Brush.GetSafeHandle());\n    }\n\n    return TRUE;\n//  return CComboBox::OnChildNotify(message, wParam, lParam, pLResult);\n}\n</code></pre>\n\n<p>Result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5SpFY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5SpFY.png\" alt=\"Result\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 381, "user_id": 11737733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPKyG.jpg?s=128&g=1", "display_name": "Jeffreys", "link": "https://stackoverflow.com/users/11737733/jeffreys"}, "is_accepted": false, "score": 0, "last_activity_date": 1562925765, "creation_date": 1562925765, "answer_id": 57004731, "question_id": 56976947, "link": "https://stackoverflow.com/questions/56976947/ccombobox-how-to-change-the-color-of-the-static-with-drop-list-style/57004731#57004731", "title": "CComboBox - How to change the color of the static with Drop List Style", "body": "<p>There are two ways - easy and hard. The hard way is to complete DrawItem with ownerdraw to handle all the cases. The easy way is to put two combos on top of each other in your dialog resource and hide the one you're not going to use.\nMaybe <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/05339d2a-982c-4324-953a-38b3f54754f2/owner-draw-comboxbox-with-cbsdropdownlist-style-does-not-retain-aero-style?forum=vcgeneral\" rel=\"nofollow noreferrer\">this</a> can give you some ideas.</p>\n"}], "owner": {"reputation": 552, "user_id": 7828978, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e231594bf369281e7b5c93eee08186cc?s=128&d=identicon&r=PG&f=1", "display_name": "Emile", "link": "https://stackoverflow.com/users/7828978/emile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 674, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563179471, "creation_date": 1562784646, "last_edit_date": 1562847649, "question_id": 56976947, "link": "https://stackoverflow.com/questions/56976947/ccombobox-how-to-change-the-color-of-the-static-with-drop-list-style", "title": "CComboBox - How to change the color of the static with Drop List Style", "body": "<p>I want to know if it's possible to change the color of the text (and of the small arrow) and the background of the static in a <code>CCombobox</code> with the <code>Drop List</code> style.</p>\n\n<p>My class is derived from <code>CComboBox</code> and I've tried with the function <code>CtlColor</code> and <code>OnCtlColor</code>, but nothing seems to change the color of the ComboBox.</p>\n\n<p>Here's a picture of the control with the Drop List style : </p>\n\n<p><a href=\"https://i.stack.imgur.com/ZeuaM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZeuaM.png\" alt=\"ComboBoxDropList\"></a></p>\n\n<p>I would like the text and the arrow to change to <code>RGB(0, 255, 255)</code> and the background to <code>RGB(255,255,0)</code>.</p>\n\n<p>Here's my function <code>CtlColor()</code> :</p>\n\n<pre><code>HBRUSH CColoredComboBox::CtlColor(CDC *pDC, UINT nCtlColor)\n{\n    if (nCtlColor == CTLCOLOR_STATIC || nCtlColor == CTLCOLOR_EDIT) \n    {\n        pDC-&gt;SetBkColor(RGB(255,255,0));\n        pDC-&gt;SetTextColor(RGB(0, 255, 255));\n    }\n    return m_brBkgnd;\n}\n</code></pre>\n\n<p>It works for the style Dropdown, but not for the Drop List.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "struct", "linked-list", "initialization", "singly-linked-list"], "comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 5, "creation_date": 1562783626, "post_id": 56976675, "comment_id": 100489591, "body": "Have you stepped through your program in a debugger, examining the values of relevant variables and how they change at each step? If not, you should do that. Debugging is an essential programmer skill."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1562784179, "post_id": 56976675, "comment_id": 100489857, "body": "Side note: not sure <code>Node *head = a;</code> behaves the way you think it does. Not 100% sure on that, though."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1562784296, "post_id": 56976675, "comment_id": 100489911, "body": "Changing <code>a</code> later on will not magically change <code>head</code> which contains garbage. You need to assign the first Node to head"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1562784324, "post_id": 56976675, "comment_id": 100489918, "body": "If your lists are not the same length, not checking for <code>nullptr</code> before doing <code>first = first-&gt;next;         second = second-&gt;next;</code> could result in a crash."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 2, "creation_date": 1562784412, "post_id": 56976675, "comment_id": 100489954, "body": "@Chipster The check is the loop condition."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1562784524, "post_id": 56976675, "comment_id": 100489992, "body": "@eerorika sigh. Missed that that would check it for null. Thanks."}, {"owner": {"reputation": 1212, "user_id": 1587755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6bfa53480be2aca93ac528eda21a7d3?s=128&d=identicon&r=PG", "display_name": "Taekahn", "link": "https://stackoverflow.com/users/1587755/taekahn"}, "edited": false, "score": 1, "creation_date": 1562785768, "post_id": 56976675, "comment_id": 100490493, "body": "Also, as I think Stroustrup put it, teachers need to stop teaching C and teach C++"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1562791280, "post_id": 56976675, "comment_id": 100492682, "body": "&quot;<i>What mistake am I making?</i>&quot; - implementing a linked list by hand, instead of using the standard <code>std::list</code> or <code>std::forward_list</code> class."}], "answers": [{"tags": [], "owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "is_accepted": false, "score": 6, "last_activity_date": 1562783743, "creation_date": 1562783743, "answer_id": 56976751, "question_id": 56976675, "link": "https://stackoverflow.com/questions/56976675/why-am-i-getting-segmentation-fault-while-implementing-linked-list/56976751#56976751", "title": "Why am I getting segmentation fault while implementing linked list?", "body": "<ol>\n<li><code>a</code> is uninitialized. You must not use <code>a</code> until you assign a value</li>\n<li>you never again assign to <code>head</code>, so it could never be anything else.</li>\n</ol>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1562784668, "post_id": 56976909, "comment_id": 100490048, "body": "1. I actually thought that too, but it&#39;s wrong. See my conversation on the original question."}, {"owner": {"reputation": 1135, "user_id": 10829805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWjzQ.jpg?s=128&g=1", "display_name": "Faruk Hossain", "link": "https://stackoverflow.com/users/10829805/faruk-hossain"}, "edited": false, "score": 0, "creation_date": 1562784873, "post_id": 56976909, "comment_id": 100490126, "body": "I started writing this before your comment. That&#39;s why I didn&#39;t notice it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 1, "creation_date": 1562784929, "post_id": 56976909, "comment_id": 100490155, "body": "That makes sense."}], "tags": [], "owner": {"reputation": 1135, "user_id": 10829805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWjzQ.jpg?s=128&g=1", "display_name": "Faruk Hossain", "link": "https://stackoverflow.com/users/10829805/faruk-hossain"}, "is_accepted": false, "score": 0, "last_activity_date": 1562784484, "creation_date": 1562784484, "answer_id": 56976909, "question_id": 56976675, "link": "https://stackoverflow.com/questions/56976675/why-am-i-getting-segmentation-fault-while-implementing-linked-list/56976909#56976909", "title": "Why am I getting segmentation fault while implementing linked list?", "body": "<p>You may get segmentation fault for various reasons here.</p>\n\n<ol>\n<li>If <code>first</code> or <code>second</code> is <em>NULL</em> then you will get segmentation fault. So make sure that if these two nodes are not <em>NULL</em>.</li>\n<li>You didn't <strong>initialize</strong> a. So initialize it first.</li>\n</ol>\n\n<p>And as you want <code>head</code> variable should contain starting node of the answer list so you need to assign node whenever you get start of the list.</p>\n\n<p>Just add this line after <code>a = new Node((ans%10)+bor);</code></p>\n\n<pre><code>if(head == NULL) head = a;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": true, "score": 1, "last_activity_date": 1562784506, "creation_date": 1562784506, "answer_id": 56976913, "question_id": 56976675, "link": "https://stackoverflow.com/questions/56976675/why-am-i-getting-segmentation-fault-while-implementing-linked-list/56976913#56976913", "title": "Why am I getting segmentation fault while implementing linked list?", "body": "<p>It's not the allocation, it's the pointer use that is all wrong.</p>\n\n<p>Here's how it should look. This code maintains a variable <code>last</code> which is the last node added to the list. You need this variable so you can at the end of the list. You were obviously trying to do this yourself, but got the logic wrong.</p>\n\n<pre><code>Node* addTwoLists(Node* first, Node* second) {\n    Node *last = NULL;\n    Node *head = NULL;\n    int bor = 0;\n    while(first-&gt;next &amp;&amp; second-&gt;next) {\n        int ans = first-&gt;data + second-&gt;data;\n        Node* a = new Node((ans%10)+bor);\n        if (head == NULL) {\n            head = last = a; // first node, update head and end of list\n        }\n        else {\n            last-&gt;next = a; // add a to the end of the list\n            last = a;       // update the end of the list\n        }\n        bor = ans/10;\n        first = first-&gt;next;\n        second = second-&gt;next;\n    }\n    return head;\n}\n</code></pre>\n\n<p>Untested code.</p>\n"}, {"comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1562784715, "post_id": 56976915, "comment_id": 100490062, "body": "Two star code! Correct but maybe a bit tricky for someone who doesn&#39;t understand ordinary pointers?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1562785447, "post_id": 56976915, "comment_id": 100490372, "body": "@john I prefer three star cognac.:)"}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1562851367, "last_edit_date": 1562851367, "creation_date": 1562784520, "answer_id": 56976915, "question_id": 56976675, "link": "https://stackoverflow.com/questions/56976675/why-am-i-getting-segmentation-fault-while-implementing-linked-list/56976915#56976915", "title": "Why am I getting segmentation fault while implementing linked list?", "body": "<p>For starters the variable <code>head</code> has indeterminate value and is not changed in the function.</p>\n\n<pre><code>Node *a;\nNode *head = a;\n</code></pre>\n\n<p>Changing the variable <code>a</code> does not mean changing of the value of the expression <code>a-&gt;next</code>.</p>\n\n<pre><code>// ...\na = new Node((ans%10)+bor);\n//...\na=a-&gt;next;\n</code></pre>\n\n<p>The function can be written the following way (without testing)</p>\n\n<pre><code>Node * addTwoLists( const Node *first, const Node *second ) \n{\n    const int Base = 10;\n\n    Node *head = nullptr;\n\n    int bor = 0;\n\n    Node **current = &amp;head;\n\n    for ( ; first != nullptr &amp;&amp; second != nullptr; first = first-&gt;next, second = second-&gt;next )\n    { \n        int sum = first-&gt;data + second-&gt;data + bor;\n        *current = new Node( sum % Base );\n        bor = sum / Base;\n        current = &amp;( *current )-&gt;next;\n    }\n\n    if ( bor )\n    {\n        *current = new Node( bor );\n    }\n\n    return head;\n}\n</code></pre>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct Node \n{\n    explicit Node( int data, Node *next = nullptr ) : data( data ), next( next )\n    {\n    }\n\n    int data;\n    Node *next;\n};\n\nvoid push_front( Node **head, int x )\n{\n    *head = new Node( x, *head );\n}\n\nNode * addTwoLists( const Node *first, const Node *second ) \n{\n    const int Base = 10;\n\n    Node *head = nullptr;\n\n    int bor = 0;\n\n    Node **current = &amp;head;\n\n    for ( ; first != nullptr &amp;&amp; second != nullptr; first = first-&gt;next, second = second-&gt;next )\n    { \n        int sum = first-&gt;data + second-&gt;data + bor;\n        *current = new Node( sum % Base );\n        bor = sum / Base;\n        current = &amp;( *current )-&gt;next;\n    }\n\n    if ( bor )\n    {\n        *current = new Node( bor );\n    }\n\n    return head;\n}\n\nstd::ostream &amp; display_list( const Node *head, std::ostream &amp;os = std::cout )\n{\n    for ( ; head != nullptr; head = head-&gt;next )\n    {\n        os &lt;&lt; head-&gt;data &lt;&lt; ' ';\n    }\n\n    return os;\n}\n\nint main()\n{\n    const int N = 10;\n    Node *list1 = nullptr;\n    Node *list2 = nullptr;\n\n    for ( int i = 1; i &lt; N; i++ ) push_front( &amp;list1, i );\n    for ( int i = N; --i != 0; ) push_front( &amp;list2, i );\n\n    display_list( list1 ) &lt;&lt; '\\n';\n    display_list( list2 ) &lt;&lt; '\\n';\n\n    Node *list3 = addTwoLists( list1, list2 );\n\n    display_list( list3 ) &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>9 8 7 6 5 4 3 2 1 \n1 2 3 4 5 6 7 8 9 \n0 1 1 1 1 1 1 1 1 1     \n</code></pre>\n"}], "owner": {"reputation": 394, "user_id": 9375838, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q5BLQlVHBB4/AAAAAAAAAAI/AAAAAAAAV60/vSRFTK8vziY/photo.jpg?sz=128", "display_name": "Leena Bhandari", "link": "https://stackoverflow.com/users/9375838/leena-bhandari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 56976913, "answer_count": 4, "score": -1, "last_activity_date": 1562851367, "creation_date": 1562783432, "last_edit_date": 1562785689, "question_id": 56976675, "link": "https://stackoverflow.com/questions/56976675/why-am-i-getting-segmentation-fault-while-implementing-linked-list", "title": "Why am I getting segmentation fault while implementing linked list?", "body": "<p>In this function, I get segmentation fault. I think it has something to do with memory allocation.  What mistake am I making?</p>\n\n<p>Now, if I initialize Node* a =NULL, i get my head pointer as NULL in the end.</p>\n\n<pre><code>struct Node {\n    int data;\n    struct Node* next;\n    Node(int x) {\n        data = x;\n        next = NULL;\n    }\n};\n\nNode* addTwoLists(Node* first, Node* second) {\n    // Code here\n    Node *a;\n    Node *head = a;\n    int bor = 0;\n    while(first-&gt;next &amp;&amp; second-&gt;next) {\n        int ans = first-&gt;data + second-&gt;data;\n        a = new Node((ans%10)+bor);\n        bor = ans/10;\n        a=a-&gt;next;\n        first = first-&gt;next;\n        second = second-&gt;next;\n    }\n    return head;\n}\n</code></pre>\n"}, {"tags": ["c++", "recursion", "mergesort"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 2, "creation_date": 1562783474, "post_id": 56976645, "comment_id": 100489535, "body": "<code>int left_arr[mid];</code> is not standard C++ unless <code>mid</code> is a constant expression. This may or may not be part of the problem, but you should not be using the non-standard language extension."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562784802, "post_id": 56976645, "comment_id": 100490098, "body": "<code>int length_left = sizeof(left_arr)&#47;sizeof(left_arr[0])</code> is a bug. At least is standard <code>c++</code>. <code>sizeof(left_arr)</code> is the size of a pointer not the size of an array."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1562784917, "post_id": 56976645, "comment_id": 100490149, "body": "@OP You know that <b>all</b> of the bugs found so far could have been prevented if you used <code>std::vector</code> and its facilities, such as the <code>at()</code> call to determine boundary access issues.  Even the <code>sizeof</code> bug mentioned is prevented by using <code>size()</code>.  These are the reasons why the VLA syntax is bad for your health.  It hides errors, and worse it causes errors if the number of entries is very high (stack overflow)."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1562785796, "post_id": 56976645, "comment_id": 100490507, "body": "<code>#include&lt;bits&#47;stdc++.h&gt;</code> <a href=\"https://stackoverflow.com/questions/31816095/why-should-i-not-include-bits-stdc-h\">loads the gun</a>. <code>using namespace std;</code> <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\">takes the safety off</a>. Be really careful."}], "answers": [{"comments": [{"owner": {"reputation": 98, "user_id": 11766468, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309869462433270/picture?type=large", "display_name": "Harshal Sharma", "link": "https://stackoverflow.com/users/11766468/harshal-sharma"}, "edited": false, "score": 0, "creation_date": 1562784521, "post_id": 56976784, "comment_id": 100489989, "body": "Please take a look at <b>conquer</b> function as well. I&#39;m getting <b>1 0 2 0 1 8 3</b>   as my final output after sorting."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 98, "user_id": 11766468, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309869462433270/picture?type=large", "display_name": "Harshal Sharma", "link": "https://stackoverflow.com/users/11766468/harshal-sharma"}, "edited": false, "score": 0, "creation_date": 1562785045, "post_id": 56976784, "comment_id": 100490210, "body": "@HarshalSharma This code is incorrect <code>int length_left = sizeof(left_arr)&#47;sizeof(left_arr[0]);</code> because <code>left_arr</code> is a pointer not an array. So <code>sizeof(left_arr)</code> is 4 (or 8 on a 64-bit system). It&#39;s not the size of the original array. Arrays are rubbish in C++, you should really be using vectors, but if you must use arrays then you should learn properly what they can and cannot do."}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1562783877, "creation_date": 1562783877, "answer_id": 56976784, "question_id": 56976645, "link": "https://stackoverflow.com/questions/56976645/recursion-misbehaving-in-merge-sort/56976784#56976784", "title": "Recursion misbehaving in merge sort", "body": "<p>It's a simple array access out of bounds error (and therefore undefined behaviour).</p>\n\n<pre><code>for(int j=mid;j&lt;n;j++)\n    right_arr[j] = arr[j];\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>for(int j=mid;j&lt;n;j++)\n    right_arr[j-mid] = arr[j];\n</code></pre>\n\n<p>Also, as already pointed out in the comments, you are using variable length arrays (VLAs) which are not legal C++.</p>\n"}, {"tags": [], "owner": {"reputation": 163, "user_id": 9756816, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LDOnjOWGcwU/AAAAAAAAAAI/AAAAAAAAAac/POirRczlo8M/photo.jpg?sz=128", "display_name": "era s&#39;q", "link": "https://stackoverflow.com/users/9756816/era-sq"}, "is_accepted": true, "score": 1, "last_activity_date": 1562786048, "creation_date": 1562786048, "answer_id": 56977245, "question_id": 56976645, "link": "https://stackoverflow.com/questions/56976645/recursion-misbehaving-in-merge-sort/56977245#56977245", "title": "Recursion misbehaving in merge sort", "body": "<p>Do,</p>\n\n<pre><code>    for(int j=mid;j&lt;n;j++)\n    right_arr[j-mid] = arr[j];\n</code></pre>\n\n<p>And pass the size of whole array</p>\n\n<pre><code>   conquer(left_arr,right_arr,arr,n);\n</code></pre>\n\n<p>In conquer function,</p>\n\n<pre><code>    int length_left = n/2;\n    int length_right = n-length_left;\n</code></pre>\n\n<p>as you cannot find the length of array from its pointer.     </p>\n"}], "owner": {"reputation": 98, "user_id": 11766468, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309869462433270/picture?type=large", "display_name": "Harshal Sharma", "link": "https://stackoverflow.com/users/11766468/harshal-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56977245, "answer_count": 2, "score": 1, "last_activity_date": 1562786048, "creation_date": 1562783326, "last_edit_date": 1562784420, "question_id": 56976645, "link": "https://stackoverflow.com/questions/56976645/recursion-misbehaving-in-merge-sort", "title": "Recursion misbehaving in merge sort", "body": "<p>The second recursion in my program is passing a weird array and then the entire process is getting ruined.\nI pass an array and its size which is then divided into two arrays <strong>left_arr</strong> and <strong>right_arr</strong>. We continue the above process for the left array until it hits the base condition. There is a similar question where the program is passing high, low values and making changes on the same array.\nI want to know why my code is giving abrupt output. Ignore the conquer function as I was unable to check that due to the error occurred before approaching it.</p>\n\n<p>I tried debugging my code by printing both original, left and right array but unable to find the error.<br>\nOk, My first doubt is that the program is creating a new array every time,i.e pass by value?\nAnd, How do I debug such issues?</p>\n\n<pre><code>#include&lt;bits/stdc++.h&gt;\n\nusing namespace std;\n\n\n int conquer(int left_arr[],int right_arr[], int arr[]){\n    int i=0,j=0,k=0;\n    int length_left = sizeof(left_arr)/sizeof(left_arr[0]);\n    int length_right = sizeof(right_arr)/sizeof(right_arr[0]);\n\n                                               //int l = length_left + \n length_right;\n\n  while(i&lt;length_left &amp;&amp; j&lt;length_right)\n  {\n      if(left_arr[i]&lt;=right_arr[j])\n      {\n          arr[k++] = left_arr[i++];\n      }\n      else\n      {\n          arr[k++] = right_arr[j++];\n      }\n  }\n  while(i&lt;length_left)\n  {\n      arr[k++] = left_arr[i++];\n  }\n\n  while(j&lt;length_right)\n  {\n      arr[k++] = right_arr[j++];\n  }\n\n\n                                                  for(int i=0; i&lt;l;i++)\n                                                  cout&lt;&lt;arr[i]&lt;&lt;\" \";\n                                                    cout&lt;&lt;endl;\nreturn 0;\n}\n\nint divide(int *arr,int n)\n{\n\n if(n&lt;2)\n  return 0;\n\n\n\n\n  int mid=n/2;\n  int x = n-mid;\n\n  cout&lt;&lt;\"  n =\"&lt;&lt;n&lt;&lt;\"  mid =\"&lt;&lt;mid&lt;&lt;endl;\n\n  int left_arr[mid];\n  int right_arr[n-mid];             //for debug\n                                    cout&lt;&lt;\"arr:\";\n                                    for(int m=0;m&lt;n;m++)\n                                        cout&lt;&lt;arr[m]&lt;&lt;\"  \";\n                                    cout&lt;&lt;endl;\n\n\n  for(int i=0;i&lt;mid;i++)\n      left_arr[i]=arr[i];          //for debug\n                                   cout&lt;&lt;\"Larr:\";\n                                   for(int k=0;k&lt;mid;k++)\n                                    cout&lt;&lt;left_arr[k]&lt;&lt;\" \";\n\n                                    cout&lt;&lt;endl;\n\n\n\n  for(int j=mid;j&lt;n;j++)\n      right_arr[j] = arr[j];\n                                cout&lt;&lt;\"Rarr:\";      //for debug\n                                for(int j=mid;j&lt;n;j++)\n                                    cout&lt;&lt;right_arr[j]&lt;&lt;\" \";\n\n                                    cout&lt;&lt;endl&lt;&lt;endl;\n\n\n   divide(left_arr,mid);\n   divide(right_arr,x);\n\n   //conquer(left_arr,right_arr,arr);\n\n\n  return 0;\n}\n\n\nint main()\n{\n  int n,arr[]={2,5,4,6,1,8,3};\n\n\n  divide(arr,7);\n\n  for(int i=0;i&lt;7;i++)\n  {\n      cout&lt;&lt;arr[i]&lt;&lt;\" \";\n  }\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>n =7  mid =3\n  arr:2  5  4  6  1  8  3\n  Larr:2 5 4\n  Rarr:6 1 8 3</p>\n  \n  <p>n =3  mid =1\n  arr:2  5  4\n  Larr:2\n  Rarr:5 4</p>\n  \n  <p>n =2  mid =1    arr:7536080  5\n  Larr:7536080\n  Rarr:5  //error from here</p>\n  \n  <p>n =4  mid =2\n  arr:-1  0  4200483  6\n  Larr:-1 0\n  Rarr:4200483 6</p>\n  \n  <p>n =2  mid =1\n  arr:-1  0\n  Larr:-1\n  Rarr:0</p>\n  \n  <p>n =2  mid =1\n  arr:7536080  5\n  Larr:7536080\n  Rarr:5</p>\n</blockquote>\n"}, {"tags": ["c++", "matlab", "mex", "address-sanitizer"], "comments": [{"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1562784050, "post_id": 56976550, "comment_id": 100489782, "body": "Are you using a shared object asan library, or linking it statically? <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizerAsDso\" rel=\"nofollow noreferrer\">github.com/google/sanitizers/wiki/AddressSanitizerAsDso</a>"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1562784168, "post_id": 56976550, "comment_id": 100489852, "body": "Also, if you use <code>g++</code> or <code>clang++</code> to compile, you should be using <code>CXXFLAGS</code>, not <code>CFLAGS</code>."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1562784209, "post_id": 56976550, "comment_id": 100489876, "body": "@CrisLuengo I believe it&#39;s the static. I did &quot;sudo dnf install libasan libasan-static&quot;. Also had to do &quot;sudo yum install libasan&quot;"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 1, "creation_date": 1562784323, "post_id": 56976550, "comment_id": 100489917, "body": "Try <code>ldd mexfile.mexa64</code>. It will report which shared object libraries are linked to. It will tell you it cannot find the MATLAB libraries (ignore that), pay attention to libasan: is it looking for it? If yes, then you&#39;re using the dynamic version. If not, you&#39;re using a static version."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1562784552, "post_id": 56976550, "comment_id": 100490003, "body": "@CrisLuengo Then it looks like I&#39;m using the static. I don&#39;t see anything about libasan. Should I be using the dynamic instead? If so, how wouldI switch?"}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1562786213, "post_id": 56976550, "comment_id": 100490680, "body": "@CrisLuengo I&#39;m starting to follow I think. So the static version only works if the executable itself is linked with it. Since MATLAB is not, it won&#39;t work. To do so dynamically...I&#39;d have to uninstall ASAN, get the source, re-build it with the appropriate flag (<code>DCOMPILER_RT_BUILD_SHARED_ASAN=ON</code>), and then re-build my project linking against that...somehow. Does that seem about right?"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 1, "creation_date": 1562786436, "post_id": 56976550, "comment_id": 100490770, "body": "GCC uses the dynamic libasan by default, you could try using <code>g++</code> to compile."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1562786964, "post_id": 56976550, "comment_id": 100490977, "body": "@CrisLuengo Huh. Yeah, that seems to work. Though now I get <code>ASan runtime does not come first in initial library list; you should either link runtime to your application or manually preload it with LD_PRELOAD</code>. I&#39;ll give a shot at seeing if I can fix that. Thanks for the help."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1562787052, "post_id": 56976550, "comment_id": 100491013, "body": "Yes, you need to preload it as described in the link I posted earlier. But <code>matlab</code> is a script, not an executable. You might want to make a local copy of it and include the <code>LD_PRELOAD</code> thing in that script."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1562788271, "post_id": 56976550, "comment_id": 100491529, "body": "@CrisLuengo So when I call <code>matlab</code> in a linux terminal, it&#39;s calling a script? That&#39;s where I need to put LD_PRELOAD? Where is that script located, and what is it called?"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 1, "creation_date": 1562788358, "post_id": 56976550, "comment_id": 100491555, "body": "<code>which matlab</code> will tell you where it is. You could copy it to <code>matlab_asan</code> and modify it to add the <code>LD_PRELOAD</code> command."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1562859565, "post_id": 56976550, "comment_id": 100520126, "body": "@CrisLuengo It turns out that I could just call those &quot;LD_PRELOAD&quot; commands in the terminal rather than editing the MATLAB script. (which I tried, it was very difficult). In any case, sadly, it turned up 0 errors the moment after the actual MATLAB script started. When MATLAB was starting up there were many, but it seems the script and my MEX files are clean."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1562860425, "post_id": 56976550, "comment_id": 100520588, "body": "If you do <code>export LD_PRELOAD=...</code> in the terminal, then for <b>every</b> program started from that terminal after this library will be preloaded. Usually one does <code>LD_PRELOAD=... matlab</code>, so that the variable is only set for the one executable. But this will not work (I think) for <code>matlab</code> because it&#39;s a script. This is why I suggested you edit the script. In any case, I&#39;m glad you got it to work."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1562863792, "post_id": 56976550, "comment_id": 100522155, "body": "@CrisLuengo Does that only apply for the lifetime of that terminal? In other words, if I close that terminal and launch another, LD_PRELOAD is effectively gone, isn&#39;t it? If not, then yeah, that&#39;s not pretty."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 1, "creation_date": 1562864244, "post_id": 56976550, "comment_id": 100522370, "body": "Yes, it&#39;s the current shell, so not terrible, just something to be aware of. If you close the terminal you exit the shell and its environment variables will be lost."}], "answers": [{"comments": [{"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562787684, "post_id": 56977451, "comment_id": 100491262, "body": "That question for Python seems to suggest it can be made to target just the shared library and not the executable using it. I still don&#39;t completely follow though, where exactly is LD_PRELOAD used? Is it in the <code>MAKEFILE</code> of my project somewhere? I found the path to GCC&#39;s libasan.so, so I&#39;m ready once I figure out LD_PRELOAD"}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 1, "creation_date": 1562820648, "post_id": 56977451, "comment_id": 100499005, "body": "&quot;where exactly is LD_PRELOAD used&quot; - you need to <code>export LD_PRELOAD=path&#47;to&#47;libasan.so.N</code> before you run MATLAB executable."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 1, "creation_date": 1562820822, "post_id": 56977451, "comment_id": 100499032, "body": "&quot;it can be made to target just the shared library and not the executable using it&quot; - <code>libasan</code> works by intercepting many standard libc functions in executable and all loaded shlibs (<code>memset</code>, <code>malloc</code>, etc.). This may cause it to detect errors in these libs. I&#39;ve added a hint in the answer on how to get past those errors (it&#39;s the MEX-file you are interested in after all, not other code)."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562856507, "post_id": 56977451, "comment_id": 100518345, "body": "Thanks for the clarification. When I attempt this, I get tons of errors after calling <code>matlab</code> in the terminal. I get: <code>ERROR: ld.so: object &#39;&#47;usr&#47;lib&#47;gcc&#47;x86_64-redhat-linux&#47;8&#47;libasan.so&#39; from LD_PRELOAD cannot be preloaded (file too short): ignored.</code> And when I run MATLAB again and try, I get the same error from before, it doesn&#39;t come first in the initial library list, you should use LD_PRELOAD."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562857971, "post_id": 56977451, "comment_id": 100519197, "body": "Nevermind, apparently I had the path wrong. Mine is located in /lib64/libasan.so.5 It seems to be working...though it only showed errors up to the point where the MATLAB script really started. At that point, no more errors of any kind showed up. I&#39;m not really buying that neither the matlab script nor <i>any</i> of the massive Mex file usage had any errors, but I could be wrong."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562860851, "post_id": 56977451, "comment_id": 100520817, "body": "@TylerShellberg Congrats, that was surprisingly smooth. You can try injecting a trivial memory overflow into your Mex to check if it works (be sure to inspect generated assembler, GCC tends to optimize out really trivial overflows)."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562861044, "post_id": 56977451, "comment_id": 100520932, "body": "@TylerShellberg I suspect that part of the problem is that MATLAB uses it&#39;s own memory management with blackja^W GC and pools. You might succeed with manual memory poisoning (see <a href=\"https://blog.fuzzing-project.org/65-When-your-Memory-Allocator-hides-Security-Bugs.html\" rel=\"nofollow noreferrer\">this post on custom allocators</a> and <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizerManualPoisoning\" rel=\"nofollow noreferrer\">this one on manual poisoning APIs</a>)."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 1, "creation_date": 1562861223, "post_id": 56977451, "comment_id": 100521026, "body": "@TylerShellberg And another guess is that MATLAB redirects stderr from Mex (in that case <code>export ASAN_OPTIONS=log_path=XXX</code> would help)."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562868082, "post_id": 56977451, "comment_id": 100524135, "body": "When I attempt to use <code>export ASAN_OPTIONS</code> the result is &quot;We could not determine the path of the MATLAB root directory&quot;. Very odd."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 1, "creation_date": 1562868414, "post_id": 56977451, "comment_id": 100524269, "body": "@TylerShellberg You&#39;ll need to combine both options: <code>export ASAN_OPTIONS=halt_on_error=false:log_path=...</code>"}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562868770, "post_id": 56977451, "comment_id": 100524417, "body": "That seems to still cause the problem. I&#39;m just setting the log_path to the ./asanlog.txt."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562869726, "post_id": 56977451, "comment_id": 100524798, "body": "@TylerShellberg The error message says that <code>matlab</code> wrapper script failed to locate the MATLAB proper (it does this via some awk magic). I suspect there&#39;s a problem with using <code>.</code> in log_path, try using absolute dir. If that does not help you&#39;ll have to debug the script (e.g. via <code>sh -x</code>)."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562942869, "post_id": 56977451, "comment_id": 100551404, "body": "Tested with absolute path, it works perfect now. However, the resulting logs are the same, it seems to stop once the actual MATLAB script starts. So either something&#39;s wrong, or there&#39;s no issue in the script or my code."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562943599, "post_id": 56977451, "comment_id": 100551813, "body": "@TylerShellberg I&#39;d try inserting deliberate memory error into your code (with caveats outlined above). If it&#39;s detected, your unchanged code is indeed ok."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562945363, "post_id": 56977451, "comment_id": 100552763, "body": "Thanks, I&#39;ll try that. As a sidenote, I&#39;m having a weird issue. I removed the flags from my makefile for <code>fsanitize=address</code>, make clean, make and replaced the old files...but MATLAB is now warning me about an undefined symbol <code>asan_option_detect_stack_use_after_return</code>. Why? I completely removed any mention of ASAN from my makefile and rebuilt. :("}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562948596, "post_id": 56977451, "comment_id": 100554278, "body": "@TylerShellberg Looks like something somewhere hasn&#39;t been recompiled or reinstalled..."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562948812, "post_id": 56977451, "comment_id": 100554352, "body": "By the way, when I try to use @ in the comments, it just isn&#39;t working for me. Sometimes it does, but rarely. As for the rest, I don&#39;t know what to do. I think I somehow permanently broke my MATLAB, or maybe something in the OS itself. I&#39;ve quadruple checked and re-built it and re-moved the files a dozen times, nothing works. I checked the environment variables, there&#39;s nothing odd there."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562950093, "post_id": 56977451, "comment_id": 100554852, "body": "I completely uninstalled libasan. Somehow, it&#39;s still showing up in the symbol table of my built mex files. I hate this."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562950798, "post_id": 56977451, "comment_id": 100555105, "body": "@TylerShellberg I&#39;m afraid I don&#39;t have an explanation. There&#39;s nothing magical about <code>-fsanitize=address</code>, it just links shlib with a runtime library. I can&#39;t imagine how it could damage your MATLAB installation..."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562950861, "post_id": 56977451, "comment_id": 100555127, "body": "&quot;By the way, when I try to use @ in the comments&quot; - SO will not let you use it when it&#39;s redundant."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1562950873, "post_id": 56977451, "comment_id": 100555131, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/196387/discussion-between-yugr-and-tyler-shellberg\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "is_accepted": true, "score": 3, "last_activity_date": 1562821574, "last_edit_date": 1562821574, "creation_date": 1562787039, "answer_id": 56977451, "question_id": 56976550, "link": "https://stackoverflow.com/questions/56976550/can-mex-files-be-run-with-fsanitize-address/56977451#56977451", "title": "Can MEX files be run with -fsanitize=address?", "body": "<p>Sanitized libraries (MEX-files are shared libraries) expect <code>libasan.so</code> to be either linked to main executable (in that case MATLAB) or <code>LD_PRELOAD</code>ed at start. As you can't rebuild MATLAB, the second approach is your only chance.</p>\n\n<p>It might not work smoothly because Asan would likely find memory issues in MATLAB startup code and abort before it gets to your MEX-file. You can use <code>export ASAN_OPTIONS=halt_on_error=false</code> to ignore those errors (they'll still be reported but at least execution will continue).</p>\n\n<p>As a side note, your issue is similar to other questions about running sanitized binary plugins in unsanitized interpreters (see e.g. <a href=\"https://stackoverflow.com/questions/55692357/address-sanitizer-on-a-python-extension\">similar question for Python</a>, although that one is Clang-centric).</p>\n"}], "owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 56977451, "answer_count": 1, "score": 4, "last_activity_date": 1562859438, "creation_date": 1562782887, "last_edit_date": 1562859438, "question_id": 56976550, "link": "https://stackoverflow.com/questions/56976550/can-mex-files-be-run-with-fsanitize-address", "title": "Can MEX files be run with -fsanitize=address?", "body": "<p>I have a MEX file compiled normally with g++.</p>\n\n<p>I recently changed its compilation to use clang++, and included <code>-fsanitize=address</code> into both the <code>LDFLAGS</code> and <code>CFLAGS</code> (note: no CXX flags exist for this project). </p>\n\n<p>However, despite this, once I get to MATLAB and attempt to call the MEX file, I get:</p>\n\n<p><code>Invalid MEX-file '(path to mex file)': undefined symbol: __asan_option_detect_stack_use_after_return.</code></p>\n\n<p>That specific error is really common when people mess up linking in the address sanitizer correctly. However, in <em>literally every file I'm compiling</em> it's linked in. Every .o, every .mexa64. </p>\n\n<p>I suspect this is because MATLAB itself isn't capable of that, but I'm unsure. Some guidance from other MEX developers would be fantastic. </p>\n\n<p><strong>Full steps I used for anyone who needs this:</strong></p>\n\n<p>1: Install libasan (for me it was \"yum install libasan\", but it might vary)</p>\n\n<p>2: Add <code>-fsanitize=address</code> to the LDFLAGs and CFLAGs of the makefile building the MEX files and object files for my project.</p>\n\n<p>3: Make clean and make to ensure it has the library included (I built with g++, apparently clang defaults to the STATIC version of libasan, which won't work in situations like this where the running executable isn't actually compiled with libasan)</p>\n\n<p>4: In a terminal, do:</p>\n\n<p><code>export LD_PRELOAD=/lib64/libasan.so.5</code> (this location varies though. I found out how to locate it using this post: <a href=\"https://stackoverflow.com/questions/48833176/get-location-of-libasan-from-gcc-clang\">Get location of libasan from gcc/clang</a>)</p>\n\n<p>Then do:</p>\n\n<p><code>export ASAN_OPTIONS=halt_on_error=false</code></p>\n\n<p>5: Finally, call MATLAB:</p>\n\n<p><code>matlab -nojvm -nodesktop -nosplash</code></p>\n\n<p>6: Then (and this might be specific to my project) I CD'd into the directory where the MATLAB project was, did <code>addpath(genpath('.'))</code> to add all its files, and finally called the actual MATLAB script that does the work.</p>\n\n<p>The result was errors in green and red, like:</p>\n\n<p>Address 0x(some address) is located in stack of thread T(thread number)\nSUMMARY: AddressSanitizer: memcpy-param-overlap (libasan.so.5+(some number))\nor\nERROR: AddressSanitizer: memcpy-param-overlap: memory ranges [range] and [range] overlap</p>\n"}, {"tags": ["c++", "pointers", "scope", "reference"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562781982, "post_id": 56976305, "comment_id": 100488825, "body": "What is the signature of <code>Get&lt;FlashcardContext&gt;()</code>? On a side note, <code>::std</code> looks extremely weird."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1562782255, "post_id": 56976305, "comment_id": 100488964, "body": "Your posted code looks ok to me."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1562784586, "last_edit_date": 1562784586, "creation_date": 1562784099, "answer_id": 56976831, "question_id": 56976305, "link": "https://stackoverflow.com/questions/56976305/not-sure-why-object-is-local-vs-reference/56976831#56976831", "title": "not sure why object is local vs reference", "body": "<p>The <code>value_type</code> of a <code>std::unordered_map</code> is <code>std::pair&lt;const Key, T&gt;</code>. Notice the <code>const</code>?  It is missing in your declarations.</p>\n\n<p>In your case, the <code>*iterator</code> returns a <code>std::pair&lt;const int64, Flashcard&gt;&amp;</code>, which you are then saving to a <code>std::pair&lt;int64, Flashcard&gt;&amp;</code>, so the compiler has to make a <em>temporary</em> <code>std::pair</code> object that is local to <code>GetRandomFlashcard()</code>, which you then <code>return</code> a reference to.  That is what the compiler is warning you about.</p>\n\n<p>You need to update your declarations of <code>std::pair</code> to include the <code>const</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>const ::std::pair&lt;const int64, Flashcard&gt;&amp; GetCardHandler::GetRandomFlashcard()\n{\n    const ::std::unordered_map&lt;int64, Flashcard&gt;&amp; flashcards_ = Get&lt;FlashcardContext&gt;()-&gt;GetFlashcardMap();\n\n    const ::std::pair&lt;const int64, Flashcard&gt;&amp; entry = *( std::next(std::begin(flashcards_), rand_between(0, flashcards_.size()) ) );\n    // alternatively:\n    // const ::std::unordered_map&lt;int64, Flashcard&gt;::value_type&amp; entry = ...;\n\n    return entry;\n}\n</code></pre>\n\n<p>Though, you really should make use of <code>auto</code> to simplify your declarations:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// pre-C++14\nconst ::std::pair&lt;const int64, Flashcard&gt;&amp; GetCardHandler::GetRandomFlashcard()\n{\n    const auto &amp;flashcards_ = Get&lt;FlashcardContext&gt;()-&gt;GetFlashcardMap();\n    const auto &amp;entry = *( std::next(std::begin(flashcards_), rand_between(0, flashcards_.size()) ) );\n    return entry;\n}\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// C++14 and later\nconst auto &amp; GetCardHandler::GetRandomFlashcard()\n{\n    const auto &amp;flashcards_ = Get&lt;FlashcardContext&gt;()-&gt;GetFlashcardMap();\n    const auto &amp;entry = *( std::next(std::begin(flashcards_), rand_between(0, flashcards_.size()) ) );\n    return entry;\n}\n</code></pre>\n\n<p>Or, at least use some <code>using</code> statements to simplify your usage of templates:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>using FlashcardMap = ::std::unordered_map&lt;int64, Flashcard&gt;;\nusing FlashcardMapEntry = FlashcardMap::value_type;\n\n...\n\nconst FlashcardMap&amp; GetFlashcardMap();\n...\nFlashcardMap flashcards_ GUARDED_BY(lock_);\n\n...\n\nconst FlashcardMapEntry&amp; GetCardHandler::GetRandomFlashcard()\n{\n    const FlashcardMap&amp; flashcards_ = Get&lt;FlashcardContext&gt;()-&gt;GetFlashcardMap();\n    const FlashcardMapEntry&amp; entry = *( std::next(std::begin(flashcards_), rand_between(0, flashcards_.size()) ) );\n    return entry;\n}\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 4335969, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/100001539977379/picture?type=large", "display_name": "Shi Zhang", "link": "https://stackoverflow.com/users/4335969/shi-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56976831, "answer_count": 1, "score": 0, "last_activity_date": 1562784586, "creation_date": 1562781820, "question_id": 56976305, "link": "https://stackoverflow.com/questions/56976305/not-sure-why-object-is-local-vs-reference", "title": "not sure why object is local vs reference", "body": "<p>I am pretty sure I'm retrieving a reference to a <code>Flashcard</code> object that is in scope but IDE is telling me that <code>entry</code> is a local object..</p>\n\n<pre><code>const ::std::pair&lt;int64, Flashcard&gt;&amp; GetCardHandler::GetRandomFlashcard() {\n  const ::std::unordered_map&lt;int64, Flashcard&gt;&amp; flashcards_ = Get&lt;FlashcardContext&gt;()-&gt;GetFlashcardMap();\n  const ::std::pair&lt;int64, Flashcard&gt;&amp; entry  = *( std::next(std::begin(flashcards_), rand_between(0, flashcards_.size()) ) ); ;\n  return entry;\n}\n</code></pre>\n\n<p>More context (from <code>FlashcardContext</code> class)...</p>\n\n<pre><code>const ::std::unordered_map&lt;int64, Flashcard&gt;&amp; GetFlashcardMap();\n...\nstd::unordered_map&lt;int64, Flashcard&gt; flashcards_ GUARDED_BY(lock_);\n</code></pre>\n\n<p><code>Flashcard</code>s in this map are persistent due to internal framework.</p>\n"}, {"tags": ["c++", "sfml", "tiled", "tmx"], "comments": [{"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1562783016, "post_id": 56976167, "comment_id": 100489344, "body": "Would it be easier to change the tilesheet to remove those spaces?  There are a number of reasons why it&#39;s standard practice to keep all tiles in a sheet as compact as possible (including ease of processing, as you have found)."}, {"owner": {"reputation": 3, "user_id": 10117171, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Nh_ia_IQZo8/AAAAAAAAAAI/AAAAAAAAAX8/8EECqQQ2sek/photo.jpg?sz=128", "display_name": "Wiz", "link": "https://stackoverflow.com/users/10117171/wiz"}, "reply_to_user": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1562784107, "post_id": 56976167, "comment_id": 100489810, "body": "You are right, i managed to find a python script for gimp and used it to remove all the spaces, everything works perfectly now!"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 10117171, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Nh_ia_IQZo8/AAAAAAAAAAI/AAAAAAAAAX8/8EECqQQ2sek/photo.jpg?sz=128", "display_name": "Wiz", "link": "https://stackoverflow.com/users/10117171/wiz"}, "is_accepted": false, "score": 0, "last_activity_date": 1562784167, "creation_date": 1562784167, "answer_id": 56976847, "question_id": 56976167, "link": "https://stackoverflow.com/questions/56976167/how-to-account-for-spacing-between-tiles-in-a-tile-sheet/56976847#56976847", "title": "How to account for spacing between tiles in a tile sheet", "body": "<p>Removing the spaces with a python script i found and gimp fixed the problem, however if anyone knows how to account for the spacing feel free to answer as i might need it someday</p>\n"}], "owner": {"reputation": 3, "user_id": 10117171, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Nh_ia_IQZo8/AAAAAAAAAAI/AAAAAAAAAX8/8EECqQQ2sek/photo.jpg?sz=128", "display_name": "Wiz", "link": "https://stackoverflow.com/users/10117171/wiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562784167, "creation_date": 1562781236, "last_edit_date": 1562782449, "question_id": 56976167, "link": "https://stackoverflow.com/questions/56976167/how-to-account-for-spacing-between-tiles-in-a-tile-sheet", "title": "How to account for spacing between tiles in a tile sheet", "body": "<p>My tile-sheet has tiles that are 64x64, however between each tile there is a 10px gap and i need to account for that gap when setting the texture rectangle in the image in order to draw that tile</p>\n\n<p>I tried simply adding the space upon setting the texture rectangle but the image still looks distorted</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>for (auto y = 0u; y &lt; map.getTileCount().y; ++y)\n            {\n                for (auto x = 0u; x &lt; map.getTileCount().x; ++x)\n                {\n                    auto posX = static_cast&lt;float&gt;(x * map.getTileSize().x); \n                    auto posY = static_cast&lt;float&gt;(y * map.getTileSize().y);\n                    sf::Vector2f position(posX, posY);\n\n                    tileSprite.setPosition(position); \n\n                    auto tileID = tiles[y * map.getTileCount().x + x].ID; //the id of the current tile\n\n                    if (tileID == 0)\n                    {\n                        continue; //empty tile\n                    }\n\n                    auto i = 0;\n                    while (tileID &lt; tileSets[i].getFirstGID())\n                    {\n                        ++i;\n                    }\n\n                    auto relativeID = tileID - tileSets[i].getFirstGID(); \n\n                    auto tileX = relativeID % tileSets[i].getColumnCount();\n                    auto tileY = relativeID / tileSets[i].getColumnCount();\n\n                    textureRect.left = tileX * tileSets[i].getTileSize().x; //i am guessing this is where\n                    // i should account for the spacing \n                    textureRect.top = tileY * tileSets[i].getTileSize().y;\n\n                    tileSprite.setTexture(mTextureHolder.get(Textures::SpriteSheet));\n                    tileSprite.setTextureRect(textureRect);\n\n                    mMapTexture.draw(tileSprite);\n                }\n            }\n</code></pre>\n\n<p>The code itself is working and its drawing the tiles in the correct sizes, if i use a normal 64x64 tileset without any spacing the final image looks right however with spacing included the tiles are cut out.\nHow do i add the gap between the tiles when setting the texture rectangle?</p>\n\n<p><a href=\"https://i.stack.imgur.com/En9fa.png\" rel=\"nofollow noreferrer\">this is how it looks:</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/GOcyY.png\" rel=\"nofollow noreferrer\">this is how it should look:</a></p>\n\n<p>(NOTE: The \"how it should look\" image is from the Tiled editor )</p>\n"}, {"tags": ["c++", "templates", "c++17"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1562781448, "post_id": 56976144, "comment_id": 100488605, "body": "Maybe you are looking for a <a href=\"https://en.cppreference.com/w/cpp/language/parameter_pack\" rel=\"nofollow noreferrer\">parameter pack</a>?"}, {"owner": {"reputation": 153, "user_id": 8976784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a0508537033e1de7730459dbd3405a?s=128&d=identicon&r=PG&f=1", "display_name": "jfh", "link": "https://stackoverflow.com/users/8976784/jfh"}, "edited": false, "score": 1, "creation_date": 1562781679, "post_id": 56976144, "comment_id": 100488689, "body": "Can you tag with which version of C++ you have available?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562781889, "post_id": 56976144, "comment_id": 100488781, "body": "If you could explain the relationship between <code>raw_resource</code>, <code>owner</code> and <code>window</code> it would help. <code>get_owner</code> returns something from a <code>raw_resource*</code> that you cast to a <code>window*</code> and store in an <code>owner*</code> so it&#39;s clearly not an <code>&#242;wner*</code> already, so what is it?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562781911, "post_id": 56976144, "comment_id": 100488792, "body": "Couple options I can think of out there, but please expand on <b>convertible to appropriate function pointers</b>.  What are these appropriate function pointers?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1562782882, "post_id": 56976144, "comment_id": 100489289, "body": "It seems odd that a function named <code>get_owner</code> returns a pointer that has to be cast to a <code>window*</code> in order to be saved as an <code>owner*</code>."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562849556, "post_id": 56976144, "comment_id": 100513906, "body": "I noticed that the casting now has changed so the return value from <code>get_owner</code> is cast to an <code>owner*</code>. Still confusing. What is the relationship between these classes?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11313931"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562866611, "post_id": 56976144, "comment_id": 100523464, "body": "@TedLyngmo each <code>raw_resource</code> has exactly one <code>owner</code>, where <code>owner</code> is a wrapper around <code>raw_resource</code>. The callbacks are fed to a low level library that doesn&#39;t know about <code>owner</code>s, but only about <code>raw_resource</code>s, so they must take a <code>raw_resource*</code>, that a pointer to them (callbacks) has the appropriate type. The operations in the callbacks need to use the <code>owner</code> objects however, so they retrieve them through <code>get_owner</code>."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562866717, "post_id": 56976144, "comment_id": 100523519, "body": "I appreciate the explanation, but if you just show that relationship in code, it&#39;ll benefit everyone trying to answer. It <i>is</i> possible to answer anyway (as shown by @Sombrero and @Vlad)  but perhaps the answer will be better suited to your situation if we got the full picture."}], "answers": [{"tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": true, "score": 4, "last_activity_date": 1562781999, "creation_date": 1562781999, "answer_id": 56976349, "question_id": 56976144, "link": "https://stackoverflow.com/questions/56976144/how-to-avoid-code-duplication-in-these-functions/56976349#56976349", "title": "How to avoid code duplication in these functions?", "body": "<p>You could use a parameter pack:</p>\n\n<pre><code>template &lt;typename Func, typename... Types&gt;\nstatic void callback(raw_resource* ptr, Func func, Types... args)\n{\n    owner* instance = static_cast&lt;window*&gt;(get_owner(ptr));\n    assert(instance != nullptr);\n    (instance-&gt;*func)(args...);\n}\n</code></pre>\n\n<p>You might want to pass <code>Types</code> differently. </p>\n\n<p>Used like:</p>\n\n<pre><code>callback(someptr, &amp;owner::on_resize, width, height);\n</code></pre>\n\n<p>If you have C++17 available you could use <code>std::invoke</code> instead of the <code>-&gt;*</code> syntax.</p>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1562783046, "last_edit_date": 1562783046, "creation_date": 1562782343, "answer_id": 56976421, "question_id": 56976144, "link": "https://stackoverflow.com/questions/56976144/how-to-avoid-code-duplication-in-these-functions/56976421#56976421", "title": "How to avoid code duplication in these functions?", "body": "<p>As the number of arguments in each member function call is different then you can use the following approach</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct A\n{\n    static void swap( int *x, int *y )\n    { \n        int tmp = *x;\n        *x = *y;\n        *y = tmp;\n    }\n\n    void set( bool b )\n    {\n        this-&gt;b = b;\n    }\n\n    bool b;\n};\n\ntemplate &lt;typename ...Args&gt;\nvoid operation( A *ptr, Args ... args )\n{\n    if constexpr( sizeof...( args ) == 1 )\n    {\n        ptr-&gt;set( args... );\n    }\n    else if constexpr( sizeof...( args ) == 2 )\n    {\n        ptr-&gt;swap( args... );\n    }            \n}\n\nint main()\n{\n    A a = { false };\n\n    operation( &amp;a, true );\n\n    std::cout &lt;&lt; \"a.b = \" &lt;&lt; a.b &lt;&lt; '\\n';\n\n    int x = 10; int y = 20;\n\n    std::cout &lt;&lt; \"x = \" &lt;&lt; x &lt;&lt; \", y = \" &lt;&lt; y &lt;&lt; '\\n';\n\n    operation( &amp;a, &amp;x, &amp;y );\n\n    std::cout &lt;&lt; \"x = \" &lt;&lt; x &lt;&lt; \", y = \" &lt;&lt; y &lt;&lt; '\\n';\n}    \n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>a.b = 1\nx = 10, y = 20\nx = 20, y = 10\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11313931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 56976349, "answer_count": 2, "score": 1, "last_activity_date": 1562868773, "creation_date": 1562781136, "last_edit_date": 1562868773, "question_id": 56976144, "link": "https://stackoverflow.com/questions/56976144/how-to-avoid-code-duplication-in-these-functions", "title": "How to avoid code duplication in these functions?", "body": "<p>I tried to create a function template that would call a member function in an object, specified by the template parameter, but I failed. Now I have multiple functions that differ only very slightly:</p>\n\n<pre><code>static void resize_callback(raw_resource* ptr, int width, int height)\n{\n    owner* instance = static_cast&lt;owner*&gt;(get_owner(ptr));\n    assert(instance != nullptr);\n    instance-&gt;on_resize(width, height);\n} \nstatic void focus_callback(raw_resource* ptr, bool state)\n{\n    owner* instance = static_cast&lt;owner*&gt;(get_owner(ptr));\n    assert(instance != nullptr);\n    instance-&gt;on_focus(state);\n} \nstatic void other_callback(raw_resource* ptr, type1 arg1, type2 arg2, type3 arg3)\n{\n    owner* instance = static_cast&lt;owner*&gt;(get_owner(ptr));\n    assert(instance != nullptr);\n    instance-&gt;on_other(arg1, arg2, arg3);\n} \n...\n</code></pre>\n\n<p>Each <code>raw_resource</code> has exactly one <code>owner</code>, where <code>owner</code> is a wrapper around <code>raw_resource</code>. The callbacks are fed to a low level C library that doesn't know about <code>owner</code>s, but only about <code>raw_resource</code>s, so they must take a <code>raw_resource*</code>, that a pointer to them (callbacks) has the appropriate type. The operations in the callbacks need to use the <code>owner</code> objects however, so they retrieve them through <code>get_owner()</code>.</p>\n\n<p>How could I make a general function template out of these that would avoid code duplication? <strong>I need instantiations of this template to be convertible to appropriate function pointers</strong> that will be compatible with their current signatures, so they can be given to the low level C library.</p>\n"}, {"tags": ["c++", "assembly", "visual-c++"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1562789472, "post_id": 56975939, "comment_id": 100491969, "body": "If you are using assembly, why did you tag this as C++?"}, {"owner": {"reputation": 9, "user_id": 11664384, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--T6TPikQ9zk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfx_qiCwd_4srNgN3i4eOwe9g-FiA/mo/photo.jpg?sz=128", "display_name": "Simz Coder", "link": "https://stackoverflow.com/users/11664384/simz-coder"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1562789660, "post_id": 56975939, "comment_id": 100492039, "body": "Oh yes. Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1562790398, "creation_date": 1562790398, "answer_id": 56978157, "question_id": 56975939, "link": "https://stackoverflow.com/questions/56975939/how-do-i-limit-the-character-input-range/56978157#56978157", "title": "How do I limit the character Input range?", "body": "<p>I don't have the code in assembly, but in C the <code>get_char()</code> function you showed would need to look something more like the following:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void get_char(char&amp; a_character)\n{\n  do\n  {\n    a_character = (char) _getwche();\n    if (\n      ((a_character &gt;= '0') &amp;&amp; (a_character &lt;= '9')) ||\n      ((a_character &lt;= 'a') &amp;&amp; (a_character &lt;= 'z')) ||\n      ((a_character &lt;= 'A') &amp;&amp; (a_character &lt;= 'Z')) ||\n      (a_character == dollarchar)\n      )\n    /* alternatively:\n    if (isalnum(a_character) || (a_character == dollarchar))\n    */\n    {\n      break;\n    }\n\n    printf(\"Alphanumeric characters only, please try again &gt; \");\n  }\n  while (true);\n}\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void get_char(char&amp; a_character)\n{\n  a_character = (char) _getwche();\n  while (\n    !(\n      ((a_character &gt;= '0') &amp;&amp; (a_character &lt;= '9')) ||\n      ((a_character &lt;= 'a') &amp;&amp; (a_character &lt;= 'z')) ||\n      ((a_character &lt;= 'A') &amp;&amp; (a_character &lt;= 'Z')) ||\n      (a_character == dollarchar)\n      )\n    )\n  /* alternatively:\n  while (!isalnum(a_character) &amp;&amp; (a_character != dollarchar))\n  */\n  {\n    printf(\"Alphanumeric characters only, please try again &gt; \");\n    a_character = (char) _getwche();\n  }\n}\n</code></pre>\n\n<p>I leave it as an exercise for you to translate the C code to assembly.</p>\n"}], "owner": {"reputation": 9, "user_id": 11664384, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--T6TPikQ9zk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfx_qiCwd_4srNgN3i4eOwe9g-FiA/mo/photo.jpg?sz=128", "display_name": "Simz Coder", "link": "https://stackoverflow.com/users/11664384/simz-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562790398, "creation_date": 1562780279, "last_edit_date": 1562789698, "question_id": 56975939, "link": "https://stackoverflow.com/questions/56975939/how-do-i-limit-the-character-input-range", "title": "How do I limit the character Input range?", "body": "<p>The Problem states,</p>\n\n<blockquote>\n  <p>The get_char subroutine allows any character to be entered.  Modify get_char, using assembly, to accept ASCII characters that are within the range of '0' and 'z' inclusively only.  You will additionally need to accept '$' as a valid input (the terminating character).  If an invalid character is entered, it should keep asking for a new input until one is given, additionally displaying the error message \"Alphanumeric characters only, please try again > \".</p>\n</blockquote>\n\n<pre><code>void get_char(char&amp; a_character)\n{\n  a_character=(char) _getwche();\n  if (a_character=='0' || a_character=='z')  // allow the enter key to work as the terminating character too\n    a_character=dollarchar;\n}\n</code></pre>\n"}, {"tags": ["c++", "eclipse", "debugging", "member-variables"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11666237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52742586a7a6c4fd4b05d96000e7796?s=128&d=identicon&r=PG&f=1", "display_name": "anon12c", "link": "https://stackoverflow.com/users/11666237/anon12c"}, "is_accepted": false, "score": 0, "last_activity_date": 1562795567, "last_edit_date": 1562795567, "creation_date": 1562794163, "answer_id": 56978896, "question_id": 56975917, "link": "https://stackoverflow.com/questions/56975917/is-there-any-convinient-way-to-check-the-values-of-the-member-variables-of-a-cla/56978896#56978896", "title": "Is there any convinient way to check the values of the member variables of a class in Eclipse?", "body": "<p>After messing around a bit, I figured out the solution to this and it was stupidly simple. All I had to do was add the member object variable of my vector object that contained my class objects to the watch list. I, however, was trying to add each member variable to the watch list individually like a complete idiot.<br>\nAnyway, after putting the object titled <code>std::_Vector_base&lt;Expression, std::allocator&lt;Expression&gt; &gt;::_Vector_impl_data&lt;Expression&gt; &gt;::_Vector_impl_data</code> of the type <code>std::_Vector_base&lt;Expression, std::allocator&lt;Expression&gt; &gt;::_Vector_impl_data</code> on watch, my problem was solved. After that, all I have to do was expand this object which would now be listed in the expressions view and viola! I had all my required member variables right where I could see them.</p>\n"}], "owner": {"reputation": 11, "user_id": 11666237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52742586a7a6c4fd4b05d96000e7796?s=128&d=identicon&r=PG&f=1", "display_name": "anon12c", "link": "https://stackoverflow.com/users/11666237/anon12c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562795567, "creation_date": 1562780196, "last_edit_date": 1562781115, "question_id": 56975917, "link": "https://stackoverflow.com/questions/56975917/is-there-any-convinient-way-to-check-the-values-of-the-member-variables-of-a-cla", "title": "Is there any convinient way to check the values of the member variables of a class in Eclipse?", "body": "<p>I am writing some code that makes use of the <code>std::vector</code> class to store objects of a user-defined class. For debugging, I need to keep watch on a few particular member variables of this class. Towards this end, I went to the variables view in my debugger perspective and put the relevant member variables on watch. However, in the expressions view, I ended up with variables that looked something like this:  </p>\n\n<pre>\n((((((class std::_Vector_base >::_Vector_impl_data) ((((class std::_Vector_base >) ((baseExpression).baseExpression)))._M_impl)))._M_start))->expressionPtr)\n</pre>\n\n<p>Needless to say, this is pretty annoying to look at.</p>\n\n<p>I tried editing the names of the variables under the \"expression\" column in the expressions view, however that seemed to remove the entire variable from the watch window. For example, I would try to set the above name to simply \"expressionPtr\" only to be greeted by the following errors:</p>\n\n<pre>\nMultiple errors reported.\n\n1) Failed to execute MI command:\n-var-create - * expressionPtr\nError message from debugger back end:\n-var-create: unable to create variable object\n\n2) Unable to create variable object\n\n3) Failed to execute MI command:\n-data-evaluate-expression expressionPtr\nError message from debugger back end:\nNo symbol \"expressionPtr\" in current context.\n\n4) Failed to execute MI command:\n-var-create - * expressionPtr\nError message from debugger back end:\n-var-create: unable to create variable object\n</pre>\n\n<p>Is there a way to assign unique identifiers to member variables while debugging to make it a bit easier on the eyes? Also, since the vector class will hold an indefinite number of objects during run-time, I would also like to keep track of the member variables of each object. For example, consider the following code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Foo\n{\npublic:\n    int a_var;\n    int b_var;\n};\n\nint main ()\n{\n    Foo a;\n    Foo b;\n    //some code to work with Foo::a_var and Foo::b_var\n}\n</code></pre>\n\n<p>I would like keep track of the member variables of both <code>a</code> and <code>b</code> as and when they are allocated.\nSome help will be really appreciated. Thanks in advance!</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 1205, "user_id": 2846068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kHfXv.jpg?s=128&g=1", "display_name": "MasterAler", "link": "https://stackoverflow.com/users/2846068/masteraler"}, "edited": false, "score": 0, "creation_date": 1562791516, "post_id": 56975868, "comment_id": 100492790, "body": "Did you try <code>lay-&gt;setContentsMargins(0, 0, 0, 0);</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1562827262, "post_id": 56976829, "comment_id": 100501356, "body": "Ah yes, I didn&#39;t read this section concerning custom <code>QWidget</code>. Thanks a lot."}], "tags": [], "owner": {"reputation": 5008, "user_id": 5762796, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b3acb5c2021f4c279f29d61481b28e15?s=128&d=identicon&r=PG&f=1", "display_name": "Aleph0", "link": "https://stackoverflow.com/users/5762796/aleph0"}, "is_accepted": true, "score": 2, "last_activity_date": 1562830011, "last_edit_date": 1562830011, "creation_date": 1562784087, "answer_id": 56976829, "question_id": 56975868, "link": "https://stackoverflow.com/questions/56975868/qt-q-object-macro-causes-unexpected-behaviour-with-style-sheets/56976829#56976829", "title": "Qt Q_OBJECT macro causes unexpected behaviour with style sheets", "body": "<p>One has to read the documentation quite carefully to stumble on the right <a href=\"https://doc.qt.io/Qt-5/stylesheet-reference.html\" rel=\"nofollow noreferrer\">passage</a>.</p>\n\n<p>Your TestWidget class needs to reimplement the paintEvent: </p>\n\n<pre><code>void TestWidget::paintEvent(QPaintEvent *)\n{\n    QStyleOption opt;\n    opt.init(this);\n    QPainter p(this);\n    style()-&gt;drawPrimitive(QStyle::PE_Widget, &amp;opt, &amp;p, this);\n}\n</code></pre>\n\n<p>There is also the important note, that you have to define the Q_OBJECT macro.</p>\n\n<blockquote>\n  <p>Warning: Make sure you define the Q_OBJECT macro for your custom widget.</p>\n</blockquote>\n\n<p>I tried it and the behavior seemingly fit your needs. </p>\n\n<p>A possible explanation for the strange behavior, in case of lacking Q_OBJECT, might be, that <code>qobject_cast&lt;TestWidget*&gt;(widget)</code> would yield <code>nullptr</code>. That might result in a different behavior for the rendered stylesheet.</p>\n"}], "owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 56976829, "answer_count": 1, "score": 2, "last_activity_date": 1562830011, "creation_date": 1562780004, "question_id": 56975868, "link": "https://stackoverflow.com/questions/56975868/qt-q-object-macro-causes-unexpected-behaviour-with-style-sheets", "title": "Qt Q_OBJECT macro causes unexpected behaviour with style sheets", "body": "<p>I have written a custom Qt widget extending the <code>QWidget</code> class.</p>\n\n<p>Let's consider the following code:</p>\n\n<p><em>.h</em></p>\n\n<pre><code>#ifndef SS_TEST_H\n#define SS_TEST_H\n\n#include &lt;QMainWindow&gt;\n\nclass TestWidget : public QWidget\n{\n    Q_OBJECT // ***&gt;&gt;&gt; BUG HERE &lt;&lt;&lt;***\n\n    public:\n        TestWidget(const QString &amp; v1, const QString &amp; v2, QWidget * parent = nullptr);\n};\n\nclass TestWindow : public QMainWindow\n{\n    Q_OBJECT\n\n    public:\n        TestWindow();\n};\n\n#endif // SS_TEST_H\n\n</code></pre>\n\n<p><em>.cpp</em></p>\n\n<pre><code>#include \"ss_test.h\"\n\n#include &lt;QGridLayout&gt;\n#include &lt;QLabel&gt;\n#include &lt;QApplication&gt;\n\nTestWidget::TestWidget(const QString &amp; v1, const QString &amp; v2, QWidget * parent) : QWidget(parent)\n{\n    QGridLayout * lay = new QGridLayout;\n\n    QLabel * field = new QLabel(v1, this);\n    QLabel * value = new QLabel(v2, this);\n    value-&gt;setMinimumWidth(80);\n    value-&gt;setAlignment(Qt::AlignCenter);\n    value-&gt;setStyleSheet(\"QLabel { background-color: white; border: 1px solid silver; }\");\n\n    lay-&gt;addWidget(field, 0, 0);\n    lay-&gt;addWidget(value, 0, 1);\n\n    this-&gt;setLayout(lay);\n\n    this-&gt;setStyleSheet(\"QWidget { background-color: red; }\");\n}\n\nTestWindow::TestWindow()\n{\n    setWindowTitle(\"ss test\");\n    resize(400, 300);\n\n    QWidget * cw = new QWidget;\n    QVBoxLayout * cl = new QVBoxLayout;\n\n    TestWidget * tw1 = new TestWidget(\"Field 1\", \"Value 1\", this);\n    TestWidget * tw2 = new TestWidget(\"Field 2\", \"Value 2\", this);\n\n    cl-&gt;addWidget(tw1);\n    cl-&gt;addWidget(tw2);\n    cl-&gt;addStretch();\n\n    cw-&gt;setLayout(cl);\n    this-&gt;setCentralWidget(cw);\n}\n\nint main(int argc, char ** argv)\n{\n    QApplication app(argc, argv);\n\n    TestWindow tw;\n    tw.show();\n\n    return app.exec();\n}\n</code></pre>\n\n<p>The widget that I am talking about is the <code>TestWidget</code> class.</p>\n\n<p>Without the <code>Q_OBJECT</code> macro in the class declaration, I obtain exactly the style I want:\n<a href=\"https://i.stack.imgur.com/oe7Be.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oe7Be.png\" alt=\"enter image description here\"></a></p>\n\n<p>But if I add the <code>Q_OBJECT</code> macro at the beginning of the class declaration (as you can see the comments in the header file), it unexpectedly modifies the style of the widget:\n<a href=\"https://i.stack.imgur.com/7Z5RN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Z5RN.png\" alt=\"enter image description here\"></a></p>\n\n<p>I do not understand what happens here.</p>\n\n<p>Of course, in my real project, the widget is way more elaborated than it is in this minimal example and necessarily needs the <code>Q_OBJECT</code> macro (in order to use signal/slots mechanisms and <code>qobject_cast</code>).</p>\n\n<p>I would be very grateful if someone can explain me what <code>Q_OBJECT</code> does here and why.</p>\n"}, {"tags": ["c++", "templates", "inheritance", "template-specialization"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1562780118, "post_id": 56975843, "comment_id": 100488067, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file\">Why can templates only be implemented in the header file?</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562782703, "post_id": 56975843, "comment_id": 100489202, "body": "@drescherjm has probably nailed the problem, but I can&#39;t be sure enough to hammer the question shut. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 3, "user_id": 7739363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3c365f3a8527c7d84a2c58e3f59c8a8?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey Davydov", "link": "https://stackoverflow.com/users/7739363/aleksey-davydov"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562835474, "post_id": 56975843, "comment_id": 100505487, "body": "@drescherjm, that is not the solution. Now I can reformulate the problem as &quot;Why linker try to find specialization in <code>DataFormatterTemplate</code> class insted of derived <code>DataFormatterTemplatePartial</code>? I&#39;ve editted the question with small example."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7739363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3c365f3a8527c7d84a2c58e3f59c8a8?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey Davydov", "link": "https://stackoverflow.com/users/7739363/aleksey-davydov"}, "edited": false, "score": 0, "creation_date": 1562933545, "post_id": 56990669, "comment_id": 100546105, "body": "Pure virtual function does not suit me, but the default implementation is what was missing!! Thanks!"}], "tags": [], "owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "is_accepted": true, "score": 0, "last_activity_date": 1562852636, "creation_date": 1562852636, "answer_id": 56990669, "question_id": 56975843, "link": "https://stackoverflow.com/questions/56975843/non-type-template-inheritance-from-template-linking-error/56990669#56990669", "title": "Non-type template inheritance from template linking error", "body": "<p>Even though you haven't used the <code>Process()</code> method of <code>DataFormatterTemplate</code> you should give it a definition or mark it as pure virtual.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;class OutFmt&gt;\nclass DataFormatterTemplate : public DataFormatter {\npublic:\n    virtual ~DataFormatterTemplate() {};\n\n    virtual void Process() = 0;  //  &lt;- should be pure virtual function\n                                 //  Or virtual void Process() { /* default behavior */ }\n};\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7739363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3c365f3a8527c7d84a2c58e3f59c8a8?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey Davydov", "link": "https://stackoverflow.com/users/7739363/aleksey-davydov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 56990669, "answer_count": 1, "score": 0, "last_activity_date": 1562854090, "creation_date": 1562779888, "last_edit_date": 1562854090, "question_id": 56975843, "link": "https://stackoverflow.com/questions/56975843/non-type-template-inheritance-from-template-linking-error", "title": "Non-type template inheritance from template linking error", "body": "<p>I have an abstract class <code>DataFormatter</code> as some interface. I have a derived template <code>DataFormatterTemplate</code> for different types of data. Here I have overried pure virtual functions and add specialisation for <code>Process()</code> method. Now I want to use data types <code>INT</code> that can differ in length. So the idea to use one template with non-type parameters <code>INT&lt;val&gt;</code>. I want to use derived from <code>DataFormatterTemplate</code> class <code>DataFormatterTemplatePartial</code> for my special data types and now I'm trying to override <code>Process()</code> method for different <code>val</code>, but having undefined reference error. </p>\n\n<p>Whats the problem?</p>\n\n<pre><code>template&lt;unsigned val&gt;\nstruct INT {\n    int data[val];\n};\n\n/**\n * Data formatter base class\n */\nclass DataFormatter {\npublic:\n    DataFormatter() {};\n\n    virtual ~DataFormatter() {};\n\n    virtual void Process() = 0;\n};\n\ntemplate&lt;class OutFmt&gt;\nclass DataFormatterTemplate : public DataFormatter {\npublic:\n    virtual ~DataFormatterTemplate() {};\n\n    virtual void Process();\n};\n\ntemplate&lt;&gt;\nvoid\nDataFormatterTemplate&lt;int&gt;::Process() {}\n\ntemplate&lt;unsigned filNum&gt;\nclass DataFormatterTemplatePartial : public DataFormatterTemplate&lt;INT&lt;filNum&gt;&gt; {\npublic :\n    virtual void Process();\n};\n\ntemplate&lt;unsigned filNum&gt;\nvoid DataFormatterTemplatePartial&lt;filNum&gt;::Process() {\n    std::cout &lt;&lt; filNum &lt;&lt; std::endl;\n}\n\nint main() {\n    DataFormatterTemplatePartial&lt;4&gt; df;\n    DataFormatterTemplatePartial&lt;3&gt; df2;\n\n    df.Process(); \n    df2.Process();\n\n    return 0;\n}\n</code></pre>\n\n<p>Linking error:</p>\n\n<pre><code>CMakeFiles/dft_test.dir/main.cpp.o:(.data.rel.ro._ZTV21DataFormatterTemplateI3INTILj3EEE[_ZTV21DataFormatterTemplateI3INTILj3EEE]+0x20): undefined reference to `DataFormatterTemplate&lt;INT&lt;3u&gt; &gt;::Process()'\n\nCMakeFiles/dft_test.dir/main.cpp.o:(.data.rel.ro._ZTV21DataFormatterTemplateI3INTILj4EEE[_ZTV21DataFormatterTemplateI3INTILj4EEE]+0x20): undefined reference to `DataFormatterTemplate&lt;INT&lt;4u&gt; &gt;::Process()'\n</code></pre>\n\n<p>As you can see linker trying to find <code>Process()</code> specialization in base class, but don't want to use derived.</p>\n"}, {"tags": ["c++", "vector", "char", "uint32"], "comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1562780252, "post_id": 56975837, "comment_id": 100488123, "body": "cast the int to a char* (NOT a vector) then set char-pointer-to-my-int[0] ... [3]"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 1830899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k06CD.jpg?s=128&g=1", "display_name": "user1830899", "link": "https://stackoverflow.com/users/1830899/user1830899"}, "edited": false, "score": 0, "creation_date": 1564608155, "post_id": 56977076, "comment_id": 101091911, "body": "Thanks! This helped me out and got me going!"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1562785187, "creation_date": 1562785187, "answer_id": 56977076, "question_id": 56975837, "link": "https://stackoverflow.com/questions/56975837/concatenation-of-vector-elements-into-one-32-bit-word/56977076#56977076", "title": "Concatenation of vector elements into one 32-bit word", "body": "<p>What you are looking for is <strong>bit shifting</strong> and <strong>bitwise OR</strong>, eg:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::vector&lt;uint8_t&gt; v;\n// fill v with 4 bytes as needed...\nuint32_t i = (uint32_t(v[X1]) &lt;&lt; 24) | (uint32_t(v[X2]) &lt;&lt; 16) | (uint32_t(v[X3]) &lt;&lt; 8) | uint32_t(v[X4]);\n</code></pre>\n\n<p>Where <code>X1..X4</code> are the desired byte indexes in the vector, depending on which endian you want to use for the <code>uint32_t</code>.</p>\n\n<p>Alternatively, if the vector elements are already in the correct byte order for the endian you want the <code>uint32_t</code> to be in, you can just <code>memcpy()</code> the bytes as-is:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::vector&lt;uint8_t&gt; v;\n// fill v with 4 bytes as needed...\nuint32_t i;\nstd::memcpy(&amp;i, v.data(), 4);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 1830899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k06CD.jpg?s=128&g=1", "display_name": "user1830899", "link": "https://stackoverflow.com/users/1830899/user1830899"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56977076, "answer_count": 1, "score": 0, "last_activity_date": 1562785187, "creation_date": 1562779860, "question_id": 56975837, "link": "https://stackoverflow.com/questions/56975837/concatenation-of-vector-elements-into-one-32-bit-word", "title": "Concatenation of vector elements into one 32-bit word", "body": "<p>I am trying to concatenate a vector of four elements into a 4-byte word to represent as an uint32_t. </p>\n\n<p>Sorry, I don't have my code, but this is what I am trying to do:</p>\n\n<p>vector v; // each element is a byte, with four elements \nv[0], v[1], v[2], v[3] \nconcatenate these four elements to form a word (I guess a char[32]?) [0][1][2][3] to use as a uint32_t. </p>\n\n<p>I have tried changing v[0,1,2,3] to strings then appending the strings using loops but for whatever reason, the end results was adding erroneous bits. </p>\n\n<p>Thank you so much for the help everyone! </p>\n"}, {"tags": ["c++", "lua"], "comments": [{"owner": {"reputation": 9718, "user_id": 1424244, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8d370542399af1afe3202ed1fc1ab88?s=128&d=identicon&r=PG", "display_name": "IS4", "link": "https://stackoverflow.com/users/1424244/is4"}, "edited": false, "score": 0, "creation_date": 1562839263, "post_id": 56975700, "comment_id": 100507770, "body": "You use <code>0</code> as an index. That is not a part of the sequence."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 10580287, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UuQktFTacq0/AAAAAAAAAAI/AAAAAAAAAqk/eHHwtOBEeaE/photo.jpg?sz=128", "display_name": "selim anac", "link": "https://stackoverflow.com/users/10580287/selim-anac"}, "is_accepted": false, "score": 0, "last_activity_date": 1562784707, "last_edit_date": 1562784707, "creation_date": 1562780905, "answer_id": 56976091, "question_id": 56975700, "link": "https://stackoverflow.com/questions/56975700/passing-2d-table-from-lua-to-c/56976091#56976091", "title": "Passing 2D table from Lua to C++", "body": "<p>I found this: <a href=\"https://stackoverflow.com/questions/44920971/iterating-a-multidimensional-lua-table-in-c\">Iterating a multidimensional Lua Table in C</a></p>\n\n<p>It works. But if there is a better solution I really want to learn. I prefer to use for-loop with size, but <code>lua_rawlen</code> always return 1.</p>\n"}], "owner": {"reputation": 41, "user_id": 10580287, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UuQktFTacq0/AAAAAAAAAAI/AAAAAAAAAqk/eHHwtOBEeaE/photo.jpg?sz=128", "display_name": "selim anac", "link": "https://stackoverflow.com/users/10580287/selim-anac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1562784707, "creation_date": 1562779202, "last_edit_date": 1562779545, "question_id": 56975700, "link": "https://stackoverflow.com/questions/56975700/passing-2d-table-from-lua-to-c", "title": "Passing 2D table from Lua to C++", "body": "<p>I was searching for hours to pass a 2d table from Lua to C++. Lua docs are really sucks.</p>\n\n<p>I have this table on <strong>Lua 5.1</strong> and I want to pass it to c++</p>\n\n<pre><code>local costs = {\n[0] = {\n    1.0,\n    1.0,\n    1.0,\n    1.0,\n    1.41,\n    1.41,\n    1.41,\n    1.41,\n},\n[1] = {\n    2.0,\n    2.0,\n    2.0,\n    2.0,\n    2.41,\n    2.41,\n    2.41,\n    2.41,\n}\n</code></pre>\n\n<p>}</p>\n\n<p>This works with simple, one dimensional table but I can't even get the keys with it</p>\n\n<pre><code>int len = lua_rawlen(L, 1);\nfor (int i = 0; i &lt; len; i++)\n{\n  lua_pushinteger(L, i + 1);\n  lua_gettable(L, -2);\n  printf(\"Key %i\\n\", lua_tointeger(L, -1));\n  lua_pop(L, 1);\n}\n</code></pre>\n\n<p>How can I get this table properly?</p>\n"}, {"tags": ["c++", "googletest"], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 11535226, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R_-orOcgd3Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdo6DQ7RGaNqsXE0iKpAf9IjX9vLw/mo/photo.jpg?sz=128", "display_name": "Weiyu He", "link": "https://stackoverflow.com/users/11535226/weiyu-he"}, "is_accepted": false, "score": 0, "last_activity_date": 1562858891, "creation_date": 1562858891, "answer_id": 56992664, "question_id": 56975631, "link": "https://stackoverflow.com/questions/56975631/gtest-failed-when-catkin-make-run-tests-undefined-reference/56992664#56992664", "title": "Gtest failed when catkin_make run_tests. Undefined Reference", "body": "<p>I have figured out the issue. The source of the answer is here:\n<a href=\"https://answers.ros.org/question/223005/cmake-error-trying-to-link-target-to-libraries/\" rel=\"nofollow noreferrer\">enter link description here</a></p>\n\n<p>Basically, in my CMakerList.txt, I need to <code>add_library(visual_robot src/visual_robot.cpp)</code> \nand link it with my test file by using <code>target_link_libraries(visual_testnode visual_robot ${catkin_LIBRARIES})</code></p>\n"}], "owner": {"reputation": 73, "user_id": 11535226, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R_-orOcgd3Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdo6DQ7RGaNqsXE0iKpAf9IjX9vLw/mo/photo.jpg?sz=128", "display_name": "Weiyu He", "link": "https://stackoverflow.com/users/11535226/weiyu-he"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562858891, "creation_date": 1562778900, "last_edit_date": 1562783242, "question_id": 56975631, "link": "https://stackoverflow.com/questions/56975631/gtest-failed-when-catkin-make-run-tests-undefined-reference", "title": "Gtest failed when catkin_make run_tests. Undefined Reference", "body": "<p>Somehow my <code>catkin_make</code> successfully executed but run_test failed. I have confirmed that I added my test script and my code as executable in CMakeList.txt and linked them using <code>target_link_libraries</code>. However, I keep getting the error when running <code>Catkin_make run_tests</code>:</p>\n\n<pre><code>undefined reference to `VisualRobot::VisualRobot(std::shared_ptr&lt;moveit::core::RobotModel&gt;)'\n</code></pre>\n\n<p>Here is my test code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;moveit_visual_tools/moveit_visual_tools.h&gt;\n#include &lt;visualization_msgs/Marker.h&gt;\n#include &lt;eigen_conversions/eigen_msg.h&gt;\n#include &lt;tf/transform_datatypes.h&gt;\n#include &lt;cmath&gt;\n#include \"gtest/gtest.h\"\n#include \"visual_robot.h\"\n\nclass Checksweep : public testing::Test{\npublic: \n\n  virtual void SetUp() {\n    // ...\n    robot_model_loader::RobotModelLoader robot_model_loader(\"robot_description\");\n    robot_model::RobotModelPtr kinematic_model = robot_model_loader.getModel();\n    visual = new VisualRobot(kinematic_model);\n  }\n\n  virtual void TearDown() { delete visual; }\n\n  VisualRobot * visual;\n  ros::NodeHandle nh;\n\n};\n\nTEST_F(Checksweep, TestnJoint)\n{\n  EXPECT_GT(visual-&gt;nJoints, 0); //nJoints is a public variable in VisualRobot class.\n}\n\nint main(int argc, char **argv){\n  testing::InitGoogleTest(&amp;argc, argv);\n  ros::init(argc, argv, \"my_testnode\");\n  return RUN_ALL_TESTS();\n}\n</code></pre>\n\n<p>And my visual_robot.h:</p>\n\n<pre><code>#ifndef _VISUAL_ROBOT\n#define _VISUAL_ROBOT\n\nclass VisualRobot{\npublic:\n    VisualRobot( robot_model::RobotModelPtr kinematic_model);\n    void make_function();\n\n\n    robot_model::RobotModelPtr kinematic_model;\n    int nJoints;\n\nprivate:\n    ros::NodeHandle nh;\n    ros::Publisher marker_pub;\n\n};\n\n#endif\n</code></pre>\n\n<p>In my understanding, I thought I already defined an instant of Visual Robot in my test code's line <code>VisualRobot * visual</code></p>\n\n<p>Edit 1: Also, it seems like the error occurs in my test code's line: </p>\n\n<pre><code>visual = new VisualRobot(kinematic_model);\n</code></pre>\n\n<p>Edit 2: Added part of my CMakeList.txt:</p>\n\n<pre><code>add_executable(visual_robot src/visual_robot.cpp)\ntarget_link_libraries(visual_robot ${catkin_LIBRARIES} ${Boost_LIBRARIES})\n\nif(CATKIN_ENABLE_TESTING)\n\n  find_package(rostest REQUIRED)\n  add_rostest_gtest(visual_testnode launch/visual.launch src/visual_test.cpp )\n  target_link_libraries(visual_testnode ${catkin_LIBRARIES} )\n  set(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -g -O0 --coverage\")\nendif()\n</code></pre>\n"}, {"tags": ["c++", "c++11", "language-lawyer", "std", "stdvector"], "comments": [{"owner": {"reputation": 846, "user_id": 7511460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cz0P7.png?s=128&g=1", "display_name": "Adrien Givry", "link": "https://stackoverflow.com/users/7511460/adrien-givry"}, "edited": false, "score": 0, "creation_date": 1562778753, "post_id": 56975491, "comment_id": 100487434, "body": "I think the problem resides in the fact that parent isn&#39;t really an incomplete type because you explicitly defined it."}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "reply_to_user": {"reputation": 846, "user_id": 7511460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cz0P7.png?s=128&g=1", "display_name": "Adrien Givry", "link": "https://stackoverflow.com/users/7511460/adrien-givry"}, "edited": false, "score": 2, "creation_date": 1562778773, "post_id": 56975491, "comment_id": 100487443, "body": "@AdrienGivry Yes it is incomplete while defining the <code>child</code> class"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1562778840, "post_id": 56975491, "comment_id": 100487476, "body": "C++11 needs complete; C++17 however: <i>&quot;This container (but not its members) can be instantiated with an incomplete element type if the allocator satisfies the allocator completeness requirements.&quot;</i> see <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/vector</a>  Please add the standard version to the question/"}, {"owner": {"reputation": 846, "user_id": 7511460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cz0P7.png?s=128&g=1", "display_name": "Adrien Givry", "link": "https://stackoverflow.com/users/7511460/adrien-givry"}, "edited": false, "score": 0, "creation_date": 1562778889, "post_id": 56975491, "comment_id": 100487505, "body": "<code>parent</code> needs to be complete to instantiate your <code>std::vector&lt;parent&gt;</code>, which is done when you instanciate a <code>child</code>. If you don&#39;t instanciate a <code>child</code>, your code will compile. If you instantiate a child somewhere, make sure that <code>parent</code> is completly defined at this point."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 846, "user_id": 7511460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cz0P7.png?s=128&g=1", "display_name": "Adrien Givry", "link": "https://stackoverflow.com/users/7511460/adrien-givry"}, "edited": false, "score": 2, "creation_date": 1562779035, "post_id": 56975491, "comment_id": 100487576, "body": "@AdrienGivry You can, it seems, instantiate a <code>child</code> before defining <code>parent</code>, see: <a href=\"https://wandbox.org/permlink/kk6xHNV8Fo4Fdu87\" rel=\"nofollow noreferrer\">wandbox.org/permlink/kk6xHNV8Fo4Fdu87</a>"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 846, "user_id": 7511460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cz0P7.png?s=128&g=1", "display_name": "Adrien Givry", "link": "https://stackoverflow.com/users/7511460/adrien-givry"}, "edited": false, "score": 0, "creation_date": 1562779172, "post_id": 56975491, "comment_id": 100487635, "body": "@AdrienGivry I think you mean that <code>parent</code> must be fully defined before instantiating one?"}, {"owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1562779236, "post_id": 56975491, "comment_id": 100487676, "body": "@RichardCritten At the moment I don&#39;t really care about the difference between c++11 and c++17. Therefore, I would like the answer for c++11 please."}, {"owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1562779288, "post_id": 56975491, "comment_id": 100487702, "body": "@PaulSanders You shared an empty link ;)"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1562779323, "post_id": 56975491, "comment_id": 100487721, "body": "@jan.sende Works for me, though it&#39;s not relevant to your q anyway."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1562779389, "post_id": 56975491, "comment_id": 100487751, "body": "The real question is simply how c++11 defines the requirement for <code>std::vector</code> to require a complete type. It may simply be that no diagnostics are required and standard library implementers are allowed to write an implementation that works for incomplete types. Though it won&#39;t be portable to use it that way."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1562779426, "post_id": 56975491, "comment_id": 100487770, "body": "<a href=\"https://stackoverflow.com/a/15382714/560648\">stackoverflow.com/a/15382714/560648</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1562779515, "post_id": 56975491, "comment_id": 100487811, "body": "@LightnessRacesinOrbit, nope because language lawyer"}, {"owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1562779707, "post_id": 56975491, "comment_id": 100487898, "body": "@LightnessRacesinOrbit That has been my personal explanation so far. However, is there any guarantee in the standard for this behaviour?"}], "answers": [{"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562779455, "post_id": 56975741, "comment_id": 100487789, "body": "@Fran&#231;oisAndrieux The second paragraph remains relevant."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562779470, "post_id": 56975741, "comment_id": 100487793, "body": "I think it would be a good answer if C++11 explanation is supported with a quote from standard."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562779906, "post_id": 56975741, "comment_id": 100487973, "body": "@SergeyA I Added quote from a draft"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562779999, "post_id": 56975741, "comment_id": 100488025, "body": "@eerorika dully upvoted. For completeness, I would humbly suggest adding C++17 quote as well"}, {"owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 0, "creation_date": 1562780451, "post_id": 56975741, "comment_id": 100488207, "body": "So you are saying, that this is implementation defined?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 1, "creation_date": 1562780555, "post_id": 56975741, "comment_id": 100488254, "body": "@jan.sende No; implementation defined would mean that implementation needs to document (it&#39;s unspecified how such definition should be documented though) the behaviour. There is no requirement whatsoever. The program could compile, not compile, behave correctly, behave wrongly, on same or different compiler etc."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562780743, "post_id": 56975741, "comment_id": 100488344, "body": "@SergeyA Added C++17 quote."}, {"owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 1, "creation_date": 1562781123, "post_id": 56975741, "comment_id": 100488474, "body": "@eerorika So the behaviour is not defined? (Not in the sense of <b>undefined behaviour</b> though...)"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 1, "creation_date": 1562781297, "post_id": 56975741, "comment_id": 100488540, "body": "@jan.sende I have no idea whether undefined behaviour is same or different that undefined &quot;effects&quot;. From perspective of C++ programmer, I would assume that they mean exactly the same. If I was implementing a standard library, I would assume that I cannot make crazy optimisations based on that."}, {"owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 0, "creation_date": 1562787315, "post_id": 56975741, "comment_id": 100491110, "body": "@eerorika Understood. Would you mind spelling out that this behaviour is not defined and therefore cannot be relied on. Then, I will gladly accept your answer."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 0, "creation_date": 1562787448, "post_id": 56975741, "comment_id": 100491157, "body": "@jan.sende I added now &quot;(as far as I can tell, this is same as undefined behaviour)&quot;."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 2, "creation_date": 1562797540, "post_id": 56975741, "comment_id": 100494633, "body": "@jan.sende Undefined here implies that there is no guarantee that the code compiles; this is <i>unlike</i> the case of doing an illegal operation like a division by zero at runtime, where the code must compile and run for all execution that don&#39;t involve that illegal operation."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 12, "last_activity_date": 1562787406, "last_edit_date": 1562787406, "creation_date": 1562779383, "answer_id": 56975741, "question_id": 56975491, "link": "https://stackoverflow.com/questions/56975491/why-does-stdvector-work-with-incomplete-types-in-class-definitions/56975741#56975741", "title": "Why does std::vector work with incomplete types in class definitions?", "body": "<p>Standard says (draft N3690; this is post C++11, pre C++14):</p>\n\n<blockquote>\n  <p>[res.on.functions]</p>\n  \n  <p>1 In certain cases (replacement functions, handler functions,\n  operations on types used to instantiate standard library template\n  components), the C++standard library depends on components supplied by\n  a C++program. If these components do not meet their requirements,\n  <strong>the Standard places no requirements on the implementation</strong>.</p>\n  \n  <p>2 In particular, the <strong>effects are undefined</strong> in the following cases:</p>\n  \n  <p>\u2014 if an incomplete type (3.9) is used as a template argument when\n  instantiating a template component, unless specifically allowed for\n  that component.</p>\n</blockquote>\n\n<p>Given that standard places no requirements, and effects are undefined (as far as I can tell, this is same as undefined behaviour), there is no expectation for the instantiation to \"not work\" any more than there is expectation for it to (appear to) \"work\".</p>\n\n<hr>\n\n<p>Since C++17, the requirement was relaxed and <code>std::vector</code> does <strong>not</strong> require the value type to be complete, if used with appropriate allocator (the default allocator is appropriate). (This freedom does not extend to using all member functions; they have additional requirements).</p>\n\n<p>Standard quote (current draft):</p>\n\n<blockquote>\n  <p>[vector.overview]</p>\n  \n  <p>An incomplete type T may be used when instantiating vector if the allocator meets the allocator completeness requirements.\n  T shall be complete before any member of the resulting specialization of vector is referenced.</p>\n  \n  <p>[allocator.requirements.completeness]</p>\n  \n  <p>If X is an allocator class for type T, X additionally meets the allocator completeness requirements if, whether or not T is a complete type:</p>\n  \n  <ul>\n  <li>X is a complete type, and</li>\n  <li>all the member types of allocator_\u00adtraits other than value_\u00adtype are complete types.</li>\n  </ul>\n  \n  <p>[default.allocator]</p>\n  \n  <p>All specializations of the default allocator meet the allocator completeness requirements ([allocator.requirements.completeness]).</p>\n</blockquote>\n"}], "owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 2, "accepted_answer_id": 56975741, "answer_count": 1, "score": 8, "last_activity_date": 1562787406, "creation_date": 1562778315, "last_edit_date": 1562779173, "question_id": 56975491, "link": "https://stackoverflow.com/questions/56975491/why-does-stdvector-work-with-incomplete-types-in-class-definitions", "title": "Why does std::vector work with incomplete types in class definitions?", "body": "<p>The following question came up:</p>\n\n<p>The c++ standard seems to say, that <code>std::vector</code> requires a complete type to work. (See <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"noreferrer\">https://en.cppreference.com/w/cpp/container/vector</a> ) Then, why does the following code still compile?</p>\n\n<pre><code>#include &lt;vector&gt;\n\nstruct parent;\n\nstruct child\n{\n    std::vector&lt;parent&gt; parents; //parent is incomplete here!\n};\n\nstruct parent\n{\n    std::vector&lt;child&gt; children;\n};\n</code></pre>\n\n<p>This seems counterintuitive. If <code>std::vector</code> requires a complete type, then <code>std::vector&lt;parent&gt;</code> should not compile because only its forward declaration is known inside the class definition of <code>child</code>.</p>\n\n<ul>\n<li>Is this behaviour something special about class definitions?</li>\n<li>Did I get it wrong, and <code>std::vector</code> does not require a complete type?</li>\n<li>Or, is this just a fluke? In that technically this isn't allowed, but it works for all implementations anyways...</li>\n</ul>\n\n<p><strong>EDIT</strong></p>\n\n<p>There seems to be a difference between c++11 and c++17. I would like to understand the c++11 version.</p>\n"}, {"tags": ["c++", "uwp"], "comments": [{"owner": {"reputation": 5398, "user_id": 11602935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a4e672481f67041c0a2206bbf0cf104?s=128&d=identicon&r=PG&f=1", "display_name": "Faywang - MSFT", "link": "https://stackoverflow.com/users/11602935/faywang-msft"}, "edited": false, "score": 0, "creation_date": 1562814700, "post_id": 56975485, "comment_id": 100497816, "body": "According to your code,we found you miss a <b>&lt;/stackPanel&gt;</b>,maybe it is a typo.When I tested this code,the progress ring does appear on the top of UI.But  just this code,I&#39;m not clear what the specific reason is.Maybe because the actual loading time is very short causes the progress ring doesn&#39;t appear.So can you show us a sample to reproduce the issue?"}, {"owner": {"reputation": 51, "user_id": 5944390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7888f0d896da48926fdb8bbfd0d25617?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/5944390/developer"}, "edited": false, "score": 0, "creation_date": 1562817272, "post_id": 56975485, "comment_id": 100498271, "body": "I tried the progress ring in seperate &lt;Grid x:Name=&quot;progressGrid&quot;&gt;...&lt;/Grid&gt;.But it is not showing in UI."}], "answers": [{"tags": [], "owner": {"reputation": 5398, "user_id": 11602935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a4e672481f67041c0a2206bbf0cf104?s=128&d=identicon&r=PG&f=1", "display_name": "Faywang - MSFT", "link": "https://stackoverflow.com/users/11602935/faywang-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1562922184, "creation_date": 1562922184, "answer_id": 57003670, "question_id": 56975485, "link": "https://stackoverflow.com/questions/56975485/show-progressbar-on-the-top-in-the-existing-mainpage-xaml-in-uwp-appc-by-mas/57003670#57003670", "title": "Show progressbar on the top in the existing MainPage.xaml in UWP app(c++) by masking all the other controls in UI", "body": "<p>I write a simple demo below.You can use this code in your application to test if the progress ring can show in the UI.</p>\n\n<pre><code>&lt;Page ...&gt;   \n  &lt;Grid Background=\"{ThemeResource ApplicationPageBackgroundThemeBrush}\"&gt;\n    &lt;StackPanel Background=\"AliceBlue\"&gt;\n       &lt;TextBlock x:Name=\"MyTextBlock\" Height=\"50\" FontSize=\"16\" Margin=\"0,20,0,20\"&gt;Hello,world&lt;/TextBlock&gt;\u200b\n       &lt;Button x:Name=\"MyButton\" Click=\"Button_Click\"&gt;click me&lt;/Button&gt;\u200b\n       &lt;ProgressRing x:Name=\"MyProgressRing\" Height=\"120\" Width=\"109\" Foreground=\"Blue\" IsActive=\"True\" Visibility=\"Visible\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"&gt;&lt;/ProgressRing&gt;\u200b\n     &lt;/StackPanel&gt;\n  &lt;/Grid&gt;\n&lt;/Page&gt;\n\nMainPage::MainPage()\n{\u200b\n  InitializeComponent();\u200b\n\n  MyTextBlock-&gt;Visibility = Windows::UI::Xaml::Visibility::Collapsed;\u200b\n  MyButton-&gt;Visibility = Windows::UI::Xaml::Visibility::Collapsed;\u200b\n  MyProgressRing-&gt;IsActive = true;\u200b\n  MyProgressRing-&gt;Visibility = Windows::UI::Xaml::Visibility::Visible;\u200b\n\u200b\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5944390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7888f0d896da48926fdb8bbfd0d25617?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/5944390/developer"}, "is_accepted": true, "score": 0, "last_activity_date": 1563437509, "creation_date": 1563437509, "answer_id": 57089921, "question_id": 56975485, "link": "https://stackoverflow.com/questions/56975485/show-progressbar-on-the-top-in-the-existing-mainpage-xaml-in-uwp-appc-by-mas/57089921#57089921", "title": "Show progressbar on the top in the existing MainPage.xaml in UWP app(c++) by masking all the other controls in UI", "body": "<p>The reason why progress ring not working was we are using another view to show the mainpage.xaml as a child to its root grid.When I moved the progress ring part to that xaml ,it is working fine. Since progress ring is working as a seperate UI thread it is not called by the mainpage.</p>\n"}], "owner": {"reputation": 51, "user_id": 5944390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7888f0d896da48926fdb8bbfd0d25617?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/5944390/developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 57089921, "answer_count": 2, "score": 0, "last_activity_date": 1563437509, "creation_date": 1562778286, "question_id": 56975485, "link": "https://stackoverflow.com/questions/56975485/show-progressbar-on-the-top-in-the-existing-mainpage-xaml-in-uwp-appc-by-mas", "title": "Show progressbar on the top in the existing MainPage.xaml in UWP app(c++) by masking all the other controls in UI", "body": "<p>I have an UWP C++ app for getting some information which takes a long time to load .While startup,its taking time to get the information and update the UI.So I thought of putting a progress ring while the UI is getting data. I need the progress ring to show on the UI during the loading time in MainPage.xaml thereby making the existing controls invisible.But it is not coming on top of UI.After getting data to UI,progress ring should disappear and all the controls should be visible.</p>\n\n<pre><code>&lt;Page\n    x:Class=\"Ft_Information.MainPage\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"using:Ft_Information\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    mc:Ignorable=\"d\"  Loaded=\"MainWindow_Loaded\" BorderThickness=\"10\" IsTabStop=\"True\"&gt;\n\n  &lt;Grid Background=\"{ThemeResource ApplicationPageBackgroundThemeBrush}\"&gt;\n\n    &lt;Grid.RowDefinitions&gt;\n      &lt;RowDefinition Height=\"Auto\" /&gt;\n      &lt;RowDefinition Height=\"*\" /&gt;\n    &lt;/Grid.RowDefinitions&gt;\n\n    &lt;Grid x:Name=\"ftnfoGrid\" Grid.Row=\"1\"&gt;\n      &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"25*\" /&gt;\n        &lt;RowDefinition Height=\"500*\" /&gt;\n        &lt;RowDefinition Height=\"100*\" /&gt;\n\n      &lt;/Grid.RowDefinitions&gt;\n      &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition Width=\"50*\" /&gt;\n        &lt;ColumnDefinition Width=\"500*\" /&gt;\n        &lt;ColumnDefinition Width=\"800*\" /&gt;\n      &lt;/Grid.ColumnDefinitions&gt;\n\n      &lt;StackPanel Orientation=\"Vertical\" Grid.Row=\"1\" Grid.Column=\"1\"&gt;\n        &lt;TextBox x:Name=\"ProductNameText\"      x:Uid=\"ProductName\"      TextWrapping=\"Wrap\" BorderThickness=\"0\" IsTabStop=\"False\" FontSize=\"13\" IsReadOnly=\"True\" /&gt;\n       &lt;StackPanel Grid.Row=\"2\" RenderTransformOrigin=\"0.5,0.5\" Grid.ColumnSpan=\"1\" HorizontalAlignment=\"Stretch\" Margin=\"55,5.333,0.333,-5\" VerticalAlignment=\"Stretch\"&gt;\n        &lt;ProgressRing  Name=\"ProgressRingLbl\" Height=\"120\" Width=\"109\" HorizontalAlignment=\"Left\"\n          Foreground=\"Blue\" IsActive=\"True\" Visibility=\"Visible\" VerticalAlignment=\"Center\" Margin=\"0,0,0,0\"/&gt;\n      &lt;/StackPanel&gt;\n\n    &lt;/Grid&gt;\n&lt;/Grid&gt;\n\n&lt;/Page&gt;\n\n\nMainPage::MainPage()\n{\n    ProductNameText-&gt;Visibility = Windows::UI::Xaml::Visibility::Collapsed;\nProgressRingLbl-&gt;IsActive = true;\n        ProgressRingLbl-&gt;Visibility = Windows::UI::Xaml::Visibility::Visible;\n}\n\nMainPage::FuntouploadUI()\n{\n.............\n//after getting data\nProgressRingLbl-&gt;IsActive = false;\n        ProgressRingLbl-&gt;Visibility = Windows::UI::Xaml::Visibility::Collapsed;\n\nProductNameText-&gt;Visibility = Windows::UI::Xaml::Visibility::Visible;\n\n}\n</code></pre>\n\n<p>Still the progress bar is not showing anywhere in the UI.</p>\n"}, {"tags": ["c++", "multithreading", "templates", "mutex", "condition-variable"], "comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1562779303, "post_id": 56975469, "comment_id": 100487713, "body": "It is unknown how many pushes and pops in this code because of <code>random</code>. Hence, it is hard to specify the expected result. It is possible that all threads do <code>push</code> and none does <code>pop</code>."}, {"owner": {"reputation": 4419, "user_id": 2254782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93806dc8873fdb424d2df0f57b54d8e?s=128&d=identicon&r=PG", "display_name": "alexrider", "link": "https://stackoverflow.com/users/2254782/alexrider"}, "edited": false, "score": 0, "creation_date": 1562779883, "post_id": 56975469, "comment_id": 100487965, "body": "Does it successfully joins or just crashes?         T object = this-&gt;queue.front(); In case of timeout this will attempt to access not existing elements, since queue is still empty, leading to UB, which means basically any behavior."}, {"owner": {"reputation": 331, "user_id": 9780816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8683731519c0e12170fc5266a44b0600?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio Santoro", "link": "https://stackoverflow.com/users/9780816/antonio-santoro"}, "reply_to_user": {"reputation": 4419, "user_id": 2254782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93806dc8873fdb424d2df0f57b54d8e?s=128&d=identicon&r=PG", "display_name": "alexrider", "link": "https://stackoverflow.com/users/2254782/alexrider"}, "edited": false, "score": 0, "creation_date": 1562840977, "post_id": 56975469, "comment_id": 100508776, "body": "@alexrider it successfully joins"}], "owner": {"reputation": 331, "user_id": 9780816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8683731519c0e12170fc5266a44b0600?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio Santoro", "link": "https://stackoverflow.com/users/9780816/antonio-santoro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563543872, "creation_date": 1562778246, "last_edit_date": 1563543872, "question_id": 56975469, "link": "https://stackoverflow.com/questions/56975469/wait-until-timeout-causing-only-one-thread-to-terminate-unable-to-catch-all-thr", "title": "wait_until timeout causing only one thread to terminate, unable to catch all thread timeouts", "body": "<p>I've made a simple thread-safe <code>Buffer</code> implementation, creating 10 threads to work on the <code>buffer</code> queue to push and pop randomly some numbers. My implementation should let threads that are waiting to pop to wait only for 3 seconds and then terminate. When that occurs I print a timeout message.</p>\n\n<p>The problem is that only one timeout message is printed, the main will then join all threads and return. Why?</p>\n\n<p>Here is the code, main.cpp</p>\n\n<pre><code>#include &lt;thread&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include \"Buffer.h\"\n\nint main() {\n\n    std::vector&lt;std::thread&gt; workers;\n    Buffer&lt;std::string&gt; buffer(3);\n\n    srandom(time(NULL));\n\n    for (int i = 0; i &lt; 10; i++) {\n        workers.emplace_back([&amp;buffer]{\n            long num = random();\n            if(num%2==0) {\n                std::stringstream msg;\n                msg &lt;&lt; std::this_thread::get_id() &lt;&lt; \" pushing \" &lt;&lt; num &lt;&lt; std::endl;\n                std::cout &lt;&lt; msg.str();\n                buffer.push(std::to_string(num));\n            } else {\n                std::stringstream msg1;\n                msg1 &lt;&lt; std::this_thread::get_id() &lt;&lt; \" waiting to pop\" &lt;&lt; std::endl;\n                std::cout &lt;&lt; msg1.str();\n                std::string popped_string = buffer.pop();\n                std::stringstream msg2;\n                msg2 &lt;&lt; std::this_thread::get_id() &lt;&lt; \" popped \" &lt;&lt; popped_string &lt;&lt; std::endl;\n                std::cout &lt;&lt; msg2.str();\n            }\n        });\n    }\n\n    for (auto &amp;w: workers) {\n        if (w.joinable()) w.join();\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Buffer.h</p>\n\n<pre><code>#ifndef PDS_CPP_BUFFER_H\n#define PDS_CPP_BUFFER_H\n\n#include &lt;queue&gt;\n#include &lt;mutex&gt;\n#include &lt;condition_variable&gt;\n\ntemplate &lt;class T&gt;\nclass Buffer {\nprivate:\n    std::queue&lt;T&gt; queue;\n    std::mutex mutex;\n    std::condition_variable cv;\n    std::chrono::seconds sec;\npublic:\n    Buffer(int time) : sec(time), queue() {};\n\n    void push(T object) {\n        std::lock_guard lockGuard(mutex);\n        this-&gt;queue.push(object);\n        this-&gt;cv.notify_one();\n    }\n\n    T pop() {\n        std::unique_lock uniqueLock(mutex);\n//        this-&gt;cv.wait(uniqueLock, [this]{ return !this-&gt;queue.empty(); });\n        if(this-&gt;cv.wait_for(uniqueLock, this-&gt;sec, [this]{ return !this-&gt;queue.empty(); })) {\n        } else {\n            std::stringstream msg;\n            msg &lt;&lt; std::this_thread::get_id() &lt;&lt; \" timeout\" &lt;&lt; std::endl;\n            std::cout &lt;&lt; msg.str();\n        }\n\n        T object = this-&gt;queue.front();\n        this-&gt;queue.pop();\n        uniqueLock.unlock();\n        return object;\n    }\n};\n\n\n#endif //PDS_CPP_BUFFER_H\n</code></pre>\n"}, {"tags": ["c++", "pointers", "memory-address"], "comments": [{"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1562778289, "post_id": 56975465, "comment_id": 100487197, "body": "It&#39;s the same as <code>int a = 1, *c = &amp;a</code>"}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1562778422, "post_id": 56975465, "comment_id": 100487265, "body": "But <code>tab</code> is an array of pointers."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11766210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285ac95e7c6e209ce45a0cef0a20968e?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew01", "link": "https://stackoverflow.com/users/11766210/matthew01"}, "edited": false, "score": 0, "creation_date": 1562778674, "post_id": 56975521, "comment_id": 100487388, "body": "I can share full code but There&#39;s lack of comments and there&#39;s more fancy notations."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 1, "user_id": 11766210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285ac95e7c6e209ce45a0cef0a20968e?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew01", "link": "https://stackoverflow.com/users/11766210/matthew01"}, "edited": false, "score": 2, "creation_date": 1562778734, "post_id": 56975521, "comment_id": 100487421, "body": "Anyone who writes code like this is just being difficult on purpose. Sorry you have to work with it. I feel for you."}, {"owner": {"reputation": 1, "user_id": 11766210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285ac95e7c6e209ce45a0cef0a20968e?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew01", "link": "https://stackoverflow.com/users/11766210/matthew01"}, "edited": false, "score": 0, "creation_date": 1562779245, "post_id": 56975521, "comment_id": 100487681, "body": "Most of competitive programming codes be like this :C I have to get on with it."}, {"owner": {"reputation": 1, "user_id": 11766210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285ac95e7c6e209ce45a0cef0a20968e?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew01", "link": "https://stackoverflow.com/users/11766210/matthew01"}, "edited": false, "score": 1, "creation_date": 1562779274, "post_id": 56975521, "comment_id": 100487693, "body": "I&#39;ll share my results later."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1562778439, "creation_date": 1562778439, "answer_id": 56975521, "question_id": 56975465, "link": "https://stackoverflow.com/questions/56975465/creating-a-pointer-in-an-unusual-way/56975521#56975521", "title": "Creating a pointer in an unusual way", "body": "<p>This appears to be three different declarations:</p>\n\n<pre><code>Graph&lt;V,E&gt; gt(SIZE(g));\nGraph&lt;V,E&gt; res(SIZE(g));\nGraph&lt;V,E&gt; *tab[] = {this,&amp;gt};\n</code></pre>\n\n<p>It's probably someone's idea of making the code more minimal, but it arguably impacts readability in a pretty severe way.</p>\n\n<p>Why <code>tab</code> even exists I don't know, it depends on how it's used in other parts of the code. Is this some kind of bizarro linked list?</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11766210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285ac95e7c6e209ce45a0cef0a20968e?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew01", "link": "https://stackoverflow.com/users/11766210/matthew01"}, "edited": false, "score": 0, "creation_date": 1562778844, "post_id": 56975526, "comment_id": 100487480, "body": "Still don&#39;t get usage of this, I mean I know &quot;this&quot; is a pointer to an object itself for example in class. But array is not a class(?) This is very unclear."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1562780277, "post_id": 56975526, "comment_id": 100488137, "body": "It depends where this code appears, like inside a <code>class</code> or <code>struct</code>."}], "tags": [], "owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "is_accepted": false, "score": 1, "last_activity_date": 1562778453, "creation_date": 1562778453, "answer_id": 56975526, "question_id": 56975465, "link": "https://stackoverflow.com/questions/56975465/creating-a-pointer-in-an-unusual-way/56975526#56975526", "title": "Creating a pointer in an unusual way", "body": "<p><code>tab</code> is an array of pointers to <code>Graph&lt;V, E&gt;</code>, and is initialized with two elements: pointer <code>this</code>, and a pointer to newly created <code>gt</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 11766210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285ac95e7c6e209ce45a0cef0a20968e?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew01", "link": "https://stackoverflow.com/users/11766210/matthew01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562778453, "creation_date": 1562778229, "question_id": 56975465, "link": "https://stackoverflow.com/questions/56975465/creating-a-pointer-in-an-unusual-way", "title": "Creating a pointer in an unusual way", "body": "<p>I was looking for implementation of SCC algorithm in C++ and there's one weird line which is clearly beyond my comprehension.</p>\n\n<pre><code>Graph&lt;V,E&gt; gt(SIZE(g)), res(SIZE(g)), *tab[] = {this,&amp;gt};\n</code></pre>\n\n<p>I don't understand <code>*tab[] = {this,&amp;gt};</code></p>\n\n<p>I assume it is a pointer but still don't get it at all so I'd be glad If someone could explain it to me. I've been using C++ for almost 6 years and I've never seen this kind of pointer before.</p>\n"}, {"tags": ["c++", "oop", "decorator", "virtual"], "comments": [{"owner": {"reputation": 1493, "user_id": 4377932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f9nFx.jpg?s=128&g=1", "display_name": "artcorpse", "link": "https://stackoverflow.com/users/4377932/artcorpse"}, "edited": false, "score": 0, "creation_date": 1562778630, "post_id": 56975420, "comment_id": 100487376, "body": "What do you mean by &quot;UML description&quot;? In C++ the way to define an &quot;interface&quot; is to make the methods virtual. Are you looking for a technical solution to changing the price, or for a semantical discussion?"}, {"owner": {"reputation": 119, "user_id": 4574479, "user_type": "registered", "profile_image": "https://graph.facebook.com/914000668650269/picture?type=large", "display_name": "Kamil Pop", "link": "https://stackoverflow.com/users/4574479/kamil-pop"}, "reply_to_user": {"reputation": 1493, "user_id": 4377932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f9nFx.jpg?s=128&g=1", "display_name": "artcorpse", "link": "https://stackoverflow.com/users/4377932/artcorpse"}, "edited": false, "score": 0, "creation_date": 1562778923, "post_id": 56975420, "comment_id": 100487527, "body": "In addition to the UML diagram, there were a few bullet points that described function behaviors, one of them specified that the getPrice function is not virtual, sorry I wasn&#39;t clear enough! I&#39;m looking for a technical solution."}, {"owner": {"reputation": 1493, "user_id": 4377932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f9nFx.jpg?s=128&g=1", "display_name": "artcorpse", "link": "https://stackoverflow.com/users/4377932/artcorpse"}, "edited": false, "score": 0, "creation_date": 1562779316, "post_id": 56975420, "comment_id": 100487719, "body": "If you are looking for a technical solution, you will need to provide more information on what you can change/touch. If you can change the base class, making the method virtual will allow you to use the decorator pattern freely. If you can&#39;t change the base class, it depends a lot on the reason why you can&#39;t change it, and most likely you will look for solutions outside the standard, that take &quot;implementation&quot; into account."}, {"owner": {"reputation": 119, "user_id": 4574479, "user_type": "registered", "profile_image": "https://graph.facebook.com/914000668650269/picture?type=large", "display_name": "Kamil Pop", "link": "https://stackoverflow.com/users/4574479/kamil-pop"}, "reply_to_user": {"reputation": 1493, "user_id": 4377932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f9nFx.jpg?s=128&g=1", "display_name": "artcorpse", "link": "https://stackoverflow.com/users/4377932/artcorpse"}, "edited": false, "score": 0, "creation_date": 1562780068, "post_id": 56975420, "comment_id": 100488047, "body": "Unfortunately I can&#39;t change the base class. Just what the function does, so a solution outside of the standard is my only option unfortunately."}, {"owner": {"reputation": 1493, "user_id": 4377932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f9nFx.jpg?s=128&g=1", "display_name": "artcorpse", "link": "https://stackoverflow.com/users/4377932/artcorpse"}, "edited": false, "score": 0, "creation_date": 1562915350, "post_id": 56975420, "comment_id": 100536759, "body": "you can have a look at this: <a href=\"https://stackoverflow.com/a/19209874/4377932\">stackoverflow.com/a/19209874/4377932</a>"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 4574479, "user_type": "registered", "profile_image": "https://graph.facebook.com/914000668650269/picture?type=large", "display_name": "Kamil Pop", "link": "https://stackoverflow.com/users/4574479/kamil-pop"}, "edited": false, "score": 0, "creation_date": 1562780133, "post_id": 56975659, "comment_id": 100488076, "body": "Forgot to add that the price variable is private - my bad. Otherwise, this would be the perfect solution."}], "tags": [], "owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "is_accepted": false, "score": 1, "last_activity_date": 1562779005, "creation_date": 1562779005, "answer_id": 56975659, "question_id": 56975420, "link": "https://stackoverflow.com/questions/56975420/how-to-create-a-decorator-function-without-using-virtual/56975659#56975659", "title": "How to create a decorator function without using virtual", "body": "<p>You can make the price protected and overwrite it in the decorator:</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nclass Smoothy{\nprotected:\n    int price;\npublic:\n    int getPrice(){\n        return price;\n    }\n    virtual ~Smoothy() = default;\n    virtual string description() = 0;\n};\n\nclass BasicSmoothy: public Smoothy{\nprivate:\n    string nume;\npublic:\n    BasicSmoothy(string n): nume(n) {\n        if (nume == \"Kiwi\") {\n            price = 10;\n        } else if (nume == \"Strawberry\") {\n            price = 12;\n        } else {\n            throw;\n        }\n    }\n    string description(){\n        return nume;\n    }\n};\n\nclass SmoothyDecorator:public Smoothy{\nprivate:\n    Smoothy *b;\n\npublic:\n    SmoothyDecorator(Smoothy* bb){\n      b = bb;\n    }\n    ~SmoothyDecorator(){\n        delete b;\n    }\n    string description(){\n        return b-&gt;description();\n    }\n};\n\nclass SmoothyWithCream:public SmoothyDecorator{\npublic:\n    SmoothyWithCream(Smoothy *b):SmoothyDecorator(b){\n        price = b-&gt;getPrice() + 2;\n    }\n    string description(){\n\n        return SmoothyDecorator::description() + \" with Cream!\";\n    }\n};\n\nclass SmoothyWithCinnamon:public SmoothyDecorator{\npublic:\n    SmoothyWithCinnamon(Smoothy *b):SmoothyDecorator(b) {\n        price = b-&gt;getPrice() + 3;\n    }\n    string description(){\n        return SmoothyDecorator::description() + \" with Cinnamon!\";\n\n    }\n};\n\nint main(){\n    Smoothy* b = new SmoothyWithCinnamon(new BasicSmoothy(\"Kiwi\"));\n    cout&lt;&lt;b-&gt;description() &lt;&lt; std::endl;\n    cout &lt;&lt; b-&gt;getPrice();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 4574479, "user_type": "registered", "profile_image": "https://graph.facebook.com/914000668650269/picture?type=large", "display_name": "Kamil Pop", "link": "https://stackoverflow.com/users/4574479/kamil-pop"}, "is_accepted": true, "score": 0, "last_activity_date": 1562957406, "creation_date": 1562957406, "answer_id": 57012590, "question_id": 56975420, "link": "https://stackoverflow.com/questions/56975420/how-to-create-a-decorator-function-without-using-virtual/57012590#57012590", "title": "How to create a decorator function without using virtual", "body": "<p>For anyone curios, I managed to find the solution.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Smoothy\n{\n\npublic:\n\n    Smoothy()\n    {\n\n    }\n\n    Smoothy(int n):\n        price(n)\n    {\n    };\n\n    virtual ~Smoothy() = default;\n\n    int getPrice()\n    {\n        return price;\n    }\n\n    virtual string description() = 0;\n\nprivate:\n\n    int price;\n};\n\n\nclass BasicSmoothy :\n    public Smoothy\n{\npublic:\n\n    BasicSmoothy(string n) :\n        Smoothy(n==\"Kiwi\"?10:12),\n        nume(n)\n    {\n    }\n\n    string description()\n    {\n        return nume;\n    }\n\nprivate:\n\n    string nume;\n};\n\nclass SmoothyDecorator :\n    public Smoothy\n{\npublic:\n\n    SmoothyDecorator(Smoothy* bb, int pret) :\n        Smoothy(pret + bb-&gt;getPrice()), b(bb)\n    {\n\n    }\n\n    ~SmoothyDecorator()\n    {\n        delete b;\n    }\n\n    string description()\n    {\n        return b-&gt;description();\n    }\n\nprivate:\n\n    Smoothy* b;\n};\n\nclass SmoothyWithCream :\n    public SmoothyDecorator\n{\npublic:\n\n    SmoothyWithCream(Smoothy* b) :\n        SmoothyDecorator(b, 2)\n    {\n    }\n\n    virtual string description()\n    {\n        return SmoothyDecorator::description() + \" with Cream!\" + to_string(getPrice());\n    }\n};\n\nclass SmoothyWithCinnamon :\n    public SmoothyDecorator\n{\npublic:\n\n    SmoothyWithCinnamon(Smoothy* b) :\n        SmoothyDecorator(b, 3)\n    {\n    }\n\n    virtual string description()\n    {\n        return SmoothyDecorator::description() + \" with Cinnamon!\" + to_string(getPrice());\n    }\n};\n\nint main()\n{\n    Smoothy* b1 = new SmoothyWithCinnamon(new SmoothyWithCream(new BasicSmoothy(\"Kiwi\")));\n    Smoothy* b2 = new SmoothyWithCinnamon(new SmoothyWithCream(new BasicSmoothy(\"Strawberry\")));\n\n    cout &lt;&lt;b1-&gt;description() &lt;&lt; std::endl;\n    cout &lt;&lt;b2-&gt;description() &lt;&lt; std::endl;\n\n    delete b1;\n    delete b2;\n\n\n}\n\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 4574479, "user_type": "registered", "profile_image": "https://graph.facebook.com/914000668650269/picture?type=large", "display_name": "Kamil Pop", "link": "https://stackoverflow.com/users/4574479/kamil-pop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 57012590, "answer_count": 2, "score": 1, "last_activity_date": 1562957406, "creation_date": 1562777960, "question_id": 56975420, "link": "https://stackoverflow.com/questions/56975420/how-to-create-a-decorator-function-without-using-virtual", "title": "How to create a decorator function without using virtual", "body": "<p>I have to use the Decorator pattern, based on an UML diagram. Depending on the type of string I input, I have to return a price and a description. The issue I'm encountering is that the UML description strictly specifies that the price function is not virtual, and furthermore, it should only be implemented in the Smoothy interface, as shown below in the code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>\n#include&lt;iostream&gt;\nusing namespace std;\n\nclass Smoothy{\n    int price;\npublic:\n    int getPrice(){\n        return price;\n    }\n    virtual ~Smoothy() = default;\n    virtual string description() = 0;\n};\n\nclass BasicSmoothy: public Smoothy{\nprivate:\n    string nume;\npublic:\n    BasicSmoothy(string n): nume(n){}\n    string description(){\n        return nume;\n    }\n};\n\nclass SmoothyDecorator:public Smoothy{\nprivate:\n    Smoothy *b;\n\npublic:\n    SmoothyDecorator(Smoothy* bb){\n      b = bb;\n    }\n    ~SmoothyDecorator(){\n        delete b;\n    }\n    string description(){\n        return b-&gt;description();\n    }\n};\n\nclass SmoothyWithCream:public SmoothyDecorator{\npublic:\n    SmoothyWithCream(Smoothy *b):SmoothyDecorator(b){\n\n    }\n    string description(){\n\n        return SmoothyDecorator::description() + \" with Cream!\";\n    }\n};\n\nclass SmoothyWithCinnamon:public SmoothyDecorator{\npublic:\n    SmoothyWithCinnamon(Smoothy *b):SmoothyDecorator(b){\n\n    }\n    string description(){\n        return SmoothyDecorator::description() + \" with Cinnamon!\";\n\n    }\n};\n\nint main(){\n     Smoothy* b = new SmoothyWithCinnamon(new BasicSmoothy(\"Kiwi\"));\n     cout&lt;&lt;b-&gt;description();\n\n}\n</code></pre>\n\n<p>I'm pretty sure my code reflects the Decorator pattern(plese let me know if it doesn't), but I'm not sure how to return the price, based on the string. In addition to that, the UML diagram specifies that the BasicSmoothy has two types, with two specific prices(Kiwi 10$, Strawberry 12$) and the Derived classes each add 2$ and 3$ to the final listed price.</p>\n\n<p>Is there a way to return the price through the function getPrice() without it being virtual and without implementing it in the other classes?</p>\n"}, {"tags": ["c++", "primes", "sieve-of-eratosthenes", "sieve"], "comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1562778020, "post_id": 56975356, "comment_id": 100487092, "body": "Offtopic: About <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\"><code>using namespace std</code></a>..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1562779350, "post_id": 56975356, "comment_id": 100487729, "body": "<code>if(n&lt;=32000)</code> \u2013 with <code>n</code> once having passed 32000, you won&#39;t ever enter the if branch again. So you might be appending new primes, but you won&#39;t check them ever again; you need to increase the count of numbers you have checked already..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1562779539, "post_id": 56975356, "comment_id": 100487824, "body": "Having fixed the issue, your algorithm will remain inefficient, you&#39;ll be re-checking the primes you already <i>have</i> checked, as you constantly iterate over the whole vector. So remember the index of highest prime already checked and re-start there when entering the if-branch again."}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1562789817, "post_id": 56975356, "comment_id": 100492103, "body": "Concerning efficiency: you perform the Sieve with all steps <code>i</code>. Instead, you can use the prime numbers already found only."}], "owner": {"reputation": 1, "user_id": 8621311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e662c3d0979a19720c55ec175ecfc4a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sri Harsha", "link": "https://stackoverflow.com/users/8621311/sri-harsha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562777673, "creation_date": 1562777673, "question_id": 56975356, "link": "https://stackoverflow.com/questions/56975356/wrong-answer-on-spoj-prime1", "title": "Wrong answer on SPOJ (PRIME1)", "body": "<p>Here is the link to the problem -> <a href=\"https://www.spoj.com/problems/PRIME1/\" rel=\"nofollow noreferrer\">PRIME1</a></p>\n\n<p>It asks us to print all the prime numbers between two numbers m and n</p>\n\n<p>I used segmented sieve to solve the problem. Stored all the primes till sqrt(10^9) and used them to get primes in a specific range. Please help me out.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nvector&lt;int&gt; v;\nvector&lt;bool&gt; prime(32022);\nvoid precompute()\n{\n    int n=32000;\n    prime[0]=prime[1]=true;\n    for(int i=2;i*i&lt;=32000;i++)\n    {\n        for(int j=i*i;j&lt;=32000;j+=i)\n            prime[j]=true;\n    }\n    for(int i=0;i&lt;=32000;i++)\n        if(!prime[i]) v.push_back(i);\n}\n\nint main() {\n    precompute();\n    int t; scanf(\"%d\",&amp;t);\n    while(t--)\n    {\n        int m,n; scanf(\"%d%d\",&amp;m,&amp;n);\n        if(n&lt;=32000)\n        {\n            for(int i:v)\n            {\n                if(i&gt;n) break;\n                if(i&gt;=m &amp;&amp; i&lt;=n)\n                    printf(\"%d\\n\",i);\n            }\n        }\n        else\n        {\n            vector&lt;bool&gt; prime(n-m+1,true);\n            for(int i:v)\n            {\n                int st=(m/i)*i;\n                if(st&lt;m) st+=i;\n                while(st&lt;=n)\n                {\n                    prime[st-m]=false;\n                    st+=i;\n                }\n            }\n            for(int i=0;i&lt;n-m+1;i++)\n            {\n                if(prime[i]) printf(\"%d\\n\",i+m);\n            }\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "openmp"], "comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 2, "creation_date": 1562778541, "post_id": 56975215, "comment_id": 100487331, "body": "Which compiler and version of OpenMP are you using?"}, {"owner": {"reputation": 2275, "user_id": 5869304, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ed0827adc1d5b81f2125f83c44e7feb5?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5869304/joe"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1562786948, "post_id": 56975215, "comment_id": 100490969, "body": "Visual Studio 2019 and whatever version of GCC is most recent on Ubuntu.   I do also sadly have to build the code under Visual Studio 2015 but I am willing to try an alternate, windows-specific approach in that case.  Going forward I will be able to stick with VS2019 and beyond"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 1, "creation_date": 1562791501, "post_id": 56975215, "comment_id": 100492786, "body": "The value set by <code>omp_set_num_threads</code> will not be used if a <code>num_threads</code> clause is present in the construct.  Maybe you could use that in code you control?  Or change the &quot;one specific OpenMP block&quot; to use it instead of <code>omp_set_num_threads</code>?"}, {"owner": {"reputation": 2275, "user_id": 5869304, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ed0827adc1d5b81f2125f83c44e7feb5?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5869304/joe"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1562792841, "post_id": 56975215, "comment_id": 100493282, "body": "Unfortunately the one specific block is using a configurable parameter that the user can change.  So I can&#39;t write the number into code with num_threads clause"}], "answers": [{"comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1562778259, "post_id": 56975413, "comment_id": 100487184, "body": "I didn&#39;t DV, but maybe because versioin 2.0 is ancient?  OpenMP is up to version 5.0."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1562778412, "post_id": 56975413, "comment_id": 100487257, "body": "@1201ProgramAlarm I agree (and will add a disclaimer), but latest MSVC still only implements the 2.0 standard and I have no experience with OpenMP on other compilers."}, {"owner": {"reputation": 1650, "user_id": 2785280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mokc5.jpg?s=128&g=1", "display_name": "Michael Klemm", "link": "https://stackoverflow.com/users/2785280/michael-klemm"}, "edited": false, "score": 0, "creation_date": 1562778441, "post_id": 56975413, "comment_id": 100487274, "body": "Yes, please do not quote a almost 20-year old spec in the light that there have been six revisions (three major ones). The post also misses the key point that with latest OpenMP the specification of the number of threads can be list-like structure that cannot be queried from the user code all the nesting levels that might be executed at runtime. So, the only way to query the number of threads for the current level is to open a parallel region, ask for the number of threads and return that number. Caveat is that this number might still be wrong as it may change in the light of <code>omp_set_dynamic</code>"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 1650, "user_id": 2785280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mokc5.jpg?s=128&g=1", "display_name": "Michael Klemm", "link": "https://stackoverflow.com/users/2785280/michael-klemm"}, "edited": false, "score": 0, "creation_date": 1562778700, "post_id": 56975413, "comment_id": 100487404, "body": "@MichaelKlemm That 20-year old spec is the latest one supported by one of the three big C++ compilers. I too wish that were different, but as of right now my answer is exactly what I would&#39;ve been looking for a few months ago and what I assume the asker wants to know if they are using MSVC right now. And even if they&#39;re not, it probably will help others (unless MSVC updates their OMP support tomorrow)."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 1650, "user_id": 2785280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mokc5.jpg?s=128&g=1", "display_name": "Michael Klemm", "link": "https://stackoverflow.com/users/2785280/michael-klemm"}, "edited": false, "score": 0, "creation_date": 1562779044, "post_id": 56975413, "comment_id": 100487580, "body": "@MichaelKlemm Thanks for explaining your thoughts though, it helps!"}, {"owner": {"reputation": 2275, "user_id": 5869304, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ed0827adc1d5b81f2125f83c44e7feb5?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5869304/joe"}, "edited": false, "score": 0, "creation_date": 1562786284, "post_id": 56975413, "comment_id": 100490714, "body": "Visual Studio 2019 (which I am using) appears to indicate that it supports Open MP 4.0... sorta.  It at least talks about SIMD extensions.  <a href=\"https://docs.microsoft.com/en-us/cpp/parallel/openmp/openmp-simd?view=vs-2019\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/cpp/parallel/openmp/&hellip;</a>"}, {"owner": {"reputation": 2275, "user_id": 5869304, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ed0827adc1d5b81f2125f83c44e7feb5?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5869304/joe"}, "edited": false, "score": 0, "creation_date": 1562786338, "post_id": 56975413, "comment_id": 100490734, "body": "Perhaps I should attempt to ask the current computer how many cores I have to work with and use that...?"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "reply_to_user": {"reputation": 2275, "user_id": 5869304, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ed0827adc1d5b81f2125f83c44e7feb5?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5869304/joe"}, "edited": false, "score": 1, "creation_date": 1562791590, "post_id": 56975413, "comment_id": 100492824, "body": "@Joe <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/openmp-enable-openmp-2-0-support?view=vs-2019\" rel=\"nofollow noreferrer\">MSVC supports</a> OpenMP 2.0, and enables SIMD functionality with the <code>&#47;openmp:experimental</code> optiion."}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 3, "last_activity_date": 1562778513, "last_edit_date": 1562778513, "creation_date": 1562777923, "answer_id": 56975413, "question_id": 56975215, "link": "https://stackoverflow.com/questions/56975215/can-i-make-openmp-to-revert-to-ideal-of-threads-after-using-omp-set-num-thread/56975413#56975413", "title": "Can I make OpenMP to revert to ideal # of threads after using omp_set_num_threads?", "body": "<p>I've had this problem before. (<strong>Disclaimer:</strong> I work with MSVC, which currently only implements the OpenMP 2.0 standard). To the best of my knowledge, there is nothing in the <a href=\"https://www.openmp.org/wp-content/uploads/cspec20.pdf\" rel=\"nofollow noreferrer\">OpenMP 2.0 standard</a> that allows you to find out this default value. <code>omp_get_max_threads()</code> is not required to return it (all subsequent emphasis mine):</p>\n\n<blockquote>\n  <p>The <code>omp_get_max_threads</code> function returns an integer that is guaranteed to be <strong>at least as large</strong> as the number of threads that would be used to form a team if a parallel region without a <code>num_threads</code> clause were to be encountered at that point in the code.</p>\n</blockquote>\n\n<p>In other words, it might return a number that is larger than the currently set (or default) value.</p>\n\n<p>There is no special value for <code>omp_set_num_threads</code> either:</p>\n\n<blockquote>\n  <p>The <code>omp_set_num_threads</code> function sets the default number of threads to use for subsequent parallel regions that do not specify a <code>num_threads</code> clause. [...] The value of the parameter <code>num_threads</code> must be a <strong>positive integer</strong>.</p>\n</blockquote>\n\n<p>And if you get it wrong, it's up to the implementation what will happen:</p>\n\n<blockquote>\n  <p>If a parallel region is encountered while dynamic adjustment of the number of threads is disabled, and the number of threads requested for the parallel region <strong>exceeds</strong> the number that the run-time system can supply, the behavior of the program is <strong>implementation-defined</strong>. An implementation may, for example, interrupt the execution of the program, or it may serialize the parallel region.</p>\n</blockquote>\n\n<p>You might find more precise (and less unsettling) information in the documentation of your OpenMP implementation. However, in the case of MSVC, that documentation is just a verbatim copy of the OpenMP 2.0 standard...</p>\n\n<hr>\n\n<p>Since you are in the business of modifying the number of threads this way, I would like to preemptively caution about the interaction of <code>omp_set_dynamic</code> with <code>omp_get_num_threads</code> within MSVC:<br>\n<a href=\"https://stackoverflow.com/questions/56055959/why-does-omp-set-dynamic1-never-adjust-the-number-of-threads-in-visual-c\">Why does omp_set_dynamic(1) never adjust the number of threads (in Visual C++)?</a></p>\n"}], "owner": {"reputation": 2275, "user_id": 5869304, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ed0827adc1d5b81f2125f83c44e7feb5?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5869304/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 56975413, "answer_count": 1, "score": 2, "last_activity_date": 1562778513, "creation_date": 1562777105, "question_id": 56975215, "link": "https://stackoverflow.com/questions/56975215/can-i-make-openmp-to-revert-to-ideal-of-threads-after-using-omp-set-num-thread", "title": "Can I make OpenMP to revert to ideal # of threads after using omp_set_num_threads?", "body": "<p>Is there a way to make OpenMP revert the number of threads (for the next time it's used) back to the default  <strong><em>after</em></strong> the application has already called <code>omp_set_num_threads()</code> with a specific number?  </p>\n\n<p>For example, is there a special code (e.g. 0 or -1) I supply to <code>omp_set_num_threads</code>?  </p>\n\n<p>Or should I just try doing something like <code>omp_set_num_threads(omp_get_max_threads())</code>?</p>\n\n<p>I am making the assumption that the default number is whatever the implementation of OpenMP deems as \"optimal\".  But I don't know what, if anything, the default is guaranteed to be or even what it should be.  All I know is that I have an application that calls <code>omp_set_num_threads(4)</code> for one specific OpenMP block which I must not edit (for now).  But I'd like to prevent that one setting from affecting other OpenMP blocks in my code.  </p>\n"}, {"tags": ["python", "c++", "performance", "numpy", "eigen3"], "comments": [{"owner": {"reputation": 6690, "user_id": 4225229, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2YfJM.jpg?s=128&g=1", "display_name": "JacobIRR", "link": "https://stackoverflow.com/users/4225229/jacobirr"}, "edited": false, "score": 4, "creation_date": 1562776998, "post_id": 56975139, "comment_id": 100486619, "body": "the python libraries that do complex math rely on the C layer for their operations"}, {"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1562777062, "post_id": 56975139, "comment_id": 100486658, "body": "There are so many reasons one would be faster than the other. To be safer, I would push the part you are measuring into a separate function."}, {"owner": {"reputation": 1640, "user_id": 3871961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d1352dc24db7622120ce9b523a2b96?s=128&d=identicon&r=PG&f=1", "display_name": "xiawi", "link": "https://stackoverflow.com/users/3871961/xiawi"}, "edited": false, "score": 1, "creation_date": 1562777082, "post_id": 56975139, "comment_id": 100486666, "body": "if you use SSE2 or AVX in C++, your program may be faster..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1562777480, "post_id": 56975139, "comment_id": 100486866, "body": "Might be unlikely that time shifts occured right now, but <a href=\"https://en.cppreference.com/w/cpp/chrono/system_clock\" rel=\"nofollow noreferrer\">system_clock</a> is <b>not</b> monotonic; for time measurements, you should use <a href=\"https://en.cppreference.com/w/cpp/chrono/steady_clock\" rel=\"nofollow noreferrer\">steady_clock</a>."}, {"owner": {"reputation": 173469, "user_id": 901925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bbd70aaeb3a97d0087daf93c2be8804?s=128&d=identicon&r=PG", "display_name": "hpaulj", "link": "https://stackoverflow.com/users/901925/hpaulj"}, "edited": false, "score": 1, "creation_date": 1562777528, "post_id": 56975139, "comment_id": 100486879, "body": "While there&#39;s a level of Python interpretation that converts <code>a*a1</code> in a <code>numpy</code> function call, most of the action takes place in compiled (&#39;C&#39;) <code>numpy</code> code.  For basic math operations like this, the <code>numpy</code> implementation of multidimensional arrays is quite efficient."}, {"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 7, "creation_date": 1562777761, "post_id": 56975139, "comment_id": 100486978, "body": "<code>I wanted to convert to C++ (with eigen3) in order to get a more efficient program</code> -&gt; I wonder why people keeping saying stuff like this. The lower level tool will only be faster if you use the low-level functionality provided."}, {"owner": {"reputation": 117, "user_id": 8384325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ztxC.jpg?s=128&g=1", "display_name": "Sermal", "link": "https://stackoverflow.com/users/8384325/sermal"}, "reply_to_user": {"reputation": 1640, "user_id": 3871961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d1352dc24db7622120ce9b523a2b96?s=128&d=identicon&r=PG&f=1", "display_name": "xiawi", "link": "https://stackoverflow.com/users/3871961/xiawi"}, "edited": false, "score": 0, "creation_date": 1562777824, "post_id": 56975139, "comment_id": 100487010, "body": "@xiawi I tried the following flags: -O3 -funroll-loops -msse2 -Winline -march=native but the run times remain the same. Does this mean -O3 already takes these optimizations into account?"}, {"owner": {"reputation": 117, "user_id": 8384325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ztxC.jpg?s=128&g=1", "display_name": "Sermal", "link": "https://stackoverflow.com/users/8384325/sermal"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1562778026, "post_id": 56975139, "comment_id": 100487094, "body": "@Aconcagua I changed system_clock to steady_clock and still got the same result. Maybe the time measurement in Python could be influenced by something similar?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1562778452, "post_id": 56975139, "comment_id": 100487282, "body": "@Sermal Those time shifts mentioned mainly occur on changing between summer and winter time \u2013 and if leap seconds need to be inserted. Both not too likely right in the middle of summer... Using <code>steady_clock</code> is a <i>general</i> advice... About time measurement: You are running the code in question just once, there are many effects that might disturb this single measurement. Additionally, you have just a hand written ordinary for loop. The underlying code within numpy might be highly optimised using quite a bunch of special tricks to speed the matter up, perhaps even coded in assembler..."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 1, "creation_date": 1562778691, "post_id": 56975139, "comment_id": 100487398, "body": "@Mansoor That and <i>if</i> you know how to vectorize code really well, which most people, even seasoned C++ developers, do not. There&#39;s a real art to writing high-performance numerical code."}, {"owner": {"reputation": 117, "user_id": 8384325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ztxC.jpg?s=128&g=1", "display_name": "Sermal", "link": "https://stackoverflow.com/users/8384325/sermal"}, "reply_to_user": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1562778693, "post_id": 56975139, "comment_id": 100487399, "body": "@Mansoor Just in case, I did as you said and put it inside a separate function, but had no noticeable difference."}, {"owner": {"reputation": 117, "user_id": 8384325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ztxC.jpg?s=128&g=1", "display_name": "Sermal", "link": "https://stackoverflow.com/users/8384325/sermal"}, "reply_to_user": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1562778722, "post_id": 56975139, "comment_id": 100487412, "body": "@Mansoor  I agree with that, but my reasoning is the following: with python you don&#39;t have much control of what the computer is doing with your variables. You don&#39;t have to think about memory management, alignment, etc. You trust the libraries&#39; programmers to do that for you. C++ is more transparent, so if I know what I&#39;m doing and know the specific requirements of my program, I should be able to optimize my code for it. In this case, it&#39;s a simple coefficient-wise operation. What can I optimize further?"}, {"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 1, "creation_date": 1562779390, "post_id": 56975139, "comment_id": 100487752, "body": "@Sermal As mentioned by many others, you are doing roughly the same things in both Python and C++. You could apply vectorisation and run in parallel. However, these types of fine tunning are very finicky and if done incorrectly will not give performance gains (or possibly make things worse at least with multi-threading). FYI there are also plenty of things to do to make the Python go faster. The key point is that C++ gives you a lot of controls; most people don&#39;t know of them and some may be misusing them, their code won&#39;t run any faster than high-level code."}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 0, "creation_date": 1562830788, "post_id": 56975139, "comment_id": 100503074, "body": "gcc sometimes has trouble inlining things in the main function. You should move your code to another function and call that from <code>main</code>. Also, <code>-O2 -DNDEBUG -march=native</code> should suffice in general."}], "owner": {"reputation": 117, "user_id": 8384325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ztxC.jpg?s=128&g=1", "display_name": "Sermal", "link": "https://stackoverflow.com/users/8384325/sermal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 553, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1562776774, "creation_date": 1562776774, "question_id": 56975139, "link": "https://stackoverflow.com/questions/56975139/python-numpy-code-more-efficient-than-eigen3-or-plain-c", "title": "Python numpy code more efficient than eigen3 or plain C++", "body": "<p>I had some code in Python3 (with numpy) that I wanted to convert to C++ (with eigen3) in order to get a more efficient program. So I decided to test a simple example to assess the performance gain I would get. The code consists on two random arrays that are to be multiplied coefficient-wise. My conclusions were that the python code with numpy is  about 30% faster than the one in C++. I'd like to know why the interpreted python code is faster than a compiled C++ code. Am I missing something in the C++ code?</p>\n\n<p>I'm using gcc 9.1.0, Eigen 3.3.7, Python 3.7.3 and Numpy 1.16.4.</p>\n\n<p><strong>Possible explanations:</strong></p>\n\n<p>C++ program isn't using vectorization<br>\nNumpy is a lot more optimized than I thought<br>\nTime is measuring different things in each program<br></p>\n\n<p>There is a similar question in Stack Overflow (<a href=\"https://stackoverflow.com/questions/24566920/eigen-matrix-vs-numpy-array-multiplication-performance\">Eigen Matrix vs Numpy Array multiplication performance</a>). I tested this in my computer and got the expected result that eigen is more efficient than numpy, but the operation here is matrix multiplication rather than coefficient-wise multiplication.</p>\n\n<p><strong>Python code (main.py)</strong><br>\nExecution command: python3 main.py</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import numpy as np\nimport time\n\nLx = 4096\nLy = 4000\n\n# Filling arrays\na = np.random.rand(Lx, Ly).astype(np.float64)\na1 = np.random.rand(Lx, Ly).astype(np.float64)\n\n# Coefficient-wise product\nstart = time.time()\nb = a*a1\n\n# Compute the elapsed time\nend = time.time()\n\nprint(b.sum())\nprint(\"duration: \", end-start)\n</code></pre>\n\n<p><strong>C++ code with eigen3 (main_eigen.cpp)</strong><br>\nCompilation command: g++ -O3 -I/usr/include/eigen3/ main_eigen.cpp -o prog_eigen</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include \"Eigen/Dense\"\n\n#define Lx 4096\n#define Ly 4000\ntypedef double T;\n\nint main(){\n\n    // Allocating arrays\n    Eigen::Array&lt;T, -1, -1&gt; KPM_ghosts(Lx, Ly), KPM_ghosts1(Lx, Ly), b(Lx,Ly);\n\n    // Filling the arrays\n    KPM_ghosts.setRandom();\n    KPM_ghosts1.setRandom();\n\n    // Coefficient-wise product\n    auto start = std::chrono::system_clock::now();\n    b = KPM_ghosts*KPM_ghosts1;\n\n    // Compute the elapsed time\n    auto end = std::chrono::system_clock::now();\n    std::chrono::duration&lt;double&gt; elapsed_seconds = end-start;\n    std::cout &lt;&lt; \"elapsed time: \" &lt;&lt; elapsed_seconds.count() &lt;&lt; \"s\\n\";\n\n    // Print the sum so the compiler doesn't optimize the code away\n    std::cout &lt;&lt; b.sum() &lt;&lt; \"\\n\";\n\n    return 0;\n}\n\n</code></pre>\n\n<p><strong>Plain C++ code (main.cpp)</strong><br>\nCompilation command: g++ -O3 main.cpp -o prog</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n\n#define Lx 4096\n#define Ly 4000\n#define N Lx*Ly\ntypedef double T;\n\nint main(){\n    // Allocating arrays\n    T lin_vector1[N];\n    T lin_vector2[N];\n    T lin_vector3[N];\n\n    // Filling the arrays\n    for(unsigned i = 0; i &lt; N; i++){\n        lin_vector1[i] = std::rand()*1.0/RAND_MAX;\n        lin_vector2[i] = std::rand()*1.0/RAND_MAX;\n    }\n\n    // Coefficient-wise product\n    auto start = std::chrono::system_clock::now();\n    for(unsigned i = 0; i &lt; N; i++)\n        lin_vector3[i] = lin_vector1[i]*lin_vector2[i];\n\n    // Compute the elapsed time\n    auto end = std::chrono::system_clock::now();\n    std::chrono::duration&lt;double&gt; elapsed_seconds = end-start;\n    std::cout &lt;&lt; \"elapsed time: \" &lt;&lt; elapsed_seconds.count() &lt;&lt; \"s\\n\";\n\n    // Print the sum so the compiler doesn't optimize the code away\n    double sum = 0;\n    for(unsigned i = 0; i &lt; N; i++)\n        sum += lin_vector3[i];\n    std::cout &lt;&lt; \"sum: \" &lt;&lt; sum &lt;&lt; \"\\n\";\n\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Runtime of each program 10 times</strong></p>\n\n<p>Plain C++<br>\nelapsed time: 0.210664s<br>\nelapsed time: 0.215406s<br>\nelapsed time: 0.222483s<br>\nelapsed time: 0.21526s<br>\nelapsed time: 0.216346s<br>\nelapsed time: 0.218951s<br>\nelapsed time: 0.21587s<br>\nelapsed time: 0.213639s<br>\nelapsed time: 0.219399s<br>\nelapsed time: 0.213403s<br></p>\n\n<p>Plain C++ with eigen3<br>\nelapsed time: 0.21052s<br>\nelapsed time: 0.220779s<br>\nelapsed time: 0.216269s<br>\nelapsed time: 0.229234s<br>\nelapsed time: 0.212265s<br>\nelapsed time: 0.256714s<br>\nelapsed time: 0.212396s<br>\nelapsed time: 0.248241s<br>\nelapsed time: 0.241537s<br>\nelapsed time: 0.323519s<br></p>\n\n<p>Python <br>\nduration:  0.23946428298950195<br>\nduration:  0.1663036346435547<br>\nduration:  0.17225909233093262<br>\nduration:  0.15922021865844727<br>\nduration:  0.16628384590148926<br>\nduration:  0.15654635429382324<br>\nduration:  0.15859222412109375<br>\nduration:  0.1633443832397461<br>\nduration:  0.1685199737548828<br>\nduration:  0.16393446922302246<br></p>\n"}, {"tags": ["c++", "visual-studio", "navigation", "xml-comments", "peek"], "owner": {"reputation": 195, "user_id": 5587903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e8925b2d926e8972a57d43233d2d185?s=128&d=identicon&r=PG&f=1", "display_name": "ktnr", "link": "https://stackoverflow.com/users/5587903/ktnr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562776023, "creation_date": 1562776023, "question_id": 56974978, "link": "https://stackoverflow.com/questions/56974978/xml-documentation-navigation-for-c-in-visual-studio-as-in-c", "title": "XML Documentation Navigation for C++ in Visual Studio (as in C#)", "body": "<p>There is <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/xml-documentation-visual-cpp?view=vs-2019\" rel=\"nofollow noreferrer\">XML Documentation support for Visual C++</a> with IntelliSense and all for some time now.</p>\n\n<p>Navigation from XML documentation, peek help etc. does not work though. Coming from C#, I dearly miss those functionalities.\nIs there a way to enable this in Visual Studio, maybe via a plugin?</p>\n\n<p>To automatically create XML documentation templates, one can use <a href=\"https://marketplace.visualstudio.com/items?itemName=acmore.CppXmlComments-Generatesxmlcommentsforcprojects\" rel=\"nofollow noreferrer\">CppXmlComments-Plugin</a>.</p>\n"}, {"tags": ["c++", "performance", "optimization", "cpu-architecture", "branch-prediction"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 3, "creation_date": 1562776121, "post_id": 56974967, "comment_id": 100486208, "body": "&quot;<i>My timings for my average case is almost double for the worst case.</i>&quot; What&#39;s wrong with that? Or that is, what&#39;s the problem? Big-O notation does not guarantee real-world performance; it only describes algorithmic complexity."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 2, "creation_date": 1562776154, "post_id": 56974967, "comment_id": 100486225, "body": "@NicolBolas: It&#39;s the opposite of what &quot;worst&quot; means.  You&#39;re right that &quot;worst-case complexity&quot; and &quot;worst-case runtime&quot; do not have to align."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562776225, "post_id": 56974967, "comment_id": 100486265, "body": "<code>__builtin_expect</code> might work for you: <a href=\"https://stackoverflow.com/questions/30130930/is-there-a-compiler-hint-for-gcc-to-force-branch-prediction-to-always-go-a-certa\" title=\"is there a compiler hint for gcc to force branch prediction to always go a certa\">stackoverflow.com/questions/30130930/&hellip;</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1562776368, "post_id": 56974967, "comment_id": 100486341, "body": "Reverse order is not the worst case for all algorithms. For bubble sort perhaps"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1562776444, "post_id": 56974967, "comment_id": 100486377, "body": "The worst case for quicksort depends on your pivot selection."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1562776554, "post_id": 56974967, "comment_id": 100486420, "body": "How many elements are in the vector you are sorting? For the record, branch prediction is a very low-level CPU feature that you probably can&#39;t disable (but you or the compiler could make the code not benefit from it)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1562776634, "post_id": 56974967, "comment_id": 100486454, "body": "Anyway, does your school assignment involve <i>complexity</i> or <i>real world performance</i>? The former is not affected by branch prediction (you cannot analyse complexity by looking at execution times) and the latter is probably too complicated for a school project."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562790562, "post_id": 56974967, "comment_id": 100492396, "body": "@NathanOliver <code>__builtin_expect</code> is not useful for random order because it&#39;s unknown at compile-time whether it&#39;s more likely that the branch will be taken or not."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1562791090, "post_id": 56974967, "comment_id": 100492597, "body": "@molbdnilo What does the traditional implementation of bubble sort look like? I think the OP&#39;s implementation is very common. But yes, it can be slightly improved as discussed in the <a href=\"https://en.wikipedia.org/wiki/Bubble_sort#Optimizing_bubble_sort\" rel=\"nofollow noreferrer\">Wikipedia article</a>.  Although the branch misprediction problem will remain almost the same."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562818836, "post_id": 56974967, "comment_id": 100498578, "body": "@NathanOliver: <code>__builtin_expect</code> has very little to do with branch <i>prediction</i> when compiling for modern x86-64.  There aren&#39;t any hardware branch hints (only Pentium 4 had that).  The actual effect is on branch <i>layout</i>, telling GCC which direction is common so it can make that case fast (e.g. put it on the not-taken path and group the hot code into fewer L1i cache lines.)  Also, <code>__builtin_expect</code> probably makes if-conversion of branching into branchless <code>cmov</code> less likely."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1562819082, "post_id": 56974967, "comment_id": 100498637, "body": "@molbdnilo: this looks exactly like standard Bubble Sort, except it counts upward instead of downward toward zero.  Are you talking about the early-out condition?  If you want to add complexity to gain performance, switch to InsertionSort instead, that&#39;s much better than early-out BubbleSort.  See  <a href=\"https://users.cs.duke.edu/~ola/papers/bubble.pdf\" rel=\"nofollow noreferrer\">Bubble Sort: An Archaeological Algorithmic Analysis</a> (i.e. how did Bubble Sort become popular despite sucking).  The early-out on a no-swap pass was a later addition to classic Bubble Sort.  The main advantage is tiny machine-code size, not perf."}], "answers": [{"tags": [], "owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "is_accepted": false, "score": 2, "last_activity_date": 1562777814, "creation_date": 1562777814, "answer_id": 56975380, "question_id": 56974967, "link": "https://stackoverflow.com/questions/56974967/how-to-disable-branch-prediction-c-mac-intel/56975380#56975380", "title": "How to disable branch prediction C++/Mac/Intel", "body": "<p>Big-O notation is all about <em>asymptotic</em> behavior. In other words, it describes what factors become dominant as the problem size gets bigger.</p>\n\n<p>CPU micro-optimizations like prefetching and branch prediction can have large relative effects at smaller sizes. But the nature of an O(n^2) procedure, relative to an O(n) procedure, is that it <em>will</em> become slower once the problem size is big enough.</p>\n\n<p>So don't bother speculating or worrying about the effects of branch prediction. Just make your array bigger. Try sorting an array of 1 million elements. Or 1 billion. I guarantee you: if you're right about one situation being the worst case, it <em>will</em> get slower than the best case. (Hint: you're not right about that.)</p>\n"}], "owner": {"reputation": 11, "user_id": 5381580, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T3hwHHHhPS0/AAAAAAAAAAI/AAAAAAAAARw/_4DlxLsWofM/photo.jpg?sz=128", "display_name": "Kyle Dagnan", "link": "https://stackoverflow.com/users/5381580/kyle-dagnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562791185, "creation_date": 1562775973, "last_edit_date": 1562791185, "question_id": 56974967, "link": "https://stackoverflow.com/questions/56974967/how-to-disable-branch-prediction-c-mac-intel", "title": "How to disable branch prediction C++/Mac/Intel", "body": "<p>I am working on an assignment for school. Essentially, we are analyzing sorting algorithms and their costs on large sets of numbers. We have a best case (in order already), worst case (reverse order), and average case (random order). However, for almost all of my sorting algorithms, sorting the worst case takes less time than the average case. After reading, it definitely seems like branch prediction is causing this. It is recognizing the pattern (decreasing order) and executing the code quicker than it should be in theory (big O notation).</p>\n\n<p>I've done some research on branch prediction, and while there appears to be ways to optimize it to be faster, I can't find anything on disabling it entirely. Is there a G++ flag I can use? Or a terminal command?</p>\n\n<p>This is an example of my bubble sort algorithm:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void bubble(vector&lt;long&gt; &amp;vector) {\n    for (int i = 0; i &lt; vector.size() - 1; i++){\n        for (int j = 0; j &lt; vector.size() - i - 1; j++) {\n            if (vector[j] &gt; vector[j + 1]) {\n                long tmp = vector[j];\n                vector[j] = vector[j+1];\n                vector[j+1] = tmp;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>My timings for my average case is almost double for the worst case.</p>\n"}, {"tags": ["c++", "windows", "winapi", "advapi32"], "answers": [{"tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": true, "score": 3, "last_activity_date": 1562776753, "creation_date": 1562776753, "answer_id": 56975134, "question_id": 56974816, "link": "https://stackoverflow.com/questions/56974816/how-to-enumerate-all-sids-to-which-a-specified-user-privilege-has-been-assigned/56975134#56975134", "title": "How to enumerate all SIDs to which a specified user privilege has been assigned? c++", "body": "<p><code>LsaEnumerateAccountsWithUserRight</code> fills in a <strong>pointer</strong> to a <code>LSA_ENUMERATION_INFORMATION</code>, so you need to change this:</p>\n\n<pre><code>LSA_ENUMERATION_INFORMATION pEnumInfo;\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>LSA_ENUMERATION_INFORMATION *pEnumInfo;\n</code></pre>\n\n<p>and to access the first SID returned, change this:</p>\n\n<pre><code>PSID pSid=pEnumInfo.Sid;\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>PSID pSid=pEnumInfo-&gt;Sid;\n</code></pre>\n\n<p>Then it works.</p>\n\n<p>Don't forget to free the structures returned with <code>LsaFreeMemory</code> when you are done with them and clean up with <code>LsaClose</code>.</p>\n"}], "owner": {"reputation": 241, "user_id": 8632386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104279ac6b6fcffcad290e7c5ec43dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tom13000", "link": "https://stackoverflow.com/users/8632386/tom13000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 56975134, "answer_count": 1, "score": 0, "last_activity_date": 1562781507, "creation_date": 1562775348, "last_edit_date": 1562781507, "question_id": 56974816, "link": "https://stackoverflow.com/questions/56974816/how-to-enumerate-all-sids-to-which-a-specified-user-privilege-has-been-assigned", "title": "How to enumerate all SIDs to which a specified user privilege has been assigned? c++", "body": "<p>I am on Windows and C ++\nI would like to recover all SIDs for a given privilege. \nTo recover the SIDs I used the following methods :\nLsaOpenPolicy, LsaEnumerateAccountsWithUserRight and ConvertSidToStringSidA.\nThe problem comes from the ConvertSidToStringSidA method that returns the error : Invalid SID. \nHere is the code I used :</p>\n\n<pre><code>    LSA_HANDLE lsaPolicyHandle;\n    LSA_OBJECT_ATTRIBUTES lsaObjectAttributes;\n    ZeroMemory(&amp;lsaObjectAttributes, sizeof (lsaObjectAttributes));\n    NTSTATUS ntStatus;\n\n    ntStatus=LsaOpenPolicy(nullptr,&amp;lsaObjectAttributes, POLICY_ALL_ACCESS, &amp;lsaPolicyHandle);\n\n    //Here ntstatus == ERROR_SUCCESS\n    if(ntStatus != ERROR_SUCCESS)\n    {\n        qDebug()&lt;&lt;\"error\";\n    }\n    LSA_UNICODE_STRING lsaUSerRight;\n    DWORD64 dwLen=0;\n    LPCWSTR pcwStr = L\"SeServiceLogonRight\";\n    dwLen = wcslen(pcwStr);\n    lsaUSerRight.Buffer = const_cast&lt;wchar_t*&gt;(pcwStr);\n    lsaUSerRight.Length = static_cast&lt;unsigned short&gt;(dwLen) * sizeof(WCHAR);\n    lsaUSerRight.MaximumLength= static_cast&lt;unsigned short&gt;(dwLen+1) *sizeof(WCHAR);\n\n    LSA_ENUMERATION_INFORMATION pEnumInfo;\n    ULONG ulCount;\n    ntStatus=LsaEnumerateAccountsWithUserRight(lsaPolicyHandle,\n                                               &amp;lsaUSerRight,\n                                               reinterpret_cast&lt;PVOID*&gt;(&amp;pEnumInfo),\n                                               &amp;ulCount);\n    //Here ntstatus == ERROR_SUCCESS\n    if(ntStatus != ERROR_SUCCESS)\n    {\n       qDebug()&lt;&lt;\"error\";\n    }\n    //here pEnumInfo has an adress 0x45FF34c et ulCount = 2\n    LPSTR lpStringSid;\n    PSID pSid=pEnumInfo.Sid;\n\n   //Here invalid SID  \n    BOOL bResultConvert=ConvertSidToStringSidA(pSid, &amp;lpStringSid);\n\n    if(bResultConvert==0)\n    {\n        qDebug()&lt;&lt;\"error\";\n    }\n\n</code></pre>\n"}, {"tags": ["c++", "boost"], "comments": [{"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1562774881, "post_id": 56974599, "comment_id": 100485557, "body": "<code>&quot;hello&quot;</code> this is string literal, so its type is <code>const char*</code>, try <code>typeid(const char*)</code>."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1562775258, "post_id": 56974599, "comment_id": 100485772, "body": "Note: if you&#39;re using <code>any::type</code>, and you&#39;re calling it more than once, you&#39;re using <code>any</code> wrong, and you should probably be using a <code>variant</code>."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 3, "last_activity_date": 1562775071, "creation_date": 1562775071, "answer_id": 56974732, "question_id": 56974599, "link": "https://stackoverflow.com/questions/56974599/how-can-i-find-out-if-boostany-contains-a-literal-string/56974732#56974732", "title": "How can I find out if boost::any contains a literal string?", "body": "<blockquote>\n  <p>How can I find out if Boost any contains a literal string?</p>\n</blockquote>\n\n<p>String literals are arrays of <code>const char</code>. <code>boost::any</code> stores decayed types, so string literal will be a <code>const char*</code>.</p>\n\n<p>Note that there is no guarantee for the <code>const char*</code> to be a string literal. It can be a pointer to any character, not just the first character of a string literal.</p>\n"}], "owner": {"reputation": 4558, "user_id": 135807, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/9a321fcae67e54d6ff1c8971e036ce47?s=128&d=identicon&r=PG", "display_name": "Aftershock", "link": "https://stackoverflow.com/users/135807/aftershock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56974732, "answer_count": 1, "score": 0, "last_activity_date": 1562785470, "creation_date": 1562774534, "last_edit_date": 1562785470, "question_id": 56974599, "link": "https://stackoverflow.com/questions/56974599/how-can-i-find-out-if-boostany-contains-a-literal-string", "title": "How can I find out if boost::any contains a literal string?", "body": "<p>I have this code</p>\n\n<pre><code>#include &lt;boost/any.hpp&gt;\n\nstd::vector&lt;boost::any&gt; a(  {1,2,3,\"hello\",3.0});\nfor (int i = 0; i &lt; a.size();i++)\n{\n    if (a[i].type() == typeid(int)) // this works\n    {\n        std::cout &lt;&lt; \"int\";\n    }\n    if (a[i].type() == typeid(char*)) // this does not work I know why\n    {\n        std::cout &lt;&lt; \"char*\";\n    }\n}\n</code></pre>\n\n<p>What <code>if</code> statement should I use to detect <code>\"hello\"</code>, or any sized literal string?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 2528, "user_id": 4658169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b351ed2ce7ddde5ab5ac9bd96200a62d?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouslyRecurringThoughts", "link": "https://stackoverflow.com/users/4658169/curiouslyrecurringthoughts"}, "edited": false, "score": 3, "creation_date": 1562774194, "post_id": 56974470, "comment_id": 100485205, "body": "When you say delete, you mean remove the line from your code or are you using the keyword delete (<a href=\"https://stackoverflow.com/questions/6077143/disable-copy-constructor\" title=\"disable copy constructor\">stackoverflow.com/questions/6077143/disable-copy-constructo&zwnj;&#8203;r</a>)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1562774261, "post_id": 56974470, "comment_id": 100485243, "body": "Sounds like you could use a <a href=\"http://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good C++ book</a>."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1562774316, "post_id": 56974470, "comment_id": 100485274, "body": "What do you mean by &quot;delete&quot; exactly? The classes in your example don&#39;t have deleted constructors, and nowhere do you do <code>B Obj2 = ob1</code>. Create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562774323, "post_id": 56974470, "comment_id": 100485277, "body": "Removing from code is not enough. <code>c++</code> will provide them for you. You need <a href=\"https://stackoverflow.com/questions/5513881/meaning-of-delete-after-function-declaration\" title=\"meaning of delete after function declaration\">stackoverflow.com/questions/5513881/&hellip;</a>"}, {"owner": {"reputation": 46, "user_id": 9953540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LB9J0.jpg?s=128&g=1", "display_name": "Yehonatan", "link": "https://stackoverflow.com/users/9953540/yehonatan"}, "edited": false, "score": 0, "creation_date": 1562774643, "post_id": 56974470, "comment_id": 100485441, "body": "When I mean&#39;t delete, It&#39;s removing the line by //, as if we didn&#39;t had the Copy Constructor"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1562774740, "post_id": 56974470, "comment_id": 100485484, "body": "@Yoni Show the program that you are asking about. Also, explain why you expect a compilation error."}, {"owner": {"reputation": 2673, "user_id": 11292489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cucr6.jpg?s=128&g=1", "display_name": "Gilles-Philippe Paill&#233;", "link": "https://stackoverflow.com/users/11292489/gilles-philippe-paill%c3%a9"}, "edited": false, "score": 2, "creation_date": 1562774928, "post_id": 56974470, "comment_id": 100485584, "body": "If you do not provide a copy constructor, the compiler will provide the default copy constructor (member-wise copy). Thus, if you comment B&#39;s copy constructor, the member <code>a</code> will get copied and will call A&#39; copy constructor, which is custom and print stuff on the screen. If you also comment A&#39;s custom copy constructor, the default copy constructor will be called (and do nothing since there is nothing to copy). Thus, commenting both copy constructors won&#39;t ignore <code>B object2 (object1);</code>, it will simply use the default copy."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1562775257, "post_id": 56974470, "comment_id": 100485771, "body": "The syntax to delete the copy constructor is:  <code>B(B const&amp;) = delete;</code>"}, {"owner": {"reputation": 46, "user_id": 9953540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LB9J0.jpg?s=128&g=1", "display_name": "Yehonatan", "link": "https://stackoverflow.com/users/9953540/yehonatan"}, "edited": false, "score": 0, "creation_date": 1562775514, "post_id": 56974470, "comment_id": 100485906, "body": "Thank you Phillipe"}], "owner": {"reputation": 46, "user_id": 9953540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LB9J0.jpg?s=128&g=1", "display_name": "Yehonatan", "link": "https://stackoverflow.com/users/9953540/yehonatan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1562775014, "answer_count": 0, "score": 0, "last_activity_date": 1562774453, "creation_date": 1562774065, "last_edit_date": 1562774453, "question_id": 56974470, "link": "https://stackoverflow.com/questions/56974470/copy-constructor-detailed", "closed_reason": "Duplicate", "title": "Copy Constructor - Detailed", "body": "<p>When we remove(//) B's Copy Constructor we go to A's Copy Constructor, and when we remove (//) A's Copy Constructor too, it ignores \"B object2 = object1\" and dosen't throw compilation error.  Can anyone explain why?    </p>\n\n<pre><code>    #include &lt;iostream&gt;\n\nusing namespace std;\n\n#include &lt;iostream&gt;\n    using namespace std;\n    class A {\n    public:\n        A() { cout &lt;&lt; \"A(0)\" &lt;&lt; endl; }\n        A(const A&amp; a) { cout &lt;&lt; \"A(1)\" &lt;&lt; endl; }\n    };\n\n     class B {\n     public:\n        B() : a() { cout &lt;&lt; \"B(0)\" &lt;&lt; endl; }\n       B(const B&amp; b) { cout &lt;&lt; \"B(1)\" &lt;&lt; endl; }\n    private:\n        A a;\n    };\n\n\n    int main() {\n      B object1;\n      B object2 (object1);\n      return 0;\n    }\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1362, "user_id": 1366027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8113fc570a09e03414126d8cda5f971c?s=128&d=identicon&r=PG", "display_name": "pcarter", "link": "https://stackoverflow.com/users/1366027/pcarter"}, "edited": false, "score": 2, "creation_date": 1562776043, "post_id": 56974433, "comment_id": 100486169, "body": "It&#39;s not clear exactly what problem you are having. What is the result of the above code and how is it different than what you desire? That being said, using == to compare floating point numbers is asking for trouble. See <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html</a> Also, it would be a good idea to separate the logic of your flocking algorithm from the GUI. This makes the code clearer and allows it to be tested independently."}, {"owner": {"reputation": 45, "user_id": 11110369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hKD5r.jpg?s=128&g=1", "display_name": "Geralt of Rivia", "link": "https://stackoverflow.com/users/11110369/geralt-of-rivia"}, "reply_to_user": {"reputation": 1362, "user_id": 1366027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8113fc570a09e03414126d8cda5f971c?s=128&d=identicon&r=PG", "display_name": "pcarter", "link": "https://stackoverflow.com/users/1366027/pcarter"}, "edited": false, "score": 0, "creation_date": 1562776395, "post_id": 56974433, "comment_id": 100486353, "body": "@pcarter The result is the foxes move up to the rabbit but only up as it is first to be processed. This is because the difference is so small because the time elapsed is in micro seconds."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 2, "creation_date": 1562777680, "post_id": 56974433, "comment_id": 100486944, "body": "You also have a whole lot of positioning/moving logic crammed in. Try to separate that from the &quot;fun&quot; part of the code. <a href=\"https://godbolt.org/z/YC3nYZ\" rel=\"nofollow noreferrer\">Example @ godbolt</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4859, "user_id": 7431860, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/P6Jko.jpg?s=128&g=1", "display_name": "Nick Reed", "link": "https://stackoverflow.com/users/7431860/nick-reed"}, "is_accepted": true, "score": 1, "last_activity_date": 1562779681, "last_edit_date": 1562779681, "creation_date": 1562779242, "answer_id": 56975711, "question_id": 56974433, "link": "https://stackoverflow.com/questions/56974433/best-way-to-create-a-flocking-algorithm-for-a-group-of-foxes-chasing-a-rabbit/56975711#56975711", "title": "Best way to create a flocking algorithm for a group of foxes chasing a rabbit", "body": "<p>A couple months back, I stumbled upon <a href=\"http://harry.me/blog/2011/02/17/neat-algorithms-flocking/\" rel=\"nofollow noreferrer\">this terrific blog post</a>, which explains the \"boid\" flocking behavior. To create lifelike movement in your foxes, there's a few things you'll need to do. A quick summary:</p>\n\n<ul>\n<li>Every fox needs to be aware of the rabbit, so they can follow it around.</li>\n<li>Every fox needs to be aware of every other fox, so they can behave properly. You only mention moving apart from one another (separation), but there's a few more options:\n\n<ul>\n<li><strong>Separation</strong> is a behavior where, if a fox moves to close to another fox, both of them try to drift apart.</li>\n<li><strong>Cohesion</strong> is a behavior where, if there is a \"group\" of foxes together, each one tries to move towards the center of the group.</li>\n<li><strong>Alignment</strong> is a behavior where, if a fox encounters a group moving in a certain direction, it will try to match that direction.</li>\n</ul></li>\n</ul>\n\n<p>For your example, if the foxes are strictly behaving to chase the rabbit and stay apart from one another, you'll want to use separation. Here's what the pseudocode might look like, if you store the foxes in an array.</p>\n\n<pre><code>fox foxarray[size_of_array]\nrabbit rabb\n\n//separate the foxes if they get too close\nfor(each fox in foxarray) {\n  current_fox = //the fox you're checking\n  for(every other fox in foxarray) {\n    other_fox = //the other ones you'll look at\n\n    if(distanceFrom(current_fox, other_fox) &lt; some_threshold_value) {\n      /*\n      use a function to check the positions of the foxes,\n      and then adjust their velocities to move away from \n      one another.\n      */\n      move_apart(curernt_fox, other_fox) \n    }\n  }\n}\n\n//chase the rabbit\nfor(each fox in foxarray) {\n  current_fox = //the fox you're checking\n/*\nthis would check their positions, and then adjust the fox's velocity \nto move it towards the rabbit. \ni'm assuming the rabbit is player-controlled, so its velocity\nwouldn't be changed\n*/\n  move_towards(current_fox, rabb) \n}\n</code></pre>\n\n<p>But what about the functions?</p>\n\n<pre><code>void move_apart(fox f1, fox f2) {\n\n  //set f1's velocity away from f2\n  //first, get f2's position relative to f1, then add velocity\n  //to move away from it\n  f2xPos = f2.x - f1.x;\n  f2yPos = f2.y - f1.y;\n\n\n  if(f2xPos &lt; 0) {\n    //if f2xPos is negative, add some positive x velocity to move away\n    f1xVel += some_velocity;\n  }\n  else {\n    //add some negative velocity to move away\n    f1xVel -= some_velocity;\n  }\n\n  //repeat for f2 - or, alternatively, call move_apart() with\n  //f2 and f1 flipped.\n\n}\n\n//============================================================\n\nvoid move_towards(fox f, rabbit r) {\n\n  //very similar to move_apart, but you'd flip the signs of\n  //the velocity so you can move the fox towards the rabbit.\n\n}\n</code></pre>\n\n<p>These are just bare-bones examples, and I've found that much better movement can be achieved if you factor in how far apart the foxes are from one another, i.e. the closer they are, the faster they try to move apart. I also find that if you represent their positions and velocities as 2D vectors (the &lt;x, y&gt; kind, not the <code>std::vector</code> self-expanding arrays) it becomes easier to manage them. </p>\n\n<p>If you're willing to refactor your code and/or are planning to make the game bigger, I very strongly recommend separating the moving entities (foxes and rabbits) into their own classes, instead of arrays of doubles in your engine class. This makes it much, much easier to implement the entities' functions, change their behaviors, and keep track of their positions and velocities.</p>\n\n<p>Additionally, if you're encountering framerate issues with the program furiously checking the positions of the foxes every frame at hundreds of frames per second, maybe consider <code>usleep()</code> between frames to slow down the execution.</p>\n\n<p>Good luck with your game!</p>\n"}], "owner": {"reputation": 45, "user_id": 11110369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hKD5r.jpg?s=128&g=1", "display_name": "Geralt of Rivia", "link": "https://stackoverflow.com/users/11110369/geralt-of-rivia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 56975711, "answer_count": 1, "score": 0, "last_activity_date": 1562779681, "creation_date": 1562773933, "last_edit_date": 1562774239, "question_id": 56974433, "link": "https://stackoverflow.com/questions/56974433/best-way-to-create-a-flocking-algorithm-for-a-group-of-foxes-chasing-a-rabbit", "title": "Best way to create a flocking algorithm for a group of foxes chasing a rabbit", "body": "<p>The program is updating constantly every frame and its making it difficult to calculate the distance between a fox and the rabbit.(it will be an almost identical value)</p>\n\n<p>I have tried using doubles so that distance value would compensate for a small change but that hasn't worked.</p>\n\n<pre><code>define OLC_PGE_APPLICATION\n#include \"olcPixelGameEngine.h\"\n\nint x = 0;\nclass Example : public olc::PixelGameEngine\n{\nprivate:\n    olc::Sprite* rabbit;\n    olc::Sprite* bush;\n    olc::Sprite* fox;\n    olc::Sprite* evilfox;\n    int size = 3;\n    double rabbitPosX = 30.0;\n    double rabbitPosY = 30.0;\n    double rabbitXvel = 0.0;\n    double rabbitYvel = 0.0;\n    double FoxPosX[3] = { 50.0f,80.0f,70.0};\n    double FoxPosY[3] = { 80.0f,50.0f,200.0};\n    double FoxXvel = 0.0;\n    double FoxYvel = 0.0;\n\npublic:\n    Example()\n    {\n        sAppName = \"Example\";\n    }\n\npublic:\n    double distanceForm(double x1, double x2, double y1, double y2)\n    {\n        double distance = sqrt((x2 - x1)*(x2 - x1) + (y2 - y1)*(y2 - y1));\n        return distance;\n    }\n    bool checkCurFox(double arrX[], double arrY[], int size, int count)\n    {       \n        for (int i = count+1; i &lt; size; i++)\n        {\n            if (distanceForm(arrX[count], arrX[i], arrY[count], arrY[i]) &gt; 15)\n            {\n                return true;\n            }\n        }\n\n    }\n    double moveRabbitX(double rabbitX, double VelX, double ETime)\n    {\n        if (VelX &gt; 0)\n        {\n            double NewrabbitX = rabbitX + VelX * ETime;\n            return NewrabbitX;\n        }\n        double NewrabbitX = rabbitX + VelX * ETime;\n        return NewrabbitX;\n    }\n    double moveRabbitY(double rabbitY, double VelY, double ETime)\n    {\n        if (VelY &gt; 0)\n        {\n            double NewrabbitY = rabbitY + VelY * ETime;\n            return NewrabbitY;\n        }\n        double NewrabbitY = rabbitY + VelY * ETime;\n        return NewrabbitY;      \n    }\n    double moveFoxX(double FoxX, double VelX, double ETime)\n    {\n        if (VelX &gt; 0)\n        {\n            double NewFoxX = FoxX + VelX * ETime;\n            return NewFoxX;\n        }\n        double NewFoxX = FoxX + VelX * ETime;\n        return NewFoxX;\n    }\n    double moveFoxY(double FoxY, double VelY, double ETime)\n    {\n        if (VelY &gt; 0)\n        {\n            double NewFoxY = FoxY + VelY * ETime;\n            return NewFoxY;\n        }\n        double NewFoxY = FoxY + VelY * ETime;\n        return NewFoxY;\n\n    }\n    bool OnUserCreate() override\n    {\n        // Called once at the start, so create things here  \n        //DrawRect(0,0,ScreenWidth(),ScreenHeight(),olc::DARK_VERY_DARK_GREEN);\n\n        /*DrawSprite(30,40,)*/\n        FillRect(0, 0, ScreenWidth(), ScreenHeight(), olc::VERY_DARK_GREEN);\n        DrawString(80, 0, \"Fox Escape\", olc::RED, 1);\n        rabbit =new olc::Sprite(\"Rabbit.png\");\n        DrawSprite(30, 30, rabbit,1);\n        /*bush = new olc::Sprite(\"Bush.png\");\n        DrawSprite(50, 50, bush, 2);*/\n        fox = new olc::Sprite(\"Fox.png\");\n        //DrawSprite(50, 70, fox, 1);\n        evilfox = new olc::Sprite(\"evilfox.png\");   \n        return true;\n    }\n    bool OnUserUpdate(float fElapsedTime) override\n    {\n\n        int Omg = 1;\n        // called once per frame\n        for (int j = 0; j &lt; 3; j++)\n        {\n            double distance = distanceForm(rabbitPosX, FoxPosX[j], rabbitPosY, FoxPosY[j]);\n            double distanceMxUp = distanceForm(rabbitPosX, FoxPosX[j], rabbitPosY, moveFoxY(FoxPosY[j], -20, fElapsedTime));\n            double distanceMxDown = distanceForm(rabbitPosX, FoxPosX[j], rabbitPosY, moveFoxY(FoxPosY[j], +20, fElapsedTime));\n            double distanceMyRight = distanceForm(moveFoxX(FoxPosX[j], 20, fElapsedTime), rabbitPosX, FoxPosY[j], rabbitPosY);\n            double distanceMyLeft = distanceForm(moveFoxX(FoxPosX[j], -20, fElapsedTime), rabbitPosX, FoxPosY[j], rabbitPosY);\n\n            double arr[4] = { distanceMxUp,distanceMxDown,distanceMyRight,distanceMyLeft };\n            double temp;\n            for (int i = 0; i &lt; 3; i++)\n            {\n                for (int j = i + 1; j &lt; 3; j++)\n                {\n                    if (arr[i] &gt; arr[j])\n                    {\n                        temp = arr[i];\n                        arr[i] = arr[j];\n                        arr[j] = temp;\n                    }\n                }\n            }\n            int tempX = FoxPosX[j];\n            int tempY = FoxPosY[j];\n            for (int k = 0; k &lt; 3; k++)\n            {\n                if (checkCurFox(FoxPosX, FoxPosY, size, j))\n                {\n                    if (arr[k] == distanceMxUp)\n                    {\n                        k = 3;\n                        double NewFoxY = moveFoxY(FoxPosY[j], -10, fElapsedTime);\n                        FillRect(FoxPosX[j], FoxPosY[j], 15, 15, olc::VERY_DARK_GREEN);\n                        FoxPosY[j] = NewFoxY;\n                        DrawSprite(FoxPosX[j], FoxPosY[j], fox, 1);\n                        if (distance &lt; 6)\n                        {\n                            FillRect(0, 0, ScreenWidth(), ScreenHeight(), olc::Pixel(0, 0, 0));\n                            DrawSprite(0, 0, evilfox, 1);\n                        }\n                    }\n                    if (arr[k] == distanceMxDown)\n                    {\n                        k = 3;\n                        double NewFoxY = moveFoxY(FoxPosY[j], 10, fElapsedTime);\n                        FillRect(FoxPosX[j], FoxPosY[j], 15, 15, olc::VERY_DARK_GREEN);\n                        FoxPosY[j] = NewFoxY;\n                        DrawSprite(FoxPosX[j], FoxPosY[j], fox, 1);\n                        if (distance &lt; 6)\n                        {\n                            FillRect(0, 0, ScreenWidth(), ScreenHeight(), olc::Pixel(0, 0, 0));\n                            DrawSprite(0, 0, evilfox, 1);\n                        }\n                    }\n                    if (arr[k] == distanceMyRight)\n                    {\n                        k = 3;\n                        double NewFoxX = moveFoxX(FoxPosX[j], 10, fElapsedTime);\n                        FillRect(FoxPosX[j], FoxPosY[j], 15, 15, olc::VERY_DARK_GREEN);\n                        FoxPosX[j] = NewFoxX;\n                        DrawSprite(FoxPosX[j], FoxPosY[j], fox, 1);\n                        if (distance &lt; 6)\n                        {\n                            FillRect(0, 0, ScreenWidth(), ScreenHeight(), olc::Pixel(0, 0, 0));\n                            DrawSprite(0, 0, evilfox, 1);\n                        }\n                    }\n                    if (arr[k] == distanceMyLeft)\n                    {\n                        k = 3;\n                        double NewFoxX = moveFoxX(FoxPosX[j], -10, fElapsedTime);\n                        FillRect(FoxPosX[j], FoxPosY[j], 15, 15, olc::VERY_DARK_GREEN);\n                        FoxPosX[j] = NewFoxX;\n                        DrawSprite(FoxPosX[j], FoxPosY[j], fox, 1);\n                        if (distance &lt; 6)\n                        {\n                            FillRect(0, 0, ScreenWidth(), ScreenHeight(), olc::Pixel(0, 0, 0));\n                            DrawSprite(0, 0, evilfox, 1);\n                        }\n                    }\n                }\n            }\n        }\n        if (GetKey(olc::Key::RIGHT).bHeld)\n        {\n            rabbitXvel = 30.0f;\n            double NewrabbitX = moveRabbitX(rabbitPosX, rabbitXvel, fElapsedTime);\n            FillRect(rabbitPosX, rabbitPosY, 7, 8,olc::VERY_DARK_GREEN);\n            rabbitPosX = NewrabbitX;\n            DrawSprite(rabbitPosX, rabbitPosY, rabbit);     \n        }\n        if (GetKey(olc::Key::LEFT).bHeld)\n        {\n            rabbitXvel = -30.0f;\n            double NewrabbitX = moveRabbitX(rabbitPosX, rabbitXvel, fElapsedTime);\n            FillRect(rabbitPosX, rabbitPosY, 7, 8, olc::VERY_DARK_GREEN);\n            rabbitPosX = NewrabbitX;\n            DrawSprite(rabbitPosX, rabbitPosY, rabbit);\n        }\n        if (GetKey(olc::Key::UP).bHeld)\n        {\n            rabbitYvel = -30.0f;\n            double NewrabbitY = moveRabbitY(rabbitPosY, rabbitYvel, fElapsedTime);\n            FillRect(rabbitPosX, rabbitPosY, 7, 8, olc::VERY_DARK_GREEN);\n            rabbitPosY = NewrabbitY;\n            DrawSprite(rabbitPosX, rabbitPosY, rabbit);\n\n        }\n        if (GetKey(olc::Key::DOWN).bHeld)\n        {\n            rabbitYvel = 30.0f;\n            double NewrabbitY = moveRabbitY(rabbitPosY, rabbitYvel, fElapsedTime);\n            FillRect(rabbitPosX, rabbitPosY, 7, 8, olc::VERY_DARK_GREEN);\n            rabbitPosY = NewrabbitY;\n            DrawSprite(rabbitPosX, rabbitPosY, rabbit);\n\n        }\n\n        //Draw(rabbitPosX, rabbitPosY, olc::YELLOW);\n\n        return true;\n    }\n};\n\nint main()\n{\n    Example demo;\n    if (demo.Construct(256, 240, 4, 4))\n        demo.Start();\n\n    return 0;\n}\n</code></pre>\n\n<p>I want the foxes to avoid colliding with each other.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 1590, "user_id": 3796272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zqSzP.jpg?s=128&g=1", "display_name": "Kampi", "link": "https://stackoverflow.com/users/3796272/kampi"}, "edited": false, "score": 0, "creation_date": 1562774045, "post_id": 56974401, "comment_id": 100485127, "body": "Please check the <a href=\"https://wiki.qt.io/How_to_create_a_multi_language_application/de\" rel=\"nofollow noreferrer\">Qt wiki</a>."}, {"owner": {"reputation": 63, "user_id": 11364103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bu87Sb6nbO8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdX5Ol0CGay5URzcfPsOLk4PyKGtw/mo/photo.jpg?sz=128", "display_name": "Steven Cao", "link": "https://stackoverflow.com/users/11364103/steven-cao"}, "reply_to_user": {"reputation": 1590, "user_id": 3796272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zqSzP.jpg?s=128&g=1", "display_name": "Kampi", "link": "https://stackoverflow.com/users/3796272/kampi"}, "edited": false, "score": 0, "creation_date": 1562774762, "post_id": 56974401, "comment_id": 100485499, "body": "Thanks for your quick reply. I already read this wiki before. But, I did not see the solution for my case."}, {"owner": {"reputation": 1590, "user_id": 3796272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zqSzP.jpg?s=128&g=1", "display_name": "Kampi", "link": "https://stackoverflow.com/users/3796272/kampi"}, "edited": false, "score": 0, "creation_date": 1562776116, "post_id": 56974401, "comment_id": 100486206, "body": "You can&#180;t translate during compilation. The translation is done during runtime, so you have to translate the widgets at the application runtime."}], "owner": {"reputation": 63, "user_id": 11364103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bu87Sb6nbO8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdX5Ol0CGay5URzcfPsOLk4PyKGtw/mo/photo.jpg?sz=128", "display_name": "Steven Cao", "link": "https://stackoverflow.com/users/11364103/steven-cao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562784108, "creation_date": 1562773818, "last_edit_date": 1562784108, "question_id": 56974401, "link": "https://stackoverflow.com/questions/56974401/qt-multi-language-support-for-the-default-text-in-a-widget", "title": "QT: Multi language support for the default TEXT in a Widget", "body": "<p>How can I add multi language support for a default TEXT in a Widget?\nFor example, if I added a Button Widget from the GUI window (form) and set it default TEXT as 'Transfer' (in other words, this widget is in a '.ui' file), how can I add multi language support for it?</p>\n\n<p>Where can I add the 'tr(Transfer)' transaction for it?</p>\n"}, {"tags": ["c++", "vector", "segmentation-fault"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562773238, "post_id": 56974217, "comment_id": 100484642, "body": "Please <b><a href=\"https://stackoverflow.com/posts/56974217/edit\">edit</a></b> your question with an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> or <a href=\"http://sscce.org\" rel=\"nofollow noreferrer\">SSCCE (Short, Self Contained, Correct Example)</a>"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 3, "creation_date": 1562773250, "post_id": 56974217, "comment_id": 100484652, "body": "Are you sure that <code>dataSet</code> has size &gt;= 2 when you print it in <code>main</code>?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1562773325, "post_id": 56974217, "comment_id": 100484706, "body": "Why are you doing <code>cout &lt;&lt;  dataSet[1]</code> in the for loop?"}, {"owner": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "edited": false, "score": 0, "creation_date": 1562773356, "post_id": 56974217, "comment_id": 100484720, "body": "This <code>cout &lt;&lt;  dataSet[1] &lt;&lt; *i &lt;&lt; endl;</code> inside your main seems fishy, what are you trying to do here?"}, {"owner": {"reputation": 143, "user_id": 1363078, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c2bfe0201b7859cfc7621d19f8b1cbcc?s=128&d=identicon&r=PG", "display_name": "THE-E", "link": "https://stackoverflow.com/users/1363078/the-e"}, "edited": false, "score": 0, "creation_date": 1562773374, "post_id": 56974217, "comment_id": 100484737, "body": "I wanted to test, whether it works. I will clean it up. Sorry for that."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562773542, "post_id": 56974217, "comment_id": 100484828, "body": "Does it still crash with it removed?"}, {"owner": {"reputation": 143, "user_id": 1363078, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c2bfe0201b7859cfc7621d19f8b1cbcc?s=128&d=identicon&r=PG", "display_name": "THE-E", "link": "https://stackoverflow.com/users/1363078/the-e"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562773667, "post_id": 56974217, "comment_id": 100484905, "body": "@NathanOliver Yes, it still crashes."}, {"owner": {"reputation": 143, "user_id": 1363078, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c2bfe0201b7859cfc7621d19f8b1cbcc?s=128&d=identicon&r=PG", "display_name": "THE-E", "link": "https://stackoverflow.com/users/1363078/the-e"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1562773670, "post_id": 56974217, "comment_id": 100484906, "body": "@Yksisarvinen Yes the data.dat file has 3 Line with entries."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1562773677, "post_id": 56974217, "comment_id": 100484910, "body": "<code>Segmentation fault using vectors in C++?</code> -- Replace the usage of <code>[ ]</code> with <code>at()</code>.  I bet you no longer get the segmentation fault, but an actual exception thrown (<code>std::out_of_range</code>).  Also, your exception handling for an invalid double is faulty -- your code continues on as if there is nothing wrong."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 2, "creation_date": 1562773749, "post_id": 56974217, "comment_id": 100484953, "body": "Maybe the bug is in operator&lt;&lt;( ) or something in <code>Record</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562773758, "post_id": 56974217, "comment_id": 100484957, "body": "Then we need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 143, "user_id": 1363078, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c2bfe0201b7859cfc7621d19f8b1cbcc?s=128&d=identicon&r=PG", "display_name": "THE-E", "link": "https://stackoverflow.com/users/1363078/the-e"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562773897, "post_id": 56974217, "comment_id": 100485044, "body": "@drescherjm I will post the definition of the operator&lt;&lt;() in the post in a second"}, {"owner": {"reputation": 1492, "user_id": 776788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/227fcf39e6bdc1a86340fc1b32614140?s=128&d=identicon&r=PG", "display_name": "Demolishun", "link": "https://stackoverflow.com/users/776788/demolishun"}, "edited": false, "score": 0, "creation_date": 1562774039, "post_id": 56974217, "comment_id": 100485123, "body": "Have you stepped through code with a debugger?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562774053, "post_id": 56974217, "comment_id": 100485135, "body": "<code>amount *= 100.0; &#47;&#47;to correct the decimal format</code> -- Since <code>amount</code> is uninitialized, this could do all sorts of weird stuff, including crash, if the exception before that line was thrown."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 5, "creation_date": 1562774175, "post_id": 56974217, "comment_id": 100485193, "body": "<code>ostream &amp;operator&lt;&lt;</code> -- You really should heed the warnings your compiler is giving you.  You are not returning a value here, thus the behavior is undefined."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 1363078, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c2bfe0201b7859cfc7621d19f8b1cbcc?s=128&d=identicon&r=PG", "display_name": "THE-E", "link": "https://stackoverflow.com/users/1363078/the-e"}, "edited": false, "score": 0, "creation_date": 1562774657, "post_id": 56974554, "comment_id": 100485449, "body": "Thank you so much! It works! It is really strange, that it worked with a directly created object. Only after adding -Wall to my gcc-compiler the warning was visible. Lesson learned. My IDE didn&#39;t show me anything either. Thank you all for your help! I think I would have spent another 3 hours without any result :/"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "reply_to_user": {"reputation": 143, "user_id": 1363078, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c2bfe0201b7859cfc7621d19f8b1cbcc?s=128&d=identicon&r=PG", "display_name": "THE-E", "link": "https://stackoverflow.com/users/1363078/the-e"}, "edited": false, "score": 1, "creation_date": 1562775394, "post_id": 56974554, "comment_id": 100485847, "body": "@THE-E It &quot;worked&quot; with directly created object because you didn&#39;t chain <code>&lt;&lt;</code> calls. In the loop you have <code>cout &lt;&lt; *it</code> which returns some rubbish, and then, the result of this expression is chained with next operator <code>&lt;&lt; endl</code> - it means you do <code>[some rubbish] &lt;&lt; endl;</code>. In general, <i>UB is not reasonable at all</i>, but that&#39;s the most probable explanation."}], "tags": [], "owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "is_accepted": true, "score": 3, "last_activity_date": 1562774678, "last_edit_date": 1562774678, "creation_date": 1562774346, "answer_id": 56974554, "question_id": 56974217, "link": "https://stackoverflow.com/questions/56974217/segmentation-fault-using-vectors-in-c/56974554#56974554", "title": "Segmentation fault using vectors in C++?", "body": "<p>One error is that you are not returning a value from this function:</p>\n\n<p><code>ostream &amp;operator&lt;&lt;(ostream &amp;os, const Record &amp;rec)</code> </p>\n\n<p>Not returning a value from a function declared to return a value is undefined behavior. </p>\n\n<pre><code>ostream &amp;operator&lt;&lt;(ostream &amp;os, const Record &amp;rec)\n{\n    //...\n    return os; // &lt;-- you are missing this line\n}\n</code></pre>\n\n<hr>\n\n<p>The above is the obvious error, but another potential error is within your test for a valid <code>double</code>.  You catch an exception, but then your code goes on as if the <code>double</code> is valid, when it is actually uninitialized.</p>\n\n<pre><code>double amount;  // &lt;--uninitialized.\n//..\ntry\n{\n   amount = stold(amountStr);\n}\ncatch (const std::exception &amp;e)\n{\n   std::cerr &lt;&lt; e.what() &lt;&lt; '\\n' &lt;&lt; \"Conversion error\";\n}\n\namount *= 100.0; // &lt;-- behavior undefined if exception above this line was thrown.\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 1363078, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c2bfe0201b7859cfc7621d19f8b1cbcc?s=128&d=identicon&r=PG", "display_name": "THE-E", "link": "https://stackoverflow.com/users/1363078/the-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 56974554, "answer_count": 1, "score": -1, "last_activity_date": 1589292448, "creation_date": 1562773172, "last_edit_date": 1589292448, "question_id": 56974217, "link": "https://stackoverflow.com/questions/56974217/segmentation-fault-using-vectors-in-c", "title": "Segmentation fault using vectors in C++?", "body": "<p>I am searching for a segmentation fault I have programmed into my code. It basically appears, when my function <code>parseRecord(string)</code> generates a vector and if I want to print out one of the elements. I have narrowed it down to that point, but can't find the error. The vectors are Record objects, which are created by reading a file, which has one row of data each line.</p>\n\n<p>Whenever I create a Object of the class (without creating a vector) I can print the element just fine. It only appears whenever I use the parseRecord(string) function which is creating the vector.</p>\n\n<p>I also tried to print it in the function itself with the same result. So I think it isn't a scope problem.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;iomanip&gt;\n#include &lt;vector&gt;\n\n#include \"record.hpp\"\n\nifstream parsefile(string filename);\nstd::vector&lt;Record&gt; parseRecord(string line);\n\nint main(int argc, char const *argv[])\n{\n    std::vector&lt;Record&gt; dataSet = parseRecord(\"data.dat\");\n\n    Record record(\"D11101001\", \"Max\", \"Muestermann\",\n                  10239, \"fictionalmarkt.com\", \"23.12.19\", \"11:11:00\");\n\n    cout &lt;&lt; record;\n\n    for(std::vector&lt;Record&gt;::const_iterator i = dataSet.begin(); i != dataSet.end(); ++i){\n        cout &lt;&lt; *i &lt;&lt; endl;\n    }\n    return 0;\n}\n\n//METHOD-IMPLEMENTATION\n//parse-file definition - Test if file is accessible\nifstream parsefile(string filename)\n{\n    ifstream inFile(filename);\n    if (!inFile)\n    {\n        cerr &lt;&lt; \"File could not be opened\" &lt;&lt; endl;\n        exit(-1);\n    }\n    cout &lt;&lt; \"Input-file is readable!\" &lt;&lt; endl;\n    return inFile;\n}\n\n//parse-record definition - read file, add to vector&lt;Record&gt; and return vector\nstd::vector&lt;Record&gt; parseRecord(string filename)\n{\n    vector&lt;Record&gt; dataSet;\n\n    ifstream inFile = parsefile(filename);\n    string line;\n\n    while (getline(inFile, line))\n    {\n        stringstream linestream(line);\n        string accountNb;\n        string firstName;\n        string lastName;\n        string amountStr; //format 100 = 1.00\u20ac\n        string merchant;\n        string date;\n        string time;\n        long double amount;\n\n        getline(linestream, accountNb, '|');\n        getline(linestream, firstName, '|');\n        getline(linestream, lastName, '|');\n        getline(linestream, amountStr, '|');\n        getline(linestream, merchant, '|');\n        getline(linestream, date, '|');\n        getline(linestream, time, '\\n');\n\n        try\n        {\n            amount = stold(amountStr);\n        }\n        catch (const std::exception &amp;e)\n        {\n            std::cerr &lt;&lt; e.what() &lt;&lt; '\\n'\n                      &lt;&lt; \"Conversion error\";\n        }\n\n        amount *= 100.0; //to correct the decimal format\n\n        Record recordEntry(accountNb, firstName, lastName, amount, merchant, date, time);\n\n        //cout &lt;&lt; recordEntry &lt;&lt; endl;\n\n        dataSet.push_back(recordEntry);\n    }\n\n    return dataSet;\n}\n</code></pre>\n\n<p>record.hpp</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Record\n{\nprivate:\n    string accountNb;\n    string firstName;\n    string lastName;\n    long double amount; //format 100 = 1.00\u20ac\n    string merchant;\n    string date;\n    string time;\npublic:\n    Record(string, string, string, long double, string, string, string);\n    ~Record();\n    friend ostream&amp; operator&lt;&lt;(ostream&amp;, const Record&amp;);\n};\n\n</code></pre>\n\n<p>record.cpp</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"record.hpp\"\n#include &lt;ostream&gt;\n\nRecord::Record(string accountNb, string firstName, string lastName,\n               long double amount, string merchant, string date, string time)\n{\n    this-&gt;accountNb = accountNb;\n    this-&gt;firstName = firstName;\n    this-&gt;lastName = lastName;\n    this-&gt;amount = amount;\n    this-&gt;merchant = merchant;\n    this-&gt;date = date;\n    this-&gt;time = time;\n}\n\nRecord::~Record()\n{\n}\n\nostream &amp;operator&lt;&lt;(ostream &amp;os, const Record &amp;rec)\n{\n    os &lt;&lt; right;\n    os &lt;&lt; setw(15) &lt;&lt; \"Account Nb:\" &lt;&lt; setw(50) &lt;&lt; rec.getAccountNb() &lt;&lt; endl;\n    os &lt;&lt; setw(15) &lt;&lt; \"First Name:\" &lt;&lt; setw(50) &lt;&lt; rec.getFirstName() &lt;&lt; endl;\n    os &lt;&lt; setw(15) &lt;&lt; \"Last Name:\" &lt;&lt; setw(50) &lt;&lt; rec.getLastName() &lt;&lt; endl;\n    try\n    {\n        os &lt;&lt; showbase;\n        os &lt;&lt; setw(15) &lt;&lt; \"Amount:\" &lt;&lt; setw(50);\n        os.imbue(std::locale(\"de_DE.UTF-8\"));\n        os &lt;&lt; put_money(rec.getAmount(), true) &lt;&lt; endl;\n    }\n    catch (const std::exception &amp;e)\n    {\n        std::cerr &lt;&lt; e.what() &lt;&lt; \"locale not supported system\";\n    }\n    os &lt;&lt; setw(15) &lt;&lt; \"Merchant:\" &lt;&lt; setw(50) &lt;&lt; rec.getMerchant() &lt;&lt; endl;\n    os &lt;&lt; setw(15) &lt;&lt; \"Date:\" &lt;&lt; setw(50) &lt;&lt; rec.getDate() &lt;&lt; endl;\n    os &lt;&lt; setw(15) &lt;&lt; \"Time:\" &lt;&lt; setw(50) &lt;&lt; rec.getTime() &lt;&lt; endl;\n}\n</code></pre>\n\n<p>As result the console prints:</p>\n\n<pre><code>Account Nb:                                         D11101001\nFirst Name:                                               Max\n Last Name:                                       Muestermann\n    Amount:                                       102,39 EUR\nFirst Name:                                             Jonny\n Last Name:                                               Doe\n    Amount:                                        80,38 EUR\n  Merchant:                                          markt.de\n      Date:                                          25.12.19\n      Time:                                         11:11:19\nSegmentation fault (core dumped)\n</code></pre>\n\n<p>So it quits after the first row.</p>\n"}, {"tags": ["c++", "arrays", "dynamic", "boolean"], "comments": [{"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 3, "creation_date": 1562773188, "post_id": 56974153, "comment_id": 100484606, "body": "<code>bool* boolArray = new bool[false] ;</code> What do you think you&#39;re doing here ?"}, {"owner": {"reputation": 51, "user_id": 10298365, "user_type": "registered", "profile_image": "https://graph.facebook.com/1700381186725835/picture?type=large", "display_name": "Najmus Saqib Makhdoomi", "link": "https://stackoverflow.com/users/10298365/najmus-saqib-makhdoomi"}, "reply_to_user": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1562773426, "post_id": 56974153, "comment_id": 100484763, "body": "making the index values as false"}, {"owner": {"reputation": 846, "user_id": 7511460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cz0P7.png?s=128&g=1", "display_name": "Adrien Givry", "link": "https://stackoverflow.com/users/7511460/adrien-givry"}, "edited": false, "score": 2, "creation_date": 1562773544, "post_id": 56974153, "comment_id": 100484832, "body": "The value that you gives in <code>new bool[...]</code> should be the size of your array, it doesn&#39;t correspond to the value of your array elements. So the problem is that you are iterating through an array that isn&#39;t well allocated"}, {"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 1, "creation_date": 1562773577, "post_id": 56974153, "comment_id": 100484852, "body": "and here <code>false</code> is <code>0</code>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 10298365, "user_type": "registered", "profile_image": "https://graph.facebook.com/1700381186725835/picture?type=large", "display_name": "Najmus Saqib Makhdoomi", "link": "https://stackoverflow.com/users/10298365/najmus-saqib-makhdoomi"}, "edited": false, "score": 0, "creation_date": 1562773951, "post_id": 56974338, "comment_id": 100485077, "body": "ok that means array size has to be specified  at declaration time.But what will be the value of items in those 2 million indexes .is it set to false by default?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 51, "user_id": 10298365, "user_type": "registered", "profile_image": "https://graph.facebook.com/1700381186725835/picture?type=large", "display_name": "Najmus Saqib Makhdoomi", "link": "https://stackoverflow.com/users/10298365/najmus-saqib-makhdoomi"}, "edited": false, "score": 1, "creation_date": 1562777162, "post_id": 56974338, "comment_id": 100486709, "body": "@NajmusSaqibMakhdoomi Not unless you value-initialize them (and you can, via <code>bool *boolArray = new bool[limit]();</code> (note the parens at the end). Related, though the performance is less-than-stellar, <code>std::vector&lt;bool&gt; ar(limit+1);</code> would also work, free you from having to dynamically free at the end, and be much more inline with modern C++, where <code>new</code> and <code>delete</code> are almost never necessary in user programs. I added the <code>+1</code> because your loops run through <code>limit</code>; not just one-short of it, and therefore you&#39;ll breach without the increased size."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1562777662, "post_id": 56974338, "comment_id": 100486933, "body": "This answer would be even better with an example of how an initialization loop would work."}], "tags": [], "owner": {"reputation": 39, "user_id": 7237027, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y68k0YM1-Dw/AAAAAAAAAAI/AAAAAAAABGU/7ZIaXYbsZI8/photo.jpg?sz=128", "display_name": "GlenL", "link": "https://stackoverflow.com/users/7237027/glenl"}, "is_accepted": false, "score": 2, "last_activity_date": 1562945474, "last_edit_date": 1562945474, "creation_date": 1562773601, "answer_id": 56974338, "question_id": 56974153, "link": "https://stackoverflow.com/questions/56974153/issues-using-dynamic-boolean-array/56974338#56974338", "title": "Issues using dynamic boolean array", "body": "<p>I sense that you're new to C++. </p>\n\n<p>\"false\" is generally zero so you're not allocating anything.</p>\n\n<pre><code>bool* boolArray = new bool[false] ;\n</code></pre>\n\n<p>Try:</p>\n\n<pre><code>bool* boolArray = new bool[limit];\n\n\nfor(int i =0; i&lt;limit; i+)\n{\n    boolArray[i] = false;                       \n}\n</code></pre>\n\n<p>And put a delete at the end:</p>\n\n<pre><code>delete boolArray;\n</code></pre>\n\n<p>Also, that loop will overrun the bounds. If you have N items, the last valid entry is N-1 as the first is 0. So use <code>k&lt;limit</code> in the for loop.</p>\n"}], "owner": {"reputation": 51, "user_id": 10298365, "user_type": "registered", "profile_image": "https://graph.facebook.com/1700381186725835/picture?type=large", "display_name": "Najmus Saqib Makhdoomi", "link": "https://stackoverflow.com/users/10298365/najmus-saqib-makhdoomi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1562945474, "creation_date": 1562772961, "last_edit_date": 1562773719, "question_id": 56974153, "link": "https://stackoverflow.com/questions/56974153/issues-using-dynamic-boolean-array", "title": "Issues using dynamic boolean array", "body": "<p>I  want to dynamically declare a boolean array for my C++ program and set its value to false.I am having issues with memory allocation I guess how and getting a dangling pointer\nI am trying to find prime numbers by Sieve of Eratosthenes I am trying to   use boolean array dynamically but facing issues.</p>\n\n<p>I am not trying to implement it using memset .</p>\n\n<pre><code>int  limit = 2000000 ;\nint crossLimit = sqrt(limit) ;\n\n\nvoid  SievePrime(int limit)\n{\n\n    bool* boolArray = new bool[false] ;\n\n    for(int i =4;i&lt;=limit ;i = i + 2)\n    {\n        boolArray[i] = true ; //getting error hereThread 1:                       \n                         //EXC_BAD_ACCESS (code=2, address=0x100786000)\n    }\n\n    for(int j= 3 ;j&lt;=crossLimit ; j= j+2){\n        if (not boolArray[j])\n\n        {\n            for(int k =j*j;k&lt;=limit;k*=2)\n        {\n            boolArray[k] = true ;\n        }\n    }\n}\n\n    double sum = 0 ;\n\n    for(int i =2 ; i&lt;=limit ;i++)\n    {\n        if(!boolArray[i])\n        {\n            sum = sum + i ;\n        }\n    }\n\n    cout&lt;&lt;sum&lt;&lt;endl ;\n}\n</code></pre>\n\n<p>expected output:\n142913828922</p>\n\n<p>error:Thread 1: EXC_BAD_ACCESS (code=2, address=0x100786000)</p>\n"}, {"tags": ["python", "c++", "database", "sqlite", "concurrency"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562772841, "post_id": 56974083, "comment_id": 100484411, "body": "If you need multiple processes writing to the db at once, sqlite is the wrong tool."}, {"owner": {"reputation": 405, "user_id": 9177422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c14c092c695c495f5800a92ebfd0b4a?s=128&d=identicon&r=PG&f=1", "display_name": "maurock", "link": "https://stackoverflow.com/users/9177422/maurock"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562773194, "post_id": 56974083, "comment_id": 100484610, "body": "I actually only have two scripts accessing the same table, and I want I to be according to a sequential structure. C++ computes something and updates a table, then python gets those results, computes something else and updates the table. This goes on for multiple iterations."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562773535, "post_id": 56974083, "comment_id": 100484820, "body": "Two counts as multiple."}, {"owner": {"reputation": 405, "user_id": 9177422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c14c092c695c495f5800a92ebfd0b4a?s=128&d=identicon&r=PG&f=1", "display_name": "maurock", "link": "https://stackoverflow.com/users/9177422/maurock"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562773907, "post_id": 56974083, "comment_id": 100485050, "body": "Oh, I thought you meant a significant amount. I chose SQLite because of its simplicity, since my focus is on the ML implementation. Off-topic, but really helpful: do you have suggestions on a very simple tool to process that? (MySQL?)"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1562776815, "post_id": 56974083, "comment_id": 100486537, "body": "As long as multiple connections don&#39;t try to write to the database at the same time, it&#39;s fine. (Normally if one connection is writing, none can be reading at the same time; use WAL mode if you want to allow readers at the same time as a writer)"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1562776866, "post_id": 56974083, "comment_id": 100486556, "body": "Also <a href=\"https://www.sqlite.org/c3ref/busy_timeout.html\" rel=\"nofollow noreferrer\">sqlite3_busy_timeout()</a> is useful in C or C++."}], "owner": {"reputation": 405, "user_id": 9177422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c14c092c695c495f5800a92ebfd0b4a?s=128&d=identicon&r=PG&f=1", "display_name": "maurock", "link": "https://stackoverflow.com/users/9177422/maurock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562775654, "creation_date": 1562772727, "last_edit_date": 1562775654, "question_id": 56974083, "link": "https://stackoverflow.com/questions/56974083/commit-while-database-is-busy", "title": "Commit while database is BUSY", "body": "<p>I have two scripts, one in python and one in C++, reading and writing from the same table in SQLite.</p>\n\n<p>I have two questions about how to handle concurrency:</p>\n\n<ol>\n<li><p>During writing, if the table is currently BUSY (something else it's writing), <code>sqlite_exec()</code> in C++ returns an Error code (5). It looks like in python this is not available, so I am wondering: what does it happen when python <code>commit()</code> while an other script is writing? In C++ it would just go on with its operation. Is there a way to know that commit() did not work as expected?</p></li>\n<li><p>My (really inefficient) workaround in C++ is to keep checking the results of <code>sqlite_exec()</code>, and if it returns 5 (BUSY) I write again. Is there a more efficient way to do this, that avoids checking for the result in a loop until UPDATE returns the correct result?  </p></li>\n</ol>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562771691, "post_id": 56973781, "comment_id": 100483763, "body": "The trap is using <code>vector&lt;bool&gt;</code>.  If you can, you should avoid it.  It is not like a regular vector."}, {"owner": {"reputation": 709, "user_id": 5405823, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5H9hi.jpg?s=128&g=1", "display_name": "thinkdeep", "link": "https://stackoverflow.com/users/5405823/thinkdeep"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562771965, "post_id": 56973781, "comment_id": 100483919, "body": "Thanks, I know that from effective c++. However, this question also asks for general guidelines for using auto&amp; iterating containers."}, {"owner": {"reputation": 467, "user_id": 9216696, "user_type": "registered", "profile_image": "https://graph.facebook.com/1983536371871178/picture?type=large", "display_name": "Alex Hodges", "link": "https://stackoverflow.com/users/9216696/alex-hodges"}, "edited": false, "score": 1, "creation_date": 1562772064, "post_id": 56973781, "comment_id": 100483977, "body": "Take a read of <a href=\"https://en.cppreference.com/w/cpp/container/vector_bool\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562772071, "post_id": 56973781, "comment_id": 100483982, "body": "It&#39;s fine for everything except <code>vector&lt;bool&gt;</code>."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1562772119, "post_id": 56973781, "comment_id": 100484015, "body": "In hindsight, they should have made a space-optimized std::vector_bool ... but too late now, that ship has sailed."}, {"owner": {"reputation": 467, "user_id": 9216696, "user_type": "registered", "profile_image": "https://graph.facebook.com/1983536371871178/picture?type=large", "display_name": "Alex Hodges", "link": "https://stackoverflow.com/users/9216696/alex-hodges"}, "edited": false, "score": 0, "creation_date": 1562772242, "post_id": 56973781, "comment_id": 100484087, "body": "<code>auto &amp;</code> =  I want to modify and not copy. <code>const auto &amp;</code> = I want to not copy. <code>auto</code> = I want to copy and modify. <code>const auto</code> = I want to copy."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1562772308, "post_id": 56973781, "comment_id": 100484127, "body": "For your question, it is answered here: <a href=\"https://stackoverflow.com/questions/29859796/c-auto-vs-auto\">stackoverflow.com/questions/29859796/c-auto-vs-auto</a>"}], "owner": {"reputation": 709, "user_id": 5405823, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5H9hi.jpg?s=128&g=1", "display_name": "thinkdeep", "link": "https://stackoverflow.com/users/5405823/thinkdeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1562771656, "answer_count": 0, "score": 0, "last_activity_date": 1562772037, "creation_date": 1562771609, "last_edit_date": 1562772037, "question_id": 56973781, "link": "https://stackoverflow.com/questions/56973781/c-iterating-with-auto-reference", "closed_reason": "Duplicate", "title": "c++ iterating with auto reference", "body": "<p>Although having read a bunch of posts here, I still often make mistakes in using <code>auto&amp;</code> reference in  <code>for (auto&amp; x : some_container)</code> . Usually, to avoid constructing temporary copy and speed up for-loop iteration for string types, I use <code>auto&amp;</code> as a default option. </p>\n\n<p>Could someone please guide me on when and how to correctly use <code>auto&amp;</code>? </p>\n\n<p>EDIT:</p>\n\n<p>Below may be a bad example. I know we shall avoid vector from the book effective c++. However, this question also asks for general guidelines for using auto&amp; iterating containers</p>\n\n<p>Today, I fall into another error trap of using <code>auto&amp;</code></p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main() {\n    int n = 3;\n    vector&lt;bool&gt; vec(n, false);\n    for(auto&amp; x : vec) cout &lt;&lt; x &lt;&lt; \" \";\n    cout &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>The error message is show as below. What does it mean?</p>\n\n<pre><code>vector_bool.cpp:9:15: error: non-const lvalue reference to type '__bit_reference&lt;[2 * ...]&gt;' cannot bind to\n      a temporary of type '__bit_reference&lt;[2 * ...]&gt;'\n    for(auto&amp; x : vec) cout &lt;&lt; x &lt;&lt; \" \";\n              ^ ~\n</code></pre>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1562794801, "post_id": 56973622, "comment_id": 100493920, "body": "&quot;I need to do it inside ADD_CUSTOM_COMMAND for a post build target&quot; - Using <code>add_custom_command</code> implies that you need a command line which performs the task. The command line could involve bash script, CMake script (which is created separately from <code>CMakeLists.txt</code>) or just using combination of <code>grep</code>/<code>sed</code>/<code>awk</code> with proper parameters. So the first task is to create a command line or script which performs required task."}, {"owner": {"reputation": 953, "user_id": 1095896, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f70f2db9cc735bfc663e9b0794125e2e?s=128&d=identicon&r=PG", "display_name": "james", "link": "https://stackoverflow.com/users/1095896/james"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1562832743, "post_id": 56973622, "comment_id": 100504063, "body": "@Tsyvarev the reason that I want to do it in CMake way is to support multiple platforms. Obviously, bash script is not easily portable."}], "answers": [{"tags": [], "owner": {"reputation": 4783, "user_id": 948128, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/788ac757a97bd1fa3ca6fd0d3eeffc1b?s=128&d=identicon&r=PG", "display_name": "piwi", "link": "https://stackoverflow.com/users/948128/piwi"}, "is_accepted": false, "score": 0, "last_activity_date": 1580202735, "creation_date": 1580202735, "answer_id": 59945350, "question_id": 56973622, "link": "https://stackoverflow.com/questions/56973622/grep-strings-from-a-text-file-and-copy-them-to-a-directory-in-cmake/59945350#59945350", "title": "grep strings from a text file and copy them to a directory in CMake", "body": "<p>You could have a CMake script that you invoke via a custom command. Something like this:</p>\n\n<pre><code># ProcessFile.cmake\nfile(READ \"${ProcessFile_INPUT_PATH}\" ProcessFile_CONTENT)\n# Replace newlines with semicolon so that it is treated as a list by CMake\n# Will need to escape existing semicolons beforehand if file contains any.\nstring(REPLACE \"\\n\" \";\" ProcessFile_LINES \"${ProcessFile_CONTENT}\")\nforeach(_line ${ProcessFile_LINES})\n  string(REGEX REPLACE \"^.+abc=\\\"(.+)\\\".+$\" \"xx/yy/\\\\1\" _file_path \"${_line}\")\n  file(COPY \"${_file_path}\" DESTINATION \"${ProcessFile_OUTPUT_DIR}\")\nendforeach()\n\n# CMakeLists.txt\nadd_custom_command(OUTPUT \"output-file\"\n  COMMAND \"${CMAKE_ROOT}\" -DProcessFile_INPUT_PATH=\"xx/yy/a.txt\" -DProcessFile_OUTPUT_DIR=\"mydir\" -P ProcessFile.cmake)\n</code></pre>\n\n<p>I did not test the scripts, but this is the gist:</p>\n\n<ul>\n<li>ProcessFile.cmake parses the file, iterate on each linem extract the file name and copy the file.</li>\n<li>The add_custom_command() in CMakeLists.txt invokes the ProcessFile.cmake script, giving it the location of the input file and the output directory.</li>\n</ul>\n"}], "owner": {"reputation": 953, "user_id": 1095896, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f70f2db9cc735bfc663e9b0794125e2e?s=128&d=identicon&r=PG", "display_name": "james", "link": "https://stackoverflow.com/users/1095896/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 554, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1580202735, "creation_date": 1562771091, "last_edit_date": 1562773419, "question_id": 56973622, "link": "https://stackoverflow.com/questions/56973622/grep-strings-from-a-text-file-and-copy-them-to-a-directory-in-cmake", "title": "grep strings from a text file and copy them to a directory in CMake", "body": "<p>In CMake 2.8.12, how to grep strings (each string represent a file name) from a text file and copy them to a directory?</p>\n\n<p>For example, I have a text file xx/yy/a.txt that contains:</p>\n\n<pre><code>xx xx xx abc=\"some_file_name1.txt\" xx xx xx\nxx xx xx abc=\"some_file_name2.txt\" xx xx xx\nxx xx xx abc=\"some_file_name3.txt\" xx xx xx\n</code></pre>\n\n<p>where 'xx' could be some random strings.</p>\n\n<p>I need to extract <code>some_file_name1.txt, some_file_name2.txt and some_file_name3.txt</code> first, form a correct path for each of them by appending the path prefix <code>xx/yy/</code> to each extracted string, then copy each file to directory <code>mydir/</code></p>\n\n<p>I know how to do this in bash script but have no clue on how to do this in CMake, in particular, I need to do it inside ADD_CUSTOM_COMMAND for a post build target.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "lambda", "wt"], "comments": [{"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 3, "creation_date": 1562771072, "post_id": 56973558, "comment_id": 100483387, "body": "Only stateless lambdas are convertible to function pointers. You can use <code>std::function</code> that can store all callables. BTW <code>[editField,initialValue]</code> copies the values into lambda, <code>[&amp;editField,&amp;initialValue]</code> captures by reference."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1562771111, "post_id": 56973558, "comment_id": 100483409, "body": "&quot;The various (similar) answers on SO all use templates which I don&#39;t think I need&quot; You think wrong. Look at the definition of <a href=\"https://www.webtoolkit.eu/wt/doc/reference/html/classWt_1_1EventSignal.html#a7050f8ff1075fb01fc0ea6a49a28b703\" rel=\"nofollow noreferrer\"><code>clicked().connect</code></a>"}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562771206, "post_id": 56973558, "comment_id": 100483462, "body": "@NathanOliver they say that <code>UndoIcon</code> class is theirs, so they can change it. Though at that point, why not just accept any callable via templates? That&#39;s likely what <code>connect</code> already does."}, {"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562771208, "post_id": 56973558, "comment_id": 100483464, "body": "@NathanOliver I was referring to <code>UndoIcon::callback</code> argument, but <code>::connect</code> is probably the same."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562771254, "post_id": 56973558, "comment_id": 100483487, "body": "Yep.  I though it was a library class for some reason, comment retracted."}], "owner": {"reputation": 3491, "user_id": 659503, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/kQXQL.png?s=128&g=1", "display_name": "TSG", "link": "https://stackoverflow.com/users/659503/tsg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1562771092, "answer_count": 0, "score": 0, "last_activity_date": 1562770914, "creation_date": 1562770914, "question_id": 56973558, "link": "https://stackoverflow.com/questions/56973558/pass-lambda-to-method-in-another-class-in-c", "closed_reason": "Duplicate", "title": "Pass lambda to method in another class in c++", "body": "<p>I'm working in C++ 14 with Wt, and I'm trying to create a generic \"UNDO\" widget to go alongside my form fields. </p>\n\n<p>Being new to Lambda's I'm getting stuck - the compiler is complaining\nabout no matching function call for the UndoIcon creation below:</p>\n\n<pre><code>auto editField = templatePtr-&gt;bindWidget(\"lineedit\", Wt::cpp14::make_unique&lt;Wt::WLineEdit&gt;());\neditField-&gt;setText(Wt::toWString(m_initialValue));\nconst QString initialValue = m_initialValue; // Copy from member variable to local for lambda\nauto undoIcon = Wt::cpp14::make_unique&lt;UndoIcon&gt;(1,[editField,initialValue] { editField-&gt;setText(Wt::toWString(initialValue)); });\n</code></pre>\n\n<p>and I define my UndoIcon class as follows:</p>\n\n<pre><code>UndoIcon::UndoIcon(unsigned char iconSize, void (*callback)()) {\nthis-&gt;clicked().connect([=] { (*callback)(); });\n}\n</code></pre>\n\n<p>Is it possible to pass a Lambda like this?  The various (similar) answers on SO all use templates which I don't think I need.</p>\n"}, {"tags": ["c++", "docker", "visual-c++", "dockerfile", "nano-server"], "owner": {"reputation": 57, "user_id": 9148202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e6e542f824784885a2b01ac76c2e439?s=128&d=identicon&r=PG&f=1", "display_name": "junior_2969", "link": "https://stackoverflow.com/users/9148202/junior-2969"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562770462, "creation_date": 1562770462, "question_id": 56973417, "link": "https://stackoverflow.com/questions/56973417/the-system-cannot-find-the-file-specified-when-trying-to-run-vc-redist-x64-withi", "title": "The system cannot find the file specified when trying to run vc_redist.x64 within nanoserver build using dockerfile", "body": "<p>I am trying to setup a nanoserver container in order to run a C++ executable that was built with the /MD flag in Visual Studio 2017.</p>\n\n<p>I know I need to install Microsoft Visual C++ Redistributable for Visual Studio 2017.</p>\n\n<p>I managed to create the container, download the Redistributable and add it to the container at the root. however when build from the Dockerfile I get the following error message:</p>\n\n<pre><code>Exception(2) tid(360) 80070002 The system cannot find the file specified.\n        CallContext:[\\Bridge_ProcessMessage\\ComputeSystemManager_ExecuteProcess\\VmHostedContainer_ExecuteProcess]\n     Provider: 00000000-0000-0000-0000-000000000000] extra info: {\"CommandLine\":\"powershell -Command $ErrorActionPreference = 'Stop'; $ProgressPreference = 'SilentlyContinue'; $verbosePreference='Continue'; Start-Process -filepath c:\\\\vc_redist.exe -ArgumentList \\\"/install\\\", \\\"/passive\\\", \\\"/norestart\\\", \\\"'/log a.txt'\\\" -PassThru | wait-process\",\"User\":\"ContainerUser\",\"WorkingDirectory\":\"C:\\\\\",\"Environment\":{\"PSCORE\":\"C:\\\\Program Files\\\\PowerShell\\\\pwsh.exe\",\"ProgramFiles\":\"C:\\\\Program Files\",\"VS2017\":\"https://aka.ms/vs/16/release/vc_redist.x64.exe\"},\"CreateStdInPipe\":true,\"CreateStdOutPipe\":true,\"CreateStdErrPipe\":true,\"ConsoleSize\":[0,0]}\n</code></pre>\n\n<p>here is my Dockerfile:</p>\n\n<pre><code>ARG FROM_IMAGE=microsoft/powershell:6.0.0-beta.9-nanoserver-1709\nFROM ${FROM_IMAGE}\n\nSHELL [\"powershell\", \"-Command\", \"$ErrorActionPreference = 'Stop'; $ProgressPreference = 'SilentlyContinue'; $verbosePreference='Continue';\"]\n\n\nARG VS2017=https://aka.ms/vs/16/release/vc_redist.x64.exe\nADD ${VS2017} /vc_redist.exe\n\nRUN Start-Process -filepath c:\\vc_redist.exe -ArgumentList \"/install\", \"/passive\", \"/norestart\", \"'/log a.txt'\" -PassThru | wait-process\n</code></pre>\n\n<p>I tried removing last line from dockerfile and running it within the container after building I simply get no output.</p>\n\n<p>also would like to avoid using windows server core as we are trying to keep the size as small as possible.</p>\n\n<p>Any help greatly appreciated.</p>\n"}, {"tags": ["c++", "shared-memory", "qpainter", "qimage", "qt4.8"], "comments": [{"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1562771818, "post_id": 56973351, "comment_id": 100483837, "body": "Can you show how <code>createImage</code> is called? Is <code>chunk</code> pointer still valid when <code>paintEvent</code> will be called? If not, you have undefined behaviour, because QImage doesn&#39;t copy chunk - it stores only pointer, no data is copied."}, {"owner": {"reputation": 1, "user_id": 7182463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34cPQ.jpg?s=128&g=1", "display_name": "Rudresh", "link": "https://stackoverflow.com/users/7182463/rudresh"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1562782144, "post_id": 56973351, "comment_id": 100488917, "body": "@rafix07, I have added createImage method in code section. Please have a look and do let me know what I am missing to lead to crash. thanks for your response and valuable time. much appreciated"}, {"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1562783323, "post_id": 56973351, "comment_id": 100489479, "body": "You could try <code>xpraImages.append(image.copy());</code> - call <code>copy</code> to make deep copy instead of shallow copies of images. Are you calling <code>munmap</code> on <code>addr</code>?"}, {"owner": {"reputation": 1, "user_id": 7182463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34cPQ.jpg?s=128&g=1", "display_name": "Rudresh", "link": "https://stackoverflow.com/users/7182463/rudresh"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1562785791, "post_id": 56973351, "comment_id": 100490504, "body": "@rafix07, no, I am not calling munmap yet.. sure, will try copying and keep u posted. thanks alot for ur time :-)"}, {"owner": {"reputation": 1, "user_id": 7182463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34cPQ.jpg?s=128&g=1", "display_name": "Rudresh", "link": "https://stackoverflow.com/users/7182463/rudresh"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1562787573, "post_id": 56973351, "comment_id": 100491214, "body": "@rafix07, image.copy() leads to crash. I also tried making image as pointer and creating by means of new QImage(params) but still lead to crash."}, {"owner": {"reputation": 1, "user_id": 7182463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34cPQ.jpg?s=128&g=1", "display_name": "Rudresh", "link": "https://stackoverflow.com/users/7182463/rudresh"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1562844910, "post_id": 56973351, "comment_id": 100511014, "body": "@rafix07, this is the issue when image of different lengths streamed it ends up with crash. for your reference <a href=\"https://bugreports.qt.io/browse/QTBUG-14766?focusedCommentId=138908&amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel\" rel=\"nofollow noreferrer\">bugreports.qt.io/browse/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 7182463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34cPQ.jpg?s=128&g=1", "display_name": "Rudresh", "link": "https://stackoverflow.com/users/7182463/rudresh"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1562957535, "post_id": 56973351, "comment_id": 100557607, "body": "@moderator,, This problem is solved by having local image created on fly. than having image as a memeber of the class. please close this ticket .. Thank you, Rudresh"}], "owner": {"reputation": 1, "user_id": 7182463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34cPQ.jpg?s=128&g=1", "display_name": "Rudresh", "link": "https://stackoverflow.com/users/7182463/rudresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562782054, "creation_date": 1562770263, "last_edit_date": 1562782054, "question_id": 56973351, "link": "https://stackoverflow.com/questions/56973351/draw-one-by-one-image-on-screen-from-qlistqimage-in-paintevent-method-in-qt4", "title": "Draw one by one image on screen from QList&lt;QImage&gt; in paintevent() method in Qt4.8", "body": "<p>I am creating QImage reading from shared memory and adding to QList and in paintevent I want to draw all Images I have in QList but ending up with crash as shown in below code snippet.</p>\n\n<p>I have created user defined paintImage() to read one by one from QList and QPainter and tried drawing although there is no crash but ending up with no images on screen.</p>\n\n<pre><code>    int fd = open(\"/run/user/1000/xpra.NanPLD.mmap\", O_RDONLY);\n    int filesize = 256*1024*1024;\n    void* addr = mmap(NULL, filesize, PROT_READ, MAP_PRIVATE, fd, 0);\n    createImage(addr,width, height, offset, colorFormat);\n    void Client::createImage(void* chunk,int width, int height, int offset, \n    QString colorFormat)\n    {\n            qDebug() &lt;&lt; \"offset Value \" &lt;&lt; offset;\n            image = QImage(((const unsigned char*)chunk ) + offset, width, height, QImage::Format_RGB888);\n            xpraImages.append(image);\n    }\n\n    void Client::paintEvent(QPaintEvent *event)\n    {\n        qDebug() &lt;&lt;\"Inside paint event\" ;\n\n        QPainter painter(this);\n        static int counter = 0;\n        qDebug() &lt;&lt; \"counter: \" &lt;&lt; counter; \n        qDebug() &lt;&lt; \"Image list length : \" &lt;&lt; xpraImages.count();       \n        if(counter &lt; xpraImages.count()){\n            qDebug() &lt;&lt; \"counter \" &lt;&lt; counter;\n            image = xpraImages.at(counter); // image is class member\n            qWarning() &lt;&lt; image.isNull() &lt;&lt; image.width()&lt;&lt; image.height();\n            if(!image.isNull()){\n                qDebug() &lt;&lt; \"Inside paintvent after nullcheck\";\n                painter.drawImage(0,0,image); // here crashes\n                            }\n            counter++;\n            QTimer::singleShot(50, this, SLOT(update()));\n\n        }\n\n    }\n</code></pre>\n"}, {"tags": ["c++", "inheritance"], "comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1562771527, "post_id": 56973332, "comment_id": 100483658, "body": "Do a preprocessor only compile step, and look at the intermediate source output."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1562771671, "post_id": 56973332, "comment_id": 100483755, "body": "Why do you have pragma once <i>and</i> header guards?"}, {"owner": {"reputation": 2673, "user_id": 11292489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cucr6.jpg?s=128&g=1", "display_name": "Gilles-Philippe Paill&#233;", "link": "https://stackoverflow.com/users/11292489/gilles-philippe-paill%c3%a9"}, "edited": false, "score": 0, "creation_date": 1562772356, "post_id": 56973332, "comment_id": 100484156, "body": "&quot;I don&#39;t believe I&#39;ve done this&quot;. Can you make sure? What is in Resource.h? Also, is it the only error that you get?"}, {"owner": {"reputation": 123, "user_id": 10240844, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9PMx-qIMhVU/AAAAAAAAAAI/AAAAAAAAIKs/k1INcqSYi1s/photo.jpg?sz=128", "display_name": "Tyler Swenson", "link": "https://stackoverflow.com/users/10240844/tyler-swenson"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1562773228, "post_id": 56973332, "comment_id": 100484635, "body": "@Eljay I added #pragma message(&quot;Defined classname&quot;) to the header files and got this output: 1&gt;  CommandButton.cpp 1&gt;  Command Button Defined 1&gt;  Config Button Defined"}, {"owner": {"reputation": 123, "user_id": 10240844, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9PMx-qIMhVU/AAAAAAAAAAI/AAAAAAAAIKs/k1INcqSYi1s/photo.jpg?sz=128", "display_name": "Tyler Swenson", "link": "https://stackoverflow.com/users/10240844/tyler-swenson"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1562773298, "post_id": 56973332, "comment_id": 100484687, "body": "@Borgleader I just added the header guards when I was looking for other solutions to the problem"}, {"owner": {"reputation": 123, "user_id": 10240844, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9PMx-qIMhVU/AAAAAAAAAAI/AAAAAAAAIKs/k1INcqSYi1s/photo.jpg?sz=128", "display_name": "Tyler Swenson", "link": "https://stackoverflow.com/users/10240844/tyler-swenson"}, "reply_to_user": {"reputation": 2673, "user_id": 11292489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cucr6.jpg?s=128&g=1", "display_name": "Gilles-Philippe Paill&#233;", "link": "https://stackoverflow.com/users/11292489/gilles-philippe-paill%c3%a9"}, "edited": false, "score": 0, "creation_date": 1562773361, "post_id": 56973332, "comment_id": 100484725, "body": "@Gilles-PhilippePaill&#233; Resource.h gives the objects for Inventor (this is an addin that uses the autodesk Inventor developertools)"}, {"owner": {"reputation": 2673, "user_id": 11292489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cucr6.jpg?s=128&g=1", "display_name": "Gilles-Philippe Paill&#233;", "link": "https://stackoverflow.com/users/11292489/gilles-philippe-paill%c3%a9"}, "edited": false, "score": 0, "creation_date": 1562773504, "post_id": 56973332, "comment_id": 100484805, "body": "@TylerSwenson And do you get any other error messages? Anything from CommandButton.h?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1562776136, "post_id": 56973332, "comment_id": 100486216, "body": "Step one: make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1562776156, "post_id": 56973332, "comment_id": 100486227, "body": "@Borgleader I do that too."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1562778049, "post_id": 56973332, "comment_id": 100487109, "body": "What is <code>ATL_NO_VTABLE</code>? I&#39;m unfamiliar with it and, consequently, the syntax you&#39;re using to declare your classes. My best guess it&#39;s a macro, but, if so, what is its value?"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1562779417, "post_id": 56973332, "comment_id": 100487766, "body": "@LightnessRacesinOrbit Then I have the same question, why? Is there an advantage to having both of them that I&#39;m not aware of?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 1, "creation_date": 1562779476, "post_id": 56973332, "comment_id": 100487796, "body": "@Borgleader <code>#pragma once</code> may be a bit faster so it&#39;s good to have, but since it&#39;s inherently non-portable the header guards are a good fallback (plus they fix potential issues with hardlinks/symlinks)"}], "owner": {"reputation": 123, "user_id": 10240844, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9PMx-qIMhVU/AAAAAAAAAAI/AAAAAAAAIKs/k1INcqSYi1s/photo.jpg?sz=128", "display_name": "Tyler Swenson", "link": "https://stackoverflow.com/users/10240844/tyler-swenson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562770222, "creation_date": 1562770222, "question_id": 56973332, "link": "https://stackoverflow.com/questions/56973332/c-base-class-undefined-c2504", "title": "c++ Base Class Undefined C2504", "body": "<p>I have a class CConfigButton which inherits from CCommandButton. I'm getting a base class undefined error on line 12 (inheriting CCommandButton). </p>\n\n<p>Error Code:</p>\n\n<pre><code>Error   C2504   'CCommandButton': base class undefined  14  \n</code></pre>\n\n<p>ConfigButton.h</p>\n\n<pre><code>#pragma once\n\n#ifndef CONFIG_BUTTON_H\n#define CONFIG_BUTTON_H\n\nclass CConfigButton;\n\n#include \"Resource.h\"\n#include \"CommandButton.h\"\n\n\n\nclass CConfigButton :\n   public CCommandButton {\npublic:\n   //----- ButtonDefinitionSink\n   STDMETHOD(ButtonDefinitionEvents_OnExecute) (NameValueMap *pContext);\n\n};\n\n#endif // !CONFIG_BUTTON_H\n</code></pre>\n\n<p>CommandButton.h</p>\n\n<pre><code>#pragma once\n\n#ifndef COMMAND_BUTTON_H\n#define COMMAND_BUTTON_H\n\n\n\n#include \"Resource.h\"\n#include \"swentylFRCAddinAddInServer.h\"\n\nclass ATL_NO_VTABLE CCommandButton;\n\n//class CCommandButton;\n// CCommandButton\n\nclass ATL_NO_VTABLE CCommandButton :\n   public CComObjectRootEx&lt;CComSingleThreadModel&gt;,\n   public IDispEventImpl&lt;0, CCommandButton, &amp;DIID_ButtonDefinitionSink, &amp;LIBID_Inventor, 1, 0&gt;\n{\n\nprotected:\n   //Inventor application object\n   CComPtr&lt;Application&gt; m_pApplication;\n\n   //Command button definition\n   CComPtr&lt;ButtonDefinitionObject&gt; m_pCommandButtonDef;\n\npublic:\n   CCommandButton()\n   {\n      m_pApplication = NULL;\n      m_pCommandButtonDef = NULL;\n   }\n\n   DECLARE_NO_REGISTRY()\n\n   BEGIN_COM_MAP(CCommandButton)\n   END_COM_MAP()\n\n   BEGIN_SINK_MAP(CCommandButton)\n      SINK_ENTRY_EX(0, DIID_ButtonDefinitionSink, ButtonDefinitionSink_OnExecuteMeth, ButtonDefinitionEvents_OnExecute)\n   END_SINK_MAP()\n\npublic:\n   //----- ButtonDefinitionSink\n   STDMETHOD(ButtonDefinitionEvents_OnExecute) (NameValueMap *pContext) = 0;\n\n   HRESULT CreateButtonDefinition(Application* pApplication,\n      BSTR bstrDisplayName,\n      BSTR bstrInternalName,\n      CommandTypesEnum eCommandType,\n      VARIANT varClientId,\n      BSTR bstrDescription,\n      BSTR bstrToolTip,\n      int StandardIconResId,\n      int LargeIconResId,\n      ButtonDisplayEnum eButtonDisplayType,\n      ButtonDefinitionObject** pCommandButtonDefinition);\n\n   HRESULT GetButtonDefinition(ButtonDefinitionObject** pCommandButtonDef);\n\n   HRESULT Disconnect();\n};\n\n#endif // !COMMAND_BUTTON_H\n</code></pre>\n\n<p>I've searched for other similar problems, but haven't been able to find a solution. Others suggest a circular dependency is one possible source to the problem, but I don't believe I've done this. How do I fix this?</p>\n"}, {"tags": ["c++", "algorithm", "sorting", "vector", "std-pair"], "comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1562770433, "post_id": 56973320, "comment_id": 100483030, "body": "Sorts left to right:  first x1, the if tied y1, then if tied x2, then if tied y2."}], "answers": [{"tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": false, "score": 1, "last_activity_date": 1562770495, "creation_date": 1562770495, "answer_id": 56973429, "question_id": 56973320, "link": "https://stackoverflow.com/questions/56973320/sorting-a-vector-with-2-pairs-inside/56973429#56973429", "title": "Sorting a vector with 2 pairs inside", "body": "<p><a href=\"https://en.cppreference.com/w/cpp/utility/pair\" rel=\"nofollow noreferrer\"><code>std::pair</code></a> defines a <a href=\"https://en.cppreference.com/w/cpp/utility/pair/operator_cmp\" rel=\"nofollow noreferrer\"><code>operator&lt;</code></a> if the contained types support comparison via <code>operator&lt;</code>, and you're using <code>int</code>, so it is provided by default.</p>\n\n<p><code>std::sort</code> uses this <code>operator&lt;</code> to sort the elements <a href=\"https://en.wikipedia.org/wiki/Lexicographical_order\" rel=\"nofollow noreferrer\">lexicographically</a>.</p>\n\n<p>If you were using an arbitrary type without <code>operator&lt;</code> defined, you would have to provide your own comparator to <code>std::sort</code></p>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1562771167, "creation_date": 1562771167, "answer_id": 56973650, "question_id": 56973320, "link": "https://stackoverflow.com/questions/56973320/sorting-a-vector-with-2-pairs-inside/56973650#56973650", "title": "Sorting a vector with 2 pairs inside", "body": "<p>For the class <code>std::pair</code> there is defined operator</p>\n\n<pre><code>template&lt;class T1, class T2&gt;\nconstexpr bool operator&lt; (const pair&lt;T1, T2&gt;&amp;, const pair&lt;T1, T2&gt;&amp;);\n</code></pre>\n\n<p>that acts the following way</p>\n\n<blockquote>\n  <p>Returns: x.first &lt; y.first || (!(y.first &lt; x.first) &amp;&amp; x.second &lt;\n  y.second).</p>\n</blockquote>\n\n<p>So for example for two pairs of the type <code>std::pair&lt;std::pair&lt;int, int&gt;, std::pair&lt;int, int&gt;&gt;</code></p>\n\n<pre><code>{ { 5, 19 }, { 8, 17 } }\n  ^^^^^^^^^\n</code></pre>\n\n<p>and</p>\n\n<pre><code>{ { 5, 15 }, { 15, 5 } }\n  ^^^^^^^^^\n</code></pre>\n\n<p>at first the pairs <code>{ 5, 19 }</code> and <code>{ 5, 15 }</code> are compared using the same <code>operator &lt;</code>.</p>\n\n<p>As the second pair is less than the first pair then the second pair will precede the first pair in the result vector.</p>\n\n<p>If they (first pairs) were equal each other as for example </p>\n\n<pre><code>{ { 5, 15 }, { 8, 17 } }\n  ^^^^^^^^^\n</code></pre>\n\n<p>and</p>\n\n<pre><code>{ { 5, 15 }, { 15, 5 } }\n  ^^^^^^^^^\n</code></pre>\n\n<p>then the second pairs were compared. Because the pair <code>{ 8, 17 }</code> is less then <code>{ 15, 5 }</code> then the first pair is less than the second pair. </p>\n\n<p>The pairs <code>{ 8, 17 }</code> and <code>{ 15, 5 }</code> are compared using the same template <code>operator &lt;</code>.</p>\n"}], "owner": {"reputation": 47, "user_id": 11559426, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GK4CF.jpg?s=128&g=1", "display_name": "ssjack", "link": "https://stackoverflow.com/users/11559426/ssjack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 56973650, "answer_count": 2, "score": 2, "last_activity_date": 1562771221, "creation_date": 1562770196, "last_edit_date": 1562771221, "question_id": 56973320, "link": "https://stackoverflow.com/questions/56973320/sorting-a-vector-with-2-pairs-inside", "title": "Sorting a vector with 2 pairs inside", "body": "<p>Well, I have a vector, pair >, and I'm wondering how he does the sort? with sort(v.begin(),v.end());</p>\n\n<pre><code>using namespace std;\n\nint main(){\n   int n; cin &gt;&gt; n;\n   vector&lt;pair&lt;pair&lt;int,int&gt;, pair&lt;int,int&gt;&gt;&gt; v;\n   for(int i=0;i&lt;n;i++){\n      long long x1,y1,x2,y2;\n      cin&gt;&gt;x1&gt;&gt;y1&gt;&gt;x2&gt;&gt;y2;\n      v.push_back(make_pair(make_pair(x1,y1),make_pair(x2,y2)));\n   }   \n   sort(v.begin(),v.end());\n   for(auto&amp; p : v){\n      cout&lt;&lt;p.first.first&lt;&lt;\" \"&lt;&lt;p.first.second&lt;&lt;\" \"&lt;&lt;p.second.first&lt;&lt;\" \"&lt;&lt;p.second.second&lt;&lt;\"\\n\";\n  }\n   return 0;\n}\n</code></pre>\n\n<p>input:</p>\n\n<pre><code>4   \n5 19 8 17\n5 15 15 5\n0 20 20 0\n8 10 10 8\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>0 20 20 0\n5 15 15 5\n5 19 8 17\n8 10 10 8\n</code></pre>\n"}, {"tags": ["c++", "codeblocks"], "comments": [{"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1562770180, "post_id": 56973274, "comment_id": 100482882, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/16611416/convert-bstr-to-lpcwstr\">convert BSTR to LPCWSTR</a>"}], "answers": [{"comments": [{"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1562770223, "post_id": 56973295, "comment_id": 100482912, "body": "Except that <code>BSTR</code> has the weird rule that <code>nullptr</code> is a valid <code>BSTR</code> (but not a valid parameter to <code>MessageBox</code>). A <code>nullptr</code> <code>BSTR</code> is an empty string."}, {"owner": {"reputation": 1027, "user_id": 3970831, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BM5Xl.jpg?s=128&g=1", "display_name": "Zurab-D", "link": "https://stackoverflow.com/users/3970831/zurab-d"}, "edited": false, "score": 0, "creation_date": 1562770454, "post_id": 56973295, "comment_id": 100483047, "body": "if I pass it directly, compiler throws an error &quot;error: cannot convert &#39;BSTR {aka wchar_t*}&#39; to &#39;LPCSTR {aka const char*}&#39; for argument &#39;2&#39; to &#39;int MessageBoxA(HWND, LPCSTR, LPCSTR, UINT)&#39;|&quot;"}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "reply_to_user": {"reputation": 1027, "user_id": 3970831, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BM5Xl.jpg?s=128&g=1", "display_name": "Zurab-D", "link": "https://stackoverflow.com/users/3970831/zurab-d"}, "edited": false, "score": 0, "creation_date": 1562770968, "post_id": 56973295, "comment_id": 100483325, "body": "Edited. @Zurab-D"}, {"owner": {"reputation": 1027, "user_id": 3970831, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BM5Xl.jpg?s=128&g=1", "display_name": "Zurab-D", "link": "https://stackoverflow.com/users/3970831/zurab-d"}, "edited": false, "score": 0, "creation_date": 1562771190, "post_id": 56973295, "comment_id": 100483449, "body": "with <code>MessageBoxW</code> I get what I need, thanks! @Michael Chourdakis"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 1027, "user_id": 3970831, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BM5Xl.jpg?s=128&g=1", "display_name": "Zurab-D", "link": "https://stackoverflow.com/users/3970831/zurab-d"}, "edited": false, "score": 0, "creation_date": 1562772225, "post_id": 56973295, "comment_id": 100484073, "body": "@Zurab-D The Windows API has two versions, the narrow character set version of the API which takes <code>char</code> and the wide character set version of the API which takes <code>wchar_t</code>. Enabling the wide character set version requires setting the UNICODE and _UNICODE Preprocessor directives before including <code>windows.h</code>. See <a href=\"https://stackoverflow.com/questions/33836706/what-are-tchar-strings-and-the-a-or-w-version-of-win32-api-functions\" title=\"what are tchar strings and the a or w version of win32 api functions\">stackoverflow.com/questions/33836706/&hellip;</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1562785692, "post_id": 56973295, "comment_id": 100490461, "body": "@RichardChambers or, you can simply call the <code>A</code>/<code>W</code> functions explicitly and not have to deal with <code>UNICODE</code>/<code>_UNICODE</code> at all."}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562786050, "post_id": 56973295, "comment_id": 100490613, "body": "@RemyLebeau you don&#39;t want to do that. Every Windows app should be set to unicode and never get reminded about that again."}], "tags": [], "owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "is_accepted": true, "score": 1, "last_activity_date": 1562770889, "last_edit_date": 1562770889, "creation_date": 1562770114, "answer_id": 56973295, "question_id": 56973274, "link": "https://stackoverflow.com/questions/56973274/how-to-display-a-bstr-value-with-messagebox-function/56973295#56973295", "title": "How to display a BSTR value with MessageBox function?", "body": "<p><a href=\"https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/692a42a9-06ce-4394-b9bc-5d2a50440168\" rel=\"nofollow noreferrer\">BSTR</a> is <code>wchar_t*</code>, as far as MessageBox is concerned, so you can pass it directly to MessageBoxW. <code>MessageBoxW(hwnd,bStrVal,...);</code></p>\n\n<p>For <code>MessageBoxA</code>, you must convert with <code>WideCharToMultiByte</code>.</p>\n\n<p>Suggestion: use always unicode in your apps, never leave it. </p>\n"}], "owner": {"reputation": 1027, "user_id": 3970831, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BM5Xl.jpg?s=128&g=1", "display_name": "Zurab-D", "link": "https://stackoverflow.com/users/3970831/zurab-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 56973295, "answer_count": 1, "score": 1, "last_activity_date": 1562770889, "creation_date": 1562770049, "question_id": 56973274, "link": "https://stackoverflow.com/questions/56973274/how-to-display-a-bstr-value-with-messagebox-function", "title": "How to display a BSTR value with MessageBox function?", "body": "<p>I'm very new to C++. I use Code::Blocks and I need to show a BSTR value with MessageBox function.</p>\n\n<p>I tried to google this question but did not found a suitable answer.</p>\n\n<p>How to do this?</p>\n"}, {"tags": ["c++", "file", "filepath"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 11730909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f74f82b295e682a4d2fddb3c08bc0d7?s=128&d=identicon&r=PG&f=1", "display_name": "heavyqtuser", "link": "https://stackoverflow.com/users/11730909/heavyqtuser"}, "edited": false, "score": 0, "creation_date": 1562784773, "post_id": 56973161, "comment_id": 100490085, "body": "Thank you very much, this helps immensely! An unrelated question that came to mind when considering the details you pointed out: at where/how is the linker instructed to include the compiled QRC file with your program? Is that something Qt handles for you?"}, {"owner": {"reputation": 10619, "user_id": 345027, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de94a2d703fa12904d400de1fc86c251?s=128&d=identicon&r=PG", "display_name": "king_nak", "link": "https://stackoverflow.com/users/345027/king-nak"}, "reply_to_user": {"reputation": 57, "user_id": 11730909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f74f82b295e682a4d2fddb3c08bc0d7?s=128&d=identicon&r=PG&f=1", "display_name": "heavyqtuser", "link": "https://stackoverflow.com/users/11730909/heavyqtuser"}, "edited": false, "score": 0, "creation_date": 1562832446, "post_id": 56973161, "comment_id": 100503915, "body": "AFAIR, rcc compiles to a c++ source file (using <code>static char[]</code> for the assets), and this is then compiled to an object,and linked into your program; or you simply <code>#include</code> that file in one of your own c++ files. How all this is invoked depends on your IDE / build system. qmake does all this under the hood"}], "tags": [], "owner": {"reputation": 10619, "user_id": 345027, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de94a2d703fa12904d400de1fc86c251?s=128&d=identicon&r=PG", "display_name": "king_nak", "link": "https://stackoverflow.com/users/345027/king-nak"}, "is_accepted": true, "score": 1, "last_activity_date": 1562770051, "last_edit_date": 1562770051, "creation_date": 1562769689, "answer_id": 56973161, "question_id": 56973104, "link": "https://stackoverflow.com/questions/56973104/why-does-giving-icons-controller-png-to-a-constructor-work-is-that-valid-re/56973161#56973161", "title": "Why does giving &quot;:/Icons/controller.png&quot; to a constructor work (is that valid relative filepath syntax)?", "body": "<p><code>:/</code> paths are paths in the <a href=\"https://doc.qt.io/qt-5/resources.html\" rel=\"nofollow noreferrer\">Qt Resource System</a>.</p>\n\n<p>You have a QRC file that is compiled and bundled with your executable. It references the images.</p>\n\n<p>E.g. your qrc file contains this:</p>\n\n<pre><code>&lt;RCC version=\"1.0\"&gt;\n    &lt;qresource&gt;\n        &lt;file&gt;Icons/controller.png&lt;/file&gt;\n    &lt;/qresource&gt;\n&lt;/RCC&gt;      \n</code></pre>\n\n<p>This is then compiled in your build process with the RCC compiler. This file is then linked with your exe.</p>\n\n<p>The default resources are automatically registered, but you can also compile resources into external RCC bundles, and load them at runtime using <code>QResource::registerResource(\"/path/to/myresource.rcc\");</code></p>\n"}], "owner": {"reputation": 57, "user_id": 11730909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f74f82b295e682a4d2fddb3c08bc0d7?s=128&d=identicon&r=PG&f=1", "display_name": "heavyqtuser", "link": "https://stackoverflow.com/users/11730909/heavyqtuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 56973161, "answer_count": 1, "score": 0, "last_activity_date": 1562770051, "creation_date": 1562769535, "question_id": 56973104, "link": "https://stackoverflow.com/questions/56973104/why-does-giving-icons-controller-png-to-a-constructor-work-is-that-valid-re", "title": "Why does giving &quot;:/Icons/controller.png&quot; to a constructor work (is that valid relative filepath syntax)?", "body": "<p>The details of the situation don't matter, but in particular I'm making a QIcon object (part of the Qt library) out of a .png file. The constructor for this takes a string that should be a filepath </p>\n\n<p>I find that, instead of using an absolute path, I can simply give something like <code>\":/Icons/controller.png\"</code> to the constructor and the icon is still correctly retrieved and displayed.</p>\n\n<p>My project is huge so I won't write out the hierarchy and where the file is relative to everything else, but they're at 3 degrees of separation at least. Because of this I think there's some sort of file searching mechanic that I don't know of. Can anyone guess what's going on here?</p>\n"}, {"tags": ["c++", "stdvector"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 6, "creation_date": 1562768944, "post_id": 56972894, "comment_id": 100482138, "body": "AFAIK this is nasal demons"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1562768978, "post_id": 56972894, "comment_id": 100482156, "body": "@SombreroChicken but you don&#39;t even have a nose! UB sure is scary."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1562768980, "post_id": 56972894, "comment_id": 100482158, "body": "Contains UB and slicing."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1562769044, "post_id": 56972894, "comment_id": 100482203, "body": "@Quentin Your UB is the equivalent of oral leeks. Flying. Everywhere."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1562769316, "post_id": 56972894, "comment_id": 100482361, "body": "<code>std::vector&lt;T&gt;</code> and <code>std::vector&lt;U&gt;</code> are unrelated, regardless of the relationship between <code>T</code> and <code>U</code> (unless <code>T</code> and <code>U</code> are exactly the same type). You need to copy the vector element-wise (one element at a time)."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1562769318, "post_id": 56972894, "comment_id": 100482363, "body": "In general if you are using a cast, especially a C style cast in C++ the likelihood that you are doing something ill advised or just plain wrong is fairly high. You can often use a C style cast in order to make something compile but just because it compiles does not mean it is right. UB by the way is Undefined Behavior which means that the code is written such that there is no clear, unambiguous functionality that may come from the code. It might work or it might not."}, {"owner": {"reputation": 231, "user_id": 3348707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NF8gI.jpg?s=128&g=1", "display_name": "Vincenzo La Spesa", "link": "https://stackoverflow.com/users/3348707/vincenzo-la-spesa"}, "edited": false, "score": 0, "creation_date": 1562769331, "post_id": 56972894, "comment_id": 100482371, "body": "What`s wrong in just returning the vector &quot;by value&quot;? It would copy the header structure with the pointer to the actual data."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1562769793, "post_id": 56972894, "comment_id": 100482651, "body": "<i>I have another function that wants that data, but it has a vector of objects that extend the main vector&#39;s data type.</i> -- There is a reason why <a href=\"https://en.cppreference.com/w/cpp/algorithm/transform\" rel=\"nofollow noreferrer\">std::transform</a> exists, and your case is one of them."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1562770175, "post_id": 56972894, "comment_id": 100482875, "body": "This may appear to work (even though it&#39;s undefined behavior) in this exact code, but as soon as <code>Row</code> and <code>SuperRow</code> get more complicated you will probably observe nasty things happening. And your &quot;other way&quot; is exactly the same as the first one - you cannot convert a pointer to <code>std::vector&lt;X&gt;</code> to a pointer to <code>std::vector&lt;Y&gt;</code> if <code>X</code> and <code>Y</code> are different."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562770241, "post_id": 56972894, "comment_id": 100482924, "body": "Side note: Why do you have pointers to the <code>vector</code>s? You are not even checking if they are <code>nullptr</code> before dereferencing them. You should probably use references."}, {"owner": {"reputation": 141, "user_id": 11735012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/266a85e18fe143e6cf8141298cad0a2e?s=128&d=identicon&r=PG&f=1", "display_name": "errno_44", "link": "https://stackoverflow.com/users/11735012/errno-44"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562770407, "post_id": 56972894, "comment_id": 100483015, "body": "@TedLyngmo I wrote this all as an example to illustrate the real question"}, {"owner": {"reputation": 141, "user_id": 11735012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/266a85e18fe143e6cf8141298cad0a2e?s=128&d=identicon&r=PG&f=1", "display_name": "errno_44", "link": "https://stackoverflow.com/users/11735012/errno-44"}, "edited": false, "score": 0, "creation_date": 1562770493, "post_id": 56972894, "comment_id": 100483066, "body": "Is this just &quot;not okay&quot; with containers? Because everywhere in our code base I see people casting object ptrs to their base classes, ie <code>GetThatRow((Row*)&amp;mySuperRow);</code>"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562770715, "post_id": 56972894, "comment_id": 100483184, "body": "@errno_44 Ok, I&#39;d change it to references in the question to not obscure the real question."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1562773368, "post_id": 56972894, "comment_id": 100484730, "body": "@errno_44 <code>GetRowsOtherWay((std::vector&lt;Row&gt;*)rows);</code> -- Remove those C-style cast from your code and recompile your program.  What error does the compiler give you?  Whatever it is, all you&#39;re doing when you use casts like that is to circumvent the type-safety of C++.  The compiler knows something is wrong, but you&#39;re claiming you know better by applying such casts."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1562785857, "post_id": 56972894, "comment_id": 100490539, "body": "@errno_44 in <code>GetThatRow((Row*)&amp;mySuperRow);</code> the cast is not necessary since <code>SuperRow</code> derives from <code>Row</code>, so a <code>SuperRow*</code> pointer can be used as-is wherever a <code>Row*</code> pointer is expected.  Same with <code>SuperRow&amp;</code> and <code>Row&amp;</code> references."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 11735012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/266a85e18fe143e6cf8141298cad0a2e?s=128&d=identicon&r=PG&f=1", "display_name": "errno_44", "link": "https://stackoverflow.com/users/11735012/errno-44"}, "edited": false, "score": 0, "creation_date": 1562772444, "post_id": 56973373, "comment_id": 100484197, "body": "Shouldn&#39;t explicitly casting an object to its base class be the same as explicitly casting a vector of objects to a vector of the objects base class? How do we <i>know</i> this is UB?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 141, "user_id": 11735012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/266a85e18fe143e6cf8141298cad0a2e?s=128&d=identicon&r=PG&f=1", "display_name": "errno_44", "link": "https://stackoverflow.com/users/11735012/errno-44"}, "edited": false, "score": 1, "creation_date": 1562786042, "post_id": 56973373, "comment_id": 100490607, "body": "@errno_44 no, the two types of casts are not the same thing. Casting a single object to a base type is legal and defined behavior. Casting a container of one type to a container of another type is undefined behavior."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1562773626, "last_edit_date": 1562773626, "creation_date": 1562770329, "answer_id": 56973373, "question_id": 56972894, "link": "https://stackoverflow.com/questions/56972894/casting-a-vector-address-to-copy-data/56973373#56973373", "title": "Casting a vector address to copy data", "body": "<blockquote>\n  <p>but I can't tell if it is really .. legal. </p>\n</blockquote>\n\n<p><code>GetData</code> and <code>GetDataOtherWay</code> are not \"legal\". The behaviour of the program is undefined.</p>\n\n<p><code>GetRowsOtherWay</code> by itself is fine although, you should probably use a reference instead of pointer argument. If you do use a pointer, then you should probably check that it isn't null.</p>\n\n<blockquote>\n  <p>Is this just \"not okay\" with containers? Because everywhere in our code base I see people casting object ptrs to their base classes, ie <code>GetThatRow((Row*)&amp;mySuperRow);</code></p>\n</blockquote>\n\n<p>Converting a pointer to a pointer to base is OK. However, vector of derived object is not derived from vector of base object. Vector has no base class at all.</p>\n\n<p>Note that the cast there is superfluous and risky. Conversion to base pointer is implicit, so <code>GetThatRow(&amp;mySuperRow)</code> works just as well. If you want to make it explicit, use <code>static_cast</code> so that the compiler will enforce type safety.</p>\n\n<blockquote>\n  <p>This works</p>\n</blockquote>\n\n<p>Appearance of \"working\" as you expected is an example of a possible undefined behaviour.</p>\n\n<hr>\n\n<blockquote>\n  <p>Shouldn't explicitly casting an object to its base class be the same as explicitly casting a vector of objects to a vector of the objects base class?</p>\n</blockquote>\n\n<p>It is not the same. Also, we are discussing conversion of pointers (although applies of references as well) here, not conversion of objects. There exists a static conversion from a pointer type to another pointer type in the same inheritance hierarchy. There does not exist a static conversion from a pointer to one vector to a pointer to another vector. Those types are not related through inheritance.</p>\n\n<blockquote>\n  <p>How do we know this is UB?</p>\n</blockquote>\n\n<p>Because the standard says so (quote from the standard draft):</p>\n\n<blockquote>\n  <p>[basic.lval]</p>\n  \n  <p>If a program attempts to access the stored value of an object through\n  a glvalue whose type is not similar ([conv.qual]) to one of the\n  following types <strong>the behavior is undefined</strong>:</p>\n  \n  <ul>\n  <li>the dynamic type of the object,</li>\n  <li>a type that is the signed or unsigned type corresponding to the dynamic type of the object, or</li>\n  <li>a char, unsigned char, or std::byte type.</li>\n  </ul>\n</blockquote>\n\n<p><code>std::vector&lt;Row&gt;</code> is not similar to the dynamic type of <code>*rows</code> (which is <code>std::vector&lt;SuperRow&gt;</code>) nor is similar to a signed or unsigned corresponding type, nor is it similar to <code>char</code>, <code>unsigned char</code> or <code>std::byte</code>.</p>\n\n<p>A good rule of thumb: Avoid reinterpret casting, and if you need it, make sure that you know the language rules that are involved, and that you're not violating them. And never ever use C-style cast because it does reinterpret casting whether you intended it or not.</p>\n\n<hr>\n\n<p>How to create a vector of derived objects from a vector of base objects: Firstly, you need a function that creates a derived object from the base. A base object is typically not convertible to its derived types, although it is possible to make it so by adding a converting constructor to the derived type. Once you've written such function, use <code>std::transform</code> to apply it to the vector of bases.</p>\n\n<p>Converting a vector of derived to vector of bases is simpler, because the base sub object can simply be copied and returned. This operation is called slicing.</p>\n"}], "owner": {"reputation": 141, "user_id": 11735012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/266a85e18fe143e6cf8141298cad0a2e?s=128&d=identicon&r=PG&f=1", "display_name": "errno_44", "link": "https://stackoverflow.com/users/11735012/errno-44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 56973373, "answer_count": 1, "score": 1, "last_activity_date": 1562773626, "creation_date": 1562768835, "last_edit_date": 1562773273, "question_id": 56972894, "link": "https://stackoverflow.com/questions/56972894/casting-a-vector-address-to-copy-data", "title": "Casting a vector address to copy data", "body": "<p>I have written an operation that seems to work fine, but I can't tell if it is really .. legal. </p>\n\n<p>I have a row class, and extension</p>\n\n<pre><code>class Row {};\nclass SuperRow : public Row {};\n</code></pre>\n\n<p>I have a function that returns a vector</p>\n\n<pre><code>std::vector&lt;Row&gt; GetRows(){\n    Row row1;\n    Row row2;\n    std::vector&lt;Row&gt; rows;\n    rows.push_back(row1);\n    rows.push_back(row2);\n    return rows;\n}\n</code></pre>\n\n<p>I have another function that wants that data, but it has a vector of objects that extend the main vector's data type.</p>\n\n<pre><code>void GetData(std::vector&lt;SuperRow&gt; *rows){\n    // in order to compile, must do this\n    *((std::vector&lt;Row&gt;*)rows) = GetRows();\n}\n</code></pre>\n\n<p>This works, but I'm looking at it like I'm doing something wrong..\n[edit: OK, clearly this is terrible]</p>\n\n<hr>\n\n<p>I am also doing maybe the same thing in a different way.. </p>\n\n<pre><code>void GetRowsOtherWay(std::vector&lt;Row&gt; *rows){\n   *rows = GetRows();\n}\n\nvoid GetDataOtherWay(std::vector&lt;SuperRow&gt; *rows){\n    GetRowsOtherWay((std::vector&lt;Row&gt;*)rows);\n}\n</code></pre>\n\n<p>Is this also bad?</p>\n"}, {"tags": ["c++", "visual-studio-2012", "compiler-errors", "cuda"], "comments": [{"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1562769047, "post_id": 56972857, "comment_id": 100482207, "body": "The first issue is described <a href=\"https://stackoverflow.com/questions/5246900/enabling-vlas-variable-length-arrays-in-ms-visual-c\">here</a>, it has nothing to do with CUDA."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1562769254, "post_id": 56972857, "comment_id": 100482339, "body": "The second issue is an enumerated limitation of CUDA when used with microsoft host compiler, see <a href=\"https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#const-variables\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1562775603, "post_id": 56972857, "comment_id": 100485964, "body": "The first issue is that your program is not standard C++, it&#39;s g++-only.  Try passing the <code>-pedantic</code> and <code>-ansi</code> options when compiling on Linux to help you find these issues earlier."}], "answers": [{"comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1562775693, "post_id": 56974843, "comment_id": 100486015, "body": "Your link for the first issue is about compiling C programs (where VLAs are allowed) with the Microsoft compiler.  This question is about a C++ program, where there simply is no such thing as a VLA."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1562775933, "post_id": 56974843, "comment_id": 100486118, "body": "@BenVoigt  I don&#39;t disagree, but on linux, <a href=\"https://stackoverflow.com/questions/39334435/variable-length-array-vla-in-c-compilers\">at least with gnu</a>, the g++ compiler seems to allow the use of VLA even in a C++ program.  And this is I suspect in part where OP&#39;s question is originating, because they are witnessing a VLA working on Linux when compiled with <code>nvcc</code>, which uses g++ under the hood for host code compilation,which is what is in view here. I will edit my answer to make a reference to this, but I don&#39;t think an extended discussion in this answer will add any clarity."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1562776082, "post_id": 56974843, "comment_id": 100486186, "body": "Your new link is better, because it reflects that this is not supposed to work, vs the first link saying it&#39;s a missing feature."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1562777252, "post_id": 56974843, "comment_id": 100486754, "body": "edited my answer, feel free to edit it if you want to try to explain it better."}], "tags": [], "owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "is_accepted": true, "score": 3, "last_activity_date": 1562777222, "last_edit_date": 1562777222, "creation_date": 1562775459, "answer_id": 56974843, "question_id": 56972857, "link": "https://stackoverflow.com/questions/56972857/cuda-code-compile-on-linux-but-not-in-windows-visual-studio-2012/56974843#56974843", "title": "CUDA code compile on Linux but not in Windows ( Visual Studio 2012)", "body": "<p>You won't be able to fix either of these problems just by changing compiler versions or anything like that.</p>\n\n<p>The first issue is described <a href=\"https://stackoverflow.com/questions/5246900/enabling-vlas-variable-length-arrays-in-ms-visual-c\">here</a>  and <a href=\"https://stackoverflow.com/questions/39334435/variable-length-array-vla-in-c-compilers\">here</a>, it has nothing to do with CUDA except insofar as CUDA is making use of the host compiler.  The code you have shown makes use of a VLA (variable length array) which is part of the C99 standard but not part of any C++ standard.  CUDA is primarily implemented based on C++, and makes use of the C++ host compiler to compile host code, which is what you have shown.  On windows it is using the Microsoft compiler for that.  So the Microsoft compiler is correct to disallow VLA, and there is no way to avoid this AFAIK.  Your code works on linux, because on linux <code>nvcc</code> uses the <code>g++</code> host compiler, and it allows (in a non-standard-compliant way) the use of a VLA in C++ host code.  </p>\n\n<p>I don't know of any method to address this that doesn't involve some change to your code, for cross-platform compatibility.  But a small amount of (C or) C++ programming skill can provide a solution for you that should work either on linux or windows:</p>\n\n<pre><code>int n_devices = 0;\ncudaGetDeviceCount(&amp;n_devices);\ncudaDeviceProp *props = new cudaDeviceProp[n_devices];\n</code></pre>\n\n<p>(if you wanted to use a C compliant method, you could use <code>malloc</code> in a similar fashion)</p>\n\n<p>The second issue is a limitation of CUDA, it is documented <a href=\"https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#const-variables\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>There is also no method to address this cross-platform that I know of that involves no changes to your code.</p>\n\n<p>You already have identified one possible workaround that can work in a cross-platform way both on linux and windows:</p>\n\n<pre><code>#define PI 3.141592654f\n#define EPS 1e-3f\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10620057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caacd33062626fa13877b41b4955c357?s=128&d=identicon&r=PG&f=1", "display_name": "ClaudiaBordone", "link": "https://stackoverflow.com/users/10620057/claudiabordone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 56974843, "answer_count": 1, "score": 0, "last_activity_date": 1562777222, "creation_date": 1562768690, "last_edit_date": 1562768754, "question_id": 56972857, "link": "https://stackoverflow.com/questions/56972857/cuda-code-compile-on-linux-but-not-in-windows-visual-studio-2012", "title": "CUDA code compile on Linux but not in Windows ( Visual Studio 2012)", "body": "<p>I'm developing a program that use CUDA developing toolkit version 10.1 and I'm using visual studio 2012. \nI'm working on windows but I share code with a linux user. All the code works fine on the two cases, except for some line of code that works on linux but not on windows. So every time I have to change these lines. I would avoid to do this and by the fact that on linux the code compile well, I think there are some reasons why on windows doesn't compile, but these reasons must be for sure not about the code but about some visual studio setting or similar. Can you help me? \nIn particular the line of codes are:</p>\n\n<pre><code>int n_devices = 0;\ncudaGetDeviceCount(&amp;n_devices);\ncudaDeviceProp props[n_devices];\n</code></pre>\n\n<p>On the last line i have the error:</p>\n\n<blockquote>\n  <p>error: expression must have a constant value</p>\n</blockquote>\n\n<p>I can fix this error defining <code>const int n_devices = 1;</code> and commenting the function <code>cudaGetDeviceCount(&amp;n_devices);</code>. It works because I already know the right number of devices but for sure is less right solution than the previous one.</p>\n\n<p>The other problem is that I have a utils.cuh file in which there are defined two const value</p>\n\n<pre><code>const float PI = 3.141592654f;\nconst float EPS = 1e-3f;\n</code></pre>\n\n<p>I invoke this two values in the utils.cu file and at compile time i have the error:</p>\n\n<blockquote>\n  <p>error: \"PI\" is undefined in device code </p>\n  \n  <p>error: \"EPS\" is undefined in device code</p>\n</blockquote>\n\n<p>I can fix this declaring these two variables in this way:</p>\n\n<pre><code>#define PI 3.141592654f\n#define EPS 1e-3f\n</code></pre>\n\n<p>So even if I can fix all the two problems I really want to leave the code in the first configuration (since it works on linux). Could be a problem related to compiler version? I really don't know which could be the reason.</p>\n"}, {"tags": ["c++", "ubuntu", "virtual-machine", "virtualbox", "grpc"], "comments": [{"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1562771368, "post_id": 56972844, "comment_id": 100483569, "body": "Likely culprits are firewalls and antivirus."}, {"owner": {"reputation": 812, "user_id": 6288413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bLBoc.jpg?s=128&g=1", "display_name": "zmike", "link": "https://stackoverflow.com/users/6288413/zmike"}, "edited": false, "score": 0, "creation_date": 1562771396, "post_id": 56972844, "comment_id": 100483584, "body": "What ports are you using? They could either be alreayd in use or firewalled. See <a href=\"https://stackoverflow.com/questions/30251889/how-to-open-some-ports-on-ubuntu\" title=\"how to open some ports on ubuntu\">stackoverflow.com/questions/30251889/&hellip;</a>"}, {"owner": {"reputation": 812, "user_id": 6288413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bLBoc.jpg?s=128&g=1", "display_name": "zmike", "link": "https://stackoverflow.com/users/6288413/zmike"}, "edited": false, "score": 0, "creation_date": 1562771601, "post_id": 56972844, "comment_id": 100483709, "body": "To find the ip address of each VM (although you probably just want the server IP), run the following command: <code>ifconfig eth0</code> in each of them. You could also try looking at connected devices in your router web interface."}, {"owner": {"reputation": 266, "user_id": 3126412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ea8f5b3c59f08f91cac73f81147eb8?s=128&d=identicon&r=PG&f=1", "display_name": "user3126412", "link": "https://stackoverflow.com/users/3126412/user3126412"}, "edited": false, "score": 0, "creation_date": 1562779792, "post_id": 56972844, "comment_id": 100487929, "body": "This is likely a firewall issue. Check iptables rules on your VMs. You can check tcpdump to verify if you&#39;re receiving traffic on the server side."}], "owner": {"reputation": 41, "user_id": 11724335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e57736ef6be17e6869e73025fbb6030?s=128&d=identicon&r=PG&f=1", "display_name": "LeenA", "link": "https://stackoverflow.com/users/11724335/leena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562770775, "creation_date": 1562768664, "last_edit_date": 1562770775, "question_id": 56972844, "link": "https://stackoverflow.com/questions/56972844/unable-to-connect-to-localhost-on-two-different-machines", "title": "Unable to connect to localhost on two different machines", "body": "<p>I am running the gRPC C++ helloworld example from the official website ( <a href=\"https://grpc.io/docs/quickstart/cpp/\" rel=\"nofollow noreferrer\">https://grpc.io/docs/quickstart/cpp/</a>). It works just fine when I run the client and server code using two different console windows. The connection fails, however, when I try to run it using two different laptops.</p>\n\n<blockquote>\n  <p>14: Connect Failed<br>\n  Greeter received: RPC failed<br>\n  14: Connect Failed<br>\n  Greeter received: RPC failed</p>\n</blockquote>\n\n<p>On both laptops I am running Ubuntu 19.04 on VirtualBox, and they are connected to the same network. The address I used is the IPv4 address listed under the \nnetwork settings. </p>\n\n<p>I am not sure what is causing the problem. I tried looking up the correct IP address to use in such a case but my efforts were futile. I would appreciate it if I am given some direction on how to proceed.</p>\n"}, {"tags": ["c++", "googletest", "ros", "fixtures"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1562769186, "post_id": 56972833, "comment_id": 100482296, "body": "It depends on what you need. If <code>nh</code> should be singleton (one object for all the tests), the you could just make it global object. If it may or should be recreated for every test suite/test case, then place it in either <code>SetUpTestSuite</code> or <code>SetUp</code>"}, {"owner": {"reputation": 73, "user_id": 11535226, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R_-orOcgd3Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdo6DQ7RGaNqsXE0iKpAf9IjX9vLw/mo/photo.jpg?sz=128", "display_name": "Weiyu He", "link": "https://stackoverflow.com/users/11535226/weiyu-he"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1562779058, "post_id": 56972833, "comment_id": 100487587, "body": "I managed to work around this by putting ros::NodeHandle nh; inside the class. But I still would love to know if there is a way to send it from main to the class using SetUp. I thought SetUp can only be called in TEST_F?"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1562779955, "post_id": 56972833, "comment_id": 100487991, "body": "I don&#39;t know of any way to pass something to the test class. GoogleTest hides all the magic it uses to instantiate and run every test. About SetUp, every <code>TEST_F</code> does the following: Create an instance of the test class -&gt; call <code>SetUp()</code> on the instance -&gt; execute test body -&gt; call <code>TearDown</code> on the instance -&gt; destroy instance. You should not call <code>SetUp</code> by yourself (although it shouldn&#39;t break the code in any way)."}, {"owner": {"reputation": 8645, "user_id": 5235574, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wEodm.jpg?s=128&g=1", "display_name": "Fruchtzwerg", "link": "https://stackoverflow.com/users/5235574/fruchtzwerg"}, "edited": false, "score": 0, "creation_date": 1562905720, "post_id": 56972833, "comment_id": 100533552, "body": "You can overload the <code>SetUp</code> method like described in this answer: <a href=\"https://stackoverflow.com/questions/38207346/specify-constructor-arguments-for-a-google-test-fixture\" title=\"specify constructor arguments for a google test fixture\">stackoverflow.com/questions/38207346/&hellip;</a>"}, {"owner": {"reputation": 1705, "user_id": 9103250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3c613d7186c7314ee818673ea4c79fd?s=128&d=identicon&r=PG&f=1", "display_name": "CharonX", "link": "https://stackoverflow.com/users/9103250/charonx"}, "edited": false, "score": 0, "creation_date": 1563261392, "post_id": 56972833, "comment_id": 100630222, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/38207346/specify-constructor-arguments-for-a-google-test-fixture\">Specify constructor arguments for a Google test Fixture</a>"}], "owner": {"reputation": 73, "user_id": 11535226, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R_-orOcgd3Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdo6DQ7RGaNqsXE0iKpAf9IjX9vLw/mo/photo.jpg?sz=128", "display_name": "Weiyu He", "link": "https://stackoverflow.com/users/11535226/weiyu-he"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562768632, "creation_date": 1562768632, "question_id": 56972833, "link": "https://stackoverflow.com/questions/56972833/c-gtest-how-to-pass-parameter-to-a-class-fixture", "title": "C++ Gtest how to pass parameter to a class fixture?", "body": "<p>I am a bit confused on how to pass parameter from main to the class fixture. Say I have:</p>\n\n<pre><code>#include \"robot.h\"\nclass Checksweep : public testing::Test{\npublic: \n  Checksweep(){}\n  virtual void SetUp() {\n\n    Robot1 = new Robot(&amp;nh);\n  }\n\n  virtual void TearDown() { delete Robot1; }\n\n  Robot *Robot1;\n\n};\n\nTEST_F(Checksweep, MyTestCaseName)\n{\n}\n\nint main(int argc, char **argv){\n  testing::InitGoogleTest(&amp;argc, argv);\n  ros::init(argc, argv, \"robot_test_node\");\n  ros::NodeHandle nh;\n  return RUN_ALL_TESTS();\n}\n</code></pre>\n\n<p>Are there anyway for me to send <code>nh</code> from <code>main()</code> to <code>setup()</code> in the <code>Checksweep</code> class?</p>\n"}, {"tags": ["c++", "windows", "credentials", "credential-providers"], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562842641, "post_id": 56986505, "comment_id": 100509758, "body": "I&#39;m sorry, the question was how to forward credentials from application to credential provider when none is logged on, create session(remotly) without any physical interaction. I didn&#39;t understand how your answer fits in."}, {"owner": {"reputation": 141, "user_id": 10413236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hYXzFol29vk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV_R5xQu7hXaWUg1X2HF31nd08XIw/mo/photo.jpg?sz=128", "display_name": "Kianii", "link": "https://stackoverflow.com/users/10413236/kianii"}, "reply_to_user": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562845030, "post_id": 56986505, "comment_id": 100511098, "body": "I agree most of my answer is focused on answering the side-question you asked. But as i said in the lower part of the answer, the credential is supposed to load your application. Then it callback to GetSerialization for providing login/password. Did i misunderstand something ?"}, {"owner": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562846275, "post_id": 56986505, "comment_id": 100511829, "body": "I think I misunderstood something. As I know <code>GetSerialization</code> is called after I click submit button on UI and submit this credential to the underlying authentication engine right? You are saying that <code>Credential is supposed to load your application</code> what exactly do you mean by that?"}, {"owner": {"reputation": 141, "user_id": 10413236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hYXzFol29vk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV_R5xQu7hXaWUg1X2HF31nd08XIw/mo/photo.jpg?sz=128", "display_name": "Kianii", "link": "https://stackoverflow.com/users/10413236/kianii"}, "reply_to_user": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562847327, "post_id": 56986505, "comment_id": 100512480, "body": "Click Submit button or you can also use the autoLogin feature by calling CredentialsChanged event. It will callback to GetCredentialCount which will call to GetSerialization if AutoLogon is enabled. This is for the no-physical interaction. What i mean is, i&#39;m personnaly loading a c++ dll and i&#39;m starting a thread for &#39;wait login/password from dll&#39;. But in your case, it would be ssh server connection or whatever you usually do to retrieve data."}, {"owner": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562847541, "post_id": 56986505, "comment_id": 100512618, "body": "So As I understand I can lunch some thread from credential provider(for example wait for user/pass by pipe), receive creds and then call <code>CredentialsChanged</code> which will call <code>GetSerialization</code> and eventually log in?"}, {"owner": {"reputation": 141, "user_id": 10413236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hYXzFol29vk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV_R5xQu7hXaWUg1X2HF31nd08XIw/mo/photo.jpg?sz=128", "display_name": "Kianii", "link": "https://stackoverflow.com/users/10413236/kianii"}, "reply_to_user": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562849007, "post_id": 56986505, "comment_id": 100513558, "body": "In the condition that autoLogon is activated and that you provide a valid default Credential. I&#39;ll update my answer to make an &quot;example&quot; of how i would do."}, {"owner": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562849570, "post_id": 56986505, "comment_id": 100513920, "body": "Thanks for example. But I think we misunderstood each other. In your example credential provider would connect to something and retrieve credentials from there. What I want is that when LogonUI is hit(machine A), then when someone tries to connect to machine A(using my app ssh alike), I want this app to forward those credentials to provider and create session."}, {"owner": {"reputation": 141, "user_id": 10413236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hYXzFol29vk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV_R5xQu7hXaWUg1X2HF31nd08XIw/mo/photo.jpg?sz=128", "display_name": "Kianii", "link": "https://stackoverflow.com/users/10413236/kianii"}, "reply_to_user": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562853296, "post_id": 56986505, "comment_id": 100516349, "body": "Oh. No clue sorry. I can&#39;t remember of any feature about ssh connection listening..."}, {"owner": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562853862, "post_id": 56986505, "comment_id": 100516673, "body": "Maybe I could have like a thread in credential provider listening to a pipe, my app would write username and password there, Can I then fill username/password field on UI and hit submit programatically from credential provider?"}, {"owner": {"reputation": 141, "user_id": 10413236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hYXzFol29vk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV_R5xQu7hXaWUg1X2HF31nd08XIw/mo/photo.jpg?sz=128", "display_name": "Kianii", "link": "https://stackoverflow.com/users/10413236/kianii"}, "reply_to_user": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562854317, "post_id": 56986505, "comment_id": 100516941, "body": "That would work as long as you successfully listen to your pipe. Credential only asks for login/password. It doesn&#39;t care of what you&#39;re doing in between."}, {"owner": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562854672, "post_id": 56986505, "comment_id": 100517158, "body": "Do you know function which would do that? Like which function would emit clicking the submit button?"}, {"owner": {"reputation": 141, "user_id": 10413236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hYXzFol29vk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV_R5xQu7hXaWUg1X2HF31nd08XIw/mo/photo.jpg?sz=128", "display_name": "Kianii", "link": "https://stackoverflow.com/users/10413236/kianii"}, "reply_to_user": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562855939, "post_id": 56986505, "comment_id": 100517979, "body": "Refer to the example i added to my answer. Submit Click call Connect which call GetSerialization. CredentialsChanged call GetCredentialCount which call GetSerialization if autoLogon is enabled."}, {"owner": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "edited": false, "score": 0, "creation_date": 1562917743, "post_id": 56986505, "comment_id": 100537985, "body": "and How can I set some strings in username/password field?"}], "tags": [], "owner": {"reputation": 141, "user_id": 10413236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hYXzFol29vk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV_R5xQu7hXaWUg1X2HF31nd08XIw/mo/photo.jpg?sz=128", "display_name": "Kianii", "link": "https://stackoverflow.com/users/10413236/kianii"}, "is_accepted": false, "score": -1, "last_activity_date": 1562849182, "last_edit_date": 1562849182, "creation_date": 1562838858, "answer_id": 56986505, "question_id": 56972817, "link": "https://stackoverflow.com/questions/56972817/forward-credentials-from-app-to-credential-provider/56986505#56986505", "title": "Forward credentials from app to credential provider", "body": "<p>I wouldn't mind too much of SetSerialization in your case. This is used for pre-initializing tile.</p>\n\n<p>One example would be, with RDP connection, you can store certificates of credentials on your system. This function is used to pre-inquire tiles with those credentials (not the only solution though).</p>\n\n<p>Make it return E_NOTIMPL in your case.</p>\n\n<p>The main purpose of the provider is to initialize Credentials and tiles :</p>\n\n<ol>\n<li><strong>Credentials initialization</strong> </li>\n</ol>\n\n<p>is done through SetUsageScenario function (automatically called after Provider construction).\nIn there, you can customize the behavior depending on scenario you are in. Most basic one being CPUS_LOGON.\nIt shall look like this (this is only a preview)</p>\n\n<pre><code>HRESULT Provider::SetUsageScenario(\n__in CREDENTIAL_PROVIDER_USAGE_SCENARIO cpus,\n__in DWORD dwFlags\n)\n{\n    HRESULT hr;\n\n    switch(cpus)\n    {\n        case CPUS_UNLOCK_WORKSTATION:\n        case CPUS_LOGON:\n        hr = this-&gt;_InitCredential();\n        break;\n\n        default:\n        hr = E_INVALIDARG;\n        break;\n    }\n\n    return hr;\n}\n</code></pre>\n\n<ol start=\"2\">\n<li><strong>Tiles initialization</strong></li>\n</ol>\n\n<p>begins in GetCredentialCount function. It allows you to define how many tiles you gonna show (pdwCount out parameter), as well as the one to be used as the default tile (pdwDefault).\nAuto-Logon is also handle in here (through pbAutoLogonWithDefault).</p>\n\n<p>Tiles Enumeration is then beginning in GetCredentialAt function.</p>\n\n<p>Passing credentials for authentication is done in the credential you're using through the GetSerialization function.</p>\n\n<p>Examples of implementation can be found <a href=\"https://github.com/microsoft/Windows-classic-samples/blob/master/Samples/CredentialProvider/cpp/CSampleCredential.cpp\" rel=\"nofollow noreferrer\">here</a>.\nI hardly insist on example as it easily divert depending on what you are trying to achieve. This is very flexible and you'd better understand the purpose of any function / parameter to fit your goals.</p>\n\n<p>EDIT - cf comments :</p>\n\n<pre><code>#define IDCredential        0x1\n\nCredential::Credential(Provider* parent)\n{\n    //Do ssh connection or whatever\n\n    if(success)\n    {\n        parent-&gt;login = retrievedLogin;\n        parent-&gt;pwd = retrievedPwd;\n        parent-&gt;CredentialUsed = IDCredential;\n        parent-&gt;autoLogin = true;\n        parent-&gt;ProviderEvents-&gt;CredentialsChanged(AdviseContext);\n    }\n}\n\nHRESULT Provider::GetCredentialCount(\n    __out DWORD* pdwCount,\n    __out_range(&lt;,*pdwCount) DWORD* pdwDefault,\n    __out BOOL* pbAutoLogonWithDefault\n    )\n{\n    if(this-&gt;autoLogin &amp;&amp; this-&gt;CredentialUsed)\n    {\n        *pbAutoLogonWithDefault = true; // --&gt; Instant call to GetSerialization\n        *pdwDefault = this-&gt;CredentialUsed; //index of the tile\n    }\n    else\n    {\n        *pbAutoLogonWithDefault = false;\n        *pdwDefault = IDCredential;\n    }\n\n    return S_OK;\n}\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 8097075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ebed3f1159a0cda465f47a552eff43?s=128&d=identicon&r=PG&f=1", "display_name": "user3503143", "link": "https://stackoverflow.com/users/8097075/user3503143"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 390, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1562849182, "creation_date": 1562768583, "question_id": 56972817, "link": "https://stackoverflow.com/questions/56972817/forward-credentials-from-app-to-credential-provider", "title": "Forward credentials from app to credential provider", "body": "<p>I've started to investigate how credential providers work, but due to poor documentation I got stuck in couple of places. </p>\n\n<p>I have console application(sort of like ssh server) when I connect remotly to this application and authenticate(none is logged on), I want it to be able to forward those credentials to credential provider and I want CP to login user(create session).</p>\n\n<p>I've also noticed that In documentation it says that <code>SetSerialization</code> method always gets called after <code>SetusageScenario</code>. But I've added logs and <code>SetSerialization</code> never gets called after <code>SetusageScenario</code>.</p>\n\n<p>As I know <code>SetSerialization</code> is called when credential is provided by application. I can't understand what does it mean to provide credential through application? It seems like this is what I need, to forward credentials from application to credential provider, but How can I do that? Are there some functions that I could call from credential provider dll to provoke login?</p>\n\n<p>Is there any way I can achieve this? I've read that when remote login is done, <code>UpdateRemoteCredential</code> is called, But As I understand(correct me if I'm wrong) in remote login it means <code>RDP</code> but my application is simple, it just listens to some port and gets username and password and then uses <code>Logonuser</code> function.</p>\n\n<p>A program named <code>MxLogon2</code> implements this scheme. A remote server with <code>MxLogon2</code> installed can authenticate a USB key(But I want username/password) connected to the client side in a remote desktop session.</p>\n\n<p>Any suggestion that would direct me to right way would be greatly appriciated.</p>\n\n<p><strong>P.S</strong></p>\n\n<p>I'm using <code>pGina</code> as my credential provider.</p>\n"}, {"tags": ["c++", "linked-list", "abstract-syntax-tree", "downcast"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1562768874, "post_id": 56972768, "comment_id": 100482091, "body": "Have <code>Node</code> specify the interface with <code>virtual  bool(*)(float, float) greaterthan() = 0;</code>. or ex. <code>virtual  bool(*)(float, float) greaterthan() { return nullptr; }</code> or <code>virtual  bool(*)(float, float) greaterthan() { throw Node::exception_greather_then_not_found(); }</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1562769023, "post_id": 56972768, "comment_id": 100482185, "body": "@KamilCuk That&#39;s not extendable though. You have to change the base class for each new operation. And a polymorphic solution that isn&#39;t extendable is immediately suspicious."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562770860, "post_id": 56972768, "comment_id": 100483273, "body": "I wonder if <a href=\"https://en.wikipedia.org/wiki/Curiously_recurring_template_pattern\" rel=\"nofollow noreferrer\">CRTP</a> could help here.  You could have a <code>get</code> function in the base class that is a template and returns the function pointer from the derived type.  This lets you set the relationship at compile time so you don&#39;t have to cast."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1562771263, "post_id": 56972768, "comment_id": 100483492, "body": "AST woes are frequently remedied by the visitor pattern. Have you taken a look at <code>std::variant</code>/<code>std::visit</code> yet?"}, {"owner": {"reputation": 573, "user_id": 6124330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ac61db7b5d278b5e3b121a3e364da5b?s=128&d=identicon&r=PG&f=1", "display_name": "Ivor Denham-Dyson", "link": "https://stackoverflow.com/users/6124330/ivor-denham-dyson"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1562771698, "post_id": 56972768, "comment_id": 100483768, "body": "I have and I&#39;ve also considered the visitor pattern although I&#39;m not actually sure how to implement it here. Some instruction on that would be really helpful. I have also looked at std::variant but I somewhat consider that cheating... maybe I shouldn&#39;t. @MaxLanghof"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562771726, "post_id": 56972768, "comment_id": 100483781, "body": "@JakeDyson Why is it cheating?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1562771756, "post_id": 56972768, "comment_id": 100483796, "body": "I also think you would want to abstract the concrete types and function signatures away here. A <code>BinaryFunction</code> should have an <code>apply</code> operation that takes two <code>TypedValue</code>s and returns a <code>TypedValue</code> (this could be done with <code>std::variant</code> too, but then the set of types in the AST is hardcoded everywhere). The question you should ask yourself is &quot;what should happen when the AST is invalid on the type level (<code>bool</code> passed where <code>float</code> was expected)&quot;. Assuming the AST is built from runtime input, there is no compile-time way to prevent a user from inputting invalid stuff."}, {"owner": {"reputation": 573, "user_id": 6124330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ac61db7b5d278b5e3b121a3e364da5b?s=128&d=identicon&r=PG&f=1", "display_name": "Ivor Denham-Dyson", "link": "https://stackoverflow.com/users/6124330/ivor-denham-dyson"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562772276, "post_id": 56972768, "comment_id": 100484108, "body": "@Fran&#231;oisAndrieux <a href=\"https://en.wikipedia.org/wiki/Type_punning\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Type_punning</a> which may not apply here but it feels like something similiar. How would I go about using std::variant? Even a starting point would be helpful."}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 6124330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ac61db7b5d278b5e3b121a3e364da5b?s=128&d=identicon&r=PG&f=1", "display_name": "Ivor Denham-Dyson", "link": "https://stackoverflow.com/users/6124330/ivor-denham-dyson"}, "edited": false, "score": 0, "creation_date": 1562785186, "post_id": 56974469, "comment_id": 100490273, "body": "Thank you this is absolutely fantastic!"}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 2, "last_activity_date": 1562774065, "creation_date": 1562774065, "answer_id": 56974469, "question_id": 56972768, "link": "https://stackoverflow.com/questions/56972768/how-to-avoid-down-casting-when-return-types-are-not-known-at-compile-time/56974469#56974469", "title": "How to avoid down-casting when return types are not known at compile time?", "body": "<p>My approach would look something like this:</p>\n\n<pre><code>using TypedValue = std::variant&lt;int, float, bool&gt;;\n\nusing BinaryFunc = std::function&lt;TypedValue(TypedValue, TypedValue)&gt;;\n\nstruct Node\n{\npublic:\n    Node() {\n        leftChild = nullptr;\n        rightChild = nullptr;\n    };\n\n    virtual ~Node() = default;\n\n    Node * leftChild, *rightChild;\n\n    void attach(Node * LC, Node * RC) {\n        leftChild = LC;\n        rightChild = RC;\n    };\n\n    virtual TypedValue evaluate() = 0;\n};\n\n\nstruct BinaryFuncNode : public Node\n{\n    BinaryFuncNode(BinaryFunc func) : Node(), binaryFunc(func) {}\n\n    BinaryFunc binaryFunc;\n\n    TypedValue evaluate() override\n    {\n        return binaryFunc(leftChild-&gt;evaluate(), rightChild-&gt;evaluate());\n    }\n};\n\nstruct ConstantNode : public Node\n{\n    ConstantNode(TypedValue val) : Node(), value(val) {}\n\n    TypedValue value;\n\n    TypedValue evaluate() override\n    {\n        return value;\n    }\n};\n</code></pre>\n\n<p>I don't know what exactly you want to do with the function pointers you are currently trying to return, but it's probably got to do with evaluating an expression. That concept can go into the <code>Node</code> interface and can be implemented by each concrete type of node. That requires specifying a return type though, and that's not something known at the <code>Node</code> level. In fact, it's presumably unknown at compile-time in general - invalid user input can obviously not lead to compile-time errors, it will have to lead to run-time errors. <code>std::variant</code> is a good match here (but limits you to a compile-time set of types, which is probably sufficient).</p>\n\n<p>We can then define e.g.</p>\n\n<pre><code>// Function that can only add integers (throws otherwise)\nBinaryFunc addI = [](TypedValue lhs, TypedValue rhs)\n{\n    return std::get&lt;int&gt;(lhs) + std::get&lt;int&gt;(rhs);\n};\n</code></pre>\n\n<p>and use everything together like this:</p>\n\n<pre><code>int main()\n{\n    auto cnode = std::make_unique&lt;ConstantNode&gt;(10);\n    auto bfnode = std::make_unique&lt;BinaryFuncNode&gt;(addI);\n    bfnode-&gt;attach(cnode.get(), cnode.get());\n    return std::get&lt;int&gt;(bfnode-&gt;evaluate());\n}\n</code></pre>\n\n<p>(Note that polymorphy requires pointers or references!)</p>\n\n<p>Play around with it here: <a href=\"https://godbolt.org/z/GNHKCy\" rel=\"nofollow noreferrer\">https://godbolt.org/z/GNHKCy</a></p>\n"}], "owner": {"reputation": 573, "user_id": 6124330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ac61db7b5d278b5e3b121a3e364da5b?s=128&d=identicon&r=PG&f=1", "display_name": "Ivor Denham-Dyson", "link": "https://stackoverflow.com/users/6124330/ivor-denham-dyson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 56974469, "answer_count": 1, "score": 1, "last_activity_date": 1562774065, "creation_date": 1562768394, "question_id": 56972768, "link": "https://stackoverflow.com/questions/56972768/how-to-avoid-down-casting-when-return-types-are-not-known-at-compile-time", "title": "How to avoid down-casting when return types are not known at compile time?", "body": "<p>Suppose I have a abstract base class called <code>Node</code>. </p>\n\n<pre><code>class Node\n{\npublic:\n    Node() {\n        leftChild = NULL;\n        rightChild = NULL;\n    };\n\n    Node * leftChild, *rightChild;\n\n    void attach(Node * LC, Node * RC) {\n        leftChild = LC;\n        rightChild = RC;\n    };\n};\n</code></pre>\n\n<p>I also have multiple functions (of which I'll include two for simplicity but in reality this could be any number). </p>\n\n<pre><code>float add(float a, float b){return a+b;}\nbool gt(float a, float b){return a&gt;b;}\n</code></pre>\n\n<p>For each function there is an associated class. The first is as follows.</p>\n\n<pre><code>class BinaryFunction1 : public Node\n{\npublic:\n    BinaryFunction1() {\n    };\n\n    float(*)(float, float) addition(){\n        return add\n    };\n}\n</code></pre>\n\n<p>The second is below.</p>\n\n<pre><code>class BinaryFunction2 : public Node\n{\npublic:\n    BinaryFunction2() {\n    };\n\n    bool(*)(float, float) greaterthan(){\n        return gt\n    };\n}\n</code></pre>\n\n<p>In main I would like to execute something like the below as a way of creating a linked list in the hopes of building an abstract syntax tree.</p>\n\n<pre><code>BinaryFunction1 testBinaryFunction1();\nBinaryFunction2 testBinaryFunction2();\n\ntestBinaryFunction1.attach(&amp;testBinaryFunction2, &amp;testBinaryFunction2);\n\ndynamic_cast&lt;BinaryFunction2 *&gt;(testBinaryFunction1.leftChild)-&gt;greaterthan()(2.0, 4.0)\n</code></pre>\n\n<p>The <code>dynamic_cast</code> is really ugly and I see it tripping me up further down the road. Is there a way to avoid this and get rid of it entirely.</p>\n\n<p>As far as I can see <code>Node * leftChild, * rightChild</code> is really the problem as I believe this is where the implicit down-casting happens. I am unsure how to declare these pointers if I don't know what their types will be at compile time.</p>\n"}, {"tags": ["c++", "initialization"], "comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1562768471, "post_id": 56972695, "comment_id": 100481850, "body": "Why would you want to have a vector of unique_ptr&#39;s that (if initialised) each reference a single dynamically allocated <code>int</code>???"}, {"owner": {"reputation": 35, "user_id": 11765418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e47716a5dbfb80d55653ea9158af522?s=128&d=identicon&r=PG&f=1", "display_name": "cppnoob", "link": "https://stackoverflow.com/users/11765418/cppnoob"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1562769400, "post_id": 56972695, "comment_id": 100482413, "body": "I substituted my class by int for simplicity."}], "answers": [{"tags": [], "owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "is_accepted": true, "score": 0, "last_activity_date": 1562768429, "creation_date": 1562768429, "answer_id": 56972775, "question_id": 56972695, "link": "https://stackoverflow.com/questions/56972695/initialize-array-of-stdvector-with-sizes/56972775#56972775", "title": "Initialize array of std::vector with sizes", "body": "<p>You can construct temporary objects explicitly, e.g.</p>\n\n<pre><code>std::vector&lt; std::unique_ptr&lt; int &gt; &gt; v[ 2 ]{ std::vector&lt; std::unique_ptr&lt; int &gt; &gt;{ n }, {} };\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11765418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e47716a5dbfb80d55653ea9158af522?s=128&d=identicon&r=PG&f=1", "display_name": "cppnoob", "link": "https://stackoverflow.com/users/11765418/cppnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 56972775, "answer_count": 1, "score": 1, "last_activity_date": 1562768429, "creation_date": 1562768160, "question_id": 56972695, "link": "https://stackoverflow.com/questions/56972695/initialize-array-of-stdvector-with-sizes", "title": "Initialize array of std::vector with sizes", "body": "<p>This won't compile, because the constructor that takes the size (something like <code>vector::vector( size_t )</code>) is <code>explicit</code>:</p>\n\n<pre><code>constexpr auto n = 16;\nstd::vector&lt; std::unique_ptr&lt; int &gt; &gt; v[ 2 ]{ { n }, {} };\n</code></pre>\n\n<p>So how can I initialize <code>v[ 0 ]</code> with <code>n</code> default constructed elements, and leave <code>v[ 1 ]</code> empty?</p>\n"}, {"tags": ["c++", "qt", "variables", "size"], "comments": [{"owner": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "edited": false, "score": 1, "creation_date": 1562768257, "post_id": 56972648, "comment_id": 100481720, "body": "Please show us the exact text that is printed, the question right now is not clear enough."}, {"owner": {"reputation": 109, "user_id": 9806145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Gabriel Silva", "link": "https://stackoverflow.com/users/9806145/gabriel-silva"}, "reply_to_user": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "edited": false, "score": 0, "creation_date": 1562769489, "post_id": 56972648, "comment_id": 100482468, "body": "@SilvanoCerza  I edited the question and put an image of the output of my code, I hope you can better understand my doubt.  thank you"}, {"owner": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "edited": false, "score": 0, "creation_date": 1562770547, "post_id": 56972648, "comment_id": 100483095, "body": "There&#39;s not enough information, the image doesn&#39;t help either. Please provide more code otherwise we can&#39;t help."}, {"owner": {"reputation": 109, "user_id": 9806145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Gabriel Silva", "link": "https://stackoverflow.com/users/9806145/gabriel-silva"}, "reply_to_user": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "edited": false, "score": 0, "creation_date": 1562771208, "post_id": 56972648, "comment_id": 100483465, "body": "@SilvanoCerza sorry for the lack of information I added more information on the question"}, {"owner": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "edited": false, "score": 3, "creation_date": 1562772484, "post_id": 56972648, "comment_id": 100484223, "body": "The code is fine, the current example prints only one time, you&#39;re probably just calling it multiple times somehow."}, {"owner": {"reputation": 408, "user_id": 4780334, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2ci_iFXK5ZI/AAAAAAAAAAI/AAAAAAAAAqQ/VlhLKhc845I/photo.jpg?sz=128", "display_name": "Drl Sherif Omran", "link": "https://stackoverflow.com/users/4780334/drl-sherif-omran"}, "edited": false, "score": 0, "creation_date": 1562810123, "post_id": 56972648, "comment_id": 100497011, "body": "I tested with the following string and i get output of the size is 5. Could you please show the output of qDebug() &lt;&lt; Attribute?       QString string= &quot;[ { aaa } { bbb } ]&quot;;"}], "owner": {"reputation": 109, "user_id": 9806145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Gabriel Silva", "link": "https://stackoverflow.com/users/9806145/gabriel-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1562794305, "creation_date": 1562768043, "last_edit_date": 1562794305, "question_id": 56972648, "link": "https://stackoverflow.com/questions/56972648/qstringlist-size-returning-two-values", "title": "QStringList.size returning two values", "body": "<p>In this section of my code I want to return the size of my QStringList</p>\n\n<pre><code>QStringList Attribute;\nint tableSize = 0;\n\n\n    QString string= reply-&gt;readAll();\n    QRegExp expretion(\"[{}]\");\n\n    Attribute = string.split(expretion);\n    tableSize = Attribute.size();\n    qDebug()&lt;&lt;tableSize;\n</code></pre>\n\n<p><code>qDebug()&lt;&lt;tableSize;</code> This is returning to me two values (1 and 7)</p>\n\n<p>Value of <strong>string</strong></p>\n\n<pre><code>[\n  {\n    \"idInstallation\": 10,\n    \"tstId\": 1,\n    \"knockPerTest\": 10,\n    \"description\": \"aaaaaaaaaaaaaaaaaaaa\",\n    \"state\": \"1\",\n    \"dateCreation\": \"2019-07-09T12:46:00\",\n    \"dateStart\": \"2019-07-09T12:46:00\",\n    \"datePause\": \"2019-07-09T12:46:00\",\n    \"dateStop\": \"2019-07-09T12:46:00\"\n  },\n  {\n    \"idInstallation\": 10,\n    \"tstId\": 2,\n    \"knockPerTest\": 20,\n    \"description\": \"bbbbbbbbbbbbbbbbbbb\",\n    \"state\": \"1\",\n    \"dateCreation\": \"2019-07-09T12:46:00\",\n    \"dateStart\": \"2019-07-09T12:46:00\",\n    \"datePause\": \"2019-07-09T12:46:00\",\n    \"dateStop\": \"2019-07-09T12:46:00\"\n  },\n  {\n    \"idInstallation\": 10,\n    \"tstId\": 3,\n    \"knockPerTest\": 30,\n    \"description\": \"ccccccccccccccccccccc\",\n    \"state\": \"1\",\n    \"dateCreation\": \"2019-07-09T12:46:00\",\n    \"dateStart\": \"2019-07-09T12:46:00\",\n    \"datePause\": \"2019-07-09T12:46:00\",\n    \"dateStop\": \"2019-07-09T12:46:00\"\n  }\n]\n</code></pre>\n\n<p>My goal using <strong>split</strong> is to separate the jason records I'm getting.\nfor example</p>\n\n<pre><code>Attribute = json.split(expretion);\n</code></pre>\n\n<p>I can't find the error</p>\n\n<p>When I print to the console, it returns me the following values:</p>\n\n<p><img src=\"https://i.stack.imgur.com/f4bN5.png\" alt=\"output\"></p>\n"}, {"tags": ["c++", "templates", "c++14"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1562768121, "post_id": 56972604, "comment_id": 100481623, "body": "But why? Your optimizer does this for you."}, {"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1562768224, "post_id": 56972604, "comment_id": 100481698, "body": "Do we have any guarantees?"}, {"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 1, "creation_date": 1562768279, "post_id": 56972604, "comment_id": 100481733, "body": "You might write it like: <code>if constexpr (mode != None)...</code>."}, {"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1562769063, "post_id": 56972604, "comment_id": 100482219, "body": "@vahancho I use C++14. So I can&#39;t use if constexpr"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1562771064, "post_id": 56972604, "comment_id": 100483385, "body": "@embedc: &quot;<i>Do we have any guarantees?</i>&quot; Is this condition being executed in a hot loop somewhere? If not, it&#39;s going to be pretty insignificant."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562771316, "post_id": 56972604, "comment_id": 100483534, "body": "While there is no guarantee, it would be a poor optimizer that would not optimize this.  I&#39;d rather not have a specialization as they are second class &quot;functions&quot;."}, {"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1562771495, "post_id": 56972604, "comment_id": 100483644, "body": "@NicolBolas 1) But is it a good style to combine constexpr expression and a run-time statement (&quot;if&quot;) together?  2) Can&#39;t it lead to a code bloat?"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1562772022, "post_id": 56972604, "comment_id": 100483951, "body": "@embedc: 1) Just look at the complexity that your code would have to have to avoid it. In the second case, to figure out what <code>func</code> does, you have to read <i>two code blocks</i> instead of one. Good style is code that is <i>easier to read</i>. 2) Why does it matter in light of #1? Any &quot;bloat&quot; would be <i>at best</i> trivial, a couple of opcodes. Even if you had 10,000 instantiations of that function (meaning 10,000 enumerators), that&#39;s still maybe 40KB of executable size."}, {"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1562773730, "post_id": 56972604, "comment_id": 100484940, "body": "@NicolBolas That refactoring isn&#39;t ofcourse very important. But 1) If we have only one such function then there&#39;s no significant impact. But what if routinely write the code like that? 2) And what if the function has a lot of if (mode == /*enum value*/) statements?"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1562774868, "post_id": 56972604, "comment_id": 100485550, "body": "@embedc: Both of these are reasons <i>not</i> to split the logic up like that. If you have lots of functions like that, having 2x as many functions makes it that much harder to understand what is going on (and to maintain the code). And if you have a function with several such conditions, that means there&#39;s a decent amount of code <i>not</i> in those conditions, and therefore will have to be <i>repeated</i> across the implementations."}, {"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1562775419, "post_id": 56972604, "comment_id": 100485864, "body": "@NicolBolas I&#39;ve updated the function to make it look more close to the real one. The refactored code looks a little more clear IMHO"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1562775577, "post_id": 56972604, "comment_id": 100485950, "body": "@embedc: If it looks clearer to you, then why are you asking us? You&#39;ve already decided that splitting up code is more clear to you than putting logic in the same place. This is clearly not about &quot;bloat&quot; to you; it&#39;s about personal preference. You seem to be asking us for justifications for what you already prefer."}, {"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1562775738, "post_id": 56972604, "comment_id": 100486037, "body": "@NicolBolas Thank you! I just wanted to hear other opinions"}], "answers": [{"comments": [{"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "edited": false, "score": 0, "creation_date": 1562768986, "post_id": 56972820, "comment_id": 100482162, "body": "Do we have any guarantees? Doesn&#39;t the refactored code looks more clear?"}, {"owner": {"reputation": 4419, "user_id": 2254782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93806dc8873fdb424d2df0f57b54d8e?s=128&d=identicon&r=PG", "display_name": "alexrider", "link": "https://stackoverflow.com/users/2254782/alexrider"}, "reply_to_user": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "edited": false, "score": 0, "creation_date": 1562769060, "post_id": 56972820, "comment_id": 100482216, "body": "No we don&#39;t, strictly speaking we don&#39;t have them in both cases.   As for the clarity it is a matter of taste, I&#39;d say that initial implementation with explicit == is more readable.   But that may depend on the rest of the code base and personal preference."}, {"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "edited": false, "score": 0, "creation_date": 1562769127, "post_id": 56972820, "comment_id": 100482263, "body": "What&#39;s the problem with the second case? How can it be less optimal that the first case?"}, {"owner": {"reputation": 4419, "user_id": 2254782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93806dc8873fdb424d2df0f57b54d8e?s=128&d=identicon&r=PG", "display_name": "alexrider", "link": "https://stackoverflow.com/users/2254782/alexrider"}, "reply_to_user": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "edited": false, "score": 1, "creation_date": 1562769227, "post_id": 56972820, "comment_id": 100482324, "body": "There is no problem, it is ok, but in theory nothing bars compiler from producing code with runtime if. I doubt it may happen in a real life thru.  If we are speaking about now day compilers both versions are going to the same, when it comes to the performance. But if we speak about guarantees there is basically none."}, {"owner": {"reputation": 4419, "user_id": 2254782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93806dc8873fdb424d2df0f57b54d8e?s=128&d=identicon&r=PG", "display_name": "alexrider", "link": "https://stackoverflow.com/users/2254782/alexrider"}, "reply_to_user": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "edited": false, "score": 0, "creation_date": 1562769569, "post_id": 56972820, "comment_id": 100482521, "body": "Practically speaking it all boils down to the style preference, not performance."}], "tags": [], "owner": {"reputation": 4419, "user_id": 2254782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93806dc8873fdb424d2df0f57b54d8e?s=128&d=identicon&r=PG", "display_name": "alexrider", "link": "https://stackoverflow.com/users/2254782/alexrider"}, "is_accepted": false, "score": 1, "last_activity_date": 1562768592, "creation_date": 1562768592, "answer_id": 56972820, "question_id": 56972604, "link": "https://stackoverflow.com/questions/56972604/refactor-constant-expression-if-statement-in-template-function/56972820#56972820", "title": "Refactor constant expression if statement in template function", "body": "<p>There is little sense in refactoring here as it is being optimized anyway.\nFor example following code produces only one call to the funcImpl();</p>\n\n<pre><code>enum Mode { None, Other };\n\nbool funcImpl();\n\ntemplate &lt;Mode mode&gt;\nbool func() {\n    if (mode != None)\n        return funcImpl();\n    return true;\n}\n\nvoid test()\n{\n    volatile auto a = func&lt;None&gt;();\n    a = func&lt;Other&gt;();\n}\n</code></pre>\n\n<p>The result is</p>\n\n<pre><code>test():\n    sub     rsp, 24\n    mov     BYTE PTR [rsp+15], 1\n    call    funcImpl()\n    mov     BYTE PTR [rsp+15], al\n    add     rsp, 24\n    ret\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/V5Uxig\" rel=\"nofollow noreferrer\">https://godbolt.org/z/V5Uxig</a></p>\n"}], "owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1562775351, "creation_date": 1562767927, "last_edit_date": 1562775351, "question_id": 56972604, "link": "https://stackoverflow.com/questions/56972604/refactor-constant-expression-if-statement-in-template-function", "title": "Refactor constant expression if statement in template function", "body": "<p>I'd like to refactor the following code:</p>\n\n<pre><code>enum Mode { None, Value1, Value2 }\ntemplate &lt;Mode mode&gt;\nbool func() {\n    if (mode == None) {\n        helperNone();\n        return funcImplNone();\n    } else if (mode == Value1) {\n        helper1();\n        return funcImplValue1();\n    } else if (mode == Value2) {\n        helper2(); \n        return funcImplValue2();\n    }\n    return true;\n}\n</code></pre>\n\n<p>because the expression </p>\n\n<pre><code>mode == None \n</code></pre>\n\n<p>is computed during a compile time. And also can't thhis code lead to a code bloat (code duplication in an executable file)?</p>\n\n<p>I'm thinking of the following refactoring:</p>\n\n<pre><code>template&lt;Mode&gt;\nbool func() {\n    return true;\n}\n\ntemplate&lt;&gt;\nbool func&lt;None&gt;() {\n    return true;\n}\n\ntemplate&lt;&gt;\nbool func&lt;Value1&gt;() {\n    helper1();\n    return funcImplValue2();\n}\n\ntemplate&lt;&gt;\nbool func&lt;Value2&gt;() {\n    helper2();\n    return funcImplValue2();\n}\n</code></pre>\n\n<p>Is there any other standard way  to refactor that?\nDo we have guarantees that compiler will optimize that code itself?\nDoesn't the refactored code looks more clear?</p>\n"}, {"tags": ["c++", "templates", "enums", "metaprogramming", "typetraits"], "comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1562767316, "post_id": 56972288, "comment_id": 100481110, "body": "Do you care if <code>int_type&lt;std::string&gt;::type</code> exists?"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1562767431, "post_id": 56972288, "comment_id": 100481188, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28674543/enable-if-in-template-parameters-creates-template-redefinition-error\">enable_if in template Parameters Creates Template Redefinition Error</a>"}, {"owner": {"reputation": 1340, "user_id": 3575426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/feCzU.png?s=128&g=1", "display_name": "Youda008", "link": "https://stackoverflow.com/users/3575426/youda008"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1562767673, "post_id": 56972288, "comment_id": 100481338, "body": "@Caleth I would prefer if it didn&#39;t."}, {"owner": {"reputation": 1340, "user_id": 3575426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/feCzU.png?s=128&g=1", "display_name": "Youda008", "link": "https://stackoverflow.com/users/3575426/youda008"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1562769087, "post_id": 56972288, "comment_id": 100482233, "body": "@RaymondChen It&#39;s not duplicate. His problem is slightly simmilar but not the same, and his solution doesn&#39;t solve my problem optimally."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1562770110, "post_id": 56972288, "comment_id": 100482833, "body": "Sorry. Was trying to find a duplicate (because this comes up often) and picked a bad one. If you strip out the bodies, you&#39;ll see that you declared <code>template&lt;typename T&gt; struct int_type;</code> twice. You&#39;ll either need to reduce to one declaration, or make the two declarations different somehow."}], "answers": [{"comments": [{"owner": {"reputation": 1340, "user_id": 3575426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/feCzU.png?s=128&g=1", "display_name": "Youda008", "link": "https://stackoverflow.com/users/3575426/youda008"}, "edited": false, "score": 0, "creation_date": 1562768379, "post_id": 56972387, "comment_id": 100481802, "body": "I accepted the other answer, because it gives invalid type for a type that is neither enum nor integer. But thank&#39;s for showing me std::conditional."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "reply_to_user": {"reputation": 1340, "user_id": 3575426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/feCzU.png?s=128&g=1", "display_name": "Youda008", "link": "https://stackoverflow.com/users/3575426/youda008"}, "edited": false, "score": 0, "creation_date": 1562769041, "post_id": 56972387, "comment_id": 100482200, "body": "I&#39;ve added a version that does that, still using <code>conditional</code>"}, {"owner": {"reputation": 1201, "user_id": 9987834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19953a1c5859e8508fe80339703eba70?s=128&d=identicon&r=PG&f=1", "display_name": "Annyo", "link": "https://stackoverflow.com/users/9987834/annyo"}, "edited": false, "score": 1, "creation_date": 1562769755, "post_id": 56972387, "comment_id": 100482632, "body": "I have 2 suggestions:   first keep <code>int_type</code> as a <code>struct</code> and add something like <code>static_assert(std::is_enum_v&lt;Type&gt; || std::is_integral_v&lt;Type&gt;, &quot;int_type error: Type must be an enum or integral type&quot;);</code> to have a clear message error, you can then define an <code>int_type_t</code> alias if you want to.   Then, replace <code>std::enable_if&lt;std::is_integral&lt;Type&gt;::value, Type&gt;</code> with <code>type_identity&lt;Type&gt;</code>, since you no longer need to check if <code>Type</code> is an integral type (you can find an implementation <a href=\"https://en.cppreference.com/w/cpp/types/type_identity\" rel=\"nofollow noreferrer\">here</a> until C++20 is available)"}, {"owner": {"reputation": 1340, "user_id": 3575426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/feCzU.png?s=128&g=1", "display_name": "Youda008", "link": "https://stackoverflow.com/users/3575426/youda008"}, "edited": false, "score": 0, "creation_date": 1562771011, "post_id": 56972387, "comment_id": 100483352, "body": "I couldn&#39;t make the last version work in VS 2017. Still complains about the last <code>::type</code>."}], "tags": [], "owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "is_accepted": false, "score": 5, "last_activity_date": 1562772330, "last_edit_date": 1562772330, "creation_date": 1562767223, "answer_id": 56972387, "question_id": 56972288, "link": "https://stackoverflow.com/questions/56972288/metaprogramming-construct-that-returns-underlying-type-for-an-enum-and-integer-f/56972387#56972387", "title": "Metaprogramming construct that returns underlying type for an enum and integer for an iteger", "body": "<p>The problem with your attempts is that you're defining the same thing twice, and although <em>part</em> of it uses <code>enable_if</code> that doesn't make the entire enclosing definition disabled when the <code>enable_if</code> isn't true. i.e. you have two definitions of <code>int_type::type</code> even when one (or both) of those definitions is invalid.</p>\n\n<p>What you're looking for is <a href=\"https://en.cppreference.com/w/cpp/types/conditional\" rel=\"nofollow noreferrer\"><code>std::conditional</code></a>:</p>\n\n<pre><code>template&lt; typename Type &gt;\nstruct int_type {\n    using when_enum\n      = std::underlying_type&lt;Type&gt;;\n    using when_integral\n      = std::enable_if&lt;std::is_integral&lt;Type&gt;::value, Type&gt;;\n    using type\n        = typename std::conditional&lt; std::is_enum&lt;Type&gt;::value,\n            when_enum, when_integral\n            &gt;::type::type;\n};\n</code></pre>\n\n<p>Or in C++14 and later:</p>\n\n<pre><code>template&lt; typename Type &gt;\nstruct int_type {\n    using when_enum\n      = std::underlying_type&lt;Type&gt;;\n    using when_integral\n      = std::enable_if&lt;std::is_integral&lt;Type&gt;::value, Type&gt;;\n    using type\n        = typename std::conditional_t&lt; std::is_enum&lt;Type&gt;::value,\n            when_enum, when_integral\n            &gt;::type;\n};\n</code></pre>\n\n<p>But I think I'd probably write it as an alias template:</p>\n\n<pre><code>template&lt; typename Type &gt;\n  using int_type = std::conditional_t&lt;\n    std::is_enum&lt;Type&gt;::value,\n    std::underlying_type&lt;Type&gt;,\n    std::enable_if&lt;std::is_integral&lt;Type&gt;::value, Type&gt;&gt;;\n</code></pre>\n\n<p>And maybe simplify it further and make <code>int_type&lt;T&gt;</code> an alias for the actual type, so you don't need to say <code>typename int_type&lt;T&gt;::type</code>:</p>\n\n<pre><code>template&lt; typename Type &gt;\n  using int_type = typename std::conditional_t&lt;\n    std::is_enum&lt;Type&gt;::value,\n    std::underlying_type&lt;Type&gt;,\n    std::enable_if&lt;std::is_integral&lt;Type&gt;::value, Type&gt;&gt;::type;\n</code></pre>\n\n<p>(N.B. In C++17 you can use <code>std::is_enum_v&lt;Type&gt;</code> and <code>std::is_integral_v</code> instead of saying <code>is_xxx&lt;Type&gt;::value</code>.)</p>\n"}, {"tags": [], "owner": {"reputation": 4419, "user_id": 2254782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93806dc8873fdb424d2df0f57b54d8e?s=128&d=identicon&r=PG", "display_name": "alexrider", "link": "https://stackoverflow.com/users/2254782/alexrider"}, "is_accepted": false, "score": 0, "last_activity_date": 1562767296, "creation_date": 1562767296, "answer_id": 56972414, "question_id": 56972288, "link": "https://stackoverflow.com/questions/56972288/metaprogramming-construct-that-returns-underlying-type-for-an-enum-and-integer-f/56972414#56972414", "title": "Metaprogramming construct that returns underlying type for an enum and integer for an iteger", "body": "<pre><code>template&lt; typename Type &gt;\nstruct int_type {\n    using type = typename std::conditional&lt; std::is_enum&lt;Type&gt;::value, typename std::underlying_type&lt;Type&gt;::type, Type &gt;::type;\n};\n</code></pre>\n\n<p>Will do the trick. It is possible to chain std::conditional to choose different types/generate errors.</p>\n"}, {"comments": [{"owner": {"reputation": 3142, "user_id": 1598163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/131731839e6abf47e73673d7bf7990c6?s=128&d=identicon&r=PG", "display_name": "linuxfever", "link": "https://stackoverflow.com/users/1598163/linuxfever"}, "edited": false, "score": 2, "creation_date": 1562767876, "post_id": 56972504, "comment_id": 100481475, "body": "+1 beat me to it. This is a good answer since it ensures that int_type will not exist for anything other than integral types and enums."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 1, "creation_date": 1562769334, "post_id": 56972504, "comment_id": 100482373, "body": "Nice. It doesn&#39;t make much difference but I&#39;d use inheritance, and combine the primary template and specialization for integral types: <a href=\"https://wandbox.org/permlink/MSwJ9HaCxRumtkgB\" rel=\"nofollow noreferrer\">wandbox.org/permlink/MSwJ9HaCxRumtkgB</a>"}], "tags": [], "owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "is_accepted": true, "score": 3, "last_activity_date": 1562771843, "last_edit_date": 1562771843, "creation_date": 1562767593, "answer_id": 56972504, "question_id": 56972288, "link": "https://stackoverflow.com/questions/56972288/metaprogramming-construct-that-returns-underlying-type-for-an-enum-and-integer-f/56972504#56972504", "title": "Metaprogramming construct that returns underlying type for an enum and integer for an iteger", "body": "<p>You can do it with partial specializations.</p>\n\n<pre><code>// primary template\ntemplate&lt; typename Type, typename = void &gt;\nstruct int_type {\n};\n\n// partial specialization for enum types\ntemplate&lt; typename Type &gt;\nstruct int_type &lt;Type, typename std::enable_if&lt; std::is_enum&lt;Type&gt;::value &gt;::type &gt; {\n    using type = typename std::underlying_type&lt;Type&gt;::type;\n};\n\n// partial specialization for integral types\ntemplate&lt; typename Type&gt;\nstruct int_type &lt;Type, typename std::enable_if&lt; std::is_integral&lt;Type&gt;::value &gt;::type &gt; {\n    using type = Type;\n};\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/0L8GpXlcZiu8Mb9e\" rel=\"nofollow noreferrer\">LIVE</a></p>\n"}], "owner": {"reputation": 1340, "user_id": 3575426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/feCzU.png?s=128&g=1", "display_name": "Youda008", "link": "https://stackoverflow.com/users/3575426/youda008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 56972504, "answer_count": 3, "score": 4, "last_activity_date": 1562772330, "creation_date": 1562766914, "last_edit_date": 1562771495, "question_id": 56972288, "link": "https://stackoverflow.com/questions/56972288/metaprogramming-construct-that-returns-underlying-type-for-an-enum-and-integer-f", "title": "Metaprogramming construct that returns underlying type for an enum and integer for an iteger", "body": "<p>I need to write a metaprogramming construct, that when given an enum type, it returns an underlying type of that enum, but when given an integer, it returns that integer.</p>\n\n<p>For example:</p>\n\n<pre><code>enum Enum : short { VALUE1, VALUE2 };\n\nint_type&lt;long&gt;::type  // -&gt; long\nint_type&lt;Enum&gt;::type  // -&gt; short\n</code></pre>\n\n<p>I attempted this</p>\n\n<pre><code>template&lt; typename Type &gt;\nstruct int_type {\n    using type = typename std::enable_if&lt; std::is_enum&lt;Type&gt;::value, typename std::underlying_type&lt;Type&gt;::type &gt;::type;\n};\ntemplate&lt; typename Type &gt;\nstruct int_type {\n    using type = typename std::enable_if&lt; std::is_integral&lt;Type&gt;::value, Type &gt;::type;\n};\n</code></pre>\n\n<p>but it complains about redefinition of the struct.</p>\n\n<p>I also tried this, but </p>\n\n<pre><code>template&lt; typename Type &gt;\nstruct int_type {\n    using type = typename std::enable_if&lt; std::is_enum&lt;Type&gt;::value, typename std::underlying_type&lt;Type&gt;::type &gt;::type;\n    using type = typename std::enable_if&lt; std::is_integral&lt;Type&gt;::value, Type &gt;::type;\n};\n</code></pre>\n\n<p>but then it complains about redefinition of member <code>type</code>.</p>\n\n<p>This is where my metaprogramming skills end, can anyone help?</p>\n\n<p>EDIT: I should have also mentioned, that our project is limited to C++11.</p>\n"}, {"tags": ["c++", "qt", "opencv", "header"], "comments": [{"owner": {"reputation": 4094, "user_id": 5514765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3c5ed890e173b3b2e45ad71034d88d0?s=128&d=identicon&r=PG&f=1", "display_name": "ParkerHalo", "link": "https://stackoverflow.com/users/5514765/parkerhalo"}, "edited": false, "score": 0, "creation_date": 1562767968, "post_id": 56972258, "comment_id": 100481524, "body": "Does your directory <code>D:\\opencv\\build\\include</code> contain the correct folder and hpp files? (e.g. the folder &quot;opencv2&quot; and in that folder the files &quot;opencv.hpp&quot;...)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11483218"}, "reply_to_user": {"reputation": 4094, "user_id": 5514765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3c5ed890e173b3b2e45ad71034d88d0?s=128&d=identicon&r=PG&f=1", "display_name": "ParkerHalo", "link": "https://stackoverflow.com/users/5514765/parkerhalo"}, "edited": false, "score": 0, "creation_date": 1562778615, "post_id": 56972258, "comment_id": 100487369, "body": "INCLUDEPATH += C:\\opencv\\build\\include the problem was in include part! It was recognised as a command instead of a regular folder name"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11483218"}, "edited": false, "score": 0, "creation_date": 1562778596, "post_id": 56972837, "comment_id": 100487361, "body": "INCLUDEPATH += C:\\opencv\\build\\include the problem was in include part! It was recognised as a command instead of a regular folder name"}], "tags": [], "owner": {"reputation": 2822, "user_id": 11048887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kE8NR.jpg?s=128&g=1", "display_name": "Yunus Temurlenk", "link": "https://stackoverflow.com/users/11048887/yunus-temurlenk"}, "is_accepted": false, "score": 0, "last_activity_date": 1562839507, "last_edit_date": 1562839507, "creation_date": 1562768638, "answer_id": 56972837, "question_id": 56972258, "link": "https://stackoverflow.com/questions/56972258/opencv2-opencv-hpp-opencv2-imgproc-hpp-opencv2-highgui-hpp-no-such-file/56972837#56972837", "title": "&lt;opencv2/opencv.hpp&gt;, &lt;opencv2/imgproc.hpp&gt;, &lt;opencv2/highgui.hpp&gt; no such file or directory", "body": "<p>I m also using Qt and OpenCV together and I added OpenCV libraries on .pro file:</p>\n\n<pre><code>INCLUDEPATH += /usr/local/include/opencv // for path\n\nLIBS += `pkg-config --cflags --libs opencv` // for libraries\n</code></pre>\n\n<p>But before doing that be sure about that you installed opencv correctly. If you are using Ubuntu, run the command on terminal:</p>\n\n<pre><code>pkg-config --modversion opencv\n</code></pre>\n\n<p>This should give an output opencv version(something like 3.4.3, 4.0).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11483218"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1034, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562839507, "creation_date": 1562766841, "last_edit_date": 1562767737, "question_id": 56972258, "link": "https://stackoverflow.com/questions/56972258/opencv2-opencv-hpp-opencv2-imgproc-hpp-opencv2-highgui-hpp-no-such-file", "title": "&lt;opencv2/opencv.hpp&gt;, &lt;opencv2/imgproc.hpp&gt;, &lt;opencv2/highgui.hpp&gt; no such file or directory", "body": "<p>First I installed Cmake and opencv. Then installed OpenCV on QT using mingw32-make etc by adding environmental. I included the libs in .pro file. I have no idea why those includes are not found.</p>\n\n<p>imagetest1.pro file include library parts</p>\n\n<pre><code>INCLUDEPATH += D:\\opencv\\build\\include\n\nLIBS += C:\\opencv-build\\bin\\libopencv_core410.dll\nLIBS += C:\\opencv-build\\bin\\libopencv_highgui410.dll\nLIBS += C:\\opencv-build\\bin\\libopencv_imgcodecs410.dll\nLIBS += C:\\opencv-build\\bin\\libopencv_imgproc410.dll\nLIBS += C:\\opencv-build\\bin\\libopencv_features2d410.dll\nLIBS += C:\\opencv-build\\bin\\libopencv_calib3d410.dll\n\n</code></pre>\n\n<p>main.cpp file</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n#include &lt;opencv2/opencv.hpp&gt;\n#include &lt;opencv2/imgproc.hpp&gt;\n#include &lt;opencv2/highgui.hpp&gt;\n\nusing namespace std;\nusing namespace  cv;\nint main()\n{\n//Some code\n}\n\n\n</code></pre>\n\n<p>changing to opencv4/opencv.hpp etc and the others gave the same error.</p>\n"}, {"tags": ["c++", "language-lawyer"], "answers": [{"comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1562766603, "post_id": 56972169, "comment_id": 100480681, "body": "Oh, well. Your hash table is more efficient than mine :)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1562766635, "post_id": 56972169, "comment_id": 100480699, "body": "@StoryTeller I use quadratic probing instead of a linked list ;)"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562766778, "post_id": 56972169, "comment_id": 100480780, "body": "@NathanOliver I suggest extending the quote to 2.2: If a program contains a violation of any diagnosable rule or an occurrence of a construct described in this document as \u201cconditionally-supported\u201d when the implementation does not support that construct, a conforming implementation shall issue at least one diagnostic message."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1562766811, "post_id": 56972169, "comment_id": 100480804, "body": "@SergeyA Just did while you were commenting."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 8, "last_activity_date": 1562766797, "last_edit_date": 1562766797, "creation_date": 1562766555, "answer_id": 56972169, "question_id": 56972120, "link": "https://stackoverflow.com/questions/56972120/which-guarantees-does-the-c-standard-have-when-it-comes-to-issuing-diagnostic/56972169#56972169", "title": "Which guarantees does the C++ standard have when it comes to issuing diagnostic messages?", "body": "<p>What you are looking for is  <a href=\"https://timsong-cpp.github.io/cppwp/intro.compliance#1\" rel=\"nofollow noreferrer\">[intro.compliance]/1</a></p>\n\n<blockquote>\n  <p>The set of diagnosable rules consists of all syntactic and semantic rules in this document except for those rules containing an explicit notation that \u201cno diagnostic is required\u201d or which are described as resulting in \u201cundefined behavior\u201d.</p>\n</blockquote>\n\n<p>It is then followed up with <a href=\"https://timsong-cpp.github.io/cppwp/intro.compliance#2.2\" rel=\"nofollow noreferrer\">[intro.compliance]/2</a></p>\n\n<blockquote>\n  <p>If a program contains a violation of any diagnosable rule or an occurrence of a construct described in this document as \u201cconditionally-supported\u201d when the implementation does not support that construct, a conforming implementation shall issue at least one diagnostic message.</p>\n</blockquote>\n\n<p>which guarantees that if you break one of the diagnosable rules you'll get a diagnostic message.</p>\n"}], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 56972169, "answer_count": 1, "score": 7, "last_activity_date": 1562766797, "creation_date": 1562766389, "last_edit_date": 1562766645, "question_id": 56972120, "link": "https://stackoverflow.com/questions/56972120/which-guarantees-does-the-c-standard-have-when-it-comes-to-issuing-diagnostic", "title": "Which guarantees does the C++ standard have when it comes to issuing diagnostic messages?", "body": "<p>While reading the C++ standard, one often sees designations like \"... ill-formed, no diagnostic required\". A (random) example can be found in 13.8.1/17:</p>\n\n<blockquote>\n  <p>The class S1::Inner1 is ill-formed, no diagnostic required, because\n  it has no valid specializations.</p>\n</blockquote>\n\n<p>Where can one find an opposite normative language in the standard, which would prescribe a diagnostic for an ill-formed program?</p>\n"}, {"tags": ["c++", "compiler-errors", "glfw"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1562766541, "post_id": 56972089, "comment_id": 100480646, "body": "<i>&quot;conversion from the window_callback type to the appropriate function pointer types&quot;</i> - You cannot convert a class instance (or a class method) to a function pointer. You need a static method or free function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11313931"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1562766650, "post_id": 56972089, "comment_id": 100480711, "body": "@MaxLanghof What do you mean by &quot;I can&#39;t&quot;? If I define a conversion operator I can convert to any type I want. Or no...?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1562766711, "post_id": 56972089, "comment_id": 100480747, "body": "Your <code>operator decltype(whatever)()</code> still returns a <code>decltype(whatever)</code>, which will be a member function pointer (which <code>glfw</code> won&#39;t accept)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11313931"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1562766798, "post_id": 56972089, "comment_id": 100480801, "body": "@MaxLanghof How does <code>std::less</code> (and similar) work, than?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1562766937, "post_id": 56972089, "comment_id": 100480870, "body": "<code>std::less</code> won&#39;t work with something that expects a function pointer. <code>std::less</code> is a struct with <code>operator()</code> (the call operator) overloaded, which works just fine with all the <i>templated</i> standard library functions (which don&#39;t care if you pass a function pointer or a functor struct). Unless I am mistaken, <code>glfw</code> is not templated and only accepts function pointers as callbacks. Capture-less lambdas can be converted to function pointers, but your own functor structs cannot."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1562766960, "post_id": 56972089, "comment_id": 100480883, "body": "<code>std::less</code> has no state. You can simply default construct one and call the operator of that."}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1562768146, "post_id": 56972089, "comment_id": 100481644, "body": "Is using <code>glfwSetWindowUserPointer</code>/<code>glfwGetWindowUserPointer</code> an option?"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 1, "last_activity_date": 1562770057, "last_edit_date": 1562770057, "creation_date": 1562769033, "answer_id": 56972961, "question_id": 56972089, "link": "https://stackoverflow.com/questions/56972089/how-to-use-function-object-as-callback-to-invoke-member-functions-handlers-in/56972961#56972961", "title": "How to use function object as callback to invoke member functions (handlers) in an object?", "body": "<blockquote>\n  <p>How to use function object as callback to invoke member functions (handlers) in an object?</p>\n  \n  <p>that I could use in glfwSet[...]Callback() functions.</p>\n</blockquote>\n\n<p>Glfw does not accept member function pointers as callback functions, nor does it accept function objects.</p>\n\n<p>You can only register function pointers. Function pointers cannot point to non-static member functions. The function call operator overload of a function object is also a member function.</p>\n\n<p>You need to write a non-member function (or you can use a static member function if you prefer) that wraps the call to the member function (or a function object if you prefer).</p>\n\n<p>Example:</p>\n\n<pre><code>struct C {\n    void window_size(GLFWwindow*, int, int);\n};\n\nauto window_size_callback = [](GLFWwindow* window, int w, int h) {\n    C c;\n    c.window_size(window, w, h);\n}; // a non-capturing lambda can be converted to a function pointer\n   // you can use a named function if you prefer\n\nglfwSetWindowSizeCallback(window, window_size_callback);\n</code></pre>\n\n<p>But, presumably you need access to some particular instance of the class (or function object), rather than a default constructed one. After all, why use a non-static member function if that wasn't the case. To achieve that, you need some way of passing a reference to that object into the callback.</p>\n\n<p>The way documented by GLFW is:</p>\n\n<blockquote>\n  <p>Each window has a user pointer that can be set with <code>glfwSetWindowUserPointer</code> and queried with <code>glfwGetWindowUserPointer</code>. This can be used for any purpose you need and will not be modified by GLFW throughout the life-time of the window.</p>\n</blockquote>\n\n<p>If all of your callbacks are to be called on a single object, using this is simple:</p>\n\n<pre><code>C c;\nglfwSetWindowUserPointer(window, &amp;c);\n\nauto window_size_callback = [](GLFWwindow* window, int w, int h) {\n    C* cptr = static_cast&lt;C*&gt;(glfwSetWindowUserPointer(window));\n    assert(c);\n    cptr-&gt;window_size(window, w, h);\n};\n</code></pre>\n\n<p>Unfortunately, GLFW API doesn't appear to support callback specific user data. If you need different objects for different callbacks, you could possibly use your own map from callback to object, but that's not quite as simple as the example above.</p>\n\n<p>Furthermore, be very careful to keep the object alive at least as long as the window is alive so that callbacks don't get called on a dangling pointer.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11313931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 56972961, "answer_count": 1, "score": 0, "last_activity_date": 1562770057, "creation_date": 1562766254, "question_id": 56972089, "link": "https://stackoverflow.com/questions/56972089/how-to-use-function-object-as-callback-to-invoke-member-functions-handlers-in", "title": "How to use function object as callback to invoke member functions (handlers) in an object?", "body": "<p>I wanted to create a <code>window_callback</code> function object that I could use in <code>glfwSet[...]Callback()</code> functions. It is supposed to find a <code>window</code> in the <code>inline static std::unordered_map&lt;GLFWwindow*, window&amp;&gt; windows_by_handles</code> by its <code>GLFWwindow* handle</code> and than call its appropriate handler. This is my current code:</p>\n\n<pre><code>template &lt;typename... Args&gt;\nclass window_callback\n{\n    typedef void(window::*member_func_t)(Args...);\n    member_func_t func;\npublic:\n    window_callback(member_func_t func_) :\n        func(func_)\n    {\n    }\n\n    void operator() (GLFWwindow* HWND, Args... args)\n    {\n        try\n        {\n            window&amp; wnd = windows_by_handles.at(HWND);\n            (wnd.*func)(args...); //error E0165\n        }\n        catch (const std::out_of_range&amp;)\n        {\n            std::cerr &lt;&lt; \"Detected callback for unknown window\\n\";\n        }\n    }\n\n    operator decltype(&amp;(operator()))() { return &amp;operator(); }\n};\n</code></pre>\n\n<p>The <code>window_callback</code> objects are created in the following manner (inside the <code>window</code> class):</p>\n\n<pre><code>inline static window_callback&lt;int, int&gt; resize_callback{ &amp;on_resize };\ninline static window_callback&lt;double, double&gt; mouse_movement_callback{ &amp;on_mouse_moved };\ninline static window_callback&lt;double, double&gt; scroll_callback{ &amp;on_scrolled };\n</code></pre>\n\n<p>Then, they are bound with <code>glfwSet[...]Callback()</code> functions like this (inside the <code>window</code> class constructor):</p>\n\n<pre><code>glfwSetFramebufferSizeCallback(handle, resize_callback);\nglfwSetCursorPosCallback(handle, mouse_movement_callback);\nglfwSetScrollCallback(handle, scroll_callback);\n</code></pre>\n\n<p>The given code doesn't compile. It gives the following errors when compiling in Visual Studio 2019 (using C++17). The first 2 errors happen on the user-defined conversion operator declaration:</p>\n\n<ul>\n<li>C2833 'operator type' is not a recognized operator or type</li>\n<li><p>C2059 syntax error: 'newline'</p></li>\n<li><p>C2664 <code>GLFWframebuffersizefun glfwSetFramebufferSizeCallback(GLFWwindow *,GLFWframebuffersizefun)</code>: cannot convert argument 2 from <code>window::window_callback&lt;int,int&gt;</code> to <code>GLFWframebuffersizefun</code></p></li>\n<li>C2664 <code>GLFWcursorposfun glfwSetCursorPosCallback(GLFWwindow *,GLFWcursorposfun)</code>: cannot convert argument 2 from <code>window::window_callback&lt;double,double&gt;</code> to <code>GLFWcursorposfun</code></li>\n<li>C2664 <code>GLFWscrollfun glfwSetScrollCallback(GLFWwindow *,GLFWscrollfun)</code>: cannot convert argument 2 from <code>window::window_callback&lt;double,double&gt;</code> to <code>GLFWscrollfun</code></li>\n</ul>\n\n<p>The problematic part is the conversion from the <code>window_callback</code> type to the appropriate function pointer types. What should be changed to make this code work or what is an alternate solution that will work in the same manner?</p>\n"}, {"tags": ["c++", "pointers", "smart-pointers"], "comments": [{"owner": {"reputation": 311, "user_id": 11630848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38aff2511098597fa8ce472473a042b2?s=128&d=identicon&r=PG&f=1", "display_name": "amlucas", "link": "https://stackoverflow.com/users/11630848/amlucas"}, "edited": false, "score": 0, "creation_date": 1562766363, "post_id": 56972060, "comment_id": 100480530, "body": "what about using a <code>shared_ptr</code>?"}, {"owner": {"reputation": 13, "user_id": 11765197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a179cc46fac4876c5302260a6753d66?s=128&d=identicon&r=PG&f=1", "display_name": "mathse", "link": "https://stackoverflow.com/users/11765197/mathse"}, "reply_to_user": {"reputation": 311, "user_id": 11630848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38aff2511098597fa8ce472473a042b2?s=128&d=identicon&r=PG&f=1", "display_name": "amlucas", "link": "https://stackoverflow.com/users/11630848/amlucas"}, "edited": false, "score": 0, "creation_date": 1562766539, "post_id": 56972060, "comment_id": 100480645, "body": "Wouldn&#39;t the shared pointer, If I assign &quot;&amp;structA.data&quot; in the else to it try to destroy the structA.data when it goes out of scope (so after the function comes to the end)?"}], "answers": [{"tags": [], "owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "is_accepted": true, "score": 2, "last_activity_date": 1562766471, "creation_date": 1562766471, "answer_id": 56972146, "question_id": 56972060, "link": "https://stackoverflow.com/questions/56972060/dynamically-point-to-existing-or-create-new-object/56972146#56972146", "title": "Dynamically point to existing or create new object", "body": "<p>You can create a smart pointer to own the new object and free it at the end of the function, but make it empty unless you need to create the new object. When you do create it, just make <code>current_data</code> refer to the object managed by the smart pointer:</p>\n\n<pre><code>void often_called_function(int i, A &amp;structA)\n{\n\n  // Pointer which shall dynamically point to existing or newly created object\n  myData *current_data;\n  // smart pointer that will own the dynamically-created object, if needed:\n  std::unique_ptr&lt;myData&gt; owner;\n\n  // we rarely land here, data can't be used\n  if (i == 10){\n    owner = std::make_unique&lt;myData&gt;(special_arguments);\n    current_data = owner.get();\n    current_data-&gt;reinit(i);\n  }\n  // most of the time we land here, no need to re-create data, just reinit existing data from struct A\n  else{\n    structA.data.reinit(i);\n    current_data = &amp;structA.data;\n  }\n\n  // do more stuff with current_data\n  current_data-&gt;do_something();\n}\n</code></pre>\n\n<p>N.B. it looks like you could simplify the function a bit by moving the <code>reinit(i)</code> call out of the conditional branches:</p>\n\n<pre><code>  // we rarely land here, data can't be used\n  if (i == 10){\n    owner = std::make_unique&lt;myData&gt;(special_arguments);\n    current_data = owner.get();\n  }\n  // most of the time we land here, no need to re-create data, just reinit existing data from struct A\n  else{\n    current_data = &amp;structA.data;\n  }\n  current_data-&gt;reinit(i);\n\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11765197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a179cc46fac4876c5302260a6753d66?s=128&d=identicon&r=PG&f=1", "display_name": "mathse", "link": "https://stackoverflow.com/users/11765197/mathse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56972146, "answer_count": 1, "score": 1, "last_activity_date": 1562766529, "creation_date": 1562766147, "last_edit_date": 1562766529, "question_id": 56972060, "link": "https://stackoverflow.com/questions/56972060/dynamically-point-to-existing-or-create-new-object", "title": "Dynamically point to existing or create new object", "body": "<p>I have a function, that uses information stored in a struct A. This function is called very often and most of the time it can just rely on the information stored in A.\nUnder some (rare) conditions, one of the objects of A cannot be used. A new object has to be created and it should not live longer than the function (since it can just be used one time and uses lots of storage).\nI have a little bit of pseudo code that demonstrates my problem. At the moment I really don't like it, because of the call to \"new\" but I can't think of another way to accomplish this with smart pointers.</p>\n\n<p>As I read in every book that you should not use pointers directly nowadays and rely on smart pointers, I'm not sure, hot to implement what I want correctly.</p>\n\n<pre><code>struct A{\n  myData data;\n}\n\nvoid often_called_function(int i, A &amp;structA)\n{\n\n  // Pointer which shall dynamically point to existing or newly created object\n  myData *current_data;\n\n  // we rarely land here, data can't be used\n  if (i == 10) {\n    current_data = new myData(special arguments);\n    current_data-&gt;reinit(i);\n  }\n  // most of the time we land here, no need to re-create data, just reinit existing data from struct A\n  else {\n    structA.data.reinit(i);\n    current_data = &amp;structA.data;\n  }\n\n  // do more stuff with current_data\n  current_data-&gt;do_something(); \n}\n</code></pre>\n\n<p>So basically I'm looking for a \"nicer\" and safe way to accomplish this, can anybody help me?\nThanks in advance</p>\n"}, {"tags": ["c++", "switch-statement"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1562766371, "post_id": 56971928, "comment_id": 100480540, "body": "Reduce the number of <code>case</code>s by 50% by using <code>std::toupper</code> or <code>std::tolower</code> before the <code>switch</code> statement."}, {"owner": {"reputation": 33, "user_id": 11689948, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VcwGDsQ41e8/AAAAAAAAAAI/AAAAAAAAKJg/Z7EpLh_OYLs/photo.jpg?sz=128", "display_name": "ThePete", "link": "https://stackoverflow.com/users/11689948/thepete"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1562767055, "post_id": 56971928, "comment_id": 100480952, "body": "You&#39;re a godsent. Just tidied up my program with these. Thank you very much. @ThomasMatthews"}], "answers": [{"comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1562765956, "post_id": 56971984, "comment_id": 100480323, "body": "Since this is in main, one can also <code>return EXIT_FAILURE</code> as an alternative to calling <code>exit</code>."}, {"owner": {"reputation": 33, "user_id": 11689948, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VcwGDsQ41e8/AAAAAAAAAAI/AAAAAAAAKJg/Z7EpLh_OYLs/photo.jpg?sz=128", "display_name": "ThePete", "link": "https://stackoverflow.com/users/11689948/thepete"}, "edited": false, "score": 0, "creation_date": 1562767006, "post_id": 56971984, "comment_id": 100480921, "body": "Thank you very much. I added &lt;stdlib.h&gt; and used exit(0) and it&#39;s working as intended now. Cheers."}, {"owner": {"reputation": 1291, "user_id": 267261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bdad6e8dba0cd418b763ab0ce1084375?s=128&d=identicon&r=PG", "display_name": "Matt G", "link": "https://stackoverflow.com/users/267261/matt-g"}, "edited": false, "score": 0, "creation_date": 1562771311, "post_id": 56971984, "comment_id": 100483530, "body": "Additionally the break statement in your default case is redundant."}], "tags": [], "owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "is_accepted": true, "score": 6, "last_activity_date": 1562765887, "creation_date": 1562765887, "answer_id": 56971984, "question_id": 56971928, "link": "https://stackoverflow.com/questions/56971928/c-default-not-working-in-switch-statement/56971984#56971984", "title": "c++ default not working in switch statement", "body": "<p>If you want to end the program in your <code>default</code> case, you need to call <code>exit(some_status)</code>before the <code>break</code>.  Otherwise, <code>break</code> just causes the <code>switch</code> statement to end and you continue right after the <code>switch</code> block.</p>\n"}, {"tags": [], "owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "is_accepted": false, "score": 2, "last_activity_date": 1562765950, "creation_date": 1562765950, "answer_id": 56972007, "question_id": 56971928, "link": "https://stackoverflow.com/questions/56971928/c-default-not-working-in-switch-statement/56972007#56972007", "title": "c++ default not working in switch statement", "body": "<p>You need to end your program after the error message. You can use either a call to exit() or a return statement.</p>\n"}], "owner": {"reputation": 33, "user_id": 11689948, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VcwGDsQ41e8/AAAAAAAAAAI/AAAAAAAAKJg/Z7EpLh_OYLs/photo.jpg?sz=128", "display_name": "ThePete", "link": "https://stackoverflow.com/users/11689948/thepete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "accepted_answer_id": 56971984, "answer_count": 2, "score": 3, "last_activity_date": 1562766525, "creation_date": 1562765749, "last_edit_date": 1562766525, "question_id": 56971928, "link": "https://stackoverflow.com/questions/56971928/c-default-not-working-in-switch-statement", "title": "c++ default not working in switch statement", "body": "<p>Fairly new to programming here. I can't get my default code in the switch statement to work. I want it to display an error and exit as soon as any data input that's not in the range is entered. For some reason, it goes to the next <code>cout</code> line after the <code>switch</code> statement. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;math.h&gt;\n#include &lt;iomanip&gt;\nusing namespace std;\n\nint main()\n{\nchar choice;\nconst double P=8.00, A=10.50, B=12.50;\ndouble t,w,price;\n\ncout&lt;&lt;\"\\nPlease enter the state code: \";\ncin&gt;&gt;choice;\n\ncout&lt;&lt;\"\\nPlease enter the Parcel's weight in KG: \";\ncin&gt;&gt;w;\n\nswitch (choice)\n    {\n    case 'P':\n    case 'p':\n        t=w*P;\n        price=P;\n\n    break;\n\n    case 'A':\n    case 'a':\n        t=w*A;\n        price=A;\n\n    break;\n\n    case 'B':\n    case 'b':\n        t=w*B;\n        price=B;\n\n    break;\n\n    default:\n        cout&lt;&lt;\"Error. Please Re-enter. Exiting\";\n\n    break;\n\n    }\n\ncout&lt;&lt;setw(80)&lt;&lt;setfill('*')&lt;&lt;\"*\"&lt;&lt;endl;\ncout&lt;&lt;\"\\nState code: \"&lt;&lt;choice&lt;&lt;endl;\ncout&lt;&lt;\"Weight &lt;KG&gt;: \"&lt;&lt;w&lt;&lt;endl;\ncout&lt;&lt;\"Price &lt;RM&gt;: \"&lt;&lt;price&lt;&lt;endl;\nstd::cout&lt;&lt;std::fixed;\nstd::cout&lt;&lt;std::setprecision(2);\ncout&lt;&lt;\"Total Price &lt;RM&gt;: \"&lt;&lt;t&lt;&lt;endl;\ncout&lt;&lt;\"\\nThank you and Please Come Again\"&lt;&lt;endl;\ncout&lt;&lt;setw(80)&lt;&lt;setfill('*')&lt;&lt;\"*\"&lt;&lt;endl;\n\nreturn 0;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "language-lawyer"], "comments": [{"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 2, "creation_date": 1562766975, "post_id": 56971781, "comment_id": 100480897, "body": "Honestly not sure why this question is getting so many upvotes.. <code>Clang</code> has it as: <code>int compare(const value_type* __s) const _NOEXCEPT;</code> So does GCC: <code>int       compare(const _CharT* __s) const _GLIBCXX_NOEXCEPT;</code> <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/basic_string.h#L2988\" rel=\"nofollow noreferrer\">github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/inclu&zwnj;&#8203;de/&hellip;</a>"}, {"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "edited": false, "score": 0, "creation_date": 1562767117, "post_id": 56971781, "comment_id": 100480991, "body": "Looks like it&#39;s up to implementation, but logically it seems like it should be <code>noexcept</code>."}, {"owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 1, "creation_date": 1562768480, "post_id": 56971781, "comment_id": 100481860, "body": "I guess we need a language lawyer to get the real answer...but I would assume, that the standard does not require <code>std::string</code> to store the string as a <code>CharT *</code>, in order to allow small string optimization. However, this also means that we might have to do some conversion for the actual <code>compare</code> to happen. This conversion might have to allocate memory, which could be exhausted and therefore possibly throw. Thus, the standard cannot enforce a <code>noexcept</code> from implementations, although they still might be <code>noexcept</code> in practice."}], "answers": [{"tags": [], "owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "is_accepted": true, "score": 2, "last_activity_date": 1562773506, "creation_date": 1562773506, "answer_id": 56974315, "question_id": 56971781, "link": "https://stackoverflow.com/questions/56971781/can-stdstringcompareconst-char-throw-an-exception/56974315#56974315", "title": "Can std::string::compare(const char*) throw an exception?", "body": "<p>Except for destructors, swap functions, move constructors and move assignment operators, the standard marks a function <code>noexcept</code> only if it has a <a href=\"https://stackoverflow.com/questions/51292673/what-is-in-simple-understanding-narrow-contract-and-wide-contract-in-terms-of\"><em>wide contract</em></a>, i.e., it has no preconditions. This overload requires the argument to be a null-terminated string, so the standard does not mark it as <code>noexcept</code>.</p>\n\n<p>The rational is specified in <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3248.pdf\" rel=\"nofollow noreferrer\">N3248</a>:</p>\n\n<blockquote>\n  <h1>Functions marked <code>noexcept</code> are difficult to test</h1>\n  \n  <p>When a function is marked with <code>noexcept</code> it becomes impossible to flag test failures,\n  notably in test drivers, by throwing an exception. A common example would be code\n  that validates preconditions on entry to a function:</p>\n\n<pre><code>T&amp; std::vector&lt;T&gt;::front() noexcept {\n assert(!this-&gt;empty());\n return *this-&gt;data();\n}\n</code></pre>\n  \n  <p>When validating such defensive checks from a test driver, a reasonable approach is to\n  register an assert-handler that throws a well-defined precondition-violated exception,\n  which the test driver catches to ensure that the appropriate <code>assert</code>s are indeed in\n  place.</p>\n  \n  <p>...</p>\n  \n  <p>Now we might argue that calling the function out-of-contract, when the <code>vector</code> is\n  empty, is undefined behavior so we should not expect any guarantees. The problem is that undefined behavior is being specified by the library; to the compiler, this code is\n  perfectly well defined and, if <code>assert</code> throws an exception, the program must terminate\n  in a well-specified manner, thwarting the test driver.</p>\n  \n  <p>Note that the issue here is not that we are using assertions to find bugs in our own\n  library implementations, but rather in user code that incorrectly calls into our library.\n  If we remove the ability to test these defensive assertions, we may get them wrong,\n  and thus put our users at risk for committing far more serious errors than propagating\n  an unexpected exception.</p>\n</blockquote>\n\n<hr>\n\n<p>By the way, due to <a href=\"https://timsong-cpp.github.io/cppwp/res.on.exception.handling#5\" rel=\"nofollow noreferrer\">[res.on.exception.handling]/5</a>:</p>\n\n<blockquote>\n  <p>An implementation may strengthen the exception specification for a non-virtual function by adding a non-throwing exception specification.</p>\n</blockquote>\n\n<p>... <code>libstdc++</code> and <code>libc++</code> are free to mark this overload <code>noexcept</code>.</p>\n"}], "owner": {"reputation": 4396, "user_id": 2064196, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YOB5j.jpg?s=128&g=1", "display_name": "Bulletmagnet", "link": "https://stackoverflow.com/users/2064196/bulletmagnet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 56974315, "answer_count": 1, "score": 13, "last_activity_date": 1562773506, "creation_date": 1562765224, "last_edit_date": 1562768661, "question_id": 56971781, "link": "https://stackoverflow.com/questions/56971781/can-stdstringcompareconst-char-throw-an-exception", "title": "Can std::string::compare(const char*) throw an exception?", "body": "<p>This is overload (4) <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/compare\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>In the \"Exceptions\" section, overloads 2,3,5,6 (which have pos1 and/or pos2 parameters) are named as throwing <code>std::out_of_range</code>.</p>\n\n<p>Overload (4) does not have \"pos\" parameters, but it's not marked <code>noexcept</code>. </p>\n\n<p>Is it up to the implementation whether it throws or not?</p>\n\n<p>In GCC 7's libstdc++, it calls <code>char_traits&lt;char&gt;::length</code> and <code>char_traits&lt;char&gt;::compare</code>. These don't seem to be able to throw, but aren't marked <code>noexcept</code>.</p>\n"}, {"tags": ["c++", "c", "linux", "bash", "shell"], "comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1562764811, "post_id": 56971631, "comment_id": 100479746, "body": "When you invoke the shell script child process, set up the environment variables to be used by the child process."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1562764848, "post_id": 56971631, "comment_id": 100479761, "body": "Environment variables are inherited by child processes created by <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow noreferrer\"><code>fork</code></a>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1562765864, "post_id": 56971631, "comment_id": 100480288, "body": "... which includes those launched by a shell."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1562769924, "post_id": 56971631, "comment_id": 100482728, "body": "Why do you execute a script (shell script) that executes an executable? Why don&#39;t you call directly the executable? How does the executable called by the script receive the values!?"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1562770073, "post_id": 56971631, "comment_id": 100482811, "body": "A way to pass values to the shell script might be to call it passing all values on the shell command line something such: system(&quot;script.sh a b c d e f&quot;) ... but maybe is to broad."}, {"owner": {"reputation": 7, "user_id": 6330494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dde6466a464867a479bbb4ae825b6e0?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip ", "link": "https://stackoverflow.com/users/6330494/dilip"}, "edited": false, "score": 0, "creation_date": 1562839700, "post_id": 56971631, "comment_id": 100508018, "body": "My requirement is such that the script has to invoke the executable."}], "answers": [{"tags": [], "owner": {"reputation": 4854, "user_id": 11714114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qKzVA.jpg?s=128&g=1", "display_name": "mario", "link": "https://stackoverflow.com/users/11714114/mario"}, "is_accepted": false, "score": 1, "last_activity_date": 1562771174, "creation_date": 1562771174, "answer_id": 56973654, "question_id": 56971631, "link": "https://stackoverflow.com/questions/56971631/how-to-share-my-cli-information-variable-etc-to-child-process-which-is-a-bash/56973654#56973654", "title": "How to share my cli information (variable, etc) to child process which is a bash shell script", "body": "<p>Simple <code>export</code> of your variables should do the job e.g.:</p>\n\n<p><code>export MY_VAR=my_value</code></p>\n\n<p>Exported variables are available for all subshells i.e. subshell spawned by your current shell, the subsequent shell spawned but the subshell and so on.</p>\n\n<p>Everything that is available in your current environment as <code>environment variable</code> ( which you can display it using <code>env</code> command ) is already exported and available for all subshells. Notice that any variable you have defined and exported is also on the list.</p>\n"}], "owner": {"reputation": 7, "user_id": 6330494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dde6466a464867a479bbb4ae825b6e0?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip ", "link": "https://stackoverflow.com/users/6330494/dilip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562771174, "creation_date": 1562764730, "question_id": 56971631, "link": "https://stackoverflow.com/questions/56971631/how-to-share-my-cli-information-variable-etc-to-child-process-which-is-a-bash", "title": "How to share my cli information (variable, etc) to child process which is a bash shell script", "body": "<p>I have a command-line interface (let's say mycli) which has its own properties (env variable, etc). mycli have a command which invokes a shell script (child process) which in turn invokes a c/cpp executable which wants to use variables/properties from mycli.</p>\n\n<p>Is there any way to pass such information in shell scripts which could be used by the invoked executable?</p>\n\n<p>Already browsed a lot but no luck.</p>\n"}, {"tags": ["python", "c++", "image-processing", "3d", "point-cloud-library"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1562766402, "post_id": 56971518, "comment_id": 100480560, "body": "If you can reconstruct a concave hull from the point cloud, you can shoot a ray from your test point to a random position and count the number of triangle intersections. If it is odd you are inside the hull."}, {"owner": {"reputation": 1229, "user_id": 9226753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28247b27eef49240c767833514e2ab50?s=128&d=identicon&r=PG&f=1", "display_name": "kanstar", "link": "https://stackoverflow.com/users/9226753/kanstar"}, "edited": false, "score": 0, "creation_date": 1562804926, "post_id": 56971518, "comment_id": 100496141, "body": "You can use <a href=\"http://docs.pointclouds.org/trunk/classpcl_1_1octree_1_1_octree_point_cloud_search.html\" rel=\"nofollow noreferrer\">pcl::octree::OctreePointCloudSearch</a> class and use <code>voxelSearch</code> function.  If the given point is inside the voxel, the function will return <code>true</code>, <code>false</code> otherwise."}, {"owner": {"reputation": 301, "user_id": 11597414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219559370843238/picture?type=large", "display_name": "Tuna Y&#252;ce", "link": "https://stackoverflow.com/users/11597414/tuna-y%c3%bcce"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1562828105, "post_id": 56971518, "comment_id": 100501799, "body": "@Botje i will try thank you"}, {"owner": {"reputation": 301, "user_id": 11597414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219559370843238/picture?type=large", "display_name": "Tuna Y&#252;ce", "link": "https://stackoverflow.com/users/11597414/tuna-y%c3%bcce"}, "reply_to_user": {"reputation": 1229, "user_id": 9226753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28247b27eef49240c767833514e2ab50?s=128&d=identicon&r=PG&f=1", "display_name": "kanstar", "link": "https://stackoverflow.com/users/9226753/kanstar"}, "edited": false, "score": 0, "creation_date": 1562828149, "post_id": 56971518, "comment_id": 100501818, "body": "@kanstar okey i will try it. also i couldn&#39;t figure out how to use pcl with python but it works with c++. What language do you recommend for pcl?"}, {"owner": {"reputation": 301, "user_id": 11597414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219559370843238/picture?type=large", "display_name": "Tuna Y&#252;ce", "link": "https://stackoverflow.com/users/11597414/tuna-y%c3%bcce"}, "edited": false, "score": 0, "creation_date": 1562828352, "post_id": 56971518, "comment_id": 100501915, "body": "i also want to see the exact location of my point like in the picture. I want to see is it on hand, head or chest etc."}, {"owner": {"reputation": 1229, "user_id": 9226753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28247b27eef49240c767833514e2ab50?s=128&d=identicon&r=PG&f=1", "display_name": "kanstar", "link": "https://stackoverflow.com/users/9226753/kanstar"}, "edited": false, "score": 0, "creation_date": 1562872244, "post_id": 56971518, "comment_id": 100525872, "body": "You can use the <code>visualization</code> module of <code>PCL</code>. Have a look at this <a href=\"http://pointclouds.org/documentation/tutorials/pcl_visualizer.php\" rel=\"nofollow noreferrer\">tutorial</a>."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 7766665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-th2MsgyytfE/AAAAAAAAAAI/AAAAAAAABpE/KOMNMAekYys/photo.jpg?sz=128", "display_name": "Howcanoe Wang", "link": "https://stackoverflow.com/users/7766665/howcanoe-wang"}, "is_accepted": false, "score": 1, "last_activity_date": 1571979493, "creation_date": 1571979493, "answer_id": 58552423, "question_id": 56971518, "link": "https://stackoverflow.com/questions/56971518/how-to-check-certain-coordinates-on-a-point-cloud-3d-object/58552423#58552423", "title": "How to check certain coordinates on a point cloud / 3d object?", "body": "<p>It depends on if you want to check visually or automatically.</p>\n\n<p>The visually check is very easy to do with Open3D (at least, installation is much easier than PCL-Python)</p>\n\n<p>First, you need to install open3d packages. Then read your point clouds by:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import open3d as o3d\npcd = o3d.io.read_point_cloud(file_path)\n</code></pre>\n\n<p>Then generate two red point cloud in o3d: # I think your x(3,1) means x for two points</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import numpy as np\n\npcd_red = o3d.geometry.PointCloud()\n\nxyz = np.asarray([[3, 2, 8],\n                  [1, 8, 3]])\n\npcd_red.points = o3d.utility.Vector3dVector(xyz)\n\n# paint them to red\npcd_red.paint_uniform_color([1, 0, 0])\n</code></pre>\n\n<p>Finally is display:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>o3d.visualization.draw_geometries([pcd, pcd_red])\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 11597414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219559370843238/picture?type=large", "display_name": "Tuna Y&#252;ce", "link": "https://stackoverflow.com/users/11597414/tuna-y%c3%bcce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1102, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1571979493, "creation_date": 1562764393, "question_id": 56971518, "link": "https://stackoverflow.com/questions/56971518/how-to-check-certain-coordinates-on-a-point-cloud-3d-object", "title": "How to check certain coordinates on a point cloud / 3d object?", "body": "<p>I have a point cloud of a human body and 3d scan of it. I have some coordinates of skeleton joints but I want to check if the coordinates fit the body/point cloud or not. </p>\n\n<p>I have tried to do that with python open3d and pangolin c++ but I couldn't figure out how to do that.</p>\n\n<p>I have X, Y, Z coordinates of a point and I want to see where it is in my point cloud. To explain my question I have an example image that is done with paint.</p>\n\n<p><img src=\"https://i.imgur.com/Wa6rDGI.png\" alt=\"perfect art\"></p>\n\n<p>I need advice about what I can use to do that.</p>\n"}, {"tags": ["c++", "dictionary", "object", "pointers", "insert"], "comments": [{"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 2, "creation_date": 1562764255, "post_id": 56971352, "comment_id": 100479393, "body": "Do you know what does <code>MAP({a, &amp;f});</code> do and why? What is <code>MAP</code>?"}, {"owner": {"reputation": 1206, "user_id": 7331538, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d9da00c0aab10cac443b18a5fea32193?s=128&d=identicon&r=PG&f=1", "display_name": "user7331538", "link": "https://stackoverflow.com/users/7331538/user7331538"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1562764469, "post_id": 56971352, "comment_id": 100479525, "body": "map is a c++ map <a href=\"http://www.cplusplus.com/reference/map/map/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/map/map</a> maybe I should make it more clear by inserting the namespace before it."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1562764519, "post_id": 56971352, "comment_id": 100479557, "body": "Profile? What are the costs of splitting and calculating c? You could just <code>insert()</code> the value, which returns a boolean that tells you if it is already present. You can also use <code>emplace()</code> to not construct the value until it is inserted, but this is somewhat difficult to use effectively in c++11. In c++17 use <code>try_emplace()</code>, but if you want to save the effort of calculating c and foo() you would need to invent a wrapper class that can be constructed by splittedString[2] or foo() respectively."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 2, "creation_date": 1562764530, "post_id": 56971352, "comment_id": 100479571, "body": "Don&#39;t use <code>&lt;int, foo*&gt;</code>.  Instead use <code>&lt;int, std::unique_ptr&lt;foo&gt;&gt;</code>."}, {"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 2, "creation_date": 1562764700, "post_id": 56971352, "comment_id": 100479675, "body": "@user7331538, I doubt <code>MAP({a, &amp;f});</code> or <code>MAP(a)</code> is valid syntax."}, {"owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 1, "creation_date": 1562764863, "post_id": 56971352, "comment_id": 100479771, "body": "Please have a look at the <a href=\"https://en.cppreference.com/w/cpp/container/map\" rel=\"nofollow noreferrer\"><code>std::map</code></a> interface again. There is no call operator (<code>operator()</code>) defined for <code>std::map</code>. Therefore, your  <code>MAP(a)</code> is either wrong, or it does not do what you expect it to do..."}, {"owner": {"reputation": 1206, "user_id": 7331538, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d9da00c0aab10cac443b18a5fea32193?s=128&d=identicon&r=PG&f=1", "display_name": "user7331538", "link": "https://stackoverflow.com/users/7331538/user7331538"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1562764867, "post_id": 56971352, "comment_id": 100479776, "body": "@vahancho MAP(a) should have been MAP.find(a) and MAP({a, &amp;f}) should have been MAP.insert({a, &amp;f}). My mistake. Just edited the question."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562764928, "post_id": 56971352, "comment_id": 100479818, "body": "@user7331538 Please post your compiler options.  If you&#39;re timing a &quot;debug&quot; or unoptimized build, then your findings are meaningless.  Any question that has &quot;why is C++ slow?&quot; or &quot;Why is C++ slower than...?&quot; requires you to post the information concerning how you built your application."}, {"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 1, "creation_date": 1562764965, "post_id": 56971352, "comment_id": 100479839, "body": "How do you compile the code? With which optimizations? Please create a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> - including the benchmark."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1562765063, "post_id": 56971352, "comment_id": 100479893, "body": "Storing pointers to local variables is not a good idea."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1562765092, "post_id": 56971352, "comment_id": 100479910, "body": "<code>MAP.insert({a, &amp;f});</code>, and since <code>f</code> is a local variable, to, at the very least, the <code>while(getline(infile, line))</code>, dereferencing such entry, on any subsequent iteration of the loop, is undefined behavior, due to the <code>f</code> being  destroyed at the end of each iteration."}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1562765113, "post_id": 56971352, "comment_id": 100479921, "body": "In the code shown, <code>splittedString</code> as a size equal to 0 before used. Some code is missing?"}, {"owner": {"reputation": 1206, "user_id": 7331538, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d9da00c0aab10cac443b18a5fea32193?s=128&d=identicon&r=PG&f=1", "display_name": "user7331538", "link": "https://stackoverflow.com/users/7331538/user7331538"}, "reply_to_user": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1562765150, "post_id": 56971352, "comment_id": 100479940, "body": "@Damien some code is obviously missing since I have my own database that I am reading from"}, {"owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 1, "creation_date": 1562765161, "post_id": 56971352, "comment_id": 100479942, "body": "It makes more sense now! Still, you got a big error in your code. The lines <code>foo f = foo(); MAP.insert({a, &amp;f});</code> produce a pointer to a deleted object. You probably should use smart pointers instead..."}, {"owner": {"reputation": 1206, "user_id": 7331538, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d9da00c0aab10cac443b18a5fea32193?s=128&d=identicon&r=PG&f=1", "display_name": "user7331538", "link": "https://stackoverflow.com/users/7331538/user7331538"}, "reply_to_user": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 0, "creation_date": 1562765321, "post_id": 56971352, "comment_id": 100480016, "body": "@jan.sende or maybe change MAP&lt;int, foo*&gt; to Map&lt;int, foo&gt; ?"}, {"owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 0, "creation_date": 1562765536, "post_id": 56971352, "comment_id": 100480120, "body": "Sure, but then your code is still wrong ;) <code>MAP.emplace(a, foo());</code> would be the right option. (<code>emplace</code> is probably a tiny bit faster than <code>insert</code> for your case.)"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1562765668, "post_id": 56971352, "comment_id": 100480187, "body": "@user7331538 <a href=\"https://coliru.stacked-crooked.com/a/e50dd09c1ad5d1b2\" rel=\"nofollow noreferrer\">There is no issue inserting 50000 items here</a>.  Again, post your compiler options.  All of these suggestions will be made null and void if it is discovered you are running an unoptimized build, and that is the reason for the slowness."}, {"owner": {"reputation": 1206, "user_id": 7331538, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d9da00c0aab10cac443b18a5fea32193?s=128&d=identicon&r=PG&f=1", "display_name": "user7331538", "link": "https://stackoverflow.com/users/7331538/user7331538"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562765848, "post_id": 56971352, "comment_id": 100480275, "body": "@PaulMcKenzie in your case though foo object is not a pointer in the map. I just tried mine by inserting the object instead of a pointer and it worked well and fast. Inserting the pointer is what is making it so slow"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1562766231, "post_id": 56971352, "comment_id": 100480453, "body": "@user7331538 Insering the pointer is making it have undefined behaviour. Reasoning about the performance of undefined code is pointless at best."}, {"owner": {"reputation": 1206, "user_id": 7331538, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d9da00c0aab10cac443b18a5fea32193?s=128&d=identicon&r=PG&f=1", "display_name": "user7331538", "link": "https://stackoverflow.com/users/7331538/user7331538"}, "reply_to_user": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 0, "creation_date": 1562766268, "post_id": 56971352, "comment_id": 100480471, "body": "@jan.sende I think you are right. can you outline a solution that uses pointers or unique_ptr?"}, {"owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 0, "creation_date": 1562767550, "post_id": 56971352, "comment_id": 100481263, "body": "See my answer on how to do this with <code>std::unique_ptr</code>."}], "answers": [{"tags": [], "owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "is_accepted": false, "score": 0, "last_activity_date": 1562767460, "last_edit_date": 1562767460, "creation_date": 1562766410, "answer_id": 56972126, "question_id": 56971352, "link": "https://stackoverflow.com/questions/56971352/c-inserting-in-map-is-taking-a-long-time/56972126#56972126", "title": "C++ inserting in map() is taking a long time", "body": "<p>You code is a little bit more complicated than it needs to be. You should let <code>std::map</code> do the work instead of trying it yourself. What you want is the <code>.emplace</code> function of the container. It not only skips the insert if not necessary, but it also gives you the right entry to modify. For example, you could do something like:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;map&gt;\n#include &lt;string&gt;\n\nint main()\n{\n    //helper\n    auto print = [](auto MAP) \n    {\n        std::cout &lt;&lt; \"MAP:\\n\";\n        for (auto &amp;&amp; each : MAP)\n            std::cout &lt;&lt; each.first &lt;&lt; \"-&gt;\" &lt;&lt; each.second &lt;&lt; '\\n';\n    };\n    //work\n    std::map&lt;int, std::string&gt; MAP;\n\n    MAP.emplace(1,\"\").first-&gt;second = \"one\";\n    MAP.emplace(2,\"\").first-&gt;second = \"two\";\n    print(MAP);\n    MAP.emplace(1,\"\").first-&gt;second = \"three\";\n    print(MAP);\n}\n</code></pre>\n\n<p>Which produces the following output:</p>\n\n<pre><code>MAP:\n1-&gt;one\n2-&gt;two\nMAP:\n1-&gt;three\n2-&gt;two\n</code></pre>\n\n<p>Of course, this has this weird <code>.first-&gt;second</code> syntax, but we can refactor it into a new lambda:</p>\n\n<pre><code>auto update = [](auto&amp; MAP, auto index, auto entry) \n{\n    MAP.emplace(index,\"\").first-&gt;second = entry;\n};\n</code></pre>\n\n<p>which lets you write the following:</p>\n\n<pre><code>update(MAP, 1, \"one\");\nupdate(MAP, 2, \"two\");\nprint(MAP);\nupdate(MAP, 1, \"three\");\nprint(MAP);\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Because you asked for a <code>std::unique_ptr</code> solution, here is it:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;map&gt;\n#include &lt;string&gt;\n#include &lt;memory&gt;\n\nint main()\n{\n    //helper\n    auto print = [](const auto&amp; MAP) \n    {\n        std::cout &lt;&lt; \"MAP:\\n\";\n        for (auto &amp;&amp; each : MAP)\n            std::cout &lt;&lt; each.first &lt;&lt; \"-&gt;\" &lt;&lt; *each.second.get() &lt;&lt; '\\n';\n    };\n    //work\n    std::map&lt;int, std::unique_ptr&lt;std::string&gt;&gt; MAP;\n\n    auto update = [](auto&amp; MAP, auto index, auto entry) \n    {\n        *MAP.emplace(index, std::make_unique&lt;std::string&gt;()).first-&gt;second.get() = entry;\n    };\n    update(MAP, 1, \"one\");\n    update(MAP, 2, \"two\");\n    print(MAP);\n    update(MAP, 1, \"three\");\n    print(MAP);\n}\n</code></pre>\n\n<p>It unfortunately gets a little bit unreadable and also annoying because <code>std::unique_ptr</code> cannot be copied. (This is just the way it is implemented.)</p>\n"}], "owner": {"reputation": 1206, "user_id": 7331538, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d9da00c0aab10cac443b18a5fea32193?s=128&d=identicon&r=PG&f=1", "display_name": "user7331538", "link": "https://stackoverflow.com/users/7331538/user7331538"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1562767460, "creation_date": 1562763894, "last_edit_date": 1562765944, "question_id": 56971352, "link": "https://stackoverflow.com/questions/56971352/c-inserting-in-map-is-taking-a-long-time", "title": "C++ inserting in map() is taking a long time", "body": "<p>I have a <code>map</code> with types <code>&lt;int, foo*&gt;</code> which I am populating from a database. <code>int</code> is a unique key so before populating I am checking if key is already in map if not than a new object of type <code>foo</code> is created and inserted in map.</p>\n\n<p>The <code>foo</code> class also has another map as attribute with types <code>&lt;int, float&gt;</code> which also needs to be populated from the database. I have the below code which is supposedly simple:</p>\n\n<pre><code>std::map&lt;int, foo&gt; MAP;\n\nwhile(getline(infile, line))\n{ //reading records in data file\n    string item;\n    stringstream ss(line);\n    vector&lt;string&gt; splittedString;\n\n    int a = stoi(splittedString[0]); // cells after splitting data\n    int b = stoi(splittedString[1]);\n    float c = stof(splittedString[2]);\n\n\n    if (MAP.find(a) == MAP.end())\n    {\n        foo f = foo();\n        MAP.insert({a, &amp;f});\n        f.fooMap.insert({b, c/100});\n    }\n    else\n    {\n        foo* f = MAP.at(a);\n        f-&gt;fooMap.insert({b, c/100});\n    }\n}\n</code></pre>\n\n<p>This is taking a ridiculous amount of time to compute. There are about 50,000 records but that should not take forever. I am pretty sure I am doing something wrong since I am somewhat rusty with c++.</p>\n\n<p>I know I have some redundancy when creating the foo object and I think a more efficient way of doing the above is the below 'incorrect' code:</p>\n\n<pre><code>while(getline(infile, line))\n{//reading records in data file\n    string item;\n    stringstream ss(line);\n    vector&lt;string&gt; splittedString;\n\n    int a = stoi(splittedString[0]); //cells after splitting data\n    int b = stoi(splittedString[1]);\n    float c = stof(splittedString[2]);\n\n    foo f = *MAP[a];        \n    if (f == NULL)\n    {\n        f = foo();\n        MAP.insert({a, &amp;f});\n\n    }    \n    f-&gt;fooMap.insert({b, c/100});\n}\n</code></pre>\n\n<h1>update</h1>\n\n<p>if I use <code>MAP&lt;int, foo&gt;</code> instead of <code>MAP&lt;int, foo*&gt;</code> (and arranging the insertion code accordingly), the code works normally. So I am doing something wrong with pointers. what is the best way to tackle this? </p>\n"}, {"tags": ["c++", "atomic"], "comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 3, "creation_date": 1562764464, "post_id": 56971327, "comment_id": 100479520, "body": "Everything that is not atomic is not atomic.  Even <code>char</code>.  Complex objects may need higher level inter-thread protections (condvar, mutex, locking).  Non-volatile objects may be optimized is surprising ways that thwarts using them across threads."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1562764584, "post_id": 56971327, "comment_id": 100479610, "body": "The &quot;atomic&quot; in <code>std::atomic</code> doesn&#39;t mean &quot;will be atomic on the processor level&quot; but &quot;you are guaranteed that this operation is not interleaved with other operations on the same object&quot;. You can prevent interleaving with e.g. locks, hence <a href=\"https://en.cppreference.com/w/cpp/atomic/atomic/is_lock_free\" rel=\"nofollow noreferrer\"><code>std::atomic::is_lock_free</code></a> and <a href=\"https://en.cppreference.com/w/cpp/atomic/atomic/is_always_lock_free\" rel=\"nofollow noreferrer\"><code>std::atomic::is_always_lockfree</code></a> exist to tell you whether locks are necessary for the given atomic instance or type."}, {"owner": {"reputation": 869, "user_id": 1903880, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3a7f0353e763f3e86ca839f199ebc6dd?s=128&d=identicon&r=PG", "display_name": "zhihuifan", "link": "https://stackoverflow.com/users/1903880/zhihuifan"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1562765207, "post_id": 56971327, "comment_id": 100479974, "body": "@Eljay  how to understand <code>char</code> is not atomic?   we can take <code>c = &#39;s&#39; </code> for example."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1562765582, "post_id": 56971327, "comment_id": 100480145, "body": "It&#39;s the other way around: <code>char</code> is not guaranteed to be atomic, so you can&#39;t assume that it will work correctly when shared between multiple threads. <code>std::atomic&lt;char&gt;</code> will work correctly, and if a plain <code>char</code> happens to meet all the requirements for atomic objects, then <code>atomic&lt;char&gt;</code> won&#39;t do anything extra. If plain <code>char</code> doesn&#39;t meet all the requirements, then <code>atomic&lt;char&gt;</code> will do whatever is necessary."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1576554032, "post_id": 56971327, "comment_id": 104928175, "body": "@Eljay 1) Which real world CPU does <i>not</i> provide atomic read and write instructions up to the natural word size? 2) Where is that word size less than 32 bits?"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1576576010, "post_id": 56971327, "comment_id": 104935690, "body": "@curiousguy \u2022 the DEC Alpha CPU only provided read and write instructions for the natural word size, not for char size."}], "answers": [{"comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1562765754, "post_id": 56971858, "comment_id": 100480232, "body": "To be perfectly clear: if more than one thread accesses an object and at least one of those accesses modifies the object, that&#39;s a <b>data race</b>, and the behavior is undefined. One common consequence of that is &quot;any change you make in one thread can not be assumed to show up in other threads&quot;, but that is by no means the extent of the possible problems."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1562766208, "post_id": 56971858, "comment_id": 100480442, "body": "@PeteBecker Added that into the answer."}, {"owner": {"reputation": 869, "user_id": 1903880, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3a7f0353e763f3e86ca839f199ebc6dd?s=128&d=identicon&r=PG", "display_name": "zhihuifan", "link": "https://stackoverflow.com/users/1903880/zhihuifan"}, "edited": false, "score": 0, "creation_date": 1562801802, "post_id": 56971858, "comment_id": 100495555, "body": "Thanks for the answer, but that&#39;s is not something I want.   in your case, the flag can be either true or false,  which any compiler and cpu cache &amp; store buffer can make that.   Here I&#39;m asking a case that is it possible to get a data which is not &quot;true&quot; or &quot;false&quot; in your example.   If you check my question,  it is not &quot;0&quot; and not &quot;100&quot;.  @NathanOliver"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 4, "last_activity_date": 1562766191, "last_edit_date": 1562766191, "creation_date": 1562765534, "answer_id": 56971858, "question_id": 56971327, "link": "https://stackoverflow.com/questions/56971327/what-makes-c-atomic-atomic/56971858#56971858", "title": "what makes c++ atomic atomic", "body": "<blockquote>\n  <p>is the above true?</p>\n</blockquote>\n\n<p>Yes.  If you do not use synchronization (<code>std::atmoic&lt;&gt;</code>, <code>std::mutex</code>, ...) then any change you make in one thread can not be assumed to show up in other threads.  It could even be the compiler optimizes something away because there is no way it can change in function.  For example</p>\n\n<pre><code>bool flag = true;\n\nvoid stop_stuff() \n{ \n    flag = false; \n}\n\nvoid do_stuff()\n{\n    while (flag)\n        std::cout &lt;&lt; \"never stop\";\n}\n</code></pre>\n\n<p>since there is no synchronization for <code>flag</code>, the compiler is free to assume it never changes optmize away even checking flag in the loop condition.  If it does then no matter how many times you call <code>stop_stuff</code>, <code>do_stuff</code> will never end.</p>\n\n<p>If you change flag to <code>std::atomic&lt;bool&gt; flag</code>, then the compiler can no longer make such an assumption as you are telling it that this variable can change outside the scope of the function and it needs to be checked.</p>\n\n<p>Do note that not providing synchronization when you have more than one thread with shared data and at least one of those threads writes to the shared data is called a data race and per the standard is undefined behavior.  The above example is just one possible outcome of that undefined behavior.</p>\n\n<blockquote>\n  <p><code>std::atomic&lt;int64_t&gt; i;  i.store(100, std::memory_order_relaxed)</code> is atomic. so what magic does atomic use to make it happen based on Q1 is true?</p>\n</blockquote>\n\n<p>It either uses an atomic primitive your system provides, or it uses a locking mechanism like <code>std::mutex</code> to guard the access.</p>\n\n<blockquote>\n  <p>I always think any operation which handles less than 64 bits is atomic (assume 64 bit cpu), looks I was wrong. so for  v = n, how I can know if it is atomic or not? for example, if v is void *, is it atomic or not?</p>\n</blockquote>\n\n<p>While this may be true on some systems, it is not true for the C++ memory model.  The only things that are atomic are <code>std::atomic&lt;T&gt;</code>.  </p>\n"}, {"comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1576554482, "post_id": 56971872, "comment_id": 104928256, "body": "&quot;memory caching can mess with it&quot; But can it, in the real world?"}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 1, "last_activity_date": 1562765578, "creation_date": 1562765578, "answer_id": 56971872, "question_id": 56971327, "link": "https://stackoverflow.com/questions/56971327/what-makes-c-atomic-atomic/56971872#56971872", "title": "what makes c++ atomic atomic", "body": "<ol>\n<li><p>Yes. Reasons include \"it requires multiple instructions\", \"memory caching can mess with it\" and \"the compiler may do surprising things (aka UB) if you fail to mention that the variable might be changed elsewhere\".</p></li>\n<li><p>The above reasons need to all be treated, and <code>std::atomic</code> gives the compiler/C++ library implementation the information to do so. The compiler won't be allowed to do any surprise optimizations, it might issue cache flushes where necessary, and the implementation may use a locking mechanism to prevent different operations on the same object from interleaving. Note that not all of these may be necessary: x86 has some atomicity guarantees built in. You can inform yourself whether a given <code>std::atomic</code> type is always lock-free on your platform with <a href=\"https://en.cppreference.com/w/cpp/atomic/atomic/is_always_lock_free\" rel=\"nofollow noreferrer\"><code>std::atomic::is_always_lockfree</code></a>, and whether a given instance is <a href=\"https://en.cppreference.com/w/cpp/atomic/atomic/is_lock_free\" rel=\"nofollow noreferrer\">lock-free</a> (due to e.g. aligned/unaligned access).</p></li>\n<li><p>If you don't use <code>std::atomic</code>, you have no atomicity guarantees due to the above reasons. It might be atomic on the instruction-level on your CPU, but C++ is defined on an abstract machine without such guarantees. If your code relies on atomicity on the abstract machine but fails to specify this, the compiler might make invalid optimizations and produce UB.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1576554373, "post_id": 56971913, "comment_id": 104928237, "body": "What is &quot;8 bit memory&quot;?"}], "tags": [], "owner": {"reputation": 4419, "user_id": 2254782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93806dc8873fdb424d2df0f57b54d8e?s=128&d=identicon&r=PG", "display_name": "alexrider", "link": "https://stackoverflow.com/users/2254782/alexrider"}, "is_accepted": false, "score": 0, "last_activity_date": 1562765709, "creation_date": 1562765709, "answer_id": 56971913, "question_id": 56971327, "link": "https://stackoverflow.com/questions/56971327/what-makes-c-atomic-atomic/56971913#56971913", "title": "what makes c++ atomic atomic", "body": "<ol>\n<li>Yes, for example if there is 8bit memory, another thread may read partially written variable.</li>\n<li>Whatever it takes to guarantee correct results, it can be nothing, built in atomic operations, locks etc.</li>\n<li>void* is not atomic std::atomic &lt; void* > is.\nSame for the char, to be atomic it needs to be explicitly stated as atomic.</li>\n</ol>\n"}], "owner": {"reputation": 869, "user_id": 1903880, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3a7f0353e763f3e86ca839f199ebc6dd?s=128&d=identicon&r=PG", "display_name": "zhihuifan", "link": "https://stackoverflow.com/users/1903880/zhihuifan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1562802044, "creation_date": 1562763820, "last_edit_date": 1562802044, "question_id": 56971327, "link": "https://stackoverflow.com/questions/56971327/what-makes-c-atomic-atomic", "title": "what makes c++ atomic atomic", "body": "<p>I just know that even the code <code>int64_t_variable = 10</code> is not an atomic operation.  for example</p>\n\n<pre><code>int64_t i = 0;\ni = 100;\n</code></pre>\n\n<p>in another thread (say T2) it may read the value which is not <code>0</code> or <code>100</code>.</p>\n\n<ol>\n<li>is the above true?</li>\n<li><code>std::atomic&lt;int64_t&gt; i;  i.store(100, std::memory_order_relaxed)</code> is atomic.  so what magic does atomic use to make it happen based on Q1 is true?</li>\n<li>I always think any operation which handles less than 64 bits is atomic (assume 64 bit cpu), looks I was wrong.  so for  <code>v = n</code>,  how I can know if it is atomic or not?  for example,  if v is <code>void *</code>, is it atomic or not?</li>\n</ol>\n\n<p>==================================</p>\n\n<p>Update:   In my question:  when T2 read the <code>i</code>,  both 0 and 100 are ok for me.  but any other result is not reasonable.  This is the point.  so I don't think cpu cache or compiler stuff can make this happen. </p>\n"}, {"tags": ["c++", "cmake", "grpc"], "comments": [{"owner": {"reputation": 812, "user_id": 6288413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bLBoc.jpg?s=128&g=1", "display_name": "zmike", "link": "https://stackoverflow.com/users/6288413/zmike"}, "edited": false, "score": 0, "creation_date": 1562763703, "post_id": 56971252, "comment_id": 100479062, "body": "Will you please provide the command you used to generate the protbuf/gRPC code?"}, {"owner": {"reputation": 327, "user_id": 8052539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ff2b0f87a3312c4f0295d2bca8c5cbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Ignas", "link": "https://stackoverflow.com/users/8052539/ignas"}, "reply_to_user": {"reputation": 812, "user_id": 6288413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bLBoc.jpg?s=128&g=1", "display_name": "zmike", "link": "https://stackoverflow.com/users/6288413/zmike"}, "edited": false, "score": 0, "creation_date": 1562764199, "post_id": 56971252, "comment_id": 100479352, "body": "I have added a makefile, is this what you were asking for?"}], "answers": [{"tags": [], "owner": {"reputation": 327, "user_id": 8052539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ff2b0f87a3312c4f0295d2bca8c5cbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Ignas", "link": "https://stackoverflow.com/users/8052539/ignas"}, "is_accepted": false, "score": 1, "last_activity_date": 1562764535, "creation_date": 1562764535, "answer_id": 56971568, "question_id": 56971252, "link": "https://stackoverflow.com/questions/56971252/how-to-solve-compile-error-in-grpc-generated-files/56971568#56971568", "title": "How to solve compile error in gRPC generated files?", "body": "<p>Then problem was solved like this:\nI had to chage <code>grpc++_unsecure</code> to <code>grpc++</code> under <code>target_link_libraries</code> in <code>CMakeLists.txt</code> cmake build configuration file.\nI had forgotten/not thought about this at first.</p>\n\n<pre><code>target_link_libraries(bita_server\n        pqxx\n        sodium\n        protobuf::libprotobuf\n#        grpc++_unsecure\n        grpc++\n        SQLiteCpp\n        sqlite3\n        pthread\n        dl\n        ${_PROTOBUF_LIBPROTOBUF}\n)\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 8052539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ff2b0f87a3312c4f0295d2bca8c5cbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Ignas", "link": "https://stackoverflow.com/users/8052539/ignas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562764535, "creation_date": 1562763499, "last_edit_date": 1562764151, "question_id": 56971252, "link": "https://stackoverflow.com/questions/56971252/how-to-solve-compile-error-in-grpc-generated-files", "title": "How to solve compile error in gRPC generated files?", "body": "<p>I am creating client-server application, using gRPC. So far I was not using TLS encryption. Now I want to enable it, and strangely I get this error. It seems, at least to me, that this is a linker error. What would be best ways to solve it?\nCLion doesn't highlight anything, so I assumed everything was syntactically OK, but when compiling I got that error.</p>\n\n<pre><code>/usr/bin/ld: CMakeFiles/projectname.dir/main.cpp.o: in function `grpc::SslServerCredentials(grpc::SslServerCredentialsOptions const&amp;)':\n/home/username/projectname/third_party/grpc/include/grpcpp/security/server_credentials.h:60: undefined reference to `grpc_impl::SslServerCredentials(grpc::SslServerCredentialsOptions const&amp;)'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>This is a makefile that I use to generate C++ code from gRPC specification:</p>\n\n<pre><code>HOST_SYSTEM = $(shell uname | cut -f 1 -d_)\nSYSTEM ?= $(HOST_SYSTEM)\nCXX = g++\nCPPFLAGS += `pkg-config --cflags protobuf grpc`\nCXXFLAGS += -std=c++11\nifeq ($(SYSTEM),Darwin)\nLDFLAGS += -L/usr/local/lib `pkg-config --libs protobuf grpc++`\\\n           -lgrpc++_reflection\\\n           -ldl\nelse\nLDFLAGS += -L/usr/local/lib `pkg-config --libs protobuf grpc++`\\\n           -Wl,--no-as-needed -lgrpc++_reflection -Wl,--as-needed\\\n           -ldl\nendif\nPROTOC = protoc\nGRPC_CPP_PLUGIN = grpc_cpp_plugin\nGRPC_CPP_PLUGIN_PATH ?= `which $(GRPC_CPP_PLUGIN)`\n\nPROTOS_PATH = ./\n\nvpath %.proto $(PROTOS_PATH)\n\n%.grpc.pb.cc: %.proto\n    $(PROTOC) -I $(PROTOS_PATH) --grpc_out=. --plugin=protoc-gen-grpc=$(GRPC_CPP_PLUGIN_PATH) $&lt;\n\n%.pb.cc: %.proto\n    $(PROTOC) -I $(PROTOS_PATH) --cpp_out=. $&lt;\n\nclean:\n    rm -f *.o *.pb.cc *.pb.h\n</code></pre>\n"}, {"tags": ["c++", "visual-c++", "wxwidgets"], "answers": [{"tags": [], "owner": {"reputation": 1572, "user_id": 3636621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef6473d290d66740556cd4a73dd8dcb?s=128&d=identicon&r=PG&f=1", "display_name": "catalin", "link": "https://stackoverflow.com/users/3636621/catalin"}, "is_accepted": false, "score": 0, "last_activity_date": 1562764681, "creation_date": 1562764681, "answer_id": 56971612, "question_id": 56971169, "link": "https://stackoverflow.com/questions/56971169/wxwigets-fails-to-pass-events-or-anything-from-inside-a-wxgridsizer-if-there-i/56971612#56971612", "title": "wxWigets fails to pass events (or anything) from inside a wxGridSizer if there is a panel or wxScrolledWindow", "body": "<p>AFAIU you want to have the following layout:</p>\n\n<p><code>wxFrame</code> -> <code>wxBoxSizer</code> -> <code>wxScrolledWindow</code> -> <code>wxGridSizer</code> -> <code>wxCheckBox</code></p>\n\n<p>So far it is nothing wrong with the <code>wxGridSizer</code>, but with the parent of <code>prueba_cbox</code> which should be <code>miscroll</code> instead of <code>this</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9736964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7da4738386cae4d9c603eeb47b46b72f?s=128&d=identicon&r=PG", "display_name": "Diego Betancor", "link": "https://stackoverflow.com/users/9736964/diego-betancor"}, "is_accepted": false, "score": 0, "last_activity_date": 1562775071, "creation_date": 1562775071, "answer_id": 56974733, "question_id": 56971169, "link": "https://stackoverflow.com/questions/56971169/wxwigets-fails-to-pass-events-or-anything-from-inside-a-wxgridsizer-if-there-i/56974733#56974733", "title": "wxWigets fails to pass events (or anything) from inside a wxGridSizer if there is a panel or wxScrolledWindow", "body": "<p>wxCheckBox *prueba_cbox = new wxCheckBox( this, wxID_ANY, wxT(\"Check Me!\"), wxDefaultPosition, wxDefaultSize, 0 );</p>\n\n<p>should be a child of miscroll, not of this (the frame).</p>\n\n<p>Thank you (and sorry for the stupid  question)</p>\n"}], "owner": {"reputation": 1, "user_id": 9736964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7da4738386cae4d9c603eeb47b46b72f?s=128&d=identicon&r=PG", "display_name": "Diego Betancor", "link": "https://stackoverflow.com/users/9736964/diego-betancor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562775071, "creation_date": 1562763275, "question_id": 56971169, "link": "https://stackoverflow.com/questions/56971169/wxwigets-fails-to-pass-events-or-anything-from-inside-a-wxgridsizer-if-there-i", "title": "wxWigets fails to pass events (or anything) from inside a wxGridSizer if there is a panel or wxScrolledWindow", "body": "<p>In wxWidgets 3.0.4 compiled with Visual-C++ 2010 Express. In the main frame if I create a wxGridSizer directly and add to the sizer it works fine, but if instead wxBoxSizer -> wxScrolledWindow -> wxGridSizer it does not interact with whatever inside, including events.</p>\n\n<p>It all began with a panel inside the wxBoxSizer that you insert as many as you need (before you see how many columns/rows are needed). The idea is to have wxScrolledWindow take care if not fit in one screen.\nI have tried many, many things and look in the Internet. To make it easy and to the minimum that shows the behavior I will show code inside a frame (with menu and menubar that I do not show to point to the problem) that adds a checkbox, the easiest thing I can think of. No connects, no nothing to the checkbox. Without the wxScrolledWindow you can check it, with the wxScrolledWindow you cannot.\nI have tried with a panel instead wxScrolledWindow, with events, with more things.. and the same behavior.\nAny idea? Thank you in advance.</p>\n\n<p>WORKS:</p>\n\n<pre><code>    grid = new wxGridSizer( 3, 2, 0, 0 );  //declared in the class\n    wxCheckBox *prueba_cbox = new wxCheckBox( this, wxID_ANY, wxT(\"Check Me!\"), wxDefaultPosition, wxDefaultSize, 0 );\n    grid-&gt;Add( prueba_cbox, 0, wxALL, 5 );\n    grid-&gt;Fit(this);\n    this-&gt;SetSizer(grid);\n    this-&gt;Layout();\n    this-&gt;Centre( wxBOTH );\n</code></pre>\n\n<p>DO NOT WORKS:</p>\n\n<pre><code>    misizer = new wxBoxSizer(wxHORIZONTAL);\n    wxScrolledWindow* miscroll = new wxScrolledWindow(this, wxID_ANY);\n    miscroll-&gt;SetScrollRate( 0, 16 );\n    misizer-&gt;Add(miscroll, 1, wxALL | wxEXPAND, 0);\n\n    grid = new wxGridSizer( 3, 2, 0, 0 );\n\n    wxCheckBox *prueba_cbox = new wxCheckBox( this, wxID_ANY, wxT(\"Check Me!\"), wxDefaultPosition, wxDefaultSize, 0 );\n    grid-&gt;Add( prueba_cbox, 0, wxALL, 5 );\n    grid-&gt;Fit( miscroll );\n    miscroll-&gt;SetSizer( grid );\n\n    misizer-&gt;Fit(this);\n    this-&gt;SetSizer( misizer );\n    misizer-&gt;Layout();\n    this-&gt;Layout();\n    this-&gt;Centre( wxBOTH );\n</code></pre>\n\n<p>More, in: \"misizer->Add(miscroll, 1, wxALL | wxEXPAND, 0);\"</p>\n\n<p>Depends on the border, with 10 or more works, with 5 or less does not work. In this easy example; when actually putting panels inside, the events do not work even with a border of 120.</p>\n"}]