[{"tags": ["c++", "templates", "thread-safety", "c++17"], "comments": [{"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "edited": false, "score": 1, "creation_date": 1548653703, "post_id": 54337410, "comment_id": 95603257, "body": "The implementation of map modifies its internal data structures significantly while adding a key. This internal modification is not gated by a mutex or even atomic operations. Have two threads make this sort of modification at the same time will lead to all kinds of problems. Having a thread try to traverse these internal data structures searching for something while they&#39;re in the process of being updated will also lead to all kinds of problems. The fact that an add is an idempotent operation in your case is irrelevant."}], "answers": [{"comments": [{"owner": {"reputation": 4665, "user_id": 1447389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQhtr.jpg?s=128&g=1", "display_name": "Soleil", "link": "https://stackoverflow.com/users/1447389/soleil"}, "edited": false, "score": 0, "creation_date": 1548290237, "post_id": 54337440, "comment_id": 95492545, "body": "In c#, there is a <code>concurrent dictionary</code>. <code>Get</code> always works, but <code>Set</code> is implemented by a <code>tryadd</code>. Shouldn&#39;t I only lock when write ? (I never delete key-value pair, except at clear; or If I want to make it more thread friendly, I could just get rid of <code>clear</code>). Do you agree ?"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 1, "creation_date": 1548290877, "post_id": 54337440, "comment_id": 95492659, "body": "If you don&#39;t have the map locked while you read from it, there&#39;s nothing to prevent another thread from locking the lock and writing to the map while your thread is in the middle of reading from it, causing a race condition and invoking undefined behavior."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1548291962, "post_id": 54337440, "comment_id": 95492867, "body": "C++ is fundamentally different from C# in many ways. None of the containers in the C++ library are thread-safe in any way. Which means that any operation that involves a container must use locking. Hard and fast rule. You can bend the rules just a little bit by using a <code>std::shared_mutex</code> and use only a shared lock when only reading the container, but that&#39;s as much leeway as you can get."}, {"owner": {"reputation": 4665, "user_id": 1447389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQhtr.jpg?s=128&g=1", "display_name": "Soleil", "link": "https://stackoverflow.com/users/1447389/soleil"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1548334940, "post_id": 54337440, "comment_id": 95509890, "body": "@JeremyFriesner Let&#39;s say the map is only used for reading a key-value or adding a key-value, then I think I can read safely (ie., have consistent result) while adding at the same time. Is it true (or does it depend on the impementation) ? A another situation is: 2+ threads don&#39;t find a key and add at the same time (the value is always the same for a given key): can I allow this and still get consistent result after the first insert occured ?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1548335046, "post_id": 54337440, "comment_id": 95509943, "body": "No, it&#39;s not true. There is no other way to state this: C++ containers are not thread-safe by themselves. No exceptions. You will not get a different answer than this, from anyone else (who actually knows C++)."}, {"owner": {"reputation": 4665, "user_id": 1447389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQhtr.jpg?s=128&g=1", "display_name": "Soleil", "link": "https://stackoverflow.com/users/1447389/soleil"}, "edited": false, "score": 0, "creation_date": 1548335965, "post_id": 54337440, "comment_id": 95510589, "body": "@SamVarshavchik Do you have a pointer to code source to support your claim, for the sake of having a full understanding ? I still thing otherwise because the hash function is constant, and a certain key-value is unique (it won&#39;t be modified). Check out the added details (EDIT)."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1548336285, "post_id": 54337440, "comment_id": 95510778, "body": "C++ is not defined by sample code, but by the C++ specification. Nothing in the C++ specification is thread-safe by default, and you will not find anything in the C++ specification that specified that any method of a <code>std::map</code> is thread-safe. The hash function is utterly irrelevant, and doesn&#39;t have to do anything with anything else. <code>std::map</code> is not thread safe. Even if you never change an existing key in the map, if another thread is modifying the map <b><i>in any way</i></b> you cannot search the map. Even for an existing key. End of story."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 3, "creation_date": 1548338344, "post_id": 54337440, "comment_id": 95512064, "body": "&quot;My understanding from Butenhoff&#39;s book is that we need to use mutex only when we modify the data.&quot; Correct, and you&#39;re modifying the map. Therefore the map must be locked, when it is accessed. The map is one self-contained entity. In most implementations it&#39;s a red-black tree. Any insert can rebalance the entire tree, remapping all internal pointers. If another thread is searching that map, for some key, while all the pointers are being ripped from under its feet, hillarity ensues. Boom."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1548340014, "post_id": 54337440, "comment_id": 95513130, "body": "<i>&quot;due to the fact that for a given key, the pointer to the value will always be the same (thanks to the hash function), therefore if the key exists, I don&#39;t need to lock.&quot;</i> The key point being the &quot;if the key exists&quot; part. You have to resolve that question by doing a <code>find</code>, and <code>find</code> is not going to have fun while mutations are taking place. It is true that observing <i>the value of individual elements</i> is much less prone to threading problems, but that&#39;s not all that you&#39;re doing; you&#39;re forgetting all about the map&#39;s internal mechanisms that get you to that value."}], "tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": true, "score": 6, "last_activity_date": 1548287491, "creation_date": 1548287491, "answer_id": 54337440, "question_id": 54337410, "link": "https://stackoverflow.com/questions/54337410/is-this-generic-implementation-of-cache-thread-safe-c/54337440#54337440", "title": "Is this generic implementation of cache thread safe (c++)?", "body": "<p>This implementation is not thread-safe, for multiple reasons.</p>\n\n<p>The first half of <code>GetOf()</code> invokes methods of a <code>std::map</code>'s instance. None of <code>std::map</code>'s methods are thread safe, and the second half of <code>GetOf()</code> modifies the <code>std::map</code>.</p>\n\n<p>Since the mutex does not protect the first half of <code>Getof()</code>, where the aforementioned methods get invoked, this is not thread-safe.</p>\n\n<p><code>Clear()</code> also modifies the <code>std::map</code>, without any synchronization/mutex protection, either.</p>\n\n<p>P.S. The invocation of <code>std::map::clear()</code> in the destructor is not necessary.</p>\n"}], "owner": {"reputation": 4665, "user_id": 1447389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQhtr.jpg?s=128&g=1", "display_name": "Soleil", "link": "https://stackoverflow.com/users/1447389/soleil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 54337440, "answer_count": 1, "score": 0, "last_activity_date": 1548342459, "creation_date": 1548287247, "last_edit_date": 1548342459, "question_id": 54337410, "link": "https://stackoverflow.com/questions/54337410/is-this-generic-implementation-of-cache-thread-safe-c", "title": "Is this generic implementation of cache thread safe (c++)?", "body": "<p>I wrote the following implementation of a generic cache, where <code>func</code> will provide the values (compute, read file, etc). <strong>Is it thread safe ?</strong></p>\n\n<pre><code>#pragma once\n#include \"stdafx.h\"\n#include &lt;map&gt;\n#include &lt;functional&gt;\n#include &lt;mutex&gt;\n\nusing namespace std;\n\ntemplate&lt;class T1, class T2&gt;\nclass __declspec(dllexport) CacheOf\n{\n    map&lt;T1, T2&gt; _cache;\n    function&lt;T2(T1)&gt; _func;\n    mutex CacheMtx;\npublic:\n    CacheOf(function&lt;T2(T1)&gt; func);\n    ~CacheOf();\n    T2 Get(T1);\n    void Clear();\n};\n\ntemplate &lt;class T1, class T2&gt;\nCacheOf&lt;T1, T2&gt;::CacheOf(std::function&lt;T2(T1)&gt; func)\n{\n    _func = func;\n}\n\ntemplate &lt;class T1, class T2&gt;\nCacheOf&lt;T1, T2&gt;::~CacheOf()\n{\n    _cache.clear();\n}\n\ntemplate &lt;class T1, class T2&gt;\nauto CacheOf&lt;T1, T2&gt;::Get(T1 key) -&gt; T2\n{\n\n    auto it = _cache.find(key);\n    T2 value;\n    if (it != _cache.end())\n    {\n        value = it-&gt;second;\n        return value;\n    }\n    value = _func(key);\n    {\n        unique_lock&lt;mutex&gt; cachelock(CacheMtx);\n        _cache.insert(pair&lt;T1, T2&gt;(key, value));\n    }\n    return value;\n}\n\ntemplate &lt;class T1, class T2&gt;\nauto CacheOf&lt;T1, T2&gt;::Clear() -&gt; void\n{\n    _cache.clear();\n}\n</code></pre>\n\n<p>EDIT: For the context I'll use this class I add this condition: </p>\n\n<blockquote>\n  <p>for a given key, the value is always the same</p>\n</blockquote>\n\n<p>Should not I lock only when I <code>insert</code> ? Is it fine to read a certain key-value stored in the map while inserting at the same time ? Is is also fine to have 2 threads doing an insert at the same time (so I can avoid the usage of a mutex) ?</p>\n\n<p>My understanding from Butenhoff's book is that we need to use mutex only when we modify the data. Therefore, in a map, due to the fact that for a given key, the pointer to the value will always be the same (thanks to the hash function), therefore if the key exists, I don't need to lock.</p>\n"}, {"tags": ["c++", "x86", "linker", "elf", "intel-pin"], "comments": [{"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1548287752, "post_id": 54337322, "comment_id": 95492044, "body": "What version of Pin did you use? What compiler and compiler options did you use to compile <code>memcpy</code>?"}, {"owner": {"reputation": 1322, "user_id": 2687712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba5e7b4134ebefb05f6907c13b328af?s=128&d=identicon&r=PG&f=1", "display_name": "AntiClimacus", "link": "https://stackoverflow.com/users/2687712/anticlimacus"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1548350728, "post_id": 54337322, "comment_id": 95519824, "body": "@HadiBrais g++ 7.3.0 and Pin 3.7 (latest release). The Pin tool has been compiled with the <code>makefile.rules</code> from Pin, the test binary has been compiled with <code>-O3 -g</code>."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1548351823, "post_id": 54337322, "comment_id": 95520346, "body": "Can you check with <code>PIN_InitSymbolsAlt</code> but without passing <code>IFUNC_SYMBOLS</code>? I think this will behave like <code>PIN_InitSymbols</code>. That flag make Pin read the ifunc symbols, which may be the reason for the difference."}, {"owner": {"reputation": 1322, "user_id": 2687712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba5e7b4134ebefb05f6907c13b328af?s=128&d=identicon&r=PG&f=1", "display_name": "AntiClimacus", "link": "https://stackoverflow.com/users/2687712/anticlimacus"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1548366518, "post_id": 54337322, "comment_id": 95526784, "body": "@HadiBrais Indeed, without <code>IFUNC_SYMBOLS</code> I don&#39;t get the symbol, so this is the one changing things... still, to me, symbols were one thing, routines another. I guess it is related to the fact that RTN, like IMG and unlike INS, in Pin, are being loaded at load time, and not on the fly, but I must admit I am slightly scared now that I could miss part of my analysis!"}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 1, "creation_date": 1548367056, "post_id": 54337322, "comment_id": 95527010, "body": "I don&#39;t understand why you&#39;re saying that <code>PIN_InitSymbolsAlt</code> with <code>IFUNC_SYMBOLS</code> is more accuarate/reliable. Why would <code>memcpy</code> be called 29 times? It makes sense that <code>memcpy@plt</code> is called once because all calls to <code>memcpy</code> has to go indirectly throughput the PLT entry of <code>memcpy</code>. So I&#39;m not sure what the <code>memcpy</code> symbol actually represents. <code>memcpy@plt</code> is the one that represents the function and correctly counts the number of invocations, not <code>memcpy</code>."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1548367268, "post_id": 54337322, "comment_id": 95527092, "body": "Try to dump all the symbols defined in the memcpy binary using <code>readelf -Ws</code> and see what each symbol means."}, {"owner": {"reputation": 1322, "user_id": 2687712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba5e7b4134ebefb05f6907c13b328af?s=128&d=identicon&r=PG&f=1", "display_name": "AntiClimacus", "link": "https://stackoverflow.com/users/2687712/anticlimacus"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1548531786, "post_id": 54337322, "comment_id": 95577208, "body": "@HadiBrais I spent a substantial more time looking at it and you&#39;re right, <code>IFUNC_SYMBOLS</code> does not make it more reliable - effectively, as you said, the numbers don&#39;t make sense. I still don&#39;t really understand what is the concept of IFUNC in the Pin world - to be continued. Thanks for having looked at it - much appreciated."}], "owner": {"reputation": 1322, "user_id": 2687712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba5e7b4134ebefb05f6907c13b328af?s=128&d=identicon&r=PG&f=1", "display_name": "AntiClimacus", "link": "https://stackoverflow.com/users/2687712/anticlimacus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548351915, "creation_date": 1548286544, "last_edit_date": 1548351915, "question_id": 54337322, "link": "https://stackoverflow.com/questions/54337322/intel-pin-function-not-being-analyzed-depending-on-symbols-initialization", "title": "Intel Pin: function not being analyzed depending on symbols initialization", "body": "<p>While instrumenting some code with Intel Pin I got a strange behavior that I isolated in the code below.</p>\n\n<p>Basically, in the trace of my Pin Tool I noticed that some parts were missing and found that a call to <code>PIN_InitSymbolsAlt(SYMBOL_INFO_MODE(UINT32(IFUNC_SYMBOLS) | UINT32(DEBUG_OR_EXPORT_SYMBOLS)))</code> instead of my previous <code>PIN_InitSymbols</code> was changing <strong>much</strong> more than symbols being accessible or not &mdash; effectively, some routines that were analyzed with zero instructions before were now displaying a positive (and realistic) number of instructions...</p>\n\n<p>In the code below (stripped down version of my program and Pin Tool), I took <code>memcpy</code> as example.</p>\n\n<p>This Pin Tool is simply counting the number of instructions per routine:</p>\n\n<pre><code>#include \"pin.H\"\n\n#include &lt;cstdint&gt;\n#include &lt;iostream&gt;\n#include &lt;map&gt;\n\nstd::map&lt;std::string, uint64_t&gt; routines;\n\nVOID CountPtr(UINT64 *counter)\n{\n    ++(*counter);\n}\n\nVOID Routine(RTN rtn, VOID*)\n{\n    uint64_t&amp; insn = routines[RTN_Name(rtn)];\n\n    RTN_Open(rtn);\n    for (INS ins = RTN_InsHead(rtn); INS_Valid(ins); ins = INS_Next(ins))\n    {\n        INS_InsertCall(ins, IPOINT_BEFORE, (AFUNPTR)CountPtr, IARG_PTR, &amp;insn, IARG_END);\n    }\n    RTN_Close(rtn);\n}\n\nvoid Fini(INT32, void*)\n{\n    for (const auto&amp; p : routines)\n    {\n        std::cout &lt;&lt; p.first &lt;&lt; \" \" &lt;&lt; p.second &lt;&lt; std::endl;\n    }\n}\n\nint main(int argc, char *argv[])\n{\n    PIN_Init(argc, argv);\n\n    // !NOTE: memcpy does NOT get analyzed with only this call instead: PIN_InitSymbols();\n    PIN_InitSymbolsAlt(SYMBOL_INFO_MODE(UINT32(IFUNC_SYMBOLS) | UINT32(DEBUG_OR_EXPORT_SYMBOLS)));\n\n    RTN_AddInstrumentFunction(Routine, 0);\n    PIN_AddFiniFunction(Fini, 0);\n\n    PIN_StartProgram();\n    return 0;\n}\n</code></pre>\n\n<p>My test binary is just calling <code>memcpy</code> &mdash; again, to simplify things:</p>\n\n<pre><code>// copy.cc\n#include &lt;cstring&gt;\n#include &lt;cstdint&gt;\n\nvoid copy(uint8_t* __restrict dst, uint8_t* __restrict src, std::size_t sz)\n{\n    memcpy(dst, src, sz);\n}\n\n// test.cc\n#include &lt;cstdint&gt;\n\nunsigned char a[128];\nunsigned char b[128];\n\nvoid copy(uint8_t* __restrict, uint8_t* __restrict, std::size_t);\n\nint main()\n{\n    copy(b, a, 128);\n    return 0;\n}\n</code></pre>\n\n<p>When calling it, it shows:</p>\n\n<pre><code>pin -t ./obj-intel64/mytool.so -- /tmp/test | grep memcpy\n__memcpy_chk 0\n__wmemcpy_chk 0\nmemcpy 29\nmemcpy@plt 1\nwmemcpy 0\n</code></pre>\n\n<p>And now, if I replace the call to <code>PIN_InitSymbolsAlt</code> by <code>PIN_InitSymbols</code>, I get...:</p>\n\n<pre><code>$ pin -t ./obj-intel64/mytool.so -- /tmp/test | grep memcpy\n__wmemcpy_chk 0\nmemcpy 0\nmemcpy@plt 1\nwmemcpy 0\n</code></pre>\n\n<p>I find this a bit dodgy to be honest. This feature is not greatly documented, and either I am overlooking something, or this has nothing to do with symbols... The analyze of the <code>memcpy</code> routine simply didn't return any instructions for some reason.</p>\n\n<p>Any ideas on what happened here, and why? Thanks!</p>\n"}, {"tags": ["c++", "language-lawyer"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1548285459, "post_id": 54337044, "comment_id": 95491489, "body": "<a href=\"https://stackoverflow.com/questions/43551665/has-a-stdbyte-pointer-the-same-aliasing-implications-as-char\">It is fine</a>."}, {"owner": {"reputation": 2270, "user_id": 8964493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/569f20d32952eb1847a1c159e95997aa?s=128&d=identicon&r=PG&f=1", "display_name": "joe_chip", "link": "https://stackoverflow.com/users/8964493/joe-chip"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1548285761, "post_id": 54337044, "comment_id": 95491582, "body": "@Hans Passant it would be fine in the opposite case (accessing <code>Header</code> through <code>std::byte*</code>). But here, I think the rules you&#39;ve linked to do not apply."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1548286315, "post_id": 54337044, "comment_id": 95491728, "body": "@curiousguy The memory is allocated with <code>new</code> and is therefore aligned to maximum native alignment. <code>Header</code> is not over-aligned, so there is no problem. Aliasing is still a problem as joe points out."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1548286378, "post_id": 54337044, "comment_id": 95491753, "body": "I forgot that an array of bytes allocated that was guaranteed to be aligned unlike a variable with type array of bytes."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1548335702, "post_id": 54337044, "comment_id": 95510404, "body": "It is unlikely to be a problem with the specific header shown, but in general reading directly from a file into a struct is also unsafe because there might be padding in between the members of the struct that isn&#39;t part of the file format."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548285978, "post_id": 54337135, "comment_id": 95491634, "body": "&quot;<i>This means that the file is not portable to systems with differing CPU architecture.</i>&quot; - that is why you should define which endian is used inside of the file, and then swap the endian of the fields when reading/writing them to/from memory as needed. The OP&#39;s original code would have suffered from this same issue anyway."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548286159, "post_id": 54337135, "comment_id": 95491676, "body": "@RemyLebeau Indeed my suggestion does the same as OP&#39;s original program attempts to do, except in a well defined manner."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1548286660, "post_id": 54337135, "comment_id": 95491817, "body": "One interpretation of modern high level (and crazy) C++ is that you can&#39;t do pointer arithmetic here as you don&#39;t have an array of bytes only one object."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1548289537, "post_id": 54337135, "comment_id": 95492414, "body": "@curiousguy there is no problem with pointer arithmetic here. And you can perform pointer arithmetic on a pointer to an object, not just a pointer to bytes."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548298835, "post_id": 54337135, "comment_id": 95494266, "body": "@RemyLebeau According to some ppl, there is a problem with arithmetic on a pointer to bytes where <b>you have not declared or created (with operator new) an array of bytes</b>: which array are iterating with pointer arithmetic?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1548351758, "post_id": 54337135, "comment_id": 95520306, "body": "@curiousguy I don&#39;t have an exact quote, but the C++ standard allows a pointer-to-object to be casted to a pointer-to-char for the purpose of accessing the object&#39;s raw bytes, which includes pointer arithmetic of those bytes."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1548481651, "post_id": 54337135, "comment_id": 95566095, "body": "&quot;<i>This means that the file is not portable to systems</i>&quot; not good for long term storage, but good for pipes/Unix sockets between processes"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1548285178, "creation_date": 1548285178, "answer_id": 54337135, "question_id": 54337044, "link": "https://stackoverflow.com/questions/54337044/strict-aliasing-and-binary-i-o/54337135#54337135", "title": "Strict aliasing and binary I/O", "body": "<blockquote>\n  <p>The question is: is my interpretation correct?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>If yes, what can be done to fix this code?</p>\n</blockquote>\n\n<p>You already know that memcpy is a solution. You can however skip memcpy and extra memory allocation by reading directly onto the header object:</p>\n\n<pre><code>Header h;\nstream.read(reinterpret_cast&lt;char*&gt;(&amp;h), sizeof h);\n</code></pre>\n\n<hr>\n\n<p>Note that reading binary file this way means that the integer representation of the file must match the representation of the CPU. This means that the file is not portable to systems with differing CPU architecture.</p>\n"}, {"comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1548363657, "post_id": 54347719, "comment_id": 95525561, "body": "As far as I can tell, P0593 would be relevant for reading the representation of a  <code>Header</code> into a storage area allocated with <code>malloc</code> or any other function that creates <i>no</i> objects in the storage area, but <code>std::make_unique&lt;std::byte[]&gt;</code> creates N <code>std::byte</code> (aka <code>unsigned char</code>) objects in the storage area, so the strict aliasing rules <i>are</i> violated."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1548364060, "post_id": 54347719, "comment_id": 95525753, "body": "@zwol The case very similar to OPs case is a motivation for P0593 <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0593r2.html#objects-provided-as-byte-representation\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2018/&hellip;</a>. And P0593 proposes to allow objects appear in a <code>std::byte</code> arrays: &quot;<i>We propose that at minimum the following operations be specified as implicitly creating objects: Creation of an array of char, unsigned char, or std::byte implicitly creates objects within that array.</i>&quot;"}], "tags": [], "owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "is_accepted": false, "score": 0, "last_activity_date": 1548367635, "last_edit_date": 1548367635, "creation_date": 1548336277, "answer_id": 54347719, "question_id": 54337044, "link": "https://stackoverflow.com/questions/54337044/strict-aliasing-and-binary-i-o/54347719#54347719", "title": "Strict aliasing and binary I/O", "body": "<blockquote>\n  <p>what can be done to fix this code?</p>\n</blockquote>\n\n<p>Wait until <a href=\"http://wg21.link/P0593\" rel=\"nofollow noreferrer\">http://wg21.link/P0593</a> or something similar allowing implicit object creation in arrays of <code>char</code>/<code>unsigned char</code>/<code>std::byte</code> is accepted.</p>\n"}], "owner": {"reputation": 2270, "user_id": 8964493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/569f20d32952eb1847a1c159e95997aa?s=128&d=identicon&r=PG&f=1", "display_name": "joe_chip", "link": "https://stackoverflow.com/users/8964493/joe-chip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1548367635, "creation_date": 1548284588, "question_id": 54337044, "link": "https://stackoverflow.com/questions/54337044/strict-aliasing-and-binary-i-o", "title": "Strict aliasing and binary I/O", "body": "<p>Let's consider the following (simplified) code for reading contents of a binary file:</p>\n\n<pre><code>struct Header\n{\n    char signature[8];\n    uint32_t version;\n    uint32_t numberOfSomeChunks;\n    uint32_t numberOfSomeOtherChunks;\n};\n\nvoid readFile(std::istream&amp; stream)\n{\n    // find total size of the file, in bytes:\n    stream.seekg(0, std::ios::end);\n    const std::size_t totalSize = stream.tellg();\n\n    // allocate enough memory and read entire file\n    std::unique_ptr&lt;std::byte[]&gt; fileBuf = std::make_unique&lt;std::byte[]&gt;(totalSize);\n    stream.seekg(0);\n    stream.read(reinterpret_cast&lt;char*&gt;(fileBuf.get()), totalSize);\n\n    // get the header and do something with it:\n    const Header* hdr = reinterpret_cast&lt;const Header*&gt;(fileBuf.get());\n\n    if(hdr-&gt;version != expectedVersion) // &lt;- Potential UB?\n    {\n        // report the error\n    }\n\n    // and so on...\n}\n</code></pre>\n\n<p>The way I see this, the following line:</p>\n\n<pre><code>if(hdr-&gt;version != expectedVersion) // &lt;- Potential UB?\n</code></pre>\n\n<p>contains undefined behavior: we're reading <code>version</code> member of type <code>uint32_t</code> which is overlaid on top of an array of <code>std::byte</code> objects, and compiler is free to assume that <code>uint32_t</code> object does not alias anything else.</p>\n\n<p>The question is: is my interpretation correct? If yes, what can be done to fix this code? If no, why there's no UB here?</p>\n\n<p><strong>Note 1:</strong> I understand the purpose of the strict aliasing rule (allowing compiler to avoid unnecessary loads from memory). Also, I know that in this case using <code>std::memcpy</code> would be a safe solution - but using <code>std::memcpy</code> would mean that we have to do additional memory allocations (on stack, or on heap if size of an object is not known).</p>\n"}, {"tags": ["c++", "arrays", "string", "word-count"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1548285352, "post_id": 54337030, "comment_id": 95491454, "body": "If you must use an array container, prefer <code>std::vector</code>, as it can expand dynamically during run-time."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1548285389, "post_id": 54337030, "comment_id": 95491466, "body": "Search the internet for &quot;c++ transform string tolower&quot;."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1548285630, "post_id": 54337030, "comment_id": 95491545, "body": "This would be much easier with a <code>std::(unordered_)map</code> to track the unique words for you, eg: <code>map&lt;string, int&gt; unique; for(int m = 0; m &lt; wordCount; ++m) { unique[wordArr[m]]++; } cout &lt;&lt; &quot;Unique word count is: &quot; &lt;&lt; unique.size() &lt;&lt; endl;</code> or a <code>set::(unordered_)set</code> instead if you don&#39;t care about tracking how many times each word repeats:  <code>set&lt;string&gt; unique; for(int m = 0; m &lt; wordCount; ++m) { unique.insert(wordArr[m]); } cout &lt;&lt; &quot;Unique word count is: &quot; &lt;&lt; unique.size() &lt;&lt; endl;</code>"}, {"owner": {"reputation": 9, "user_id": 10375096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9255a54fee130fd2f07aeec1d2b4df?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Barry", "link": "https://stackoverflow.com/users/10375096/nathan-barry"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548286204, "post_id": 54337030, "comment_id": 95491695, "body": "@RemyLebeau I tried using the map idea you suggested and I end up getting 55 instead, but the correct unique word count is 52. I&#39;m not sure how maps work exactly so i&#39;m not sure if this has to do with the map, or with the way I set lowercase. Any Ideas?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548289847, "post_id": 54337030, "comment_id": 95492473, "body": "Nathan, What Remy suggested should work. Can you add your version with <code>map</code> at the bottom of the question?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1548290149, "post_id": 54337030, "comment_id": 95492527, "body": "@NathanBarry Then there is a problem with how you are parsing words into <code>wordArr</code> (but you did not show that code). In the sample text you provided, I count (ignoring case and punctuation) 64 total words, and 52 unique words. How many words is your code putting into <code>wordArr</code>? Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that shows exactly how you are processing the sample text and reproduces the issue in action."}, {"owner": {"reputation": 9, "user_id": 10375096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9255a54fee130fd2f07aeec1d2b4df?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Barry", "link": "https://stackoverflow.com/users/10375096/nathan-barry"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548353979, "post_id": 54337030, "comment_id": 95521323, "body": "@RemyLebeau I have updated my post to include to how I can in all the words from the file, ignoring punctuation and anything that isn&#39;t a letter. Any help is greatly appreciated. I apologize for not including it earlier."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548369466, "post_id": 54337030, "comment_id": 95527822, "body": "@NathanBarry As suspected, your parsing code has faulty logic (in fact, it doesn&#39;t even compile). There are logic errors in how you break up words on non-alpha characters, in how you look for and track duplicate words, and even in how you are lower-casting words. In short, this entire code is full of bugs."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10375096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9255a54fee130fd2f07aeec1d2b4df?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Barry", "link": "https://stackoverflow.com/users/10375096/nathan-barry"}, "edited": false, "score": 0, "creation_date": 1548287581, "post_id": 54337386, "comment_id": 95492009, "body": "When I tested this it changes the value to 63, but that is still the wrong value. The correct value being 52."}], "tags": [], "owner": {"reputation": 703, "user_id": 1538065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b582973f08978966f4ec59ced39302?s=128&d=identicon&r=PG", "display_name": "XlbrlX", "link": "https://stackoverflow.com/users/1538065/xlbrlx"}, "is_accepted": false, "score": 0, "last_activity_date": 1548287022, "creation_date": 1548287022, "answer_id": 54337386, "question_id": 54337030, "link": "https://stackoverflow.com/questions/54337030/need-help-fixing-code-to-output-correct-unique-word-count-from-a-file/54337386#54337386", "title": "Need help fixing code to output correct unique word count from a file", "body": "<p>You need to reset the oldWord in each iteration:</p>\n\n<pre><code> //unique count\nstring tempArr[10000];\nint unique=0;\nint oldWord=0;\nfor(int m=0; m&lt;wordCount;m++ ) {\n    for (int n = 0; n &lt; wordCount; n++) {\n        if (wordArr[m] == tempArr[n]) {\n\n\n            oldWord = 1;\n        }\n    }\n    if(oldWord==0){\n        wordArr[m] = tempArr[n];\n        unique++;\n    }\n    // reset the oldWord variable here\n    oldWord=0;\n\n}\ncout &lt;&lt; \"Unique word count is: \" &lt;&lt; unique &lt;&lt; endl;\n</code></pre>\n\n<p>}</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 10375096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9255a54fee130fd2f07aeec1d2b4df?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Barry", "link": "https://stackoverflow.com/users/10375096/nathan-barry"}, "edited": false, "score": 0, "creation_date": 1548369675, "post_id": 54356375, "comment_id": 95527886, "body": "Thank you so much for all of your help! And I appreciate all the time you spent to help me."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 0, "last_activity_date": 1548369288, "creation_date": 1548369288, "answer_id": 54356375, "question_id": 54337030, "link": "https://stackoverflow.com/questions/54337030/need-help-fixing-code-to-output-correct-unique-word-count-from-a-file/54356375#54356375", "title": "Need help fixing code to output correct unique word count from a file", "body": "<p>Your parsing code has faulty logic (in fact, it doesn't even compile).  There are logic errors in how you break up words on non-alpha characters, in how you look for and track duplicate words, and even in how you are lower-casting words.</p>\n\n<p>In short, this entire code is full of bugs that need to be fixed, eg:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;ctype.h&gt;\nusing namespace std;\n\nint main(int argc, char *argv[]) {\n    //File Paths\n    ifstream fp;\n    fp.open(argv[1]);\n    if (!fp.is_open()) {\n        cout &lt;&lt; \"Error No file\" &lt;&lt; endl;\n        return 0;\n    }\n\n    string wordArr[10000];\n    string words;\n    int wordCount = 0;\n    while ((fp &gt;&gt; words) &amp;&amp; (wordCount &lt; 10000)) {\n        for (int i = 0; i &lt; words.length(); ++i) {\n            if (!isalpha(words[i])) {\n                wordArr[wordCount++] = words.substr(0, i);\n                if (wordCount == 10000) break;\n                ++i;\n                while ((i &lt; words.length()) &amp;&amp; (!isalpha(words[i]))) {\n                    ++i;\n                }\n                words.erase(0, i);\n                i = -1;\n            }\n        }\n        if (words.length() &gt; 0) {\n            wordArr[wordCount++] = words;\n        }\n    }\n    cout &lt;&lt; \"Number of words found was: \" &lt;&lt; wordCount &lt;&lt; endl;\n\n    // makes all lower\n    for(int k=0; k&lt;wordCount;k++){ //need to find size of array\n        for(int l=0; l&lt;wordArr[k].length(); l++){\n            wordArr[k][l] = tolower(wordArr[k][l]);\n        }\n    }\n\n    //unique count\n    string tempArr[10000];\n    int unique=0;\n    for(int m=0; m&lt;wordCount;m++ ) {\n        int oldWord=0;\n        for (int n = 0; n &lt; unique; n++) {\n            if (wordArr[m] == tempArr[n]) {\n                oldWord = 1;\n                break;\n            }\n        }\n        if(oldWord==0){\n            tempArr[unique++] = wordArr[m];\n        }\n    }\n    cout &lt;&lt; \"Unique word count is: \" &lt;&lt; unique &lt;&lt; endl;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/Owx5hK\" rel=\"nofollow noreferrer\">Now the code works as expected</a>:</p>\n\n<pre>\nNumber of words found was: 64\nUnique word count is: 52\n</pre>\n"}], "owner": {"reputation": 9, "user_id": 10375096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9255a54fee130fd2f07aeec1d2b4df?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Barry", "link": "https://stackoverflow.com/users/10375096/nathan-barry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 54356375, "answer_count": 2, "score": 0, "last_activity_date": 1548369432, "creation_date": 1548284532, "last_edit_date": 1548369432, "question_id": 54337030, "link": "https://stackoverflow.com/questions/54337030/need-help-fixing-code-to-output-correct-unique-word-count-from-a-file", "title": "Need help fixing code to output correct unique word count from a file", "body": "<p>I am trying to find the unique word count from a text file. But for some reason, my number is always off. My regular word count comes out fine though. </p>\n\n<p>My string Array <code>wordArr</code> contains all the words from the file.</p>\n\n<p>I try assigning every word to another array after it is found to be not unique, then I go through the list of words that I have already been through to see if it matches the current word being shown. If the words match I set <code>oldWord</code> to true and the word is not counted toward my <code>unique</code> count.</p>\n\n<pre><code>//New portion\nint main(int argc, char *argv[]) {\n    //File Paths\n    ifstream fp;\n    fp.open(argv[1]);\n    if (fp.fail()) {\n        cout &lt;&lt; \"Error No file\" &lt;&lt; endl;\n        return 0;\n    }\n    string wordArr[10000];\n    string words;\n    string temp;\n    int wordCount = 0;\n\n\n    while (fp &gt;&gt; words) {\n        int newWord = 0;\n        for (int i; i &lt; words.length(); i++) {\n            if (isalpha(words[i])) {\n\n            } else {\n                wordArr[wordCount++] = words.substr(0, i);\n                //wordCount++;\n                newWord = 1;\n                if(words[i] + 1 != '\\0') {\n                    for (int j = i + 1; j &lt;  words.length(); j++) {\n                        temp = temp +words[j];\n                    }\n                    wordArr[wordCount++] = temp;\n                    //wordCount++;\n                }\n\n            }\n\n        }\n        if (newWord == 0) {\n            wordArr[wordCount] = words;\n            wordCount++;\n        }\n    }\n    cout &lt;&lt; \"Number of words found was: \" &lt;&lt; wordCount &lt;&lt; endl;\n    //New portion\n\n\n    // makes all lower\n    for(int k=0; k&lt;wordCount;k++){ //need to find size of array\n        for(int l=0; l&lt;wordArr[k].length(); l++){\n            tolower(wordArr[k].at(l));\n        }\n\n    }\n\n\n\n    //unique count\n    string tempArr[10000];\n    int unique=0;\n    int oldWord=0;\n    for(int m=0; m&lt;wordCount;m++ ) {\n        for (int n = 0; n &lt; wordCount; n++) {\n            if (wordArr[m] == tempArr[n]) {\n\n\n                oldWord = 1;\n            }\n        }\n        if(oldWord==0){\n            wordArr[m] = tempArr[n];\n            unique++;\n        }\n    }\n    cout &lt;&lt; \"Unique word count is: \" &lt;&lt; unique &lt;&lt; endl;\n}\n</code></pre>\n\n<p>I expect to get 52 unique words from my test case, but end up only getting 37.</p>\n\n<p>Test case:</p>\n\n<blockquote>\n  <p>Cryptography is both the practice and study of the techniques used to\n  communicate and/or store information or data privately and\n  securely, without being intercepted by third parties. This can include\n  processes such as encryption, hashing, and steganography. Until the\n  modern era, cryptography almost exclusively referred to encryption, but\n  now cryptography is a broad field with applications in many critical\n  areas of our lives.</p>\n</blockquote>\n"}, {"tags": ["c++", "enums"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548284288, "post_id": 54336932, "comment_id": 95491142, "body": "<code>enum book stories {</code> will cause a syntax error. Otherwise I can&#39;t see any issue with using multiple enums in a single translation unit, as long the enum tokens aren&#39;t ambigouus, or you use scoped enums."}], "answers": [{"tags": [], "owner": {"reputation": 1229, "user_id": 9226753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28247b27eef49240c767833514e2ab50?s=128&d=identicon&r=PG&f=1", "display_name": "kanstar", "link": "https://stackoverflow.com/users/9226753/kanstar"}, "is_accepted": false, "score": 2, "last_activity_date": 1548284318, "creation_date": 1548284318, "answer_id": 54336987, "question_id": 54336932, "link": "https://stackoverflow.com/questions/54336932/multiple-enumerations/54336987#54336987", "title": "Multiple enumerations", "body": "<p>Yes. The enumeration <code>NONE</code> is present in both <code>element</code> and <code>book stories</code> (btw, you cannot name your enums with a space inside).</p>\n\n<h3>enum class</h3>\n\n<p>Use <code>enum class</code>es if you want to use <code>NONE</code> in both enumerations.</p>\n\n<pre><code>enum class element \n{\n    ICE, FIRE, EARTH, WIND, NONE\n};\n\nenum class bookstories \n{\n    FK, IK, EK, WK, NONE\n};\n</code></pre>\n\n<p>Then you use your enum like this:</p>\n\n<pre><code>auto elem  = element::NONE;\nauto story = bookstories::NONE;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10949373, "user_type": "registered", "profile_image": "https://graph.facebook.com/429064581248609/picture?type=large", "display_name": "Guraiya", "link": "https://stackoverflow.com/users/10949373/guraiya"}, "edited": false, "score": 0, "creation_date": 1548284866, "post_id": 54337047, "comment_id": 95491307, "body": "The entire progam is made in c++ so I will stick with the tip from @Serkan T."}], "tags": [], "owner": {"reputation": 1465, "user_id": 5122006, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d5d9f38947aef246351984de8786ce8c?s=128&d=identicon&r=PG&f=1", "display_name": "okovko", "link": "https://stackoverflow.com/users/5122006/okovko"}, "is_accepted": false, "score": 0, "last_activity_date": 1548284595, "creation_date": 1548284595, "answer_id": 54337047, "question_id": 54336932, "link": "https://stackoverflow.com/questions/54336932/multiple-enumerations/54337047#54337047", "title": "Multiple enumerations", "body": "<p>This is most generally solved by doing this:</p>\n\n<pre><code>typedef enum element_e {\n  E_ELEMENT_ERROR = -1,\n  E_ELEMENT_NONE,\n  /* ... */\n} element_t;\n\ntypedef enum bookstories_e {\n  E_BOOKSTORIES_ERROR = -1,\n  E_BOOKSTORIES_NONE,\n  /* ... */\n} bookstories_t;\n</code></pre>\n\n<p>So you can maintain C / C++ interop in your header files. If you don't have any C modules, use enum classes like the other answers describe.</p>\n"}, {"tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 1, "last_activity_date": 1548284774, "creation_date": 1548284774, "answer_id": 54337076, "question_id": 54336932, "link": "https://stackoverflow.com/questions/54336932/multiple-enumerations/54337076#54337076", "title": "Multiple enumerations", "body": "<p>Leaving the syntax error caused by <code>book stories</code> aside, you can make your <code>enum</code> declarations unambigous by putting them into a scope:</p>\n\n<pre><code>struct Elements {\n    enum element {\n        ICE, FIRE, EARTH, WIND, NONE\n    };\n};\n\nstruct BookStories {\n    enum book_stories {\n        FK, IK, EK, WK, NONE\n    };\n};\n</code></pre>\n\n<p>Referring to <code>Elements::NONE</code> and <code>BookStories::NONE</code> would be unambigous then.</p>\n\n<hr>\n\n<p>Another way to make enums scoped is to use <code>enum class</code> (since c++11):</p>\n\n<pre><code>enum class element {\n    ICE, FIRE, EARTH, WIND, NONE\n};\n\nenum class book_stories {\n    FK, IK, EK, WK, NONE\n};\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10949373, "user_type": "registered", "profile_image": "https://graph.facebook.com/429064581248609/picture?type=large", "display_name": "Guraiya", "link": "https://stackoverflow.com/users/10949373/guraiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1548284774, "creation_date": 1548284037, "question_id": 54336932, "link": "https://stackoverflow.com/questions/54336932/multiple-enumerations", "title": "Multiple enumerations", "body": "<p>I was wondering if I could use different enumerations in the same file where one is already present?</p>\n\n<p>For this project I have elements which act as a genre for a number of books. I want to create different story's for the books and create a 2nd enum for them. </p>\n\n<pre><code>enum element {\n    ICE, FIRE, EARTH, WIND, NONE\n};\nenum book stories {\n    FK, IK, EK, WK, NONE\n};\n</code></pre>\n\n<p>could this start issues with my compiler?</p>\n"}, {"tags": ["c++", "googletest", "googlemock"], "answers": [{"tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": true, "score": 1, "last_activity_date": 1548286801, "creation_date": 1548286801, "answer_id": 54337365, "question_id": 54336916, "link": "https://stackoverflow.com/questions/54336916/mocking-class-with-no-virtual-methods/54337365#54337365", "title": "Mocking class with no virtual methods", "body": "<p>There may be a way, but it's not as nice as the simple way of overriding a virtual function.</p>\n\n<p>First, if the function is not virtual and is inline, you're likely out of luck.  When the compiler saw a call to <code>obj.Add()</code> or <code>ptr-&gt;Add()</code>, the fact the function is not virtual means it didn't need to worry about the possibility some function other than <code>Test::Add()</code> might need to be the one actually called.  So it most likely either directly inlined the code from the definition of <code>Add</code>, in which case replacing it is near impossible, or it put a weakly-linked copy of the <code>Test::Add()</code> into the same object file as the function calling it.  In that second case, you might be able to replace it using linker tricks, depending on the platform you're using - until later the compiler switches to deciding to inline it after all.</p>\n\n<p>If it's just the class <code>Test</code> you don't want to modify, but you're okay with changing the code that uses <code>Test</code> as a dependency and will be tested by the unit test, you could do template dependency injection.  But the question sounds like you probably don't want to modify that code either.</p>\n\n<p>Now assuming the function is not inline, and is defined in some file \"Test.cpp\", and the class is polymorphic (which it is in the example because of the virtual destructor) you can replace all the definitions from that file, to make them act as though they were virtual even if they're not:</p>\n\n<ol>\n<li><p>Write the Google Mock class as usual, with the functions you want to be able to detect mocked.</p>\n\n<pre><code>#include \"Test.hpp\"\n#include &lt;gmock/gmock.h&gt;\n\nclass MockTest : public Test\n{\npublic:\n    MOCK_METHOD0(Add, int());\n    MOCK_CONST_METHOD0(Print, void());\n};\n</code></pre></li>\n</ol>\n\n<p>(I've added a const method to the example, to show how to deal with them also.)</p>\n\n<ol start=\"2\">\n<li><p>In the same unit test code, write definitions for the mocked functions like this.</p>\n\n<pre><code>int Test::Add()\n{\n    if (auto* mock = dynamic_cast&lt;MockTest*&gt;(this))\n        return mock-&gt;Add();\n    // Next comes what to do if the code ever calls Add on\n    // a Test which is not actually a MockTest. This could\n    // be a stub implementation, an actual implementation, or\n    // could intentionally terminate, throw, or note a gtest error.\n    ADD_FAILURE() &lt;&lt; \"Test is not a MockTest\";\n    return 0;\n}\n\nvoid Test::Print() const\n{\n    if (auto* mock = dynamic_cast&lt;const MockTest*&gt;(this)) {\n        mock-&gt;Print();\n        return;\n    }\n    ADD_FAILURE() &lt;&lt; \"Test is not a MockTest\";\n}\n</code></pre></li>\n</ol>\n\n<p>You may also need to write at least stubs for other definitions in the Test.cpp file to make the linker happy.  This doesn't necessarily mean they would actually get called or otherwise used.</p>\n\n<ol start=\"3\">\n<li>When linking the unit test, make sure the real Test.cpp file is NOT provided.  If it's normally part of a library, you may need to list out the other files from that library on the command line.  This might lead to dependency order issues and/or circular dependency issues.  GNU's linker has \"-Wl,--start-group ... -Wl,--end-group\" to deal circular link issues by repeatedly trying some objects and/or libraries in a loop until as much as possible has been resolved; I'm not sure about other systems.</li>\n</ol>\n"}], "owner": {"reputation": 23, "user_id": 4385572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff39602085aff9da148ffbfc30442af6?s=128&d=identicon&r=PG&f=1", "display_name": "tech 1990", "link": "https://stackoverflow.com/users/4385572/tech-1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1067, "favorite_count": 1, "closed_date": 1548288739, "accepted_answer_id": 54337365, "answer_count": 1, "score": 1, "last_activity_date": 1548286801, "creation_date": 1548283944, "question_id": 54336916, "link": "https://stackoverflow.com/questions/54336916/mocking-class-with-no-virtual-methods", "closed_reason": "Duplicate", "title": "Mocking class with no virtual methods", "body": "<p>I have just started to use google mock for unit testing production code. The classes I want to mock have no virtual methods inside. From reading a little on google mock, is it not possible to mock a class like this? Bear in mind I don't want to make any changes to the source.</p>\n\n<pre><code>class Test\n{\n    Test(void);\n    virtual ~Test() {}\n    Add();\n};\n\nint Test::Add()\n{\n    return 1;\n}\n\nclass MockTest : public Test\n{\npublic:\n    MOCK_METHOD0(Add,int(void));\n};\n</code></pre>\n"}, {"tags": ["c++", "kernel", "julia", "opencl", "arrayfire"], "comments": [{"owner": {"reputation": 393, "user_id": 8601080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oWtzO.jpg?s=128&g=1", "display_name": "4lrdyD", "link": "https://stackoverflow.com/users/8601080/4lrdyd"}, "edited": false, "score": 0, "creation_date": 1549490455, "post_id": 54336892, "comment_id": 95925337, "body": "I defined a <code>BLOCK_SIZE</code> of 32 (<code>#define BLOCK_SIZE 32</code>), I did some tests and the maximum matrix size that the function handles correctly depends on the <code>BLOCK_SIZE</code> that I have defined, for example, if <code>BLOCK_SIZE</code> is equal to <code>n</code>, the maximum matrix size is <code>(nxn) x (nxn)</code>, where <code>nxn</code> is the size of a thread block, i.e., the function seems to work only in a group (or block), and when the matrix is \u200b\u200blarger, the function stops working correctly"}, {"owner": {"reputation": 393, "user_id": 8601080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oWtzO.jpg?s=128&g=1", "display_name": "4lrdyD", "link": "https://stackoverflow.com/users/8601080/4lrdyd"}, "edited": false, "score": 0, "creation_date": 1551213309, "post_id": 54336892, "comment_id": 96556451, "body": "I was investigating, a problem is that global synchronization is not possible, so the solution is correct only to reach the size of a block, knowing this, I modified the kernel code that work only with one group, but, it works relatively correct, although better than the code above, however still show <code>ArgumentError: cannot convert NULL to string</code> in large arrays"}], "owner": {"reputation": 393, "user_id": 8601080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oWtzO.jpg?s=128&g=1", "display_name": "4lrdyD", "link": "https://stackoverflow.com/users/8601080/4lrdyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548283803, "creation_date": 1548283803, "question_id": 54336892, "link": "https://stackoverflow.com/questions/54336892/julia-calling-a-arrayfire-customized-function-that-use-customized-kernels-argu", "title": "Julia: calling a ArrayFire customized function that use customized kernels, ArgumentError: cannot convert NULL to string", "body": "<p>I have a customized kernel and his respective customized ArrayFire function, I  wanna call this function from Julia, but when I do that with relative large arrays I get: <code>ArgumentError: cannot convert NULL to string</code>,  I know this can be limited depending on the type of GPU, but the trouble is that this limit varies when I change the kernel, for instance.</p>\n\n<p><strong>Kernel (Gauss_Jordan_f Kernel)</strong></p>\n\n<hr>\n\n<pre><code>#pragma OPENCL EXTENSION cl_khr_fp64 : enable\n__kernel void\nGauss_Jordan_f(__global double* A, __global double* B, int gsize)\n{\n    int tx = get_global_id(0);\n    if (tx &gt;= gsize)\n    {\n        return;\n    }\n    int Rfirst = tx * gsize;\n    double diag;\n    double fm;\n\n    for (int i = 0; i &lt; gsize; i++)\n    {\n        diag = A[i*gsize + i];\n\n        if (tx != i &amp;&amp; diag != 0)\n        {\n            fm = A[Rfirst + i] / diag;\n            B[tx] -= fm * B[i];\n\n            for (int j = i + 1; j &lt; gsize; j++)\n            {\n                A[Rfirst + j] -= fm * A[i*gsize + j];\n            }\n        }\n\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n\n    barrier(CLK_LOCAL_MEM_FENCE);\n\n    B[tx] /= A[Rfirst + tx];\n}\n</code></pre>\n\n<p><strong>Function (Function with af::array arguments that use Gauss_Jordan_f Kernel)</strong></p>\n\n<hr>\n\n<pre><code>void AFire::SELgj_(af::array &amp;A, af::array &amp;B) {\n\n    static cl_context af_context = afcl::getContext();\n    static cl_device_id af_device_id = afcl::getDeviceId();\n    static cl_command_queue af_queue = afcl::getQueue();\n\n    cl_mem * d_A = A.device&lt;cl_mem&gt;();\n    cl_mem * d_B = B.device&lt;cl_mem&gt;();\n\n    size_t order = (int)A.dims(0);\n\n    size_t program_length = strlen(GJordan_source);\n    int status = CL_SUCCESS;\n\n    cl_program program = clCreateProgramWithSource(af_context, 1, (const char **)&amp;GJordan_source, &amp;program_length, &amp;status);\n    status = clBuildProgram(program, 1, &amp;af_device_id, NULL, NULL, NULL);\n    cl_kernel kernel = clCreateKernel(program, \"Gauss_Jordan_f\", &amp;status);\n\n    clSetKernelArg(kernel, 0, sizeof(cl_mem), d_A);\n    clSetKernelArg(kernel, 1, sizeof(cl_mem), d_B);\n    clSetKernelArg(kernel, 2, sizeof(cl_int), &amp;order);\n\n    size_t localWorkSize = BLOCK_SIZE * BLOCK_SIZE;\n    size_t globalWorkSize = shrRoundUp(localWorkSize, order);\n\n    clEnqueueNDRangeKernel(af_queue, kernel, 1, 0, &amp;globalWorkSize, &amp;localWorkSize,\n        0, NULL, NULL);\n\n    A.unlock();\n    B.unlock();\n}\n</code></pre>\n\n<p><strong>Calling from Julia</strong></p>\n\n<hr>\n\n<p><code>A</code> is an <code>AFArray: 2000\u00d72000 Array{Float64,2}</code> and <code>B</code> a vector compatible with A (size 2000), I know the system is compatible and I know the solution, but:</p>\n\n<pre><code> ccall((:SELgj_,\"path/to/dll\")\n         ,Cvoid,(Ref{af_array},Ref{af_array}),Af.arr,Df.arr)\n</code></pre>\n\n<p>It seems to end well, however:</p>\n\n<pre><code>Df\n\nArgumentError: cannot convert NULL to string\n\nStacktrace:\n [1] unsafe_string at .\\strings\\string.jl:56 [inlined]\n [2] unsafe_string at .\\c.jl:193 [inlined]\n [3] get_last_error at C:\\Users\\user\\.julia\\packages\\ArrayFire\\4SkOz\\src\\util.jl:299 [inlined]\n [4] _error(::UInt32) at C:\\Users\\user\\.julia\\packages\\ArrayFire\\4SkOz\\src\\util.jl:86\n [5] convert_array(::AFArray{Float64,2}) at C:\\Users\\user\\.julia\\packages\\ArrayFire\\4SkOz\\src\\wrap.jl:748\n [6] Type at C:\\Users\\user\\.julia\\packages\\ArrayFire\\4SkOz\\src\\array.jl:32 [inlined]\n [7] toa(::AFArray{Float64,2}) at C:\\Users\\user\\.julia\\packages\\ArrayFire\\4SkOz\\src\\util.jl:37\n [8] show(::IOContext{Base.GenericIOBuffer{Array{UInt8,1}}}, ::MIME{Symbol(\"text/plain\")}, ::AFArray{Float64,2}) at C:\\Users\\user\\.julia\\packages\\ArrayFire\\4SkOz\\src\\util.jl:41\n [9] limitstringmime(::MIME{Symbol(\"text/plain\")}, ::AFArray{Float64,2}) at C:\\Users\\user\\.julia\\packages\\IJulia\\GIANC\\src\\inline.jl:37\n [10] display_mimestring(::MIME{Symbol(\"text/plain\")}, ::AFArray{Float64,2}) at C:\\Users\\user\\.julia\\packages\\IJulia\\GIANC\\src\\display.jl:66\n [11] display_dict(::AFArray{Float64,2}) at C:\\Users\\user\\.julia\\packages\\IJulia\\GIANC\\src\\display.jl:95\n [12] #invokelatest#1 at .\\essentials.jl:697 [inlined]\n [13] invokelatest at .\\essentials.jl:696 [inlined]\n [14] execute_request(::ZMQ.Socket, ::Msg) at C:\\Users\\user\\.julia\\packages\\IJulia\\GIANC\\src\\execute_request.jl:95\n [15] #invokelatest#1 at .\\essentials.jl:697 [inlined]\n [16] invokelatest at .\\essentials.jl:696 [inlined]\n [17] eventloop(::ZMQ.Socket) at C:\\Users\\user\\.julia\\packages\\IJulia\\GIANC\\src\\eventloop.jl:8\n [18] (::getfield(IJulia, Symbol(\"##15#18\")))() at .\\task.jl:259\n</code></pre>\n\n<p>and from here I can no longer create or modify ArrayFire objects, This function works well up to a maximum size of 1000, however I have other functions and kernels that works well with larger sizes, and I don't know why this varies.</p>\n\n<p><strong>ArrayFire details</strong></p>\n\n<pre><code>ArrayFire v3.6.1 (OpenCL, 64-bit Windows, build b443e14)\n[0] NVIDIA: GeForce GT 630M, 2048 MB\n-1- INTEL: Intel(R) HD Graphics 4000, 1400 MB\n-2- INTEL: Intel(R) Core(TM) i7-3630QM CPU @ 2.40GHz, 6037 MB\n</code></pre>\n\n<p><strong>OpenCL details</strong></p>\n\n<pre><code>ocldevicequery\n[ocldevicequery] starting...\n\nocldevicequery Starting...\n\nOpenCL SW Info:\n\n CL_PLATFORM_NAME:      NVIDIA CUDA\n CL_PLATFORM_VERSION:   OpenCL 1.2 CUDA 9.1.84\n OpenCL SDK Revision:   7027912\n\n\nOpenCL Device Info:\n\n 1 devices found supporting OpenCL:\n\n ---------------------------------\n Device GeForce GT 630M\n ---------------------------------\n  CL_DEVICE_NAME:                       GeForce GT 630M\n  CL_DEVICE_VENDOR:                     NVIDIA Corporation\n  CL_DRIVER_VERSION:                    391.35\n  CL_DEVICE_VERSION:                    OpenCL 1.1 CUDA\n  CL_DEVICE_OPENCL_C_VERSION:           OpenCL C 1.1\n  CL_DEVICE_TYPE:                       CL_DEVICE_TYPE_GPU\n  CL_DEVICE_MAX_COMPUTE_UNITS:          2\n  CL_DEVICE_MAX_WORK_ITEM_DIMENSIONS:   3\n  CL_DEVICE_MAX_WORK_ITEM_SIZES:        1024 / 1024 / 64\n  CL_DEVICE_MAX_WORK_GROUP_SIZE:        1024\n  CL_DEVICE_MAX_CLOCK_FREQUENCY:        950 MHz\n  CL_DEVICE_ADDRESS_BITS:               64\n  CL_DEVICE_MAX_MEM_ALLOC_SIZE:         512 MByte\n  CL_DEVICE_GLOBAL_MEM_SIZE:            2048 MByte\n  CL_DEVICE_ERROR_CORRECTION_SUPPORT:   no\n  CL_DEVICE_LOCAL_MEM_TYPE:             local\n  CL_DEVICE_LOCAL_MEM_SIZE:             48 KByte\n  CL_DEVICE_MAX_CONSTANT_BUFFER_SIZE:   64 KByte\n  CL_DEVICE_QUEUE_PROPERTIES:           CL_QUEUE_OUT_OF_ORDER_EXEC_MODE_ENABLE\n  CL_DEVICE_QUEUE_PROPERTIES:           CL_QUEUE_PROFILING_ENABLE\n  CL_DEVICE_IMAGE_SUPPORT:              1\n  CL_DEVICE_MAX_READ_IMAGE_ARGS:        128\n  CL_DEVICE_MAX_WRITE_IMAGE_ARGS:       8\n  CL_DEVICE_SINGLE_FP_CONFIG:           denorms INF-quietNaNs round-to-nearest round-to-zero round-to-inf fma\n\n  CL_DEVICE_IMAGE &lt;dim&gt;                 2D_MAX_WIDTH     16384\n                                        2D_MAX_HEIGHT    16384\n                                        3D_MAX_WIDTH     2048\n                                        3D_MAX_HEIGHT    2048\n                                        3D_MAX_DEPTH     2048\n\n  CL_DEVICE_EXTENSIONS:                 cl_khr_global_int32_base_atomics\n                                        cl_khr_global_int32_extended_atomics\n                                        cl_khr_local_int32_base_atomics\n                                        cl_khr_local_int32_extended_atomics\n                                        cl_khr_fp64\n                                        cl_khr_byte_addressable_store\n                                        cl_khr_icd\n                                        cl_khr_gl_sharing\n                                        cl_nv_compiler_options\n                                        cl_nv_device_attribute_query\n                                        cl_nv_pragma_unroll\n                                        cl_nv_d3d10_sharing\n                                        cl_khr_d3d10_sharing\n                                        cl_nv_d3d11_sharing\n                                        cl_nv_copy_opts\n\n\n  CL_DEVICE_COMPUTE_CAPABILITY_NV:      2.1\n  NUMBER OF MULTIPROCESSORS:            2\n  NUMBER OF CUDA CORES:                 96\n  CL_DEVICE_REGISTERS_PER_BLOCK_NV:     32768\n  CL_DEVICE_WARP_SIZE_NV:               32\n  CL_DEVICE_GPU_OVERLAP_NV:             CL_TRUE\n  CL_DEVICE_KERNEL_EXEC_TIMEOUT_NV:     CL_TRUE\n  CL_DEVICE_INTEGRATED_MEMORY_NV:       CL_FALSE\n  CL_DEVICE_PREFERRED_VECTOR_WIDTH_&lt;t&gt;  CHAR 1, SHORT 1, INT 1, LONG 1, FLOAT 1, DOUBLE 1\n\n\n  ---------------------------------\n  2D Image Formats Supported (71)\n  ---------------------------------\n  #     Channel Order   Channel Type\n\n  1     CL_R            CL_FLOAT\n  2     CL_R            CL_HALF_FLOAT\n  3     CL_R            CL_UNORM_INT8\n  4     CL_R            CL_UNORM_INT16\n  5     CL_R            CL_SNORM_INT16\n  6     CL_R            CL_SIGNED_INT8\n  7     CL_R            CL_SIGNED_INT16\n  8     CL_R            CL_SIGNED_INT32\n  9     CL_R            CL_UNSIGNED_INT8\n  10    CL_R            CL_UNSIGNED_INT16\n  11    CL_R            CL_UNSIGNED_INT32\n  12    CL_A            CL_FLOAT\n  13    CL_A            CL_HALF_FLOAT\n  14    CL_A            CL_UNORM_INT8\n  15    CL_A            CL_UNORM_INT16\n  16    CL_A            CL_SNORM_INT16\n  17    CL_A            CL_SIGNED_INT8\n  18    CL_A            CL_SIGNED_INT16\n  19    CL_A            CL_SIGNED_INT32\n  20    CL_A            CL_UNSIGNED_INT8\n  21    CL_A            CL_UNSIGNED_INT16\n  22    CL_A            CL_UNSIGNED_INT32\n  23    CL_RG           CL_FLOAT\n  24    CL_RG           CL_HALF_FLOAT\n  25    CL_RG           CL_UNORM_INT8\n  26    CL_RG           CL_UNORM_INT16\n  27    CL_RG           CL_SNORM_INT16\n  28    CL_RG           CL_SIGNED_INT8\n  29    CL_RG           CL_SIGNED_INT16\n  30    CL_RG           CL_SIGNED_INT32\n  31    CL_RG           CL_UNSIGNED_INT8\n  32    CL_RG           CL_UNSIGNED_INT16\n  33    CL_RG           CL_UNSIGNED_INT32\n  34    CL_RA           CL_FLOAT\n  35    CL_RA           CL_HALF_FLOAT\n  36    CL_RA           CL_UNORM_INT8\n  37    CL_RA           CL_UNORM_INT16\n  38    CL_RA           CL_SNORM_INT16\n  39    CL_RA           CL_SIGNED_INT8\n  40    CL_RA           CL_SIGNED_INT16\n  41    CL_RA           CL_SIGNED_INT32\n  42    CL_RA           CL_UNSIGNED_INT8\n  43    CL_RA           CL_UNSIGNED_INT16\n  44    CL_RA           CL_UNSIGNED_INT32\n  45    CL_RGBA         CL_FLOAT\n  46    CL_RGBA         CL_HALF_FLOAT\n  47    CL_RGBA         CL_UNORM_INT8\n  48    CL_RGBA         CL_UNORM_INT16\n  49    CL_RGBA         CL_SNORM_INT16\n  50    CL_RGBA         CL_SIGNED_INT8\n  51    CL_RGBA         CL_SIGNED_INT16\n  52    CL_RGBA         CL_SIGNED_INT32\n  53    CL_RGBA         CL_UNSIGNED_INT8\n  54    CL_RGBA         CL_UNSIGNED_INT16\n  55    CL_RGBA         CL_UNSIGNED_INT32\n  56    CL_BGRA         CL_UNORM_INT8\n  57    CL_BGRA         CL_SIGNED_INT8\n  58    CL_BGRA         CL_UNSIGNED_INT8\n  59    CL_ARGB         CL_UNORM_INT8\n  60    CL_ARGB         CL_SIGNED_INT8\n  61    CL_ARGB         CL_UNSIGNED_INT8\n  62    CL_INTENSITY    CL_FLOAT\n  63    CL_INTENSITY    CL_HALF_FLOAT\n  64    CL_INTENSITY    CL_UNORM_INT8\n  65    CL_INTENSITY    CL_UNORM_INT16\n  66    CL_INTENSITY    CL_SNORM_INT16\n  67    CL_LUMINANCE    CL_FLOAT\n  68    CL_LUMINANCE    CL_HALF_FLOAT\n  69    CL_LUMINANCE    CL_UNORM_INT8\n  70    CL_LUMINANCE    CL_UNORM_INT16\n  71    CL_LUMINANCE    CL_SNORM_INT16\n\n  ---------------------------------\n  3D Image Formats Supported (71)\n  ---------------------------------\n  #     Channel Order   Channel Type\n\n  1     CL_R            CL_FLOAT\n  2     CL_R            CL_HALF_FLOAT\n  3     CL_R            CL_UNORM_INT8\n  4     CL_R            CL_UNORM_INT16\n  5     CL_R            CL_SNORM_INT16\n  6     CL_R            CL_SIGNED_INT8\n  7     CL_R            CL_SIGNED_INT16\n  8     CL_R            CL_SIGNED_INT32\n  9     CL_R            CL_UNSIGNED_INT8\n  10    CL_R            CL_UNSIGNED_INT16\n  11    CL_R            CL_UNSIGNED_INT32\n  12    CL_A            CL_FLOAT\n  13    CL_A            CL_HALF_FLOAT\n  14    CL_A            CL_UNORM_INT8\n  15    CL_A            CL_UNORM_INT16\n  16    CL_A            CL_SNORM_INT16\n  17    CL_A            CL_SIGNED_INT8\n  18    CL_A            CL_SIGNED_INT16\n  19    CL_A            CL_SIGNED_INT32\n  20    CL_A            CL_UNSIGNED_INT8\n  21    CL_A            CL_UNSIGNED_INT16\n  22    CL_A            CL_UNSIGNED_INT32\n  23    CL_RG           CL_FLOAT\n  24    CL_RG           CL_HALF_FLOAT\n  25    CL_RG           CL_UNORM_INT8\n  26    CL_RG           CL_UNORM_INT16\n  27    CL_RG           CL_SNORM_INT16\n  28    CL_RG           CL_SIGNED_INT8\n  29    CL_RG           CL_SIGNED_INT16\n  30    CL_RG           CL_SIGNED_INT32\n  31    CL_RG           CL_UNSIGNED_INT8\n  32    CL_RG           CL_UNSIGNED_INT16\n  33    CL_RG           CL_UNSIGNED_INT32\n  34    CL_RA           CL_FLOAT\n  35    CL_RA           CL_HALF_FLOAT\n  36    CL_RA           CL_UNORM_INT8\n  37    CL_RA           CL_UNORM_INT16\n  38    CL_RA           CL_SNORM_INT16\n  39    CL_RA           CL_SIGNED_INT8\n  40    CL_RA           CL_SIGNED_INT16\n  41    CL_RA           CL_SIGNED_INT32\n  42    CL_RA           CL_UNSIGNED_INT8\n  43    CL_RA           CL_UNSIGNED_INT16\n  44    CL_RA           CL_UNSIGNED_INT32\n  45    CL_RGBA         CL_FLOAT\n  46    CL_RGBA         CL_HALF_FLOAT\n  47    CL_RGBA         CL_UNORM_INT8\n  48    CL_RGBA         CL_UNORM_INT16\n  49    CL_RGBA         CL_SNORM_INT16\n  50    CL_RGBA         CL_SIGNED_INT8\n  51    CL_RGBA         CL_SIGNED_INT16\n  52    CL_RGBA         CL_SIGNED_INT32\n  53    CL_RGBA         CL_UNSIGNED_INT8\n  54    CL_RGBA         CL_UNSIGNED_INT16\n  55    CL_RGBA         CL_UNSIGNED_INT32\n  56    CL_BGRA         CL_UNORM_INT8\n  57    CL_BGRA         CL_SIGNED_INT8\n  58    CL_BGRA         CL_UNSIGNED_INT8\n  59    CL_ARGB         CL_UNORM_INT8\n  60    CL_ARGB         CL_SIGNED_INT8\n  61    CL_ARGB         CL_UNSIGNED_INT8\n  62    CL_INTENSITY    CL_FLOAT\n  63    CL_INTENSITY    CL_HALF_FLOAT\n  64    CL_INTENSITY    CL_UNORM_INT8\n  65    CL_INTENSITY    CL_UNORM_INT16\n  66    CL_INTENSITY    CL_SNORM_INT16\n  67    CL_LUMINANCE    CL_FLOAT\n  68    CL_LUMINANCE    CL_HALF_FLOAT\n  69    CL_LUMINANCE    CL_UNORM_INT8\n  70    CL_LUMINANCE    CL_UNORM_INT16\n  71    CL_LUMINANCE    CL_SNORM_INT16\n\noclDeviceQuery, Platform Name = NVIDIA CUDA, Platform Version = OpenCL 1.2 CUDA 9.1.84, SDK Revision = 7027912, NumDevs = 1, Device = GeForce GT 630M\n\nSystem Info:\n\n Local Time/Date = 17:37:54, 1/23/2019\n CPU Arch: 9\n CPU Level: 6\n # of CPU processors: 8\n Windows Build: 9200\n Windows Ver: 6.2 (Windows Vista / Windows 7)\n\n\n[ocldevicequery] test results...\nPASSED\n</code></pre>\n"}, {"tags": ["c++", "c++11", "constructor-overloading"], "comments": [{"owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "edited": false, "score": 0, "creation_date": 1548325446, "post_id": 54336756, "comment_id": 95504280, "body": "I mean, I&#39;d say that this highly depends on the context. In your very example, you put in default objects, and I wonder why, if that does the job, you don&#39;t simply write a single constructor with default values, like <code>A(obj c, obj b = defaultb, obj a = defaulta)</code>."}, {"owner": {"reputation": 676, "user_id": 8340131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213822252052614/picture?type=large", "display_name": "Johnathan Gross", "link": "https://stackoverflow.com/users/8340131/johnathan-gross"}, "reply_to_user": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "edited": false, "score": 0, "creation_date": 1548527648, "post_id": 54336756, "comment_id": 95576082, "body": "Like I said,I can&#39;t rearrange them all to use default constructors. For example, if I have a constructor with three parameters, I have default values for 2 of them, but I may need to specify one or the other."}], "owner": {"reputation": 676, "user_id": 8340131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213822252052614/picture?type=large", "display_name": "Johnathan Gross", "link": "https://stackoverflow.com/users/8340131/johnathan-gross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548327315, "creation_date": 1548282964, "last_edit_date": 1548320283, "question_id": 54336756, "link": "https://stackoverflow.com/questions/54336756/when-delegating-constructors-is-it-better-to-chain-or-have-every-constructor-ca", "title": "When delegating constructors, is it better to chain or have every constructor call one generic constructor?", "body": "<p>I have a class with many possible combinations of parameters in the constructor that prevents simply listing all of them as default parameters. I can either chain constructor calls like this:</p>\n\n<pre><code>class A{\n    A(obj a, obj b, obj c){/*code*/}\n    A(obj b, obj c):A(defaulta, b, c){}\n    A(obj c):A(defaultb, c){}\n}\n</code></pre>\n\n<p>Or I can call the deepest constructor every time like this:</p>\n\n<pre><code>class B{\n    B(obj a, obj b, obj c){/*code*/}\n    B(obj b, obj c):B(defaulta, b, c){}\n    B(obj c):B(defaulta, defaultb, c){}\n}\n</code></pre>\n\n<p>Is there an advantage to doing one over the other?</p>\n\n<p>Since the body of the delegating constructors is empty, does it change the compiled program or affect runtime performance, and if it does, can the compiler optimize it to the better option?</p>\n"}, {"tags": ["c++", "memory-leaks"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1548281279, "post_id": 54336422, "comment_id": 95490132, "body": "Basically, &quot;no&quot;."}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 2, "creation_date": 1548281328, "post_id": 54336422, "comment_id": 95490145, "body": "Assuming you also mean you&#39;re not using <code>malloc</code>, as well, heh"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 1, "creation_date": 1548281380, "post_id": 54336422, "comment_id": 95490165, "body": "@Phil &quot;without dynamically allocating memory&quot;"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1548281406, "post_id": 54336422, "comment_id": 95490169, "body": "How about Linux function <code>strdup</code>? That will give you a memory leak without using <code>new</code>."}, {"owner": {"reputation": 864, "user_id": 10913596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cf12cce6499d0cf89a03500f0808ab?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10913596/daniel"}, "edited": false, "score": 0, "creation_date": 1548281427, "post_id": 54336422, "comment_id": 95490179, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37017667/memory-leak-with-no-dynamic-memory\">Memory Leak with no dynamic memory</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1548281429, "post_id": 54336422, "comment_id": 95490181, "body": "@DeiDei &quot;without dynamically allocating memory&quot;"}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 1, "creation_date": 1548281616, "post_id": 54336422, "comment_id": 95490247, "body": "@NeilButterworth yeah, the title and question differ in that regard. Do we assume OP knows that there are ways other than explicit use of <code>new</code> to dynamically allocate memory? Or do we assume (even if tongue-in-cheek) not? Especially as they&#39;re &quot;new to the language&quot;"}, {"owner": {"reputation": 111, "user_id": 10958306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqyCT.png?s=128&g=1", "display_name": "MonkeyCoder", "link": "https://stackoverflow.com/users/10958306/monkeycoder"}, "edited": false, "score": 0, "creation_date": 1548281807, "post_id": 54336422, "comment_id": 95490311, "body": "Sorry first question ever asked in stackoverflow, i refer to new ,malloc,calloc etc. (i dont know if there are other ways)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1548281855, "post_id": 54336422, "comment_id": 95490327, "body": "One way you can get a leak is described <a href=\"https://stackoverflow.com/a/27366754/4342498\">here</a>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548281975, "post_id": 54336422, "comment_id": 95490372, "body": "@NathanOliver Yeah, circular dependency of smart pointers is certainly a way to leak."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1548282456, "post_id": 54336422, "comment_id": 95490552, "body": "What was the point of the question? What is the endgoal?"}], "answers": [{"tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 7, "last_activity_date": 1548284018, "last_edit_date": 1548284018, "creation_date": 1548283669, "answer_id": 54336862, "question_id": 54336422, "link": "https://stackoverflow.com/questions/54336422/can-i-have-memory-leaks-if-im-not-using-new-keyword/54336862#54336862", "title": "Can I have memory leaks if I&#39;m not using new keyword?", "body": "<blockquote>\n  <p>i.e having my variables in the stack and using data containers like <code>std::vector</code></p>\n</blockquote>\n\n<p>No, with <code>std::vector</code> or other standard containers you shouldn't have to worry.</p>\n\n<blockquote>\n  <p>can someone give me an example of a situation that creates a leak without dynamically allocating memory?</p>\n</blockquote>\n\n<p>One popular mistake are circularly dependent smart pointers of the form:</p>\n\n<pre><code>class Child;\nclass Parent {\n     std::vector&lt;std::shared_ptr&lt;Child&gt;&gt; childs;\n};\n\nclass Child {\n     std::shared_ptr&lt;Parent&gt; parent;\n};\n</code></pre>\n\n<p>Since the reference counters of the shared pointers will never drop to zero those instances never would be deleted and cause a memory leak.</p>\n\n<p>More info about what causes that and how to avoid it can be found here</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/1826902/how-to-avoid-memory-leak-with-shared-ptr\">How to avoid memory leak with shared_ptr?</a> </li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 10958306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqyCT.png?s=128&g=1", "display_name": "MonkeyCoder", "link": "https://stackoverflow.com/users/10958306/monkeycoder"}, "edited": false, "score": 0, "creation_date": 1548284486, "post_id": 54336937, "comment_id": 95491203, "body": "Very nice. Thank you for the examples. Specially the last one i think i might have that mistake!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1548285581, "post_id": 54336937, "comment_id": 95491533, "body": "There is nothing wrong with having a static vector. This is not a particularly good answer."}, {"owner": {"reputation": 4580, "user_id": 218774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ejff2.png?s=128&g=1", "display_name": "J. Calleja", "link": "https://stackoverflow.com/users/218774/j-calleja"}, "edited": false, "score": 1, "creation_date": 1548285762, "post_id": 54336937, "comment_id": 95491583, "body": "@Neil Having a static vector is OK. But, if you only push elements and never pop them it will only grow and it is never deleted."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1548285818, "post_id": 54336937, "comment_id": 95491601, "body": "@J.Calleja  Destructor will be called on normal program exit."}, {"owner": {"reputation": 4580, "user_id": 218774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ejff2.png?s=128&g=1", "display_name": "J. Calleja", "link": "https://stackoverflow.com/users/218774/j-calleja"}, "edited": false, "score": 0, "creation_date": 1548286366, "post_id": 54336937, "comment_id": 95491748, "body": "You are right. Destructor is called at the end. This was  a simplification of an actual example were we created an static vector an make It grow until the memory exhausted. I will update the answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1548287614, "post_id": 54336937, "comment_id": 95492014, "body": "&quot; memory usage will grow with each call to the function&quot; - what does that have to do with memory leaks? Tere are many ways calling a function can cause memory usage to grow, but that does not imply a leak."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1548289393, "post_id": 54336937, "comment_id": 95492384, "body": "@NeilButterworth even in GC languages, this is considered a memory leak."}, {"owner": {"reputation": 4580, "user_id": 218774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ejff2.png?s=128&g=1", "display_name": "J. Calleja", "link": "https://stackoverflow.com/users/218774/j-calleja"}, "edited": false, "score": 0, "creation_date": 1548290548, "post_id": 54336937, "comment_id": 95492602, "body": "@Neil I understand a leak as a resource you have lost control of. After calling f() you have memory reserved that you cannot free. Even if the function only uses vector internally. Obviously, there are valid uses of static variables, but you must remember to clear (and shrink)  them when you no longer need them."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1548410021, "post_id": 54336937, "comment_id": 95539609, "body": "Neil is correct. This does not leak. The destructor will be called and memory correctly released before program termination. There is no resource leakage and all contained objects would also be correctly be destroyed."}, {"owner": {"reputation": 4580, "user_id": 218774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ejff2.png?s=128&g=1", "display_name": "J. Calleja", "link": "https://stackoverflow.com/users/218774/j-calleja"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1548503507, "post_id": 54336937, "comment_id": 95569727, "body": "@MartinYork It is stated in the answer that the memory is freed at the end. I wanted to note that, even using vectors, the memory may not be released when the variable goes out of scope. I understand that, when a resource is allocated but it is nor used nor accesible, it is simmilar to a memory leak. I have tried to clarify the issue in the answer."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1548580266, "post_id": 54336937, "comment_id": 95585427, "body": "<code>even using vectors, the memory may not be released when the variable goes out of scope.</code> You are picking scope to fit your argument but its not relavant. The Standard talks about lifetime. The lifetime of a static variable is well defined and guarantees the objects destruction."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1548580340, "post_id": 54336937, "comment_id": 95585444, "body": "<code>I understand that, when a resource is allocated but it is nor used nor accesible, it is simmilar to a memory leak.</code> Badly articulated, but still wrong. A leak is when it can not be accessed."}, {"owner": {"reputation": 4580, "user_id": 218774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ejff2.png?s=128&g=1", "display_name": "J. Calleja", "link": "https://stackoverflow.com/users/218774/j-calleja"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1548705322, "post_id": 54336937, "comment_id": 95629510, "body": "@MartinYork I could not find the definition for memory leak in the C++ Standard. Wikipedia defines memory leak as &quot;(...) a computer program incorrectly manages memory allocations in such a way that memory which is no longer needed is not released.&quot;. My example shows a case where the memory is not released after it is no longer needed. I agree the destructor will be called before the end of the execution. I agree it is not a complete memory leak. However, I think it is a good example of a problem OP may experience even if only std::vectors are being used."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1548706301, "post_id": 54336937, "comment_id": 95629961, "body": "@J.Calleja Even by your definition it is not a leak. Its also a terrible example (as noted by both Neil and I). The memory is released so it is not leaked. You never loose the reference to it. So it is not leaked. It is ued every time <code>f()</code> is called so you can continue to use it for the life of the application.  This is a leak in nobodies mind apart from yours."}, {"owner": {"reputation": 4580, "user_id": 218774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ejff2.png?s=128&g=1", "display_name": "J. Calleja", "link": "https://stackoverflow.com/users/218774/j-calleja"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1548709919, "post_id": 54336937, "comment_id": 95631653, "body": "@MartinYork I may not call f() again and the memory will remain reserved until the end of the application. Note that I would not call it a leak if the data or the memory is going to be reused. However, if I find a method that reserves memory, it does not free it and it is not going to use it again, I would call it a leak (and it complies with the definition from Wikipedia). For me, it is not so important that the memory is released at the end (after all, every resource is released when the process exits). It is important to control the memory usage while the application is running."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1548713010, "post_id": 54336937, "comment_id": 95632865, "body": "@J.Calleja But you may call <code>f()</code> again. And the memory will be there for you. So it is not a leak. <code>every resource is released when the process exits</code> Not 100% true. There are lots of resources that are not automatically released when the processes exits. These resources will eventually time out and be released but that can be well after the processes exits. You are twisting the meaning if you think it complies with the Wikipedia definition."}], "tags": [], "owner": {"reputation": 4580, "user_id": 218774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ejff2.png?s=128&g=1", "display_name": "J. Calleja", "link": "https://stackoverflow.com/users/218774/j-calleja"}, "is_accepted": true, "score": 4, "last_activity_date": 1548503332, "last_edit_date": 1548503332, "creation_date": 1548284052, "answer_id": 54336937, "question_id": 54336422, "link": "https://stackoverflow.com/questions/54336422/can-i-have-memory-leaks-if-im-not-using-new-keyword/54336937#54336937", "title": "Can I have memory leaks if I&#39;m not using new keyword?", "body": "<p>I think it is not possible to leak memory if you do not reserve memory dynamically. Probably, global variables are not going to be freed, but I would not call that a memory leak.</p>\n\n<p>However, there are more ways to dynamically reserve memory than using the keyword <code>new</code>.</p>\n\n<p>For example, <a href=\"https://en.cppreference.com/w/cpp/memory/c/malloc\" rel=\"nofollow noreferrer\"><code>malloc</code></a> allocates a memory block. Also <a href=\"https://en.cppreference.com/w/cpp/memory/c/calloc\" rel=\"nofollow noreferrer\"><code>calloc</code></a> reserves memory and zeroes it.</p>\n\n<p>Your operating can also give you methods to manage the memory. For example <code>strdup</code> for Linux.</p>\n\n<p>You can also be using smart pointers and calling <a href=\"https://en.cppreference.com/w/cpp/memory/unique_ptr/make_unique\" rel=\"nofollow noreferrer\"><code>std::make_unique</code></a> or <a href=\"https://en.cppreference.com/w/cpp/memory/shared_ptr/make_shared\" rel=\"nofollow noreferrer\"><code>std::make_shared</code></a>. Both methods dynamically allocate memory. </p>\n\n<p>For <code>std::unique_ptr</code> you can leak if you call <code>release()</code> and forget to delete the pointer. </p>\n\n<pre><code> std::make_unique&lt;int&gt;(3).release(); // Memory leak\n</code></pre>\n\n<p>For <code>std::shared_ptr</code> you can leak if you create a circular reference. You can find more information <a href=\"https://stackoverflow.com/a/27366754/218774\">here</a>.</p>\n\n<p>Also, when you use static variables, the destructor is not called when the variable goes out of scope but at the end of the execution. This is not exactly a memory leak because the destructor is finally called but you may have some memory allocated and not used.</p>\n\n<p>For example, consider the following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n\nvoid f() \n{\n    static std::vector&lt;int&gt; v;\n    v.insert(v.begin(), 100*1024*1024, 0);\n    v.clear();\n}\n\nint main()\n{\n    f();\n    return 0;\n}\n</code></pre>\n\n<p><code>std::vector::clear()</code> is not required to free the memory allocated by the vector. So, after calling <code>f()</code>, you will have 400 MB of memory allocated but only accesible inside <code>f()</code>. Not exactly a memory leak, but it is a resource allocated that it is not automatically freed until the end.</p>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 4286117, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/87aa2c19c6c5b95a9b6330c0099a0b22?s=128&d=identicon&r=PG&f=1", "display_name": "sudgy", "link": "https://stackoverflow.com/users/4286117/sudgy"}, "edited": false, "score": 1, "creation_date": 1548309825, "post_id": 54340255, "comment_id": 95496719, "body": "My personal suggestion for avoiding this problem is to wrap the type in a simple RAII class, or use a <code>std::unique_ptr</code> with a custom deleter."}], "tags": [], "owner": {"reputation": 149, "user_id": 4286117, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/87aa2c19c6c5b95a9b6330c0099a0b22?s=128&d=identicon&r=PG&f=1", "display_name": "sudgy", "link": "https://stackoverflow.com/users/4286117/sudgy"}, "is_accepted": false, "score": 4, "last_activity_date": 1548309770, "creation_date": 1548309770, "answer_id": 54340255, "question_id": 54336422, "link": "https://stackoverflow.com/questions/54336422/can-i-have-memory-leaks-if-im-not-using-new-keyword/54340255#54340255", "title": "Can I have memory leaks if I&#39;m not using new keyword?", "body": "<p>In addition to the other answers, an easy source for memory leaks are external libraries.  A lot of them, especially C or C-like libraries, have functions like <code>create_*</code> and <code>destroy_*</code> for their data types.  Even though you never explicitly call <code>new</code>, it is still just as easy to have a memory leak.</p>\n"}], "owner": {"reputation": 111, "user_id": 10958306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqyCT.png?s=128&g=1", "display_name": "MonkeyCoder", "link": "https://stackoverflow.com/users/10958306/monkeycoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 1, "accepted_answer_id": 54336937, "answer_count": 3, "score": 10, "last_activity_date": 1548503332, "creation_date": 1548281200, "last_edit_date": 1548283887, "question_id": 54336422, "link": "https://stackoverflow.com/questions/54336422/can-i-have-memory-leaks-if-im-not-using-new-keyword", "title": "Can I have memory leaks if I&#39;m not using new keyword?", "body": "<p>I'm new to the language and I have a basic doubt about memory leaks.\nIs it possible to  have a leak if I don't use the <code>new</code> keyword? (i.e having my variables in the stack and using data containers like <code>std::vector</code>) </p>\n\n<p>Should I worry about this issue? </p>\n\n<p>If that is the case, can someone give me an example of a situation that creates a leak without dynamically allocating memory?</p>\n"}, {"tags": ["c++", "constants", "extern"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1548281681, "post_id": 54336380, "comment_id": 95490272, "body": "Let me know if this answer your question and I (or somebody) will close as a duplicate: <a href=\"https://stackoverflow.com/questions/10422034/when-to-use-extern-in-c\">When to use extern in C++</a>"}, {"owner": {"reputation": 590, "user_id": 9154738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36980213b38a6581d264e31ad3ee585a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex24", "link": "https://stackoverflow.com/users/9154738/alex24"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548282198, "post_id": 54336380, "comment_id": 95490451, "body": "@user4581301: I know the usage of const and extern but what matters me <code>extern</code> in definition which I see redundant."}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 3, "last_activity_date": 1548282197, "creation_date": 1548282197, "answer_id": 54336611, "question_id": 54336380, "link": "https://stackoverflow.com/questions/54336380/should-i-add-keyword-extern-to-the-definition-of-a-constant-to-share-among-sou/54336611#54336611", "title": "Should I add keyword `extern` to the definition of a constant to share among source files?", "body": "<p>You are correct that <code>extern</code> is not needed in cpp file.</p>\n\n<p>First, you need to understand what is a declaration and a definition. Your <code>bufSize</code> needs a declaration in every translation unit it is used, and a single definition inside your program. So let's look at what you have in the .h file:</p>\n\n<pre><code>extern const int bufSize;\n</code></pre>\n\n<p>This is a valid declaration of <code>const int</code> variable. No confusion here.</p>\n\n<p>Now you need a definition, which goes to a .cpp file, and you need to make sure that this exists in a single place in the whole program, otherwise you are breaking ODR - One Definition Rule. This is what you currently have:</p>\n\n<pre><code>extern const int bufSize = fcn();\n</code></pre>\n\n<p>This is a valid definition, since any declaration with extern storage class and initializer is a definition. However, </p>\n\n<pre><code>const int bufSize = fcn();\n</code></pre>\n\n<p>Also is a definition. And with preceeding declaration of <code>extern</code>, this definition has an external linkage - which means, it can be accessed from other translation units (without that, <code>const int bufSize</code> in namespace scope would have internal linkage).</p>\n\n<p>Bottom line - <code>extern</code> in the example doesn't affect the compiler behavior, but reminds whoever is reading the code that the variable has external linkage (as it is not immediately obvious from this line).</p>\n\n<p>Further reading:</p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/language/definition\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/definition</a></p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/language/storage_duration\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/storage_duration</a></p>\n"}], "owner": {"reputation": 590, "user_id": 9154738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36980213b38a6581d264e31ad3ee585a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex24", "link": "https://stackoverflow.com/users/9154738/alex24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 54336611, "answer_count": 1, "score": 1, "last_activity_date": 1548282760, "creation_date": 1548281004, "last_edit_date": 1548282760, "question_id": 54336380, "link": "https://stackoverflow.com/questions/54336380/should-i-add-keyword-extern-to-the-definition-of-a-constant-to-share-among-sou", "title": "Should I add keyword `extern` to the definition of a constant to share among source files?", "body": "<p>In \"C++ Primer, Fifth Edition\" on page 95. Talking about constants. He said: </p>\n\n<blockquote>\n  <p>Sometimes we have a <code>const</code> variable that we want to share across multiple files but whose initializer is not a constant expression. In this case, we don\u2019t want the compiler to generate a separate variable in each file. Instead, we want the <code>const</code> object to behave like other (non <code>const</code>) variables. We want to define the <code>const</code> in one file, and declare it in the other files that use that object.</p>\n  \n  <p>To define a single instance of a <code>const</code> variable, we use the keyword <code>extern</code> on both its definition and declaration(s):</p>\n  \n  <p><code>// file_1.cc</code> defines and initializes a <code>const</code> that is accessible to other files.</p>\n  \n  <p><code>extern const int bufSize = fcn();</code></p>\n  \n  <p><code>// file_1.h</code></p>\n  \n  <p><code>extern const int bufSize; // same bufSize as defined in file_1.cc</code></p>\n</blockquote>\n\n<p>What I am not sure of is the last paragraph; I removed <code>extern</code> from the definition of <code>bufsize</code> but it is ok and is accessible from other files?!</p>\n\n<pre><code>const int bufSize = fcn(); // without keyword extern\n</code></pre>\n\n<p>Why he said we should add keyword <code>extern</code> to both declarations and definition of <code>bufsize</code> to be accessible from other files but <code>extern</code> as I guess is enough in declarations?</p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548280668, "post_id": 54336302, "comment_id": 95489892, "body": "Function return type and parameter types, what&#39;s unclear about that please??"}, {"owner": {"reputation": 11, "user_id": 10463168, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dn4O47zBtT4/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DW38hKPaKZ_iTely0GnyHtuSmSIZA/mo/photo.jpg?sz=128", "display_name": "Pingas", "link": "https://stackoverflow.com/users/10463168/pingas"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548280888, "post_id": 54336302, "comment_id": 95489982, "body": "I wasn&#39;t complete question. I know how to use std::function."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1548280888, "post_id": 54336302, "comment_id": 95489983, "body": "What does you now posted example code have to do with <code>std::function</code>?"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548280889, "post_id": 54336302, "comment_id": 95489984, "body": "It does seem obvious after you point it out, @\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6"}], "answers": [{"tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": false, "score": 0, "last_activity_date": 1548282961, "creation_date": 1548282961, "answer_id": 54336755, "question_id": 54336302, "link": "https://stackoverflow.com/questions/54336302/can-someone-explain-the-special-stdfunction-template-parameter-list-syntaxthi/54336755#54336755", "title": "Can someone explain the special std::function template parameter list syntax(this strange Type(Types...))?", "body": "<p>You can't have a function type as a template parameter for <code>std::vector</code> (or <code>std::tuple</code>), but you can have a function <strong>pointer</strong> type in this role. For example,</p>\n\n<pre><code>int foo(int x) { return 2 * x; }\nint bar(int x) { return 3 * x; }\n\nstd::vector&lt;int(*)(int)&gt; v{&amp;foo, &amp;bar}; // &amp; is optional here\nstd::cout &lt;&lt; v[0](5); // Calls foo(5), outputs 10\nstd::cout &lt;&lt; v[1](5); // Calls bar(5), outputs 15\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 0, "last_activity_date": 1548283570, "last_edit_date": 1548283570, "creation_date": 1548283260, "answer_id": 54336797, "question_id": 54336302, "link": "https://stackoverflow.com/questions/54336302/can-someone-explain-the-special-stdfunction-template-parameter-list-syntaxthi/54336797#54336797", "title": "Can someone explain the special std::function template parameter list syntax(this strange Type(Types...))?", "body": "<p>When you declare a function in C++ you use virtually exactly the same syntax</p>\n\n<pre><code>return_type function_name(parameter_type1, parameter_type2 /* and so on */)\n</code></pre>\n\n<p>I hope you don't find it strange. In function declaration syntax parentheses surround the parameter list.</p>\n\n<p>Now, if you remove the <code>function_name</code> from this syntax you'll be left with just function type itself, \"extracted\" from that declaration</p>\n\n<pre><code>return_type (parameter_type1, parameter_type2)\n</code></pre>\n\n<p>That's just how you describe an ordinary function type in C++. Actually, it is inherited directly from C. Nothing new, strange or unusual about it.</p>\n\n<p>For another example, when you are declaring</p>\n\n<pre><code>int a[10];\n</code></pre>\n\n<p>you are actually declaring name <code>a</code> as having type <code>int [10]</code>. In the very same fashion, when you are declaring</p>\n\n<pre><code>double a(double);\n</code></pre>\n\n<p>you are actually declaring name <code>a</code> as having type <code>double (double)</code>. </p>\n\n<p>And you can't use function type as container element type or tuple element type. Function type is not <em>object</em> type. And these contexts actually require object types.</p>\n\n<p>But you can (and you have) to use it as template argument for <code>std::function</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 10535037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1fe9777a8ae44f91fd8e9588ee8292?s=128&d=identicon&r=PG&f=1", "display_name": "Sasha Volokh", "link": "https://stackoverflow.com/users/10535037/sasha-volokh"}, "is_accepted": true, "score": 2, "last_activity_date": 1548331743, "last_edit_date": 1548331743, "creation_date": 1548299496, "answer_id": 54338857, "question_id": 54336302, "link": "https://stackoverflow.com/questions/54336302/can-someone-explain-the-special-stdfunction-template-parameter-list-syntaxthi/54338857#54338857", "title": "Can someone explain the special std::function template parameter list syntax(this strange Type(Types...))?", "body": "<p><code>Type(Types...)</code> is <strong>not</strong> a \"special syntax\". The reason <code>std::function</code> takes <code>R(Args...)</code> is that it specializes for the function type <code>R(Args...)</code>. Here is its declaration from the standard:</p>\n\n<pre><code>template&lt;class&gt; class function; // undefined\ntemplate&lt;class R, class... ArgTypes&gt; class function&lt;R(ArgTypes...)&gt;;\n</code></pre>\n\n<p>The important thing to understand is that the <code>R(ArgTypes...)</code> syntax specifies a function type. If you declare a function such as <code>int foo(int arg)</code>, the type of <code>foo</code> is <code>int(int)</code>.</p>\n\n<p>You can create your own structures that accept arguments in this way like so:</p>\n\n<pre><code>template &lt;class&gt;\nstruct X;\n\ntemplate &lt;class R, class ...Args&gt;\nstruct X&lt;R(Args...)&gt; {\n   typedef R result_type;\n   // ... whatever\n};\n</code></pre>\n\n<p>The reason why you can't use <code>int(int)</code> with <code>std::vector</code> or <code>std::tuple</code> is because of their declarations:</p>\n\n<pre><code>template&lt;class T, class Allocator = allocator&lt;T&gt;&gt; class vector;\ntemplate&lt;class... Types&gt; class tuple;\n</code></pre>\n\n<p>When you do <code>std::vector&lt;int(int)&gt;</code>, you substitute <code>T</code> for <code>int(int)</code>, which won't work because the construction of <code>std::allocator&lt;int(int)&gt;</code> will fail (you can't allocate function types). </p>\n\n<p>When you do <code>std::tuple&lt;int(int)&gt;</code>, you are passing <code>int(int)</code> as the first type in the parameter pack <code>Types</code>, which won't work either because you cannot have function types be a data member.</p>\n"}], "owner": {"reputation": 11, "user_id": 10463168, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dn4O47zBtT4/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DW38hKPaKZ_iTely0GnyHtuSmSIZA/mo/photo.jpg?sz=128", "display_name": "Pingas", "link": "https://stackoverflow.com/users/10463168/pingas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 54338857, "answer_count": 3, "score": -1, "last_activity_date": 1548331743, "creation_date": 1548280548, "last_edit_date": 1548280920, "question_id": 54336302, "link": "https://stackoverflow.com/questions/54336302/can-someone-explain-the-special-stdfunction-template-parameter-list-syntaxthi", "title": "Can someone explain the special std::function template parameter list syntax(this strange Type(Types...))?", "body": "<p>Can someone explain the special <code>std::function</code> syntax(this strange <code>Type(Types...)</code>)?What are this parentheses? I know that what is inside means argument list of function. </p>\n\n<p>I just wonder what this syntax means.</p>\n\n<pre><code>//What am I doing? Can someone explain?\n\nstd::vector&lt;int&gt;      a; // \nstd::vector&lt;int(int)&gt; b; // it counts as a type\n\n//or\nstd::tuple&lt;double, double&gt; t1{0.0, 0.0}; // okey\nstd::tuple&lt;double(double)&gt; t2{0.0, 0.0}; // not okey, not the same as above(please explain what happens)\n</code></pre>\n"}, {"tags": ["c++", "c++11", "c++14", "c++17"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 1, "creation_date": 1548280243, "post_id": 54336229, "comment_id": 95489714, "body": "How about writing two loops (or using a standard algorithm, like <code>std::for_each</code>) and implementing the duplicate bahaviour in a single function that will be passed to said algorithm?"}, {"owner": {"reputation": 800, "user_id": 1113720, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6N9jm.jpg?s=128&g=1", "display_name": "Mathai", "link": "https://stackoverflow.com/users/1113720/mathai"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1548280306, "post_id": 54336229, "comment_id": 95489740, "body": "@Fureeish Yes, thats a possiblity"}, {"owner": {"reputation": 800, "user_id": 1113720, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6N9jm.jpg?s=128&g=1", "display_name": "Mathai", "link": "https://stackoverflow.com/users/1113720/mathai"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1548280321, "post_id": 54336229, "comment_id": 95489742, "body": "Someone care to explain why the question was downvoted? Did my research, and this is not a homework question."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1548280471, "post_id": 54336229, "comment_id": 95489809, "body": "Then I&#39;d go with that approach. Forcing the logic to be enclosed in a single loop will introduce a lot of unnecessary checks and hard-to-read code noise. Prefer simplicity over complexity, especially if the behaviour <b>and</b> performance are either the same, or better regarding the simpler approach."}], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 0, "last_activity_date": 1548280621, "creation_date": 1548280621, "answer_id": 54336311, "question_id": 54336229, "link": "https://stackoverflow.com/questions/54336229/is-there-a-way-to-iterate-over-two-containers-without-using-two-for-loops/54336311#54336311", "title": "Is there a way to iterate over two containers without using two for loops", "body": "<p>Well... your error is a double equal where you need a single equal.</p>\n\n<p>I mean, not</p>\n\n<pre><code>if (it == a.end())\n{\n    it == b.begin();\n} //   ^^ Wrong!\n</code></pre>\n\n<p>but</p>\n\n<pre><code>if (it == a.end())\n{\n    it = b.begin();\n} //   ^ correct\n</code></pre>\n\n<p>But I don't think it's a good idea: we are sure that <code>a.end() != b.end()</code> ?</p>\n\n<p>Your code depend from this.</p>\n"}, {"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 8, "last_activity_date": 1548280678, "creation_date": 1548280678, "answer_id": 54336323, "question_id": 54336229, "link": "https://stackoverflow.com/questions/54336229/is-there-a-way-to-iterate-over-two-containers-without-using-two-for-loops/54336323#54336323", "title": "Is there a way to iterate over two containers without using two for loops", "body": "<p>Using <a href=\"https://github.com/ericniebler/range-v3\" rel=\"noreferrer\">range-v3</a>, your go-to for all things range-related in C++17 or earlier:</p>\n\n<pre><code>for (int i : view::concat(a, b)) {\n    std::cout &lt;&lt; i &lt;&lt; ' ';\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1304, "user_id": 231299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66dff0c4f2df2394109a0b09fa59dce1?s=128&d=identicon&r=PG", "display_name": "beerboy", "link": "https://stackoverflow.com/users/231299/beerboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1548281127, "creation_date": 1548281127, "answer_id": 54336411, "question_id": 54336229, "link": "https://stackoverflow.com/questions/54336229/is-there-a-way-to-iterate-over-two-containers-without-using-two-for-loops/54336411#54336411", "title": "Is there a way to iterate over two containers without using two for loops", "body": "<p>You can use <a href=\"https://www.boost.org/doc/libs/1_69_0/libs/range/doc/html/range/reference/utilities/join.html\" rel=\"nofollow noreferrer\">boost::range::join</a> like so:</p>\n\n<pre><code>#include &lt;boost/range/join.hpp&gt;\n\n...\n\nstd::vector&lt;int&gt; a{ 1,2,3 };\nstd::vector&lt;int&gt; b{ 4,5,6 };\n\nfor (auto i : boost::range::join(a, b))\n{\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "is_accepted": false, "score": -1, "last_activity_date": 1548281275, "creation_date": 1548281275, "answer_id": 54336437, "question_id": 54336229, "link": "https://stackoverflow.com/questions/54336229/is-there-a-way-to-iterate-over-two-containers-without-using-two-for-loops/54336437#54336437", "title": "Is there a way to iterate over two containers without using two for loops", "body": "<p>To get the most optimal code it is preferable to avoid to make unnecessary test at each loop. Since the most efficient code consist in performing two loops, it is possible to get close to that by changing the entire state of the variables that participate in the loop (iterator and sentinel), (I suppose this is how is implemented a concatenated range ... this is how I did):</p>\n\n<pre><code>vector&lt;int&gt; a{ 1,2,3 };\nvector&lt;int&gt; b{ 4,5,6 };\n\nauto it = a.begin();\nauto end = a.end();\n\nfor (;[&amp;](){\n         if (it==end){\n            if (end==a.end()) {\n              it=b.begin();\n              end=b.end();\n              return true;\n              }\n            else return false;\n            }\n          return true;\n          }();\n    ++it)\n{\n   //loop content\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 800, "user_id": 1113720, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6N9jm.jpg?s=128&g=1", "display_name": "Mathai", "link": "https://stackoverflow.com/users/1113720/mathai"}, "edited": false, "score": 0, "creation_date": 1548340609, "post_id": 54336449, "comment_id": 95513477, "body": "With visual studio 2017, I get the error &quot;vector iterators incompatible&quot;. I guess it is because we compare it against v2.end() when v1 it is v1 iterator."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1548429222, "post_id": 54336449, "comment_id": 95549907, "body": "If both v1 and v2 are empty, you&#39;ll need some extra checks."}, {"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1548615964, "post_id": 54336449, "comment_id": 95595506, "body": "@AndyG nope. The code checks all cases. I don&#39;t think there is any UB here"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1548636569, "post_id": 54336449, "comment_id": 95600219, "body": "@BiagioFesta: You&#39;re right, apologies. I misread the <code>use of *it</code> as outside the <code>else</code>"}], "tags": [], "owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "is_accepted": false, "score": 2, "last_activity_date": 1548281332, "creation_date": 1548281332, "answer_id": 54336449, "question_id": 54336229, "link": "https://stackoverflow.com/questions/54336229/is-there-a-way-to-iterate-over-two-containers-without-using-two-for-loops/54336449#54336449", "title": "Is there a way to iterate over two containers without using two for loops", "body": "<p><a href=\"https://www.boost.org/doc/libs/1_69_0/libs/range/doc/html/index.html\" rel=\"nofollow noreferrer\">Boost Range</a> and Standard Library algorithms are solutions which should be prefered because of their better design.</p>\n\n<p>However, just for sake of completeness, if you really want to apply the idea behind your design you can code like the following:</p>\n\n<pre><code>std::vector&lt;int&gt; v1 = {1, 2, 3};\nstd::vector&lt;int&gt; v2 = {4, 5, 6};\n\nfor (auto it = v1.begin(); it != v2.end();) {\n  if (it == v1.end()) {\n    it = v2.begin();\n  } else {\n  // {\n    // use of *it\n  // }\n    ++it;\n  }\n}\n</code></pre>\n\n<p><a href=\"https://coliru.stacked-crooked.com/a/cd57efe673dbc3f2\" rel=\"nofollow noreferrer\">Live Demo Here</a></p>\n"}, {"tags": [], "owner": {"reputation": 2079, "user_id": 3461617, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b551849b0da31fcb2f8ffae813f7c834?s=128&d=identicon&r=PG&f=1", "display_name": "Sandro", "link": "https://stackoverflow.com/users/3461617/sandro"}, "is_accepted": false, "score": 2, "last_activity_date": 1548281437, "creation_date": 1548281437, "answer_id": 54336474, "question_id": 54336229, "link": "https://stackoverflow.com/questions/54336229/is-there-a-way-to-iterate-over-two-containers-without-using-two-for-loops/54336474#54336474", "title": "Is there a way to iterate over two containers without using two for loops", "body": "<p>one more way to do it using boost range</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\n#include &lt;boost/range.hpp&gt;\n#include &lt;boost/range/join.hpp&gt;\n\nint main()\n{\n  std::vector&lt;int&gt; a{ 1,2,3 };\n  std::vector&lt;int&gt; b{ 4,5,6 };\n\n  for(auto&amp; x : boost::join(a, b)) {\n      std::cout &lt;&lt; x &lt;&lt; \" \";\n  }\n  std::cout &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1548429086, "post_id": 54349001, "comment_id": 95549799, "body": "But this uses two for loops?"}, {"owner": {"reputation": 800, "user_id": 1113720, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6N9jm.jpg?s=128&g=1", "display_name": "Mathai", "link": "https://stackoverflow.com/users/1113720/mathai"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1548443968, "post_id": 54349001, "comment_id": 95557450, "body": "@AndyG Sorry if I confused everyone, I meant &#39;not using two loops, one followed by another&#39;. Did not want the code &quot;// do something with *it&quot; repeated"}], "tags": [], "owner": {"reputation": 800, "user_id": 1113720, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6N9jm.jpg?s=128&g=1", "display_name": "Mathai", "link": "https://stackoverflow.com/users/1113720/mathai"}, "is_accepted": false, "score": 1, "last_activity_date": 1548340658, "last_edit_date": 1548340658, "creation_date": 1548340314, "answer_id": 54349001, "question_id": 54336229, "link": "https://stackoverflow.com/questions/54336229/is-there-a-way-to-iterate-over-two-containers-without-using-two-for-loops/54349001#54349001", "title": "Is there a way to iterate over two containers without using two for loops", "body": "<p>Found an easy 'traditional' way to do this. </p>\n\n<pre><code>for (int i = 0; i &lt; 2; i++)\n{\n    auto it = (i == 0) ? a.begin() : b.begin();\n    auto end = (i == 0) ? a.end() : b.end();\n    for (; it != end; ++it)\n    {\n        // do something with *it\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "is_accepted": false, "score": 1, "last_activity_date": 1548354418, "creation_date": 1548354418, "answer_id": 54353207, "question_id": 54336229, "link": "https://stackoverflow.com/questions/54336229/is-there-a-way-to-iterate-over-two-containers-without-using-two-for-loops/54353207#54353207", "title": "Is there a way to iterate over two containers without using two for loops", "body": "<p>If you feel like writing your own, the following helps:</p>\n\n<pre><code>template&lt;class ForwardItr&gt;\nstruct range {\n    ForwardItr beg;\n    ForwardItr end;\n};\n\ntemplate&lt;class ForwardItr, class F&gt;\nvoid concat_ranges(range&lt;ForwardItr&gt; r1, range&lt;ForwardItr&gt; r2, F f) {\n    auto run = [&amp;f](range&lt;ForwardItr&gt; r) {\n        for(auto itr = r.beg; itr != r.end; ++itr){\n            f(*itr);\n        }\n    };\n    run(r1);\n    run(r2);\n};\n</code></pre>\n\n<p>Example: <a href=\"https://gcc.godbolt.org/z/8tPArY\" rel=\"nofollow noreferrer\">https://gcc.godbolt.org/z/8tPArY</a></p>\n"}, {"tags": [], "owner": {"reputation": 235, "user_id": 4262263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d72aea65f8ef4c3793765e3601271353?s=128&d=identicon&r=PG&f=1", "display_name": "Vikas Awadhiya", "link": "https://stackoverflow.com/users/4262263/vikas-awadhiya"}, "is_accepted": false, "score": 0, "last_activity_date": 1559744978, "creation_date": 1559744978, "answer_id": 56462583, "question_id": 54336229, "link": "https://stackoverflow.com/questions/54336229/is-there-a-way-to-iterate-over-two-containers-without-using-two-for-loops/56462583#56462583", "title": "Is there a way to iterate over two containers without using two for loops", "body": "<p>Not even a single <code>for()</code> loop requires to print these container, If you use <code>std::copy</code> as follows,</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n#include &lt;vector&gt;\n\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\n\nint main(int , char *[])\n{\n    std::vector&lt; int&gt; a{ 1, 2, 3};\n    std::vector&lt; int&gt; b{ 4, 5, 6};\n\n    std::copy( a.begin(), a.end(), std::ostream_iterator&lt; int&gt;( std::cout, \" \"));\n    std::copy( b.begin(), b.end(), std::ostream_iterator&lt; int&gt;( std::cout, \" \"));\n\n    std::cout&lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>output : <code>1 2 3 4 5 6</code></p>\n\n<p>Using stl library is best option and it is not required to write any code to print  a container.<br/></p>\n\n<p>As per your concern <strong>I do not want to write two for loops and duplicate the code inside the loop. Is there a way to iterate over a followed by b with a single for loop?</strong></p>\n\n<p>The way to avoiding duplicate code is write functions which can be used from multiple places, for example if you don't want to use <code>std::copy</code> and wants to write your own code to print these containers (which is not recommended) then you can write following function,</p>\n\n<pre><code>template&lt; typename ForwardIterator&gt;\nvoid print( ForwardIterator begin, ForwardIterator end, const std::string&amp; separator)\n{\n    while( begin != end)\n    {\n        std::cout&lt;&lt; *begin&lt;&lt; separator;\n        ++begin;\n    }\n}\n</code></pre>\n\n<p>then call <code>print</code> function,</p>\n\n<pre><code>print( a.begin(), a.end(), std::string( \" \"));\nprint( b.begin(), b.end(), std::string( \" \"));\n</code></pre>\n"}], "owner": {"reputation": 800, "user_id": 1113720, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6N9jm.jpg?s=128&g=1", "display_name": "Mathai", "link": "https://stackoverflow.com/users/1113720/mathai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 54336323, "answer_count": 9, "score": 3, "last_activity_date": 1559744978, "creation_date": 1548280122, "last_edit_date": 1548341527, "question_id": 54336229, "link": "https://stackoverflow.com/questions/54336229/is-there-a-way-to-iterate-over-two-containers-without-using-two-for-loops", "title": "Is there a way to iterate over two containers without using two for loops", "body": "<p>Is there a way to iterate over two containers (one followed by the other), without using two for loops.</p>\n\n<p>My intention is to do something like this</p>\n\n<pre><code>vector&lt;int&gt; a{ 1,2,3 };\nvector&lt;int&gt; b{ 4,5,6 };\n\nauto it = a.begin();\nauto end = b.end();\n\nfor (; it != end; ++it)\n{\n    if (it == a.end())\n    {\n        it = b.begin();\n    }\n    // do something with *it\n}\n</code></pre>\n\n<p>to print</p>\n\n<pre><code>1 2 3 4 5 6\n</code></pre>\n\n<p>(of course it doesn't work. The explanation is in this <a href=\"https://stackoverflow.com/questions/4657513/comparing-iterators-from-different-containers\">answer</a> )</p>\n\n<p>I do not want to write two for loops and duplicate the code inside the loop.\nIs there a way to iterate over <code>a</code> followed by <code>b</code> with a single for loop?</p>\n\n<p>The only thing I can think of is either copy/move the second container to the first or create a new vector combining <code>a</code> and <code>b</code>, and then iterate over it. I do not want to do this either, because this will mean expensive copy operations.</p>\n"}, {"tags": ["c++", "boost", "cmake", "compilation", "repository"], "owner": {"reputation": 2359, "user_id": 3801449, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/04t78.jpg?s=128&g=1", "display_name": "Eenoku", "link": "https://stackoverflow.com/users/3801449/eenoku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 641, "favorite_count": 4, "answer_count": 0, "score": 6, "last_activity_date": 1548287004, "creation_date": 1548280051, "last_edit_date": 1548287004, "question_id": 54336210, "link": "https://stackoverflow.com/questions/54336210/cmake-how-to-build-boost-after-downloading-it-with-fetchcontent", "title": "CMake - how to build Boost after downloading it with FetchContent?", "body": "<p>My goal is to download the Boost repository if it isn't found and then build it  the default way, i.e. using <code>boostrap</code> and <code>b2</code> tools.</p>\n\n<p>I know, I can download it like this:</p>\n\n<pre><code>include(FetchContent)\nFetchContent_Declare(\n    Boost\n    PREFIX external_dependencies/boost\n    GIT_REPOSITORY https://github.com/boostorg/boost.git\n    GIT_SUBMODULES libs/system libs/serialization libs/random \n                   libs/function libs/config libs/headers libs/assert libs/core libs/integer \n                   libs/type_traits libs/mpl libs/throw_exception libs/preprocessor libs/utility \n                   libs/static_assert libs/smart_ptr libs/predef libs/move libs/io libs/iterator \n                   libs/detail libs/spirit libs/optional libs/type_index libs/container_hash\n                   libs/array libs/bind\n                   tools/build tools/boost_install\n)   \n\nFetchContent_GetProperties(Boost)\nFetchContent_Populate(Boost)\n</code></pre>\n\n<p><strong>But how can I build it now correctly?</strong> I'd like to run following commands:</p>\n\n<pre><code>./bootstrap.sh\n./b2 headers\n./b2 -q cxxflags=\"-fPIC\" --layout=system variant=${BUILD_TYPE} link=${LINK_TYPE} address-model=64 --with-system --with-serialization --with-random\n</code></pre>\n\n<p>I'm thinking about <a href=\"https://cmake.org/cmake/help/latest/command/add_custom_target.html\" rel=\"noreferrer\">add_custom_target()</a> and <a href=\"https://cmake.org/cmake/help/v3.13/command/add_custom_command.html\" rel=\"noreferrer\">add_custom_command()</a> functions, but I'm not sure, if it's the recommended way to do this.</p>\n"}, {"tags": ["c++", "constructor", "polymorphism", "virtual"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1548279733, "post_id": 54336098, "comment_id": 95489508, "body": "What did you observe stepping through your code line by line with the debugger?"}, {"owner": {"reputation": 43, "user_id": 9813882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b19404cb625c0c5f4399d1a59a1b0b2?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/9813882/micha%c5%82"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548280129, "post_id": 54336098, "comment_id": 95489670, "body": "when calling constructor, output is written off from a class that does not inherit from any other. deconstructor&#39;s output starts from a class that is called"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1548280242, "post_id": 54336098, "comment_id": 95489713, "body": "Could you please explain to us why those 3 methods shouldn&#39;t print the results as above? What would you expect?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1548280732, "post_id": 54336098, "comment_id": 95489919, "body": "These type of &quot;follow through the inheritance maze&quot; questions are non-productive IMO.  As long as you know what <code>virtual</code> means, that virtual dispatch functions is not invoked during construction, <code>virtual destructor</code>, static and dynamic object creation, etc. shouldn&#39;t that be enough?  I would just fire up the debugger ..."}], "owner": {"reputation": 43, "user_id": 9813882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b19404cb625c0c5f4399d1a59a1b0b2?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/9813882/micha%c5%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548279577, "creation_date": 1548279577, "question_id": 54336098, "link": "https://stackoverflow.com/questions/54336098/virtual-void-classes-constructors-polymorphism-order-of-execution", "title": "Virtual void, classes, constructors, polymorphism - order of execution", "body": "<p>I have problem with understanding order of execution in virtual void/polymorphism based program.</p>\n\n<p>As far as I understand what happens in other outputs, I have no idea why those commands: </p>\n\n<pre><code>a-&gt;b();\nd-&gt;b();\nd-&gt;a();\n((G*)d) -&gt; a();\n</code></pre>\n\n<p>give following outputs: </p>\n\n<pre><code>Nieznany\nNieznany\nGniewosz\n</code></pre>\n\n<p>Could anyone please explain me why those 3 methods print results as above?</p>\n\n<pre><code>#include &lt;iostream&gt;  \nusing namespace std; \n\n    class C { public:\n    C() {cout &lt;&lt; \"Buduje A\";}\n    void a() {cout &lt;&lt; \"Nauczyciel\" &lt;&lt; endl;}\n    virtual ~C() {cout &lt;&lt; \"~D\" &lt;&lt; endl;}\n    virtual void b() {cout &lt;&lt; \"Nieznany\" &lt;&lt; endl; }; };\n\nclass G {\n    int e; public:\n    G() {cout &lt;&lt; \"Buduje G \";}\n    void a() {cout &lt;&lt; \"Gniewosz \" &lt;&lt; endl;}\n    ~G() {cout &lt;&lt; \"~C \" &lt;&lt; endl; }\n    void b() {cout &lt;&lt; \"Draka\" &lt;&lt; endl;}; };\n\nclass A :public C {\n    int o;\n    int a;\n\npublic:\n    A() {cout &lt;&lt; \"Buduje C \";}\n    ~A() {cout &lt;&lt; \"~F \" &lt;&lt; endl;} };\n\nclass D :public A {\n    float f; public:\n    D() {cout &lt;&lt; \"Buduje D\";}\n    virtual void a() {cout &lt;&lt; \"Po\u015brednik\" &lt;&lt; endl;}\n    ~D() {cout &lt;&lt; \"~E\" &lt;&lt; endl;} };\n\nclass B :public D {\n    short s;\n    int b; public:\n    B() {cout &lt;&lt; \"Buduje E \";}\n    ~B() {cout &lt;&lt; \"~G\" &lt;&lt; endl;} };\n\nclass E :public B {\n    E() {cout &lt;&lt; \"Buduje B\";}\n    ~E() {cout &lt;&lt; \"~I\" &lt;&lt; endl;} };\n\nclass F :public G, public D { public:\n    F() {cout &lt;&lt; \"Buduje F \";}\n    void a() {cout &lt;&lt; \"Nieznany \" &lt;&lt; endl;}\n    void b() {}\n    ~F() {cout &lt;&lt; \"~H\" &lt;&lt; endl;} };\n\nvoid nic() {cout &lt;&lt; endl;}\n\nint main() {\n    C*a = new B();\n    nic();\n    a-&gt;b();\n    D*d = new F;\n    nic();\n    d-&gt;b();\n    d-&gt;a();\n    ((G*)d) -&gt; a();\n    delete d;\n    delete a;\n\n    return 0; }\n</code></pre>\n"}, {"tags": ["c++", "templates", "invoke", "return-type", "decltype"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548279263, "post_id": 54336001, "comment_id": 95489305, "body": "How does it not seem to work?"}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1548279456, "post_id": 54336001, "comment_id": 95489396, "body": "Pretty sure that you want <code>is_same_v&lt;T, int&gt;</code> (or <code>is_same&lt;T, int&gt;::value</code>) instead of <code>is_same&lt;T, int&gt;</code>. The first <code>template</code> parameter of <code>std::conditional_t</code> expects a value, not a type."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 1, "creation_date": 1548279871, "post_id": 54336001, "comment_id": 95489566, "body": "Shouldn&#39;t it be <code>decltype(foo(std::declval&lt;T&gt;()))</code> if you want a return type, not the function type?"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1548279885, "post_id": 54336001, "comment_id": 95489576, "body": "Shouldn&#39;t you use something as <code>decltype(foo(0.0f))</code> to get a return type? See <a href=\"https://wandbox.org/permlink/MwKsxcY8aGCWXPl1\" rel=\"nofollow noreferrer\">wandbox.org/permlink/MwKsxcY8aGCWXPl1</a>."}], "answers": [{"tags": [], "owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "is_accepted": true, "score": 1, "last_activity_date": 1548280623, "last_edit_date": 1548280623, "creation_date": 1548280084, "answer_id": 54336216, "question_id": 54336001, "link": "https://stackoverflow.com/questions/54336001/determining-the-return-type-of-a-template-function/54336216#54336216", "title": "Determining the Return Type of a Template Function", "body": "<blockquote>\n  <p>I thought that I could use <code>decltype(foo&lt;float&gt;)</code> to get this type but it doesn't seem to be working.</p>\n</blockquote>\n\n<p>The expression <code>foo&lt;float&gt;</code> refers to the function, so the <code>decltype</code> will be related with the type of the template function (i.e., <code>char (const float&amp;)</code>).</p>\n\n<hr>\n\n<p>What you are looking for is:</p>\n\n<pre><code>decltype(foo(std::declval&lt;float&gt;()))\n</code></pre>\n\n<p>That is, the expression returned by function <code>foo</code> when a <code>float</code> is given as input.</p>\n\n<p><em>Of course, you can substitute <code>float</code> with any type in order to obtain the different results of the template function.</em></p>\n\n<hr>\n\n<p>Example Code:</p>\n\n<pre><code>#include &lt;type_traits&gt;\n#include &lt;utility&gt;\n\n// Your template function\ntemplate &lt;typename T&gt;\nstd::conditional_t&lt;std::is_same_v&lt;T, int&gt;, int, char&gt; foo(const T&amp;);\n\nvoid test() {\n  decltype(foo(std::declval&lt;float&gt;())) x;  // x is char in this case\n\n  // We can test the type of x at compile time\n\n  static_assert(!std::is_same_v&lt;decltype(x), int&gt;, \"error\");  // x is not an int\n  static_assert(std::is_same_v&lt;decltype(x), char&gt;, \"error\");  // x is a char\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": false, "score": 1, "last_activity_date": 1548280091, "creation_date": 1548280091, "answer_id": 54336223, "question_id": 54336001, "link": "https://stackoverflow.com/questions/54336001/determining-the-return-type-of-a-template-function/54336223#54336223", "title": "Determining the Return Type of a Template Function", "body": "<p><code>decltype(foo&lt;float&gt;)</code> will give you a function type, something like <code>char (float const&amp;)</code>. To get the return type you can use</p>\n\n<pre><code>using R = decltype(foo(std::declval&lt;T&gt;()));   // T = float\n</code></pre>\n"}], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 54336216, "answer_count": 2, "score": 3, "last_activity_date": 1548280902, "creation_date": 1548279191, "last_edit_date": 1548280902, "question_id": 54336001, "link": "https://stackoverflow.com/questions/54336001/determining-the-return-type-of-a-template-function", "title": "Determining the Return Type of a Template Function", "body": "<p>Given that I have a return type which is determined by a template argument, like so:</p>\n\n<pre><code>template &lt;typename T&gt;\nconditional_t&lt;is_same_v&lt;T, int&gt;, int, char&gt; foo(const T&amp;);\n</code></pre>\n\n<p>I thought that I could use <code>decltype(foo&lt;float&gt;)</code> to get this type but it doesn't seem to be working.</p>\n\n<p>I don't have <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a> so I cannot use <code>invoke_result_t</code>.</p>\n"}, {"tags": ["c++", "vector", "c-strings", "initializer-list", "string-literals"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 2, "creation_date": 1548278743, "post_id": 54335830, "comment_id": 95489066, "body": "What do you mean by &quot;legal&quot;? If you mean &quot;should this code compile?&quot; It&#39;s easy to check that yourself. If you, however, mean &quot;Will this code produce UB?&quot;, please explain, your rationale, why you think, that it should."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548280511, "post_id": 54335830, "comment_id": 95489828, "body": "With respect to 3 and 4, there is only one <code>vector</code> here. No temporary <code>vector</code> is created. This is an initialization so it&#39;s just a direct call to a constructor. Identical to <code>std::vector&lt;const char *&gt; v1{&quot;a&quot;, &quot;b&quot;, &quot;c&quot;};</code>"}], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 7270210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51643b9e93f58e57a84a52157820178b?s=128&d=identicon&r=PG&f=1", "display_name": "Even Young", "link": "https://stackoverflow.com/users/7270210/even-young"}, "is_accepted": true, "score": 1, "last_activity_date": 1548358005, "creation_date": 1548358005, "answer_id": 54353989, "question_id": 54335830, "link": "https://stackoverflow.com/questions/54335830/initializing-a-vector-of-c-strings/54353989#54353989", "title": "Initializing a vector of c-strings", "body": "<p>Well, I realize this is a silly question, once I know the answer.\nFrom <a href=\"https://en.cppreference.com/w/cpp/language/string_literal\" rel=\"nofollow noreferrer\">cppreference.com</a>:</p>\n\n<blockquote>\n  <p>String literals have static storage duration, and thus exist in memory for the life of the program.</p>\n</blockquote>\n\n<p>That explains everything.</p>\n"}], "owner": {"reputation": 381, "user_id": 7270210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51643b9e93f58e57a84a52157820178b?s=128&d=identicon&r=PG&f=1", "display_name": "Even Young", "link": "https://stackoverflow.com/users/7270210/even-young"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 54353989, "answer_count": 1, "score": 0, "last_activity_date": 1548358005, "creation_date": 1548278475, "last_edit_date": 1548357517, "question_id": 54335830, "link": "https://stackoverflow.com/questions/54335830/initializing-a-vector-of-c-strings", "title": "Initializing a vector of c-strings", "body": "<p>Is the following code legal C++? And Why? What risk it may have?</p>\n\n<pre><code>std::vector&lt;const char *&gt; v1 = {\"a\", \"b\", \"c\"};\n</code></pre>\n\n<p>I am thinking about how this works, regarding the lifetime of the string literals. To my understand:</p>\n\n<ol>\n<li>The compiler makes a temporary array of c-strings.</li>\n<li>It assign the temporary array to a <code>std::initializer_list&lt;const char*&gt;</code></li>\n<li>Call the constructor <code>vector( std::initializer_list&lt;const char *&gt; init)</code></li>\n<li>Copy construct <code>v1</code> from the temporary vector.</li>\n</ol>\n\n<p>Well, my concern is that, shouldn't the lifetime of those string literals already expired after step 3? why?</p>\n\n<p>Whether or not the temporary vector exists doesn't matter. My point is if the constructor is implemented like this:</p>\n\n<pre><code>template &lt;typename T&gt;\nvector&lt;T&gt;::vector(initializer_list&lt;T&gt; init)\n{\n  // shallow copy from init to this\n}\n</code></pre>\n\n<p>Shouldn't those string literals expire, when the lifetime of <code>init</code> end after the constructor return?</p>\n"}, {"tags": ["c++", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 0, "creation_date": 1548304173, "post_id": 54335723, "comment_id": 95495251, "body": "Did you try not to use the HT? Usually, these hardware threads are not good for compute-intensive applications where they compete between each-other for essential parts of the same actual CPU. Try to stick to a number of OpenMP threads equal to the number of CPU cores (not HT). And if it improves things, you can even consider disabling the HT at the BIOS level."}, {"owner": {"reputation": 137, "user_id": 5033288, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ihNBjJTUV_A/AAAAAAAAAAI/AAAAAAAABxY/uiFTIDsuuOQ/photo.jpg?sz=128", "display_name": "Enzo Ferrazzano", "link": "https://stackoverflow.com/users/5033288/enzo-ferrazzano"}, "reply_to_user": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 0, "creation_date": 1548313125, "post_id": 54335723, "comment_id": 95497869, "body": "I tried to measure the speedup by doubling the number of threads: 1-&gt;2 : 50% 2-&gt;4 : 25% 4-&gt;8 (HT): 15% So it is beneficial although it is saturating already at 4 cores. On average I use around 3 cores."}, {"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 1, "creation_date": 1548314313, "post_id": 54335723, "comment_id": 95498384, "body": "Looking at your profiler&#39;s output, it seems to me that a lot of the top functions are either wrappers, or data copying. That could mean that your code waist a lot of time in reorganizing data in order to call optimized functions, and/or that it is memory bound. Could you try not to use OpenMP at compile time and take advantage of the MKL&#39;s parallelisation (you call DGEMM quite a lot) by setting in your environment <code>MKL_NUM_THREADS</code> to the number of threads you want at run time..."}, {"owner": {"reputation": 137, "user_id": 5033288, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ihNBjJTUV_A/AAAAAAAAAAI/AAAAAAAABxY/uiFTIDsuuOQ/photo.jpg?sz=128", "display_name": "Enzo Ferrazzano", "link": "https://stackoverflow.com/users/5033288/enzo-ferrazzano"}, "reply_to_user": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 0, "creation_date": 1548320295, "post_id": 54335723, "comment_id": 95501232, "body": "At an early stage we tried two strategies:    try to pack everything in a big problem, to be solved via parallelism. or   write a for loop of smaller, independent problems to parallelise with OpenMP  It seemed that the second approach was faster, and definitely easier to debug. Perhaps the first approach will scale better with the number of CPU. We will give it try again"}], "owner": {"reputation": 137, "user_id": 5033288, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ihNBjJTUV_A/AAAAAAAAAAI/AAAAAAAABxY/uiFTIDsuuOQ/photo.jpg?sz=128", "display_name": "Enzo Ferrazzano", "link": "https://stackoverflow.com/users/5033288/enzo-ferrazzano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 402, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548277965, "creation_date": 1548277965, "question_id": 54335723, "link": "https://stackoverflow.com/questions/54335723/reducing-spin-times-in-openmp-parallel-for", "title": "Reducing spin times in OpenMP parallel for", "body": "<p>We are writing a performance critical application, which has 3 main parameters:\nN_steps (about 10000)\nN_nodes (anything from 20 to 5000)\nN_size (range about 1k-10k)</p>\n\n<p>The algorithm has essentially this form</p>\n\n<pre><code>for (int i=0; i&lt;N_steps; i++)\n{\n    serial_function(i); \n    parallel_function(i,N_nodes);\n}\n</code></pre>\n\n<p>where </p>\n\n<pre><code>parallel_function(i,N_nodes) {\n    #pragma omp parallel for schedule (static) num_threads(threadNum)\n    for (int j=0; j&lt;N_nodes j++)\n    {\n        Local_parallel_function(i,j) //complexity proportional to N_size\n    }\n}\n</code></pre>\n\n<p>and Local_parallel_function is a function performing linear algebra and it typically has a run time of about 0.01-0.04 seconds or even more, and this execution time should be pretty stable within the loop. Unfortunately the problem is sequential in nature, so I cannot write the outer loop differently.</p>\n\n<p>I have noticed while profiling that a huge deal of time is spent in the NtYieldExecution function (up to 20%, if I use HT on 4 cores). </p>\n\n<p>I did some test playing with the parameters and I found out that this percentage:</p>\n\n<ul>\n<li><p>Increases with the number of threads</p></li>\n<li><p>Decreases as N_nodes and N_size increase.</p></li>\n</ul>\n\n<p>Most likely for OpenMP the parallel loop is currently not large enough, and making it larger or the function more computationally expensive helps in reducing this overhead.</p>\n\n<p>To try to have a better insight, I downloaded the Intel Profiler, and I obtained the following results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/m1yCw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m1yCw.png\" alt=\"Results from V Tune-1\"></a>\n<a href=\"https://i.stack.imgur.com/D25Py.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D25Py.png\" alt=\"Results from V Tune-2\"></a></p>\n\n<p>The region in red are the spin times, and the threads on top are the one spawned by OpenMP.</p>\n\n<p>Any suggestion on how to manage and reduce this effect?</p>\n\n<p>I use windows 10, Visual Studio 15.9.5 and OpenMP. Unfortunately it seems that the Intel Compiler is not able to compile one dependent library, so I am stuck with the Microsoft one.</p>\n"}, {"tags": ["c++", "c++-experimental"], "answers": [{"comments": [{"owner": {"reputation": 430, "user_id": 1163705, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/faab0c6bbd5ca1054bf9d53cd64011cf?s=128&d=identicon&r=PG", "display_name": "Xandor", "link": "https://stackoverflow.com/users/1163705/xandor"}, "edited": false, "score": 0, "creation_date": 1548282254, "post_id": 54335895, "comment_id": 95490474, "body": "Thanks for the quick reply. I was able to get somewhere but now am getting new errors. It seems there are still some things g++-8 do not support or is not linking properly even with the tag <code>-lstdc++fs</code>. I edited with the updates."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 430, "user_id": 1163705, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/faab0c6bbd5ca1054bf9d53cd64011cf?s=128&d=identicon&r=PG", "display_name": "Xandor", "link": "https://stackoverflow.com/users/1163705/xandor"}, "edited": false, "score": 0, "creation_date": 1548283594, "post_id": 54335895, "comment_id": 95490900, "body": "@Xandor I don&#39;t know linux so I can&#39;t really help with that.  I wonder if it is still linking against an older libstdc++"}, {"owner": {"reputation": 430, "user_id": 1163705, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/faab0c6bbd5ca1054bf9d53cd64011cf?s=128&d=identicon&r=PG", "display_name": "Xandor", "link": "https://stackoverflow.com/users/1163705/xandor"}, "edited": false, "score": 0, "creation_date": 1548285505, "post_id": 54335895, "comment_id": 95491502, "body": "Yeah, I was thinking something along those lines as well but am not finding much documentation on the matter. Regardless, thanks for getting me this far."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 0, "last_activity_date": 1548278764, "creation_date": 1548278764, "answer_id": 54335895, "question_id": 54335667, "link": "https://stackoverflow.com/questions/54335667/stdexperimentalfilesystemperm-options-has-not-been-declared/54335895#54335895", "title": "std::experimental::filesystem::perm_options has not been declared", "body": "<p>The overload of <code>filesystem::permissions</code> that you are trying to call does not exist in the experimental branch.  Per cppreference the only overloads are</p>\n\n<pre><code>void permissions(const path&amp; p, perms prms);\nvoid permissions(const path&amp; p, perms prms, error_code&amp; ec);\n</code></pre>\n\n<p>and <code>filesystem::perm_options</code> is not even a <code>type</code> is the <a href=\"https://en.cppreference.com/w/cpp/experimental/fs\" rel=\"nofollow noreferrer\">technical specification</a>.</p>\n\n<p>C++17's <a href=\"https://en.cppreference.com/w/cpp/filesystem\" rel=\"nofollow noreferrer\"><code>std::filesystem</code></a> does have <a href=\"https://en.cppreference.com/w/cpp/filesystem/perm_options\" rel=\"nofollow noreferrer\"><code>std::filesystem::perm_options</code></a> and <a href=\"https://en.cppreference.com/w/cpp/filesystem/permissions\" rel=\"nofollow noreferrer\"><code>filesystem::permissions</code></a> is overloaded to take a <code>std::filesystem::perm_options</code>.</p>\n\n<p>You can see it working in this <a href=\"https://wandbox.org/permlink/v3H5jmAnRZv9oCnw\" rel=\"nofollow noreferrer\">live example on wandbox</a> with GCC 8.1 (It is not supported in 7.3).  Do note that you have to use <code>-lstdc++fs</code> in the compiler options to get it to work as it does not link by default.</p>\n"}], "owner": {"reputation": 430, "user_id": 1163705, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/faab0c6bbd5ca1054bf9d53cd64011cf?s=128&d=identicon&r=PG", "display_name": "Xandor", "link": "https://stackoverflow.com/users/1163705/xandor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1672, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548282163, "creation_date": 1548277678, "last_edit_date": 1548282163, "question_id": 54335667, "link": "https://stackoverflow.com/questions/54335667/stdexperimentalfilesystemperm-options-has-not-been-declared", "title": "std::experimental::filesystem::perm_options has not been declared", "body": "<p>I am attempting to work with file permissions under experimental::filesystem but it states perm_options is not declared. I have tried setting flags <code>lstdc++fs</code> as well as <code>std=c++14</code> and <code>std=c++17</code> but to no avail. I copied the test code from a reference site and it does not compile either. Test code follows:</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;bitset&gt;\n#include &lt;iostream&gt;\n#include &lt;experimental/filesystem&gt;\nnamespace fs = std::experimental::filesystem;\n\nvoid demo_perms(fs::perms p)\n{\n    std::cout &lt;&lt; ((p &amp; fs::perms::owner_read) != fs::perms::none ? \"r\" : \"-\")\n              &lt;&lt; ((p &amp; fs::perms::owner_write) != fs::perms::none ? \"w\" : \"-\")\n              &lt;&lt; ((p &amp; fs::perms::owner_exec) != fs::perms::none ? \"x\" : \"-\")\n              &lt;&lt; ((p &amp; fs::perms::group_read) != fs::perms::none ? \"r\" : \"-\")\n              &lt;&lt; ((p &amp; fs::perms::group_write) != fs::perms::none ? \"w\" : \"-\")\n              &lt;&lt; ((p &amp; fs::perms::group_exec) != fs::perms::none ? \"x\" : \"-\")\n              &lt;&lt; ((p &amp; fs::perms::others_read) != fs::perms::none ? \"r\" : \"-\")\n              &lt;&lt; ((p &amp; fs::perms::others_write) != fs::perms::none ? \"w\" : \"-\")\n              &lt;&lt; ((p &amp; fs::perms::others_exec) != fs::perms::none ? \"x\" : \"-\")\n              &lt;&lt; '\\n';\n}\nint main()\n{\n    std::ofstream(\"test.txt\"); // create file\n\n    std::cout &lt;&lt; \"Created file with permissions: \";\n    demo_perms(fs::status(\"test.txt\").permissions());\n\n    fs::permissions(\"test.txt\",\n                    fs::perms::owner_all | fs::perms::group_all,\n                    fs::perm_options::add);\n\n    std::cout &lt;&lt; \"After adding o+rwx and g+rwx:  \";\n    demo_perms(fs::status(\"test.txt\").permissions());\n\n    fs::remove(\"test.txt\");\n}\n</code></pre>\n\n<p>I am on Ubuntu 18.04.1 LTS using g++ 7.3.0.</p>\n\n<p>When I compile I get the error:</p>\n\n<pre><code>test.cpp: In function \u2018int main()\u2019:\ntest.cpp:72:26: error: \u2018fs::perm_options\u2019 has not been declared\n                  fs::perm_options::add);\n</code></pre>\n\n<p>I'm not sure if std::experimental::filesystem is just lacking support for this feature, but it seems odd that this one part is missing. Any help or direction in the matter would be greatly appreciated.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Okay, so I was not aware of g++8 as Ubuntu had told me that my g++ was up to date. I installed g++8.2.0 using the command <code>sudo apt-get install g++-8</code> and I seem to be able to use it with the command <code>g++-8</code> instead of <code>g++</code>. I tested this compiler with a standard <code>cout</code> to make sure it compiles. I replaced the include and namespace to this:</p>\n\n<pre><code>#include &lt;filesystem&gt;\nnamespace fs = std::filesystem;\n</code></pre>\n\n<p>At first it said <code>filesystem</code> was not defined but I was able to take care of that with the flag <code>-std=c++17</code> and also added the flag <code>-lstdc++fs</code> but now am getting the errors:</p>\n\n<pre><code>g++-8 -std=c++17 -lstdc++fs test.cpp -o test\n/tmp/ccs3Eg7a.o: In function `main':\ntest.cpp:(.text+0x259): undefined reference to \n`std::filesystem::status(std::filesystem::__cxx11::path const&amp;)'\ntest.cpp:(.text+0x2c7): undefined reference to \n`std::filesystem::permissions(std::filesystem::__cxx11::path const&amp;, \nstd::filesystem::perms, std::filesystem::perm_options)'\ntest.cpp:(.text+0x313): undefined reference to \n`std::filesystem::status(std::filesystem::__cxx11::path const&amp;)'\ntest.cpp:(.text+0x369): undefined reference to \n`std::filesystem::remove(std::filesystem::__cxx11::path const&amp;)'\n/tmp/ccs3Eg7a.o: In function `std::filesystem::__cxx11::path::path&lt;char [9], std::filesystem::__cxx11::path&gt;(char const (&amp;) [9], std::filesystem::__cxx11::path::format)':\ntest.cpp:(.text._ZNSt10filesystem7__cxx114pathC2IA9_cS1_EERKT_NS1_6formatE[_ZNSt10filesystem7__cxx114pathC5IA9_cS1_EERKT_NS1_6formatE]+0x6d): undefined reference to `std::filesystem::__cxx11::path::_M_split_cmpts()'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["c++", "constructor", "compiler-errors"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548277714, "post_id": 54335465, "comment_id": 95488613, "body": "What is unclear about that error message? Constructor functions don&#39;t have a return type (that&#39;s covered in every beginners book). I don&#39;t think that&#39;s such a common error that it deserves it&#39;s own Q&amp;A pair here."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548277800, "post_id": 54335465, "comment_id": 95488647, "body": "Nah. Instead I&#39;ll nag you. <i>This error message is not helpful.</i> Yet it told you exactly what&#39;s wrong. You want it to be a constructor, yet clearly to the compiler it&#39;s not a constructor. Compare the function against the signature of a constructor and Whammo! The return type really stands out."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1548277898, "post_id": 54335465, "comment_id": 95488699, "body": "I wrote this Q/A pair because searching for error messages usually brings me to a helpful entry on SO and in this case I couldn&#39;t find a good answer anywhere. I&#39;m hoping it will help somebody else."}], "answers": [{"tags": [], "owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "is_accepted": false, "score": 5, "last_activity_date": 1548276885, "creation_date": 1548276885, "answer_id": 54335481, "question_id": 54335465, "link": "https://stackoverflow.com/questions/54335465/why-am-i-seeing-member-function-with-the-same-name-as-its-class-must-be-a-const/54335481#54335481", "title": "Why am I seeing &quot;member function with the same name as its class must be a constructor&quot;?", "body": "<p>The problem is a cut and paste error. It is the presence of the return type that prevents the function being interpreted as a constructor.</p>\n\n<p>So:</p>\n\n<pre><code>class Useful\n{\n    Useful( int Param ) // problem solved\n    {\n        // do useful things\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1458, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1609769678, "creation_date": 1548276818, "last_edit_date": 1609769678, "question_id": 54335465, "link": "https://stackoverflow.com/questions/54335465/why-am-i-seeing-member-function-with-the-same-name-as-its-class-must-be-a-const", "title": "Why am I seeing &quot;member function with the same name as its class must be a constructor&quot;?", "body": "<p>I had a useful function that I wanted to convert from a standalone utility into a RAII-style helper class. My definition of the class goes well until I paste in the function code and rename it. At this point the function name is underlined in red, and the tooltip says &quot;member function with the same name as its class must be a constructor&quot;.</p>\n<p>This error message is not helpful. I <strong>know</strong> that I can't write a function with the same name as the class. I <strong>want</strong> this function to be a constructor. Why isn't it? What's going on?</p>\n<p>Before:</p>\n<pre><code>void Useful( int Param ) // works, and is useful\n{\n    // do useful things\n}\n</code></pre>\n<p>After:</p>\n<pre><code>class Useful\n{\n    void Useful( int Param ) // generates error\n    {\n        // do useful things\n    }\n};\n</code></pre>\n"}, {"tags": ["c++", "performance", "templates", "template-specialization"], "comments": [{"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 1, "creation_date": 1548277750, "post_id": 54335352, "comment_id": 95488626, "body": "I&#39;m no expert, but I think it&#39;s safe to say that in general you should be storing the data as a 1D-array. Then your class can present it as a 2D structure."}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1548278129, "post_id": 54335352, "comment_id": 95488792, "body": "As to side question 2, your syntax is already correct. You can, however, not specialize just part of the class. A class specialization has no relationship to the base template. It could be a completely different class. You have to specialize the entire class."}, {"owner": {"reputation": 1480, "user_id": 9502856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d386dd3fdda4721337ad56c73fdd1dd?s=128&d=identicon&r=PG&f=1", "display_name": "Michele Piccolini", "link": "https://stackoverflow.com/users/9502856/michele-piccolini"}, "reply_to_user": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1549182700, "post_id": 54335352, "comment_id": 95806654, "body": "@super what do you mean by &quot;safe&quot;? More comfortable to write and handle for me? More secure? More efficient?"}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1549185655, "post_id": 54335352, "comment_id": 95807228, "body": "More efficient, and probably more comfortable to write and handle as well."}], "answers": [{"comments": [{"owner": {"reputation": 1480, "user_id": 9502856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d386dd3fdda4721337ad56c73fdd1dd?s=128&d=identicon&r=PG&f=1", "display_name": "Michele Piccolini", "link": "https://stackoverflow.com/users/9502856/michele-piccolini"}, "edited": false, "score": 0, "creation_date": 1549124293, "post_id": 54335560, "comment_id": 95795223, "body": "Thank you. This allows me to specialize the constructor just for the size==3 case. But I have a few doubts left: 1) should the implementation of that constructor be inside the class definition, or it can/should be outside (and with what syntax?). 2) This would let me pass any number of Vec3 to the constructor, while I want to be allowed to pass 3 and only 3 Vec3 in the initialization list. Is it possible to enfore this?"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 1480, "user_id": 9502856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d386dd3fdda4721337ad56c73fdd1dd?s=128&d=identicon&r=PG&f=1", "display_name": "Michele Piccolini", "link": "https://stackoverflow.com/users/9502856/michele-piccolini"}, "edited": false, "score": 1, "creation_date": 1549137086, "post_id": 54335560, "comment_id": 95799068, "body": "@MichelePiccolini - answer improved; hope this helps."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 4, "last_activity_date": 1549137056, "last_edit_date": 1549137056, "creation_date": 1548277225, "answer_id": 54335560, "question_id": 54335352, "link": "https://stackoverflow.com/questions/54335352/specialize-only-constructor-in-template-keeping-best-performance-and-neat-inter/54335560#54335560", "title": "Specialize only constructor in template, keeping best performance and neat interface", "body": "<p>Question 1.</p>\n\n<blockquote>\n  <p>Is it possible to just specialize a constructor in a templated class?</p>\n</blockquote>\n\n<p>I suppose you are looking something as follows</p>\n\n<pre><code>   template &lt;unsigned int s = size,\n             std::enable_if_t&lt; s == 3u, bool&gt; = true&gt;\n   Matrix (std::initializer_list&lt;Vec3&gt; values)\n    { }\n</code></pre>\n\n<p>The following is a full simplified compiling example</p>\n\n<pre><code>#include &lt;type_traits&gt;\n#include &lt;initializer_list&gt;\n\nstruct Vec3\n { };\n\ntemplate &lt;unsigned int size&gt;\nstruct Matrix\n {\n   // list of lists matrix constructor\n   Matrix (std::initializer_list&lt;std::initializer_list&lt;float&gt;&gt;)\n    { }\n\n   template &lt;unsigned int s = size,\n             std::enable_if_t&lt; s == 3u, bool&gt; = true&gt;\n   Matrix (std::initializer_list&lt;Vec3&gt; values)\n    { }\n };\n\nint main ()\n {\n   Matrix&lt;1&gt;  m1 {{1.0f}};\n   Matrix&lt;2&gt;  m2 {{1.0f}};\n   Matrix&lt;3&gt;  m3 {{1.0f}};\n   Matrix&lt;4&gt;  m4 {{1.0f}};\n\n   //Matrix&lt;1&gt;  m5 {{Vec3{}}};  // compilation error\n   //Matrix&lt;2&gt;  m6 {{Vec3{}}};  // compilation error\n   Matrix&lt;3&gt;  m7 {{Vec3{}}};\n   //Matrix&lt;4&gt;  m8 {{Vec3{}}};  // compilation error\n }\n</code></pre>\n\n<p>This isn't exactly \"specializing a constructor\"; this is \"SFINAE enabling\" a contructor.</p>\n\n<hr>\n\n<p>Question 3.</p>\n\n<blockquote>\n  <p>Is there a way to allow my constructor to use braces list syntax when instantiating an object (to have a cleaner and uniform syntax) while enforcing at the same time a fixed size of the list?</p>\n</blockquote>\n\n<p>Not with <code>std::initializer_list</code>.</p>\n\n<p>But you can obtain something similar with an good old C-style array.</p>\n\n<pre><code>   template &lt;unsigned int s = size,\n             std::enable_if_t&lt; s == 3u, bool&gt; = true&gt;\n   Matrix (Vec3 const (&amp;values)[3u])\n    { }\n</code></pre>\n\n<p>But this solution accept non only three <code>Vec3</code>'s but also one or two; the constructor receive ever an array of three with <code>Vec3{}</code> initialized with default constructor (if available) when not explicited</p>\n\n<pre><code>   Matrix&lt;3&gt;  m7a {{Vec3{}}};\n   Matrix&lt;3&gt;  m7b {{Vec3{}, Vec3{}}};\n   Matrix&lt;3&gt;  m7c {{Vec3{}, Vec3{}, Vec3{}}};\n   //Matrix&lt;3&gt;  m7d {{Vec3{}, Vec3{}, Vec3{}, Vec3{}}}; // compilation error\n</code></pre>\n\n<p><strong>-- EDIT --</strong></p>\n\n<p>The OP ask</p>\n\n<blockquote>\n  <p>1) should the implementation of that constructor be inside the class definition, or it can/should be outside (and with what syntax?)</p>\n</blockquote>\n\n<p>I'm used to define it inside the class but, if you declare it as follows inside the class</p>\n\n<pre><code>   template &lt;unsigned int s = size,\n             std::enable_if_t&lt; s == 3u, bool&gt; = true&gt;\n   Matrix (std::initializer_list&lt;Vec3&gt; values);\n</code></pre>\n\n<p>defining it, outside the body of the class, as follows should works</p>\n\n<pre><code>template &lt;&gt;\ntemplate &lt;&gt;\nMatrix&lt;3u&gt;::Matrix (std::initializer_list&lt;Vec3&gt; values)\n { }\n</code></pre>\n\n<blockquote>\n  <p>2) This would let me pass any number of Vec3 to the constructor, while I want to be allowed to pass 3 and only 3 Vec3 in the initialization list. Is it possible to enfore this?</p>\n</blockquote>\n\n<p>I don't think it's possible to enforce it, passing through <code>std::initializer_list</code>, because the number of the elements in the list isn't a template value (as in <code>std::array</code> or in a C-style array) or something that we can use compile time to enable SFINAE.</p>\n\n<p>You can use the solution based on a <code>Vec3[3]</code> C-style array (see my answer to question 3) but, unfortunately, accept also one or two <code>Vec3</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1480, "user_id": 9502856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d386dd3fdda4721337ad56c73fdd1dd?s=128&d=identicon&r=PG&f=1", "display_name": "Michele Piccolini", "link": "https://stackoverflow.com/users/9502856/michele-piccolini"}, "edited": false, "score": 0, "creation_date": 1549182807, "post_id": 54335624, "comment_id": 95806678, "body": "Thank you. How does this compare with respect to using a C-style array of fixed size? Do they achieve the same effect? And do they have side effects I might want to consider (such as efficiency, readability, etc.)?"}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "reply_to_user": {"reputation": 1480, "user_id": 9502856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d386dd3fdda4721337ad56c73fdd1dd?s=128&d=identicon&r=PG&f=1", "display_name": "Michele Piccolini", "link": "https://stackoverflow.com/users/9502856/michele-piccolini"}, "edited": false, "score": 1, "creation_date": 1549228097, "post_id": 54335624, "comment_id": 95818841, "body": "@MichelePiccolini, this question seems to be too broad for a comment. With C arrays you can enforce the number of element, with <code>initializer_list</code> you can&#39;t. Both, initializer lists and C arrays, are, in essence, just two pointers (or pointer + size), so a compiler generates similar assembly code for calling corresponding constructors. But the details can vary greatly in different situations (number of elements, whether they are known at compile time, is the constructor inlined, etc.) due to an optimizer."}], "tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": false, "score": 1, "last_activity_date": 1548278964, "last_edit_date": 1548278964, "creation_date": 1548277450, "answer_id": 54335624, "question_id": 54335352, "link": "https://stackoverflow.com/questions/54335352/specialize-only-constructor-in-template-keeping-best-performance-and-neat-inter/54335624#54335624", "title": "Specialize only constructor in template, keeping best performance and neat interface", "body": "<p>Another option, though not fully equivalent to SFINAE, is to use <code>static_assert</code>:</p>\n\n<pre><code>Matrix(std::initializer_list&lt;Vec3&gt;)\n{\n    static_assert(size == 3);\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 1480, "user_id": 9502856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d386dd3fdda4721337ad56c73fdd1dd?s=128&d=identicon&r=PG&f=1", "display_name": "Michele Piccolini", "link": "https://stackoverflow.com/users/9502856/michele-piccolini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 54335560, "answer_count": 2, "score": 3, "last_activity_date": 1549137056, "creation_date": 1548276304, "question_id": 54335352, "link": "https://stackoverflow.com/questions/54335352/specialize-only-constructor-in-template-keeping-best-performance-and-neat-inter", "title": "Specialize only constructor in template, keeping best performance and neat interface", "body": "<p><strong>1. Is it possible to just specialize a constructor in a templated class?</strong></p>\n\n<p>I have this example:</p>\n\n<pre><code>// squared matrix class\ntemplate &lt;unsigned int size&gt;\nclass Matrix {\npublic:\n    // list of lists matrix constructor\n    Matrix(std::initializer_list&lt;std::initializer_list&lt;float&gt;&gt; values);\n\n    // actual static data\n    float data[size][size];\n};\n</code></pre>\n\n<p>So basically I can instantiate squared matrices of any size by using nested initializer lists, like in:</p>\n\n<pre><code>Matrix &lt;3&gt; Identity {\n    {1.,0.,0.},\n    {0.,1.,0.},\n    {0.,0.,1.}\n};\n</code></pre>\n\n<p>Now I would like to provide <strong>just for 3x3 matrices</strong> a constructor that takes 3 3D vectors (<code>Vec3</code> class in my code) and uses them as the matrix's columns to build a 3x3 matrix.</p>\n\n<p>Is there a way of just specializing the constructor?</p>\n\n<p>If I specialize the entire class, like in:</p>\n\n<pre><code>template &lt;&gt;\nclass Matrix&lt;3&gt; {\npublic:\n    // build matrix providing 3 Vec3 (your basis) which will be the columns\n    Matrix(std::initializer_list&lt;Vec3&gt; basis_vectors);\n};\n</code></pre>\n\n<p>Then I get errors inside the ctor definition:</p>\n\n<pre><code>Matrix&lt;3&gt;::Matrix(std::initializer_list&lt;Vec3&gt; basis_vectors) {\n\n    // only accept 3 vectors\n    assert(basis_vectors.size() == 3);\n\n    // column counter\n    unsigned int j = 0;\n\n    for (auto &amp; col : basis_vectors) {\n        // copy a column (col to data[:][j])\n        data[0][j] = col[0];\n        data[1][j] = col[1];\n        data[2][j] = col[2];\n\n        // increase j for column\n        j++;\n    }\n}\n</code></pre>\n\n<p>like \"identifier 'data' is undefined\".</p>\n\n<p><strong>Notes</strong>: I would like to avoid inheritance as much as I can. Weird template patterns could be nice but it's maybe better to avoid those also (otherwise everything becomes even less readable than what is now).\nI would like to point out that my focus is performance, though. Therefore I am looking for the fastest and possibly cleanest solution (clean for the user that has to instantiate these classes, for example. That's why I'm using initializer lists in the constructor).</p>\n\n<hr>\n\n<p>Side questions:</p>\n\n<p><strong>2. What is the right syntax for specializing a constructor?</strong> </p>\n\n<p>I'm referring to: do I need to provide <code>template &lt;blabla&gt;</code>, or <code>template&lt;&gt;</code> or nothing before the method name? And what about the actual constructor method? Is it <code>Matrix()</code> or <code>Matrix&lt;3&gt;()</code>?</p>\n\n<p><strong>3. Is there a way to allow my constructor to use braces list syntax when instantiating an object (to have a cleaner and uniform syntax) while enforcing at the same time a fixed size of the list?</strong> </p>\n\n<p>In my case, I would like to have a constructor that just takes 3 <code>Vec3</code> (and knows that at compile time, without <code>assert</code>ing). But I would prefer to avoid the signature <code>Matrix(Vec3 a, Vec3 b, Vec3 c)</code>. Is this possible?</p>\n\n<p><strong>4. What's a cleaner and cahche-friendly way of doing what I'm trying to do, that is, setting columns in a 2D array?</strong></p>\n\n<p>If this requires to change entirely my data structures, using some neat C++11/17/20/whatever <code>std::something</code>, using something that already implements nD-array slicing, or implementing that myself, I'm here ready to do all of this.</p>\n\n<p>I just need some good amount of advice in all these things. It's so easy to start writing something and then to get lost into all these details and ending up writing nothing in the end, feeling that there are way too many directions where one could go and that might bring to non-optimal, non-readable, painful-to-refactor code :(</p>\n"}, {"tags": ["c++", "linear-programming", "gurobi", "mixed-integer-programming"], "comments": [{"owner": {"reputation": 4806, "user_id": 446610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115fdf94f87f4fc3f0a817e514e0cbfc?s=128&d=identicon&r=PG", "display_name": "Greg Glockner", "link": "https://stackoverflow.com/users/446610/greg-glockner"}, "edited": false, "score": 1, "creation_date": 1548282805, "post_id": 54335218, "comment_id": 95490663, "body": "Did you have warning messages about numerical issues?"}, {"owner": {"reputation": 2402, "user_id": 4621142, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Pa0B7.jpg?s=128&g=1", "display_name": "Bobface", "link": "https://stackoverflow.com/users/4621142/bobface"}, "reply_to_user": {"reputation": 4806, "user_id": 446610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115fdf94f87f4fc3f0a817e514e0cbfc?s=128&d=identicon&r=PG", "display_name": "Greg Glockner", "link": "https://stackoverflow.com/users/446610/greg-glockner"}, "edited": false, "score": 0, "creation_date": 1548286033, "post_id": 54335218, "comment_id": 95491646, "body": "@GregGlockner I had the output disabled. I think it aborts automatically when numerical difficulties happen. See <a href=\"http://gurobi.com/documentation/8.1/refman.pdf\" rel=\"nofollow noreferrer\">here</a> on page 701: <i>NUMERIC: Optimization was terminated due to unrecoverable numerical difficulties.</i> My model reported <i>OPTIMAL</i> instead."}], "owner": {"reputation": 2402, "user_id": 4621142, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Pa0B7.jpg?s=128&g=1", "display_name": "Bobface", "link": "https://stackoverflow.com/users/4621142/bobface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548275688, "creation_date": 1548275688, "question_id": 54335218, "link": "https://stackoverflow.com/questions/54335218/equality-constraint-being-ignored-in-mip-model", "title": "Equality constraint being ignored in MIP model", "body": "<p>I have a MIP model (<a href=\"http://www.gurobi.com\" rel=\"nofollow noreferrer\">Gurobi</a>) which contains the following constraint:</p>\n\n<pre><code>model.addConstr(rawOutputVar == rawInputVar * edge-&gt;getMultiplicator());\n</code></pre>\n\n<p><code>rawOutputVar</code> and <code>rawInputVar</code> are both continuous variables. <code>edge-&gt;getMultiplicator()</code> returns a small double.</p>\n\n<p>Upon running the model I saw the the constraint was \"ignored\". The value of <code>rawInputVar</code> was set to 0, while <code>rawOutputVar</code> was a huge number, with <code>edge-&gt;getMultiplicator()</code> being <code>0.0000346</code>. So the equation became:</p>\n\n<p><code>100000000 == 0 * 0.0000346</code></p>\n\n<p>which is obviously wrong. Gurobi reported the solution as <em>optimal</em> however. I replaced the equation with</p>\n\n<pre><code>model.addConstr(rawOutputVar &lt;= rawInputVar * edge-&gt;getMultiplicator());\nmodel.addConstr(rawInputVar * edge-&gt;getMultiplicator() &lt;= rawOutputVar);\n</code></pre>\n\n<p>which is basically the same. It now works correctly. </p>\n\n<p>I am wondering why my first attempt did not work correctly. Am I doing something fundamentally wrong? </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 2, "creation_date": 1548275763, "post_id": 54335190, "comment_id": 95487866, "body": "And the question is what exactly?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1548275825, "post_id": 54335190, "comment_id": 95487892, "body": "<code>a.begin()</code> returns an iterator to the first element (or <code>a.end()</code> if <code>a</code> doesn&#39;t contain any elements). <code>a.front()</code> accesses the first element directly (check <code>a.size()</code> first)."}, {"owner": {"reputation": 45, "user_id": 3812411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df60fe240930cf3ac145235eb08df49?s=128&d=identicon&r=PG&f=1", "display_name": "user3812411", "link": "https://stackoverflow.com/users/3812411/user3812411"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1548275974, "post_id": 54335190, "comment_id": 95487960, "body": "I am not able to write the code for it. I have tried multiple things but always get stuck when doing the recursion part since I usually have 3 arguments for quicksort but now am stuck with just one argument. @Borgleader"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1548276087, "post_id": 54335190, "comment_id": 95488009, "body": "What are your usual 3 arguments?  <code>vector&lt;int&gt;</code> probably has those 3 arguments encapsulated."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1548276147, "post_id": 54335190, "comment_id": 95488028, "body": "@user3812411 What prevents you from making another function with the signature you need (i.e with 3 arguments) and calling it from a function that has the signature that main requires?"}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1548276108, "creation_date": 1548276108, "answer_id": 54335313, "question_id": 54335190, "link": "https://stackoverflow.com/questions/54335190/quicksort-using-only-one-argument-vector-of-ints-and-first-element-as-pivot/54335313#54335313", "title": "Quicksort using only one argument (vector of ints) and first element as pivot", "body": "<p>Nothing keeps you from making <code>QuickSort</code> call a (recursive) helper function.</p>\n\n<p>For example:</p>\n\n<pre><code>static long long QuickSortWorker(vector&lt;int&gt; &amp;a, size_t start, size_t length) {\n    ...\n}\n\nlong long QuickSort(vector&lt;int&gt; &amp;a) {\n    return QuickSortWorker(a, 0, a.size());\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 3812411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df60fe240930cf3ac145235eb08df49?s=128&d=identicon&r=PG&f=1", "display_name": "user3812411", "link": "https://stackoverflow.com/users/3812411/user3812411"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 54335313, "answer_count": 1, "score": 0, "last_activity_date": 1548276108, "creation_date": 1548275566, "question_id": 54335190, "link": "https://stackoverflow.com/questions/54335190/quicksort-using-only-one-argument-vector-of-ints-and-first-element-as-pivot", "title": "Quicksort using only one argument (vector of ints) and first element as pivot", "body": "<p>I need to implement a Quicksort algorithm in C++ which is usually easy but the thing is I can only have the vector as my argument and must choose the first element as pivot. I only have to return the number of comparisons made by my algorithm.\nThis is my function and this cannot be changed since I have no control over the main.cpp file and only have control over the quicksort.cpp and quicksort.h files.</p>\n\n<pre><code> long long QuickSort(vector&lt;int&gt; &amp; a)\n</code></pre>\n"}, {"tags": ["c++", "constants", "language-lawyer", "undefined-behavior", "temporary-objects"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1548274094, "post_id": 54334861, "comment_id": 95487207, "body": "The temporary itself that is created by <code>A{}</code> is not const.  You are simply creating a const reference to it, and then you are casting away that const-ness then accessing the temporary. That does not change the const-ness of the temporary itself. It is not UB to cast away const-ness from a pointer/reference if you are sure the object being pointed/referenced is not actually const. It WOULD be UB if the object were actually const, eg <code>const A a; const A &amp;ref = a; const_cast&lt;A&amp;&gt;(ref).nonconst();</code>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1548274167, "post_id": 54334861, "comment_id": 95487228, "body": "You can even bind it to <code>A&amp;&amp;</code>."}, {"owner": {"reputation": 4371, "user_id": 2945027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etv49.jpg?s=128&g=1", "display_name": "Alex Guteniev", "link": "https://stackoverflow.com/users/2945027/alex-guteniev"}, "edited": false, "score": 2, "creation_date": 1548274227, "post_id": 54334861, "comment_id": 95487259, "body": "I don&#39;t think it is really called temporary, as const reference prolongs lifetime in this case."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1548274380, "post_id": 54334861, "comment_id": 95487327, "body": "In response to your edit, <a href=\"http://coliru.stacked-crooked.com/a/215f88184c350c75\" rel=\"nofollow noreferrer\">yes</a>"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 4371, "user_id": 2945027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etv49.jpg?s=128&g=1", "display_name": "Alex Guteniev", "link": "https://stackoverflow.com/users/2945027/alex-guteniev"}, "edited": false, "score": 0, "creation_date": 1548298236, "post_id": 54334861, "comment_id": 95494137, "body": "@AlexanderGutenev How do you call it?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1548298552, "post_id": 54334861, "comment_id": 95494203, "body": "@Jarod42 Temporaries were never inherently immutable in C++; historically you could do <code>string() = &quot;hello&quot;</code> or <code>vector&lt;int&gt;().push_back(1)</code>. (And there was no rvalue reference at that time.)"}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1548345610, "post_id": 54334861, "comment_id": 95516773, "body": "@RemyLebeau <i>The temporary itself that is created by <code>A{}</code> is not const.</i> In C++17, <code>A{}</code> does not even create a temporary object."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 4371, "user_id": 2945027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etv49.jpg?s=128&g=1", "display_name": "Alex Guteniev", "link": "https://stackoverflow.com/users/2945027/alex-guteniev"}, "edited": false, "score": 0, "creation_date": 1549167081, "post_id": 54334861, "comment_id": 95804564, "body": "@AlexanderGutenev &quot;<i>I don&#39;t think it is really called temporary</i>&quot; How do you call it?"}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 3, "last_activity_date": 1548276461, "last_edit_date": 1548276461, "creation_date": 1548274742, "answer_id": 54335021, "question_id": 54334861, "link": "https://stackoverflow.com/questions/54334861/is-temporary-object-originally-const/54335021#54335021", "title": "Is temporary object originally const?", "body": "<p>The type of a temporary is whatever type you declared it with.  </p>\n\n<p>Unfortunately, as <a href=\"https://stackoverflow.com/users/5632316/oliv\">Oliv</a> points out in <a href=\"https://stackoverflow.com/a/54335024/4342498\">their answer</a> reference initialization rules transform the type to match the reference type so in this case <code>a</code> actually refers to a <code>const A</code>.  It is basically doing</p>\n\n<pre><code>using const_A = const A;\nconst A&amp; a = const_A{};\n</code></pre>\n\n<hr>\n\n<p>Because you can actually create constant prvalues if you ever want to stop a overload set from accepting a constant prvalue you need to have</p>\n\n<pre><code>ret_type function_name(some_type const&amp;&amp;) = delete;\n</code></pre>\n\n<p>otherwise if you have</p>\n\n<pre><code>ret_type function_name(some_type const&amp;)\n</code></pre>\n\n<p>in the overload set it then the constant prvalue would bind to that if you only deleted</p>\n\n<pre><code>ret_type function_name(some_type&amp;&amp;)\n</code></pre>\n\n<p>instead. You can see this working with</p>\n\n<pre><code>struct bar{};\n\nvoid foo(bar const&amp;) { std::cout &lt;&lt; \"void foo(bar const&amp;)\\n\"; }\nvoid foo(bar&amp;&amp;) =delete;\n\nusing c_bar = const bar;\n\nint main()\n{   \n    foo(c_bar{});\n}\n</code></pre>\n\n<p>Here, <code>void foo(bar const&amp;)</code> gets called since <code>c_bar{}</code> is actually <code>const</code> instead of getting a deleted function error if you had used <code>foo(bar{});</code>.  Adding</p>\n\n<pre><code>void foo(bar const&amp;&amp;) = delete;\n</code></pre>\n\n<p>is needed to actually stop <code>foo(c_bar{});</code> from compiling.</p>\n"}, {"comments": [{"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 1, "creation_date": 1548338147, "post_id": 54335024, "comment_id": 95511931, "body": "<i>So the code const_cast&lt;A&amp;&gt;(a).nonconst(); is undefined behavior</i> I&#39;ve thought UB is to modify a const object. Here there is no modification."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1548350694, "post_id": 54335024, "comment_id": 95519810, "body": "@LanguageLawyer True I supposed the code above was an illustration not the production code. So I did not considered the body of nonconst as meaningfull."}], "tags": [], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "is_accepted": true, "score": 9, "last_activity_date": 1548274749, "creation_date": 1548274749, "answer_id": 54335024, "question_id": 54334861, "link": "https://stackoverflow.com/questions/54334861/is-temporary-object-originally-const/54335024#54335024", "title": "Is temporary object originally const?", "body": "<p>The initialization of the reference <code>a</code> is given by <a href=\"http://eel.is/c++draft/dcl.init.ref#5.3\" rel=\"noreferrer\">[dcl.init.ref]/5</a> (bold mine):</p>\n\n<blockquote>\n  <p>Otherwise, if the initializer expression</p>\n  \n  <ul>\n  <li>is an rvalue (but not a bit-field)[...]</li>\n  </ul>\n  \n  <p>then the value of the initializer expression in the first case and the result of the conversion in the second case is called the converted initializer.\n  <strong>If the converted initializer is a prvalue, its type T4 is adjusted to type \u201ccv1 T4\u201d ([conv.qual])</strong> and the temporary materialization conversion ([conv.rval]) is applied.</p>\n</blockquote>\n\n<p>So it means that the type prvalue expression that initialize the reference, <code>A{}</code>, is adjusted to <code>const A</code>.</p>\n\n<p>Then <a href=\"http://eel.is/c++draft/conv.rval#1\" rel=\"noreferrer\">[conv.rval]</a> states:</p>\n\n<blockquote>\n  <p>A prvalue of type T can be converted to an xvalue of type T.\n  This conversion initializes a temporary object ([class.temporary]) of type T.</p>\n</blockquote>\n\n<p>So the type of the temporary object, bound to the reference is the same as the adjusted <code>prvalue</code> type: <code>const A</code>.</p>\n\n<p>So the code <code>const_cast&lt;A&amp;&gt;(a).nonconst();</code> is <em>undefined behavior</em>.</p>\n"}], "owner": {"reputation": 2279, "user_id": 2288628, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8e7edd8267abc525a6c48d87d7f7fcf5?s=128&d=identicon&r=PG", "display_name": "PoweredByRice", "link": "https://stackoverflow.com/users/2288628/poweredbyrice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 6, "accepted_answer_id": 54335024, "answer_count": 2, "score": 11, "last_activity_date": 1548298194, "creation_date": 1548273961, "last_edit_date": 1548298194, "question_id": 54334861, "link": "https://stackoverflow.com/questions/54334861/is-temporary-object-originally-const", "title": "Is temporary object originally const?", "body": "<p>Is this code UB?</p>\n\n<pre><code>struct A\n{\n void nonconst() {}\n};\n\nconst A&amp; a = A{};\nconst_cast&lt;A&amp;&gt;(a).nonconst();\n</code></pre>\n\n<p>In other words, is the (temporary) object originally <code>const</code>? I've looked through the standard but cannot find an answer so would appreciate quotations to relevant sections.</p>\n\n<p><strong><em>Edit:</em></strong> for those saying <code>A{}</code> is not <code>const</code>, then can you do <code>A{}.nonconst()</code> ?</p>\n"}, {"tags": ["c++", "qt", "placeholder"], "answers": [{"tags": [], "owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "is_accepted": true, "score": 0, "last_activity_date": 1548274780, "creation_date": 1548274780, "answer_id": 54335028, "question_id": 54334801, "link": "https://stackoverflow.com/questions/54334801/customplaceholder-has-no-matching-function-to-call-qt-label/54335028#54335028", "title": "Customplaceholder has no matching function to call QT label", "body": "<p>You are missing a constructor which takes parent widget. General advice against this is to create new QObject subclasses using Qt Creator new class wizard, it will get everything right. But to solve the problem with this class, try replacing your default constructor with this constructor:</p>\n\n<p>Declaration in .h:</p>\n\n<pre><code>explicit WatchListLabel(QWidget *parent = nullptr);\n</code></pre>\n\n<p>Definition in .cpp:</p>\n\n<pre><code>WatchListLabel::WatchListLabel(QWidget *parent)\n    : QLabel(parent) \n    //, any other member variable initializations\n{\n    // any constructor code if needed\n}\n</code></pre>\n"}], "owner": {"reputation": 46, "user_id": 8827966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e81b6104cc76cc68ea46dc66ec962d4?s=128&d=identicon&r=PG&f=1", "display_name": "Helge", "link": "https://stackoverflow.com/users/8827966/helge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 54335028, "answer_count": 1, "score": 0, "last_activity_date": 1548274780, "creation_date": 1548273612, "question_id": 54334801, "link": "https://stackoverflow.com/questions/54334801/customplaceholder-has-no-matching-function-to-call-qt-label", "title": "Customplaceholder has no matching function to call QT label", "body": "<p>I have a problem regarding my QT project. I want to create a touchable Qlabel, so I created a placeholder in the gui designer and referenced it to my \"watchlistlabel\" which extends from QLabel. When I now start my app I get the error \" no matching function for call to WatchListLabel::WatchListLabel(QGroupBox*&amp;)'\nname1 = new WatchListLabel(groupBox_3); </p>\n\n<p>My labels are in a groupbox does this affect my code?\nwhy it cant find a matching function?\n                                              ^</p>\n\n<pre><code> #include&lt;QLabel&gt;\n\n  class WatchListLabel: public QLabel\n{\n   Q_OBJECT\n  private: \n     void mousePressEvent(QMouseEvent * event) override;\n public:\n    WatchListLabel();\n };\n</code></pre>\n\n<p>watchlistlabel.cpp</p>\n\n<pre><code>  #include \"watchlistlabel.h\"\n\n void WatchListLabel::mousePressEvent(QMouseEvent *event)\n {\n\n\n\n    }\n\n  WatchListLabel::WatchListLabel()\n {\n\n }\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/UMNu4.png\" rel=\"nofollow noreferrer\">QTdesigner</a></p>\n"}, {"tags": ["c++", "eigen"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548273978, "post_id": 54334787, "comment_id": 95487168, "body": "Assuming <a href=\"https://github.com/libigl/eigen/blob/master/bench/BenchTimer.h\" rel=\"nofollow noreferrer\">this</a> is your source file, the error is at line <a href=\"https://github.com/libigl/eigen/blob/master/bench/BenchTimer.h#L31\" rel=\"nofollow noreferrer\"><code>asm volatile(&quot;&quot; : : &quot;g&quot;(p) : &quot;memory&quot;);</code></a>."}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 1, "creation_date": 1548283619, "post_id": 54334787, "comment_id": 95490915, "body": "You need to comment out those two inline asm statements to make MSVC happy."}, {"owner": {"reputation": 598, "user_id": 1734357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gaD24.jpg?s=128&g=1", "display_name": "WurmD", "link": "https://stackoverflow.com/users/1734357/wurmd"}, "edited": false, "score": 0, "creation_date": 1548327399, "post_id": 54334787, "comment_id": 95505498, "body": "Hi ggael, is this a known issue? Should I (or you) create an &#39;Issue&#39; in the repository?"}], "answers": [{"tags": [], "owner": {"reputation": 598, "user_id": 1734357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gaD24.jpg?s=128&g=1", "display_name": "WurmD", "link": "https://stackoverflow.com/users/1734357/wurmd"}, "is_accepted": true, "score": 0, "last_activity_date": 1548327873, "creation_date": 1548327873, "answer_id": 54345155, "question_id": 54334787, "link": "https://stackoverflow.com/questions/54334787/bench-benchtimer-h-31-syntax-error-volatile/54345155#54345155", "title": "bench/BenchTimer.h (31) syntax error: &#39;volatile&#39;", "body": "<p>As ggael mentioned, the solution is commenting the two offending code lines:</p>\n\n<pre><code>static void escape(void *p) {\n  //asm volatile(\"\" : : \"g\"(p) : \"memory\");\n}\n\nstatic void clobber() {\n  //asm volatile(\"\" : : : \"memory\");\n}\n</code></pre>\n\n<p>This \"volatile\" does not seem supported/accepted by MSVS2017</p>\n\n<p>It is however already fixed by ggael in the newest version of the repository :)</p>\n"}], "owner": {"reputation": 598, "user_id": 1734357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gaD24.jpg?s=128&g=1", "display_name": "WurmD", "link": "https://stackoverflow.com/users/1734357/wurmd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 54345155, "answer_count": 1, "score": 0, "last_activity_date": 1548327873, "creation_date": 1548273554, "last_edit_date": 1548327776, "question_id": 54334787, "link": "https://stackoverflow.com/questions/54334787/bench-benchtimer-h-31-syntax-error-volatile", "title": "bench/BenchTimer.h (31) syntax error: &#39;volatile&#39;", "body": "<p>Could you help me with this flabbergasting error in Eigen? \"bench/BenchTimer.h (31) syntax error: 'volatile'\"</p>\n\n<p>The offending code: <strong>bench/BenchTimer.h</strong></p>\n\n<pre><code>static void escape(void *p) {\n  asm volatile(\"\" : : \"g\"(p) : \"memory\");\n}\n\nstatic void clobber() {\n  asm volatile(\"\" : : : \"memory\");\n}\n</code></pre>\n\n<p>My code: <strong>tests.cpp</strong></p>\n\n<pre><code>    #include &lt;iostream&gt;\n    #include &lt;bench/BenchTimer.h&gt;\n\n    int main() {\n            Eigen::BenchTimer t;\n            t.reset(); t.start();\n\n            //TestEigenSolveSpeed();\n\n            t.stop();\n            std::cout &lt;&lt; t.value()  &lt;&lt; std::endl;\n\n            return 0;\n    }\n</code></pre>\n\n<p><strong>CMakeLists.txt</strong></p>\n\n<pre><code>    cmake_minimum_required(VERSION 3.11)\n\n    set(LEVELING_NAME test-eigen)\n\n    project(${LEVELING_NAME})\n\n    add_executable(${LEVELING_NAME} tests.cpp )\n\n    target_include_directories(${LEVELING_NAME} PUBLIC\n            ${CMAKE_CURRENT_LIST_DIR}/deps/eigen-master \n    )\n</code></pre>\n\n<p><strong>Folder structure:</strong></p>\n\n<pre><code>    /\n    |\n    -- CMakeLists.txt\n    -- tests.cpp\n    -- deps\n       |\n       -- eigen-master\n</code></pre>\n\n<p>Created solution with:\n<code>cmake . -DCMAKE_GENERATOR_PLATFORM=x64 -B build</code></p>\n\n<p>In Windows, in VS2017</p>\n\n<p>with newest repository version: master version 3.3.3</p>\n\n<p>Here is the three files plus the repository in a zip for ease of reproduction: <a href=\"https://www.dropbox.com/s/avpfbabo4l9ti5h/test-eigen-error-volatile.zip?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/avpfbabo4l9ti5h/test-eigen-error-volatile.zip?dl=0</a></p>\n"}, {"tags": ["c++", "winapi", "com", "sensors"], "comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 1, "creation_date": 1548283707, "post_id": 54334740, "comment_id": 95490946, "body": "If you only load the gyroscope, does it work? Try the sensor diagnostic tool to verify that it is not a hardware limitation. Sensors can be loaded together."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1548291554, "post_id": 54334740, "comment_id": 95492788, "body": "All you have shown is the code that creates an <code>ISensorManager</code> COM object, but not any of the code that actually uses it, or sets up the individual sensors and their event sinks, or processes their events. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates your problem in action."}, {"owner": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "edited": false, "score": 1, "creation_date": 1548318732, "post_id": 54334740, "comment_id": 95500464, "body": "What the code &quot;do more here&quot; is? Is there anything like <code>while(true)</code> or other loop in it? And can you make sure that the program actually runs to the line <code>new GyroscopeCallBack()</code> ?"}, {"owner": {"reputation": 286, "user_id": 8606035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00dc1fe3d87d042d46927e7b6ac6460d?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/8606035/taylor"}, "reply_to_user": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1548342478, "post_id": 54334740, "comment_id": 95514623, "body": "@Michael If I only load the gyroscope, it does work."}, {"owner": {"reputation": 286, "user_id": 8606035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00dc1fe3d87d042d46927e7b6ac6460d?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/8606035/taylor"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548342686, "post_id": 54334740, "comment_id": 95514756, "body": "@Remy Lebeau I would put the complete verifiable example, but I am afraid it might get the post too long, so I just wanted some suggestions."}, {"owner": {"reputation": 286, "user_id": 8606035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00dc1fe3d87d042d46927e7b6ac6460d?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/8606035/taylor"}, "reply_to_user": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "edited": false, "score": 0, "creation_date": 1548342941, "post_id": 54334740, "comment_id": 95514926, "body": "@DrakeWu-MSFT I have confirmed that the callback (C# to C++) works fine for both sensors. It just does not work when I initialize both of them together."}, {"owner": {"reputation": 286, "user_id": 8606035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00dc1fe3d87d042d46927e7b6ac6460d?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/8606035/taylor"}, "edited": false, "score": 0, "creation_date": 1548343017, "post_id": 54334740, "comment_id": 95514977, "body": "I have a gut feeling that it may because of <code>CoInitializeEx(NULL, COINIT_APARTMENTTHREADED);</code> and the message pump <code>GetMessage()</code> that is somehow blocking other sensor callbacks, but I have no clue on how to solve the issue."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1548352527, "post_id": 54334740, "comment_id": 95520680, "body": "@JohnW you should not be calling <code>CoInitializeEx</code> inside your sensor initialization functions at all. That belongs in your app startup code instead. But the main problem is that you are simply doing ALL of the work for the accelerometer before you even touch the gyroscope. That&#39;s easy to fix, just break up the code a little. Create 1 SensorManager, then setup the event sinks for both sensors within it, then run the message loop. Your initialization functions are doing more than just initialization, the message loop needs to be taken out of them and handled separately."}, {"owner": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "edited": false, "score": 0, "creation_date": 1548379119, "post_id": 54334740, "comment_id": 95530250, "body": "@JohnW As I have metioned,  Your initialization functions will not return unless the <code>GetMessage()</code> return 0. So the next line will not be executed."}, {"owner": {"reputation": 286, "user_id": 8606035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00dc1fe3d87d042d46927e7b6ac6460d?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/8606035/taylor"}, "reply_to_user": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "edited": false, "score": 0, "creation_date": 1548430849, "post_id": 54334740, "comment_id": 95550905, "body": "@DrakeWu-MSFT You are right. Is there a way to keep the sensor events triggering without using a Message pump? So far, that was the only way I could get this sensor events triggering constantly, but I would prefer not to use it since as you said it will not execute the next line unless the return value is 0."}], "answers": [{"tags": [], "owner": {"reputation": 286, "user_id": 8606035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00dc1fe3d87d042d46927e7b6ac6460d?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/8606035/taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1548434028, "creation_date": 1548434028, "answer_id": 54369333, "question_id": 54334740, "link": "https://stackoverflow.com/questions/54334740/retrieving-info-from-multiple-sensors-using-windows-sensor-api/54369333#54369333", "title": "Retrieving info from multiple sensors using Windows Sensor API", "body": "<p>It worked! Solution was to remove the message pump and use <code>COINIT_MULTITHREADED</code> option for <code>Coinitializine()</code>. Thanks for all the help.</p>\n"}], "owner": {"reputation": 286, "user_id": 8606035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00dc1fe3d87d042d46927e7b6ac6460d?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/8606035/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1548434028, "creation_date": 1548273365, "last_edit_date": 1548343135, "question_id": 54334740, "link": "https://stackoverflow.com/questions/54334740/retrieving-info-from-multiple-sensors-using-windows-sensor-api", "title": "Retrieving info from multiple sensors using Windows Sensor API", "body": "<p>I am using the Windows Sensor API to get info from various sensors including accelerometer and gyroscope. (<a href=\"https://docs.microsoft.com/en-us/windows/desktop/sensorsapi/sensor-api-programming-guide\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/desktop/sensorsapi/sensor-api-programming-guide</a>)</p>\n\n<p>My initial implementation of sensor driver for accelerometer worked - I asynchronously can get the values for that sensor. </p>\n\n<p>The working initialization code for a single sensor (accelerometer) looks like the following:</p>\n\n<pre><code>void initialize1(AccelerometerCallBack callBack) {\n\n    HRESULT hr = S_OK;\n    CoInitializeEx(NULL, COINIT_APARTMENTTHREADED);\n\n    ISensorManager* pSensorManager = NULL;\n    ISensorCollection* pSensorColl = NULL;\n    ISensor* accelerometer = NULL;\n\n    hr = CoCreateInstance(CLSID_SensorManager,\n        NULL, CLSCTX_INPROC_SERVER,\n        IID_PPV_ARGS(&amp;pSensorManager));\n\n    if (SUCCEEDED(hr))\n    {\n        printf(\"Succeeded getting Sensor...\\n\");\n        ULONG ulCount = 0;\n        // Verify that the collection contains\n        // at least one sensor.\n        hr = pSensorColl-&gt;GetCount(&amp;ulCount);\n        if (SUCCEEDED(hr))\n        {\n            if (ulCount &lt; 1)\n            {\n                wprintf_s(L\"\\nNo sensors of the requested category.\\n\");\n                hr = E_UNEXPECTED;\n            }\n        }\n    }\n    else {\n        printf(\"Failed to get Sensor...\\n\");\n    }\n\n    if (SUCCEEDED(hr))\n    {\n        // Get the first available sensor.\n        hr = pSensorColl-&gt;GetAt(0, &amp;accelerometer);\n\n        BSTR name = 0;\n        hr = accelerometer-&gt;GetFriendlyName(&amp;name);\n        wprintf(L\"%s\\n\", name);\n    }\n\n    AccelerometerEvent* pEventClass = NULL;\n    ISensorEvents* pMyEvents = NULL;\n    if (SUCCEEDED(hr))\n    {\n        // Create an instance of the event class.\n        pEventClass = new(std::nothrow) AccelerometerEvent();\n        pEventClass-&gt;globalCallBack = callBack;\n    }\n\n    if (SUCCEEDED(hr))\n    {\n        // Retrieve the pointer to the callback interface.\n        hr = pEventClass-&gt;QueryInterface(IID_PPV_ARGS(&amp;pMyEvents));\n    }\n\n    if (SUCCEEDED(hr))\n    {\n        // Start receiving events.\n        hr = accelerometer-&gt;SetEventSink(pMyEvents);\n    }\n\n    MSG msg;\n    BOOL bRet;\n    while ((bRet = GetMessage(&amp;msg, NULL, 0, 0)) != 0)\n    {\n        if (bRet == -1)\n        {\n        // handle the error and possibly exit\n        }\n        else\n        {\n            TranslateMessage(&amp;msg);\n            DispatchMessage(&amp;msg);\n        }\n    }\n}\n</code></pre>\n\n<p>Now I wanted to simultaneously get the gyroscope, so I add a similar initialization code:</p>\n\n<p><code>void initialize2(GyroscopeCallBack callBack);</code>, which does similar thing as above.</p>\n\n<p>Now my C# layer triggers those code like this: </p>\n\n<pre><code>internal void Start()\n{\n    AccelerometerCallBack myCallBack1 = new AccelerometerCallBack(onAccelerometerDataChanged);\n    initialize1(myCallBack1);\n\n    GyroscopeCallBack myCallBack2 = new GyroscopeCallBack(onGyroscopeDataChanged);\n    initialize2(myCallBack2);\n}\n</code></pre>\n\n<p>However, only the accelerometer info is received through the callback, not the gyroscope's. </p>\n\n<ul>\n<li>I have confirmed that my device has both sensors of the correct type</li>\n<li>I have confirmed that my callback functions and C# to C++ interface all works properly</li>\n</ul>\n\n<p><strong>What is the correct way to \"fetch\" multiple sensors (instead of one) using the Windows Sensor API?</strong></p>\n\n<p>There are no examples on the official website about doing this, and the only related SO post (<a href=\"https://stackoverflow.com/questions/14325827/exposing-multiple-sensors-on-a-single-device-to-windows-sensor-api\">Exposing multiple sensors on a single device to Windows Sensor API</a>) does not help. Thanks!</p>\n"}, {"tags": ["c++", "qt", "sqlite", "qt5", "qsqltablemodel"], "answers": [{"comments": [{"owner": {"reputation": 3061, "user_id": 881712, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/852956f1a8a603a7d09d10e856f821be?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/881712/mark"}, "edited": false, "score": 0, "creation_date": 1548278422, "post_id": 54335692, "comment_id": 95488922, "body": "Works perfectly"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 2, "last_activity_date": 1548277833, "creation_date": 1548277833, "answer_id": 54335692, "question_id": 54334601, "link": "https://stackoverflow.com/questions/54334601/qsqltablemodelsetdata-returns-false-also-with-qteditmode/54335692#54335692", "title": "QSqlTableModel::setData() returns false also with Qt::EditMode", "body": "<p>If the <a href=\"http://code.qt.io/cgit/qt/qtbase.git/tree/src/sql/models/qsqltablemodel.cpp?h=dev#n574\" rel=\"nofollow noreferrer\">source code</a> is revised, the problem is understood:</p>\n\n<pre><code>bool QSqlTableModel::setData(const QModelIndex &amp;index, const QVariant &amp;value, int role)\n{\n    // ...\n\n    if (!(flags(index) &amp; Qt::ItemIsEditable))\n        return false;\n    // ...\n}\n</code></pre>\n\n<p>It is seen that if the QModelIndex is not editable then setData will do nothing and return false as in this case.</p>\n\n<p>So the solution is to enable the edition but I guess you do not want that column to be editable so instead of using the flag we will place a delegate that does not allow the editing:</p>\n\n<pre><code>Qt::ItemFlags ModelOperators::flags(const QModelIndex &amp;index) const\n{\n    switch (index.column())\n    {\n    case MODEL_OPERATORS_COL_NAME: return Qt::ItemIsEnabled | Qt::ItemIsSelectable | Qt::ItemIsEditable;\n    case MODEL_OPERATORS_COL_SIGNATURE: return Qt::ItemIsEnabled | Qt::ItemIsSelectable | Qt::ItemIsEditable;\n    default: return Qt::NoItemFlags;\n    }\n}\n</code></pre>\n\n<hr>\n\n<pre><code>class ReadOnlyDelegate: public QStyledItemDelegate\n{\npublic:\n    using QStyledItemDelegate::QStyledItemDelegate;\n    QWidget *createEditor(QWidget */*parent*/, const QStyleOptionViewItem &amp; /*option*/, const QModelIndex &amp;/*index*/) const override\n    {\n        return nullptr;\n    }\n};\n</code></pre>\n\n<hr>\n\n<pre><code>_modelOperators = new ModelOperators(this, QSqlDatabase::database(\"dbApp\"));\nui-&gt;tableOperators-&gt;setModel(_modelOperators);\nui-&gt;tableOperators-&gt;hideColumn(MODEL_OPERATORS_COL_ID);\nui-&gt;tableOperators-&gt;sortByColumn(MODEL_OPERATORS_COL_NAME);\nui-&gt;tableOperators-&gt;setItemDelegate(&amp;_delegateOperators);\n\nReadOnlyDelegate *delegate = new ReadOnlyDelegate(ui-&gt;tableOperators);\nui-&gt;tableOperators-&gt;setItemDelegateForColumn(MODEL_OPERATORS_COL_SIGNATURE, delegate);\n</code></pre>\n"}], "owner": {"reputation": 3061, "user_id": 881712, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/852956f1a8a603a7d09d10e856f821be?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/881712/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 1, "accepted_answer_id": 54335692, "answer_count": 1, "score": 2, "last_activity_date": 1548277833, "creation_date": 1548272826, "last_edit_date": 1548272945, "question_id": 54334601, "link": "https://stackoverflow.com/questions/54334601/qsqltablemodelsetdata-returns-false-also-with-qteditmode", "title": "QSqlTableModel::setData() returns false also with Qt::EditMode", "body": "<p>The <a href=\"http://doc.qt.io/qt-5/qsqltablemodel.html#setData\" rel=\"nofollow noreferrer\">documentation</a> of <code>QSqlTableModel::setData()</code> says:</p>\n\n<blockquote>\n  <p>Returns false if the role is not Qt::EditRole. To set data for roles other than EditRole, either use a custom proxy model or subclass QSqlTableModel.</p>\n</blockquote>\n\n<p>but I still get <code>false</code> even if the the role is <code>Qt::EditRole</code>.</p>\n\n<p>My model:</p>\n\n<pre><code>#ifndef MODELOPERATORS_H\n#define MODELOPERATORS_H\n\n#include &lt;QSqlTableModel&gt;\n\nenum\n{\n    MODEL_OPERATORS_COL_ID,\n    MODEL_OPERATORS_COL_NAME,\n    MODEL_OPERATORS_COL_SIGNATURE,\n\n    MODEL_OPERATORS_COL_COUNT\n};\n\nclass ModelOperators : public QSqlTableModel\n{\n    Q_OBJECT\n\npublic:\n    typedef struct\n    {\n        QString name;\n        QString signature;\n    } item_t;\n\n    ModelOperators(QObject *parent = nullptr, QSqlDatabase db = QSqlDatabase());\n    ~ModelOperators();\n    QVariant headerData(int section, Qt::Orientation orientation, int role) const;\n    Qt::ItemFlags flags(const QModelIndex &amp;index) const;\n};\n\n#endif // MODELOPERATORS_H\n\n#include \"modeloperators.h\"\n\nModelOperators::ModelOperators(QObject *parent, QSqlDatabase db) : QSqlTableModel(parent, db)\n{\n    setTable(\"operators\");\n    setEditStrategy(QSqlTableModel::OnFieldChange);\n    select();\n}\n\nModelOperators::~ModelOperators() { }\n\nQVariant ModelOperators::headerData(int section, Qt::Orientation orientation, int role) const\n{\n    if (orientation == Qt::Horizontal)\n    {\n        if (role == Qt::TextAlignmentRole) return Qt::AlignCenter;\n        if (role == Qt::DisplayRole)\n        {\n            switch(section)\n            {\n            case MODEL_OPERATORS_COL_NAME: return tr(\"Name\");\n            case MODEL_OPERATORS_COL_SIGNATURE: return tr(\"Signature\");\n            default: return \"\";\n            }\n        }\n    }\n    return QVariant();\n}\n\nQt::ItemFlags ModelOperators::flags(const QModelIndex &amp;index) const\n{\n    switch (index.column())\n    {\n    case MODEL_OPERATORS_COL_NAME: return Qt::ItemIsEnabled | Qt::ItemIsSelectable | Qt::ItemIsEditable;\n    case MODEL_OPERATORS_COL_SIGNATURE: return Qt::ItemIsEnabled | Qt::ItemIsSelectable;\n    default: return Qt::NoItemFlags;\n    }\n}\n</code></pre>\n\n<p>Table definition:</p>\n\n<pre><code>bool DatabaseManager::appCreateTableOperators()\n{\n    QSqlQuery query(QSqlDatabase::database(\"dbApp\"));\n    query.prepare(\"CREATE TABLE operators (\"\n                  \"id INTEGER PRIMARY KEY, \"\n                  \"name TEXT, \"\n                  \"signature TEXT)\");\n\n    return query.exec();\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>DialogSettings::DialogSettings(QWidget *parent) : QDialog(parent), ui(new Ui::DialogSettings)\n{\n    ui-&gt;setupUi(this);\n\n    _modelOperators = new ModelOperators(this, QSqlDatabase::database(\"dbApp\"));\n    ui-&gt;tableOperators-&gt;setModel(_modelOperators);\n    ui-&gt;tableOperators-&gt;hideColumn(MODEL_OPERATORS_COL_ID);\n    ui-&gt;tableOperators-&gt;sortByColumn(MODEL_OPERATORS_COL_NAME);\n    ui-&gt;tableOperators-&gt;setItemDelegate(&amp;_delegateOperators);\n}\n\nvoid DialogSettings::on_btnOperatorsBrowse_clicked()\n{\n    if (ui-&gt;tableOperators-&gt;selectionModel()-&gt;hasSelection())\n    {\n        QString filename = QFileDialog::getOpenFileName(this, tr(\"Select signature image\"), QDir::homePath(), tr(\"Portable Network Graphics (*.png)\"));\n        if (filename.isEmpty()) return;\n        int row = ui-&gt;tableOperators-&gt;selectionModel()-&gt;currentIndex().row();\n        QModelIndex index = _modelOperators-&gt;index(row, MODEL_OPERATORS_COL_SIGNATURE);\n        qDebug() &lt;&lt; _modelOperators-&gt;setData(index, filename, Qt::EditRole);\n    }\n}\n</code></pre>\n\n<p>But it returns <code>false</code> and of course the db is not updated;</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 7, "creation_date": 1548272623, "post_id": 54334545, "comment_id": 95486606, "body": "If you are using C++ why aren&#39;t you using <code>std::string</code>? It saves all the problems of having to manually <code>new[]</code>, <code>delete[]</code>, <code>memcpy</code>, etc."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1548272660, "post_id": 54334545, "comment_id": 95486630, "body": "You are not <code>delete[]</code>ing the old memory that <code>name</code> previously points to before reassigning <code>name</code> to point at new memory. That is your leak.  Also, make sure you are following the <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">Rule of 3/5/0</a> in your class to avoid other similar leaks."}, {"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "edited": false, "score": 1, "creation_date": 1548272661, "post_id": 54334545, "comment_id": 95486631, "body": "You might be calling <code>setName()</code> multiple times but it gets deleted only once since its in destructor."}, {"owner": {"reputation": 1471, "user_id": 202893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1IpHb.jpg?s=128&g=1", "display_name": "Danielle Paquette-Harvey", "link": "https://stackoverflow.com/users/202893/danielle-paquette-harvey"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548272708, "post_id": 54334545, "comment_id": 95486648, "body": "I was about to say the same as @RemyLebeau :-)"}, {"owner": {"reputation": 21, "user_id": 10549330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i5YcgM_J7aQ/AAAAAAAAAAI/AAAAAAAAEEY/iH1izpdsh2Y/photo.jpg?sz=128", "display_name": "Vikram Pasupathy", "link": "https://stackoverflow.com/users/10549330/vikram-pasupathy"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1548272777, "post_id": 54334545, "comment_id": 95486681, "body": "@CoryKramer I&#39;m forced to use char[]"}, {"owner": {"reputation": 21, "user_id": 10549330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i5YcgM_J7aQ/AAAAAAAAAAI/AAAAAAAAEEY/iH1izpdsh2Y/photo.jpg?sz=128", "display_name": "Vikram Pasupathy", "link": "https://stackoverflow.com/users/10549330/vikram-pasupathy"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548272868, "post_id": 54334545, "comment_id": 95486715, "body": "@RemyLebeau how do I delete the old memory name points to"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548272939, "post_id": 54334545, "comment_id": 95486738, "body": "@VikramPasupathy the same way you do in your destructor - using <code>delete[]</code>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1548275721, "post_id": 54334545, "comment_id": 95487849, "body": "@VikramPasupathy -- <i>I am forced to use char[]</i> -- Create your own string class that does basic things, and just use it.  You have most of the code now to do this, it&#39;s just that you&#39;ve got it tangled up in a <code>Student</code> class."}], "answers": [{"comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 1, "creation_date": 1548273033, "post_id": 54334624, "comment_id": 95486774, "body": "Obviously we&#39;re following the good practices so... <code>nullptr</code>?"}, {"owner": {"reputation": 21, "user_id": 10549330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i5YcgM_J7aQ/AAAAAAAAAAI/AAAAAAAAEEY/iH1izpdsh2Y/photo.jpg?sz=128", "display_name": "Vikram Pasupathy", "link": "https://stackoverflow.com/users/10549330/vikram-pasupathy"}, "edited": false, "score": 0, "creation_date": 1548273035, "post_id": 54334624, "comment_id": 95486775, "body": "Conditional jump or move depends on uninitialised value(s)"}, {"owner": {"reputation": 21, "user_id": 10549330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i5YcgM_J7aQ/AAAAAAAAAAI/AAAAAAAAEEY/iH1izpdsh2Y/photo.jpg?sz=128", "display_name": "Vikram Pasupathy", "link": "https://stackoverflow.com/users/10549330/vikram-pasupathy"}, "edited": false, "score": 0, "creation_date": 1548273074, "post_id": 54334624, "comment_id": 95486785, "body": "@Remy Lebeau it&#39;s giving me an error based on conditional jumps"}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 21, "user_id": 10549330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i5YcgM_J7aQ/AAAAAAAAAAI/AAAAAAAAEEY/iH1izpdsh2Y/photo.jpg?sz=128", "display_name": "Vikram Pasupathy", "link": "https://stackoverflow.com/users/10549330/vikram-pasupathy"}, "edited": false, "score": 1, "creation_date": 1548273138, "post_id": 54334624, "comment_id": 95486820, "body": "@VikramPasupathy that means you copy-pasted the code incorrectly. No such thing should be generated by code that Remy proposed."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 1, "creation_date": 1548273271, "post_id": 54334624, "comment_id": 95486866, "body": "@Fureeish since the OP is resorting to old-school C <code>strcpy()</code>, good chance he&#39;s not using C++11, either. Which is why I opted for <code>NULL</code> instead of <code>nullptr</code>.  But, I added a second example that does not rely on either."}, {"owner": {"reputation": 21, "user_id": 10549330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i5YcgM_J7aQ/AAAAAAAAAAI/AAAAAAAAEEY/iH1izpdsh2Y/photo.jpg?sz=128", "display_name": "Vikram Pasupathy", "link": "https://stackoverflow.com/users/10549330/vikram-pasupathy"}, "edited": false, "score": 0, "creation_date": 1548273310, "post_id": 54334624, "comment_id": 95486884, "body": "void Student::setName(const char * const name) {  24         delete[] this-&gt;name;  25         this-&gt;name = NULL;  26           27         this-&gt;name = new char[strlen(name)+1];  28   strcpy(this-&gt;name,name);  29 }"}, {"owner": {"reputation": 21, "user_id": 10549330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i5YcgM_J7aQ/AAAAAAAAAAI/AAAAAAAAEEY/iH1izpdsh2Y/photo.jpg?sz=128", "display_name": "Vikram Pasupathy", "link": "https://stackoverflow.com/users/10549330/vikram-pasupathy"}, "edited": false, "score": 0, "creation_date": 1548273353, "post_id": 54334624, "comment_id": 95486909, "body": "Conditional jump or move depends on uninitialised value(s) ==3409==    at 0x402077: Student::setName(char const*) (student.cpp:24) ==3409==    by 0x4020FF: Student::Student(Student const&amp;) (student.cpp:33) ==3409==    by 0x4022DE: StudentRoll::insertAtTail(Student const&amp;) (studentRoll.cpp:12) ==3409==    by 0x401B71: main (testStudentRoll02.cpp:27)"}, {"owner": {"reputation": 21, "user_id": 10549330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i5YcgM_J7aQ/AAAAAAAAAAI/AAAAAAAAEEY/iH1izpdsh2Y/photo.jpg?sz=128", "display_name": "Vikram Pasupathy", "link": "https://stackoverflow.com/users/10549330/vikram-pasupathy"}, "edited": false, "score": 0, "creation_date": 1548273372, "post_id": 54334624, "comment_id": 95486917, "body": "^ My error that comes when I use your code @RemyLebeau"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 21, "user_id": 10549330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i5YcgM_J7aQ/AAAAAAAAAAI/AAAAAAAAEEY/iH1izpdsh2Y/photo.jpg?sz=128", "display_name": "Vikram Pasupathy", "link": "https://stackoverflow.com/users/10549330/vikram-pasupathy"}, "edited": false, "score": 0, "creation_date": 1548273449, "post_id": 54334624, "comment_id": 95486953, "body": "@VikramPasupathy There are no conditional jumps or uninitialized values in the code I showed. But, do make sure you have initialized <code>this-&gt;name</code> to something meaningful (even null) before calling <code>setName()</code>. Looks like you are calling <code>setName()</code> in your copy constructor, you probably forgot to initialize <code>name</code> first, so it would have an <i>indeterminate</i> value in <code>setName()</code> and fail on the <code>delete[]</code>."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1548273561, "last_edit_date": 1548273561, "creation_date": 1548272920, "answer_id": 54334624, "question_id": 54334545, "link": "https://stackoverflow.com/questions/54334545/how-to-solve-problems-with-memory-leaks-in-c-code/54334624#54334624", "title": "How to solve problems with Memory Leaks in C++ code", "body": "<p>You are not <code>delete[]</code>ing the memory that <code>name</code> already points to before reassigning it to point at newly allocated memory. That is your leak.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>void Student::setName(const char * const name)\n{\n    delete[] this-&gt;name; // &lt;-- add this\n    this-&gt;name = NULL; // in case new[] below throws an exception...\n\n    this-&gt;name = new char[strlen(name)+1];\n    strcpy(this-&gt;name, name);\n}\n</code></pre>\n\n<p>Or better, use the <a href=\"https://stackoverflow.com/questions/3279543/\">copy-and-swap idiom</a> to provide better exception safety:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n\nStudent::Student(const char * const name)\n    : name(new char[strlen(name)+1])\n{\n    strcpy(this-&gt;name, name);\n}\n\nvoid Student::setName(const char * const name)\n{\n    Student temp(name);\n    std::swap(this-&gt;name, temp.name);\n}\n</code></pre>\n\n<p>Also, make sure you are following the <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">Rule of 3/5/0</a> in your class to avoid a similar leak in your copy assignment operator (assuming you have even implemented one - the default generated one WILL leak in this situation).</p>\n\n<p>A better solution is to simply use <code>std::string</code> instead of <code>char*</code> and let it handle memory management for you.</p>\n"}], "owner": {"reputation": 21, "user_id": 10549330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i5YcgM_J7aQ/AAAAAAAAAAI/AAAAAAAAEEY/iH1izpdsh2Y/photo.jpg?sz=128", "display_name": "Vikram Pasupathy", "link": "https://stackoverflow.com/users/10549330/vikram-pasupathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "closed_date": 1548276584, "accepted_answer_id": 54334624, "answer_count": 1, "score": -1, "last_activity_date": 1548273561, "creation_date": 1548272518, "last_edit_date": 1548273375, "question_id": 54334545, "link": "https://stackoverflow.com/questions/54334545/how-to-solve-problems-with-memory-leaks-in-c-code", "closed_reason": "Duplicate", "title": "How to solve problems with Memory Leaks in C++ code", "body": "<p>This is the code that I'm using to setName</p>\n\n<pre><code>void Student::setName(const char * const name) {\n    this-&gt;name = new char[strlen(name)+1];\n    strcpy(this-&gt;name,name);\n}\n</code></pre>\n\n<p>and this is my deletor</p>\n\n<pre><code>Student::~Student() {\n    perm = 0;\n    delete[] this-&gt;name;\n}\n</code></pre>\n\n<p>but when I run valgrind, I get</p>\n\n<pre><code>13 bytes in 1 blocks are definitely lost in loss record 1 of 1\n==1786==    at 0x4C2FBC3: operator new[](unsigned long) \n(vg_replace_malloc.c:433)\n==1786==    by 0x402167: Student::setName(char const*) \n(student.cpp:25)\n==1786==    by 0x4020F1: Student::Student(char const*, int) \n(student.cpp:7)\n==1786==    by 0x401A73: main (testStudentRoll01.cpp:11)\n</code></pre>\n"}, {"tags": ["c++", "pointers", "reference"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548272454, "post_id": 54334508, "comment_id": 95486527, "body": "Does <code>getString()</code> return a reference? Otherwise <code>b.getString().begin(), b.getString().end()</code> is not a valid range."}, {"owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548272496, "post_id": 54334508, "comment_id": 95486551, "body": "yes it&#39;s by reference"}, {"owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548272638, "post_id": 54334508, "comment_id": 95486613, "body": "@Fran&#231;oisAndrieux the trick is in the second function. SetReferenceToBase. how was it able to print &quot;base&quot; wihout any memory leak"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548272646, "post_id": 54334508, "comment_id": 95486619, "body": "<i>&quot;How did the value of buffer survive also?&quot;</i> What leads you to believe it did? Edit : <code>Entity</code> just copies the string&#39;s value into it&#39;s <code>_value</code>. It doesn&#39;t need <code>buffer</code> anymore. <code>_value = _c.getBuffer();</code> performs the copy."}, {"owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548272740, "post_id": 54334508, "comment_id": 95486667, "body": "that&#39;s what I don&#39;t understand. I thought maybe because it is pointing to str variable of base? I thought that if do print after SetReferenceToBase I&#39;ll get nothing."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548272814, "post_id": 54334508, "comment_id": 95486697, "body": "A <code>std::string</code> doesn&#39;t point to anything external to know it&#39;s value. It&#39;s value is entirely managed internally. If you initialize it from a pointer it copies the string that pointer points to and no longer needs the pointer or what it points to."}, {"owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548272863, "post_id": 54334508, "comment_id": 95486713, "body": "Okk So even when the object Container is delete when function goes out of scope. _value will have the copy of _str."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548272903, "post_id": 54334508, "comment_id": 95486724, "body": "Yes. <code>std::string</code> is self contained."}, {"owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548273048, "post_id": 54334508, "comment_id": 95486778, "body": "please one last question. in set setLocalCopy It&#39;s not the same right? We do get an invalid read"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548273142, "post_id": 54334508, "comment_id": 95486821, "body": "No it&#39;s the same. <code>std::string</code> is self contained always. It doesn&#39;t matter how it was initialized, provided that it was initialized correctly. Once you have a valid <code>std::string</code> it&#39;s value doesn&#39;t care about anything else in your program unless you specifically change it&#39;s value."}, {"owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548273569, "post_id": 54334508, "comment_id": 95487000, "body": "oh damn it. I actually wanted to use a char * instead of string in entity. I actually Got nothing when I replaced string with char * can I add to the question. Sheeshhhhh I really wanted to ask that"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548273781, "post_id": 54334508, "comment_id": 95487099, "body": "This would no longer have anything to do with the original question and would be off topic."}, {"owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548273909, "post_id": 54334508, "comment_id": 95487145, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/187198/discussion-between-gringo-and-francois-andrieux\">continue this discussion in chat</a>."}, {"owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548274966, "post_id": 54334508, "comment_id": 95487541, "body": "well thanks a lot @Fran&#231;oisAndrieux sorry if the question was weird. lol ; sorry again I understood. This really really interesting"}], "owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548273720, "creation_date": 1548272366, "last_edit_date": 1592644375, "question_id": 54334508, "link": "https://stackoverflow.com/questions/54334508/how-can-a-member-variable-survive-after-local-object-being-deleted-when-function", "title": "How can a member variable survive after local object being deleted when function goes out of scope", "body": "<p>I Have 3 classes: Base, Container and Entity:</p>\n<ul>\n<li><p>Class Base has a string member variable</p>\n</li>\n<li><p>Class container a wrapper for a char * buffer</p>\n</li>\n<li><p>Class Entity has a static function that takes as argument a container and uses its buffer to fill its static member variable called value</p>\n</li>\n</ul>\n<p>I Want to fill the member variable of class Entity as follows:</p>\n<pre><code>void setLocalCopy(Entity &amp;e, const Base &amp; b) {\n  char buffer[2048] = {};\n  copy(b.getString().begin(), b.getString().end(), buffer);\n  Container c(buffer);\n  Entity::setValue(c);\n}\n</code></pre>\n<p>in setLocalCopy we initialize a buffer by COPYING the string of class Base into a buffer. We then instantiate an object Container with buffer and we Set the value of Entity. The problem in here is that Container is a LOCAL VARIABLE to setLocalCopy. When setLocalCopy goes out scope Container object will be destroyed.</p>\n<p>In order to solve that problem I wrote setReferenceToBase function:</p>\n<pre><code>void setReferenceToBase(Entity &amp;e, const Base &amp; b) {\n  char *buffer = const_cast&lt;char*&gt;(b.getString().c_str());\n  Container c(buffer);\n  Entity::setValue(c);\n}\n</code></pre>\n<p>in setReferenceToBase I create a pointer to the _str member variable of class Base. Now since Base is created dynamically in main, it will survive till the end of the program or until I delete it.</p>\n<p>The part that I don't understand How did the value of buffer survive also? The container object should be destroyed we leave setReferenceToBase. Is it because it is pointer to a member variable of class created dynamically?</p>\n<p>On top of that valgrind showed no memory leak whatsoever.</p>\n<h1>Source code Example</h1>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\n\nclass Base {\n    public:\n    Base(const std::string &amp; str):_str(str) {}\n     const std::string &amp;getString() const {\n         return _str;\n     }\n     private:\n     std::string _str;\n};\n\nclass Container {\n    public:\n      Container(char *buffer):_buffer(buffer) {}\n      char *getBuffer() {\n          return _buffer;\n      }\n    \n    private:\n    char * _buffer;\n    \n};\n\nclass Entity {\n    public:\n      Entity() {}\n      static void setValue(Container _c) {\n          _value = _c.getBuffer();\n      }\n      \n      static const std::string &amp; value() {\n          return _value;\n      }\n      \n     private:\n       static std::string _value;\n       \n};\nstd::string Entity::_value = {};\n\nvoid setLocalCopy(Entity &amp;e, const Base &amp; b) {\n  char buffer[2048] = {};\n  copy(b.getString().begin(), b.getString().end(), buffer);\n  Container c(buffer);\n  Entity::setValue(c);\n}\n\nvoid setReferenceToBase(Entity &amp;e, const Base &amp; b) {\n  char *buffer = const_cast&lt;char*&gt;(b.getString().c_str());\n  Container c(buffer);\n  Entity::setValue(c);\n}\n\nint main()\n{\n    Base *b = new Base(&quot;base&quot;);\n    Entity e;\n    \n    setLocalCopy(e,*b);\n    std::cout &lt;&lt; Entity::value() &lt;&lt; std::endl; \n    \n    setReferenceToBase(e,*b);\n    std::cout &lt;&lt; Entity::value() &lt;&lt; std::endl; //OK but I don't know why\n    \n    delete b;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "compiler-errors", "namespaces", "ambiguous", "atmelstudio"], "answers": [{"tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": false, "score": 0, "last_activity_date": 1548277389, "creation_date": 1548277389, "answer_id": 54335612, "question_id": 54334497, "link": "https://stackoverflow.com/questions/54334497/how-to-avoid-ambiguous-name-of-the-base-class-with-the-same-name-of-register-def/54335612#54335612", "title": "How to avoid ambiguous name of the base class with the same name of register defination from manufacturer", "body": "<p>In the places where the compiler can't figure out which <code>Adc</code> you're referring to, you can use the scope operator to specify which one.  Use <code>symm::Adc</code> for the base class (or possibly <code>::symm::Adc</code>), and <code>::Adc</code> for the global struct.</p>\n"}], "owner": {"reputation": 13, "user_id": 2208600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/964a141dcca6e412648379e9c8f305ff?s=128&d=identicon&r=PG", "display_name": "Rishit", "link": "https://stackoverflow.com/users/2208600/rishit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548277389, "creation_date": 1548272326, "question_id": 54334497, "link": "https://stackoverflow.com/questions/54334497/how-to-avoid-ambiguous-name-of-the-base-class-with-the-same-name-of-register-def", "title": "How to avoid ambiguous name of the base class with the same name of register defination from manufacturer", "body": "<p>I am deriving a base class named (<strong>Class Adc</strong>). There is also a manufacturer's header file which has a <strong>struct</strong> for ADC registers with name <strong>Adc</strong>. </p>\n\n<p>When I am trying to use ADC struct in my child class, compiler confuses it with the base class. Also, the base class is part of the \"symm\" namespace, while the struct is part of the global namespace.</p>\n\n<p>Is there any way I can avoid this ambiguity in names without changing both names. The base class is used in many projects. Changing the base class name would create some trouble in other projects. I don't want to touch manufacturer's header too. </p>\n\n<p>This is the Struct from Manfacturer I am talking about:    </p>\n\n<pre><code> /** \\brief ADC hardware registers */\n#if !(defined(__ASSEMBLY__) || defined(__IAR_SYSTEMS_ASM__))\ntypedef struct {\n  __IO ADC_CTRLA_Type            CTRLA;       /**&lt; \\brief Offset: 0x00 (R/W  8) Control A */\n  __IO ADC_CTRLB_Type            CTRLB;       /**&lt; \\brief Offset: 0x01 (R/W  8) Control B */\n  __IO ADC_REFCTRL_Type          REFCTRL;     /**&lt; \\brief Offset: 0x02 (R/W  8) Reference Control */\n  __IO ADC_EVCTRL_Type           EVCTRL;      /**&lt; \\brief Offset: 0x03 (R/W  8) Event Control */\n  __IO ADC_INTENCLR_Type         INTENCLR;    /**&lt; \\brief Offset: 0x04 (R/W  8) Interrupt Enable Clear */\n  __IO ADC_INTENSET_Type         INTENSET;    /**&lt; \\brief Offset: 0x05 (R/W  8) Interrupt Enable Set */\n  __IO ADC_INTFLAG_Type          INTFLAG;     /**&lt; \\brief Offset: 0x06 (R/W  8) Interrupt Flag Status and Clear */\n  __I  ADC_SEQSTATUS_Type        SEQSTATUS;   /**&lt; \\brief Offset: 0x07 (R/   8) Sequence Status */\n  __IO ADC_INPUTCTRL_Type        INPUTCTRL;   /**&lt; \\brief Offset: 0x08 (R/W 16) Input Control */\n  __IO ADC_CTRLC_Type            CTRLC;       /**&lt; \\brief Offset: 0x0A (R/W 16) Control C */\n  __IO ADC_AVGCTRL_Type          AVGCTRL;     /**&lt; \\brief Offset: 0x0C (R/W  8) Average Control */\n  __IO ADC_SAMPCTRL_Type         SAMPCTRL;    /**&lt; \\brief Offset: 0x0D (R/W  8) Sample Time Control */\n  __IO ADC_WINLT_Type            WINLT;       /**&lt; \\brief Offset: 0x0E (R/W 16) Window Monitor Lower Threshold */\n  __IO ADC_WINUT_Type            WINUT;       /**&lt; \\brief Offset: 0x10 (R/W 16) Window Monitor Upper Threshold */\n  __IO ADC_GAINCORR_Type         GAINCORR;    /**&lt; \\brief Offset: 0x12 (R/W 16) Gain Correction */\n  __IO ADC_OFFSETCORR_Type       OFFSETCORR;  /**&lt; \\brief Offset: 0x14 (R/W 16) Offset Correction */\n       RoReg8                    Reserved1[0x2];\n  __IO ADC_SWTRIG_Type           SWTRIG;      /**&lt; \\brief Offset: 0x18 (R/W  8) Software Trigger */\n       RoReg8                    Reserved2[0x3];\n  __IO ADC_DBGCTRL_Type          DBGCTRL;     /**&lt; \\brief Offset: 0x1C (R/W  8) Debug Control */\n       RoReg8                    Reserved3[0x3];\n  __I  ADC_SYNCBUSY_Type         SYNCBUSY;    /**&lt; \\brief Offset: 0x20 (R/  16) Synchronization Busy */\n       RoReg8                    Reserved4[0x2];\n  __I  ADC_RESULT_Type           RESULT;      /**&lt; \\brief Offset: 0x24 (R/  16) Result */\n       RoReg8                    Reserved5[0x2];\n  __IO ADC_SEQCTRL_Type          SEQCTRL;     /**&lt; \\brief Offset: 0x28 (R/W 32) Sequence Control */\n  __IO ADC_CALIB_Type            CALIB;       /**&lt; \\brief Offset: 0x2C (R/W 16) Calibration */\n} Adc;\n#endif /* !(defined(__ASSEMBLY__) || defined(__IAR_SYSTEMS_ASM__)) */\n</code></pre>\n\n<p>This is my child class definition:</p>\n\n<pre><code>class ADC_SAML21 : public Adc\n    {\n        public:\n\n            ADC_SAML21(bool interruptable = false);\n}\n</code></pre>\n\n<p>Thank you.</p>\n\n<p>Regards,\nRishit</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 727, "user_id": 4866865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7789b80c26c3bc3f9d69580734c220b?s=128&d=identicon&r=PG&f=1", "display_name": "Gamification", "link": "https://stackoverflow.com/users/4866865/gamification"}, "edited": false, "score": 0, "creation_date": 1548272628, "post_id": 54334460, "comment_id": 95486608, "body": "Also: I highly recommend you use proper identation, it will help you and everyone who reads your code (like me) to keep track of control flow."}, {"owner": {"reputation": 727, "user_id": 4866865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7789b80c26c3bc3f9d69580734c220b?s=128&d=identicon&r=PG&f=1", "display_name": "Gamification", "link": "https://stackoverflow.com/users/4866865/gamification"}, "edited": false, "score": 1, "creation_date": 1548272690, "post_id": 54334460, "comment_id": 95486638, "body": "Furthermore, don&#39;t include headers you don&#39;t use as it seems to be the case with <code>conio.h</code>."}, {"owner": {"reputation": 727, "user_id": 4866865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7789b80c26c3bc3f9d69580734c220b?s=128&d=identicon&r=PG&f=1", "display_name": "Gamification", "link": "https://stackoverflow.com/users/4866865/gamification"}, "edited": false, "score": 1, "creation_date": 1548272827, "post_id": 54334460, "comment_id": 95486702, "body": "Another thing: There are pros and cons to using <code>using namespace std;</code> but what it does is it will let you use symbols in the <code>std</code> namespace (like <code>cout</code> and <code>cin</code>) without specifyng the namespace. So in this code, you can either leave out the <code>using namespace std;</code> or all the <code>std::</code> prefixes."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 727, "user_id": 4866865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7789b80c26c3bc3f9d69580734c220b?s=128&d=identicon&r=PG&f=1", "display_name": "Gamification", "link": "https://stackoverflow.com/users/4866865/gamification"}, "edited": false, "score": 1, "creation_date": 1548285496, "post_id": 54334460, "comment_id": 95491499, "body": "@Gamification: I think that last one isn&#39;t quite right. <code>std::endl</code> flushes buffers, which makes the app run slower, so there&#39;s a major performance difference between the two. And since <code>&lt;&lt;</code> is a formatted output, <code>&#39;\\n&#39;</code> will result in the local newline character regardless."}, {"owner": {"reputation": 727, "user_id": 4866865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7789b80c26c3bc3f9d69580734c220b?s=128&d=identicon&r=PG&f=1", "display_name": "Gamification", "link": "https://stackoverflow.com/users/4866865/gamification"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1548341709, "post_id": 54334460, "comment_id": 95514128, "body": "@MooingDuck oh my, thanks for pointing that out. So I was always under a wrong impression. I&#39;ll delete the comment so no one picks it up. I wrongly stated that std::endl was for platform compatibiliy but usually equal to &#39;\\n&#39; \u2013 So I was wrong in both regards."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10957676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TU-STJSpMpM/AAAAAAAAAAI/AAAAAAAAAMA/P2XyoRRfd7k/photo.jpg?sz=128", "display_name": "Brian", "link": "https://stackoverflow.com/users/10957676/brian"}, "edited": false, "score": 0, "creation_date": 1548272449, "post_id": 54334485, "comment_id": 95486526, "body": "Thank you bud this really helped my program. Thank you and Have a nice day."}, {"owner": {"reputation": 727, "user_id": 4866865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7789b80c26c3bc3f9d69580734c220b?s=128&d=identicon&r=PG&f=1", "display_name": "Gamification", "link": "https://stackoverflow.com/users/4866865/gamification"}, "reply_to_user": {"reputation": 13, "user_id": 10957676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TU-STJSpMpM/AAAAAAAAAAI/AAAAAAAAAMA/P2XyoRRfd7k/photo.jpg?sz=128", "display_name": "Brian", "link": "https://stackoverflow.com/users/10957676/brian"}, "edited": false, "score": 0, "creation_date": 1548272548, "post_id": 54334485, "comment_id": 95486574, "body": "If that solved your problem and answered your question, please <i>accept</i> it by pressing the green \u2713to the left of the post. Thanks"}], "tags": [], "owner": {"reputation": 727, "user_id": 4866865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7789b80c26c3bc3f9d69580734c220b?s=128&d=identicon&r=PG&f=1", "display_name": "Gamification", "link": "https://stackoverflow.com/users/4866865/gamification"}, "is_accepted": true, "score": 4, "last_activity_date": 1548285287, "last_edit_date": 1548285287, "creation_date": 1548272266, "answer_id": 54334485, "question_id": 54334460, "link": "https://stackoverflow.com/questions/54334460/is-there-a-fix-for-my-code-not-declaring-an-int-to-what-i-select-it-to-be-in-a-i/54334485#54334485", "title": "Is there a fix for my code not declaring an int to what I select it to be in a if else loop?", "body": "<p>That is because <code>int henlep = 1</code> declares henlep as int assigns 1 to it. However, what you seem to want is to compare it with one. For that you have to use the comparison operator <code>==</code> like so:</p>\n\n<pre><code>if (henlep == 1) {\n    std::cout &lt;&lt;\"you chose \" &lt;&lt; henlep &lt;&lt; \",\\n\";\n    std::cout &lt;&lt;\"you fool!\\n\";\n    std::cout &lt;&lt; \"honestly if you ate it you ruined the fun. compile this again and press 2\\n\";\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10957676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TU-STJSpMpM/AAAAAAAAAAI/AAAAAAAAAMA/P2XyoRRfd7k/photo.jpg?sz=128", "display_name": "Brian", "link": "https://stackoverflow.com/users/10957676/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 54334485, "answer_count": 1, "score": 1, "last_activity_date": 1548285287, "creation_date": 1548272142, "last_edit_date": 1548273073, "question_id": 54334460, "link": "https://stackoverflow.com/questions/54334460/is-there-a-fix-for-my-code-not-declaring-an-int-to-what-i-select-it-to-be-in-a-i", "title": "Is there a fix for my code not declaring an int to what I select it to be in a if else loop?", "body": "<p>When I run and test the code, I select 2 for the second option, but when I do, it reverts it to 1 and selects the first option in my if-then loop.</p>\n\n<p>I've tried moving the declaration to right below the console input, and I've tried using other numbers besides 2.I moved the console output so I know what it selects, and that didn't help with anything.</p>\n\n<p>Here's my entire code for this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;conio.h&gt;\nusing namespace std;\n\nint main()\n{\n    std::cout &lt;&lt; \"HELLOW THERE!\\n\";\n    char enter[2];\n    int help2 = 0;\n    char help[20];\n    std::cin &gt;&gt; help;\n    std::cout &lt;&lt; \"hello, \" &lt;&lt; help &lt;&lt;\" this was a test, thanks\\n\";\n    std::cout &lt;&lt; \"lol jk no it wasnt\\n\";\n    std::cout &lt;&lt; \"come on, \" &lt;&lt; help &lt;&lt; \"\\n\";\n    char name[20] = \"Crilbus\";\n    std::cout &lt;&lt; \"press any key + enter to continue...\\n\";\n    std::cin &gt;&gt; enter;\n    std::cout &lt;&lt;\"Your name is \" &lt;&lt; name &lt;&lt; \" now haha gotem\\n\";\n    std::cout &lt;&lt; \"so, \" &lt;&lt; name &lt;&lt; \", you were walking to \" &lt;&lt; help &lt;&lt;\" and you bought a cherry.\\n\";\n    std::cout &lt;&lt; \"JUST ONE CHERRY, FORGET ABOUT THE OTHER 4.\\n\";\n    std::cout &lt;&lt;\"so what do you do?\\n\";\n    std::cout &lt;&lt;\"do you eat it or throw it at someone?\\n\";\n    std::cout &lt;&lt;\"press 1 to eat it and 2 to throw it.\\n\";\n    int henlep;\n    std::cin &gt;&gt; henlep;\n\n    if (int henlep = 1) {\n        std::cout &lt;&lt;\"you chose \" &lt;&lt; henlep &lt;&lt; \",\\n\";\n        std::cout &lt;&lt;\"you fool!\\n\";\n        std::cout &lt;&lt; \"honestly if you ate it you ruined the fun. compile this again and press 2\\n\";\n    }\n    else if (int henlep = 2){\n        std::cout &lt;&lt;\"ok so you through it at my boy gavin and he decided to 1v1 you.\\n\";\n        std::cout &lt;&lt; \"do you press 1 to fight, or press 2 to run away?\\n\";\n        std::cin &gt;&gt; henlep;\n    }\n}\n</code></pre>\n\n<p>I expect the console output to be 2 when I select 2 in the console input, but I get the console output as 1 </p>\n"}, {"tags": ["c++", "arduino"], "answers": [{"tags": [], "owner": {"reputation": 1353, "user_id": 1306779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4rji2.png?s=128&g=1", "display_name": "jfowkes", "link": "https://stackoverflow.com/users/1306779/jfowkes"}, "is_accepted": true, "score": 0, "last_activity_date": 1548328051, "creation_date": 1548328051, "answer_id": 54345207, "question_id": 54334295, "link": "https://stackoverflow.com/questions/54334295/error-undefined-reference-when-a-library-is-included-to-arduino-code-from-direct/54345207#54345207", "title": "error undefined reference when a library is included to arduino code from directory other than src in sketch folder", "body": "<p>The Arduino IDE will only compile source files in the <code>src</code> directory and subdirectories (see <a href=\"https://github.com/arduino/arduino-builder/pull/148\" rel=\"nofollow noreferrer\">this pull request</a>)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4016337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 54345207, "answer_count": 1, "score": 0, "last_activity_date": 1548328051, "creation_date": 1548271428, "question_id": 54334295, "link": "https://stackoverflow.com/questions/54334295/error-undefined-reference-when-a-library-is-included-to-arduino-code-from-direct", "title": "error undefined reference when a library is included to arduino code from directory other than src in sketch folder", "body": "<p>code.ino:</p>\n\n<pre><code> #include \"./(src or comp)/lib/one.h\"\n</code></pre>\n\n<hr>\n\n<p>Case 1:</p>\n\n<pre><code>sketchfolder/code.ino\nsketchfolder/src/lib/one.h\nsketchfolder/src/lib/one.cpp\n</code></pre>\n\n<p>Now when code.ino is compiled  in arduino IDE everything works fine.</p>\n\n<hr>\n\n<p>Case 2:</p>\n\n<pre><code>sketchfolder/code.ino\nsketchfolder/comp/lib/one.h\nsketchfolder/comp/lib/one.cpp\n</code></pre>\n\n<p>Now when code.ino is compiled in arduino IDE it throws an error. </p>\n\n<p>error:</p>\n\n<pre><code>sketch/code.ino.cpp.o:(.literal.startup._GLOBAL__sub_I_sens+0x8): undefined reference to `one::one()'\n</code></pre>\n\n<hr>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 4, "creation_date": 1548269977, "post_id": 54333960, "comment_id": 95485503, "body": "&quot;Something like that&quot;? Why not show us the actual message?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1548270123, "post_id": 54333960, "comment_id": 95485560, "body": "<b>Recommended reading:</b> <a href=\"https://stackoverflow.com/q/5605125/560648\">Why is iostream::eof inside a loop condition considered wrong?</a>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1548270155, "post_id": 54333960, "comment_id": 95485577, "body": "Also you have to be really careful if you want to serialise/deserialise in a byte-by-byte way like this. There are stringent constraints. Usually we create more sophisticated serialisation/deserialisation logic..."}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1548270020, "creation_date": 1548270020, "answer_id": 54333995, "question_id": 54333960, "link": "https://stackoverflow.com/questions/54333960/building-data-base-read-method/54333995#54333995", "title": "Building data base, read method", "body": "<pre><code>if (infile.read(reinterpret_cast&lt;char*&gt;(this), sizeof(*this) &gt; 0))\n//                                                          ^   ^\n//                                                          A   B\n</code></pre>\n\n<p>The end of the <code>read</code> function call should be at A, not at B.</p>\n\n<p>You put the bracket in the wrong place.</p>\n\n<p>There is no <code>read(char*, bool)</code> function ;)</p>\n"}], "owner": {"reputation": 9, "user_id": 8584442, "user_type": "registered", "profile_image": "https://graph.facebook.com/263744547478767/picture?type=large", "display_name": "Unknown Name", "link": "https://stackoverflow.com/users/8584442/unknown-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "closed_date": 1548271960, "answer_count": 1, "score": 0, "last_activity_date": 1548270020, "creation_date": 1548269888, "question_id": 54333960, "link": "https://stackoverflow.com/questions/54333960/building-data-base-read-method", "closed_reason": "Not suitable for this site", "title": "Building data base, read method", "body": "<p>Can anyone why this code does not work? \nIt says that this operator does not exists or something like that.\nPlease help me</p>\n\n<pre><code>void Account::read_rec()\n{\n    std::ifstream infile;\n    infile.open(\"record.bank\", std::ios::binary);\n    if (!infile)\n    {\n        std::cout &lt;&lt; \"[Error] File Not Found!\" &lt;&lt; std::endl;\n        return;\n    }\n\n    std::cout &lt;&lt; \"\\n***** Data from file *****\" &lt;&lt; std::endl;\n\n    while (!infile.eof())\n    {\n        if (infile.read(reinterpret_cast&lt;char*&gt;(this), sizeof(*this) &gt; 0))\n        {\n            show_data();\n        }\n    }\n    infile.close();\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 6, "creation_date": 1548269274, "post_id": 54333774, "comment_id": 95485153, "body": "The line <code>(char*)my_string.c_str()</code> is discarding a <code>const</code>. You are explicitly circumventing the type system to do something illegal that the type system is design to protect you from. <code>c_str()</code> returns a <code>const char *</code> because you aren&#39;t supposes to use it to modify the array it points."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1548269315, "post_id": 54333774, "comment_id": 95485179, "body": "You have undefined behavior. This is a kind of error where your code&#39;s behavior is not defined by the standard and it can do anything. You must not have any expectation regarding undefined behavior, including expecting a specific mode of failure or even expecting it to fail at all (it can appear to work according to your expectations)."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1548270813, "post_id": 54333774, "comment_id": 95485851, "body": "It may even work according to your expectations, until after you&#39;ve shipped the product, and then it may do something bad.  It may not seem possible, but that&#39;s undefined behavior for you."}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 10, "last_activity_date": 1548270207, "last_edit_date": 1548270207, "creation_date": 1548269474, "answer_id": 54333851, "question_id": 54333774, "link": "https://stackoverflow.com/questions/54333774/strcat-on-an-stdstring-cast-to-a-char/54333851#54333851", "title": "strcat on an std::string cast to a char*", "body": "<blockquote>\n  <p>What would be the actual behaviour of this operation?</p>\n</blockquote>\n\n<p>The behavior is undefined.  First, <a href=\"https://timsong-cpp.github.io/cppwp/string.accessors#3\" rel=\"noreferrer\">writing to any character through <code>c_str</code> is undefined behavior</a>. Secondly, had you used <code>data</code> instead to get a <code>char*</code>, <a href=\"https://timsong-cpp.github.io/cppwp/string.accessors#6\" rel=\"noreferrer\">overwriting the null terminator is also undefined behavior</a>.  Lastly, both <code>c_str</code> and <code>data</code> only give you a pointer (<code>p</code>) that has a valid range of elements from <code>[p, p + size()]</code>.  Writing to any element outside that range is also undefined behavior.</p>\n\n<p>If you want to modify the string you need to use the string's member/free functions to do so. Your function could be rewritten to</p>\n\n<pre><code>void addtostring(std::string&amp; str){\n    str += \"goodbye\";\n}\n</code></pre>\n\n<p>and that will have well defined behavior.</p>\n"}], "owner": {"reputation": 145, "user_id": 10863242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/929c63723558abbc140e2464c011912d?s=128&d=identicon&r=PG&f=1", "display_name": "peer_2_peer_2", "link": "https://stackoverflow.com/users/10863242/peer-2-peer-2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548270207, "creation_date": 1548269156, "last_edit_date": 1548269187, "question_id": 54333774, "link": "https://stackoverflow.com/questions/54333774/strcat-on-an-stdstring-cast-to-a-char", "title": "strcat on an std::string cast to a char*", "body": "<p>I found this (simplified) piece of code in our code base and it's leaving me feeling unpleasant. It either works, doesn't work, or is never called anyway. I would expect some buffer overflow, but when I try it in an online compiler it certainly doesn't work, but doesn't overflow either. I'm looking at the definition of <code>strcat</code> and it will write the source to the destination starting at its null terminator, but I am assuming in this scenario, the destination buffer (which was created as a <code>std::string</code>) should be too small..</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"string.h\"\n\nusing namespace std;\n\nvoid addtostring(char* str){\n    char str2[12] = \"goodbye\";\n    strcat(str, str2);\n}\n\nint main()\n{\n    std::string my_string = \"hello\";\n    addtostring((char*)my_string.c_str());\n\n    cout &lt;&lt; my_string &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>What would be the actual behaviour of this operation? </p>\n"}, {"tags": ["c++", "rvo", "nrvo"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1548268975, "post_id": 54333687, "comment_id": 95485027, "body": "It may or may not happen.  The only way to know for certain is to check the assembly."}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1548269052, "post_id": 54333687, "comment_id": 95485063, "body": "If you had <code>return report;</code> then NRVO would be nearly a sure thing. However since you are using <code>.c_str()</code> to construct another separate string, I think that&#39;s a stretch to consider for NRVO."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1548269102, "post_id": 54333687, "comment_id": 95485083, "body": "Which function? <code>DoIt</code> or <code>GenerateReport</code>?"}, {"owner": {"reputation": 2064, "user_id": 761184, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7a13f44e38c5de4e9d85ef07ec7e30e?s=128&d=identicon&r=PG", "display_name": "conectionist", "link": "https://stackoverflow.com/users/761184/conectionist"}, "edited": false, "score": 0, "creation_date": 1548269448, "post_id": 54333687, "comment_id": 95485242, "body": "Both. Sorry, I thought I wrote functions, not function. My bad."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1548269588, "post_id": 54333687, "comment_id": 95485308, "body": "Please post actual <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> not pseudo code."}], "answers": [{"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1548270376, "post_id": 54334023, "comment_id": 95485666, "body": "While <code>report</code> cannot be NRVO&#39;d, the <code>std::string</code> return value constructed from it can be RVO&#39;d directly into <code>val</code>. Although, since C++17, this it is no longer an optimisation, but rather required behaviour."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1548270592, "post_id": 54334023, "comment_id": 95485768, "body": "As far as I know, NRVO works only with id-expressions. Am I mistaken?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1548271042, "post_id": 54334023, "comment_id": 95485932, "body": "@eerorika Sorry, I read <code>return val</code> not <code>return report.c_str()</code> as not being NRVO&#39;d.  My mistake."}, {"owner": {"reputation": 2064, "user_id": 761184, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7a13f44e38c5de4e9d85ef07ec7e30e?s=128&d=identicon&r=PG", "display_name": "conectionist", "link": "https://stackoverflow.com/users/761184/conectionist"}, "edited": false, "score": 0, "creation_date": 1548272693, "post_id": 54334023, "comment_id": 95486641, "body": "Wow, thanks for the comprehensive explanation @Yakk-AdamNevraumont"}, {"owner": {"reputation": 2064, "user_id": 761184, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7a13f44e38c5de4e9d85ef07ec7e30e?s=128&d=identicon&r=PG", "display_name": "conectionist", "link": "https://stackoverflow.com/users/761184/conectionist"}, "edited": false, "score": 0, "creation_date": 1548273079, "post_id": 54334023, "comment_id": 95486790, "body": "So basically the &quot;problem&quot; is that I have 2 different return paths. What if I could somehow get rid of the if(remove_all) condition? If would return something like (g_report_generator.isEmpty() ? string() : g_report_generator.GenerateReport()), would RVO then be possible?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 2064, "user_id": 761184, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7a13f44e38c5de4e9d85ef07ec7e30e?s=128&d=identicon&r=PG", "display_name": "conectionist", "link": "https://stackoverflow.com/users/761184/conectionist"}, "edited": false, "score": 1, "creation_date": 1548280008, "post_id": 54334023, "comment_id": 95489628, "body": "@conectionist Suggested practically elision-guaranteed solution added."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 1, "last_activity_date": 1548279978, "last_edit_date": 1548279978, "creation_date": 1548270157, "answer_id": 54334023, "question_id": 54333687, "link": "https://stackoverflow.com/questions/54333687/will-nrvo-be-applied-with-my-function-in-this-situation/54334023#54334023", "title": "Will (N)RVO be applied with my function in this situation?", "body": "<p>To solve your problem I rewrote it.</p>\n\n<pre><code>#include &lt;string&gt;\n\n\nstruct string : std::string {\n    using std::string::string;\n\n    string(string&amp;&amp; s) {\n        exit(-1);\n    }\n    string(string const&amp;) {\n        exit(-2);\n    }\n\n    string() {}\n};\n\nstruct ReportManager\n{\n    // I know, using c_str in this case is stupid. \n    // but just assume that it has to be this way\n    string GenerateReport()\n    {\n        string report(\"test\");\n        return report.c_str();\n    }\n    bool isEmpty() const { return true; }\n    void clear() const {}\n};\n\nReportManager g_report_generator;\n\nstring DoIt(bool remove_all)\n{\n    if(g_report_generator.isEmpty())\n        return string();\n\n    string val = g_report_generator.GenerateReport();\n\n    if(remove_all)\n        g_report_generator.clear();\n\n    return val;\n}\n\nint main()\n{\n    string s = DoIt(true);\n}\n</code></pre>\n\n<p>The trick with this rewriting is that elision permits skipping copy/move ctors.  So every time we actually copy an object (even if inlined), we'll insert an <code>exit</code> clause; only by elision can we avoid it.</p>\n\n<p><code>GenerateReport</code> has no (N)RVO or any kind of elision, other than possibly under as-if.  I doubt a compiler will be able to prove that, especially if the string is non-static and large enough to require heap storage.</p>\n\n<p>For <code>DoIt</code> both NRVO and RVO is possible.  Elision is legal there, even with side effects.</p>\n\n<p><a href=\"https://godbolt.org/z/0qtFeF\" rel=\"nofollow noreferrer\">MSVC fails</a> -- notice calls to\n<code>??0string@@QAE@$QAU0@@Z</code>, which is the move constructor of my local <code>string</code> class.</p>\n\n<p>When I force the possible RVO case to run <a href=\"https://godbolt.org/z/Mw16U1\" rel=\"nofollow noreferrer\">by saying it is empty</a>, you'll see that the compiler also fails to RVO optimize here; there is an <code>exit(-1)</code> inlined into the disassembly.</p>\n\n<p><a href=\"https://godbolt.org/z/ApAG0H\" rel=\"nofollow noreferrer\">Clang</a> manages to RVO the <code>return string();</code> but not NRVO the <code>return val;</code>.</p>\n\n<p>By far the easiest fix is:</p>\n\n<pre><code>string DoIt(bool remove_all)\n{\n    if(g_report_generator.isEmpty())\n        return string();\n\n    return [&amp;]{   \n      string val = g_report_generator.GenerateReport();\n\n      if(remove_all)\n        g_report_generator.clear();\n\n      return val;\n    }();\n}\n</code></pre>\n\n<p>which has double RVO, and a lambda that does simple NRVO.  Zero structural changes to your code, and functions which C++98 compilers can elide return values on (well, they don't support lambda, but you get the idea).</p>\n"}, {"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 1, "last_activity_date": 1548271144, "last_edit_date": 1548271144, "creation_date": 1548270315, "answer_id": 54334057, "question_id": 54333687, "link": "https://stackoverflow.com/questions/54333687/will-nrvo-be-applied-with-my-function-in-this-situation/54334057#54334057", "title": "Will (N)RVO be applied with my function in this situation?", "body": "<p>I do not think (N)RVO is possible in either functions. <code>GenerateReport</code> has to construct a string from character array, there is nothing left for NRVO. <code>DoIt</code> returns two different values through it control path, which makes it impossible to perform NRVO as well.</p>\n"}], "owner": {"reputation": 2064, "user_id": 761184, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7a13f44e38c5de4e9d85ef07ec7e30e?s=128&d=identicon&r=PG", "display_name": "conectionist", "link": "https://stackoverflow.com/users/761184/conectionist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 54334023, "answer_count": 2, "score": 0, "last_activity_date": 1548279978, "creation_date": 1548268852, "last_edit_date": 1548269470, "question_id": 54333687, "link": "https://stackoverflow.com/questions/54333687/will-nrvo-be-applied-with-my-function-in-this-situation", "title": "Will (N)RVO be applied with my function in this situation?", "body": "<p>I have the following code: (ok, in reality it's much more complicated, but I simplified it to make it easier to understand. so please disregard the things that seems stupid. I can't change them in my real situation)</p>\n\n<pre><code>#include &lt;string&gt;\n\nusing std::string;\n\nReportManager g_report_generator;\n\nstruct ReportManager\n{\n    // I know, using c_str in this case is stupid. \n    // but just assume that it has to be this way\n    string GenerateReport() { string report(\"test\"); return report.c_str(); }\n}\n\nstring DoIt(bool remove_all)\n{\n    if(g_report_generator.isEmpty())\n        return string();\n\n    string val = g_report_generator.GenerateReport();\n\n    if(remove_all)\n        g_report_generator.clear();\n\n    return val;\n}\n\nvoid main()\n{\n    string s = DoIt(true);\n}\n</code></pre>\n\n<p>Will (N)RVO be applied with my functions?\nI did a bit of research, and it would seem like it, but I'm not really convinced and I'd like a second opinion (or more).</p>\n\n<p>I'm using Visual Studio 2017.</p>\n"}, {"tags": ["c++", "boost", "mingw"], "comments": [{"owner": {"reputation": 731, "user_id": 3030737, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/84f06b806a31acf130deb8f5c9e0d679?s=128&d=identicon&r=PG&f=1", "display_name": "Cromon", "link": "https://stackoverflow.com/users/3030737/cromon"}, "edited": false, "score": 1, "creation_date": 1548274372, "post_id": 54333608, "comment_id": 95487323, "body": "I noticed, it seems to cut away just the first <code>_</code>, for example <code>mainCRTStartup</code> is actually named <code>_mainCRTStartup</code> and <code>_tmainCRTStartup</code> would be <code>__tmainCRTStartup</code>. Also <code>_ZN3foo3Bar6fooBarEv</code> sould properly be demangled online by a GCC demangler..."}], "answers": [{"tags": [], "owner": {"reputation": 731, "user_id": 3030737, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/84f06b806a31acf130deb8f5c9e0d679?s=128&d=identicon&r=PG&f=1", "display_name": "Cromon", "link": "https://stackoverflow.com/users/3030737/cromon"}, "is_accepted": true, "score": 0, "last_activity_date": 1548346883, "creation_date": 1548346883, "answer_id": 54351109, "question_id": 54333608, "link": "https://stackoverflow.com/questions/54333608/boost-stacktrace-not-demangling-names-when-cross-compiled/54351109#54351109", "title": "Boost stacktrace not demangling names when cross compiled", "body": "<p>TL/DR: libbacktrace for some reason strips leading underscores and boost improperly calls <code>backtrace_pcinfo</code> -> Issue for libbacktrace and boost will be created (fixed in my local compilations)</p>\n\n<p><strong>More detailed response:</strong></p>\n\n<p>I was able to figure out the weird behavior by creating a debug build of libbacktrace and stepping through the code. There is - in my opinion - a bug in both boost and libbacktrace.</p>\n\n<p>Very high level explanation how boost::stacktrace works when the libbacktrace backend is selected:</p>\n\n<ul>\n<li>Call <code>backtrace_pcinfo</code>, this will read (on first call) and search through the DWARF debug information (at least the mingw implementation)</li>\n<li>If the previous call was successful it will return here since it will have gotten more than enough info (function, file, line)</li>\n<li>If it returned zero, it will try to call <code>backtrace_syminfo</code>. This will (for mingw) search the coff symbol table</li>\n<li>If it returned zero you will get a raw address printed, otherwise at least the function name (no file/line)</li>\n</ul>\n\n<p>The first bug/unexpected behavior I was able to trace back to libbacktrace (pun intended). The implementation in <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libbacktrace/pecoff.c#L440\" rel=\"nofollow noreferrer\">gcc/pecoff.c#440</a> for some reason strips the leading underscore if it is present. That is the reason the function names all lack their leading underscore and cannot be demangled. I think this can be considered a bug, or at least I dont see any other reason than a failed attempted at pretty printing symbols.</p>\n\n<p>Now the attentive reader probably remembers from my question that I am using debug information, so it should not need to get into the coff symbol table but instead should use the DWARF debug information. And this is where the bug with boost is located.</p>\n\n<p><code>backtrace_pcinfo</code> has to be called with two callbacks. The first will receive the resolved symbol info (if any) and the second is an error callback. When a symbol is found the first callback is called and its return value is returned from <code>backtrace_pcinfo</code> or in code:</p>\n\n<p>return of <code>backtrace_pcinfo</code>: <code>return state-&gt;fileline_fn (state, pc, callback, error_callback, data);</code></p>\n\n<p><code>fileline_fn</code> for mingw is the dwarf implementation <code>dwarf_fileline</code> which returns like this:</p>\n\n<pre><code>ret = dwarf_lookup_pc (state, ddata, pc, callback, error_callback,\n        data, &amp;found);\nif (ret != 0 || found)\n  return ret;\n</code></pre>\n\n<p><code>dwarf_lookup_pc</code> now returns what the callback returned when a symbol is found: <code>return callback (data, pc, filename, lineno, function-&gt;name);</code></p>\n\n<p>Now lets see how the callback looks boost is supplying:</p>\n\n<pre><code>inline int libbacktrace_full_callback(void *data, uintptr_t /*pc*/, const char *filename, int lineno, const char *function) {\n    pc_data&amp; d = *static_cast&lt;pc_data*&gt;(data);\n    if (d.filename &amp;&amp; filename) {\n        *d.filename = filename;\n    }\n    if (d.function &amp;&amp; function) {\n        *d.function = function;\n    }\n    d.line = lineno;\n    return 0;\n}\n</code></pre>\n\n<p>Since the return value is directly propagated to <code>backtrace_pcinfo</code> this means that this check will always go into the <code>or</code> case no matter if anything was found:</p>\n\n<pre><code>        ::backtrace_pcinfo(\n            state,\n            reinterpret_cast&lt;uintptr_t&gt;(addr),\n            boost::stacktrace::detail::libbacktrace_full_callback,\n            boost::stacktrace::detail::libbacktrace_error_callback,\n            &amp;data\n        ) \n        ||\n        ::backtrace_syminfo(\n            state,\n            reinterpret_cast&lt;uintptr_t&gt;(addr),\n            boost::stacktrace::detail::libbacktrace_syminfo_callback,\n            boost::stacktrace::detail::libbacktrace_error_callback,\n            &amp;data\n        );\n</code></pre>\n\n<p>This means it will always use the implementation that somehow strips the leading space. I changed the callback to return <code>1</code> and now everything is fine.</p>\n"}], "owner": {"reputation": 731, "user_id": 3030737, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/84f06b806a31acf130deb8f5c9e0d679?s=128&d=identicon&r=PG&f=1", "display_name": "Cromon", "link": "https://stackoverflow.com/users/3030737/cromon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 54351109, "answer_count": 1, "score": 1, "last_activity_date": 1548346883, "creation_date": 1548268529, "last_edit_date": 1548323643, "question_id": 54333608, "link": "https://stackoverflow.com/questions/54333608/boost-stacktrace-not-demangling-names-when-cross-compiled", "title": "Boost stacktrace not demangling names when cross compiled", "body": "<p>In order to generate a stack trace I am using <code>boost::stacktrace</code>. I have a build agent on Debian that is compiling a unix and a windows version of the program. The Unix version is compiled using the native <code>g++</code> installed and the windows cross compilation is created using <code>mingw-w64</code>. I am using the <code>libbacktrace</code> backend for both compilations. Both boost and libbacktrace are themselves compiled on the Debian machine using the same mingw-w64 compiler.</p>\n\n<p>In my <code>CMakeLists.txt</code> I specify: <code>add_definitions(-DBOOST_STACKTRACE_USE_BACKTRACE)</code></p>\n\n<p>A stacktrace is generated like this:</p>\n\n<pre><code>namespace foo {\n    class Bar {\n    public:\n        void fooBar() {\n            std::cout &lt;&lt; boost::stacktrace::stacktrace() &lt;&lt; std::endl;\n        }\n    };\n}\n\nint main(int argc, char *argv[]) {\n    foo::Bar bar;\n    bar.fooBar();\n}\n</code></pre>\n\n<p>This results in the following output (with -g and no optimization) when compiled on my computer (elementary OS) and when downloaded from the build server on my unix machine.</p>\n\n<pre><code> 0# foo::Bar::fooBar() in /home/cromon/CLionProjects/test-proj/cmake-build-debug/test-proj\n 1# main at /home/cromon/CLionProjects/test-proj/main.cpp:31\n 2# __libc_start_main in /lib/x86_64-linux-gnu/libc.so.6\n 3# _start in /home/cromon/CLionProjects/test-proj/cmake-build-debug/test-proj\n</code></pre>\n\n<p>This is the output with the binary created on the build server on my unix machine:</p>\n\n<pre><code> 0# foo::Bar::fooBar() in ./test-proj\n 1# main at /opt/teamcity/2018.2/TeamCity/buildAgent/work/d79789e141c5605f/test-proj/main.cpp:31\n 2# __libc_start_main in /lib/x86_64-linux-gnu/libc.so.6\n 3# _start in ./test-proj\n</code></pre>\n\n<p>Now if I am using the binary that was compiled using mingw on Unix on my Windows machine the following output can be observed</p>\n\n<pre><code>0# ZN5boost10stacktrace16basic_stacktraceISaINS0_5frameEEE4initEyy at /opt/teamcity/boost/1_69/windows/include/boost-1_69/boost/stacktrace/stacktrace.hpp:75\n1# ZN3foo3Bar6fooBarEv at /opt/teamcity/2018.2/TeamCity/buildAgent/work/eb975d0a928ba129/test_proj/main.cpp:22\n2# main at /opt/teamcity/2018.2/TeamCity/buildAgent/work/eb975d0a928ba129/test_proj/main.cpp:31\n3# _tmainCRTStartup at ./mingw-w64-crt/crt/crtexe.c:336\n4# mainCRTStartup at ./mingw-w64-crt/crt/crtexe.c:214\n5# register_frame_ctor in C:\\WINDOWS\\System32\\KERNEL32.DLL\n6# register_frame_ctor in C:\\WINDOWS\\SYSTEM32\\ntdll.dll\n</code></pre>\n\n<p>I have also tried to loop through the frames and run a <code>boost::core::demangle</code> on them, but it fails to do so.</p>\n\n<p>There is so far only one difference I can see between the compilation environment on unix and the runtime environment on my windows machine. On Windows I have <code>g++</code> of version <code>8.2.0</code> and on unix it is <code>6.3.0</code>. Is this causing any problems? What else could cause the demangling to fail only on windows when cross compiled?</p>\n"}, {"tags": ["c++", "variables", "random", "int"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1548266409, "post_id": 54333069, "comment_id": 95483805, "body": "How many elements is there in the array <code>ynumber</code>? How many elements do you write to in the loop?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1548266450, "post_id": 54333069, "comment_id": 95483827, "body": "<b><i>I realised that my variable is getting random</i></b> Which variable?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1548266498, "post_id": 54333069, "comment_id": 95483858, "body": "Better change <code>for (int i = 0; i &lt; 6; i++)</code> to <code>for (int i = 0; i &lt; 5; i++)</code> since you have <code>int ynumber[5];</code>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1548266503, "post_id": 54333069, "comment_id": 95483861, "body": "Also, don&#39;t use global variables, define the variables as close as possible to the place where they are being used."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 3, "creation_date": 1548266539, "post_id": 54333069, "comment_id": 95483877, "body": "<a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1548266612, "post_id": 54333069, "comment_id": 95483919, "body": "By the way, with the current code you don&#39;t actually need the array at all. A simple variable <code>int ynumber;</code> would be enough. That would of course also solve the <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><i>undefined behavior</i></a> you have by going out of bounds of the array."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1548267161, "post_id": 54333069, "comment_id": 95484159, "body": "Rather than asking others to debug your program it&#39;s going to be more productive to try to learn how to debug."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548267727, "post_id": 54333069, "comment_id": 95484454, "body": "&quot;<i>my variable is getting random, even if I set it to 0</i>&quot; - sounds like a classic <b>buffer overflow</b> to me."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10718975, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZXxVIcd3zHg/AAAAAAAAAAI/AAAAAAAAADE/5--FeiVF80E/photo.jpg?sz=128", "display_name": "Mateusz Dettlaff", "link": "https://stackoverflow.com/users/10718975/mateusz-dettlaff"}, "edited": false, "score": 0, "creation_date": 1548267952, "post_id": 54333341, "comment_id": 95484557, "body": "Thank you I forgot about it when I was changing the number in the array ;)."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 33, "user_id": 10718975, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZXxVIcd3zHg/AAAAAAAAAAI/AAAAAAAAADE/5--FeiVF80E/photo.jpg?sz=128", "display_name": "Mateusz Dettlaff", "link": "https://stackoverflow.com/users/10718975/mateusz-dettlaff"}, "edited": false, "score": 0, "creation_date": 1548268051, "post_id": 54333341, "comment_id": 95484602, "body": "@MateuszDettlaff Using <code>std::size</code> neatly avoids <i>that</i> problem :)"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 4, "last_activity_date": 1548267942, "last_edit_date": 1548267942, "creation_date": 1548267412, "answer_id": 54333341, "question_id": 54333069, "link": "https://stackoverflow.com/questions/54333069/how-can-i-set-my-variable-in-c-to-0-and-prevent-it-from-getting-random/54333341#54333341", "title": "How can I set my variable in C++ to 0 and prevent it from getting random?", "body": "<blockquote>\n<pre><code>int ynumber[5];\n</code></pre>\n</blockquote>\n\n<p>The length of your array is 5</p>\n\n<blockquote>\n<pre><code>for (int i = 0; i &lt; 6; i++)\n{\n//...\n     cin &gt;&gt; ynumber[i];\n</code></pre>\n</blockquote>\n\n<p>You loop over the indices 0,1,2,3,4,5. Use your fingers to count the number of indices that you use. You'll notice that you access the array at 6 different fingers. 6 is more than 5. As such, we can conclude that you're accessing the array out of bounds. The consequence is that behaviour of your program is undefined.</p>\n\n<p>Solution: Do not access an array out of bounds. The last index of array of length <code>n</code> is <code>n - 1</code>.</p>\n\n<p>More generally: Don't rely on magic numbers. In this case, you could use instead:</p>\n\n<pre><code>for (int i = 0; i &lt; std::size(ynumber); i++)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10718975, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZXxVIcd3zHg/AAAAAAAAAAI/AAAAAAAAADE/5--FeiVF80E/photo.jpg?sz=128", "display_name": "Mateusz Dettlaff", "link": "https://stackoverflow.com/users/10718975/mateusz-dettlaff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 54333341, "answer_count": 1, "score": -5, "last_activity_date": 1548267942, "creation_date": 1548266288, "last_edit_date": 1548267525, "question_id": 54333069, "link": "https://stackoverflow.com/questions/54333069/how-can-i-set-my-variable-in-c-to-0-and-prevent-it-from-getting-random", "title": "How can I set my variable in C++ to 0 and prevent it from getting random?", "body": "<p>I am a beginner in programming. I was doing some simple applications. I was already done with my programme when I realised that my variable is getting random, even if I set it to 0. I was trying to figure it out why. My goal is to add 1 to the \"cor\" variable when the answer is matching the random generated number, the \"else\" section is working as it has to be. Maybe someone more experienced can help me. </p>\n\n<p>`</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;time.h&gt;\n#include &lt;Windows.h&gt;\n\nusing namespace std;\n\nint number;\nint ynumber[5];\nint cor = 0;\nint falsed = 0;\n\nint main()\n{\n    cout &lt;&lt; \"Welcome to our lottery!\" &lt;&lt; endl; \n\n    cout &lt;&lt; \"We start in ...\" &lt;&lt; endl;\n    Sleep(2000);\n\n\n    for (int i = 3; i &gt;= 0; i--)\n    {\n        system(\"cls\");\n        cout &lt;&lt; i &lt;&lt; endl;\n        Sleep(1000);\n    }\n\n    system(\"cls\");\n    srand(time(NULL));\n\n    for (int i = 0; i &lt; 6; i++)\n    {\n        cout &lt;&lt; \"Type your \" &lt;&lt; i+1 &lt;&lt; \" number below\" &lt;&lt; endl;\n        cin &gt;&gt; ynumber[i];\n\n        number = rand() % 50 + 1;\n        cout &lt;&lt; \"The picked number is: \" &lt;&lt; number &lt;&lt; endl;\n        Sleep(1000);\n\n        if (ynumber[i] == number)\n        {\n            cout &lt;&lt; \"Same same!\" &lt;&lt; endl;\n            cor = cor + 1;\n        }\n        else\n        {\n            cout &lt;&lt; \"Hope for better luck next time ;)\" &lt;&lt; endl;\n            falsed = falsed + 1; \n        }\n    }\n\n    system(\"cls\");\n\n    cout &lt;&lt; \"Thank you for participating!\" &lt;&lt; endl &lt;&lt; \"Correct picked numbers: \" &lt;&lt; cor &lt;&lt; endl &lt;&lt; \"Wrong picked numbers: \" &lt;&lt; falsed &lt;&lt; endl &lt;&lt; endl;\n\n    system(\"pause\");\n\n    return 0;\n}\n</code></pre>\n\n<p>`</p>\n"}, {"tags": ["c++", "linux", "flush"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 2, "creation_date": 1548266091, "post_id": 54332970, "comment_id": 95483658, "body": "Your explanation isn&#39;t quite clear (to me). Obviously the file exists when B calls Flush. Please add some code that illustrates the issue."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 3, "creation_date": 1548266117, "post_id": 54332970, "comment_id": 95483674, "body": "What OS is this on?  Typically the OS&#39;s filesystem has an integrated buffering layer so that even if the data isn&#39;t physically on disk yet, another program trying to read the file will still &quot;see&quot; it because the filesystem driver&#39;s read-routine knows to look in the filesystem&#39;s memory-cache before looking on the disk."}, {"owner": {"reputation": 145, "user_id": 10205512, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hCja2imyCxY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qiiPpav1FB4p3qoUBucJYdr_7Xdg/mo/photo.jpg?sz=128", "display_name": "buj", "link": "https://stackoverflow.com/users/10205512/buj"}, "edited": false, "score": 0, "creation_date": 1548266180, "post_id": 54332970, "comment_id": 95483714, "body": "This is on linux, I did not test it on other OS."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1548266469, "post_id": 54332970, "comment_id": 95483840, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1548266967, "post_id": 54332970, "comment_id": 95484081, "body": "The scenario you have described does not exist. If A accesses the file that B should have written, it will succeed even if the file does not yet exist on disk."}], "answers": [{"comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1548267342, "post_id": 54333259, "comment_id": 95484247, "body": "This just affects the OS file cache and is useful to make sure that the data is actually on disk (for e.g. transactional integrity in face of power loss), but the OS already provides a coherent view of the content of the file across processes even without syncing to disk."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1548267351, "post_id": 54333259, "comment_id": 95484252, "body": "Ah ok now I see the edit."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1548267437, "last_edit_date": 1548267437, "creation_date": 1548267152, "answer_id": 54333259, "question_id": 54332970, "link": "https://stackoverflow.com/questions/54332970/c-blocking-flush/54333259#54333259", "title": "C++ blocking flush", "body": "<p>For resileince against system crashes, you want the fsync/fdatasync  syscall.</p>\n\n<ul>\n<li><a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fsync.html\" rel=\"nofollow noreferrer\">http://pubs.opengroup.org/onlinepubs/9699919799/functions/fsync.html</a></li>\n<li><a href=\"https://linux.die.net/man/2/fsync\" rel=\"nofollow noreferrer\">https://linux.die.net/man/2/fsync</a></li>\n</ul>\n\n<p>From POSIX:</p>\n\n<blockquote>\n  <p>The fsync() function shall request that all data for the open file\n  descriptor named by fildes is to be transferred to the storage device\n  associated with the file described by fildes. The nature of the\n  transfer is implementation-defined. The fsync() function shall not\n  return until the system has completed that action or until an error is\n  detected.</p>\n</blockquote>\n\n<p>For simple IPC like you've described in the question, you don't need to do anything.</p>\n\n<p>When A looks at info that B has fflushed to the system, it doesn't matter that the info hasn't made it to disk yet. A won't take it from the disk, it will take it from the system and the system will give it up to date info regardless of whether the data's been synced to permanent storage or not.</p>\n"}], "owner": {"reputation": 145, "user_id": 10205512, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hCja2imyCxY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qiiPpav1FB4p3qoUBucJYdr_7Xdg/mo/photo.jpg?sz=128", "display_name": "buj", "link": "https://stackoverflow.com/users/10205512/buj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "closed_date": 1548267389, "answer_count": 1, "score": 2, "last_activity_date": 1548269889, "creation_date": 1548265870, "last_edit_date": 1548269889, "question_id": 54332970, "link": "https://stackoverflow.com/questions/54332970/c-blocking-flush", "closed_reason": "Needs details or clarity", "title": "C++ blocking flush", "body": "<p>I want to flush a file output stream (fstream). If I do it the usual way (flush()), the program does not wait until the contents of the file are actually written, it continues on. To illustrate the issue, consider the following scenario:</p>\n\n<p>A requires B to write something to a file. B immediately returns upon completion of the task. Then, A accesses the file. Unfortunately, the B has finished before the OS actually managed to write the contents of the file. The file does not exist yet, A crashes.</p>\n\n<p>So, is there something like a blocking flush?</p>\n\n<p>Note that the issue does not arise when B writes to cout, and B's stdout is redirected to a file. Unfortunately, if B uses cout for other purposes, this workaround cannot be applied.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> I've found out that the problem lies somewhere else in the end. For those of you that are interested:</p>\n\n<p>Short version is, that the file indeed did exist, but could not be read because another program was still writing to it.</p>\n\n<p>Long version: Suppose we receive program A, which can be thought of as a \"solution\" to some algorithmic problem. The problem is on-line, meaning that the input must be provided to A in small chunks. To do this, we create a program B that communicates with A. Whenever A sends an answer, B sends the next input chunk. We run an interaction between A and B: we create a FIFO file (<code>mkfifo fifo</code>) and then <code>A &lt; fifo | B &gt; fifo</code>.</p>\n\n<p>We want to capture the output of A and see if it matches some target output file <code>target.out</code>. One way to do this is to have B open a file stream (<code>fstream fout(\"test.out\", fstream::out)</code>) and write everything it reads from A there. Another solution is this: <code>A &lt; fifo | tee test.out | B &gt; fifo</code>. After the interaction between A and B is done, we run <code>diff test.out target.out</code> to compare them.</p>\n\n<p>Unfortunately, both of the solutions suffer the following problem: once A finishes, we immediately continue to the comparison. The <code>tee</code> or <code>B</code>, whichever is the author of <code>test.out</code>, need not have finished yet. If so, the file cannot be read (even though it exists, as many of you have pointed out).</p>\n\n<p>Switching the order of A and B does not come into consideration, because we are capturing the return code of A, too. (Gotta report that the solution has crashed when it has crashed.)</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1548265900, "post_id": 54332928, "comment_id": 95483577, "body": "<a href=\"https://stackoverflow.com/questions/40577339/replace-substring-case-insensitive-in-c\" title=\"replace substring case insensitive in c\">stackoverflow.com/questions/40577339/&hellip;</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548265910, "post_id": 54332928, "comment_id": 95483581, "body": "If you have an attempt that builds, then please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> from that."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548266011, "post_id": 54332928, "comment_id": 95483620, "body": "As for your problem, the <a href=\"https://en.cppreference.com/w/cpp/regex/syntax_option_type\" rel=\"nofollow noreferrer\">regex flags</a> have an option for case insensitivity. The &quot;match word&quot; have more to do with your regex."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9138388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52695aa4bb5c605026bc3ef9a7bdc30a?s=128&d=identicon&r=PG&f=1", "display_name": "FOREX V", "link": "https://stackoverflow.com/users/9138388/forex-v"}, "edited": false, "score": 0, "creation_date": 1548344408, "post_id": 54334218, "comment_id": 95515915, "body": "Thanks it works. The reason I described in the question the whole function is because I need it for a complete file. and what i did is <code>regex_replace(ost{ outfile }, begin(content), end(content), std::regex { R&quot;DELIM(\\bis\\b)DELIM&quot;, std::regex::icase }, &quot;was&quot;);</code> and only Match whole word works and not Match case \u2013 In your function it works but in my function it is not What can I do for this to work, too?"}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "reply_to_user": {"reputation": 17, "user_id": 9138388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52695aa4bb5c605026bc3ef9a7bdc30a?s=128&d=identicon&r=PG&f=1", "display_name": "FOREX V", "link": "https://stackoverflow.com/users/9138388/forex-v"}, "edited": false, "score": 0, "creation_date": 1548344628, "post_id": 54334218, "comment_id": 95516074, "body": "@FOREXV it is not possible to help without an MCVE. i.e show code that I can copy paste, compile and run. If you insist on using files for input, put its contents as well."}, {"owner": {"reputation": 17, "user_id": 9138388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52695aa4bb5c605026bc3ef9a7bdc30a?s=128&d=identicon&r=PG&f=1", "display_name": "FOREX V", "link": "https://stackoverflow.com/users/9138388/forex-v"}, "edited": false, "score": 0, "creation_date": 1548346781, "post_id": 54334218, "comment_id": 95517483, "body": "Sorry. I updated the question above with all the new problems. You can also see the function itself how I modified it to fit your code. I would like to say thank you very much for your help and I greatly appreciate it"}, {"owner": {"reputation": 17, "user_id": 9138388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52695aa4bb5c605026bc3ef9a7bdc30a?s=128&d=identicon&r=PG&f=1", "display_name": "FOREX V", "link": "https://stackoverflow.com/users/9138388/forex-v"}, "edited": false, "score": 0, "creation_date": 1548970259, "post_id": 54334218, "comment_id": 95746887, "body": "I&#39;ve improved the question above Please can you tell me if it&#39;s enough for you to help me? And if it is not then please tell me so I can improve it. Many thanks for your help"}], "tags": [], "owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "is_accepted": false, "score": 1, "last_activity_date": 1548271069, "creation_date": 1548271069, "answer_id": 54334218, "question_id": 54332928, "link": "https://stackoverflow.com/questions/54332928/how-to-replace-strings-with-match-case-and-match-whole-word-in-c/54334218#54334218", "title": "how to replace strings with &quot;Match case&quot; and &quot;Match whole word&quot; in C++", "body": "<p>First, you have to present a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>. Your for loop, filenames are not necessary to describe your problem.</p>\n\n<p>For,</p>\n\n<p>Match Case, pass <code>std::regex::icase</code> flag</p>\n\n<p>Match Whole word, Use word boundries <code>\\b</code> around the regex.</p>\n\n<p>Example:</p>\n\n<pre><code>int main()\n{\n    std::string input = \"My name is isha. Is it true?\";\n    std::regex reg{R\"DELIM(\\bis\\b)DELIM\", std::regex::icase};\n    std::cout &lt;&lt; std::regex_replace(input, reg, \"was\");\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>My name was isha. was it true?\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9138388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52695aa4bb5c605026bc3ef9a7bdc30a?s=128&d=identicon&r=PG&f=1", "display_name": "FOREX V", "link": "https://stackoverflow.com/users/9138388/forex-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1549018366, "creation_date": 1548265693, "last_edit_date": 1549018366, "question_id": 54332928, "link": "https://stackoverflow.com/questions/54332928/how-to-replace-strings-with-match-case-and-match-whole-word-in-c", "title": "how to replace strings with &quot;Match case&quot; and &quot;Match whole word&quot; in C++", "body": "<p>I use this function to replace strings in an entire file. </p>\n\n<p>I Need the search and replace to be case sensitive\nbut the problem is that \"Match case\" does not work in this function although there is the icase flag include within the code</p>\n\n<pre><code>int Replace() {\n\nauto from = R\"DELIM(\\bis\\b)DELIM\"; //replace only \"is\" not \"Is\" or \"iS\" or \"IS\"\nauto to   = \"was\"; //replace with \"was\"\n\n //The file is created automatically in the debug folder of the software then you \n //can put all your \"is\" \"Is\" \"iS\" \"IS\" options into it In order to check if it works\n for (auto filename : { \"A.txt\" }) {\n ifstream infile{ filename };  string c { ist {infile}, ist{} };  infile.close();\n ofstream outfile{ filename };\n\n //std::regex::icase flag does not work    \n regex_replace(ost{outfile},begin(c),end(c),std::regex {from, std::regex::icase}, to); \n}return 0;}\n</code></pre>\n\n<p>How can I make the search and replace process case sensitive?</p>\n"}, {"tags": ["c++", "ld", "ld-preload", "nm", "objcopy"], "answers": [{"comments": [{"owner": {"reputation": 2430, "user_id": 730070, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d09c7ccd960850eb07acd2f8f258fd0a?s=128&d=identicon&r=PG", "display_name": "BrianTheLion", "link": "https://stackoverflow.com/users/730070/brianthelion"}, "edited": false, "score": 0, "creation_date": 1548772455, "post_id": 54423018, "comment_id": 95656670, "body": "Do you have a citation for the objcopy limitations you mentioned?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 2430, "user_id": 730070, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d09c7ccd960850eb07acd2f8f258fd0a?s=128&d=identicon&r=PG", "display_name": "BrianTheLion", "link": "https://stackoverflow.com/users/730070/brianthelion"}, "edited": false, "score": 0, "creation_date": 1548772682, "post_id": 54423018, "comment_id": 95656833, "body": "Mostly very old ones like <a href=\"http://sourceware-org.1504.n7.nabble.com/objcopy-redefine-sym-on-dynsym-section-td119610.html\" rel=\"nofollow noreferrer\">objcopy --redefine-sym on .dynsym section</a>, but now that you know what&#39;s happening, searching for <i>ELF renaming symbols in the dynamic symbol table</i> (or similar) will probably give the all those I found."}, {"owner": {"reputation": 2430, "user_id": 730070, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d09c7ccd960850eb07acd2f8f258fd0a?s=128&d=identicon&r=PG", "display_name": "BrianTheLion", "link": "https://stackoverflow.com/users/730070/brianthelion"}, "edited": false, "score": 0, "creation_date": 1548772800, "post_id": 54423018, "comment_id": 95656911, "body": "Looks like it&#39;s probably the right answer but I&#39;m looking for an official reference to reward the bounty."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 2430, "user_id": 730070, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d09c7ccd960850eb07acd2f8f258fd0a?s=128&d=identicon&r=PG", "display_name": "BrianTheLion", "link": "https://stackoverflow.com/users/730070/brianthelion"}, "edited": false, "score": 0, "creation_date": 1548774588, "post_id": 54423018, "comment_id": 95658197, "body": "I suspect that&#39;s going to be hard. I looked at the source code, <a href=\"https://chromium.googlesource.com/native_client/nacl-toolchain/+/vendor-src/binutils/binutils/objcopy.c\" rel=\"nofollow noreferrer\">objcopy.c</a> and could only find <code>SHT_SYMTAB</code> mentioned in there, not <code>SHT_DYNSYM</code> that you can find in tools just reading files, like <a href=\"https://chromium.googlesource.com/native_client/nacl-binutils/+/upstream/master/binutils/readelf.c\" rel=\"nofollow noreferrer\">readelf.c</a>. Perhaps that&#39;s a sign that it can&#39;t be done with <code>objcopy</code>."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 2430, "user_id": 730070, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d09c7ccd960850eb07acd2f8f258fd0a?s=128&d=identicon&r=PG", "display_name": "BrianTheLion", "link": "https://stackoverflow.com/users/730070/brianthelion"}, "edited": false, "score": 0, "creation_date": 1548948761, "post_id": 54423018, "comment_id": 95736078, "body": "@BrianTheLion I added a link to a query I made on the binutils mailing list. Perhaps someone will give an official statement there some day. I&#39;ve also cloned the latest and greatest version of binutils/objcopy but haven&#39;t found anything in there suggesting it can be done."}], "tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": true, "score": 7, "last_activity_date": 1548948534, "last_edit_date": 1548948534, "creation_date": 1548771377, "answer_id": 54423018, "question_id": 54332797, "link": "https://stackoverflow.com/questions/54332797/binding-failure-with-objcopy-redefine-syms/54423018#54423018", "title": "Binding failure with objcopy --redefine-syms", "body": "<blockquote>\n  <p>WHY? What's the story here?</p>\n</blockquote>\n\n<p><code>objcopy -redefine-syms</code> will only redefine the debugging symbols in the <code>.symtab</code> and <code>.strtab</code> symbol tables, not the symbols in the <code>.dynsym</code> and <code>.dynstr</code> symbol tables that is used for dynamic loading.</p>\n\n<p>If you examine the library you created with <code>objcopy</code> with <code>nm -D</code> or <code>readelf -s</code> you'll see that the name used by the dynamic loader is still <code>_ZN3foq3barEii</code>, or with <code>nm -DC</code>, <code>foq::bar(int, int)</code>.</p>\n\n<p>So, that's what's going on.</p>\n\n<p>The most official references I could find indicating that <code>objcopy</code> can't be used to update the dynamic symbols is this unassigned bugzilla entry from 2010:</p>\n\n<p><a href=\"https://sourceware.org/bugzilla/show_bug.cgi?id=11386\" rel=\"nofollow noreferrer\">Bug 11386 - objcopy should be able to update dynamic symbols visibility</a></p>\n\n<p>And my own query on the official <code>binutils</code> mailing list:</p>\n\n<p><a href=\"https://www.sourceware.org/ml/binutils/2019-01/msg00254.html\" rel=\"nofollow noreferrer\">Redefining dynamic symbols</a></p>\n\n<hr>\n\n<p>As a side note, I don't think there's a tool available to redefine the dynamic symbols (properly), but I could be wrong.</p>\n\n<p>The <a href=\"https://github.com/cjacker/elfhash\" rel=\"nofollow noreferrer\">cjacker/elfhash</a> project from 2015 seems to make an attempt. I tried that and it seems to actually rename the dynamic symbol name - but loading the <code>.so</code> afterwards fails and the original libs symbol is used instead.</p>\n\n<pre><code>% elfhash -f _ZN3foq3barEii -t _ZN3foo3barEii libmyfoq.so\n% mv libmyfoq.so libmyfoo.so\n% LD_DEBUG=bindings LD_DEBUG_OUTPUT=ld_debug.log LD_PRELOAD=./libmyfoo.so ./fooapp\nERROR: ld.so: object './libmyfoo.so' from LD_PRELOAD cannot be preloaded (cannot change memory protections): ignored.\n</code></pre>\n"}], "owner": {"reputation": 2430, "user_id": 730070, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d09c7ccd960850eb07acd2f8f258fd0a?s=128&d=identicon&r=PG", "display_name": "BrianTheLion", "link": "https://stackoverflow.com/users/730070/brianthelion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 2, "accepted_answer_id": 54423018, "answer_count": 1, "score": 12, "last_activity_date": 1548948534, "creation_date": 1548265140, "last_edit_date": 1548273538, "question_id": 54332797, "link": "https://stackoverflow.com/questions/54332797/binding-failure-with-objcopy-redefine-syms", "title": "Binding failure with objcopy --redefine-syms", "body": "<h1>Preconditions</h1>\n\n<p>A third-party has provided a C++ executable <code>fooapp</code> that uses a shared object <code>libfoo.so</code>. The library also comes with a header <code>foo.hpp</code> so developers can build other applications:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>/* foo.hpp */\nnamespace foo {\n  void bar(int a, int b);\n  // More code below here &lt;--- NOTE!!!\n}\n</code></pre>\n\n<h1>Success example</h1>\n\n<p>This is a standard <code>LD_PRELOAD</code>-based function interposition workflow.</p>\n\n<p>First, I write my own version of the library, <code>myfoo.cpp</code> that exactly mirrors <strong>part of</strong> <code>foo.hpp</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>/* myfoo.hpp */\n# include &lt;ofstream&gt;\nnamespace foo {\n  void bar(int a, int b) {\n    std::cout &lt;&lt; a &lt;&lt; \",\" &lt;&lt; b &lt;&lt; std::endl;\n  }\n  // NOTHING below here &lt;-- NOTE!!!\n}\n</code></pre>\n\n<p>Then I compile my library into <code>libmyfoo.so</code> and see the following:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ nm libfoo.so -C | fgrep bar\n0000000000021fc0 T foo::bar(int, int)\n$ nm libmyfoo.so -C | fgrep bar\n0000000000010c30 T foo::bar(int, int)\n$ LD_DEBUG=bindings LD_DEBUG_OUTPUT=ld_debug.log LD_PRELOAD=./libmyfoo.so fooapp\n</code></pre>\n\n<p><strong>Success!</strong> <code>ld_debug.log</code> shows binding as expected, and <code>bar(...)</code> generates output to the console.</p>\n\n<h1>Failure example</h1>\n\n<p>For the failure example, I'm going to (1) change one character in <code>myfoo.hpp</code> and (2) then fix that character in the binary using <code>objcopy</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>/* myfoo.hpp */\n# include &lt;ofstream&gt;\nnamespace foq { // &lt;-- NAME CHANGE!\n  void bar(int a, int b) {\n    std::cout &lt;&lt; a &lt;&lt; \",\" &lt;&lt; b &lt;&lt; std::endl;\n  }\n  // NOTHING below here &lt;-- NOTE!!!\n}\n</code></pre>\n\n<p>When I compile my library into <code>libmyfoq.so</code> I see the following:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ nm libfoo.so -C | fgrep bar\n0000000000021fc0 T foo::bar(int, int) # &lt;-- Sames as before\n$ nm libmyfoq.so -C | fgrep bar\n0000000000010c30 T foq::bar(int, int) # &lt;-- New name as expected\n$ objcopy --redefine-syms=sym.map libmyfoq.so libmyfoo.so # &lt;-- NEW STEP!\n$ nm libmyfoo.so -C | fgrep bar\n0000000000010c30 T foo::bar(int, int) # &lt;-- SUCCESSful name update\n$ LD_DEBUG=bindings LD_DEBUG_OUTPUT=ld_debug.log LD_PRELOAD=./libmyfoo.so fooapp\n</code></pre>\n\n<p><strong>Failure!</strong> <code>ld_debug.log</code> shows <em>NO</em> binding of <code>fooapp</code> symbols to <code>libmyfoo.so</code>.</p>\n\n<p>(PS -- If you're curious, <code>sym.map</code> contains a mapping between the mangled name of <code>foq::bar</code> and the mangled name of <code>foo::bar</code>. You can see these if you drop the <code>-C</code> from the <code>nm</code> command. See <code>man objcopy</code> for additional details.)</p>\n\n<h1>WHY?</h1>\n\n<p>In summary:</p>\n\n<ul>\n<li><code>objcopy</code> is renaming the symbol correctly.</li>\n<li>The symbol name hasn't changed size.</li>\n<li><strong>BUT</strong> the loader is ignoring it at load time.</li>\n</ul>\n\n<p>What's the story here?</p>\n"}, {"tags": ["c++", "language-lawyer"], "answers": [{"comments": [{"owner": {"reputation": 1231, "user_id": 1162978, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0e908671c0508cbb172a1ef30ff66c54?s=128&d=identicon&r=PG", "display_name": "WaldB", "link": "https://stackoverflow.com/users/1162978/waldb"}, "edited": false, "score": 0, "creation_date": 1548272423, "post_id": 54333806, "comment_id": 95486514, "body": "<code>The highlighted sentence applies to any union-like class X that has an anonymous union member. X may be a non-union class.</code> That&#39;s not what the quote says: &quot;<b>If x is a union</b>, a non-static data member of x that is not an anonymous union is ...&quot;"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 1231, "user_id": 1162978, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0e908671c0508cbb172a1ef30ff66c54?s=128&d=identicon&r=PG", "display_name": "WaldB", "link": "https://stackoverflow.com/users/1162978/waldb"}, "edited": false, "score": 0, "creation_date": 1548272564, "post_id": 54333806, "comment_id": 95486582, "body": "@WaldB <code>If x is a union</code> is a condition for the previous sentence. It no longer applies to the next sentence."}, {"owner": {"reputation": 1231, "user_id": 1162978, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0e908671c0508cbb172a1ef30ff66c54?s=128&d=identicon&r=PG", "display_name": "WaldB", "link": "https://stackoverflow.com/users/1162978/waldb"}, "edited": false, "score": 0, "creation_date": 1548272859, "post_id": 54333806, "comment_id": 95486712, "body": "That was exactly my interpretation, by exclusion. But it&#39;s my impression that anyone reading this paragraph would say the contrary, i.e., that the highlighted sentence applies only to the union case. In other words, I think the wording could be improved a little bit here. Don&#39;t you agree?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 1231, "user_id": 1162978, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0e908671c0508cbb172a1ef30ff66c54?s=128&d=identicon&r=PG", "display_name": "WaldB", "link": "https://stackoverflow.com/users/1162978/waldb"}, "edited": false, "score": 0, "creation_date": 1548273494, "post_id": 54333806, "comment_id": 95486968, "body": "@WaldB In my opinion, there is no ambiguity, but I suppose further clarification wouldn&#39;t hurt. Such as adding an example similar to the one in my answer."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1548272206, "last_edit_date": 1548272206, "creation_date": 1548269293, "answer_id": 54333806, "question_id": 54332785, "link": "https://stackoverflow.com/questions/54332785/definition-of-a-variant-member-in-the-standard/54333806#54333806", "title": "Definition of a variant member in the Standard", "body": "<blockquote>\n  <p>I have the impression that the highlighted sentence above applies only to the case where <code>X</code> is a union</p>\n</blockquote>\n\n<p>The highlighted sentence applies to any union-like class <code>X</code> that has an anonymous union member. <code>X</code> may be a non-union class.</p>\n\n<p>An example:</p>\n\n<pre><code>struct X {      // union-like, non-union class X\n    union {     // anonymous union member of X\n        int i;  // non-static data member of anonymous union\n        float f;\n    }\n}\n</code></pre>\n\n<p><code>i</code> and <code>f</code> are variant members of the union like class <code>X</code>, as per the highlighted rule.</p>\n"}], "owner": {"reputation": 1231, "user_id": 1162978, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0e908671c0508cbb172a1ef30ff66c54?s=128&d=identicon&r=PG", "display_name": "WaldB", "link": "https://stackoverflow.com/users/1162978/waldb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 54333806, "answer_count": 1, "score": 2, "last_activity_date": 1548272206, "creation_date": 1548265107, "last_edit_date": 1548265460, "question_id": 54332785, "link": "https://stackoverflow.com/questions/54332785/definition-of-a-variant-member-in-the-standard", "title": "Definition of a variant member in the Standard", "body": "<p><a href=\"http://eel.is/c++draft/class.union.anon#4\" rel=\"nofollow noreferrer\">[class.union.anom]/4</a></p>\n\n<blockquote>\n  <p>A union-like class is a union or a class that has an anonymous union\n  as a direct member. A union-like class <code>X</code> has a set of variant\n  members. If <code>X</code> is a union, a non-static data member of <code>X</code> that is\n  not an anonymous union is a variant member of <code>X</code>. <strong>In addition, a\n  non-static data member of an anonymous union that is a member of <code>X</code>\n  is also a variant member of <code>X</code></strong>. At most one variant member of a\n  union may have a default member initializer.</p>\n</blockquote>\n\n<p>English is not my native language, but just by reading this paragraph I have the impression that the highlighted sentence above applies only to the case where <code>X</code> is a union, which would turn this definition incomplete, as it would miss the definition of a variant member in a class. So, I must conclude that the highlighted sentence must apply to both cases, unions and classes. Could anyone confirm this? If that is not the case, then I think we a have a defect in this paragraph.  </p>\n"}, {"tags": ["c++", "macos", "qt", "terminal", "qt5"], "comments": [{"owner": {"reputation": 17562, "user_id": 568635, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25f0758867b3f251cfdf101b9611b9b5?s=128&d=identicon&r=PG", "display_name": "Eelke", "link": "https://stackoverflow.com/users/568635/eelke"}, "edited": false, "score": 1, "creation_date": 1548268080, "post_id": 54332703, "comment_id": 95484623, "body": "The problem is that when you execute that command in your terminal the string <code>$(df -h &#47; | tail -1 | cut -d&#39; &#39; -f 1)</code> is recognized by your shell and it executes those command for you and passes the resulting output as an argument to diskutil. QProcess is not a shell it just passes the string without any processing on to diskutil."}, {"owner": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "reply_to_user": {"reputation": 17562, "user_id": 568635, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25f0758867b3f251cfdf101b9611b9b5?s=128&d=identicon&r=PG", "display_name": "Eelke", "link": "https://stackoverflow.com/users/568635/eelke"}, "edited": false, "score": 0, "creation_date": 1548327787, "post_id": 54332703, "comment_id": 95505758, "body": "Got it... changed the process to: QStringList args;     args &lt;&lt; &quot;-c&quot; &lt;&lt; &quot;diskutil info $(df -h / | tail -1 | cut -d&#39; &#39; -f 1)&quot;;     p.start(&quot;/bin/bash&quot;, args);"}], "answers": [{"tags": [], "owner": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "is_accepted": true, "score": 0, "last_activity_date": 1548327891, "creation_date": 1548327891, "answer_id": 54345164, "question_id": 54332703, "link": "https://stackoverflow.com/questions/54332703/qprocess-on-macos-trying-to-use-diskutil/54345164#54345164", "title": "QProcess on MacOS trying to use diskutil", "body": "<p>The slight modification after Eelke explained. </p>\n\n<pre><code>QStringList args;\nargs &lt;&lt; \"-c\" &lt;&lt; \"diskutil info $(df -h / | tail -1 | cut -d' ' -f 1)\";\np.start(\"/bin/bash\", args);\n</code></pre>\n"}], "owner": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 54345164, "answer_count": 1, "score": 0, "last_activity_date": 1548327891, "creation_date": 1548264859, "question_id": 54332703, "link": "https://stackoverflow.com/questions/54332703/qprocess-on-macos-trying-to-use-diskutil", "title": "QProcess on MacOS trying to use diskutil", "body": "<p>Qt 5.12</p>\n\n<p>I am trying to get the volume ID on macOS and using the following function:</p>\n\n<pre><code>QString getVolumeInfo()\n{\n    QString volumeID = \"Cannot find the volumeID\";\n    QProcess p;\n    //diskutil info $(df -h / | tail -1 | cut -d' ' -f 1)\n    QString command = \"diskutil\";\n    QStringList args;\n    args &lt;&lt; \"info\" &lt;&lt;  \"$(df -h / | tail -1 | cut -d' ' -f 1)\";\n    p.start(command, args);\n    p.waitForStarted();\n    p.waitForFinished();\n    foreach(QString line, QString(p.readAll()).split(\"\\n\"))\n    {\n       if(line.contains(\"Volume UUID:\"))\n           volumeID = line;\n    }\n    return volumeID;\n}\n</code></pre>\n\n<p>I have to use the diskutil because of the limitation with macOS. However, QProcess, reading the object has nothing in it.</p>\n\n<p>Command on terminal: <strong>diskutil info $(df -h / | tail -1 | cut -d' ' -f 1)</strong>\nwhich returns a ton of information like:</p>\n\n<p>...</p>\n\n<p>SMART Status: Verified</p>\n\n<p>Volume UUID: 954BACF1-EBC5-4D14-86FB-0912CF7F839C</p>\n\n<p>Disk / Partition UUID: 954BACF1-EBC5-4D14-86FB-0912CF7F839C</p>\n\n<p>Disk Size: 500.1 GB (500068036608 Bytes) (exactly 976695384 512-Byte-Units)</p>\n\n<p>....</p>\n\n<p>When I try to add qDebug() to debug I get the following: true - \"Could not find disk: $(df -h / | tail -1 | cut -d' ' -f 1)\\n\"</p>\n\n<p>So seem like the arguments is not formatted or something?</p>\n\n<p>I am trying to implement: <a href=\"https://apple.stackexchange.com/questions/50302/how-can-i-tell-which-volume-the-operating-system-is-on\">https://apple.stackexchange.com/questions/50302/how-can-i-tell-which-volume-the-operating-system-is-on</a></p>\n"}, {"tags": ["c++", "templates", "template-argument-deduction"], "comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1548268786, "post_id": 54332593, "comment_id": 95484948, "body": "Why are you making a deep copy of the vector to print?"}, {"owner": {"reputation": 11, "user_id": 7270126, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZjUVTV0GXTw/AAAAAAAAAAI/AAAAAAAAABI/EOfcluAPp8k/photo.jpg?sz=128", "display_name": "Michele Pellegrino", "link": "https://stackoverflow.com/users/7270126/michele-pellegrino"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1548270809, "post_id": 54332593, "comment_id": 95485847, "body": "@MooingDuck it&#39;s just a test; i actually, in my project I would use reference to RNG objects, instead"}], "answers": [{"comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548267105, "post_id": 54332955, "comment_id": 95484137, "body": "Don&#39;t get it - can you explain how this can compile at all? <code>template&lt;class value_type&gt; static std::vector&lt;value_type&gt; vec;</code> - there&#39;s one static member vec, but type changes with each constructor call???"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548267284, "post_id": 54332955, "comment_id": 95484221, "body": "Hm, one static member created for each instantiated constructor?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 2, "creation_date": 1548267599, "post_id": 54332955, "comment_id": 95484394, "body": "@Aconcagua Correct. See <a href=\"https://en.cppreference.com/w/cpp/language/variable_template\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/variable_template</a>."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548267741, "post_id": 54332955, "comment_id": 95484461, "body": "@Aconcagua Honestly, I&#39;ve never seen it used before either. But the cppreference page details exactly what has to happen here (and the clange error messages are quite clear too)."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548269466, "post_id": 54332955, "comment_id": 95485252, "body": "Suppose it is such rarely seen because of forcing you into (numerous) static variables. That might be useful to avoid polymorphism <i>if</i> one needs the static variables anyway - or needs to avoid PM for performance reaons. Otherwise, I consider true template classes superior. (But still +1 for good answer.)"}, {"owner": {"reputation": 11, "user_id": 7270126, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZjUVTV0GXTw/AAAAAAAAAAI/AAAAAAAAABI/EOfcluAPp8k/photo.jpg?sz=128", "display_name": "Michele Pellegrino", "link": "https://stackoverflow.com/users/7270126/michele-pellegrino"}, "edited": false, "score": 0, "creation_date": 1548270389, "post_id": 54332955, "comment_id": 95485674, "body": "@MaxLanghof thank you; it does compile, even if I still can&#39;t understand the syntax &#39;vec&lt;value_type&gt;&#39; (I am probably still too ignorant about templates...)"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 11, "user_id": 7270126, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZjUVTV0GXTw/AAAAAAAAAAI/AAAAAAAAABI/EOfcluAPp8k/photo.jpg?sz=128", "display_name": "Michele Pellegrino", "link": "https://stackoverflow.com/users/7270126/michele-pellegrino"}, "edited": false, "score": 0, "creation_date": 1548318203, "post_id": 54332955, "comment_id": 95500236, "body": "@MichelePellegrino Variable templates are probably not the best to start with. I mean, I don&#39;t really get the reason why we have to provide the definition separately either. Function templates are a much better start for learning templates."}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 3, "last_activity_date": 1548265821, "creation_date": 1548265821, "answer_id": 54332955, "question_id": 54332593, "link": "https://stackoverflow.com/questions/54332593/template-argument-deduction-variable-template-how-can-i-make-it-work/54332955#54332955", "title": "Template argument deduction / variable template: how can I make it work?", "body": "<p>The error message says quite clearly what you have to do: Specify the template argument for <code>vec</code>.</p>\n\n<pre><code>  template&lt;class value_type&gt;\n  VectorPrinter(const std::vector&lt;value_type&gt;&amp; vec_)\n  {\n    // Using a reference here so we don't have to type all this again and again.\n    auto&amp; v = vec&lt;value_type&gt;;\n    v = vec_;\n    for (std::size_t i = 0; i &lt; v.size(); ++i)\n      std::cout &lt;&lt; v[i] &lt;&lt; std::endl;\n  }\n</code></pre>\n\n<p>You'll also have to provide the definition for your variable template:</p>\n\n<pre><code>template&lt;class value_type&gt;\nstd::vector&lt;value_type&gt; VectorPrinter::vec;\n</code></pre>\n\n<p>Together this should give you what you're asking for: <a href=\"https://godbolt.org/z/gVFvFw\" rel=\"nofollow noreferrer\">https://godbolt.org/z/gVFvFw</a><br>\n(Whether this is a good design for your use case is a different question).</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7270126, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZjUVTV0GXTw/AAAAAAAAAAI/AAAAAAAAABI/EOfcluAPp8k/photo.jpg?sz=128", "display_name": "Michele Pellegrino", "link": "https://stackoverflow.com/users/7270126/michele-pellegrino"}, "edited": false, "score": 0, "creation_date": 1548270715, "post_id": 54333121, "comment_id": 95485815, "body": "yes, you are right: this is probably a bad idea, I may try the way of template argument deduction, even if I am not keen in relying too much on the new features of the C++17 standard"}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 1, "last_activity_date": 1548269867, "last_edit_date": 1548269867, "creation_date": 1548266484, "answer_id": 54333121, "question_id": 54332593, "link": "https://stackoverflow.com/questions/54332593/template-argument-deduction-variable-template-how-can-i-make-it-work/54333121#54333121", "title": "Template argument deduction / variable template: how can I make it work?", "body": "<p>I have certain doubts if you are on the right way; you get forced to use static members this way, but now all instances will compete for this single common member (well, only all those that use the same template type, of course). This could lead to race conditions among those objects with same template type, especially in a multi-threaded environment.</p>\n\n<p>A true template class would allow to have non-static members, which might be safer and thus preferable.</p>\n\n<p>If you opted for template variables just for not having to repeat the template arguments on object creation, then there's good news: Since C++17, you can let <a href=\"https://en.cppreference.com/w/cpp/language/class_template_argument_deduction\" rel=\"nofollow noreferrer\">deduce</a> class template arguments from constructor. So if you <em>do</em> make your class a template:</p>\n\n<pre><code>template&lt;class value_type&gt;\nclass VectorPrinter { /* ... */ };\n</code></pre>\n\n<p>you still can define your objects without having to specify the template arguments:</p>\n\n<pre><code>VectorPrinter vp1(v1); // fine with above template, too - since C++17\n</code></pre>\n\n<p>but don't rely on static members.</p>\n\n<p>If you wanted to place multiple <code>VectorPrinter</code>s (template version) of different types into a common container, though, then you'd need to introduce a common base class. So in such a scenario, you have the choice: No static variables (especially: no varying number of), but polymorphism, or the other way round. I have my clear personal preference (doesn't mean I'd refuse the other approach, if proved superior in a specific scenario), but you'll have to weigh up yourself...</p>\n"}], "owner": {"reputation": 11, "user_id": 7270126, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZjUVTV0GXTw/AAAAAAAAAAI/AAAAAAAAABI/EOfcluAPp8k/photo.jpg?sz=128", "display_name": "Michele Pellegrino", "link": "https://stackoverflow.com/users/7270126/michele-pellegrino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548269867, "creation_date": 1548264376, "question_id": 54332593, "link": "https://stackoverflow.com/questions/54332593/template-argument-deduction-variable-template-how-can-i-make-it-work", "title": "Template argument deduction / variable template: how can I make it work?", "body": "<p>I have a problem in wrapping a template class in a non-template one;</p>\n\n<p>I'm trying to make this code work:</p>\n\n<p>my_class.hpp</p>\n\n<pre><code>#ifndef MY_CLASS_HPP\n#define MY_CLASS_HPP\n\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nclass VectorPrinter {\n\nprivate:\n\n  template&lt;class value_type&gt;\n  static std::vector&lt;value_type&gt; vec;\n\npublic:\n\n  template&lt;class value_type&gt;\n  VectorPrinter(const std::vector&lt;value_type&gt;&amp; vec_)\n  {\n    vec = vec_\n    for (std::size_t i = 0; i&lt;vec.size(); ++i)\n      std::cout &lt;&lt; vec[i] &lt;&lt; std::endl;\n  }\n\n};\n\n#endif /* MY_CLASS_HPP */\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include \"my_class.hpp\"\n#include &lt;string&gt;\n\nint main() {\n\nstd::vector&lt;int&gt; v1{1, 2, 3, 4, 5};\nstd::vector&lt;std::string&gt; v2{\"Hello\", \"world\", \"!\"};\nstd::vector&lt;double&gt; v3{2.5, 7.3, -5.1};\n\nVectorPrinter vp1(v1);\nVectorPrinter vp2(v2);\nVectorPrinter vp3(v3);\n\nreturn 0;\n\n}\n</code></pre>\n\n<p>I get the following error message while trying to compile (I tried -std=c++11, -std=c++14, -std=c++17: no difference; no difference neither switching from g++ to clang):</p>\n\n<pre><code>./my_class.hpp:19:5: error: cannot refer to variable template 'vec' without a template argument list\n</code></pre>\n\n<p>Now: my goal is to circumvent defining VectorPrinter as a template class or, alternatively, avoid specifying the template argument in the case VectorPrinter cannot be non-template; so my problem reside within the scope of either variable template or template argument deduction.</p>\n\n<p>This is just a test for my thesis project; what I need to achieve, at the end, is being able to define a template library for RNG and to encapsulate these classes in more complex ones which perform Direct Simulation Monte Carlo. So, at the end I would like something like:</p>\n\n<pre><code>template &lt;class engineType&gt;\nclass RngObject {\n   // ...\n};\n</code></pre>\n\n<pre><code>class Ensemble {\n   private:\n      template&lt;class engineType&gt; RngObject&lt;engineType&gt; rng;\n   // ...\n};\n</code></pre>\n\n<p>It would be quite boring having to define each and every class that encapsulate a RNG as template; moreover, I am asked to avoid using dynamic time polymorphism, at leat at this stage.</p>\n\n<p>I hope someone can provide me some useful suggestion.\nThanks</p>\n"}, {"tags": ["c++", "sfml"], "answers": [{"tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": true, "score": 1, "last_activity_date": 1548268799, "last_edit_date": 1548268799, "creation_date": 1548267957, "answer_id": 54333469, "question_id": 54332579, "link": "https://stackoverflow.com/questions/54332579/sfml-networking-socketselector-member-function-isready-not-working-correctly/54333469#54333469", "title": "Sfml networking, SocketSelector member function isReady not working correctly", "body": "<p>You created a client which connected to the server, sent one package and at the end of the scope was destroyed. Socket at the client side doesn't exist and the connection between client-server is closed. So, how do you want to get the information about closed connection at server side ?</p>\n\n<p>Function <code>isReady</code> returns true, then you call <code>receive</code> for this socket and as output you get one of <em>Status</em> codes: Done, NotReady, <strong>Disconnected</strong>, Error. You need to check if status is Disconnected, if so, the client socket should be removed from selector.</p>\n\n<pre><code>  if(selector.isReady(*(clients[i])))\n  {\n      sf::Packet pakiet;\n      if ( clients[i]-&gt;receive(pakiet) == sf::Socket::Done)\n      {\n          // process data\n      }\n      else if ( clients[i]-&gt;receive(pakiet) == sf::Socket::Disconnected ) {\n           // delete socket, remove from selector\n      }\n      else {\n         // \n      }\n  }\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 10256256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14338073191dfd427bfacde661893613?s=128&d=identicon&r=PG&f=1", "display_name": "mateusz834", "link": "https://stackoverflow.com/users/10256256/mateusz834"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 54333469, "answer_count": 1, "score": -1, "last_activity_date": 1548269544, "creation_date": 1548264336, "last_edit_date": 1548269544, "question_id": 54332579, "link": "https://stackoverflow.com/questions/54332579/sfml-networking-socketselector-member-function-isready-not-working-correctly", "title": "Sfml networking, SocketSelector member function isReady not working correctly", "body": "<p>I am coding simple networking system based on sfml-network liblary and tcp sockets.\nWhen i compile and run my program i am getting that output on screen(screenshot).\n<a href=\"https://i.stack.imgur.com/E2xs6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E2xs6.png\" alt=\"screenshot\"></a></p>\n\n<p>It looks like selector.wait() (Server.cpp:20) is not waiting for any packet and <code>selector.isReady(TCPSOCKET) (Server.cpp:43)</code> is not checking correctly if client is sending package to server.</p>\n\n<p>Code:\nmain.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"Server.h\"\n\nint main()\n{\n    int mode = 0;\n    std::cin &gt;&gt; mode;\n    if(mode == 0)\n    {\n        Server server(55200);\n    }else if(mode == 1){\n\n        sf::TcpSocket socket;\n\n        if (socket.connect(\"localhost\", 55200) != sf::Socket::Done)\n        {\n            std::cout &lt;&lt; \"Error1\\n\";\n        }\n        //Sleep(2000);\n        sf::Packet packet;\n        packet &lt;&lt; 11;\n        if (socket.send(packet) != sf::Socket::Done)\n        {\n            std::cout &lt;&lt; \"Error2\\n\";\n        }\n\n\n    }\n    std::cin.get();\n    std::cin.get();\n}\n</code></pre>\n\n<p>Server.h</p>\n\n<pre><code>#pragma once\n#include &lt;SFML/Network.hpp&gt;\n#include &lt;vector&gt;\nclass Server\n{\nprivate:\n    sf::TcpListener listener;\n    std::vector&lt;sf::TcpSocket*&gt; clients;\n    sf::SocketSelector selector;\n    unsigned short port;\npublic:\n    Server(unsigned short port);\n    ~Server();\n};\n</code></pre>\n\n<p>Server.cpp</p>\n\n<pre><code>#include \"Server.h\"\n#include &lt;iostream&gt;\n#include &lt;SFML/Network.hpp&gt;\n#include &lt;vector&gt;\n\nServer::Server(unsigned short pport)\n{\n    port = pport;\n    std::cout &lt;&lt; \"Starting Server....\\n\";\n    if (listener.listen(port) != sf::Socket::Done)\n    {\n        std::cout &lt;&lt; \"Failed while starting listening on port: \" &lt;&lt; port &lt;&lt; std::endl;\n        return;\n    }\n\n    selector.add(listener);\n\n    while(true)\n    {\n        if (selector.wait())\n        {\n\n            //new connection\n            if (selector.isReady(listener))\n            {\n                std::cout &lt;&lt; \"New connection!!\\n\";\n                sf::TcpSocket* tmp = new sf::TcpSocket; // !!!!!!!!!!!\n                if (listener.accept(*tmp) != sf::Socket::Done)\n                {\n                    std::cout &lt;&lt; \"Error while accepting new connection\\n\";\n                    delete tmp;\n                }\n                else {\n                    selector.add(*tmp);\n                    clients.push_back(tmp);\n                }\n            }\n            else {\n\n                for (int i = 0; i &lt; clients.size(); i++)\n                {\n                    //new incoming packet\n                    if(selector.isReady(*(clients[i])))\n                    {\n                        sf::Packet pakiet;\n                        if (clients[i]-&gt;receive(pakiet) != sf::Socket::Done)\n                        {\n                            std::cout &lt;&lt; \"Error while receiving packet\\n\";\n                        }\n                        else {\n                            int x;\n                            pakiet &gt;&gt; x;\n                            std::cout &lt;&lt; \"Recived new data!!!: \" &lt;&lt; x &lt;&lt; std::endl;\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n\nServer::~Server()\n{\n    for (int i = 0; i &lt; clients.size();i++)\n    {\n        delete clients[i];\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "dji-sdk"], "comments": [{"owner": {"reputation": 452, "user_id": 1972657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NjLuO.jpg?s=128&g=1", "display_name": "SChalice", "link": "https://stackoverflow.com/users/1972657/schalice"}, "edited": false, "score": 1, "creation_date": 1550616625, "post_id": 54332555, "comment_id": 96332123, "body": "I am using the Qt Sample application. I have converted it to pure VC using the Qt  VS Tools plugin. This is giving me the most Windows functionality for the M600. I have this working on Win 7 (VS2015) even though the docs suggest it is Win 10 only. <a href=\"https://developer.dji.com/onboard-sdk/documentation/sample-doc/qt-sample.html\" rel=\"nofollow noreferrer\">developer.dji.com/onboard-sdk/documentation/sample-doc/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 344, "user_id": 3176696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b56006f5afe7be59ecfcb6502f589f3?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/3176696/paul"}, "edited": false, "score": 0, "creation_date": 1558686283, "post_id": 56248604, "comment_id": 99189881, "body": "Thanks for the checklist... I also pretty much came to the same conclusion when I started to work with the OSDK. And then actually start working with the OSDK on windows (programming side) becomes a whole new ball-game where it was eventually just easier to work from the QT example and writing a c++ application (where I actually preferred porting the code with a dll to c# environment). But yeah, thanks for putting the steps out there for the other guys..."}], "tags": [], "owner": {"reputation": 1609, "user_id": 11530294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wmx8FmXvssw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddovKe67tDYNr2B-3B5bFJOj8cZg/mo/photo.jpg?sz=128", "display_name": "Dr Yuan Shenghai", "link": "https://stackoverflow.com/users/11530294/dr-yuan-shenghai"}, "is_accepted": true, "score": 2, "last_activity_date": 1558493042, "creation_date": 1558493042, "answer_id": 56248604, "question_id": 54332555, "link": "https://stackoverflow.com/questions/54332555/dji-osdk-in-windows/56248604#56248604", "title": "DJI OSDK in Windows", "body": "<p>Hi Im shenghai and I have been running DJI hardware for non-GPS/LIDAR/Vision based autonomous research for 3 years. </p>\n\n<p>It is a typical problem which DJI wont tell you the full list.  Here is a checklist that I come up with</p>\n\n<p>(1) Connect API cable first. Then Run OSDK. then connect simulator cable then run DJI assistant. There is proper sequence shit which DJI don't feel obliged to share. </p>\n\n<p>(2) Ensure your cable is 3.3, not 5</p>\n\n<p>(3) Tx Rx swap. Common problem. Can check by realterm</p>\n\n<p>(4) Ensure your DJI go app is running and the controller is powered on b4 \nstart serial connection</p>\n\n<p>(5) Ensure app id and enc key is correct. And the account this id and key are associated is also running in ur tablet. We encounter this issue for some special compassless firmware, if you have close relationships with DJI they will provide u with lots of shit to test. </p>\n\n<p>(6) Ensure your Serial have authority. In ubuntu is sudo chmod a+rw /dev/serial/by-id/usb-XXmanufactoridXX-port0. Windows forgot. haven`t use it for years</p>\n\n<p>(7) Ensure your API is enabled in DJI assistant. Also for a quick check, disconnect and connect to the assistant, ensure API is still checked. We have a bad experience with it. No matter how many time i check, it went uncheck. Took us a while to find the bug</p>\n\n<p>(8) Ensure you are running current Assistant 2. For matrix should be DJI assistant for Matrix. For a different drone, there is a different version. I know its complex. no idea why they do so. </p>\n\n<p>(9) Ensure you OSDK build is complete and functional. No missing dependency or funny errors. It happens a lot with new 3.7 and 3.8 stereo vision system</p>\n\n<p>That's pretty much all I can think so far. </p>\n"}], "owner": {"reputation": 344, "user_id": 3176696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b56006f5afe7be59ecfcb6502f589f3?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/3176696/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 1, "accepted_answer_id": 56248604, "answer_count": 1, "score": 0, "last_activity_date": 1558493042, "creation_date": 1548264238, "last_edit_date": 1551196373, "question_id": 54332555, "link": "https://stackoverflow.com/questions/54332555/dji-osdk-in-windows", "title": "DJI OSDK in Windows", "body": "<p>I'm trying to get the DJI OSDK up and running from windows environment, but am hitting a few road blocks along the way. Know the SDK has been published for Windows 10, but not yet including the .Net API for M200 / 600 (what I'm trying to interface).</p>\n\n<p>So I first figured my best chance for getting it running on <strong>Windows</strong> is by trying to run a linux sample application from windows (via Visual studio 2017). Struggled with linux dependencies in the beginning but eventually figured it out by writing a <em>Windows Serial conn</em> class and including <em>pthread.dll for windows</em> (with some minor additional alterations and included #if _WIN32 etc...)</p>\n\n<p>After quite a bit of coding and debugging (also tried Qt sample app via VS tools - whole can of worms on it's own), I'm still struggling with my \"Hello world\" application from the drone / RPA. (Even the rest works where I export it to a DLL and implement in c# environment, but besides the point).</p>\n\n<p>After connecting to the platform (basically initialization and serial port opening) the <em>Activate function</em> sends your app ID + key to the RPA and receives an acknowledgement: This being my code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    bool threadSupport = true;  //disable first so that able to debug\n    vehicle = new Vehicle(Port, baud, threadSupport, AdvancedSensing);\n\n    //test if connection works fine\n    if (!vehicle-&gt;protocolLayer-&gt;getDriver()-&gt;getDeviceStatus())\n    {\n        //not working, delete current instances\n        delete (vehicle);\n        vehicle = nullptr;  //set back to null pointer\n    }\n\n    DJI::OSDK::Vehicle::ActivateData actData;\n    actData.ID = appID;\n    actData.encKey = new char[65];\n    strcpy(actData.encKey, key);\n    actData.version = getFWVersion();\n\n    ACK::ErrorCode ack = vehicle-&gt;activate(&amp;actData, 1);\n</code></pre>\n\n<p>The activation function returns 'invalid feedback':</p>\n\n<blockquote>\n  <p>STATUS/1 @ DJI::OSDK::Win_serial_device::init, L47: Attempting to open device COM21 with baudrate 230400...</p>\n  \n  <p>STATUS/1 @ DJI::OSDK::Win_serial_device::init, L75: ...Serial started successfully.</p>\n  \n  <p>ERRORLOG/1 @ getDroneVersion, L1378: Drone version not obtained! Please do not proceed. Possible reasons: \n  Serial port connection: </p>\n  \n  <ul>\n  <li><p>SDK is not enabled, please check DJI Assistant2 SDK -> [v] Enable API Control. </p></li>\n  <li><p>Baudrate is not correct, please double-check from DJI Assistant2 -> SDK -> baudrate. </p></li>\n  <li><p>TX and RX pins are inverted. </p></li>\n  <li><p>Serial port is occupied by another program. * Permission required. Please do 'sudo usermod -a -G dialout $USER' (you do not need to replace $USER with your username). Then logout and login again</p></li>\n  </ul>\n  \n  <p>ERRORLOG/1 @ activate, L1267: Unable to initialize some vehicle components! STATUS/1 @ getErrorCodeMessage, L656: Activate STATUS/1 @ getCommonErrorCodeMessage, L722: ACK_NO_RESPONSE_ERROR</p>\n</blockquote>\n\n<p>...Already checked the suggested issues, but can't pick up anything apparent. At this point not knowing if the problem is hardware-, software (with altered code and threading). If anyone with DJI platforms (M-range), or on the DJI dev. team can please assist? I'm desperate to get this working! :(</p>\n\n<p>I've also shared the code solution on Github <a href=\"https://github.com/pw24/DJI-OSDK-Win32_console\" rel=\"nofollow noreferrer\">DJI OSDK Win Console</a> </p>\n"}, {"tags": ["c++", "winapi", "system-tray"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 5, "creation_date": 1548264203, "post_id": 54332515, "comment_id": 95482879, "body": "You can create a window and never show it."}, {"owner": {"reputation": 136, "user_id": 5965966, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6f8f66f8f1629ba4730e0d63f9a6687?s=128&d=identicon&r=PG", "display_name": "ZeroZ30o", "link": "https://stackoverflow.com/users/5965966/zeroz30o"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1548264344, "post_id": 54332515, "comment_id": 95482931, "body": "Oh my god, is this seriously how it&#39;s meant to work? Am I unable to pass a nullptr or anything?"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1548264645, "post_id": 54332515, "comment_id": 95483045, "body": "The docs actually explain why you need the window: <code>A handle to the window that receives notifications associated with an icon in the notification area.</code> Only window&#39;s can receive events, so yes, you definitely need to at least create a hidden window."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1548265124, "post_id": 54332515, "comment_id": 95483226, "body": "@ZeroZ30o the point is that the window you pass is the target of the messages. It&#39;s not uncommon in Win32 to use windows just for message passing - there&#39;s even the concept of message-only windows (with no actual associated drawing surface or anything)."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1548265426, "post_id": 54332515, "comment_id": 95483346, "body": "Indeed. You need a window in order for the system to communicate with you. Just don&#39;t show the window."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1548266154, "post_id": 54332515, "comment_id": 95483697, "body": "You can use a <a href=\"https://docs.microsoft.com/en-us/windows/desktop/winmsg/window-features#message-only-windows\" rel=\"nofollow noreferrer\">Message-Only window</a>: &quot;<i>A message-only window enables you to send and receive messages. It is not visible, has no z-order, cannot be enumerated, and does not receive broadcast messages. The window simply dispatches messages.</i>&quot;"}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1548267949, "post_id": 54332515, "comment_id": 95484555, "body": "@RemyLebeau Unfortunately, <a href=\"https://stackoverflow.com/q/21141193/7571258\">a message-only window doesn&#39;t receive <code>WM_QUERYENDSESSION</code></a> and other broadcast messages. So if you want to gracefully shutdown, instead of being terminated, a regular hidden window would be a better choice."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1548268310, "post_id": 54332515, "comment_id": 95484723, "body": "@zett42 good point"}], "answers": [{"comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 3, "creation_date": 1548280984, "post_id": 54335850, "comment_id": 95490035, "body": "<a href=\"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appshellintegration/NotificationIcon\" rel=\"nofollow noreferrer\">NotificationIcon sample at GitHub</a>"}], "tags": [], "owner": {"reputation": 1338, "user_id": 158583, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fd5f8cd7b3822a655636dd425234a260?s=128&d=identicon&r=PG", "display_name": "Olaf Hess", "link": "https://stackoverflow.com/users/158583/olaf-hess"}, "is_accepted": true, "score": 4, "last_activity_date": 1548278568, "creation_date": 1548278568, "answer_id": 54335850, "question_id": 54332515, "link": "https://stackoverflow.com/questions/54332515/c-system-tray-only-program/54335850#54335850", "title": "C++ system tray only program", "body": "<p>The <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=8279\" rel=\"nofollow noreferrer\">Windows 7 SDK</a> contains an example called <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd940367(v=vs.85).aspx\" rel=\"nofollow noreferrer\">NotificationIcon</a>. This example contains a line</p>\n\n<pre><code>ShowWindow(hwnd, nCmdShow);\n</code></pre>\n\n<p>in its <code>wWinMain</code> function. The effect of this call is that you see a program window.</p>\n\n<p>Just change this line to</p>\n\n<pre><code>ShowWindow(hwnd, SW_HIDE);\n</code></pre>\n\n<p>to hide the program window and only display the icon in the system tray. As others have pointed out the program needs a program window, even if it is not visible.</p>\n"}], "owner": {"reputation": 136, "user_id": 5965966, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6f8f66f8f1629ba4730e0d63f9a6687?s=128&d=identicon&r=PG", "display_name": "ZeroZ30o", "link": "https://stackoverflow.com/users/5965966/zeroz30o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4184, "favorite_count": 1, "accepted_answer_id": 54335850, "answer_count": 1, "score": 1, "last_activity_date": 1548278568, "creation_date": 1548264070, "last_edit_date": 1548276292, "question_id": 54332515, "link": "https://stackoverflow.com/questions/54332515/c-system-tray-only-program", "title": "C++ system tray only program", "body": "<p>After checking Microsoft's documentation on system tray icons (that I could find):</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/shellapi/nf-shellapi-shell_notifyicona\" rel=\"nofollow noreferrer\">Shell_NotifyIconA function</a></p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/shellapi/ns-shellapi-_notifyicondataa\" rel=\"nofollow noreferrer\">NOTIFYICONDATAA structure</a> </p>\n\n<p>I've noticed that a window handle (HWND) is REQUIRED. This is very bad for what I'm trying to accomplish, as I'm looking to create a program that only reacts to the system tray: it doesn't \"minimize\" the window to the tray, it just uses notifications (clicking/right clicking on the icon) to interact.</p>\n\n<p>How would I go about doing this?</p>\n"}, {"tags": ["c++", "inheritance", "overriding"], "comments": [{"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1548263623, "post_id": 54332307, "comment_id": 95482623, "body": "What are you looking for that is not in the link you provided? Your options are to use virtual and override, or don&#39;t and hide. There is no third option if that is what you are asking. Do you have something against the keyword virtual? Also, you don&#39;t need to type out &quot;this&quot;"}, {"owner": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "reply_to_user": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1548264152, "post_id": 54332307, "comment_id": 95482856, "body": "There is a third option in other languages you might not be familiar with.  It is functionally useful, but not an option with the syntax I&#39;ve been shown thus far.  In terms of using &quot;this&quot;, I just like to be specific.  I know it changes nothing, but it makes it easier to read on me.  Thank you for your input."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1548264212, "post_id": 54332307, "comment_id": 95482881, "body": "Can you explain in what way making <code>getY</code> virtual does not accomplish what you need?"}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 1, "creation_date": 1548264233, "post_id": 54332307, "comment_id": 95482887, "body": "What is this &quot;third option&quot; called in the &quot;other languages&quot; you mention? Can you link it, so I know what you are after?"}, {"owner": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "edited": false, "score": 0, "creation_date": 1548264657, "post_id": 54332307, "comment_id": 95483052, "body": "I&#39;ve added an edit section detailing my mistake above."}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1548264710, "post_id": 54332307, "comment_id": 95483069, "body": "@SephReed, If your question is answered, you have to accept the answer, not delete the question."}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 1, "creation_date": 1548264801, "post_id": 54332307, "comment_id": 95483107, "body": "<code>similar to abstract functions in other languages</code> &gt;&gt; In c++, true abstract functions are called &quot;pure virtual functions&quot;, regular virtual functions can have default implementations."}, {"owner": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "reply_to_user": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1548265324, "post_id": 54332307, "comment_id": 95483301, "body": "@balki I&#39;ll have to take some time to understand your answer.  There&#39;s a good chance it&#39;s the most correct, but it&#39;s also a bit over my head."}], "answers": [{"comments": [{"owner": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "edited": false, "score": 0, "creation_date": 1548263981, "post_id": 54332411, "comment_id": 95482795, "body": "I&#39;d like to have default behavior for this, should the child not override."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "edited": false, "score": 1, "creation_date": 1548264114, "post_id": 54332411, "comment_id": 95482844, "body": "@SephReed What do you mean by &quot;I&#39;d like to have default behavior for this&quot;?? You should say in which situation you want which of the child or parent function be called."}, {"owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "edited": false, "score": 0, "creation_date": 1548264219, "post_id": 54332411, "comment_id": 95482882, "body": "if you want say by default &quot; parent behavior &quot; then why override it at all just inherit as it is"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "edited": false, "score": 0, "creation_date": 1548264325, "post_id": 54332411, "comment_id": 95482924, "body": "@SephReed You can have default implementations of virtual functions. It seems (based on another comment of yours) that this is the core of the misunderstanding here."}, {"owner": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "edited": false, "score": 0, "creation_date": 1548264490, "post_id": 54332411, "comment_id": 95482984, "body": "It is the core misunderstanding.  My apologies, it would seem <code>virtual</code> is very different from <code>abstract</code>, though often used together."}], "tags": [], "owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "is_accepted": false, "score": 2, "last_activity_date": 1548263715, "creation_date": 1548263715, "answer_id": 54332411, "question_id": 54332307, "link": "https://stackoverflow.com/questions/54332307/how-can-i-simulate-overriding-a-parent-function-not-hiding-in-c/54332411#54332411", "title": "How can I simulate overriding a parent function (not hiding) in c++?", "body": "<p>in the parent class you should make the functions you wanna override as virtual eg:</p>\n\n<pre><code> class Parent{\n virtual float getY(float x) {\n    return sin(x);\n  }}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1548271603, "post_id": 54332476, "comment_id": 95486188, "body": "That&#39;s a very nice example of CRTP and static (i.e., compile-time) polymorphism, using the OP&#39;s example."}], "tags": [], "owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "is_accepted": true, "score": 3, "last_activity_date": 1548264345, "last_edit_date": 1548264345, "creation_date": 1548263943, "answer_id": 54332476, "question_id": 54332307, "link": "https://stackoverflow.com/questions/54332307/how-can-i-simulate-overriding-a-parent-function-not-hiding-in-c/54332476#54332476", "title": "How can I simulate overriding a parent function (not hiding) in c++?", "body": "<p>use CRTP pattern. <a href=\"https://gcc.godbolt.org/z/J_N5Y_\" rel=\"nofollow noreferrer\">https://gcc.godbolt.org/z/J_N5Y_</a></p>\n\n<pre><code>void sink(int);\ntemplate&lt;class ChildT&gt;\nstruct Parent {\n    void doStuff(){\n        sink(\n            static_cast&lt;ChildT*&gt;(this)-&gt;getY()\n            );\n    }\n    int getY() {\n        return 42;\n    }\n};\nstruct Child : Parent&lt;Child&gt; {\n    int getY() {\n        return 43;\n    }\n};\nstruct Child2 : Parent&lt;Child2&gt; {\n//Does not want to customize, default is fine.\n};\nvoid foo() {\n    Child c;\n    c.doStuff(); # passes 43\n    Child2 c2;\n    c2.doStuff(); # passes 42\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "edited": false, "score": 0, "creation_date": 1548264253, "post_id": 54332503, "comment_id": 95482895, "body": "ah.  It would appear I misunderstood <code>virtual</code>.  I&#39;ve never seen a virtual function defined, and did not realize it was possible.  I&#39;ll give it a try."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "edited": false, "score": 1, "creation_date": 1548267228, "post_id": 54332503, "comment_id": 95484195, "body": "@SephReed -- since you mentioned Java, the key here is that in Java <b>all</b> functions that aren&#39;t marked &quot;final&quot; are virtual. In C++ you have to say that you want a function to be virtual."}], "tags": [], "owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "is_accepted": false, "score": 2, "last_activity_date": 1548265617, "last_edit_date": 1548265617, "creation_date": 1548264029, "answer_id": 54332503, "question_id": 54332307, "link": "https://stackoverflow.com/questions/54332307/how-can-i-simulate-overriding-a-parent-function-not-hiding-in-c/54332503#54332503", "title": "How can I simulate overriding a parent function (not hiding) in c++?", "body": "<p>Not sure what you are looking for that has not already been provided in the link you gave, but this is how you would implement overriding in C++.</p>\n\n<pre><code>class Parent\n{\npublic:\n    virtual ~Parent() = default;\n\n    Graph createGraph(float x)\n    {\n        return Graph(getY(x));\n    }\n\n    virtual float getY(float x) const\n    {\n        return sin(x);\n    }\n};\n\nclass Child: public Parent\n{\npublic:\n    float getY(float x) const override\n    {\n        return x * x;\n    }\n};\n\nint main()\n{\n    // Play around here with creating a Parent instead of a Child\n    //    and/or taking away the virtual keyword to learn how this works\n    std::unique_ptr&lt;Parent&gt; thingy = std::make_unique&lt;Child&gt;();\n    thingy-&gt;createGraph(1.0f);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "is_accepted": false, "score": 1, "last_activity_date": 1548264961, "creation_date": 1548264961, "answer_id": 54332738, "question_id": 54332307, "link": "https://stackoverflow.com/questions/54332307/how-can-i-simulate-overriding-a-parent-function-not-hiding-in-c/54332738#54332738", "title": "How can I simulate overriding a parent function (not hiding) in c++?", "body": "<p>How work function call:</p>\n\n<pre><code>struct Parent{\n  virtual void foo(){} // Func(1)\n  void call(){\n    this-&gt;foo();         // (A) call final overrider\n    this-&gt;Parent::foo(); // (B) call Parent::foo\n    }\n  };\n\nstruct Derived:Parent{\n  void foo() override {} // Func(2)\n  };\n\nvoid test(){\n  Parent parent; //final overrider of foo is Func(1)\n  Derived derived1; //final overrider of foo is Func(2)\n  Parent&amp; derived2 = derived; //final overrider of foo is Func(2).\n\n  parent.call()//  At (A) call =&gt; Func(1)\n               //  At (B) call =&gt; Func(1)\n\n  derived1.call()  // At (A) call =&gt; Func(2)\n                   // At (B) call =&gt; Func(1)\n\n  derived2.call()  // At (A) call =&gt; Func(2)\n                   // At (B) call =&gt; Func(1)\n</code></pre>\n"}], "owner": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 54332476, "answer_count": 4, "score": 1, "last_activity_date": 1548265659, "creation_date": 1548263232, "last_edit_date": 1548265659, "question_id": 54332307, "link": "https://stackoverflow.com/questions/54332307/how-can-i-simulate-overriding-a-parent-function-not-hiding-in-c", "title": "How can I simulate overriding a parent function (not hiding) in c++?", "body": "<p>From reading this answer (<a href=\"https://stackoverflow.com/questions/9620113/is-it-possible-to-override-a-function-in-c-child-class-without-using-virtual-k\">Is it possible to override a function in C++ child class without using virtual keyword to the function in parent class which is abstract?</a>) it is apparent that one can not override a parent function from a child class.</p>\n\n<p>Nevertheless, I need something that functions like this.  Here's a non functional setup that describes what I'm trying to do.</p>\n\n<pre><code>class Parent {\npublic:\n  Graph createGraph() {\n    return new Graph([this](float x){ \n        return this-&gt;getY(x); \n    });\n  }\n\n  float getY(float x) {\n    return sin(x);\n  }\n}\n</code></pre>\n\n<p>.</p>\n\n<pre><code>class Child: public Parent {\npublic:\n  float getY(float x) {\n    return x * x;\n  }\n}\n</code></pre>\n\n<p>The important bits of my setup are that I have a parent class which has a function that consistently references a function that is often overloaded by child classes.  Coming from Java/Javascript land, my approach would be to do what you see above, but it appears I'm thinking about this incorrectly for c++.</p>\n\n<p>How can I simulate (ie get relatively similar functionality) to this form of overriding?</p>\n\n<p>I know that by not being DRY I could copy/paset <code>createGraph</code> into both, and it would work.  And if that's the way an experienced c++ dev would do it, than it's good enough for me.  But right now, I'm looking for a way to approach this problem that is as DRY as my more java-like way.</p>\n\n<p>EDIT:  it would appear the core issue here is that I misunderstood what <code>virtual</code> does, assuming it meant there could be <em>no definition</em> of the function in the parent class (similar to abstract functions in other languages).  That is not the case, virtual appears to do something else which allows for abstract classes, but does not necessitate them.</p>\n"}, {"tags": ["c++", "pointers", "new-operator", "delete-operator"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1548262953, "post_id": 54332210, "comment_id": 95482275, "body": "Yes it&#39;s safe. As long as delete[] gets the same pointer values as were returned by new[] then it&#39;s OK."}, {"owner": {"reputation": 2028, "user_id": 5572543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6f73140eedc8165647dc849dd8ae7cdb?s=128&d=identicon&r=PG", "display_name": "elzell", "link": "https://stackoverflow.com/users/5572543/elzell"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1548263066, "post_id": 54332210, "comment_id": 95482334, "body": "@john So how does the compiler keep track of how much memory can be freed for each pointer?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1548263124, "post_id": 54332210, "comment_id": 95482363, "body": "Don&#39;t use raw pointers, C-style arrays, <code>new</code> or <code>delete</code>. <code>std::vector</code> is your friend."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 3, "creation_date": 1548263138, "post_id": 54332210, "comment_id": 95482370, "body": "@elzell The <i>compiler</i> doesn&#39;t keep track.  The same way that <code>free</code> knows how much memory to free with <code>malloc</code> in C, some extra book-keeping information is stored with the allocated memory.  It&#39;s safe in that the memory will be properly freed, but I am obligated to say that you almost never should use <code>new[]</code> and <code>delete[]</code> and should just use a <code>std::vector</code> instead."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1548263146, "post_id": 54332210, "comment_id": 95482378, "body": "@elzell Often by allocating a few extra bytes and storing the length at the beginning of the allocated block. The returned pointer points to the byte immediately after where the length is stored. But of course this is implementation dependent"}, {"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 1, "creation_date": 1548263363, "post_id": 54332210, "comment_id": 95482484, "body": "It isn&#39;t the variable (a, b) that matters, it&#39;s what they point to (arrays of 5 and 10 integers). As long as you delete all of your dynamically allocated memory once and once only you should be OK. std::vector (or std::unique_ptr) can make this a lot simpler."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1548263069, "creation_date": 1548263069, "answer_id": 54332265, "question_id": 54332210, "link": "https://stackoverflow.com/questions/54332210/is-it-safe-to-delete-an-array-pointer-in-c-after-reassignment/54332265#54332265", "title": "Is it safe to delete an array pointer in C++ after reassignment?", "body": "<blockquote>\n  <p>Is it safe to delete [] them after swapping?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>What if they have the same length?</p>\n</blockquote>\n\n<p>The length is irrelevant.</p>\n"}, {"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1548263370, "post_id": 54332309, "comment_id": 95482487, "body": "<i>And this is the correct way of doing it. Great Job</i> <code>std::unique_ptr&lt;T[]&gt;</code> or <code>std::vector&lt;T&gt;</code> would be the correct way.  <code>new</code> and <code>delete</code> should not use used unless you absolutely have to (your writing you own library implementation)"}, {"owner": {"reputation": 322, "user_id": 8407242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hk1Nm.jpg?s=128&g=1", "display_name": "Ritviz Sharma", "link": "https://stackoverflow.com/users/8407242/ritviz-sharma"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548263837, "post_id": 54332309, "comment_id": 95482726, "body": "@NathanOliver definitely that is a more appropriate way of doing it. Though for small code like swapping delete will do the job."}, {"owner": {"reputation": 38726, "user_id": 301883, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/937b36681a56def2b41c438a00e12b46?s=128&d=identicon&r=PG", "display_name": "Edward Strange", "link": "https://stackoverflow.com/users/301883/edward-strange"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548271922, "post_id": 54332309, "comment_id": 95486314, "body": "@NathanOliver Both are correct.  Yours is preferred."}], "tags": [], "owner": {"reputation": 322, "user_id": 8407242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hk1Nm.jpg?s=128&g=1", "display_name": "Ritviz Sharma", "link": "https://stackoverflow.com/users/8407242/ritviz-sharma"}, "is_accepted": false, "score": 1, "last_activity_date": 1548263236, "creation_date": 1548263236, "answer_id": 54332309, "question_id": 54332210, "link": "https://stackoverflow.com/questions/54332210/is-it-safe-to-delete-an-array-pointer-in-c-after-reassignment/54332309#54332309", "title": "Is it safe to delete an array pointer in C++ after reassignment?", "body": "<p>Yes, you can surely delete the pointer once your swapping is done. As you no longer need to point your array so in that case, it is safe to delete after swapping.</p>\n\n<pre><code>int *a;\nint *b;\nint *tmp;\n\na = new int[5];\nb = new int[10];\ntmp = a;\na = b;\nb = tmp;\n\ndelete [] a;\ndelete [] b;\n</code></pre>\n\n<p>And this is the correct way of doing it. Great Job</p>\n"}, {"tags": [], "owner": {"reputation": 38726, "user_id": 301883, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/937b36681a56def2b41c438a00e12b46?s=128&d=identicon&r=PG", "display_name": "Edward Strange", "link": "https://stackoverflow.com/users/301883/edward-strange"}, "is_accepted": true, "score": 3, "last_activity_date": 1548263430, "creation_date": 1548263430, "answer_id": 54332345, "question_id": 54332210, "link": "https://stackoverflow.com/questions/54332210/is-it-safe-to-delete-an-array-pointer-in-c-after-reassignment/54332345#54332345", "title": "Is it safe to delete an array pointer in C++ after reassignment?", "body": "<p>Yeah, you can.  The reason being is that the information needed to accurately free up that memory is managed by the free store (the heap in most cases).  So it knows how to delete based on address rather than variable.  Often times this information is held in <code>*(ptr - x)</code> where x is the size of the tracking data.</p>\n"}], "owner": {"reputation": 2028, "user_id": 5572543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6f73140eedc8165647dc849dd8ae7cdb?s=128&d=identicon&r=PG", "display_name": "elzell", "link": "https://stackoverflow.com/users/5572543/elzell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 54332345, "answer_count": 3, "score": 0, "last_activity_date": 1548263430, "creation_date": 1548262846, "question_id": 54332210, "link": "https://stackoverflow.com/questions/54332210/is-it-safe-to-delete-an-array-pointer-in-c-after-reassignment", "title": "Is it safe to delete an array pointer in C++ after reassignment?", "body": "<p>Suppose I'd like to swap two array pointers in C++ which I have allocated with <code>new []</code> and different length. Is it safe to <code>delete []</code> them after swapping? What if they have the same length?</p>\n\n<pre><code>int *a;\nint *b;\nint *tmp;\n\na = new int[5];\nb = new int[10];\ntmp = a;\na = b;\nb = tmp;\n\ndelete [] a;\ndelete [] b;\n</code></pre>\n"}, {"tags": ["c++", "cmake", "cpack"], "answers": [{"tags": [], "owner": {"reputation": 363, "user_id": 2437429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6becfbef6f040c820794aab6d998078?s=128&d=identicon&r=PG", "display_name": "xoorath", "link": "https://stackoverflow.com/users/2437429/xoorath"}, "is_accepted": true, "score": 2, "last_activity_date": 1548271740, "creation_date": 1548271740, "answer_id": 54334377, "question_id": 54332099, "link": "https://stackoverflow.com/questions/54332099/cpack-create-zip-without-creating-self-named-directory-inside-zip/54334377#54334377", "title": "cpack create zip without creating self named directory inside zip", "body": "<p>The option I was looking for is called <a href=\"https://cmake.org/cmake/help/latest/variable/CPACK_INCLUDE_TOPLEVEL_DIRECTORY.html?highlight=zip\" rel=\"nofollow noreferrer\">CPACK_INCLUDE_TOPLEVEL_DIRECTORY</a></p>\n\n<p>I added this line to my CMakeLists.txt before <code>include(CPack)</code>:</p>\n\n<pre><code>set(CPACK_INCLUDE_TOPLEVEL_DIRECTORY OFF)\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 2437429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6becfbef6f040c820794aab6d998078?s=128&d=identicon&r=PG", "display_name": "xoorath", "link": "https://stackoverflow.com/users/2437429/xoorath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 929, "favorite_count": 1, "accepted_answer_id": 54334377, "answer_count": 1, "score": 3, "last_activity_date": 1548271740, "creation_date": 1548262443, "question_id": 54332099, "link": "https://stackoverflow.com/questions/54332099/cpack-create-zip-without-creating-self-named-directory-inside-zip", "title": "cpack create zip without creating self named directory inside zip", "body": "<p>I'm creating a zip with my target binary and header files that go with it. I'm trying to find a way to get this to work without creating a self-named folder inside the zip, and have the zip simply contain the target binary and header files at its root.</p>\n\n<p>Here's the entire project in a small zip (5k) on dropbox: <a href=\"https://www.dropbox.com/s/i7ufecvx57lr2hk/sis_cg_lib.zip?dl=0\" rel=\"nofollow noreferrer\">link</a></p>\n\n<p>Here's how I build and package:</p>\n\n<pre><code>cd Build\ncmake ..\nmake\nmake package\n</code></pre>\n\n<h1>Version details:</h1>\n\n<blockquote>\n  <p>> cmake --version</p>\n  \n  <p>cmake version 3.10.2</p>\n  \n  <p>CMake suite maintained and supported by Kitware (kitware.com/cmake).</p>\n  \n  <p>> cpack --version</p>\n  \n  <p>cpack version 3.10.2</p>\n  \n  <p>CMake suite maintained and supported by Kitware (kitware.com/cmake).</p>\n  \n  <p>> gcc --version</p>\n  \n  <p>gcc (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0\n  Copyright (C) 2017 Free Software Foundation, Inc.\n  This is free software; see the source for copying conditions.  There is > NO\n  warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>\n</blockquote>\n\n<h1>CMakeLists.txt</h1>\n\n<pre><code>cmake_minimum_required(VERSION 3.2)\n###################################################################### PROJECT\nproject(sis_cg_lib)\n###################################################################### FILES\n\nfile(GLOB_RECURSE SIS_CG_LIB_INC \"deps/*.h\" \"deps/*.inl\" )\nfile(GLOB_RECURSE SIS_CG_LIB_SRC \"sources/*.cpp\" )\n\n###################################################################### TARGET\n\nadd_library(SIS_CG_Lib ${SIS_CG_LIB_INC} ${SIS_CG_LIB_SRC})\n\n###################################################################### SETTINGS\n\ntarget_include_directories(SIS_CG_Lib PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/deps)\n\n###################################################################### PACKAGE\n\ninstall(DIRECTORY deps/\n    DESTINATION deps\n)\n\ninstall(TARGETS SIS_CG_Lib\n    ARCHIVE DESTINATION .\n)\n\nset(CPACK_OUTPUT_FILE_PREFIX \"\")\nset(CPACK_GENERATOR \"ZIP\" CACHE STRING \"Generators to support. semi-colon delimited list\")\ninclude(CPack)\n</code></pre>\n\n<h1>Desired contents of the zip:</h1>\n\n<pre><code>libSIS_CG_Lib.a\ndeps/vec3.h\n</code></pre>\n\n<h1>Actual contents of the zip:</h1>\n\n<pre><code>sis_gc_lib-0.1.1-Linux/libSIS_CG_Lib.a\nsis_gc_lib-0.1.1-Linux/deps/vec3.h\n</code></pre>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1548262270, "post_id": 54332020, "comment_id": 95481928, "body": "You could make <code>B</code> inherit from a special non-template tag type that only <code>B</code> inherits from. Then you can check if your type inherits from that type instead."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1548263106, "post_id": 54332020, "comment_id": 95482357, "body": "@Fran&#231;oisAndrieux You should make that an answer.  That gives the OP a solution that works at compile time and run time."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548263737, "post_id": 54332020, "comment_id": 95482687, "body": "The necessity of needing to cast to sub class is a hint that your design possibly is flawed - and we are possibly discussing an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY-Problem</a>. Maybe you want to share a bit more of information what you <i>actually</i> intend to achieve? There might be a better solution at a higher level..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1548264559, "post_id": 54332020, "comment_id": 95483013, "body": "I do not agree on duplicate: Base class in question is not a template, linked question is a compile-time only solution (but we rely on run-time here, as unable to know at compile time of which types the elements in the deque actually are) and we are searching in opposite direction: not interested in base class(es), but if given object is an instance of one of a set of derived types (all possible template instantiations). Citing @NathanOliver&#39;s comment to (now deleted) answer: <i>&#39;How would you use this to check if the A* in the vector is a B?&#39;</i>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548267547, "post_id": 54332020, "comment_id": 95484367, "body": "Someone please notify me if this question reopens and I will make an answer based on my comment. I don&#39;t feel comfortable reopening myself with the intention of answering as it seems like a conflict of interest (I might be biased towards disagreeing with the duplicate). I&#39;d first like someone else to pass judgement on this duplicate close."}, {"owner": {"reputation": 33, "user_id": 3237481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849887c77dffcf7a367630a5bc2272ed?s=128&d=identicon&r=PG&f=1", "display_name": "almasif", "link": "https://stackoverflow.com/users/3237481/almasif"}, "edited": false, "score": 1, "creation_date": 1548435469, "post_id": 54332020, "comment_id": 95553506, "body": "I could&#39;t solve it yet, so I&#39;ve upgraded my example. I would be grateful if somebody can help me."}], "owner": {"reputation": 33, "user_id": 3237481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849887c77dffcf7a367630a5bc2272ed?s=128&d=identicon&r=PG&f=1", "display_name": "almasif", "link": "https://stackoverflow.com/users/3237481/almasif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "closed_date": 1548263181, "answer_count": 0, "score": 1, "last_activity_date": 1548435263, "creation_date": 1548262160, "last_edit_date": 1548435263, "question_id": 54332020, "link": "https://stackoverflow.com/questions/54332020/check-that-is-my-class-is-instance-of-a-template-class-ignoring-type", "closed_reason": "Duplicate", "title": "Check that is my class is instance of a template class ignoring type", "body": "<p>I have two base abstract classes <strong>A</strong>, and <strong>B</strong> what is inherited from <strong>A</strong>. <strong>B</strong> contains a map argument with generic type, and I would like to create children from <strong>A</strong> and <strong>B</strong> and store that in a deque:</p>\n\n<pre><code>class A {\n};\n\ntemplate &lt;typename T&gt;\nclass B : public A {\n    std::map&lt;const char *, T&gt; data;\n    virtual void doEvent(const char *) = 0;\n};\n\nclass C : public A {\n};\n\nclass D : public B&lt;char&gt; {\n    void doEvent(const char *event) {\n        // use map&lt;const char*, char&gt;\n    }\n};\n\nclass E : public B&lt;int&gt; {\n    void doEvent(const char *event) {\n        // use map&lt;const char*, int&gt;\n    }\n};\n\nstd::deque&lt;A *&gt; as;\n\nvoid main() {\n    for (auto &amp;it : as) {\n        //if (it instanceof B) {\n            // cast it to B\n            // call B.doEvent(\"myEvent\")\n        //}\n    }\n}\n</code></pre>\n\n<p>Could somebody help me how to check that a child is inherited from <strong>B</strong> , ignoring T type. How could I use std::is_base_of or dynamic_cast with generic type.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["python", "c++", "c"], "answers": [{"tags": [], "owner": {"reputation": 2343, "user_id": 9448377, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Wim Lavrijsen", "link": "https://stackoverflow.com/users/9448377/wim-lavrijsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1548301947, "last_edit_date": 1548301947, "creation_date": 1548280792, "answer_id": 54336340, "question_id": 54331986, "link": "https://stackoverflow.com/questions/54331986/resolve-a-c-c-call-method-from-python-by-using-cppyy/54336340#54336340", "title": "Resolve a C (C++) call method from Python by using cppyy", "body": "<p>cppyy assumes C++, i.e. name mangling will be applied. To make sure the declarations in your project's header files can be used both from C and C++, add extern \"C\" when used from C++. Like so:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nvoid pocket(void);\nint pocket_add(int op1, int op2);\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>This will also be generally helpful for anyone using your code from C++, so it's not just for Python/cppyy.</p>\n\n<p>Edit: forgot to add that you can also use \"cppyy.c_include\" instead of \"cppyy.include\" for C headers.</p>\n"}], "owner": {"reputation": 94, "user_id": 5569333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8IPM6.jpg?s=128&g=1", "display_name": "Gromph", "link": "https://stackoverflow.com/users/5569333/gromph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 54336340, "answer_count": 1, "score": 1, "last_activity_date": 1548301947, "creation_date": 1548262047, "last_edit_date": 1548272132, "question_id": 54331986, "link": "https://stackoverflow.com/questions/54331986/resolve-a-c-c-call-method-from-python-by-using-cppyy", "title": "Resolve a C (C++) call method from Python by using cppyy", "body": "<p>In a C project, I would like to do the tests with the Python tools, so I integrated the Cling and Cppyy python package tool.</p>\n\n<p>After that, I created a simple project like <a href=\"http://www.benjack.io/2018/02/02/python-cpp-revisited.html\" rel=\"nofollow noreferrer\">this</a>. And found <a href=\"https://stackoverflow.com/questions/145270/calling-c-c-from-python\">this help</a>.</p>\n\n<p>I have one source and one header.</p>\n\n<h1>header/pocket.h</h1>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid pocket(void);\nint pocket_add(int op1, int op2);\n</code></pre>\n\n<h1>source/pocket.c</h1>\n\n<pre><code>#include &lt;pocket.h&gt;\nvoid pocket(void)\n{\n  printf(\"Hello, pocket!\\n\");\n}\n\nint pocket_add(int op1, int op2)\n{\n  return op1 + op2;\n}\n</code></pre>\n\n<p><strong>I have this error on python interpreter</strong></p>\n\n<blockquote>\n  <p>IncrementalExecutor::executeFunction: symbol '_Z6pocketv' unresolved while linking symbol '__cf_6'!\n  You are probably missing the definition of pocket()\n  Maybe you need to load the corresponding shared library?\n  Error in : Failed to compile</p>\n</blockquote>\n\n<p><strong>Check the result via Python interpreter:</strong></p>\n\n<pre><code>import cppyy\ncppyy.include('include/pocket.h')\ncppyy.load_library('build/libpocket.so')\ncppyy.gbl.pocket()\n</code></pre>\n\n<blockquote>\n  <p>IncrementalExecutor::executeFunction: symbol '_Z6pocketv' unresolved while linking symbol '__cf_6'!\n  You are probably missing the definition of pocket()\n  Maybe you need to load the corresponding shared library?\n  Error in : Failed to compile</p>\n</blockquote>\n\n<h1>Source</h1>\n\n<pre><code>#pragma clang diagnostic push\n#pragma clang diagnostic ignored \"-Wformat-security\"\n__attribute__((used)) extern \"C\" void __cf_6(void* obj, int nargs, void** args, void* ret)\n{\n    ((void (&amp;)())pocket)();\n    return;\n}\n#pragma clang diagnostic pop\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "opengl", "sfml", "access-violation"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1548262602, "post_id": 54331920, "comment_id": 95482081, "body": "You could make things easier by breaking up that last line to see exactly which one of those calls is causing the exception."}, {"owner": {"reputation": 23, "user_id": 10913569, "user_type": "registered", "profile_image": "https://graph.facebook.com/1459822137485857/picture?type=large", "display_name": "Yee7i", "link": "https://stackoverflow.com/users/10913569/yee7i"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1548262913, "post_id": 54331920, "comment_id": 95482247, "body": "@PaulMcKenzie it&#39;s the .saveToFile function as far as I can see, it runs just fine without .saveToFile"}, {"owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "edited": false, "score": 1, "creation_date": 1548263570, "post_id": 54331920, "comment_id": 95482598, "body": "Did you open VS with Administrator rights? Had you try to save it in another folder, less restrictive than <code>C:</code>? Maybe <code>My Documents</code> or similar could work."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1548264155, "post_id": 54331920, "comment_id": 95482859, "body": "I haven&#39;t used this API, but a function that crashes due to a file not being able to be saved is rather poor.  You would think an error code would be returned on failure (or a C++ exception thrown (not an access violation))."}, {"owner": {"reputation": 23, "user_id": 10913569, "user_type": "registered", "profile_image": "https://graph.facebook.com/1459822137485857/picture?type=large", "display_name": "Yee7i", "link": "https://stackoverflow.com/users/10913569/yee7i"}, "reply_to_user": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "edited": false, "score": 1, "creation_date": 1548264703, "post_id": 54331920, "comment_id": 95483067, "body": "@alseether opening as administrator didn&#39;t work, changing location to &quot;D:\\output\\test.bmp&quot; neither"}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 1, "creation_date": 1548267182, "post_id": 54331920, "comment_id": 95484167, "body": "The <a href=\"https://www.sfml-dev.org/documentation/2.5.1/classsf_1_1Image.php#a51537fb667f47cbe80395cfd7f9e72a4\" rel=\"nofollow noreferrer\">docs</a> note that &quot;<i>This function fails if the image is empty.</i>&quot;.  I would think that means that the function returns false, but maybe it means that it invokes undefined behavior?  Try moving the <code>texture.clear</code> line before <code>texture.display</code>."}, {"owner": {"reputation": 23, "user_id": 10913569, "user_type": "registered", "profile_image": "https://graph.facebook.com/1459822137485857/picture?type=large", "display_name": "Yee7i", "link": "https://stackoverflow.com/users/10913569/yee7i"}, "reply_to_user": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1548269667, "post_id": 54331920, "comment_id": 95485347, "body": "@0x5453 I&#39;ve tried both configurations, none worked, I also manually created the file under the path, didn&#39;t work as well"}, {"owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "edited": false, "score": 0, "creation_date": 1548314333, "post_id": 54331920, "comment_id": 95498393, "body": "How did you install <code>SFML</code> libraries? Manually or via NuGet Packages? If manually, as static or as dynamic lib? Did you configure both, debug and release configurations? Would be nice an edit in your question adding all this info ;)"}, {"owner": {"reputation": 23, "user_id": 10913569, "user_type": "registered", "profile_image": "https://graph.facebook.com/1459822137485857/picture?type=large", "display_name": "Yee7i", "link": "https://stackoverflow.com/users/10913569/yee7i"}, "reply_to_user": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "edited": false, "score": 0, "creation_date": 1548410884, "post_id": 54331920, "comment_id": 95540115, "body": "@alseether I tried to add those informations to the post, but I don&#39;t really have an idea if including libraries and headers each time I&#39;m making a new project is static or dynamic, as I&#39;m fairly new to VS. Let&#39;s put it that way: I&#39;ve got VS 2017 installed under C:/Program Files (x86)/Visual Studio and libraries and headers under Documents/OpenGL/lib and Documents/OpenGL/include. Each time I&#39;m making a new project I add their paths in project options in VC++ Directories and link the libraries in linkers"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10913569, "user_type": "registered", "profile_image": "https://graph.facebook.com/1459822137485857/picture?type=large", "display_name": "Yee7i", "link": "https://stackoverflow.com/users/10913569/yee7i"}, "edited": false, "score": 0, "creation_date": 1548506531, "post_id": 54364781, "comment_id": 95570417, "body": "So what I did was install the packages via NuGet, but it didn&#39;t help much, although I suspect you have to do more things than just press &quot;install&quot;. I&#39;m a beginner in Visual Studio, I have <code>opengl32.lib, sfml-graphics.lib, sfml-window.lib, sfml-system.lib</code> under both release and debug configuration, since I didn&#39;t have any d-ending libraries I could find"}, {"owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "reply_to_user": {"reputation": 23, "user_id": 10913569, "user_type": "registered", "profile_image": "https://graph.facebook.com/1459822137485857/picture?type=large", "display_name": "Yee7i", "link": "https://stackoverflow.com/users/10913569/yee7i"}, "edited": false, "score": 0, "creation_date": 1548682329, "post_id": 54364781, "comment_id": 95616623, "body": "Actually, it&#39;s just that simple. Installing <code>SFML</code> via NuGet should create a folder called <code>packages</code>, at the level where your solution file is. Inside that folder are all the packages with both versions, Debug and Release. You don&#39;t have to worry about linking stuff. Just make sure that you&#39;re installing all packages you need, usually <code>window</code>, <code>graphics</code> and <code>system</code> are needed for drawing. Install <code>audio</code> or <code>network</code> if you want to do music/sounds stuff or network communication respectively."}, {"owner": {"reputation": 23, "user_id": 10913569, "user_type": "registered", "profile_image": "https://graph.facebook.com/1459822137485857/picture?type=large", "display_name": "Yee7i", "link": "https://stackoverflow.com/users/10913569/yee7i"}, "edited": false, "score": 1, "creation_date": 1548716714, "post_id": 54364781, "comment_id": 95634037, "body": "I did some tinkering on my PC (I worked on my laptop before) and I got it to work. I&#39;ll edit my post with an update"}], "tags": [], "owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "is_accepted": false, "score": 1, "last_activity_date": 1548417000, "creation_date": 1548417000, "answer_id": 54364781, "question_id": 54331920, "link": "https://stackoverflow.com/questions/54331920/sfml-access-violation-reading-location-when-saving-rendertexture-to-image-0xc0/54364781#54364781", "title": "SFML - Access violation reading location when saving RenderTexture to image 0xC0000005", "body": "<p>My best guess is that you're linking the libraries somehow wrong. \nEnsure you have debug libraries in debug configuration and release ones in release configuration.</p>\n\n<p>Remember, debug libraries usually end with a \"d\". If you don't set debug libraries correctly, you cannot debug your code and that would explain why you're getting a <em>poor</em> error message.</p>\n\n<p>I leave <a href=\"https://en.sfml-dev.org/forums/index.php?topic=11429.0\" rel=\"nofollow noreferrer\">here</a> a link to SFML forum with someone with a similar issue.</p>\n\n<p>Hope that helps.</p>\n\n<hr>\n\n<p>As side note, for beginners with <a href=\"/questions/tagged/sfml\" class=\"post-tag\" title=\"show questions tagged &#39;sfml&#39;\" rel=\"tag\">sfml</a> I highly recommend install the library using NuGet packages (right click on your solution -> Manage NuGet packages -> look for SFML -> install)</p>\n\n<p>This works for SFML, not sure for OpenGL.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 10913569, "user_type": "registered", "profile_image": "https://graph.facebook.com/1459822137485857/picture?type=large", "display_name": "Yee7i", "link": "https://stackoverflow.com/users/10913569/yee7i"}, "is_accepted": true, "score": 0, "last_activity_date": 1550522459, "creation_date": 1550522459, "answer_id": 54755047, "question_id": 54331920, "link": "https://stackoverflow.com/questions/54331920/sfml-access-violation-reading-location-when-saving-rendertexture-to-image-0xc0/54755047#54755047", "title": "SFML - Access violation reading location when saving RenderTexture to image 0xC0000005", "body": "<p>I found an answer, the issue was that I wasn't using .dlls compiled for VS 2017, I was using those compiled for 2015 instead, switched them and it works like a charm</p>\n"}], "owner": {"reputation": 23, "user_id": 10913569, "user_type": "registered", "profile_image": "https://graph.facebook.com/1459822137485857/picture?type=large", "display_name": "Yee7i", "link": "https://stackoverflow.com/users/10913569/yee7i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 1, "accepted_answer_id": 54755047, "answer_count": 2, "score": 1, "last_activity_date": 1550522459, "creation_date": 1548261825, "last_edit_date": 1548748119, "question_id": 54331920, "link": "https://stackoverflow.com/questions/54331920/sfml-access-violation-reading-location-when-saving-rendertexture-to-image-0xc0", "title": "SFML - Access violation reading location when saving RenderTexture to image 0xC0000005", "body": "<p>I'm using Visual Studio 2017.\nWhen debugging it points me to line 11 </p>\n\n<pre><code>texture.getTexture().copyToImage().saveToFile(\"C:/test.bmp\");\n</code></pre>\n\n<p>with an error </p>\n\n<blockquote>\n  <p>Exception thrown at 0x54B06B9E (sfml-graphics-2.dll) in Project2.exe:\n  0xC0000005: Access violation reading location 0xCCE6C37F.</p>\n</blockquote>\n\n<p>I want to save the texture to a .bmp file.</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;SFML/Graphics.hpp&gt;\n\nint main()\n{\n    using namespace sf;\n    RenderTexture texture;\n    texture.create(800, 600);\n    texture.display();\n    texture.clear(Color::Black);\n    texture.getTexture().copyToImage().saveToFile(\"C:/test.bmp\");\n\n    return 0;\n}\n</code></pre>\n\n<h3>EDIT</h3>\n\n<p>As far as we've detected it's the <code>.saveToFile(\"C:/test.bmp\")</code> fragment that's causing the issue, the code works fine without it</p>\n\n<h3>SECOND EDIT</h3>\n\n<p>I got SFML packages manually, I include them from a set folder each time I'm making a new project and link the libraries, also added manually through external lib folder</p>\n\n<h3>THIRD EDIT</h3>\n\n<p>After some work I managed to fix the debug libraries and release libraries, now the code throws an exception</p>\n\n<blockquote>\n  <p>Run-Time Check Failure #2 - Stack around the variable 'texture' was corrupted.</p>\n</blockquote>\n\n<p>A screenshot with the whole output and code:\n<a href=\"https://i.stack.imgur.com/pajvQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pajvQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Another thing is, when I continue without handling the exception it throws at me this:</p>\n\n<blockquote>\n  <p>Unhandled exception at 0x00D26859 in Project2.exe: Stack cookie instrumentation code detected a stack-based buffer overrun.</p>\n</blockquote>\n"}, {"tags": ["c++", "mingw", "mingw-w64"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1548261965, "post_id": 54331717, "comment_id": 95481763, "body": "Which language, C or C++?  They are distinct languages.  For example, the C++ allows overloading of functions and some compilers use <i>name mangling</i> to manage the overloading.  This may interfere with libraries built by compilers that use different schemes of name mangling."}, {"owner": {"reputation": 507, "user_id": 4347276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/1ae069dad45aed6714d8f383f068c42f?s=128&d=identicon&r=PG&f=1", "display_name": "Egor", "link": "https://stackoverflow.com/users/4347276/egor"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1548262077, "post_id": 54331717, "comment_id": 95481825, "body": "The language is c++. In either case I don&#39;t understand why definition of a hidden function could end up in the import library."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1548262131, "post_id": 54331717, "comment_id": 95481851, "body": "You should update your tags."}, {"owner": {"reputation": 507, "user_id": 4347276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/1ae069dad45aed6714d8f383f068c42f?s=128&d=identicon&r=PG&f=1", "display_name": "Egor", "link": "https://stackoverflow.com/users/4347276/egor"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1548262430, "post_id": 54331717, "comment_id": 95481994, "body": "@ThomasMatthews Removed c tag"}], "owner": {"reputation": 507, "user_id": 4347276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/1ae069dad45aed6714d8f383f068c42f?s=128&d=identicon&r=PG&f=1", "display_name": "Egor", "link": "https://stackoverflow.com/users/4347276/egor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548262178, "creation_date": 1548261100, "last_edit_date": 1548262178, "question_id": 54331717, "link": "https://stackoverflow.com/questions/54331717/duplicate-symbol-defined-in-a-dll-import-library-in-mingw-build", "title": "Duplicate symbol defined in a dll import library in MinGW build", "body": "<p>I have static library <code>libA-static</code> that defines function <code>privateFunction</code> and is linked into library <code>libB-static</code>. <code>libB-static</code> implements a lot of stuff but exports only one function <code>publicFunction</code>. <code>libB-static</code> is then linked into shared library  <code>libC-shared</code> that re-exports <code>publicFunction</code>. As suggested <a href=\"https://stackoverflow.com/questions/2222162/how-to-apply-fvisibility-option-to-symbols-in-static-libraries\">here</a> and <a href=\"https://stackoverflow.com/questions/2649735/how-to-link-static-library-into-dynamic-library-in-gcc\">here</a>, I compile all libraries with <code>-fvisibility=hidden</code>, label public with default visibility and link <code>libB-static</code> to <code>libC-shared</code> as whole archive.</p>\n\n<p>My main program depends on <code>libC-shared</code> and <code>libA-static</code>. The setup works fine on Linux, Mac (and on Windows too), but on MinGW linking fails with multiple definitions of symbol <code>privateFunction</code>. The second definition comes from the import library <code>libC-shared.dll.a</code>. The size of import library is ridiculous for a single exported symbol (10MB) and it looks like it contains at least entire <code>libB-static</code>.</p>\n\n<p>I tried linking <code>libC-shared</code> with <code>-Wl,--exclude-libs,All</code>, and the size of import library in this case is 1 KB, but <code>publicFunction</code> is then unresolved. I also tried linking <code>libC-shared</code> with <code>-Wl,--exclude-libs,libB-static</code>, but in this case linking of <code>libC-shared</code> fails to resolve <code>privateFunction</code>.</p>\n\n<p>This is the linking command generated by CMake, where <code>libC-shared=GraphicsEngineOpenGL-shared</code>, <code>libB-static=GraphicsEngineOpenGL-static</code> and <code>libA</code> is all other static libs:</p>\n\n<pre><code>C:\\PROGRA~1\\MINGW-~1\\X86_64~1.0-P\\mingw64\\bin\\G__~1.EXE    -shared -o GraphicsEngineOpenGL-shared.dll -Wl,--out-implib,libGraphicsEngineOpenGL-shared.dll.a -Wl,--major-image-version,0,--minor-image-version,0 -Wl,--whole-archive CMakeFiles\\GraphicsEngineOpenGL-shared.dir/objects.a -Wl,--no-whole-archive -Wl,--whole-archive libGraphicsEngineOpenGL-static.a -Wl,--no-whole-archive ../GLSLTools/libGLSLTools.a ../HLSL2GLSLConverterLib/libHLSL2GLSLConverterLib.a ../GraphicsEngine/libGraphicsEngine.a ../GraphicsAccessories/libGraphicsAccessories.a ../../Common/libCommon.a ../../Platforms/Win32/libWin32Platform.a ../../Platforms/Basic/libBasicPlatform.a -lShlwapi ../../Primitives/libPrimitives.a ../../External/glew/libglew-static.a -lopengl32 -lkernel32 -luser32 -lgdi32 -lwinspool -lshell32 -lole32 -loleaut32 -luuid -lcomdlg32 -ladvapi32 \n</code></pre>\n\n<p>My main problem is obviously linking error, but ridiculous size of the import library is probably the key to the answer.</p>\n"}, {"tags": ["c++", "g++", "clang"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548261339, "post_id": 54331715, "comment_id": 95481419, "body": "This is quite a bit of code to look through and may turn away a lot of users who could otherwise answer your question. Is a custom allocator really required to reproduce the problem?"}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 1, "creation_date": 1548261666, "post_id": 54331715, "comment_id": 95481598, "body": "Do you really need a custom allocator? Why not adjust the children&#39;s parent in the constructor? Could be just a simple private member function that goes through <code>children</code> and updates pointer. Significantly less code =&gt; less errors."}, {"owner": {"reputation": 95, "user_id": 8434292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6f8a0b628d7c051e105d9f49c9d5f43?s=128&d=identicon&r=PG&f=1", "display_name": "extiam", "link": "https://stackoverflow.com/users/8434292/extiam"}, "edited": false, "score": 0, "creation_date": 1548262568, "post_id": 54331715, "comment_id": 95482062, "body": "It&#39;s true that a custom allocator could be avoidable - I was originally thinking that the children (which in my actual use are a lot more complicated) could depend on the node from which they&#39;re constructed and therefore would need that information in their constructor. This could theoretically be replaced by a <code>setParent</code> function or something like that."}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 1, "creation_date": 1548262587, "post_id": 54331715, "comment_id": 95482071, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 95, "user_id": 8434292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6f8a0b628d7c051e105d9f49c9d5f43?s=128&d=identicon&r=PG&f=1", "display_name": "extiam", "link": "https://stackoverflow.com/users/8434292/extiam"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1548262800, "post_id": 54331715, "comment_id": 95482178, "body": "@Holt - hmm it won&#39;t compile on my machine which reports a clang version of <code>Apple LLVM version 10.0.0 (clang-1000.10.44.4)</code>"}, {"owner": {"reputation": 95, "user_id": 8434292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6f8a0b628d7c051e105d9f49c9d5f43?s=128&d=identicon&r=PG&f=1", "display_name": "extiam", "link": "https://stackoverflow.com/users/8434292/extiam"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548263053, "post_id": 54331715, "comment_id": 95482330, "body": "@Fran&#231;oisAndrieux - I&#39;m not sure that I can easily dodge the custom allocator. I think the compiler error hinges on there being a difference between something being MoveInsertable and MoveConstructible."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1548263080, "post_id": 54331715, "comment_id": 95482342, "body": "@extiam Sorry, I wasn&#39;t compiling with libc++. The requirements for this constructor are that <code>Node</code> is <code>Cpp17MoveInsertable</code>."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 1, "creation_date": 1548263602, "post_id": 54331715, "comment_id": 95482612, "body": "@extiam According to the standard (C++17), your code is valid because <code>Node</code> is <code>Cpp17MoveInsertable</code> in a vector with your allocator. This is different from being <code>MoveConstructible</code>, which is what clang is testing apparently. IMO, you should not use this custom allocator but rather a factory, or something similar, which have the same benefits (i.e., preventing inconsistency between parents and children), while being simpler to implement."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1548264293, "post_id": 54331715, "comment_id": 95482911, "body": "If we trust cppreference, then a requirement for an allocator is that <code>construct(xptr, args)</code>, if present, &quot;constructs an object of type <code>X</code> in previously-allocated storage at the address pointed to by <code>xptr</code>, <i>using <code>args</code> as the constructor arguments</i>&quot;. Your <code>construct</code> doesn&#39;t do that. For what I can find, the standard itself doesn&#39;t say &quot;using <code>args</code> as the constructor arguments&quot; though."}, {"owner": {"reputation": 95, "user_id": 8434292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6f8a0b628d7c051e105d9f49c9d5f43?s=128&d=identicon&r=PG&f=1", "display_name": "extiam", "link": "https://stackoverflow.com/users/8434292/extiam"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1548264674, "post_id": 54331715, "comment_id": 95483056, "body": "@Holt could you repeat this as an answer so I can accept it? Could you also elaborate on the factory part as I&#39;m not quite sure how it would work - the allocator wasn&#39;t trying to solve creating the children, but rather handling what happened when they were moved."}, {"owner": {"reputation": 95, "user_id": 8434292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6f8a0b628d7c051e105d9f49c9d5f43?s=128&d=identicon&r=PG&f=1", "display_name": "extiam", "link": "https://stackoverflow.com/users/8434292/extiam"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1548264733, "post_id": 54331715, "comment_id": 95483076, "body": "@n.m. - and this answers the last question - &quot;is [this] an unforgivable abuse of the standard?&quot;: Yes!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1548265643, "post_id": 54331715, "comment_id": 95483452, "body": "I&#39;m not so sure to be honest. libc++ checks for <code>is_constructible</code> in its <code>assign</code>, but this requirement doesn&#39;t seem to be present in the standard. I would tentatively call this a bug in libc++."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1548265769, "post_id": 54331715, "comment_id": 95483514, "body": "@extiam You should provide a bit more context on how you want to use / move / copy these nodes for us to give  you design advice. Your allocator could simply be replaced by a loop in the constructors of <code>Node</code> that set the <code>parent</code> pointer on <code>Node</code> from <code>children</code>."}, {"owner": {"reputation": 95, "user_id": 8434292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6f8a0b628d7c051e105d9f49c9d5f43?s=128&d=identicon&r=PG&f=1", "display_name": "extiam", "link": "https://stackoverflow.com/users/8434292/extiam"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1548266432, "post_id": 54331715, "comment_id": 95483815, "body": "@Holt in terms of design advice the answer seems pretty clear: don&#39;t do this, this kind of allocator is against the standard. The loop in the constructor seems like the simplest thing to do as well. The main question I had was whether clang was right not to compile my code which you seem to have answered?"}], "answers": [{"tags": [], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "is_accepted": true, "score": 1, "last_activity_date": 1548316586, "last_edit_date": 1592644375, "creation_date": 1548316586, "answer_id": 54341784, "question_id": 54331715, "link": "https://stackoverflow.com/questions/54331715/does-the-c-standard-place-explicit-requirements-on-the-vector-assign-function/54341784#54341784", "title": "Does the C++ standard place explicit requirements on the vector assign function or constructors?", "body": "<p>Your code seems to be valid regarding the C++17 standard. The strongest requirements come from this copy constructor of <code>std::vector</code>:</p>\n<pre><code>children(other.children, alloc_t(this))\n</code></pre>\n<p>The standard says (<a href=\"http://www.eel.is/c++draft/containers#tab:containers.allocatoraware\" rel=\"nofollow noreferrer\">Table 65</a>) that this requires <code>Node</code> to be <em>Cpp17CopyInsertable</em> into <code>std::vector&lt;Node, PreloadAllocator&lt;Node, Node*&gt;&gt;</code>:</p>\n<blockquote>\n<p><code>T</code>  is <a href=\"http://www.eel.is/c++draft/containers#container.requirements.general-15.4\" rel=\"nofollow noreferrer\"><em>Cpp17CopyInsertable</em></a> into <code>X</code> means that, in addition to <code>T</code> being <em>Cpp17MoveInsertable</em> into <code>X</code>, the following expression is well-formed:</p>\n<pre><code>allocator_traits&lt;A&gt;::construct(m, p, v)\n</code></pre>\n<p>and its evaluation causes the following postcondition to hold: The value of <code>v</code> is unchanged and is equivalent to <code>*p</code>.</p>\n</blockquote>\n<p>The requirements for <a href=\"http://www.eel.is/c++draft/containers#container.requirements.general-15.3\" rel=\"nofollow noreferrer\"><em>Cpp17MoveInsertable</em></a> are similar, except that <code>v</code> is an rvalue, and the post condition is different.</p>\n<p>When looking at the error for <code>clang</code>, it seems the compiler is checking the requirements for <a href=\"http://www.eel.is/c++draft/concept.moveconstructible\" rel=\"nofollow noreferrer\"><em>MoveConstructible</em></a>:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>is_constructible&lt;\n    value_type, \n    typename iterator_traits&lt;move_iterator&lt;__wrap_iter&lt;Node *&gt; &gt;::reference&gt;::value\n</code></pre>\n<p>...which are different than the ones for <a href=\"http://www.eel.is/c++draft/containers#container.requirements.general-15.3\" rel=\"nofollow noreferrer\"><em>Cpp17MoveInsertable</em></a>.</p>\n<hr />\n<p>From a design point of view, I would personally drop that custom allocator and instead update the <code>parent</code> member manually when needed, e.g.:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>Node(Node* parent, const Node&amp; other) \n    : parent(parent), data(other.data), children(other.children) {\n    fix_parent_in_childrens();\n}\n\nvoid fix_parent_in_childrens() {\n    for (Node &amp;node: children) {\n        node.parent = this;\n    }\n}\n</code></pre>\n<p>Since  you seems to have an already correct encapsulation, this makes more sense (to me) than a custom allocator.</p>\n"}], "owner": {"reputation": 95, "user_id": 8434292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6f8a0b628d7c051e105d9f49c9d5f43?s=128&d=identicon&r=PG&f=1", "display_name": "extiam", "link": "https://stackoverflow.com/users/8434292/extiam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 1, "accepted_answer_id": 54341784, "answer_count": 1, "score": 1, "last_activity_date": 1548316586, "creation_date": 1548261096, "last_edit_date": 1548262727, "question_id": 54331715, "link": "https://stackoverflow.com/questions/54331715/does-the-c-standard-place-explicit-requirements-on-the-vector-assign-function", "title": "Does the C++ standard place explicit requirements on the vector assign function or constructors?", "body": "<p>Where it may be ambiguous I will be referring to the C++14 standard.</p>\n\n<p>Using <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/container/vector</a> as a reference, the requirements on the template parameter <code>T</code> for a vector are relatively sparse</p>\n\n<blockquote>\n  <p>The requirements that are imposed on the elements depend on the actual operations performed on the container. Generally, it is required that element type is a complete type and meets the requirements of Erasable, but many member functions impose stricter requirements. </p>\n</blockquote>\n\n<p>Indeed many of the pages (e.g. the one for <a href=\"https://en.cppreference.com/w/cpp/container/vector/insert\" rel=\"nofollow noreferrer\">insert</a>) are remarkably explicit about the requirements placed upon <code>T</code>. Sadly the same is not true for the constructors or the assign function. Is this an omission from the website or from the standard?</p>\n\n<p><strong>Motivation</strong><br>\nThe motivation for this question is a little complicated. I have a class <code>Node</code> representing a node in a tree. Each node has a parent (represented by a <code>Node*</code>) and a list of children (represented by a <code>std::vector&lt;Node, MyAllocator&gt;</code>). This last bit is where it gets interesting. In order to ensure that the <code>Node</code>s continue to point at the correct parents I implemented a custom allocator that 'preloads' each constructor call with a pointer to the correct <code>Node</code>. The code for that is as follows</p>\n\n<pre><code>#ifndef PRElOAD_ALLOCATOR_H\n#define PRElOAD_ALLOCATOR_H\n\n#include &lt;tuple&gt;\n#include &lt;utility&gt;\n#include &lt;memory&gt;\n#include &lt;vector&gt;\n\n/**\n * @class PreloadAllocator\n * Provides a generic allocator that is able to 'preload' some arguments for the\n * construct function. Note that these arguments are *always* loaded at the\n * front of any constructor call so modified move, copy constructors need to\n * created to match.\n * This allocator will only work with simple containers like vector that do not\n * modify the type of the allocator being used. *It will not work* with types\n * like list and map that internally represent the data in a different format.\n * This is because the constructors for these objects behave differently and it\n * is not simple to know how to insert the extra arguments into such a call.\n */\ntemplate &lt;typename T, typename... Args&gt;\nclass PreloadAllocator {\n  public:\n\n    // Standard allocator typedefs\n    using value_type      = T;\n    using pointer         = T*;\n    using const_pointer   = const T*;\n    using reference       = T&amp;;\n    using const_reference = const T&amp;;\n    using size_type       = std::size_t;\n    using difference_type = std::ptrdiff_t;\n\n    PreloadAllocator(Args&amp;&amp;... args)\n      : tup(std::forward_as_tuple(args...) ) {}\n\n    template &lt;typename U&gt;\n      PreloadAllocator(const PreloadAllocator&lt;U, Args...&gt;&amp; other)\n      : tup(other.tup) {}\n\n    pointer allocate(size_type count, const_pointer hint = 0) {\n      return m_defaultAlloc.allocate(count, hint);\n    }\n\n    void deallocate(pointer ptr, size_type count) {\n      return m_defaultAlloc.deallocate(ptr, count);\n    }\n\n    template &lt;typename... Ts&gt;\n      void construct(T* ptr, Ts&amp;&amp;... ts) {\n        // First preload the constructor arguments with the allocator's\n        // versions, then add on the rest, and let the default allocator do the\n        // rest.\n        return construct_impl&lt;Ts...&gt;(\n            ptr, std::forward&lt;Ts&gt;(ts)..., std::index_sequence_for&lt;Args...&gt;{});\n      }\n\n    // Hold the arguments that we will preload into every constructor call\n    const std::tuple&lt;Args...&gt; tup;\n  private:\n    // Compose the default STL allocator to use its version of allocate and\n    // deallocate.\n    std::allocator&lt;T&gt; m_defaultAlloc;\n    // Actual function that does the constructing\n    template &lt;typename... Ts, std::size_t... Is&gt;\n      void construct_impl(T* ptr, Ts&amp;&amp;... ts, std::index_sequence&lt;Is...&gt;) {\n        return m_defaultAlloc.construct(\n          ptr, std::get&lt;Is&gt;(tup)..., std::forward&lt;Ts&gt;(ts)...);\n      }\n};\n\ntemplate &lt;typename T, typename... Args&gt;\nbool operator==(\n    const PreloadAllocator&lt;T, Args...&gt;&amp; lhs,\n    const PreloadAllocator&lt;T, Args...&gt;&amp; rhs)\n{\n  return lhs.tup == rhs.tup;\n}\n\ntemplate &lt;typename T, typename... Args&gt;\nbool operator!=(\n    const PreloadAllocator&lt;T, Args...&gt;&amp; lhs,\n    const PreloadAllocator&lt;T, Args...&gt;&amp; rhs)\n{\n  return !(lhs==rhs);\n}\n\n#endif //&gt; !PRElOAD_ALLOCATOR_H\n\nclass Node {\n  public:\n    using alloc_t = PreloadAllocator&lt;Node, Node*&gt;;\n    using vec_t = std::vector&lt;Node, alloc_t&gt;;\n\n    Node(Node* parent, int data)\n      : parent(parent), data(data), children(alloc_t(this) ) {}\n    Node(Node* parent, const Node&amp; other)\n      : parent(parent), data(other.data), children(other.children, alloc_t(this) ) {}\n    Node(Node* parent, Node&amp;&amp; other)\n      : parent(parent), data(std::move(other.data) ), children(std::move(other.children), alloc_t(this) ) {}\n\n    // Copy/Move constructing is not going to give us the correct parent!\n    Node(const Node&amp;) = delete;\n    Node(Node&amp;&amp;) = delete;\n\n    Node* parent;\n    int data;\n    vec_t children;\n};\n\nint main() {\n  Node root(nullptr, 0);\n}\n</code></pre>\n\n<p>When compiling this code in g++ then it compiles and runs fine. However when I compile in clang I get the following error</p>\n\n<pre><code>In file included from alloc_test.cxx:3:\n/Library/Developer/CommandLineTools/usr/include/c++/v1/vector:1275:9: error: no matching member function for call to 'assign'\n        assign(_Ip(__x.begin()), _Ip(__x.end()));\n        ^~~~~~\nalloc_test.cxx:15:55: note: in instantiation of member function 'std::__1::vector&lt;Node, PreloadAllocator&lt;Node, Node *&gt; &gt;::vector' requested here\n      : parent(parent), data(std::move(other.data) ), children(std::move(other.children), alloc_t(this) ) {}\n                                                      ^\n/Library/Developer/CommandLineTools/usr/include/c++/v1/vector:588:10: note: candidate function not viable: no known conversion from '_Ip' (aka 'move_iterator&lt;__wrap_iter&lt;Node *&gt; &gt;') to\n      'std::__1::vector&lt;Node, PreloadAllocator&lt;Node, Node *&gt; &gt;::size_type' (aka 'unsigned long') for 1st argument\n    void assign(size_type __n, const_reference __u);\n         ^\n/Library/Developer/CommandLineTools/usr/include/c++/v1/vector:576:9: note: candidate template ignored: requirement '!__is_forward_iterator&lt;move_iterator&lt;__wrap_iter&lt;Node *&gt; &gt; &gt;::value' was not satisfied\n      [with _InputIterator = std::__1::move_iterator&lt;std::__1::__wrap_iter&lt;Node *&gt; &gt;]\n        assign(_InputIterator __first, _InputIterator __last);\n        ^\n/Library/Developer/CommandLineTools/usr/include/c++/v1/vector:586:9: note: candidate template ignored: requirement 'is_constructible&lt;value_type, typename iterator_traits&lt;move_iterator&lt;__wrap_iter&lt;Node *&gt;\n      &gt; &gt;::reference&gt;::value' was not satisfied [with _ForwardIterator = std::__1::move_iterator&lt;std::__1::__wrap_iter&lt;Node *&gt; &gt;]\n        assign(_ForwardIterator __first, _ForwardIterator __last);\n        ^\n/Library/Developer/CommandLineTools/usr/include/c++/v1/vector:592:10: note: candidate function not viable: requires single argument '__il', but 2 arguments were provided\n    void assign(initializer_list&lt;value_type&gt; __il)\n         ^\n1 error generated.\n</code></pre>\n\n<p>So, is this an ambiguity in the standard that g++ and clang have decided to interpret differently or is it a genuine error for one of them?</p>\n\n<p>Is attempting to write this sort of preloading allocator an unforgivable abuse of the standard?</p>\n\n<p>*Edit: * fixed missing data members in the code snippet.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1548261064, "post_id": 54331686, "comment_id": 95481272, "body": "strncpy takes a string as argument?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1548261106, "post_id": 54331686, "comment_id": 95481289, "body": "That won&#39;t compile..."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1548261137, "post_id": 54331686, "comment_id": 95481305, "body": "<i>Are there consequences of copying too much data into the buffer, even though the buffer has adequate size?</i> -- what? Is it too much or not?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1548261215, "post_id": 54331686, "comment_id": 95481351, "body": "You should read <a href=\"https://en.cppreference.com/w/cpp/string/byte/strncpy\" rel=\"nofollow noreferrer\">the documentation</a>. Pay close attention to the fine print, and then pretend that <code>strncpy()</code> doesn&#39;t exist."}, {"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1548261362, "post_id": 54331686, "comment_id": 95481431, "body": "@Shawn, from your link, it states, <i>&quot;If, after copying the terminating null character from src, count is not reached, additional null characters are written to dest until the total of count characters have been written.&quot;</i> --&gt; That means <code>my_buffer</code> would be written in with <code>my_string</code> and everything after that in <code>my_buffer</code> would be filled with NULLs. Do I understand it right?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1548261681, "post_id": 54331686, "comment_id": 95481601, "body": "Yes. But it&#39;s the behavior when the source is longer than the destination that&#39;s the real troublesome one. The function is meant for filling in fixed length char arrays that don&#39;t need to be 0 terminated, not reliably copying into a C style string that does. In C++, you should be using std::string instead of C strings anyways. In C, it&#39;s just too error prone and easy to overlook the edge cases."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1548261637, "last_edit_date": 1548261637, "creation_date": 1548261143, "answer_id": 54331729, "question_id": 54331686, "link": "https://stackoverflow.com/questions/54331686/what-happens-if-strncpy-copies-random-data-into-a-buffer/54331729#54331729", "title": "What happens if strncpy copies random data into a buffer?", "body": "<blockquote>\n  <p>but so will 123 other bytes of data that comes after <code>my_string</code></p>\n</blockquote>\n\n<p>This assumption is incorrect: <code>strncpy</code> pays attention to null termination of the source string, never reading past null terminator. The remaining data will be set to <code>'\\0'</code> characters:</p>\n\n<blockquote>\n  <p>destination is padded with zeros until a total of num characters have been written to it. <a href=\"https://en.cppreference.com/w/c/string/byte/strncpy\" rel=\"nofollow noreferrer\"><em>[reference]</em></a></p>\n</blockquote>\n\n<p>This is in contrast to <code>memcpy</code>, which requires both the source and the destination to be of sufficient size in order to avoid undefined behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 3, "last_activity_date": 1548261175, "creation_date": 1548261175, "answer_id": 54331737, "question_id": 54331686, "link": "https://stackoverflow.com/questions/54331686/what-happens-if-strncpy-copies-random-data-into-a-buffer/54331737#54331737", "title": "What happens if strncpy copies random data into a buffer?", "body": "<p>OK, let's assume what you wanted is:</p>\n\n<pre><code>strncpy(my_buffer, my_string.c_str(), 128);\n</code></pre>\n\n<p>Thsi is always a 0-terminated string by definition, so considering:</p>\n\n<blockquote>\n  <p>Copies at most count characters of the character array pointed to by src (including the terminating null character, but not any of the characters that follow the null character) to character array pointed to by dest.</p>\n</blockquote>\n\n<p>You won't get anything copied after <code>\"hello\"</code> from the original string, the rest will be <code>0</code>s:</p>\n\n<blockquote>\n  <p>If, after copying the terminating null character from src, count is not reached, additional null characters are written to dest until the total of count characters have been written.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1444, "user_id": 6534880, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6YTr5.jpg?s=128&g=1", "display_name": "Prodigle", "link": "https://stackoverflow.com/users/6534880/prodigle"}, "is_accepted": false, "score": 2, "last_activity_date": 1548351625, "last_edit_date": 1548351625, "creation_date": 1548261198, "answer_id": 54331746, "question_id": 54331686, "link": "https://stackoverflow.com/questions/54331686/what-happens-if-strncpy-copies-random-data-into-a-buffer/54331746#54331746", "title": "What happens if strncpy copies random data into a buffer?", "body": "<p>Assuming you mean definitely copying that data, as your current code would end at a null terminator.</p>\n\n<p>Essentially, no. Whatever data is in there will be used only as string data so unless you then tried to do something weird with that spare data (try to put a function pointer to it and execute it etc.) then it's basically safe.</p>\n\n<p>The issue is with initially copying random data past the end of your original string, that could overflow into protected data that you don't have access to and throw a segfault(Inaccessible memory exception)</p>\n"}, {"tags": [], "owner": {"reputation": 142, "user_id": 10556443, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_mmqQ58ky7E/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCpR0XqqJ8w320B-KkL6GwxrH0l_g/mo/photo.jpg?sz=128", "display_name": "user10556443", "link": "https://stackoverflow.com/users/10556443/user10556443"}, "is_accepted": false, "score": 2, "last_activity_date": 1548261503, "creation_date": 1548261503, "answer_id": 54331821, "question_id": 54331686, "link": "https://stackoverflow.com/questions/54331686/what-happens-if-strncpy-copies-random-data-into-a-buffer/54331821#54331821", "title": "What happens if strncpy copies random data into a buffer?", "body": "<p>According to strncpy() description here <a href=\"https://clc-wiki.net/wiki/strncpy\" rel=\"nofollow noreferrer\">1</a>, the copy is done up to the length you provided, for null terminated string, so that when end of the string come before, like in this case, copy is done up to it and no more copy is done, so rest of the \"123 bytes\" are not copied, and the copy loop terminates</p>\n"}, {"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1548262642, "post_id": 54331951, "comment_id": 95482110, "body": "You answered the question which was not asked."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1548263667, "post_id": 54331951, "comment_id": 95482650, "body": "The question that <i>was</i> asked was (per the title): &quot;what happens if strncpy() copies random data into a buffer?&quot;, to which the practical answer (&quot;strncpy() won&#39;t do that, at least not in the example code you posted&quot;) is good info, but it doesn&#39;t answer the &quot;what happens if&quot; part."}], "tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": false, "score": 2, "last_activity_date": 1548261940, "creation_date": 1548261940, "answer_id": 54331951, "question_id": 54331686, "link": "https://stackoverflow.com/questions/54331686/what-happens-if-strncpy-copies-random-data-into-a-buffer/54331951#54331951", "title": "What happens if strncpy copies random data into a buffer?", "body": "<p>The other answers to this question have addressed what happens with <code>strncpy()</code> (i.e. it will copy your string correctly because it stops at the 0-terminator byte), so perhaps what gets more to the intent of the question would be, what if you had this instead?</p>\n\n<pre><code>memcpy(my_buffer, my_string.c_str(), 128);\n</code></pre>\n\n<p>In this case, the function (<code>memcpy()</code>) doesn't know about 0-terminated-string semantics, and will always just blindly copy 128 bytes (starting at the address returned by <code>my_string.c_str()</code>) to the address <code>my_buffer</code>.  The first 6 (or so) of those bytes will be from <code>my_string</code>'s internal buffer, and the remaining bytes will be from whatever happens to be in memory after that.</p>\n\n<p>So the question is, what happens then?  Well, this <code>memcpy()</code> call reads from \"mystery memory\" whose purpose you're not aware of, so you're invoking undefined behavior by doing that, and therefore in principle anything could happen.  In practice, the likely result is that your buffer will contain a copy of whatever bytes were read (although you probably won't notice them, since you'll be using string functions that don't look past the 0/terminator byte in your array anyway).  </p>\n\n<p>There is a small chance, though, that the \"extra\" memory bytes that <code>memcpy()</code> read could be part of a memory-page that is marked as off-limits, in which case trying to read from that page would likely cause a segmentation fault.  </p>\n\n<p>And finally, there's the real bugaboo of undefined behavior, which is that your C++ compiler's optimizer is allowed to do all kinds of crazy modifications to your code's logic, in the name of making your program more efficient -- and (assuming the optimizer isn't buggy) all of those optimizations will still result in the program running as intended -- <em>as long as the program follows the rules and doesn't invoke undefined behavior</em>.  Which is to say, if your program invokes undefined behavior in any way, the optimizations may be applied in ways that are <a href=\"https://www.youtube.com/watch?v=g7entxbQOCc&amp;index=34&amp;list=PLHTh1InhhwT7J5jl4vAhO1WvGHUUFgUQH\" rel=\"nofollow noreferrer\">very difficult to predict or understand</a>, resulting in bizarre/unexpected behavior in your program.  So the general rule is, <em>avoid undefined behavior like the plague</em>, because even if you think it \"should be harmless\", there's a very real possibility that it will end up doing things you wouldn't expect it to do, and then you're in for a long, painful debugging session as you try to figure out what's going on.</p>\n"}, {"tags": [], "owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "is_accepted": false, "score": 0, "last_activity_date": 1548262398, "last_edit_date": 1548262398, "creation_date": 1548262075, "answer_id": 54331994, "question_id": 54331686, "link": "https://stackoverflow.com/questions/54331686/what-happens-if-strncpy-copies-random-data-into-a-buffer/54331994#54331994", "title": "What happens if strncpy copies random data into a buffer?", "body": "<p>Function <code>strncpy</code> will copy everything up to NUL character or specified <code>size</code>. That's it.</p>\n\n<p>In addition to other answers please remember that <code>strncpy</code> does not NUL terminate the <code>dst</code> buffer when the <code>src</code> string length (excluding NUL) is equal to buffer's <code>size</code> given. You should always do something like <code>my_buffer[127]=0</code> to prevent buffer overruns when handling the string later on. In <code>libbsd</code> there is <code>strlcpy</code> defined that always NUL terminate the buffer.</p>\n\n<p>Check out this snippet:</p>\n\n<pre><code>#include &lt;string.h&gt;\n\nint main(int argc, char ** argv)\n{\n    char buf[8];\n    char *str = \"deadbeef\";\n\n    strlcpy(buf, str, sizeof(buf));\n    printf(\"%s\\n\", buf);\n\n    strncpy(buf, str, sizeof(buf));\n    printf(\"%s\\n\", buf);\n    return 0;\n}\n</code></pre>\n\n<p>To see the problem compile it with flag <code>-fsanitize=address</code>. The second buffer is not NUL terminated!</p>\n"}], "owner": {"reputation": 145, "user_id": 10863242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/929c63723558abbc140e2464c011912d?s=128&d=identicon&r=PG&f=1", "display_name": "peer_2_peer_2", "link": "https://stackoverflow.com/users/10863242/peer-2-peer-2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 54331729, "answer_count": 6, "score": 2, "last_activity_date": 1548351625, "creation_date": 1548261002, "last_edit_date": 1548261230, "question_id": 54331686, "link": "https://stackoverflow.com/questions/54331686/what-happens-if-strncpy-copies-random-data-into-a-buffer", "title": "What happens if strncpy copies random data into a buffer?", "body": "<p>Suppose you have a <code>char</code> buffer that you want to copy an <code>std::string</code> into. Are there consequences of copying extra data into the buffer, outside of the strings scope, even though the buffer has adequate size?</p>\n\n<p>Example</p>\n\n<pre><code>std::string my_string = \"hello\";\nchar my_buffer[128];\nmemset(my_buffer, 0, 128);\n\nstrncpy(my_buffer, my_string.c_str(), 128);\n</code></pre>\n\n<p>So \"hello\" gets copied into <code>my_buffer</code>, but so will 123 other bytes of data that comes after <code>my_string</code>. Are there any consequences of this? Is it harmful for the buffer to hold this other data? </p>\n"}, {"tags": ["c++", "boost-icl"], "owner": {"reputation": 27886, "user_id": 158285, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/53f7def58ca1dfdc13369dfd5e2aaace?s=128&d=identicon&r=PG", "display_name": "bradgonesurfing", "link": "https://stackoverflow.com/users/158285/bradgonesurfing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1548261011, "creation_date": 1548260618, "last_edit_date": 1548261011, "question_id": 54331589, "link": "https://stackoverflow.com/questions/54331589/can-boost-interval-set-or-interval-map-create-clusters-with-cluster-membership-c", "title": "Can boost interval_set or interval_map create clusters with cluster membership counts?", "body": "<p>For example if I have 5 input intervals</p>\n\n<pre><code>[0,2]\n[1,3]\n[2,4]\n[5,7]\n[6,8]\n</code></pre>\n\n<p>the result should indicate two clusters. Cluster 1</p>\n\n<pre><code>[0,4] with a count of 3\n[5,8] with a count of 2\n</code></pre>\n\n<p>But I've found that boost::icl::interval map doesn't aggregate clusters, but splits on boundaries.</p>\n\n<p>For example the following test case does not give me the result I hoped for</p>\n\n<pre><code>using namespace boost::icl;\ninterval_map&lt;double,int&gt; map;\n\nmap += std::make_pair(interval&lt;double&gt;::right_open(1.0,2.0), 1);\nmap += std::make_pair(interval&lt;double&gt;::right_open(2.1,3.0), 1);\nmap += std::make_pair(interval&lt;double&gt;::right_open(2.9,4.0), 1);\n\nstd::cerr &lt;&lt; map.iterative_size() &lt;&lt; std::endl;\n\n\nEXPECT_EQ(1, map.find(1.5)-&gt;second); // passes\nEXPECT_EQ(2, map.find(1.0)-&gt;second); // passes \nEXPECT_EQ(2, map.find(3.1)-&gt;second); // fails\n</code></pre>\n\n<p>and I understand why as this is by design. However is there a different formulation or library I can use to achieve what I require?</p>\n\n<p>I guess what I'd be looking for is a count of the number of merges that occur with boost::icl::interval_set. When a new interval is added to the container it either inserts a new unique interval or merges with a previous interval. However I don't think the number of times the merge occurs is preserved.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 175, "user_id": 3906464, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/498adf20fce7a9206542168a13765528?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Roncagliolo", "link": "https://stackoverflow.com/users/3906464/patrick-roncagliolo"}, "edited": false, "score": 0, "creation_date": 1548259605, "post_id": 54331213, "comment_id": 95480415, "body": "What&#39;s your request, then? It&#39;s not clear."}, {"owner": {"reputation": 41, "user_id": 10583439, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f277Gao42rk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCMwZdET1bCxGFt_MjwP6L-Xxmyrg/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10583439/john-smith"}, "reply_to_user": {"reputation": 175, "user_id": 3906464, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/498adf20fce7a9206542168a13765528?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Roncagliolo", "link": "https://stackoverflow.com/users/3906464/patrick-roncagliolo"}, "edited": false, "score": 0, "creation_date": 1548259870, "post_id": 54331213, "comment_id": 95480565, "body": "Sorry if it&#39;s not clear, basically if the input is a string or character it will say the input is invalid, otherwise if its a logical operator symbol, or an integer the output will say that."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1548262873, "post_id": 54331213, "comment_id": 95482224, "body": "You need to more formally specify the rules for your input.  Right now, <code>&quot;abcdef*&quot;</code> is valid input."}, {"owner": {"reputation": 41, "user_id": 10583439, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f277Gao42rk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCMwZdET1bCxGFt_MjwP6L-Xxmyrg/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10583439/john-smith"}, "edited": false, "score": 0, "creation_date": 1548263239, "post_id": 54331213, "comment_id": 95482423, "body": "May I ask how? I&#39;m new to C++ sorry"}, {"owner": {"reputation": 6583, "user_id": 10426037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6723e3123b9a13d6360d1ee755f8728?s=128&d=identicon&r=PG&f=1", "display_name": "Valentino", "link": "https://stackoverflow.com/users/10426037/valentino"}, "edited": false, "score": 0, "creation_date": 1548263383, "post_id": 54331213, "comment_id": 95482495, "body": "You need to parse each character of the input stream. Also you may wish to consider what to do in case of unclear input. For example, are you ok if there is more than one operator? If I wrote in input <code>12 + 34 * 4</code> would be a valid input for the program?"}, {"owner": {"reputation": 41, "user_id": 10583439, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f277Gao42rk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCMwZdET1bCxGFt_MjwP6L-Xxmyrg/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10583439/john-smith"}, "edited": false, "score": 0, "creation_date": 1548263571, "post_id": 54331213, "comment_id": 95482599, "body": "The input would be invalid, I&#39;m just aiming for only one operator so 1+1 would be valid, but adding in other symbols would become invalid, or just add in another conditional statement?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548263854, "post_id": 54331213, "comment_id": 95482736, "body": "@JohnSmith You could setup a <a href=\"https://en.cppreference.com/w/cpp/regex/basic_regex\" rel=\"nofollow noreferrer\"><code>std::regex</code></a> to validate your input."}, {"owner": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "edited": false, "score": 0, "creation_date": 1548264608, "post_id": 54331213, "comment_id": 95483031, "body": "@JohnSmith Do you accept negative integers? Are both <code>+1</code> and <code>-1</code> valid inputs?"}, {"owner": {"reputation": 41, "user_id": 10583439, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f277Gao42rk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCMwZdET1bCxGFt_MjwP6L-Xxmyrg/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10583439/john-smith"}, "edited": false, "score": 0, "creation_date": 1548265175, "post_id": 54331213, "comment_id": 95483240, "body": "I&#39;m so new to this I think probably not, I&#39;d just like to see how to get C++ to detect if the input is a number or operator symbol, cause wouldn&#39;t that mean I have to convert the input? or am I handling this wrong"}], "answers": [{"tags": [], "owner": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "is_accepted": false, "score": 1, "last_activity_date": 1548341436, "last_edit_date": 1548341436, "creation_date": 1548269157, "answer_id": 54333775, "question_id": 54331213, "link": "https://stackoverflow.com/questions/54331213/c-input-to-only-accept-operator-symbols-or-only-numbers/54333775#54333775", "title": "C++ Input to only accept operator symbols or only numbers", "body": "<p><strong>Definition of the Valid Input</strong></p>\n\n<p>Here I assume that the <em>valid input</em> is given by the following natural statements. First of all, as you mentioned,</p>\n\n<ul>\n<li><p>Each input must be constructed from <code>*</code>, <code>/</code>, <code>%</code>, <code>+</code> and <strong>an integer</strong>.</p></li>\n<li><p>Only zero or one operation. ( So <code>1+1</code> is valid. )</p></li>\n</ul>\n\n<p>For an input of an integer, I also assume</p>\n\n<ul>\n<li><p><a href=\"https://en.cppreference.com/w/cpp/string/byte/isspace\" rel=\"nofollow noreferrer\">Whitespace characters</a> are allowed in the left and right side of the input string.</p></li>\n<li><p>Whitespace characters between non-whitespace characters are not allowed.</p></li>\n<li><p>The first non-whitespace character must be <code>0</code>, <code>1</code>, ..., <code>9</code> or <code>-</code> (for negative integers).</p></li>\n<li><p>The second and the subsequent non-whitespace characters must be <code>0</code>, <code>1</code>, ..., <code>8</code> or <code>9</code>.</p></li>\n</ul>\n\n<p>Note that in my assumption the positive sign character <code>+</code>, decimal-point character <code>.</code> are not allowed for integer inputs.\nFor instance, in this definition,</p>\n\n<ul>\n<li><code>\"123\"</code>, <code>\"  123\"</code>, <code>\"123  \"</code> and <code>\" -123 \"</code> are <strong>all valid</strong> integer inputs.</li>\n<li><code>\"abc\"</code>, <code>\"123a\"</code>, <code>\" 1  23\"</code>, <code>\"+123\"</code> and <code>\"1.0\"</code> are <strong>all invalid</strong> ones.</li>\n</ul>\n\n<hr>\n\n<p><strong>Validity Check Function for An Integer</strong></p>\n\n<p>First, to check the validity of the input of an integer, we trim the input and remove left and right whitespaces using the following <a href=\"https://stackoverflow.com/questions/1798112/removing-leading-and-trailing-spaces-from-a-string/1798170#1798170\"><strong>trimming function</strong></a>: ( If you can use C++17, <code>std::string_view</code> would be more preferable from the performance poin of view.)</p>\n\n<pre><code>#include &lt;string&gt;\n\nstd::string trimLR(const std::string&amp; str)\n{\n    const auto strBegin = str.find_first_not_of(\" \\f\\n\\r\\t\\v\");\n    if (strBegin == std::string::npos){\n        return \"\";\n    }\n\n    const auto strEnd = str.find_last_not_of(\" \\f\\n\\r\\t\\v\");\n    const auto strRange = strEnd - strBegin + 1;\n\n    return str.substr(strBegin, strRange);\n}\n</code></pre>\n\n<p>Next, we define the following simple validity check function <code>isInteger</code> which checks whether the passed string is an integer or not. Here <a href=\"https://en.cppreference.com/w/cpp/string/byte/isdigit\" rel=\"nofollow noreferrer\"><code>std::isdigit</code></a> is useful to check whether each character is digits or not.\nPlease note that various interesting methods are proposed in the <a href=\"https://stackoverflow.com/questions/2844817/how-do-i-check-if-a-c-string-is-an-int\"><strong>past</strong></a> \n <a href=\"https://stackoverflow.com/questions/8888748/how-to-check-if-given-c-string-or-char-contains-only-digits\"><strong>posts</strong></a>.</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;algorithm&gt;\n\nbool isInteger(const std::string&amp; s)\n{\n    const auto ts = trimLR(s);\n\n    if(ts.empty()){\n        return false;\n    }\n\n    const std::size_t offset = (ts[0] == '-') ? 1 : 0;\n    const auto begin = ts.cbegin() + offset;\n\n    return (begin != ts.cend()) // false if s is just a negative sign \"-\"\n              &amp;&amp; std::all_of(begin, ts.cend(), [](unsigned char c){\n                     return std::isdigit(c);\n                 });\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Main Function</strong></p>\n\n<p>Now it is easy and straightforward to implement the main function.\nThe following code will check inputs and work fine.\nThe next considerations are writing tests and performance tunings:</p>\n\n<p><a href=\"https://wandbox.org/permlink/IAcburBBo6RbbMqS\" rel=\"nofollow noreferrer\"><strong>DEMO(Multiplication)</strong></a></p>\n\n<p><a href=\"https://wandbox.org/permlink/KZMZqhRA17ARETkP\" rel=\"nofollow noreferrer\"><strong>DEMO(Division)</strong></a></p>\n\n<p><a href=\"https://wandbox.org/permlink/DmSmoqA0cxmsTMC9\" rel=\"nofollow noreferrer\"><strong>DEMO(Modulo)</strong></a></p>\n\n<p><a href=\"https://wandbox.org/permlink/R7o0FqOIQPm32S92\" rel=\"nofollow noreferrer\"><strong>DEMO(Addition)</strong></a></p>\n\n<p><a href=\"https://wandbox.org/permlink/dwE0mUHOjVK1R95u\" rel=\"nofollow noreferrer\"><strong>DEMO(Invalid 1)</strong></a></p>\n\n<p><a href=\"https://wandbox.org/permlink/y49MewhARZvUZuvX\" rel=\"nofollow noreferrer\"><strong>DEMO(Invalid 2)</strong></a></p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    std::string x;\n\n    std::cout &lt;&lt; \"Enter expression: \";\n    std::getline(std::cin, x);\n\n    const auto optPos = x.find_first_of(\"*/%+\");\n\n    if (optPos == std::string::npos)\n    {\n        if(isInteger(x)){\n            std::cout &lt;&lt; \"Valid input, \" &lt;&lt; x;\n        }\n        else{\n            std::cout &lt;&lt; \"Invalid input, \" &lt;&lt; x;\n        }\n\n        return 0;\n    }\n\n    const auto left  = x.substr(0, optPos);\n    const auto opt   = x.substr(optPos, 1);\n    const auto right = x.substr(std::min(optPos+1, x.length()-1));\n\n    if (!isInteger(left) || !isInteger(right))\n    {\n        std::cout\n            &lt;&lt; \"Either `\" &lt;&lt; left &lt;&lt; \"`, `\" &lt;&lt; right \n            &lt;&lt; \"` or both are invalid inputs.\" &lt;&lt; std::endl;\n\n        return 0;\n    }\n\n    const auto leftVal  = std::stod(left);\n    const auto rightVal = std::stod(right);\n\n    if(opt == \"*\")\n    {\n        std::cout \n            &lt;&lt; \"Multiplication: \" \n            &lt;&lt; x &lt;&lt; \" = \" &lt;&lt; (leftVal * rightVal);\n    }\n    else if(opt == \"/\")\n    {\n        std::cout \n            &lt;&lt; \"Division: \" \n            &lt;&lt; x &lt;&lt; \" = \" &lt;&lt; (leftVal / rightVal);\n    }\n    else if(opt == \"%\")\n    {\n        std::cout \n            &lt;&lt; \"Modulo: \" \n            &lt;&lt; x &lt;&lt; \" = \" &lt;&lt; (std::stoi(left) % std::stoi(right));\n    }\n    else if(opt == \"+\")\n    {\n        std::cout \n            &lt;&lt; \"Addition: \" \n            &lt;&lt; x &lt;&lt; \" = \" &lt;&lt; (leftVal + rightVal);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10583439, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f277Gao42rk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCMwZdET1bCxGFt_MjwP6L-Xxmyrg/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10583439/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 921, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1548341436, "creation_date": 1548259420, "question_id": 54331213, "link": "https://stackoverflow.com/questions/54331213/c-input-to-only-accept-operator-symbols-or-only-numbers", "title": "C++ Input to only accept operator symbols or only numbers", "body": "<p>I've been trying to code this as sort of a beginner program for C++ to help me understand the language more but I don't really know how to tackle this.</p>\n\n<p>Basically the program needs to only accept '+', '*', '/', '%' or numbers, otherwise it will say the input is invalid.</p>\n\n<p>Here's what I've done so far</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nint main()\n{\n    string x;\n\n    cout&lt;&lt;\"Enter expression: \";\n    getline(cin,x);\n\n\n\n    if(x.find('*') != string::npos){\n\n        cout&lt;&lt;\"Multiplication\";\n    }else if(x.find('/') != string::npos){\n\n        cout&lt;&lt;\"Division\";\n    }else if(x.find('%') != string::npos){\n\n        cout&lt;&lt;\"Modulo\";\n    }else if(x.find('+') != string::npos){\n\n        cout&lt;&lt;\"Addition\";\n    }else{\n\n        cout&lt;&lt;\"Invalid!\";\n}\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "data-structures", "low-latency"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 7, "creation_date": 1548258852, "post_id": 54330963, "comment_id": 95479979, "body": "This is what a <a href=\"http://quick-bench.com/\" rel=\"nofollow noreferrer\">benchmarker</a> is for.  Test both implementations on your suspected data set and see what you get.  The cache efficiency you gain from contiguous containers vs the algorithmic gain you get from using the &quot;right&quot; container are hard to judge.  The real world often doesn&#39;t mirror the theoretical one so testing is your friend."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 6, "creation_date": 1548258878, "post_id": 54330963, "comment_id": 95479991, "body": "the big-O notation is for asymtotic complexity. What people often forget is the &quot;asymptotic&quot;, ie for small enough N the complexitiy tells you nothing about performance. I think the only correct answer is: measure!"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 6, "creation_date": 1548259057, "post_id": 54330963, "comment_id": 95480095, "body": "For that problem, vector would be a much better solution. You only are expected to have 26 keys (assuming lower-case letters of Latin alphabet), and <code>unordered_map</code>  performance is likely to be pretty abysmal."}, {"owner": {"reputation": 166, "user_id": 10938068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3056e94de5646aad27742bf37698c97?s=128&d=identicon&r=PG&f=1", "display_name": "Alok Garg", "link": "https://stackoverflow.com/users/10938068/alok-garg"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548259064, "post_id": 54330963, "comment_id": 95480102, "body": "@NathanOliver That is a useful tool. Thanks!"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548259106, "post_id": 54330963, "comment_id": 95480126, "body": "@NathanOliver in this case it is not question that <code>vector</code> would outperform <code>unordered_map</code> on such a limited key space. I would argue that in low-latency applications <code>unordered_map</code> of <code>char</code> should be ill-advised."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1548259148, "post_id": 54330963, "comment_id": 95480152, "body": "Why do you think you will get better cache coherency with a vector? For all we know, unordered_map could be using vector or some other array-like data type for its underlying storage mechanism. In your particular case vector is going to win but probably not because of cache coherency."}, {"owner": {"reputation": 166, "user_id": 10938068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3056e94de5646aad27742bf37698c97?s=128&d=identicon&r=PG&f=1", "display_name": "Alok Garg", "link": "https://stackoverflow.com/users/10938068/alok-garg"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1548259250, "post_id": 54330963, "comment_id": 95480215, "body": "@SergeyA How can a vector be better in this case ? You have mentioned vector and key at the same time so I don&#39;t understand how it could be used."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1548259316, "post_id": 54330963, "comment_id": 95480249, "body": "@n.m. The difference is with <code>vector</code> you are guaranteed memory contiguity and compactness. With <code>unordered_map</code> you are just hoping for it. At best you can check for a specific platform with a specific use case. But locality would still only be, at best, as good as <code>vector</code>."}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1548259330, "post_id": 54330963, "comment_id": 95480262, "body": "What are the possible characters in the string? just lowercase or just printable characters?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1548259356, "post_id": 54330963, "comment_id": 95480278, "body": "@AlokGarg I am not going to give you solution, for several reasons. But I think, I gave you some food for thought."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548259372, "post_id": 54330963, "comment_id": 95480294, "body": "@AlokGarg If your keys have contiguous values (generally true for characters of the alphabet, but not guaranteed on all platforms) then you can arithmetically determine indices from the characters. Just subtract the lowest ordered key from the character value and that&#39;s your index."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1548259433, "post_id": 54330963, "comment_id": 95480324, "body": "No, you are not thinking of the correct usage of vector. You need to use it as a hash table with an identity hash function (the index is the key)."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1548259485, "post_id": 54330963, "comment_id": 95480355, "body": "@AlokGarg A good term to search for is &quot;perfect hashing&quot;."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548259555, "post_id": 54330963, "comment_id": 95480383, "body": "@Fran&#231;oisAndrieux The standard guarantees you many things, but real life performance is not one of them. For that, you need to test."}, {"owner": {"reputation": 166, "user_id": 10938068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3056e94de5646aad27742bf37698c97?s=128&d=identicon&r=PG&f=1", "display_name": "Alok Garg", "link": "https://stackoverflow.com/users/10938068/alok-garg"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1548260289, "post_id": 54330963, "comment_id": 95480842, "body": "Thanks @juanchopanza for the lead."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548260555, "post_id": 54330963, "comment_id": 95480997, "body": "@Fran&#231;oisAndrieux OP has assumed that with vector the asymototic complexity will be worse that with unordered map. This assumption only holds when the key space is large. But suppose for a second it is large. Then you have no guarantees. You can only hope that vector wins despite worse complexity, because of this or that constant speed up factor versus unordered map, which may or may not be there."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1548260899, "post_id": 54330963, "comment_id": 95481170, "body": "@n.m. It seems you misunderstand my comment. I&#39;m merely providing a point of view with regards to your question <i>&quot;Why do you think you will get better cache coherency with a vector?&quot;</i>  Answer : because it has tight memory layout requirements. <code>std::list</code> might have great locality sometimes. Who knows how it&#39;s allocator was written? But you can&#39;t generally count on it. Though you can count on <code>std::vector</code>&#39;s layout. That&#39;s why someone could <i>think</i> <code>std::vector</code> has good cache coherency. Which is what you asked. I&#39;m not saying it&#39;s <i>necessarily</i> better and I&#39;m not arguing against your point."}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1548261175, "post_id": 54330963, "comment_id": 95481325, "body": "btw, your logic is buggy. <code>isPermutation(&quot;ab&quot;, &quot;a&quot;)</code> will return true"}, {"owner": {"reputation": 166, "user_id": 10938068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3056e94de5646aad27742bf37698c97?s=128&d=identicon&r=PG&f=1", "display_name": "Alok Garg", "link": "https://stackoverflow.com/users/10938068/alok-garg"}, "reply_to_user": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1548261392, "post_id": 54330963, "comment_id": 95481445, "body": "@balki no it shouldn\u2019t . I am checking that both strings are equal length in the beginning ."}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1548261402, "post_id": 54330963, "comment_id": 95481452, "body": "oh.. yes. I missed that."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548262267, "post_id": 54330963, "comment_id": 95481925, "body": "@Fran&#231;oisAndrieux You have some guarantees about std::vector, but there&#39;s no guarantee of <i>better</i> cache coherence. You can assume a reasonable implementation will provide <i>not worse</i> cache coherence (because it has tight memory layout requirements indeed), but this is rather different from &quot;better&quot;.  There are other performance-impacting factors too, so <i>not worse</i> cache coherence guaraantee isn&#39;t worth much without testing."}, {"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1548263016, "post_id": 54330963, "comment_id": 95482304, "body": "Firstly I&#39;d take a look at std::is_permutation. Then for a cache friendly container consider boost::flat_map. Lastly, if your strings are regular words or names then the average length will be quite low (a bit over 5 for English). This means that big-O complexity doesn&#39;t count for much. As already said, you need to measure the performance."}], "answers": [{"tags": [], "owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "is_accepted": false, "score": 4, "last_activity_date": 1548260322, "last_edit_date": 1548260322, "creation_date": 1548259135, "answer_id": 54331135, "question_id": 54330963, "link": "https://stackoverflow.com/questions/54330963/in-a-low-latency-application-is-unordered-map-ever-a-better-solution-over-vecto/54331135#54331135", "title": "In a low-latency application, Is unordered_map ever a better solution over vector?", "body": "<p>Sure, but it really depends on the problem you are trying to solve.  If the domain of your key space is unknown, it would be difficult to come up with a generic solution that is faster than <code>unordered_map</code>.</p>\n\n<p>In this case, the domain of your key space <em>is</em> known: it is limited to ASCII characters.  This is convenient because you can instantly convert from item (<code>char</code>) to vector index (<code>std::size_t</code>).  So you could just use the value of each character as an index into a <code>vector</code> rather than hashing it for every lookup.</p>\n\n<p>But in general, <strong>don't optimize prematurely.</strong>  If <code>unordered_map</code> is the most natural solution, I would start there, then profile, and if you find that performance does not meet your requirements, look at reworking your solution.  (This isn't always the best advice; if you <em>know</em> you are working on a highly critical piece of code, there are certain design decisions you will want to take into consideration from the beginning.  Coming back and refactoring later may be much more difficult if you start with an incompatible design.)</p>\n"}, {"tags": [], "owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "is_accepted": false, "score": 0, "last_activity_date": 1548304703, "creation_date": 1548304703, "answer_id": 54339451, "question_id": 54330963, "link": "https://stackoverflow.com/questions/54330963/in-a-low-latency-application-is-unordered-map-ever-a-better-solution-over-vecto/54339451#54339451", "title": "In a low-latency application, Is unordered_map ever a better solution over vector?", "body": "<p>Since there are only 256 possible keys, you can use a stack-allocated array of 256 counts, which will be faster than a vector or an unordered_map.  if <code>first.size()+second.size() &lt; 128</code>, then only initialize the counts to 0 for keys that actually occur.  Otherwise <code>memset</code> the whole array.</p>\n"}], "owner": {"reputation": 166, "user_id": 10938068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3056e94de5646aad27742bf37698c97?s=128&d=identicon&r=PG&f=1", "display_name": "Alok Garg", "link": "https://stackoverflow.com/users/10938068/alok-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1548304703, "creation_date": 1548258571, "last_edit_date": 1548259008, "question_id": 54330963, "link": "https://stackoverflow.com/questions/54330963/in-a-low-latency-application-is-unordered-map-ever-a-better-solution-over-vecto", "title": "In a low-latency application, Is unordered_map ever a better solution over vector?", "body": "<p>Is it advisable to use <code>unordered_map</code> in place of <code>vector</code> while developing a low-latency application ?</p>\n\n<p>I recently appeared for an interview with a financial company which worked on low-latency trading applications. I was asked a question for which I answered using an <code>unordered_map</code> which seemed pretty good efficiency-wise (<code>0(n)</code>) compared to If I had used a vector (<code>O(n*n)</code>). However, I know that it is advisable to use vector as much as possible and avoid <code>unordered_map</code> in order to utilize benefits of cache coherence.  I just wanted to see If there is a better solution possible for this problem  The problem I was asked was to check If two strings are a permutation of each other. </p>\n\n<pre><code>bool isPermutation(const std::string&amp; first, const std::string&amp; second) {\n    std::unordered_map&lt;char, int&gt; charDict;\n    if(first.length() != second.length()) \n        return false;\n\n    for(auto it: first) {\n        charDict[it]++;\n    }\n\n    for(auto it: second) {\n        if(charDict.count(it) &gt; 0) {\n        --charDict[it];\n    } else {\n        return false;\n    }\n    return true;\n}\n</code></pre>\n\n<p>You can assume that both strings are equal length and the function is only assumed to return true If there is an exact number of occurrences of each character in second string as there are in the first string.</p>\n"}, {"tags": ["c++", "c++11", "language-lawyer"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1548258605, "post_id": 54330926, "comment_id": 95479839, "body": "Though it&#39;s &quot;hidden&quot; you can still use <code>A::f()</code> to call <code>A</code>&#39;s implementation (for example : <code>o.A::f();</code>)."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 7, "creation_date": 1548258639, "post_id": 54330926, "comment_id": 95479863, "body": "Consider using <code>override</code> when overriding a base class&#39; <code>virtual</code> member function to avoid errors."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548259924, "post_id": 54330926, "comment_id": 95480600, "body": "@Fran&#231;oisAndrieux I understand <code>A::f()</code> can be called directly. I just wondered if this is a valid thing. Thanks for the <code>override</code> suggestion which I often forget!"}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1548275331, "post_id": 54330926, "comment_id": 95487687, "body": "One possibility would be that <code>C::f()</code> could delegate part of its implementation to <code>A::f()</code> again."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1548259534, "last_edit_date": 1548259534, "creation_date": 1548259203, "answer_id": 54331152, "question_id": 54330926, "link": "https://stackoverflow.com/questions/54330926/is-it-valid-to-hide-a-base-class-virtual-function-by-making-it-pure-virtual-in/54331152#54331152", "title": "Is it valid to &quot;hide&quot; a base class virtual function by making it pure virtual in derived classes?", "body": "<blockquote>\n  <p>my question whether this is a valid C++ or just \"works\" (such as undefined behaviours)?</p>\n</blockquote>\n\n<p>The behaviour of the program is well defined.</p>\n\n<blockquote>\n  <p>effectively making <code>A::f()</code> more or less pointless.</p>\n</blockquote>\n\n<p>Of course, if you never call a function, then defining the function is unnecessary indeed. To clarify, the function would have to be declared pure virtual if you did choose to omit the definition (the opposite is not true; you <em>can</em> define a pure virtual function).</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 23, "last_activity_date": 1548259380, "creation_date": 1548259380, "answer_id": 54331206, "question_id": 54330926, "link": "https://stackoverflow.com/questions/54330926/is-it-valid-to-hide-a-base-class-virtual-function-by-making-it-pure-virtual-in/54331206#54331206", "title": "Is it valid to &quot;hide&quot; a base class virtual function by making it pure virtual in derived classes?", "body": "<p>It is clearly allowed and supported by the standard (cf, for example, <a href=\"https://timsong-cpp.github.io/cppwp/n3337/class.abstract#5\" rel=\"noreferrer\">this</a> online C++ standard draft), and thus clearly not undefined behaviour:</p>\n\n<blockquote>\n  <p><strong>10.4 Abstract classes</strong></p>\n  \n  <p>5 [ Note: An abstract class can be derived from a class that is not\n  abstract, and a pure virtual function may override a virtual function\n  which is not pure.  \u2014 end note ]</p>\n</blockquote>\n\n<p>The effect is that your class <code>B</code> becomes abstract and any subclass - if it shall not be abstract, too - must define <code>f()</code> then; the implementation in class <code>A</code> can still be invoked through <code>A::f()</code>, such that it is - from the perspective of reusing the implementation - not pointless.</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1548259423, "creation_date": 1548259423, "answer_id": 54331215, "question_id": 54330926, "link": "https://stackoverflow.com/questions/54330926/is-it-valid-to-hide-a-base-class-virtual-function-by-making-it-pure-virtual-in/54331215#54331215", "title": "Is it valid to &quot;hide&quot; a base class virtual function by making it pure virtual in derived classes?", "body": "<p>This is valid and well-defined C++.</p>\n\n<p>It can occasionally be useful if you want to force a user of your class to implement a method that's already implemented in a base class (and don't want to use a different name which would be a more obvious choice). GUI libraries implementing operating system message pumps are one application.</p>\n"}, {"comments": [{"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "edited": false, "score": 0, "creation_date": 1548260369, "post_id": 54331258, "comment_id": 95480892, "body": "It&#39;s unclear what the OP thinks is being hidden. Seems quite clear what it does and I don&#39;t see anything being hidden."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1548260393, "post_id": 54331258, "comment_id": 95480904, "body": "I agree with your question - but a colleague argued this increases &quot;safety&quot; (i.e., it forces C to provide an implementation and avoids calling A::f() accidentally while allowing A::f() to be called directly if needed). bTW, the &quot;hidden&quot; is used for want of a better word. Hiding isn&#39;t really important to my question. Thanks."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "edited": false, "score": 0, "creation_date": 1548262483, "post_id": 54331258, "comment_id": 95482013, "body": "@doug It hides &quot;the ability of the non-pureness of <code>A::f()</code> to allow people not to bother overriding <code>f()</code>&quot;, I guess."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1548262526, "post_id": 54331258, "comment_id": 95482035, "body": "@usr: I can sort of get behind that, <i>if</i> it is dangerous/undesirable for someone to forget to override <code>f()</code>. But then it should be pure virtual in the base already, no?"}, {"owner": {"reputation": 4035, "user_id": 478891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df15c8847129ee12937d3e62b84a3a4f?s=128&d=identicon&r=PG", "display_name": "Eric Towers", "link": "https://stackoverflow.com/users/478891/eric-towers"}, "edited": false, "score": 0, "creation_date": 1548263898, "post_id": 54331258, "comment_id": 95482756, "body": "It is perfectly reasonable for a base to provide a default implementation and it is perfectly reasonable for a derived to realize that the default implementation is contextually incorrect and further inheritors must write a correct one.  Off the head instance:  when layering an abstract logging system over an existing concrete error reporting object hierarchy, abstract loggers may not want to spew their logging content to stderr, but do need to store their content somewhere.  (It&#39;s a mandatory 3rd part error reporter, so refactoring it is not going to happen.)"}, {"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "edited": false, "score": 0, "creation_date": 1548267298, "post_id": 54331258, "comment_id": 95484227, "body": "So the point of the technique is to force classes derived from B to require an f() so it flags, at compile time, the lack of a definition. It wasn&#39;t clear to me why the OP&#39;s code would produce UB. It&#39;s quite well defined and may be of some use. Almost all of my limited OOP used pure virtual base classes and rarely had multiple levels below that.  The notion of forcing definitions in subclasses where a superclass provides a definition is interesting."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1548268157, "post_id": 54331258, "comment_id": 95484658, "body": "If you can&#39;t modify <code>A</code> then sure."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 3, "last_activity_date": 1548259543, "creation_date": 1548259543, "answer_id": 54331258, "question_id": 54330926, "link": "https://stackoverflow.com/questions/54330926/is-it-valid-to-hide-a-base-class-virtual-function-by-making-it-pure-virtual-in/54331258#54331258", "title": "Is it valid to &quot;hide&quot; a base class virtual function by making it pure virtual in derived classes?", "body": "<p>This will safely achieve the goal of requiring the author of <code>C</code> to provide an implementation for <code>f()</code>.</p>\n\n<p>I would query why this is needed &mdash; if the base implementation is not \"valid\" in your design then why does it exist, and/or why is it <code>virtual</code>?</p>\n\n<p>They can still invoke <code>A::f()</code>, anyway, so whether this can be deemed \"hiding\" is open to debate.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10684582, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JUFSP_mBy8Q/AAAAAAAAAAI/AAAAAAAAAk0/MyAK8pn6MWo/photo.jpg?sz=128", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10684582/sebastian"}, "is_accepted": false, "score": 2, "last_activity_date": 1548259637, "creation_date": 1548259637, "answer_id": 54331284, "question_id": 54330926, "link": "https://stackoverflow.com/questions/54330926/is-it-valid-to-hide-a-base-class-virtual-function-by-making-it-pure-virtual-in/54331284#54331284", "title": "Is it valid to &quot;hide&quot; a base class virtual function by making it pure virtual in derived classes?", "body": "<p>As far as I can see there's no undefined behavior = 0 only means that derived classes must override it. But you can still provide an out-of-line definition for that function in the same class.</p>\n"}], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1749, "favorite_count": 3, "accepted_answer_id": 54331206, "answer_count": 5, "score": 19, "last_activity_date": 1548259637, "creation_date": 1548258468, "question_id": 54330926, "link": "https://stackoverflow.com/questions/54330926/is-it-valid-to-hide-a-base-class-virtual-function-by-making-it-pure-virtual-in", "title": "Is it valid to &quot;hide&quot; a base class virtual function by making it pure virtual in derived classes?", "body": "<p>Consider the example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass A {\n    public:\n    virtual void f();\n};\n\nvoid A::f()\n{\n    std::cout &lt;&lt; \"f() from A\\n\";\n}\n\nclass B: public A {\n    public:\n    virtual void f() = 0;\n};\n\nclass C: public B {\n    public:\n    void f();\n};\n\nvoid C::f()\n{\n    std::cout &lt;&lt; \"f() from C\\n\";\n}\n\nint main()\n{\n    C o;\n    o.f();\n}\n</code></pre>\n\n<p><code>A::f()</code> implementation is \"hidden\" from class C, which provides its own implementation for <code>f()</code> - effectively making <code>A::f()</code> more or less pointless. I see little value in such class hierarchy design, but my question whether this is a valid C++ or just \"works\" (such as undefined behaviours)?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548258052, "post_id": 54330781, "comment_id": 95479510, "body": "Maybe lookup <i>placement new</i>."}, {"owner": {"reputation": 1130, "user_id": 3702643, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4f61562dc120ef93ca459f241a028f0b?s=128&d=identicon&r=PG&f=1", "display_name": "user3702643", "link": "https://stackoverflow.com/users/3702643/user3702643"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548258348, "post_id": 54330781, "comment_id": 95479690, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 I think placement new is what I&#39;m looking for. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548258432, "post_id": 54330894, "comment_id": 95479740, "body": "It always violates the start of lifetime, even for simple <code>int</code>. It never violates strict aliasing."}, {"owner": {"reputation": 1130, "user_id": 3702643, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4f61562dc120ef93ca459f241a028f0b?s=128&d=identicon&r=PG&f=1", "display_name": "user3702643", "link": "https://stackoverflow.com/users/3702643/user3702643"}, "edited": false, "score": 0, "creation_date": 1548258439, "post_id": 54330894, "comment_id": 95479747, "body": "Thank you! This is what I was looking for. Will accept the answer in 6 mins."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548258485, "post_id": 54330894, "comment_id": 95479770, "body": "Also, you need to assert proper alignment."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548258492, "post_id": 54330894, "comment_id": 95479775, "body": "@BaummitAugen it always violates strict aliasing rule, once you start accesing the object through the pointer. Alignment would only be a problem if <code>Object</code> alignment requirements are exceeding= __ STDCPP_DEFAULT_NEW_ALIGNMENT__ and there is no indication this is the case."}, {"owner": {"reputation": 1130, "user_id": 3702643, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4f61562dc120ef93ca459f241a028f0b?s=128&d=identicon&r=PG&f=1", "display_name": "user3702643", "link": "https://stackoverflow.com/users/3702643/user3702643"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548258526, "post_id": 54330894, "comment_id": 95479793, "body": "@BaummitAugen what do you mean by proper alignment?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 1130, "user_id": 3702643, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4f61562dc120ef93ca459f241a028f0b?s=128&d=identicon&r=PG&f=1", "display_name": "user3702643", "link": "https://stackoverflow.com/users/3702643/user3702643"}, "edited": false, "score": 0, "creation_date": 1548258670, "post_id": 54330894, "comment_id": 95479878, "body": "@user3702643 there is no indication that you should be worried about alignment."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548258726, "post_id": 54330894, "comment_id": 95479910, "body": "@SergeyA There are no two pointers of unrelated types storing or loading the same memory location. Note that pointers to <code>char</code>, <code>signed char</code>, <code>unsigned char</code> and <code>std::byte</code> are exempt from that rule. So there is no strict aliasing violation."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548258789, "post_id": 54330894, "comment_id": 95479937, "body": "@BaummitAugen You misunderstand the rule. <code>char*</code> is exempted, but <code>Object*</code> is not. While it is always legal to access any pointer through <code>char*</code>, the opposite is not true, and you cannot access <code>char*</code> through any pointer."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548259068, "post_id": 54330894, "comment_id": 95480105, "body": "@SergeyA Again, strict aliasing only forbids access though two pointers of unrelated type. Accessing the memory allocated in <code>new char[]</code> via <code>Object*</code> does not violate strict aliasing because no such two pointers are involved. The issue is purely related to lifetime."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 1130, "user_id": 3702643, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4f61562dc120ef93ca459f241a028f0b?s=128&d=identicon&r=PG&f=1", "display_name": "user3702643", "link": "https://stackoverflow.com/users/3702643/user3702643"}, "edited": false, "score": 0, "creation_date": 1548259190, "post_id": 54330894, "comment_id": 95480175, "body": "I was wrong about the alignment, though. cc @user3702643"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548259306, "post_id": 54330894, "comment_id": 95480243, "body": "@BaummitAugen no, again, you are wrong. There is accessing through a pointer to <code>Object</code> to the address where dynamic type of the object is not <code>Object</code> (it is a char). You might want to re-read corresponding section of the standard."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548260195, "post_id": 54330894, "comment_id": 95480779, "body": "Hm yeah, looks like I somehow got that mixed up. Sorry. Though the &quot;potentially&quot; with regard to the lifetime issue is still wrong. (Unless I messed that up, too, but [intro.object]/1 seems clear about that at least.)"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548260830, "post_id": 54330894, "comment_id": 95481134, "body": "@BaummitAugen lifetime might be a mistake on my side :) I would need to research it more."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 2, "last_activity_date": 1548258461, "last_edit_date": 1548258461, "creation_date": 1548258375, "answer_id": 54330894, "question_id": 54330781, "link": "https://stackoverflow.com/questions/54330781/cast-first-16-bytes-of-allocated-memory-into-a-udt/54330894#54330894", "title": "Cast first 16 bytes of allocated memory into a UDT", "body": "<p>You cannot 'cast' the memory to type <code>Object</code>. It would violate strict aliasing rule at the bare minimum, and potentially (depending of <code>Object</code>) violate it start of lifetime as well, and lead to undefined behavior.</p>\n\n<p>Instead, you want to use <a href=\"https://en.cppreference.com/w/cpp/language/new#Placement_new\" rel=\"nofollow noreferrer\">placement new</a> to properly construct the object in the allocated space. The code will look like this:</p>\n\n<pre><code>class Object{\n  // some code here\n}\n\nchar* c = new char[64];\nstatic_assert(sizeof(Object) &lt;= 64, \"Can't use allocated storage\");\nObject* p = new (c) Object(/* args */);\n</code></pre>\n"}], "owner": {"reputation": 1130, "user_id": 3702643, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4f61562dc120ef93ca459f241a028f0b?s=128&d=identicon&r=PG&f=1", "display_name": "user3702643", "link": "https://stackoverflow.com/users/3702643/user3702643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 54330894, "answer_count": 1, "score": -2, "last_activity_date": 1548258461, "creation_date": 1548257919, "last_edit_date": 1548258040, "question_id": 54330781, "link": "https://stackoverflow.com/questions/54330781/cast-first-16-bytes-of-allocated-memory-into-a-udt", "title": "Cast first 16 bytes of allocated memory into a UDT", "body": "<pre><code>class Object{\n  // some code here\n}\n\nchar* c = new char[64];\n</code></pre>\n\n<p>From what I understand from the code sample above, I have allocated 64 bytes of memory in the heap. So now I have a block of memory to work with.</p>\n\n<p>My question: is it possible to cast just the first 16 bytes into an Object* of the above allocated 64 bytes? If yes, how do I do it? If no, why?</p>\n"}, {"tags": ["c++", "syntax", "casting"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1548256977, "post_id": 54330444, "comment_id": 95478911, "body": "Most vexing parse or similar? Try <code>int*{}</code> instead."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 4, "creation_date": 1548256990, "post_id": 54330444, "comment_id": 95478921, "body": "why would you use <code>auto</code> when the only effect is that you need the cast? It does not answer the question, but if you write <code>int* foo = nullptr;</code> the &quot;problem&quot; does not exist"}, {"owner": {"reputation": 579, "user_id": 5606197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d40e14bdd6510c86266fa01b462f978e?s=128&d=identicon&r=PG&f=1", "display_name": "vlind", "link": "https://stackoverflow.com/users/5606197/vlind"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548257041, "post_id": 54330444, "comment_id": 95478949, "body": "@Someprogrammerdude I tried that with GCC 8.2, Clang 7.0 and the latest VC++, doesn&#39;t work either."}, {"owner": {"reputation": 579, "user_id": 5606197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d40e14bdd6510c86266fa01b462f978e?s=128&d=identicon&r=PG&f=1", "display_name": "vlind", "link": "https://stackoverflow.com/users/5606197/vlind"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1548257083, "post_id": 54330444, "comment_id": 95478980, "body": "@user463035818 Why I would want to do this is irrelevant to my question. I&#39;m wondering <i>why</i> it&#39;s not possible. I&#39;m not asking for good practices I&#39;m asking why is this illegal in the language."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548257147, "post_id": 54330444, "comment_id": 95479009, "body": "As I said, it does not answer the quesiton, but I disagree that it is irrelevant. You write &quot;The only way I could think off ..&quot; but the only way I can think of to write this is without <code>auto</code>. Are you trying to get rid of the first A in almost always auto ?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 3, "creation_date": 1548257238, "post_id": 54330444, "comment_id": 95479062, "body": "This has nothing to do with <code>auto</code>, the RHS in itself is invalid. <code>(int*) nullptr;</code> would work instead. <a href=\"https://wandbox.org/permlink/xRTCeGhjFAP80Z7O\" rel=\"nofollow noreferrer\">wandbox.org/permlink/xRTCeGhjFAP80Z7O</a>"}, {"owner": {"reputation": 579, "user_id": 5606197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d40e14bdd6510c86266fa01b462f978e?s=128&d=identicon&r=PG&f=1", "display_name": "vlind", "link": "https://stackoverflow.com/users/5606197/vlind"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548257302, "post_id": 54330444, "comment_id": 95479094, "body": "@user463035818 Quoting myself  The only way I could think off to get <i>this</i> to work was Again, I&#39;m asking about the syntax to get the first code piece in this question to compile. All this text is just an attempt to have a better formulated question than &quot;Why doesn&#39;t this work&quot;"}, {"owner": {"reputation": 616, "user_id": 8578679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CeZ5Z.png?s=128&g=1", "display_name": "Ruifeng Xie", "link": "https://stackoverflow.com/users/8578679/ruifeng-xie"}, "edited": false, "score": 0, "creation_date": 1548257310, "post_id": 54330444, "comment_id": 95479096, "body": "It occurred to me that <code>static_cast</code> should work in this case. Maybe the problem here is that you used a C style cast."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548257555, "post_id": 54330444, "comment_id": 95479225, "body": "<code>int* foo = nullptr;</code> is correct syntax that has the same effect, as your first line, not sure why you insist that it is not relevant. Of course, independent of that it is an interesting question to know why the line as you wrote it is wrong...."}, {"owner": {"reputation": 579, "user_id": 5606197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d40e14bdd6510c86266fa01b462f978e?s=128&d=identicon&r=PG&f=1", "display_name": "vlind", "link": "https://stackoverflow.com/users/5606197/vlind"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548257734, "post_id": 54330444, "comment_id": 95479318, "body": "@user463035818 My question clearly asks about initializing a variable deduced by the compiler via auto."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548257878, "post_id": 54330444, "comment_id": 95479410, "body": "but <code>auto</code> just deduces the exact type you write on the rhs. Afaik there is literally no difference between <code>auto foo = (int*)(nullptr);</code> and <code>int* foo = nullptr;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 579, "user_id": 5606197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d40e14bdd6510c86266fa01b462f978e?s=128&d=identicon&r=PG&f=1", "display_name": "vlind", "link": "https://stackoverflow.com/users/5606197/vlind"}, "edited": false, "score": 0, "creation_date": 1548262607, "post_id": 54330579, "comment_id": 95482084, "body": "This summed it up very well for me. Thank you. Thumbs up."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 8, "last_activity_date": 1548268191, "last_edit_date": 1548268191, "creation_date": 1548257334, "answer_id": 54330579, "question_id": 54330444, "link": "https://stackoverflow.com/questions/54330444/why-cant-i-initialize-an-auto-deduced-pointer-with-nullptr/54330579#54330579", "title": "Why can&#39;t I initialize an auto deduced pointer with nullptr?", "body": "<p><code>int*</code> is a <a href=\"https://stackoverflow.com/questions/13779273/in-the-standard-what-is-derived-declarator-type\">\"derived declarator type\"</a>(not a standard term, but useful for reasoning about this). A functional style cast notation (which is what <code>int(2)</code> is) can only contain a <a href=\"https://timsong-cpp.github.io/cppwp/n4659/expr.type.conv#1\" rel=\"nofollow noreferrer\"><em>\"A simple-type-specifier or typename-specifier\"</em></a>. A derived declarator type doesn't fall under either category.</p>\n\n<p>You have to either:</p>\n\n<ul>\n<li><p>write it out in the form of a C-style cast:</p>\n\n<pre><code>auto foo = (int*) nullptr;\n</code></pre></li>\n<li><p>or in the form of a C++-style cast:</p>\n\n<pre><code>auto foo = static_cast&lt;int*&gt;(nullptr);\n</code></pre></li>\n<li><p>or alias the pointer type:</p>\n\n<pre><code>using iptr = int*;\nauto foo = iptr(nullptr);\n</code></pre></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 579, "user_id": 5606197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d40e14bdd6510c86266fa01b462f978e?s=128&d=identicon&r=PG&f=1", "display_name": "vlind", "link": "https://stackoverflow.com/users/5606197/vlind"}, "edited": false, "score": 0, "creation_date": 1548262573, "post_id": 54330613, "comment_id": 95482065, "body": "Amazing answer as well, thank you. I really appreciate it."}], "tags": [], "owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "is_accepted": false, "score": 7, "last_activity_date": 1548257883, "last_edit_date": 1548257883, "creation_date": 1548257435, "answer_id": 54330613, "question_id": 54330444, "link": "https://stackoverflow.com/questions/54330444/why-cant-i-initialize-an-auto-deduced-pointer-with-nullptr/54330613#54330613", "title": "Why can&#39;t I initialize an auto deduced pointer with nullptr?", "body": "<p><code>int*(nullptr)</code> doesn't work because only <strong>single-word type name</strong> could be used in <a href=\"https://en.cppreference.com/w/cpp/language/explicit_cast\" rel=\"nofollow noreferrer\">functional cast expression</a>. Note that <code>int*</code> is not a single-word type name, while <code>int</code> is (and then <code>int(2)</code> works fine).</p>\n\n<blockquote>\n  <p>The functional cast expression consists of a simple type specifier or a typedef specifier (in other words, a single-word type name: <code>unsigned int(expression)</code> or <code>int*(expression)</code> are not valid), followed by a single expression in parentheses.</p>\n</blockquote>\n\n<p>As the workaround, you can use <code>typedef</code>,</p>\n\n<pre><code>typedef int* int_pointer;\nauto foo = int_pointer (nullptr);\n</code></pre>\n\n<p>or change it to c-style cast expression.</p>\n\n<pre><code>auto foo = (int*) nullptr;\n</code></pre>\n"}], "owner": {"reputation": 579, "user_id": 5606197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d40e14bdd6510c86266fa01b462f978e?s=128&d=identicon&r=PG&f=1", "display_name": "vlind", "link": "https://stackoverflow.com/users/5606197/vlind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 54330579, "answer_count": 2, "score": 0, "last_activity_date": 1548268191, "creation_date": 1548256853, "last_edit_date": 1548260604, "question_id": 54330444, "link": "https://stackoverflow.com/questions/54330444/why-cant-i-initialize-an-auto-deduced-pointer-with-nullptr", "title": "Why can&#39;t I initialize an auto deduced pointer with nullptr?", "body": "<p>I was trying to do something similar to this:</p>\n\n<pre><code>auto foo = int*(nullptr);\n</code></pre>\n\n<p>Which with VC++ doesn't compile with the error message: </p>\n\n<blockquote>\n  <p>Type name is not allowed</p>\n</blockquote>\n\n<p>And with GCC 8.2 doesn't compile with:</p>\n\n<blockquote>\n  <p>Expected primary expression before 'int'</p>\n</blockquote>\n\n<p>I was really curious as to why this appears to be an illegal syntax. In my mind it should be fine since literals can be initialized like this.</p>\n\n<pre><code>auto foo = int(2);\n</code></pre>\n\n<p>The only way I could think off to get this to work was to either make a type alias or do this:</p>\n\n<pre><code>auto foo = std::add_pointer_t&lt;int&gt;(nullptr);\n</code></pre>\n\n<p>I tried googling for this but frankly I don't even know how to properly formulate this question since my standardese is weak. Any insight would be appreciated!</p>\n"}, {"tags": ["c++", "string", "char", "add"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 3, "creation_date": 1548256575, "post_id": 54330309, "comment_id": 95478680, "body": "Please include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> with your post so that potential answerers can identify and diagnose the problem you are having"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10956529, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-46pOqH2-h0s/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPQK73REotqZaYT3lqdjVowOCEPiA/mo/photo.jpg?sz=128", "display_name": "Robin Widegren", "link": "https://stackoverflow.com/users/10956529/robin-widegren"}, "is_accepted": false, "score": 0, "last_activity_date": 1548293919, "last_edit_date": 1548293919, "creation_date": 1548256780, "answer_id": 54330426, "question_id": 54330309, "link": "https://stackoverflow.com/questions/54330309/adding-char-which-is-a-math-operator-to-random-string/54330426#54330426", "title": "Adding char which is a math operator to random string", "body": "<p>From the code you provided, I see an issue that would cause the last character to not be printed. This is because you are only printing <code>tmp</code> when the next character is a space. So \"12 3 +\" would print \"12\", \"3\". Then <code>tmp</code> contains the value \"+\" since its never printed nor cleared, but is never printed. If your input string is \"12 3 + \" (notice the space) the '+' char would be printed too.</p>\n\n<p>This can be solved with printing and clearing <code>tmp</code> after the loop is done if <code>tmp</code> still contains any data.</p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 0, "last_activity_date": 1548257701, "last_edit_date": 1548257701, "creation_date": 1548256805, "answer_id": 54330432, "question_id": 54330309, "link": "https://stackoverflow.com/questions/54330309/adding-char-which-is-a-math-operator-to-random-string/54330432#54330432", "title": "Adding char which is a math operator to random string", "body": "<p>Your loop will never display the last token of the string unless the string ends in a space.  When you have <code>\"12 3 +\"</code> you read in the <code>12</code> see a space, print the <code>12</code> and clear the string.  You do the same thing for <code>3</code>.  Then you get <code>+</code> but since that is the last character in the string you never run the <code>else</code> part of the if statement to print it out. You can fix this a few ways.  You can check if <code>temp</code> is not empty after the loop and if it is not then handle that.  You can rework your logic in the loop to handle when you are on the last character and it is not a space. You could add a space to the end of the input so it will end with a space and the loop works as is.</p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 1, "last_activity_date": 1548256812, "creation_date": 1548256812, "answer_id": 54330434, "question_id": 54330309, "link": "https://stackoverflow.com/questions/54330309/adding-char-which-is-a-math-operator-to-random-string/54330434#54330434", "title": "Adding char which is a math operator to random string", "body": "<p>Issue is that <code>+</code> is your last character, so you won't go in else block for it.</p>\n\n<p><code>std::cout</code> <code>temp</code> after the loop would show your missing character:</p>\n\n<p><a href=\"https://ideone.com/AYCMGG\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 45, "user_id": 10788295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65de477efdae0834e5a44ee3a7ebe9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Rdomi", "link": "https://stackoverflow.com/users/10788295/rdomi"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "closed_date": 1548265702, "accepted_answer_id": 54330434, "answer_count": 3, "score": -3, "last_activity_date": 1548293919, "creation_date": 1548256429, "question_id": 54330309, "link": "https://stackoverflow.com/questions/54330309/adding-char-which-is-a-math-operator-to-random-string", "closed_reason": "Needs details or clarity", "title": "Adding char which is a math operator to random string", "body": "<p>I am trying to add \"+\", \"-\", \"*\" etc. to a string but it doesn't work.</p>\n\n<p>Lets say I have string \"12 3 +\" Then I use <code>string tmp</code> to get values between spaces like \"12\" \"3\" \"+\". my <code>cout</code> prints \"12\" and \"3\", but \"+\" is missing</p>\n\n<pre><code>int ONP() {\n\n    string wyrazenie;\n    getline(cin, wyrazenie);\n\n    string tmp;\n\n    for (int i = 0; i &lt; wyrazenie.length(); ++i) {\n\n        if (!isspace(wyrazenie[i])) {\n            tmp += wyrazenie[i];\n\n        } else {\n            cout &lt;&lt; tmp &lt;&lt; endl;\n            SOME CODE.....\n            tmp.clear();\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "c++11", "asynchronous"], "answers": [{"comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1548256972, "post_id": 54330320, "comment_id": 95478907, "body": "For completeness, since C++14, you can also effectively &quot;rename&quot; captures: these are &quot;captures with initialisers&quot;, and the initialiser can be a struct member."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1548257106, "post_id": 54330320, "comment_id": 95478988, "body": "@GemTaylor that is true, I will add it for completness."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 1, "last_activity_date": 1548257151, "last_edit_date": 1548257151, "creation_date": 1548256462, "answer_id": 54330320, "question_id": 54330291, "link": "https://stackoverflow.com/questions/54330291/how-to-pass-struct-elements-to-asynchronous-threads/54330320#54330320", "title": "How to pass struct elements to asynchronous threads?", "body": "<p>What you are trying to do is to capture a field in the struct in lambda. This is not possible, you can only capture the whole struct.</p>\n\n<p>It has nothing to do with <code>std::launch</code>, it's a basic property of lambda closure.</p>\n\n<p>In C++14, you can have captures with initializers, which might be what you want:</p>\n\n<pre><code> auto lam = [ten = ex.ten]...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 956, "user_id": 6449949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a920ba06a595d7137a076ab1de7425?s=128&d=identicon&r=PG&f=1", "display_name": "paler123", "link": "https://stackoverflow.com/users/6449949/paler123"}, "is_accepted": true, "score": 3, "last_activity_date": 1548268548, "last_edit_date": 1548268548, "creation_date": 1548256962, "answer_id": 54330480, "question_id": 54330291, "link": "https://stackoverflow.com/questions/54330291/how-to-pass-struct-elements-to-asynchronous-threads/54330480#54330480", "title": "How to pass struct elements to asynchronous threads?", "body": "<p>You can't pass single struct field that way into lambda in C++. The error you get is not connected to <code>std::launch</code> or communicating between threads. What you can do instead is:  </p>\n\n<p>C++11 - copy field into local variable and capture that variable: </p>\n\n<pre><code>auto ten = ex.ten;\nthreads[s] = async(std::launch::async,\n                               [ten,\n                               someString] {\n     threadFunction(ten, someString);})\n</code></pre>\n\n<p>C++14 and later - initialize variable in capture list:</p>\n\n<pre><code>threads[s] = async(std::launch::async,\n                               [ten = ex.ten,\n                               someString] {threadFunction(ten, someString);})\n</code></pre>\n"}], "owner": {"reputation": 420, "user_id": 1762311, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e0f07ea8b740559778f1f276ff209333?s=128&d=identicon&r=PG", "display_name": "Simon Klaver", "link": "https://stackoverflow.com/users/1762311/simon-klaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 54330480, "answer_count": 2, "score": 0, "last_activity_date": 1548268548, "creation_date": 1548256370, "question_id": 54330291, "link": "https://stackoverflow.com/questions/54330291/how-to-pass-struct-elements-to-asynchronous-threads", "title": "How to pass struct elements to asynchronous threads?", "body": "<p>I am trying to launch a function threaded using <code>launch::async</code>. However, I noticed that this doesn't work when passing struct elements as parameter:<br>\nThe code</p>\n\n<pre><code>#include &lt;future&gt;\n#include &lt;vector&gt;\n#include &lt;thread&gt;\n\nstruct example { int ten; };\n\nvoid threadFunction(int number, std::string hi) { \n   printf(\"%s Your number is %d\\n\", hi.c_str(), number + 1);\n}\n\nint main() {\n   example ex;\n   ex.ten = 9;\n   std::string someString = \"Hi there!\";\n   std::vector&lt; std::future&lt; void &gt; &gt; threads(5);\n   for (uint16_t s = 0; s &lt; 5; s += 1) {\n      threads[s] = async(std::launch::async,\n                                   [ex.ten,\n                                   someString] {\n         threadFunction(ex.ten, someString);\n      });\n   }\n}\n</code></pre>\n\n<p>gives the following errors:</p>\n\n<pre><code>file.cpp: In function \u2018int main()\u2019:\nfile.cpp:25:39: error: expected \u2018,\u2019 before \u2018.\u2019 token\n                                    [ex.ten,\n                                       ^\nfile.cpp:25:39: error: expected identifier before \u2018.\u2019 token\nfile.cpp:25:43: error: expected \u2018]\u2019 before \u2018,\u2019 token\n                                    [ex.ten,\n                                           ^\nfile.cpp: In lambda function:\nfile.cpp:25:43: error: expected \u2018{\u2019 before \u2018,\u2019 token\nfile.cpp: In function \u2018int main()\u2019:\nfile.cpp:26:46: error: expected \u2018)\u2019 before \u2018]\u2019 token\n                                    someString] {\n                                              ^\nfile.cpp:28:8: error: expected primary-expression before \u2018)\u2019 token\n       });\n</code></pre>\n\n<p>When replacing <code>ex.ten</code> with some other variable <code>ten</code> it does work.  </p>\n\n<p>So my questions are:<br>\n   1. Why does launch::async not work with struct elements?<br>\n   2. Is there a way to do it in a more elegant way than to make a variable for each element in the struct and pass those variables instead? (such as <code>int ten = ex.ten;</code> etc)</p>\n"}, {"tags": ["c++", "opencv", "interpolation", "subpixel", "bilinear-interpolation"], "answers": [{"tags": [], "owner": {"reputation": 528, "user_id": 8110010, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1enq4.jpg?s=128&g=1", "display_name": "Finley", "link": "https://stackoverflow.com/users/8110010/finley"}, "is_accepted": false, "score": 0, "last_activity_date": 1548316340, "last_edit_date": 1548316340, "creation_date": 1548306543, "answer_id": 54339717, "question_id": 54330212, "link": "https://stackoverflow.com/questions/54330212/interpolate-pixel-rectangle-that-are-out-of-image-in-opencv/54339717#54339717", "title": "Interpolate pixel rectangle that are out of image in OpenCV", "body": "<p>Basically, <code>adjustRect</code> should be considered together with codes in <a href=\"https://github.com/opencv/opencv/blob/808ba552c532408bddd5fe51784cf4209296448a/modules/imgproc/src/samplers.cpp#L184-L214\" rel=\"nofollow noreferrer\"><code>getRectSubPix_Cn_</code></a>. OpenCV adopts different interpolation strategies when pixel rectangle is out of image.<br>\nIt will dereference properly when indexing pixels because:</p>\n\n<pre><code>s0 = src[r.x*cn + c]*b1 + src2[r.x*cn + c]*b2; .\n</code></pre>\n\n<p>For my case, this interpolation scheme is depicted in following figure:\n<a href=\"https://i.stack.imgur.com/AkQKv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AkQKv.png\" alt=\"enter image description here\"></a>\n This post waits to be updated because I think there should be more details to be discovered. </p>\n"}], "owner": {"reputation": 528, "user_id": 8110010, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1enq4.jpg?s=128&g=1", "display_name": "Finley", "link": "https://stackoverflow.com/users/8110010/finley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548316340, "creation_date": 1548256106, "last_edit_date": 1548312479, "question_id": 54330212, "link": "https://stackoverflow.com/questions/54330212/interpolate-pixel-rectangle-that-are-out-of-image-in-opencv", "title": "Interpolate pixel rectangle that are out of image in OpenCV", "body": "<p>I am recently reading the code of <a href=\"https://docs.opencv.org/3.4/da/d54/group__imgproc__transform.html#ga77576d06075c1a4b6ba1a608850cd614\" rel=\"nofollow noreferrer\"><code>cv::getRectSubPix</code></a> in OpenCV, which involves dealing rectangles out of image. Concretely, I am stuck on function <a href=\"https://github.com/opencv/opencv/blob/808ba552c532408bddd5fe51784cf4209296448a/modules/imgproc/src/samplers.cpp#L52-L102\" rel=\"nofollow noreferrer\"><code>adjustRect</code></a> that is used to reshape the out-of-bounds rectangular window.<br>\nAccording to the code of <code>adjustRect</code>, top left corner <code>p=(x,y)</code> of rectangle will shift to <code>p'=(-x,-y)</code>(blue frame) if <code>p</code>(red frame) is as follows:\n<a href=\"https://i.stack.imgur.com/Spboc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Spboc.png\" alt=\"enter image description here\"></a>\nWhat puzzled me was the last line in <code>adjustRect</code>:</p>\n\n<pre><code>return src - rect.x*pix_size;\n</code></pre>\n\n<p>why <code>src</code> is shifted in <code>x</code> direction only? To my understanding, proper code should be:</p>\n\n<pre><code>return src - rect.x*pix_size-rect.y*src_step\n</code></pre>\n\n<p>Besides, I think <code>src</code> will point to undefined memory if both <code>x</code> and <code>y</code> are negative. Can anyone help?</p>\n"}, {"tags": ["c++", "lambda", "c++17", "constexpr"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1548255296, "post_id": 54329879, "comment_id": 95477923, "body": "If you&#39;re not capturing the string by value, then what is meant to stop a user from passing a string that <i>isn&#39;t</i> a literal, one whose lifetime may end before the callback gets called?"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1548255485, "post_id": 54329879, "comment_id": 95478053, "body": "Could you possibly change <code>StatisticsFunc</code> to <code>std::function&lt;double(const std::vector&lt;double&gt;&amp;)&gt;</code>?"}, {"owner": {"reputation": 956, "user_id": 6449949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a920ba06a595d7137a076ab1de7425?s=128&d=identicon&r=PG&f=1", "display_name": "paler123", "link": "https://stackoverflow.com/users/6449949/paler123"}, "edited": false, "score": 0, "creation_date": 1548256336, "post_id": 54329879, "comment_id": 95478539, "body": "Template seems like the way to go, I doubt that it is doable with some constexpr cleverness."}, {"owner": {"reputation": 548, "user_id": 7432927, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/875c26e9002856e5184f08012753f279?s=128&d=identicon&r=PG&f=1", "display_name": "Przemys\u0142aw Czechowski", "link": "https://stackoverflow.com/users/7432927/przemys%c5%82aw-czechowski"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1548257462, "post_id": 54329879, "comment_id": 95479178, "body": "@aschepler this is a part of the third party API, I cannot change it."}, {"owner": {"reputation": 548, "user_id": 7432927, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/875c26e9002856e5184f08012753f279?s=128&d=identicon&r=PG&f=1", "display_name": "Przemys\u0142aw Czechowski", "link": "https://stackoverflow.com/users/7432927/przemys%c5%82aw-czechowski"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1548257645, "post_id": 54329879, "comment_id": 95479273, "body": "@NicolBolas well, the string is passed to <code>constexpr</code> function, so I&#39;d like to enforce it being known at compile time."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1548257748, "post_id": 54329879, "comment_id": 95479335, "body": "@Przemys\u0142awCzechowski: <code>constexpr</code> functions do not <i>have</i> to be executed at compile-time."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1548257857, "post_id": 54329879, "comment_id": 95479398, "body": "Are you really taking a pointer to a pointer to a function? I feel like there&#39;s an extra <code>*</code> - I went ahead and removed it"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1548258398, "post_id": 54329879, "comment_id": 95479722, "body": "Are there any reason for using lambas.  What about old school i.e. something like  obj1-&gt;ComputeStatistics(<a href=\"https://en.cppreference.com/w/cpp/utility/functional/bind\" rel=\"nofollow noreferrer\">std::bind</a>(histogram,&quot;obj1&quot;,_1))"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1548258485, "post_id": 54329879, "comment_id": 95479769, "body": "@VictorGubin Need to end up with a function pointer, so that won&#39;t work."}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1548259423, "post_id": 54329879, "comment_id": 95480322, "body": "Also an option, extend the libraryClass and add a field object_name_ and generic method like - <code>double HistogramStatistics() { return ComputeStatistics([object_name_](const auto&amp; v) {return histogram(object_name_, v); }</code>. Or create a facade class like HistorgramStatisic which took object and it&#39;s name as a constructor parameter."}], "answers": [{"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 3, "last_activity_date": 1548258454, "creation_date": 1548258454, "answer_id": 54330920, "question_id": 54329879, "link": "https://stackoverflow.com/questions/54329879/constexpr-parametrized-function-pointer/54330920#54330920", "title": "constexpr parametrized function pointer", "body": "<p>Sort of.</p>\n\n<p>This:</p>\n\n<pre><code>obj1-&gt;ComputeStatistics(getHistogramLambda(\"obj1\"));\n</code></pre>\n\n<p>Won't work for the reasons you point out - you need to capture state. And then, we can't write this:</p>\n\n<pre><code>obj1-&gt;ComputeStatistics(getHistogramLambda&lt;\"obj1\"&gt;());\n</code></pre>\n\n<p>Because while we can have template parameters of type <code>const char*</code> we can't have them bind to string literals. You <em>could</em> do it this way:</p>\n\n<pre><code>template &lt;const char* name&gt;\nconstexpr auto getHistogramLambda() {\n    return [](const auto&amp; v) {return histogram(name, v);};\n}\n\nconst char p[] = \"obj1\";\nobj1-&gt;ComputeStatistics(getHistogramLambda&lt;p&gt;());\n</code></pre>\n\n<p>Which is pretty awkward because you need to introduce the extra variable for each invocation. In C++20, we'll be able to write a class type that has as its template paramater a fixed string, which will allow <code>getHistogramLambda&lt;\"obj1\"&gt;</code> to work, just in a slightly different way.</p>\n\n<p>Until then, the best way currently is probably to use a UDL to capture the individual characters as template parameters of some class type:</p>\n\n<pre><code>template &lt;char... Cs&gt;\nconstexpr auto getHistogramLambda(X&lt;Cs...&gt;) {\n    static constexpr char name[] = {Cs..., '\\0'};\n    return [](const auto&amp; v) { return histogram(name, v);};\n}\n\n\nobj-&gt;ComputeStatistic(getHistogramLambda(\"obj1\"_udl));\n</code></pre>\n\n<p>The intent here is that <code>\"obj\"_udl</code> is an object of type <code>X&lt;'o', 'b', 'j', '1'&gt;</code> - and then we reconstruct the string within the body of the function template in a way that still does not require capture.</p>\n\n<p>Is this worth it to avoid the duplication? Maybe. </p>\n"}, {"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": -1, "last_activity_date": 1548265031, "creation_date": 1548265031, "answer_id": 54332758, "question_id": 54329879, "link": "https://stackoverflow.com/questions/54329879/constexpr-parametrized-function-pointer/54332758#54332758", "title": "constexpr parametrized function pointer", "body": "<p>Not sure to understand what do you exactly need but... what about declaring a global <code>constexpr</code> array of <code>char const</code> pointers</p>\n\n<pre><code>constexpr std::array&lt;char const *, 3u&gt; arrStr {{\"obj0\", \"obj1\", \"obj2\"}};\n</code></pre>\n\n<p>then receiving in <code>getHistogramLambda()</code> the index of the required string as template parameter?</p>\n\n<pre><code>template &lt;std::size_t N&gt;\nconstexpr auto getHistogramLambda () {\n    return [](const auto&amp; v) {return histogram(arrStr.at(N), v);};\n}\n</code></pre>\n\n<p>This way you can call <code>ComputeStatistic()</code> as follows</p>\n\n<pre><code>obj1-&gt;ComputeStatistics(getHistogramLambda&lt;1u&gt;());\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 548, "user_id": 7432927, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/875c26e9002856e5184f08012753f279?s=128&d=identicon&r=PG&f=1", "display_name": "Przemys\u0142aw Czechowski", "link": "https://stackoverflow.com/users/7432927/przemys%c5%82aw-czechowski"}, "edited": false, "score": 0, "creation_date": 1548344424, "post_id": 54347751, "comment_id": 95515924, "body": "well, if we allow using macros, we can as well do: <code>#define HISTOGRAM_LAMBDA(X)  [] (const auto&amp; v) { return histogram(X, v);};</code> the idea of the question is to acheive it without macros, in some &quot;modern&quot; <code>constexpr</code> way. But thanks for your contribution."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 548, "user_id": 7432927, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/875c26e9002856e5184f08012753f279?s=128&d=identicon&r=PG&f=1", "display_name": "Przemys\u0142aw Czechowski", "link": "https://stackoverflow.com/users/7432927/przemys%c5%82aw-czechowski"}, "edited": false, "score": 0, "creation_date": 1548345177, "post_id": 54347751, "comment_id": 95516471, "body": "@Przemys\u0142awCzechowski Those... aren&#39;t equivalent. This is a general solution for encasing a value in a type, that is a very specific solution to this problem that just saves you a little bit of typing."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 1, "last_activity_date": 1548336407, "creation_date": 1548336407, "answer_id": 54347751, "question_id": 54329879, "link": "https://stackoverflow.com/questions/54329879/constexpr-parametrized-function-pointer/54347751#54347751", "title": "constexpr parametrized function pointer", "body": "<p>Different answer, courtesy of <a href=\"https://mpark.github.io/programming/2017/05/26/constexpr-function-parameters/\" rel=\"nofollow noreferrer\">Michael Park</a>. We can encode the value we want in a type - not passing the string literal we want as a function argument or a template argument, but as an actual type - and that way we don't need to capture it:</p>\n\n<pre><code>#define CONSTANT(...) \\\n  union { static constexpr auto value() { return __VA_ARGS__; } }\n#define CONSTANT_VALUE(...) \\\n  [] { using R = CONSTANT(__VA_ARGS__); return R{}; }()\n\n\ntemplate &lt;typename X&gt;\nconstexpr auto getHistogramLambda(X) {\n    return [](const auto&amp; v) { return histogram(X::value(), v);};\n}\n\nobj-&gt;ComputeStatistic(getHistogramLambda(CONSTANT_VALUE(\"obj1\")));\nobj-&gt;ComputeStatistic(getHistogramLambda(CONSTANT_VALUE(\"obj2\")));\n</code></pre>\n\n<p>Not sure this is better than the UDL approach in this particular case, but it's an interesting technique for sure.</p>\n"}], "owner": {"reputation": 548, "user_id": 7432927, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/875c26e9002856e5184f08012753f279?s=128&d=identicon&r=PG&f=1", "display_name": "Przemys\u0142aw Czechowski", "link": "https://stackoverflow.com/users/7432927/przemys%c5%82aw-czechowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 54330920, "answer_count": 3, "score": 8, "last_activity_date": 1548336407, "creation_date": 1548255011, "last_edit_date": 1548257919, "question_id": 54329879, "link": "https://stackoverflow.com/questions/54329879/constexpr-parametrized-function-pointer", "title": "constexpr parametrized function pointer", "body": "<p>I have the following third-party API:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>using StatisticsFunc = double (*)(const std::vector&lt;double&gt; &amp;)\nlibraryClass::ComputeStatistics(StatisticsFunc sf);\n</code></pre>\n\n<p>Which I'm using like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>obj1-&gt;ComputeStatistics([](const auto&amp; v) {return histogram(\"obj1\", v);};\nobj2-&gt;ComputeStatistics([](const auto&amp; v) {return histogram(\"obj2\", v);};\n</code></pre>\n\n<p>But all those lambdas are just repeated code. I'd rather have it like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>obj1-&gt;ComputeStatistics(getHistogramLambda(\"obj1\"));\n</code></pre>\n\n<p>So I need to define:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>constexpr auto getHistogramLambda(const char* name) {\n    return [](const auto&amp; v) {return histogram(name, v);};\n}\n</code></pre>\n\n<p>But it won't work, because <code>name</code> is not captured. Neither will this work:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>constexpr auto getHistogramLambda(const char* name) {\n    return [name](const auto&amp; v) {return histogram(name, v);};\n}\n</code></pre>\n\n<p>Because capturing lambda is not stateless anymore and cannot be cast to function pointer.</p>\n\n<p>Ofc one can do it as a macro, but I want a modern C++ 17 solution. </p>\n\n<p>Passing string as template argument seems an option as well:\n<a href=\"https://stackoverflow.com/a/28209546/7432927\">https://stackoverflow.com/a/28209546/7432927</a> , but I'm curious if there's a <code>constexpr</code> way of doing it. </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 3979, "user_id": 2641587, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mLMnS.jpg?s=128&g=1", "display_name": "Dmytro Prylipko", "link": "https://stackoverflow.com/users/2641587/dmytro-prylipko"}, "edited": false, "score": 0, "creation_date": 1548255146, "post_id": 54329828, "comment_id": 95477821, "body": "Add <code>#include &quot;Log.h&quot;</code> into Log.cpp"}, {"owner": {"reputation": 16174, "user_id": 1934903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/RSNco.png?s=128&g=1", "display_name": "Chris Schmitz", "link": "https://stackoverflow.com/users/1934903/chris-schmitz"}, "reply_to_user": {"reputation": 3979, "user_id": 2641587, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mLMnS.jpg?s=128&g=1", "display_name": "Dmytro Prylipko", "link": "https://stackoverflow.com/users/2641587/dmytro-prylipko"}, "edited": false, "score": 0, "creation_date": 1548255159, "post_id": 54329828, "comment_id": 95477830, "body": "@matthieu-brucher I&#39;m reading through this answer and mine may be a duplicate, but one of the issues I mentioned is that I have been searching through and reading possible solutions but I don&#39;t really understand what I&#39;m reading in relation to the issue I&#39;m hitting now. These answers are def informative, but I&#39;ve said I&#39;m already running into problems scaling the walls of information I&#39;m finding. In the end, even if I read through all of these answers, but I still can&#39;t figure out how it applies to my situation they&#39;re not really helpful."}, {"owner": {"reputation": 16174, "user_id": 1934903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/RSNco.png?s=128&g=1", "display_name": "Chris Schmitz", "link": "https://stackoverflow.com/users/1934903/chris-schmitz"}, "reply_to_user": {"reputation": 3979, "user_id": 2641587, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mLMnS.jpg?s=128&g=1", "display_name": "Dmytro Prylipko", "link": "https://stackoverflow.com/users/2641587/dmytro-prylipko"}, "edited": false, "score": 0, "creation_date": 1548255363, "post_id": 54329828, "comment_id": 95477957, "body": "@matthieu-brucher you glanced at my question and closed it without actually reading it. The problem that I&#39;m running into isn&#39;t just the error I&#39;m getting, it&#39;s that I can&#39;t seem to figure out what within the wall of text I&#39;ve found already and that you&#39;ve pointed me to actually applies to my problem. You&#39;re closing my question b/c you&#39;re not seeing the forest from the trees."}, {"owner": {"reputation": 16174, "user_id": 1934903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/RSNco.png?s=128&g=1", "display_name": "Chris Schmitz", "link": "https://stackoverflow.com/users/1934903/chris-schmitz"}, "reply_to_user": {"reputation": 3979, "user_id": 2641587, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mLMnS.jpg?s=128&g=1", "display_name": "Dmytro Prylipko", "link": "https://stackoverflow.com/users/2641587/dmytro-prylipko"}, "edited": false, "score": 0, "creation_date": 1548255465, "post_id": 54329828, "comment_id": 95478032, "body": "@DmytroPrylipko I tried adding an include for the log header file into my Log.cpp file and I get a <code>Redefinition of &#39;Log&#39;</code> error. Is my declaration in the header file wrong?"}, {"owner": {"reputation": 3979, "user_id": 2641587, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mLMnS.jpg?s=128&g=1", "display_name": "Dmytro Prylipko", "link": "https://stackoverflow.com/users/2641587/dmytro-prylipko"}, "edited": false, "score": 5, "creation_date": 1548255693, "post_id": 54329828, "comment_id": 95478169, "body": "Wait a second, why do you define the class again in the .cpp? The content of the .cpp file must be like <code>void Log::Error(const char* message)</code>, but instead you define the class again, now with implementation. See this: <a href=\"https://stackoverflow.com/questions/9579930/separating-class-code-into-a-header-and-cpp-file\" title=\"separating class code into a header and cpp file\">stackoverflow.com/questions/9579930/&hellip;</a>"}, {"owner": {"reputation": 16174, "user_id": 1934903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/RSNco.png?s=128&g=1", "display_name": "Chris Schmitz", "link": "https://stackoverflow.com/users/1934903/chris-schmitz"}, "edited": false, "score": 0, "creation_date": 1548258533, "post_id": 54329828, "comment_id": 95479798, "body": "You&#39;re right, I am trying something I didn&#39;t learn yet. I was trying to expand a bit past what I&#39;d been learning already to see if I could figure it out, and I was almost there but was stuck. I did get a helpful point that did get me unstuck, and it didn&#39;t require cutting me down for trying to learn. It&#39;s disappointing that a newbie asking for help on what is a simple error for you and other experienced devs is met with negativity from more experienced developers. What good are you doing for making me feel bad for being new to cpp??"}, {"owner": {"reputation": 16174, "user_id": 1934903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/RSNco.png?s=128&g=1", "display_name": "Chris Schmitz", "link": "https://stackoverflow.com/users/1934903/chris-schmitz"}, "edited": false, "score": 0, "creation_date": 1548258877, "post_id": 54329828, "comment_id": 95479990, "body": "Yeah dude, I <i>did read the documentation</i> and while I understood some of it <i>I didn&#39;t understand how it applied to my specific issue</i>. Look at my answer to the question, I was close, I understood what was once I got a point in the right direction. Saying &quot;read the documentation&quot; as a stack overflow reply is a cop out because it assumes that the person didn&#39;t already try and also assumes that all documentation is written in a way that is clear to everyone and always yields epiphanies to every issue. Sometimes when you&#39;re new to something the documentation alone isn&#39;t the best answer."}], "answers": [{"tags": [], "owner": {"reputation": 16174, "user_id": 1934903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/RSNco.png?s=128&g=1", "display_name": "Chris Schmitz", "link": "https://stackoverflow.com/users/1934903/chris-schmitz"}, "is_accepted": false, "score": -1, "last_activity_date": 1548258255, "creation_date": 1548258255, "answer_id": 54330861, "question_id": 54329828, "link": "https://stackoverflow.com/questions/54329828/trying-to-understand-the-cpp-linker-error-for-class-methods-declared-in-header/54330861#54330861", "title": "Trying to understand the cpp linker error for class methods declared in header", "body": "<p>Thanks @DmytroPrylipko for the point int the right direction via the link to the stackoverflow question and answer: <a href=\"https://stackoverflow.com/questions/9579930/separating-class-code-into-a-header-and-cpp-file\">Separating class code into a header and cpp file</a></p>\n\n<p>After reading your comments and then looking for the answer it helped me realize that my hang up was from my Log.cpp not including the Log.h file I had defined and then the contents of my Log.cpp file re-defining the class. </p>\n\n<p>For anyone else who may run into this kind of issue, here's how I fixed my code. </p>\n\n<p>My main.cpp file stayed the same:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"Log.h\"\n\nint main() {\n\n    Log log;\n\n    log.SetLevel(Log::LevelError);\n    log.Warn(\"hello from main\");\n    log.Error(\"hello from main\");\n    log.Info(\"hello from main\");\n}\n</code></pre>\n\n<p>But I altered my Log.h file to include the private property in the base class definition:</p>\n\n<pre><code>#pragma once\n\nclass Log {\npublic: // variables\n    enum Level {\n        LevelError, LevelWarning, LevelInfo\n    };\nprivate: // variables \n    Level m_LogLevel = LevelWarning;\npublic: // methods\n    void SetLevel(Level level);\n    void Error(const char* message);\n    void Warn(const char* message);\n    void Info(const char* message);\n};\n</code></pre>\n\n<p>The part that hung me up conceptually was the new structure of Log.cpp. As Dmytro suggested, I added an include for the <code>Log.h</code> file into my <code>Log.cpp</code> file, but I forgot that this is a pre-processor statement that essentially copy/pastes the code from <code>Log.h</code> into <code>Log.cpp</code>, so the re-declaration error I was getting was because I was defining <code>class Log ...</code> twice in the object file; once from the header and once from the <code>Log.cpp</code>.</p>\n\n<p>Knowing that and seeing the syntax for adding methods to an existing class definition from the linked SO post, I updated my <code>Log.cpp</code> file to look like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"Log.h\"\n\n\nvoid Log::SetLevel(Level level){\n    m_LogLevel = level;\n}\n\nvoid Log::Error(const char* message){\n    if (m_LogLevel &gt;= LevelError)\n        std::cout &lt;&lt; \"[ERROR]: \" &lt;&lt; message &lt;&lt; std::endl;\n}\nvoid Log::Warn(const char* message){\n    if (m_LogLevel &gt;= LevelWarning)\n        std::cout &lt;&lt; \"[WARNING]: \" &lt;&lt; message &lt;&lt; std::endl;\n}\nvoid Log::Info(const char* message){\n    if (m_LogLevel &gt;= LevelInfo)\n        std::cout &lt;&lt; \"[Info]: \" &lt;&lt; message &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>So now my header file defines the class and the cpp file adds methods to it. In the tutorials I'm following I hadn't gotten to this syntax yet and I wasn't quite understanding documentation I was reading that has a lot of assumptions on what I already knew about cpp. </p>\n\n<p>Thanks again for the point. I'm unstuck now and and have a bit of a taste, for better and worse, of what the cpp community is like. </p>\n"}], "owner": {"reputation": 16174, "user_id": 1934903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/RSNco.png?s=128&g=1", "display_name": "Chris Schmitz", "link": "https://stackoverflow.com/users/1934903/chris-schmitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1548258255, "creation_date": 1548254831, "last_edit_date": 1548255587, "question_id": 54329828, "link": "https://stackoverflow.com/questions/54329828/trying-to-understand-the-cpp-linker-error-for-class-methods-declared-in-header", "title": "Trying to understand the cpp linker error for class methods declared in header", "body": "<p>I'm working through an intro video series on cpp and I'm running into a linker error, but I'm not sure why I'm hitting it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/eWo9H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eWo9H.png\" alt=\"the error\"></a></p>\n\n<p>I'm def still green to reading complier and linker errors so this may be wrong, but it seems like the linker is telling me that I haven't defined the methods that I'm calling in my main function. It makes me suspect that I have something wrong in my header file. Here's the current state of my files:</p>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include \"Log.h\"\n\nint main() {\n\n    Log log;\n\n    log.SetLevel(Log::LevelError);\n    log.Warn(\"hello from main\");\n    log.Error(\"hello from main\");\n    log.Info(\"hello from main\");\n}\n</code></pre>\n\n<p><strong>Log.h</strong></p>\n\n<pre><code>#pragma once\n\nclass Log {\npublic: // variables\n    enum Level {\n        LevelError, LevelWarning, LevelInfo\n    };\npublic: // methods\n    void SetLevel(Level level);\n    void Error(const char* message);\n    void Warn(const char* message);\n    void Info(const char* message);\n};\n</code></pre>\n\n<p><strong>Log.cpp</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass Log {\npublic: // variables\n    enum Level {\n        LevelError, LevelWarning, LevelInfo\n    };\n\nprivate: // variables\n    Level m_LogLevel = LevelWarning;\n\npublic: // methods\n    void SetLevel(Level level){\n        m_LogLevel = level;\n    }\n\n    void Error(const char* message){\n        if (m_LogLevel &gt;= LevelError)\n            std::cout &lt;&lt; \"[ERROR]: \" &lt;&lt; message &lt;&lt; std::endl;\n    }\n    void Warn(const char* message){\n        if (m_LogLevel &gt;= LevelWarning)\n            std::cout &lt;&lt; \"[WARNING]: \" &lt;&lt; message &lt;&lt; std::endl;\n    }\n    void Info(const char* message){\n        if (m_LogLevel &gt;= LevelInfo)\n            std::cout &lt;&lt; \"[Info]: \" &lt;&lt; message &lt;&lt; std::endl;\n    }\n};\n</code></pre>\n\n<p>In the video series I'm watching the instructor defined the log class within the main.cpp file, but I wanted to try to start organizing my files by moving the log class out to it's own file and pulling it in via a header file. </p>\n\n<p>I tried to figure out what I'm doing wrong by searching around on the internet, but whether it's because I can't find the exact problem I'm hitting or I'm just still to green to cpp to see the solution in the answers I'm finding I can't seem to figure it out. </p>\n\n<p>Can someone point me in the right direction, please??</p>\n"}, {"tags": ["c++", "function", "recursion"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1548253845, "post_id": 54329475, "comment_id": 95476909, "body": "Invalid <a href=\"https://en.cppreference.com/w/cpp/language/main_function\" rel=\"nofollow noreferrer\"><code>main</code> function</a>. And infinite recursion. Please <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>. And enable verbose warnings and treat them as errors."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 2, "creation_date": 1548253852, "post_id": 54329475, "comment_id": 95476915, "body": "side note: you&#39;re not allowed to define <code>main</code> with no return type. =&gt; <code>int main() {</code>"}], "answers": [{"comments": [{"owner": {"reputation": 332, "user_id": 4196087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99bfd69164d18d75fcf3f6807cf8d96a?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/4196087/ben"}, "edited": false, "score": 1, "creation_date": 1548253970, "post_id": 54329501, "comment_id": 95477007, "body": "if(n&lt;1) return 1; would be better"}, {"owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "edited": false, "score": 1, "creation_date": 1548254207, "post_id": 54329501, "comment_id": 95477194, "body": "that&#39;s exactly what i thought but maybe he wants to go for larger numbers?"}, {"owner": {"reputation": 1, "user_id": 10802579, "user_type": "registered", "profile_image": "https://graph.facebook.com/960482620827753/picture?type=large", "display_name": "Muti Ur Rehman", "link": "https://stackoverflow.com/users/10802579/muti-ur-rehman"}, "edited": false, "score": 0, "creation_date": 1548255038, "post_id": 54329501, "comment_id": 95477745, "body": "i&#39;m feeling like an idiot right now it was in front of my eyes how can i make a mistake this obvious and thanks for both of u for pointing it out"}], "tags": [], "owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "is_accepted": true, "score": 7, "last_activity_date": 1548254139, "last_edit_date": 1548254139, "creation_date": 1548253804, "answer_id": 54329501, "question_id": 54329475, "link": "https://stackoverflow.com/questions/54329475/when-run-the-programme-it-says-programme-exe-stopped-working/54329501#54329501", "title": "When run the programme it says programme.exe stopped working", "body": "<p>you need a stop condition for your factorial recursive function </p>\n\n<pre><code>double factorial (double n)\n{   if(n&lt;1) return 1;\n    return (n * factorial (n - 1));\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10802579, "user_type": "registered", "profile_image": "https://graph.facebook.com/960482620827753/picture?type=large", "display_name": "Muti Ur Rehman", "link": "https://stackoverflow.com/users/10802579/muti-ur-rehman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 54329501, "answer_count": 1, "score": -2, "last_activity_date": 1548255480, "creation_date": 1548253743, "last_edit_date": 1548254080, "question_id": 54329475, "link": "https://stackoverflow.com/questions/54329475/when-run-the-programme-it-says-programme-exe-stopped-working", "title": "When run the programme it says programme.exe stopped working", "body": "<p>My programme is pretty simple i'm making a recursive programme i want it to call it self again and again until the task is completed it compiles just fine but it always says that  \"programme.exe stopped working\" </p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\ndouble factorial (double);\nmain ()\n{\n    double n;\n    cin &gt;&gt; n;\n    cout &lt;&lt; factorial (n);\n}\ndouble factorial (double n)\n{\n    return (n * factorial (n - 1));\n}\n</code></pre>\n"}, {"tags": ["c++", "unreal-engine4"], "comments": [{"owner": {"reputation": 2565, "user_id": 4781312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lDEcJ.jpg?s=128&g=1", "display_name": "Asesh", "link": "https://stackoverflow.com/users/4781312/asesh"}, "edited": false, "score": 0, "creation_date": 1548255069, "post_id": 54329452, "comment_id": 95477765, "body": "Looks like the first argument to <code>SpawnActor</code> should be a function pointer whose return type is <code>* UClass</code> and doesn&#39;t take any agument. But the argument that you are providing doesn&#39;t match it&#39;s signature"}, {"owner": {"reputation": 25, "user_id": 10776146, "user_type": "registered", "profile_image": "https://graph.facebook.com/2058598044184047/picture?type=large", "display_name": "Laura", "link": "https://stackoverflow.com/users/10776146/laura"}, "reply_to_user": {"reputation": 2565, "user_id": 4781312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lDEcJ.jpg?s=128&g=1", "display_name": "Asesh", "link": "https://stackoverflow.com/users/4781312/asesh"}, "edited": false, "score": 0, "creation_date": 1548427525, "post_id": 54329452, "comment_id": 95548885, "body": "Yeah, I was just wondering what this signature with &quot;(__cdecl *)&quot; was meaning, thank you very much :) !"}], "answers": [{"comments": [{"owner": {"reputation": 2565, "user_id": 4781312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lDEcJ.jpg?s=128&g=1", "display_name": "Asesh", "link": "https://stackoverflow.com/users/4781312/asesh"}, "edited": false, "score": 0, "creation_date": 1548660894, "post_id": 54387608, "comment_id": 95605550, "body": "You statement doesn&#39;t answer his question. The problem is something else. Look at the comments"}, {"owner": {"reputation": 597, "user_id": 2092777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZbO0V.png?s=128&g=1", "display_name": "TheBrain", "link": "https://stackoverflow.com/users/2092777/thebrain"}, "reply_to_user": {"reputation": 2565, "user_id": 4781312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lDEcJ.jpg?s=128&g=1", "display_name": "Asesh", "link": "https://stackoverflow.com/users/4781312/asesh"}, "edited": false, "score": 0, "creation_date": 1548962178, "post_id": 54387608, "comment_id": 95743334, "body": "The question is why it does not compile -&gt; I answered with the corrected code that does compile and said what was missing. How is this not answering the question. Also, &quot;Laura&quot; is not a men&#39;s name."}], "tags": [], "owner": {"reputation": 597, "user_id": 2092777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZbO0V.png?s=128&g=1", "display_name": "TheBrain", "link": "https://stackoverflow.com/users/2092777/thebrain"}, "is_accepted": false, "score": 0, "last_activity_date": 1548588298, "creation_date": 1548588298, "answer_id": 54387608, "question_id": 54329452, "link": "https://stackoverflow.com/questions/54329452/spawn-actor-with-a-class-ue4/54387608#54387608", "title": "Spawn Actor with a class (UE4)", "body": "<p>StaticClass is not a field, but a function. So you are missing the '()' at the end:</p>\n\n<pre><code>currentTrap = GetWorld()-&gt;SpawnActor(AOMFBallista::StaticClass(), GetOwner()-&gt;GetActorLocation());\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10776146, "user_type": "registered", "profile_image": "https://graph.facebook.com/2058598044184047/picture?type=large", "display_name": "Laura", "link": "https://stackoverflow.com/users/10776146/laura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1623, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548588298, "creation_date": 1548253661, "question_id": 54329452, "link": "https://stackoverflow.com/questions/54329452/spawn-actor-with-a-class-ue4", "title": "Spawn Actor with a class (UE4)", "body": "<p>I'm currently trying to spawn a trap in my scene with the function \"Spawn Actor\" but, oddly, it don't want to take my static class as a UClass*. So this line :</p>\n\n<pre><code>currentTrap = GetWorld()-&gt;SpawnActor(AOMFBallista::StaticClass, GetOwner()-&gt;GetActorLocation());\n</code></pre>\n\n<p>just does'nt want to work. The error is : </p>\n\n<blockquote>\n  <p>'AActor *UWorld::SpawnActor(UClass *,const FTransform *,const\n  FActorSpawnParameters &amp;)'\u00a0: unable to convert the argument 1 from\n  'UClass *(__cdecl *)(void)' to 'UClass\n  *'    OrcMustFry  D:\\SVN\\2018-2019\\Sections\\Prog3B\\Cours\\UE4\\Application\\OrcMustFry\\Step3\\Correction\\Source\\OrcMustFry\\PlaceTrapComponent.cpp 36</p>\n</blockquote>\n\n<p>If you have any idea of where this problem can come, I would be very grateful !</p>\n"}, {"tags": ["c++", "file-io"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1548253802, "post_id": 54329382, "comment_id": 95476876, "body": "Open the file in binary mode, not text mode."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1548253859, "post_id": 54329382, "comment_id": 95476920, "body": "Why are you storing non-text in a \u201d.txt\u201d file?"}, {"owner": {"reputation": 11, "user_id": 10956273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1df89a0c9e1fb18d5f8bfcb770b3b0?s=128&d=identicon&r=PG&f=1", "display_name": "Rishav", "link": "https://stackoverflow.com/users/10956273/rishav"}, "edited": false, "score": 0, "creation_date": 1548254807, "post_id": 54329382, "comment_id": 95477577, "body": "So then if I store non-string variables I should use the file in binary mode. Okay but the file was working all right until this update operation. I could just store and retrieve data. So what did I miss?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1548255299, "post_id": 54329382, "comment_id": 95477924, "body": "<i>but the file was working all right</i> -- Now it doesn&#39;t work &quot;all right&quot;.  What&#39;s the point of bringing up how it was working before you made the change in the code? Obviously the text mode now is showing you the flaws, while before it didn&#39;t."}, {"owner": {"reputation": 11, "user_id": 10956273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1df89a0c9e1fb18d5f8bfcb770b3b0?s=128&d=identicon&r=PG&f=1", "display_name": "Rishav", "link": "https://stackoverflow.com/users/10956273/rishav"}, "edited": false, "score": 0, "creation_date": 1548255526, "post_id": 54329382, "comment_id": 95478076, "body": "Because I like to find the exact reason of a issue. I will try out binary mode. Thanks"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1548256298, "post_id": 54329382, "comment_id": 95478519, "body": "The simple explanation is that text mode will interpret certain control characters to mean specific things, such as end-of-file, carriage-return, etc.  For example, you write a 0x26 to a Windows text file, you aren&#39;t going to get back 0x26, but an EOF when reading the file back in text mode.  Binary mode writes the bytes as-is -- no translation, no interpretation, etc.  So for your case, you were just lucky you didn&#39;t run into these issues."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1548256850, "post_id": 54329382, "comment_id": 95478843, "body": "Also, note that this code, even in binary mode, will not work for classes or structs that are not POD (Plain-Old-Data).  For example, if one of those members was a <code>std::vector</code> or <code>std::string</code>, this method of writing files and reading them back will not work."}, {"owner": {"reputation": 11, "user_id": 10956273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1df89a0c9e1fb18d5f8bfcb770b3b0?s=128&d=identicon&r=PG&f=1", "display_name": "Rishav", "link": "https://stackoverflow.com/users/10956273/rishav"}, "edited": false, "score": 0, "creation_date": 1548257983, "post_id": 54329382, "comment_id": 95479468, "body": "Thank you so much for your help. It is working fine now. And yes I did try to use string and as you said it didn&#39;t work. I learned c++ 2 years back and I thought the best way to revise would be to just browse through the books by Schildt and making a small project. I will see into strings and vectors. Thanks again!"}], "owner": {"reputation": 11, "user_id": 10956273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1df89a0c9e1fb18d5f8bfcb770b3b0?s=128&d=identicon&r=PG&f=1", "display_name": "Rishav", "link": "https://stackoverflow.com/users/10956273/rishav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548261071, "creation_date": 1548253428, "last_edit_date": 1548261071, "question_id": 54329382, "link": "https://stackoverflow.com/questions/54329382/program-printing-garbage-value-into-file", "title": "Program printing garbage value into file", "body": "<p>This is my class :</p>\n\n<pre><code>class User{\n    char name[40], address[50], phone[15];\n    long uid; int password;\n    char acctType;\n    float acctBalance;\n    void GenerateIdPassword();\n    int GetPassword();\npublic :\n    int NewAccount();\n    int LoginToAccount();\n    void DisplayAccountDetails();\n    int GetAcctNumber();\n    float GetBalance();\n    void Deposit(float);\n    void Withdraw(float);\n    void ChangePassword();\n    void StoreData(User);\n};\n</code></pre>\n\n<p>Note : I haven't included any member function definitions.</p>\n\n<pre><code>void User::StoreData(User u)\n{\n    fstream fio;\n    long p;\n    User t;\n    fio.open(\"UserAccounts.txt\", ios::in | ios::out);\n    while(fio) {\n        p = fio.tellg();\n        fio.read((char*)&amp;t, sizeof(t));\n        if(u.uid == t.uid) {\n            fio.seekp(p);\n            fio.write((char*) &amp;u, sizeof(u));\n            break;\n        }\n    }\n    fio.close();\n}\n</code></pre>\n\n<p>This function modifies a record in the file if the user has actually modified any information related to his account.</p>\n\n<p>If I modify an account from this file in the end I get garbage value in the file.</p>\n\n<p>Can someone please tell me what I am doing wrong!</p>\n"}, {"tags": ["c++", "security", "boost", "communication"], "owner": {"reputation": 584, "user_id": 2639398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2af0cf25bed0d359dce19de12cfcd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Curve25519", "link": "https://stackoverflow.com/users/2639398/curve25519"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548253363, "creation_date": 1548253363, "question_id": 54329369, "link": "https://stackoverflow.com/questions/54329369/load-data-using-boostserialization-from-untrusted-source", "title": "Load data using boost::serialization from untrusted source", "body": "<p>I have communication between two parties, where one does not trust the other. I wish to know whether the data I've received is valid before deserializing it, and that it cannot be used maliciously (Cause segfault or major security flaws).</p>\n\n<p>Can boost provide this safety measures, and be safe to serialize?\nIf boost doesn't provide this kind of security, which serialization does?</p>\n"}, {"tags": ["c++", "overloading"], "comments": [{"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 5, "creation_date": 1548253474, "post_id": 54329361, "comment_id": 95476662, "body": "&quot;It&#39;s wrong if I would implied copying, because it works as assignment of the address&quot;: no, that&#39;s not true for C++, maybe you are confusing it with C# or Java?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1548253501, "post_id": 54329361, "comment_id": 95476678, "body": "&quot;[I]t works as assignment of the address&quot; is wrong. With <code>my_class a = b;</code> the actual object is copied. If you have <code>my_class&amp; a = b;</code> then that&#39;s another matter."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1548253733, "post_id": 54329361, "comment_id": 95476819, "body": "In your first case the copy ctor is called because otherwise the ctor and then the assignment operator would need to be called which is not as efficient as a copy constructor."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1548255171, "post_id": 54329361, "comment_id": 95477839, "body": "When you see <code>type name = value</code> you are <b>never</b> doing assignment.  You are initializing <code>name</code> and will always be calling a constructor."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1548255276, "post_id": 54329361, "comment_id": 95477903, "body": "You can use the <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">rule of five</a> example and add your own debug output to each ctor, the dtor and the assignment operators and then make some test code using your class in different ways until you&#39;ve managed to use all the functions in the class. It&#39;ll be worth it."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1548257335, "post_id": 54329361, "comment_id": 95479114, "body": "In C++, the distinction between initialisation and assignment is important. The former creates a new object, the latter modifies one that already exists."}], "answers": [{"comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1548256206, "post_id": 54329990, "comment_id": 95478462, "body": "<code>if (&amp;a != this)</code> Also, you forgot to <code>delete x</code> in <code>operator=</code> and the destructor."}], "tags": [], "owner": {"reputation": 41, "user_id": 10943413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddbfa6370348f5e82241569718fa515c?s=128&d=identicon&r=PG&f=1", "display_name": "Serg", "link": "https://stackoverflow.com/users/10943413/serg"}, "is_accepted": true, "score": 1, "last_activity_date": 1548255370, "creation_date": 1548255370, "answer_id": 54329990, "question_id": 54329361, "link": "https://stackoverflow.com/questions/54329361/overload-of-operators-and-constructor-of-copy/54329990#54329990", "title": "Overload of operators and constructor of copy", "body": "<p>You can use or the copy assignment, as well as the constructor of copies.</p>\n\n<pre><code>class A {\n  A(const A&amp; a);\n  A&amp; operator=(const A&amp; a);\n};\n\nA a1;\nA a2(a1);  // calling constructor of copies A(const A&amp; a);\nA a2 = a1; // also calling constructor of copies A(const A&amp; a);\nA a3;\na3 = a1;   // calling copy assignment operator=(const A&amp; a);\n</code></pre>\n\n<p>Here is example implementation:</p>\n\n<pre><code>class A\n{\npublic:\n\n  int* x;\n\n  A(int data)\n  {\n    this-&gt;x = new int(data);\n  }\n\n  A(const A&amp; a)\n  {\n    this-&gt;operator=(a);\n  }\n\n  A&amp; operator=(const A&amp; a)\n  {\n    this-&gt;x = new int(*a.x);\n    return *this;\n  }\n};\n</code></pre>\n\n<p>Also you can provide special checks to avoid self-assignment, e.g. <code>if (a != this)</code></p>\n"}], "owner": {"reputation": 319, "user_id": 8741818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a231ae28ba14d88a59e9367bc7a7ae?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/8741818/displayname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 54329990, "answer_count": 1, "score": 0, "last_activity_date": 1548255370, "creation_date": 1548253329, "question_id": 54329361, "link": "https://stackoverflow.com/questions/54329361/overload-of-operators-and-constructor-of-copy", "title": "Overload of operators and constructor of copy", "body": "<p>C++ requires create constructor of copies for assignment one instance to another instance. For example: </p>\n\n<pre><code>my_class a = b;\n</code></pre>\n\n<p>It's wrong if I would implied copying, because it works as assignment of the address. Therefore, if I change <code>a</code>, <code>b</code> will be changed too. So, I should create constructor of copy:</p>\n\n<pre><code>my_class(const my_class &amp;obj);\n</code></pre>\n\n<p>It seems as obvious thing and rest is going without saying, but I have gotten a doubt, when I found out about overload operators:</p>\n\n<pre><code>my_class operator=(my_class obj);\n</code></pre>\n\n<p>Turns out that I could use it as assignment and I don't have to use constructor of copies. Is that right? However, why assignment that is placed in the definition of <code>operator=</code> works as copying.</p>\n"}, {"tags": ["c++", "algorithm", "floating-point"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1548253590, "post_id": 54329320, "comment_id": 95476733, "body": "Convert the floating point number to a rational number?  You would have to limit yourself to a certain amount of precision since <code>.1</code> is actually <code>0.1000000000000000055511151231257827021181583404541015625</code>."}, {"owner": {"reputation": 22814, "user_id": 182660, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75e48a7020624657e5da6033590030ee?s=128&d=identicon&r=PG", "display_name": "SergGr", "link": "https://stackoverflow.com/users/182660/serggr"}, "edited": false, "score": 3, "creation_date": 1548253669, "post_id": 54329320, "comment_id": 95476776, "body": "Mark, do you take into account the fact that the numbers <code>0.4</code> and <code>0.1</code> themselves can&#39;t be accurately represented using the <code>double</code> type? It seems that you missed this important point and thus are not satisfied with valid results."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548253689, "post_id": 54329320, "comment_id": 95476793, "body": "@NathanOliver: not sure if I need to use rational number, maybe there&#39;s another way using only floats? That&#39;s why I ask :)"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 22814, "user_id": 182660, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75e48a7020624657e5da6033590030ee?s=128&d=identicon&r=PG", "display_name": "SergGr", "link": "https://stackoverflow.com/users/182660/serggr"}, "edited": false, "score": 0, "creation_date": 1548253735, "post_id": 54329320, "comment_id": 95476822, "body": "@SergGr: of course I know, and I&#39;m aware of this. I&#39;m not asking this. I can deal with the approx of the nearest representable value, but it must be that one, not another one :)"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1548253846, "post_id": 54329320, "comment_id": 95476910, "body": "<a href=\"https://en.cppreference.com/w/cpp/numeric/math/nextafter\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/numeric/math/nextafter</a> may be able to help you"}, {"owner": {"reputation": 22814, "user_id": 182660, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75e48a7020624657e5da6033590030ee?s=128&d=identicon&r=PG", "display_name": "SergGr", "link": "https://stackoverflow.com/users/182660/serggr"}, "edited": false, "score": 1, "creation_date": 1548253872, "post_id": 54329320, "comment_id": 95476931, "body": "Then I probably don&#39;t understand from your question where do you see a problem with the literal translation of your code: <code>round(value &#47; step)*step</code>?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1548253916, "post_id": 54329320, "comment_id": 95476968, "body": "Either the desired number is representable or it isn&#39;t. Can you decide which one you want? ;)"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 22814, "user_id": 182660, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75e48a7020624657e5da6033590030ee?s=128&d=identicon&r=PG", "display_name": "SergGr", "link": "https://stackoverflow.com/users/182660/serggr"}, "edited": false, "score": 0, "creation_date": 1548253979, "post_id": 54329320, "comment_id": 95477014, "body": "@SergGr: try yourself :) If you use that function, in the second case, it will return <code>47.900000000000005684341886080801486968994140625</code>, not <code>47.89999999999999857891452847979962825775146484375</code> (which is the nearest representable value)"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1548254054, "post_id": 54329320, "comment_id": 95477066, "body": "@Lightness Races in Orbit: but I need the nearest representable one (as shown in the example) :)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548254154, "post_id": 54329320, "comment_id": 95477147, "body": "@markzzz I&#39;m not a floating point expert but my intuition says you need rational numbers to get what you want. Since the steps you want to use are not exactly representable there error will introduce error into your calculation and as you can see from your couple posts related to this, it is very hard to deal with it."}, {"owner": {"reputation": 22814, "user_id": 182660, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75e48a7020624657e5da6033590030ee?s=128&d=identicon&r=PG", "display_name": "SergGr", "link": "https://stackoverflow.com/users/182660/serggr"}, "edited": false, "score": 0, "creation_date": 1548254318, "post_id": 54329320, "comment_id": 95477267, "body": "Mark, I think you need to start with the definition of  the &quot;<i>multiple of the step</i>&quot; such that it would say that <code>47.89999999999999857891452847979962825775146484375</code> is a &quot;multiply of <code>0.1</code>&#39;s <b><i>actual double representation</i></b>&quot;"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 22814, "user_id": 182660, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75e48a7020624657e5da6033590030ee?s=128&d=identicon&r=PG", "display_name": "SergGr", "link": "https://stackoverflow.com/users/182660/serggr"}, "edited": false, "score": 0, "creation_date": 1548254705, "post_id": 54329320, "comment_id": 95477502, "body": "@SergGr: <code>47.9</code> is multiple of <code>0.1</code>, right? I need the nearest representable float value of <code>47.9</code>, which is <code>47.899999999999998578914528479799628257751464843759</code> (not <code>47.900000000000005684341886080801486968994140625</code>)."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 22814, "user_id": 182660, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75e48a7020624657e5da6033590030ee?s=128&d=identicon&r=PG", "display_name": "SergGr", "link": "https://stackoverflow.com/users/182660/serggr"}, "edited": false, "score": 0, "creation_date": 1548255055, "post_id": 54329320, "comment_id": 95477759, "body": "@SergGr: again :) I got that 0.1 can&#39;t be accurately represented as a double value. But I need to &quot;treat&quot; it as it is!!! So, once I read the value 0.1 from a JSON, even if its <code>0.1000000000000000055511151231257827021181583404541015625</code> I need to consider it as <code>0.1</code>, so with <code>47.9435</code> (which is <code>47.943500000000000227373675443232059478759765625</code>) I need to return <code>47.89999999999999857891452847979962825775146484375</code> (which represent the nearest representable value with &quot;hypothetical&quot; step and value considered without floating error)."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548255557, "post_id": 54329320, "comment_id": 95478096, "body": "@markzzz If you are getting the value from a JSON can you get the value as a string instead of a <code>double</code>?  If so then you can easily convert the string into a rational number with no loss of precision which means you son&#39;t lose any precision in your snap function."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548256060, "post_id": 54329320, "comment_id": 95478373, "body": "@NathanOliver: I get not only from JSON (was an example); it can come from different sources. Thanks for the tip anyway!"}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 5, "creation_date": 1548256296, "post_id": 54329320, "comment_id": 95478517, "body": "@markzzz: How is it possible to \u201ctreat\u201d .1 as representable even though it is not? If there is a routine <code>void double foo(double x)</code> and you pass 0.1000000000000000055511151231257827021181583404541015625 for <code>x</code>, how could <code>foo</code> know that you wanted .1 and not 0.1000000000000000055511151231257827021181583404541015625? It has only the value it is given? If you want to work with .1 instead, you <b>must</b> define some way of expressing that. You could pass it as a string numeral, represent it as a rational fraction of 1/10, or use other methods. But you have to specify something."}, {"owner": {"reputation": 22814, "user_id": 182660, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75e48a7020624657e5da6033590030ee?s=128&d=identicon&r=PG", "display_name": "SergGr", "link": "https://stackoverflow.com/users/182660/serggr"}, "edited": false, "score": 0, "creation_date": 1548256790, "post_id": 54329320, "comment_id": 95478808, "body": "To re-state what Eric says, if you can&#39;t represent <code>0.1</code> exactly how do you distinguish the case when you got <code>0.100...</code> and the user meant <code>0.1</code> and you got <code>0.100...</code> and the user did mean exactly <code>0.100...</code>? I&#39;d say that the only real solution is to use some data type that can represent all the values you need exactly. Nathan&#39;s idea of parsing values into exact rationals is one of such approaches. Another approach might be using some fixed of floating point <b><i>decimal</i></b> (as opposed to binary) numbers."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1548259023, "post_id": 54329320, "comment_id": 95480064, "body": "@EricPostpischil: &quot;or use other methods&quot; is the reason way I opened this question. How would you do it properly? Or its simple not achievable?"}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1548260263, "post_id": 54329320, "comment_id": 95480825, "body": "@markzzz: You need to change the question. Actually, you likely need to abandon this one and enter a new question. The title of this one asks about a \u201cmultiple of another <b>float</b> number\u201d. It starts \u201cI&#39;ve both the value and step numbers <b>given in float</b>.\u201d And it ends \u201cBut, as I said, I don&#39;t have any rational numbers to start with, <b>only float</b>.\u201d So you have told us repeatedly that you have only a floating-point number. If you want to find the floating-point number that is nearest a multiple of an arbitrary rational number, you need to enter a new question asking that."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1548260586, "post_id": 54329320, "comment_id": 95481032, "body": "@Eric Postpischil: I see, thanks. English is not my naive english, that&#39;s why it could be a bit enigmatic."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1548264366, "post_id": 54329320, "comment_id": 95482942, "body": "<code>return value - remainder(value, step);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548253959, "post_id": 54329459, "comment_id": 95476999, "body": "This is not &quot;snapping&quot; to the value the OP wants in the second case: <a href=\"http://coliru.stacked-crooked.com/a/05117caaa124a0ca\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/05117caaa124a0ca</a>"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 1, "creation_date": 1548254099, "post_id": 54329459, "comment_id": 95477095, "body": "@MrSmith42: the version of 0.1 won&#39;t snap corectly, it goes to <code>47.90000000000000568434188608080148696899</code>"}, {"owner": {"reputation": 9168, "user_id": 1921273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LREX2.png?s=128&g=1", "display_name": "MrSmith42", "link": "https://stackoverflow.com/users/1921273/mrsmith42"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1548254650, "post_id": 54329459, "comment_id": 95477464, "body": "@markzzz: so you expect for not exact representation of 0.1 and 0.4 and limited and the limited accuracy of float arithmetic the result that you would get with infinite precision of 0.1 and 0.4 and infinite accurate arithmetic operations only rounded the result at the end?"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1548254770, "post_id": 54329459, "comment_id": 95477555, "body": "@MrSmith42: <code>47.9</code> is multiple of <code>0.1</code>, right? I need the nearest representable float value of <code>47.9</code>, which is <code>47.899999999999998578914528479799628257751464843759</code> (not <code>47.900000000000005684341886080801486968994140625</code>)."}, {"owner": {"reputation": 9168, "user_id": 1921273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LREX2.png?s=128&g=1", "display_name": "MrSmith42", "link": "https://stackoverflow.com/users/1921273/mrsmith42"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 1, "creation_date": 1548254914, "post_id": 54329459, "comment_id": 95477656, "body": "@markzzz: you are correct in real numbers, but 0.1 is a float and also 47.9 is a float. And in this case 0.1 is not an exact multiple of 47.9 ."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1548255134, "post_id": 54329459, "comment_id": 95477811, "body": "@MrSmith42: I know. But I need to &quot;treat&quot; is as real number, even if they aren&#39;t (and use them, since I have only them, not real numbers and/or rational ones)"}, {"owner": {"reputation": 9168, "user_id": 1921273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LREX2.png?s=128&g=1", "display_name": "MrSmith42", "link": "https://stackoverflow.com/users/1921273/mrsmith42"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1548256182, "post_id": 54329459, "comment_id": 95478445, "body": "@markzzz: If possible void inexact arithmetic. Depending on the rest of your program you may be able to store the value in an <code>int</code> for the multiple of the <code>step</code> and save the inexact conversion to <code>float</code> until the value leaves your program (e.g. at the output). This way you avoid rounding errors as long as possible. (Like it is most times done with money when you store the cent-value in an <code>int</code> (instead of in a <code>float</code> that represents the fraction of a dollar)."}], "tags": [], "owner": {"reputation": 9168, "user_id": 1921273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LREX2.png?s=128&g=1", "display_name": "MrSmith42", "link": "https://stackoverflow.com/users/1921273/mrsmith42"}, "is_accepted": false, "score": 1, "last_activity_date": 1548253689, "creation_date": 1548253689, "answer_id": 54329459, "question_id": 54329320, "link": "https://stackoverflow.com/questions/54329320/how-to-return-the-nearest-representable-float-number-multiple-of-another-float-n/54329459#54329459", "title": "How to return the nearest representable float number multiple of another float number?", "body": "<p>I would do it like this</p>\n\n<p>Your fist example:</p>\n\n<pre><code>    double step = 0.4;\n    (float) (((int) (47.7121d / step + step / 2)) * step);\n\n    -&gt; 47.6\n</code></pre>\n\n<p>Your second example:</p>\n\n<pre><code>    double step = 0.1;\n    (float) (((int) (47.9435d / step + step / 2)) * step);\n\n    -&gt; 47.9\n</code></pre>\n\n<p>This part is needed to get the nearest: <code>+ step / 2</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1548844287, "post_id": 54431206, "comment_id": 95686174, "body": "It doesn&#39;t works. Try <code>nearest_step(47.9435, 0.1)</code>. which should snap to 47.9 (which is <code>47.89999999999999857891452847979962825775146484375</code>): it outputs <code>47.900000000000005684341886080801486968994140625</code>, which is different"}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1548844621, "post_id": 54431206, "comment_id": 95686381, "body": "@markzzz But you did not actually pass <code>0.1</code> (which is not a valid <code>double</code>), but <code>0.1000000000000000055511151231257827021181583404541015625</code>. So the result is correct. Be more clear on how you want to pass the actual step-size if you want a better solution."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1548845196, "post_id": 54431206, "comment_id": 95686704, "body": "Its &quot;what I have&quot;. I need to &quot;treat&quot; <code>0.1000000000000000055511151231257827021181583404541015625</code> as 0.1. That&#39;s the whole point of the question hehe"}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1548845398, "post_id": 54431206, "comment_id": 95686809, "body": "It&#39;s not what I read into &quot;the nearest representable float number multiple [desired result] of another float number [step]&quot;. Maybe your question should be &quot;how to find a rational [e.g. 1/10] close to a given float number [e.g. <code>0.100...55511..</code>]?&quot;"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1548845503, "post_id": 54431206, "comment_id": 95686880, "body": "yes, it could be! ;) Anyway, what I need its the same hehe"}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1548845659, "post_id": 54431206, "comment_id": 95686975, "body": "It <i>could</i> be, but what if someone passes <code>sqrt(2.0)</code> or <code>M_PI</code> as stepsize? Do you expect the method to magically know what the user meant? And what if the user actually wants <code>3602879701896397&#47;36028797018963968</code> and not <code>1&#47;10</code>?"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1548845765, "post_id": 54431206, "comment_id": 95687056, "body": "Correct note! Let say so that I&#39;m ok with step that can be expressed correctly with rational numbers... how would you do this?"}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1548846243, "post_id": 54431206, "comment_id": 95687383, "body": "<code>0.1000000000000000055511151231257827021181583404541015625 == 3602879701896397&#47;36028797018963968</code> <b>is</b> a rational number. In fact, every <code>double</code> (except <code>NaN</code> and +-<code>Inf</code>) can be expressed as a rational number."}], "tags": [], "owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "is_accepted": false, "score": 0, "last_activity_date": 1548804642, "creation_date": 1548804642, "answer_id": 54431206, "question_id": 54329320, "link": "https://stackoverflow.com/questions/54329320/how-to-return-the-nearest-representable-float-number-multiple-of-another-float-n/54431206#54431206", "title": "How to return the nearest representable float number multiple of another float number?", "body": "<p>A very simple solution, using <a href=\"http://www.cplusplus.com/reference/cmath/round/\" rel=\"nofollow noreferrer\"><code>std::round</code></a>:</p>\n\n<pre><code>#include &lt;cmath&gt;\ndouble nearest_step(double value, double step)\n{\n    return std::round(value/step)*step;\n}\n</code></pre>\n\n<p>Be aware that there is no floating point number with (exactly) the value <code>0.1</code>. The closest <code>double</code> to <code>1./10</code> is <code>0.1000000000000000055511151231257827021181583404541015625</code>, i.e., you will get slightly bigger numbers than expected most of the time. (Also, the result of the division is usually not exact, so in a few corner cases it may get rounded to the wrong direction.)</p>\n"}], "owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1548804642, "creation_date": 1548253220, "last_edit_date": 1548253527, "question_id": 54329320, "link": "https://stackoverflow.com/questions/54329320/how-to-return-the-nearest-representable-float-number-multiple-of-another-float-n", "title": "How to return the nearest representable float number multiple of another float number?", "body": "<p>I've both the value and step numbers given in float, such as:</p>\n\n<pre><code>double step = 0.4;\ndouble value = 47.7121;\n</code></pre>\n\n<p>I need to return, for each value and step pair I give, the nearest representable float number multiple of the step.</p>\n\n<p>So here's some expected results:</p>\n\n<pre><code>step = 0.4;\nvalue = 47.7121;\n===&gt; it must snap to 47.6\nresult = 47.60000000000000142108547152020037174224853515625\n\nstep = 0.1;\nvalue = 47.9435;\n===&gt; it must snap to 47.9\nresult = 47.89999999999999857891452847979962825775146484375\n</code></pre>\n\n<p>I'm able to <a href=\"http://coliru.stacked-crooked.com/a/f6ff9b2294a6099a\" rel=\"nofollow noreferrer\">do this</a> only with rational numbers (not float), in this form:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;math.h&gt;\n\ninline double SnapValue(double value, int numerator, int denominator) {\n    return round(value * denominator / numerator) * numerator / denominator;\n}\n\nint main() {\n    std::cout.precision(100);\n\n    std::cout &lt;&lt; \"result: \" &lt;&lt; SnapValue(47.7121, 2, 5) &lt;&lt; std::endl; // step = 0.4, value 47.7121\n    std::cout &lt;&lt; \"result: \" &lt;&lt; SnapValue(47.9435, 1, 10) &lt;&lt; std::endl; // step = 0.1, value 47.9435\n\n    return 0;\n}\n</code></pre>\n\n<p>But, as I said, I don't have any rational numbers to start with, only float. \nHow would you do this?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1548252724, "post_id": 54329140, "comment_id": 95476243, "body": "You only have a <i>declaration</i> of the static member, there&#39;s no definition of it. Every book or tutorial discussing static members should have told you what to do, please don&#39;t skip parts of your books, tutorials or classes."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1548253056, "post_id": 54329140, "comment_id": 95476413, "body": "By the way, if you make <code>get_test()</code> return by reference, that actually <i>is</i> the preferred way to do it, if you don&#39;t mind a little overhead. It avoids the static initialisation order fiasco, among other things."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1548253211, "post_id": 54329140, "comment_id": 95476505, "body": "@LightnessRacesinOrbit Not to mention that the OP won&#39;t have to wonder why the data he or she added to the map seems to disappear all the time. :)"}], "owner": {"reputation": 5894, "user_id": 4746206, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aeb5a68770c5420348fb112d7e082436?s=128&d=identicon&r=PG&f=1", "display_name": "Bob5421", "link": "https://stackoverflow.com/users/4746206/bob5421"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1548252668, "answer_count": 0, "score": 0, "last_activity_date": 1548252627, "creation_date": 1548252627, "question_id": 54329140, "link": "https://stackoverflow.com/questions/54329140/undefined-reference-to-c-static-field", "closed_reason": "Duplicate", "title": "undefined reference to c++ static field", "body": "<p>Look at this very basic c++ class:</p>\n\n<pre><code>class MyClass {\n public:\n  static std::map&lt;int, std::string&gt; test;\n\n  void method1()\n  {\n     std::cout &lt;&lt; test[1] &lt;&lt; std::endl;\n  }\n};\n\nint main()\n{\n    MyClass::test[1]=\"test\";  \n\n    return 0;\n}\n</code></pre>\n\n<p>As you can see, this very basic class contains a static field.\nBut when i am trying to access it, i get this compiler error:</p>\n\n<pre><code>undefined reference to `MyClass::test[abi:cxx11]'\n</code></pre>\n\n<p>In order to make it work, i have tried to create a static method and declare my static field inside this method.\nIt works, but it looks ugly.\nI want to understand why my first code does not work and why this second code works...</p>\n\n<pre><code>class MyClass {\n public:\n  static std::map&lt;int, std::string&gt;  get_test()\n  {\n    static std::map&lt;int, std::string&gt; test;\n    return test;\n  }\n\n  void method1()\n  {\n     std::cout &lt;&lt; get_test()[1] &lt;&lt; std::endl;\n  }\n};\n\nint main()\n{\n    MyClass::get_test()[1]=\"test\";\n\n    return 0;\n}\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "windows", "opengl"], "comments": [{"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1548249890, "post_id": 54328265, "comment_id": 95474523, "body": "Which error do you get? What is it that is not working? Do you have a valid OpenGL context?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10692448"}, "edited": false, "score": 0, "creation_date": 1548250744, "post_id": 54328265, "comment_id": 95475068, "body": "Sorry, I posted the error in the edit"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1548251271, "post_id": 54328265, "comment_id": 95475411, "body": "@BobTheTreeGod see <a href=\"https://stackoverflow.com/a/36980406/2521214\">wglext - extension not installed in OpenGL context</a> my bet is you are either doing multiple include of itself (simple <code>#ifndef xxx #define xxx ... #endif</code> would repair it) or redefinig something that is already included like <code>wglSwapInterval_t</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10692448"}, "edited": false, "score": 0, "creation_date": 1548251589, "post_id": 54328265, "comment_id": 95475581, "body": "Seems to work now with ifndef"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1548322222, "post_id": 54328265, "comment_id": 95502319, "body": "@BobTheTreeGod yep so you are including the file more than once ... I also saw  on some platforms (AVR32/GCC) that compiler  compile all C or Cpp files in directory so if you are including a C or Cpp file on such its compiled twice ... if you have include of the same file more than once its the same so I usually add <code>#ifndef XXX ...</code> where the XXX is the filename encoded as macro token like <code>_file_h</code> that way even on multiple include/compile it will compile just once for each separate object ..."}], "answers": [{"tags": [], "owner": {"reputation": 26196, "user_id": 1841194, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e65b668131c96399c25c6fae3fff8da5?s=128&d=identicon&r=PG&f=1", "display_name": "frogatto", "link": "https://stackoverflow.com/users/1841194/frogatto"}, "is_accepted": true, "score": 1, "last_activity_date": 1548761674, "last_edit_date": 1548761674, "creation_date": 1548252800, "answer_id": 54329177, "question_id": 54328265, "link": "https://stackoverflow.com/questions/54328265/error-while-loading-opengl-functions-without-a-loading-library/54329177#54329177", "title": "Error while loading opengl functions without a loading library", "body": "<ul>\n<li><p>Error <a href=\"https://docs.microsoft.com/en-us/cpp/error-messages/compiler-errors-1/compiler-error-c2086?view=vs-2017\" rel=\"nofollow noreferrer\">C2086</a> says that you have defined <code>wglSwapInterval</code> multiple times.</p></li>\n<li><p>Error <a href=\"https://docs.microsoft.com/en-us/cpp/error-messages/compiler-errors-1/compiler-error-c2374?view=vs-2017\" rel=\"nofollow noreferrer\">C2374</a> says that you have defined and initialized <code>glCreateProgram</code> multiple times.</p></li>\n</ul>\n\n<p>The common reason for such problems is including an unguarded <code>.h</code> file more than once in a single <code>.cpp</code> file directly or indirectly (i.e. included in another file which itself is included in the current file).</p>\n\n<p>To avoid such problems, always put <code>#ifndef</code> or <code>#pragma once</code> in your <code>.h</code> files as the <a href=\"https://en.wikipedia.org/wiki/Include_guard\" rel=\"nofollow noreferrer\">include guard</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10692448"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 54329177, "answer_count": 1, "score": 0, "last_activity_date": 1548761674, "creation_date": 1548249747, "last_edit_date": 1548250719, "question_id": 54328265, "link": "https://stackoverflow.com/questions/54328265/error-while-loading-opengl-functions-without-a-loading-library", "title": "Error while loading opengl functions without a loading library", "body": "<p>I don't really know what i'm doing wrong. I'm not using a loading library so I can have more control over my code. I am using windows os.</p>\n\n<pre><code>#include &lt;gl/GL.h&gt;\n#include &lt;windows.h&gt;\n\ntypedef BOOL(WINAPI wglSwapInterval_t) (int interval);\nstatic wglSwapInterval_t* wglSwapInterval;\n\n#ifndef GLAPI\n#define GLAPI extern\n#endif\n\n#ifndef APIENTRYP\n#define APIENTRYP APIENTRY *\n#endif\n\n#define GL_VERTEX_SHADER 0x8B31\n#define GL_FRAGMENT_SHADER 0x8B30\n\ntypedef GLuint(APIENTRYP PFNGLCREATEPROGRAMPROC) (void);\nPFNGLCREATEPROGRAMPROC glCreateProgram = (PFNGLCREATEPROGRAMPROC)wglGetProcAddress(\"glCreateProgram\");\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>(5): error C2086: 'wglSwapInterval_t (__stdcall *__stdcall wglSwapInterval)': redefinition\n(5): note: see declaration of 'wglSwapInterval'\n(19): error C2374: 'glCreateProgram': redefinition; multiple initialization\n(19): note: see declaration of 'glCreateProgram'\n</code></pre>\n"}, {"tags": ["c++", "arduino", "lcd"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1548249791, "post_id": 54328254, "comment_id": 95474456, "body": "Could it be because you never free the memory pointed by <code>longText</code>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1548249833, "post_id": 54328254, "comment_id": 95474484, "body": "<code>sizeof(text)</code> does not do what you think. You (probably) won&#39;t allocate enough memory, and so get <i>undefined behaviour</i> writing beyond its bounds."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1548249863, "post_id": 54328254, "comment_id": 95474501, "body": "Also <code>sizeof(text)</code> is not the length of the string pointed by text, use <code>strlen(text)</code> instead. Same problem with <code>sizeof(screen)</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1548250007, "post_id": 54328254, "comment_id": 95474589, "body": "Also your use of the &quot;magic numers&quot; (google that) <code>16</code>, and <code>17</code> is questionable, use constants instead."}], "answers": [{"tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1548250324, "last_edit_date": 1548250324, "creation_date": 1548249977, "answer_id": 54328349, "question_id": 54328254, "link": "https://stackoverflow.com/questions/54328254/arduino-scrolling-text-program-freeze-after-some-time/54328349#54328349", "title": "Arduino scrolling text program freeze after some time", "body": "<p>When you declare the argument as <code>char text[]</code>, the compiler translates it as <code>char* text</code>. That is, it's a pointer.</p>\n\n<p>And getting the size of a pointer (e.g. <code>sizeof(text)</code>) gives you the size of the <em>pointer</em> and not whatever it points to. If it's a null-terminated byte string, then use <a href=\"https://en.cppreference.com/w/c/string/byte/strlen\" rel=\"nofollow noreferrer\"><code>strlen</code></a> to get the length (but note that the null-terminator not counted).</p>\n\n<p>Or even better, stop using C strings and functions, because Arduino is actually programmed in C++ and have its own standard <a href=\"https://www.arduino.cc/reference/en/language/variables/data-types/stringobject/\" rel=\"nofollow noreferrer\"><code>String</code></a> class that should be used for all strings.</p>\n\n<hr>\n\n<p>Also note that</p>\n\n<pre><code>const char space[16] = \"                \";\n</code></pre>\n\n<p>creates an array of 16 elements, and set all those elements to the space character <code>' '</code>. <strong><em>But</em></strong> it's not a null-terminated string, because the terminator doesn't fit in the array.</p>\n\n<p>You also know about the <code>memset</code> function, but seems to have forgotten the <code>memcpy</code> function when you copy from your arrays.</p>\n\n<p>Instead of the explicit loop copying from <code>space</code>, you could simply do</p>\n\n<pre><code>memcpy(longText, space, sizeof space);  // Using sizeof since space is not null-terminated\n</code></pre>\n\n<p>Lastly, be careful with the <a href=\"https://en.cppreference.com/w/c/string/byte/strncpy\" rel=\"nofollow noreferrer\"><code>strncpy</code></a> function, it might not null-terminate the destination string.</p>\n"}], "owner": {"reputation": 692, "user_id": 762630, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/u2TPx.png?s=128&g=1", "display_name": "Erdem", "link": "https://stackoverflow.com/users/762630/erdem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 54328349, "answer_count": 1, "score": 0, "last_activity_date": 1548272597, "creation_date": 1548249720, "last_edit_date": 1548272597, "question_id": 54328254, "link": "https://stackoverflow.com/questions/54328254/arduino-scrolling-text-program-freeze-after-some-time", "title": "Arduino scrolling text program freeze after some time", "body": "<p>I use a 16x2 character LCD to display some text. What I want is first line is fixed and second line is scrolling.</p>\n\n<p>I wrote a program which works fine but the problem is after some time Arduino does not respond. I suspect there might be a bug or memory leak in the code.</p>\n\n<p>The relevant code is like this.</p>\n\n<pre><code>void scrollTextFromRight(int line, char text[])\n{\n    const char space[16] = \"                \";\n    char screen[16];\n    char * longText;\n\n    longText = malloc(sizeof(char) * (sizeof(text) + 17));\n\n    memset(longText, '\\0', sizeof(char) * (sizeof(text) + 17));\n    memset(screen, '\\0', sizeof(screen));\n\n    for (int i = 0; i &lt; 16; ++i)\n    {\n        longText[i] = space[i];\n    }\n\n    for (int j = 0; j &lt; sizeof(text) + 17; ++j)\n    {\n        longText[16+j] = text[j];\n    }\n\n\n    for (int i = 0; i &lt; sizeof(text) + 17; ++i)\n    {\n\n        lcd.setCursor(0, line);\n        strncpy(screen, longText + i, 17 );\n        lcd.print(screen);\n        delay(350);\n    }\n}\n</code></pre>\n\n<p>I call this function from main program like this:</p>\n\n<pre><code>scrollTextFromRight(1, \"Scrolling text\");\n</code></pre>\n\n<p><strong>Update 1 :</strong><br>\nAfter reading the comments and answers I freed allocated memory space with free function. I uploaded the new code and testing whether it works as expected.</p>\n\n<p>I added this part after the third for loop.</p>\n\n<pre><code>free longText;\n</code></pre>\n\n<p><strong>Update 2 :</strong><br>\nAfter reading the comments I decided to use Arduino's String class. The code became like this:</p>\n\n<pre><code>void scrollTextFromRight(int line, String text)\n{\n    const String space = \"                \";\n    const String longText = space + text + ' ';\n    int displaySize = 16;\n\n    for (int i = 0; i &lt;= longText.length(); ++i)\n    {\n        lcd.setCursor(0, line);\n        String display = longText.substring(i, i + displaySize);\n        lcd.print(display);\n        delay(350);\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c++14", "variadic-templates", "perfect-forwarding"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1548249599, "post_id": 54328194, "comment_id": 95474334, "body": "This looks to be logically equivalent to <code>std::invoke</code>. Just use <code>std::invoke</code>."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1548249882, "post_id": 54328194, "comment_id": 95474514, "body": "@SamVarshavchik: It is only example code! In real world code there is a need to do lot more than invoking the given function by the pointer..."}, {"owner": {"reputation": 10521, "user_id": 1316462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de3149d5f602449f41083ca17a5ceab?s=128&d=identicon&r=PG&f=1", "display_name": "Jans", "link": "https://stackoverflow.com/users/1316462/jans"}, "edited": false, "score": 0, "creation_date": 1548253521, "post_id": 54328194, "comment_id": 95476692, "body": "You could disable deduction on the function parameter pack by putting it in a non-deduced context and let the function pointer lead the deduction."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "reply_to_user": {"reputation": 10521, "user_id": 1316462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de3149d5f602449f41083ca17a5ceab?s=128&d=identicon&r=PG&f=1", "display_name": "Jans", "link": "https://stackoverflow.com/users/1316462/jans"}, "edited": false, "score": 0, "creation_date": 1548273896, "post_id": 54328194, "comment_id": 95487142, "body": "@Jans: Can you give an example?"}, {"owner": {"reputation": 10521, "user_id": 1316462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de3149d5f602449f41083ca17a5ceab?s=128&d=identicon&r=PG&f=1", "display_name": "Jans", "link": "https://stackoverflow.com/users/1316462/jans"}, "edited": false, "score": 0, "creation_date": 1548286535, "post_id": 54328194, "comment_id": 95491794, "body": "@Klaus - Jarod42 has already provided it in his answer. The first part."}], "answers": [{"comments": [{"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1548250501, "post_id": 54328322, "comment_id": 95474901, "body": "The first case did not fit to my needs as I have to perform some checks on the types given by the function signature presented via the function pointer. For your second solution: Is there missing <code>AS2&amp;&amp; ... args</code>?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 1, "creation_date": 1548251736, "post_id": 54328322, "comment_id": 95475642, "body": "@Klaus: and even <code>ARGS&amp;&amp;...</code> for first case too."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1548253682, "post_id": 54328322, "comment_id": 95476787, "body": "@Klaus - yes, sorry: <code>&amp;&amp;</code> forgotten in both cases (as observed by Jarod42); otherwise perfect forwarding doesn&#39;t works; corrected."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1548253994, "post_id": 54328322, "comment_id": 95477028, "body": "Since <code>Do1</code> is <code>auto</code> (even though all functions are <code>void</code> right now), perhaps this could be a future improvement (for the second solution): <code>auto Do1( RET(*ptr)(AS1...), AS2&amp;&amp;... args ) -&gt; RET  {    return (*ptr)(std::forward&lt;AS2&gt;( args )...);  }</code>"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1548254565, "post_id": 54328322, "comment_id": 95477403, "body": "Just noticed the C++14 tag so the <code>-&gt; RET</code> part can be skipped, Only <code>return</code> would need to be added."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 3, "last_activity_date": 1548253640, "last_edit_date": 1548253640, "creation_date": 1548249895, "answer_id": 54328322, "question_id": 54328194, "link": "https://stackoverflow.com/questions/54328194/forwarding-parameters-indirectly-deducible-from-function-pointer-type/54328322#54328322", "title": "forwarding parameters indirectly deducible from function pointer type", "body": "<blockquote>\n  <p>Q: Is there any way to repair the first approach in any case to get rid of the intermediate lambda here?</p>\n</blockquote>\n\n<p>I suggest to accept the callable <code>ptr</code> simply as a type</p>\n\n<pre><code>template &lt; typename F, typename ... ARGS &gt;\nauto Do1( F func, ARGS &amp;&amp; ... args )\n {\n    func(std::forward&lt;ARGS&gt;( args )...);\n }\n</code></pre>\n\n<p>This way your <code>Do1()</code> avoid completely the double-different deduction problem and works also with other types of callable (by example: with generic lambda that can't be simply converted to function pointer).</p>\n\n<p>Otherwise you can intercept two variadic list of argument types</p>\n\n<pre><code>template &lt; typename RET, typename ... AS1, typename ... AS2 &gt;\nauto Do1( RET(*ptr)(AS1...), AS2 &amp;&amp; ... args )\n {\n   (*ptr)(std::forward&lt;AS2&gt;( args )...);\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1548275895, "post_id": 54330086, "comment_id": 95487932, "body": "sorry but... in your first solution... if <code>args</code> are &quot;<code>non_deducible_t</code>&quot; (and without <code>&amp;&amp;</code>) you don&#39;t loose perfect forwarding?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1548319806, "post_id": 54330086, "comment_id": 95500999, "body": "@max66: indeed, first solution has same issue than OP&#39;s lambda way with extra move construct. <code>&amp;&amp;</code> cannot be added, as non deducible, it would really be rvalue references (with reference collapsing) and not forwarding references."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 3, "last_activity_date": 1548255653, "creation_date": 1548255653, "answer_id": 54330086, "question_id": 54328194, "link": "https://stackoverflow.com/questions/54328194/forwarding-parameters-indirectly-deducible-from-function-pointer-type/54330086#54330086", "title": "forwarding parameters indirectly deducible from function pointer type", "body": "<blockquote>\n  <p>Q: Is there any way to repair the first approach in any case to get rid of the intermediate lambda here?</p>\n</blockquote>\n\n<p>You might change second args to be non deducible:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct non_deducible {\n    using type = T;  \n};\ntemplate &lt;typename T&gt;\nusing non_deducible_t = typename non_deducible&lt;T&gt;::type;\n\ntemplate &lt; typename RET, typename ... ARGS &gt;\nauto Do1( RET(*ptr)(ARGS...), non_deducible_t&lt;ARGS&gt;... args );\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/9df462c2888bf6cf\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<blockquote>\n  <p>is the solution with the intermediate lambda \"well\" designed, especially with all the \"forwarding\" things so that I did not create some copies or other unexpected behavior?</p>\n</blockquote>\n\n<p>You do extra move constructs, so for <code>void Ex1(std::array&lt;int, 5&gt;)</code>, you copy twice the <code>std::array</code>.\nSolution is forwarding reference:</p>\n\n<pre><code>template &lt; typename RET, typename ... ARGS &gt;\nauto Do2( RET(*ptr)(ARGS...) )\n{   \n    return [ptr](auto&amp;&amp; ... args )\n    -&gt; decltype((*ptr)((decltype(args)(args))...))\n    {\n        std::cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; std::endl;\n        (*ptr)((decltype(args)(args))...); \n    };\n}\n</code></pre>\n\n<p>Simple alternatives are:</p>\n\n<pre><code>template &lt; typename Ret, typename ... Ts, typename ... Args &gt;\nauto Do1( Ret(*ptr)(Ts...), Args&amp;&amp; ... args)\n{\n    (*ptr)(std::forward&lt;Args&gt;(args)...);\n}\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>template &lt; typename Func, typename ... Args &gt;\nauto Do1(Func f, Args&amp;&amp; ... args)\n{\n    f(std::forward&lt;Args&gt;(args)...);\n}\n</code></pre>\n\n<p>You might still have some <code>function_traits</code> to check <code>Func</code>.</p>\n"}], "owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 54328322, "answer_count": 2, "score": 1, "last_activity_date": 1548255653, "creation_date": 1548249534, "last_edit_date": 1548250378, "question_id": 54328194, "link": "https://stackoverflow.com/questions/54328194/forwarding-parameters-indirectly-deducible-from-function-pointer-type", "title": "forwarding parameters indirectly deducible from function pointer type", "body": "<p>I want to have a function which accepts a pointer to a function and forwards all parameters as given by the function pointer type itself like this:</p>\n\n<pre><code>template &lt; typename RET, typename ... ARGS &gt;\nauto Do1( RET(*ptr)(ARGS...), ARGS... args )\n{\n    (*ptr)(std::forward&lt;ARGS&gt;( args )...);\n}\n\nint main ()\n{\n    int i=4;\n\n    Do1( &amp;Ex1, i );\n    Do1( &amp;Ex2, i ); //fails!\n    Do1( &amp;Ex3, i+1 ); // fails\n}\n</code></pre>\n\n<p>Functions to call are for both examples:</p>\n\n<pre><code>void Ex1( int i){ std::cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; \" \" &lt;&lt; i &lt;&lt; std::endl; i=10;}\nvoid Ex2( int&amp; i){ std::cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; \" \" &lt;&lt; i &lt;&lt; std::endl; i=20;}\nvoid Ex3( int&amp;&amp; i){ std::cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; \" \" &lt;&lt; i &lt;&lt; std::endl; i=30;}\n</code></pre>\n\n<p>It fails in case of <code>Ex2</code>and <code>Ex3</code> simply while it tries to deduce the type of the ARGS list two times and the result is different. The compiler complains with:</p>\n\n<pre><code>main.cpp:57:22: error: no matching function for call to 'Do1(void (*)(int&amp;), int&amp;)'\n         Do1( &amp;Ex2, i ); //fails!\n                      ^   \nmain.cpp:33:10: note: candidate: 'template&lt;class RET, class ... ARGS&gt; auto Do1(RET (*)(ARGS ...), ARGS ...)'\n     auto Do1( RET(*ptr)(ARGS...), ARGS... args )\n          ^~~ \nmain.cpp:33:10: note:   template argument deduction/substitution failed:\nmain.cpp:57:22: note:   inconsistent parameter pack deduction with 'int&amp;' and 'int'\n</code></pre>\n\n<p>After that I tried to work around the problem with the following approach as I pick up the types by only one time deducing the ARGS list and forward once more to a intermediate lambda as follows:</p>\n\n<pre><code>template &lt; typename RET, typename ... ARGS &gt;\nauto Do2( RET(*ptr)(ARGS...) )\n{   \n    return [ptr]( ARGS ... args )\n    {\n        std::cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; std::endl;\n        (*ptr)(std::forward&lt;ARGS&gt;(args)...); \n    };\n}   \n\nint main ()\n{   \n    int i=4;\n\n    Do1( &amp;Ex1, i );\n    Do1( &amp;Ex2, i ); //fails!\n    Do1( &amp;Ex3, i+1 ); // fails\n\n    Do2( &amp;Ex1 )( i );\n    std::cout &lt;&lt; \"now i: \" &lt;&lt; i &lt;&lt; std::endl;\n    std::cout &lt;&lt; std::endl;\n\n    Do2( &amp;Ex2 )( i );\n    std::cout &lt;&lt; \"now i: \" &lt;&lt; i &lt;&lt; std::endl;\n    std::cout &lt;&lt; std::endl;\n\n    Do2( &amp;Ex3 )( i+1 );\n    std::cout &lt;&lt; \"now i: \" &lt;&lt; i &lt;&lt; std::endl;\n    std::cout &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Q: Is there any way to repair the first approach in any case to get rid of the intermediate lambda here? And if not, is the solution with the intermediate lambda \"well\" designed, especially with all the \"forwarding\" things so that I did not create some copies or other unexpected behavior?</p>\n\n<p>EDIT:\nThis is only a reduced example. It is not my intend to write a copy of <code>std::invoke</code>. So there is in my real world code a lot more to do inside the <code>Do</code> method itself.</p>\n\n<p>It is important to get the needed types from the function pointer type as I have to perform some checks inside <code>Do</code> which are related to the types provided by the function pointer and <em>not</em> from the given additional parameters I provide from the user code to the <code>Do</code> method.</p>\n"}, {"tags": ["c++", "qt", "qt5", "qtabwidget"], "answers": [{"tags": [], "owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1548270499, "creation_date": 1548270499, "answer_id": 54334088, "question_id": 54328100, "link": "https://stackoverflow.com/questions/54328100/use-setwindowmodified-on-qtabwidget/54334088#54334088", "title": "Use setWindowModified() on QTabWidget", "body": "<p>I don't think there's any way to get the tab text to follow the widget title by default.  Having said that, it should be very easy to fix up by overriding <a href=\"http://doc.qt.io/qt-5/qtabwidget.html#tabInserted\" rel=\"nofollow noreferrer\"><code>QTabWidget::tabInserted</code></a>.</p>\n\n<pre><code>class tab_widget: public QTabWidget {\n  using super      = QTabWidget;\n  using this_class = tab_widget;\npublic:\n  using super::super;\nprotected:\n  virtual void tabInserted (int index) override\n    {\n      super::tabInserted(index);\n      if (auto *w = widget(index)) {\n        connect(w, &amp;QWidget::windowTitleChanged, this, &amp;this_class::handle_window_title_change);\n      }\n    }\n  virtual void tabRemoved (int index) override\n    {\n      super::tabRemoved(index);\n      if (auto *w = widget(index)) {\n        disconnect(w, &amp;QWidget::windowTitleChanged, this, &amp;this_class::handle_window_title_change);\n      }\n    }\nprivate:\n  void handle_window_title_change (const QString &amp;title)\n    {\n      if (auto *w = qobject_cast&lt;QWidget *&gt;(sender())) {\n        setTabText(indexOf(w), title);\n      }\n    }\n};\n</code></pre>\n\n<p>Using the above class rather than <code>QTabWidget</code> should result in the tab text mirroring the title of the widget associated with that tab.</p>\n"}], "owner": {"reputation": 3061, "user_id": 881712, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/852956f1a8a603a7d09d10e856f821be?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/881712/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 54334088, "answer_count": 1, "score": 0, "last_activity_date": 1548270633, "creation_date": 1548249205, "last_edit_date": 1548270633, "question_id": 54328100, "link": "https://stackoverflow.com/questions/54328100/use-setwindowmodified-on-qtabwidget", "title": "Use setWindowModified() on QTabWidget", "body": "<p>Because <code>QTabWidget</code> inherits <code>QWidget</code> we have <code>setWindowModified()</code> available.\nBut it seems it doesn't work for the tab title:</p>\n\n<pre><code>ui-&gt;tab1-&gt;setWindowTitle(QString(\"%1[*]\").arg(tr(\"Tab title\")));\nui-&gt;tab1-&gt;setWindowModified(true);\n</code></pre>\n\n<p>but it doesn't show the '*' nor changes the tab text.\nIs there a way to handle this automatically instead of manually use <code>setTabText()</code>?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 7, "creation_date": 1548248837, "post_id": 54327951, "comment_id": 95473913, "body": "Pointers (smart or not) to containers are not useful very often. What is the reason you need pointers to vectors?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 7, "creation_date": 1548248869, "post_id": 54327951, "comment_id": 95473930, "body": "Looks okay, but using a pointer to a vector instead of a plain vector is a bit weird and <code>std::copy</code> would do the right thing without you having to scratch your head."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 5, "creation_date": 1548249258, "post_id": 54327951, "comment_id": 95474135, "body": "This code is really hard to read and follow. Even if it&#39;s correct you&#39;re going to have substantial maintenance problems. I suggest reworking it."}, {"owner": {"reputation": 97, "user_id": 10955842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdf44848487b26d5584dd1b56c4d41b2?s=128&d=identicon&r=PG&f=1", "display_name": "A. Cimet", "link": "https://stackoverflow.com/users/10955842/a-cimet"}, "edited": false, "score": 0, "creation_date": 1548249308, "post_id": 54327951, "comment_id": 95474162, "body": "The copying part is written in a different function, to which I am trying to pass the values of vectors."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548251183, "post_id": 54327951, "comment_id": 95475357, "body": "<code>std::vector</code> has the meber functions <code>insert</code> and <code>append</code>.  You should be using those t copy elements from one vector to another.  AFAIK, the big three all optimize this to a <code>memcpy</code> for POD types."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1548251577, "post_id": 54327951, "comment_id": 95475577, "body": "I would honestly consider rewriting this without using <code>std::unique_ptr</code> (nor any kind of pointer to vector) and without using <code>memcpy</code>. Just use <code>std::vector</code> and <code>std::copy</code> etc. It might even be more efficient without the extra indirection. The resulting code should definitely be less error prone."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 0, "last_activity_date": 1548253157, "last_edit_date": 1548253157, "creation_date": 1548252855, "answer_id": 54329199, "question_id": 54327951, "link": "https://stackoverflow.com/questions/54327951/using-memcpy-with-a-unique-ptr-to-a-vector/54329199#54329199", "title": "Using memcpy with a unique_ptr to a vector", "body": "<p>Firstly, there is hardly ever a reason to allocate a vector dynamically. You can simplify the program a lot by using automatic storage:</p>\n\n<pre><code>std::vector&lt;unsigned int&gt; filtered_profile(baselength);\nstd::vector&lt;unsigned int&gt; profile_vector(length + filter_size - 1);\n</code></pre>\n\n<p>Hidden problem of <code>memcpy</code> is that it only works with trivially copyable types - for others the behaviour is undefined. Sure, your copies may be trivial at the moment (assuming I've read your code correctly in that you're coping the internal buffers of the vectors), but there is no need to rely on that subtle detail: You could use <code>std::copy</code> instead which works with non-trivially types as well.</p>\n\n<p>This program should do what your memcpy does, unless I misread your program. Except this works on vectors without smart pointers. This is much more readable, at least to me:</p>\n\n<pre><code>assert(std::size(profileVector) &gt;= length);\nauto srcB = std::begin(profileVector); // begin\nauto srcE = srcB + length;             // end\nauto srcL = srcE - win_size_left;      // left from end\nauto srcR = srcB + win_size_right;     // right from begin\n\n\nassert(std::size(profile_vector) &gt;= win_size_left + length + win_size_right);\nauto dst0 = std::begin(profile_vector);\nauto dst1 = dst0 + win_size_left;\nauto dst2 = dst1 + length;\n\nstd::copy(srcL, srcE, dst0);\nstd::copy(srcB, srcE, dst1);\nstd::copy(srcB, srcR, dst2);\n</code></pre>\n\n<p>P.S. Note that naming two variables <code>profile_vector</code> and <code>profileVector</code> is highly confusing. Consider renaming one of them. Furthermore, it is unclear how <code>filtered_profile</code> is related to the copying.</p>\n"}], "owner": {"reputation": 97, "user_id": 10955842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdf44848487b26d5584dd1b56c4d41b2?s=128&d=identicon&r=PG&f=1", "display_name": "A. Cimet", "link": "https://stackoverflow.com/users/10955842/a-cimet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 54329199, "answer_count": 1, "score": 1, "last_activity_date": 1548253157, "creation_date": 1548248673, "last_edit_date": 1548248866, "question_id": 54327951, "link": "https://stackoverflow.com/questions/54327951/using-memcpy-with-a-unique-ptr-to-a-vector", "title": "Using memcpy with a unique_ptr to a vector", "body": "<p>I am writing a piece of code, where I need to copy a pointer to a vector or some part of it - defined as:</p>\n\n<pre><code>std::unique_ptr&lt;std::vector&lt;unsigned int&gt;&gt; filtered_profile_ptr = \n  std::make_unique&lt;std::vector&lt;unsigned int&gt;&gt;((int)baselength);\n</code></pre>\n\n<p>to another pointer to a vector - defined as:</p>\n\n<pre><code>std::unique_ptr&lt;std::vector&lt;unsigned int&gt;&gt; profile_vector = \n  std::make_unique&lt;std::vector&lt;unsigned int&gt;&gt;(length + filter_size - 1);\n</code></pre>\n\n<p>I am doing that using the memcpy function - like this:</p>\n\n<pre><code>memcpy(&amp;(*profile_vector)[0], &amp;(*profileVector)[length - win_size_left], win_size_left * sizeof(unsigned int));\nmemcpy(&amp;(*profile_vector)[win_size_left], &amp;(*profileVector)[0], length * sizeof(unsigned int));\nmemcpy(&amp;(*profile_vector)[length + win_size_left], &amp;(*profileVector)[0], win_size_right * sizeof(unsigned int));\n</code></pre>\n\n<p>My question is: Does using memcpy this way provide some hidden problems, concerning memory in some cases, or maybe some problems concerning the buffer. </p>\n\n<p>P.S. The code runs fine, I am only concerned with the problems that can't be seen.</p>\n"}, {"tags": ["c++", "oop", "architecture", "stl", "singleton"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4721086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5abe24d39bb90a7e4eae00a34b2df5b?s=128&d=identicon&r=PG&f=1", "display_name": "Micah Martin", "link": "https://stackoverflow.com/users/4721086/micah-martin"}, "edited": false, "score": 0, "creation_date": 1548254783, "post_id": 54329070, "comment_id": 95477562, "body": "Thank you so much for this suggestion! everyone has been telling me to just go with a singleton but this is beautiful, you&#39;re the best."}], "tags": [], "owner": {"reputation": 646, "user_id": 1494134, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e0ad40b49b7be9f65ddd411039814672?s=128&d=identicon&r=PG", "display_name": "Carmine Ingaldi", "link": "https://stackoverflow.com/users/1494134/carmine-ingaldi"}, "is_accepted": true, "score": 1, "last_activity_date": 1548252900, "last_edit_date": 1548252900, "creation_date": 1548252415, "answer_id": 54329070, "question_id": 54327934, "link": "https://stackoverflow.com/questions/54327934/c-proper-singleton-use-case/54329070#54329070", "title": "C++ proper singleton use case", "body": "<p>You can use singleton instead of injecting your dependencies explicitly but be aware that this design leads to a less testable code and high functional coupling between components.  Other ecosystems have addressed this issue introducing means to inject dependencies in a declarative fashion, thanks to frameworks that provide mechanism to replace actual depencencies with \"test doubles\". Check out how Spring MVC works with Java applications.</p>\n\n<p>If you're sure that this is what you need, you could use a similar (but still less flexible) approach implementing a \"service locator\" pattern which consists in a single point that holds pointers to instances of \"injectable\" objects</p>\n\n<pre><code>ServiceLocator::inject&lt;Screen*&gt;(new Screen () , \"screen1\")\n\n//\n\n...\n\n//\nScreen* s = ServiceLocator::getInstance&lt;Screen*&gt;(\"screen1\")\n</code></pre>\n\n<p>In this way you can avoid to pass pointers around and at same time be more decoupled. Now suppose that you have a MockScreen that inherits from Screen. Suppose also that you want to test the method int MyClass::workWithScreen() which depends on an instance of Screen referenced with the label \"screen1\". You can write your test like</p>\n\n<pre><code>Myclass unitUnderTest;\nServiceLocator::inject&lt;Screen*&gt;(new MockScreen () , \"screen1\");\n\nint result = unitUnderTest.workWithScreen()\n\nassert ....\n</code></pre>\n\n<p>I'll leave you as exercise to implement the service locator!</p>\n\n<p>Keep in mind that, in this way, your are introducing in your code also the drawbacks of dependency injection: the worst of them is that you loose the control over the design of your component layout, every object can access every object. This is not a big issue when you are developing some REST api handler which is based on solid and well known architectural pattern (controller -> service -> repository -> db and then go back) but you have to be careful in other contexts!</p>\n"}], "owner": {"reputation": 31, "user_id": 4721086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5abe24d39bb90a7e4eae00a34b2df5b?s=128&d=identicon&r=PG&f=1", "display_name": "Micah Martin", "link": "https://stackoverflow.com/users/4721086/micah-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 1, "accepted_answer_id": 54329070, "answer_count": 1, "score": -2, "last_activity_date": 1548252900, "creation_date": 1548248614, "question_id": 54327934, "link": "https://stackoverflow.com/questions/54327934/c-proper-singleton-use-case", "title": "C++ proper singleton use case", "body": "<p>I'm making a game to practice good design/arch and I think I programmed myself into a check. I'm not sure if my architecture is clean right now, some advice would be clutch. </p>\n\n<p>I have a <code>class Game</code> that holds an instance of <code>class GraphicsManager</code> <code>class InputManager</code> and <code>class StateManager</code></p>\n\n<p>The graphics manager handles sdl stuff as does the input manager. the state manager is a stack of abstract type <code>class GameState</code></p>\n\n<p>Each frame, the game calls update on the GameState at the top of the state stack and passes said state a StateManager pointer so that the GameState can push a new state or pop itself from the stack.</p>\n\n<p><code>GameState* currentState = stateManager.getState() //return top</code>\n<code>currentState.update(&amp;stateManager) // state might change here</code></p>\n\n<p>The issue is when I introduce my <code>class Screen</code>. Screen should be owned by the various implementations of GameState, so if I had OpeningState I'd expect for it to own OpeningScreen. \nThe issue is, Screen needs access to the Graphics instance to get a pointer to the SDL_Renderer and I don't see a good place to pass that pointer down. Passing the pointer from Game --> GameState --> Screen feels kind of funky.</p>\n\n<p>I feel like I need to turn each 'Manager' into a singleton but if theres something more elegant I'd love to learn</p>\n\n<p>heres my spaghetti code for ref <a href=\"https://github.com/MicahMartin/FightingGame/tree/master/src\" rel=\"nofollow noreferrer\">https://github.com/MicahMartin/FightingGame/tree/master/src</a></p>\n"}, {"tags": ["c++", "ide"], "comments": [{"owner": {"reputation": 1194, "user_id": 4782513, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ca2834b0654459b57ca36c59d90e1848?s=128&d=identicon&r=PG&f=1", "display_name": "newkid", "link": "https://stackoverflow.com/users/4782513/newkid"}, "edited": false, "score": 0, "creation_date": 1548248293, "post_id": 54327773, "comment_id": 95473603, "body": "How about using <code>git</code>?"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1548248691, "post_id": 54327773, "comment_id": 95473832, "body": "How about a virtual machine?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1548249304, "post_id": 54327773, "comment_id": 95474158, "body": "Personally, I&#39;d just do everything remotely, but I&#39;m also way more productive and have a better workflow using emacs than some ide."}, {"owner": {"reputation": 1477, "user_id": 5899776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/64b8e28377778d1b8ad57198ba46c319?s=128&d=identicon&r=PG&f=1", "display_name": "van dench", "link": "https://stackoverflow.com/users/5899776/van-dench"}, "edited": false, "score": 0, "creation_date": 1548253761, "post_id": 54327773, "comment_id": 95476848, "body": "I\u2019ve seen a lot of people mention git, but I didn\u2019t see anyone mention that you can also setup Continuous Integration to automatically pull and compile code when a commit comes in."}, {"owner": {"reputation": 573, "user_id": 6328514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yae7F.jpg?s=128&g=1", "display_name": "Lewis Chan", "link": "https://stackoverflow.com/users/6328514/lewis-chan"}, "reply_to_user": {"reputation": 1194, "user_id": 4782513, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ca2834b0654459b57ca36c59d90e1848?s=128&d=identicon&r=PG&f=1", "display_name": "newkid", "link": "https://stackoverflow.com/users/4782513/newkid"}, "edited": false, "score": 0, "creation_date": 1548296993, "post_id": 54327773, "comment_id": 95493857, "body": "@newkid  git seems not be an option. Sometimes the changes are not a complete commit, so it&#39;s very undesiable to make codebase full of uncomplete modifications."}, {"owner": {"reputation": 573, "user_id": 6328514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yae7F.jpg?s=128&g=1", "display_name": "Lewis Chan", "link": "https://stackoverflow.com/users/6328514/lewis-chan"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1548297069, "post_id": 54327773, "comment_id": 95493875, "body": "@Shawn Any blogs about your workflow ?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1548332517, "post_id": 54327773, "comment_id": 95508408, "body": "A blog? Lol no. Write code, compile, debug, repeat."}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 6328514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yae7F.jpg?s=128&g=1", "display_name": "Lewis Chan", "link": "https://stackoverflow.com/users/6328514/lewis-chan"}, "edited": false, "score": 0, "creation_date": 1548301946, "post_id": 54327868, "comment_id": 95494822, "body": "Thanks for many options. For Option 1, I&#39;m very curious. Do you mean you can install QtCreator(which is one of my favourite IDE) on linux and run it via mobaxtem on Windows ?"}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "reply_to_user": {"reputation": 573, "user_id": 6328514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yae7F.jpg?s=128&g=1", "display_name": "Lewis Chan", "link": "https://stackoverflow.com/users/6328514/lewis-chan"}, "edited": false, "score": 0, "creation_date": 1548320936, "post_id": 54327868, "comment_id": 95501563, "body": "@LewisChan Yes. This is what I do all the time. You&#39;re gonna love it! The only problem there is that you can&#39;t save your sessions. So if your laptop (Windows machine) shuts down, you&#39;ll have to restart Qt Creator. Also if the connection gets interrupted, it&#39;ll close. Mobaxterm, however, does everything it can to keep the session connected. Some times even if I forcibly disconnect my wifi."}], "tags": [], "owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "is_accepted": true, "score": 1, "last_activity_date": 1548248833, "last_edit_date": 1548248833, "creation_date": 1548248417, "answer_id": 54327868, "question_id": 54327773, "link": "https://stackoverflow.com/questions/54327773/efficient-method-of-writing-c-code-in-windows-ide-and-compiling-in-linux-termi/54327868#54327868", "title": "Efficient method of writing C++ code in Windows IDE and compiling in Linux terminal?", "body": "<p>Here are some options:</p>\n\n<ul>\n<li><strong>Option 1:</strong> Use <a href=\"https://mobaxterm.mobatek.net/\" rel=\"nofollow noreferrer\">mobaxterm</a> (which is a very fast xserver on windows) to run your IDE. I run Qt Creator over the internet and it's instantaneous, so no lags.</li>\n<li><strong>Option 2:</strong> Use VNC only for that program. So create some VNC server and run your IDE in it. This doesn't work for me because the VNC server (realvnc I think) crashes all the time. Maybe you'll be lucky.</li>\n<li><strong>Option 3:</strong> Use VNC with desktop environment. I got this to work at work, but not at home. It depends on what desktop environment you want to use, something like icewm is fine (the command on linux is <code>vncserver</code> for that).</li>\n<li><strong>Option 4:</strong> Use <a href=\"https://wiki.x2go.org/doku.php\" rel=\"nofollow noreferrer\">X2Go</a> as your remote environment. Install the server on your linux, and connect to it with ssh.</li>\n<li><strong>Option 5:</strong> Use <a href=\"http://www.xrdp.org/\" rel=\"nofollow noreferrer\">xrdp</a> protocol. Install it on linux, and use windows remote desktop to connect to your linux machine from windows.</li>\n</ul>\n\n<p><strong>Warning:</strong> If you're using VNC, be aware that the standard VNC implementation doesn't provide encrypted connection. So you should use something like ssh tunnel (with putty, or similar) from Windows to Linux, then tunnel your VNC connection through it.</p>\n"}, {"comments": [{"owner": {"reputation": 573, "user_id": 6328514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yae7F.jpg?s=128&g=1", "display_name": "Lewis Chan", "link": "https://stackoverflow.com/users/6328514/lewis-chan"}, "edited": false, "score": 0, "creation_date": 1548297309, "post_id": 54327870, "comment_id": 95493923, "body": "The thing is, before compiling I may  make some unware mistakes such as grammar errors, spelling errors or logical errors. I don&#39;t think the changes can make a resonable commit ."}, {"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "reply_to_user": {"reputation": 573, "user_id": 6328514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yae7F.jpg?s=128&g=1", "display_name": "Lewis Chan", "link": "https://stackoverflow.com/users/6328514/lewis-chan"}, "edited": false, "score": 0, "creation_date": 1548316926, "post_id": 54327870, "comment_id": 95499622, "body": "You have a point. But 1-unless some really specific situation, there shouldn&#39;t be a reason not to be able to build on Windows. 2-sure, erroneous commits are not desirable, but they can be squashed afterwards if that is really annoying. But, sure, remote viewing (other answer) is also a nice idea."}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 1, "creation_date": 1548322371, "post_id": 54327870, "comment_id": 95502419, "body": "I don&#39;t believe anyone in the world really uses this solution and really gets results for huge programs. I&#39;m just imagining the amount of time wasted committing, pushing, building (with make parallelization since you have templates in your program and want to finish fast), then having to scroll up and down to see that you typed <code>cot</code> instead of <code>cout</code>... then going back to your IDE, fix it, commit, push, and go back again to terminal, to see that you missed a semi-colon somewhere else. I would quit programming before having to do this. Are you gonna scroll through all of it to find warnings?"}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 1, "creation_date": 1548322715, "post_id": 54327870, "comment_id": 95502636, "body": "[...] I build with Qt Creator with Ctrl+b. It shows me warnings immediately. It also uses clang model to predict compilation errors before compiling. I run valgrind with 1 click to do memory checks for my final program. I run debugger with 1 click, and can navigate through my debugged code without having to type <code>up</code> <code>up</code> <code>up</code> to reach my current stack frame. Because I click on the stack frame I want. I run function profiling with 1 click. I will never understand how people get work done with terminals only. Well, maybe in the 1990s. But now you have Qt Creator and/or VSCode for this luxury."}, {"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "reply_to_user": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1548324547, "post_id": 54327870, "comment_id": 95503764, "body": "@TheQuantumPhysicist I agree this workflow isn&#39;t the best. But what if you don&#39;t have a desktop on the remote machine?"}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 1, "creation_date": 1548325561, "post_id": 54327870, "comment_id": 95504351, "body": "@kebs We all went into these situations, but then it&#39;s not a full dev environment that you can suggest to OP! He&#39;s asking for a convenient setup for his development. You can&#39;t suggest a temporary solution to a temporary problem for someone who&#39;s looking for a permanent setup. And to answer your question: You install a desktop on that machine if you have to. Otherwise, it&#39;s not a proper machine for permanent development."}], "tags": [], "owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "is_accepted": false, "score": 1, "last_activity_date": 1548251843, "last_edit_date": 1548251843, "creation_date": 1548248423, "answer_id": 54327870, "question_id": 54327773, "link": "https://stackoverflow.com/questions/54327773/efficient-method-of-writing-c-code-in-windows-ide-and-compiling-in-linux-termi/54327870#54327870", "title": "Efficient method of writing C++ code in Windows IDE and compiling in Linux terminal?", "body": "<p>Here is how I work in this situation:</p>\n\n<ol>\n<li>setup a distant Git repo</li>\n<li>use your regular workstation to edit your code (Windows OS), using the IDE that suits you needs</li>\n<li>keep a shell open on your remote Linux machine (SSH)</li>\n<li>As soon as you have something runnable/testable:\n\n<ol>\n<li><code>commit</code> your changes and <code>git push</code></li>\n<li>in your Linux Shell: <code>git pull</code> &amp; build (<code>make</code> ?)</li>\n</ol></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 573, "user_id": 6328514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yae7F.jpg?s=128&g=1", "display_name": "Lewis Chan", "link": "https://stackoverflow.com/users/6328514/lewis-chan"}, "edited": false, "score": 0, "creation_date": 1548300072, "post_id": 54329784, "comment_id": 95494500, "body": "That seems a solution, but not good for me. Starting a VM on Windows will slow down other apps. Besides the c++ project I build consumes much more resources when compiling."}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1548321809, "post_id": 54329784, "comment_id": 95502079, "body": "Not only that VMs are very impractical for performance reasons, but VirtualBox is aweful anyway. It&#39;s very slow. I used VMWare for years, but it&#39;s kind of impractical to keep everything on your laptop. At some point your laptop can&#39;t handle all the memory required for debugging and memory analysis. My ideal solution is ssh to my workstation and use it. This depends on whether your apps are &quot;Hello World!&quot; or ones with 2000 source files. For small apps... who cares? VM is fine."}, {"owner": {"reputation": 332, "user_id": 4196087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99bfd69164d18d75fcf3f6807cf8d96a?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/4196087/ben"}, "edited": false, "score": 0, "creation_date": 1548343044, "post_id": 54329784, "comment_id": 95514994, "body": "Fair points. An adaptation of this would be to run Linux on a separate physical machine and share/mount the project directory over the LAN. Just &#39;optioneering&#39;. :)"}], "tags": [], "owner": {"reputation": 332, "user_id": 4196087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99bfd69164d18d75fcf3f6807cf8d96a?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/4196087/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1548254707, "creation_date": 1548254707, "answer_id": 54329784, "question_id": 54327773, "link": "https://stackoverflow.com/questions/54327773/efficient-method-of-writing-c-code-in-windows-ide-and-compiling-in-linux-termi/54329784#54329784", "title": "Efficient method of writing C++ code in Windows IDE and compiling in Linux terminal?", "body": "<p>I just use VirtualBox:</p>\n\n<ol>\n<li>Create a VM containing your favorite flavor of Linux</li>\n<li>Create a project in your Windows IDE of choice - I use VS2015 at the mo.</li>\n<li>Set the VS project directory as an external mount point/shared folder of the VM. So all code changes are intrinsically available to the Linux machine.</li>\n<li>When its time to compile just alt-tab to the VM windows and type make (assuming you've create your MakeFile ;) )</li>\n</ol>\n"}], "owner": {"reputation": 573, "user_id": 6328514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yae7F.jpg?s=128&g=1", "display_name": "Lewis Chan", "link": "https://stackoverflow.com/users/6328514/lewis-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 54327868, "answer_count": 3, "score": 0, "last_activity_date": 1548254707, "creation_date": 1548248085, "question_id": 54327773, "link": "https://stackoverflow.com/questions/54327773/efficient-method-of-writing-c-code-in-windows-ide-and-compiling-in-linux-termi", "title": "Efficient method of writing C++ code in Windows IDE and compiling in Linux terminal?", "body": "<p>First of all, it's all about maximizing the productivity as a c++ programmer. My regular work is to use Windows ssh client such as <code>xshell</code> to log in to remote linux machine via ssh and do many linux work there. Imagine I want to set up a big C++ project, and now I'm faced with a trouble.</p>\n\n<ul>\n<li>If I write code in Windows IDE, I need to propagate the changes every time I modify some files to linux machine, and compile there. (Consider compiling in Windows is not feasible or very slow)</li>\n<li>If I write code in linux terminal, as it's gonna be a big project(not just a simple hellowrold), the productivity in working on vim or emacs cannot match with  that in Windows IDE.</li>\n</ul>\n\n<p>Here I want to exclude some options such as <code>samba</code>, configuring many plugins for vim, or just buy a Mac. And if I write in Windows, it's undesirable to copy the whole contents to remote machine every time syncing with it.</p>\n\n<p>Any ways or tools to make this process easier and productive ?</p>\n"}, {"tags": ["c++", "opencv", "graph", "gpu"], "comments": [{"owner": {"reputation": 168, "user_id": 7137791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K-hMkhLnvAM/AAAAAAAAAAI/AAAAAAAAAHQ/hVLJcAYa7Zs/photo.jpg?sz=128", "display_name": "Nitin Pawar", "link": "https://stackoverflow.com/users/7137791/nitin-pawar"}, "edited": false, "score": 0, "creation_date": 1548246467, "post_id": 54327129, "comment_id": 95472597, "body": "<a href=\"https://docs.opencv.org/3.4/dc/d66/group__cudafilters.html#gaa4df286369114cfd4b144ae211f6a6c8\" rel=\"nofollow noreferrer\">docs.opencv.org/3.4/dc/d66/&hellip;</a> Did you take a look at this?"}, {"owner": {"reputation": 414, "user_id": 9574775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iAzne.jpg?s=128&g=1", "display_name": "kevin su", "link": "https://stackoverflow.com/users/9574775/kevin-su"}, "reply_to_user": {"reputation": 168, "user_id": 7137791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K-hMkhLnvAM/AAAAAAAAAAI/AAAAAAAAAHQ/hVLJcAYa7Zs/photo.jpg?sz=128", "display_name": "Nitin Pawar", "link": "https://stackoverflow.com/users/7137791/nitin-pawar"}, "edited": false, "score": 0, "creation_date": 1548246706, "post_id": 54327129, "comment_id": 95472720, "body": "is this equal to GaussianBlur, but in GPU compare web, there compare lots of opencv API, not only GaussianBlur,how about others."}, {"owner": {"reputation": 168, "user_id": 7137791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K-hMkhLnvAM/AAAAAAAAAAI/AAAAAAAAAHQ/hVLJcAYa7Zs/photo.jpg?sz=128", "display_name": "Nitin Pawar", "link": "https://stackoverflow.com/users/7137791/nitin-pawar"}, "edited": false, "score": 0, "creation_date": 1548247082, "post_id": 54327129, "comment_id": 95472918, "body": "I think mathematics is the same, although you might have to add a few more steps. Again, not sure. About the rest, you have to explore namespace &quot;cuda&quot;."}], "owner": {"reputation": 414, "user_id": 9574775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iAzne.jpg?s=128&g=1", "display_name": "kevin su", "link": "https://stackoverflow.com/users/9574775/kevin-su"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548247212, "creation_date": 1548245990, "last_edit_date": 1548247212, "question_id": 54327129, "link": "https://stackoverflow.com/questions/54327129/dose-any-gpu-version-of-gaussianblur-in-opencv-3-4-5", "title": "Dose any gpu version of GaussianBlur in Opencv-3.4.5", "body": "<p>I am using <strong><em>opencv-3.4.5</em></strong> now,</p>\n\n<p>but I want to use GPU to accelerate my GaussianBlur, Canny, and findContours API.</p>\n\n<p>I know there is gpu::GaussianBlur in <strong><em>opencv-2.4.13.7</em></strong>,</p>\n\n<p>they have namespace GPU to accelerate processing graph.</p>\n\n<blockquote>\n  <p><a href=\"https://docs.opencv.org/2.4/modules/gpu/doc/image_filtering.html?highlight=blur\" rel=\"nofollow noreferrer\">opencv-2.4.13.7 GPU</a></p>\n</blockquote>\n\n<p>On the other hand, opencv-3.4.5 suppot namespace <strong>cuda</strong> for gpu, </p>\n\n<p>but I didn't see any API like gpu::GaussianBlur,which I can use.</p>\n\n<blockquote>\n  <p><a href=\"https://docs.opencv.org/3.1.0/d1/d1a/namespacecv_1_1cuda.html\" rel=\"nofollow noreferrer\">opencv-3.4.5 CUDA</a></p>\n</blockquote>\n\n<p>I found a website to compare Opencv API performance use GPU or not.</p>\n\n<blockquote>\n  <p><a href=\"https://jamesbowley.co.uk/opencv-3-4-gpu-cuda-performance-comparison-nvidia-vs-intel/\" rel=\"nofollow noreferrer\">opencv GPU performance comparison</a></p>\n</blockquote>\n\n<p>My question is does any GaussianBlur API for GPU in opencv-3.4.5,</p>\n\n<p>or other way I can used to accelerate it.</p>\n"}, {"tags": ["c++", "dictionary", "stl", "set", "composition"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4697826, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4697996b5159a93aa8b2890030697e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4697826/matt"}, "edited": false, "score": 0, "creation_date": 1548247008, "post_id": 54327328, "comment_id": 95472877, "body": "ahh ok it seems to work thanks (though i have no understand good how methods works). And to read it? I tried with    &#39;&#39;&#39;map&lt;string, set&lt;string&gt;&gt;::iterator iter = m.begin();             for (; iter != m.end(); ++iter) {                 cout &lt;&lt; iter-&gt;first &lt;&lt; &quot; &quot; &lt;&lt; iter-&gt;second &lt;&lt; endl;             } &#39;&#39;&#39; but it gives errors in operator &lt;&lt; (i have iostream included and namespace std)"}, {"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "reply_to_user": {"reputation": 109, "user_id": 4697826, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4697996b5159a93aa8b2890030697e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4697826/matt"}, "edited": false, "score": 0, "creation_date": 1548247633, "post_id": 54327328, "comment_id": 95473246, "body": "@Romans Your code and error description should be in <a href=\"https://stackoverflow.com/posts/54327128/edit\">your question</a> but okay. <code>iter-&gt;second</code> has a type of <code>set</code>, doesn&#39;t it? <code>cout</code> doesn&#39;t know how to handle that. You&#39;ll probably want a second loop working with <code>set::iterator</code>. (You can also define an <code>operator&lt;&lt;</code> that will accept <code>std::set</code>s, but this may be a bit challenging.)"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1551693578, "post_id": 54327328, "comment_id": 96719483, "body": "@TrebuchetMS the default program at <a href=\"http://coliru.stacked-crooked.com/\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com</a> has a <code>&lt;&lt;</code> for <code>vector</code>, you can just swap in <code>set</code> to that"}], "tags": [], "owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "is_accepted": true, "score": 3, "last_activity_date": 1551694082, "last_edit_date": 1551694082, "creation_date": 1548246615, "answer_id": 54327328, "question_id": 54327128, "link": "https://stackoverflow.com/questions/54327128/insert-read-a-set-into-a-map/54327328#54327328", "title": "Insert/read a set into a map", "body": "<p>Just treat your <code>m[volo]</code> like any kind of regular set. Your <code>set</code> will be default-constructed once you access its value using <a href=\"https://en.cppreference.com/w/cpp/container/map/operator_at\" rel=\"nofollow noreferrer\"><code>std::map::operator[]</code></a>. This allows you to directly use any of <code>set</code>'s member functions. To add a value to the set, use <a href=\"https://en.cppreference.com/w/cpp/container/set/insert\" rel=\"nofollow noreferrer\"><code>std::set::insert</code></a>.</p>\n\n<p>Here's what your code might look like using standard input/output:</p>\n\n<pre><code>string a, b;\nwhile (cin &gt;&gt; a &gt;&gt; b) {\n    m[a].insert(b);\n    cout &lt;&lt; m[a].size() &lt;&lt; endl;\n}\n</code></pre>\n\n<hr>\n\n<p>If you want to output your set, a convenient way to do this would be to define an overload over <code>operator&lt;&lt;</code>. The following defines a template any set.</p>\n\n<pre><code>template&lt;typename T&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const std::set&lt;T&gt;&amp; s)\n{\n    for (auto&amp; el : s)\n        os &lt;&lt; el &lt;&lt; ' ';\n    return os;\n}\n</code></pre>\n\n<p>This allows you to do the following without any errors.</p>\n\n<pre><code>for (auto it = m.begin(); it != m.end(); ++it)\n{\n    cout &lt;&lt; it-&gt;first;   // a string\n    cout &lt;&lt; ' ';\n    cout &lt;&lt; it-&gt;second;   // a set\n    cout &lt;&lt; endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4697826, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4697996b5159a93aa8b2890030697e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4697826/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 54327328, "answer_count": 1, "score": 2, "last_activity_date": 1551694082, "creation_date": 1548245986, "last_edit_date": 1551691579, "question_id": 54327128, "link": "https://stackoverflow.com/questions/54327128/insert-read-a-set-into-a-map", "title": "Insert/read a set into a map", "body": "<p>I want to 'manage' flights, using <code>map&lt;string, set&lt;string&gt;&gt;</code>. The <code>string</code> keys represents the flight number while the <code>set&lt;string&gt;</code> values represent the people's name registered onto the flight. In my case, I read data from a simple text file such as:</p>\n\n<pre><code>123 jhonny\n132 harry\n123 bill\n145 herry\n132 jarry\n</code></pre>\n\n<p>in order to find the people in the same flight.</p>\n\n<p>I know that a basic way to insert into a map is</p>\n\n<pre><code>map&lt;string, string&gt; m;\nm[\"hi\"] = test;\n</code></pre>\n\n<p>and using the iterator to read the container.</p>\n\n<p>But how can I insert and read the composition of a set into a map?</p>\n\n<p>I tried with a double iterator, or using the while and a iterator to take data from a file:</p>\n\n<pre><code>string pers, volo;\nwhile (wf &gt;&gt; volo &gt;&gt; pers) {\n    m[volo] = pers;\n}\n</code></pre>\n\n<p>but it gives error.</p>\n\n<p>I'm new in STL and I've read some files, guide, and others to learn sets and maps, but I haven't found anything about container composition (such as the one I've described). How can I do that? Perhaps with a double iterator on map and on set?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "windows", "ssl", "curl", "libcurl"], "comments": [{"owner": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "edited": false, "score": 0, "creation_date": 1548247314, "post_id": 54327066, "comment_id": 95473067, "body": "I would recommend asking on the curl-library list instead. Is <code>MODE</code> perhaps case sensitive so you should use uppercase?"}, {"owner": {"reputation": 7, "user_id": 10680338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9923123cb315384c0d74af0120da49c?s=128&d=identicon&r=PG&f=1", "display_name": "ohad", "link": "https://stackoverflow.com/users/10680338/ohad"}, "reply_to_user": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "edited": false, "score": 0, "creation_date": 1548247769, "post_id": 54327066, "comment_id": 95473316, "body": "its not case sensitive, I tried both ways and got the same result. I couldn&#39;t find anything about this phenomenon on the libcurl site but I posted the same question over there too"}, {"owner": {"reputation": 7, "user_id": 10680338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9923123cb315384c0d74af0120da49c?s=128&d=identicon&r=PG&f=1", "display_name": "ohad", "link": "https://stackoverflow.com/users/10680338/ohad"}, "reply_to_user": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "edited": false, "score": 0, "creation_date": 1548337693, "post_id": 54327066, "comment_id": 95511649, "body": "Solved it. I used the visual studio command prompt instead of the visual c++ one and everything works just fine"}], "owner": {"reputation": 7, "user_id": 10680338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9923123cb315384c0d74af0120da49c?s=128&d=identicon&r=PG&f=1", "display_name": "ohad", "link": "https://stackoverflow.com/users/10680338/ohad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 572, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548245760, "creation_date": 1548245760, "question_id": 54327066, "link": "https://stackoverflow.com/questions/54327066/build-static-libcurl-lib-using-winssl-on-windows", "title": "build static libcurl lib using WinSSL on windows", "body": "<p>I want to create static libcurl.lib with WinSSl.\nI built libcurl.lib on windows with VC++ using the command:\n\"nmake /f makefile.vc RTLIBCFG=static ENABLE_WINSSL=yes mode=static MACHINE=x64 VC=17\"</p>\n\n<p>it created a lib inside the directory:\n\"libcurl-vc17-x64-release-static-ipv6-sspi-winssl\"\n\"libcurl-vc17-x64-release-static-ipv6-sspi-winssl-obj-lib\" (I tried them both)</p>\n\n<p>after that I created a new dll project that will link with this lib (using linker-input-libcurl.lib)</p>\n\n<p>after I created my dll and inspect it using CFF explorer I can see it has libcurl.dll in its import directories which means it wasnt built staticly at all.</p>\n\n<p>what am I missing here?</p>\n"}, {"tags": ["c++", "windows", "mfc", "registry"], "answers": [{"tags": [], "owner": {"reputation": 8601, "user_id": 1485885, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tdPE1.jpg?s=128&g=1", "display_name": "cbuchart", "link": "https://stackoverflow.com/users/1485885/cbuchart"}, "is_accepted": true, "score": 1, "last_activity_date": 1548254825, "last_edit_date": 1548254825, "creation_date": 1548245711, "answer_id": 54327047, "question_id": 54327046, "link": "https://stackoverflow.com/questions/54327046/retrieve-windows-placement-from-saved-workspace-in-windows-registry/54327047#54327047", "title": "Retrieve windows placement from saved workspace in Windows Registry", "body": "<p>As far as I've been able to see, the <code>MainWindowRect</code> happens to be the direct memory dump of a <code>RECT</code> structure. A simple cast is enough to get the window's rect.</p>\n\n<p>Here the full code snippet for getting the value as well as the associated monitor:</p>\n\n<pre><code>// Assumes SetRegistryKey has been already called\nif (const auto hKey = AfxGetApp()-&gt;GetSectionKey(\"Workspace\\\\WindowPlacement\")) {\n  DWORD dwReturn[32];\n  DWORD dwBufSize = sizeof(dwReturn);\n  if (RegQueryValueEx(hKey, \"MainWindowRect\", 0, 0, (LPBYTE)dwReturn, &amp;dwBufSize) == ERROR_SUCCESS) {\n    const auto rectWindow = *(RECT*)dwReturn;\n\n    // Get monitor index from window's rect\n    const auto hMonitor = MonitorFromRect(&amp;rectWindow, MONITOR_DEFAULTTONEAREST);\n    const auto iMonitorIndex = GetMonitorIndex(hMonitor); // see linked post for GetMonitorIndex implementation\n  }\n  RegCloseKey(hKey);\n}\n</code></pre>\n"}], "owner": {"reputation": 8601, "user_id": 1485885, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tdPE1.jpg?s=128&g=1", "display_name": "cbuchart", "link": "https://stackoverflow.com/users/1485885/cbuchart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 54327047, "answer_count": 1, "score": 0, "last_activity_date": 1548254825, "creation_date": 1548245711, "question_id": 54327046, "link": "https://stackoverflow.com/questions/54327046/retrieve-windows-placement-from-saved-workspace-in-windows-registry", "title": "Retrieve windows placement from saved workspace in Windows Registry", "body": "<p>I have a MFC application that automatically saves and restores its workspace (window position, open panes, sizes, etc) to Windows Registry (e.g. <code>HKCU\\Software\\foo\\bar\\Workspace</code>). It's working correctly.</p>\n\n<p>Now I'm interested in showing a splash screen <em>before</em> loading any other window (user requirements). This splash screen must be shown in the same screen where the application's main window will be shown.</p>\n\n<p>I've noticed that in the Registry there is a value <code>HKCU\\Software\\foo\\bar\\Workspace\\WindowPlacement\\MainWindowRect</code> that I guess contains the information about the top-left point and size of the window. With that information I'm able to get the correct screen number (see <a href=\"https://stackoverflow.com/a/54326893/1485885\">this other post</a> if interested in how).</p>\n\n<p>How can I get and interpret that <code>MainWindowRect</code> value?</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 434, "user_id": 6235807, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/LSR9j.jpg?s=128&g=1", "display_name": "lynxSven", "link": "https://stackoverflow.com/users/6235807/lynxsven"}, "edited": false, "score": 0, "creation_date": 1548245713, "post_id": 54327018, "comment_id": 95472171, "body": "Could you provide a code example? What do you have so far?"}, {"owner": {"reputation": 57, "user_id": 10851204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2Rs44HdL6aY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYkM2BncwTji5t8QYfl31nK3j7ZAw/mo/photo.jpg?sz=128", "display_name": "sohit jain", "link": "https://stackoverflow.com/users/10851204/sohit-jain"}, "reply_to_user": {"reputation": 434, "user_id": 6235807, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/LSR9j.jpg?s=128&g=1", "display_name": "lynxSven", "link": "https://stackoverflow.com/users/6235807/lynxsven"}, "edited": false, "score": 0, "creation_date": 1560511167, "post_id": 54327018, "comment_id": 99770260, "body": "for changing image on click event of button i&#39;m just writing          m_bkImgScene.addPixmap(QPixmap(&quot;:/res/Clamp  Down - Pedistal Down - Arm Retracted - Complete.jpg&quot;));"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10851204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2Rs44HdL6aY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYkM2BncwTji5t8QYfl31nK3j7ZAw/mo/photo.jpg?sz=128", "display_name": "sohit jain", "link": "https://stackoverflow.com/users/10851204/sohit-jain"}, "edited": false, "score": 0, "creation_date": 1548246862, "post_id": 54327063, "comment_id": 95472800, "body": "its not working. I want to replace another image outside of the constructor."}, {"owner": {"reputation": 5555, "user_id": 2927205, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luWrX.jpg?s=128&g=1", "display_name": "Mailerdaimon", "link": "https://stackoverflow.com/users/2927205/mailerdaimon"}, "edited": false, "score": 0, "creation_date": 1548247907, "post_id": 54327063, "comment_id": 95473389, "body": "This answers works for changing a QPixmap shown in a QLabel at runtime."}, {"owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "reply_to_user": {"reputation": 57, "user_id": 10851204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2Rs44HdL6aY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYkM2BncwTji5t8QYfl31nK3j7ZAw/mo/photo.jpg?sz=128", "display_name": "sohit jain", "link": "https://stackoverflow.com/users/10851204/sohit-jain"}, "edited": false, "score": 0, "creation_date": 1548252144, "post_id": 54327063, "comment_id": 95475884, "body": "@sohitjain are you sure you are loading the image and setting it to the correct label? the solution i gave is general because you didin&#39;t show us any code so :) you just need to use it right"}, {"owner": {"reputation": 57, "user_id": 10851204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2Rs44HdL6aY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYkM2BncwTji5t8QYfl31nK3j7ZAw/mo/photo.jpg?sz=128", "display_name": "sohit jain", "link": "https://stackoverflow.com/users/10851204/sohit-jain"}, "edited": false, "score": 0, "creation_date": 1548653727, "post_id": 54327063, "comment_id": 95603263, "body": "thanks . its working but now problem is widgets I defined in previous image are not coming in second image. so how can I solved it"}, {"owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "edited": false, "score": 0, "creation_date": 1548664249, "post_id": 54327063, "comment_id": 95606840, "body": "you need to clarify a bit more"}, {"owner": {"reputation": 57, "user_id": 10851204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2Rs44HdL6aY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYkM2BncwTji5t8QYfl31nK3j7ZAw/mo/photo.jpg?sz=128", "display_name": "sohit jain", "link": "https://stackoverflow.com/users/10851204/sohit-jain"}, "edited": false, "score": 0, "creation_date": 1548750244, "post_id": 54327063, "comment_id": 95643133, "body": "I used some widgets( check box pushbuttons   ) and labels  above the previous image. Than I replace the image and write same widgets and labels after image replace but its  not coming."}, {"owner": {"reputation": 57, "user_id": 10851204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2Rs44HdL6aY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYkM2BncwTji5t8QYfl31nK3j7ZAw/mo/photo.jpg?sz=128", "display_name": "sohit jain", "link": "https://stackoverflow.com/users/10851204/sohit-jain"}, "edited": false, "score": 0, "creation_date": 1560513864, "post_id": 54327063, "comment_id": 99771555, "body": "please check edited question .  and for changing image on click event of button i&#39;m just writing    -           m_bkImgScene.addPixmap(QPixmap(&quot;:/res/Clamp Down - Pedistal Down - Arm Retracted - Complete.jpg&quot;));"}], "tags": [], "owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "is_accepted": false, "score": 2, "last_activity_date": 1548245750, "creation_date": 1548245750, "answer_id": 54327063, "question_id": 54327018, "link": "https://stackoverflow.com/questions/54327018/how-to-replace-previous-image-with-new-image-in-qgrapicsscene/54327063#54327063", "title": "How to replace previous image with new image in QGrapicsScene", "body": "<pre><code>mypixmap-&gt;load(\"secondimage_path\");\nmylabel-&gt;setPixmap(mypixmap);\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10851204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2Rs44HdL6aY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYkM2BncwTji5t8QYfl31nK3j7ZAw/mo/photo.jpg?sz=128", "display_name": "sohit jain", "link": "https://stackoverflow.com/users/10851204/sohit-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1560510851, "creation_date": 1548245595, "last_edit_date": 1560510851, "question_id": 54327018, "link": "https://stackoverflow.com/questions/54327018/how-to-replace-previous-image-with-new-image-in-qgrapicsscene", "title": "How to replace previous image with new image in QGrapicsScene", "body": "<p>In Constructor, using QGraphicScene  I'm adding many widgets and one image using Qpixmap. when I want to replace only image. i'm able  replace the image but these widgets are not coming   ..`\nQPixmap *bkgnd=new QPixmap(\":/res/Clamp  Down - Pedistal Down - Arm Retracted - Complete.jpg\");\nm_bkImgScene.addPixmap(*bkgnd);</p>\n\n<pre><code>m_bkImgScene.addItem(&amp;m_txtForelinePsr);\nm_txtForelinePsr.setPos(POS_FORELINEPSR);\n\nm_bkImgScene.addItem(&amp;m_txtMechPump);\nm_txtMechPump.setPos(POS_MECHPUMP);\n\nm_bkImgScene.addItem(&amp;m_txtRoughLnPsr);\nm_txtRoughLnPsr.setPos(POS_ROUGHLINEPSR);\nm_bkImgScene.addItem(&amp;m_txtHeBartn);\nm_bkImgScene.addItem(&amp;m_txtHeMfc);\nm_bkImgScene.addItem(&amp;m_txtIonGfb);\n\nm_bkImgScene.addItem(&amp;m_txtProBaratronfb);\nm_txtProBaratronfb.setPos(POS_PROBARATRONFB);\n\nm_bkImgScene.addItem(&amp;m_txtChamberPsr);\nm_mapTxtWxs[CHAMBERPRESSUREFEEDBACK] = &amp;m_txtChamberPsr;\nm_txtChamberPsr.setPos(POS_CHAMBERPSR);`\n</code></pre>\n"}, {"tags": ["c++", "gcc", "constexpr", "icc"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 1, "creation_date": 1548245382, "post_id": 54326901, "comment_id": 95472005, "body": "icpc doesn&#39;t use gcc 5.4, it uses its standard library (header + so/a), and that&#39;s it."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1548245570, "post_id": 54326901, "comment_id": 95472098, "body": "Seems to be reproducible on <a href=\"https://wandbox.org/permlink/ZVN4a4COwD3z6Icu\" rel=\"nofollow noreferrer\">wandbox</a>. But, you know, no compiler is perfect. GCC 5.4 <i>could</i> have had a bug."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548246036, "post_id": 54326901, "comment_id": 95472345, "body": "With ICPC do you mean the <a href=\"https://en.wikipedia.org/wiki/International_Collegiate_Programming_Contest\" rel=\"nofollow noreferrer\">International Collegiate Programming Contest</a>? Then why did you add the <code>icc</code> tag for the Intel C/C++ Compiler? Please be careful when selecting tags, and edit as soon as you find a mistake."}, {"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548246110, "post_id": 54326901, "comment_id": 95472391, "body": "@Someprogrammerdude icpc is an Intel C++ compiler"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548246333, "post_id": 54326901, "comment_id": 95472520, "body": "Okay, so not the competition then. And in that case note that the version messages says &quot;gcc version 5.4.0 <b><i>compatibility</i></b>&quot;. It&#39;s <i>not</i> using GCC 5.4, it&#39;s only <i>compatible</i> with GCC 5.4 (though in this case not that compatible since it didn&#39;t implement the GCC bug). The Intel C/C++ Compiler is a totally separate compiler."}], "answers": [{"comments": [{"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "edited": false, "score": 0, "creation_date": 1548248394, "post_id": 54327284, "comment_id": 95473665, "body": "Thanks! But which version of gcc is being considered in <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=86678\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=86678</a>?"}, {"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "reply_to_user": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "edited": false, "score": 1, "creation_date": 1548251768, "post_id": 54327284, "comment_id": 95475663, "body": "The latest 8.2 I believe."}, {"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "edited": false, "score": 0, "creation_date": 1548318290, "post_id": 54327284, "comment_id": 95500271, "body": "No) I can compile that source.cpp using gcc6.4"}, {"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "reply_to_user": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "edited": false, "score": 0, "creation_date": 1548318602, "post_id": 54327284, "comment_id": 95500409, "body": "Your example is a little bit different from http:\\\\gcc.gnu.org/bugzilla/show_bug.cgi?id=86678? . If you try to compile the example constexpr bool always_true() { return true; } int f() { return 1; } constexpr int g() {   if (always_true())     return 0;   return f(); } you will see that there still is a problem with gcc8.2 and gcc 6.4 for that matter. So I confirm that the gcc being considered is gcc8.2. And to avoid this problem try using constexpr until the gcc 9 release"}, {"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "edited": false, "score": 0, "creation_date": 1548319237, "post_id": 54327284, "comment_id": 95500712, "body": "Well, if it is a little different then maybe the reason of the error is different too?"}, {"owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "edited": false, "score": 0, "creation_date": 1548322039, "post_id": 54327284, "comment_id": 95502216, "body": "I can not modify the source code that contains similar original code. But I&#39;d like to know exactly the reason"}, {"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "reply_to_user": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "edited": false, "score": 0, "creation_date": 1548331886, "post_id": 54327284, "comment_id": 95508084, "body": "I have edited the answer. If you can&#39;t modify the source code I believe your only option is to switch to gcc6.4 with -std=c++14. And beware of the limitation in gcc for the time being."}], "tags": [], "owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "is_accepted": true, "score": 2, "last_activity_date": 1548331772, "last_edit_date": 1548331772, "creation_date": 1548246475, "answer_id": 54327284, "question_id": 54326901, "link": "https://stackoverflow.com/questions/54326901/why-gcc5-4-doesnt-compile-a-constexpr-function-calling-a-non-constexpr-function/54327284#54327284", "title": "Why gcc5.4 doesn&#39;t compile a constexpr function calling a non-constexpr function, but icpc does?", "body": "<p>The first limitation is concerning the use gcc 5.4 with -std=c++11 which produces the error because of the two return statement see <a href=\"https://stackoverflow.com/questions/45097171/the-body-of-constexpr-function-not-a-return-statement\">The body of constexpr function not a return-statement</a> so in order to lift your first issue you need to use -std=c++14</p>\n\n<p>It then produces</p>\n\n<blockquote>\n  <p>'#1 with x86-64 gcc 5.4\n  : In function 'constexpr int func(int)':</p>\n  \n  <p>:10:32: error: call to non-constexpr function 'int\n  nonconstexprfunc()'</p>\n\n<pre><code>     return nonconstexprfunc();        ^\n</code></pre>\n  \n  <p>: In function 'int main()':</p>\n  \n  <p>:16:28: error: 'constexpr int func(int)' called in a constant\n  expression</p>\n\n<pre><code> constexpr int t1 = func(0);\n\n                         Compiler returned: 1\n</code></pre>\n</blockquote>\n\n<p>This next error produced seems to be a known GCC bug (misinterpretation of c++14) see<br>\n<a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=86678\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=86678</a><br>\n<a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=67026\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=67026</a></p>\n\n<p>You can also check out <a href=\"https://stackoverflow.com/questions/47726503/calling-non-constexpr-function-from-constexpr-allowed-in-some-conditions\">calling non constexpr function from constexpr allowed in some conditions</a></p>\n\n<p>However judging from the error it produces:</p>\n\n<p>It seems pretty obvious that doing </p>\n\n<pre><code>constexpr int nonconstexprfunc()\n{\n    return 14;\n}\n</code></pre>\n\n<p>will solve the error and will be more efficient in your case.<br>\nCheck the difference with <a href=\"https://www.godbolt.org/\" rel=\"nofollow noreferrer\">https://www.godbolt.org/</a> of adding constexpr or not using gcc 8.2 for example.</p>\n"}], "owner": {"reputation": 1305, "user_id": 10955302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d217869ed810b306ce55f8cf5b6fbbfd?s=128&d=identicon&r=PG&f=1", "display_name": "embedc", "link": "https://stackoverflow.com/users/10955302/embedc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 54327284, "answer_count": 1, "score": 1, "last_activity_date": 1548331772, "creation_date": 1548245144, "last_edit_date": 1548247435, "question_id": 54326901, "link": "https://stackoverflow.com/questions/54326901/why-gcc5-4-doesnt-compile-a-constexpr-function-calling-a-non-constexpr-function", "title": "Why gcc5.4 doesn&#39;t compile a constexpr function calling a non-constexpr function, but icpc does?", "body": "<p>gcc5.4 doesn't compile the following code:</p>\n\n<pre><code>// source.cpp\nint nonconstexprfunc()\n{\n    return 14;\n}\n\nconstexpr int func(int n)\n{\n    if (n &lt; 0)\n        return nonconstexprfunc();\n    return n*n;\n}\n\nint main()\n{\n    constexpr int t1 = func(0);\n    return 0;\n}\n</code></pre>\n\n<p>The command I use:</p>\n\n<pre><code>$ g++ -std=c++14 -c source.cpp\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>In function \u2018constexpr int func(int)\u2019:\nerror: \u2018constexpr int func(int)\u2019 called in a constant expression\nconstexpr int t1 = func(0);\nIn function \u2018int main()\u2019:\nerror: \u2018constexpr int func(int)\u2019 called in a constant expression\nconstexpr int t1 = func(0);\n</code></pre>\n\n<p>But I can compile that source.cpp using gcc6.4. Doesn't gcc5.4 fully support constexpr functions?</p>\n\n<p>More interestingly I can compile that source.cpp using icpc (Intel C++ compiler) that uses gcc5.4 - I suppose there must be an option to compile that code using gcc5.4.</p>\n\n<pre><code>$  icpc -v\nicpc version 19.0 (gcc version 5.4.0 compatibility)\n$  icpc -std=c++14 -c source.cpp\nno errors\n</code></pre>\n"}, {"tags": ["c++", "windows", "multiple-monitors"], "answers": [{"tags": [], "owner": {"reputation": 8601, "user_id": 1485885, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tdPE1.jpg?s=128&g=1", "display_name": "cbuchart", "link": "https://stackoverflow.com/users/1485885/cbuchart"}, "is_accepted": true, "score": 1, "last_activity_date": 1548317370, "last_edit_date": 1548317370, "creation_date": 1548245108, "answer_id": 54326893, "question_id": 54326892, "link": "https://stackoverflow.com/questions/54326892/get-monitor-index-from-its-handle-hmonitor/54326893#54326893", "title": "Get monitor index from its handle (HMONITOR)", "body": "<p>I found <a href=\"https://stackoverflow.com/questions/29412926/get-the-handle-of-a-real-monitor-by-its-index\">this post</a> with the opposite question: finding the handle given the index (0-based in that case).</p>\n\n<p>Based on it I worked this solution:</p>\n\n<pre><code>struct sEnumInfo {\n  int iIndex = 0;\n  HMONITOR hMonitor = NULL;\n};\n\nBOOL CALLBACK GetMonitorByHandle(HMONITOR hMonitor, HDC hdcMonitor, LPRECT lprcMonitor, LPARAM dwData)\n{\n  auto info = (sEnumInfo*)dwData;\n  if (info-&gt;hMonitor == hMonitor) return FALSE;\n  ++info-&gt;iIndex;\n  return TRUE;\n}\n\nint GetMonitorIndex(HMONITOR hMonitor)\n{\n  sEnumInfo info;\n  info.hMonitor = hMonitor;\n\n  if (EnumDisplayMonitors(NULL, NULL, GetMonitorByHandle, (LPARAM)&amp;info)) return -1;\n  return info.iIndex + 1; // 1-based index\n}\n</code></pre>\n"}], "owner": {"reputation": 8601, "user_id": 1485885, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tdPE1.jpg?s=128&g=1", "display_name": "cbuchart", "link": "https://stackoverflow.com/users/1485885/cbuchart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 54326893, "answer_count": 1, "score": 0, "last_activity_date": 1548317370, "creation_date": 1548245108, "last_edit_date": 1548253225, "question_id": 54326892, "link": "https://stackoverflow.com/questions/54326892/get-monitor-index-from-its-handle-hmonitor", "title": "Get monitor index from its handle (HMONITOR)", "body": "<p>I'm interested in getting the monitor index (1-based, to match Windows numbering) given the monitor handle.</p>\n\n<p>Case of use: given a window's rect I want to know the monitor it belongs to. I can get the handle of the monitor using <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-monitorfromrect\" rel=\"nofollow noreferrer\"><code>MonitorFromRect</code></a>:</p>\n\n<pre><code>// RECT rect\nconst HMONITOR hMonitor = MonitorFromRect(rect, MONITOR_DEFAULTTONEAREST);\n</code></pre>\n\n<p>How can I get the monitor index from this handle?</p>\n\n<p>PS: not sure if duplicate, but I've been looking around with no luck.</p>\n"}, {"tags": ["c++", "c++20", "spaceship-operator"], "comments": [{"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1548244411, "post_id": 54326473, "comment_id": 95471510, "body": "For ordered types it will produce as strcmp: a value that indicate whether the comparison result in greater smaller or equal. So you can look for example of strmcp. For unordered type it can also provide the case where two object are unordered (like 2 infinity, or comparison with nan) this may help coder in not forgetting this case."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1548244542, "post_id": 54326473, "comment_id": 95471578, "body": "What do you define as <b>client code</b>? And why is a class declaration excluded from it?"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1548244756, "post_id": 54326473, "comment_id": 95471674, "body": "I might be opinionated, but I dislike the <code>&lt;=&gt;</code> operator. They could&#39;ve made <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code> implicit by having defined only <code>==</code> and <code>&lt;</code>... The way <code>&lt;=&gt;</code> is specified is way too complicated (even its own header and library components)."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 3, "creation_date": 1548246952, "post_id": 54326473, "comment_id": 95472851, "body": "@DeiDei <code>auto X::operator&lt;=&gt;(const Y&amp;) =default;</code> is <i>very</i> simple."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1548247915, "post_id": 54326473, "comment_id": 95473397, "body": "@Moia the comment is a reply to DeiDei, showing that the complexity of the specification give simplicity of use. The &quot;client code&quot; for <code>&lt;=&gt;</code> is the union of the &quot;client code&quot; for <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>==</code>, and <code>!=</code>"}, {"owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1548247946, "post_id": 54326473, "comment_id": 95473419, "body": "@StoryTeller I&#39;d like to see a <i>Minimal, Complete, and Verifiable example</i> of how to use it."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 2, "creation_date": 1548250276, "post_id": 54326473, "comment_id": 95474772, "body": "@DeiDei The question is: how do you define <code>&lt;=</code>? If you&#39;re suggesting that <code>a &lt;= b</code> is <code>!(b &lt; a)</code>, then that gives the wrong answer for partial orders (e.g. <code>float</code>). If you&#39;re suggesting that <code>a &lt;= b</code> is <code>(a &lt; b) || (a == b)</code>, then that always gives the right answer but is potentially a large pessimization for total orders (e.g. <code>string</code>). <code>&lt;=&gt;</code> is a hugely superior choice to <code>&lt;</code> to use as an ordering operator."}], "answers": [{"comments": [{"owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "edited": false, "score": 0, "creation_date": 1548250316, "post_id": 54326896, "comment_id": 95474797, "body": "Could you add a simple main showing the usage? Just for completeness. then I&#39;m going to mark it as accepted"}, {"owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "edited": false, "score": 0, "creation_date": 1548250470, "post_id": 54326896, "comment_id": 95474882, "body": "with which logic are performed the comparison order in your Person with operator&lt;=&gt;?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "edited": false, "score": 0, "creation_date": 1548250570, "post_id": 54326896, "comment_id": 95474943, "body": "They both perform the same comparison"}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": true, "score": 4, "last_activity_date": 1548250654, "last_edit_date": 1548250654, "creation_date": 1548245115, "answer_id": 54326896, "question_id": 54326473, "link": "https://stackoverflow.com/questions/54326473/real-world-usage-example-for-spaceship-operator/54326896#54326896", "title": "Real world usage example for spaceship operator", "body": "<p><code>&lt;=&gt;</code> allows the lazy way to also be the performant way. You <strong>don't change</strong> your client code.</p>\n\n<p>Clients may see performance benefits when there was a <code>using std::rel_ops</code> (or <code>boost::ordered</code> etc).</p>\n\n<p>An example</p>\n\n<pre><code>// old and busted\nstruct Person : boost::totally_ordered&lt;Person&gt;\n{\n    std::string firstname;\n    std::string lastname\n    bool operator&lt;(const Person &amp; other) \n    { \n        return std::tie(firstname, lastname)\n             &lt; std::tie(other.firstname, other.lastname); \n    }\n}\n\n// new hotness\nstruct Person\n{\n    std::string firstname;\n    std::string lastname;\n    auto operator&lt;=&gt;(const Person &amp;) = default;\n}\n\nint main()\n{\n    Person person1 { \"John\", \"Smith\" };\n    Person person2 { \"John\", \"Smith\" };\n    std::cout &lt;&lt; person2 &lt;= person1 &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 1, "creation_date": 1548257354, "post_id": 54328520, "comment_id": 95479127, "body": "And if all comparison operator depends on the same call to a function and a comparison with a fundamental type, the optimizer will be able to use its knowledge of the mathematical structure of integer with comparison operator to optimize further the code:<a href=\"https://godbolt.org/z/2ip7JK\" rel=\"nofollow noreferrer\">godbolt.org/z/2ip7JK</a>"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1587119112, "post_id": 54328520, "comment_id": 108388810, "body": "&quot;The advantage of &lt;=&gt; is that you only need to write one operator instead of four&quot; - shouldn&#39;t that be <i>six</i>? <code>&lt;</code>, <code>&lt;=</code>, <code>==</code>, <code>&gt;=</code>, <code>&gt;</code>, and <code>!=</code>? Or did I miss something?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1587133085, "post_id": 54328520, "comment_id": 108396899, "body": "@cmaster-reinstatemonica No, four. <code>&lt;=&gt;</code> is an ordering operator, it doesn&#39;t provide equality. <code>==</code> gives you <code>==</code> and <code>!=</code>."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1587134678, "post_id": 54328520, "comment_id": 108397857, "body": "Ok, once again there is stuff in C++ that I fail to understand. I mean, why introduce enum values for <code>equivalent</code>, <code>less</code>, <code>greater</code> and <code>unordered</code> (the <code>partial_ordering</code> type) if no sensible <code>==</code> and <code>!=</code> operators are defined? It&#39;s once again going only part of the way, leaving us with a suboptimal solution that will spawn suboptimal code, which in turn will hinder further progress of the language :-( Imho, if a language adds a feature, it should embrace that feature whole-heartedly. A patchwork that only applies features to parts of the language can only produce Frankenstein monsters."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1587139772, "post_id": 54328520, "comment_id": 108400768, "body": "Well, if the <code>&lt;=&gt;</code> based version of <code>==</code> is not fast enough, I&#39;m always free to implement an explicit <code>==</code>. That&#39;s an optimization. The <code>&lt;=&gt;</code> exists to simplify things, but it leaves the programmer with the power to fall back to doing it all themselves should need be. It&#39;s not the first simplification in C++ that may turn into a pessimisation. I do not believe that forcing programmers to needlessly provide explicit <code>==</code> operators is an improvement of an otherwise elegant, and long awaited feature."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1587140211, "post_id": 54328520, "comment_id": 108400994, "body": "@cmaster-reinstatemonica Okay, you do that. Now I have your type as a member. So now I have to write an explicit <code>==</code> that just calls your <code>==</code>, otherwise I get the slow one. So, okay, hopefully I&#39;m diligent enough about this. So I do that. Okay, now somebody has my type as a member - and they have to know to write an explicit <code>==</code> that just calls my <code>==</code> that just calls your <code>==</code>... otherwise <i>they</i> get the slow one. And ..."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1587140394, "post_id": 54328520, "comment_id": 108401082, "body": "@cmaster-reinstatemonica And if I forget (or don&#39;t know to, or don&#39;t think to) add that explicit <code>==</code> that calls your <code>==</code>... then that somebody else that uses my type as a member is just screwed. Even if they write <code>==</code>, it would still be slow."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1587147272, "post_id": 54328520, "comment_id": 108404704, "body": "Fair point, though I don&#39;t believe that it really cuts it: How frequently do you write such nested comparison functions? I for one don&#39;t do that often. In fact, I cannot remember <i>ever</i> writing more than a 2-level comparison. And going over the software projects that I have worked on, no, none ever called for this. So, while you have a point in principle, I really don&#39;t see the practical relevance of it. I do see the practical relevance of an automatically defined <code>==</code> operator that is guaranteed to agree with the comparison operators which are defined based on my <code>&lt;=&gt;</code> implementation, though."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1587151135, "post_id": 54328520, "comment_id": 108406521, "body": "@cmaster-reinstatemonica What do you mean by a &quot;nested comparison&quot; function? I&#39;m just talking about having a type with some members, whose comparison is just comparing those members. That&#39;s... very common. And you <i>can</i> write <code>bool operator==(T x, T y) { return (x &lt;=&gt; y) == 0; }</code> if you choose to do so."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1587151623, "post_id": 54328520, "comment_id": 108406758, "body": "@cmaster-reinstatemonica Moreover, every class template would need to provide both anyway."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1587157756, "post_id": 54328520, "comment_id": 108409502, "body": "Yes, you are right, that trivial implementation of <code>==</code> is indeed quickly written, so my point is rather mute :-) And yes, you understood nested type comparisons for what I meant, and yes, they happen. One class comparing all its members in order. That&#39;s fine with me. However, one class comparing its members which need to compare their non-POD members in turn, that&#39;s where the real nesting begins and which is extremely rare. And why would every class template need to provide comparisons? I mean, I don&#39;t want to compare complex stuff for no good reason, and most stuff never needs comparisons."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1587158159, "post_id": 54328520, "comment_id": 108409651, "body": "However, the point of my &quot;rant&quot; above was not so much about C++ and its <code>&lt;=&gt;</code> operator, but more generally about the accumulation of corner cases in a language. I happen to have some experience with Fortran. Unfortunately. &quot;Modern&quot; Fortran is an extremely complex language with tons and tons of features, but all features have some corner cases and pitfalls where they act up when you try to combine them with other features. It makes programming in Fortran feel like walking through a mine field. It&#39;ll all blow up when you least expect it. And it pains me to see signs of that same disease in C++."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 3, "last_activity_date": 1548250530, "creation_date": 1548250530, "answer_id": 54328520, "question_id": 54326473, "link": "https://stackoverflow.com/questions/54326473/real-world-usage-example-for-spaceship-operator/54328520#54328520", "title": "Real world usage example for spaceship operator", "body": "<p>You just compare the way you've always done:</p>\n\n<pre><code>a &lt; b\n</code></pre>\n\n<p>It's just that under the hood, one of the candidate functions for that expression will also find <code>(a &lt;=&gt; b) &lt; 0</code> and if that candidate exists and happens to be the best viable candidate, then it is invoked. </p>\n\n<p>You typically don't use <code>&lt;=&gt;</code> directly in \"client code\", you just use the comparisons that you want directly.</p>\n\n<p>For instance, given:</p>\n\n<pre><code>struct X {\n    int i;\n\n    // this can be = default, just writing it out for clarity\n    strong_ordering operator&lt;=&gt;(X const&amp; rhs) const { return i &lt;=&gt; rhs.i; }\n};\n</code></pre>\n\n<p>The expression</p>\n\n<pre><code>X{42} &lt; X{57};\n</code></pre>\n\n<p>will evaluate as <code>X{42} &lt;=&gt; X{57} &lt; 0</code> (there is no <code>&lt;</code> candidate, so <code>&lt;=&gt;</code> non-reversed is trivially the best candidate). <code>X{42} &lt;=&gt; X{57}</code> evaluates as <code>42 &lt;=&gt; 57</code> which is <code>strong_ordering::less</code>. And that <code>&lt; 0</code> returns <code>true</code>. Hence, the initial expression is <code>true</code>... as expected. </p>\n\n<p>The same operator also directly gives us that <code>X{57} &gt; X{42}</code>, that <code>X{3} &gt;= X{2}</code>, etc.</p>\n\n<hr />\n\n<p>The advantage of <code>&lt;=&gt;</code> is that you only need to write one operator instead of four, that operator is typically much easier to write than <code>&lt;</code>, you can properly express the differentiation between partial and total orders, and stacking it is typically more performant (e.g. in the cases like <code>string</code>).</p>\n\n<p>Additionally, we don't have to live in this weird world where everyone pretends that <code>operator&lt;</code> is the only relational operator that exists. </p>\n"}], "owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1645, "favorite_count": 5, "closed_date": 1548258917, "accepted_answer_id": 54326896, "answer_count": 2, "score": 6, "last_activity_date": 1587118676, "creation_date": 1548243716, "last_edit_date": 1587118676, "question_id": 54326473, "link": "https://stackoverflow.com/questions/54326473/real-world-usage-example-for-spaceship-operator", "closed_reason": "Opinion-based", "title": "Real world usage example for spaceship operator", "body": "<p>The definition of spaceship operator is meant to have a strong definition of ordering, but does this affect the way your <strong>client code</strong> is written or just how to define your class comparison operators?</p>\n\n<p>Since in other post are missing real world example I'm not fully understanding this part.</p>\n\n<p>Other SO post about spaceship operator:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/49661170/spaceship-comparison-operator-in-c\">Why do we need the spaceship &lt;=&gt; operator in C++?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/47466358/what-is-the-operator-in-c\">What is the &lt;=&gt; operator in C++?</a>\n<a href=\"https://stackoverflow.com/questions/47485803/how-and-why-did-the-iso-c-standards-committee-wg21-decide-to-accept-the-prop\">https://stackoverflow.com/questions/47485803/how-and-why-did-the-iso-c-standards-committee-wg21-decide-to-accept-the-prop</a></li>\n<li><a href=\"https://stackoverflow.com/questions/48042955/how-is-the-three-way-comparison-operator-different-from-subtraction\">How is the three-way comparison operator different from subtraction?</a></li>\n</ul>\n"}, {"tags": ["c++", "gcc", "sse", "simd", "auto-vectorization"], "comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1548298827, "post_id": 54326264, "comment_id": 95494263, "body": "I had no luck with gcc or clang extracting the MSB with an unsigned right-shift instead of a compare, either.  <a href=\"https://godbolt.org/z/DuVdF5\" rel=\"nofollow noreferrer\">godbolt.org/z/DuVdF5</a>.  Or reducing the count to 16, so it only had to find the XMM version. Also, some of the code gen is pretty horrible and clunky for gcc and clang.  Unpacking to 32-bit integers for variable-count shifts makes sense if they miss <code>pmovmskb</code>, but it&#39;s a mess."}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 0, "creation_date": 1548413300, "post_id": 54326264, "comment_id": 95541484, "body": "I&#39;m not really sure what your goal is here. If you explicitly want to get a movemask instruction, use the intrinsic. If you have non-artificial code which could benefit from using movemask make a feature-request to the compiler-maintainers."}], "owner": {"reputation": 660, "user_id": 2003487, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/738c28142129a64eb33d3579bcb570fe?s=128&d=identicon&r=PG", "display_name": "Wojciech Migda", "link": "https://stackoverflow.com/users/2003487/wojciech-migda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1548272116, "creation_date": 1548243050, "last_edit_date": 1548272116, "question_id": 54326264, "link": "https://stackoverflow.com/questions/54326264/auto-vectorization-with-sse2-movemask-for-bytes-to-bitmap-with-gcc", "title": "Auto-vectorization with SSE2 movemask for bytes to bitmap with gcc", "body": "<p>With properly constructed C/C++ code one can hint gcc to generate efficient SIMD assembler on its own, without use of intrinsics, e.g. <a href=\"https://locklessinc.com/articles/vectorize/\" rel=\"nofollow noreferrer\">https://locklessinc.com/articles/vectorize/</a></p>\n\n<p>I am trying to achieve a similar effect for movemask operation (<a href=\"https://www.felixcloutier.com/x86/pmovmskb\" rel=\"nofollow noreferrer\">PMOVMSKB</a> / *_movemask_epi8 family), but so far without success.</p>\n\n<p>The simplest code I could think of:</p>\n\n<pre><code>#include &lt;cstdint&gt;\n\nalignas(128) int8_t arr[32];\n\nuint32_t foo()\n{\n    uint32_t rv = 0;\n\n    for (int it = 0; it &lt; 32; ++it)\n    {\n        rv |= (arr[it] &lt; 0) &lt;&lt; it;\n    }\n\n    return rv;\n}\n</code></pre>\n\n<p>leads to assembly that fails to utilize move mask instruction: <a href=\"https://godbolt.org/z/3XimYc\" rel=\"nofollow noreferrer\">https://godbolt.org/z/3XimYc</a></p>\n\n<p><strong>Does anyone have an idea if there's a way to do that with gcc without explicitly using intrinsics?</strong></p>\n\n<p>I haven't looked into MD files and associated implementation in gcc yet (<a href=\"https://github.com/gcc-mirror/gcc/tree/master/gcc/config/i386\" rel=\"nofollow noreferrer\">https://github.com/gcc-mirror/gcc/tree/master/gcc/config/i386</a>).</p>\n"}, {"tags": ["c++", "gprof"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1548247328, "post_id": 54326005, "comment_id": 95473072, "body": "I don&#39;t know for sure but I assume gprof is reporting in the same resolution that it records samples in. To get around this issue, use a longer running test case."}, {"owner": {"reputation": 21, "user_id": 10556953, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UOVH8RcAt1E/AAAAAAAAAAI/AAAAAAAAABg/QCZxYpvkoTg/photo.jpg?sz=128", "display_name": "Mason Ng&#244;", "link": "https://stackoverflow.com/users/10556953/mason-ng%c3%b4"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1548253193, "post_id": 54326005, "comment_id": 95476491, "body": "I believe there is a way to setting the report time resolution, maybe by an gprof option or sth else. Actually most of functions in real time applications run very, very fast when handling thousand of messages. Must have some ways to profiling them!"}], "owner": {"reputation": 21, "user_id": 10556953, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UOVH8RcAt1E/AAAAAAAAAAI/AAAAAAAAABg/QCZxYpvkoTg/photo.jpg?sz=128", "display_name": "Mason Ng&#244;", "link": "https://stackoverflow.com/users/10556953/mason-ng%c3%b4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1548242175, "creation_date": 1548242175, "question_id": 54326005, "link": "https://stackoverflow.com/questions/54326005/how-to-make-gprof-report-in-nanosecond", "title": "How to make gprof report in nanosecond?", "body": "<p>I'm trying to profile my C++ application, using gprof I would like to calculate function execution time. However in case some functions run faster than 0.01s it's reported on gprof with value 0.00. How can I change the report time of gprof to nanosecond?</p>\n\n<p>Thanks for your advices.</p>\n\n<pre><code>    Flat profile:\n\n    Each sample counts as 0.01 seconds.\n     no time accumulated\n\n      %   cumulative   self              self     total           \n     time   seconds   seconds    calls  Ts/call  Ts/call  name    \n      0.00      0.00     0.00        3     0.00     0.00  access_counter\n      0.00      0.00     0.00        2     0.00     0.00  get_counter\n      0.00      0.00     0.00        1     0.00     0.00  start_counter\n\nCopyright (C) 2012-2015 Free Software Foundation, Inc.\n\nCopying and distribution of this file, with or without modification,\nare permitted in any medium without royalty provided the copyright\nnotice and this notice are preserved.\n\n.....\n\n             Call graph (explanation follows)\n\n\ngranularity: each sample hit covers 2 byte(s) no time propagated\n\nindex % time    self  children    called     name\n                0.00    0.00       1/3           start_counter [3]\n                0.00    0.00       2/3           get_counter [2]\n[1]      0.0    0.00    0.00       3         access_counter [1]\n-----------------------------------------------\n                0.00    0.00       2/2           main [9]\n[2]      0.0    0.00    0.00       2         get_counter [2]\n                0.00    0.00       2/3           access_counter [1]\n-----------------------------------------------\n                0.00    0.00       1/1           main [9]\n[3]      0.0    0.00    0.00       1         start_counter [3]\n                0.00    0.00       1/3           access_counter [1]\n-----------------------------------------------\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "qt", "qmake"], "comments": [{"owner": {"reputation": 893, "user_id": 6361694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b808f24204076dfdb2fc9afa27a8b8?s=128&d=identicon&r=PG&f=1", "display_name": "Petok Lorand", "link": "https://stackoverflow.com/users/6361694/petok-lorand"}, "edited": false, "score": 0, "creation_date": 1548242432, "post_id": 54325997, "comment_id": 95470495, "body": "I don&#39;t have access to visual studio  right now, so this might not be exactly correct, but you can edit the warning level by rightclicking to your project -&gt; properties-&gt;c/c++-&gt;change warning level"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1548242709, "post_id": 54325997, "comment_id": 95470640, "body": "but that caused many (thousands) of warnings being generated by libraries - seems like an expected result to me"}, {"owner": {"reputation": 2165, "user_id": 1387866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8c28745932169219a179d1ac9c5b642c?s=128&d=identicon&r=PG", "display_name": "user1387866", "link": "https://stackoverflow.com/users/1387866/user1387866"}, "reply_to_user": {"reputation": 893, "user_id": 6361694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b808f24204076dfdb2fc9afa27a8b8?s=128&d=identicon&r=PG&f=1", "display_name": "Petok Lorand", "link": "https://stackoverflow.com/users/6361694/petok-lorand"}, "edited": false, "score": 1, "creation_date": 1548244140, "post_id": 54325997, "comment_id": 95471360, "body": "@Lorand My post now explains why this is not acceptable."}, {"owner": {"reputation": 2165, "user_id": 1387866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8c28745932169219a179d1ac9c5b642c?s=128&d=identicon&r=PG", "display_name": "user1387866", "link": "https://stackoverflow.com/users/1387866/user1387866"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1548244153, "post_id": 54325997, "comment_id": 95471371, "body": "@VTT See the mention of <code>-Wall</code> in the updated version of my post."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1548258207, "post_id": 54325997, "comment_id": 95479589, "body": "<code>How can I swap the order of -W3 and -W4 (so -W4 would take precedence over -W3)?</code> <code>QMAKE_CFLAGS_WARN_ON = -W4 $$QMAKE_CFLAGS_WARN_ON</code>"}, {"owner": {"reputation": 2165, "user_id": 1387866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8c28745932169219a179d1ac9c5b642c?s=128&d=identicon&r=PG", "display_name": "user1387866", "link": "https://stackoverflow.com/users/1387866/user1387866"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1548316599, "post_id": 54325997, "comment_id": 95499455, "body": "@Matt Your suggestion does not work, for three reasons. 1) Your suggestion results in <code>-W4</code> being placed before <code>-W3</code>, which is the opposite of the desired result. 2) Manipulating <code>QMAKE_CFLAGS_WARN_ON</code> in the <code>.pro</code> file has no impact on my project, which is C++ only. 3) As I told in my post, appending <code>-W4</code> to <code>QMAKE_CXXFLAGS_WARN_ON</code> (not to <code>QMAKE_CFLAGS_WARN_ON</code>) in my <code>.pro</code> file results in tons of warnings from libraries."}], "answers": [{"comments": [{"owner": {"reputation": 2165, "user_id": 1387866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8c28745932169219a179d1ac9c5b642c?s=128&d=identicon&r=PG", "display_name": "user1387866", "link": "https://stackoverflow.com/users/1387866/user1387866"}, "edited": false, "score": 0, "creation_date": 1548246206, "post_id": 54326809, "comment_id": 95472438, "body": "As I wrote in my post, <code>-W4</code> (which I appended to <code>QMAKE_CXXFLAGS</code>) is overridden on the command line by <code>-W3</code> (which apparently comes from <code>QMAKE_CFLAGS_WARN_ON</code>, which is set in <code>msvc-desktop.conf</code>). And replacing <code>-W3</code> by <code>-W4</code> has no effect (<code>QMAKE_CXXFLAGS</code> is probably empty initially)."}, {"owner": {"reputation": 2165, "user_id": 1387866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8c28745932169219a179d1ac9c5b642c?s=128&d=identicon&r=PG", "display_name": "user1387866", "link": "https://stackoverflow.com/users/1387866/user1387866"}, "edited": false, "score": 2, "creation_date": 1548318547, "post_id": 54326809, "comment_id": 95500385, "body": "Replacing <code>QMAKE_CXXFLAGS</code> by <code>QMAKE_CXXFLAGS_WARN_ON</code> in your second suggestion, like this: <code>QMAKE_CXXFLAGS_WARN_ON ~= s&#47;-W3&#47;-W4</code>, seems to solve all my problems. Thanks!"}, {"owner": {"reputation": 16850, "user_id": 172642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2a18a04255beea3beff827eecedd64?s=128&d=identicon&r=PG", "display_name": "gavinb", "link": "https://stackoverflow.com/users/172642/gavinb"}, "reply_to_user": {"reputation": 2165, "user_id": 1387866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8c28745932169219a179d1ac9c5b642c?s=128&d=identicon&r=PG", "display_name": "user1387866", "link": "https://stackoverflow.com/users/1387866/user1387866"}, "edited": false, "score": 0, "creation_date": 1548336850, "post_id": 54326809, "comment_id": 95511124, "body": "@user1387866 Great to hear!"}], "tags": [], "owner": {"reputation": 16850, "user_id": 172642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2a18a04255beea3beff827eecedd64?s=128&d=identicon&r=PG", "display_name": "gavinb", "link": "https://stackoverflow.com/users/172642/gavinb"}, "is_accepted": true, "score": 2, "last_activity_date": 1548244875, "creation_date": 1548244875, "answer_id": 54326809, "question_id": 54325997, "link": "https://stackoverflow.com/questions/54325997/how-to-specify-w4-visual-studio-in-a-qt-project/54326809#54326809", "title": "How to specify -W4 (Visual Studio) in a Qt project?", "body": "<p>The change to your project file <em>appends</em> the warning setting to the existing variable, which is predefined:</p>\n\n<pre><code>QMAKE_CXXFLAGS += -W4\n</code></pre>\n\n<p>You could either prepend the variable, or actually <a href=\"http://doc.qt.io/qt-5/qmake-language.html#replacing-values\" rel=\"nofollow noreferrer\">replace the existing warning variable setting</a> with your own:</p>\n\n<pre><code>QMAKE_CXXFLAGS ~= s/-W3/-W4\n</code></pre>\n"}], "owner": {"reputation": 2165, "user_id": 1387866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8c28745932169219a179d1ac9c5b642c?s=128&d=identicon&r=PG", "display_name": "user1387866", "link": "https://stackoverflow.com/users/1387866/user1387866"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 54326809, "answer_count": 1, "score": 3, "last_activity_date": 1548315896, "creation_date": 1548242155, "last_edit_date": 1548315896, "question_id": 54325997, "link": "https://stackoverflow.com/questions/54325997/how-to-specify-w4-visual-studio-in-a-qt-project", "title": "How to specify -W4 (Visual Studio) in a Qt project?", "body": "<p>My environment:</p>\n\n<ul>\n<li>Windows 10, 64-bit</li>\n<li>Microsoft Visual Studio 2015</li>\n<li>Qt 5.6.2</li>\n<li>Qt Creator 4.8.1</li>\n</ul>\n\n<p>I want to compile my C++ project with <code>-W4</code> instead of the default <code>-W3</code>, so I added this line to my <code>.pro</code> file:</p>\n\n<pre><code>QMAKE_CXXFLAGS += -W4\n</code></pre>\n\n<p>But then, I get many of these warnings (one for each compilation unit, I suppose):</p>\n\n<pre><code>cl : Command line warning D9025 : overriding '/W4' with '/W3'\n</code></pre>\n\n<p>From the command line, I can see that the command line does include both <code>-W3</code> and <code>-W4</code> (in this order).</p>\n\n<p>So, my question: <strong>How can I swap the order of <code>-W3</code> and <code>-W4</code> (so <code>-W4</code> would take precedence over <code>-W3</code>)?</strong></p>\n\n<p>Note that <strong>this did not work</strong>: I tried to modify Qt's configuration file <code>C:\\Qt\\5.6.2\\msvc2015_64\\mkspecs\\common\\msvc-desktop.conf</code>, by changing the value of variable <code>QMAKE_CFLAGS_WARN_ON</code> from <code>-W3</code> to <code>-W4</code>, and not adding <code>-W4</code> to <code>QMAKE_CXXFLAGS</code> in my <code>.pro</code> file, but that caused many (thousands) of warnings being generated by libraries. I also tried to append <code>-W4</code> to <code>QMAKE_CXXFLAGS_WARN_ON</code> (instead of <code>QMAKE_CXXFLAGS</code>) in my <code>.pro</code> file, with the same result (thousands of warnings from libraries).</p>\n\n<p>Also note that if I add <code>-Wall</code> (instead of <code>-W4</code>) to <code>QMAKE_CXXFLAGS</code>, then:</p>\n\n<ul>\n<li>I do not get similar command line warnings (although <code>-Wall</code> is\nfollowed by <code>-W3</code> on the command line)</li>\n<li>I still get many warnings from libraries, but considerably less than\nwith <code>-W3</code> changed to <code>-W4</code> in <code>msvc-desktop.conf</code> (or with <code>-W4</code> appended to\n<code>QMAKE_CXXFLAGS_WARN_ON</code> in my <code>.pro</code> file).</li>\n</ul>\n\n<p>I use qmake (through Qt Creator), so any solutions that would require editing the generated Visual Studio project files would be unacceptable.</p>\n"}, {"tags": ["c++", "templates", "lambda", "stl", "functor"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548241880, "post_id": 54325864, "comment_id": 95470173, "body": "Depending on your compiler and version of it, <a href=\"https://en.cppreference.com/w/cpp/language/class_template_argument_deduction\" rel=\"nofollow noreferrer\">it might be possible to do what you want</a>. If you can enable C++17 mode then try it."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548241970, "post_id": 54325864, "comment_id": 95470233, "body": "@Someprogrammerdude it will copy the object and store the object despite the const&amp;? If yes, I&#39;ll remove my answer."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1548242028, "post_id": 54325864, "comment_id": 95470276, "body": "@MatthieuBrucher It won&#39;t."}, {"owner": {"reputation": 77, "user_id": 10950714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ab993e0a3c6ce1d85c61589cd636da?s=128&d=identicon&r=PG&f=1", "display_name": "igorman007", "link": "https://stackoverflow.com/users/10950714/igorman007"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548242051, "post_id": 54325864, "comment_id": 95470292, "body": "@Someprogrammerdude no, i haven&#39;t. I can use c++11 only. And it would be good not to use std::function"}], "answers": [{"comments": [{"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1548241999, "post_id": 54325937, "comment_id": 95470253, "body": "Specifically, your <code>const F&amp; _func;</code> is referring to the <code>functor</code> parameter of the constructor, which no longer exists after the construction is finished."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1548242063, "post_id": 54325937, "comment_id": 95470300, "body": "@L.F. That&#39;s what I thought, added a clarification in my answer."}, {"owner": {"reputation": 77, "user_id": 10950714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ab993e0a3c6ce1d85c61589cd636da?s=128&d=identicon&r=PG&f=1", "display_name": "igorman007", "link": "https://stackoverflow.com/users/10950714/igorman007"}, "edited": false, "score": 0, "creation_date": 1548242568, "post_id": 54325937, "comment_id": 95470567, "body": "@MatthieuBrucher thanks, my silly mistake. Storing the object is working. But what about not using std::function in template args?"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1548242821, "post_id": 54325937, "comment_id": 95470695, "body": "You can use <code>bool(*)(int, int)</code> a the template argument, storing a pointer to the function."}, {"owner": {"reputation": 77, "user_id": 10950714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ab993e0a3c6ce1d85c61589cd636da?s=128&d=identicon&r=PG&f=1", "display_name": "igorman007", "link": "https://stackoverflow.com/users/10950714/igorman007"}, "edited": false, "score": 0, "creation_date": 1548243030, "post_id": 54325937, "comment_id": 95470802, "body": "@MatthieuBrucher but this won&#39;t work for functors, right?"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1548243205, "post_id": 54325937, "comment_id": 95470898, "body": "No, it cannot. If you pass a lambda, a functor... you need <code>std::function</code>. If you have a single function, then you can use a pointer."}], "tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 2, "last_activity_date": 1548242038, "last_edit_date": 1548242038, "creation_date": 1548241915, "answer_id": 54325937, "question_id": 54325864, "link": "https://stackoverflow.com/questions/54325864/pass-an-functor-object-to-constructor-of-templated-class/54325937#54325937", "title": "Pass an functor object to constructor of templated class", "body": "<p>Nope, this is not going to work because of the reference on a temporary object (<code>functor</code>):</p>\n\n<pre><code>const F&amp; _func;\npublic: \n    MyTemplateClass(T v1, T v2, F functor)\n    :_func(functor)\n</code></pre>\n\n<p>Store the object:</p>\n\n<pre><code>F _func;\npublic: \n    MyTemplateClass(T v1, T v2, F functor)\n    :_func(std::move(functor))\n</code></pre>\n\n<p>Or in some cases where you know the lifetime of the object, pass it as const&amp;:</p>\n\n<pre><code>MyTemplateClass(T v1, T v2, const F&amp; functor)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 2, "last_activity_date": 1548252540, "last_edit_date": 1592644375, "creation_date": 1548252540, "answer_id": 54329112, "question_id": 54325864, "link": "https://stackoverflow.com/questions/54325864/pass-an-functor-object-to-constructor-of-templated-class/54329112#54329112", "title": "Pass an functor object to constructor of templated class", "body": "<blockquote>\n<p>I've tried something like this, but got runtime-error</p>\n</blockquote>\n<p>As <a href=\"https://stackoverflow.com/users/2266772/matthieu-brucher\">Matthieu Brucher</a> pointed out <a href=\"https://stackoverflow.com/a/54325937/4342498\">their answer</a> you can't store <code>_func</code> as a reference since the object you bind the reference to dies at the end of the constructor call.  Changing to storing <code>_func</code> by value will fix that.</p>\n<blockquote>\n<p>Is there any way to make this working without using std::function and without passing typename for my functor object? I would like to use it this way</p>\n<pre><code>MyTemplateClass&lt;int&gt; test(1, 2, isGreater);\n</code></pre>\n</blockquote>\n<p>This is actually pretty easy to do.  You'll still have to use a <code>std::function</code> as the storage type and constructor parameter type but won't have to specify it.  Utilizing a <a href=\"https://en.cppreference.com/w/cpp/language/type_alias\" rel=\"nofollow noreferrer\">type alias</a> we can specify the predicate type in terms of the type of the class members.  That gives us</p>\n<pre><code>using predicate = std::function&lt;bool(T, T)&gt;;\n</code></pre>\n<p>and after adding it to the class we can rework it to be</p>\n<pre><code>template&lt;typename T&gt;\nclass MyTemplateClass {\npublic:\n    using predicate = std::function&lt;bool(T, T)&gt;;\n    MyTemplateClass(T v1, T v2, predicate functor)\n        :_func(std::move(functor))\n    {\n        _v1 = v1;\n        _v2 = v2;\n    }\n    bool Act()\n    {\n        return _func(_v1, _v2);\n    }\nprivate: \n    T _v1, _v2;\n    predicate _func;\n}; \n</code></pre>\n<p>Which can be used now like</p>\n<pre><code>int main()\n{\n    MyTemplateClass&lt;int&gt; test(1, 2, isGreater);\n    std::cout &lt;&lt; test.Act() &lt;&lt; std::endl; \n}\n    \n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 10950714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ab993e0a3c6ce1d85c61589cd636da?s=128&d=identicon&r=PG&f=1", "display_name": "igorman007", "link": "https://stackoverflow.com/users/10950714/igorman007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 54329112, "answer_count": 2, "score": 3, "last_activity_date": 1548252540, "creation_date": 1548241714, "question_id": 54325864, "link": "https://stackoverflow.com/questions/54325864/pass-an-functor-object-to-constructor-of-templated-class", "title": "Pass an functor object to constructor of templated class", "body": "<p>Imagine we have a template class. Something like this</p>\n\n<pre><code>template&lt;typename T&gt;\nclass MyTemplateClass {\nprivate: \n    T _v1, _v2;\npublic: \n    MyTemplateClass(T v1, T v2)\n    {\n        _v1 = v1;\n        _v2 = v2;\n    }\n    bool Act()\n    {\n        return _v1 &gt; _v2;\n    }\n}; \n\n//usage\nMyTemplateClass&lt;int&gt; test(1, 2);\nstd::cout &lt;&lt; test.Act() &lt;&lt; std::endl;\n</code></pre>\n\n<p>now we want to pass a functor object / function pointer / lambda to his constructor so that we can use it.</p>\n\n<p>I've tried something like this, but got runtime-error</p>\n\n<pre><code>template&lt;typename T, typename F&gt;\nclass MyTemplateClass {\nprivate: \n    T _v1, _v2;\n    const F&amp; _func;\npublic: \n    MyTemplateClass(T v1, T v2, F functor)\n        :_func(functor)\n    {\n        _v1 = v1;\n        _v2 = v2;\n    }\n    bool Act()\n    {\n        return _func(_v1, _v2);\n    }\n}; \n\nbool isGreater(int a, int b)\n{\n    return a &gt; b;\n} \n\n\n//later\n    MyTemplateClass&lt;int, std::function&lt;bool(int, int)&gt;&gt; test(1, 2, isGreater);\n    std::cout &lt;&lt; test.Act() &lt;&lt; std::endl; \n</code></pre>\n\n<p>so how could I achieve this functionality? Is there any way to make this working without using std::function and without passing typename for my functor object?\nI would like to use it this way</p>\n\n<pre><code>MyTemplateClass&lt;int&gt; test(1, 2, isGreater);\n</code></pre>\n"}, {"tags": ["c++", "templates", "inheritance", "pure-virtual"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5905016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/40rSu.jpg?s=128&g=1", "display_name": "mcamurri", "link": "https://stackoverflow.com/users/5905016/mcamurri"}, "edited": false, "score": 0, "creation_date": 1548242404, "post_id": 54325413, "comment_id": 95470474, "body": "Marking this as the most correct answer because it explains better the problem (and arrived first). Thanks!"}], "tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": true, "score": 2, "last_activity_date": 1548240250, "creation_date": 1548240250, "answer_id": 54325413, "question_id": 54325187, "link": "https://stackoverflow.com/questions/54325187/inherited-templated-method-not-visible-after-method-with-same-name-is-added/54325413#54325413", "title": "inherited templated method not visible after method with same name is added", "body": "<p>This happens because compiler does not automatically merge all the functions from the base classes to the set of overloaded functions to select from. That is the set of overloaded functions considered when you call <code>d-&gt;doSomething(a);</code> consists only of <code>D::doSomething(const B&amp; b)</code>. In order to fix this you need to bring <code>C&lt;A&gt;::doSomething;</code> into <code>D</code> class</p>\n\n<pre><code> class D : public C&lt;A&gt; {\n public:\n     using C&lt;A&gt;::doSomething;\n     virtual void doSomething(const B&amp; b) = 0;\n };\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 5905016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/40rSu.jpg?s=128&g=1", "display_name": "mcamurri", "link": "https://stackoverflow.com/users/5905016/mcamurri"}, "edited": false, "score": 0, "creation_date": 1548242487, "post_id": 54325683, "comment_id": 95470530, "body": "Thanks for the pointer! I forgot to add the destructor in my example."}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 1, "last_activity_date": 1548241157, "creation_date": 1548241157, "answer_id": 54325683, "question_id": 54325187, "link": "https://stackoverflow.com/questions/54325187/inherited-templated-method-not-visible-after-method-with-same-name-is-added/54325683#54325683", "title": "inherited templated method not visible after method with same name is added", "body": "<p>To make a base class function visible in the derived class which is hidden by a function of the same name, you should use the <code>using</code> directive (<code>using C&lt;A&gt;::doSomething;</code>).</p>\n\n<p>However, I also want to add that GCC 8.2 reports that there is undefined behavior in the code when you <code>delete d</code>. This is because the class <code>D</code> has a non-virtual destructor.</p>\n\n<pre><code>warning: deleting object of abstract class type 'D' which has non-virtual destructor will cause undefined behavior [-Wdelete-non-virtual-dtor]\n       delete d;\n</code></pre>\n\n<p>See <a href=\"https://godbolt.org/z/ZEBRqm\" rel=\"nofollow noreferrer\">demo here</a>.</p>\n"}], "owner": {"reputation": 99, "user_id": 5905016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/40rSu.jpg?s=128&g=1", "display_name": "mcamurri", "link": "https://stackoverflow.com/users/5905016/mcamurri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 54325413, "answer_count": 2, "score": 0, "last_activity_date": 1548241157, "creation_date": 1548239552, "question_id": 54325187, "link": "https://stackoverflow.com/questions/54325187/inherited-templated-method-not-visible-after-method-with-same-name-is-added", "title": "inherited templated method not visible after method with same name is added", "body": "<p>I have the following problem. A class <code>E</code> overrides two methods: one comes from an abstract class <code>D</code> which inherits from a specialization of a templated class <code>C&lt;T&gt;</code> where <code>T = A</code>. The other is from <code>C&lt;A&gt;</code> directly. And both have the same name.</p>\n\n<p>Now, <code>D</code> should have access to both methods: <code>doSomething(const A&amp; a)</code> because it inherits it from <code>C</code>, and <code>doSomething(const B&amp; b)</code> because <code>D</code> declares it.</p>\n\n<p>However, the following code does not compile, because the compiler recognizes only the method <code>doSomething(const B&amp;)</code> from the pointer to <code>D</code> </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sstream&gt;\nusing namespace std;\n\nclass A {\nprivate:\n    int a = 10;\npublic:\n    inline std::string hello() const{\n        std::stringstream ss;\n        ss &lt;&lt; a;\n        return ss.str();\n    }\n};\n\nclass B {\nprivate:\n    int b = 20;\npublic:\n    inline std::string hello() const{\n        std::stringstream ss;\n        ss &lt;&lt; b;\n        return ss.str();\n    }\n};\n\ntemplate &lt;class T&gt;\nclass C {\npublic:\n    inline virtual bool doSomething(const T&amp; t) {\n     std::cout &lt;&lt; \"C is doing something with T\" &lt;&lt; t.hello() &lt;&lt; std::endl;\n     return true;\n    }\n};\n\n\nclass D : public C&lt;A&gt; {\npublic:\n    virtual void doSomething(const B&amp; b) = 0;\n};\n\nclass E : public D {\npublic:\n    inline bool doSomething(const A&amp; a) override {\n        std::cout &lt;&lt; \"E is doing something with A: \" &lt;&lt; a.hello() &lt;&lt; std::endl;\n        return true;\n    }\n\n    inline void doSomething(const B&amp; b) override {\n        std::cout &lt;&lt; \"E is doing somethign with B: \" &lt;&lt; b.hello() &lt;&lt; std::endl;\n    }\n};\n\n\nint main()\n{\n  A a;\n  B b;\n  D* d = new E();\n\n  d-&gt;doSomething(b);\n  d-&gt;doSomething(a); // compile error, does not recognize doSomething(const A&amp;)\n\n  delete d;\n}\n</code></pre>\n\n<p>The compiler shows the following error:</p>\n\n<pre><code>In function \u2018int main()\u2019:\nmain.cpp:62:19: error: no matching function for call to \u2018D::doSomething(A&amp;)\u2019\n   d-&gt;doSomething(a); // compile error, does not recognize doSomething(const A&amp;)\n                   ^\nmain.cpp:39:18: note: candidate: virtual void D::doSomething(const B&amp;)\n     virtual void doSomething(const B&amp; b) = 0;\n                  ^\nmain.cpp:39:18: note:   no known conversion for argument 1 from \u2018A\u2019 to \u2018const B&amp;\u2019\n</code></pre>\n\n<p>Why is that?</p>\n"}, {"tags": ["c++", "optimization"], "comments": [{"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 1, "creation_date": 1548239752, "post_id": 54325168, "comment_id": 95468974, "body": "Why even include <code>(void)msg;</code>?"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 1, "creation_date": 1548239779, "post_id": 54325168, "comment_id": 95468991, "body": "@MichaWiedenmann: if you have all warnings enabled (recommended), you will get a &quot;unused parameter&quot; warning otherwise."}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 4, "creation_date": 1548239867, "post_id": 54325168, "comment_id": 95469037, "body": "Well, then why not <code>void MyDebugLogger(std::string const&amp;) { }</code>, that is, remove <code>msg</code>."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1548241385, "post_id": 54325168, "comment_id": 95469882, "body": "A function with an empty body won&#39;t be a proper equivalent for an empty macro. that string must be constructed at runtime, etc..."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548241437, "post_id": 54325168, "comment_id": 95469908, "body": "Some general remarks, not an answer: for the compiler to optimize away the empty function, it needs to see its definition, or LTO must be enabled. You can get around the <code>(void)msg;</code> with <code>[[maybe_unused]]</code>, see e.g. my answer <a href=\"https://stackoverflow.com/a/49320892/\">here</a>. Last, changing the signature to <code>template &lt;class T&gt; void MyDebugLogger(T const&amp; msg)</code> allows logging of everything that&#39;s streamable, without converting to string first. That may or may not help you."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1548241591, "post_id": 54325168, "comment_id": 95470004, "body": "@VTT The string need not be constructed if the compiler can prove it&#39;s unused. <a href=\"https://godbolt.org/z/mYKlln\" rel=\"nofollow noreferrer\">godbolt.org/z/mYKlln</a>"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1548241782, "post_id": 54325168, "comment_id": 95470119, "body": "@BaummitAugen <a href=\"https://godbolt.org/z/FX9PZF\" rel=\"nofollow noreferrer\">Not really</a> I guess your case only works because compiler is able to analyze a case of small string optimization when no allocation is required."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1548241897, "post_id": 54325168, "comment_id": 95470184, "body": "@VTT Clang <a href=\"https://godbolt.org/z/ViyjIe\" rel=\"nofollow noreferrer\">still gets it right</a>, but good point."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1548243911, "post_id": 54325168, "comment_id": 95471264, "body": "No, it&#39;s not guaranteed that a compiler will &quot;strip out&quot; a call of a function that does nothing. Depending on compiler settings a fair few compilers will, IF the definition is visible to the compiler. If the function is defined in a different compilation unit from where it is called, then most compilers will not eliminate the call (that would require the compiler to analyse code across compilation units, which is not required, and not all compilers do it).  Notionally, a smart linker may eliminate the call to an empty function, but I&#39;m not aware of any that do."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1548245044, "post_id": 54325168, "comment_id": 95471817, "body": "@VTT: GCC with <code>-Wall -Wextra</code>, <a href=\"https://godbolt.org/z/6fYBH1\" rel=\"nofollow noreferrer\">here is an example</a>. I was referring to the function, not the macro btw (the code mentioned in the comment has a semicolon)."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1548245276, "post_id": 54325168, "comment_id": 95471958, "body": "@MichaWiedenmann: omitting the parameter wouldn&#39;t work in the <code>#ifndef DEBUG</code> version then, the way OP is using the function now."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1548245405, "post_id": 54325168, "comment_id": 95472013, "body": "@VTT: the macro doesn&#39;t have the semicolon. Also, Micha&#39;s second comment explicitly mentions the function, i.e. suggests that the function parameter should be removed then."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1548245617, "post_id": 54325168, "comment_id": 95472116, "body": "@VTT: read the first three comments, it&#39;s the conversation between me and Micha, I don&#39;t see what&#39;s unclear about it. The &quot;Well, ...&quot; part is the reply to my comment. The first comment has a semicolon."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1548246824, "post_id": 54325168, "comment_id": 95472774, "body": "The conventional way is your first option but with the <code>NDEBUG</code> expansion empty, which will remove the parameter completely without relying on compiler optimisations. (Constructing strings is not free, and leaving potentially sensitive or embarrassing strings in the binary is a no-no.)"}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 1902536, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4FbBF.png?s=128&g=1", "display_name": "FloFu", "link": "https://stackoverflow.com/users/1902536/flofu"}, "edited": false, "score": 0, "creation_date": 1548239901, "post_id": 54325214, "comment_id": 95469059, "body": "Well... Yes! :) I&#39;ll edit my post as my question is (even with your solution) do this call add an extra-cost at release. We (human) know that it can be completely removed."}, {"owner": {"reputation": 380, "user_id": 5627004, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3d69032ea3d27e87d4303b8ae5e3ee07?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfgang Roth", "link": "https://stackoverflow.com/users/5627004/wolfgang-roth"}, "reply_to_user": {"reputation": 559, "user_id": 1902536, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4FbBF.png?s=128&g=1", "display_name": "FloFu", "link": "https://stackoverflow.com/users/1902536/flofu"}, "edited": false, "score": 0, "creation_date": 1548252434, "post_id": 54325214, "comment_id": 95476051, "body": ":) seeing it this way is a bit different. To be honest, I dont know what the compiler does with an empty function body. Maybe it depends on the implementation of the compiler. If you embedd all calls to MyDebugLogger in the #ifdef statement, it sure would be left out completely. But then you would have more coding overhead"}], "tags": [], "owner": {"reputation": 380, "user_id": 5627004, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3d69032ea3d27e87d4303b8ae5e3ee07?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfgang Roth", "link": "https://stackoverflow.com/users/5627004/wolfgang-roth"}, "is_accepted": false, "score": 1, "last_activity_date": 1548239635, "creation_date": 1548239635, "answer_id": 54325214, "question_id": 54325168, "link": "https://stackoverflow.com/questions/54325168/replace-define-macro-with-empty-implementation/54325214#54325214", "title": "Replace &#39;Define macro&#39; with empty implementation", "body": "<p>practically you would do the same as with the macro:</p>\n\n<pre><code>void MyDebugLogger(std::string const&amp; msg)\n{\n#ifdef NDEBUG\n    std::clog &lt;&lt; msg &lt;&lt; \"\\n\"; // Or whatever\n#endif\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10956360, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/facbd95f2aed0c1712b5535e0a3f9690?s=128&d=identicon&r=PG", "display_name": "user10956360", "link": "https://stackoverflow.com/users/10956360/user10956360"}, "is_accepted": false, "score": 1, "last_activity_date": 1548254510, "creation_date": 1548254510, "answer_id": 54329726, "question_id": 54325168, "link": "https://stackoverflow.com/questions/54325168/replace-define-macro-with-empty-implementation/54329726#54329726", "title": "Replace &#39;Define macro&#39; with empty implementation", "body": "<p>You'r example should work, with a little tweak. In your current version the compiler \"sees\" just the function signature and will emit a call to it's symbol, which will later be resolved via the linker, so it can't optimize it out on it's own. (Link Time Optimizations might help with that, but that depends very much on you'r setup and dynamic linking would make this impossible). So maybe try something like this\nin the header:</p>\n\n<pre><code>// Assuming you are using clang or gcc,\n// but is required to not give an error by the standard and probably\n// not even needed.\n[[gnu::always_inline]] \nvoid MyDebugLogger(std::string const&amp; msg [[maybe_unused]])\n{\n  #ifdef NDEBUG\n    MyDebugLoggerImplementation(msg);\n  #endif\n}\n</code></pre>\n\n<p>And then implement it in you .cpp file. Another benefit of this method is that you\nmethod needs the Logger to be compiled with NDEBUG while this method gives the client code the choice. </p>\n"}], "owner": {"reputation": 559, "user_id": 1902536, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4FbBF.png?s=128&g=1", "display_name": "FloFu", "link": "https://stackoverflow.com/users/1902536/flofu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548254510, "creation_date": 1548239495, "last_edit_date": 1548240381, "question_id": 54325168, "link": "https://stackoverflow.com/questions/54325168/replace-define-macro-with-empty-implementation", "title": "Replace &#39;Define macro&#39; with empty implementation", "body": "<p>I usually use the <code>#define</code> macro to add code that will be here while compiling as debug time and not while compiling as release. For instance:</p>\n\n<pre><code>#ifdef NDEBUG\n# define LOG(msg) (void)msg\n#else\n# define LOG(msg) MyDebugLogger(msg)\n#endif\n</code></pre>\n\n<p>Instead of that, I was thinking of using plain function and, just not providing the body for the release method:</p>\n\n<pre><code>void MyDebugLogger(std::string const&amp; msg);\n</code></pre>\n\n<p>In MyDebugLogger.cpp:</p>\n\n<pre><code>void MyDebugLogger(std::string const&amp; msg)\n{\n#ifdef NDEBUG\n    std::clog &lt;&lt; msg &lt;&lt; \"\\n\"; // Or whatever\n#else\n    (void)msg;\n#endif\n}\n</code></pre>\n\n<p>I'm expecting that the compilers will have the power to strip out the call and add <strong>no</strong> extra cost in Release. Am I correct? \nFor some reason, could it be a bad practice?</p>\n\n<p>EDIT: My question is: If I use macros as before, I know that in Release mode, the executable will be smaller and faster, as all the code has been removed.\nIf I use the function, will it be the same? As the compiler may understand that the function does nothing and is not necessary. (Or it will add an extra, even small, for calling an empty function)</p>\n"}, {"tags": ["c++", "std", "chrono", "rfc3339"], "answers": [{"comments": [{"owner": {"reputation": 1836, "user_id": 1523730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90e3620398a07934def1113d0b31478?s=128&d=identicon&r=PG", "display_name": "sebastian", "link": "https://stackoverflow.com/users/1523730/sebastian"}, "edited": false, "score": 0, "creation_date": 1548257402, "post_id": 54329619, "comment_id": 95479151, "body": "Thanks Howard, stumbled across your date lib already, it looks very helpful! I&#39;ll keep it in mind for the future. But in this project, there&#39;s only one place where I need that format, so I rather not include an external source for that."}], "tags": [], "owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "is_accepted": false, "score": 0, "last_activity_date": 1548254175, "creation_date": 1548254175, "answer_id": 54329619, "question_id": 54325137, "link": "https://stackoverflow.com/questions/54325137/c-rfc3339-timestamp-with-milliseconds-using-stdchrono/54329619#54329619", "title": "C++ RFC3339 timestamp with milliseconds using std::chrono", "body": "<p>You could also do this with subtraction:</p>\n\n<pre><code>string\nnow_rfc3339()\n{\n    const auto now_ms = time_point_cast&lt;milliseconds&gt;(system_clock::now());\n    const auto now_s = time_point_cast&lt;seconds&gt;(now_ms);\n    const auto millis = now_ms - now_s;\n    const auto c_now = system_clock::to_time_t(now_s);\n\n    stringstream ss;\n    ss &lt;&lt; put_time(gmtime(&amp;c_now), \"%FT%T\")\n       &lt;&lt; '.' &lt;&lt; setfill('0') &lt;&lt; setw(3) &lt;&lt; millis.count() &lt;&lt; 'Z';\n    return ss.str();\n}\n</code></pre>\n\n<p>This avoids the \"magic number\" 1000.</p>\n\n<p>Also, there is <a href=\"https://github.com/HowardHinnant/date/blob/master/include/date/date.h\" rel=\"nofollow noreferrer\">Howard Hinnant's free, open source, single-header, header-only datetime library</a>:</p>\n\n<pre><code>string\nnow_rfc3339()\n{\n    return date::format(\"%FT%TZ\", time_point_cast&lt;milliseconds&gt;(system_clock::now()));\n}\n</code></pre>\n\n<p>This does the same thing but with easier syntax.</p>\n"}], "owner": {"reputation": 1836, "user_id": 1523730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90e3620398a07934def1113d0b31478?s=128&d=identicon&r=PG", "display_name": "sebastian", "link": "https://stackoverflow.com/users/1523730/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1568, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1548254175, "creation_date": 1548239420, "question_id": 54325137, "link": "https://stackoverflow.com/questions/54325137/c-rfc3339-timestamp-with-milliseconds-using-stdchrono", "title": "C++ RFC3339 timestamp with milliseconds using std::chrono", "body": "<p>I'm creating an <a href=\"http://tools.ietf.org/html/rfc3339\" rel=\"nofollow noreferrer\">RFC3339</a> timestamp, including milliseconds and in UTC, in C++ using <code>std::chrono</code> like so:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;chrono&gt;\n#include &lt;ctime&gt;\n#include &lt;iomanip&gt;\n\nusing namespace std;\nusing namespace std::chrono;\n\nstring now_rfc3339() {\n  const auto now = system_clock::now();\n  const auto millis = duration_cast&lt;milliseconds&gt;(now.time_since_epoch()).count() % 1000;\n  const auto c_now = system_clock::to_time_t(now);\n\n  stringstream ss;\n  ss &lt;&lt; put_time(gmtime(&amp;c_now), \"%FT%T\") &lt;&lt;\n    '.' &lt;&lt; setfill('0') &lt;&lt; setw(3) &lt;&lt; millis &lt;&lt; 'Z';\n  return ss.str();\n}\n\n// output like 2019-01-23T10:18:32.079Z\n\n</code></pre>\n\n<p>(forgive the <code>using</code>s)</p>\n\n<p>Is there a more straight forward way of getting the milliseconds of <code>now</code>? It seems somewhat cumbersome to <code>%1000</code> the <code>now</code> in milliseconds to get there. Or any other comments on how to do this more idiomatic?</p>\n"}, {"tags": ["c++", "memory-management", "quadtree"], "comments": [{"owner": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "edited": false, "score": 1, "creation_date": 1548239626, "post_id": 54325079, "comment_id": 95468905, "body": "Please give us the concrete implementation. Otherwise you will not get any concrete answer. Nevertheless, you can think about overloading <code>new</code> in order to create a memory pool."}, {"owner": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "reply_to_user": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "edited": false, "score": 0, "creation_date": 1548240616, "post_id": 54325079, "comment_id": 95469462, "body": "Hi, thanks for your answer.  I&#39;ve updated my post with more info on my implementation."}, {"owner": {"reputation": 16707, "user_id": 341065, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8e57fe4b0f7381288a8e1e4c6cd77a8e?s=128&d=identicon&r=PG", "display_name": "wilx", "link": "https://stackoverflow.com/users/341065/wilx"}, "edited": false, "score": 0, "creation_date": 1548240729, "post_id": 54325079, "comment_id": 95469526, "body": "Instead of new/delete, why don&#39;t you try to put unused nodes into a free list and use a node from the free list unless none is available?"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1548240899, "post_id": 54325079, "comment_id": 95469619, "body": "<i>&quot;<code>new</code> and <code>delete</code> about 200 ~ 300 times per frame is going to kill my performance&quot;</i>, did you actually benchmark that?"}, {"owner": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "reply_to_user": {"reputation": 16707, "user_id": 341065, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8e57fe4b0f7381288a8e1e4c6cd77a8e?s=128&d=identicon&r=PG", "display_name": "wilx", "link": "https://stackoverflow.com/users/341065/wilx"}, "edited": false, "score": 0, "creation_date": 1548241604, "post_id": 54325079, "comment_id": 95470017, "body": "@wilx when you say &quot;try to put unused nodes into a freelist&quot; what do you mean by &quot;unused nodes&quot;?  Does it mean I could create all the nodes in advance and pop them from the list when I subdivide the tree?"}, {"owner": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1548241608, "post_id": 54325079, "comment_id": 95470020, "body": "@PasserBy I tried it in UE4 and I barely get 60FPS (around 56~59), and I don&#39;t have lgihts, meshes, textures yet. Just the Quadtree. So I think it won&#39;t be viable."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1548241661, "post_id": 54325079, "comment_id": 95470046, "body": "You have no evidence that <code>new</code> is the culprit here, and as a working hypothesis it is rather dubious. You need to profile your code and identify tue actual bottlenecks. In any case, not recreating the entire tree every frame would probably be a good idea."}, {"owner": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1548242671, "post_id": 54325079, "comment_id": 95470616, "body": "@n.m. You are right. I might step back and profile it to see where it&#39;s actually blocking.  I must have read too much about the subject these days, I saw all kind of warning about memory allocation etc... That made me think that my approach was definitely bad."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 16707, "user_id": 341065, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8e57fe4b0f7381288a8e1e4c6cd77a8e?s=128&d=identicon&r=PG", "display_name": "wilx", "link": "https://stackoverflow.com/users/341065/wilx"}, "edited": false, "score": 1, "creation_date": 1548243210, "post_id": 54325079, "comment_id": 95470900, "body": "To prevent individual allocations, you could provide chunks of pre-allocated nodes which are not yet in use. When nodes are sub-divided they can be taken out of that pool. (If sub-division is reversed they could be given back - this is how I understood @wilx.) If pre-allocated nodes are fully consumed and more are needed then a new chunk has to be allocated. This would at least reduce the number of individual allocations and might even improve the performance by better cache-locality..."}, {"owner": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1548244803, "post_id": 54325079, "comment_id": 95471694, "body": "@Scheff oh okay I see it now! Tanks for clarifying.  I need to learn more about memory pool, but I&#39;m already getting the core idea."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1548246507, "post_id": 54325079, "comment_id": 95472622, "body": "A memory pool could be in simplest case a list of vectors of nodes + a bit fiddling to manage unused vs. used nodes based on that pool. Please, be aware, while a vector provides convenient allocation by giving it an initial size - resizing it may invalidate all of its contents. (Therefore, I mentioned a list of vectors.) The &quot;+ a bit fiddling to manage unused vs. used nodes&quot; could become a bit more complicated if you want to give back individual nodes. Otherwise, some kind of counter is probably sufficient to recognize when a vector is exhausted (and a new one is needed)."}, {"owner": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1548248966, "post_id": 54325079, "comment_id": 95473977, "body": "@Scheff If I understand, I&#39;d have some vector&lt;Node&gt; that reserve, let&#39;s say, a hundred bytes by default.  When it gets oversized (just before), Instead of resizing it, I create a new one to store the new nodes. Actually instead of creating a new vector I simply create a list of them, and that represent my memory pool?  Therefore, when I want to subdivide my tree, instead of saying  <code>Node* newNode = new Node();</code> It would be something like this : <code>Node* newNode = &amp;Nodes.emplace();</code> is that correct?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1548249900, "post_id": 54325079, "comment_id": 95474532, "body": "For a list of nodes, you had to allocate each instance individually. In a vector of nodes, you could allocate an &quot;arbitrary&quot; number of instances at once (which additionally are stored consecutively -&gt; cache locality). If you address those nodes in the vector by pointer, you must prevent any reallocation (or addresses of contained nodes might become invalid). However, you have to limit the size of the vector and you may not know how much nodes will be required at maximum, or there usually will not be required as many as theoretically possible. Hence, the list of such vectors."}, {"owner": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1548253496, "post_id": 54325079, "comment_id": 95476672, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/187191/discussion-between-maxime-parata-and-scheff\">continue this discussion in chat</a>."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1548253737, "post_id": 54325079, "comment_id": 95476825, "body": "Sorry, I missed your invitation. However, I prepared a small demo and am about to write an answer."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "edited": false, "score": 0, "creation_date": 1548257392, "post_id": 54329857, "comment_id": 95479146, "body": "This is exciting indeed! Thank you very much for taking your time to make this demo, I think it&#39;ll make a useful resource.  I&#39;m quite new to C++, it&#39;s only been 2 month that I&#39;m using it, so it takes me a little while before I understand new concepts. But this is so clear.  I need to read it through again and try to get it done by myself, so I can assimilate it.  I was reading about overloaded <code>new</code> today, it seems very cool to use.  Idk what in-place construction is but I&#39;ll read about it later. If you have other cool things like this to lead me to, I&#39;ll be glad to read about it!"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "edited": false, "score": 1, "creation_date": 1548258854, "post_id": 54329857, "comment_id": 95479981, "body": "@MaximeParata You are welcome. I inserted some additional notes about deleted copy constructors etc. and found a link for in-place construction."}, {"owner": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "edited": false, "score": 0, "creation_date": 1549476499, "post_id": 54329857, "comment_id": 95919208, "body": "I tried to implement the pool myself, but I don&#39;t get the return statement of the <code>GetNew()</code> function. What does <code>(*_ItrEnd)[++size, n++];</code> mean exactly? usually the operator [x, y] is used for 2D arrays right? But here, even though we have a sort of 2D array, the operator [] is not supposed to work with lists. I understand that it&#39;s actually returning what&#39;s at <code>*_ItrEnd[n++]</code> But the whole statement is unclear to me. can you tell me how it&#39;s supposed to work?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "edited": false, "score": 1, "creation_date": 1549477733, "post_id": 54329857, "comment_id": 95919748, "body": "@MaximeParata No. There are no 2D subscript operators in C++. <code>(*_iterEnd)</code> refers to current element in list. That&#39;s a <code>vector</code>. <code>[_n++]</code> retrieves the <code>_n</code>th element of it while <code>_n</code> is incremented afterwards. The result is <code>Element&amp;</code> and that&#39;s what is returned. The <code>++_size</code> is an intended side-effect which I put into the expression for subscript with a sequence operator <code>,</code>. The result of <code>++_size</code> is discarded but the effect (the incr. of <code>_size</code>) happens immediately before returning the result of <code>[_n]</code>, and that&#39;s what I wanted. But, <code>++_size; return (*_iterEnd)[_n++];</code> works as well."}, {"owner": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "edited": false, "score": 0, "creation_date": 1549532210, "post_id": 54329857, "comment_id": 95938244, "body": "Okay I understand it better now. It&#39;s very neat and well simplified, I didn&#39;t even know that was possible. Thanks."}], "tags": [], "owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "is_accepted": true, "score": 1, "last_activity_date": 1548258628, "last_edit_date": 1548258628, "creation_date": 1548254928, "answer_id": 54329857, "question_id": 54325079, "link": "https://stackoverflow.com/questions/54325079/subdivide-quadtree-without-the-new-operator/54329857#54329857", "title": "Subdivide Quadtree without the new operator", "body": "<p>I want to demonstrate a very simple memory pool. (In my comment, I recommended a list of vectors for this, and this is what I want to elaborate below.)</p>\n\n<p>At first, I make some constraints which are used to simplify the concept:</p>\n\n<ol>\n<li>Nodes provide a default constructor.</li>\n<li>No inplace construction of nodes is required.</li>\n<li>Nodes are created consecutively and freed all at once.</li>\n</ol>\n\n<p>So, I start with a <code>template class PoolT</code>:</p>\n\n<pre><code>#include &lt;iomanip&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;list&gt;\n\ntemplate &lt;typename ELEMENT, size_t N = 16&gt;\nclass PoolT {\n  private:\n    typedef std::list&lt;std::vector&lt;ELEMENT&gt; &gt; Data;\n    Data _data;\n    typename Data::iterator _iterEnd;\n    size_t _n;\n    size_t _size, _capacity;\n\n  public:\n    PoolT():\n      _data(), _iterEnd(_data.end()), _n(N),\n      _size(0), _capacity(0)\n    {\n      std::cout &lt;&lt; \"  PoolT&lt;ELEMENT&gt;::PoolT()\\n\";\n    }\n    ~PoolT() = default;\n\n    PoolT(const PoolT&amp;) = delete;\n    PoolT&amp; operator=(const PoolT&amp;) = delete;\n\n    ELEMENT&amp; getNew()\n    {\n      if (_n &gt;= N &amp;&amp; _iterEnd != _data.end()) {\n        _n = 0; ++_iterEnd;\n        std::cout &lt;&lt; \"  PoolT&lt;ELEMENT&gt;::getNew(): switching to next chunk.\\n\";\n      }\n      if (_iterEnd == _data.end()) {\n        std::cout &lt;&lt; \"  PoolT&lt;ELEMENT&gt;::getNew(): Chunks exhausted. Allocating new chunk of size \" &lt;&lt; N &lt;&lt; \".\\n\";\n        _iterEnd = _data.insert(_iterEnd, std::vector&lt;ELEMENT&gt;(N));\n        _capacity += N;\n        _n = 0;\n      }\n      std::cout &lt;&lt; \"  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT \" &lt;&lt; _n &lt;&lt; \" of current chunk.\\n\";\n      return (*_iterEnd)[++_size, _n++];\n    }\n\n    void reset()\n    {\n      _size = _n = 0; _iterEnd = _data.begin();\n    }\n\n    size_t size() const { return _size; }\n    size_t capacity() const { return _capacity; }\n};\n</code></pre>\n\n<p>The chunks are implemented as <code>std::vector&lt;ELEMENT&gt;</code> and the list of chunks is just a <code>std::list&lt;std::vector&lt;ELEMENT&gt;&gt;</code>.</p>\n\n<p>The <code>ELEMENT&amp; getNew()</code> is the function to request a new ELEMENT from pool.</p>\n\n<p>If the current chunk is exhausted, a switch to next chunk is performed.</p>\n\n<p>If it was the last chunk then a new chunk is allocated and added to list.</p>\n\n<p>Afterwards, the next element is returned from chunk.</p>\n\n<p>Please, note, that I disabled copy constructor and copy assignment operator of <code>PoolT</code>. I don't see any sense in copying a memory pool. So, if it is done accidentally (e.g. forget to insert the <code>&amp;</code> when intending to pass it by reference as argument to function) this will cause a compiler error.</p>\n\n<p>For the elements, I made a <code>struct Node</code> which resembles parts of OPs quadtree node:</p>\n\n<pre><code>struct Node {\n  Node *pNW, *pNE, *pSW, *pSE;\n\n  Node(): pNW(nullptr), pNE(nullptr), pSW(nullptr), pSE(nullptr) { }\n  ~Node() = default;\n\n  Node(const Node&amp;) = delete;\n  Node&amp; operator=(const Node&amp;) = delete;\n\n  void clear()\n  {\n    pNW = pNE = pSW = pSE = nullptr;\n  }\n};\n</code></pre>\n\n<p>The returned <code>ELEMENT</code> might have been used before. Hence, it should be reset to an intitial state afterwards. To keep it simple, I just made a function <code>Node::clear()</code> which resets the instance to an initial state.</p>\n\n<p>I disabled the copy constructor and copy assignment operator of <code>Node</code> as well. In my sample, <code>Node</code> instances refer to each other by pointers. Hence, a reallocation of their storage would have fatal consequences. (It would make node pointers dangling.) The memory pool <code>PoolT</code> is build with this in mind. (For an accidental reallocation in <code>std::vector</code>, at least one of them (copy constructor or assignment operator) would have been needed. Hence,  I would get a compiler error in this case.) </p>\n\n<p>A memory pool for <code>Node</code>:</p>\n\n<pre><code>typedef PoolT&lt;Node&gt; NodePool;\n</code></pre>\n\n<p>And a small test suite, to show things in action:</p>\n\n<pre><code>Node* fill(NodePool &amp;nodePool, int depth)\n{\n  Node *pNode = &amp;nodePool.getNew();\n  pNode-&gt;clear();\n  if (--depth &gt; 0) {\n    pNode-&gt;pNW = fill(nodePool, depth);\n    pNode-&gt;pNE = fill(nodePool, depth);\n    pNode-&gt;pSW = fill(nodePool, depth);\n    pNode-&gt;pSE = fill(nodePool, depth);\n  }\n  return pNode;\n}\n\nvoid print(std::ostream &amp;out, const Node *pNode, int depth = 0)\n{\n  out &lt;&lt; (const void*)pNode &lt;&lt; '\\n';\n  if (!pNode) return;\n  ++depth;\n  if (pNode-&gt;pNW) {\n    out &lt;&lt; std::setw(2 * depth) &lt;&lt; \"\" &lt;&lt; \"pNW: \"; print(out, pNode-&gt;pNW, depth);\n  }\n  if (pNode-&gt;pNE) {\n    out &lt;&lt; std::setw(2 * depth) &lt;&lt; \"\" &lt;&lt; \"pNE: \"; print(out, pNode-&gt;pNE, depth);\n  }\n  if (pNode-&gt;pSW) {\n    out &lt;&lt; std::setw(2 * depth) &lt;&lt; \"\" &lt;&lt; \"pSW: \"; print(out, pNode-&gt;pSW, depth);\n  }\n  if (pNode-&gt;pSE) {\n    out &lt;&lt; std::setw(2 * depth) &lt;&lt; \"\" &lt;&lt; \"pSE: \"; print(out, pNode-&gt;pSE, depth);\n  }\n}\n\n#define DEBUG(...) std::cout &lt;&lt; #__VA_ARGS__ &lt;&lt; \";\\n\"; __VA_ARGS__\n\nint main()\n{\n  DEBUG(NodePool nodePool);\n  std::cout\n    &lt;&lt; \"nodePool.capacity(): \" &lt;&lt; nodePool.capacity() &lt;&lt; \", \"\n    &lt;&lt; \"nodePool.size(): \" &lt;&lt; nodePool.size() &lt;&lt; '\\n';\n  DEBUG(Node *pRoot = nullptr);\n  DEBUG(pRoot = fill(nodePool, 2));\n  DEBUG(std::cout &lt;&lt; \"pRoot: \"; print(std::cout, pRoot));\n  std::cout\n    &lt;&lt; \"nodePool.capacity(): \" &lt;&lt; nodePool.capacity() &lt;&lt; \", \"\n    &lt;&lt; \"nodePool.size(): \" &lt;&lt; nodePool.size() &lt;&lt; '\\n';\n  DEBUG(pRoot = nullptr);\n  DEBUG(nodePool.reset());\n  std::cout\n    &lt;&lt; \"nodePool.capacity(): \" &lt;&lt; nodePool.capacity() &lt;&lt; \", \"\n    &lt;&lt; \"nodePool.size(): \" &lt;&lt; nodePool.size() &lt;&lt; '\\n';\n  DEBUG(pRoot = fill(nodePool, 3));\n  DEBUG(std::cout &lt;&lt; \"pRoot: \"; print(std::cout, pRoot));\n  std::cout\n    &lt;&lt; \"nodePool.capacity(): \" &lt;&lt; nodePool.capacity() &lt;&lt; \", \"\n    &lt;&lt; \"nodePool.size(): \" &lt;&lt; nodePool.size() &lt;&lt; '\\n';\n  return 0;\n}\n</code></pre>\n\n<p>Compiled and tested:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>NodePool nodePool;\n  PoolT&lt;ELEMENT&gt;::PoolT()\nnodePool.capacity(): 0, nodePool.size(): 0\nNode *pRoot = nullptr;\npRoot = fill(nodePool, 2);\n  PoolT&lt;ELEMENT&gt;::getNew(): Chunks exhausted. Allocating new chunk of size 16.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 0 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 1 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 2 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 3 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 4 of current chunk.\nstd::cout &lt;&lt; \"pRoot: \"; print(std::cout, pRoot);\npRoot: 0xcb4c30\n  pNW: 0xcb4c50\n  pNE: 0xcb4c70\n  pSW: 0xcb4c90\n  pSE: 0xcb4cb0\nnodePool.capacity(): 16, nodePool.size(): 5\npRoot = nullptr;\nnodePool.reset();\nnodePool.capacity(): 16, nodePool.size(): 0\npRoot = fill(nodePool, 3);\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 0 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 1 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 2 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 3 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 4 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 5 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 6 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 7 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 8 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 9 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 10 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 11 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 12 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 13 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 14 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 15 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): switching to next chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): Chunks exhausted. Allocating new chunk of size 16.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 0 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 1 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 2 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 3 of current chunk.\n  PoolT&lt;ELEMENT&gt;::getNew(): returning ELEMENT 4 of current chunk.\nstd::cout &lt;&lt; \"pRoot: \"; print(std::cout, pRoot);\npRoot: 0xcb4c30\n  pNW: 0xcb4c50\n    pNW: 0xcb4c70\n    pNE: 0xcb4c90\n    pSW: 0xcb4cb0\n    pSE: 0xcb4cd0\n  pNE: 0xcb4cf0\n    pNW: 0xcb4d10\n    pNE: 0xcb4d30\n    pSW: 0xcb4d50\n    pSE: 0xcb4d70\n  pSW: 0xcb4d90\n    pNW: 0xcb4db0\n    pNE: 0xcb4dd0\n    pSW: 0xcb4df0\n    pSE: 0xcb4e10\n  pSE: 0xcb4e70\n    pNW: 0xcb4e90\n    pNE: 0xcb4eb0\n    pSW: 0xcb4ed0\n    pSE: 0xcb4ef0\nnodePool.capacity(): 32, nodePool.size(): 21\n</code></pre>\n\n<p><kbd><a href=\"http://coliru.stacked-crooked.com/a/ed72766cedfe3a26\" rel=\"nofollow noreferrer\"><strong>Live Demo on coliru</strong></a></kbd></p>\n\n<p>I used a rather small <code>N = 16</code> as default chunk size. I did this to show exhausting of chunks without the necessity to blow the samples size too much. For &ldquo;productive&rdquo; usage, I would, of course, recommend a higher value.</p>\n\n<p>There is, of course, a lot of potential to make this more sophisticated, obtaining the C++ features like overloaded <code>new</code> and <code>delete</code>, in-place construction (like e.g. in <a href=\"https://en.cppreference.com/w/cpp/container/vector/emplace\" rel=\"nofollow noreferrer\">std::vector::emplace()</a>) or other exciting things.</p>\n"}], "owner": {"reputation": 105, "user_id": 10721390, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sIrR19LDQGg/AAAAAAAAAAI/AAAAAAAAFb0/oMqyDD6sxco/photo.jpg?sz=128", "display_name": "Maxime Parata", "link": "https://stackoverflow.com/users/10721390/maxime-parata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 54329857, "answer_count": 1, "score": 4, "last_activity_date": 1548258628, "creation_date": 1548239220, "last_edit_date": 1548240569, "question_id": 54325079, "link": "https://stackoverflow.com/questions/54325079/subdivide-quadtree-without-the-new-operator", "title": "Subdivide Quadtree without the new operator", "body": "<p>In every implementation of Quadtrees I've seen, the subdivision method always uses the <code>new</code> operator to create the child cells.</p>\n\n<p>Is there a way to avoid that? \nBecause I recreate my Quadtree every frame to update it easily, but using <code>new</code> and <code>delete</code> about 200 ~ 300 times per frame is going to kill my performance.</p>\n\n<p>This is my Implementation : </p>\n\n<pre><code>void UQuadtree::subdivide(Quad * Node)\n{\n    float HalfExtent = Node-&gt;Extent/2;\n    FVector2D Center = Node-&gt;Center;\n\n    Node-&gt;NW = new Quad(FVector2D(Center.X + HalfExtent, Center.Y - HalfExtent), HalfExtent);\n    Node-&gt;NE = new Quad(FVector2D(Center.X + HalfExtent, Center.Y + HalfExtent), HalfExtent);\n    Node-&gt;SW = new Quad(FVector2D(Center.X - HalfExtent, Center.Y - HalfExtent), HalfExtent);\n    Node-&gt;SE = new Quad(FVector2D(Center.X - HalfExtent, Center.Y + HalfExtent), HalfExtent);\n}\n\nbool UQuadtree::insert(FVector2D* point, Quad * Node)\n{\n    if (!ConstructBox2D(Node-&gt;Center, Node-&gt;Extent).IsInside(*point)) \n    {\n        return false;\n    }\n    if (Node-&gt;Points.Num() &lt; Capacity) {\n        Node-&gt;Points.Add(point);\n\n        return true;\n    }\n    if (Node-&gt;NW == nullptr) {\n        subdivide(Node);\n    }\n    if (insert(point, Node-&gt;NW)) { return true; }\n    if (insert(point, Node-&gt;NE)) { return true; }\n    if (insert(point, Node-&gt;SW)) { return true; }\n    if (insert(point, Node-&gt;SE)) { return true; }\n\n    return false;\n}\n</code></pre>\n\n<p>And I do this for every points I want to add to my Quadtree (about 1000), every frames, after deleting the whole tree with the clear() function.</p>\n\n<pre><code>void UQuadtree::clear() {\n\n    if (root-&gt;NW != nullptr) {\n        delete root-&gt;NW;\n        root-&gt;NW = nullptr;\n        delete root-&gt;NE;\n        root-&gt;NE = nullptr;\n        delete root-&gt;SW;\n        root-&gt;SW = nullptr;\n        delete root-&gt;SE;\n        root-&gt;SE = nullptr;\n    }\n}\n</code></pre>\n\n<p>(BTW,I implemented it in UE4).</p>\n"}, {"tags": ["c++", "json", "nlohmann-json"], "comments": [{"owner": {"reputation": 1615, "user_id": 10362622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54067bb99c90afda4a7ac844255dc6b5?s=128&d=identicon&r=PG&f=1", "display_name": "dave", "link": "https://stackoverflow.com/users/10362622/dave"}, "edited": false, "score": 5, "creation_date": 1548238739, "post_id": 54324892, "comment_id": 95468364, "body": "You create a new json document each time you run the program, which will be empty. If you want to append info to an existing document, you need to read it first!"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 1615, "user_id": 10362622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54067bb99c90afda4a7ac844255dc6b5?s=128&d=identicon&r=PG&f=1", "display_name": "dave", "link": "https://stackoverflow.com/users/10362622/dave"}, "edited": false, "score": 2, "creation_date": 1548238757, "post_id": 54324892, "comment_id": 95468375, "body": "Because you asked it to, try this instead <code>o.open(&quot;logins.json&quot;, std::ios_base:app| std::ios_base::ate);</code> But if you want to have a single JSON object in the output file then you are going to have to read the file first, like @dave said. Remember computers do what you tell them to, not what you want them to."}, {"owner": {"reputation": 43, "user_id": 10907563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767502276688101/picture?type=large", "display_name": "Reinis Z\u012bverts", "link": "https://stackoverflow.com/users/10907563/reinis-z%c4%abverts"}, "edited": false, "score": 0, "creation_date": 1548239269, "post_id": 54324892, "comment_id": 95468685, "body": "Okey, so i replace o.open(&quot;logins.json&quot;) with o.open(&quot;logins.json&quot;, std::ios_base:app| std::ios_base::ate)  and it should work ?"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1548239521, "post_id": 54324892, "comment_id": 95468844, "body": "@ReinisZ\u012bverts That completely depends on what you mean by work. You will not see the new output replace the old output, but whether you&#39;ll be happy or not I can&#39;t say, since I don&#39;t know exactly what you want."}, {"owner": {"reputation": 43, "user_id": 10907563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767502276688101/picture?type=large", "display_name": "Reinis Z\u012bverts", "link": "https://stackoverflow.com/users/10907563/reinis-z%c4%abverts"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1548239921, "post_id": 54324892, "comment_id": 95469073, "body": "@john Well, thats all I need. So each time I run the programm it adds new data to json file, depending on input, but the old data still stays there."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1548245872, "post_id": 54324892, "comment_id": 95472256, "body": "Storing passwords? Yikes!"}, {"owner": {"reputation": 43, "user_id": 10907563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767502276688101/picture?type=large", "display_name": "Reinis Z\u012bverts", "link": "https://stackoverflow.com/users/10907563/reinis-z%c4%abverts"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1548251768, "post_id": 54324892, "comment_id": 95475662, "body": "@LightnessRacesinOrbit It&#39;s just for school, no actual passwords will be stored that way."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1548252844, "post_id": 54324892, "comment_id": 95476306, "body": "Hopefully your teacher is not teaching you to store passwords!"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10907563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767502276688101/picture?type=large", "display_name": "Reinis Z\u012bverts", "link": "https://stackoverflow.com/users/10907563/reinis-z%c4%abverts"}, "edited": false, "score": 0, "creation_date": 1548239794, "post_id": 54325118, "comment_id": 95468998, "body": "Could you help me with the code. This is all new stuff to me, but I need to do it for class project, and i&#39;ve searched alot, I think it is around 10H of solid searching for answers, but all I can find is some code bits, but not the whole picture. And I can&#39;t put it all together, as you can see."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 43, "user_id": 10907563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767502276688101/picture?type=large", "display_name": "Reinis Z\u012bverts", "link": "https://stackoverflow.com/users/10907563/reinis-z%c4%abverts"}, "edited": false, "score": 0, "creation_date": 1548239808, "post_id": 54325118, "comment_id": 95469005, "body": "@ReinisZ\u012bverts Added an example for you."}, {"owner": {"reputation": 43, "user_id": 10907563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767502276688101/picture?type=large", "display_name": "Reinis Z\u012bverts", "link": "https://stackoverflow.com/users/10907563/reinis-z%c4%abverts"}, "edited": false, "score": 0, "creation_date": 1548240319, "post_id": 54325118, "comment_id": 95469294, "body": "OMG. Thank you so much. You just saved my day and my sanity."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1548242209, "last_edit_date": 1548242209, "creation_date": 1548239365, "answer_id": 54325118, "question_id": 54324892, "link": "https://stackoverflow.com/questions/54324892/why-is-json-file-deleting-old-inputs-from-c/54325118#54325118", "title": "Why is json file deleting old inputs from c++?", "body": "<p>Every time you run this application it rewrites file <code>logins.json</code> ignoring its existing contents.</p>\n\n<p>If you would like to edit the json file, you need to load it first, decode json, modify json, and serialize the json back into the file overwriting it.</p>\n\n<p>E.g.:</p>\n\n<pre><code>int main() {\n    json j;\n    {\n        std::ifstream i(\"logins.json\");\n        if(i.is_open())\n            i &gt;&gt; j;\n    }\n\n    system(\"cls\");\n    std::string pass;\n    std::string user;\n    std::cout &lt;&lt; \"Username: \";\n    std::cin &gt;&gt; user;\n    std::cout &lt;&lt; \"Password: \";\n    std::cin &gt;&gt; pass;\n\n    j[user][\"Username\"] = user;\n    j[user][\"Password\"] = pass;\n\n    std::ofstream o(\"logins.json\");\n    o &lt;&lt; std::setw(4) &lt;&lt; j &lt;&lt; '\\n';\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10907563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767502276688101/picture?type=large", "display_name": "Reinis Z\u012bverts", "link": "https://stackoverflow.com/users/10907563/reinis-z%c4%abverts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 54325118, "answer_count": 1, "score": 2, "last_activity_date": 1558557027, "creation_date": 1548238614, "last_edit_date": 1558557027, "question_id": 54324892, "link": "https://stackoverflow.com/questions/54324892/why-is-json-file-deleting-old-inputs-from-c", "title": "Why is json file deleting old inputs from c++?", "body": "<p>I need to make a program that stores usernames and passwords. I want to store them in json file. I already made a program that kinda does that, but it deletes old inputs and rewrite them as new. </p>\n\n<pre><code>int main()\n{\nchar pass[12];\nchar user[12];\n\nstd::ofstream o;\n\no.open(\"logins.json\");\n\njson j;\n\n    system(\"cls\");\n    std::cout &lt;&lt; \"Username: \";\n    std::cin &gt;&gt; user;\n    std::cout &lt;&lt; \"Password: \";\n    std::cin &gt;&gt; pass;\n\n    j[user][\"Username\"] = user;\n    j[user][\"Password\"] = pass;\n\n    o &lt;&lt; std::setw(4) &lt;&lt; j &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>So for example we input username: admin, password: admin. It creates a json file and stores them:</p>\n\n<pre><code>{\n\"admin\": {\n    \"Username\": \"admin\",\n    \"Password\": \"admin\"\n}\n</code></pre>\n\n<p>}</p>\n\n<p>But when I run the program again and this time input username:user, password:user, it replaces admin with user. So basically it stores only one input. But I need it to store all of them. So I later can access them.</p>\n\n<p>And that's not good. Can you please help me fix this or suggest something else?</p>\n"}, {"tags": ["c++", "c", "android-source", "stack-trace", "android.mk"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1548238515, "post_id": 54324757, "comment_id": 95468237, "body": "<code>not show properly function&#39;s names</code> the function names (or function themselves) are probably removed after the code is compiled. You can try to compile with debugging symbols enabled and try writing some smart library that in case of call stack dump will try to extract the debugging symbols from specified program location, but you will / can still see some functions names missing (inlined, optimized, merged, etc...). C is not java, in C there is only assembly."}], "owner": {"reputation": 31, "user_id": 10691263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BKegOKg4xmY/AAAAAAAAAAI/AAAAAAAAAEs/Bm2yh3uCSwo/photo.jpg?sz=128", "display_name": "\u0413\u0440\u0438\u0446\u044c \u0425\u0443\u0434\u0438\u0439", "link": "https://stackoverflow.com/users/10691263/%d0%93%d1%80%d0%b8%d1%86%d1%8c-%d0%a5%d1%83%d0%b4%d0%b8%d0%b9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 446, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1548238205, "creation_date": 1548238205, "question_id": 54324757, "link": "https://stackoverflow.com/questions/54324757/aosp-print-method-call-stack-trace", "title": "AOSP print method call stack trace", "body": "<p>I need to see a stack trace in AOSP C/C++ code. I have found some solutions but all of them not show properly function's names.<br><br>\n1. The solution from <a href=\"http://yongbingchen.github.io/blog/2013/05/09/dump-stack-in-android-native-c-code/\" rel=\"nofollow noreferrer\">http://yongbingchen.github.io/blog/2013/05/09/dump-stack-in-android-native-c-code/</a> gives the following result:\n<br><code>01-22 11:19:24.737 CallStack ( 3304): #00 pc 0004440b  /system/lib/hw/bluetooth.default.so (dump_stack_android+42)\n01-22 11:19:24.737 CallStack ( 3304): #01 pc 0008b7f5  /system/lib/hw/bluetooth.default.so (btif_gatt_check_encrypted_link+32)\n01-22 11:19:24.737 CallStack ( 3304): #02 pc 0008870f  /system/lib/hw/bluetooth.default.so\n01-22 11:19:24.737 CallStack ( 3304): #03 pc 0007ea5f  /system/lib/hw/bluetooth.default.so\n01-22 11:19:24.737 CallStack ( 3304): #04 pc 00126c5f  /system/lib/hw/bluetooth.default.so\n01-22 11:19:24.737 CallStack ( 3304): #05 pc 00125673  /system/lib/hw/bluetooth.default.so\n01-22 11:19:24.737 CallStack ( 3304): #06 pc 00126963  /system/lib/hw/bluetooth.default.so\n01-22 11:19:24.737 CallStack ( 3304): #07 pc 00047313  /system/lib/libc.so (_ZL15__pthread_startPv+22)\n01-22 11:19:24.737 CallStack ( 3304): #08 pc 00019e5d  /system/lib/libc.so (__start_thread+6)</code><br><br>\nAs you can see the lines from <code>#02</code> to <code>#06</code> have no function's names<br><br>\n2. The solution from <a href=\"https://stackoverflow.com/a/28858941/10691263\">https://stackoverflow.com/a/28858941/10691263</a> working fine for the desctop project after adding <code>-rdynamic</code> flag. However, after integrating this code with AOSP I got the same result as in the previous example.<br>\nIt looks like some symbols in bluetooth.default.so are hidden. I tried to change <code>-fvisibility</code> flag in <code>Android.mk</code> from <code>hidden</code> to <code>default</code> but received the following compiling error:\n<code>system/bt/btcore/src/hal_util.c:90: error: undefined reference to 'hw_get_module'\nclang++: error: linker command failed with exit code 1 (use -v to see invocation)</code><br><br>\nPlease help me find a solution that will be able to show a callstack with all function's names for AOSP.</p>\n"}, {"tags": ["c++", "c", "clion"], "comments": [{"owner": {"reputation": 3447, "user_id": 4297146, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Zl9y3.jpg?s=128&g=1", "display_name": "mohabouje", "link": "https://stackoverflow.com/users/4297146/mohabouje"}, "edited": false, "score": 0, "creation_date": 1548238127, "post_id": 54324634, "comment_id": 95467999, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/35159634/how-to-link-curses-h-in-cmake\">How to link curses.h in Cmake?</a>"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1548238958, "post_id": 54324634, "comment_id": 95468489, "body": "Please proofread your writing; it&#39;s hard to understand. There&#39;s no letter el or space in <code>ncurses</code> and  an IDE is an acronym for &quot;Integrated Development Environment&quot;; it only has one e and should be in all caps. We can figure out what you mean, but it&#39;s easier if you write in a more standard way so we don&#39;t need to figure out whether &quot;idee&quot; is &quot;IDE&quot; or &quot;idea&quot; or something."}, {"owner": {"reputation": 3, "user_id": 10954917, "user_type": "registered", "profile_image": "https://graph.facebook.com/2289562041300633/picture?type=large", "display_name": "Luca Ladu", "link": "https://stackoverflow.com/users/10954917/luca-ladu"}, "edited": false, "score": 0, "creation_date": 1548239265, "post_id": 54324634, "comment_id": 95468683, "body": "sorry I was wrong writing IDE"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10954917, "user_type": "registered", "profile_image": "https://graph.facebook.com/2289562041300633/picture?type=large", "display_name": "Luca Ladu", "link": "https://stackoverflow.com/users/10954917/luca-ladu"}, "edited": false, "score": 0, "creation_date": 1548238610, "post_id": 54324710, "comment_id": 95468289, "body": "/opt/clion-2018.2.6/bin/cmake/linux/bin/cmake -DCMAKE_BUILD_TYPE=Debug -G &quot;CodeBlocks - Unix Makefiles&quot; &quot;/home/luca/CLionProjects/backup progetto pipe/progetto_pipe_2&quot; -- Found Curses: /usr/lib/x86_64-linux-gnu/libcurses.so   CMake Error at CMakeLists.txt:8 (target_link_libraries):   Cannot specify link libraries for target &quot;progetto_pipe_2&quot; which is not   built by this project.   -- Configuring incomplete, errors occurred! See also &quot;/home/luca/CLionProjects/backup progetto pipe/progetto_pipe_2/cmake-build-debug/CMakeFiles/CMakeOutpu&zwnj;&#8203;t.log&quot;.  [Finished]"}, {"owner": {"reputation": 3447, "user_id": 4297146, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Zl9y3.jpg?s=128&g=1", "display_name": "mohabouje", "link": "https://stackoverflow.com/users/4297146/mohabouje"}, "reply_to_user": {"reputation": 3, "user_id": 10954917, "user_type": "registered", "profile_image": "https://graph.facebook.com/2289562041300633/picture?type=large", "display_name": "Luca Ladu", "link": "https://stackoverflow.com/users/10954917/luca-ladu"}, "edited": false, "score": 0, "creation_date": 1548239236, "post_id": 54324710, "comment_id": 95468666, "body": "You should link a library after declaring the target. See the modifications."}, {"owner": {"reputation": 3, "user_id": 10954917, "user_type": "registered", "profile_image": "https://graph.facebook.com/2289562041300633/picture?type=large", "display_name": "Luca Ladu", "link": "https://stackoverflow.com/users/10954917/luca-ladu"}, "edited": false, "score": 0, "creation_date": 1548239586, "post_id": 54324710, "comment_id": 95468889, "body": "Thanks, but now comes the following error if I try to use debugging  ____  Error opening terminal: unknown.  Process finished with exit code 1"}, {"owner": {"reputation": 3, "user_id": 10954917, "user_type": "registered", "profile_image": "https://graph.facebook.com/2289562041300633/picture?type=large", "display_name": "Luca Ladu", "link": "https://stackoverflow.com/users/10954917/luca-ladu"}, "edited": false, "score": 0, "creation_date": 1548239822, "post_id": 54324710, "comment_id": 95469013, "body": "After these commands                                                                                  initscr();     noecho();     curs_set(0)"}, {"owner": {"reputation": 3447, "user_id": 4297146, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Zl9y3.jpg?s=128&g=1", "display_name": "mohabouje", "link": "https://stackoverflow.com/users/4297146/mohabouje"}, "reply_to_user": {"reputation": 3, "user_id": 10954917, "user_type": "registered", "profile_image": "https://graph.facebook.com/2289562041300633/picture?type=large", "display_name": "Luca Ladu", "link": "https://stackoverflow.com/users/10954917/luca-ladu"}, "edited": false, "score": 0, "creation_date": 1548240115, "post_id": 54324710, "comment_id": 95469175, "body": "You should open another question for that. That error is not related to library linkage or the cmake configuration."}], "tags": [], "owner": {"reputation": 3447, "user_id": 4297146, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Zl9y3.jpg?s=128&g=1", "display_name": "mohabouje", "link": "https://stackoverflow.com/users/4297146/mohabouje"}, "is_accepted": true, "score": 0, "last_activity_date": 1548239200, "last_edit_date": 1548239200, "creation_date": 1548238086, "answer_id": 54324710, "question_id": 54324634, "link": "https://stackoverflow.com/questions/54324634/lncurses-on-clion-with-ubuntu/54324710#54324710", "title": "lncurses on Clion with Ubuntu", "body": "<p>You need to link the library in your cmake configuration file. Check this post: <a href=\"https://stackoverflow.com/questions/35159634/how-to-link-curses-h-in-cmake\">How to link curses.h in Cmake?</a></p>\n\n<p>Try:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.12) \nproject(progetto_pipe_2 C)\nset(CMAKE_C_STANDARD 99)\n\n# Define the target\nadd_executable(progetto_pipe_2 main.c movimento.c movimento.h grafica.c grafica.h area_gioco.c area_gioco.h)\n\n# Look for the package you want to link\nfind_package( Curses REQUIRED )\n\n# Include the directories of the package (to find curses.h for instance)\ntarget_include_directories(progetto_pipe_2 PRIVATE ${CURSES_INCLUDE_DIRS} )\n\n# Link the library\ntarget_link_libraries(progetto_pipe_2 PRIVATE ${CURSES_LIBRARIES} )\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10954917, "user_type": "registered", "profile_image": "https://graph.facebook.com/2289562041300633/picture?type=large", "display_name": "Luca Ladu", "link": "https://stackoverflow.com/users/10954917/luca-ladu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 54324710, "answer_count": 1, "score": 0, "last_activity_date": 1548239588, "creation_date": 1548237862, "last_edit_date": 1548239588, "question_id": 54324634, "link": "https://stackoverflow.com/questions/54324634/lncurses-on-clion-with-ubuntu", "title": "lncurses on Clion with Ubuntu", "body": "<p>I'm doing a project for school with C, i'm using Clion as idee.\nI already installed the ln curses in Ubuntu with the command</p>\n\n<pre><code>sudo apt-get install libncurses&lt;ver&gt;-dev\n</code></pre>\n\n<p>Using the shall, the program works!\nBut I would like to do some debugging with idee.\nMy cmake file is this </p>\n\n<pre><code>cmake_minimum_required(VERSION 3.12)\nproject(progetto_pipe_2 C)\n\nset(CMAKE_C_STANDARD 99)\n\nadd_executable(progetto_pipe_2 main.c movimento.c movimento.h grafica.c grafica.h area_gioco.c area_gioco.h)\n</code></pre>\n\n<p>If I start the application from idee , the following error appears is:</p>\n\n<pre><code>undefined reference to `initscr' ecc ecc\n</code></pre>\n"}, {"tags": ["javascript", "c++", "qt", "qml"], "comments": [{"owner": {"reputation": 2669, "user_id": 1228771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SF8S5.png?s=128&g=1", "display_name": "Amfasis", "link": "https://stackoverflow.com/users/1228771/amfasis"}, "edited": false, "score": 0, "creation_date": 1548318697, "post_id": 54324258, "comment_id": 95500450, "body": "The exception code means an access violation. It&#39;s probably a good idea to add quite some logging if you&#39;re not able to sit and watch ;-)"}, {"owner": {"reputation": 80, "user_id": 6363797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/661da3524bb8f57b241499f532cd19e3?s=128&d=identicon&r=PG&f=1", "display_name": "zohee", "link": "https://stackoverflow.com/users/6363797/zohee"}, "reply_to_user": {"reputation": 2669, "user_id": 1228771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SF8S5.png?s=128&g=1", "display_name": "Amfasis", "link": "https://stackoverflow.com/users/1228771/amfasis"}, "edited": false, "score": 0, "creation_date": 1548319736, "post_id": 54324258, "comment_id": 95500957, "body": "yes i think i should do it"}], "owner": {"reputation": 80, "user_id": 6363797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/661da3524bb8f57b241499f532cd19e3?s=128&d=identicon&r=PG&f=1", "display_name": "zohee", "link": "https://stackoverflow.com/users/6363797/zohee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1548238030, "creation_date": 1548236685, "last_edit_date": 1548238030, "question_id": 54324258, "link": "https://stackoverflow.com/questions/54324258/why-module-qt5quick-dll-sometimes-generate-error-and-application-crash-because-o", "title": "why module Qt5Quick.dll sometimes generate error and application crash because of it?", "body": "<p>i have an application that run properly good but sometimes it crash and because i am away i can't see what happened exactly,just i can check event viewer of Windows that it return this</p>\n\n<h1>error:</h1>\n\n<p><strong>Faulting application name:</strong>\nmyApp.exe, version: 0.0.0.0, time stamp: 0x5c35ee78</p>\n\n<p><strong>Faulting module name:</strong>\n Qt5Quick.dll, version: 5.9.1.0, time stamp: 0x59539656</p>\n\n<p><strong>Exception code:</strong>\n 0xc0000005</p>\n\n<p><strong>Fault offset:</strong>\n0x0009c690</p>\n\n<p><strong>Faulting process id:</strong>\n 0xea4</p>\n\n<p><strong>Faulting application start time:</strong>\n 0x01d4b1a8a0ea5d8b</p>\n\n<p><strong>Faulting application path:</strong>\n C:\\Program Files\\myApp.exe</p>\n\n<p><strong>Faulting module path:</strong>\nC:\\Program Files\\Qt5Quick.dll</p>\n\n<p><strong>Report Id:</strong>\n 1c079607-b5f9-4991-b144-ccea521260e3</p>\n\n<p><strong>Faulting package full name:</strong> </p>\n\n<p><strong>Faulting package-relative application ID:</strong></p>\n\n<p>event ID=1000 and Task category is 100 --------\nit's so strange that in some system this error occur more and in some of them 1 time in day.i search a lot about this error but nothing found.is there any body know what i get this error?</p>\n\n<p><strong>ps:</strong>\nQt 5.9.1 (MSVC 2015, 32 bit)\nif need more detail say me.thanks   </p>\n"}]