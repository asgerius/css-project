[{"tags": ["c++", "macos", "openssl", "casablanca", "cpprest-sdk"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1499297459, "post_id": 44937414, "comment_id": 76851435, "body": "&quot;Is there something else that needs to be done to compile this file?&quot; : How would we know when you don&#39;t show us &quot;this file&quot;? Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 255, "user_id": 5361388, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/390946537763279/picture?type=large", "display_name": "Anit", "link": "https://stackoverflow.com/users/5361388/anit"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1499297724, "post_id": 44937414, "comment_id": 76851501, "body": "It is the same file that is there at <a href=\"https://github.com/Microsoft/cpprestsdk/wiki/Getting-Started-Tutorial\" rel=\"nofollow noreferrer\">github.com/Microsoft/cpprestsdk/wiki/Getting-Started-Tutoria&zwnj;&#8203;l</a>  Sorry I missed to add the code as I had added a link which has the complete code."}, {"owner": {"reputation": 255, "user_id": 5361388, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/390946537763279/picture?type=large", "display_name": "Anit", "link": "https://stackoverflow.com/users/5361388/anit"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1499297736, "post_id": 44937414, "comment_id": 76851504, "body": "Can you please explain the reason for the downvote?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1499298522, "post_id": 44937414, "comment_id": 76851701, "body": "Please show the command line used to compile your program or library. <code>CPPFLAGS</code> is the C preprocessor. You should add <code>-I&#47;usr&#47;local&#47;opt&#47;openssl&#47;include</code> to <code>CFLAGS</code> (C options) and <code>CXXFLAGS</code> (C++ options). Its the compiler driver&#39;s job to pass arguments down to the C preprocessor; not vice versa. If it literally is <code>g++ -std=c++11 BingSearch.cpp</code>, then use <code>g++ $CXXFLAGS -std=c++11 BingSearch.cpp</code>"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1499298530, "post_id": 44937414, "comment_id": 76851704, "body": "Also see <a href=\"http://stackoverflow.com/q/38670295\">Homebrew refusing to link OpenSSL</a>, <a href=\"http://stackoverflow.com/q/15185661\">Update OpenSSL on OS X with Homebrew</a>, <a href=\"http://stackoverflow.com/q/35129977\">How to install latest version of openssl Mac OS X El Capitan</a>, <a href=\"http://apple.stackexchange.com/q/126830\">How to upgrade OpenSSL in OS X?</a>, <a href=\"http://superuser.com/q/486389\">Openssl installation using HomeBrew fails</a>, etc."}, {"owner": {"reputation": 255, "user_id": 5361388, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/390946537763279/picture?type=large", "display_name": "Anit", "link": "https://stackoverflow.com/users/5361388/anit"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1499299615, "post_id": 44937414, "comment_id": 76851935, "body": "@jww Thanks! I am sure how if I am running the program correctly. The example link does not say how to run the program. So I am running it as any other C++ program &quot;g++ -std=c++11 BingSearch.cpp&quot;. Please let me know if there is an alternate way to run it."}], "answers": [{"tags": [], "owner": {"reputation": 255, "user_id": 5361388, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/390946537763279/picture?type=large", "display_name": "Anit", "link": "https://stackoverflow.com/users/5361388/anit"}, "is_accepted": true, "score": 1, "last_activity_date": 1499371500, "creation_date": 1499371500, "answer_id": 44957937, "question_id": 44937414, "link": "https://stackoverflow.com/questions/44937414/running-casablanca-program-fails-with-openssl-conf-h-file-not-found-on-mac-os/44957937#44957937", "title": "Running Casablanca program fails with &#39;openssl/conf.h&#39; file not found on Mac OS", "body": "<p>I tried @jww's suggestion as below.</p>\n\n<pre><code>g++ -std=c++11 BingSearch.cpp -lssl -lcrypto -L/usr/local/opt/openssl/lib -I/usr/local/opt/openssl/include\n</code></pre>\n\n<p>This resulted in overcoming 'conf.h' file not found error.</p>\n\n<p>But it still failed with the below error.</p>\n\n<pre><code>Undefined symbols for architecture x86_64:\n  \"web::uri_builder::append_query(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, bool)\", referenced from:\n      web::uri_builder&amp; web::uri_builder::append_query&lt;char [18]&gt;(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, char const (&amp;) [18], bool) in BingSearch-582644.o\n</code></pre>\n\n<p>I followed <a href=\"https://github.com/Microsoft/cpprestsdk/issues/264\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/cpprestsdk/issues/264</a> and it resolved the problem.</p>\n\n<p>I am able to compile the program using the below command.</p>\n\n<pre><code>g++ -std=c++11 BingSearch.cpp -stdlib=libc++ -lcpprest -lssl -lcrypto -lboost_system -lboost_thread-mt -lboost_chrono-mt -L/usr/local/opt/openssl/lib -I/usr/local/opt/openssl/include\n</code></pre>\n\n<p>My PATH variable is set as follows.</p>\n\n<pre><code>$echo $PATH\n/usr/local/opt/openssl/bin:/opt/local/bin:/opt/local/sbin:/usr/local/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin\n</code></pre>\n"}], "owner": {"reputation": 255, "user_id": 5361388, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/390946537763279/picture?type=large", "display_name": "Anit", "link": "https://stackoverflow.com/users/5361388/anit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 0, "closed_date": 1499393952, "accepted_answer_id": 44957937, "answer_count": 1, "score": 0, "last_activity_date": 1499371500, "creation_date": 1499296587, "last_edit_date": 1499297665, "question_id": 44937414, "link": "https://stackoverflow.com/questions/44937414/running-casablanca-program-fails-with-openssl-conf-h-file-not-found-on-mac-os", "closed_reason": "Not suitable for this site", "title": "Running Casablanca program fails with &#39;openssl/conf.h&#39; file not found on Mac OS", "body": "<p>I am trying to setup a Http client and download some data using the example shown <a href=\"https://github.com/Microsoft/cpprestsdk/wiki/Getting-Started-Tutorial\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>When I try to run the program, it fails saying \"conf.h\" is not found.</p>\n\n<pre><code>$g++ -std=c++11 BingSearch.cpp\nIn file included from BingSearch.cpp:1:\nIn file included from /usr/local/include/cpprest/http_client.h:53:\nIn file included from /usr/local/include/boost/asio/ssl.hpp:19:\nIn file included from /usr/local/include/boost/asio/ssl/context.hpp:27:\nIn file included from /usr/local/include/boost/asio/ssl/context_base.hpp:19:\n/usr/local/include/boost/asio/ssl/detail/openssl_types.hpp:20:10: fatal error: 'openssl/conf.h' file not found\n#include &lt;openssl/conf.h&gt;\n         ^\n1 error generated.\n</code></pre>\n\n<p>I looked at other SO <a href=\"https://stackoverflow.com/questions/43415106/openssl-conf-h-file-not-found-error-on-macos-sierra\">posts</a> and I have set the necessary path variables. </p>\n\n<pre><code>$echo $LDFLAGS\n-L/usr/local/opt/openssl/lib\n$echo $CPPFLAGS\n-I/usr/local/opt/openssl/include\n$echo $PKG_CONFIG_PATH\n/usr/local/opt/openssl/lib/pkgconfig\n</code></pre>\n\n<p>Also conf.h is located inside openssl directory</p>\n\n<pre><code>openssl $find /usr/local/opt/openssl/ -name \"conf.h\"\n/usr/local/opt/openssl//include/openssl/conf.h\n</code></pre>\n\n<p>Is there something else that needs to be done to compile the below file? It is got from <a href=\"https://github.com/Microsoft/cpprestsdk/wiki/Getting-Started-Tutorial\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>#include &lt;cpprest/http_client.h&gt;\n#include &lt;cpprest/filestream.h&gt;\n\nusing namespace utility;                    // Common utilities like string conversions\nusing namespace web;                        // Common features like URIs.\nusing namespace web::http;                  // Common HTTP functionality\nusing namespace web::http::client;          // HTTP client features\nusing namespace concurrency::streams;       // Asynchronous streams\n\nint main(int argc, char* argv[])\n{\n    auto fileStream = std::make_shared&lt;ostream&gt;();\n\n    // Open stream to output file.\n    pplx::task&lt;void&gt; requestTask = fstream::open_ostream(U(\"results.html\")).then([=](ostream outFile)\n            {\n            *fileStream = outFile;\n\n            // Create http_client to send the request.\n            http_client client(U(\"http://www.bing.com/\"));\n\n            // Build request URI and start the request.\n            uri_builder builder(U(\"/search\"));\n            builder.append_query(U(\"q\"), U(\"cpprestsdk github\"));\n            return client.request(methods::GET, builder.to_string());\n            })\n\n    // Handle response headers arriving.\n    .then([=](http_response response)\n            {\n            printf(\"Received response status code:%u\\n\", response.status_code());\n\n            // Write response body into the file.\n            return response.body().read_to_end(fileStream-&gt;streambuf());\n            })\n\n    // Close the file stream.\n    .then([=](size_t)\n            {\n            return fileStream-&gt;close();\n            });\n\n    // Wait for all the outstanding I/O to complete and handle any exceptions\n    try\n    {\n        requestTask.wait();\n    }\n    catch (const std::exception &amp;e)\n    {\n        printf(\"Error exception:%s\\n\", e.what());\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1499295155, "post_id": 44937196, "comment_id": 76850797, "body": "What&#39;s to explain? It&#39;s a vector of vectors of int. Nothing weird going on there.. hint; you may want to consult <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/vector</a> - especially <a href=\"http://en.cppreference.com/w/cpp/container/vector/vector\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/vector/vector</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1499295396, "post_id": 44937219, "comment_id": 76850872, "body": "What is the terminology for the <code>vector&lt;int&gt;()</code> argument? A temporary or something else?"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 1, "creation_date": 1499295517, "post_id": 44937219, "comment_id": 76850906, "body": "@Ron the technical term is a prvalue (aka &quot;pure&quot; rvalue)"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1499295740, "post_id": 44937219, "comment_id": 76850968, "body": "Nitpick: <i>one</i> of the (multiple) vector constructors take such two arguments."}], "tags": [], "owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "is_accepted": false, "score": 5, "last_activity_date": 1499295782, "last_edit_date": 1499295782, "creation_date": 1499295140, "answer_id": 44937219, "question_id": 44937196, "link": "https://stackoverflow.com/questions/44937196/c-syntax-of-2d-vector/44937219#44937219", "title": "C++ syntax of 2D vector", "body": "<p>This specific constructor of vector takes two arguments:</p>\n\n<ol>\n<li>The number of elements.</li>\n<li>The value to assign to each element.</li>\n</ol>\n\n<p>For example, this creates a vector containing 3 times the value 5.</p>\n\n<pre><code>std::vector&lt;int&gt; vec(3, 5);\n</code></pre>\n\n<p><code>vector&lt;int&gt;()</code> is a default-constructed instance of <code>vector&lt;int&gt;</code>. So you are creating a vector containing n vectors, each empty.</p>\n"}, {"tags": [], "owner": {"reputation": 1515, "user_id": 6615552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/952cbb61ab387e04b000590e294c9fe8?s=128&d=identicon&r=PG&f=1", "display_name": "21koizyd", "link": "https://stackoverflow.com/users/6615552/21koizyd"}, "is_accepted": false, "score": 0, "last_activity_date": 1499298041, "creation_date": 1499298041, "answer_id": 44937612, "question_id": 44937196, "link": "https://stackoverflow.com/questions/44937196/c-syntax-of-2d-vector/44937612#44937612", "title": "C++ syntax of 2D vector", "body": "<pre><code>#include &lt;vector&gt;\nusing namespace std;\n\nint main() \n{\n    int N = 10;\n    std::vector&lt; std::vector&lt;int&gt; vector2DA(N, std::vector&lt; int&gt;(N));\n    return 0;\n\n}\n</code></pre>\n\n<p>This code create <code>vector2D</code> 10x10, first parameter constructor is size basic vector(vector2DA(size, objectWhichIsContain)), which contain other vector, which have size 10 (<code>std::vector&lt; int&gt;(size)</code>). We have <code>vector2D</code> 10x10.</p>\n"}, {"tags": [], "owner": {"reputation": 2933, "user_id": 6350858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfeae5d1ddef3ed5e81e88bdd30063f?s=128&d=identicon&r=PG&f=1", "display_name": "Ap31", "link": "https://stackoverflow.com/users/6350858/ap31"}, "is_accepted": false, "score": 0, "last_activity_date": 1499310656, "creation_date": 1499310656, "answer_id": 44939168, "question_id": 44937196, "link": "https://stackoverflow.com/questions/44937196/c-syntax-of-2d-vector/44939168#44939168", "title": "C++ syntax of 2D vector", "body": "<p>First of all, <code>vector</code> of <code>vector</code>s is not exactly a \"2D vector\". The \"rows\" of <code>vector&lt;vector&lt;&gt;&gt;</code> are completely independent both in terms of memory layout and semantically. There are better options, e.g. <a href=\"http://www.boost.org/doc/libs/1_38_0/libs/multi_array/doc/index.html\" rel=\"nofollow noreferrer\">Boost.Multi_array</a>.  </p>\n\n<p>Then we have <code>vector &lt;int&gt; ()</code>. Depending on context this could mean both temorary object initialization or a function declaration. The example in question actually does not provide enough context:</p>\n\n<pre><code>vector &lt;vector &lt;int&gt; &gt; s(n,vector &lt;int&gt; ());\n</code></pre>\n\n<p>If <code>n</code> happens to be a type name, then this line is a function declaration. Of course <code>n</code> is probably an <code>int</code>, but it would be better to explicitly state that you want a default-constructed <code>vector&lt;int&gt;</code> as a second argument:  </p>\n\n<pre><code>vector &lt;vector &lt;int&gt; &gt; s(n,vector &lt;int&gt; {});\n</code></pre>\n\n<p>Here <code>vector &lt;int&gt; {}</code> unambiguously means <em>\"a default-constructed temporary object of type <code>vector&lt;int&gt;</code>\"</em>, and you pass it to the <code>vector&lt;vector&lt;int&gt;&gt;</code> constructor as a value to initialize your rows with.  </p>\n\n<p>This brings us to another observation: <code>std::vector</code> <em>value-initializes</em> its elements by default, which means that the same result can be achieved like that:  </p>\n\n<pre><code>vector &lt;vector &lt;int&gt; &gt; s(n);\n</code></pre>\n\n<p>Finally, the presence of <code>vector&lt;int&gt;()</code> in the original statement kind of hints that it might have been intended to set up the \"width\" of the 2D vector:  </p>\n\n<pre><code>vector &lt;vector &lt;int&gt; &gt; s(n,vector &lt;int&gt; (m));  \n</code></pre>\n\n<p>but <code>m</code> got lost somewhere along the lines :)</p>\n"}], "owner": {"reputation": 25, "user_id": 6941474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be1a69ba2831359fab7a9f5d9247eac2?s=128&d=identicon&r=PG&f=1", "display_name": "rahul kadam", "link": "https://stackoverflow.com/users/6941474/rahul-kadam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1499310656, "creation_date": 1499294898, "question_id": 44937196, "link": "https://stackoverflow.com/questions/44937196/c-syntax-of-2d-vector", "title": "C++ syntax of 2D vector", "body": "<p>Can someone explain below c++ syntax with example ?</p>\n\n<pre><code>vector &lt;vector &lt;int&gt; &gt; s(n,vector &lt;int&gt; ());\n</code></pre>\n\n<p>especially this part inside the constructor:</p>\n\n<pre><code>vector &lt;int&gt; ()\n</code></pre>\n"}, {"tags": ["c++", "mysql", "qt", "qtableview", "qsqltablemodel"], "comments": [{"owner": {"reputation": 2342, "user_id": 1606402, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/58eb2d7e318592109d99dd7846c6dfd9?s=128&d=identicon&r=PG&f=1", "display_name": "saeed", "link": "https://stackoverflow.com/users/1606402/saeed"}, "edited": false, "score": 0, "creation_date": 1499345833, "post_id": 44937181, "comment_id": 76874132, "body": "I&#39;m not sure about this comment but may be &quot;QTableView::resizeRowsToContents()&quot; helps to reach what you desired. If so let me know."}, {"owner": {"reputation": 13, "user_id": 8261762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab16b7827e93e93b1269fe3738062692?s=128&d=identicon&r=PG&f=1", "display_name": "KevinR", "link": "https://stackoverflow.com/users/8261762/kevinr"}, "reply_to_user": {"reputation": 2342, "user_id": 1606402, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/58eb2d7e318592109d99dd7846c6dfd9?s=128&d=identicon&r=PG&f=1", "display_name": "saeed", "link": "https://stackoverflow.com/users/1606402/saeed"}, "edited": false, "score": 0, "creation_date": 1499480885, "post_id": 44937181, "comment_id": 76939065, "body": "@saeed I think QTableView::resizeRowsToContents() could be useful if the text was a simple large string , but it is not, the text comes from mysql table which is displayed in the tableview with qsqltablemodel, so the problem is how can I select the text from the sql table and put it in the tableview since I can&#39;t control this, I just use tableview-&gt;setModel(qsqlmodel) in order to display the data in the tableview"}], "owner": {"reputation": 13, "user_id": 8261762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab16b7827e93e93b1269fe3738062692?s=128&d=identicon&r=PG&f=1", "display_name": "KevinR", "link": "https://stackoverflow.com/users/8261762/kevinr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 483, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1499306788, "creation_date": 1499294807, "last_edit_date": 1499306788, "question_id": 44937181, "link": "https://stackoverflow.com/questions/44937181/how-to-display-multiline-cells-in-qtableview-with-qsqltablemodel", "title": "How to display multiline cells in QTableView with QSqlTableModel", "body": "<p>I have a QSqlTableModel with a table from a MySQL database, which I use to populate a table view with setModel function, this works fine but I want multiline cells in all rows of one column in order to be able to display some columns info of that row insted of display all the columns. Here is an example of my current table and what I want.</p>\n\n<p>Current table and desired table\n<img src=\"https://i.stack.imgur.com/IMKad.png\" alt=\"Current table and desired table\"></p>\n\n<p>Here is an actual example:\nTable with multiple lines in cells of one column\n<img src=\"https://i.stack.imgur.com/OH93o.png\" alt=\"Table with multiple lines in cells of one column\"></p>\n\n<p>Does anyone know how to achieve this with a QTableView and QSqlTableModel as source to fill the table view?</p>\n\n<p>Can this be done subclassing QStyledItemDelegate? If so, could someone show me an example to understand it? I don't know how to access and select data of some columns of my QSqlTableModel and put it in a QTableView  cell.  </p>\n"}, {"tags": ["c++", "opencv", "image-processing", "matrix", "gdal"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 1, "creation_date": 1499294209, "post_id": 44936925, "comment_id": 76850478, "body": "My gut tells me you are looking for haar cascades: <a href=\"http://docs.opencv.org/2.4/modules/objdetect/doc/cascade_classification.html?highlight=feature\" rel=\"nofollow noreferrer\">docs.opencv.org/2.4/modules/objdetect/doc/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1352, "user_id": 165606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kZART.jpg?s=128&g=1", "display_name": "DanyAlejandro", "link": "https://stackoverflow.com/users/165606/danyalejandro"}, "is_accepted": false, "score": 0, "last_activity_date": 1499305019, "creation_date": 1499305019, "answer_id": 44938451, "question_id": 44936925, "link": "https://stackoverflow.com/questions/44936925/finding-regions-of-higher-numbers-in-a-matrix/44938451#44938451", "title": "Finding regions of higher numbers in a matrix", "body": "<p>Supposing you can put the DEM information into a 2D Mat where each \"pixel\" has the elevation value, you can find local maximums by applying <strong>dilate</strong> and then <strong>substract</strong> the result from the original image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gqDQ8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gqDQ8.png\" alt=\"enter image description here\"></a></p>\n\n<p>There's a related post with code examples in: <a href=\"http://answers.opencv.org/question/28035/find-local-maximum-in-1d-2d-mat/\" rel=\"nofollow noreferrer\">http://answers.opencv.org/question/28035/find-local-maximum-in-1d-2d-mat/</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8083649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6a2511d03a355959767850a7d6c152?s=128&d=identicon&r=PG&f=1", "display_name": "Will Carty", "link": "https://stackoverflow.com/users/8083649/will-carty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499305019, "creation_date": 1499293390, "question_id": 44936925, "link": "https://stackoverflow.com/questions/44936925/finding-regions-of-higher-numbers-in-a-matrix", "title": "Finding regions of higher numbers in a matrix", "body": "<p>I am working on a project to detect certain objects in an aerial image, and as part of this I am trying to utilize elevation data for the image. I am working with Digital Elevation Models (DEMs), basically a matrix of elevation values. When I am trying to detect trees, for example, I want to search for tree-shaped regions that are higher than their surrounding terrain. Here is an example of a tree in a DEM heatmap:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pIvlv.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/pIvlv.png</a></p>\n\n<p>I want to be able to find small regions like that that are higher than their surroundings.</p>\n\n<p>I am using OpenCV and GDAL for my actual image processing. Do either of those already contain techniques for what I'm trying to accomplish? If not, can you point me in the right direction? Some ideas I've had are going through each pixel and calculating the rate of change in relation to it's surrounding pixels, which would hopefully mean that pixels with high rates change/steep slopes would signify an edge of a raised area.</p>\n\n<p>Note that the elevations will change from image to image, and this needs to work with any elevation. So the ground might be around 10 meters in one image but 20 meters in another.</p>\n"}, {"tags": ["c++", "templates", "nested"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1499293572, "post_id": 44936909, "comment_id": 76850208, "body": "Uh, maybe <code>try {return a.b_.value().c_.value().d_.value().l_;} catch (...) {return def;}</code>?"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 1, "creation_date": 1499293705, "post_id": 44936909, "comment_id": 76850275, "body": "In more functional languages, what you&#39;re asking for would be called a monad. I don&#39;t know of any monad libraries for C++, but that might give you a search term to start looking for."}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499295215, "post_id": 44936909, "comment_id": 76850818, "body": "I think this should be achievable using expression templates. You&#39;d have to rely on operator-&gt; since . is not overloadable, but it might be possible"}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1499298309, "creation_date": 1499298309, "answer_id": 44937643, "question_id": 44936909, "link": "https://stackoverflow.com/questions/44936909/optionally-descend-a-nested-struct/44937643#44937643", "title": "Optionally descend a nested struct", "body": "<p>You can do something like</p>\n\n<pre><code>template &lt;typename Class, typename Def, typename M&gt;\nDef getValueOrDefault(const Class&amp; c, Def, M m)\n{\n    return c.*m;\n}\n\ntemplate &lt;typename Class, typename Def, typename  M, typename ... Ms&gt;\nDef getValueOrDefault(const Class&amp; c, Def def, M m, Ms... ms)\n{\n    if (c.*m) {\n        return getValueOrDefault(*(c.*m), def, ms...);\n    } else {\n        return def;\n    }\n}\n</code></pre>\n\n<p>With usage:</p>\n\n<pre><code>std::cout &lt;&lt; getValueOrDefault(a, 0, &amp;A::b, &amp;B::j) &lt;&lt; std::endl;\nstd::cout &lt;&lt; getValueOrDefault(a, 0, &amp;A::b, &amp;B::c, &amp;C::k) &lt;&lt; std::endl;\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/228b4723b5fe75ff\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 0, "last_activity_date": 1499303014, "creation_date": 1499303014, "answer_id": 44938228, "question_id": 44936909, "link": "https://stackoverflow.com/questions/44936909/optionally-descend-a-nested-struct/44938228#44938228", "title": "Optionally descend a nested struct", "body": "<p>This needs bind.</p>\n\n<p>Bind takes optional of a and a function from a to b or optional of b, and returns an optional of b.</p>\n\n<p>Suppose we had a named operator <code>-&gt;*bind*</code> that understands poinnter to members.  Then</p>\n\n<pre><code>auto op_l = a-&gt;*bind*&amp;A::b1_-&gt;*bind*&amp;B::c1_-&gt;*bind*&amp;C::d1_-&gt;*bind*&amp;D::l_;\nreturn value_or(op_l,def);\n</code></pre>\n\n<p>(Where value or takes an optional and a default).</p>\n"}, {"tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": false, "score": 0, "last_activity_date": 1499304789, "last_edit_date": 1499304789, "creation_date": 1499303875, "answer_id": 44938324, "question_id": 44936909, "link": "https://stackoverflow.com/questions/44936909/optionally-descend-a-nested-struct/44938324#44938324", "title": "Optionally descend a nested struct", "body": "<p>you need something recursive to do it. As an example, if you can have the same base class for your A, B, C, structs, you can have something like this:</p>\n\n<pre><code>struct Presentable &lt;T&gt; {\n  Optional&lt;T&gt; opt;\n  virtual int getIntValue(int def) {\n    if (opt.isPresent())\n     return opt.getValue().getIntValue(def);\n    else\n     return def;\n    }\n};\n\nstruct A : public Presentable&lt;B&gt;) {\n  int i_;\n};\n...\nstruct D : Presentable &lt;F&gt; {\n   int getIntValue(int) {return l_;}\n}\n</code></pre>\n\n<p>Now you can get your value from the end of the chain or 'def'. </p>\n\n<p>This is just one of possible variants, but in any case you would either need some base class, or you can use a pointer to create parent-child relation between structs (Optional class can help in doing so), or you can probably use dynamic cast for doing it.</p>\n"}], "owner": {"reputation": 11, "user_id": 3482208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5de13fb736b3df45b070c34ae384be4?s=128&d=identicon&r=PG&f=1", "display_name": "madakhan", "link": "https://stackoverflow.com/users/3482208/madakhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1499304789, "creation_date": 1499293290, "question_id": 44936909, "link": "https://stackoverflow.com/questions/44936909/optionally-descend-a-nested-struct", "title": "Optionally descend a nested struct", "body": "<p>Assuming a class template <code>Optional</code> exists:</p>\n\n<pre><code>template &lt;class T&gt;\nclass Optional\n{\npublic:\n  ...\n  bool isPresent(void) const {...}\n  const T&amp; value(void) {...} // throws if !isPresent()\n  ...\n};\n</code></pre>\n\n<p>Also, some structs with nested <code>Optional</code> fields are defined:</p>\n\n<pre><code>struct A;\nstruct B;\nstruct C;\nstruct D;\n\nstruct A\n{\n   Optional&lt;B&gt; b1_;\n   int i_;\n};\n\nstruct B\n{\n   Optional&lt;C&gt; c1_;\n   int j_;\n};\n\nstruct C\n{\n   Optional&lt;D&gt; d1_;\n   int k_;\n};\n\nstruct D\n{\n   int l_;\n   int m_;\n   int n_;\n};\n</code></pre>\n\n<p>I'm looking for a programming idiom that provides the following behavior without the ugliness.</p>\n\n<pre><code>int get_l_OrDefault(const A&amp; a, int def)\n{\n  if (!a.b_.isPresent()) return def;\n  else if (!a.b_.value().c_.isPresent()) return def;\n  else if (!a.b_.value().c_.value().d_.isPresent()) return def;\n  else return a.b_.value().c_.value().d_.value().l_;\n}\n</code></pre>\n\n<p>Given an <code>A a;</code>, can I define something that takes some representation of the path to the non-optional leaf field and a default value?</p>\n\n<pre><code>getValueOrDefault(a.b.j_, 0);\ngetValueOrDefault(a.b.c.k_, 0);\n... etc\n</code></pre>\n"}, {"tags": ["c++", "memory-leaks"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1499293361, "post_id": 44936891, "comment_id": 76850136, "body": "There is no leak in this code (unless <code>Mem.Read()</code> or <code>string()</code> throw an exception), let alone anything that allocates 221K of memory. To avoid any possible leaking, you should use a <code>std::vector&lt;char&gt;</code> instead of a <code>char[]</code>. Or, just read from memory directly into the <code>std::string</code> that you return."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1499293465, "post_id": 44936891, "comment_id": 76850164, "body": "And never use bare new a delete in code like this. If you&#39;re using C++, you should be adhering to RAII"}, {"owner": {"reputation": 187, "user_id": 1939991, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/10c51aa23c9b3f4c988a3726e4830bbb?s=128&d=identicon&r=PG", "display_name": "user1939991", "link": "https://stackoverflow.com/users/1939991/user1939991"}, "edited": false, "score": 0, "creation_date": 1499293490, "post_id": 44936891, "comment_id": 76850174, "body": "What else could cause an enormous char[] to form and fill the heap if no other char[] are made throughout the code?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1499293523, "post_id": 44936891, "comment_id": 76850186, "body": "@user1939991: what makes you think there is any <code>char[]</code> at all? Or even a single <code>char[]</code>?  If you are just looking at raw memory, it could represent <i>literally anything</i>.  To diagnose a memory leak, you need to trace your app&#39;s individual allocations and frees.  Only your app&#39;s memory manager library can do that reliably, since it is the one managing those operations, so only it knows what constitutes a real leak. For instance, maybe freed memory is cached for later reuse? You don&#39;t know, it is an implementation detail."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1499293659, "post_id": 44936891, "comment_id": 76850250, "body": "@user1939991 And are you sure it&#39;s a single array, and not 232,023,801 bytes total of leaked character arrays?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1499293682, "post_id": 44936891, "comment_id": 76850261, "body": "Why, ohh why, are you not using smart pointers in this day and age?"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 3, "creation_date": 1499293750, "post_id": 44936891, "comment_id": 76850292, "body": "<code>string(buffer)</code> expects a null-terminated string, assuming this is <code>std::string</code>. <code>buffer</code> doesn&#39;t seem to be null-terminated, so this could conceivably allocate a lot of memory or crash."}, {"owner": {"reputation": 187, "user_id": 1939991, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/10c51aa23c9b3f4c988a3726e4830bbb?s=128&d=identicon&r=PG", "display_name": "user1939991", "link": "https://stackoverflow.com/users/1939991/user1939991"}, "edited": false, "score": 0, "creation_date": 1499293889, "post_id": 44936891, "comment_id": 76850358, "body": "I&#39;ll have to read up on smart pointers -- i&#39;m still rather new to C++. I took a heap snapshot, and it listed a char[] under object type with a count of 1 and a size of 232,023,801 bytes. I might be interpreting this wrong, though."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1499293935, "post_id": 44936891, "comment_id": 76850382, "body": "There&#39;s no reason to use <code>new&#47;delete</code> here. Just declare a local array. Or declare a <code>std::string</code> and append each character to it, rather than using the temporary array."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1499293966, "post_id": 44936891, "comment_id": 76850394, "body": "@interjay That&#39;s almost certainly the problem, post it as an answer."}, {"owner": {"reputation": 187, "user_id": 1939991, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/10c51aa23c9b3f4c988a3726e4830bbb?s=128&d=identicon&r=PG", "display_name": "user1939991", "link": "https://stackoverflow.com/users/1939991/user1939991"}, "edited": false, "score": 0, "creation_date": 1499294105, "post_id": 44936891, "comment_id": 76850429, "body": "Thanks so much everyone for your help! I am still learning C++, and I am using bad habits that I formed while using Java, as it took care of most of the memory management for me."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1499295660, "post_id": 44936891, "comment_id": 76850940, "body": "<code>(0x1 * c)</code>.  Ummm."}, {"owner": {"reputation": 187, "user_id": 1939991, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/10c51aa23c9b3f4c988a3726e4830bbb?s=128&d=identicon&r=PG", "display_name": "user1939991", "link": "https://stackoverflow.com/users/1939991/user1939991"}, "edited": false, "score": 0, "creation_date": 1499295769, "post_id": 44936891, "comment_id": 76850976, "body": "Haha, that was leftover from my other function which used wchar and had a spacing of 0x2."}], "answers": [{"tags": [], "owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "is_accepted": true, "score": 4, "last_activity_date": 1499294260, "creation_date": 1499294260, "answer_id": 44937085, "question_id": 44936891, "link": "https://stackoverflow.com/questions/44936891/memory-leak-char/44937085#44937085", "title": "Memory Leak (char[])", "body": "<p>Assuming that <code>string</code> here is <code>std::string</code>:</p>\n\n<p>You call <code>string(buffer)</code> which assumes that <code>buffer</code> is 0-terminated and allocates a new string. But your code doesn't ensure that <code>buffer</code> is actually 0-terminated, so this can cause undefined behavior, including potentially crashing or allocating too much memory for the string.</p>\n\n<p>You probably want to use the <code>string(buffer, size)</code> constructor instead, which doesn't require <code>buffer</code> to be 0-terminated.</p>\n\n<p>I'd also recommend avoiding the manual <code>new</code>/<code>delete</code>. One way to do this is to create an empty string and <code>push_back</code> the characters you read to it. This avoid the need for <code>buffer</code>.</p>\n"}], "owner": {"reputation": 187, "user_id": 1939991, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/10c51aa23c9b3f4c988a3726e4830bbb?s=128&d=identicon&r=PG", "display_name": "user1939991", "link": "https://stackoverflow.com/users/1939991/user1939991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "accepted_answer_id": 44937085, "answer_count": 1, "score": 0, "last_activity_date": 1499294260, "creation_date": 1499293207, "question_id": 44936891, "link": "https://stackoverflow.com/questions/44936891/memory-leak-char", "title": "Memory Leak (char[])", "body": "<p>When I run my program, it can run for a while, then all of the sudden, it experiences a huge memory leak. I traced it out using a snapshot of the heap when it crashed, and I have a mysterious char[] with the size of 232,023,801 Bytes. The minutes preceding crash have no unusual behavior until then. The only places where I use char arrays is in the following piece of code:</p>\n\n<pre><code>string ReadString(DWORD64 addr) {\n\n    char* buffer = new char[128];\n\n    bool validChar = true;\n    for (int c = 0; c &lt; 128 &amp;&amp; validChar; c++) {\n        buffer[c] = Mem.Read&lt;char&gt;(addr+ (0x1 * c), sizeof(char));\n        if (!isalnum(buffer[c]) &amp;&amp; !ispunct(buffer[c]))\n            validChar = false;\n    }\n    string ret= string(buffer);\n    delete[] buffer;\n    return ret;\n}\n</code></pre>\n\n<p>All this code should be doing is reading a few characters from memory, saving the char array to a string, cleaning up the array, and returning the string. How is the memory leak originating from here? Or does the char[] in the heap snapshot potentially point to another issue? </p>\n"}, {"tags": ["c++", "class", "interface", "friend"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1499293354, "post_id": 44936844, "comment_id": 76850133, "body": "Hint: does it work if you make it <code>public</code>?"}, {"owner": {"reputation": 119, "user_id": 6723229, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f1822fb5885f632c7f064cb369cc870f?s=128&d=identicon&r=PG&f=1", "display_name": "kwadhwa", "link": "https://stackoverflow.com/users/6723229/kwadhwa"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1499293461, "post_id": 44936844, "comment_id": 76850163, "body": "@juanchopanza It will work but I want to keep it private and follow the pricinples."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1499293587, "post_id": 44936844, "comment_id": 76850213, "body": "Did you try it?"}, {"owner": {"reputation": 119, "user_id": 6723229, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f1822fb5885f632c7f064cb369cc870f?s=128&d=identicon&r=PG&f=1", "display_name": "kwadhwa", "link": "https://stackoverflow.com/users/6723229/kwadhwa"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1499293718, "post_id": 44936844, "comment_id": 76850281, "body": "@juanchopanza tried it now. Doesn&#39;t work"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1499293784, "post_id": 44936844, "comment_id": 76850312, "body": "Right. So it has nothing to do with <code>private</code> or <code>friend</code>. Now try making a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 127, "user_id": 2016601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adadcd930b2ad4bf451eba420f9a8f3?s=128&d=identicon&r=PG", "display_name": "Marco Amagliani", "link": "https://stackoverflow.com/users/2016601/marco-amagliani"}, "edited": false, "score": 1, "creation_date": 1499294501, "post_id": 44936844, "comment_id": 76850582, "body": "Yes, you need getter functions in the interface and implement it in A. The function must be virtual."}, {"owner": {"reputation": 1515, "user_id": 6615552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/952cbb61ab387e04b000590e294c9fe8?s=128&d=identicon&r=PG&f=1", "display_name": "21koizyd", "link": "https://stackoverflow.com/users/6615552/21koizyd"}, "edited": false, "score": 0, "creation_date": 1499294983, "post_id": 44936844, "comment_id": 76850735, "body": "@kwadhwa look to my answer ;)"}], "answers": [{"comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1499295921, "post_id": 44936932, "comment_id": 76851024, "body": "Why is using <code>friend</code> not correct here? By using <code>friend</code> the OP retains encapsulation while only exposing it&#39;s internals to a very select few. By adding an <i>accessor</i> member function now exposes it to the entire world."}, {"owner": {"reputation": 1515, "user_id": 6615552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/952cbb61ab387e04b000590e294c9fe8?s=128&d=identicon&r=PG&f=1", "display_name": "21koizyd", "link": "https://stackoverflow.com/users/6615552/21koizyd"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1499296921, "post_id": 44936932, "comment_id": 76851301, "body": "@CaptainObvlious okey, you&#39;ve right, always each developer say &quot;You never use `friend&quot;, but I never think about that like special access point"}], "tags": [], "owner": {"reputation": 1515, "user_id": 6615552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/952cbb61ab387e04b000590e294c9fe8?s=128&d=identicon&r=PG&f=1", "display_name": "21koizyd", "link": "https://stackoverflow.com/users/6615552/21koizyd"}, "is_accepted": true, "score": 1, "last_activity_date": 1499296851, "last_edit_date": 1499296851, "creation_date": 1499293429, "answer_id": 44936932, "question_id": 44936844, "link": "https://stackoverflow.com/questions/44936844/access-private-members-of-a-class-instantiated-using-interface/44936932#44936932", "title": "Access private members of a class instantiated using interface", "body": "<p>Now work</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n\nclass AInterface\n{\npublic:\n    virtual ~AInterface() = default;\n    int getMem() { return mem; }\n    virtual void set(int a) = 0;\nprotected:\n    int mem = 0;\n};\n\nclass A : public AInterface\n{\npublic:\n    ~A() override {}\n    void set(int a) override\n    {\n        mem = a;\n    }\n\n\n};\n\nclass B\n{\npublic:\n    B()\n    {\n         a = new A{};\n        a-&gt;set(3);\n    }\n\n    int get_a()\n    {\n        // Access mem since it's a friend class\n        return a-&gt;getMem();\n    }\n\nprivate:\n    AInterface *a;\n};\nint main()\n{\n    B *b = new B();\n    std::cout &lt;&lt; b-&gt;get_a() &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<ol>\n<li>Method which is override by child and is pure, should be virtual.</li>\n<li>If each class (child) <code>Interface</code>, variable <code>int mem</code> should be protected in interface.\nNow works fine, like you want.</li>\n<li>Add getter <code>getMem()</code></li>\n</ol>\n\n<p>Version with <code>friend</code></p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n\nclass AInterface\n{\npublic:\n    virtual ~AInterface() = default;\n    virtual void set(int a) = 0;\nprotected:\n    friend class B;\n    int mem = 0;\n};\n\nclass A : public AInterface\n{\npublic:\n    ~A() override {}\n    void set(int a) override\n    {\n        mem = a;\n    }\n\n\n};\n\nclass B\n{\npublic:\n    B()\n    {\n         a = new A{};\n        a-&gt;set(3);\n    }\n\n    int get_a()\n    {\n        // Access mem since it's a friend class\n        return a-&gt;mem;\n    }\n\nprivate:\n    AInterface *a;\n};\nint main()\n{\n    B *b = new B();\n    std::cout &lt;&lt; b-&gt;get_a() &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": false, "score": 0, "last_activity_date": 1499299149, "last_edit_date": 1499299149, "creation_date": 1499298350, "answer_id": 44937654, "question_id": 44936844, "link": "https://stackoverflow.com/questions/44936844/access-private-members-of-a-class-instantiated-using-interface/44937654#44937654", "title": "Access private members of a class instantiated using interface", "body": "<p>In your class B.</p>\n\n<pre><code>class B\n{\n  //...\n   int get_a()\n   {\n      return a-&gt;mem;   // but a is a AInterface*  !!!\n   }\n\nprivate:\n    AInterface *a;     // That's not an A*, but an AInterface*\n};\n</code></pre>\n\n<p>You have 2 options. </p>\n\n<ol>\n<li><p>use <code>dynamic_cast&lt;&gt;</code></p>\n\n<pre><code> int B::get_a()\n {\n     A* p = dynamic_cast&lt;A*&gt;(a);\n     if (p)\n       return p-&gt;mem;  \n     // a is not an A*, it's another AInterface*-type object !!!  \n                                   // What should you do?\n     throw something_or_other();   // throw?\n     return -1;                    // return an error code?\n   }\n   // or maybe add..  so you can check for errors before calling get_a()\n   A* B::get_A_ptr() const \n   { \n      return dynamic_cast&lt;A*&gt;(a); \n   }\n</code></pre></li>\n</ol>\n\n<p>dynamic_cast works fine, but can slow down your app if you need to make frequent reads of <code>a-&gt;mem</code>.</p>\n\n<ol start=\"2\">\n<li><p>Store <code>a</code> in an <code>A*</code>, which is probably what you meant to do from the start...</p>\n\n<pre><code>class B\n{\n  // ...\nprivate:\n  A* a;    // now a-&gt;A::mem is visible.\n};\n</code></pre></li>\n</ol>\n\n<p>Since you explicitly call <code>new A</code> in B's constructor, I think option 2 is better for your case.  </p>\n"}], "owner": {"reputation": 119, "user_id": 6723229, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f1822fb5885f632c7f064cb369cc870f?s=128&d=identicon&r=PG&f=1", "display_name": "kwadhwa", "link": "https://stackoverflow.com/users/6723229/kwadhwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 1, "accepted_answer_id": 44936932, "answer_count": 2, "score": 0, "last_activity_date": 1499299149, "creation_date": 1499292885, "last_edit_date": 1499293489, "question_id": 44936844, "link": "https://stackoverflow.com/questions/44936844/access-private-members-of-a-class-instantiated-using-interface", "title": "Access private members of a class instantiated using interface", "body": "<p>I have a class derived from an interface and a friend class of the derived class. I want to access the members of derived class which is instantiated as interface. It looks like this:</p>\n\n<p>Interface:</p>\n\n<pre><code>class AInterface\n{\npublic:\n   virtual ~AInterface() = default;\n   virtual void set(int a) = 0;\n};\n</code></pre>\n\n<p>Derived class A with friend class B:</p>\n\n<pre><code>class B;\nclass A : public AInterface\n{\npublic:\n   ~A() override {}\n   void set(int a) override\n   {\n      mem = a;\n   }\nprivate:\n   friend class B;\n\n   int mem = 0;\n};\n</code></pre>\n\n<p>class B:</p>\n\n<pre><code>class B\n{\npublic:\n   B() \n   {\n     a = new A();\n     a-&gt;set(3);\n   }\n\n   int get_a()\n   {\n      // Access mem since it's a friend class\n      return a-&gt;mem;\n   }\n\nprivate:\n    AInterface *a;\n}\n</code></pre>\n\n<p>main:</p>\n\n<pre><code>int main()\n{\n    B *b = new B();\n    std::cout &lt;&lt; b-&gt;get_a() &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>The program does not compile saying AInterface has no member named 'mem'.\nDo I need getter functions in the interface and implement it in A to achieve this or is there any other way to do it?</p>\n"}, {"tags": ["c++", "opencv", "descriptor", "image-stitching", "keypoint"], "answers": [{"tags": [], "owner": {"reputation": 702, "user_id": 5956151, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/36cbd9873a8a5ca327f20f95974e5f75?s=128&d=identicon&r=PG&f=1", "display_name": "C.Radford", "link": "https://stackoverflow.com/users/5956151/c-radford"}, "is_accepted": true, "score": 1, "last_activity_date": 1499292500, "creation_date": 1499292500, "answer_id": 44936770, "question_id": 44936653, "link": "https://stackoverflow.com/questions/44936653/opencv-c-create-reusable-set-of-keypoints-and-descriptors-for-stitching-multip/44936770#44936770", "title": "OpenCV C++ create reusable set of keypoints and descriptors for stitching multiple images", "body": "<p>After combing through the I just happened to find I was using the wrong variable at one point!:)</p>\n"}], "owner": {"reputation": 702, "user_id": 5956151, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/36cbd9873a8a5ca327f20f95974e5f75?s=128&d=identicon&r=PG&f=1", "display_name": "C.Radford", "link": "https://stackoverflow.com/users/5956151/c-radford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "accepted_answer_id": 44936770, "answer_count": 1, "score": 0, "last_activity_date": 1499292500, "creation_date": 1499291929, "question_id": 44936653, "link": "https://stackoverflow.com/questions/44936653/opencv-c-create-reusable-set-of-keypoints-and-descriptors-for-stitching-multip", "title": "OpenCV C++ create reusable set of keypoints and descriptors for stitching multiple images", "body": "<p>I have created a program that can stitch multiple images together and am now looking to improve the efficiency of it. Depending on the size of the stitched image, eventually it is to large and contains too many keypoints that the machine runs out of allocatable memory. To compensate for this my goal is to store all the keypoints and descriptors as they are found so that I don't need to find them again in the master stitched image and only need to find them in the new image being stitched. I had this process working in python but haven't had the same luck in C++. \nIn order to do this I need to perform a <code>perspectiveTransform()</code> on the keypoints and therefor convert them from <code>vector&lt;keypoint&gt;</code> to <code>vector&lt;point2f&gt;</code> and back to <code>vector&lt;keypoint&gt;</code>. I have been able to achieve this and can confirm it works (pick to follow). <strong>I am not sure if the same process needs to be done to the descriptors</strong> (currently I have don it but either its wrong or not effective).</p>\n\n<p>Issue: When I run this the keypoints and descriptors don't appear to work and I throw an error I created being: \"Not enough matches found\" even though I know at least the keypoints are making its way to the function.</p>\n\n<p>Here is the code for the keypoint and descriptor transforms. The code first calculates the warpPerspective to be applied to image one as homography will warp the second image only. The rest of the codd deals with keypoints and descriptors.  </p>\n\n<pre><code>tuple&lt;Mat, vector&lt;KeyPoint&gt;, Mat&gt;  stitchMatches(Mat image1,Mat image2, Mat homography, vector&lt;KeyPoint&gt; kp1, vector&lt;KeyPoint&gt; kp2 , Mat desc1, Mat desc2){\n    Mat result, destination, descriptors_updated;\n    vector&lt;Point2f&gt; fourPoint;\n    vector&lt;KeyPoint&gt; keypoints_updated;\n\n    //-Get the four corners of the first image (master)\n    fourPoint.push_back(Point2f (0,0));\n    fourPoint.push_back(Point2f (image1.size().width,0));\n    fourPoint.push_back(Point2f (0, image1.size().height));\n    fourPoint.push_back(Point2f (image1.size().width, image1.size().height));\n    //perspectiveTransform(Mat(fourPoint), destination, homography);\n\n\n    //- Get points used to determine Htr\n    double min_x, min_y, tam_x, tam_y;\n    float min_x1, min_x2, min_y1, min_y2, max_x1, max_x2, max_y1, max_y2;\n    min_x1 = min(fourPoint.at(0).x, fourPoint.at(1).x);\n    min_x2 = min(fourPoint.at(2).x, fourPoint.at(3).x);\n    min_y1 = min(fourPoint.at(0).y, fourPoint.at(1).y);\n    min_y2 = min(fourPoint.at(2).y, fourPoint.at(3).y);\n    max_x1 = max(fourPoint.at(0).x, fourPoint.at(1).x);\n    max_x2 = max(fourPoint.at(2).x, fourPoint.at(3).x);\n    max_y1 = max(fourPoint.at(0).y, fourPoint.at(1).y);\n    max_y2 = max(fourPoint.at(2).y, fourPoint.at(3).y);\n    min_x = min(min_x1, min_x2);\n    min_y = min(min_y1, min_y2);\n    tam_x = max(max_x1, max_x2);\n    tam_y = max(max_y1, max_y2);\n\n    //- Htr use to map image one to result in line with the alredy warped image 1\n    Mat Htr = Mat::eye(3,3,CV_64F);\n    if (min_x &lt; 0){\n        tam_x = image2.size().width - min_x;\n        Htr.at&lt;double&gt;(0,2)= -min_x;\n    }\n    if (min_y &lt; 0){\n        tam_y = image2.size().height - min_y;\n        Htr.at&lt;double&gt;(1,2)= -min_y;\n    }\n\n    result = Mat(Size(tam_x*2,tam_y*2), CV_8UC3,cv::Scalar(0,0,0));\n    warpPerspective(image2, result, Htr, result.size(), INTER_LINEAR, BORDER_TRANSPARENT,   0);\n    warpPerspective(image1, result, (Htr*homography), result.size(), INTER_LINEAR, BORDER_TRANSPARENT,0);\n\n\n\n    //-- Variables to hold the keypoints at the respective stages\n    vector&lt;Point2f&gt; kp1Local,kp2Local;\n    vector&lt;KeyPoint&gt; kp1updated, kp2updated;\n\n\n    //Localize the keypoints to allow for perspective change\n    KeyPoint::convert(kp1, kp1Local);\n    KeyPoint::convert(kp2, kp2Local);\n\n    //perform persepctive transform on the keypoints of type vector&lt;point2f&gt;\n    perspectiveTransform(kp1Local, kp1Local, (Htr));\n    perspectiveTransform(kp2Local, kp2Local, (Htr*homography));\n\n\n    //convert keypoints back to type vector&lt;keypoint&gt;\n    for( size_t i = 0; i &lt; kp1Local.size(); i++ ) {\n        kp1updated.push_back(KeyPoint(kp1Local[i], 1.f));\n    }\n    for( size_t i = 0; i &lt; kp2Local.size(); i++ ) {\n        kp2updated.push_back(KeyPoint(kp2Local[i], 1.f));\n    }\n\n    //Add to master of list of keypoints to be passed along during next iteration of image\n    keypoints_updated.reserve(kp1updated.size() + kp2updated.size());\n    keypoints_updated.insert(keypoints_updated.end(),kp1updated.begin(),kp1updated.end());\n    keypoints_updated.insert(keypoints_updated.end(),kp2updated.begin(),kp2updated.end());\n\n    //WarpPerspective of decriptors to match that of the images and cooresponding keypoints\n    Mat desc1New, desc2New;\n    warpPerspective(desc2, desc2New, Htr, result.size(), INTER_LINEAR, BORDER_TRANSPARENT,   0);\n    warpPerspective(desc1, desc1New, (Htr*homography), result.size(), INTER_LINEAR, BORDER_TRANSPARENT,0);\n\n    //create a new Mat including the descriports from desc1 and desc2\n    descriptors_updated.push_back(desc1New);\n    descriptors_updated.push_back(desc2New);\n\n\n    //------------TEST TO see if keypoints have moved\n\n    Mat img_keypoints;\n    drawKeypoints( result, keypoints_updated, img_keypoints, Scalar::all(-1), DrawMatchesFlags::DEFAULT );\n\n    imshow(\"Keypoints 1\", img_keypoints );\n    waitKey();\n    destroyAllWindows();\n\n\n\n    return {result, keypoints_updated, descriptors_updated};\n}\n</code></pre>\n\n<p>The following code is my master stitching program that does the actual stitching. </p>\n\n<pre><code>tuple&lt;Mat,vector&lt;KeyPoint&gt;,Mat&gt; stitch(Mat img1,Mat img2 ,vector&lt;KeyPoint&gt; keypoints, Mat descriptors, String featureDetection,String featureExtractor,String keypointsMatcher,String showMatches){\n\n    Mat desc, desc1, desc2, homography, result, croppedResult,descriptors_updated;\n    std::vector&lt;KeyPoint&gt; keypoints_updated, kp1, kp2;\n    std::vector&lt;DMatch&gt; matches;\n    //-Base Case[2]\n    if (keypoints.empty()){\n\n        //-Detect Keypoints and their descriptors\n        tie(kp1,desc1) = KeyPointDescriptor(img1, featureDetection,featureExtractor);\n        tie(kp2,desc2) = KeyPointDescriptor(img2, featureDetection,featureExtractor);\n\n        //Find matches and calculated homography based on keypoints and descriptors\n        std::tie(matches,homography) = matchFeatures(kp1,  desc1,kp2, desc2, keypointsMatcher);\n        //draw matches if requested\n        if(showMatches == \"true\"){\n            drawMatchedImages( img1, kp1, img2, kp2, matches);\n        }\n        //stitch the images and update the keypoint and descriptors\n        std::tie(result,keypoints_updated,descriptors_updated) = stitchMatches(img1, img2, homography,kp1,kp2,desc1,desc2);\n        //crop function using created cropping function\n        croppedResult = crop(result);\n        return {croppedResult,keypoints_updated,descriptors_updated};\n\n    }\n\n    //base case[3:n]\n    else{\n\n        //Get keypoints and descriptors of new image and add to respective lists\n        tie(kp2,desc2) = KeyPointDescriptor(img2, featureDetection,featureExtractor);\n\n        //find matches and determine homography\n        std::tie(matches,homography) = matchFeatures(keypoints_updated,descriptors_updated,kp2,desc2, keypointsMatcher);\n        //draw matches if requested\n        if(showMatches == \"true\")\n            drawMatchedImages( img1, keypoints, img2, kp2, matches);\n\n        //stitch the images and update the keypoint and descriptors\n        tie(result,keypoints_updated,descriptors_updated) = stitchMatches(img1, img2, homography,keypoints,kp2,descriptors,desc2);\n        //crop function using created cropping function\n        croppedResult = crop(result);\n        return {croppedResult,keypoints_updated,descriptors_updated};\n        }\n}\n</code></pre>\n\n<p>Lastly here is the image of the keypoints that are being transformed onto the stitched image. Any help is so greatly appreciated!</p>\n\n<p><a href=\"https://i.stack.imgur.com/JfSUK.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JfSUK.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1499291719, "post_id": 44936423, "comment_id": 76849478, "body": "I can&#39;t reproduce your problem with the code you posted. However this answer may be useful to you: <a href=\"https://stackoverflow.com/a/44872822/3807729\">stackoverflow.com/a/44872822/3807729</a> It uses <code>thread_local static</code> to make the random generator persistent and thread-safe."}, {"owner": {"reputation": 17, "user_id": 8120951, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207249106666001/picture?type=large", "display_name": "Harry Budd", "link": "https://stackoverflow.com/users/8120951/harry-budd"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1499292209, "post_id": 44936423, "comment_id": 76849702, "body": "@Galik This helped tremendously, thank you!"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1499292721, "post_id": 44936423, "comment_id": 76849894, "body": "I am developing an <i>in need of testing</i> header-only library for this which you may or may not find useful. The relevant headers are <code>hol&#47;random_numbers.h</code> and <code>hol&#47;random_distros.h</code>. The relevant function would be <code>random_normal()</code>. The repository is here: <a href=\"https://github.com/galik/header-only\" rel=\"nofollow noreferrer\">github.com/galik/header-only</a>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8120951, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207249106666001/picture?type=large", "display_name": "Harry Budd", "link": "https://stackoverflow.com/users/8120951/harry-budd"}, "edited": false, "score": 0, "creation_date": 1499292293, "post_id": 44936480, "comment_id": 76849732, "body": "This worked, but I decided to go with @Galik &#39;s solution to avoid the use of global variables. Thank you for the help, though!"}], "tags": [], "owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "is_accepted": false, "score": 2, "last_activity_date": 1499291549, "last_edit_date": 1499291549, "creation_date": 1499291059, "answer_id": 44936480, "question_id": 44936423, "link": "https://stackoverflow.com/questions/44936423/c-function-to-create-gaussian-random-numbers/44936480#44936480", "title": "c++ Function to create gaussian random numbers", "body": "<p>The problem is that you need to recycle the <code>random_device</code>.</p>\n\n<p>If you really want to keep the exact same function signature, the easiest way would be to use a global variable:</p>\n\n<pre><code>random_device rd;\nmt19937 gen(rd());\n\ndouble r_norm(double mean, double sigma){\n    normal_distribution&lt;double&gt; d(mean, sigma);\n    return d(gen);\n}\n</code></pre>\n\n<p>That being said: stl random distributions are statefull, so you need to also recycle <code>d</code> if you want an actual valid distribution. </p>\n\n<p>At this point, maintaining your interface would require a <code>static std::map&lt;pair&lt;double, double&gt;, normal_distribution&gt;</code> so that you recycle them properly as well.</p>\n"}], "owner": {"reputation": 17, "user_id": 8120951, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207249106666001/picture?type=large", "display_name": "Harry Budd", "link": "https://stackoverflow.com/users/8120951/harry-budd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1025, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1499291549, "creation_date": 1499290784, "last_edit_date": 1499290927, "question_id": 44936423, "link": "https://stackoverflow.com/questions/44936423/c-function-to-create-gaussian-random-numbers", "title": "c++ Function to create gaussian random numbers", "body": "<p>I'm using the following function to generate gaussian random numbers:</p>\n\n<pre><code>double r_norm(double mean, double sigma){\n    random_device rd;\n    mt19937 gen(rd());\n    normal_distribution&lt;double&gt; d(mean, sigma);\n    return d(gen);\n}\n</code></pre>\n\n<p>However, when I call this in main() with cout:</p>\n\n<pre><code>for (int k = 0; k &lt; 10; k++){ \n    cout &lt;&lt; r_norm(2,0.5) &lt;&lt;endl;\n}\n</code></pre>\n\n<p>It outputs the same number 10 times. Ideally I need to be able to call this function wherever, in order to receive a newly generated number each time.</p>\n\n<p>Update: I managed to fix this by declaring the random device and mersenne twister outside of scope as global variables, but is there a neater way to do this?</p>\n"}, {"tags": ["c++", "windows", "winapi", "dialog"], "comments": [{"owner": {"reputation": 814, "user_id": 6263041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ir86i.png?s=128&g=1", "display_name": "The Techel", "link": "https://stackoverflow.com/users/6263041/the-techel"}, "edited": false, "score": 0, "creation_date": 1499289549, "post_id": 44936078, "comment_id": 76848519, "body": "you might want to have a look at proper GUI-Libraries for C++."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7715430"}, "reply_to_user": {"reputation": 814, "user_id": 6263041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ir86i.png?s=128&g=1", "display_name": "The Techel", "link": "https://stackoverflow.com/users/6263041/the-techel"}, "edited": false, "score": 0, "creation_date": 1499289782, "post_id": 44936078, "comment_id": 76848641, "body": "Well yes I could just simply use Qt or another environment to create such a GUI but I think there has to be a solution for a dialogbox using resource header files?!"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7715430"}, "edited": false, "score": 0, "creation_date": 1499368957, "post_id": 44936238, "comment_id": 76890009, "body": "If it is, Iam sorry. But I didn&#39;t know that there is something like a manifest file. If I would have had a clue I would have googled it"}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": true, "score": 6, "last_activity_date": 1551539745, "last_edit_date": 1551539745, "creation_date": 1499289812, "answer_id": 44936238, "question_id": 44936078, "link": "https://stackoverflow.com/questions/44936078/how-do-i-implement-windows-style-for-a-dialog-box-in-c/44936238#44936238", "title": "How do I implement Windows style for a dialog box in C++?", "body": "<p>You need to opt in to comctl32 v6 in your manifest: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb773175%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Enabling Visual Styles</a>.</p>\n\n<blockquote>\n  <p>To enable your application to use visual styles, you must use\n  ComCtl32.dll version 6 or later. Because version 6 is not\n  redistributable, it is available only when your application is running\n  on a version of Windows that contains it. Windows ships with both\n  version 5 and version 6. ComCtl32.dll version 6 contains both the user\n  controls and the common controls. By default, applications use the\n  user controls defined in User32.dll and the common controls defined in\n  ComCtl32.dll version 5. For a list of DLL versions and their\n  distribution platforms, see Common Control Versions.</p>\n  \n  <p>If you want your application to use visual styles, you must add an\n  application manifest or compiler directive that indicates that\n  ComCtl32.dll version 6 should be used if it is available.</p>\n  \n  <p>An application manifest enables an application to specify which\n  versions of an assembly it requires. In Microsoft Win32, an assembly\n  is a set of DLLs and a list of versionable objects that are contained\n  within those DLLs.</p>\n</blockquote>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7715430"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 1, "accepted_answer_id": 44936238, "answer_count": 1, "score": 1, "last_activity_date": 1551539745, "creation_date": 1499289184, "last_edit_date": 1499291493, "question_id": 44936078, "link": "https://stackoverflow.com/questions/44936078/how-do-i-implement-windows-style-for-a-dialog-box-in-c", "title": "How do I implement Windows style for a dialog box in C++?", "body": "<p>I have searched for an answer on the Internet, but with exceptions of the difference between modal and modaless dialog boxes, I couldn't find anything useful for my question.</p>\n\n<p>As written in the title, my question is - how can I implement/use a Windows version specific design for my dialog box?  IOW, use the Windows 10 button style on a Windows 10 system.</p>\n\n<p>I am using Visual Studio, and I have created a simple resource for my dialog using the integrated resource editor.</p>\n\n<p>Here is my programm:</p>\n\n<pre><code>int CALLBACK WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)\n{\n    DialogBox(hInstance, MAKEINTRESOURCE(IDD_DIALOG1), NULL, NULL);\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>Right now, when I compile this code, the console and the dialog box appear on the screen, but the dialog box controls (buttons) seem to be shown in the Windows 2000 style. I'm using Windows 10.</p>\n\n<p>I have this style:</p>\n\n<p><img src=\"https://i.stack.imgur.com/xOnuX.png\" alt=\"current style\"></p>\n\n<p>I want this style:</p>\n\n<p><img src=\"https://i.stack.imgur.com/znZyr.png\" alt=\"wanted style\"></p>\n"}, {"tags": ["c++", "syntax"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 1, "creation_date": 1499289278, "post_id": 44936070, "comment_id": 76848402, "body": "Yes, function pointer."}, {"owner": {"reputation": 508, "user_id": 7625039, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d30dc8e67ea57081b388fda0589ddafd?s=128&d=identicon&r=PG&f=1", "display_name": "gfdsal", "link": "https://stackoverflow.com/users/7625039/gfdsal"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499289371, "post_id": 44936070, "comment_id": 76848440, "body": "Thanks but how can we find out which function it points to as I checked the whole repository for the function <a href=\"https://github.com/Airtau/genivi/blame/master/layer_management/\" rel=\"nofollow noreferrer\">github.com/Airtau/genivi/blame/master/layer_management</a>"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 1, "creation_date": 1499289716, "post_id": 44936070, "comment_id": 76848603, "body": "ilm_control_platform.h does not seem to be part of that repository. Is it a generated file?"}, {"owner": {"reputation": 508, "user_id": 7625039, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d30dc8e67ea57081b388fda0589ddafd?s=128&d=identicon&r=PG&f=1", "display_name": "gfdsal", "link": "https://stackoverflow.com/users/7625039/gfdsal"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499289885, "post_id": 44936070, "comment_id": 76848692, "body": "<a href=\"https://github.com/GENIVI/wayland-ivi-extension/blob/master/ivi-layermanagement-api/ilmControl/include/ilm_control_platform.h\" rel=\"nofollow noreferrer\">github.com/GENIVI/wayland-ivi-extension/blob/master/&hellip;</a>"}, {"owner": {"reputation": 508, "user_id": 7625039, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d30dc8e67ea57081b388fda0589ddafd?s=128&d=identicon&r=PG&f=1", "display_name": "gfdsal", "link": "https://stackoverflow.com/users/7625039/gfdsal"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499289913, "post_id": 44936070, "comment_id": 76848703, "body": "This is the main repository . It has both"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 1, "creation_date": 1499290100, "post_id": 44936070, "comment_id": 76848795, "body": "it looks to me like the assignment should be happening in <code>init_ilmControlPlatformTable()</code>, which is not in that repository either (hence why you can&#39;t find it)."}, {"owner": {"reputation": 508, "user_id": 7625039, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d30dc8e67ea57081b388fda0589ddafd?s=128&d=identicon&r=PG&f=1", "display_name": "gfdsal", "link": "https://stackoverflow.com/users/7625039/gfdsal"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499290333, "post_id": 44936070, "comment_id": 76848899, "body": "How did you figure that out? because it begins with <code>init</code> and has <code>Table()</code> Thats pretty smart actually!"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 1, "creation_date": 1499290431, "post_id": 44936070, "comment_id": 76848954, "body": "Yeah, your function pointer is member of a struct (which looks like a vtable) instantiated once as a global variable: <code>gIlmControlPlatformFunc</code>, so it would make sense that <code>init_ilmControlPlatformTable()</code>, decalred on the very next line is meant to initialize that global variable."}, {"owner": {"reputation": 508, "user_id": 7625039, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d30dc8e67ea57081b388fda0589ddafd?s=128&d=identicon&r=PG&f=1", "display_name": "gfdsal", "link": "https://stackoverflow.com/users/7625039/gfdsal"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499290694, "post_id": 44936070, "comment_id": 76849053, "body": "That actually makes lots of sense. I did try searching for <code>init_ilmControlPlatformTable()</code> to further understand but it appears its not there in the web."}], "answers": [{"comments": [{"owner": {"reputation": 508, "user_id": 7625039, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d30dc8e67ea57081b388fda0589ddafd?s=128&d=identicon&r=PG&f=1", "display_name": "gfdsal", "link": "https://stackoverflow.com/users/7625039/gfdsal"}, "edited": false, "score": 0, "creation_date": 1499289759, "post_id": 44936158, "comment_id": 76848628, "body": "I see but why is it that in other code the function pointer <code>layerSetOpacity</code> is declared as a function <code>ilm_layerSetOpacity</code>? Are the two same?"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 1, "creation_date": 1499289914, "post_id": 44936158, "comment_id": 76848704, "body": "A function pointer is just a variable that can refer to a function with a matching signature. It plays no role in declaring/defining functions."}, {"owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "edited": false, "score": 1, "creation_date": 1499289982, "post_id": 44936158, "comment_id": 76848738, "body": "There is no relation between <code>ilm_layerSetOpacity</code> and <code>layerSetOpacity</code>"}], "tags": [], "owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "is_accepted": true, "score": 1, "last_activity_date": 1499290180, "last_edit_date": 1499290180, "creation_date": 1499289490, "answer_id": 44936158, "question_id": 44936070, "link": "https://stackoverflow.com/questions/44936070/same-code-different-syntaxilm-client-h-vs-ilm-control-platform-h/44936158#44936158", "title": "Same code different syntax(ilm_client.h vs ilm_control_platform.h)", "body": "<p>Let's dissect: - <code>ilmErrorTypes (*layerSetOpacity)(t_ilm_layer layerId, t_ilm_float opacity)</code>:-     </p>\n\n<ol>\n<li><code>layerSetOpacity</code> is a pointer to a function that takes 2 params as input  </li>\n<li>The inparams to the function  are of type <code>t_ilm_layer</code> and <code>t_ilm_float</code>  </li>\n<li>The function returns a adata type <code>ilmErrorTypes</code></li>\n</ol>\n\n<p>The fact that you can't find anything in your code base that matches the symbol <code>layerSetOpacity</code> means the function pointer is <strong>declared</strong> in the header but never <strong>invoked</strong> using this function pointer but quite possibly invoked using <code>ilm_layerSetOpacity</code></p>\n\n<p>A simpler analogy would be:-</p>\n\n<pre><code>int a = 10;\nint *p1; //Uninitialized pointer\nint *p2 = &amp;a; //pointer pointing to a\n</code></pre>\n\n<p>In your case <code>a</code> is <code>ilm_layerSetOpacity</code> and <code>p1</code> is <code>layerSetOpacity</code> and <code>p2</code> does not exist<br>\nHTH!</p>\n"}], "owner": {"reputation": 508, "user_id": 7625039, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d30dc8e67ea57081b388fda0589ddafd?s=128&d=identicon&r=PG&f=1", "display_name": "gfdsal", "link": "https://stackoverflow.com/users/7625039/gfdsal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 44936158, "answer_count": 1, "score": 1, "last_activity_date": 1499290180, "creation_date": 1499289151, "question_id": 44936070, "link": "https://stackoverflow.com/questions/44936070/same-code-different-syntaxilm-client-h-vs-ilm-control-platform-h", "title": "Same code different syntax(ilm_client.h vs ilm_control_platform.h)", "body": "<p>I would like to know that in the following code is <code>(*layerSetOpacity)</code> is some sort of function pointer. I could not find the reference anywhere in the whole repository!</p>\n\n<p>The following code found in ilm_client.h is understandable as <code>ilm_layerSetOpacity</code> pertains to function </p>\n\n<pre><code>ilmErrorTypes ilm_layerSetOpacity(t_ilm_layer layerId, t_ilm_float opacity);\n</code></pre>\n\n<p>But this code found in ilm_control_platform.h is confusing as what does bracket with pointer represent - function pointer?</p>\n\n<pre><code> ilmErrorTypes (*layerSetOpacity)(t_ilm_layer layerId,\n               t_ilm_float opacity);\n</code></pre>\n\n<p>I am not asking for code specifics only the syntax. </p>\n"}, {"tags": ["c++", "opencv"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6941869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4fb45457fc6cb2cb8b6335bc7a6a22?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Scullion", "link": "https://stackoverflow.com/users/6941869/richard-scullion"}, "edited": false, "score": 0, "creation_date": 1499291472, "post_id": 44936458, "comment_id": 76849398, "body": "Thanks but that didn&#39;t make a difference. I think the reason that it takes an array of arrays is you can specify calibration points for multiple images. I only wish to provide the points for one though."}, {"owner": {"reputation": 1, "user_id": 6941869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4fb45457fc6cb2cb8b6335bc7a6a22?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Scullion", "link": "https://stackoverflow.com/users/6941869/richard-scullion"}, "edited": false, "score": 0, "creation_date": 1499362976, "post_id": 44936458, "comment_id": 76886792, "body": "There&#39;s no much more to it but I&#39;ll add it."}, {"owner": {"reputation": 1, "user_id": 6941869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4fb45457fc6cb2cb8b6335bc7a6a22?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Scullion", "link": "https://stackoverflow.com/users/6941869/richard-scullion"}, "edited": false, "score": 0, "creation_date": 1499363079, "post_id": 44936458, "comment_id": 76886847, "body": "I can&#39;t add it all, too long but here is the preceeding bit:"}, {"owner": {"reputation": 1, "user_id": 6941869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4fb45457fc6cb2cb8b6335bc7a6a22?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Scullion", "link": "https://stackoverflow.com/users/6941869/richard-scullion"}, "edited": false, "score": 0, "creation_date": 1499363092, "post_id": 44936458, "comment_id": 76886853, "body": "cv::Mat distorted = MatFromImage(img, MakeGrey);        cv::Mat undistorted = distorted.clone();         Mat Knew = Mat::eye(3, 3, CV_64F);      cv::Matx33d Ka;     cv::Vec4d Da;     std::vector&lt;cv::Vec3d&gt; rvec;     std::vector&lt;cv::Vec3d&gt; tvec;      int flag = 0;     flag |= cv::fisheye::CALIB_RECOMPUTE_EXTRINSIC;     flag |= cv::fisheye::CALIB_CHECK_COND;     flag |= cv::fisheye::CALIB_FIX_SKEW;"}, {"owner": {"reputation": 1, "user_id": 6941869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4fb45457fc6cb2cb8b6335bc7a6a22?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Scullion", "link": "https://stackoverflow.com/users/6941869/richard-scullion"}, "edited": false, "score": 0, "creation_date": 1499363190, "post_id": 44936458, "comment_id": 76886906, "body": "MatFromImage is my own routine. It creates a matrix of type: cv::Mat image(imSize, type, dataBuffer, stride);  @vacky"}], "tags": [], "owner": {"reputation": 237, "user_id": 5893603, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/901a9d49a7723bcf5d18c622749670c1?s=128&d=identicon&r=PG", "display_name": "vacky", "link": "https://stackoverflow.com/users/5893603/vacky"}, "is_accepted": false, "score": 0, "last_activity_date": 1499290935, "creation_date": 1499290935, "answer_id": 44936458, "question_id": 44936016, "link": "https://stackoverflow.com/questions/44936016/inputarrayofarrays-in-opencv/44936458#44936458", "title": "InputArrayOfArrays in OpenCV", "body": "<p>Im not sure if you are defining the vectors and adding points in a right way</p>\n\n<p>try doing it as follows</p>\n\n<pre><code>std::vector&lt;cv::Point2d&gt; imagePoints; //={ Point(144,103),  Point(206,75),  Point(109,151), Point(253,159) };\nimagePoints.push_back(Point2d(144,103));\nimagePoints.push_back(Point2d(206,75));\nimagePoints.push_back(Point2d(109,151));\nimagePoints.push_back(Point2d(253,159));\n//real world position is object Points\nstd::vector&lt;cv::Point3d&gt; objectPoints; //={ Point3d(4,3,0),  Point3d(7,2,0),  Point3d(2,5,0), Point3d(8,6,0)};\nobjectPoints.push_back(Point3d(4,3,0));\nobjectPoints.push_back(Point3d(7,2,0));\nobjectPoints.push_back(Point3d(2,5,0));\nobjectPoints.push_back(Point3d(8,6,0));\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6941869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4fb45457fc6cb2cb8b6335bc7a6a22?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Scullion", "link": "https://stackoverflow.com/users/6941869/richard-scullion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2598, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499290935, "creation_date": 1499288928, "question_id": 44936016, "link": "https://stackoverflow.com/questions/44936016/inputarrayofarrays-in-opencv", "title": "InputArrayOfArrays in OpenCV", "body": "<p>I'm trying to generate an InputArrayOfArrays to pass into OpenCV calibrate. I believe it should be a vector of vectors. However, when I call the calibrate function it bombs out with an exception that my input and output arrays aren't the same size. I've tried to perform the conversion outside of the calibrate call and the resulting InputArrayOfArrays (op and ip) appear to not be initialised (the reported total() size is random). If I interrogate the vectors directly, they are as expected.\nAny help is much appreciated!</p>\n\n<pre><code>{\n....\n//pixel position is imagePoints\nstd::vector&lt;std::vector&lt;cv::Point&gt; &gt; imagePoints(1); //={ Point(144,103),  Point(206,75),  Point(109,151), Point(253,159) };\nimagePoints[0].push_back(Point(144,103));\nimagePoints[0].push_back(Point(206,75));\nimagePoints[0].push_back(Point(109,151));\nimagePoints[0].push_back(Point(253,159));\n//real world position is object Points\nstd::vector&lt;std::vector&lt;cv::Point3d&gt; &gt; objectPoints(1); //={ Point3d(4,3,0),  Point3d(7,2,0),  Point3d(2,5,0), Point3d(8,6,0)};\nobjectPoints[0].push_back(Point3d(4,3,0));\nobjectPoints[0].push_back(Point3d(7,2,0));\nobjectPoints[0].push_back(Point3d(2,5,0));\nobjectPoints[0].push_back(Point3d(8,6,0));\n\nInputArrayOfArrays ip = InputArrayOfArrays(imagePoints);\nInputArrayOfArrays op = InputArrayOfArrays(objectPoints);\n\nprintf(\"ip (%d, %I64u) op (%d, %I64u)\\n\", ip.empty(), ip.total(), op.empty(), op.total());\n\nfisheye::calibrate(objectPoints, imagePoints, distorted.size(), Ka, Da, rvec, tvec, flag, cv::TermCriteria(3, 20, 1e-6));\n\n}\n</code></pre>\n\n<p>Ouptut is:<br>\nip (0, 18446744073709499195) op (0, 18446744073709499176)<br>\nOpenCV Error: Assertion failed (!objectPoints.empty() &amp;&amp; !imagePoints.empty() &amp;&amp; objectPoints.total() == imagePoints.total()) in cv::fisheye::calibrate, file C:\\Temp\\OpenCV_3.2_extra\\source\\opencv\\modules\\calib3d\\src\\fisheye.cpp, line 701</p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1499290779, "post_id": 44936222, "comment_id": 76849088, "body": "specialization and instantiation are different things."}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 2, "creation_date": 1499293327, "post_id": 44936222, "comment_id": 76850119, "body": "The second would risk leaking memory if the <code>new jteSound</code> succeeds, but then the vector&#39;s <code>emplace_back</code> needs to reallocate storage and fails (and it happens that the <code>bad_alloc</code> exception is caught instead of calling <code>terminate</code>)."}], "tags": [], "owner": {"reputation": 4082, "user_id": 7893951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5eWm1.jpg?s=128&g=1", "display_name": "Akira", "link": "https://stackoverflow.com/users/7893951/akira"}, "is_accepted": true, "score": 1, "last_activity_date": 1499322382, "last_edit_date": 1499322382, "creation_date": 1499289752, "answer_id": 44936222, "question_id": 44935985, "link": "https://stackoverflow.com/questions/44935985/cannot-push-back-a-struct-into-an-stdvectorstdshared-ptrthestruct-thev/44936222#44936222", "title": "Cannot push_back() a struct into an std::vector&lt;std::shared_ptr&lt;theStruct&gt;&gt; theVector", "body": "<p>The type of the elements inside your <code>std::vector</code> is <code>std::shared_ptr&lt;jteSound&gt;</code> which means that <code>std::vector::push_back</code> will accept only instances of that type.</p>\n\n<p>To make your code work you have two options. The first is using <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr/make_shared\" rel=\"nofollow noreferrer\"><code>std::make_shared</code></a> helper function as follows:</p>\n\n<pre><code>bnk.push_back(std::make_shared&lt;jteSound&gt;());\n\n// the equivalent counterpart is:\nbnk.push_back(std::shared_ptr&lt;jteSound&gt;(new jteSound));\n</code></pre>\n\n<p>The second is using <a href=\"http://en.cppreference.com/w/cpp/container/vector/emplace\" rel=\"nofollow noreferrer\"><code>std::vector::emplace</code></a> as follows:</p>\n\n<pre><code>bnk.emplace(bnk.end(), new jteSound);\n</code></pre>\n\n<hr>\n\n<p>As the comments below warn, <strong>using the second option is risky</strong> because it can cause memory leak when the <code>new jteSound</code> succeeds but the <code>std::vector::emplace</code> has to reallocate memory and fails.</p>\n"}], "owner": {"reputation": 159, "user_id": 2939576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15f6dfc48a77ae71198cb9361290492c?s=128&d=identicon&r=PG&f=1", "display_name": "JohnBobSmith", "link": "https://stackoverflow.com/users/2939576/johnbobsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "accepted_answer_id": 44936222, "answer_count": 1, "score": -1, "last_activity_date": 1499322382, "creation_date": 1499288780, "question_id": 44935985, "link": "https://stackoverflow.com/questions/44935985/cannot-push-back-a-struct-into-an-stdvectorstdshared-ptrthestruct-thev", "title": "Cannot push_back() a struct into an std::vector&lt;std::shared_ptr&lt;theStruct&gt;&gt; theVector", "body": "<p>Hopefully my title isn't too confusing. I'm trying to write a sound manager for my game using SFML. I'm trying to replace my new/delete with the \"smart pointer\" std::shared_ptr. This is what I have so far.</p>\n\n<pre><code>/* SoundManager.h */\n#ifndef SOUNDMANAGER_H\n#define SOUNDMANAGER_H\n\n#include &lt;SFML/Audio.hpp&gt;\n#include &lt;string&gt;\n#include &lt;memory&gt;\n\nclass SoundManager\n{\n    public:\n        ~SoundManager();\n\n        struct jteSound\n        {\n            sf::Sound snd;\n            sf::SoundBuffer sndBuffer;\n            std::string name;\n        };\n\n        //Load a new sound from path and store it in audio bank bnk.\n        //Banks are simply std::vectors of type jteSound.\n        void registerNewSound(std::vector&lt;std::shared_ptr&lt;jteSound&gt;&gt; &amp;bnk, std::string path, std::string sndName);\n\n        //Footsteps bank\n        std::vector&lt;std::shared_ptr&lt;jteSound&gt;&gt; bnkFootsteps;\n};\n\n#endif // SOUNDMANAGER_H\n\n/* SoundManager.cpp */\n#include \"SoundManager.h\"\n#include &lt;stdlib.h&gt;\n\nSoundManager::~SoundManager()\n{\n    /*\n    //Cleanup each sound bank that we use.\n    for (std::vector&lt;jteSound*&gt;::iterator it = bnkFootsteps.begin(); it != bnkFootsteps.end(); ++it) {\n        delete *it;\n    }\n    */\n}\n\nvoid SoundManager::registerNewSound(std::vector&lt;std::shared_ptr&lt;jteSound&gt;&gt; &amp;bnk, std::string path, std::string sndName)\n{\n    static int counter = 0;\n    for (int i = counter; counter &lt;i+1; counter++) {\n        bnk.push_back(jteSound);\n        bnk[i]-&gt;name = sndName;\n        bnk[i]-&gt;sndBuffer.loadFromFile(path);\n        bnk[i]-&gt;snd.setBuffer(bnk[i]-&gt;sndBuffer);\n    }\n}\n</code></pre>\n\n<p><code>bnk.push_back(jteSound);</code> gives me a compiler error. If I remove the line, the program compiles, but crashes. I have tried things like <code>emplace_back()</code> or <code>jteSound*</code> or <code>new jteSound</code>, but nothing works. I always get a lengthy compiler error or immediate runtime crash. When I use regular pointers and new/delete, see <a href=\"https://bpaste.net/show/fa684f2f2d5e\" rel=\"nofollow noreferrer\">https://bpaste.net/show/fa684f2f2d5e</a> and <a href=\"https://bpaste.net/show/c74ac701ce7a\" rel=\"nofollow noreferrer\">https://bpaste.net/show/c74ac701ce7a</a>, the code works as expected. Any thoughts appreciated!</p>\n"}, {"tags": ["c++", "winapi", "mouse", "raw-input"], "comments": [{"owner": {"reputation": 141, "user_id": 2045953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be541d7be981682c5165f86ba531c538?s=128&d=identicon&r=PG", "display_name": "TooGeeky", "link": "https://stackoverflow.com/users/2045953/toogeeky"}, "edited": false, "score": 0, "creation_date": 1499288732, "post_id": 44935905, "comment_id": 76848162, "body": "Have a look at this question and answer... [Get current cursor position ](<a href=\"https://stackoverflow.com/questions/6423729/get-current-cursor-position\" title=\"get current cursor position\">stackoverflow.com/questions/6423729/get-current-cursor-pos&zwnj;&#8203;ition</a>)  It might help... You can have even a thread running in the background to keep capturing..."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1499306334, "post_id": 44935905, "comment_id": 76853515, "body": "the posted code is missing the extraction of the buttons and the calculation (compared to prior input) of the mouse direction of movement,."}, {"owner": {"reputation": 2565, "user_id": 4781312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lDEcJ.jpg?s=128&g=1", "display_name": "Asesh", "link": "https://stackoverflow.com/users/4781312/asesh"}, "edited": false, "score": 1, "creation_date": 1499311217, "post_id": 44935905, "comment_id": 76854693, "body": "You have to register your raw input devices before using it. Use RegisterRawInputDevices to do so"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1499322732, "post_id": 44935905, "comment_id": 76858400, "body": "C is not C++ is not C."}, {"owner": {"reputation": 2565, "user_id": 4781312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lDEcJ.jpg?s=128&g=1", "display_name": "Asesh", "link": "https://stackoverflow.com/users/4781312/asesh"}, "edited": false, "score": 0, "creation_date": 1499324315, "post_id": 44935905, "comment_id": 76859341, "body": "Besides your window procedure would never be called because you have not registered that window procedure and you are using main instead of WinMain."}], "owner": {"reputation": 1, "user_id": 5967779, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wnphEwexvNA/AAAAAAAAAAI/AAAAAAAAABU/67pleBAni2Y/photo.jpg?sz=128", "display_name": "R1per", "link": "https://stackoverflow.com/users/5967779/r1per"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 417, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499322717, "creation_date": 1499288429, "last_edit_date": 1499322717, "question_id": 44935905, "link": "https://stackoverflow.com/questions/44935905/why-i-can-not-retrieve-rawinput-data-from-mouse", "title": "Why I can not retrieve rawinput data from mouse?", "body": "<p>I am building an app that will translate mouse input to virtual joystick, I have tried doing low level mouse input, but getting mouse position was not enough, so I went with rawinput, but now I am stuck, I cant retrieve data from mouse.</p>\n\n<pre><code>int main(int argc, char** argv)\n    {\n        while (true) {\n            printf(\"%d %d\\n\", mouse_x, mouse_y);\n            Sleep(100);\n        }\n\n    }\n    LRESULT CALLBACK WndProc(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam) {\n        switch (uMsg) {\n                case WM_CREATE:\n                    RAWINPUTDEVICE Rid[2];\n\n                    Rid[0].usUsagePage = 0x01;\n                    Rid[0].usUsage = 0x02;\n                    Rid[0].dwFlags = RIDEV_INPUTSINK;   // adds HID mouse and also ignores legacy mouse messages\n                    Rid[0].hwndTarget = 0;\n\n                    Rid[1].usUsagePage = 0x01;\n                    Rid[1].usUsage = 0x06;\n                    Rid[1].dwFlags = RIDEV_INPUTSINK;   // adds HID keyboard and also ignores legacy keyboard messages\n                    Rid[1].hwndTarget = 0;\n                    return 0;\n                case WM_INPUT:\n                {\n                    UINT dwSize;\n                    GetRawInputData((HRAWINPUT)lParam, RID_INPUT, NULL, &amp;dwSize, sizeof(RAWINPUTHEADER));\n                    LPBYTE lpb = new BYTE[dwSize];\n                    GetRawInputData((HRAWINPUT)lParam, RID_INPUT, lpb, &amp;dwSize, sizeof(RAWINPUTHEADER));\n                    RAWINPUT* raw = (RAWINPUT*)lpb;\n\n                    if (raw-&gt;header.dwType == RIM_TYPEKEYBOARD)\n                    {\n                    }\n                    else if (raw-&gt;header.dwType == RIM_TYPEMOUSE)\n                    {\n                        mouse_x = raw-&gt;data.mouse.lLastX;\n                        mouse_y = raw-&gt;data.mouse.lLastY;\n                    }\n                    delete[] lpb;\n                    break;\n                }\n        }\n    }\n</code></pre>\n"}, {"tags": ["c++", "assembly", "x86", "simd", "avx"], "comments": [{"owner": {"reputation": 1253, "user_id": 1172720, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MTA6M.png?s=128&g=1", "display_name": "NathanTempelman", "link": "https://stackoverflow.com/users/1172720/nathantempelman"}, "edited": false, "score": 0, "creation_date": 1499289529, "post_id": 44935902, "comment_id": 76848513, "body": "This might be helpful <a href=\"https://stackoverflow.com/questions/42040937/horizontal-xor-of-two-sse-values\" title=\"horizontal xor of two sse values\">stackoverflow.com/questions/42040937/&hellip;</a>"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1499291450, "post_id": 44935902, "comment_id": 76849387, "body": "Nothing built-in, it&#39;s easy to implement manually."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1499340816, "post_id": 44935902, "comment_id": 76870362, "body": "It would probably be faster to do this using non-SIMD instructions. You need three <code>XOR</code>s and you&#39;re done. (Especially if you want the result in an integer register anyway, which is what the code sample implies.)"}, {"owner": {"reputation": 10955, "user_id": 1915854, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/gIC27.jpg?s=128&g=1", "display_name": "Serge Rogatch", "link": "https://stackoverflow.com/users/1915854/serge-rogatch"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1499340974, "post_id": 44935902, "comment_id": 76870464, "body": "@CodyGray , so is this code good as is? Or can it be faster with some get/extract instructions on the <code>YMM</code> register containing <code>t</code> parameter?"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1499341600, "post_id": 44935902, "comment_id": 76870900, "body": "Well, how good the code is depends on which compiler you&#39;re using. :-) I&#39;m assuming that the use of <code>m256i_u64</code> means MSVC? (This doesn&#39;t compile in GCC or Clang, AFAIK.) And <a href=\"https://godbolt.org/g/5JFvLJ\" rel=\"nofollow noreferrer\">the output in MSVC looks pretty good</a>.  Pretty hard to imagine that you could beat a few extracts and moves. Have you profiled that this is actually a bottleneck?"}, {"owner": {"reputation": 10955, "user_id": 1915854, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/gIC27.jpg?s=128&g=1", "display_name": "Serge Rogatch", "link": "https://stackoverflow.com/users/1915854/serge-rogatch"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1499342163, "post_id": 44935902, "comment_id": 76871320, "body": "@CodyGray , yes, it&#39;s MSVC++2017 . I&#39;m currently far before profiling phase - in deep implementation. But this horizontal xor is in the heart of a random number generator, so it&#39;s expected to be a bottleneck in some use-cases."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1499343343, "post_id": 44935902, "comment_id": 76872165, "body": "I&#39;m not really sure how you got yourself into a situation where you need to do horizontal operations in the first place. SIMD operations are designed to scale <i>vertically</i>, not horizontally. If you&#39;re still in the implementation phase, it may be appropriate to reconsider the design. Generate the 4 random numbers in 4 <i>different</i> AVX registers."}, {"owner": {"reputation": 10955, "user_id": 1915854, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/gIC27.jpg?s=128&g=1", "display_name": "Serge Rogatch", "link": "https://stackoverflow.com/users/1915854/serge-rogatch"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 1, "creation_date": 1499343942, "post_id": 44935902, "comment_id": 76872611, "body": "@CodyGray, indeed, that&#39;s a great idea, thanks! Still an answer to this question may be useful for someone, I think."}, {"owner": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "edited": false, "score": 0, "creation_date": 1499356130, "post_id": 44935902, "comment_id": 76882369, "body": "You&#39;ve been asking a bunch of good but small x86 questions these days... Clearly you&#39;re working on something bigger. It&#39;s like a version of an X-Y problem. Maybe you could show us the bigger picture and we can contribute?"}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1499356245, "post_id": 44935902, "comment_id": 76882459, "body": "Is your <code>t.m256i_u64[0]</code> etc actually portable? Looks very much like a compiler-specific extension to me. Which compiler?"}, {"owner": {"reputation": 10955, "user_id": 1915854, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/gIC27.jpg?s=128&g=1", "display_name": "Serge Rogatch", "link": "https://stackoverflow.com/users/1915854/serge-rogatch"}, "reply_to_user": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "edited": false, "score": 1, "creation_date": 1499362483, "post_id": 44935902, "comment_id": 76886516, "body": "@IwillnotexistIdonotexist , thanks, I&#39;ve pushed what I&#39;m doing to <a href=\"https://github.com/srogatch/ProbQA\" rel=\"nofollow noreferrer\">github.com/srogatch/ProbQA</a> . It has large cube in its heart: <code>nAnswers</code> * <code>nQuestions</code> * <code>nTargets</code> and a few less-dimensional arrays containing aggregates. I&#39;m currently implementing CPU engine for it (well, it&#39;s x86_64 engine only, but I don&#39;t plan it for e.g. ARM yet, and supercomputer engine would have its own name), but CUDA and network grid engines are also planned. Mathematically it&#39;s based on Bayesian formula and naive Bayes assumption."}], "answers": [{"comments": [{"owner": {"reputation": 10955, "user_id": 1915854, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/gIC27.jpg?s=128&g=1", "display_name": "Serge Rogatch", "link": "https://stackoverflow.com/users/1915854/serge-rogatch"}, "edited": false, "score": 0, "creation_date": 1499330541, "post_id": 44942272, "comment_id": 76863263, "body": "I&#39;ve edited the question to clarify the goal. Please, look. Also I&#39;m afraid the code like above is slower than to just XOR 64-bit components of <code>__m256i</code> register: 4 components need 3 scalar XOR operations."}, {"owner": {"reputation": 3670, "user_id": 2831104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fM2Ds.jpg?s=128&g=1", "display_name": "ErmIg", "link": "https://stackoverflow.com/users/2831104/ermig"}, "reply_to_user": {"reputation": 10955, "user_id": 1915854, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/gIC27.jpg?s=128&g=1", "display_name": "Serge Rogatch", "link": "https://stackoverflow.com/users/1915854/serge-rogatch"}, "edited": false, "score": 0, "creation_date": 1499334015, "post_id": 44942272, "comment_id": 76865614, "body": "@SergeRogatch Could you write scalar code that you want to optimize with using AVX?"}], "tags": [], "owner": {"reputation": 3670, "user_id": 2831104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fM2Ds.jpg?s=128&g=1", "display_name": "ErmIg", "link": "https://stackoverflow.com/users/2831104/ermig"}, "is_accepted": false, "score": 2, "last_activity_date": 1499325855, "creation_date": 1499325855, "answer_id": 44942272, "question_id": 44935902, "link": "https://stackoverflow.com/questions/44935902/horizontal-xor-in-avx/44942272#44942272", "title": "Horizontal XOR in AVX", "body": "<p>Implementation of direct analogue of <code>_mm256_hadd_epi32()</code> for XOR will be look something like this:</p>\n\n<pre><code>#include &lt;immintrin.h&gt;\n\ntemplate&lt;int imm&gt; inline __m256i _mm256_shuffle_epi32(__m256i a, __m256i b)\n{\n    return _mm256_castps_si256(_mm256_shuffle_ps(_mm256_castsi256_ps(a), _mm256_castsi256_ps(b), imm));\n}\n\ninline __m256i _mm256_hxor_epi32(__m256i a, __m256i b)\n{\n    return _mm256_xor_si256(_mm256_shuffle_epi32&lt;0x88&gt;(a, b), _mm256_shuffle_epi32&lt;0xDD&gt;(a, b));\n}\n\nint main()\n{\n    __m256i a = _mm256_setr_epi32(0, 1, 2, 3, 4, 5, 6, 7);\n    __m256i b = _mm256_setr_epi32(1, 2, 3, 4, 5, 6, 7, 8);\n    __m256i c = _mm256_hxor_epi32(a, b);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "edited": false, "score": 0, "creation_date": 1499421011, "post_id": 44953526, "comment_id": 76910331, "body": "Good visual explanation about  the XORs!"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1499487695, "post_id": 44953526, "comment_id": 76940009, "body": "For swapping the two lanes of a ymm register, <code>vpermq</code> should be preferred over <code>vperm2i128</code>.  It only has one input, which makes it much faster on Ryzen and KNL.  They&#39;re the same performance on Intel Haswell/Skylake."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1499487945, "post_id": 44953526, "comment_id": 76940058, "body": "Of course, <code>vextracti128</code> is even better on Ryzen, and 128b operations are only a single uop.  If you don&#39;t need the result broadcast to all elements, narrowing down to 128b as early as possible is a good strategy for horizontal ops in general, including this one.  But <code>vpextrq</code> is relatively expensive in uop count, so it does make sense to shuffle/xor down to a scalar in the bottom of an xmm register, then use one <code>vmovq</code> (to an integer register or to memory).  The same applies to other horizontal ops, <a href=\"https://stackoverflow.com/a/35270026/224132\">including integer sums</a>."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1499488536, "post_id": 44953526, "comment_id": 76940153, "body": "<i>completely separate integer execution units</i>: they&#39;re on the same ports as the vector execution units in Intel CPUs, except for Haswell and later&#39;s port6 which has integer ALUs (and the taken-branch unit) but no vector execution units.  So there&#39;s only a tiny amount of extra ALU throughput to be gained from mixing in scalar instructions, but it costs a lot of front-end throughput and p0 / p5 uops to get the data to it.   (Front-end throughput is a problem for this idea on AMD, too, even though the integer and vector uops use different pipes)."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1499488686, "post_id": 44953526, "comment_id": 76940172, "body": "Worth considering: an in-lane <code>vpshufd</code>, <code>vpxor ymm</code>, <code>vextracti128</code>, 2x <code>vmovq</code>, 2x scalar <code>xor</code>.  7 uops total on Intel, and the first <code>vmovq</code> can execute while the 2nd is waiting for the <code>vextracti128</code> result.  On Intel, latency is no better than your final sequence, but it costs more total uops (which need to run in parallel for latency to not be worse).  So it can&#39;t overlap as well with surrounding code."}], "tags": [], "owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "is_accepted": true, "score": 12, "last_activity_date": 1499476359, "last_edit_date": 1499476359, "creation_date": 1499355858, "answer_id": 44953526, "question_id": 44935902, "link": "https://stackoverflow.com/questions/44935902/horizontal-xor-in-avx/44953526#44953526", "title": "Horizontal XOR in AVX", "body": "<p>As stated in the comments, the fastest code very likely uses scalar operations, doing everything in the integer registers. All you need to do is extract the four packed 64-bit integers, then you have three <code>XOR</code> instructions, and you're done. This can be done pretty efficiently, and it leaves the result in an integer register, which is what your sample code suggests that you would want.</p>\n\n<p>MSVC already generates pretty good code for the scalar function that you show as an example in the question:</p>\n\n<pre><code>inline uint64_t HorizontalXor(__m256i t) {\n  return t.m256i_u64[0] ^ t.m256i_u64[1] ^ t.m256i_u64[2] ^ t.m256i_u64[3];\n}\n</code></pre>\n\n<p>Assuming that <code>t</code> is in <code>ymm1</code>, the resulting disassembly will be something like this:</p>\n\n<pre><code>vextractf128 xmm0, ymm1, 1\nvpextrq      rax,  xmm0, 1\nvmovq        rcx,  xmm1\nxor          rax,  rcx\nvpextrq      rcx,  xmm1, 1\nvextractf128 xmm0, ymm1, 1\nxor          rax,  rcx\nvmovq        rcx,  xmm0\nxor          rax,  rcx\n</code></pre>\n\n<p>\u2026with the result left in <code>RAX</code>. If this accurately reflects what you need (a scalar <code>uint64_t</code> result), then this code would be sufficient.</p>\n\n<p>You can <em>slightly</em> improve it by using intrinsics:</p>\n\n<pre><code>inline uint64_t _mm256_hxor_epu64(__m256i x)\n{\n   const __m128i temp = _mm256_extracti128_si256(x, 1);\n   return (uint64_t&amp;)x\n          ^ (uint64_t)(_mm_extract_epi64(_mm256_castsi256_si128(x), 1))\n          ^ (uint64_t&amp;)(temp)\n          ^ (uint64_t)(_mm_extract_epi64(temp, 1));\n}\n</code></pre>\n\n<p>Then you'll get the following disassembly (again, assuming that <code>x</code> is in <code>ymm1</code>):</p>\n\n<pre><code>vextracti128 xmm2, ymm1, 1\nvpextrq      rcx,  xmm2, 1\nvpextrq      rax,  xmm1, 1\nxor          rax,  rcx\nvmovq        rcx,  xmm1\nxor          rax,  rcx\nvmovq        rcx,  xmm2\nxor          rax,  rcx\n</code></pre>\n\n<p>Notice that we were able to elide one extraction instruction, and that we've ensured <code>VEXTRACTI128</code> was used instead of <code>VEXTRACTF128</code> (although, <a href=\"https://stackoverflow.com/a/25703340/366904\">this choice probably does not matter</a>).</p>\n\n<p>You'll see similar output on other compilers. For example, here's GCC 7.1 (with <code>x</code> assumed to be in <code>ymm0</code>):</p>\n\n<pre><code>vextracti128 xmm2, ymm0, 0x1\nvpextrq      rax,  xmm0, 1\nvmovq        rdx,  xmm2\nvpextrq      rcx,  xmm2, 1\nxor          rax,  rdx\nvmovq        rdx,  xmm0\nxor          rax,  rdx\nxor          rax,  rcx\n</code></pre>\n\n<p>The same instructions are there, but they've been slightly reordered. The intrinsics allow the compiler's scheduler to order as it deems best. Clang 4.0 schedules them differently yet:</p>\n\n<pre><code>vmovq        rax,  xmm0\nvpextrq      rcx,  xmm0, 1\nxor          rcx,  rax\nvextracti128 xmm0, ymm0, 1\nvmovq        rdx,  xmm0\nxor          rdx,  rcx\nvpextrq      rax,  xmm0, 1\nxor          rax,  rdx\n</code></pre>\n\n<p>And, of course, this ordering is always subject to change when the code gets inlined.</p>\n\n<hr>\n\n<p>On the other hand, if you want the result to be in an AVX register, then you first need to decide how you want it to be stored. I guess you would just store the single 64-bit result as a scalar, something like:</p>\n\n<pre><code>inline __m256i _mm256_hxor(__m256i x)\n{\n   const __m128i temp = _mm256_extracti128_si256(x, 1);\n   return _mm256_set1_epi64x((uint64_t&amp;)x\n                             ^ (uint64_t)(_mm_extract_epi64(_mm256_castsi256_si128(x), 1))\n                             ^ (uint64_t&amp;)(temp)\n                             ^ (uint64_t)(_mm_extract_epi64(temp, 1)));\n}\n</code></pre>\n\n<p>But now you're doing a lot of data shuffling, negating any performance boost that you would possibly see from vectorizing the code.</p>\n\n<p>Speaking of which, I'm not really sure how you got yourself into a situation where you need to do horizontal operations like this in the first place. SIMD operations are designed to scale <em>vertically</em>, not horizontally. If you're still in the implementation phase, it may be appropriate to reconsider the design. In particular, you should be generating the 4 integer values in 4 <em>different</em> AVX registers, rather than packing them all into one.</p>\n\n<p>If you actually want <em>4 copies</em> of the result packed into an AVX register, then you could do something like this:</p>\n\n<pre><code>inline __m256i _mm256_hxor(__m256i x)\n{\n   const __m256i temp = _mm256_xor_si256(x,\n                                         _mm256_permute2f128_si256(x, x, 1));    \n   return _mm256_xor_si256(temp,\n                           _mm256_shuffle_epi32(temp, _MM_SHUFFLE(1, 0, 3, 2)));\n}\n</code></pre>\n\n<p>This still exploits a bit of parallelism by doing two XORs at once, meaning that only two XOR operations are required in all, instead of three. </p>\n\n<p>If it helps to visualize it, this basically does:</p>\n\n<pre><code>   A         B         C         D           \u27f5 input\n  XOR       XOR       XOR       XOR\n   C         D         A         B           \u27f5 permuted input\n=====================================\n  A^C       B^D       A^C        B^D         \u27f5 intermediate result\n  XOR       XOR       XOR        XOR\n  B^D       A^C       B^D        A^C         \u27f5 shuffled intermediate result\n======================================\nA^C^B^D   A^C^B^D   A^C^B^D    A^C^B^D      \u27f5 final result\n</code></pre>\n\n<p>On practically all compilers, these intrinsics will produce the following assembly code:</p>\n\n<pre><code>vperm2f128  ymm0, ymm1, ymm1, 1    ; input is in YMM1\nvpxor       ymm2, ymm0, ymm1\nvpshufd     ymm1, ymm2, 78\nvpxor       ymm0, ymm1, ymm2\n</code></pre>\n\n<p>(I had come up with this on my way to bed after first posting this answer, and planned to come back and update the answer, but I see that <a href=\"https://stackoverflow.com/a/44959950/366904\">wim</a> beat me to the punch on posting it. Oh well, it's still a better approach than what I first had, so it still merits being included here.)</p>\n\n<p>And, of course, if you wanted this in an integer register, you would just need a simple <code>VMOVQ</code>:</p>\n\n<pre><code>vperm2f128  ymm0, ymm1, ymm1, 1    ; input is in YMM1\nvpxor       ymm2, ymm0, ymm1\nvpshufd     ymm1, ymm2, 78\nvpxor       ymm0, ymm1, ymm2\nvmovq       rax,  xmm0\n</code></pre>\n\n<p>The question is, would this be faster than the scalar code above. And the answer is, yes, probably. Although you are doing the XORs using the AVX execution units, instead of the completely separate integer execution units, there are fewer AVX shuffles/permutes/extracts that need to be done, which means less overhead. So I might also have to eat my words on scalar code being the fastest implementation. But it really depends on what you're doing and how the instructions can be scheduled/interleaved.</p>\n"}, {"comments": [{"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1499414947, "post_id": 44959950, "comment_id": 76906219, "body": "Indeed, my original solution was sub-optimal. I posted the answer right before turning in for the night, and then on my way to bed realized a better solution. Having come back to update, I see that you had already posted it. I went ahead and updated my answer for completeness, but have an upvote!"}, {"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1499421114, "post_id": 44959950, "comment_id": 76910401, "body": "@CodyGray Loosely speaking, the SIMD complexity of &#39;simple&#39; horizontal operations,  such as horizontal sum, product, minimum, maximum, logical and, etc. is often O(log(n)) instead of O(n), where n is the number of elements in the SIMD  register. Sometimes this is quite obvious, for example with the <a href=\"https://stackoverflow.com/a/43271592/2439725\">horizontal minimum</a>. Sometimes it is less obvious, <a href=\"https://stackoverflow.com/a/43392973/2439725\">such as this one</a>."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1499489021, "post_id": 44959950, "comment_id": 76940222, "body": "Most of <a href=\"https://stackoverflow.com/questions/44935902/horizontal-xor-in-avx#comment76940009_44953526\">my comments on Cody&#39;s update</a> apply here too: reduce down to 128b as the first step (faster on Ryzen and Excavator), and avoid <code>vperm2i128</code> when you don&#39;t need it.  <code>vextracti128</code> is excellent on Ryzen, and <code>vpermq</code> is better than <code>vperm2?128</code> for swapping upper/lower lanes."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1499489213, "post_id": 44959950, "comment_id": 76940257, "body": "When you <i>do</i> want a result broadcast to every element instead of reducing to 128 and then scalar, doing the in-lane shuffle first is probably <i>slightly</i> better, since the lower latency means more uops/instructions can execute (and retire) sooner, freeing up space in the reservation station and ROB.  It&#39;s probably non-trivial to even construct an artificial test that could measure the difference, but I think it can&#39;t hurt.  This also applies when reducing to scalar, but in that case staying 256b for longer means extra uops on AMD CPUs, so I&#39;d recommend reducing to 128b first."}, {"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1499503030, "post_id": 44959950, "comment_id": 76943215, "body": "@PeterCordes Thanks for your insightful comments! I didn&#39;t even think about Ryzen  when I wrote my answer. I&#39;ll update my answer later on."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1499503315, "post_id": 44959950, "comment_id": 76943299, "body": ":)  Even without Ryzen, presumably narrowing to 128b ASAP has energy/power advantages.  Might be more relevant for FP add than for XOR, but still very small.  Also, a speed advantage on e.g. Skylake if the CPU is still in AVX &quot;warm-up&quot; mode where the upper lane isn&#39;t active yet."}], "tags": [], "owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "is_accepted": false, "score": 4, "last_activity_date": 1499380810, "creation_date": 1499380810, "answer_id": 44959950, "question_id": 44935902, "link": "https://stackoverflow.com/questions/44935902/horizontal-xor-in-avx/44959950#44959950", "title": "Horizontal XOR in AVX", "body": "<p>Vectorization is likely to be useful if the input of the horizontal <code>xor</code>-function is already in\nan AVX register, i.e. your <code>t</code> is the result of some SIMD computation. \nOtherwise, scalar code is likely to be faster, as already mentioned by @Cody Gray. \nOften you can do horizontal SIMD operations in about log_2(SIMD_width) 'steps'.\nIn this case one step is a 'shuffle/permute' and a 'xor'. This is slightly more efficient than @Cody Gray 's <code>_mm256_hxor</code> function:</p>\n\n<pre><code>__m256i _mm256_hxor_v2(__m256i x)\n{\n    __m256i x0 = _mm256_permute2x128_si256(x,x,1);       // swap the 128 bit high and low lane \n    __m256i x1 = _mm256_xor_si256(x,x0);\n    __m256i x2 = _mm256_shuffle_epi32(x1,0b01001110);    // swap 64 bit lanes                         \n    __m256i x3 = _mm256_xor_si256(x1,x2);\n    return x3;\n}\n</code></pre>\n\n<p>This compiles to: </p>\n\n<pre><code>vperm2i128  $1, %ymm0, %ymm0, %ymm1\nvpxor   %ymm1, %ymm0, %ymm0\nvpshufd $78, %ymm0, %ymm1\nvpxor   %ymm1, %ymm0, %ymm0\n</code></pre>\n\n<p><br/></p>\n\n<p>If you want the result in a scalar register:</p>\n\n<pre><code>uint64_t _mm256_hxor_v2_uint64(__m256i x)\n{\n    __m256i x0 = _mm256_permute2x128_si256(x,x,1);\n    __m256i x1 = _mm256_xor_si256(x,x0);\n    __m256i x2 = _mm256_shuffle_epi32(x1,0b01001110);\n    __m256i x3 = _mm256_xor_si256(x1,x2);\n    return _mm_cvtsi128_si64x(_mm256_castsi256_si128(x3)) ;\n}\n</code></pre>\n\n<p>Which compiles to:</p>\n\n<pre><code>vperm2i128  $1, %ymm0, %ymm0, %ymm1\nvpxor   %ymm1, %ymm0, %ymm0\nvpshufd $78, %ymm0, %ymm1\nvpxor   %ymm1, %ymm0, %ymm0\nvmovq   %xmm0, %rax\n</code></pre>\n\n<p><br/></p>\n\n<p>Full test code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;x86intrin.h&gt;\n#include &lt;stdint.h&gt;\n/*  gcc -O3 -Wall -m64 -march=broadwell hor_xor.c   */\nint print_vec_uint64(__m256i v);\n\n__m256i _mm256_hxor_v2(__m256i x)\n{\n    __m256i x0 = _mm256_permute2x128_si256(x,x,1);\n    __m256i x1 = _mm256_xor_si256(x,x0);\n    __m256i x2 = _mm256_shuffle_epi32(x1,0b01001110);\n    __m256i x3 = _mm256_xor_si256(x1,x2);\n/* Uncomment the next few lines to print the values of the intermediate variables */ \n/*\n    printf(\"3...0        =          3          2          1          0\\n\");\n    printf(\"x            = \");print_vec_uint64(x        );\n    printf(\"x0           = \");print_vec_uint64(x0        );\n    printf(\"x1           = \");print_vec_uint64(x1        );\n    printf(\"x2           = \");print_vec_uint64(x2        );\n    printf(\"x3           = \");print_vec_uint64(x3        );\n*/\n    return x3;\n}\n\nuint64_t _mm256_hxor_v2_uint64(__m256i x)\n{\n    __m256i x0 = _mm256_permute2x128_si256(x,x,1);\n    __m256i x1 = _mm256_xor_si256(x,x0);\n    __m256i x2 = _mm256_shuffle_epi32(x1,0b01001110);\n    __m256i x3 = _mm256_xor_si256(x1,x2);\n    return _mm_cvtsi128_si64x(_mm256_castsi256_si128(x3)) ;\n}\n\n\nint main() {\n    __m256i x = _mm256_set_epi64x(0x7, 0x5, 0x2, 0xB);\n//    __m256i x = _mm256_set_epi64x(4235566778345231, 1123312566778345423, 72345566778345673, 967856775433457);\n\n    printf(\"x            = \");print_vec_uint64(x);\n\n    __m256i y = _mm256_hxor_v2(x);\n\n    printf(\"y            = \");print_vec_uint64(y);\n\n    uint64_t z = _mm256_hxor_v2_uint64(x);\n\n    printf(\"z =  %10lX  \\n\",z);\n\n    return 0;\n}\n\n\nint print_vec_uint64(__m256i v){\n    uint64_t t[4];\n    _mm256_storeu_si256((__m256i *)t,v);\n    printf(\"%10lX %10lX %10lX %10lX \\n\",t[3],t[2],t[1],t[0]);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 10955, "user_id": 1915854, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/gIC27.jpg?s=128&g=1", "display_name": "Serge Rogatch", "link": "https://stackoverflow.com/users/1915854/serge-rogatch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1531, "favorite_count": 0, "accepted_answer_id": 44953526, "answer_count": 3, "score": 7, "last_activity_date": 1499476359, "creation_date": 1499288420, "last_edit_date": 1499340872, "question_id": 44935902, "link": "https://stackoverflow.com/questions/44935902/horizontal-xor-in-avx", "title": "Horizontal XOR in AVX", "body": "<p>Is there a way to XOR horizontally an AVX register\u2014specifically, to XOR the four 64-bit components of a 256-bit register?</p>\n\n<p>The goal is to get the XOR of all 4 64-bit components of an AVX register. It would essentially be doing the same thing as a horizontal add (<code>_mm256_hadd_epi32()</code>), except that I want to XOR instead of ADD.</p>\n\n<p>The scalar code is:</p>\n\n<pre><code>inline uint64_t HorizontalXor(__m256i t) {\n  return t.m256i_u64[0] ^ t.m256i_u64[1] ^ t.m256i_u64[2] ^ t.m256i_u64[3];\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "c++11", "memory-leaks", "swig"], "comments": [{"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 5, "creation_date": 1499445807, "post_id": 44935830, "comment_id": 76926900, "body": "You need to show a <i>minimal</i> complete example we can try with a debugger on our own computers that reproduces the issue and not random incomplete fragments of a large fragment."}, {"owner": {"reputation": 232, "user_id": 4438552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbf7db222a1b26ef78becec9676969a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jared Andrews", "link": "https://stackoverflow.com/users/4438552/jared-andrews"}, "reply_to_user": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1499454800, "post_id": 44935830, "comment_id": 76931451, "body": "@Flexo Sorry, the complete setup is pretty extensive and likely overkill. I&#39;ve updated my question with the source files for the <code>Matrix</code> class and how they&#39;re being utilized by the python module. I&#39;ve also spent a lot of time reading about pointers and dynamic memory allocation and updated my question with related concerns. Thanks for your time."}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1499786647, "post_id": 44935830, "comment_id": 77051341, "body": "I am not sure how your <code>Matrix.cpp</code> compiles without error. In <code>Matrix::lookForPvalue</code> you do <code>map&lt;long long, double&gt; nbocc = calcDistribWithMapMinMax(min,max);</code> which should cause compilation error since LHS <code>nbocc</code> is not a type of <code>map&lt;long long, double&gt; *</code> which is what <code>calcDistribWithMapMinMax</code> returns."}, {"owner": {"reputation": 232, "user_id": 4438552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbf7db222a1b26ef78becec9676969a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jared Andrews", "link": "https://stackoverflow.com/users/4438552/jared-andrews"}, "edited": false, "score": 0, "creation_date": 1499786795, "post_id": 44935830, "comment_id": 77051475, "body": "That&#39;s a typo, my mistake, I will edit the code."}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1499786970, "post_id": 44935830, "comment_id": 77051612, "body": "@JaredAndrews I am no expert in SWIG, but, could you try removing <code>%nodefaultdtor Matrix;</code> and see if you can still reproduce the memory leak?"}, {"owner": {"reputation": 232, "user_id": 4438552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbf7db222a1b26ef78becec9676969a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jared Andrews", "link": "https://stackoverflow.com/users/4438552/jared-andrews"}, "reply_to_user": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1499787181, "post_id": 44935830, "comment_id": 77051786, "body": "@Griffin Yes, it will still be there. I added that after trying to explicitely define a destructor, but the problem existed prior to that. None of the <code>Matrix</code> attributes themselves consume much memory and appear properly cleaned up on the Python side."}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 1, "creation_date": 1499787797, "post_id": 44935830, "comment_id": 77052295, "body": "@JaredAndrews How have you checked memory is properly cleaned up on Pythod side? Can you try tracing the leak with <a href=\"http://tech.labs.oliverwyman.com/blog/2008/11/14/tracing-python-memory-leaks/\" rel=\"nofollow noreferrer\">this suggested tool</a>?"}, {"owner": {"reputation": 232, "user_id": 4438552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbf7db222a1b26ef78becec9676969a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jared Andrews", "link": "https://stackoverflow.com/users/4438552/jared-andrews"}, "reply_to_user": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1499788134, "post_id": 44935830, "comment_id": 77052520, "body": "@Griffin. This looks useful and I&#39;ll test it out. I used <a href=\"https://pythonhosted.org/Pympler/\" rel=\"nofollow noreferrer\">Pympler</a> to check out the size of objects while debugging. I will try tracing it will this tool as well."}, {"owner": {"reputation": 232, "user_id": 4438552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbf7db222a1b26ef78becec9676969a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jared Andrews", "link": "https://stackoverflow.com/users/4438552/jared-andrews"}, "reply_to_user": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1499793773, "post_id": 44935830, "comment_id": 77056022, "body": "@Griffin So using both that tool and Pympler yield basically the same result. <code>Matrix</code> objects themselves have a very small memory footprint and are deleted properly, <i>at least</i> as can be seen from the python side. <a href=\"http://i.imgur.com/jLyXwwU.png\" rel=\"nofollow noreferrer\">This Pympler image</a> shows all <code>Matrix</code> objects right after instantiation and then deletion. I think it&#39;s going to be difficult to assay the leak from the python side, so I&#39;m trying to get Valgrind to play nice and see what it yields."}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1499851130, "post_id": 44935830, "comment_id": 77080298, "body": "@JaredAndrews could you share what you have with Valgrind found with us?"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1499904194, "post_id": 44935830, "comment_id": 77111853, "body": "This can/ <b>should</b> be debugged outside <i>Python</i>. Simply add a <i>main.cpp</i> file to the &quot;project&quot;, that instantiates the <code>Matrix</code> class and call its methods. The rule is simple: for every <code>new</code> call there should be one <code>delete[]</code> counterpart (brackets might not be necessary). E.g. all matrix type (double pointer - <code>**</code>) variables that are allocated must be freed (like <code>matInt</code> from destructor). <code>mattemp</code> on the other hand, produces such a memory leak (there might be more)."}, {"owner": {"reputation": 3740, "user_id": 1030870, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8f96f7ac4f0bf4c2421a9f58b6893400?s=128&d=identicon&r=PG", "display_name": "Mine", "link": "https://stackoverflow.com/users/1030870/mine"}, "edited": false, "score": 0, "creation_date": 1499930277, "post_id": 44935830, "comment_id": 77120214, "body": "A general comment: you could avoid the use of <code>new</code>/<code>delete</code> here, and use <code>std::vector</code> or <code>std::array</code> instead, then you are likely to avoid memory leaks."}, {"owner": {"reputation": 232, "user_id": 4438552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbf7db222a1b26ef78becec9676969a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jared Andrews", "link": "https://stackoverflow.com/users/4438552/jared-andrews"}, "reply_to_user": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1499962760, "post_id": 44935830, "comment_id": 77144740, "body": "@Griffin Valgrind confirmed the memory leak, but also yielded a ton of noise even with the python suppressions. I&#39;m creating a purely c++ example as suggested so that I can test the solution in Some Who Call Me Tim&#39;s answer below."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1499985866, "post_id": 44935830, "comment_id": 77156664, "body": "You say it was written in 2007 so doesn\u2019t have C++11 tricks, but is there a reason you couldn\u2019t write it to use those now? You could get rid of almost all the explicit <code>new</code>s and <code>delete</code>s if you did that, and the fewer of those you have the fewer chances there are for memory leaks to sneak in."}], "answers": [{"comments": [{"owner": {"reputation": 232, "user_id": 4438552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbf7db222a1b26ef78becec9676969a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jared Andrews", "link": "https://stackoverflow.com/users/4438552/jared-andrews"}, "edited": false, "score": 0, "creation_date": 1499786648, "post_id": 45020696, "comment_id": 77051343, "body": "Thanks for the first answer. I actually did just what you suggested, but the <code>Matrix</code> object isn&#39;t actually the issue, but rather the extensive use of pointers to maps of maps and issues dereferencing them properly.  I looked at other options (Boost, Cython, ctypes among them), but Swig seemed like the most straightforward one."}], "tags": [], "owner": {"reputation": 398, "user_id": 459189, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3d785e58e02fb88fd844b38467fd0cd3?s=128&d=identicon&r=PG", "display_name": "Fruch", "link": "https://stackoverflow.com/users/459189/fruch"}, "is_accepted": false, "score": 1, "last_activity_date": 1499717195, "creation_date": 1499717195, "answer_id": 45020696, "question_id": 44935830, "link": "https://stackoverflow.com/questions/44935830/c-memory-leak-in-swig-python-module/45020696#45020696", "title": "C++ Memory Leak in Swig Python Module", "body": "<p>to answer your question, yes you can use delete on diffrent function or method. and you should, any memory you allocate in c/c++ you need to free (delete in c++ lingo)</p>\n\n<p>python isn't aware of this memory, it's not a python object, so gc.collect() won't help.\nyou should add a c function that would take a Matrix struct and free/delete the memory use on that struct. and call it from python, swig in not handling memory allocation (only for the objects swig creates)</p>\n\n<p>I would recommended looking into newer packages other then swig, like cython or cffi (or even NumPy matrix handling, I've heard he's good at)</p>\n"}, {"comments": [{"owner": {"reputation": 232, "user_id": 4438552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbf7db222a1b26ef78becec9676969a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jared Andrews", "link": "https://stackoverflow.com/users/4438552/jared-andrews"}, "edited": false, "score": 0, "creation_date": 1499962421, "post_id": 45081898, "comment_id": 77144546, "body": "Thanks. Yes, SWIG does just that, and at this point, I&#39;m quite certain the <code>Matrix</code> class is being cleaned up properly.  I had contemplated your first approach and think it&#39;s likely the best solution. I had come across shared pointers previously, but this isn&#39;t c++11, so it&#39;s not an option unless I use something like <code>boost</code>, which I&#39;m less inclined to do.  The vector usage is also a good idea and something I will try to implement."}], "tags": [], "owner": {"reputation": 991, "user_id": 7472328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ddbe555b433ddd61621c5b5697f421?s=128&d=identicon&r=PG&f=1", "display_name": "Some Who Call Me Tim", "link": "https://stackoverflow.com/users/7472328/some-who-call-me-tim"}, "is_accepted": false, "score": 2, "last_activity_date": 1499952115, "creation_date": 1499952115, "answer_id": 45081898, "question_id": 44935830, "link": "https://stackoverflow.com/questions/44935830/c-memory-leak-in-swig-python-module/45081898#45081898", "title": "C++ Memory Leak in Swig Python Module", "body": "<p>Two questions are in play here: managing memory in C++, and then nudging the C++ side from the Python side to clean up. I'm guessing SWIG is generating a wrapper for the Matrix destructor and calling the destructor at some useful time. (I might convince myself of that by having the dtor make some noise.) That should handle the second question.</p>\n\n<p>So let's focus on the C++ side. Passing around a bare <code>map *</code> is a well-known invitation to mischief. Here are two alternatives. </p>\n\n<p>Alternative one: make the map a member of <code>Matrix</code>. Then it gets cleaned up automatically by <code>~Matrix()</code>. This is the easiest thing. If the lifetime of the map does not exceed the lifetime of the Matrix, then this route will work.</p>\n\n<p>Alternative two: if the map needs to persist after the Matrix object, then instead of passing around <code>map *</code>, use a shared pointer, <code>std::shared_ptr&lt;map&gt;</code>. The shared pointer reference counts the pointee (i.e. the dynamically allocated Matrix). When the ref count goes to zero, it deletes the underlying object. </p>\n\n<p>They both build on the rule to allocate resources (memory in this case) in constructors and deallocate in destructors. This is called RAII (Resource Allocation Is Initialization). Another application of RAII in your code would be to use <code>std::vector&lt;long long&gt; offsets</code> instead of <code>long long *offsets</code> etc. Then you just resize the vectors as needed. When the Matrix is destroyed, the vectors are deleted with no intervention on your part. For the matrix, you could use a vector of vectors, and so on.</p>\n"}, {"comments": [{"owner": {"reputation": 232, "user_id": 4438552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbf7db222a1b26ef78becec9676969a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jared Andrews", "link": "https://stackoverflow.com/users/4438552/jared-andrews"}, "edited": false, "score": 1, "creation_date": 1504293150, "post_id": 45091990, "comment_id": 78974280, "body": "Though all of these comments and answers were helpful, this one was the one that ultimately best addressed the issues I was facing.  As previously suggested by @Flexo and others, I created a minimal example in c++ that still had the issue and used <code>valgrind</code> to find where the leaks were. This allowed me to systematically remove/fix all <code>new</code> and <code>delete</code> statements that we causing the leaks. Thanks again to everyone for your help. The source code for the corrected program can be seen here: <a href=\"https://github.com/j-andrews7/pytfmpval\" rel=\"nofollow noreferrer\">github.com/j-andrews7/pytfmpval</a>"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 232, "user_id": 4438552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbf7db222a1b26ef78becec9676969a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jared Andrews", "link": "https://stackoverflow.com/users/4438552/jared-andrews"}, "edited": false, "score": 0, "creation_date": 1504294207, "post_id": 45091990, "comment_id": 78974686, "body": "@JaredAndrews I\u2019m glad I could help! One tip which I forgot to mention here is that it&#39;s often easier and less error-prone to use C++ classes like <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow noreferrer\"><code>std::unique_ptr</code></a> instead of trying to do memory management yourself; unfortunately, I don\u2019t know if those play nicely with SWIG."}, {"owner": {"reputation": 232, "user_id": 4438552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbf7db222a1b26ef78becec9676969a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jared Andrews", "link": "https://stackoverflow.com/users/4438552/jared-andrews"}, "edited": false, "score": 1, "creation_date": 1504294482, "post_id": 45091990, "comment_id": 78974791, "body": "Yeah, they&#39;re supported (supposedly, though I read plenty of threads that had issues) but I really wasn&#39;t looking forward to reworking everything with the different pointers - this was my first contact with C++ and this was meant to be a quick task that turned into something that was much more of a headache. If I ever wrote anything from scratch, I&#39;d be sure to utilize the features of C++11 though. Thanks again!"}], "tags": [], "owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1500066682, "last_edit_date": 1500066682, "creation_date": 1499985669, "answer_id": 45091990, "question_id": 44935830, "link": "https://stackoverflow.com/questions/44935830/c-memory-leak-in-swig-python-module/45091990#45091990", "title": "C++ Memory Leak in Swig Python Module", "body": "<p>It\u2019s hard to follow what\u2019s happening, but I\u2019m pretty sure your matrices are not being cleaned up correctly.</p>\n\n<p>In <code>readMatrix</code>, you have a loop over <code>j</code> which contains the line <code>this-&gt;mat[j] = new double[this-&gt;length];</code>. This allocates memory, which <code>mat[j]</code> points to. This memory needs to be freed at some point, by calling <code>delete[] mat[j]</code> (or some other loop variable). However, in the destructor, you just call <code>delete[] mat</code>, which leaks all of the arrays inside it.</p>\n\n<p>Some general suggestions on cleaning this up:</p>\n\n<ol>\n<li>If you know the bounds of an array, such as that <code>matInt</code> will always have a length of 4, you should declare it with that fixed length (<code>long long* matInt[4]</code> will make an array of four pointers to <code>long long</code>, each of which could be a pointer to an array); this will mean you don\u2019t need to either <code>new</code> or <code>delete</code> it.</li>\n<li>If you have a double pointer like <code>double ** mat</code>, and you allocate both the first and second layers of pointers with <code>new[]</code>, you need to deallocate the inner layer with <code>delete[]</code> (and you need to do it before you <code>delete[]</code> the outer layer).</li>\n<li>If you still have trouble, more of your code will be clear if you remove the methods which don\u2019t seem relevant to the problem. For example, <code>toLogOddRatio</code> doesn\u2019t allocate or deallocate memory at all; it almost certainly isn\u2019t contributing to the problem and you can remove it from the code you post here (once you\u2019ve removed the parts which you think don\u2019t contribute, test again to make sure the problem\u2019s still there; if not then you know that it was one of those parts somehow causing the leak).</li>\n</ol>\n"}], "owner": {"reputation": 232, "user_id": 4438552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbf7db222a1b26ef78becec9676969a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jared Andrews", "link": "https://stackoverflow.com/users/4438552/jared-andrews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 2, "accepted_answer_id": 45091990, "answer_count": 3, "score": 2, "last_activity_date": 1504294909, "creation_date": 1499288147, "last_edit_date": 1504294909, "question_id": 44935830, "link": "https://stackoverflow.com/questions/44935830/c-memory-leak-in-swig-python-module", "title": "C++ Memory Leak in Swig Python Module", "body": "<h2>Background</h2>\n\n<p>I have created a <code>python</code> module that wraps a <code>c++</code> program using <code>SWIG</code>. It works just fine, but it has a pretty serious memory leak issue that I think is a result of poorly handled pointers to large <code>map</code> objects. I have very little experience with <code>c++</code>, and I have questions as to whether <code>delete[]</code> can be used on an object created with <code>new</code> in a different function or method.</p>\n\n<p>The program was written in 2007, so excuse the lack of useful <code>c++11</code> tricks. </p>\n\n<hr>\n\n<p>The <code>swig</code> extension basically just wraps a single c++ class (<code>Matrix</code>) and a few functions.</p>\n\n<p><strong>Matrix.h</strong></p>\n\n<pre><code>#ifndef __MATRIX__\n#define __MATRIX__\n\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;map&gt;\n#include &lt;cmath&gt;\n#include &lt;fstream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\n#include \"FileException.h\"\n#include \"ParseException.h\"\n\n#define ROUND_TO_INT(n) ((long long)floor(n))\n#define MIN(a,b) ((a)&lt;(b)?(a):(b))\n#define MAX(a,b) ((a)&gt;(b)?(a):(b))\n\nusing namespace std;\n\nclass Matrix {\n\nprivate:\n\n\n  /**\n  * Split a string following delimiters\n   */\n  void tokenize(const string&amp; str, vector&lt;string&gt;&amp; tokens, const string&amp; delimiters) {\n\n    // Skip delimiters at beginning.\n    string::size_type lastPos = str.find_first_not_of(delimiters, 0);\n    // Find first \"non-delimiter\".\n    string::size_type pos     = str.find_first_of(delimiters, lastPos);\n\n    while (string::npos != pos || string::npos != lastPos)\n    {\n      // Found a token, add it to the vector.\n      tokens.push_back(str.substr(lastPos, pos - lastPos));\n      // Skip delimiters.  Note the \"not_of\"\n      lastPos = str.find_first_not_of(delimiters, pos);\n      // Find next \"non-delimiter\"\n      pos = str.find_first_of(delimiters, lastPos);\n    }\n  }\n\n\npublic:\n\n\n  // used for efficiency tests\n  long long totalMapSize;\n  long long totalOp;\n\n  double ** mat; // the matrix as it is stored in the matrix file\n  int length;\n  double granularity; // the real granularity used, greater than 1\n  long long ** matInt; // the discrete matrix with offset\n  double errorMax;\n  long long *offsets; // offset of each column\n  long long offset; // sum of offsets\n  long long *minScoreColumn; // min discrete score at each column\n  long long *maxScoreColumn; // max discrete score at each column\n  long long *sum;\n  long long minScore;  // min total discrete score (normally 0)\n  long long maxScore;  // max total discrete score\n  long long scoreRange;  // score range = max - min + 1\n  long long *bestScore;\n  long long *worstScore;\n  double background[4];\n\n  Matrix() {\n    granularity = 1.0;\n    offset = 0;\n    background[0] = background[1] = background[2] = background[3] = 0.25;\n  }\n\n  Matrix(double pA, double pC, double pG, double pT) {\n    granularity = 1.0;\n    offset = 0;\n    background[0] = pA;\n    background[1] = pC;\n    background[2] = pG;\n    background[3] = pT;  \n  }\n\n  ~Matrix() {\n      for (int k = 0; k &lt; 4; k++ ) {\n        delete[] matInt[k];\n      }\n      delete[] matInt;\n      delete[] mat;\n      delete[] offsets;\n      delete[] minScoreColumn;\n      delete[] maxScoreColumn;\n      delete[] sum;\n      delete[] bestScore;\n      delete[] worstScore;\n  }\n\n\n  void toLogOddRatio () {\n    for (int p = 0; p &lt; length; p++) {\n      double sum = mat[0][p] + mat[1][p] + mat[2][p] + mat[3][p];\n      for (int k = 0; k &lt; 4; k++) {\n        mat[k][p] = log((mat[k][p] + 0.25) /(sum + 1)) - log (background[k]); \n      }\n    }\n  }\n\n  void toLog2OddRatio () {\n    for (int p = 0; p &lt; length; p++) {\n      double sum = mat[0][p] + mat[1][p] + mat[2][p] + mat[3][p];\n      for (int k = 0; k &lt; 4; k++) {\n        mat[k][p] = log2((mat[k][p] + 0.25) /(sum + 1)) - log2 (background[k]); \n      }\n    }\n  }\n\n  /**\n    * Transforms the initial matrix into an integer and offseted matrix.\n   */\n  void computesIntegerMatrix (double granularity, bool sortColumns = true);\n\n  // computes the complete score distribution between score min and max\n  void showDistrib (long long min, long long max) {\n    map&lt;long long, double&gt; *nbocc = calcDistribWithMapMinMax(min,max); \n    map&lt;long long, double&gt;::iterator iter;\n\n    // computes p values and stores them in nbocc[length] \n    double sum = 0;\n    map&lt;long long, double&gt;::reverse_iterator riter = nbocc[length-1].rbegin();\n    while (riter != nbocc[length-1].rend()) {\n      sum += riter-&gt;second;\n      nbocc[length][riter-&gt;first] = sum;\n      riter++;      \n    }\n\n    iter = nbocc[length].begin();\n    while (iter != nbocc[length].end() &amp;&amp; iter-&gt;first &lt;= max) {\n      //cout &lt;&lt; (((iter-&gt;first)-offset)/granularity) &lt;&lt; \" \" &lt;&lt; (iter-&gt;second) &lt;&lt; \" \" &lt;&lt; nbocc[length-1][iter-&gt;first] &lt;&lt; endl;\n      iter ++;\n    }\n  }\n\n  /**\n    * Computes the pvalue associated with the threshold score requestedScore.\n    */\n  void lookForPvalue (long long requestedScore, long long min, long long max, double *pmin, double *pmax);\n\n  /**\n    * Computes the score associated with the pvalue requestedPvalue.\n    */\n  long long lookForScore (long long min, long long max, double requestedPvalue, double *rpv, double *rppv);\n\n  /** \n    * Computes the distribution of scores between score min and max as the DP algrithm proceeds \n    * but instead of using a table we use a map to avoid computations for scores that cannot be reached\n    */\n  map&lt;long long, double&gt; *calcDistribWithMapMinMax (long long min, long long max); \n\n  void readMatrix (string matrix) {\n\n    vector&lt;string&gt; str;\n    tokenize(matrix, str, \" \\t|\");\n    this-&gt;length = 0;\n    this-&gt;length = str.size() / 4;\n    mat = new double*[4];\n    int idx = 0;\n\n    for (int j = 0; j &lt; 4; j++) {\n      this-&gt;mat[j] = new double[this-&gt;length];\n      for (int i = 0; i &lt; this-&gt;length; i++) {\n        mat[j][i] = atof(str.at(idx).data());\n        idx++;\n      }\n    }\n\n    str.clear();\n\n  }\n\n}; /* Matrix */\n\n#endif\n</code></pre>\n\n<p><strong>Matrix.cpp</strong></p>\n\n<pre><code>#include \"Matrix.h\"\n\n#define MEMORYCOUNT\n\nvoid Matrix::computesIntegerMatrix (double granularity, bool sortColumns) {\n  double minS = 0, maxS = 0;\n  double scoreRange;\n\n  // computes precision\n  for (int i = 0; i &lt; length; i++) {\n    double min = mat[0][i];\n    double max = min;\n    for (int k = 1; k &lt; 4; k++ )  {\n      min = ((min &lt; mat[k][i])?min:(mat[k][i]));\n      max = ((max &gt; mat[k][i])?max:(mat[k][i]));\n    }\n    minS += min;\n    maxS += max;\n  } \n\n  // score range\n  scoreRange = maxS - minS + 1;\n\n  if (granularity &gt; 1.0) {\n    this-&gt;granularity = granularity / scoreRange;\n  } else if (granularity &lt; 1.0) {\n    this-&gt;granularity = 1.0 / granularity;\n  } else {\n    this-&gt;granularity = 1.0;\n  }\n\n  matInt = new long long *[length];\n  for (int k = 0; k &lt; 4; k++ ) {\n    matInt[k] = new long long[length];\n    for (int p = 0 ; p &lt; length; p++) {\n      matInt[k][p] = ROUND_TO_INT((double)(mat[k][p]*this-&gt;granularity)); \n    }\n  }\n\n  this-&gt;errorMax = 0.0;\n  for (int i = 1; i &lt; length; i++) {\n    double maxE = mat[0][i] * this-&gt;granularity - (matInt[0][i]);\n    for (int k = 1; k &lt; 4; k++) {\n      maxE = ((maxE &lt; mat[k][i] * this-&gt;granularity - matInt[k][i])?(mat[k][i] * this-&gt;granularity - (matInt[k][i])):(maxE));\n    }\n    this-&gt;errorMax += maxE;\n  }\n\n  if (sortColumns) {\n    // sort the columns : the first column is the one with the greatest value\n    long long min = 0;\n    for (int i = 0; i &lt; length; i++) {\n      for (int k = 0; k &lt; 4; k++) {\n        min = MIN(min,matInt[k][i]);\n      }\n    }\n    min --;\n    long long *maxs = new long long [length];\n    for (int i = 0; i &lt; length; i++) {\n      maxs[i] = matInt[0][i];\n      for (int k = 1; k &lt; 4; k++) {\n        if (maxs[i] &lt; matInt[k][i]) {\n          maxs[i] = matInt[k][i];\n        }\n      }\n    }\n    long long **mattemp = new long long *[4];\n    for (int k = 0; k &lt; 4; k++) {        \n      mattemp[k] = new long long [length];\n    }\n    for (int i = 0; i &lt; length; i++) {\n      long long max = maxs[0];\n      int p = 0;\n      for (int j = 1; j &lt; length; j++) {\n        if (max &lt; maxs[j]) {\n          max = maxs[j];\n          p = j;\n        }\n      }\n      maxs[p] = min;\n      for (int k = 0; k &lt; 4; k++) {        \n        mattemp[k][i] = matInt[k][p];\n      }\n    }\n\n    for (int k = 0; k &lt; 4; k++)  {\n      for (int i = 0; i &lt; length; i++) {\n        matInt[k][i] = mattemp[k][i];\n      }\n    }\n\n    for (int k = 0; k &lt; 4; k++) {        \n      delete[] mattemp[k];\n    }\n    delete[] mattemp;\n    delete[] maxs;\n  }\n\n  // computes offsets\n  this-&gt;offset = 0;\n  offsets = new long long [length];\n  for (int i = 0; i &lt; length; i++) {\n    long long min = matInt[0][i];\n    for (int k = 1; k &lt; 4; k++ )  {\n      min = ((min &lt; matInt[k][i])?min:(matInt[k][i]));\n    }\n    offsets[i] = -min;\n    for (int k = 0; k &lt; 4; k++ )  {\n      matInt[k][i] += offsets[i];  \n    }\n    this-&gt;offset += offsets[i];\n  }\n\n  // look for the minimum score of the matrix for each column\n  minScoreColumn = new long long [length];\n  maxScoreColumn = new long long [length];\n  sum            = new long long [length];\n  minScore = 0;\n  maxScore = 0;\n  for (int i = 0; i &lt; length; i++) {\n    minScoreColumn[i] = matInt[0][i];\n    maxScoreColumn[i] = matInt[0][i];\n    sum[i] = 0;\n    for (int k = 1; k &lt; 4; k++ )  {\n      sum[i] = sum[i] + matInt[k][i];\n      if (minScoreColumn[i] &gt; matInt[k][i]) {\n        minScoreColumn[i] = matInt[k][i];\n      }\n      if (maxScoreColumn[i] &lt; matInt[k][i]) {\n        maxScoreColumn[i] = matInt[k][i];\n      }\n    }\n    minScore = minScore + minScoreColumn[i];\n    maxScore = maxScore + maxScoreColumn[i];\n    //cout &lt;&lt; \"minScoreColumn[\" &lt;&lt; i &lt;&lt; \"] = \" &lt;&lt; minScoreColumn[i] &lt;&lt; endl;\n    //cout &lt;&lt; \"maxScoreColumn[\" &lt;&lt; i &lt;&lt; \"] = \" &lt;&lt; maxScoreColumn[i] &lt;&lt; endl;\n  }\n  this-&gt;scoreRange = maxScore - minScore + 1;\n\n  bestScore = new long long[length];\n  worstScore = new long long[length];\n  bestScore[length-1] = maxScore;\n  worstScore[length-1] = minScore;\n  for (int i = length - 2; i &gt;= 0; i--) {\n    bestScore[i]  = bestScore[i+1]  - maxScoreColumn[i+1];\n    worstScore[i] = worstScore[i+1] - minScoreColumn[i+1];\n  }\n\n\n}\n\n\n\n\n/**\n* Computes the pvalue associated with the threshold score requestedScore.\n */\nvoid Matrix::lookForPvalue (long long requestedScore, long long min, long long max, double *pmin, double *pmax) {\n\n  map&lt;long long, double&gt; *nbocc = calcDistribWithMapMinMax(min,max); \n  map&lt;long long, double&gt;::iterator iter;\n\n\n  // computes p values and stores them in nbocc[length] \n  double sum = nbocc[length][max+1];\n  long long s = max + 1;\n  map&lt;long long, double&gt;::reverse_iterator riter = nbocc[length-1].rbegin();\n  while (riter != nbocc[length-1].rend()) {\n    sum += riter-&gt;second;\n    if (riter-&gt;first &gt;= requestedScore) s = riter-&gt;first;\n    nbocc[length][riter-&gt;first] = sum;\n    riter++;      \n  }\n  //cout &lt;&lt; \"   s found : \" &lt;&lt; s &lt;&lt; endl;\n\n  iter = nbocc[length].find(s);\n  while (iter != nbocc[length].begin() &amp;&amp; iter-&gt;first &gt;= s - errorMax) {\n    iter--;      \n  }\n  //cout &lt;&lt; \"   s - E found : \" &lt;&lt; iter-&gt;first &lt;&lt; endl;\n\n#ifdef MEMORYCOUNT\n  // for tests, store the number of memory bloc necessary\n  for (int pos = 0; pos &lt;= length; pos++) {\n    totalMapSize += nbocc[pos].size();\n  }\n#endif\n\n  *pmax = nbocc[length][s];\n  *pmin = iter-&gt;second;\n\n}\n\n\n\n/**\n* Computes the score associated with the pvalue requestedPvalue.\n */\nlong long Matrix::lookForScore (long long min, long long max, double requestedPvalue, double *rpv, double *rppv) {\n\n  map&lt;long long, double&gt; *nbocc = calcDistribWithMapMinMax(min,max); \n  map&lt;long long, double&gt;::iterator iter;\n\n  // computes p values and stores them in nbocc[length] \n  double sum = 0.0;\n  map&lt;long long, double&gt;::reverse_iterator riter = nbocc[length-1].rbegin();\n  long long alpha = riter-&gt;first+1;\n  long long alpha_E = alpha;\n  nbocc[length][alpha] = 0.0;\n  while (riter != nbocc[length-1].rend()) {\n    sum += riter-&gt;second;\n    nbocc[length][riter-&gt;first] = sum;\n    if (sum &gt;= requestedPvalue) { \n      break;\n    }\n    riter++;      \n  }\n  if (sum &gt; requestedPvalue) {\n    alpha_E = riter-&gt;first;\n    riter--;\n    alpha = riter-&gt;first; \n  } else {\n    if (riter == nbocc[length-1].rend()) { // path following the remark of the mail\n      riter--;\n      alpha = alpha_E = riter-&gt;first;\n    } else {\n      alpha = riter-&gt;first;\n      riter++;\n      sum += riter-&gt;second;\n      alpha_E = riter-&gt;first;\n    }\n    nbocc[length][alpha_E] = sum;  \n    //cout &lt;&lt; \"Pv(S) \" &lt;&lt; riter-&gt;first &lt;&lt; \" \" &lt;&lt; sum &lt;&lt; endl;   \n  } \n\n#ifdef MEMORYCOUNT\n  // for tests, store the number of memory bloc necessary\n  for (int pos = 0; pos &lt;= length; pos++) {\n    totalMapSize += nbocc[pos].size();\n  }\n#endif\n\n  if (alpha - alpha_E &gt; errorMax) alpha_E = alpha;\n\n  *rpv = nbocc[length][alpha];\n  *rppv = nbocc[length][alpha_E];   \n\n  delete[] nbocc;\n  return alpha;\n\n}\n\n\n// computes the distribution of scores between score min and max as the DP algrithm proceeds \n// but instead of using a table we use a map to avoid computations for scores that cannot be reached\nmap&lt;long long, double&gt; *Matrix::calcDistribWithMapMinMax (long long min, long long max) { \n\n  // maps for each step of the computation\n  // nbocc[length] stores the pvalue\n  // nbocc[pos] for pos &lt; length stores the qvalue\n  map&lt;long long, double&gt; *nbocc = new map&lt;long long, double&gt; [length+1];\n  map&lt;long long, double&gt;::iterator iter;\n\n  long long *maxs = new long long[length+1]; // @ pos i maximum score reachable with the suffix matrix from i to length-1\n\n  maxs[length] = 0;\n  for (int i = length-1; i &gt;= 0; i--) {\n    maxs[i] = maxs[i+1] + maxScoreColumn[i];\n  }\n\n  // initializes the map at position 0\n  for (int k = 0; k &lt; 4; k++) {\n    if (matInt[k][0]+maxs[1] &gt;= min) {\n      nbocc[0][matInt[k][0]] += background[k];\n    }\n  }\n\n  // computes q values for scores greater or equal than min\n  nbocc[length-1][max+1] = 0.0;\n  for (int pos = 1; pos &lt; length; pos++) {\n    iter = nbocc[pos-1].begin();\n    while (iter != nbocc[pos-1].end()) {\n      for (int k = 0; k &lt; 4; k++) {\n        long long sc = iter-&gt;first + matInt[k][pos];\n        if (sc+maxs[pos+1] &gt;= min) {\n          // the score min can be reached\n          if (sc &gt; max) {\n            // the score will be greater than max for all suffixes\n            nbocc[length-1][max+1] += nbocc[pos-1][iter-&gt;first] * background[k]; //pow(4,length-pos-1) ;\n            totalOp++;\n          } else {              \n            nbocc[pos][sc] += nbocc[pos-1][iter-&gt;first] * background[k];\n            totalOp++;\n          }\n        } \n      }\n      iter++;      \n    }      \n    //cerr &lt;&lt; \"        map size for \" &lt;&lt; pos &lt;&lt; \" \" &lt;&lt; nbocc[pos].size() &lt;&lt; endl;\n  }\n\n  delete[] maxs;\n\n  return nbocc;\n\n\n}\n</code></pre>\n\n<p><strong>pytfmpval.i</strong></p>\n\n<pre><code>%module pytfmpval\n%{\n#include \"../src/Matrix.h\"\n#define SWIG_FILE_WITH_INIT\n%}\n\n%include \"cpointer.i\"\n%include \"std_string.i\"\n%include \"std_vector.i\"\n%include \"typemaps.i\"\n%include \"../src/Matrix.h\"\n\n%pointer_class(double, doublep)\n%pointer_class(int, intp)\n\n%nodefaultdtor Matrix;\n</code></pre>\n\n<p>The <code>c++</code> functions are called in a <code>python</code> module.</p>\n\n<hr>\n\n<p>I worry that <code>nbocc</code> in <code>Matrix.cpp</code> is not being properly dereferenced or deleted. <strong>Is this use valid?</strong> </p>\n\n<p>I have tried using <code>gc.collect()</code> and I am using the <code>multiprocessing</code> module as recommended in this <a href=\"https://stackoverflow.com/questions/15455048/releasing-memory-in-python\">question</a> to call these functions from my python program. I've also tried deleting the <code>Matrix</code> object from within python to no avail. </p>\n\n<p>I'm out of characters, but will provide any additional needed info in the comments as well as I can.</p>\n\n<p><strong>UPDATE</strong>: I've removed all of the python code, as it wasn't the issue and made for an absurdly long post. As I stated in the comments below, this was ultimately solved by taking the suggestion of many users and creating a <strong>minimal example</strong> that exhibited the issue in pure C++. I then used <code>valgrind</code> to identify the problematic pointers created with <code>new</code> and made sure that they were properly dereferenced. This fixed <em>almost</em> all memory leaks. One remains, but it leaks only a few hundred bytes over thousands of iterations and would require refactoring the entire <code>Matrix</code> class, which simply isn't worth the time for what it is. Bad practice, I know. To any other newbie in C++ out there, seriously try to avoid dynamic memory allocation or utilize <code>std::unique_ptr</code> or <code>std::shared_ptr</code>.</p>\n\n<p>Thanks again to everyone who provided input and suggestions.</p>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499287050, "post_id": 44935498, "comment_id": 76847304, "body": "You say your library is static, but you have a dll. Check the file size of openexr.lib, if it&#39;s tiny then it&#39;s just the stub for the dynamic library linking. It REALLY looks like you are dealing with a dynamic library."}, {"owner": {"reputation": 1122, "user_id": 1394922, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/dbc3851e1aa347c35ae22b2d9650d647?s=128&d=identicon&r=PG", "display_name": "andyopayne", "link": "https://stackoverflow.com/users/1394922/andyopayne"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499287247, "post_id": 44935498, "comment_id": 76847406, "body": "Yes, you&#39;re right.  The openexr.lib file is 753kb and the openexr.dll is 7.6mb.  So, if that&#39;s the case, what do I need to change to get it to link properly?  I thought I could still link to the .lib file and that it would know to then find the .dll upon compile time."}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499287503, "post_id": 44935498, "comment_id": 76847540, "body": "Dynamic vs static linking is something that&#39;s determined when you build the library iteself, not in how you use it. You need to revisit how openexr is compiled and change its linking settings to be static."}, {"owner": {"reputation": 1122, "user_id": 1394922, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/dbc3851e1aa347c35ae22b2d9650d647?s=128&d=identicon&r=PG", "display_name": "andyopayne", "link": "https://stackoverflow.com/users/1394922/andyopayne"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499288230, "post_id": 44935498, "comment_id": 76847922, "body": "Ok. So, I went back and re-compiled and made sure I was compiling a static library.  Now, I have an openexr.lib file that is approximately 64mb.  Also, there is no .dll now... so I only have a lib to link to.  However, I&#39;m still running into the same issue when I go to try to build my Demo.exe file which links to that static library."}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499288645, "post_id": 44935498, "comment_id": 76848122, "body": "If you could provide us with a bit more of your error log, there might be a hint in there."}, {"owner": {"reputation": 1122, "user_id": 1394922, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/dbc3851e1aa347c35ae22b2d9650d647?s=128&d=identicon&r=PG", "display_name": "andyopayne", "link": "https://stackoverflow.com/users/1394922/andyopayne"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499288748, "post_id": 44935498, "comment_id": 76848173, "body": "Also... if I add the .lib extension to the end of the line where I set the target properties (as in the code above) then I get the 78 linker errors.  However, if I remove the .lib extension and just end it in <code>${CMAKE_CURRENT_SOURCE_DIR}&#47;libraries&#47;openexr</code> then I still get an error when I build the executable... but now it says <code>LINK : fatal error LNK1104: cannot open file &#39;..\\libraries\\openexr.obj&#39;</code> but I do not get the 78 linker errors as before."}, {"owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "edited": false, "score": 0, "creation_date": 1499289160, "post_id": 44935498, "comment_id": 76848341, "body": "Check file/folder permissions of your lib folder and the library"}, {"owner": {"reputation": 1122, "user_id": 1394922, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/dbc3851e1aa347c35ae22b2d9650d647?s=128&d=identicon&r=PG", "display_name": "andyopayne", "link": "https://stackoverflow.com/users/1394922/andyopayne"}, "edited": false, "score": 0, "creation_date": 1499289587, "post_id": 44935498, "comment_id": 76848534, "body": "I attached the full error_log.txt file above in the original question. Also, the libraries folder nor the file seem to have anything out of the ordinary about their permissions. The folder has inherited &#39;Read-Only&#39; permission.  But, the openexr.lib file doesn&#39;t have &#39;Read-Only&#39; or &#39;Hidden&#39; attributes checked."}], "owner": {"reputation": 1122, "user_id": 1394922, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/dbc3851e1aa347c35ae22b2d9650d647?s=128&d=identicon&r=PG", "display_name": "andyopayne", "link": "https://stackoverflow.com/users/1394922/andyopayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 662, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499289232, "creation_date": 1499286723, "last_edit_date": 1499289232, "question_id": 44935498, "link": "https://stackoverflow.com/questions/44935498/cmake-not-linking-static-library", "title": "CMake not linking static library", "body": "<p>I have a static library (openexr.lib) that was compiled in debug mode.  I'm trying to link this library to a project I've created using CMake. Here's my folder structure.</p>\n\n<pre><code>+-- myproject\n|   +-- Demo\n|       +-- build\n|       +-- libraries\n|           +-- openexr.lib\n|       +-- cmake\n|           +-- GenerateVS2015.bat\n|       +-- CMakeLists.txt\n|       +-- Demo.cpp\n|       +-- stdafx.cpp\n</code></pre>\n\n<p>So, you can see that I have the <strong><em>openexr.lib</em></strong> located in the libraries directory. I have verified that this .lib file has been compiled as a static library and the file size is approximately 64mb. Then, I have a batch file which is found in the cmake directory which tries to build the projects.  Here's what my batch script looks like.</p>\n\n<pre><code>@echo off\nset startingDir=%CD%\nset basepath=%~dp0\nset builddir=%basepath%\\..\\build\nif exist %builddir% (@RD /S /Q %builddir%)\nmkdir %builddir%\ncd %builddir%\ncmake -G \"Visual Studio 14 2015 Win64\" .. %*\ncd %startingDir%\n</code></pre>\n\n<p>So, this basically creates the build directory if it doesn't already exist (otherwise it clears it so it can repopulate everything).  Then, it calls the cmake command with the visual studio generator option.</p>\n\n<p>Now, here's what's in my CMakeLists.txt file:</p>\n\n<pre><code>CMAKE_MINIMUM_REQUIRED (VERSION 2.8)\nPROJECT (MyProject)\n\nIF (\"${CMAKE_CXX_COMPILER_ID}\" STREQUAL \"MSVC\")\n  ADD_DEFINITIONS(-DBUILD_DLL)\n  SET(CMAKE_SHARED_LINKER_FLAGS \"${CMAKE_SHARED_LINKER_FLAGS} xmllite.lib\")\n  string(REGEX REPLACE \"/bin/[^/]*$\" \"\" VCINSTALLDIR \"${CMAKE_C_COMPILER}\")\n  message(STATUS \"Guessed MSVC directory: ${VCINSTALLDIR}\")\nENDIF()\n\nADD_LIBRARY(openexr STATIC IMPORTED GLOBAL)\nSET_TARGET_PROPERTIES(openexr PROPERTIES IMPORTED_LOCATION ${CMAKE_CURRENT_SOURCE_DIR}/libraries/openexr.lib)\n\nADD_EXECUTABLE(MyDemo ${CMAKE_CURRENT_SOURCE_DIR}/Demo.cpp ${CMAKE_CURRENT_SOURCE_DIR}/stdafx.cpp)\nTARGET_LINK_LIBRARIES(MyDemo openexr)\n</code></pre>\n\n<p>When I run my batch file, it generates the MyDemo.vcxproj file correctly.  I can see it's setup to compile with the target extension .exe (which is what I want).  But, when I try to build the project, I get the following error message:</p>\n\n<pre><code>C:\\myproject\\build\\Debug\\MyDemo.exe : fatal error LNK1120: 78 unresolved externals\n</code></pre>\n\n<p>If I open up the property pages for my demo project, I can see that under the Linker section that is trying to link to my openexr.lib file. </p>\n\n<p><a href=\"https://i.stack.imgur.com/uMnjL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uMnjL.png\" alt=\"LINKER\"></a></p>\n\n<p>But, for some reason it continues to fail every time I try to build the executable file.  Can anyone provide a reason why?</p>\n\n<p><strong>EDIT</strong>\nHere is a link to the full error log in case it helps: <a href=\"https://dl.dropboxusercontent.com/u/22255624/error_log.txt\" rel=\"nofollow noreferrer\">errorlog.txt</a></p>\n"}, {"tags": ["c++", "winapi", "createfile"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 4, "creation_date": 1499286475, "post_id": 44935386, "comment_id": 76847023, "body": "If this is in Visual Studio the default folder (unless you changed the <code>Working Directory</code> setting in debug settings) is not the same as the executable. It will be same folder as the project."}, {"owner": {"reputation": 49, "user_id": 8261397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf59ac33f7ea49acc505d855e20d73cf?s=128&d=identicon&r=PG&f=1", "display_name": "plowed", "link": "https://stackoverflow.com/users/8261397/plowed"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1499286589, "post_id": 44935386, "comment_id": 76847072, "body": "Hello, I launch the .exe myself by double clicking on it in the folder &quot;Release&quot;."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 5, "creation_date": 1499286629, "post_id": 44935386, "comment_id": 76847095, "body": "Maybe your file has two .txt extensions. Windows adds confusion by hiding extensions. You may actually have <code>test.txt.txt</code> when you wanted <code>test.txt</code>"}, {"owner": {"reputation": 49, "user_id": 8261397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf59ac33f7ea49acc505d855e20d73cf?s=128&d=identicon&r=PG&f=1", "display_name": "plowed", "link": "https://stackoverflow.com/users/8261397/plowed"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1499286857, "post_id": 44935386, "comment_id": 76847208, "body": "I dont know if i am stupid or you are a genius, but thank you this is the exact problem..."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1499286868, "post_id": 44935386, "comment_id": 76847211, "body": "Please learn about a programs <i>current working directory</i> (<code>getcwd()</code> is useful) and how to change it (<code>chdir()</code> for example)."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1499286901, "post_id": 44935386, "comment_id": 76847232, "body": "My advice is to disable the &quot;Hide Extensions for known types&quot; in your view settings for explorer. This is one of the first things I always do when setting up a new windows box."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1499286995, "post_id": 44935386, "comment_id": 76847276, "body": "<b><i>if i am stupid or you are a genius, but thank you this is the exact problem</i></b> This is a reasonably common issue here. I have seen it dozens of times."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1499289991, "post_id": 44935386, "comment_id": 76848746, "body": "@JesperJuhl: The only thing you need to know about the current working directory is to not ever use it. As a per-process property it is unreliable, and generally not under your control."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1499290551, "post_id": 44935386, "comment_id": 76848992, "body": "@IInspectable it&#39;s completely reliable if your program makes sure to always change it to what it needs to be as its first order of business."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1499290844, "post_id": 44935386, "comment_id": 76849117, "body": "@JesperJuhl: How do you control a per-process property in a multi-threaded environment, where you don&#39;t even control creation of all threads?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1499291334, "post_id": 44935386, "comment_id": 76849338, "body": "@JesperJuhl: Or the fact that some system APIs, like dialogs, also can change the CWD.  Best to NEVER rely on relative paths, ALWAYS use absolute paths."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1499291732, "post_id": 44935386, "comment_id": 76849483, "body": "@IInspectable who said anything about the program being multithreaded?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1499291877, "post_id": 44935386, "comment_id": 76849552, "body": "@Remy Lebeau: sure CWD can change, but that&#39;s checkable. In any case, I (personally) prefer to always use paths relative to the location of my executable."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1499292058, "post_id": 44935386, "comment_id": 76849632, "body": "@JesperJuhl: Then you are not actually using <i>true</i> relative paths (paths relative to the CWD, as demonstrated in the OP&#39;s question), you are actually using absolute paths that just <i>happen</i> to use the EXE path as their prefix."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1499292220, "post_id": 44935386, "comment_id": 76849708, "body": "@Remy Lebeau I know. That bit was not meant to be in relation to OPs question - just me stating my personal preference."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1499323237, "post_id": 44935386, "comment_id": 76858677, "body": "@JesperJuhl: Always expect an application on Windows to be multi-threaded. The OS will create threads, and you have no control over this. Again, you cannot reliably use the current working directory in a Windows application. And there is no reason to rely on it either. If you believe otherwise, please provide a convincing use-case, for which there is no other solution."}], "owner": {"reputation": 49, "user_id": 8261397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf59ac33f7ea49acc505d855e20d73cf?s=128&d=identicon&r=PG&f=1", "display_name": "plowed", "link": "https://stackoverflow.com/users/8261397/plowed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 711, "favorite_count": 1, "closed_date": 1499291537, "answer_count": 0, "score": 4, "last_activity_date": 1499332962, "creation_date": 1499286313, "last_edit_date": 1499332962, "question_id": 44935386, "link": "https://stackoverflow.com/questions/44935386/c-createfile-does-not-found-txt-file-in-same-folder-as-exe", "closed_reason": "Not suitable for this site", "title": "C++ CreateFile does not found .txt file in same folder as .exe", "body": "<p>I'm trying to use <code>CreateFile</code> function, but it does not go as planned.</p>\n\n<p>I did a simple test code :</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;iostream&gt;\n#include &lt;tchar.h&gt;\n\nusing namespace std;\n\nint main() {\n    HANDLE hFile;\n    hFile = CreateFile(_T(\"test.txt\"), GENERIC_READ, NULL, NULL, OPEN_EXISTING, NULL, NULL);\n    if (hFile == INVALID_HANDLE_VALUE) {\n        cout &lt;&lt; GetLastError() &lt;&lt; endl;\n        Sleep(2000);\n        return EXIT_FAILURE;\n    }\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I generate the <code>.exe</code> and place a file <code>test.txt</code> in the same folder.</p>\n\n<p>When I execute the <code>.exe</code> I get <code>getLastError() = 2</code> which means <code>ERROR_FILE_NOT_FOUND</code></p>\n\n<p>How is it even possible?</p>\n"}, {"tags": ["c++", "hash", "hashtable"], "comments": [{"owner": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 0, "creation_date": 1499286314, "post_id": 44935362, "comment_id": 76846941, "body": "Yes, <code>std::map&lt;key, value&gt;</code>"}, {"owner": {"reputation": 1499, "user_id": 3508551, "user_type": "registered", "accept_rate": 37, "profile_image": "https://graph.facebook.com/100000637329350/picture?type=large", "display_name": "AspiringMat", "link": "https://stackoverflow.com/users/3508551/aspiringmat"}, "reply_to_user": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 0, "creation_date": 1499286391, "post_id": 44935362, "comment_id": 76846984, "body": "@Kyle Khalaf I am not sure what you mean. How would I use <code>std::map</code> as a hashing function?"}, {"owner": {"reputation": 1499, "user_id": 3508551, "user_type": "registered", "accept_rate": 37, "profile_image": "https://graph.facebook.com/100000637329350/picture?type=large", "display_name": "AspiringMat", "link": "https://stackoverflow.com/users/3508551/aspiringmat"}, "reply_to_user": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 0, "creation_date": 1499286470, "post_id": 44935362, "comment_id": 76847020, "body": "My main problem is actually generating the corresponding key. Each value should be 1) relatively small and 2) prime."}, {"owner": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 0, "creation_date": 1499286644, "post_id": 44935362, "comment_id": 76847099, "body": "You will do something like <code>int main () {   std::map&lt;char,int&gt; MyMap;    MyMap[&#39;a&#39;]=2;   MyMap[&#39;b&#39;]=3;   MyMap[&#39;c&#39;]=4;   MyMap[&#39;d&#39;]=7;   &#47;&#47; ...  }</code> where <code>a</code> (or any char) can&#39;t exist twice"}, {"owner": {"reputation": 1499, "user_id": 3508551, "user_type": "registered", "accept_rate": 37, "profile_image": "https://graph.facebook.com/100000637329350/picture?type=large", "display_name": "AspiringMat", "link": "https://stackoverflow.com/users/3508551/aspiringmat"}, "reply_to_user": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 0, "creation_date": 1499286810, "post_id": 44935362, "comment_id": 76847185, "body": "@KyleKhalaf I understand that, however, I don&#39;t want to generate the 26 prime numbers manually. I am hoping there is a hashing function out there (such as std::hash) where hash(&#39;a&#39;)=2, hash(&#39;b&#39;)=3, hash(&#39;c&#39;)=5 so that I can assign the values automatically rather than writing it on 26 different lines"}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 1, "creation_date": 1499287234, "post_id": 44935362, "comment_id": 76847401, "body": "The result of <code>hash</code> is not necessarily a prime number. If the only problem you have with <code>hash</code> is that the numbers are large, do you need them to be primes at all?"}, {"owner": {"reputation": 1499, "user_id": 3508551, "user_type": "registered", "accept_rate": 37, "profile_image": "https://graph.facebook.com/100000637329350/picture?type=large", "display_name": "AspiringMat", "link": "https://stackoverflow.com/users/3508551/aspiringmat"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1499287334, "post_id": 44935362, "comment_id": 76847450, "body": "@anatolyg If the numbers generated have a small probability of being the same, then being prime is not an issue. However, the numbers must be smaller than what <code>hash</code> gives."}], "answers": [{"comments": [{"owner": {"reputation": 1499, "user_id": 3508551, "user_type": "registered", "accept_rate": 37, "profile_image": "https://graph.facebook.com/100000637329350/picture?type=large", "display_name": "AspiringMat", "link": "https://stackoverflow.com/users/3508551/aspiringmat"}, "edited": false, "score": 0, "creation_date": 1499286906, "post_id": 44935510, "comment_id": 76847238, "body": "I understand. I am just asking if there is any hashing function in the standard library that hashes automatically to small prime numbers, rather than me actually implementing the entire hashing function"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 1499, "user_id": 3508551, "user_type": "registered", "accept_rate": 37, "profile_image": "https://graph.facebook.com/100000637329350/picture?type=large", "display_name": "AspiringMat", "link": "https://stackoverflow.com/users/3508551/aspiringmat"}, "edited": false, "score": 2, "creation_date": 1499286975, "post_id": 44935510, "comment_id": 76847265, "body": "@AspiringMat: No, because that&#39;s not what hash functions do. And I don&#39;t know of anything in the C++ standard library that deals with primes, except maybe the RNGs."}, {"owner": {"reputation": 1499, "user_id": 3508551, "user_type": "registered", "accept_rate": 37, "profile_image": "https://graph.facebook.com/100000637329350/picture?type=large", "display_name": "AspiringMat", "link": "https://stackoverflow.com/users/3508551/aspiringmat"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1499287215, "post_id": 44935510, "comment_id": 76847392, "body": "@MooingDuck Thank you, that was just basically my question. I wanted a built in function that hashes a character to a prime automatically which is why I ask the question."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 1499, "user_id": 3508551, "user_type": "registered", "accept_rate": 37, "profile_image": "https://graph.facebook.com/100000637329350/picture?type=large", "display_name": "AspiringMat", "link": "https://stackoverflow.com/users/3508551/aspiringmat"}, "edited": false, "score": 2, "creation_date": 1499287522, "post_id": 44935510, "comment_id": 76847553, "body": "@AspiringMat You seem to somewhat misuse the work &#39;hash&#39;. By definition, hashing function is a function which takes an input of arbitary length and produces an output of fixed length out of it. Your function receives input of fixed length, thus it&#39;s not a hash."}], "tags": [], "owner": {"reputation": 893, "user_id": 4204413, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wkXjz.png?s=128&g=1", "display_name": "TimD1", "link": "https://stackoverflow.com/users/4204413/timd1"}, "is_accepted": false, "score": 6, "last_activity_date": 1499287032, "last_edit_date": 1499287032, "creation_date": 1499286774, "answer_id": 44935510, "question_id": 44935362, "link": "https://stackoverflow.com/questions/44935362/how-to-hash-a-single-char-to-a-relatively-small-prime-in-c/44935510#44935510", "title": "How to hash a single char to a relatively small prime in C++?", "body": "<p>I would just store the first 26 primes in a <code>std::vector</code> called <code>primes</code>, and then if you have character <code>c</code>, simply access the correct prime using <code>primes[c-'a']</code>.</p>\n"}], "owner": {"reputation": 1499, "user_id": 3508551, "user_type": "registered", "accept_rate": 37, "profile_image": "https://graph.facebook.com/100000637329350/picture?type=large", "display_name": "AspiringMat", "link": "https://stackoverflow.com/users/3508551/aspiringmat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 1, "answer_count": 1, "score": -4, "last_activity_date": 1499287032, "creation_date": 1499286243, "question_id": 44935362, "link": "https://stackoverflow.com/questions/44935362/how-to-hash-a-single-char-to-a-relatively-small-prime-in-c", "title": "How to hash a single char to a relatively small prime in C++?", "body": "<p>I am interested in hashing the alphabet letters to different prime numbers which are relatively small. For example,  <code>a-&gt;2,b-&gt;3, c-&gt;5, d-&gt;7, ...</code>. Since I will be multiplying/dividing hashes of several characters. </p>\n\n<p>I tried <code>std::hash</code>, however, it hashes characters to very large integers and it causes overflows if I multiply/divide, is there an easier way to do this?</p>\n\n<p>One possible way I though of is to use the Sieve of Eratosthenes to generate the first bunch of primes then use a <code>std::unordered_map</code> to store <code>char,int</code> pairs. <strong>However, is there any ready made hashing function in the standard library that would suit my needs?</strong> </p>\n"}, {"tags": ["c++", "oop", "constants", "encapsulation", "getter"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1499285533, "post_id": 44935159, "comment_id": 76846474, "body": "Generally compilers can optimize better if they can assume data won&#39;t change (<code>mutable</code> notwithstanding)"}, {"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 8, "creation_date": 1499285551, "post_id": 44935159, "comment_id": 76846483, "body": "Well for one if you have a <code>const</code> reference or an instance of the type you won&#39;t be able to invoke the non-const members."}, {"owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1499285650, "post_id": 44935159, "comment_id": 76846548, "body": "@AndyG, true, but beside the point; I&#39;m asking from an OOP best practice perspective. @Captain Oblivious, doesn&#39;t speak to the question; why then not remove the <code>const</code> references from the other objects?"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1499285681, "post_id": 44935159, "comment_id": 76846575, "body": "Think about the violations of assumptions and how impactful they could be if down the road you suddenly stopped promising that <code>getBrand</code> wouldn&#39;t change any data, but had no way of indicating as much"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1499285696, "post_id": 44935159, "comment_id": 76846580, "body": "@kmiklas If you had <code>const Cheese cheddar(&quot;Cabot clothbound&quot;);</code> How would you get information if the getters are not <code>const</code>?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1499285801, "post_id": 44935159, "comment_id": 76846642, "body": "Also, if you mark a member as <code>mutable</code> it can be changed inside a <code>const</code> function.  This is required for things like mutexs where you might need to lock it in the function for thread safety."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1499285984, "post_id": 44935159, "comment_id": 76846760, "body": "@AndyG, compilers cannot optimize better based only on <code>const</code> annotations because <code>const_cast</code> is not UB. Compilers that figure out that a value is never mutated would be able to figure it out regardless of whether <code>const</code> was used."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 4, "creation_date": 1499286140, "post_id": 44935159, "comment_id": 76846848, "body": "<code>Const</code> is a tool for developers, not compilers. If you hate const correctness, you don&#39;t have to use it, but there is a wide consensus that it&#39;s one very fine feature of C++. Without <code>const</code> at the end of your <code>getBrand</code> method, you wouldn&#39;t be able to get the brand off of a <code>const Cheese</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1499286265, "post_id": 44935159, "comment_id": 76846915, "body": "It is not about an evil user that will steal your data."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1499286273, "post_id": 44935159, "comment_id": 76846919, "body": "@zneak <code>const_cast</code> is not UB, but writing to a variable you&#39;ve <code>const_cast</code>ed generally is. Also, I think <a href=\"https://youtu.be/zBkNBP00wJE?t=1665\" rel=\"nofollow noreferrer\">this video from Jason Turner</a> was pretty enlightening about the performance benefits of marking <code>const</code> (I&#39;ve marked it at the appropriate time. Turns out it <i>did</i> need the <code>const</code> keyword)"}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1499286674, "post_id": 44935159, "comment_id": 76847120, "body": "@AndyG, it&#39;s only UB if the object was originally declared <code>const</code>, which cover a vanishingly small portion of all the objects used in any non-trivial program. In practice, that&#39;s almost only ever the case for global variables. Notice that you benefit from marking global variables <code>const</code>, and not from telling the compiler that you&#39;re using <code>const</code> methods to manipulate them (although that&#39;s kind of an unavoidable side effect)."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1499287809, "post_id": 44935159, "comment_id": 76847703, "body": "@AndyG, to illustrate the point, see <a href=\"https://godbolt.org/g/nvQjgV\" rel=\"nofollow noreferrer\">this example</a>. The compiler is able to determine that the argument to <code>square</code> is constant and it passes 16 directly to <code>printf</code> (<code>mov esi, 16</code>). When the compiler can&#39;t tell that the object was declared <code>const</code> in the first place, like <a href=\"https://godbolt.org/g/TtjCPd\" rel=\"nofollow noreferrer\">in this example</a>, the optimization can&#39;t happen and you get the runtime multiplication with two loads from the same reference. It has to do so because it can&#39;t be sure that <code>kill_aa</code> doesn&#39;t modify the reference, despite it being <code>const</code>."}], "answers": [{"tags": [], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "is_accepted": false, "score": 10, "last_activity_date": 1499287181, "last_edit_date": 1499287181, "creation_date": 1499285831, "answer_id": 44935242, "question_id": 44935159, "link": "https://stackoverflow.com/questions/44935159/why-must-accessor-functions-be-const-where-is-the-vulnerability/44935242#44935242", "title": "Why must accessor functions be const? Where is the vulnerability?", "body": "<p>It's actually very simple: If the method is not const, you would not be able to use it on <code>const</code> objects - but you do want to be able to use it. With your class, you can't implement</p>\n\n<pre><code>void print_brand(const Cheese&amp; cheese);\n</code></pre>\n\n<p>(unless you const-cast, which you shouldn't do).</p>\n\n<p>Also, if you do make it const, instead of returning a copy of your string - which may or may not get optimized away, you could implement:</p>\n\n<pre><code>const std::string&amp; getBrand() const { return brand_; }\n</code></pre>\n\n<p>which returns a reference, or perhaps</p>\n\n<pre><code>std::string_view getBrand() const { return brand_; }\n</code></pre>\n\n<p>that does not \"commit\" your API to the string class (read about <code>string_view</code> <a href=\"http://en.cppreference.com/w/cpp/string/basic_string_view\" rel=\"nofollow noreferrer\">here</a>; it was only officially added to the language in C++17, but is available as <code>std::experimental::string_view</code> with recent compilers).</p>\n"}, {"comments": [{"owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "edited": false, "score": 0, "creation_date": 1499287185, "post_id": 44935339, "comment_id": 76847376, "body": "Here you reiterate exactly what all my professors, associates, and textbooks have said: &quot;you should use only method with keyword const.&quot; The question is not <b>when</b> <code>const</code> should be used, but <b>why</b>?"}], "tags": [], "owner": {"reputation": 1515, "user_id": 6615552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/952cbb61ab387e04b000590e294c9fe8?s=128&d=identicon&r=PG&f=1", "display_name": "21koizyd", "link": "https://stackoverflow.com/users/6615552/21koizyd"}, "is_accepted": false, "score": 1, "last_activity_date": 1499287931, "last_edit_date": 1499287931, "creation_date": 1499286158, "answer_id": 44935339, "question_id": 44935159, "link": "https://stackoverflow.com/questions/44935159/why-must-accessor-functions-be-const-where-is-the-vulnerability/44935339#44935339", "title": "Why must accessor functions be const? Where is the vulnerability?", "body": "<p>Function with keyword <code>const</code> guarantee that use her, don't change object which was given. So if you want give to print object to some function or especially to <code>operator&lt;&lt;</code> outside class you should use only method with keyword <code>const</code>.</p>\n\n<pre><code>std::ostream &amp;operator&lt;&lt;(std::ostream&amp; str, const Object&amp; obj)\n{\n    return str &lt;&lt; obj.someFunctionConst() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>function with error (compile error)</p>\n\n<pre><code>std::ostream &amp;operator&lt;&lt;(std::ostream&amp; str, const Object&amp; obj)\n{\n     return str &lt;&lt; obj.someFunctionWithoutConst() &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "is_accepted": false, "score": 2, "last_activity_date": 1499286177, "creation_date": 1499286177, "answer_id": 44935345, "question_id": 44935159, "link": "https://stackoverflow.com/questions/44935159/why-must-accessor-functions-be-const-where-is-the-vulnerability/44935345#44935345", "title": "Why must accessor functions be const? Where is the vulnerability?", "body": "<p><em>Strictly speaking</em> the method you've written doesn't mutate class members. If you marked it <code>const</code> the compiler completely prevents it from mutating members. But let's dig a little deeper here.</p>\n\n<p>Typically you write code once but read/review it many times. Marking a method <code>const</code> allows future readers to look at it and <em>instantly know</em> that the method can't change the class state because the compiler would catch it. For example if you accidentally write <code>size_t empty() const { return size_ = 0; }</code> (where <code>size_</code> is a member variable) the compiler will catch your typo. If you hadn't marked the method const you would have a subtle bug.</p>\n\n<p>But more importantly, <code>const</code> methods can only call other <code>const</code> methods. Consider if you have a method that takes the class state as input, does a bunch of work and returns a result. If the <code>getter</code> methods it uses to do its work are non-const then the long, complicated method <em>also</em> has to be non-const which then makes code comprehension <em>much</em> harder.</p>\n"}, {"comments": [{"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1499286651, "post_id": 44935457, "comment_id": 76847101, "body": "I wouldn&#39;t say that&#39;s the main reason, but definitely worth a +1. I remember the pain of realizing methods don&#39;t do what they claim to do..."}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 3, "last_activity_date": 1499286570, "creation_date": 1499286570, "answer_id": 44935457, "question_id": 44935159, "link": "https://stackoverflow.com/questions/44935159/why-must-accessor-functions-be-const-where-is-the-vulnerability/44935457#44935457", "title": "Why must accessor functions be const? Where is the vulnerability?", "body": "<blockquote>\n  <p>where is the vulnerability?</p>\n</blockquote>\n\n<p>The answer is that function names can lie, but interfaces containing references to const cannot.</p>\n\n<p>example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\n// this function name lies\nvoid i_wont_touch_your_cheese(std::string&amp; s)\n{\n    // uh-oh - I lied!\n    s = \"lol, I touched your cheese!\";    \n}\n\n// this one cannot. The compiler won't allow it\nvoid i_really_wont_touch_your_cheese(const std::string&amp; s)\n{\n    // compiler error here!\n    // cheese is safe\n    s = \"lol, I touched your cheese!\";    \n}\n\nint main() {\n    auto cheese = std::string(\"untouched cheese\");\n    i_wont_touch_your_cheese(cheese);\n    std::cout &lt;&lt; cheese &lt;&lt; std::endl;\n\n    cheese = \"more untouched cheese\";\n    i_really_wont_touch_your_cheese(cheese);\n    std::cout &lt;&lt; cheese &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1515, "user_id": 6615552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/952cbb61ab387e04b000590e294c9fe8?s=128&d=identicon&r=PG&f=1", "display_name": "21koizyd", "link": "https://stackoverflow.com/users/6615552/21koizyd"}, "edited": false, "score": 0, "creation_date": 1499287598, "post_id": 44935622, "comment_id": 76847589, "body": "I see too, that it&#39;s not good idea give some parameters by <code>const &amp;</code> because you can miss <code>const</code> ~architect software ( it&#39;s slopped allusion to <code>mutable</code>)"}], "tags": [], "owner": {"reputation": 2558, "user_id": 655436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da4e7757d5f0e8596fd832bebee3d0?s=128&d=identicon&r=PG", "display_name": "fukanchik", "link": "https://stackoverflow.com/users/655436/fukanchik"}, "is_accepted": false, "score": 0, "last_activity_date": 1499287212, "creation_date": 1499287212, "answer_id": 44935622, "question_id": 44935159, "link": "https://stackoverflow.com/questions/44935159/why-must-accessor-functions-be-const-where-is-the-vulnerability/44935622#44935622", "title": "Why must accessor functions be const? Where is the vulnerability?", "body": "<p><code>const</code> is not about vulneratilities! Thecnically it doesn't enforce security, safety or anything. Nothing stops you from applying const-cast to remove it or using keyword <code>mutable</code> to change something. </p>\n\n<p><code>const</code> helps to make your code cleaner. See <a href=\"https://isocpp.org/wiki/faq/const-correctness\" rel=\"nofollow noreferrer\" title=\"Const-correctness\">Const-Correctness</a> article with good explanation of the concept.</p>\n\n<ol>\n<li>When you look at something with <code>const</code> you would reasonably expect it not change the state. The declaration <code>int Class:foo() const;</code> tells me <code>foo()</code> won't change the object's state and it is ok to call it from anywhere.</li>\n<li><code>const</code> is infectious. The more you use it the more you have to use it. <code>bool Class::bar();</code> would have to be <code>const</code> if it needs to call <code>foo()</code>.</li>\n<li>Same applies in reverse direction. If you are passing <code>const &amp;</code> to a function: <code>void zoo(const Class &amp;cls);</code> then you know <code>zoo()</code> won't be able to modify <code>cls</code>'s state.</li>\n</ol>\n"}], "owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1106, "favorite_count": 0, "answer_count": 5, "score": 3, "last_activity_date": 1499303926, "creation_date": 1499285478, "last_edit_date": 1499287631, "question_id": 44935159, "link": "https://stackoverflow.com/questions/44935159/why-must-accessor-functions-be-const-where-is-the-vulnerability", "title": "Why must accessor functions be const? Where is the vulnerability?", "body": "<p>Professors hammered it into my head when I was in school, associates have jumped down my throat for it on code reviews, and it's in pretty much every C++ textbook out there: \"accessor\" (aka \"selector\" or <a href=\"https://stackoverflow.com/questions/tagged/getter\">\"getter\"</a>) methods must be marked <code>const</code>. If it doesn't change or mutate the data, then mark it <code>const</code>.</p>\n\n<p>Why? How could the invocation of an accessor modify the private data?</p>\n\n<p>In the following example, I have set up a simple class and one accessor. How can <code>getBrand()</code> be used to modify the private data? In my eyes, it can't; so why do we need to mark it <code>const</code>?</p>\n\n<p>In other words, am I correct in saying that it is impossible for <code>getBrand()</code> to be used, in practice, to mutate a private property?</p>\n\n<p>Example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nclass Cheese {\npublic:\n    Cheese(std::string brand):brand_(brand) {}\n    std::string getBrand() { return brand_; } // Intentionally not marked const\nprivate:\n    std::string brand_;\n};\n\nint main() {\n    Cheese cheddar(\"Cabot clothbound\");\n    std::cout &lt;&lt; \"Brand: \" &lt;&lt; cheddar.getBrand() &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "code-signing"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1499286442, "post_id": 44935148, "comment_id": 76847011, "body": "Did IT give you a pfx ? (and the password, of course). Just curious. I had to do this with VS2010 and VS2015. Unless MS finally integrated it into the IDE for project configuration in VS 2017 for unmanaged C++ (and it sounds like it still isn&#39;t), you can indeed use signtool, and it isn&#39;t that difficult so long as you have the pfx and associated password."}, {"owner": {"reputation": 43, "user_id": 6411669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d867bdbbd143028e480af56204277d75?s=128&d=identicon&r=PG&f=1", "display_name": "Nate San", "link": "https://stackoverflow.com/users/6411669/nate-san"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1499287741, "post_id": 44935148, "comment_id": 76847662, "body": "@WhozCraig They gave me a link to a microsoft site to generate my own pfx. So yes. I have a pfx with a password I set up."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6411669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d867bdbbd143028e480af56204277d75?s=128&d=identicon&r=PG&f=1", "display_name": "Nate San", "link": "https://stackoverflow.com/users/6411669/nate-san"}, "edited": false, "score": 0, "creation_date": 1499288844, "post_id": 44935852, "comment_id": 76848220, "body": "This is exactly what I was hoping I could do with the command line!  Forgive my ignorance, but I want to make sure I get this right.   I will be replacing &quot;path-to-your-cert\\yourcert.pfx&quot; with the full path to my cert.   I will replace &quot;$(TargetPath)&quot; with my password as plaintext?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 43, "user_id": 6411669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d867bdbbd143028e480af56204277d75?s=128&d=identicon&r=PG&f=1", "display_name": "Nate San", "link": "https://stackoverflow.com/users/6411669/nate-san"}, "edited": false, "score": 0, "creation_date": 1499288972, "post_id": 44935852, "comment_id": 76848261, "body": "@NateSan You can totally do it from the command line as well (obviously). You must have <code>signtool.exe</code> in your path, which it would be automatically if you are running from a Visual Studio Command Prompt. I thought (perhaps mistakenly) you were looking to incorporate it directly into your solution and project files. If so, the above is applicable. If not, and you only wanted a command line, only a fraction of the above will really be required (the actual command)."}, {"owner": {"reputation": 43, "user_id": 6411669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d867bdbbd143028e480af56204277d75?s=128&d=identicon&r=PG&f=1", "display_name": "Nate San", "link": "https://stackoverflow.com/users/6411669/nate-san"}, "edited": false, "score": 0, "creation_date": 1499289426, "post_id": 44935852, "comment_id": 76848456, "body": "Ignore the previous question. The edit system is messing with me.   So &quot;$(FrameworkSDKDir)bin\\\\x86\\signtool.exe&quot; may or may not be accurate for my version.  sign /v /f &quot;path-to-your-cert\\yourcert.pfx&quot; just gets replaced by the full directory to the pxf?  /p password becomes /p whateverthepassis  with no quotes.  &quot;$(TargetPath)&quot; is the path to the folder containing the exe?  &quot;$(OutDir) could be the same as the above directory, right?  sign\\$(ProjectName)-sign.out&quot; project name becomes whatever the project is called spaces and all?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 43, "user_id": 6411669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d867bdbbd143028e480af56204277d75?s=128&d=identicon&r=PG&f=1", "display_name": "Nate San", "link": "https://stackoverflow.com/users/6411669/nate-san"}, "edited": false, "score": 0, "creation_date": 1499289602, "post_id": 44935852, "comment_id": 76848545, "body": "@NateSan Yup, that&#39;s pretty much it. signtool does the rest. Usually this is done as part of a company&#39;s official build system, as they&#39;re the only ones that have the company signing cert (usually issued by Verisign, Thawt, or some other trusted authority) under lock and key, and are the only ones that can spit out &quot;official&quot; company-signed bits. But if you also need authenticode signing as part of your internal security checks, etc, this is one way to do it, usually using a development-generated/managed certificate chain. Anyway, hope it helps."}, {"owner": {"reputation": 43, "user_id": 6411669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d867bdbbd143028e480af56204277d75?s=128&d=identicon&r=PG&f=1", "display_name": "Nate San", "link": "https://stackoverflow.com/users/6411669/nate-san"}, "edited": false, "score": 0, "creation_date": 1499291204, "post_id": 44935852, "comment_id": 76849291, "body": "Sorry to keep bothering you, but I&#39;m getting an error, but I don&#39;t see the issue. compile fails and returns 1, which i assume is fail. The sign.out shows nothing when opened with notepad++.   &quot;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\10.0.15063.0\\x86\\signtool.exe&quot; sign /v /f &quot;C:\\Users\\nate_roth\\Documents\\Certifications\\cert.pfx&quot; /p mypassword &quot;$(C:\\Users\\nate_roth\\Documents\\Visual Studio 2017\\Projects\\CySmart Log Parser\\Debug)&quot; &gt; &quot;$(C:\\Users\\nate_roth\\Documents\\Visual Studio 2017\\Projects\\CySmart Log Parser\\Debug)sign\\$(Cysmart Log Parser)-sign.out&quot;"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 43, "user_id": 6411669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d867bdbbd143028e480af56204277d75?s=128&d=identicon&r=PG&f=1", "display_name": "Nate San", "link": "https://stackoverflow.com/users/6411669/nate-san"}, "edited": false, "score": 0, "creation_date": 1499293056, "post_id": 44935852, "comment_id": 76850025, "body": "Your macro usage for your to-be-signed is wrong. Note the $ at the beginning, which shouldn&#39;t be there. And the value is wrong anyway, as it&#39;s a full path with no file name (no DLL or EXE; just the Debug output folder). Fix that macro and it should fix your problem, assuming your certificate and its password are correct."}, {"owner": {"reputation": 43, "user_id": 6411669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d867bdbbd143028e480af56204277d75?s=128&d=identicon&r=PG&f=1", "display_name": "Nate San", "link": "https://stackoverflow.com/users/6411669/nate-san"}, "edited": false, "score": 0, "creation_date": 1499295919, "post_id": 44935852, "comment_id": 76851023, "body": "that fixed the error, but I&#39;m still getting bit9 flags from my company&#39;s security. So I&#39;ll just have to get back with them. Thanks for your help!"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 43, "user_id": 6411669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d867bdbbd143028e480af56204277d75?s=128&d=identicon&r=PG&f=1", "display_name": "Nate San", "link": "https://stackoverflow.com/users/6411669/nate-san"}, "edited": false, "score": 0, "creation_date": 1499378220, "post_id": 44935852, "comment_id": 76894406, "body": "@NateSan that is most likely because either client auth isn&#39;t configured correctly or the server public cert they undoubtedly had you self-sign is not in their trusted store. Ideally whatever signing cert signed your executable is rooted issued by an authority your company&#39;s security ultimately trusts. Frankly, them sending you to gen a self-signed cert for this seems a little ludicrous. Anyway, best of luck."}, {"owner": {"reputation": 43, "user_id": 6411669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d867bdbbd143028e480af56204277d75?s=128&d=identicon&r=PG&f=1", "display_name": "Nate San", "link": "https://stackoverflow.com/users/6411669/nate-san"}, "edited": false, "score": 0, "creation_date": 1499699263, "post_id": 44935852, "comment_id": 77004961, "body": "This was exactly the issue. I had to get in touch with a higher level IT guy. It works now. I do have a small annoyance though. I have to manually rebuild every time for the cert to be applied. Letting it build when i ask it to debug or run without debug still throws errors. Is there anything I can do do apply the cert on every build?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 43, "user_id": 6411669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d867bdbbd143028e480af56204277d75?s=128&d=identicon&r=PG&f=1", "display_name": "Nate San", "link": "https://stackoverflow.com/users/6411669/nate-san"}, "edited": false, "score": 0, "creation_date": 1499717248, "post_id": 44935852, "comment_id": 77015667, "body": "The signature should only requiring being done when the module (be it an exe or a dll) is built. That is the reason for the custom build step, and the detection of the sign-out file being out-of-date with the exe/dll should trigger an automatic resign. if it doesn&#39;t then chances are your macros aren&#39;t configured precisely as I described (but close). Make sure they correct."}], "tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 5, "last_activity_date": 1591244085, "last_edit_date": 1591244085, "creation_date": 1499288203, "answer_id": 44935852, "question_id": 44935148, "link": "https://stackoverflow.com/questions/44935148/how-can-i-get-visual-studio-2017-to-sign-a-win32-application-automatically/44935852#44935852", "title": "How can I get Visual Studio 2017 to sign a Win32 application automatically?", "body": "<p>This is how i've done this with Visual Studio 2010 and Visual Studio 2015 for unmanaged C or C++ Win32 applications. You need:</p>\n\n<ul>\n<li>A signing certificate. This is normally given as a PFX when working in Windows, and is typically an intermediate certificate in your certificate chain.</li>\n<li>The password to the above PFX to decrypt the certificate private key.</li>\n</ul>\n\n<p>With those, the following custom build step for your Win32 project can be created:</p>\n\n<pre><code>\"$(FrameworkSDKDir)bin\\x86\\signtool.exe\" sign /v /f \"path-to-your-cert\\yourcert.pfx\" /p password \"$(TargetPath)\" &gt; \"$(OutDir)sign\\$(ProjectName)-sign.out\"\n</code></pre>\n\n<p>This will use your certificate to sign the project output (be it a DLL or EXE makes no difference), and record the output of the signing certificate in a file named after your project with the suffix <code>sign.out</code>, placing that file in a folder called <code>sign</code> off your output directory.</p>\n\n<p>That may seem a bit overkill, but there is a reason for that generated output file. By creating that file, and naming it as one of the \"Outputs\" of the custom build step:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KsPil.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KsPil.png\" alt=\"enter image description here\"></a></p>\n\n<p>it can be comparatively used to determine whether to re-sign or not. Each time the project is built, if the target image (your exe or dll) is regenerated that output file will be out-of-date and the custom build step will be kicked off to regenerate it (and thusly also re-sign the image). The sign.out file, btw, will contain something like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>The following certificate was selected:\n    Issued to: The Signing Cert Name Here\n\n    Issued by: The Issuer Cert Name Here\n\n    Expires:   Sat Dec 31 16:59:59 2039\n\n    SHA1 hash: 232C80E19EBC71330E7C12CA8C07B345B1531777\n\n\nDone Adding Additional Store\nSuccessfully signed: full-path-to-image-here\n\nNumber of files successfully Signed: 1\n\nNumber of warnings: 0\n\nNumber of errors: 0\n</code></pre>\n\n<p>Once you have your PFX and password, you can easily just hand-test the command before you finally configure it as part of the build. The only real wildcard I've seen is the full path to the signtool.exe, which seemingly changes from time to time (different with VS2008 than with VS2015, for example.</p>\n\n<p>Anyway, that's how I did it. Hopefully you can too.</p>\n"}], "owner": {"reputation": 43, "user_id": 6411669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d867bdbbd143028e480af56204277d75?s=128&d=identicon&r=PG&f=1", "display_name": "Nate San", "link": "https://stackoverflow.com/users/6411669/nate-san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3281, "favorite_count": 3, "accepted_answer_id": 44935852, "answer_count": 1, "score": 4, "last_activity_date": 1591244085, "creation_date": 1499285445, "question_id": 44935148, "link": "https://stackoverflow.com/questions/44935148/how-can-i-get-visual-studio-2017-to-sign-a-win32-application-automatically", "title": "How can I get Visual Studio 2017 to sign a Win32 application automatically?", "body": "<p>I am using visual studio 2017. I am not a developer. I am just trying to write a simple parsing script and I am familiar with visual studio. I use Atmel Studio(which is based off VS) to write embedded code, but I don't have to deal with signing. I installed visual studio on my work computer and now I get bit9 errors every time I make a new build. </p>\n\n<p>Internal IT has pointed me to a bunch of slightly outdated certificate stuff. I now have a certificate to apply to my builds, however the process defined <a href=\"https://docs.microsoft.com/en-us/visualstudio/ide/how-to-sign-application-and-deployment-manifests\" rel=\"nofollow noreferrer\">here</a> will apparently not work for a Win32 application. I do not have a Signing tab in the project properties.</p>\n\n<p>I have also looked into the visual studio command line using signtool. However, it would take a lot of my time to learn how it works and implement it. </p>\n\n<p>Hopefully someone else has solved this and I can save the time. If there are no easy solutions I'll just go back to manually parsing, because this has already taken up to much of my time.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 297, "user_id": 3280501, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3dbdd954235a2fc661aa6da74e9f8461?s=128&d=identicon&r=PG&f=1", "display_name": "kay00", "link": "https://stackoverflow.com/users/3280501/kay00"}, "edited": false, "score": 0, "creation_date": 1499352567, "post_id": 44935106, "comment_id": 76879708, "body": "I edited the question. Since the answer is &quot;Iterators, pointers, and references (including the off-the-end and the before-the-beginning iterators) to a list or forward_list remain valid.&quot; How do I create a off-the-end iterator to test list.erase?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1499357220, "post_id": 44935106, "comment_id": 76883105, "body": "note that you can&#39;t increment <code>lst.end()</code>, that&#39;s the &quot;one-past-the-end&quot; iterator. (Well you can, but it makes your program ill-formed)"}], "answers": [{"tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": true, "score": 2, "last_activity_date": 1499285682, "creation_date": 1499285682, "answer_id": 44935201, "question_id": 44935106, "link": "https://stackoverflow.com/questions/44935106/how-to-test-iterators-including-the-off-the-end-and-the-before-the-beginning-it/44935201#44935201", "title": "How to test Iterators (including the off-the-end and the before-the-beginning iterators) to a list or forward_list remain valid,", "body": "<p>There is no built-in mechanism to check if an iterator, pointer or reference is valid. In some cases, if you know an iterator or pointer will become invalidated, you can set it to a known value such as <code>nullptr</code> (for pointers) or the containers <code>end</code> iterator (for iterators). Usually, you must simply design your software in such a way that you never preform an operation on an invalidated iterator. Once an iterator is invalidated it cannot be used, even to compare it with other iterators to see if it's valid.</p>\n\n<p>If you want to check if a valid iterator is a past-the-end iterator, you would usually compare it with the container's <code>end</code> iterator (see <a href=\"http://en.cppreference.com/w/cpp/iterator/end\" rel=\"nofollow noreferrer\">std::end</a>).</p>\n"}], "owner": {"reputation": 297, "user_id": 3280501, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3dbdd954235a2fc661aa6da74e9f8461?s=128&d=identicon&r=PG&f=1", "display_name": "kay00", "link": "https://stackoverflow.com/users/3280501/kay00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "closed_date": 1499300522, "accepted_answer_id": 44935201, "answer_count": 1, "score": 0, "last_activity_date": 1499368126, "creation_date": 1499285272, "last_edit_date": 1499368126, "question_id": 44935106, "link": "https://stackoverflow.com/questions/44935106/how-to-test-iterators-including-the-off-the-end-and-the-before-the-beginning-it", "closed_reason": "Needs details or clarity", "title": "How to test Iterators (including the off-the-end and the before-the-beginning iterators) to a list or forward_list remain valid,", "body": "<p>Working through C++ Primer and puzzled by Exercise 9.25.</p>\n\n<p>Consider the following code erasing all elements from a list:</p>\n\n<pre><code>list&lt;int&gt; lst = {0,1,2,3,4,5,6,7,8,9};\nelem1 = lst.begin();\nelem2 = lst.end();\nelem1 = lst.erase(elem1, elem2);\n</code></pre>\n\n<p>Exercise 9.25 asks about invalid elements: what happens if elem2 or both elem1 and elem2 are the off-the-end iterator?</p>\n\n<p>How do I write code to test this question that has an off-the-end iterator?</p>\n\n<p>I have tried this:</p>\n\n<pre><code>std::list&lt;int&gt; lst = { 0,1,2,3,4,5,6,7,8,9 };\nlst.erase(lst.begin(), ++lst.end());\n</code></pre>\n\n<p>According to the text at section 9.3.6.: The answer is </p>\n\n<pre><code>Iterators, pointers, and references (including the off-the-end and the \nbefore-the-beginning iterators) to a list or forward_list remain valid.\n</code></pre>\n\n<p>How do I create a sample code to see that the solution is correct? That iterators remain valid? When I use the above code the error thrown is  \"list iterator not incrementable\"</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1499285389, "post_id": 44935101, "comment_id": 76846404, "body": "what are these dashes in the file?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1499285429, "post_id": 44935101, "comment_id": 76846425, "body": "@EugeneSh. They seem to separate each 4 columns."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1499285452, "post_id": 44935101, "comment_id": 76846439, "body": "You are printing the addresses of the arrays."}, {"owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "edited": false, "score": 2, "creation_date": 1499285585, "post_id": 44935101, "comment_id": 76846505, "body": "also, sizeof(...) does not work with structs the way you think it does."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1499285590, "post_id": 44935101, "comment_id": 76846511, "body": "Use <code>ifstream::read()</code> instead of <code>ifstream::get()</code>. The latter is intended for c-strings. <code>read()</code> is for any data."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1499285611, "post_id": 44935101, "comment_id": 76846527, "body": "C++ is not C.  It is possible to write code that compiles and has the same semantics in both languages, but yours is not such code."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1499286141, "post_id": 44935101, "comment_id": 76846849, "body": "Jack up your compiler warning level. Some modern compilers look at the <code>printf</code> format string and can tell you if you are providing it the wrong datatypes."}, {"owner": {"reputation": 514, "user_id": 275636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040ec00435e0fa97764b552ba00378c7?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/275636/dale"}, "edited": false, "score": 0, "creation_date": 1499286278, "post_id": 44935101, "comment_id": 76846920, "body": "Perhaps read this for a refresher on C++ binary file reading: <a href=\"http://www.eecs.umich.edu/courses/eecs380/HANDOUTS/cppBinaryFileIO-2.html\" rel=\"nofollow noreferrer\">eecs.umich.edu/courses/eecs380/HANDOUTS/cppBinaryFileIO-2.ht&zwnj;&#8203;ml</a>"}], "answers": [{"comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1499286948, "post_id": 44935291, "comment_id": 76847255, "body": "Why does <code>printf(&quot;%i&quot;, array)</code> print the address of the array instead of the contents?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1499288354, "post_id": 44935291, "comment_id": 76847976, "body": "@zett42 <code>&quot;%i&quot;</code> is for printing an <code>int</code>, not a <code>char [3]</code>, nor the address of the array.  Since code used a mis-matched specifier and argument, the result is undefined behavior and in your case, it appeared like the address of the array."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 4, "last_activity_date": 1499290400, "last_edit_date": 1499290400, "creation_date": 1499285977, "answer_id": 44935291, "question_id": 44935101, "link": "https://stackoverflow.com/questions/44935101/problems-reading-binary-file/44935291#44935291", "title": "Problems reading binary file", "body": "<p>You should use type <code>unsigned char</code> in your <code>Block</code> structure.</p>\n\n<p>You should use <code>file.read()</code> to read binary data instead of <code>file.get()</code>.</p>\n\n<p>You are printing the addresses of the arrays in the <code>Block</code> structure, not their contents, furthermore the specifier <code>%i</code> expects an <code>int</code>, not a <code>char *</code>, so the behavior in undefined and you get some weird integer value but anything culd have happened, including program termination. Increasing the warning level is advisable so the compiler warns about such silly mistakes.</p>\n\n<p>If the file format is little endian, you could convert these 3 byte arrays to numbers this way:</p>\n\n<pre><code>int block_fileSize =  (unsigned char)block.fileSize[0] + \n                     ((unsigned char)block.fileSize[1] &lt;&lt; 8) + \n                     ((unsigned char)block.fileSize[2] &lt;&lt; 16);\nint block_initialDataBlockId =  (unsigned char)block.initialDataBlockId[0] +\n                               ((unsigned char)block.initialDataBlockId[1] &lt;&lt; 8) +\n                               ((unsigned char)block.initialDataBlockId[2] &lt;&lt; 16);\nprintf(\"File Size: %i\\n\", block_fileSize);\nprintf(\"Initial Data Block ID: %i\\n\", block_initialDataBlockId);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 310, "user_id": 7475829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nazhM.jpg?s=128&g=1", "display_name": "Stan Forto\u0144ski Developer", "link": "https://stackoverflow.com/users/7475829/stan-forto%c5%84ski-developer"}, "is_accepted": false, "score": 1, "last_activity_date": 1586595824, "last_edit_date": 1586595824, "creation_date": 1499290019, "answer_id": 44936278, "question_id": 44935101, "link": "https://stackoverflow.com/questions/44935101/problems-reading-binary-file/44936278#44936278", "title": "Problems reading binary file", "body": "<p>If you want to read a binary data you can use a <code>read</code> method from <code>ifstream</code> and also <code>write</code> method from <code>ofstream</code>.</p>\n\n<pre><code>istream &amp; ifstream::read (char * s, streamsize n);\nostream &amp; ofstream::write (const char * s, streamsize n);\n</code></pre>\n\n<p>You have to know that binary mode is useless for UNIX systems and text mode is only useful.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5473227"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "accepted_answer_id": 44935291, "answer_count": 2, "score": 2, "last_activity_date": 1586595824, "creation_date": 1499285257, "last_edit_date": 1499293333, "question_id": 44935101, "link": "https://stackoverflow.com/questions/44935101/problems-reading-binary-file", "title": "Problems reading binary file", "body": "<p>I'm trying to read the first 6 bytes of a file, but it's giving me weird results, and I can't seem to figure out what I'm doing wrong.</p>\n\n<p>My code:</p>\n\n<pre><code>struct Block {\n    char fileSize[3];\n    char initialDataBlockId[3];\n};\n\nint main(int c, char **a) {\n\n    ifstream file(\"C\\\\main_file_cache.idx0\", ios::binary);\n\n    Block block;\n\n    file.get((char*)&amp;block, sizeof(block));\n\n    printf(\"File Size: %i\\n\", block.fileSize);\n    printf(\"Initial Data Block ID: %i\\n\", block.initialDataBlockId);\n\n    file.close();\n\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>Before I ran the code, I opened the file in a binary editor,\nand it showed me this hex code:</p>\n\n<pre><code>    00 00 00 00-00 00 05 af-4b 00 00 01-26 df cd 00\n    00 6f 03 3f-ed 00 03 61-05 08 35 00-04 8b 01 61\n    59 00 08 39-03 23 0a 00-05 6c 00 35-d0 00 06 fe\n    03 69 d8 00-07 19\n</code></pre>\n\n<p>There are a total of 54 bytes. The first 6 bytes are just zero.</p>\n\n<p>So, I expected my program to produce the following output:</p>\n\n<pre><code>File Size: 0\nInitial Data Block ID: 0\n</code></pre>\n\n<p>Instead, the outputs is as follows:</p>\n\n<pre><code>File Size: 10419128\nInitial Data Block ID: 10419131\n</code></pre>\n\n<p>This result makes no sense. Maybe there is something wrong with my code?</p>\n"}, {"tags": ["c++", "tuples", "c++14", "boost-hana"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499287364, "post_id": 44935075, "comment_id": 76847468, "body": "What&#39;s wrong with your code? It&#39;s just going to be squirreled away in a library header anyways, so who cares if it&#39;s a little convoluted. I have a few ideas of how this could be done differently, but without knowing what the issue with your current approach is, it&#39;s hard to figure out what would be best."}, {"owner": {"reputation": 4305, "user_id": 2640636, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/NWXEh.jpg?s=128&g=1", "display_name": "SU3", "link": "https://stackoverflow.com/users/2640636/su3"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499287589, "post_id": 44935075, "comment_id": 76847585, "body": "There&#39;s no problem with my code. I posted it as an explanation of what I want to do. I just want to know if Hana has an algorithm for this."}], "answers": [{"comments": [{"owner": {"reputation": 1567, "user_id": 800347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Buq1.jpg?s=128&g=1", "display_name": "Jason Rice", "link": "https://stackoverflow.com/users/800347/jason-rice"}, "edited": false, "score": 2, "creation_date": 1499294598, "post_id": 44936069, "comment_id": 76850608, "body": "Cats and dogs answering each others metaprogramming questions - Mass hysteria! BTW there is also an open request for this feature <a href=\"https://github.com/boostorg/hana/issues/273\" rel=\"nofollow noreferrer\">github.com/boostorg/hana/issues/273</a>"}, {"owner": {"reputation": 2976, "user_id": 627587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b7225df5b0728daa170646a5c5a4bfda?s=128&d=identicon&r=PG", "display_name": "Louis Dionne", "link": "https://stackoverflow.com/users/627587/louis-dionne"}, "edited": false, "score": 1, "creation_date": 1499405683, "post_id": 44936069, "comment_id": 76901342, "body": "Technically, the reason why you need <code>to&lt;tuple_tag&gt;(range_c&lt;...&gt;)</code> is because <code>range_c</code> is not a <code>MonadPlus</code> (see <a href=\"http://boostorg.github.io/hana/group__group-MonadPlus.html\" rel=\"nofollow noreferrer\">this</a>), not because it&#39;s not a <code>Sequence</code>. This is just a nitpick, and your answer is otherwise correct."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 2976, "user_id": 627587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b7225df5b0728daa170646a5c5a4bfda?s=128&d=identicon&r=PG", "display_name": "Louis Dionne", "link": "https://stackoverflow.com/users/627587/louis-dionne"}, "edited": false, "score": 0, "creation_date": 1499428887, "post_id": 44936069, "comment_id": 76915132, "body": "@LouisDionne Must be using an old pull of hana, I swear the static assert said it had to be a Sequence - definitely says MonadPlus. Woops."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 2, "last_activity_date": 1499428844, "last_edit_date": 1499428844, "creation_date": 1499289143, "answer_id": 44936069, "question_id": 44935075, "link": "https://stackoverflow.com/questions/44935075/sequence-of-indices-of-tuple-elements-satifying-predicate-in-hana/44936069#44936069", "title": "Sequence of indices of tuple elements satifying predicate in Hana", "body": "<p>I'd guess something like this:</p>\n\n<pre><code>constexpr auto get_indices_of = [](auto tuple, auto predicate){\n    constexpr auto indices = to&lt;tuple_tag&gt;(range_c&lt;std::size_t, 0, size(tuple)&gt;);\n    return filter(indices, [=](auto i){ return predicate(tuple[i]); }); \n};\n</code></pre>\n\n<p>The only awkward part there is getting the indices, since <code>range_c</code> itself isn't a MonadPlus. Your actual example, using this function, is:</p>\n\n<pre><code>constexpr auto types = make_tuple(\n    type_c&lt;std::string&gt;, type_c&lt;int&gt;, type_c&lt;double&gt;, type_c&lt;char&gt;);\nconstexpr auto ints = get_indices_of(types, trait&lt;std::is_integral&gt;);\n</code></pre>\n"}], "owner": {"reputation": 4305, "user_id": 2640636, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/NWXEh.jpg?s=128&g=1", "display_name": "SU3", "link": "https://stackoverflow.com/users/2640636/su3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 44936069, "answer_count": 1, "score": 3, "last_activity_date": 1499428844, "creation_date": 1499285150, "question_id": 44935075, "link": "https://stackoverflow.com/questions/44935075/sequence-of-indices-of-tuple-elements-satifying-predicate-in-hana", "title": "Sequence of indices of tuple elements satifying predicate in Hana", "body": "<p>Is there a <strong>concise</strong> way to get a sequence of indices of tuple elements which satisfy a predicate in <a href=\"https://boostorg.github.io/hana/index.html\" rel=\"nofollow noreferrer\">Hana</a>?</p>\n\n<p>Here's the code I wrote for that using just the standard library:</p>\n\n<pre><code>template &lt;template&lt;typename&gt; typename Pred, typename Tuple&gt;\nclass get_indices_of {\n  static constexpr size_t size = std::tuple_size&lt;Tuple&gt;::value;\n  template &lt;size_t I, size_t... II&gt; struct impl {\n    using type = std::conditional_t&lt;\n      Pred&lt;std::tuple_element_t&lt;I,Tuple&gt;&gt;::value,\n      typename impl&lt;I+1, II..., I&gt;::type,\n      typename impl&lt;I+1, II...&gt;::type &gt;;\n  };\n  template &lt;size_t... II&gt; struct impl&lt;size,II...&gt; {\n    using type = std::index_sequence&lt;II...&gt;;\n  };\npublic:\n  using type = typename impl&lt;0&gt;::type;\n};\ntemplate &lt;template&lt;typename&gt; typename Pred, typename Tuple&gt;\nusing get_indices_of_t = typename get_indices_of&lt;Pred,Tuple&gt;::type;\n</code></pre>\n\n<p>Usage example:</p>\n\n<pre><code>using types = std::tuple&lt;std::string,int,double,char&gt;;\nusing ints = get_indices_of_t&lt;std::is_integral,types&gt;;\n</code></pre>\n\n<p>The type of <code>ints</code> is now <code>std::index_sequence&lt;1ul, 3ul&gt;</code>.</p>\n"}, {"tags": ["c++", "multithreading", "boost-asio"], "comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1499284993, "post_id": 44934987, "comment_id": 76846176, "body": "There&#39;s no need to put the async_receive in its own thread. asio is asynchronous"}, {"owner": {"reputation": 4817, "user_id": 513034, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29ebc95bcc5d5aec8ad0d583e0d69aa1?s=128&d=identicon&r=PG", "display_name": "pandoragami", "link": "https://stackoverflow.com/users/513034/pandoragami"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1499285150, "post_id": 44934987, "comment_id": 76846280, "body": "Ok, didn&#39;t know that, still new using this framework, but then would the async function only work before the <code>io_service</code> thread? In other words, is one guaranteed before the other?"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1499285267, "post_id": 44934987, "comment_id": 76846332, "body": "an async operation causes an io_service::work to be alive until the completion handler is called. Thus the io_service::run call will not return until the completion handler is called."}, {"owner": {"reputation": 4817, "user_id": 513034, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29ebc95bcc5d5aec8ad0d583e0d69aa1?s=128&d=identicon&r=PG", "display_name": "pandoragami", "link": "https://stackoverflow.com/users/513034/pandoragami"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1499285819, "post_id": 44934987, "comment_id": 76846654, "body": "When <code>io_service::run</code> returns after the completion handler is called does it stop blocking and exit? To me it seems that <code>async_receive</code> can keep accepting packets for the duration of a program and <code>io_service::run</code>  is only initialized at start up?"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1499286097, "post_id": 44934987, "comment_id": 76846825, "body": "see my answer for pre/postconditions. You need to read the docs a few times before it will all make sense. Took me ages to understand it all."}], "answers": [{"comments": [{"owner": {"reputation": 4817, "user_id": 513034, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29ebc95bcc5d5aec8ad0d583e0d69aa1?s=128&d=identicon&r=PG", "display_name": "pandoragami", "link": "https://stackoverflow.com/users/513034/pandoragami"}, "edited": false, "score": 0, "creation_date": 1499285288, "post_id": 44935081, "comment_id": 76846342, "body": "What you&#39;re saying is that I can call this before or after the <code>async_recieve</code> call?"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1499285312, "post_id": 44935081, "comment_id": 76846356, "body": "no need to control the lifetime of the work object with a pointer. if you want the io service to stop, just call stop() on it."}, {"owner": {"reputation": 4817, "user_id": 513034, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29ebc95bcc5d5aec8ad0d583e0d69aa1?s=128&d=identicon&r=PG", "display_name": "pandoragami", "link": "https://stackoverflow.com/users/513034/pandoragami"}, "edited": false, "score": 0, "creation_date": 1499286001, "post_id": 44935081, "comment_id": 76846768, "body": "I already have a <code>menu</code> thread that allows the <code>io_service</code> to stop and start but this is an interesting tidbit, thanks!"}], "tags": [], "owner": {"reputation": 17031, "user_id": 185915, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/207045374ab195353388d9fcc77af9c5?s=128&d=identicon&r=PG", "display_name": "Chad", "link": "https://stackoverflow.com/users/185915/chad"}, "is_accepted": false, "score": 2, "last_activity_date": 1499285175, "creation_date": 1499285175, "answer_id": 44935081, "question_id": 44934987, "link": "https://stackoverflow.com/questions/44934987/boostasio-making-sure-io-service-run-is-invoked-only-after-async-receive/44935081#44935081", "title": "BOOST::ASIO. Making sure io_service.run() is invoked only after async_receive(...) is called?", "body": "<p>If you want to keep the <code>io_service</code> running, create a <code>work</code> object:</p>\n\n<pre><code>boost::asio::io_service svc;\nauto work = std::make_shared&lt;boost::asio::io_service::work&gt;(svc);\nsvc.run(); // this will block as long as the work object is valid.\n</code></pre>\n\n<p>The nice thing about this approach is that the <code>work</code> object above will keep the <code>svc</code> object \"running\", but not block any other operations on it.</p>\n"}, {"comments": [{"owner": {"reputation": 4817, "user_id": 513034, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29ebc95bcc5d5aec8ad0d583e0d69aa1?s=128&d=identicon&r=PG", "display_name": "pandoragami", "link": "https://stackoverflow.com/users/513034/pandoragami"}, "edited": false, "score": 0, "creation_date": 1499292881, "post_id": 44935303, "comment_id": 76849954, "body": "Great explanation, ASIO developers should use this explanation instead of this one. <a href=\"http://www.boost.org/doc/libs/1_64_0/doc/html/boost_asio/reference/io_service/run/overload1.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_64_0/doc/html/boost_asio/reference/&hellip;</a>"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 4817, "user_id": 513034, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29ebc95bcc5d5aec8ad0d583e0d69aa1?s=128&d=identicon&r=PG", "display_name": "pandoragami", "link": "https://stackoverflow.com/users/513034/pandoragami"}, "edited": false, "score": 0, "creation_date": 1499322430, "post_id": 44935303, "comment_id": 76858228, "body": "I&#39;ve always felt that asio is a masterpiece, but the documentation let&#39;s it down badly."}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 2, "last_activity_date": 1499286021, "creation_date": 1499286021, "answer_id": 44935303, "question_id": 44934987, "link": "https://stackoverflow.com/questions/44934987/boostasio-making-sure-io-service-run-is-invoked-only-after-async-receive/44935303#44935303", "title": "BOOST::ASIO. Making sure io_service.run() is invoked only after async_receive(...) is called?", "body": "<p>When you call <code>io_service.run()</code>, the thread will block, dispatching posted handlers until either:</p>\n\n<ol>\n<li><p>There are no <code>io_service::work</code> objects associated with the <code>io_service</code>, or</p></li>\n<li><p><code>io_service.stop()</code> is called.</p></li>\n</ol>\n\n<p>If either of these happens, the <code>io_service</code> enters the stopped state and will refuse to dispatch any more handlers in future until its <code>reset()</code> method is called.</p>\n\n<p>Every time you initiate an asynchronous operation on an io object associated with the io_service, an io_service::work object is embedded in the asynchronous handler.</p>\n\n<p>For this reason, point (1) above cannot happen until the asynchronous handler has run.</p>\n\n<p>this code therefore will guarantee that the async process completes and that the asserts pass:</p>\n\n<pre><code>asio::io_service ios;    // ios is not in stopped state\nassert(!ios.stopped());\nauto obj = some_io_object(ios);\nbool completed = false;\nobj.async_something(..., [&amp;](auto const&amp; ec) { completed = true; });\n// nothing will happen yet. There is now 1 work object associated with ios\nassert(!completed);\n\nauto ran = ios.run();\nassert(completed);\nassert(ran == 1);    // only 1 async op waiting for completion.\nassert(ios.stopped());  // io_service is exhausted and no work remaining\n\nios.reset();\nassert(!ios.stopped());  // io_service is ready to run again \n</code></pre>\n"}], "owner": {"reputation": 4817, "user_id": 513034, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29ebc95bcc5d5aec8ad0d583e0d69aa1?s=128&d=identicon&r=PG", "display_name": "pandoragami", "link": "https://stackoverflow.com/users/513034/pandoragami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1042, "favorite_count": 0, "accepted_answer_id": 44935303, "answer_count": 2, "score": 0, "last_activity_date": 1499286021, "creation_date": 1499284807, "question_id": 44934987, "link": "https://stackoverflow.com/questions/44934987/boostasio-making-sure-io-service-run-is-invoked-only-after-async-receive", "title": "BOOST::ASIO. Making sure io_service.run() is invoked only after async_receive(...) is called?", "body": "<p>I have a problem where two threads are called like this, one after another.</p>\n\n<p><code>new boost::thread( &amp;SERVER::start_receive, this);</code></p>\n\n<p><code>new boost::thread( &amp;SERVER::run_io_service, this);</code></p>\n\n<p>Where the first thread calls this function.</p>\n\n<pre><code>void start_receive()\n{   \n    udp_socket.async_receive(....);\n}\n</code></pre>\n\n<p>and the second thread calls, </p>\n\n<pre><code>void run_io_service()\n{  \n    io_service.run();\n}\n</code></pre>\n\n<p>and sometimes the <code>io_service</code> thread ends up finishing before the <code>start_receive()</code> thread and then the server cannot receive packets.</p>\n\n<p>I thought about putting a sleep function between the two threads to wait a while for the <code>start_receive()</code> to complete and that works but I wondered if there was another sure fire way to make this happen? </p>\n"}, {"tags": ["c++", "printf"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1499284446, "post_id": 44934836, "comment_id": 76845846, "body": "Almost duplicate of <a href=\"https://stackoverflow.com/questions/4217510/how-to-cout-the-correct-number-of-decimal-places-of-a-double-value\">How to &#39;cout&#39; the correct number of decimal places of a double value?</a>"}, {"owner": {"reputation": 614, "user_id": 526255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49999c7d5d3832ab1ceaf62067343534?s=128&d=identicon&r=PG", "display_name": "1User", "link": "https://stackoverflow.com/users/526255/1user"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1499284593, "post_id": 44934836, "comment_id": 76845925, "body": "@user4581301 - i required that using printf , not by using any float , setprecision  or %C"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1499284880, "post_id": 44934836, "comment_id": 76846090, "body": "You should be able to search the internet for <a href=\"http://en.cppreference.com/w/cpp/io/c/fprintf\" rel=\"nofollow noreferrer\"><code>printf</code> format specifiers</a>, or any good C or C++ reference."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 1, "creation_date": 1499284909, "post_id": 44934836, "comment_id": 76846102, "body": "Does your &quot;Note&quot; mean: &quot;I haven&#39;t used [these things]&quot;, or &quot;I&#39;m not allowed to use [these things]&quot;?"}, {"owner": {"reputation": 614, "user_id": 526255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49999c7d5d3832ab1ceaf62067343534?s=128&d=identicon&r=PG", "display_name": "1User", "link": "https://stackoverflow.com/users/526255/1user"}, "reply_to_user": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1499285153, "post_id": 44934836, "comment_id": 76846282, "body": "@JerryCoffin - iam not allowed to use that float or setprecision()"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1499285296, "post_id": 44934836, "comment_id": 76846348, "body": "What&#39;s your purpose in not using floating point?  School assignment?  Online Judge?  Most real life programming allows for division and floating point.  There are exceptions for constrained systems."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1499285434, "post_id": 44934836, "comment_id": 76846427, "body": "You probably want to clarify the requirements in the question, not just a comment."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1499285660, "post_id": 44934836, "comment_id": 76846556, "body": "Recommendation: watch out for <code>std::pow</code> it delves into floating point calculations deep inside and may result in a number like 9999.9999999 being returned in place of 10000. 9999.9999999  will then be truncated to 9999 and produce the wrong answer. When you are working in integers it&#39;s usually safer just to perform the multiplications yourself.  In this case you could use a look-up table or a <code>switch</code>."}, {"owner": {"reputation": 71, "user_id": 7331388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fb2bbdb6f530f389de1a617aec3db9b?s=128&d=identicon&r=PG&f=1", "display_name": "AFatBunny", "link": "https://stackoverflow.com/users/7331388/afatbunny"}, "edited": false, "score": 1, "creation_date": 1499286011, "post_id": 44934836, "comment_id": 76846776, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4217510/how-to-cout-the-correct-number-of-decimal-places-of-a-double-value\">How to &#39;cout&#39; the correct number of decimal places of a double value?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 614, "user_id": 526255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49999c7d5d3832ab1ceaf62067343534?s=128&d=identicon&r=PG", "display_name": "1User", "link": "https://stackoverflow.com/users/526255/1user"}, "edited": false, "score": 0, "creation_date": 1499285343, "post_id": 44935093, "comment_id": 76846379, "body": "thanks for your reply , Floats are not used . since it is the value iam using for Price calculations , so when i used float can&#39;t be compared further"}, {"owner": {"reputation": 614, "user_id": 526255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49999c7d5d3832ab1ceaf62067343534?s=128&d=identicon&r=PG", "display_name": "1User", "link": "https://stackoverflow.com/users/526255/1user"}, "edited": false, "score": 0, "creation_date": 1499285381, "post_id": 44935093, "comment_id": 76846401, "body": "&quot;%c%5.2f&quot; not allowed"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "reply_to_user": {"reputation": 614, "user_id": 526255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49999c7d5d3832ab1ceaf62067343534?s=128&d=identicon&r=PG", "display_name": "1User", "link": "https://stackoverflow.com/users/526255/1user"}, "edited": false, "score": 0, "creation_date": 1499285502, "post_id": 44935093, "comment_id": 76846465, "body": "Search the internet for &quot;fixed point math c++&quot;.  You would have better precision with integers.  So in $US, one example is to represent number in pennies rather than floating point dollars.  Or in length, use millimeters."}, {"owner": {"reputation": 614, "user_id": 526255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49999c7d5d3832ab1ceaf62067343534?s=128&d=identicon&r=PG", "display_name": "1User", "link": "https://stackoverflow.com/users/526255/1user"}, "edited": false, "score": 0, "creation_date": 1499288379, "post_id": 44935093, "comment_id": 76847989, "body": "Actually i know to print simple individual numbers into array and display numbers , which requires an array to store the string ..and one temp variable to store the individual value like this . while(num&gt;=1) { temp= temp%10 ; printf(&quot;temp&quot;,temp) ;num=num/10 ; i++)  .........but in my scenario i should print all at once like this ...i should store the value in arr ........printf(&quot;%c.%c%c%c%c&quot;,value/divisor,arr[0],ar[1],ar[2&zwnj;&#8203;],ar[3],ar[4]); BUT i am looking for simple logic"}, {"owner": {"reputation": 614, "user_id": 526255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49999c7d5d3832ab1ceaf62067343534?s=128&d=identicon&r=PG", "display_name": "1User", "link": "https://stackoverflow.com/users/526255/1user"}, "edited": false, "score": 0, "creation_date": 1499288667, "post_id": 44935093, "comment_id": 76848131, "body": "Please if u understood the problem , can u provide the logic"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "reply_to_user": {"reputation": 614, "user_id": 526255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49999c7d5d3832ab1ceaf62067343534?s=128&d=identicon&r=PG", "display_name": "1User", "link": "https://stackoverflow.com/users/526255/1user"}, "edited": false, "score": 0, "creation_date": 1499291126, "post_id": 44935093, "comment_id": 76849247, "body": "Try developing the logic yourself.  Take a number like 3.14159, figure out how to get a digit from it, such as multiplying by some divisor and subtracting from the original number.  Trust yourself, or search the internet for &quot;c++ extract decimal digits&quot;."}], "tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 1, "last_activity_date": 1499286098, "last_edit_date": 1499286098, "creation_date": 1499285231, "answer_id": 44935093, "question_id": 44934836, "link": "https://stackoverflow.com/questions/44934836/please-provide-me-the-logic-to-print-the-result-using-printf/44935093#44935093", "title": "Please provide me the logic to print the result using PRINTF", "body": "<p>In order to print decimals (easily), you need floating point:</p>\n\n<pre><code>printf(\"%10.6f\", static_cast&lt;double&gt;(1) / 3);\n</code></pre>\n\n<p>If one of the arguments to division is floating point, the compiler will promote the expression to floating point.</p>\n\n<p>Integral or scalar division will lose decimals.</p>\n\n<p>You are always welcome to write your own division function.</p>\n\n<p><strong>Edit 1: Shifting</strong><br>\nYou don't need to use the <code>pow</code> function (especially since it's floating point).  </p>\n\n<p>Use a loop, in the loop multiply your divisor by 10 each time.</p>\n\n<pre><code>double result = (double) scalar / value;\nint divisor = 10;\nint i;\nfor (i = 0; i &lt; NUMBER_OF_DECIMALS; ++)\n{\n  // Isolate a digit using math.\n  // print the digit\n  divisor += 10;\n}\n</code></pre>\n\n<p>The math part is left as an exercise for the OP.</p>\n"}, {"tags": [], "owner": {"reputation": 17002, "user_id": 11440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d549ac1c84a6806b3fb330ed09fb96c2?s=128&d=identicon&r=PG", "display_name": "Tom Leys", "link": "https://stackoverflow.com/users/11440/tom-leys"}, "is_accepted": false, "score": 0, "last_activity_date": 1499294342, "creation_date": 1499294342, "answer_id": 44937104, "question_id": 44934836, "link": "https://stackoverflow.com/questions/44934836/please-provide-me-the-logic-to-print-the-result-using-printf/44937104#44937104", "title": "Please provide me the logic to print the result using PRINTF", "body": "<p>In this homework exercise you are expected to perform your own number formatting, rather than using that of a library.</p>\n\n<p>For instance, to format and output 100 as \"100\"</p>\n\n<pre><code>int accum = 100;\nint position = 0;\nwhile (accum &gt; 0)\n{\n   printf(\"%d\", accum % 10);\n   accum /= 10;\n   position += 1;\n}\n</code></pre>\n\n<p>For your homework assignment, you need to modify the above loop so that it puts a <code>printf(\".\")</code> in the correct place in the output number. Your answer is likely to involve multiplying <code>accum</code> before the loop and testing <code>position</code> relative to <code>scalar</code></p>\n"}], "owner": {"reputation": 614, "user_id": 526255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49999c7d5d3832ab1ceaf62067343534?s=128&d=identicon&r=PG", "display_name": "1User", "link": "https://stackoverflow.com/users/526255/1user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "closed_date": 1499320188, "answer_count": 2, "score": -6, "last_activity_date": 1499294342, "creation_date": 1499284220, "last_edit_date": 1499288319, "question_id": 44934836, "link": "https://stackoverflow.com/questions/44934836/please-provide-me-the-logic-to-print-the-result-using-printf", "closed_reason": "Not suitable for this site", "title": "Please provide me the logic to print the result using PRINTF", "body": "<p>need an programming logic to print an 4 decimal points</p>\n\n<pre><code>  EX: scalar should be 0 to -5   \n  value = 10006 , scalar = -3 then print result = 10.0060 (4 decimals)  \n  value = 123   ,scalar = -5  then print result = 0.0012 (4 decimals)**  \n  required value/divisor = 10 , value%divisor = 0060 (required logic after decimals )\n</code></pre>\n\n<p>I tried like this: </p>\n\n<pre><code> divisor =  std::pow(10,std::abs(scalar));\n\n **Result = snprintf(X,Y,\"%d.%0*d\",value/scalar,4,value%scalar);**\n</code></pre>\n\n<p>I'm not allowed to use  float , setprecision() .</p>\n\n<p>It does not necessarily represent the actual value , but we can format that value to print with logic like the original one (by using the logic , add ...subtract...pow etc)</p>\n\n<p>std::int32_t divisor = static_cast(std::pow( 10.0F,  std::abs( Scalar)) );</p>\n\n<p>but int the above result modulus scalar value with 0 are not considering.\n      **Please provide me the logic to print the above result with scalar condition</p>\n"}, {"tags": ["c++", "makefile"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1499283961, "post_id": 44934600, "comment_id": 76845535, "body": "I&#39;ve got an (incomplete) couple of articles here <a href=\"https://latedev.wordpress.com/2014/11/08/generic-makefiles-with-gcc-and-gnu-make/\" rel=\"nofollow noreferrer\">latedev.wordpress.com/2014/11/08/&hellip;</a> on how to write  a generic makefile, which may or may not be useful."}, {"owner": {"reputation": 1819, "user_id": 5245129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-R6N_z4EgNEg/AAAAAAAAAAI/AAAAAAAAACw/BCIyzdGOv64/photo.jpg?sz=128", "display_name": "Faheel", "link": "https://stackoverflow.com/users/5245129/faheel"}, "edited": false, "score": 0, "creation_date": 1499284238, "post_id": 44934600, "comment_id": 76845731, "body": "@NeilButterworth This seems useful, thanks! Going through it ATM."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1499285348, "post_id": 44934600, "comment_id": 76846382, "body": "It really depends on what your target <i>program(s)</i> is/are. Does this all build one program? Or one program per source file?"}, {"owner": {"reputation": 1819, "user_id": 5245129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-R6N_z4EgNEg/AAAAAAAAAAI/AAAAAAAAACw/BCIyzdGOv64/photo.jpg?sz=128", "display_name": "Faheel", "link": "https://stackoverflow.com/users/5245129/faheel"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1499285572, "post_id": 44934600, "comment_id": 76846497, "body": "@Galik One program per source file"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1499285779, "post_id": 44934600, "comment_id": 76846630, "body": "Presumable then the file names will be unique so that in the <code>bin</code> dir the programs don&#39;t overwrite each other? Or do you want the same subdirectories under the <code>bin</code> dir you have in the source directories?"}, {"owner": {"reputation": 1819, "user_id": 5245129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-R6N_z4EgNEg/AAAAAAAAAAI/AAAAAAAAACw/BCIyzdGOv64/photo.jpg?sz=128", "display_name": "Faheel", "link": "https://stackoverflow.com/users/5245129/faheel"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1499286054, "post_id": 44934600, "comment_id": 76846802, "body": "@Galik I would like the same structure to be maintained under both <code>bin</code> and <code>build</code>. For example, I should get the executables <code>bin&#47;dir1&#47;file1</code> and <code>bin&#47;dir1&#47;file1.test</code> from the source and test code of <code>file1</code> respectively."}], "answers": [{"comments": [{"owner": {"reputation": 1819, "user_id": 5245129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-R6N_z4EgNEg/AAAAAAAAAAI/AAAAAAAAACw/BCIyzdGOv64/photo.jpg?sz=128", "display_name": "Faheel", "link": "https://stackoverflow.com/users/5245129/faheel"}, "edited": false, "score": 0, "creation_date": 1499292264, "post_id": 44936536, "comment_id": 76849723, "body": "Will definitely read the manual in depth for more on Makefiles. Thanks for your help!"}], "tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": true, "score": 1, "last_activity_date": 1499291309, "creation_date": 1499291309, "answer_id": 44936536, "question_id": 44934600, "link": "https://stackoverflow.com/questions/44934600/makefile-for-project-with-code-in-multiple-directories-but-same-directory-struct/44936536#44936536", "title": "Makefile for project with code in multiple directories but same directory structure", "body": "<p>I don't think this is fool proof but I think it pretty much does what you are after. You should study up on building Makefiles because it this turns out not to quite fit your needs, how are you going to fix it?</p>\n\n<pre class=\"lang-bash prettyprint-override\"><code>CXX := g++\nRM  := rm -f\nMD  := mkdir -p\n\n# don't change, this is for dependencies\nCXXFLAGS += -MMD -MP\n\n# add compiler flags here\nCXXFLAGS += -std=c++14 -pedantic-errors\nCXXFLAGS += -Wall -Wextra\nCXXFLAGS += -g3 -O0\n\n# add external includes here\nCPPFLAGS += -Iinclude\n\n# add library flags here\nLDFLAGS +=\n\nDIRS := $(patsubst  src/%, %, $(wildcard  src/*))\nDIRS += $(patsubst test/%, %, $(wildcard test/*))\nPROG_SOURCES := $(wildcard  src/*/*.cpp)\nTEST_SOURCES := $(wildcard test/*/*.cpp)\nOBJECTS := $(patsubst  src/%.cpp, build/%.o, $(PROG_SOURCES))\nOBJECTS += $(patsubst test/%.cpp, build/%.o, $(TEST_SOURCES))\nEXECUTABLES := $(patsubst  src/%.cpp, bin/%, $(PROG_SOURCES))\nEXECUTABLES += $(patsubst test/%.cpp, bin/%, $(TEST_SOURCES))\nDEPENDENCIES := $(patsubst   src/%.cpp, build/%.d, $(PROG_SOURCES)) \nDEPENDENCIES += $(patsubst  test/%.cpp, build/%.d, $(TEST_SOURCES)) \n\nall: dirs $(EXECUTABLES)\n\nbuild/%.o: src/%.cpp\n    $(CXX) -c $(CXXFLAGS) $(CPPFLAGS) -o $@ $&lt;\n\nbuild/%.o: test/%.cpp\n    $(CXX) -c $(CXXFLAGS) $(CPPFLAGS) -o $@ $&lt;\n\nbin/%: build/%.o\n    $(CXX) $(CXXFLAGS) -o $@ $&lt; $(LDFLAGS)\n\n-include $(DEPENDENCIES)\n\nclean:\n    @echo Removing build files\n    @$(RM) $(EXECUTABLES) $(OBJECTS) $(DEPENDENCIES)\n\ndirs:\n    @$(MD) $(patsubst %, build/%, $(DIRS)) $(patsubst %, bin/%, $(DIRS))\n\n.PHONY: show dirs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1819, "user_id": 5245129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-R6N_z4EgNEg/AAAAAAAAAAI/AAAAAAAAACw/BCIyzdGOv64/photo.jpg?sz=128", "display_name": "Faheel", "link": "https://stackoverflow.com/users/5245129/faheel"}, "edited": false, "score": 0, "creation_date": 1499303682, "post_id": 44937143, "comment_id": 76852864, "body": "Will take a look at this too. Thanks!"}], "tags": [], "owner": {"reputation": 300, "user_id": 8243878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a342072e9493c58c8405868e2784ee1?s=128&d=identicon&r=PG&f=1", "display_name": "jschmerge", "link": "https://stackoverflow.com/users/8243878/jschmerge"}, "is_accepted": false, "score": 0, "last_activity_date": 1499294581, "creation_date": 1499294581, "answer_id": 44937143, "question_id": 44934600, "link": "https://stackoverflow.com/questions/44934600/makefile-for-project-with-code-in-multiple-directories-but-same-directory-struct/44937143#44937143", "title": "Makefile for project with code in multiple directories but same directory structure", "body": "<p>You might find some inspiration from this: <a href=\"https://github.com/jschmerge/DasBuild\" rel=\"nofollow noreferrer\">https://github.com/jschmerge/DasBuild</a></p>\n"}], "owner": {"reputation": 1819, "user_id": 5245129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-R6N_z4EgNEg/AAAAAAAAAAI/AAAAAAAAACw/BCIyzdGOv64/photo.jpg?sz=128", "display_name": "Faheel", "link": "https://stackoverflow.com/users/5245129/faheel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "accepted_answer_id": 44936536, "answer_count": 2, "score": 1, "last_activity_date": 1499294581, "creation_date": 1499283314, "question_id": 44934600, "link": "https://stackoverflow.com/questions/44934600/makefile-for-project-with-code-in-multiple-directories-but-same-directory-struct", "title": "Makefile for project with code in multiple directories but same directory structure", "body": "<p>I have the following directory structure for a C++ project:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 build\n\u251c\u2500\u2500 include\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 dir1\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 file1.hpp\n\u2502   \u2502   \u2514\u2500\u2500 file2.hpp\n\u2502   \u251c\u2500\u2500 dir2\n\u2502   \u2502   \u251c\u2500\u2500 file3.hpp\n\u2502   \u2502   \u2514\u2500\u2500 file4.hpp\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 third_party\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 catch.hpp\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 src\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 dir1\n\u2502   \u2502   \u251c\u2500\u2500 file1.cpp\n\u2502   \u2502   \u2514\u2500\u2500 file2.cpp\n\u2502   \u2514\u2500\u2500 dir2\n\u2502       \u251c\u2500\u2500 file3.cpp\n\u2502       \u2514\u2500\u2500 file4.cpp\n\u2514\u2500\u2500 test\n    \u251c\u2500\u2500 dir1\n    \u2502   \u251c\u2500\u2500 file1.test.cpp\n    \u2502   \u2514\u2500\u2500 file2.test.cpp\n    \u2514\u2500\u2500 dir2\n        \u251c\u2500\u2500 file3.test.cpp\n        \u2514\u2500\u2500 file4.test.cpp\n</code></pre>\n\n<p>How can I write the Makefile to compile the code in <code>src</code> and <code>test</code> directories and obtain the object files in the <code>build</code> directory and the binaries in the <code>bin</code> directory, maintaining the same directory structure within them, <strong>without having to name every file and its dependency explicitly</strong>? Would it be better to use multiple Makefiles in each <code>dir*</code> within <code>src</code> and <code>test</code>?</p>\n\n<p>My Makefile currently looks like this: (it's probably nonsensical, sorry about that!)</p>\n\n<pre><code>binaries_dir = bin\nbuild_dir = build\nsources_dir = src\ninclude_dir = include\n\ncompile_flags = -std=c++14 -Wall\n\nbinaries := $(wildcard *.out)\nobjects := $(wildcard *.o)\nsources := $(wildcard *.cpp)\nheaders := $(wildcard *.hpp)\n\nobjects: $(sources)\n    g++ $(compile_flags) -c $(sources_dir)/$(sources) -I $(include_dir)\n\nbinaries: $(objects)\n    for object in $(objects); do\n        g++ $(compile_flags) -o $(binaries_dir)/ $(build_dir)/$object\n    done\n</code></pre>\n"}, {"tags": ["c++", "c", "c-preprocessor"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1499283328, "post_id": 44934586, "comment_id": 76845174, "body": "try it out. I&#39;d say 5"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1499283402, "post_id": 44934586, "comment_id": 76845225, "body": "What did you get when you tried it?  Why didn&#39;t you try it?  What is puzzling you about the output?"}, {"owner": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1499283420, "post_id": 44934586, "comment_id": 76845233, "body": "Hmm... it compiles with clang on macOS and the output says <code>5</code>."}, {"owner": {"reputation": 165, "user_id": 6644397, "user_type": "registered", "profile_image": "https://graph.facebook.com/339836286349003/picture?type=large", "display_name": "Anwar Hussain", "link": "https://stackoverflow.com/users/6644397/anwar-hussain"}, "edited": false, "score": 0, "creation_date": 1499283450, "post_id": 44934586, "comment_id": 76845255, "body": "why the output is 5?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1499283454, "post_id": 44934586, "comment_id": 76845257, "body": "Remember, the input is already tokenized before the preprocessor processes macro expansion.  Therefore, the code is as if you&#39;d written <code>- - 5</code> rather than <code>--5</code> which would be an error (you can&#39;t decrement a constant)."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1499283579, "post_id": 44934586, "comment_id": 76845304, "body": "@EOF it&#39;s perfectly legal. The illegal thing is to try to force the preprocessor to perform 2 passes by trying to <code>#define</code> macro which performs a <code>#define</code>. Not the case here"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1499284013, "post_id": 44934586, "comment_id": 76845573, "body": "@Marged lazy but interesting enough :)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1499284043, "post_id": 44934586, "comment_id": 76845597, "body": "@Marged: I don&#39;t agree: it has nothing to do with lazyness, compiling source code does not prove much, explaining where the extra space comes from is the core of the trick question. Telling the interviewer about token pasting and compiler bugs would be a fantastic answer from an applicant."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1499284182, "post_id": 44934586, "comment_id": 76845690, "body": "methinks that this is a great question :) as @chqrlie noted, sole compiling doesn&#39;t help much to understand why this works."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1499284306, "post_id": 44934586, "comment_id": 76845764, "body": "@JonathanLeffler your 27 comments on that Q&amp;A - gathered - could be great material for an answer, since no answer explained the tokenizing stuff (chqrlie&#39;s answer does, yes). thanks for the edit BTW."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1499287933, "post_id": 44934586, "comment_id": 76847767, "body": "The question <a href=\"https://stackoverflow.com/questions/1489932/\">How to concatenate twice with the C preprocessor and expand a macro as in <code>arg ## _ ## MACRO</code></a> has relevant information, but isn&#39;t by any stretch of the imagination a duplicate.  The question <a href=\"https://stackoverflow.com/questions/41710558\">Can we write a macro over many lines without using a backslash at the end?</a> also has relevant information about stages 1-4 of the processing (stage 3 tokenizes; stage 4 preprocesses)."}, {"owner": {"reputation": 811, "user_id": 1273178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9c4b75eae227c2f8190e963367a4f9?s=128&d=identicon&r=PG", "display_name": "Rastaban", "link": "https://stackoverflow.com/users/1273178/rastaban"}, "edited": false, "score": 0, "creation_date": 1499797720, "post_id": 44934586, "comment_id": 77058300, "body": "MSVC compiler dev here.  Our current preprocessor is (mostly) string based, and as a side effect it will concatenate in places where it should not.  I am in the process of rewriting the preprocessor to correctly handle pp-tokens.  It is a tricky problem to solve because there is a significant amount of legacy code that relies on this behavior, so I am not sure when the conformant preprocessor will be complete."}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 5, "last_activity_date": 1499284210, "last_edit_date": 1499284210, "creation_date": 1499283437, "answer_id": 44934628, "question_id": 44934586, "link": "https://stackoverflow.com/questions/44934586/understanding-macros-in-c/44934628#44934628", "title": "Understanding macros in C", "body": "<p>No need to compile this code, just use <code>gcc -E</code> on it (preprocessor) and see what happens:</p>\n\n<pre><code>&lt;lots of output expanding stdio.h&gt; ...\n\nint main()\n{\n  printf(\"The value of A is %d\\n\", - -5);\n  return 0;\n}\n</code></pre>\n\n<p>Obviously the result is <code>5</code> (which could have been guessed by looking at the nested macros, but a small preprocessor test doesn't hurt).</p>\n\n<p>(Other answers noted that some compilers may handle the preprocessing of the minus signs which would result in a compiler error. <code>gcc</code> handles that nicely.)</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 6, "creation_date": 1499283725, "post_id": 44934675, "comment_id": 76845392, "body": "Congratulations.  You can file a bug report with Microsoft.  That is incorrect behaviour by their compiler."}, {"owner": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1499283850, "post_id": 44934675, "comment_id": 76845465, "body": "@JonathanLeffler why is this a bug? clang expands <code>B</code> to <code>-5</code> and <code>A</code> to <code>- -5</code>. Where the space come from? And, if clang and gcc are right, why they don&#39;t expand <code>B</code> to <code>- 5</code>?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1499283988, "post_id": 44934675, "comment_id": 76845556, "body": "@axiac: the space is the char that saves the compilation, by creating a double minus instead of a pre-decrementation."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1499284028, "post_id": 44934675, "comment_id": 76845589, "body": "The input to the preprocessor is tokenized before macros are expanded.  Tokens don&#39;t get untokenized.  The <code>-</code> from <code>-B</code> is one token; it is not subject to further macro expansion.  The next token is <code>B</code>; it is subject to macro expansion as <code>-C</code> (that&#39;s two tokens).  The <code>-</code> is again not subject to macro expansion; it proceeds down the line.  The <code>C</code> is not subject to macro expansion; it passes unscathed.  The output of the preprocessor is 3 tokens \u2014 <code>-</code>, <code>-</code> and <code>C</code>.  Conflating them as <code>--C</code> and then interpreting the two dashes as a decrement is incorrect.  The standard is remarkably clear."}, {"owner": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1499284080, "post_id": 44934675, "comment_id": 76845623, "body": "@Jean-Fran&#231;oisFabre I see that. My question is why the preprocessor adds a white space when it expands <code>A</code> but it doesn&#39;t add it when it expands <code>B</code>. It doesn&#39;t seem even to me, as the space is not there in the source code."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1499284160, "post_id": 44934675, "comment_id": 76845677, "body": "@axiac see Johnathan Leffer excellent comments. The compilers are just complying to the norm (well, some ... :))"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 2, "creation_date": 1499284395, "post_id": 44934675, "comment_id": 76845819, "body": "The extra space in only needed in the textual output of the preprocessor. It does not matter if VS uses multiple separate phases or not, the source program is perfectly valid and their failure to compile it is a BUG."}, {"owner": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1499284589, "post_id": 44934675, "comment_id": 76845923, "body": "@JonathanLeffler If I get you right, it is not possible to <code>#define A str</code>, <code>#define B uct</code> and then use <code>A</code> and <code>B</code> to generate the keyword <code>struct</code>, isn&#39;t it? No matter what, it will be parsed as two tokens, right? (<code>str</code> and <code>uct</code>)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1499284697, "post_id": 44934675, "comment_id": 76845986, "body": "As shown, that&#39;s correct.  There is the <code>##</code> token pasting operator, of course: <code>#define C(x, y) C1(x, y)</code> plus <code>#define C1(x, y) x ## y</code> which can be used in <code>C(A, B) apoplexy { \u2026 };</code> etc to cause apoplexy in the unfortunate readers of the code (not to mention the compiler writer).  The two levels of macro are needed to get the arguments expanded to <code>str</code> and <code>uct</code>.  Token pasting only works with &#39;wordy&#39; tokens, not punctuation."}, {"owner": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1499285302, "post_id": 44934675, "comment_id": 76846351, "body": "@JonathanLeffler Thank you. I learned something today."}], "tags": [], "owner": {"reputation": 21987, "user_id": 163551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/BLZsK.jpg?s=128&g=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/163551/patrick"}, "is_accepted": false, "score": 3, "last_activity_date": 1499283603, "creation_date": 1499283603, "answer_id": 44934675, "question_id": 44934586, "link": "https://stackoverflow.com/questions/44934586/understanding-macros-in-c/44934675#44934675", "title": "Understanding macros in C", "body": "<p>Question doesn't really make sense, but I still decided to give it a go.</p>\n\n<p>Visual Studio 2013 and 2015: <code>error C2105: '--' needs l-value</code></p>\n\n<p>Reason is that the following line:</p>\n\n<pre><code>printf(\"The value of A is %d\\n\", A);\n</code></pre>\n\n<p>is first translated into (A becomes -B):</p>\n\n<pre><code>printf(\"The value of A is %d\\n\", -B);\n</code></pre>\n\n<p>then into (B becomes -C);</p>\n\n<pre><code>printf(\"The value of A is %d\\n\", --C);\n</code></pre>\n\n<p>and then into (C becomes 5):</p>\n\n<pre><code>printf(\"The value of A is %d\\n\", --5);\n</code></pre>\n\n<p>And since 5 is not an l-value, you cannot decrement it, hence the error.\nSeems quite logical, knowing the preprocessor will just do a simple string replace.</p>\n"}, {"comments": [{"owner": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1499283922, "post_id": 44934721, "comment_id": 76845508, "body": "Where the white space come from? If clang and gcc are right, why they don&#39;t expand <code>B</code> to <code>- 5</code>?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1499284051, "post_id": 44934721, "comment_id": 76845600, "body": "@axiac: they don&#39;t need to expand to <code>- 5</code> because <code>-5</code> is correct."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1499284295, "post_id": 44934721, "comment_id": 76845758, "body": "The standard says what must happen (and GCC and Clang implement it correctly); some compilers may have bugs, perhaps because they use a separate preprocessor program.  The standard doesn&#39;t say &quot;you can get different behaviours depending on whether the preprocessor is a separate program or not&quot;."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 4, "creation_date": 1499284376, "post_id": 44934721, "comment_id": 76845810, "body": "@axiac, the space is synthesized when the preprocessor emits its results as text, instead of as a sequence of tokens passed directly to the compiler.   This allows it to ensure that if the output is re-read as C source, it will represent the same token sequence that the original source did.  This is a quality of implementation consideration, because the standard says nothing about such transformations back to text."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1499284716, "post_id": 44934721, "comment_id": 76845998, "body": "@JonathanLeffler: I completely agree.  This code is a confirmance test for the preprocessor and VS fails it.  I clarified the answer to this respect."}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 0, "creation_date": 1500199120, "post_id": 44934721, "comment_id": 77224442, "body": "Really interesting. I&#39;d never considered this distinction before!"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 8, "last_activity_date": 1499309400, "last_edit_date": 1499309400, "creation_date": 1499283797, "answer_id": 44934721, "question_id": 44934586, "link": "https://stackoverflow.com/questions/44934586/understanding-macros-in-c/44934721#44934721", "title": "Understanding macros in C", "body": "<p>This is a tricky question because it is a stress test for the compiler preprocessor.</p>\n\n<p>Depending if the preprocessor is an integrated phase of the compiler or a separate program passing its output to the compiler via a file or a pipe and in this case whether it is careful enough to not perform erroneous token pasting, you may get the expected output: <code>5</code> or you may get a compilation error.</p>\n\n<p>After the preprocessed contents of <code>stdio.h</code>, the source code expands to:</p>\n\n<pre><code>int main()\n{\n  printf(\"The value of A is %d\\n\", --5);\n  return 0;\n}\n</code></pre>\n\n<p>But the two <code>-</code> are separate tokens, so depending if the preprocessor separates them in its output or not, you may get a program that outputs <code>5</code> or one that does not compile because <code>--</code> cannot be applied to a literal <code>5</code>.</p>\n\n<p>Both the <code>gcc</code> and the <code>clang</code> preprocessors behave correctly and separate the <code>-</code> with an extra space to prevent token pasting when they produce the preprocessor output with the <code>-E</code> command line option. They output this as preprocessed source code after the expansion of <code>&lt;stdio.h&gt;</code>:</p>\n\n<pre><code>int main()\n{\n  printf(\"The value of A is %d\\n\", - -5);\n  return 0;\n}\n</code></pre>\n\n<p>Try your own compiler to check how it expands the source code. It seems Visual Studio 2013 and 2015 fail the test and reject the program with an error.</p>\n\n<p>To makes things clear, I do not say the behavior of the program should depend on the compiler architecture.  I was hoping at least one common C compiler would mishandle this conformance test.  I am not surprised MS Visual Studio 2013 and 2015 fail this test.</p>\n\n<p>The extra space in only needed in the textual output of the preprocessor. It does not matter if Visual Studio uses multiple separate phases or not, the source program is perfectly valid and their failure to compile it is a BUG.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1499288460, "post_id": 44935697, "comment_id": 76848032, "body": "This is a valid observation about how to use the preprocessor; it isn&#39;t directly an answer to the &#39;why&#39; question.  So, +1 for validity and -1 for relevance."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1499289233, "post_id": 44935697, "comment_id": 76848374, "body": "Yes but the initial question is unanswerable. It is an example if the even not the Undefined Behaviour as UB is when program actually compiles but the result is unpredictable in the C standard meaning, but in this case compilation process in undefined. So my another answer is compiler error if the preprocessor does not add any whitespace or 5 if it does."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1499289298, "post_id": 44935697, "comment_id": 76848408, "body": "No; it is perfectly defined code with a valid answer \u2014 though there is at least one major compiler that mishandles the valid C code.  There is no UB in the code.  (I&#39;m not claiming it is good code; it isn&#39;t.  And using your macros instead of what&#39;s in the question would prevent broken compilers from breaking on the valid code.  Those are tangential issues, though.)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1499290828, "post_id": 44935697, "comment_id": 76849111, "body": "The parentheses in <code>#define C (5)</code> seem unnecessary. is what context do you think they are required?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1499290832, "post_id": 44935697, "comment_id": 76849113, "body": "To avoid C standard maniacs (I am not one of them) discussion, general rule (IMHO) is: <i>*It is better to write to many brackets than to have one pair missing*</i> :)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1499290943, "post_id": 44935697, "comment_id": 76849167, "body": "Did you respond to my question in less than 4 seconds? extra parentheses do not hurt, I am just asking if you thought of something I did not."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1499291367, "post_id": 44935697, "comment_id": 76849348, "body": "@chqrlie No I did not. I just do not understand this minimalistic approach."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1499292163, "post_id": 44935697, "comment_id": 76849678, "body": "OK, so there is no misunderstanding."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1499287503, "creation_date": 1499287503, "answer_id": 44935697, "question_id": 44934586, "link": "https://stackoverflow.com/questions/44934586/understanding-macros-in-c/44935697#44935697", "title": "Understanding macros in C", "body": "<p>This an excellent example how do not use the preprocessor. To avoid confusions parenthesis should be used (not only in this case)</p>\n\n<pre><code>#define A (-B)\n#define B (-C)\n#define C (5)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 0, "last_activity_date": 1499294839, "creation_date": 1499294839, "answer_id": 44937189, "question_id": 44934586, "link": "https://stackoverflow.com/questions/44934586/understanding-macros-in-c/44937189#44937189", "title": "Understanding macros in C", "body": "<p>each #define preprocessing directive will insert in the environment of the preprocessor a variable assigned to a value made of a list of preprocessing directives.</p>\n\n<pre><code>{A -&gt; -B; B-&gt;-C; C-&gt;5}\n</code></pre>\n\n<p>is the environment in the moment when <code>A</code>  is evaluated.  Now, making the evaluation process of <code>A</code>, we have</p>\n\n<pre><code>  A  -&gt;  -B   (the identifier `A` is transformed in the stream of preprocessing tokens `-B`)\n -B  -&gt;  --C\n--C  -&gt;  --5\n-&gt;  5\n</code></pre>\n\n<p>and this one will not be evaluated any more by the Prosser's algorithm, as it has no more identifiers.</p>\n\n<p>So, reducing,</p>\n\n<pre><code> A-&gt;5\n</code></pre>\n\n<p>the stream <code>A</code> is converted in the stream <code>5</code> and this one will be converted from preprocessing tokens in C-tokens and sent further to the C compiler.</p>\n"}], "owner": {"reputation": 165, "user_id": 6644397, "user_type": "registered", "profile_image": "https://graph.facebook.com/339836286349003/picture?type=large", "display_name": "Anwar Hussain", "link": "https://stackoverflow.com/users/6644397/anwar-hussain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 1, "closed_date": 1529849653, "answer_count": 5, "score": 7, "last_activity_date": 1500197779, "creation_date": 1499283267, "last_edit_date": 1500197779, "question_id": 44934586, "link": "https://stackoverflow.com/questions/44934586/understanding-macros-in-c", "closed_reason": "Duplicate", "title": "Understanding macros in C", "body": "<p>Why is the output from the following code the value 5?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\n#define A -B\n#define B -C\n#define C 5\n\nint main()\n{\n  printf(\"The value of A is %d\\n\", A);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1499281966, "post_id": 44934240, "comment_id": 76844361, "body": "It&#39;s better to copy the errors from the Output tab of Visual Studio."}, {"owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "edited": false, "score": 4, "creation_date": 1499282181, "post_id": 44934240, "comment_id": 76844494, "body": "&quot;it is not clear enough or it it complete shit&quot;. Your question itself suffers from some of these problems. Using appropriate punctuation and capitalization, leaving out the complaints at the beginning, improving the punctuation on your code, and stripping out those functions that aren&#39;t problematic to create a Minimum Working Example would improve it."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1499282219, "post_id": 44934240, "comment_id": 76844520, "body": "The Output Tab is in a better format than the Error List for copying and pasting errors."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8261143, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tr998a5kPUg/AAAAAAAAAAI/AAAAAAAAAfY/Y66WF5QY70c/photo.jpg?sz=128", "display_name": "Nem Twohands", "link": "https://stackoverflow.com/users/8261143/nem-twohands"}, "edited": false, "score": 0, "creation_date": 1500485026, "post_id": 44934324, "comment_id": 77361632, "body": "Sorry for replying so late however I did fix it and you were a lot of help and from this post I have understood more so how to ask questions properly"}], "tags": [], "owner": {"reputation": 4007, "user_id": 1020484, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94c933a9303bcc5b6445fc9e310bcf57?s=128&d=identicon&r=PG", "display_name": "lcs", "link": "https://stackoverflow.com/users/1020484/lcs"}, "is_accepted": true, "score": 3, "last_activity_date": 1499282187, "creation_date": 1499282187, "answer_id": 44934324, "question_id": 44934240, "link": "https://stackoverflow.com/questions/44934240/multiple-errors-in-code/44934324#44934324", "title": "Multiple Errors In Code", "body": "<blockquote>\n  <p>function 'int FBullCowGame::GetCurrentTry(void) const' already has a body BullCowGame </p>\n</blockquote>\n\n<p>The function <code>int FBullCowGame::GetCurrentTry(void)</code> is defined twice (meaning the second time it is seen, it already has a body).</p>\n\n<pre><code>1. int FBullCowGame::GetCurrentTry() const { return MyCurrentTry;}\n\n2. int FBullCowGame::GetCurrentTry() const {\n        return MyCurrentTry;\n   }\n</code></pre>\n\n<blockquote>\n  <p>C2084 function 'int FBullCowGame::GetMaxTries(void) const' already has a body BullCowGame </p>\n</blockquote>\n\n<p>Same goes for the second error. </p>\n\n<blockquote>\n  <p>C3867 'FBullCowGame::Reset': non-standard syntax; use '&amp;' to create a pointer to member </p>\n</blockquote>\n\n<p>You missed the <code>()</code> when trying to call this method. This assumes that you're trying to reference the function itself, hence the error relating to pointer to member.</p>\n\n<pre><code>BCGame.Reset;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8261143, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tr998a5kPUg/AAAAAAAAAAI/AAAAAAAAAfY/Y66WF5QY70c/photo.jpg?sz=128", "display_name": "Nem Twohands", "link": "https://stackoverflow.com/users/8261143/nem-twohands"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 44934324, "answer_count": 1, "score": -5, "last_activity_date": 1499286447, "creation_date": 1499281913, "last_edit_date": 1499286447, "question_id": 44934240, "link": "https://stackoverflow.com/questions/44934240/multiple-errors-in-code", "title": "Multiple Errors In Code", "body": "<p>Theese are the errors</p>\n\n<p>I asked on the website where I am doing the course at my the answer I was given I either do not understand, it is not clear enough or it it complete shit, I have been looking for 2 days for solutions for this  and with all the edits I have done it has not worked]</p>\n\n<p>anyway here is  the answer I was given\n\"In the header you are trying to define functions multiple times. as you can see here on lines 6&amp;15, and  7&amp;18\" I have changed the int's around and it still does not work so could somebody possibly explain in more detail or just give me the correct code please:</p>\n\n<p>My Code is </p>\n\n<p>Main.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include \"FBullCowGame.h\"\nvoid PrintIntro();\nstd::string GetGuess();\nvoid PlayGame();\nbool AskToPlayAgain();\nFBullCowGame BCGame; // instantiate a new game\n\n// the entry point for our application\nint main() { \n bool bPlayAgain = false;\n do {\n PrintIntro();\n PlayGame();\n // TODO add game summary\n bPlayAgain = AskToPlayAgain();\n } while (bPlayAgain);\n return 0;\n}\n// introduce the game\nvoid PrintIntro() {\n constexpr int WORD_LENGTH = 5;\n std::cout &lt;&lt; \"Welme To Bulls and Cows, a fun word game.\\n\";\n std::cout &lt;&lt; \"Can you guess the \" &lt;&lt; WORD_LENGTH &lt;&lt; \" letter isogram I'm thinking of? \\n \";\n}\n//Play the game\nvoid PlayGame() {\n BCGame.Reset;\n int MaxTries = BCGame.GetMaxTries(); // checks how many tries the game has got\n std::cout &lt;&lt; \"MaxTries = \" &lt;&lt; MaxTries &lt;&lt; \"\\n\";\n // loop for the number of turns asking for our guesses \n // TODO make while looop\n for (int count = 1; count &lt;= MaxTries; count++) {\n std::string Guess = GetGuess(); // TODO check valid guesses\n std::cout &lt;&lt; \"Your guess was \" &lt;&lt; Guess &lt;&lt; \"\\n\";\n }\n return;\n}\n// get a guess from the player\nstd::string GetGuess() {\n int CurrentTry = BCGame.GetCurrentTry();\n std::cout &lt;&lt; \"Try \" &lt;&lt; CurrentTry &lt;&lt; \". Enter your guess: \";\n std::string Guess = \"\";\n std::getline(std::cin, Guess);\n return Guess;\n}\nbool AskToPlayAgain() {\n std::cout &lt;&lt; \"Would you like to play again? (y/n) \\n \";\n std::string Response = \"\";\n std::getline(std::cin, Response);\n return (Response[0] == 'y') || (Response[0] == 'Y');\n}\n</code></pre>\n\n<p>Header</p>\n\n<pre><code>#pragma once\n#include&lt;string&gt;\n// senpai notice me\nclass FBullCowGame { \npublic:\n FBullCowGame(); // contructor\n bool Reset(); // make a more rich return valuve\n int GetMaxTries()const;\n int GetCurrentTry()const;\n bool IsGameWon()const;\n bool CheckGuessCorrect(std::string); // make a rich return value\n // TODO make a method  to get bulls and cowws\n//Focus above ,not here\nprivate:\n int MyCurrentTry ; // find the contructor or somthing\n int MyMaxTries;\n};\n</code></pre>\n\n<p>Fbullcowgame,.cpp</p>\n\n<pre><code>#include \"FBullCowGame.h\"\nFBullCowGame::FBullCowGame() {\n Reset();\n}\nint FBullCowGame::GetMaxTries() const { return MyMaxTries;}\nint FBullCowGame::GetCurrentTry() const { return MyCurrentTry;}\nbool FBullCowGame::Reset() {\n\n constexpr int MyMaxTries = 8;\n MyCurrentTry = 1;\n return MyMaxTries;\n}\n\nint FBullCowGame::GetMaxTries() const {\n return;\n}\nint FBullCowGame::GetCurrentTry() const {\n return MyCurrentTry;\n}\nbool FBullCowGame::IsGameWon() const {\n return false;\n}\nbool FBullCowGame::CheckGuessCorrect(std::string) {\n return false;\n}\n</code></pre>\n\n<p>Severity Code Description Project File Line Suppression State  </p>\n\n<pre><code>Error C2084 function 'int FBullCowGame::GetCurrentTry(void) const' already has a body BullCowGame \nc:\\users\\nem\\documents\\unrealcorse\\section_2\\section_02\\bullcowgame\\fbullcowgame.cpp 22 \nError C2084 function 'int FBullCowGame::GetMaxTries(void) const' already has a body BullCowGame \nc:\\users\\nem\\documents\\unrealcorse\\section_2\\section_02\\bullcowgame\\fbullcowgame.cpp 18 \nError C3867 'FBullCowGame::Reset': non-standard syntax; use '&amp;' to create a pointer to member BullCowGame c:\\users\\nem\\documents\\unrealcorse\\section_2\\section_02\\bullcowgame\\main.cpp 33\n</code></pre>\n"}, {"tags": ["c++", "performance", "vector", "push-back"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 13, "creation_date": 1499281198, "post_id": 44934038, "comment_id": 76843932, "body": "<a href=\"http://en.cppreference.com/w/cpp/container/vector/reserve\" rel=\"nofollow noreferrer\">std::vector::reserve</a>"}, {"owner": {"reputation": 161, "user_id": 8137084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e1e0ed9fd4d58f824d53e7e8d182b?s=128&d=identicon&r=PG&f=1", "display_name": "anc", "link": "https://stackoverflow.com/users/8137084/anc"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1499281711, "post_id": 44934038, "comment_id": 76844210, "body": "@Fran&#231;oisAndrieux this still takes like 6 seconds :( is this one of those things I&#39;ll just have to accept?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1499281857, "post_id": 44934038, "comment_id": 76844295, "body": "That&#39;s about 35 nano seconds per <code>push_back</code> (for 172,490,752). You <i>are</i> copying over a hundred million floats."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1499282230, "post_id": 44934038, "comment_id": 76844527, "body": "@anc What are you running this on, and are you running a release build? Even with an online compiler  such as <a href=\"http://ideone.com/2XWATN\" rel=\"nofollow noreferrer\">ideone</a> or <a href=\"http://coliru.stacked-crooked.com/a/437a79ad304caaf0\" rel=\"nofollow noreferrer\">coliru</a>, the numbers should be much better than six seconds. What <i>else</i> are you doing while pushing floats into a vector? (i.e. where are they coming from?)."}, {"owner": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "edited": false, "score": 0, "creation_date": 1499282340, "post_id": 44934038, "comment_id": 76844597, "body": "might be a very stupid question so apologies but would adding a couple threads to do <code>push_back</code> help with speed? if the order doesn&#39;t matter?"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "edited": false, "score": 0, "creation_date": 1499282462, "post_id": 44934038, "comment_id": 76844677, "body": "@pyjg It wouldn&#39;t work. You would have race conditions all over"}, {"owner": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1499282513, "post_id": 44934038, "comment_id": 76844709, "body": "@Justin Yes thats why I said IF the order of insertion doesnt matter."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "edited": false, "score": 0, "creation_date": 1499282514, "post_id": 44934038, "comment_id": 76844712, "body": "@pyjg The only way you could make that work is if you created the vector to the correct size and had the threads only access sections of the vector."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "edited": false, "score": 2, "creation_date": 1499282543, "post_id": 44934038, "comment_id": 76844730, "body": "@pyjg <code>push_back</code> isn&#39;t atomic, so you  can get things much worse than out-of-order insertion"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1499282630, "post_id": 44934038, "comment_id": 76844792, "body": "You enabled the optimizer?"}, {"owner": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1499282655, "post_id": 44934038, "comment_id": 76844809, "body": "@Justin could you please explain what all could go wrong? I thought if you do a <code>reserve</code> and add threads to <code>push_back</code> then yes the order is wrong but what else can happen that is bad? Thanks :)"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "edited": false, "score": 2, "creation_date": 1499282896, "post_id": 44934038, "comment_id": 76844948, "body": "@pyjg With 2 threads A and B. A and B call <code>V.push_back()</code> with <code>1</code> and <code>2</code> respectively. In A&#39;s perspective, <code>V.size() == 0</code>, so it inserts <code>1</code> into position <code>0</code>. In B&#39;s perspective, since it is executing at the same time as A, <code>V.size() == 0</code>, so it inserts <code>2</code> into position <code>0</code> (in reality, it could even be worse because different bytes might be written in and you might get a completely different number; depends on if writing a <code>float</code> is atomic). Meanwhile, A increments <code>V.size</code> and B does so too. After this, <code>V.size()</code> could be <code>1</code>, <code>2</code>, or something else, and <code>V[0]</code> is unknown as well"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "edited": false, "score": 1, "creation_date": 1499282903, "post_id": 44934038, "comment_id": 76844951, "body": "@pyjg Suppose <code>push_back</code> checks what the last element is, then assigns to it, then increments it. If you have multiple threads going at once you could get multiple assignments to the same address and/or skipped entries, and probably worse things are possible in a real implementation."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1499282952, "post_id": 44934038, "comment_id": 76844985, "body": "@anc Do you know the size of the vector at compile time, or only run time?"}, {"owner": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1499283001, "post_id": 44934038, "comment_id": 76845013, "body": "@Justin that makes a lot of sense, thank you"}, {"owner": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1499283025, "post_id": 44934038, "comment_id": 76845023, "body": "@DanielH thank you for the explanation."}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "reply_to_user": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "edited": false, "score": 1, "creation_date": 1499283307, "post_id": 44934038, "comment_id": 76845162, "body": "@pyjg The basic problem is a <a href=\"https://stackoverflow.com/questions/34510/what-is-a-race-condition\">race condition</a>. Once you are aware of the definition it&#39;s easier to spot them."}, {"owner": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "reply_to_user": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1499283368, "post_id": 44934038, "comment_id": 76845198, "body": "@Blastfurnace I knew it had to be a race condition but didnt realize exactly WHAT it would be. Thanks!"}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1499356976, "post_id": 44934038, "comment_id": 76882947, "body": "close match: <a href=\"https://stackoverflow.com/questions/15952412/performance-degradation-due-to-default-initialisation-of-elements-in-standard-co\" title=\"performance degradation due to default initialisation of elements in standard co\">stackoverflow.com/questions/15952412/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4933, "user_id": 8217180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621a549160f738b81303a4a008ddd50?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Ribizel", "link": "https://stackoverflow.com/users/8217180/tobias-ribizel"}, "edited": false, "score": 1, "creation_date": 1499282715, "post_id": 44934232, "comment_id": 76844841, "body": "<code>push_back</code> and <code>emplace_back</code> may still be slower than raw access because they have to check if there is need for reallocation, even if there isn&#39;t. The performance penalty may be slight, but it is there ;)"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 4933, "user_id": 8217180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621a549160f738b81303a4a008ddd50?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Ribizel", "link": "https://stackoverflow.com/users/8217180/tobias-ribizel"}, "edited": false, "score": 1, "creation_date": 1499283255, "post_id": 44934232, "comment_id": 76845141, "body": "@Tobias maybe. Benchmarking the two solutions would be the way to tell."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1499364433, "post_id": 44934232, "comment_id": 76887634, "body": "I doubt <code>emplace_back</code> is any faster here, because floats are <a href=\"http://en.cppreference.com/w/cpp/concept/TriviallyCopyable\" rel=\"nofollow noreferrer\">trivially copyable</a>"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1499365000, "post_id": 44934232, "comment_id": 76887941, "body": "@Daniel H: isn&#39;t that what I already said when I said &quot;I doubt it will make any difference for a vector of float&quot;? The fact that it is trivially copyable was sort of implied.."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1499365966, "post_id": 44934232, "comment_id": 76888469, "body": "The implication is the other way around: because it is trivially copyable, there\u2019s no difference between a copy and a move, so it won\u2019t make any difference."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": true, "score": 10, "last_activity_date": 1499282216, "last_edit_date": 1499282216, "creation_date": 1499281883, "answer_id": 44934232, "question_id": 44934038, "link": "https://stackoverflow.com/questions/44934038/faster-alternative-to-push-backsize-is-known/44934232#44934232", "title": "Faster alternative to push_back(size is known)", "body": "<p>If you know the final size, then <a href=\"http://en.cppreference.com/w/cpp/container/vector/reserve\" rel=\"noreferrer\">reserve()</a> that size after you declare the vector. That way it only has to allocate memory once.</p>\n\n<p>Also, you may experiment with using <a href=\"http://en.cppreference.com/w/cpp/container/vector/emplace_back\" rel=\"noreferrer\">emplace_back()</a> although I doubt it will make any difference for a vector of <code>float</code>. But try it and benchmark it (with an optimized build of course - you <em>are</em> using an optimized build - right?).</p>\n"}, {"tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": false, "score": 1, "last_activity_date": 1499282306, "last_edit_date": 1499282306, "creation_date": 1499281899, "answer_id": 44934237, "question_id": 44934038, "link": "https://stackoverflow.com/questions/44934038/faster-alternative-to-push-backsize-is-known/44934237#44934237", "title": "Faster alternative to push_back(size is known)", "body": "<p><a href=\"http://www.boost.org/doc/libs/1_64_0/doc/html/container/non_standard_containers.html#container.non_standard_containers.stable_vector\" rel=\"nofollow noreferrer\"><code>::boost::container::stable_vector</code></a> Notice that allocating a contiguous block of 172 *4 MB might easily fail and requires quite a lot page joggling. Stable vector is essentially a list of smaller vectors or arrays of reasonable size. You may also want to populate it in parallel.</p>\n"}, {"comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1499282694, "post_id": 44934428, "comment_id": 76844827, "body": "This would require benchmarks; it&#39;s totally possible that this would be <i>slower</i>, as the vector would have to initialize every element, then overwrite it later."}, {"owner": {"reputation": 4933, "user_id": 8217180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621a549160f738b81303a4a008ddd50?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Ribizel", "link": "https://stackoverflow.com/users/8217180/tobias-ribizel"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1499282831, "post_id": 44934428, "comment_id": 76844909, "body": "If it were possible to initialize the storage without filling the vector explicitly, this would probably be the fastest solution ;) I&#39;ll check the assembly output first"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1499282915, "post_id": 44934428, "comment_id": 76844960, "body": "@Tobias How would you initialize the storage without filling it? Do you mean allocating the storage without filling it?"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1499283001, "post_id": 44934428, "comment_id": 76845012, "body": "@Fran&#231;oisAndrieux I think he means that if <code>std::vector::resize</code> didn&#39;t default initialize, for instance. Basically if it behaved like <code>reserve</code> but the length of the vector was also set to be the length of the capacity."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1499283028, "post_id": 44934428, "comment_id": 76845025, "body": "@Justin Thank you for the clarification."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1499287658, "post_id": 44934428, "comment_id": 76847616, "body": "I doubt there\u2019s a way that does that for all types, but it would be nice if there were a method to <a href=\"http://en.cppreference.com/w/cpp/language/default_initialization\" rel=\"nofollow noreferrer\">default initialize</a> a bunch of elements instead of initializing them to a specific value; for <code>float</code>s that would be a no-op. It looks like allocators in general don\u2019t have that option, though, so it\u2019s no wonder <code>vector</code> doesn\u2019t."}], "tags": [], "owner": {"reputation": 4933, "user_id": 8217180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621a549160f738b81303a4a008ddd50?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Ribizel", "link": "https://stackoverflow.com/users/8217180/tobias-ribizel"}, "is_accepted": false, "score": 1, "last_activity_date": 1499522143, "last_edit_date": 1499522143, "creation_date": 1499282625, "answer_id": 44934428, "question_id": 44934038, "link": "https://stackoverflow.com/questions/44934038/faster-alternative-to-push-backsize-is-known/44934428#44934428", "title": "Faster alternative to push_back(size is known)", "body": "<p>I have two answers for you:</p>\n\n<ol>\n<li>As previous answers have pointed out, using <code>reserve</code> to allocate the storage beforehand can be quite helpful, but:</li>\n<li><code>push_back</code> (or <code>emplace_back</code>) themselves have a performance penalty because during every call, they have to check whether the vector has to be reallocated. If you know the number of elements you will insert already, you can avoid this penalty by directly setting the elements using the access operator <code>[]</code></li>\n</ol>\n\n<p>So the most efficient way I would recommend is:</p>\n\n<ol>\n<li><p>Initialize the vector with the 'fill'-constructor:</p>\n\n<pre><code>std::vector&lt;float&gt; values(172490752, 0.0f);\n</code></pre></li>\n<li><p>Set the entries directly using the access operator:</p>\n\n<pre><code>values[i] = some_float;\n++i;\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1499355278, "post_id": 44935063, "comment_id": 76881749, "body": "You would need to use <code>std::unique_ptr&lt;float[]&gt;</code>, not <code>std::unique_ptr&lt;float&gt;</code>, to get the right destructor behavior."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1499357666, "post_id": 44935063, "comment_id": 76883463, "body": "@DanielH thanks for that, I did actually figure it out myself yesterday but never came back to fix the answer. It&#39;s fixed now."}], "tags": [], "owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "is_accepted": false, "score": 2, "last_activity_date": 1499357630, "last_edit_date": 1499357630, "creation_date": 1499285119, "answer_id": 44935063, "question_id": 44934038, "link": "https://stackoverflow.com/questions/44934038/faster-alternative-to-push-backsize-is-known/44935063#44935063", "title": "Faster alternative to push_back(size is known)", "body": "<p>The usual way of speeding up a <code>vector</code> when you know the size beforehand is to call <code>reserve</code> on it before using <code>push_back</code>. This eliminates the overhead of reallocating memory and copying the data every time the previous capacity is filled.</p>\n\n<p>Sometimes for very demanding applications this won't be enough. Even though <code>push_back</code> won't reallocate, it still needs to check the capacity every time. There's no way to know how bad this is without benchmarking, since modern processors are amazingly efficient when a branch is always/never taken.</p>\n\n<p>You could try <code>resize</code> instead of <code>reserve</code> and use array indexing, but the <code>resize</code> forces a default initialization of every element; this is a waste if you know you're going to set a new value into every element anyway.</p>\n\n<p>An alternative would be to use <code>std::unique_ptr&lt;float[]&gt;</code> and allocate the storage yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1499364350, "last_edit_date": 1499364350, "creation_date": 1499356018, "answer_id": 44953587, "question_id": 44934038, "link": "https://stackoverflow.com/questions/44934038/faster-alternative-to-push-backsize-is-known/44953587#44953587", "title": "Faster alternative to push_back(size is known)", "body": "<p>The reason <code>push_back</code> is slow is that it will need to copy all the data several times as the vector grows, and even when it doesn\u2019t need to copy data it needs to check. Vectors grow quickly enough that this doesn\u2019t happen often, but it still does happen. A rough rule of thumb is that every element will need to be copied on average once or twice; the earlier elements will need to be copied a lot more, but almost half the elements won\u2019t need to be copied at all.</p>\n\n<p>You can avoid the copying, but not the checks, by calling <code>reserve</code> on the vector when you create it, ensuring it has enough space. You can avoid both the copying and the checks by creating it with the right size from the beginning, by giving the number of elements to the vector constructor, and then inserting using indexing as <a href=\"https://stackoverflow.com/a/44934428/27302\">Tobias suggested</a>; unfortunately, this also goes through the vector an extra time initializing everything.</p>\n\n<p>If you know the number of floats at compile time and not just runtime, you could use an <a href=\"http://en.cppreference.com/w/cpp/container/array\" rel=\"nofollow noreferrer\"><code>std::array</code></a>, which avoids all these problems. If you only know the number at runtime, I would second <a href=\"https://stackoverflow.com/a/44935063/27302\">Mark\u2019s suggestion</a> to go with <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow noreferrer\"><code>std::unique_ptr&lt;float[]&gt;</code></a>. You would create it with</p>\n\n<pre><code>size_t size = /* Number of floats */;\nauto floats = unique_ptr&lt;float[]&gt;{new float[size]};\n</code></pre>\n\n<p>You don\u2019t need to do anything special to delete this; when it goes out of scope it will free the memory. In most respects you can use it like a vector, but it won\u2019t automatically resize.</p>\n"}, {"tags": [], "owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "is_accepted": false, "score": 1, "last_activity_date": 1499356945, "creation_date": 1499356945, "answer_id": 44953891, "question_id": 44934038, "link": "https://stackoverflow.com/questions/44934038/faster-alternative-to-push-backsize-is-known/44953891#44953891", "title": "Faster alternative to push_back(size is known)", "body": "<p>You could use a custom allocator which avoids default initialisation of all elements, as discussed in <a href=\"https://stackoverflow.com/a/15966795/1023390\">this answer</a>, in conjunction with ordinary element access:</p>\n\n<pre><code>const size_t N = 172490752;\nstd::vector&lt;float, uninitialised_allocator&lt;float&gt; &gt; vec(N);\nfor(size_t i=0; i!=N; ++i)\n    vec[i] = the_value_for(i);\n</code></pre>\n\n<p>This avoids (i) default initializing all elements, (ii) checking for capacity at every push, and (iii) reallocation, but at the same time preserves all the convenience of using <code>std::vector</code> (rather than <code>std::unique_ptr&lt;float[]&gt;</code>). However, the <code>allocator</code> template parameter is unusual, so you will need to use generic code rather than <code>std::vector</code>-specific code.</p>\n"}], "owner": {"reputation": 161, "user_id": 8137084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e1e0ed9fd4d58f824d53e7e8d182b?s=128&d=identicon&r=PG&f=1", "display_name": "anc", "link": "https://stackoverflow.com/users/8137084/anc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4205, "favorite_count": 0, "accepted_answer_id": 44934232, "answer_count": 6, "score": 1, "last_activity_date": 1499522143, "creation_date": 1499281132, "question_id": 44934038, "link": "https://stackoverflow.com/questions/44934038/faster-alternative-to-push-backsize-is-known", "title": "Faster alternative to push_back(size is known)", "body": "<p>I have a float vector. As I process certain data, I push it back.I always know what the size will be while declaring the vector.</p>\n\n<p>For the largest case, it is 172,490,752 floats. This takes about eleven seconds just to push_back everything.</p>\n\n<p>Is there a faster alternative, like a different data structure or something?</p>\n"}, {"tags": ["c++", "boost"], "comments": [{"owner": {"reputation": 4007, "user_id": 1020484, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94c933a9303bcc5b6445fc9e310bcf57?s=128&d=identicon&r=PG", "display_name": "lcs", "link": "https://stackoverflow.com/users/1020484/lcs"}, "edited": false, "score": 0, "creation_date": 1499281433, "post_id": 44933996, "comment_id": 76844069, "body": "<a href=\"https://isocpp.org/wiki/faq/templates#separate-template-fn-defn-from-decl\" rel=\"nofollow noreferrer\">This may be helpful</a>. <code>Server.cpp</code> when linked can&#39;t see the definition of <code>readMsg</code> because it doesn&#39;t include <code>Connection.cpp</code> where it is defined (and <code>readMsg</code> is a template). Either move the implementation of <code>readMsg</code> to the <code>Connection.h</code> header or clue the linker in on what template variations you&#39;ll be needing."}, {"owner": {"reputation": 190, "user_id": 2848762, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dcc36b70714a667ef2bebe32eb221a89?s=128&d=identicon&r=PG&f=1", "display_name": "Misha.P", "link": "https://stackoverflow.com/users/2848762/misha-p"}, "reply_to_user": {"reputation": 4007, "user_id": 1020484, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94c933a9303bcc5b6445fc9e310bcf57?s=128&d=identicon&r=PG", "display_name": "lcs", "link": "https://stackoverflow.com/users/1020484/lcs"}, "edited": false, "score": 0, "creation_date": 1499281966, "post_id": 44933996, "comment_id": 76844360, "body": "@Ics, what is the explicit class specifier for boost::bind in the latter case? That is, what do I write instead of <code>int</code> here: <code>template void foo&lt;int&gt;();</code>"}, {"owner": {"reputation": 4007, "user_id": 1020484, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94c933a9303bcc5b6445fc9e310bcf57?s=128&d=identicon&r=PG", "display_name": "lcs", "link": "https://stackoverflow.com/users/1020484/lcs"}, "edited": false, "score": 0, "creation_date": 1499282315, "post_id": 44933996, "comment_id": 76844582, "body": "Heh, you can decipher it from the error message: <code>class boost::_bi::bind_t&lt;void,class boost::_mfi::mf1&lt;void,class Server,class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt; &gt;,class boost::_bi::list2&lt;class boost::_bi::value&lt;class Server *&gt;,struct boost::arg&lt;1&gt; &gt; &gt; </code>. Due to this, it is probably easier to just move the implementation to the header. Or you could likely use <code>decltype</code>."}, {"owner": {"reputation": 190, "user_id": 2848762, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dcc36b70714a667ef2bebe32eb221a89?s=128&d=identicon&r=PG&f=1", "display_name": "Misha.P", "link": "https://stackoverflow.com/users/2848762/misha-p"}, "reply_to_user": {"reputation": 4007, "user_id": 1020484, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94c933a9303bcc5b6445fc9e310bcf57?s=128&d=identicon&r=PG", "display_name": "lcs", "link": "https://stackoverflow.com/users/1020484/lcs"}, "edited": false, "score": 0, "creation_date": 1499282491, "post_id": 44933996, "comment_id": 76844698, "body": "@Ics, yeah, my thoughts exactly; thought there was a shortcut. Thank you. That solved my problem."}], "owner": {"reputation": 190, "user_id": 2848762, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dcc36b70714a667ef2bebe32eb221a89?s=128&d=identicon&r=PG&f=1", "display_name": "Misha.P", "link": "https://stackoverflow.com/users/2848762/misha-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499281359, "creation_date": 1499280963, "last_edit_date": 1499281359, "question_id": 44933996, "link": "https://stackoverflow.com/questions/44933996/boost-bind-callbacks-linker-error", "title": "Boost bind callbacks linker error", "body": "<p>Working on a chat I want to use callbacks as a way to \"transport\" messages from a particular client's stream, to a server, which should later send that message to other clients. <br>\nHere's the code for that functionality:</p>\n\n<pre><code>void Server::waitForConnection(){\n\n    Connection::pointer connect = Connection::create(accept.get_io_service());\n\n    accept.async_accept(connect-&gt;getSocket(), boost::bind(&amp;Server::acceptConnection, this, connect, boost::asio::placeholders::error));\n}\n\n\nvoid Server::acceptConnection(Connection::pointer connection, const boost::system::error_code&amp; error){\n    if (!error)\n    {\n        connections.push_back(connection);\n        connection-&gt;readMsg(boost::bind(&amp;Server::msgHandler,this, boost::placeholders::_1));\n    }\n    else\n    {\n        std::cout &lt;&lt; \"Server::acceptConnection error\" &lt;&lt; std::endl;\n    }\n    waitForConnection();\n\n}\n</code></pre>\n\n<p>--</p>\n\n<pre><code>template&lt;typename T&gt; void Connection::readMsg(T msgHandler){\n    const char delim = '\\n';\n    //boost::asio::async_read_until(soc, boost::asio::buffer(arr), delim);\n    std::string tmp;\n    do{\n        boost::asio::read_until(soc, buf, delim);\n        std::istream is(&amp;buf);\n        std::getline(is,tmp);\n        msgHandler(tmp);\n    } while (tmp != \"leave\");\n}\n</code></pre>\n\n<p>Upon compilation I get the following error:</p>\n\n<blockquote>\n  <p>Server.obj : error LNK2019: unresolved external symbol \"public: void __thiscall Connection::readMsg,class std::allocator > >,class boost::_bi::list2,struct boost::arg&lt;1> > > >(class boost::_bi::bind_t,class std::allocator > >,class boost::_bi::list2,struct boost::arg&lt;1> > >)\" (??$readMsg@V?$bind_t@XV?$mf1@XVServer@@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@_mfi@boost@@V?$list2@V?$value@PAVServer@@@_bi@boost@@U?$arg@$00@3@@_bi@3@@_bi@boost@@@Connection@@QAEXV?$bind_t@XV?$mf1@XVServer@@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@_mfi@boost@@V?$list2@V?$value@PAVServer@@@_bi@boost@@U?$arg@$00@3@@_bi@3@@_bi@boost@@@Z) referenced in function \"private: void __thiscall Server::acceptConnection(class boost::shared_ptr,class boost::system::error_code const &amp;)\" (?acceptConnection@Server@@AAEXV?$shared_ptr@VConnection@@@boost@@ABVerror_code@system@3@@Z)</p>\n</blockquote>\n\n<p>This is the minimal, compilable, code I used to try and recreate the problem:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;boost/bind.hpp&gt;\n#include &lt;cmath&gt;\n\nusing namespace std;\n\nclass A;\nclass B;\nclass C;\n\nclass C{\npublic:\n    template &lt;typename T&gt;void init(T t);\n};\n\nclass B{\npublic:\ntemplate &lt;typename T&gt;void init(T t);\nvoid what(string s);\n};\n\nvoid B::what(string s){\n    cout &lt;&lt; \"in what \" &lt;&lt; s.c_str() &lt;&lt; endl;\n}\n\nclass A{\n    B obj;\n    int id;\npublic:\n    void init();\n    void func(string s);\n\n\n};\n\nvoid A::func(string s){\n\n    cout &lt;&lt; s.c_str() &lt;&lt; \" yes \" &lt;&lt;id&lt;&lt; endl;\n}\nvoid A::init(){\n    id = rand()%1024;\n    obj.init(boost::bind(&amp;A::func, this, boost::placeholders::_1));\n}\n\ntemplate &lt;typename T&gt;void B::init(T t){\n    //A a;\n    //(a.*t)();\n    C c;\n    c.init(boost::bind(&amp;B::what, this, boost::placeholders::_1));\n    t(\"from B\");\n}\n\ntemplate &lt;typename T&gt;void C::init(T t){\n    //A a;\n    //(a.*t)();\n    t(\"from C\");\n}\n\nint main(){\n    A a;\n    a.init();\n    a.func(\"main\");\n    system(\"pause\");\n}\n</code></pre>\n\n<p>However it fails to serve its purpose, which makes me turn to SO and ask what might actually be causing the linker error I get. <br>\nFull code: <br>\n<a href=\"https://pastebin.com/YCmL9pNm\" rel=\"nofollow noreferrer\">Connection.cpp</a><br>\n<a href=\"https://pastebin.com/dKCpseq5\" rel=\"nofollow noreferrer\">Connection.h</a><br>\n<a href=\"https://pastebin.com/Bcn7V297\" rel=\"nofollow noreferrer\">Server.cpp</a><br>\n<a href=\"https://pastebin.com/LKJgH0S9\" rel=\"nofollow noreferrer\">Server.h</a><br>\n<a href=\"https://pastebin.com/GL2XJZ6G\" rel=\"nofollow noreferrer\">main.cpp</a></p>\n"}, {"tags": ["c++", "file"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1499280641, "post_id": 44933867, "comment_id": 76843601, "body": "<i>&quot;I&#39;m not entirely sure if I&#39;m doing file extraction correct&quot;</i> It&#39;s done correctly, what makes you doubt?"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1499280856, "post_id": 44933867, "comment_id": 76843728, "body": "<i>&quot;I&#39;m getting lldb as my output for this code.&quot;</i> What is <code>lldb</code> actually?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1499280914, "post_id": 44933867, "comment_id": 76843764, "body": "You didn&#39;t ask a question. The only oddities I see in this code are: (a) you never included <code>&lt;string&gt;</code>, which is required for using <code>std::string</code>, and (b) you seem bent on discarding the first word in your file, as it will never be printed to the console."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1499280944, "post_id": 44933867, "comment_id": 76843789, "body": "@user0042 It&#39;s the LLVM debugger, the default on mac OSX (among others)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1499281237, "post_id": 44933867, "comment_id": 76843958, "body": "@user0042   &quot;It&#39;s done correctly&quot;  - only if you intend not print the first word."}, {"owner": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1499281344, "post_id": 44933867, "comment_id": 76844022, "body": "Line  <code>sourceFile &gt;&gt; words;</code> before while loop is probably redundant. It will just throw away first line."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1499281469, "post_id": 44933867, "comment_id": 76844082, "body": "@Marek The first word, not the first line."}, {"owner": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1499281653, "post_id": 44933867, "comment_id": 76844182, "body": "@NeilButterworth you are right. Even though in this program it will be also line as there is one word per line."}, {"owner": {"reputation": 11, "user_id": 7899052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f40710fa637109c3f12b6d7e5dd3bb5?s=128&d=identicon&r=PG&f=1", "display_name": "landucci", "link": "https://stackoverflow.com/users/7899052/landucci"}, "edited": false, "score": 0, "creation_date": 1499282240, "post_id": 44933867, "comment_id": 76844534, "body": "Every time the while loop is true shouldn&#39;t the code print the word from the file not 11db?"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1499282995, "post_id": 44933867, "comment_id": 76845008, "body": "@landucci <code>11db</code> again? Nothing in your code would actually lead to that output."}], "owner": {"reputation": 11, "user_id": 7899052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f40710fa637109c3f12b6d7e5dd3bb5?s=128&d=identicon&r=PG&f=1", "display_name": "landucci", "link": "https://stackoverflow.com/users/7899052/landucci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499280831, "creation_date": 1499280505, "last_edit_date": 1499280831, "question_id": 44933867, "link": "https://stackoverflow.com/questions/44933867/getting-information-from-input-file-c", "title": "Getting Information from input file C++", "body": "<p>I'm pretty new to coding so I'm not entirely sure if I'm doing file extraction correct. I'm getting lldb as my output for this code. Instead of prompting the user with the words in the hangman.dat file. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;cstdlib&gt;\nusing namespace std;\n\nint main()\n{\n    ifstream sourceFile;\n    sourceFile.open(\"hangman.dat\");\n\n    if (sourceFile.fail())\n    {\n        cout&lt;&lt;\"File didn't open\" ;\n    }\n\n    else\n    {\n        string words;\n        sourceFile &gt;&gt; words;\n        while(sourceFile&gt;&gt;words)\n        {\n            cout&lt;&lt;words&lt;&lt;endl;\n        }\n    }\n\n}\n</code></pre>\n\n<p>The file hangman.dat contains the following information:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Fall\nleaves\nThanksgiving\npumpkins\nturkey\nHalloween\n</code></pre>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1499281162, "post_id": 44933671, "comment_id": 76843911, "body": "Where can we find the image that you&#39;re using for testing, <code>im.jpg</code>?"}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1499281764, "post_id": 44933671, "comment_id": 76844247, "body": "I was not able to reproduce this issue using <a href=\"http://imgur.com/a/2iV3q\" rel=\"nofollow noreferrer\">this sample image</a> with your code. <a href=\"http://imgur.com/a/MWkIw\" rel=\"nofollow noreferrer\">Result</a>."}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 1, "creation_date": 1499284221, "post_id": 44933671, "comment_id": 76845717, "body": "Check your linker properties. You either linked OpenCV debug library in release, or viceversa. Or you&#39;re using a version of OpenCV compiled with a different compiler / architecture"}, {"owner": {"reputation": 11, "user_id": 7765246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab096ea5ad66bb852240daf9329f416c?s=128&d=identicon&r=PG&f=1", "display_name": "Heshan", "link": "https://stackoverflow.com/users/7765246/heshan"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1499285731, "post_id": 44933671, "comment_id": 76846603, "body": "@Miki I have used the same linker properties that worked for other projects.. And I have included both opencv_world320.lib/320d.lib as additional dependencies which should not give any issue right?"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 1, "creation_date": 1499286089, "post_id": 44933671, "comment_id": 76846821, "body": "you need to add <b>only</b> opencv_world320.lib in release, and <b>only</b> opencv_world320d.lib in debug"}, {"owner": {"reputation": 11, "user_id": 7765246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab096ea5ad66bb852240daf9329f416c?s=128&d=identicon&r=PG&f=1", "display_name": "Heshan", "link": "https://stackoverflow.com/users/7765246/heshan"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1499311096, "post_id": 44933671, "comment_id": 76854667, "body": "@Miki I tried it.. does not make any difference"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7765246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab096ea5ad66bb852240daf9329f416c?s=128&d=identicon&r=PG&f=1", "display_name": "Heshan", "link": "https://stackoverflow.com/users/7765246/heshan"}, "edited": false, "score": 0, "creation_date": 1499285291, "post_id": 44934938, "comment_id": 76846345, "body": "I got the same error set even with your image.. But what is the matter with using VS 2013? Other opencv projects worked just fine with it.."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 11, "user_id": 7765246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab096ea5ad66bb852240daf9329f416c?s=128&d=identicon&r=PG&f=1", "display_name": "Heshan", "link": "https://stackoverflow.com/users/7765246/heshan"}, "edited": false, "score": 1, "creation_date": 1499285936, "post_id": 44934938, "comment_id": 76846720, "body": "@Heshan You&#39;re using OpenCV 3.20 for your project. The shipped binaries for OpenCV 3.20 were compiled for Visual Studio SDK 14.x.yyyy, which corresponds to either VS2015 (14.0.yyyy) or VS2017 (14.1.yyyy), which are binary compatible with each other, but not to other versions of Visual Studio. If you&#39;re compiling and building the OpenCV object files yourself using Visual Studio 2013, then you need to inspect the compilation process and make sure you aren&#39;t making any mistakes there."}, {"owner": {"reputation": 11, "user_id": 7765246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab096ea5ad66bb852240daf9329f416c?s=128&d=identicon&r=PG&f=1", "display_name": "Heshan", "link": "https://stackoverflow.com/users/7765246/heshan"}, "edited": false, "score": 0, "creation_date": 1499333873, "post_id": 44934938, "comment_id": 76865520, "body": "I did it the other way round by using opencv 2.4.11 (vc12). Now release mode does not make any errors.. But the debug mode gives an opencv error in calling drawkeypoints(). I used <code>kp.release(1000)</code> which contains the growth of kp vector to some extent, but larger than that when run in release mode.. What is the link between this abnormal bahavior of the vector object (or FAST() )  and the mode of execution? Now the VS and OpenCV versions could not be the matter, could they?"}], "tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": false, "score": 0, "last_activity_date": 1499284662, "creation_date": 1499284662, "answer_id": 44934938, "question_id": 44933671, "link": "https://stackoverflow.com/questions/44933671/access-violation-reading-location-0xffffffffffffffff-when-using-fast-feature-det/44934938#44934938", "title": "Access violation reading location 0xFFFFFFFFFFFFFFFF when using FAST feature detector in OpenCV", "body": "<p>I was unable to reproduce this issue either using my own image or using the image you provided. I therefore have to conclude that there's a problem with your build environment.</p>\n\n<ul>\n<li>Make sure that you've set up your project includes and libraries correctly, including the shared libraries that OpenCV uses by default.</li>\n<li>Make sure that you're using Visual Studio 2015 (or the binary-compatible VS2017) to compile your code.</li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 7765246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab096ea5ad66bb852240daf9329f416c?s=128&d=identicon&r=PG&f=1", "display_name": "Heshan", "link": "https://stackoverflow.com/users/7765246/heshan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 932, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499284662, "creation_date": 1499279850, "question_id": 44933671, "link": "https://stackoverflow.com/questions/44933671/access-violation-reading-location-0xffffffffffffffff-when-using-fast-feature-det", "title": "Access violation reading location 0xFFFFFFFFFFFFFFFF when using FAST feature detector in OpenCV", "body": "<p>I am beginner using opencv, and was using the FAST feature detector in opencv to simply get the keypoints of an image. </p>\n\n<pre><code>#include \"opencv2/highgui/highgui.hpp\"\n#include \"opencv2/imgproc/imgproc.hpp\"\n#include \"opencv2/features2d.hpp\"\n\nstd::vector&lt;cv::KeyPoint&gt; kp;\n\nint main()\n{\n    cv::Mat img = cv::imread(\"im.jpg\", 0);\n    cv::FAST(img, kp, 100, true);\n\n    cv::Mat img2;\n    cv::drawKeypoints(img, kp, img2 , CV_RGB(255, 0, 0));\n    cv::imshow(\"Display\", img2);\n    cv::waitKey(0);\n    cv::destroyWindow(\"Display\");\n\n    return 0;\n}\n</code></pre>\n\n<p>But when debugging the code (Debug mode): \nI found out that the vector kp (passed as the keypoints vector) in to FAST() has a large size ( kp = { size=658812287755660302 }) which is not possible. But the image denoting correct keypoints is generated. The above mentioned access violation error message comes at the end of debugging.</p>\n\n<p>In Release mode:\nThe code runs fine at first showing the keypoints in the image. At the end when image window is closed, the program is crashed. When debugged, kp has a reasonable size (kp = { size=427 }).</p>\n\n<p>When the code is run in debug mode without debugging, an application error pops out stating that memory at 0xffffffff could not be read.</p>\n\n<p>The call stack is as shown <a href=\"https://i.stack.imgur.com/FNNUr.png\" rel=\"nofollow noreferrer\">here</a>, which doesn't make any sense to me.</p>\n\n<p>What am I doing wrong? Is it related to the way I'm initializing the vector or something else?  </p>\n"}, {"tags": ["c++", "opencv", "image-processing"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1499280004, "post_id": 44933599, "comment_id": 76843256, "body": "<i>&quot;my following code doesn&#39;t work&quot;</i> is not a valid problem statement. Please visit the <a href=\"http://stackoverflow.com/help\">help center</a> and read the section <a href=\"http://stackoverflow.com/help/how-to-ask\">how do I ask a good question</a>."}, {"owner": {"reputation": 332, "user_id": 2319867, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/02c4e8da23b104f1593cc00dc79cbf1f?s=128&d=identicon&r=PG", "display_name": "Igor Bobko", "link": "https://stackoverflow.com/users/2319867/igor-bobko"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1499280359, "post_id": 44933599, "comment_id": 76843446, "body": "The Code above can only identify candies if they don&#39;t intersect. But I don&#39;t have any thoughts about what to do if they intersect."}, {"owner": {"reputation": 1820, "user_id": 6411572, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UW5c3vqf1Uk/AAAAAAAAAAI/AAAAAAAACVM/MxyCKe2XJJM/photo.jpg?sz=128", "display_name": "Shawn Mathew", "link": "https://stackoverflow.com/users/6411572/shawn-mathew"}, "edited": false, "score": 0, "creation_date": 1499285121, "post_id": 44933599, "comment_id": 76846261, "body": "Please post intermediate images like the contours(using draw contours), the result of minEnclosingCircle, etc"}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1499321425, "post_id": 44933599, "comment_id": 76857701, "body": "use HSV color space and segment the hue channel. Then find ellipses."}, {"owner": {"reputation": 17633, "user_id": 2858170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4263428b9b0e0aed365e264c7a2b044?s=128&d=identicon&r=PG&f=1", "display_name": "Piglet", "link": "https://stackoverflow.com/users/2858170/piglet"}, "edited": false, "score": 0, "creation_date": 1499344659, "post_id": 44933599, "comment_id": 76873171, "body": "Please read <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why &quot;Can anyone help me?&quot; is not an actual question</a>"}, {"owner": {"reputation": 17633, "user_id": 2858170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4263428b9b0e0aed365e264c7a2b044?s=128&d=identicon&r=PG&f=1", "display_name": "Piglet", "link": "https://stackoverflow.com/users/2858170/piglet"}, "edited": false, "score": 0, "creation_date": 1499345000, "post_id": 44933599, "comment_id": 76873449, "body": "This is a very trivial problem. If you cannot solve it you should definitely get some basic knowledge about image-processing..."}], "answers": [{"tags": [], "owner": {"reputation": 5865, "user_id": 45269, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/25c35e90595b236da0fee29edb70db7f?s=128&d=identicon&r=PG", "display_name": "Headcrab", "link": "https://stackoverflow.com/users/45269/headcrab"}, "is_accepted": false, "score": 0, "last_activity_date": 1499739587, "creation_date": 1499739587, "answer_id": 45024313, "question_id": 44933599, "link": "https://stackoverflow.com/questions/44933599/how-to-detect-all-candies-with-opencv-and-count-them/45024313#45024313", "title": "How to detect all candies with opencv and count them", "body": "<p>This is probably not a very good solution (it only works under assumption that candies of the same color never overlap). (There's also <a href=\"http://docs.opencv.org/3.1.0/d3/db4/tutorial_py_watershed.html\" rel=\"nofollow noreferrer\">this article</a> about using distance transform and watershed, but I couldn't make it fork for this, maybe the candies overlap too much?)</p>\n\n<ol>\n<li>Remove the white background (especially because it has a lot of noise and JPEG artifacts).</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/pBdog.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pBdog.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"2\">\n<li>Convert to HSV and take the H channel (as suggested in the comments). Hue is useful here, because it <em>sort of</em> represents a color with a single value (hue) instead of three (red, green, blue), ignoring, to a degree, all those surface irregularities. You probably can't distinguish some of the ellipses below from the background, but don't worry, your computer can.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/goZpC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/goZpC.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"3\">\n<li>For a narrow range of H (say, [1, 20]), find contours big enough (in terms of their area) to be a single candy, but small enough not to be more than one candy. Repeat for H in range [21, 40], then [41, 60], and so on, until you reach the top hue value of 179. The contours are not too good, but good enough for counting. You can probably improve them by doing dilate/erode at every step to get rid of the junk, or something, if you need to.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/ZUl5d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZUl5d.png\" alt=\"enter image description here\"></a></p>\n\n<p>The Python code to show how it works:</p>\n\n<pre><code>import cv2\nimport numpy as np\n\n#get only contours of more or less the single candy size\n#noise is not included because its area is too small\n#overlapping candies are not included because their area is too big\n#probably there are smarter ways (area/circumference ratio, ellipse fitting, etc.)\ndef get_contours(img):\n    area_threshold_max = 120*120  #nice hard-coded empirical values\n    area_threshold_min = 50*50\n\n    _, contours, _ = cv2.findContours(img, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)\n    areas = [cv2.contourArea(c) for c in contours]\n    contours = [c for n, c in enumerate(contours) if area_threshold_min &lt; areas[n] &lt; area_threshold_max]\n    return contours\n\n#remove background\nimg_g = cv2.imread(\"candy.jpg\", 0)  #read as grayscale\n_, thresh = cv2.threshold(img_g, 235, 1, cv2.THRESH_BINARY_INV)  #mask to include everything that isn't too white\nimg = cv2.imread(\"candy.jpg\")  #read again as a color image\nblack = np.zeros(img.shape).astype(img.dtype)  #black image to combine with\nimg = cv2.bitwise_or(img, black, mask = thresh)\n\n#convert to HSV and take only the H value\nimg = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)[:, :, 0]\n\n#find contours of a more or less appropriate size within a narrow H range,\n#remove them from the image, increment H, repeat\ncontours_all = []\nh_step = 20\nfor h_start in range(0, 180, h_step):\n    rng = np.zeros(img.shape).astype(np.uint8)\n    rng = cv2.inRange(img, h_start + 1, h_start + h_step)\n    contours = get_contours(rng)\n    contours_all += contours\n\n#draw our contours with their numbers on top of the original image\nimg_to_draw = cv2.imread(\"candy.jpg\")\ncv2.drawContours(img_to_draw, contours_all, -1, (0, 0, 0), 2)\nfor i, cnt in enumerate(contours_all):\n    (x, y), radius = cv2.minEnclosingCircle(cnt)\n    cv2.putText(img_to_draw, \"%d\" % (i + 1), (int(x-20), int(y+10)), cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 0, 0), 3)\ncv2.putText(img_to_draw, \"%d candies\" % len(contours_all), (5, 30), cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 0, 0), 3)\ncv2.imwrite(\"result2.png\", img_to_draw)\n</code></pre>\n"}], "owner": {"reputation": 332, "user_id": 2319867, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/02c4e8da23b104f1593cc00dc79cbf1f?s=128&d=identicon&r=PG", "display_name": "Igor Bobko", "link": "https://stackoverflow.com/users/2319867/igor-bobko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 725, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499739587, "creation_date": 1499279635, "last_edit_date": 1499283012, "question_id": 44933599, "link": "https://stackoverflow.com/questions/44933599/how-to-detect-all-candies-with-opencv-and-count-them", "title": "How to detect all candies with opencv and count them", "body": "<p>I have the following picture\n<a href=\"https://i.stack.imgur.com/IWh8H.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IWh8H.jpg\" alt=\"Candies\"></a>\nAnd I try to count all candies, but some of them intersect. And my following code doesn't work. The Code below can only identify candies if they don't intersect. But I can't have any thoughts about what to do if they intersect</p>\n\n<pre><code>int main( int argc, char** argv )\n{\nMat src = imread(\"C:\\\\data\\\\Assignment1A.jpg\",0); // reads image from file\nMat dst = Mat::zeros(src.rows, src.cols, CV_8UC3);\n\ncv::Scalar   min(245, 0, 0);\ncv::Scalar   max(255, 255, 255);\ncv::inRange( src, min, max, dst);\n\nnamedWindow( \"Source\", 1 );\nimshow( \"Source\", dst );\n\nvector&lt;vector&lt;Point&gt; &gt; contours;\nvector&lt;Vec4i&gt; hierarchy;\n\nfindContours( dst, contours, hierarchy,\n    CV_RETR_CCOMP, CV_CHAIN_APPROX_SIMPLE );\n\ncout &lt;&lt;contours.size();\nsize_t count = contours.size();\nint i = 0;\nfor(size_t i = 0; i &lt; contours.size(); i++) {\n    cv::Point2f c;\n    float r;\n    cv::minEnclosingCircle( contours[i], c, r);\n    if (r &gt; 10) {\n        i++;        }\n}\n\ncout &lt;&lt; i &lt;&lt; \" candies\";\nwaitKey(0);\nreturn 0;\n}\n</code></pre>\n\n<p>Can anyone help me how to solve this problem?</p>\n"}, {"tags": ["c++", "file"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1499278889, "post_id": 44933390, "comment_id": 76842668, "body": "It means a reference to the stream you are writing to."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1499278920, "post_id": 44933390, "comment_id": 76842681, "body": "And please don&#39;t use cplusplus as a reference, or for anything else."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1499278968, "post_id": 44933390, "comment_id": 76842715, "body": "Give <a href=\"http://en.cppreference.com/w/cpp/io/basic_ostream/write\" rel=\"nofollow noreferrer\">this reference a try</a>.  Also, do you know what you get then you do <code>*this</code>?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1499281294, "post_id": 44933390, "comment_id": 76843984, "body": "&quot;What return ostream::write?&quot; - It returns <code>basic_ostream&amp;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 219, "user_id": 5553433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/vYn6W.jpg?s=128&g=1", "display_name": "L. Dai", "link": "https://stackoverflow.com/users/5553433/l-dai"}, "is_accepted": false, "score": 2, "last_activity_date": 1499279811, "creation_date": 1499279811, "answer_id": 44933658, "question_id": 44933390, "link": "https://stackoverflow.com/questions/44933390/what-return-ostreamwrite/44933658#44933658", "title": "What return ostream::write?", "body": "<pre><code>this\n</code></pre>\n\n<p>is a pointer to the current object invoked.</p>\n\n<pre><code>*this\n</code></pre>\n\n<p>dereferences the pointer.</p>\n\n<p>This is often used for \"chaining\".\nFor instance:</p>\n\n<pre><code>cout&lt;&lt;1&lt;&lt;2&lt;&lt;3&lt;&lt;4&lt;&lt;5;\n</code></pre>\n\n<p>operator&lt;&lt; is invoked in cout:\n    cout&lt;&lt;1\nwill print 1 and return cout, then we'll have:</p>\n\n<pre><code>cout&lt;&lt;2&lt;&lt;3&lt;&lt;4&lt;&lt;5;\n</code></pre>\n\n<p>and so on.</p>\n"}, {"tags": [], "owner": {"reputation": 3023, "user_id": 5587393, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1d83bf6603c6c7a002ab8e18e418e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Luzzara", "link": "https://stackoverflow.com/users/5587393/marco-luzzara"}, "is_accepted": true, "score": 0, "last_activity_date": 1499281107, "creation_date": 1499281107, "answer_id": 44934031, "question_id": 44933390, "link": "https://stackoverflow.com/questions/44933390/what-return-ostreamwrite/44934031#44934031", "title": "What return ostream::write?", "body": "<p>Generally in C++, methods' classes that don't have to return a specific value, like in this case (or with <code>string</code> for example), return <code>*this</code>. </p>\n\n<blockquote>\n  <p>Every object in C++ has access to its own address through an important pointer called this pointer. The this pointer is an implicit parameter to all member functions. Therefore, inside a member function, this may be used to refer to the invoking object.</p>\n</blockquote>\n\n<p>Thanks to <code>this</code>, you can use the method chaining, this is an example:</p>\n\n<pre><code>char c[]=\"This this this\";\nstd::cout &lt;&lt; (std::cout.write(c,4) &lt;&lt; \" hello \") &lt;&lt; std::endl;\n</code></pre>\n\n<p>Output:\n<code>This hello 0x600e08</code></p>\n\n<p>In this example I used operator chaining on purpose, but it's the same with methods.</p>\n\n<p><code>0x600e08</code> is address of your <code>basic_ostream</code> object.</p>\n"}], "owner": {"reputation": 153, "user_id": 6317008, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d70250c4115fb023f34da97e04ba8782?s=128&d=identicon&r=PG&f=1", "display_name": "Simone G", "link": "https://stackoverflow.com/users/6317008/simone-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 44934031, "answer_count": 2, "score": -2, "last_activity_date": 1499281107, "creation_date": 1499278815, "question_id": 44933390, "link": "https://stackoverflow.com/questions/44933390/what-return-ostreamwrite", "title": "What return ostream::write?", "body": "<p>Cplusplus say \"The ostream object (* this)\" but I do not understand. Return ostream object's pointer? I have try print this value with cout function but I print always 0. And how can this value be useful?</p>\n"}, {"tags": ["c++", "string", "winapi"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1499278091, "post_id": 44933102, "comment_id": 76842229, "body": "<code>&quot;The selected folder is : &quot;+lp</code> - this makes no sense. There&#39;s no such <code>+</code> operation in C++. What are you trying to do by that <code>+</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1499278595, "post_id": 44933187, "comment_id": 76842504, "body": "The <code>const_cast</code> is not necessary, since <code>MessageBox</code> takes an <code>LPCSTR</code> (<code>const char*</code>) as input, not <code>LPSTR</code> (<code>char*</code>)."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 3, "last_activity_date": 1499278810, "last_edit_date": 1499278810, "creation_date": 1499278124, "answer_id": 44933187, "question_id": 44933102, "link": "https://stackoverflow.com/questions/44933102/invalid-operands-of-types-const-char-26-and-lpstr/44933187#44933187", "title": "invalid operands of types &#39;const char [26]&#39; and &#39;LPSTR &#39;", "body": "<p><code>LPSTR</code> represents a <code>char *</code>-type, and string literal <code>\"The ...\"</code> denotes a <code>const char[26]</code>. You get the error because in your expression <code>\"The selected folder is : \"+lp</code>, you try to \"concatenate\" them with operator <code>+</code>, which is not supported for members of type <code>const char*</code> or <code>char *</code>. </p>\n\n<p>Operator <code>+</code> is, however, supported for members of type <code>std::string</code>; So you could work around this by, for example, the following code:</p>\n\n<pre><code>string folder = \"The selected folder is : \" + str;\nMessageBox ( NULL, folder.c_str(), \"Bye!\", MB_OK );\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1499278490, "last_edit_date": 1499278490, "creation_date": 1499278147, "answer_id": 44933196, "question_id": 44933102, "link": "https://stackoverflow.com/questions/44933102/invalid-operands-of-types-const-char-26-and-lpstr/44933196#44933196", "title": "invalid operands of types &#39;const char [26]&#39; and &#39;LPSTR &#39;", "body": "<p>You are trying to concatenate a <code>char*</code> pointer (obtained from your <code>string</code> variable) to a <code>const char[]</code> array (from your string literal).  You can't do that concatenation.</p>\n\n<p>Also, the <code>const_cast</code> is not necessary.</p>\n\n<p>You will have to convert one of the pointers to a <code>string</code>, eg:</p>\n\n<pre><code>string str = \"C:\\\\Users\\\\mardare\\\\Downloads\\\\config\";\nconst char *lp = str.c_str();\nMessageBox ( NULL, (string(\"The selected folder is : \") + lp).c_str(), \"Bye!\", MB_OK );\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>string str = \"C:\\\\Users\\\\mardare\\\\Downloads\\\\config\";\nconst char *lp = str.c_str();\nMessageBox ( NULL, (\"The selected folder is : \" + string(lp)).c_str(), \"Bye!\", MB_OK );\n</code></pre>\n\n<p>Alternatively, simply get rid of the <code>char*</code> from the <code>string</code>, you don't actually need it:</p>\n\n<pre><code>string str = \"C:\\\\Users\\\\mardare\\\\Downloads\\\\config\";\nMessageBox ( NULL, (\"The selected folder is : \" + str).c_str(), \"Bye!\", MB_OK );\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>string str = \"C:\\\\Users\\\\mardare\\\\Downloads\\\\config\";\nstring msg = \"The selected folder is : \" + str;\nMessageBox ( NULL, msg.c_str(), \"Bye!\", MB_OK );\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>string str = \"C:\\\\Users\\\\mardare\\\\Downloads\\\\config\";\nostringstream msg;\nmsg &lt;&lt; \"The selected folder is : \" &lt;&lt; str;\nMessageBox ( NULL, msg.str().c_str(), \"Bye!\", MB_OK );\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 814, "user_id": 6263041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ir86i.png?s=128&g=1", "display_name": "The Techel", "link": "https://stackoverflow.com/users/6263041/the-techel"}, "is_accepted": false, "score": 0, "last_activity_date": 1499278441, "last_edit_date": 1499278441, "creation_date": 1499278287, "answer_id": 44933243, "question_id": 44933102, "link": "https://stackoverflow.com/questions/44933102/invalid-operands-of-types-const-char-26-and-lpstr/44933243#44933243", "title": "invalid operands of types &#39;const char [26]&#39; and &#39;LPSTR &#39;", "body": "<p>You cannot add together a <code>const char[26]</code> (that is, your <code>\"The selected folder is : \"</code> literal) and a <code>char*</code> pointer (that is, your <code>lp</code> variable of type <code>LPSTR</code>, which is <code>char*</code>). Concatenate the strings first and then obtain a <code>const char*</code>, which you can pass to the function:</p>\n\n<pre><code>std::string str = R\"(C:\\Users\\mardare\\Downloads\\config)\"; //don't care about escape sequences, use raw string literals.\nMessageBox(nullptr, (\"The selected folder is : \" + str).c_str(), \"Bye!\", MB_OK);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37828, "user_id": 1629821, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/861cfc0de6bf99a544b500eac16229eb?s=128&d=identicon&r=PG", "display_name": "Mr.C64", "link": "https://stackoverflow.com/users/1629821/mr-c64"}, "is_accepted": false, "score": 1, "last_activity_date": 1499284047, "last_edit_date": 1499284047, "creation_date": 1499279822, "answer_id": 44933660, "question_id": 44933102, "link": "https://stackoverflow.com/questions/44933102/invalid-operands-of-types-const-char-26-and-lpstr/44933660#44933660", "title": "invalid operands of types &#39;const char [26]&#39; and &#39;LPSTR &#39;", "body": "<p>If you consider the second parameter of <code>MessageBox</code> in this line of code:</p>\n\n<blockquote>\n<pre><code>MessageBox ( NULL, \"The selected folder is : \"+lp, \"Bye!\", MB_OK );\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n</blockquote>\n\n<p>You can see a string literal, i.e. <code>\"The selected folder is : \"</code>, which is a NUL-terminated C-style raw <code>char</code> array (the <code>const char [26]</code> part in your error message); and you are trying to <em>\"concatenate\"</em> it using the operator <code>+</code> with <code>lp</code>, which you defined as <code>LPSTR</code> (i.e. <code>char*</code>) in your code.</p>\n\n<p>Such operation is <em>not</em> defined, hence the error message.</p>\n\n<p>It's clear that your intent is to concatenate two strings, and print the resulting string calling the <code>MessageBox</code> API.</p>\n\n<p>To do so, consider using a C++ string <em>class</em>. If you are at the Win32 API boundary, I think ATL/MFC <code>CString</code> is very convenient. Or, you can use a <em>standard</em> string class like <code>std::string</code>.</p>\n\n<p><code>std::string</code> (and <code>CString</code> as well...) conveniently defines proper overloads of <code>operator+()</code>, which make it possible to concatenate strings with a simple syntax, e.g.:</p>\n\n<pre><code>string str = \"C:\\\\Users\\\\mardare\\\\Downloads\\\\config\";\nstring message = \"The selected folder is : \" + str;\n</code></pre>\n\n<p>At this point, if you want to pass your message <code>std::string</code> instance to the <code>MessageBox</code> API (which is a <em>C-interface</em> API), you can call the <strong><code>std::string::c_str()</code></strong> method:</p>\n\n<pre><code>MessageBox( NULL, message.c_str(), /* ... other params ... */ ); \n</code></pre>\n\n<p>Note that this code will compile in ANSI/MBCS builds (which is an obsolete build setting; Unicode build has been the default since VS2005, more than 10 years ago).</p>\n\n<p>In your case, the actual Win32 API that gets called is <code>MessageBoxA</code> (note the <code>A</code> suffix).</p>\n\n<p>Your code will fail to compile in VS solutions that use Unicode builds; in those cases, you may want to use the explicit <code>MessageBoxA()</code> call.</p>\n\n<hr>\n\n<p><strong>EDIT</strong> Not directly related to your error message, but might be interesting for you to know: If you are using a recent Visual C++ compiler, you may want to replace <code>NULL</code> with <code>nullptr</code> in your C++ code, and you can use <em>raw</em> string literals to simplify the way you write your paths, like this:</p>\n\n<pre><code>// Was: string str = \"C:\\\\Users\\\\mardare\\\\Downloads\\\\config\";\nstring str = R\"(C:\\Users\\mardare\\Downloads\\config)\";\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7728014, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MJ0m2G5mWLA/AAAAAAAAAAI/AAAAAAAAATI/i9vIqIAnnqg/photo.jpg?sz=128", "display_name": "Gazer HD", "link": "https://stackoverflow.com/users/7728014/gazer-hd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 44933196, "answer_count": 4, "score": 1, "last_activity_date": 1499284047, "creation_date": 1499277792, "last_edit_date": 1499279840, "question_id": 44933102, "link": "https://stackoverflow.com/questions/44933102/invalid-operands-of-types-const-char-26-and-lpstr", "title": "invalid operands of types &#39;const char [26]&#39; and &#39;LPSTR &#39;", "body": "<p>My code is </p>\n\n<pre><code>string  str = \"C:\\\\Users\\\\mardare\\\\Downloads\\\\config\";\nLPSTR lp = const_cast&lt;char *&gt;(str.c_str());\nMessageBox ( NULL, \"The selected folder is : \"+lp, \"Bye!\", MB_OK );\n</code></pre>\n\n<p>And when I try to build it and run i get this error </p>\n\n<blockquote>\n  <p>invalid operands of types 'const char [26]' and 'LPSTR'</p>\n</blockquote>\n"}, {"tags": ["c++", "function", "pass-by-reference", "rvalue-reference", "rvalue"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1499277817, "post_id": 44933095, "comment_id": 76842083, "body": "What compiler are you using?  <a href=\"http://coliru.stacked-crooked.com/a/6da820371cdddbae\" rel=\"nofollow noreferrer\">Both calls fail here</a>"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1499277832, "post_id": 44933095, "comment_id": 76842090, "body": "Are you using msvc? As in visual studio?"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1499277897, "post_id": 44933095, "comment_id": 76842122, "body": "<a href=\"http://coliru.stacked-crooked.com/a/79fdc40b281add2d\" rel=\"nofollow noreferrer\">Why do you think you can</a>?"}, {"owner": {"reputation": 11, "user_id": 6319828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23b6d16a46abf1d5cbed572a5cb727af?s=128&d=identicon&r=PG&f=1", "display_name": "jaayy", "link": "https://stackoverflow.com/users/6319828/jaayy"}, "edited": false, "score": 0, "creation_date": 1499278642, "post_id": 44933095, "comment_id": 76842521, "body": "I&#39;m using Visual C++ 14.0(from Visual Studio 2015)."}], "owner": {"reputation": 11, "user_id": 6319828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23b6d16a46abf1d5cbed572a5cb727af?s=128&d=identicon&r=PG&f=1", "display_name": "jaayy", "link": "https://stackoverflow.com/users/6319828/jaayy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "closed_date": 1499278689, "answer_count": 0, "score": 0, "last_activity_date": 1499277757, "creation_date": 1499277757, "question_id": 44933095, "link": "https://stackoverflow.com/questions/44933095/r-value-passed-to-function-by-reference-c", "closed_reason": "Duplicate", "title": "R-value passed to function by reference C++", "body": "<p>I have a question about code below, exactly passing r-value arguments to function in C++.\nWhy we can't pass r-value object <code>Rect</code> to function <code>Print(Rect&amp;)</code>, but r-value <code>int</code> we can.</p>\n\n<p>I know we can use <code>Print(const int&amp;)</code> or <code>Print(int&amp;&amp;)</code>. But the main question is why my own r-value object can be passed?</p>\n\n<p>Thanks in advance for explanation.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct Rect{\n    uint32_t a, b;\n    Rect(uint32_t a, uint32_t b): a(a), b(b){\n        std::cout &lt;&lt; \"Rect constructor...\" &lt;&lt; std::endl;\n    }\n    ~Rect(){\n        std::cout &lt;&lt; \"Rect destructor...\" &lt;&lt; std::endl;\n    }\n    Rect( const Rect&amp; rhs ): a(rhs.a), b(rhs.b){\n        std::cout &lt;&lt; \"Rect copy constructor...\" &lt;&lt; std::endl;\n    }\n};\n\nvoid Print(Rect&amp; r){\n    std::cout &lt;&lt; \"a = \" &lt;&lt; r.a &lt;&lt; \", b = \" &lt;&lt; r.b &lt;&lt; std::endl;\n}\n\nvoid Print(int&amp; a){\n    std::cout &lt;&lt; \"a = \" &lt;&lt; a &lt;&lt; std::endl;\n}\n\nint main(){\n    Print( Rect( 2, 5 ) );\n\n    Print( 5 );\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["java", "android", "c++", "android-ndk", "java-native-interface"], "comments": [{"owner": {"reputation": 2283, "user_id": 4526030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-s05ILbxi6YA/AAAAAAAAAAI/AAAAAAAAACc/yAd6W8jNSBI/photo.jpg?sz=128", "display_name": "John Perry", "link": "https://stackoverflow.com/users/4526030/john-perry"}, "edited": false, "score": 0, "creation_date": 1505001695, "post_id": 44933030, "comment_id": 79234640, "body": "You ever figure this out? I keep making the mistake of trying to enable C/C++ support in Android Studio, only to find that Google doesn&#39;t seem to support it well, if at all."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1512423671, "post_id": 44933030, "comment_id": 82243370, "body": "The naming quirks with JNI don&#39;t apply here. Normally, jniLibs from library module(s) are automagically packed into the APK, no need to do special tricks. If you post you <b>build.gradle</b> scripts, it may be easier to point to a mistake."}], "owner": {"reputation": 373, "user_id": 4363712, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/45e259bf6aafdfc95c0e0a3a62229f1b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Volcano", "link": "https://stackoverflow.com/users/4363712/joe-volcano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2496, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1512237326, "creation_date": 1499277500, "last_edit_date": 1512237326, "question_id": 44933030, "link": "https://stackoverflow.com/questions/44933030/android-studio-jni-module-couldnt-find-libnative-lib-so", "title": "Android Studio JNI Module Couldn&#39;t find &quot;libnative-lib.so&quot;", "body": "<p>I have a regular android project. I want to reference another module that is composed of a Simple Object (.so) and a cpp jni file. I created a module and added it to my project. I have a cmakefile and reference it from my gradle project. </p>\n\n<p>When I include the SO and cpp file directly into the main project it works fine. I followed this tutorial essentially \n<a href=\"https://developer.android.com/studio/projects/add-native-code.html\" rel=\"nofollow noreferrer\">Add C++ to Anrdoid</a></p>\n\n<p>now I want to reference my C++ .so libraries from a different module indirectly from the main application class. Everything builds and compiles but I am getting the following error. </p>\n\n<p>nativeLibraryDirectories=[/data/app/com.example.jniapp01.jniapp01-2/lib/x86, /vendor/lib, /system/lib]]] couldn't find \"libnative-lib.so\"</p>\n\n<p>I feel there is a copy step that puts the so in the proper location when running on the emulator or in the apk etc... but I dont know where or how to set it. Or do I need to set the environment variable for the \".so\" when the app runs?</p>\n\n<p>Any advice. I have been poking at this for too long....</p>\n\n<p>Android Studio 2.3.3\nGradle 2.3.3</p>\n\n<p>UPDATE:\nI did not specifically resolve this. However, I believe this was related to specific naming convention for the intermediary class that references the native libraries from the java code. I had so many libraries  and methods that hand coding was taking a lot of time. I believe there is a way that this can automatically be created from an existing \".so\" lib but I was trying to take it from another sample project. more info here may be helpful... <a href=\"https://stackoverflow.com/questions/12064854/what-is-the-naming-convention-of-jni-call-in-android\">here</a>  let me know what you think.   \"The C++ method will also contain your namespace (e.g. com.domain.your) and classname (e.g. YourActivity), it will look something like\"</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 2, "creation_date": 1499277177, "post_id": 44932941, "comment_id": 76841711, "body": "nothing.Did you find something?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1499277506, "post_id": 44932941, "comment_id": 76841885, "body": "You could also write <code>auto&amp;c</code> or <code>auto   &amp;             c</code>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1499277670, "post_id": 44932941, "comment_id": 76841988, "body": "Just style difference."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 2, "creation_date": 1499278518, "post_id": 44932941, "comment_id": 76842461, "body": "But be careful. Discussions about where the whitespace belongs have already triggered wars."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 2, "creation_date": 1499278605, "post_id": 44932941, "comment_id": 76842506, "body": "@manni66 Yes, and the ampersand definitely belongs <i>with</i> the type. Fight me."}], "owner": {"reputation": 319, "user_id": 8205265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc7e521d6c2e3ae0279e7b5d5fcb0ad?s=128&d=identicon&r=PG&f=1", "display_name": "Igracx33", "link": "https://stackoverflow.com/users/8205265/igracx33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "closed_date": 1499277341, "answer_count": 0, "score": 0, "last_activity_date": 1499277140, "creation_date": 1499277140, "question_id": 44932941, "link": "https://stackoverflow.com/questions/44932941/what-is-the-difference-between-int-name-and-int-name-in-c", "closed_reason": "Duplicate", "title": "What is the difference between int&amp; name and int &amp;name in C++?", "body": "<p>I was wondering what is the difference between int&amp; name and int &amp;name if there is any. One example:</p>\n\n<pre><code>   for (auto&amp; c : s) {...}\n   for (auto &amp;c : s) {...}\n</code></pre>\n"}, {"tags": ["c++", "queue", "profiling", "zeromq"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 1, "creation_date": 1499277537, "post_id": 44932885, "comment_id": 76841899, "body": "Should be fairly easy to insert your custom proxy sockets to enable all kind of diagnostics you need."}, {"owner": {"reputation": 346, "user_id": 7401775, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/79fae12e436469518f605824de67925b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Lin", "link": "https://stackoverflow.com/users/7401775/joe-lin"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1499536227, "post_id": 44932885, "comment_id": 76953018, "body": "Thanks. I think that&#39;s probably the only viable solution."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "is_accepted": false, "score": 1, "last_activity_date": 1499435744, "creation_date": 1499435744, "answer_id": 44972637, "question_id": 44932885, "link": "https://stackoverflow.com/questions/44932885/profiling-zeromq/44972637#44972637", "title": "Profiling ZeroMQ", "body": "<h2>No, AFAIK, this view is not exposed to user-programs. Why?</h2>\n\n<p>The reason is that all the ZeroMQ maxims are doing their best to fine-tune internal mechanics so as to leave user-programs as free from the underlying duties as possible and minimise the service overheads and latencies.</p>\n\n<hr>\n\n<h2>If indeed in a need to reach such nice-to haves:</h2>\n\n<p>One may, either, fork and add these user-side service management-plane layer into the core elements of the ZeroMQ data-pumps.</p>\n\n<p>Next possible move is to stay within the as-is core implementation and just make each socket / queue connect and \"run\"-traffic through a simple, single purpose \"gas-meter\"-proxy, that would have none other duty, than to count bytes, messages ( and handle all the mechanics of the possible distribution / aggregation patterns the SUT-is using, so as to meter the 1:1 the flow ).</p>\n\n<p>The costs of the former are much higher than of the latter, but the latter adds a way larger portion of end-to-end SUT-skew, as the \"inserted\" latencies are much higher and resources consumption grows both in ( SPACE ( {RX|TX}-HWM queues + buffers ) and TIME ( thread-count ).</p>\n"}], "owner": {"reputation": 346, "user_id": 7401775, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/79fae12e436469518f605824de67925b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Lin", "link": "https://stackoverflow.com/users/7401775/joe-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1499435744, "creation_date": 1499276927, "question_id": 44932885, "link": "https://stackoverflow.com/questions/44932885/profiling-zeromq", "title": "Profiling ZeroMQ", "body": "<p>Question about ZeroMQ profiling and debugging.\nI'm interested to find out two information for a 0MQ socket. 1) queue length and 2) the messages (# of messages and total message size).</p>\n\n<p>Is there anyway we can monitor and log the above information in 0MQ sockets? Does 0MQ expose such counters? I think it quite useful for us to profile and debug the system that we build on top of 0MQ. We are using the C++ API.\nThanks.</p>\n"}, {"tags": ["c++", "json", "qt", "double"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 1, "creation_date": 1499276999, "post_id": 44932791, "comment_id": 76841618, "body": "<code>double</code> is the worst choice to deal with money (unless you can <i>double</i> it). Use fixed decimals and certain rounding rules instead, the bookkeepers will be thankful."}], "answers": [{"tags": [], "owner": {"reputation": 1199, "user_id": 6666791, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-W3_hsDW1xtE/AAAAAAAAAAI/AAAAAAAAAEo/y7sVkMzv2kA/photo.jpg?sz=128", "display_name": "Nikolai Shalakin", "link": "https://stackoverflow.com/users/6666791/nikolai-shalakin"}, "is_accepted": false, "score": 0, "last_activity_date": 1499279040, "creation_date": 1499279040, "answer_id": 44933445, "question_id": 44932791, "link": "https://stackoverflow.com/questions/44932791/qt-double-from-json-precision/44933445#44933445", "title": "Qt double from JSON precision", "body": "<p>Well, you should use some Decimal type if you want to deal with money to be on a safe side. Unfortunately, Qt does not have decimal type for some reason. So, you may end up with some rounding rules/conventions <strong>if you have no other choice</strong>. Otherwise <strong>you'd better</strong> to implement your own implementation or use some existing solution like <a href=\"https://github.com/semihc/qdecimal\" rel=\"nofollow noreferrer\">qdecimal</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 7946870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acfc0a40f80fa4c51e9798c62b2d496f?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7946870/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499279040, "creation_date": 1499276542, "question_id": 44932791, "link": "https://stackoverflow.com/questions/44932791/qt-double-from-json-precision", "title": "Qt double from JSON precision", "body": "<p>I receive a JSON Array from a server which looks like: [0.00015099, 1, -672.41163]\nThese values are orderbook entries. If I try to parse all values as double, my price differs slightly from the price in the JSON array. It is clear for me, that this happens because of the double conversion, but how to program around some crazy stuff like this?\nNeed these values also for calculation, compares etc.\nI am using Qt5 and C++.</p>\n\n<p>Any hint?</p>\n"}, {"tags": ["c++", "multithreading", "mutex", "stdthread", "stdmutex"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 8, "creation_date": 1499276350, "post_id": 44932714, "comment_id": 76841265, "body": "No reason.  It was probably done to cut down code in the example."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1499276788, "post_id": 44932714, "comment_id": 76841502, "body": "Probably because the author hates the syntax of <code>std::reference_wrapper</code> ;)"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 2, "creation_date": 1499277967, "post_id": 44932714, "comment_id": 76842159, "body": "It totally depends. Are they fairly trivial programs? Do they consist of more than one file? Need more information. Usually globals are considered bad practice and should be avoided. Typically my mutexes tend to be class member variables. It is often natural to put them in the object that needs locking."}], "answers": [{"comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1499277520, "post_id": 44932947, "comment_id": 76841888, "body": "Side note:  You can at least minimize the number of tramps by putting the various pieces of data (mutexes, etc) into a single object together; then you only have to pass one argument down the call chain rather than many."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1499278017, "post_id": 44932947, "comment_id": 76842181, "body": "@JeremyFriesner -- yes, you can create incoherent types to simplify implementing a bad design. &lt;g&gt; Seriously, though, this can be a legitimate technique. Thanks for mentioning it."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1499278019, "post_id": 44932947, "comment_id": 76842185, "body": "Some people have criticisms about global in <code>&lt;iostream&gt;</code>... It is not because it is done that way in <code>std</code> that it is the right way."}, {"owner": {"reputation": 3529, "user_id": 2036035, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/746fc48544cf535f52f1247079e5a927?s=128&d=identicon&r=PG", "display_name": "hythis", "link": "https://stackoverflow.com/users/2036035/hythis"}, "edited": false, "score": 0, "creation_date": 1499278125, "post_id": 44932947, "comment_id": 76842241, "body": "I don&#39;t really agree with this at all.  A: my implementations usually have used mutexes at the top scope, B: My threads typically have another data structure where I need mutually exclusive access, you can&#39;t portably move mutex code when you rely on some global mutex that may or may not actually exist.  C: You can create a threaded class to house mutexes, or use an entirely separate class to combine mutex and  resource access.  Globals still seem like code smell in this situation."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1499278208, "post_id": 44932947, "comment_id": 76842291, "body": "@Jarod42 -- &quot;some people don&#39;t like it&quot; is not the same as &quot;it&#39;s &#39;bad practice&#39;&quot;."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 2, "creation_date": 1499288920, "post_id": 44932947, "comment_id": 76848242, "body": "Re, &quot;Mutexes are in a sense global...&quot;  The sense you&#39;re looking for might be <i>extent</i> (i.e., how long a variable lives), but when people say &quot;global&quot; without qualifying it, they usually mean global <i>scope</i> (i.e., what parts of the code can see it).  The scope of a C++ <code>std::mutex</code> depends on where it&#39;s declared---could be global, could be local, could be a private member---just like any other type of variable.  Since the purpose of a mutex is to prevent threads from accessing the same data at the same time, it usually makes sense to declare it in the same scope as the data it protects."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1499289071, "post_id": 44932947, "comment_id": 76848310, "body": "@jameslarge -- that only works for simple cases. When you have to coordinate access to two separate sets of data, there&#39;s no obvious single place for the mutex."}], "tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": false, "score": 9, "last_activity_date": 1499277161, "creation_date": 1499277161, "answer_id": 44932947, "question_id": 44932714, "link": "https://stackoverflow.com/questions/44932714/is-there-any-reason-c-11-stdmutex-should-be-declared-as-a-global-variable-i/44932947#44932947", "title": "Is there any reason C++ 11+ std::mutex should be declared as a global variable instead of passed into a std::thread as a function parameter?", "body": "<p>It's bad practice to have globals except when it isn't. For example, <code>std::cin</code> is global.</p>\n\n<p>Mutexes are in a sense global, regardless of how you make them available. They're shared between disparate pieces of code. So you can make them globals, or you can pass them down the call chain, through functions that don't use them, until you eventually reach someone who does. That's known as \"tramp data\" and it's also \"bad practice\". Choose your poison.</p>\n"}, {"tags": [], "owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1499437576, "creation_date": 1499437576, "answer_id": 44973259, "question_id": 44932714, "link": "https://stackoverflow.com/questions/44932714/is-there-any-reason-c-11-stdmutex-should-be-declared-as-a-global-variable-i/44973259#44973259", "title": "Is there any reason C++ 11+ std::mutex should be declared as a global variable instead of passed into a std::thread as a function parameter?", "body": "<p>Most likely this was done to make the example easier to follow, allowing the use of the mutex itself to be the focus of the example rather than the exact specifics.</p>\n\n<p>Typically a mutex protects a resource and in many cases it makes sense for the mutex to live alongside the resource. For example if you have a class with a member container that needs to be protected by a mutex, make the mutex also a member of the class. Then as the class instance is acted on by multiple threads the member-mutex can be used to protect the needed accesses to the internal container.</p>\n"}], "owner": {"reputation": 3529, "user_id": 2036035, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/746fc48544cf535f52f1247079e5a927?s=128&d=identicon&r=PG", "display_name": "hythis", "link": "https://stackoverflow.com/users/2036035/hythis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4456, "favorite_count": 2, "answer_count": 2, "score": 13, "last_activity_date": 1499437576, "creation_date": 1499276275, "last_edit_date": 1499276383, "question_id": 44932714, "link": "https://stackoverflow.com/questions/44932714/is-there-any-reason-c-11-stdmutex-should-be-declared-as-a-global-variable-i", "title": "Is there any reason C++ 11+ std::mutex should be declared as a global variable instead of passed into a std::thread as a function parameter?", "body": "<p>I've seen most examples using <code>std::mutex</code> where the mutex is global.  I was wondering is there any specific reason why this is done?  I've had programs of my own where I don't do this, and simply pass the mutex in as a <code>std::thread</code> <code>std::ref</code>.  Isn't it bad practice to have globals, what is the rational behind global <code>std::mutexes</code> in C++ if there is no language restricting reason to do this?</p>\n"}, {"tags": ["c++", "linux", "security", "c++11", "encryption"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1499275961, "post_id": 44932578, "comment_id": 76841049, "body": "Question:  If someone has an app installed that can scan the memory of your app; what else can they do?  If the computer is already compromised do you need to worry about memory scanning.  You need to develop your thread model 1st before worrying above application-implementation details."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 2, "creation_date": 1499276893, "post_id": 44932578, "comment_id": 76841558, "body": "This is more suited for <a href=\"https://security.stackexchange.com/\">security.stackexchange.com</a>"}, {"owner": {"reputation": 2031, "user_id": 481075, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7e510779ae85664bf9623a091355563d?s=128&d=identicon&r=PG", "display_name": "MysteryMoose", "link": "https://stackoverflow.com/users/481075/mysterymoose"}, "edited": false, "score": 0, "creation_date": 1499278802, "post_id": 44932578, "comment_id": 76842608, "body": "Can this be migrated to security.stackexchange.com if it is better suited there?  I honestly wasn&#39;t sure since this deals with nuts-and-bolts programming."}, {"owner": {"reputation": 2031, "user_id": 481075, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7e510779ae85664bf9623a091355563d?s=128&d=identicon&r=PG", "display_name": "MysteryMoose", "link": "https://stackoverflow.com/users/481075/mysterymoose"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1499279117, "post_id": 44932578, "comment_id": 76842783, "body": "@RichardCritten My goal is to keep the API secrets secure.  As long as these are safe a malicious actor can cost me time and inconvenience but not &#39;direct&#39; assets.  No doubt these are very important concerns in their own right but beyond the scope of my immediate inquiry."}], "answers": [{"comments": [{"owner": {"reputation": 2031, "user_id": 481075, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7e510779ae85664bf9623a091355563d?s=128&d=identicon&r=PG", "display_name": "MysteryMoose", "link": "https://stackoverflow.com/users/481075/mysterymoose"}, "edited": false, "score": 0, "creation_date": 1499362616, "post_id": 44942240, "comment_id": 76886605, "body": "Clever idea; I like the minimization of plaintext and segregation of memory.  If I am understanding correctly, they live keys are stored in memory encrypted with a one-time (probably random) key generated at init.  When I want to use them, the process would be decrypt memory -&gt; use secret -&gt; possibly re-encrypt memory -&gt; nuke temporary memory?  In that case, what is to stop someone from finding the app key and grabbing the secrets using that?"}, {"owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "reply_to_user": {"reputation": 2031, "user_id": 481075, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7e510779ae85664bf9623a091355563d?s=128&d=identicon&r=PG", "display_name": "MysteryMoose", "link": "https://stackoverflow.com/users/481075/mysterymoose"}, "edited": false, "score": 0, "creation_date": 1499372069, "post_id": 44942240, "comment_id": 76891534, "body": "The scheme was the best I could think of without hardware assistance - if you have only one box, and no hardware assistance, I couldn&#39;t think of better.  If you had a TPM, it could be used instead of the application key to encrypt/decrypt your secrets, that would mean at least physical access to get the data.  If you had 2 machines, you could separate the app-key from the live data, but that would cost more latency."}, {"owner": {"reputation": 2031, "user_id": 481075, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7e510779ae85664bf9623a091355563d?s=128&d=identicon&r=PG", "display_name": "MysteryMoose", "link": "https://stackoverflow.com/users/481075/mysterymoose"}, "edited": false, "score": 0, "creation_date": 1499445064, "post_id": 44942240, "comment_id": 76926531, "body": "I suppose <i>any</i> memory can be read under the right circumstances and the only true protection will come from hardware.  The perk about this approach is that it can be (fairly) easily upgraded to use a TPM (or similar) in the future.  Accepted and upvoted,"}], "tags": [], "owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "is_accepted": true, "score": 1, "last_activity_date": 1499325748, "creation_date": 1499325748, "answer_id": 44942240, "question_id": 44932578, "link": "https://stackoverflow.com/questions/44932578/temporarily-storing-decrypted-data-in-memory/44942240#44942240", "title": "Temporarily Storing Decrypted Data in Memory", "body": "<p>I would have an area of static memory (largish buffer in your application which holds a per application launch encryption key. </p>\n\n<ol>\n<li>Encrypt all your live secrets with the encryption key</li>\n<li>Any memory which uses unencrypted secrets is cleared with a secure memset.</li>\n<li>Keep memory used for encryption separate from normal memory (special new/delete to a mmap area).</li>\n</ol>\n\n<p>This would result in....</p>\n\n<ol>\n<li>Plain view of your secrets would not be possible.  This prevents leaking of your information by heartbleed type of bugs.  Although un- reset areas of the heap may be published, they are no use as they are encrypted.</li>\n<li>Plain view secrets have a short life.</li>\n<li>Encrypted memory would not be adjacent to un-encypted data.</li>\n</ol>\n\n<p>The scheme keeps three areas of memory, the encryption secret which is static, and part of the image memory.</p>\n\n<p>The general application side data - using normal new / delete.</p>\n\n<p>Encrypted data, using a custom new/delete, which is a mmap, and won't share addresses with normal new/delete</p>\n"}, {"tags": [], "owner": {"reputation": 515, "user_id": 2957922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GITvm.png?s=128&g=1", "display_name": "Farooq Khan", "link": "https://stackoverflow.com/users/2957922/farooq-khan"}, "is_accepted": false, "score": -1, "last_activity_date": 1499333124, "creation_date": 1499333124, "answer_id": 44944882, "question_id": 44932578, "link": "https://stackoverflow.com/questions/44932578/temporarily-storing-decrypted-data-in-memory/44944882#44944882", "title": "Temporarily Storing Decrypted Data in Memory", "body": "<p>LibSodium is the library you need: <a href=\"https://download.libsodium.org/doc/helpers/memory_management.html\" rel=\"nofollow noreferrer\">https://download.libsodium.org/doc/helpers/memory_management.html</a></p>\n\n<p>Don't know if this will be available on every possible platform, but in most cases this should help you with your objectives.</p>\n"}], "owner": {"reputation": 2031, "user_id": 481075, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7e510779ae85664bf9623a091355563d?s=128&d=identicon&r=PG", "display_name": "MysteryMoose", "link": "https://stackoverflow.com/users/481075/mysterymoose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 44942240, "answer_count": 2, "score": 2, "last_activity_date": 1499333124, "creation_date": 1499275743, "last_edit_date": 1499276816, "question_id": 44932578, "link": "https://stackoverflow.com/questions/44932578/temporarily-storing-decrypted-data-in-memory", "title": "Temporarily Storing Decrypted Data in Memory", "body": "<p><strong>Background</strong></p>\n\n<p>I am working on a simple application in native C++11 which uses Microsoft's Cassablanca REST framework to communicate with various remote endpoints.  To do this, I have to cryptographically sign the various requests with some secret provided by whichever API is being targeted.  By linking Cassablanca I already have OpenSSL so the actual crypto is reasonably straight-forward.</p>\n\n<p>Now, the tricky part is how to store the secrets themselves.  My plan is to AES encrypt a JSON file with all of the goodies using a symmetric key from the user's brain (read: password) so that it does not have to be stored on disk.</p>\n\n<p><strong>The Question</strong></p>\n\n<p><strong>What is a secure way to store the decrypted secrets in memory during the execution of the application?</strong>  This is not another \"how do I store secrets on disk so the user doesn't have to do anything\" question.</p>\n\n<p>My big concern is that someone will be able to examine my application's memory externally and find the appropriate regions containing the goodies.  I know Windows provides credstores and protected memory however I am on Linux and would prefer a platform-agnostic solution if possible.  There is also a significant chance that this will be deployed to a VM cluster so protected memory may only buy limited assurances (though, still better than nothing).</p>\n\n<p>Finally, I know that <em>any</em> cryptographic system can be overcome with sufficiently large amount of money+time or a large enough rubber hose.  That being said, I would still like to be as secure as possible as an exercise in Good\u2122 coding practice. </p>\n\n<p><strong>My constraints are:</strong></p>\n\n<ul>\n<li><p>Must be able to access secrets for signing the various requests quickly.  Milliseconds count here but I am willing to accept a slowdown if security is truly improved.</p></li>\n<li><p>I would prefer a minimum of external libraries and to use native C++11 where possible.  I feel like this should be doable with what I already have (Cassablanca which requires OpenSSL, Boost, libcrypt).</p></li>\n<li><p>Finally, it should be able to accommodate a reasonably large number of secrets / requests.  My application domain is basically a giant parallelization problem and scalability is key.</p></li>\n</ul>\n\n<p><strong>What I already know to do:</strong></p>\n\n<ul>\n<li><p>Never ever store sensitive material on disk unencrypted.  This includes usage of disk-backed containers and whatnot.</p></li>\n<li><p>An old but useful trick: attach a debugger instance to prevent remote debugging from external process.</p></li>\n<li><p>Build without debug symbols and strip final executable.</p></li>\n<li><p>Minimize in-application access to data to only the parts which truly need it.</p></li>\n<li><p>Destroy sensitive information as soon as it is no longer needed (Ex. NULL out user password as soon as decryption is finished, etc).</p></li>\n<li><p>Do not trust anybody to sanitize memory for me.  Manually overwrite areas with NULL / garbage.</p></li>\n</ul>\n\n<p><strong>Similar Questions</strong></p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/11229119/storing-sensitive-data-in-memory\">Storing sensitive data in memory</a></li>\n</ul>\n\n<p>PHP specific and advises writing something not in PHP to store the credentials...which is exactly the problem I am trying to solve.</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/3031739/store-password-temporarily-in-memory\">Store password temporarily in memory</a></li>\n</ul>\n\n<p>Android application lifecycle specific.  I already know the storage duration for my secrets will be the lifetime of the application.</p>\n"}, {"tags": ["c++", "usb", "driver"], "comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1499277073, "post_id": 44932561, "comment_id": 76841653, "body": "Did you read the page you linked??"}, {"owner": {"reputation": 70803, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1499278023, "post_id": 44932561, "comment_id": 76842188, "body": "Your OS will have a USB HID driver that reads events from the joystick, so you don&#39;t need to send the events to the OS.  Do you mean that you are trying to read the joystick events from the joystick and use it in your software application?  You found HIDAPI, so that&#39;s a good step; have you tried using it yet?"}, {"owner": {"reputation": 9, "user_id": 4830704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ca3a87e01931210af6f2ff93466a75?s=128&d=identicon&r=PG&f=1", "display_name": "justin barnes", "link": "https://stackoverflow.com/users/4830704/justin-barnes"}, "edited": false, "score": 0, "creation_date": 1499284172, "post_id": 44932561, "comment_id": 76845682, "body": "I&#39;m trying to use HIDAPI to read from my joystick and send it to a specific application(s). so, I don&#39;t have to use motionjoy"}], "answers": [{"tags": [], "owner": {"reputation": 355, "user_id": 5718551, "user_type": "registered", "profile_image": "https://graph.facebook.com/1651854048399761/picture?type=large", "display_name": "Inigo Selwood", "link": "https://stackoverflow.com/users/5718551/inigo-selwood"}, "is_accepted": false, "score": 0, "last_activity_date": 1499278542, "creation_date": 1499278542, "answer_id": 44933322, "question_id": 44932561, "link": "https://stackoverflow.com/questions/44932561/sending-out-input-events-to-windows/44933322#44933322", "title": "sending out input events to windows", "body": "<p>That all depends on your OS, as drivers are platform specific. Some IDEs like Visual Studio (Windows) provide templates for drivers which you can use, and a great deal of <a href=\"https://msdn.microsoft.com/en-gb/library/windows/hardware/hh706187(v=vs.85).aspx\" rel=\"nofollow noreferrer\">documentation</a> about doing so.</p>\n"}], "owner": {"reputation": 9, "user_id": 4830704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ca3a87e01931210af6f2ff93466a75?s=128&d=identicon&r=PG&f=1", "display_name": "justin barnes", "link": "https://stackoverflow.com/users/4830704/justin-barnes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499278542, "creation_date": 1499275714, "last_edit_date": 1499276417, "question_id": 44932561, "link": "https://stackoverflow.com/questions/44932561/sending-out-input-events-to-windows", "title": "sending out input events to windows", "body": "<p>I am attempting to make a joystick driver via <a href=\"http://www.signal11.us/oss/hidapi/\" rel=\"nofollow noreferrer\">hidapi</a>;  I would like to know how to send events to the os of any joystick activity.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 32100, "user_id": 1033581, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e8891617e36b8d1254eb3ce1a5662da4?s=128&d=identicon&r=PG", "display_name": "C\u0153ur", "link": "https://stackoverflow.com/users/1033581/c%c5%93ur"}, "edited": false, "score": 0, "creation_date": 1504451763, "post_id": 44932424, "comment_id": 79009093, "body": "Please be careful by reporting exact errors: it is likely that it was spelt <i>assignments</i> instead of <i>assigments</i>."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8260650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4f13f2cff1709fa20e800b0982322e?s=128&d=identicon&r=PG", "display_name": "SLASHLogin", "link": "https://stackoverflow.com/users/8260650/slashlogin"}, "edited": false, "score": 0, "creation_date": 1499275460, "post_id": 44932465, "comment_id": 76840776, "body": "Happens to this two cases so it gives same error to w1 and w2"}, {"owner": {"reputation": 19, "user_id": 8260650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4f13f2cff1709fa20e800b0982322e?s=128&d=identicon&r=PG", "display_name": "SLASHLogin", "link": "https://stackoverflow.com/users/8260650/slashlogin"}, "edited": false, "score": 0, "creation_date": 1499275726, "post_id": 44932465, "comment_id": 76840924, "body": "Thanks a lot to both of you, I&#39;m learning so sorry for my inattention"}], "tags": [], "owner": {"reputation": 4147, "user_id": 6654077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3deaf30afffe58c663f22106e4fe9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabien", "link": "https://stackoverflow.com/users/6654077/fabien"}, "is_accepted": false, "score": 1, "last_activity_date": 1499275758, "last_edit_date": 1499275758, "creation_date": 1499275369, "answer_id": 44932465, "question_id": 44932424, "link": "https://stackoverflow.com/questions/44932424/incompatible-types-in-assignments-of-float-to-float-1000/44932465#44932465", "title": "Incompatible types in assignments of &#39;float*&#39; to &#39;float* [1000]&#39;", "body": "<pre><code>float *w2[1000];\n</code></pre>\n\n<p>is erroneous, and should be <code>float *w2;</code></p>\n\n<pre><code>float a[1000];\nfloat b[1000];\nfloat c[1000];\n\nint main()\n{\nfloat *w1;\nw1 = a;\nfloat *w2;\nw2 = b; \n}\n</code></pre>\n\n<p>compiles with no error.</p>\n\n<p>The '&amp;' is intended for single variables, not arrays of single variables. When you instantiate an array with <code>[]</code> your variable actually transforms into a pointer.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 8260650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4f13f2cff1709fa20e800b0982322e?s=128&d=identicon&r=PG", "display_name": "SLASHLogin", "link": "https://stackoverflow.com/users/8260650/slashlogin"}, "edited": false, "score": 0, "creation_date": 1499275715, "post_id": 44932481, "comment_id": 76840919, "body": "Thanks a lot to both of you, I&#39;m learning so sorry for my inattention"}], "tags": [], "owner": {"reputation": 1199, "user_id": 6666791, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-W3_hsDW1xtE/AAAAAAAAAAI/AAAAAAAAAEo/y7sVkMzv2kA/photo.jpg?sz=128", "display_name": "Nikolai Shalakin", "link": "https://stackoverflow.com/users/6666791/nikolai-shalakin"}, "is_accepted": true, "score": 3, "last_activity_date": 1499275437, "creation_date": 1499275437, "answer_id": 44932481, "question_id": 44932424, "link": "https://stackoverflow.com/questions/44932424/incompatible-types-in-assignments-of-float-to-float-1000/44932481#44932481", "title": "Incompatible types in assignments of &#39;float*&#39; to &#39;float* [1000]&#39;", "body": "<p>Probably you aim to do something like this?</p>\n\n<pre><code>float a[1000];\nfloat b[1000];\nfloat c[1000];\n\nint main()\n{\n    float *w1;\n    w1 = a;    // no need of &amp;\n    float *w2; // no need of [1000]\n    w2 = b;    // no need of &amp;\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8260650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4f13f2cff1709fa20e800b0982322e?s=128&d=identicon&r=PG", "display_name": "SLASHLogin", "link": "https://stackoverflow.com/users/8260650/slashlogin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1579, "favorite_count": 0, "accepted_answer_id": 44932481, "answer_count": 2, "score": -4, "last_activity_date": 1504451650, "creation_date": 1499275205, "last_edit_date": 1504451650, "question_id": 44932424, "link": "https://stackoverflow.com/questions/44932424/incompatible-types-in-assignments-of-float-to-float-1000", "title": "Incompatible types in assignments of &#39;float*&#39; to &#39;float* [1000]&#39;", "body": "<pre><code>float a[1000];\nfloat b[1000];\nfloat c[1000];\n\nint main()\n{\n    float *w1;\n    w1 = &amp;a;\n    float *w2[1000];\n    w2 = &amp;b;\n    ...\n}\n</code></pre>\n\n<p>so error: cannot convert <code>float (*)[1000]</code> to <code>float*</code> in assignments - to <code>w1</code>\nand compiler throws error: incompatible types in assignments of <code>float*</code> to <code>float * [1000]</code> to <code>w2</code></p>\n"}, {"tags": ["c++", "linux", "porting"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 4, "creation_date": 1499275240, "post_id": 44932352, "comment_id": 76840633, "body": "There are no invalid parameters in C++. There is only undefined behavior."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1499281173, "post_id": 44932352, "comment_id": 76843920, "body": "This is Microsoft doing some low-level implementation specific stuff. It is unlikely you will be able to duplicate it elsewhere without writing a bunch of code. <code>vsnprintf_s</code> only marginally exists in standard C++ so be warned. It might not be implemented. You need to implement and install a <a href=\"http://en.cppreference.com/w/c/error/set_constraint_handler_s\" rel=\"nofollow noreferrer\">Constraint Handler</a> that performs the behaviours, throws the exceptions, you want. You will also probably have to define the exceptions."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1499281250, "post_id": 44932352, "comment_id": 76843965, "body": "I&#39;ve never done this, so I can&#39;t give an authoritative answer without doing a lot of work I don&#39;t have time for at the moment. Once you get this all figured out and have a working solution, this will make a brilliant self-answered question."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1499281711, "post_id": 44932352, "comment_id": 76844211, "body": "But one last point, you wouldn&#39;t be having any of these issues if you wrote standard-compliant C++ and used iostreams. This is still possible to do in CLI and would remove virtually all of your portability concerns."}, {"owner": {"reputation": 303, "user_id": 5718927, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/1b5848b7f0ee59c47516ae018c8b4021?s=128&d=identicon&r=PG&f=1", "display_name": "darkThoughts ", "link": "https://stackoverflow.com/users/5718927/darkthoughts"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1499284560, "post_id": 44932352, "comment_id": 76845905, "body": "@user4581301 what do you mean by using iostreams? How do i replace vsnprintf_s functionality by iostreams? Also - this code somehow detects incorrect parameters and uses that info to set a flag - how do i overcome the need of doing that simply by using iostreams? Thanks"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1499287078, "post_id": 44932352, "comment_id": 76847324, "body": "With iostreams the compiler figures out from the provided datatypes   how to print and the program won&#39;t compile if it can&#39;t figure it out. if you use a std::stringstream, the receptacle will resize itself so you never need worry about buffer overflow. About the only runtime error that leaves is a catchable out of memory exception if the stream cannot resize. That said, I have no clue where <code>pTempFormat</code> and <code>pList</code> came from, so your mileage may vary on this one."}], "owner": {"reputation": 303, "user_id": 5718927, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/1b5848b7f0ee59c47516ae018c8b4021?s=128&d=identicon&r=PG&f=1", "display_name": "darkThoughts ", "link": "https://stackoverflow.com/users/5718927/darkthoughts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 851, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499274979, "creation_date": 1499274979, "question_id": 44932352, "link": "https://stackoverflow.com/questions/44932352/handling-invalid-parameter-exception-in-c", "title": "handling invalid parameter exception in C++", "body": "<p>I have the following code written in CLI C++:</p>\n\n<pre><code>static void BadTraceHandler(const wchar_t* expression,\n    const wchar_t* function, \n    const wchar_t* file, \n    unsigned int line, \n    uintptr_t pReserved)\n{\n    UNREFERENCED_PARAMETER(expression);\n    UNREFERENCED_PARAMETER(function);\n    UNREFERENCED_PARAMETER(file);\n    UNREFERENCED_PARAMETER(line);\n    UNREFERENCED_PARAMETER(pReserved);\n\n    sBadTrace = 1;\n}\n\nvoid func ()\n{\n    newHandler = BadTraceHandler;\n    oldHandler = _set_invalid_parameter_handler(newHandler);\n\n    _CrtSetReportMode(_CRT_ASSERT, 0);\n    sBadTrace = 0;\n\n    __try\n    {\n        vsnprintf_s((char*)pDisplayStr, MAX_TRACE_LEN, _TRUNCATE, (char*)pTempFormat, (va_list)pList);\n    }\n    __except(1)\n    {\n        sBadTrace = 1;\n    }   \n\n    _set_invalid_parameter_handler(oldHandler);\n    _CrtSetReportMode(_CRT_ASSERT, _CRTDBG_MODE_WNDW);\n}\n</code></pre>\n\n<p>The goal of this code is to basically set sBadTrace to 1 in case the function vsnprintf_s receives a bad parameter and for that purpose two mechanisems are used - the __try, __except(1) and the _set_invalid_parameter_handler. None of those is supported in standard C++ (they are Microsoft specific).</p>\n\n<p>I am trying to make this code compatible for Linux so i rewire it in STL C++. \nTo achieve this I changed __try, __except(1) to try, catch(...), which i hope will work the same in case of an invalid parameter (although i couldn't fin information about the kind of exceptions vsnprintf_s throws). Is it an equivalent code? </p>\n\n<p>As to _set_invalid_parameter_handler - i am not sure how to replicate this mechanism in Linux. I know all about using signals but i couldn't find a signal that's triggered when an invalid parameter is passed to a function. </p>\n"}, {"tags": ["c++", "loops", "for-loop", "language-agnostic"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1499275058, "post_id": 44932344, "comment_id": 76840517, "body": "Regarding c++, your teacher is wrong. A <code>for</code> loop won&#39;t execute at all if the condition is false before the first iteration."}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1499275111, "post_id": 44932344, "comment_id": 76840551, "body": "Perhaps you misunderstood, and your teacher merely refers to the initialization and condition check? Also, why is this tagged with Python? Python for-loops are not like C++ for-loops."}, {"owner": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "edited": false, "score": 5, "creation_date": 1499275114, "post_id": 44932344, "comment_id": 76840555, "body": "only a <code>do while</code> loop is guaranteed to run at least once"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 5, "creation_date": 1499275137, "post_id": 44932344, "comment_id": 76840572, "body": "Your teacher&#39;s statement is complete and utter nonsense, as your test easily demonstrates."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 3, "creation_date": 1499275198, "post_id": 44932344, "comment_id": 76840607, "body": "@BaummitAugen OP is right in doing research beyond testing himself. C++ is notorious in that direct observation is far from sufficient to determine if and how a behavior is defined."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1499275226, "post_id": 44932344, "comment_id": 76840623, "body": "Gee, here&#39;s a thought. Remove the comment, insert a <code>printf</code> statement, and compile and run your code. Voila! You know the answer."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1499275261, "post_id": 44932344, "comment_id": 76840650, "body": "@KenWhite It seems like he did that test, since his question says &quot;yet it does not&quot;."}, {"owner": {"reputation": 123, "user_id": 8260533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c51e3ad93ef53e58e395e46a82c27da6?s=128&d=identicon&r=PG&f=1", "display_name": "Klaus9090", "link": "https://stackoverflow.com/users/8260533/klaus9090"}, "reply_to_user": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1499275273, "post_id": 44932344, "comment_id": 76840659, "body": "@juanpa.arrivillaga I know python has a different for-loop, yet I don&#39;t know Python and it could be that she could be wrong regarding Python&#39;s for-loop. That&#39;s why I tagged it with Python as well."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1499275286, "post_id": 44932344, "comment_id": 76840666, "body": "@Fran&#231;oisAndrieux Sure. And I just confirmed that their test does indeed demonstrate that their teacher&#39;s statement was nonsense."}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1499275351, "post_id": 44932344, "comment_id": 76840703, "body": "@Klaus9090 don&#39;t spam language tags. If your question could be about any language, use [langage-agnostic]. I&#39;ve gone ahead and edited."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1499275417, "post_id": 44932344, "comment_id": 76840746, "body": "@Barmar: Then the OP should be going to the teacher, demonstrating that the lesson was wrong, and asking that teacher to explain. (It&#39;s what I did when encountering this sort of situation.)"}, {"owner": {"reputation": 123, "user_id": 8260533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c51e3ad93ef53e58e395e46a82c27da6?s=128&d=identicon&r=PG&f=1", "display_name": "Klaus9090", "link": "https://stackoverflow.com/users/8260533/klaus9090"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1499275519, "post_id": 44932344, "comment_id": 76840815, "body": "@KenWhite I did, yet she would not admit she was, now obviously, wrong."}, {"owner": {"reputation": 123, "user_id": 8260533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c51e3ad93ef53e58e395e46a82c27da6?s=128&d=identicon&r=PG&f=1", "display_name": "Klaus9090", "link": "https://stackoverflow.com/users/8260533/klaus9090"}, "reply_to_user": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1499275554, "post_id": 44932344, "comment_id": 76840829, "body": "@juanpa.arrivillaga it was not my intention to spam tags. Thanks for the correction! :)"}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1499275595, "post_id": 44932344, "comment_id": 76840854, "body": "@Klaus9090 no worries, just giving you a heads up for future questions. It&#39;s easy enough to clean up tags."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1499275668, "post_id": 44932344, "comment_id": 76840889, "body": "@Klaus9090: So you know the answer, the teacher refuses to admit she&#39;s wrong... What exactly are you wanting us to do here? Boycott your school?"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1499277712, "post_id": 44932344, "comment_id": 76842017, "body": "@KenWhite That sounds like a great idea"}, {"owner": {"reputation": 123, "user_id": 8260533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c51e3ad93ef53e58e395e46a82c27da6?s=128&d=identicon&r=PG&f=1", "display_name": "Klaus9090", "link": "https://stackoverflow.com/users/8260533/klaus9090"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1499277890, "post_id": 44932344, "comment_id": 76842121, "body": "@KenWhite I just wanted to check if there were cases that I could be missing where she was right."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 8260533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c51e3ad93ef53e58e395e46a82c27da6?s=128&d=identicon&r=PG&f=1", "display_name": "Klaus9090", "link": "https://stackoverflow.com/users/8260533/klaus9090"}, "edited": false, "score": 0, "creation_date": 1499276503, "post_id": 44932441, "comment_id": 76841354, "body": "Evaluation in this case means checking if the condition is true or false, right?"}], "tags": [], "owner": {"reputation": 4300, "user_id": 4513509, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MAkrs.png?s=128&g=1", "display_name": "NonCreature0714", "link": "https://stackoverflow.com/users/4513509/noncreature0714"}, "is_accepted": true, "score": 17, "last_activity_date": 1550956841, "last_edit_date": 1550956841, "creation_date": 1499275276, "answer_id": 44932441, "question_id": 44932344, "link": "https://stackoverflow.com/questions/44932344/is-a-for-loop-always-executed-at-least-once/44932441#44932441", "title": "Is a For Loop always executed at least once?", "body": "<p>You could say a for-loop is always <strong><em>evaluated</em></strong> at least once.</p>\n\n<p>But if a for-loop's condition is not met, its block will never execute.</p>\n\n<p>Because you didn't ask about other loops, I won't address those.</p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 6, "last_activity_date": 1550942177, "last_edit_date": 1550942177, "creation_date": 1499275337, "answer_id": 44932456, "question_id": 44932344, "link": "https://stackoverflow.com/questions/44932344/is-a-for-loop-always-executed-at-least-once/44932456#44932456", "title": "Is a For Loop always executed at least once?", "body": "<p>A loop will only execute while its condition is true.  Since a <code>for</code> loop and a <code>while</code> loop both check the condition before the body is executed they will never execute if the condition is false.</p>\n\n<p>The only loop that will is a <code>do while</code> loop.  With a <code>do while</code> loop the condition is not evaluated until the end of the loop.  Because of that a <code>do while</code> loop will always execute at least once.</p>\n"}, {"tags": [], "owner": {"reputation": 3197, "user_id": 5853530, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b9567983f2e1d6c2315fa26202accb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rajeev Singh", "link": "https://stackoverflow.com/users/5853530/rajeev-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1499275503, "creation_date": 1499275503, "answer_id": 44932503, "question_id": 44932344, "link": "https://stackoverflow.com/questions/44932344/is-a-for-loop-always-executed-at-least-once/44932503#44932503", "title": "Is a For Loop always executed at least once?", "body": "<p>An entry controlled loop will never execute if the condition is <code>false</code>, however, exit controlled loop will execute at least once.</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 8261048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc9181b4dd0ca0a4dc5f1250fc42ada?s=128&d=identicon&r=PG&f=1", "display_name": "Eesha", "link": "https://stackoverflow.com/users/8261048/eesha"}, "is_accepted": false, "score": 1, "last_activity_date": 1499299740, "creation_date": 1499299740, "answer_id": 44937834, "question_id": 44932344, "link": "https://stackoverflow.com/questions/44932344/is-a-for-loop-always-executed-at-least-once/44937834#44937834", "title": "Is a For Loop always executed at least once?", "body": "<p>A for-loop always makes sure the condition is true before running the program. Whereas, a do-loop runs the program at least once and then checks the condition.</p>\n"}], "owner": {"reputation": 123, "user_id": 8260533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c51e3ad93ef53e58e395e46a82c27da6?s=128&d=identicon&r=PG&f=1", "display_name": "Klaus9090", "link": "https://stackoverflow.com/users/8260533/klaus9090"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23503, "favorite_count": 2, "accepted_answer_id": 44932441, "answer_count": 4, "score": 12, "last_activity_date": 1550956841, "creation_date": 1499274965, "last_edit_date": 1499276678, "question_id": 44932344, "link": "https://stackoverflow.com/questions/44932344/is-a-for-loop-always-executed-at-least-once", "title": "Is a For Loop always executed at least once?", "body": "<p>According to my teacher, a for-loop always executes at least once, even if the condition is not met.</p>\n\n<p>Example (like I know it from C++):</p>\n\n<pre><code>for (int i=6; i &lt;=5; i++) {\n    //irrelevant for this question\n}\n</code></pre>\n\n<p>According to her, this loop would execute at least once, yet it does not, or am I missing something? \nIs there any case, no matter what language, where this would execute once? \nTo eliminate the thought in advance: yes, it was about for loops, not do-while-loops.</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>Thanks for all those quick answers, I guess this case is already closed. Have a nice day/night.</p>\n"}, {"tags": ["c++", "matlab", "eigen3", "matlab-to-eigen"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 2244148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3678a8f44626348e35269c6b71c188?s=128&d=identicon&r=PG", "display_name": "Nick Wilton", "link": "https://stackoverflow.com/users/2244148/nick-wilton"}, "edited": false, "score": 1, "creation_date": 1499358464, "post_id": 44934161, "comment_id": 76883976, "body": "This is almost the correct answer, except for some reason you must also call transpose on permutationP prior to multiplying by F. See below."}], "tags": [], "owner": {"reputation": 319, "user_id": 8226830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMxPt.jpg?s=128&g=1", "display_name": "DCSmith", "link": "https://stackoverflow.com/users/8226830/dcsmith"}, "is_accepted": false, "score": 4, "last_activity_date": 1499281582, "creation_date": 1499281582, "answer_id": 44934161, "question_id": 44931857, "link": "https://stackoverflow.com/questions/44931857/lu-decomposition-with-partialpivlu/44934161#44934161", "title": "LU decomposition with PartialPivLU", "body": "<p>By calling <code>[F,J]=lu(P)</code>, the resulting matrix <code>F</code> is a <em>permuted</em> lower triangular matrix. You can call the function as <code>[F,J,perm]=lu(P)</code> to receive <code>F</code> as a truly lower triangle matrix and <code>P</code> as the separate permutation matrix so that <code>F*J = perm*P</code>. By default, the line </p>\n\n<p><code>MatrixXd F = lu.matrixLU().triangularView&lt;UpLoType::UnitLower&gt;();</code>  </p>\n\n<p>using Eigen returns the true lower triangular matrix. If you want the permuted lower triangular matrix like Matlab returns, then you can store the permutation matrix in Eigen by calling <code>permutationP</code> and then multiplying this matrix by <code>F</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 2244148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3678a8f44626348e35269c6b71c188?s=128&d=identicon&r=PG", "display_name": "Nick Wilton", "link": "https://stackoverflow.com/users/2244148/nick-wilton"}, "is_accepted": false, "score": 2, "last_activity_date": 1499358867, "creation_date": 1499358867, "answer_id": 44954538, "question_id": 44931857, "link": "https://stackoverflow.com/questions/44931857/lu-decomposition-with-partialpivlu/44954538#44954538", "title": "LU decomposition with PartialPivLU", "body": "<p>The answer by DCSmith is pretty close, however it seems that you must also call transpose() on the permutation matrix in order to get the correct result:</p>\n\n<pre><code>MatrixXd P(3, 3);\nP &lt;&lt; 1, 2, 3, 4, 5, 6, 7, 8, 9;\nMatrixXd U(3, 1);\nU &lt;&lt; 0, 1, 2;\n\nPartialPivLU&lt;MatrixXd&gt; lu = PartialPivLU&lt;MatrixXd&gt;(P);\nMatrixXd J = lu.matrixLU().triangularView&lt;UpLoType::Upper&gt;();\nMatrixXd F = lu.matrixLU().triangularView&lt;UpLoType::UnitLower&gt;();\nMatrixXd perm = lu.permutationP().transpose();\nMatrixXd F1 = perm * F;\n\nMatrixXd Jlamda = F.lu().solve(U);\nMatrixXd l = J.lu().solve(Jlamda);\n\ncout &lt;&lt; perm &lt;&lt; endl;\ncout &lt;&lt; endl;\ncout &lt;&lt; F1 &lt;&lt; endl;\n</code></pre>\n\n<p>Prints:<br></p>\n\n<pre>\n0 1 0<br>\n0 0 1<br>\n1 0 0<br>\n\n0.142857 1   0<br>\n0.571429 0.5 1<br>\n1        0   0<br>\n</pre>\n\n<p>Which is the same as the MatLab example</p>\n"}], "owner": {"reputation": 93, "user_id": 2244148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3678a8f44626348e35269c6b71c188?s=128&d=identicon&r=PG", "display_name": "Nick Wilton", "link": "https://stackoverflow.com/users/2244148/nick-wilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1499358867, "creation_date": 1499273121, "question_id": 44931857, "link": "https://stackoverflow.com/questions/44931857/lu-decomposition-with-partialpivlu", "title": "LU decomposition with PartialPivLU", "body": "<p>I have the following code in MatLab that does an LU decomposition before trying to calculate 'lamb' which I've included to give some context.</p>\n\n<pre><code>P=[1,2,3;4,5,6;7,8,9];\nU=[0;1;2];\n[F,J]=lu(P);\nJlamda=F\\U;\nlamb=J\\Jlamda;\n</code></pre>\n\n<p>F is:<br></p>\n\n<pre>0.142857142857143   1                   0<br>\n0.571428571428571   0.500000000000000   1<br>\n1                   0                   0<br></pre>\n\n<p>U is:<br></p>\n\n<pre>7                  8                   9<br>\n0                   0.857142857142857   1.71428571428571<br>\n0                   0                   1.11022302462516e-16<br></pre>\n\n<p>When I try to replicate this in Eigen with the following code:</p>\n\n<pre><code>MatrixXd P(3, 3);\nP &lt;&lt; 1, 2, 3, 4, 5, 6, 7, 8, 9;\nMatrixXd U(3, 1);\nU &lt;&lt; 0, 1, 2;\n\nPartialPivLU&lt;MatrixXd&gt; lu = PartialPivLU&lt;MatrixXd&gt;(P);\nMatrixXd J = lu.matrixLU().triangularView&lt;UpLoType::Upper&gt;();\nMatrixXd F = lu.matrixLU().triangularView&lt;UpLoType::UnitLower&gt;();\n\nMatrixXd Jlamda = F.lu().solve(U);\nMatrixXd l = J.lu().solve(Jlamda);\n\ncout &lt;&lt; F &lt;&lt; endl;\ncout &lt;&lt; endl;\ncout &lt;&lt; J &lt;&lt; endl;\n</code></pre>\n\n<p>Which prints:<br></p>\n\n<pre>1                    0                  0<br>\n0.142857             1                  0<br>\n0.571429             0.5                1<br></pre>\n\n<pre>\n7                    8                  9<br>\n0                    0.857143           1.71429<br>\n0                    0                  1.11022e-16<br></pre>\n\n<p>Whilst I can obviously handcraft a matrix to transform the rows of F in C++ to that of the F from MatLab I am not sure how to do that dynamically.</p>\n\n<p>Is PartialPivLU the best way to go about this, or am I missing something more trivial?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["javascript", "c++", "openframeworks"], "comments": [{"owner": {"reputation": 4410, "user_id": 802435, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/gGqtf.png?s=128&g=1", "display_name": "SteakOverflow", "link": "https://stackoverflow.com/users/802435/steakoverflow"}, "edited": false, "score": 0, "creation_date": 1499273270, "post_id": 44931822, "comment_id": 76839584, "body": "Please share a code example, error messages, more info about your process and narrow the question down to a more specific problem."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6510852, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30d6aaafbc5225e5c22927087b9fb6b0?s=128&d=identicon&r=PG&f=1", "display_name": "aii", "link": "https://stackoverflow.com/users/6510852/aii"}, "edited": false, "score": 0, "creation_date": 1499355663, "post_id": 44942803, "comment_id": 76882027, "body": "Hi. Thank you for your reply. I have actually followed the tutorial you have linked and I was able to successfully compile to some html and js files. My concern here is that when I render the html with emrun (or on a server), there is the header (which gives you the option for fullscreen) and a footer that looks like some console. I do not want these, just the drawing by itself. Is this possible to make with emscripten? I want to replicate what&#39;s shown on this site: <a href=\"http://codedoodl.es\" rel=\"nofollow noreferrer\">codedoodl.es</a>"}, {"owner": {"reputation": 2998, "user_id": 2628257, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ujGHu.jpg?s=128&g=1", "display_name": "Sergio Basurco", "link": "https://stackoverflow.com/users/2628257/sergio-basurco"}, "reply_to_user": {"reputation": 39, "user_id": 6510852, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30d6aaafbc5225e5c22927087b9fb6b0?s=128&d=identicon&r=PG&f=1", "display_name": "aii", "link": "https://stackoverflow.com/users/6510852/aii"}, "edited": false, "score": 0, "creation_date": 1499360039, "post_id": 44942803, "comment_id": 76884995, "body": "Hmm, after some reverse engineering I found this file: <a href=\"https://github.com/openframeworks/openFrameworks/blob/19ec2688df9eecd818e333bef4753c302058de17/libs/openFrameworksCompiled/project/emscripten/template.html\" rel=\"nofollow noreferrer\">openFrameworks/libs/openFrameworksCompiled/project/emscripte&zwnj;&#8203;n/template.html</a>. I think you should be able to change it, or find where it&#39;s used, and choose a style of your choice for the generated canvas."}], "tags": [], "owner": {"reputation": 2998, "user_id": 2628257, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ujGHu.jpg?s=128&g=1", "display_name": "Sergio Basurco", "link": "https://stackoverflow.com/users/2628257/sergio-basurco"}, "is_accepted": true, "score": 0, "last_activity_date": 1499360359, "last_edit_date": 1499360359, "creation_date": 1499327331, "answer_id": 44942803, "question_id": 44931822, "link": "https://stackoverflow.com/questions/44931822/how-to-render-openframeworks-app-to-host-on-browser/44942803#44942803", "title": "How to render openFrameworks app to host on browser", "body": "<p>If you follow OF's guidelines Emscripten generates not only the html file but also some other files (I think it's 4 files in total). You need to copy all of those into your site, then link to the html file. </p>\n\n<p>Notice that while developing you can use </p>\n\n<p><code>emrun --browser chrome bin/yourSample.html\n</code></p>\n\n<p>To open the file, but you cannot just open the .html file (not sure why). See <a href=\"http://www.reginafloresmir.com/blog/2015/5/14/openframeworks-on-the-line\" rel=\"nofollow noreferrer\">this guidelines</a> as well, which are linked in the OF tutorial. </p>\n\n<h2>Update</h2>\n\n<p>I haven't tested this, but it looks like OF loads a site template. See <a href=\"https://github.com/openframeworks/openFrameworks/blob/63d20a5b5f3c4181f83febf2ad441921332f29e0/libs/openFrameworksCompiled/project/emscripten/config.emscripten.default.mk\" rel=\"nofollow noreferrer\">this makefile</a> for emscripten, you may specify your own via <a href=\"https://github.com/openframeworks/openFrameworks/blob/63d20a5b5f3c4181f83febf2ad441921332f29e0/libs/openFrameworksCompiled/project/emscripten/config.emscripten.default.mk#L88\" rel=\"nofollow noreferrer\">PROJECT_EMSCRIPTEN_TEMPLATE</a> or you could just change <a href=\"https://github.com/openframeworks/openFrameworks/blob/63d20a5b5f3c4181f83febf2ad441921332f29e0/libs/openFrameworksCompiled/project/emscripten/template.html\" rel=\"nofollow noreferrer\">the template</a> OF uses.</p>\n"}], "owner": {"reputation": 39, "user_id": 6510852, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30d6aaafbc5225e5c22927087b9fb6b0?s=128&d=identicon&r=PG&f=1", "display_name": "aii", "link": "https://stackoverflow.com/users/6510852/aii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 44942803, "answer_count": 1, "score": 0, "last_activity_date": 1499360359, "creation_date": 1499273004, "question_id": 44931822, "link": "https://stackoverflow.com/questions/44931822/how-to-render-openframeworks-app-to-host-on-browser", "title": "How to render openFrameworks app to host on browser", "body": "<p>I'm new to both openFrameworks and this compiler called Emscripten.\nAfter struggling for a few days, I was able to compile my openFrameworks/C++ code into js but Emscripten gives me an html file with a lot of junk included (For example, there is a header and footer -\n <a href=\"http://openframeworks.cc/setup/emscripten/\" rel=\"nofollow noreferrer\">http://openframeworks.cc/setup/emscripten/</a>)</p>\n\n<p>I'm trying to host the video/animation itself like it is on this page (<a href=\"http://www.syedrezaali.com/#/great-scott/\" rel=\"nofollow noreferrer\">http://www.syedrezaali.com/#/great-scott/</a>) but I have no idea how to go about it. Can anyone help me out?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c++", "qt", "containers", "qt5"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1499272853, "post_id": 44931703, "comment_id": 76839353, "body": "Might be a dupe: <a href=\"https://stackoverflow.com/questions/7804955/heterogeneous-containers-in-c\" title=\"heterogeneous containers in c\">stackoverflow.com/questions/7804955/&hellip;</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1499272883, "post_id": 44931703, "comment_id": 76839367, "body": "Also, IIRC they are both derived from <code>QObject</code> so you could have a <code>QList&lt;Qobject*&gt;</code>."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1499272885, "post_id": 44931703, "comment_id": 76839368, "body": "You may want a <code>QList&lt;QVariant&gt;</code>"}, {"owner": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "edited": false, "score": 0, "creation_date": 1499290981, "post_id": 44931703, "comment_id": 76849181, "body": "I thank everyone for your response."}, {"owner": {"reputation": 5281, "user_id": 1495627, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/05f7c73495dfcdc1b6b32b30fdb994f0?s=128&d=identicon&r=PG", "display_name": "Jean-Micha&#235;l Celerier", "link": "https://stackoverflow.com/users/1495627/jean-micha%c3%abl-celerier"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1499328036, "post_id": 44931703, "comment_id": 76861660, "body": "@NathanOliver: QColor doesn&#39;t inherit from QObject."}], "answers": [{"tags": [], "owner": {"reputation": 5281, "user_id": 1495627, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/05f7c73495dfcdc1b6b32b30fdb994f0?s=128&d=identicon&r=PG", "display_name": "Jean-Micha&#235;l Celerier", "link": "https://stackoverflow.com/users/1495627/jean-micha%c3%abl-celerier"}, "is_accepted": true, "score": 1, "last_activity_date": 1499274143, "creation_date": 1499274143, "answer_id": 44932102, "question_id": 44931703, "link": "https://stackoverflow.com/questions/44931703/store-objects-of-different-types-in-a-container/44932102#44932102", "title": "Store objects of different types in a container", "body": "<blockquote>\n  <p>Is there a container accepts adding different types of objects?</p>\n</blockquote>\n\n<p>Yes: QVariantList, QVariantMap, QVariantHash.</p>\n\n<p>You can also roll your own manually, like <code>std::vector&lt;QVariant&gt;</code> for instance.</p>\n\n<p>See <a href=\"http://doc.qt.io/qt-5/qvariant.html\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/qvariant.html</a></p>\n\n<p>Also, note that loosing type information like this is frowned upon and bad practice. If you have a finite set of types you can use <code>std::variant</code> instead.</p>\n"}], "owner": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 44932102, "answer_count": 1, "score": 0, "last_activity_date": 1499274143, "creation_date": 1499272612, "question_id": 44931703, "link": "https://stackoverflow.com/questions/44931703/store-objects-of-different-types-in-a-container", "title": "Store objects of different types in a container", "body": "<p>I have two objects <code>QColor</code>, <code>QFont</code> and there's a possibility of adding more.<br>\nI want to store that objects in a container for instance <code>QList</code> but this container needs one type of data.</p>\n\n<pre><code>QFont font = QFontDialog::getFont(&amp;fontDlgRet, initFont, parent);\nQColor color = QColorDialog::getColor(initColor, parent);\n</code></pre>\n\n<p>Is there a container accepts adding different types of objects?</p>\n"}, {"tags": ["c++", "arrays", "pointers"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1499272103, "post_id": 44931512, "comment_id": 76838877, "body": "of course it doesn&#39;t <code>++i</code>, you are <code>return</code>ing on the first iteration of the loop"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1499272121, "post_id": 44931512, "comment_id": 76838888, "body": "You have a possible buffer overrun issue:  <code>std::cin &gt;&gt; c</code>.  Type 12 characters and find out."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1499272354, "post_id": 44931512, "comment_id": 76838999, "body": "I highly recommend replacing your loop in <code>FindIndexOfChar</code> with <code>strchr</code>.  Since the <code>strchr</code> returns a pointer to an array, you can subtract the start of the array from the result of <code>strchr</code> to get the index.  Remember to validate the result from <code>strchr</code> before calculating the index."}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 3, "last_activity_date": 1499272093, "creation_date": 1499272093, "answer_id": 44931550, "question_id": 44931512, "link": "https://stackoverflow.com/questions/44931512/for-loop-not-looping-and-detecting-char-array-pointers-and-char-arrays/44931550#44931550", "title": "For Loop not looping and detecting Char Array [Pointers and Char Arrays]", "body": "<pre><code>for (int i = 0; i &lt; sizeOfArray2; ++i)\n{\n    if (c[i] == Val)\n        return i;\n    else\n        return -1;\n}\n</code></pre>\n\n<p>You're only checking the first character. If it doesn't match, you return <code>-1</code> right away.</p>\n\n<p>Instead you need to proceed to the next character.</p>\n\n<p>Perhaps try:</p>\n\n<pre><code>for (int i = 0; i &lt; sizeOfArray2; ++i)\n{\n    if (c[i] == Val)\n        return i;\n}\n\nreturn -1;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 1, "last_activity_date": 1499272443, "creation_date": 1499272443, "answer_id": 44931659, "question_id": 44931512, "link": "https://stackoverflow.com/questions/44931512/for-loop-not-looping-and-detecting-char-array-pointers-and-char-arrays/44931659#44931659", "title": "For Loop not looping and detecting Char Array [Pointers and Char Arrays]", "body": "<p>You could change your function:  </p>\n\n<pre><code>char * p_found = strchr(c, Val);\nif (p_found != nullptr)\n{\n  return p_found - c;\n}\nreturn -1;\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8145521, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f4749dfedf19e6bfb5c506e36dfb545e?s=128&d=identicon&r=PG&f=1", "display_name": "don1123", "link": "https://stackoverflow.com/users/8145521/don1123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 44931550, "answer_count": 2, "score": -1, "last_activity_date": 1499272443, "creation_date": 1499271949, "last_edit_date": 1499272058, "question_id": 44931512, "link": "https://stackoverflow.com/questions/44931512/for-loop-not-looping-and-detecting-char-array-pointers-and-char-arrays", "title": "For Loop not looping and detecting Char Array [Pointers and Char Arrays]", "body": "<p>Basically, the code is asking for a user input. I type in the word hotkdog and I would like to use the function FindIndexOfCharacter 'k', which is 3. However, the function is always returning -1, so I guess my loop isn't being ++i for some reason??   </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstring&gt;\n#include &lt;string&gt;\n\nvoid ReadString(char * c, int maxLength);\nint FindIndexOfCharacter(char * c, char testVal);\n\nint main()\n{\n    const int SIZE = 10;\n    char ca[SIZE];\n    char * cpointer = ca;\n\n    ReadString(cpointer, 10);\n    std::cout &lt;&lt; FindIndexOfCharacter(cpointer, 'k');\n    system(\"pause\");\n}\n\nvoid ReadString(char * c, int Length)\n{\n    std::cout &lt;&lt; \"Enter a string \" &lt;&lt; Length &lt;&lt; \" characters.\" &lt;&lt; std::endl;\n    std::cin &gt;&gt; c;\n}\n\nint FindIndexOfCharacter(char * c, char Val)\n{\n    int sizeOfArray2 = std::strlen(c);\n    std::cout &lt;&lt; sizeOfArray2 &lt;&lt; std::endl; // this confirms array size\n\n    for (int i = 0; i &lt; sizeOfArray2; ++i)\n    {\n        if (c[i] == Val)\n            return i;\n        else\n            return -1;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "lambda", "compilation", "c++14"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1499271469, "post_id": 44931284, "comment_id": 76838475, "body": "Looks like instead of <code>std::function&lt;void(std::string)&gt;</code> what you really want would be <code>void MyServer::*(std::string)&gt;</code>   Or at least use pointer-to-member binding to create the <code>std::function</code> instances instead of yet another bunch of lambdas.  That is, <code>server.request[&quot;&#47;my_page.html&quot;] = std::bind(&amp;MyServer::do_my_page, &amp;my_server, _1);</code>"}, {"owner": {"reputation": 3981, "user_id": 1021959, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PaP06.png?s=128&g=1", "display_name": "Bernard", "link": "https://stackoverflow.com/users/1021959/bernard"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1499272049, "post_id": 44931284, "comment_id": 76838843, "body": "@BenVoigt I would prefer not to do pointer-to-member binding, because the <code>GrandServer</code> definition is in an external header file. Keeping it intact would allow easier updating of the external header when there are fixes. But yes, I think <code>std::bind</code> is probably what I want."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1499273640, "post_id": 44931284, "comment_id": 76839796, "body": "And then you might consider <code>struct { const char* path; void MyServer::*handler(std::string); } const pages[] = { { &quot;&#47;my_page.html&quot;, &amp;MyServer::do_my_page }, { ... }, { .. } };</code> followed by <code>for( auto&amp; page : pages) server.request[page.path] = std::bind(page.handler, &amp;my_server, _1);</code>  That way the messy bind call isn&#39;t repeated, only the portions that truly differ for every single resource.  The <code>pages</code> definition then doesn&#39;t even need to be inside <code>main()</code>."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1499278083, "post_id": 44931284, "comment_id": 76842221, "body": "Have you copied every single <code>#include &lt;&gt;</code> to `stdfafx.h"}], "answers": [{"comments": [{"owner": {"reputation": 3981, "user_id": 1021959, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PaP06.png?s=128&g=1", "display_name": "Bernard", "link": "https://stackoverflow.com/users/1021959/bernard"}, "edited": false, "score": 0, "creation_date": 1499308344, "post_id": 44933903, "comment_id": 76854022, "body": "Putting all my includes - <code>Windows.h</code>, standard library, external header-only libraries, my own project headers, everything included - into <code>stdafx.h</code> only reduces the compilation time slightly - to about 4-5 minutes.  It seems that the VS compiler doesn&#39;t complain that the precompiled header is too large.  My code is all stored on my local machine, so I think the part about network drives would be irrelevant for me."}], "tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": false, "score": 1, "last_activity_date": 1499280670, "creation_date": 1499280670, "answer_id": 44933903, "question_id": 44931284, "link": "https://stackoverflow.com/questions/44931284/will-converting-lambda-functions-to-normal-functions-in-another-compilation-unit/44933903#44933903", "title": "Will converting lambda functions to normal functions in another compilation unit improve compile time?", "body": "<p>Have you copied every single <code>#include &lt;&gt;</code> to <code>stdfafx.h</code> ?? This goes a long way towards reducing compilation times.  The compiler may complain about the precompiled header being too large, but the default size is ridiculously small.  </p>\n\n<p>The -Zm option controls the amount allocated for the precompiled header, in megabytes.  </p>\n\n<p>I've seen over 10 x improvements in compilation speed for some projects.</p>\n\n<p>If you map a network drive to one of your local disks, there is an easy way to see a further 3x improvement in compilation time.</p>\n\n<p>Here's a solution for that case, it involves replacing the network map to a DOS drive in the registry.  Here's what this gives for my own setup:</p>\n\n<pre><code>[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\DOS Devices] \n\"R:\"=\"\\DosDevices\\D:\\devel\\build\"\n\"S:\"=\"\\DosDevices\\D:\\devel\\src\"\n</code></pre>\n"}], "owner": {"reputation": 3981, "user_id": 1021959, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PaP06.png?s=128&g=1", "display_name": "Bernard", "link": "https://stackoverflow.com/users/1021959/bernard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1499280670, "creation_date": 1499271168, "question_id": 44931284, "link": "https://stackoverflow.com/questions/44931284/will-converting-lambda-functions-to-normal-functions-in-another-compilation-unit", "title": "Will converting lambda functions to normal functions in another compilation unit improve compile time?", "body": "<p>I am working on a C++ server project that has been plagued with a growing <code>main()</code> function, and the code base has grown to a point where compilation time is about 6 minutes (in debug mode) even after I make the slightest change to the <code>main()</code> function.  (The <code>main()</code> function is about 5000 lines long!)</p>\n\n<p>I'm using Visual Studio 2017, and (as I understand) the compiler has some pre-compiled header capabilities, as well as capability to not recompile unmodified functions.  But those stuff are currently of little use because most of the logic is in the <code>main()</code> function.</p>\n\n<p>Here's a (very simplified) version of my code:</p>\n\n<pre><code>struct GrandServer{\n    std::map&lt;std::string,std::function&lt;void(std::string)&gt;&gt; request;\n    /* some other functions of this server */\n};\n\nint main()\n{\n    SQLClient sql_client;\n    auto query_database=[&amp;sql_client](auto&amp;&amp; callback){/*stuff*/};\n    GrandServer server;\n    server.request[\"/my_page.html\"] = [](std::string&amp;&amp; data){\n        // Do stuff\n    };\n    server.request[\"/my_page_2.html\"] = [](std::string&amp;&amp; data){\n        // Do more stuff\n    };\n    server.request[\"/my_page_3.html\"] = [](std::string&amp;&amp; data){\n        // Do even more stuff\n    };\n    server.request[\"/my_page_4.html\"] = [&amp;query_database](std::string&amp;&amp; data){\n        // Do many many callbacks\n        query_database([](std::vector&lt;std::string&gt;&amp;&amp; results){\n            std::string id = std::move(results.front());\n            do_something_else([id = std::move(id)](auto&amp;&amp; param) mutable {\n                /* do more stuff, call more functions that will call back, then answer the client */\n            });\n        });\n    };\n    /* Many many more lambda functions */\n}\n</code></pre>\n\n<p>In essence, the core logic of the whole application is contained within the <code>main()</code> function, by defining lambdas stored in a <code>std::map</code>.  The lambda functions contain a few levels of lambda functions within them, mostly defining (async) callbacks from the database.  The other standalone functions consist mainly of the functions in <code>GrandServer</code> as well as various utility functions (e.g. time conversion, async callback utilities, unicode utilities, etc.) but none of them form the core logic of the application.  This feels like really bad code sprawl :(</p>\n\n<p>I'm thinking of converting all the top-level lambdas (i.e. those stored directly in <code>server.request</code>) into normal standalone member functions into a few separate compilation units like such:</p>\n\n<pre><code>// split definitions of methods in this class over several compilation units\n// header file left out for brevity\nstruct MyServer{\n    SQLClient sql_client;\n    void query_database=[this](auto&amp;&amp; callback){/*stuff*/};\n\n    void do_my_page(std::string&amp;&amp; data){\n        // Do stuff\n    }\n\n    void do_my_page_2(std::string&amp;&amp; data){\n        // Do stuff\n    }\n\n    void do_my_page_3(std::string&amp;&amp; data){\n        // Do stuff\n    }\n\n    void do_my_page_4(std::string&amp;&amp; data){\n        // Do many many callbacks\n        query_database([](std::vector&lt;int&gt;&amp;&amp; results){\n            do_something_else([](auto&amp;&amp; param){\n                /* do more stuff, call more functions that will call back, then answer the client */\n            });\n        });\n    }\n};\n\n// main.cpp\nstruct GrandServer{\n    std::map&lt;std::string,std::function&lt;void(std::string)&gt;&gt; request;\n    /* some other functions of this server */\n};\n\nint main()\n{\n    GrandServer server;\n    MyServer my_server;\n    server.request[\"/my_page.html\"] = [&amp;my_server](auto&amp;&amp;... params){my_server.do_my_page(std::forward&lt;decltype(params)&gt;(params)...);};\n    server.request[\"/my_page_2.html\"] = [&amp;my_server](auto&amp;&amp;... params){my_server.do_my_page_2(std::forward&lt;decltype(params)&gt;(params)...);};\n    server.request[\"/my_page_3.html\"] = [&amp;my_server](auto&amp;&amp;... params){my_server.do_my_page_3(std::forward&lt;decltype(params)&gt;(params)...);};\n    server.request[\"/my_page_4.html\"] = [&amp;my_server](auto&amp;&amp;... params){my_server.do_my_page_4(std::forward&lt;decltype(params)&gt;(params)...);};\n    /* Lots more lambda functions */\n}\n</code></pre>\n\n<p>While this will reduce the size of <code>main()</code> to something much more tolerable, should I expect this to reduce compilation time significantly?  There will not be any reduction in the number of template instantiations (in fact, I introduced some new template lambda forwarders in <code>main()</code> that should get inlined).</p>\n\n<p>Also note that due to the callbacks and capturing of variables using move semantics, it is not easy to change the inner lambda functions within each logic flow to normal standalone member or non-member functions.  (Template functions and classes cannot be in separate compilation units.)  However, each logic flow is usually no more than 100 lines long so I do not believe that this is necessary.</p>\n\n<p>6 minutes to compile a code base of about 6000-7000 lines seems way too slow, and I would think that this is due to my horrendously long <code>main()</code> function.  Should I expect breaking this function up as I described above to significantly improve the compile time of this project?</p>\n"}, {"tags": ["c++", "csv", "ifstream"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 3, "creation_date": 1499271141, "post_id": 44931257, "comment_id": 76838250, "body": "What do you mean by &quot;struggling to find anything&quot;? It literally says right there that the object <code>read</code> is of type <code>ifstream</code>, and you just linked to reference for <i>ifstream</i>. What is the problem?"}, {"owner": {"reputation": 17, "user_id": 5072995, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EC03VTFqJcA/AAAAAAAAAAI/AAAAAAAAADo/GszQi5jmtLU/photo.jpg?sz=128", "display_name": "ToastehMonkey", "link": "https://stackoverflow.com/users/5072995/toastehmonkey"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499271165, "post_id": 44931257, "comment_id": 76838262, "body": "I need to pass the variable read through a function and i don&#39;t know what data type it is"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499271174, "post_id": 44931257, "comment_id": 76838270, "body": "It says right there. Is this a troll? @doctorlove no it doesn&#39;t"}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1499271180, "post_id": 44931257, "comment_id": 76838273, "body": "<code>read</code> look slike a function definiton not a variable - is there more context to theis code and a specific error."}, {"owner": {"reputation": 17, "user_id": 5072995, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EC03VTFqJcA/AAAAAAAAAAI/AAAAAAAAADo/GszQi5jmtLU/photo.jpg?sz=128", "display_name": "ToastehMonkey", "link": "https://stackoverflow.com/users/5072995/toastehmonkey"}, "reply_to_user": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1499271235, "post_id": 44931257, "comment_id": 76838313, "body": "@doctorlove {aka std::__cxx11::basic_string&lt;char&gt;}&#39; is not derived from &#39;std::basic_istream&lt;_CharT, _Traits&gt;"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1499271250, "post_id": 44931257, "comment_id": 76838324, "body": "If you have a build error, present your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1499271295, "post_id": 44931257, "comment_id": 76838350, "body": "There&#39;s clearly some extra context to reproduce the error message - mention the rest of the code and the error in your question and we may be able to help"}, {"owner": {"reputation": 17, "user_id": 5072995, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EC03VTFqJcA/AAAAAAAAAAI/AAAAAAAAADo/GszQi5jmtLU/photo.jpg?sz=128", "display_name": "ToastehMonkey", "link": "https://stackoverflow.com/users/5072995/toastehmonkey"}, "reply_to_user": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1499271372, "post_id": 44931257, "comment_id": 76838412, "body": "@doctorlove Post has been updated"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499271382, "post_id": 44931257, "comment_id": 76838422, "body": "That is not a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Still, it&#39;s enough to see that you&#39;re passing an <code>ifstream</code> to a function that expects a <code>string</code>. I don&#39;t know why you thought that would work."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499271515, "post_id": 44931257, "comment_id": 76838501, "body": "Furthermore, the loop condition <code>!read.eof()</code> is wrong. Which book are you using to learn C++? It&#39;s bad."}, {"owner": {"reputation": 17, "user_id": 5072995, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EC03VTFqJcA/AAAAAAAAAAI/AAAAAAAAADo/GszQi5jmtLU/photo.jpg?sz=128", "display_name": "ToastehMonkey", "link": "https://stackoverflow.com/users/5072995/toastehmonkey"}, "edited": false, "score": 0, "creation_date": 1499271539, "post_id": 44931257, "comment_id": 76838521, "body": "C++ Programming in easy steps - mike mcgrath"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1499271592, "post_id": 44931257, "comment_id": 76838568, "body": "Never heard of it; don&#39;t know why it&#39;s so highly rated on Amazon. Here&#39;s <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">our list</a>."}, {"owner": {"reputation": 17, "user_id": 5072995, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EC03VTFqJcA/AAAAAAAAAAI/AAAAAAAAADo/GszQi5jmtLU/photo.jpg?sz=128", "display_name": "ToastehMonkey", "link": "https://stackoverflow.com/users/5072995/toastehmonkey"}, "edited": false, "score": 0, "creation_date": 1499271654, "post_id": 44931257, "comment_id": 76838606, "body": "I have a working copy of this code where the for loop is inside the read function but my &quot;boss&quot; needs it to be in <i>int(main)</i>"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1499271908, "post_id": 44931257, "comment_id": 76838762, "body": "<code>ifstream read(ans.c_str());</code> tells you that <code>read</code> is of type <code>ifstream</code>. What more do you need to know?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499272769, "post_id": 44931257, "comment_id": 76839302, "body": "This code is for a company? Your boss accepts code like this?"}, {"owner": {"reputation": 17, "user_id": 5072995, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EC03VTFqJcA/AAAAAAAAAAI/AAAAAAAAADo/GszQi5jmtLU/photo.jpg?sz=128", "display_name": "ToastehMonkey", "link": "https://stackoverflow.com/users/5072995/toastehmonkey"}, "edited": false, "score": 0, "creation_date": 1499329041, "post_id": 44931257, "comment_id": 76862319, "body": "I am on work experience, And you are just a toxic person."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5072995, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EC03VTFqJcA/AAAAAAAAAAI/AAAAAAAAADo/GszQi5jmtLU/photo.jpg?sz=128", "display_name": "ToastehMonkey", "link": "https://stackoverflow.com/users/5072995/toastehmonkey"}, "edited": false, "score": 0, "creation_date": 1499272047, "post_id": 44931490, "comment_id": 76838841, "body": "Thank you so much, this is what i needed to know, Sorry to everyone else i am just starting to use c++ so my question might&#39;ve seemed odd to you. :)"}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "reply_to_user": {"reputation": 17, "user_id": 5072995, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EC03VTFqJcA/AAAAAAAAAAI/AAAAAAAAADo/GszQi5jmtLU/photo.jpg?sz=128", "display_name": "ToastehMonkey", "link": "https://stackoverflow.com/users/5072995/toastehmonkey"}, "edited": false, "score": 0, "creation_date": 1499340352, "post_id": 44931490, "comment_id": 76870065, "body": "Glad to have helped. Keep practising. Keep asking questions. Find one or two good books (look at the list in the comments). Ask you boss/work mates too."}], "tags": [], "owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "is_accepted": false, "score": 3, "last_activity_date": 1499271891, "creation_date": 1499271891, "answer_id": 44931490, "question_id": 44931257, "link": "https://stackoverflow.com/questions/44931257/stdifstream-data-type/44931490#44931490", "title": "std::ifstream data type?", "body": "<p>You have <code>ifstream read</code> but a function </p>\n\n<pre><code>string read_function(string line, string read)\n                                 // ^------\n</code></pre>\n\n<p>If you change the function to </p>\n\n<pre><code> string read_function(string line, ifstream &amp; read)\n                                 // ^------\n</code></pre>\n\n<p>the <code>read_function</code> then expects a stream as the second parameter, not a string.</p>\n\n<p>You will have a similar problem with the next function.</p>\n\n<p>The comments point out other problems.</p>\n\n<p>If you get an error about types, sit back and look at what you are passing to functions and what they expect.</p>\n"}], "owner": {"reputation": 17, "user_id": 5072995, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EC03VTFqJcA/AAAAAAAAAAI/AAAAAAAAADo/GszQi5jmtLU/photo.jpg?sz=128", "display_name": "ToastehMonkey", "link": "https://stackoverflow.com/users/5072995/toastehmonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1343, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1499276909, "creation_date": 1499271085, "last_edit_date": 1499276909, "question_id": 44931257, "link": "https://stackoverflow.com/questions/44931257/stdifstream-data-type", "title": "std::ifstream data type?", "body": "<p>The variable \"read\" in this program needs to be passed through a function and i don't know what data type it is. I have used <a href=\"http://www.cplusplus.com/reference/fstream/ifstream/ifstream/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/fstream/ifstream/ifstream/</a>\nand <a href=\"http://www.cplusplus.com/reference/fstream/ifstream/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/fstream/ifstream/</a> but I'm struggling to find anything, is this just not possible?</p>\n\n<pre><code>int main()\n{\nstring line = \" \", ans = \" \", ans2 = \" \", data = \" \";\nint i = 0, j = 0;\ncout &lt;&lt; \"What file do you want to read? : \";\ncin &gt;&gt; ans;\ncout &lt;&lt; \"What do you want the new file to be called? : \";\ncin &gt;&gt; ans2;\nifstream read(ans.c_str());\nfor (i = 0; !read.eof(); i++)\n{\n    read_function(line, read);\n    write_function(line, ans2);\n}\nreturn 0;\n}\n\n\nstring read_function(string line, string read)\n{\n        getline(read, line, ' ');\n        cout &lt;&lt; line;\n}\n\nvoid write_function(string line, string ans2)\n{\n    ofstream write(ans2.c_str(), ios::app);\n    write &lt;&lt; line;\n    write.close();\n}\n</code></pre>\n"}, {"tags": ["c++", "matrix", "char"], "comments": [{"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 2, "creation_date": 1499271187, "post_id": 44931245, "comment_id": 76838277, "body": "<code>&#39;O&#39;</code> is always true so the if statement is always true. Meinst du vielleicht <code>matrix[2][2] == &#39;X&#39; || matrix[2][2] == &#39;O&#39;</code>? Also, why is there a <code>;</code> after <code>char Checker()</code>?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1499271374, "post_id": 44931245, "comment_id": 76838415, "body": "<code>char Checker();</code> better get rid of the <code>;</code> here.."}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1499271396, "post_id": 44931245, "comment_id": 76838433, "body": "If you want to check whether <code>p</code> is either <code>&#39;X&#39;</code> or <code>&#39;O&#39;</code>, you do <code>if ((p == &#39;X&#39;) or (p == &#39;O&#39;))</code>, not <code>if (p == &#39;X&#39; or &#39;O&#39;)</code>."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 1, "creation_date": 1499271516, "post_id": 44931245, "comment_id": 76838502, "body": "With respect to <code>&#39;Expected a declaration&#39;</code>: <code>char Checker();</code> just defines a function named Checker that returns a char. It defines no body for the function because there&#39;s a semicolon after it. So those two things are related."}, {"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 2, "creation_date": 1499271617, "post_id": 44931245, "comment_id": 76838582, "body": "Your opening paragraph doesn&#39;t explain clearly what you have done and what you are trying to achieve. What do you expect your &#39;if&#39; condition to do? It doesn&#39;t check that all elements are either &#39;O&#39; or &#39;X&#39;. Lastly, all paths should return a value from Checker()."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1499271690, "post_id": 44931245, "comment_id": 76838630, "body": "Like Paul said, I don&#39;t think that if statement is doing what you think it&#39;s doing. If we ignore the fact that it&#39;s always true because of the <code>|| &#39;O&#39;</code>, it just checks whether there&#39;s a non-zero value in most of the tic-tac-toe positions."}, {"owner": {"reputation": 1, "user_id": 8260302, "user_type": "registered", "profile_image": "https://graph.facebook.com/871469203027281/picture?type=large", "display_name": "SummerAnimations", "link": "https://stackoverflow.com/users/8260302/summeranimations"}, "edited": false, "score": 0, "creation_date": 1499272020, "post_id": 44931245, "comment_id": 76838828, "body": "The Return &#39;X&#39; or &#39;O&#39; is at another char it returns an &#39;/&#39; and to check if the game is over I made this"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1499272206, "post_id": 44931245, "comment_id": 76838929, "body": "So do you want to check if all elements of <code>matrix</code> have either an &#39;X&#39; or an &#39;O&#39; in them?"}, {"owner": {"reputation": 1, "user_id": 8260302, "user_type": "registered", "profile_image": "https://graph.facebook.com/871469203027281/picture?type=large", "display_name": "SummerAnimations", "link": "https://stackoverflow.com/users/8260302/summeranimations"}, "edited": false, "score": 0, "creation_date": 1499272316, "post_id": 44931245, "comment_id": 76838979, "body": "yes thats what I want. But now I have another problem. my game ends in Draw if I insert a wrong number"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 1, "creation_date": 1499272371, "post_id": 44931245, "comment_id": 76839007, "body": "You&#39;ll have to take each problem one at a time."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1499272449, "post_id": 44931245, "comment_id": 76839065, "body": "StackOverflow is mostly 1 problem per question. It&#39;s not fix all the bugs in my code. You can ask additional new separate questions about the other bugs."}, {"owner": {"reputation": 1, "user_id": 8260302, "user_type": "registered", "profile_image": "https://graph.facebook.com/871469203027281/picture?type=large", "display_name": "SummerAnimations", "link": "https://stackoverflow.com/users/8260302/summeranimations"}, "edited": false, "score": 0, "creation_date": 1499272566, "post_id": 44931245, "comment_id": 76839144, "body": "ok sorry it just was for Information"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1499272591, "post_id": 44931245, "comment_id": 76839166, "body": "@SummerAnimations <a href=\"https://godbolt.org/g/5STUAJ\" rel=\"nofollow noreferrer\">godbolt.org/g/5STUAJ</a>. (disclaimer: I didn&#39;t test it)"}, {"owner": {"reputation": 1, "user_id": 8260302, "user_type": "registered", "profile_image": "https://graph.facebook.com/871469203027281/picture?type=large", "display_name": "SummerAnimations", "link": "https://stackoverflow.com/users/8260302/summeranimations"}, "edited": false, "score": 0, "creation_date": 1499272768, "post_id": 44931245, "comment_id": 76839301, "body": "Thank you now it Works except if I do a mistake it changes Player"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1499272927, "post_id": 44931245, "comment_id": 76839385, "body": "If I make* a mistake. Let me know if you don&#39;t want me to correct your English. My German is worse than your English :), that&#39;s for sure. As for your problem, you will need to check that the user input was valid and only change state / perform actions if the input was valid."}, {"owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1499272977, "post_id": 44931245, "comment_id": 76839410, "body": "Yeah make a function that takes an input and validates it. I did the same"}], "answers": [{"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1499273314, "creation_date": 1499273314, "answer_id": 44931897, "question_id": 44931245, "link": "https://stackoverflow.com/questions/44931245/error-expecting-a-declaration-tictactoe-game/44931897#44931897", "title": "Error: Expecting a declaration TicTacToe Game", "body": "<p>it seems like you want</p>\n\n<pre><code> if (matrix[0][0] &amp;&amp; matrix[0][1] &amp;&amp; matrix[0][2] &amp;&amp; matrix[1][0] &amp;&amp; matrix[1][1] &amp;&amp; matrix[1][2] &amp;&amp; matrix[2][0] &amp;&amp; matrix[2][1] &amp;&amp; matrix[2][2] == 'X' || 'O')\n</code></pre>\n\n<p>to mean 'if m00 and m01 etc is X or O' sadly thats not what it means. YOu have to say it the long way</p>\n\n<pre><code>if((m00 == 'o' || m00 == 'x') &amp;&amp; (m01 == 'o' || m01 == 'x') ...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8260302, "user_type": "registered", "profile_image": "https://graph.facebook.com/871469203027281/picture?type=large", "display_name": "SummerAnimations", "link": "https://stackoverflow.com/users/8260302/summeranimations"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499273314, "creation_date": 1499271051, "last_edit_date": 1499272508, "question_id": 44931245, "link": "https://stackoverflow.com/questions/44931245/error-expecting-a-declaration-tictactoe-game", "title": "Error: Expecting a declaration TicTacToe Game", "body": "<p>Hello yesterday I started Programming a little Tic Tac Toe game but today I found a mistake. The game ends in Draw if a return of '/'(just 'X' or 'O' if somebody wins) is shown and the counter shows 9 but it also ends if I make a mistake during game and input e.g. 34 (possible inputs are 1-9) and I reach 9 (Counter).</p>\n\n<p>I want to change the '/' to 'B'\nand use\nbut I get 'Expected a declaration' at <strong>{</strong>.</p>\n\n<pre><code>char Checker();\n{\n    if (matrix[0][0] &amp;&amp; matrix[0][1] &amp;&amp; matrix[0][2] &amp;&amp; matrix[1][0] &amp;&amp; matrix[1][1] &amp;&amp; matrix[1][2] &amp;&amp; matrix[2][0] &amp;&amp; matrix[2][1] &amp;&amp; matrix[2][2] == 'X' || 'O')\n        return 'B';\n}\n</code></pre>\n\n<p>Can you help me fix this problem? If you want to see the full Code: <a href=\"https://pastebin.com/E5TzAG4t\" rel=\"nofollow noreferrer\">https://pastebin.com/E5TzAG4t</a>.\nSorry for my English its just a language I learned at School (Germany).</p>\n\n<p>Edit: This is the Checking Code 1. to see if somebody wins 2. i there was made a Mistake during number insert</p>\n\n<pre><code>char Win()\n{\n    //Spieler X\n    if (matrix[0][0] == 'X' &amp;&amp; matrix[0][1] == 'X' &amp;&amp; matrix[0][2] == 'X')\n        return 'X';\n    if (matrix[1][0] == 'X' &amp;&amp; matrix[1][1] == 'X' &amp;&amp; matrix[1][2] == 'X')\n        return 'X';\n    if (matrix[2][0] == 'X' &amp;&amp; matrix[2][1] == 'X' &amp;&amp; matrix[2][2] == 'X')\n        return 'X';\n\n    if (matrix[0][0] == 'X' &amp;&amp; matrix[1][0] == 'X' &amp;&amp; matrix[2][0] == 'X')\n        return 'X';\n    if (matrix[0][1] == 'X' &amp;&amp; matrix[1][1] == 'X' &amp;&amp; matrix[2][1] == 'X')\n        return 'X';\n    if (matrix[0][2] == 'X' &amp;&amp; matrix[1][2] == 'X' &amp;&amp; matrix[2][2] == 'X')\n        return 'X';\n\n    if (matrix[0][0] == 'X' &amp;&amp; matrix[1][1] == 'X' &amp;&amp; matrix[2][2] == 'X')\n        return 'X';\n    if (matrix[2][0] == 'X' &amp;&amp; matrix[1][1] == 'X' &amp;&amp; matrix[0][2] == 'X')\n        return 'X';\n\n    //Spieler O\n    if (matrix[0][0] == 'O' &amp;&amp; matrix[0][1] == 'O' &amp;&amp; matrix[0][2] == 'O')\n        return 'O';\n    if (matrix[1][0] == 'O' &amp;&amp; matrix[1][1] == 'O' &amp;&amp; matrix[1][2] == 'O')\n        return 'O';\n    if (matrix[2][0] == 'O' &amp;&amp; matrix[2][1] == 'O' &amp;&amp; matrix[2][2] == 'O')\n        return 'O';\n\n    if (matrix[0][0] == 'O' &amp;&amp; matrix[1][0] == 'O' &amp;&amp; matrix[2][0] == 'O')\n        return 'O';\n    if (matrix[0][1] == 'O' &amp;&amp; matrix[1][1] == 'O' &amp;&amp; matrix[2][1] == 'O')\n        return 'O';\n    if (matrix[0][2] == 'O' &amp;&amp; matrix[1][2] == 'O' &amp;&amp; matrix[2][2] == 'O')\n        return 'O';\n\n    if (matrix[0][0] == 'O' &amp;&amp; matrix[1][1] == 'O' &amp;&amp; matrix[2][2] == 'O')\n        return 'O';\n    if (matrix[2][0] == 'O' &amp;&amp; matrix[1][1] == 'O' &amp;&amp; matrix[0][2] == 'O')\n        return 'O';\n\n        return '/';\n}\nchar Checker()\n{\n    if (matrix[0][0] &amp;&amp; matrix[0][1] &amp;&amp; matrix[0][2] &amp;&amp; matrix[1][0] &amp;&amp; matrix[1][1] &amp;&amp; matrix[1][2] &amp;&amp; matrix[2][0] &amp;&amp; matrix[2][1] &amp;&amp; matrix[2][2] == 'X' || 'O' || '1' || '2' || '3' || '4' || '5' || '6' || '7' || '8' || '9')\n        return 'B';\n}\n</code></pre>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1499270856, "post_id": 44931130, "comment_id": 76838089, "body": "The rocket&#39;s right, the conversion does not matter."}, {"owner": {"reputation": 4673, "user_id": 594456, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7ebb047e22fdfa1d3002655d0824079a?s=128&d=identicon&r=PG", "display_name": "Trass3r", "link": "https://stackoverflow.com/users/594456/trass3r"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1499329918, "post_id": 44931130, "comment_id": 76862879, "body": "Thanks. <a href=\"https://bugs.llvm.org/show_bug.cgi?id=33696\" rel=\"nofollow noreferrer\">bugs.llvm.org/show_bug.cgi?id=33696</a>"}], "owner": {"reputation": 4673, "user_id": 594456, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7ebb047e22fdfa1d3002655d0824079a?s=128&d=identicon&r=PG", "display_name": "Trass3r", "link": "https://stackoverflow.com/users/594456/trass3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "closed_date": 1499270838, "answer_count": 0, "score": 1, "last_activity_date": 1499270623, "creation_date": 1499270623, "question_id": 44931130, "link": "https://stackoverflow.com/questions/44931130/lambda-expression-as-non-type-template-argument", "closed_reason": "Duplicate", "title": "lambda expression as non-type template argument", "body": "<p><code>clang -std=c++1z</code> accepts</p>\n\n<pre><code>void foo();\n\ntemplate &lt;auto f&gt;\nstruct F {};\n\nint main()\n{\n   F&lt;+[](){foo();}&gt; f;\n}\n</code></pre>\n\n<p>Note the <code>+</code> to force the conversion to function pointer.</p>\n\n<p>But gcc 7.1 rejects it <code>error: lambda-expression in template-argument</code>.\nWhich one is right?</p>\n"}, {"tags": ["c++", "dictionary", "c++98"], "comments": [{"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1499270595, "post_id": 44931094, "comment_id": 76837922, "body": "You have a typo btw. <code>std:;string</code>"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1499270616, "post_id": 44931094, "comment_id": 76837935, "body": "Are you asking how you can access a static class variable?"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1499270718, "post_id": 44931094, "comment_id": 76838005, "body": "This compiles for me once I fix the typo. What specifically is your problem?"}, {"owner": {"reputation": 199, "user_id": 5715878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153364821304308/picture?type=large", "display_name": "CSLearner", "link": "https://stackoverflow.com/users/5715878/cslearner"}, "edited": false, "score": 0, "creation_date": 1499270724, "post_id": 44931094, "comment_id": 76838014, "body": "Thanks Millie, I&#39;ll edit that.    Yes Rakete1111, my goal is to access the static class variable from a seperate file.    The codebase I&#39;m using is larger than the example I&#39;m posting so I&#39;ll be including .h files in the actual codebase I&#39;m working on.  #include &quot;.cpp&quot; is just a placeholder basically right now."}, {"owner": {"reputation": 199, "user_id": 5715878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153364821304308/picture?type=large", "display_name": "CSLearner", "link": "https://stackoverflow.com/users/5715878/cslearner"}, "edited": false, "score": 0, "creation_date": 1499270853, "post_id": 44931094, "comment_id": 76838086, "body": "Right now this code doesn&#39;t compile and gives me: &quot;undefined reference to &#39;HasGlobals::globalData&#39;.  Basically the entire printContentsOfGlobal() method is total garbage right now."}, {"owner": {"reputation": 199, "user_id": 5715878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153364821304308/picture?type=large", "display_name": "CSLearner", "link": "https://stackoverflow.com/users/5715878/cslearner"}, "edited": false, "score": 0, "creation_date": 1499272067, "post_id": 44931094, "comment_id": 76838854, "body": "The link is helpful but I&#39;m not working with a static integer so there are some small differences between my problem and the link.  Thank you for sharing of course."}, {"owner": {"reputation": 199, "user_id": 5715878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153364821304308/picture?type=large", "display_name": "CSLearner", "link": "https://stackoverflow.com/users/5715878/cslearner"}, "edited": false, "score": 0, "creation_date": 1499273427, "post_id": 44931094, "comment_id": 76839680, "body": "Would I define the static member in WantsGlobal.cpp?"}], "answers": [{"comments": [{"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1499271031, "post_id": 44931164, "comment_id": 76838191, "body": "I&#39;d guess an instance of the globals was created to put something in the map, looking at the code. Doing so on the heap was asking for a memory leak though."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1499271051, "post_id": 44931164, "comment_id": 76838204, "body": "@doctorlove: Yep. OP can initialise at the point of definition instead."}, {"owner": {"reputation": 199, "user_id": 5715878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153364821304308/picture?type=large", "display_name": "CSLearner", "link": "https://stackoverflow.com/users/5715878/cslearner"}, "edited": false, "score": 0, "creation_date": 1499271922, "post_id": 44931164, "comment_id": 76838774, "body": "To clarify, the code above is meant as an example of the actual problem I&#39;m trying to fix while isolating the parts I felt were relevant.  I&#39;ve tried implementing the changes you suggested but the code still isn&#39;t compiling."}, {"owner": {"reputation": 199, "user_id": 5715878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153364821304308/picture?type=large", "display_name": "CSLearner", "link": "https://stackoverflow.com/users/5715878/cslearner"}, "edited": false, "score": 0, "creation_date": 1499273370, "post_id": 44931164, "comment_id": 76839640, "body": "Right now the print statements look like this:  for(std::map&lt;int, std::string&gt;::iterator it = HasGlobals::globalData.begin(); it != HasGlobals::globalData.end(); ++it){ std::cout &lt;&lt; it-&gt;first &lt;&lt; &quot; &quot; &lt;&lt; it-&gt;second &lt;&lt; std::endl;  }  For the defining would I put the definition in the WantsGlobals.cpp file?"}, {"owner": {"reputation": 199, "user_id": 5715878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153364821304308/picture?type=large", "display_name": "CSLearner", "link": "https://stackoverflow.com/users/5715878/cslearner"}, "edited": false, "score": 0, "creation_date": 1499274649, "post_id": 44931164, "comment_id": 76840308, "body": "The duplicate has a single file while mine is 3 seperate files for this specific example which is why I inquired which specific file requires the definition.  I am not sure which book you&#39;re referencing."}, {"owner": {"reputation": 199, "user_id": 5715878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153364821304308/picture?type=large", "display_name": "CSLearner", "link": "https://stackoverflow.com/users/5715878/cslearner"}, "edited": false, "score": 0, "creation_date": 1499366074, "post_id": 44931164, "comment_id": 76888526, "body": "Thank you for all your help!  I was able to get it working!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 199, "user_id": 5715878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153364821304308/picture?type=large", "display_name": "CSLearner", "link": "https://stackoverflow.com/users/5715878/cslearner"}, "edited": false, "score": 0, "creation_date": 1499367576, "post_id": 44931164, "comment_id": 76889285, "body": "@CSLearner: That code is <i>much</i> better now."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 4, "last_activity_date": 1499271034, "last_edit_date": 1499271034, "creation_date": 1499270743, "answer_id": 44931164, "question_id": 44931094, "link": "https://stackoverflow.com/questions/44931094/how-do-i-access-a-static-map-from-a-seperate-class-in-c/44931164#44931164", "title": "How do I access a static map from a seperate class in C++?", "body": "<p><em>(CW as this is now just hints &amp; tips on a dupe, left for posterity.)</em></p>\n\n<p>Why are you <code>#include</code>ing <code>.cpp</code> files? Don't do that. It looks like those two files should be named <code>.hpp</code> instead.</p>\n\n<p>You're close. Since the map is <code>static</code>, you don't need an instance of <code>HasGlobals</code> to access it, so <code>HasGlobals * globalRetriever = new HasGlobals();</code> is pointless (plus you leaked it).</p>\n\n<p>The map is \"called\" <code>HasGlobals::globalData</code>.</p>\n\n<p>Though you will need to find some place to add data to it; the <code>HasGlobals</code> constructor is not the proper place, as that is called <em>every</em> time you instantiate the class. Best to use the <em>initialiser</em> when you define the object, which you forgot to do, hence the \"undefined reference\" linker error you mentioned in comments.</p>\n\n<p>You are using the map correctly from then on, except from a typo here:</p>\n\n<pre><code>std::map&lt;int, std:;string&gt;\n//                ^\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 5715878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153364821304308/picture?type=large", "display_name": "CSLearner", "link": "https://stackoverflow.com/users/5715878/cslearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "closed_date": 1499270905, "accepted_answer_id": 44931164, "answer_count": 1, "score": 0, "last_activity_date": 1499368882, "creation_date": 1499270480, "last_edit_date": 1499368882, "question_id": 44931094, "link": "https://stackoverflow.com/questions/44931094/how-do-i-access-a-static-map-from-a-seperate-class-in-c", "closed_reason": "Duplicate", "title": "How do I access a static map from a seperate class in C++?", "body": "<p>I'd like to access a static map that is stored in a seperate class and iterate through and print the contents.  </p>\n\n<p>So I have three files:</p>\n\n<p>HasGlobals.cpp which has the global map.</p>\n\n<pre><code>/* HasGlobals.cpp */\n\n#include &lt;string&gt;\n#include &lt;map&gt;\n#include &lt;iostream&gt;\n\nclass HasGlobals{\n    public:\n        static std::map&lt;int, std::string&gt; globalData;\n\n        HasGlobals(){\n            globalData.insert(std::pair&lt;int, std::string&gt;(0, \"data\"));\n        };\n\n        ~HasGlobals(){\n        };\n};\n</code></pre>\n\n<p>WantsGlobals.cpp which has a method that needs to use the map from HasGlobals.cpp for one of its methods.</p>\n\n<pre><code>/* WantsGlobals.cpp */\n\n#include \"HasGlobals.cpp\"\n#include &lt;string&gt;\n\nclass WantsGlobals{\n    public:\n        WantsGlobals(){\n        };\n\n        ~WantsGlobals(){\n        };\n\n        //THIS IS THE METHOD THAT I CAN'T GET TO WORK\n        void printContentsOfGlobal(){\n            HasGlobals * globalRetriever = new HasGlobals();\n            for(std::map&lt;int, std::string&gt;::iterator it = globalRetriever-&gt;globalData.begin(); it != globalRetriever-&gt;globalData.end(); ++it){\n                std::cout &lt;&lt; it-&gt;first &lt;&lt; \" \" &lt;&lt; it-&gt;second &lt;&lt; std::endl;\n            }\n        };\n    };\n</code></pre>\n\n<p>Main.cpp which simply tries to call the printContentsOfGlobal() method in WantsGlobals.cpp.</p>\n\n<pre><code>/* Main.cpp */\n\n#include &lt;iostream&gt;\n#include \"WantsGlobals.cpp\"\n\nint main(){\n    WantsGlobals * globalRetriever = new WantsGlobals();\n    globalRetriever-&gt;printContentsOfGlobal();\n}\n</code></pre>\n\n<p>Right now this code doesn't compile and gives me</p>\n\n<blockquote>\n  <p>undefined reference to 'HasGlobals::globalData'</p>\n</blockquote>\n\n<p>How would I implement printContentsOfGlobal() so that I can retrieve the data in the map[globalData] in the seperate HasGlobals.cpp file?</p>\n\n<p><strong>EDIT:</strong>\n<em>Thanks for the help everyone.  Below is the code I created with everyone's help.  Yes it's still not perfect but it compiles and performs the desired behavior:</em></p>\n\n<p>HasGlobals.hpp</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;map&gt;\n#include &lt;iostream&gt;\n\nclass HasGlobals{\n    public:\n        static std::map&lt;int, std::string&gt; globalData;\n\n        HasGlobals(){};\n\n        ~HasGlobals(){};\n\n        static std::map&lt;int, std::string&gt; createDummyData(){\n            std::map&lt;int, std::string&gt; m;\n            m[0] = \"Help\";\n            m[1] = \"Me\";\n            m[2] = \"Stackoverflow\";\n            m[3] = \"You're my only hope.\";\n            return m;\n         }\n};\n\nstd::map&lt;int, std::string&gt; HasGlobals::globalData = HasGlobals::createDummyData();\n</code></pre>\n\n<p>WantsGlobals.hpp</p>\n\n<pre><code>#include \"HasGlobals.hpp\"\n#include &lt;string&gt;\n#include &lt;map&gt;\n\nclass WantsGlobals{\n    public:\n        WantsGlobals(){};\n\n        ~WantsGlobals(){};\n\n        void printContentsOfGlobal(){\n            for(std::map&lt;int, std::string&gt;::iterator it = HasGlobals::globalData.begin(); it != HasGlobals::globalData.end(); ++it){\n                 std::cout &lt;&lt; it-&gt;first &lt;&lt; \" \" &lt;&lt; it-&gt;second &lt;&lt; std::endl;\n             }\n         };\n};\n</code></pre>\n\n<p>Main.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;\"WantsGlobals.hpp\"&gt;\n\nint main(){\n    WantsGlobals * globalRetriever = new WantsGlobals();\n    globalRetriever-&gt;printContentsOfGlobal();\n}\n</code></pre>\n"}, {"tags": ["c++", "mfc"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1499289881, "post_id": 44931022, "comment_id": 76848690, "body": "Don&#39;t tag something as <code>random</code> just because it involves a bug which you can&#39;t reliably reproduce. <code>random</code> should be reserved for questions involving the use of random number generators. I am thus deleting that tag."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1499295532, "post_id": 44931022, "comment_id": 76850911, "body": "I don&#39;t think a service can open a window."}, {"owner": {"reputation": 13842, "user_id": 2790621, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/b7bSs.jpg?s=128&g=1", "display_name": "xMRi", "link": "https://stackoverflow.com/users/2790621/xmri"}, "edited": false, "score": 0, "creation_date": 1499327032, "post_id": 44931022, "comment_id": 76861029, "body": "GetLastError checked?"}, {"owner": {"reputation": 133, "user_id": 3725395, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/3692af387c7259d510553858b107190b?s=128&d=identicon&r=PG&f=1", "display_name": "user3725395", "link": "https://stackoverflow.com/users/3725395/user3725395"}, "edited": false, "score": 0, "creation_date": 1499410169, "post_id": 44931022, "comment_id": 76903357, "body": "yes, it was always 0.   the solution was the heap limit when running as a service is different to normal."}], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 3725395, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/3692af387c7259d510553858b107190b?s=128&d=identicon&r=PG&f=1", "display_name": "user3725395", "link": "https://stackoverflow.com/users/3725395/user3725395"}, "is_accepted": false, "score": 0, "last_activity_date": 1499323921, "creation_date": 1499323921, "answer_id": 44941694, "question_id": 44931022, "link": "https://stackoverflow.com/questions/44931022/domodal-main-application-returning-1-code-randomly/44941694#44941694", "title": "DoModal main application returning -1 code randomly", "body": "<p>the solution was in article: <a href=\"https://stackoverflow.com/questions/17472389/how-to-increase-the-maximum-number-of-child-processes-that-can-be-spawned-by-a-w\">How to increase the maximum number of child processes that can be spawned by a windows service -- desktop heap limits</a></p>\n\n<p>worked for me, but had to reboot after making changes for it to take effect.</p>\n"}], "owner": {"reputation": 133, "user_id": 3725395, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/3692af387c7259d510553858b107190b?s=128&d=identicon&r=PG&f=1", "display_name": "user3725395", "link": "https://stackoverflow.com/users/3725395/user3725395"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499323921, "creation_date": 1499270282, "last_edit_date": 1499289924, "question_id": 44931022, "link": "https://stackoverflow.com/questions/44931022/domodal-main-application-returning-1-code-randomly", "title": "DoModal main application returning -1 code randomly", "body": "<p>I have a vc++ program that calls another large exe written in MFC vc++ over and over with create process threads.\nsometimes the exe fails to start because the DoModal in the exe fails, but not always. out of 6 calls, 2 may not start.</p>\n\n<p>is there some sort of resource limit? or something else that can identify the problem rather than a -1 return code?\nIt seems to be mainly when I run as a service under localsystem account, not sure why - might be a red herring.</p>\n\n<p>In the main application startup main window:-</p>\n\n<pre><code> CTestDlg dlg;\n int ret = dlg.DoModal();\n</code></pre>\n\n<p>return code is sometimes -1.</p>\n"}, {"tags": ["c++", "libssh2"], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 8222493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/60bb1c967f8edaf50b289e18b7263e27?s=128&d=identicon&r=PG", "display_name": "Samega 7Cattac", "link": "https://stackoverflow.com/users/8222493/samega-7cattac"}, "is_accepted": true, "score": 1, "last_activity_date": 1499369750, "creation_date": 1499369750, "answer_id": 44957472, "question_id": 44930981, "link": "https://stackoverflow.com/questions/44930981/libssh2-libssh2-scp-recv2-function/44957472#44957472", "title": "Libssh2 - libssh2_scp_recv2 function", "body": "<p>I found the answer!\nThis function is only to make a request to that session and them it's just read it like a ssh output using the <code>libssh2_channel_read()</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 42, "user_id": 11224958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cffb461b76ffe2c3be226d7e1dcf3e6?s=128&d=identicon&r=PG&f=1", "display_name": "dev0", "link": "https://stackoverflow.com/users/11224958/dev0"}, "is_accepted": false, "score": 0, "last_activity_date": 1618921291, "creation_date": 1618921291, "answer_id": 67178842, "question_id": 44930981, "link": "https://stackoverflow.com/questions/44930981/libssh2-libssh2-scp-recv2-function/67178842#67178842", "title": "Libssh2 - libssh2_scp_recv2 function", "body": "<p>There is an example of how to use <code>libssh2_scp_recv2()</code> and <code>libssh2_channel_read()</code> in the file /example/scp.c</p>\n<p>I replaced the <code>write(1, mem, rc)</code> there by <code>fwrite (mem, 1, amount, targetFile)</code> to write the buffer content to a file.</p>\n"}], "owner": {"reputation": 191, "user_id": 8222493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/60bb1c967f8edaf50b289e18b7263e27?s=128&d=identicon&r=PG", "display_name": "Samega 7Cattac", "link": "https://stackoverflow.com/users/8222493/samega-7cattac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 44957472, "answer_count": 2, "score": 1, "last_activity_date": 1618921291, "creation_date": 1499270178, "question_id": 44930981, "link": "https://stackoverflow.com/questions/44930981/libssh2-libssh2-scp-recv2-function", "title": "Libssh2 - libssh2_scp_recv2 function", "body": "<p>Can someone explain me the <code>libssh2_scp_recv2()</code> function from libssh2 lib?</p>\n\n<p>According <a href=\"https://www.libssh2.org/libssh2_scp_recv2.html\" rel=\"nofollow noreferrer\">to this</a> I need to input the session var (<code>LIBSSH2_SESSION *session</code>), the path to the file I want (<code>const char *path</code>) and a struct with information of the file I want (<code>struct_stat *sb</code>).</p>\n\n<p>Where is the part I receive the data from that file? Because what return is a pointer to the channel.</p>\n"}, {"tags": ["python", "c++", "cython"], "comments": [{"owner": {"reputation": 5662, "user_id": 5781248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/712de4f2f811d1a400d3311c9cdd5836?s=128&d=identicon&r=PG&f=1", "display_name": "J.J. Hakala", "link": "https://stackoverflow.com/users/5781248/j-j-hakala"}, "edited": false, "score": 0, "creation_date": 1499376531, "post_id": 44930707, "comment_id": 76893729, "body": "A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> might be useful"}], "owner": {"reputation": 4924, "user_id": 2862719, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yzhk5.png?s=128&g=1", "display_name": "m00am", "link": "https://stackoverflow.com/users/2862719/m00am"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499269362, "creation_date": 1499269362, "question_id": 44930707, "link": "https://stackoverflow.com/questions/44930707/strings-returned-from-c-code-are-padded-with-random-values", "title": "Strings returned from C++ code are padded with random values", "body": "<p>I tried to write a Cython wrapper for some C++ code. When I compile and execute the C++ file, the input string gets translated correctly. Example output:</p>\n\n<pre><code>T*GRSLR*L\nRKVDLCDSL\n[...]\n</code></pre>\n\n<p>However when I run my code from the Cython wrapper in Python, the string is padded like this:</p>\n\n<pre><code>b'T*GRSLR*R\\x8f\\x96\\x01'\nb'RKVDLCDSR\\x8f\\x96\\x01'\n[...]\n</code></pre>\n\n<p>Sometimes this happens only with one sequence, sometimes with all of them. </p>\n\n<p>I used the following Cython code to interface with my C++ code:</p>\n\n<pre><code># file: sixframe.pyx\nfrom libcpp.string cimport string\nfrom libcpp.vector cimport vector\n\ncdef extern from \"six_frame.cpp\":\n    cdef void initCodonTable()\n    cdef vector[string] sixFrame(string seq)\n\ndef six_frame(bytes seq):\n    return sixFrame(seq)\n\ninitCodonTable()\n</code></pre>\n\n<p>and the signature of my C++ function is:</p>\n\n<pre><code>// file: six_frame.cpp\nvector&lt;string&gt; sixFrame(string seq){\n    ...\n}\n</code></pre>\n\n<p>This error terribly looks like I am using a wrong type and the end of the string is not detected correctly. I suspect the error is in the Cython code, since the C++ executable works as intended. Does anyone have an idea what is going wrong here?</p>\n"}, {"tags": ["c++", "winapi", "keylogger"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1499273346, "post_id": 44930693, "comment_id": 76839626, "body": "They all require you to press shift right?"}, {"owner": {"reputation": 5939, "user_id": 7074490, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/56kzw.jpg?s=128&g=1", "display_name": "roy", "link": "https://stackoverflow.com/users/7074490/roy"}, "edited": false, "score": 0, "creation_date": 1499273883, "post_id": 44930693, "comment_id": 76839923, "body": "this can help you <a href=\"https://stackoverflow.com/questions/43724247/check-if-alt-key-is-pressed/43726477#43726477\" title=\"check if alt key is pressed\">stackoverflow.com/questions/43724247/&hellip;</a>"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1499275611, "post_id": 44930693, "comment_id": 76840861, "body": "You are mixing <code>GetKeyState()</code> and <code>GetAsyncKeyState()</code>. Knowing the difference between these two is essential."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8260160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8a4cafe88da8a6b529d347cc8338a8?s=128&d=identicon&r=PG&f=1", "display_name": "Dbzdur", "link": "https://stackoverflow.com/users/8260160/dbzdur"}, "edited": false, "score": 0, "creation_date": 1499330728, "post_id": 44935823, "comment_id": 76863359, "body": "Thanks for answer, I will use Windows Hooks."}, {"owner": {"reputation": 815, "user_id": 495564, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/404c7306fb8dfb224fdebe0abb2898e0?s=128&d=identicon&r=PG", "display_name": "Gogeta70", "link": "https://stackoverflow.com/users/495564/gogeta70"}, "reply_to_user": {"reputation": 23, "user_id": 8260160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8a4cafe88da8a6b529d347cc8338a8?s=128&d=identicon&r=PG&f=1", "display_name": "Dbzdur", "link": "https://stackoverflow.com/users/8260160/dbzdur"}, "edited": false, "score": 0, "creation_date": 1499378170, "post_id": 44935823, "comment_id": 76894388, "body": "If someone is going to downvote my answer, I would appreciate at the very least an explanation of why you decided to downvote it."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 23, "user_id": 8260160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8a4cafe88da8a6b529d347cc8338a8?s=128&d=identicon&r=PG&f=1", "display_name": "Dbzdur", "link": "https://stackoverflow.com/users/8260160/dbzdur"}, "edited": false, "score": 0, "creation_date": 1505408401, "post_id": 44935823, "comment_id": 79412535, "body": "A low-level keyboard hook intercepts keystrokes, not characters. The system doesn&#39;t determine the final character that gets sent to an application in a low-level keyboard hook. The OP is asking for characters. Your proposed solution has the very same shortcoming the OP is trying to solve. @Dbzdur: Please don&#39;t accept an answer that doesn&#39;t solve your problem."}, {"owner": {"reputation": 815, "user_id": 495564, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/404c7306fb8dfb224fdebe0abb2898e0?s=128&d=identicon&r=PG", "display_name": "Gogeta70", "link": "https://stackoverflow.com/users/495564/gogeta70"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1505409674, "post_id": 44935823, "comment_id": 79413282, "body": "@IInspectable On the contrary, low-level keyboard hooks contain a data structure that indicates the resulting character using a virtual key-code, which generally correspond to their ASCII value. If you&#39;re going to bother scrutinizing all of my answers, at least take the time to read the documentation before making false accusations. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms644967%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1505413251, "post_id": 44935823, "comment_id": 79415268, "body": "Do <code>a</code> and <code>A</code> have different virtual-key codes? The OP needs to distinguish between uppercase and lowercase characters. And what would be the virtual-key code for the character <code>&#225;</code>, or <code>_</code>, which the OP was explicitly asking for? No, I&#39;m afraid, you haven&#39;t understood, how <code>WM_KEYDOWN</code> and <code>WM_CHAR</code> are completely different beasts. The latter is the one the OP is interested in, while your proposed solution provides the former only."}, {"owner": {"reputation": 815, "user_id": 495564, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/404c7306fb8dfb224fdebe0abb2898e0?s=128&d=identicon&r=PG", "display_name": "Gogeta70", "link": "https://stackoverflow.com/users/495564/gogeta70"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1505414492, "post_id": 44935823, "comment_id": 79415933, "body": "@IInspectable You&#39;re nit-picking here at something that&#39;s really a non-issue. Given a low-level keyboard hook, it&#39;s pretty trivial to keep track of the state of the Caps Lock and Shift keys. You also seem to miss the entire point of Stack Overflow with your commentary. The Windows API only provides certain facilities for developing keylogger-like functionality. Windows Hooks are the way to go without developing a driver. I pointed the OP in the right direction, I have no obligation to write a fully functional keylogger for him. It&#39;s up to him to learn for himself."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1505415245, "post_id": 44935823, "comment_id": 79416350, "body": "How is pointing out, that your proposed answer <b>completely</b> misses to address the OP&#39;s problem <i>&quot;nit-picking&quot;</i>? It may be pretty trivial to keep track of the Caps Lock key, or the Shift key. Combining both is more involved. Take dead-character keys into account, and your state machine gets complex already. Consider IME&#39;s, and the task will become near impossible. A hook <i>may</i> be part of a solution. But most definitely <b>not</b> a low-level keyboard hook. This answer is not useful. -1. You asked for an explanation, there you have it."}, {"owner": {"reputation": 815, "user_id": 495564, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/404c7306fb8dfb224fdebe0abb2898e0?s=128&d=identicon&r=PG", "display_name": "Gogeta70", "link": "https://stackoverflow.com/users/495564/gogeta70"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1505419879, "post_id": 44935823, "comment_id": 79418717, "body": "@IInspectable I can see that regardless of me explaining the intentions behind my answer, you remain very narrow-minded. I hope one day you realize that there is more than one way to solve a problem and that your opinion is not analogous to fact. It is people like you that drive others away from SE communities. Anyway, feel free to go through all of my answers (I see you&#39;ve already started) and apply your insular point of view to them. I&#39;m done with this conversation and I have better things to do with my time. Best of luck to you."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1505421101, "post_id": 44935823, "comment_id": 79419327, "body": "Given your low-level keyboard hook, how do you propose to intercept input of an underscore (<code>_</code>) character? Should be simple, right? Let&#39;s see it then. That&#39;s still far from <i>&quot;a fully functional keylogger&quot;</i>. If you cannot deliver even that tiny bit of information, then this is a strong indication, that, while there may be different solutions, this is not one of them."}, {"owner": {"reputation": 815, "user_id": 495564, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/404c7306fb8dfb224fdebe0abb2898e0?s=128&d=identicon&r=PG", "display_name": "Gogeta70", "link": "https://stackoverflow.com/users/495564/gogeta70"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1505424614, "post_id": 44935823, "comment_id": 79420880, "body": "@IInspectable Just to prove my point, I wrote a partially functional low-level keyboard hook that handles A-Z, a-z, 0-9, 0-9 secondary, plus, minus, underscore, tilde, comma, period, less-than, greater-than, forward slash, quesstion-mark, colon, semi-colon, equal sign, tick-mark, and the enter key. It is hastily written (so, a little sloppy and uncommented) and does not track the Caps Lock state or handle any other keypresses, simply because I feel I&#39;ve made my point with what I&#39;ve got here. <a href=\"https://pastebin.com/29MdUhHz\" rel=\"nofollow noreferrer\">pastebin.com/29MdUhHz</a>"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1505425466, "post_id": 44935823, "comment_id": 79421196, "body": "Isn&#39;t that odd, it fails for a number of characters for me, e.g. <code>=</code> or <code>)</code>. It is always an error to assume an environment you cannot enforce. Sorry, that one doesn&#39;t even suffice as a proof-of-concept. Unless you meant to proof, that your concept is wrong. Which this perfectly does."}, {"owner": {"reputation": 815, "user_id": 495564, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/404c7306fb8dfb224fdebe0abb2898e0?s=128&d=identicon&r=PG", "display_name": "Gogeta70", "link": "https://stackoverflow.com/users/495564/gogeta70"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1505427807, "post_id": 44935823, "comment_id": 79422041, "body": "@IInspectable <i>sigh</i> It&#39;s something I threw together in 20 minutes, I wasn&#39;t really focused on supporting different keyboard layouts or non-english characters. You asked me to intercept the input of an underscore character, that was what I was trying to prove. To provide support for different keyboard layouts and non-ascii characters, you&#39;d need to determine regional settings. Having written my own OS kernel before, you work with keyboard scan codes. The low-level keyboard hook provides that as well, so it is entirely possible."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1505429199, "post_id": 44935823, "comment_id": 79422416, "body": "Oh of course, it&#39;s entirely possible. The OS does it already! You just picked the wrong hook and now try to re-implement, what the system already offers. In case you want to continue down that route of much dismay, it&#39;s not enough to look up regional settings. You&#39;re going to have to find out, whose thread&#39;s input you intercepted (entirely non-trivial by itself), and then check for that thread&#39;s regional settings. You&#39;d need to do this for an underscore, too. Anyway, 2 down-votes, 0 up-votes. Did you not get the hint?"}], "tags": [], "owner": {"reputation": 815, "user_id": 495564, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/404c7306fb8dfb224fdebe0abb2898e0?s=128&d=identicon&r=PG", "display_name": "Gogeta70", "link": "https://stackoverflow.com/users/495564/gogeta70"}, "is_accepted": true, "score": -1, "last_activity_date": 1499288123, "creation_date": 1499288123, "answer_id": 44935823, "question_id": 44930693, "link": "https://stackoverflow.com/questions/44930693/getasynckeystate-dont-work-with-oem-keys/44935823#44935823", "title": "GetAsyncKeyState() don&#39;t work with &#39;OEM&#39; keys", "body": "<p>First off, this is a very naive approach to writing a keylogger. I actually tried this same thing the same way you are about 10 years ago.</p>\n\n<p>A better approach would be to use Windows <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms644990%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">Hooks</a>.</p>\n\n<pre><code>LRESULT CALLBACK llKeyboardHook(int nCode, WPARAM wParam, LPARAM lParam)\n{\n    KBDLLHOOKSTRUCT *hookStruct = (KBDLLHOOKSTRUCT*) lParam;\n\n    // Parse the lParam value and members of the hookStruct structure\n\n    return CallNextHookEx(0, nCode, wParam, lParam);\n}\n\n// Somewhere in your program, call the following function:\n// Initialize the hook\nSetWindowsHookEx(WH_KEYBOARD_LL, (HOOKPROC) llKeyboardHook, 0, 0);\n</code></pre>\n\n<p>The main idea here is to let Windows determine the resulting \"output\" character for you, instead of having to create a switch-case for each possibility like you have done.</p>\n\n<p>I know this doesn't directly answer your question, but the approach you're taking is really the worst way to do it.</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 8225999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8fc1470b7514f168ffde338203a02e7?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin2002", "link": "https://stackoverflow.com/users/8225999/benjamin2002"}, "is_accepted": false, "score": 1, "last_activity_date": 1530153525, "creation_date": 1530153525, "answer_id": 51073922, "question_id": 44930693, "link": "https://stackoverflow.com/questions/44930693/getasynckeystate-dont-work-with-oem-keys/51073922#51073922", "title": "GetAsyncKeyState() don&#39;t work with &#39;OEM&#39; keys", "body": "<p>try this, change the for loop variable <code>key</code> to int instead of char.</p>\n\n<pre><code>int key;\n\nwhile (1) {\n    for (key=8; key&lt;= 255; key++) {\n        if (i &lt; 160 || i &gt;165) {\n            if (GetAsyncKeyState(i) == -32767) {\n                &lt;event&gt;\n            }\n        }\n    }\n}\n\nreturn 0;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8260160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8a4cafe88da8a6b529d347cc8338a8?s=128&d=identicon&r=PG&f=1", "display_name": "Dbzdur", "link": "https://stackoverflow.com/users/8260160/dbzdur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 965, "favorite_count": 0, "accepted_answer_id": 44935823, "answer_count": 2, "score": 0, "last_activity_date": 1530153525, "creation_date": 1499269320, "last_edit_date": 1499271200, "question_id": 44930693, "link": "https://stackoverflow.com/questions/44930693/getasynckeystate-dont-work-with-oem-keys", "title": "GetAsyncKeyState() don&#39;t work with &#39;OEM&#39; keys", "body": "<p>I'm trying to create a keylogger. I decided to use the function GetAsyncKeyState. I programmed all of keys. And when I was testing my keylogger, I realized that keys like ,&lt;.>/?;:'\"[{]}\\|=+-_ aren't displaying on the console. Why?</p>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;Windows.h&gt;\n#include &lt;string&gt;\n#include &lt;cctype&gt;\n#include &lt;conio.h&gt;\n\nusing namespace std;\n\nstring WhichKey(char key)\n{\nstring ToReturn;\n\nswitch (key)\n{\ncase VK_BACK:\n    return \"*BACKSPACE*\";\ncase VK_TAB:\n    return \"*TAB*\";\ncase VK_RETURN:\n    return \"*ENTER*\";\ncase VK_SHIFT:\n    return \"*SHIFT*\";\ncase VK_MENU:\n    return \"*ALT*\";\ncase VK_CONTROL:\n    return \"*CTRL*\";\ncase VK_ESCAPE:\n    return \"*ESC*\";\ncase VK_SPACE:\n    return \" \";\ncase VK_PRIOR:\n    return \"*PAGE_UP*\";\ncase VK_NEXT:\n    return \"*PAGE_DOWN*\";\ncase VK_END:\n    return \"*END*\";\ncase VK_HOME:\n    return \"*HOME*\";\ncase VK_CAPITAL:\n    return \"*CAPS_LOCK*\";\ncase VK_UP:\n    return \"*UP_ARROW*\";\ncase VK_DOWN:\n    return \"*DOWN_ARROW*\";\ncase VK_LEFT:\n    return \"*LEFT_ARROW*\";\ncase VK_RIGHT:\n    return \"*RIGHT_ARROW*\";\ncase VK_EXECUTE:\n    return \"*EXECUTE*\";\ncase VK_SNAPSHOT:\n    return \"*PRINTSCREEN*\";\ncase VK_INSERT:\n    return \"*INSERT*\";\ncase VK_DELETE:\n    return \"*DELETE*\";\ncase VK_LWIN:\ncase VK_RWIN:\n    return \"*WIN*\";\ncase VK_NUMPAD0:\n    return \"0\";\ncase VK_NUMPAD1:\n    return \"1\";\ncase VK_NUMPAD2:\n    return \"2\";\ncase VK_NUMPAD3:\n    return \"3\";\ncase VK_NUMPAD4:\n    return \"4\";\ncase VK_NUMPAD5:\n    return \"5\";\ncase VK_NUMPAD6:\n    return \"6\";\ncase VK_NUMPAD7:\n    return \"7\";\ncase VK_NUMPAD8:\n    return \"8\";\ncase VK_NUMPAD9:\n    return \"9\";\ncase VK_F1:\n    return \"*F1*\";\ncase VK_F2:\n    return \"*F2*\";\ncase VK_F3:\n    return \"*F3*\";\ncase VK_F4:\n    return \"*F4*\";\ncase VK_F5:\n    return \"*F5*\";\ncase VK_F6:\n    return \"*F6*\";\ncase VK_F7:\n    return \"*F7*\";\ncase VK_F8:\n    return \"*F8*\";\ncase VK_F9:\n    return \"*F9*\";\ncase VK_F10:\n    return \"*F10*\";\ncase VK_F11:\n    return \"*F11*\";\ncase VK_F12:\n    return \"*F12*\";\ncase VK_SCROLL:\n    return \"*SCROLL_LOCK*\";\ncase VK_NUMLOCK:\n    return \"*NUM_LOCK*\";\ncase VK_MULTIPLY:\n    return \"*\";\ncase VK_ADD:\n    return \"+\";\ncase VK_SUBTRACT:\n    return \"-\";\ncase VK_DIVIDE:\n    return \"/\";\ncase VK_DECIMAL:\n    return \".\";\ncase VK_LBUTTON:\n    return \"*left_click*\";\ncase VK_RBUTTON:\n    return \"*right_click*\";\ncase VK_MBUTTON:\n    return \"*middle_click*\";\n}\n\nif (isalpha(key))\n{\n    if (!((GetKeyState(VK_CAPITAL) &amp; 0x0001) == 0) ^ (((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)))\n    {\n        key = tolower(key);                                                     //off\n        ToReturn += key;\n        return ToReturn;\n    }\n    else\n    {\n        ToReturn += key;                                                        //on\n        return ToReturn;\n    }\n}\nelse if (isdigit(key))\n{\n    if ((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)\n    {\n        ToReturn += key;                                                        //off\n        return ToReturn;\n    }\n    else\n    {\n        switch (key)\n        {\n        case '1':\n        {\n            key = '!';\n            break;\n        }\n        case '2':\n        {\n            key = '@';\n            break;\n        }\n        case '3':\n        {\n            key = '#';\n            break;\n        }\n        case '4':\n        {\n            key = '$';\n            break;\n        }\n        case '5':\n        {\n            key = '%';\n            break;\n        }\n        case '6':\n        {\n            key = '^';\n            break;\n        }\n        case '7':\n        {\n            key = '&amp;';\n            break;\n        }\n        case '8':\n        {\n            key = '*';\n            break;\n        }\n        case '9':\n        {\n            key = '(';\n            break;\n        }\n        case '0':\n        {\n            key = ')';\n            break;\n        }\n\n        }\n\n        ToReturn += key;                                                        //on\n        return ToReturn;\n    }\n\n\n}\nelse\n{\n\n\n    switch (key)\n    {\n    case VK_OEM_1:\n    {\n        if ((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)\n            key = ';';                                                      //off\n        else\n            key = ':';\n        break;\n    }\n    case VK_OEM_PLUS:\n    {\n        if ((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)\n            key = '=';                                                      //off\n        else\n            key = '+';\n        break;\n    }\n    case VK_OEM_COMMA:\n    {\n        if ((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)\n            key = ',';                                                      //off\n        else\n            key = '&lt;';\n        break;\n    }\n    case VK_OEM_MINUS:\n    {\n        if ((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)\n            key = '-';                                                      //off\n        else\n            key = '_';\n        break;\n    }\n    case VK_OEM_PERIOD:\n    {\n        if ((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)\n            key = '.';                                                      //off\n        else\n            key = '&gt;';\n        break;\n    }\n    case VK_OEM_2:\n    {\n        if ((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)\n            key = '/';                                                      //off\n        else\n            key = '?';\n        break;\n    }\n    case VK_OEM_3:\n    {\n        if ((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)\n            key = '`';                                                      //off\n        else\n            key = '~';\n        break;\n    }\n    case VK_OEM_4:\n    {\n        if ((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)\n            key = '[';                                                      //off\n        else\n            key = '{';\n        break;\n    }\n    case VK_OEM_5:\n    {\n        if ((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)\n            key = '\\\\';                                                     //off\n        else\n            key = '|';\n        break;\n    }\n    case VK_OEM_6:\n    {\n        if ((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)\n            key = ']';                                                      //off\n        else\n            key = '}';\n        break;\n    }\n    case VK_OEM_7:\n    {\n        if ((GetKeyState(VK_SHIFT) &amp; 0x1000) == 0)\n            key = '\\'';                                                     //off\n        else\n            key = '\\\"';\n        break;\n    }\n\n    }\n\n\n\n    ToReturn += key;\n    return ToReturn;\n\n}\n\nToReturn += key;                                                    \nreturn ToReturn;\n}\n\nint main()\n{\n\nchar key;\n\nwhile(1) \n{ \n    for(key = 0; key &lt;= 256; key++) \n    { \n        if (GetAsyncKeyState(key) &amp; 0x0001)\n        { \n                cout &lt;&lt; WhichKey(key); \n        } \n\n    } \n\n} \n\n\nreturn 0;\n}\n</code></pre>\n\n<p>Thanks in advance and sorry for my English.</p>\n"}, {"tags": ["c++", "c++11", "raspberry-pi", "g++", "llvm-clang"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 2, "creation_date": 1499269434, "post_id": 44930645, "comment_id": 76837130, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14136833/stdput-time-implementation-status-in-gcc\">std::put_time implementation status in GCC?</a>"}, {"owner": {"reputation": 1917, "user_id": 2144408, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/110b99a60955d722d1b3fd9a0e7ff0e1?s=128&d=identicon&r=PG", "display_name": "TamaMcGlinn", "link": "https://stackoverflow.com/users/2144408/tamamcglinn"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1499270342, "post_id": 44930645, "comment_id": 76837748, "body": "Thank you Rakete; that explains why my g++ version 4.9.2 was not sufficient. The question may still be answered completely by specifying which compilers actually support the feature. In particular, I want to use clang, whose llvm page claims that the feature should be implemented as of Clang 3.3."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1499270402, "post_id": 44930645, "comment_id": 76837791, "body": "I guess, but I don&#39;t think that is on-topic. Anyways, are you sure that you are using LLVM&#39;s Standard Library instead of gcc&#39;s? Because you need a compiler flag for that in clang last time I checked."}, {"owner": {"reputation": 1917, "user_id": 2144408, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/110b99a60955d722d1b3fd9a0e7ff0e1?s=128&d=identicon&r=PG", "display_name": "TamaMcGlinn", "link": "https://stackoverflow.com/users/2144408/tamamcglinn"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1499271302, "post_id": 44930645, "comment_id": 76838357, "body": "Unsure; so you mean I should not try <code>clang++ -std=c++1z main.cc</code> but <code>clang++ -std=c++1z -stdlib=libstdc++ main.cc</code> or  <code>clang++ -std=c++1z -stdlib=libc++ main.cc</code>? I&#39;ve tried both; libc++ fails to find iostream, libstdc++ fails the same way as without passing any library option."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1499271446, "post_id": 44930645, "comment_id": 76838462, "body": "<code>-stdlib=libc++</code> is indeed the right option, not sure why it can&#39;t find <code>&lt;iostream&gt;</code> though..."}], "owner": {"reputation": 1917, "user_id": 2144408, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/110b99a60955d722d1b3fd9a0e7ff0e1?s=128&d=identicon&r=PG", "display_name": "TamaMcGlinn", "link": "https://stackoverflow.com/users/2144408/tamamcglinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2076, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1499270225, "creation_date": 1499269132, "last_edit_date": 1499270225, "question_id": 44930645, "link": "https://stackoverflow.com/questions/44930645/why-does-stdput-time-not-compile-using-multiple-compilers", "title": "Why does std::put_time not compile using multiple compilers?", "body": "<p><code>std::put_time</code> does not seem to work.</p>\n\n<p>The following snippet is taken <a href=\"http://en.cppreference.com/w/cpp/io/manip/put_time\" rel=\"nofollow noreferrer\">directly from en.cpp.reference.com</a>.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;ctime&gt;\n\nint main()\n{\n    std::time_t t = std::time(nullptr);\n    std::tm tm = *std::localtime(&amp;t);\n    std::cout.imbue(std::locale(\"ru_RU.utf8\"));\n    std::cout &lt;&lt; \"ru_RU: \" &lt;&lt; std::put_time(&amp;tm, \"%c %Z\") &lt;&lt; '\\n';\n    std::cout.imbue(std::locale(\"ja_JP.utf8\"));\n    std::cout &lt;&lt; \"ja_JP: \" &lt;&lt; std::put_time(&amp;tm, \"%c %Z\") &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>Several compilers agree that put_time is not a member of the std library. My question is; why? Does put_time work, and if so, with which compilers and options does the example compile successfully?</p>\n\n<p>clang++ 3.5.0-10 (based on LLVM 3.5.0) with -std=c++14 complains thus:</p>\n\n<pre><code>main.cc:10:36: error: no member named 'put_time' in namespace 'std'\n    std::cout &lt;&lt; \"ru_RU: \" &lt;&lt; std::put_time(&amp;tm, \"%c %Z\") &lt;&lt; '\\n';\n                              ~~~~~^\nmain.cc:12:36: error: no member named 'put_time' in namespace 'std'\n    std::cout &lt;&lt; \"ja_JP: \" &lt;&lt; std::put_time(&amp;tm, \"%c %Z\") &lt;&lt; '\\n';\n                              ~~~~~^\n2 errors generated.\n</code></pre>\n\n<p>Gcc added support for std::put_time in version 5.0, as stated here by <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=54354#c9\" rel=\"nofollow noreferrer\">Jonathan Wakely</a>.</p>\n\n<p>A <a href=\"http://www.cpp.sh/6ynft\" rel=\"nofollow noreferrer\">third \"compiler\" (using cpp.sh)</a> and ticking c++14, gives:</p>\n\n<pre><code> In function 'int main()':\n10:31: error: 'put_time' is not a member of 'std'\n12:31: error: 'put_time' is not a member of 'std'\n</code></pre>\n\n<p>I'm trying to compile this on a raspberry pi; full compiler version info:</p>\n\n<pre><code>pi@tacarmepi:~/test$ clang++ --version\nRaspbian clang version 3.5.0-10+rpi1 (tags/RELEASE_350/final) (based on LLVM 3.5.0)\nTarget: arm-unknown-linux-gnueabihf\nThread model: posix\n</code></pre>\n"}, {"tags": ["c++", "linux", "boost"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1499269297, "post_id": 44930454, "comment_id": 76837024, "body": "Hmm, something looks wrong. I have join, join_noexcept, and joinable (as well as do_try_join_* variants)"}, {"owner": {"reputation": 2106, "user_id": 2375105, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/iojsu.jpg?s=128&g=1", "display_name": "traveh", "link": "https://stackoverflow.com/users/2375105/traveh"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1499329324, "post_id": 44930454, "comment_id": 76862513, "body": "Thanks @AndyG I check several versions on another Ubuntu 14.04 machine but got the same results (updated above). Could you post the output of <code>nm --demangle &#47;usr&#47;local&#47;lib&#47;libboost_thread.so | grep join</code> in a response? It would help me alot."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1499341596, "post_id": 44930454, "comment_id": 76870893, "body": "I&#39;m not on a Ubuntu machine, and my initial comment was for a windows boost DLL. However, on my Linux box, I also have the same three functions you mention. Looking into it, the <code>boost::thread::join</code> is declared <code>inline</code>, so it is likely that the compiler used to build for Linux is able to <code>inline</code> the function effectively, but not the one for Windows."}], "owner": {"reputation": 2106, "user_id": 2375105, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/iojsu.jpg?s=128&g=1", "display_name": "traveh", "link": "https://stackoverflow.com/users/2375105/traveh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499329231, "creation_date": 1499268652, "last_edit_date": 1499329231, "question_id": 44930454, "link": "https://stackoverflow.com/questions/44930454/missing-functions-in-libboost-thread", "title": "Missing functions in libboost_thread?", "body": "<p>Continuing to try to solve my question <a href=\"https://stackoverflow.com/questions/44928719/undefined-reference-to-boostthread-functions-when-building-caffe\">here</a> I am trying to figure out where the <code>join</code>, <code>start_thread</code> and <code>~thread</code> are supposed to come from but I can't see they exist at all in the <code>libboost_thread</code> library (this is version 1.64.0 that I build and installed from the sources), for example, checking if the <code>join</code> function exists:</p>\n\n<pre><code>$ nm --demangle /usr/local/lib/libboost_thread.so | grep join\n             U pthread_join@@GLIBC_2.2.5\n0000000000011e00 T boost::thread::join_noexcept()\n0000000000011f90 T boost::thread::do_try_join_until_noexcept(timespec const&amp;, bool&amp;)\n0000000000010dc0 T boost::thread::joinable() const\n</code></pre>\n\n<p>I can see that there is an undefined symbol <code>pthread_join</code> but my understanding is that there's supposed to be a separate <code>join</code> function inside the <code>libboost_thread</code> library itself.</p>\n\n<p>I checked several different versions installed on another Ubuntu 14.04 machine of ours and got pretty much the same results:</p>\n\n<pre><code>$ nm --demangle /usr/local/boost-1.60.0/lib/libboost_thread.so | grep join\n                 U pthread_join@@GLIBC_2.2.5\n0000000000012070 T boost::thread::join_noexcept()\n0000000000012200 T boost::thread::do_try_join_until_noexcept(timespec const&amp;, bool&amp;)\n0000000000010ed0 T boost::thread::joinable() const\n$ nm --demangle /home/ubuntu/src/anaconda2/lib/libboost_thread.so.1.61.0 | grep join\n                 U pthread_join@@GLIBC_2.2.5\n0000000000014140 T boost::thread::join_noexcept()\n00000000000144e0 T boost::thread::do_try_join_until_noexcept(timespec const&amp;, bool&amp;)\n0000000000010870 T boost::thread::joinable() const\n$ nm --demangle /home/ubuntu/src/anaconda3/lib/libboost_thread.so.1.61.0 | grep join\n                 U pthread_join@@GLIBC_2.2.5\n0000000000014140 T boost::thread::join_noexcept()\n00000000000144e0 T boost::thread::do_try_join_until_noexcept(timespec const&amp;, bool&amp;)\n0000000000010870 T boost::thread::joinable() const\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "atomic", "lock-free"], "comments": [{"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1499270692, "post_id": 44930320, "comment_id": 76837988, "body": "This is a hard question; a lock-free tree is a research topic by itself"}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1499329185, "post_id": 44930320, "comment_id": 76862419, "body": "@LWimsey I have changed/simplified the question to avoid any complications arising from the tree."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1499330225, "post_id": 44930320, "comment_id": 76863062, "body": "<code>value = data[max=index];</code> should be <code>max = index;</code>, isn&#39;t it?"}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1499330696, "post_id": 44930320, "comment_id": 76863336, "body": "@Tsyvarev Not in the code originally posted: <code>value</code> must be updated too (since it&#39;s used in the previous line). I will edit the post to avoid that and make it a bit clearer."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502336212, "post_id": 44930320, "comment_id": 78167231, "body": "Your hand-rolled lock isn&#39;t safe: you usually need seq_cst while taking a lock, to prevent loads in the critical section from being visible before the store that actually takes the lock.  Remember that <code>acquire</code> only applies to the load part of the test-and-set, not the store.  On x86, it will compile to a <code>lock xchg</code> or <code>lock bts</code> or something, so you could only see the problem on an architecture where an atomic RMW with weaker than <code>seq_cst</code> can actually compile that way in the asm.  (This might not be the exact right reasoning, but I&#39;m pretty sure <code>acquire</code> is too weak.)"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502338787, "post_id": 44930320, "comment_id": 78167885, "body": "This might be a good use-case for Intel TSX (transactional memory): <a href=\"https://en.wikipedia.org/wiki/Transactional_Synchronization_Extensions\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Transactional_Synchronization_Extensio&zwnj;&#8203;ns</a>, if you&#39;re on x86 hardware that supports it.  Actually, IDK if that gains you much over just taking a lot, as long as most calls take the fast-path that doesn&#39;t involve any locking."}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502342234, "post_id": 44930320, "comment_id": 78168940, "body": "@PeterCordes With <code>test_and_set</code> being an indivisible atomic RMW, how can a load in the critical section be reordered with the store part without also being reordered with the load part (violating the acquire barrier) ?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1502343472, "post_id": 44930320, "comment_id": 78169416, "body": "@LWimsey: Consider the case where <code>test_and_set</code> is implemented on a CPU <a href=\"https://en.wikipedia.org/wiki/Load-link/store-conditional\" rel=\"nofollow noreferrer\">with LL/SC retry loop</a>, because it doesn&#39;t have a memory-destination atomic RMW instructions e.g. ARM.  If the load is an acquire-load, but the store is a relaxed store, stuff in the critical section can pass the store.  Even a release-store doesn&#39;t stop loads from escaping.  I know I read something about needing a stronger memory barrier when taking a lock, which made sense at the time, but I can&#39;t seem to find it now.  I think this was the argument."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1502344004, "post_id": 44930320, "comment_id": 78169608, "body": "@LWimsey: Without extra fencing, <a href=\"https://groups.google.com/d/msg/lock-free/2W6XE66KW-A/XSVzyd_xrCQJ\" rel=\"nofollow noreferrer\">LL/SC doesn&#39;t stop the load and store from reordering with other instructions</a>.  But it&#39;s still atomic for that location: any other observer observing or modifying <i>that location</i> will see it or now.  So it&#39;s kind of like a very limited memory transaction, rather than an atomic RMW."}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502345105, "post_id": 44930320, "comment_id": 78170038, "body": "@PeterCordes Interesting (thanks for the link), but your argument was that <code>test_and_set</code> has to be seq/cst.. That will add a release part to the store, which, I believe, still does not prevent the StoreLoad re-ordering you mentioned. It does not turn a store into a full barrier, only guarantees a single global order for these seq/cst operations"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1502345362, "post_id": 44930320, "comment_id": 78170140, "body": "@LWimsey: <code>mo_acq_rel</code> is still weaker than <code>mo_seq_cst</code>.  So yes, you do need <code>seq_cst</code> to stop loads escaping the critical section, which does require a full <code>mfence</code>-style barrier.  Your argument makes some sense, but I know that gcc on x86 inserts an <code>mfence</code> after a <code>seq_cst</code> store but not after a <code>release</code> store.  So <code>seq_cst</code> is stronger than what you&#39;re thinking of."}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502345614, "post_id": 44930320, "comment_id": 78170264, "body": "@PeterCordes Yes, but that is implementation.. a compiler could insert an <code>mfence</code> before each seq/cst load (inefficient but correct) and let a seq/cst store be a regular <code>mov</code>. Point being, seq/cst operations are only seq/cst with respect to each other. The only guarantee that applies to a single seq/cst store is that it has <code>release</code> semantics"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1502346701, "post_id": 44930320, "comment_id": 78170837, "body": "@LWimsey: Hrm, yes, you&#39;re right.  Even a seq_cst test_and_set doesn&#39;t used a memory-barrier instruction on ARM: <a href=\"https://godbolt.org/g/sqwtY6\" rel=\"nofollow noreferrer\">godbolt.org/g/sqwtY6</a>.  Really what&#39;s needed is an <code>atomic_thread_fence(mo_seq_cst)</code> after the <code>test_and_set</code>, because that will keep the critical section&#39;s loads from escaping.  (<a href=\"http://preshing.com/20131125/acquire-and-release-fences-dont-work-the-way-youd-expect/\" rel=\"nofollow noreferrer\">fences are stronger than regular operations tagged acq_rel</a>, and <a href=\"http://en.cppreference.com/w/cpp/atomic/memory_order#Sequentially-consistent_ordering\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/atomic/&hellip;</a> goes into a lot of detail about fencing.)"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502346791, "post_id": 44930320, "comment_id": 78170886, "body": "Also, turns out <code>atomic_flag</code> isn&#39;t just a bit inside a byte.  Since it always takes at least one whole byte to itself, gcc implements it with a single byte, and uses <code>xchg</code> for test-and-set, and just a simple release-store for <code>clear</code>."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1502346885, "post_id": 44930320, "comment_id": 78170945, "body": "@LWimsey: Anyway, thanks for clearing up my x86-centric thinking.  I had always thought of seq_cst as implying a full memory barrier on anything with a store or RMW, and hadn&#39;t realized it wasn&#39;t like that on LL/SC architectures.  That makes it suck to roll your own spinlock, since on x86 you end up with two fences: the <code>xchg</code> and the <code>mfence</code>.  Of course, it sucks a lot to roll your own spinlock for other reasons, too!  You lose out on stuff like OS-supported fallback, and on the <code>pause</code> instruction on x86 to reduce power and other benefits.  And spinning on an atomic exchange sucks, too."}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502347543, "post_id": 44930320, "comment_id": 78171343, "body": "@PeterCordes thank you too, I am glad I learned more about this LL/SC stuff"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1502366479, "post_id": 44930320, "comment_id": 78184528, "body": "@LWimsey: Apparently on ARM64, LL-acquire/SC-release is already enough to order a LDAR, unless gcc has a bug.  I put a <code>load(seq_cst)</code> after a <code>test_and_set(seq_cst)</code> and got the same asm as for a <code>load(acquire)</code> on ARM64(<a href=\"https://godbolt.org/g/QeBg8C\" rel=\"nofollow noreferrer\">godbolt.org/g/QeBg8C</a>).  On PowerPC 64 (notoriously weakly-ordered), there is an extra <code>sync</code> instruction before the plain <code>lwz</code> with <code>seq_cst</code>, but not with <code>acquire</code> (<a href=\"https://godbolt.org/g/2Kc7tK\" rel=\"nofollow noreferrer\">godbolt.org/g/2Kc7tK</a>).  I assume that orders it with respect to the <code>isync</code> after the byte LL/SC.  So one way to roll your own lock would be to use seq_cst loads inside the &quot;critical section&quot;."}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502426374, "post_id": 44930320, "comment_id": 78213395, "body": "@PeterCordes I&#39;ve given it more thought and I am not convinced an acquire barrier is too weak for the given scenario.. Maybe some day I&#39;ll post a new question."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1502573484, "post_id": 44930320, "comment_id": 78268375, "body": "Why not remove the tracking of <code>max</code> from the update function (at which point it becomes lock-free as long as atomic assignments to <code>data</code> are lock-free), and then simply calculate <code>max</code> on demand when required? With <code>N=8</code> this doesn&#39;t seem too bad even if requests for <code>max</code> are frequent."}], "answers": [{"comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502337164, "post_id": 45538662, "comment_id": 78167469, "body": "<code>atomic&lt;double&gt;</code> exists now.  <a href=\"https://stackoverflow.com/a/45086258/224132\">Compilers currently suck at it, but C++11 exposes pretty much everything that x86 supports</a>, except for TSX (transactional memory).  There is no hardware support for atomic <code>+=</code> or atomic <code>max()</code> on a <code>double</code> in memory, so you (or the compiler) have to do it with CAS (x86 <code>cmpxchg</code>, which is perfectly capable of operating on 64-bit <code>double</code> bit-patterns).  What do you think C++20 could do about anything?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502348294, "post_id": 45538662, "comment_id": 78171829, "body": "Good point about <code>max</code> being out-of-date instantly.  Storing the max value as well as the index might help.  Maybe in an 8B <code>atomic&lt;struct&gt;</code> of an <code>int32 index</code> and a <code>float val</code>, which you can load with a single atomic load.  Then you might be able to control which way the errors go.  (e.g. maybe you could arrange the order of updates so that <code>maxval</code> is always &lt;= the max value in the array.)  That might allow you to keep the fast-path through the function very light-weight, with no retry-loop needed when you&#39;re decreasing an index other than the current max."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502348512, "post_id": 45538662, "comment_id": 78171978, "body": "Hrm, then recheck the max after storing into the array?  No, that&#39;s no good, I don&#39;t think you can have the fast path that light weight (wait free, and not even an atomic RMW) without allowing for errors when another thread decreases max below the value you just stored."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502348828, "post_id": 45538662, "comment_id": 78172161, "body": "I think if you know different threads can&#39;t have the same <code>index</code>, you probably don&#39;t want a contiguous array anyway.  Having multiple threads writing to the same cache line causes false-sharing that you could avoid by having them each write to their own index.  Other threads reading a cache line you wrote is a lot less bad than them writing it, because it just has to become Shared, not Invalidated; you can get it back to Modified without having to reload it. (<a href=\"https://en.wikipedia.org/wiki/MESI_protocol\" rel=\"nofollow noreferrer\">MESI</a>)."}, {"owner": {"reputation": 3312, "user_id": 177923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0a9c082cd36b8148bf74a720e8e89c6?s=128&d=identicon&r=PG", "display_name": "tony", "link": "https://stackoverflow.com/users/177923/tony"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502515941, "post_id": 45538662, "comment_id": 78252564, "body": "If you had each thread maintain its own max, and then survey all threads when you need to read max, that might help (assuming you read less often than write)."}, {"owner": {"reputation": 3312, "user_id": 177923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0a9c082cd36b8148bf74a720e8e89c6?s=128&d=identicon&r=PG", "display_name": "tony", "link": "https://stackoverflow.com/users/177923/tony"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502516010, "post_id": 45538662, "comment_id": 78252575, "body": "@PeterCordes for atomic float, see <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0020r5.html\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0020r5.html</a>"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502517024, "post_id": 45538662, "comment_id": 78252757, "body": "Interesting.  I guess CPUs like ARM that use <a href=\"https://en.wikipedia.org/wiki/Load-link/store-conditional\" rel=\"nofollow noreferrer\">LL/SC</a> instructions for atomicity can support atomic <code>fetch_add</code> for float just as efficiently as integer, but C++11 doesn&#39;t give access to it.  The only thing new in that proposal is <code>fetch_add</code> and operator <code>+=</code>/<code>-=</code>.  C++11 already supports everything else, including <code>compare_exchange_weak</code>, for <code>atomic&lt;double&gt;</code>."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502517450, "post_id": 45538662, "comment_id": 78252848, "body": "Hmm, LL/SC would also make atomic multiply, divide and min/max possible (even for integer) with better performance than a CAS loop, but that proposal doesn&#39;t expose any of those.  C++11 basically ignores LL/SC because it&#39;s so low-level and with such platform-specific restrictions on what you can do between an LL and SC that it makes it hard to portably expose it. <a href=\"https://groups.google.com/a/isocpp.org/forum/#!topic/std-discussion/pUrS0aXX_uM\" rel=\"nofollow noreferrer\">groups.google.com/a/isocpp.org/forum/#!topic/std-discussion/&zwnj;&#8203;&hellip;</a>."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502572976, "post_id": 45538662, "comment_id": 78268270, "body": "@PeterCordes - why would LL/SC have better performance than a CAS loop for those ops (unless the underlying LL/SC operation is somehow faster than CAS)? Implementing all of those things with LL/SC follows exactly the same pattern as CAS - read, calculate updated value, and &quot;store&quot;, with the &quot;store&quot; possibly failing in either implementation. The only intrinsic advantage algorithmic LL/SC has, AFAIK, is in detection of intervening writes which makes ABA detection automatic. Of course, you might mean that LL/SC is faster at the hardware level..."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1502580983, "post_id": 45538662, "comment_id": 78269843, "body": "@BeeOnRope: I was thinking that HW support for LL/SC might lock the cache line on LL, so the SC was more likely to succeed.  Or delay the LL until the line was in E state.  Anyway, basically provide hardware arbitration to allow <code>N</code> LL/SC operations on different cores to complete with not much more than <code>N</code> attempts, like x86 HW does for <code>lock add [mem], 1</code>.  Far better than the worst-case behaviour with many cores hammering away with load/stuff-in-registers/CAS/retry.  If the CAS is implemented with LL/SC, then on dumb hardware you only save the initial load, but smart HW can do much better."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1502581967, "post_id": 45538662, "comment_id": 78269972, "body": "@BeeOnRope: With no hardware arbitration, and too many threads in LL/SC loops on the same shared memory address, you could get a livelock situation: the SC always fails on every CPU because it lets the line be invalidated between the LL and SC.  I tried to google some to find out if real hardware does hardware arbitration for LL/SC, but wasn&#39;t able to find anything practical with those search terms."}, {"owner": {"reputation": 3312, "user_id": 177923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0a9c082cd36b8148bf74a720e8e89c6?s=128&d=identicon&r=PG", "display_name": "tony", "link": "https://stackoverflow.com/users/177923/tony"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502608913, "post_id": 45538662, "comment_id": 78274039, "body": "@PeterCordes I was thinking atomic floats were more restricted (or not atomic) - I guess I was wrong. (I&#39;ve never had an occasion that needed them.)  I&#39;ve removed that part of my answer."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502609099, "post_id": 45538662, "comment_id": 78274084, "body": "@tony: I&#39;ve never used atomic floats either.  I don&#39;t recommend it when you can cheaply avoid it, since compilers aren&#39;t good at them.  It was interesting to see what happens when you throw some <code>atomic&lt;double&gt;</code> code at them, like I did in the answer I linked."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502649986, "post_id": 45538662, "comment_id": 78285129, "body": "@PeterCordes - ah, right, you are saying that it can work better at the hardware level. It certainly could be the case. A directly apples to apples comparison on real hardware is tough because platforms tend to have one or the other, not both, and then each platforms capabilities are usually quite different, and may have different memory models etc. For example, CAS may perform better on x86 than LL/SC on platform X simply because it has more has had more hardware and engineering resources poured into it."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 1, "creation_date": 1502650115, "post_id": 45538662, "comment_id": 78285174, "body": "You point out an issue with CAS though - that the initial <code>load</code> is usually a plain one, so you waste time first getting the line in S state (usually) and then almost immediately after trying to get it in M state when the <code>cmpxchg</code> comes through, probably increasing the window for the line to be stolen and generally increasing cache and coherency traffic. I wonder if blind-writing to an adjacent, unused, position on the same line first, to get the line in M initially, would actually be an optimization in some cases. LL/SC doesn&#39;t have this issue since the LL is already special."}], "tags": [], "owner": {"reputation": 3312, "user_id": 177923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0a9c082cd36b8148bf74a720e8e89c6?s=128&d=identicon&r=PG", "display_name": "tony", "link": "https://stackoverflow.com/users/177923/tony"}, "is_accepted": false, "score": 1, "last_activity_date": 1502608757, "last_edit_date": 1502608757, "creation_date": 1502073414, "answer_id": 45538662, "question_id": 44930320, "link": "https://stackoverflow.com/questions/44930320/how-to-lock-free-update-index-to-maximum-over-a-range/45538662#45538662", "title": "How to lock-free update index to maximum over a range?", "body": "<p>So, IIUC, the array only gets new values if they are lower than what is already there (and I won't worry about how the initial values got there), and if the current max is lowered, find a new max.</p>\n\n<p>Some of this is not too hard.\nBut some is... harder.</p>\n\n<p>So the \"if value &lt; data[index] then write data\" needs to be in a CAS-loop. Something like:</p>\n\n<pre><code>auto oldval = data[index].load(memory_order_relaxed);\ndo\n   if (value &lt;= oldval) return;\nwhile ( ! data[index].compare_exchange_weak(oldval, value) );\n// (note that oldval is updated to data[index] each time comp-exch fails)\n</code></pre>\n\n<p>So now data[index] has the new lower value. Awesome. And relatively easy.\nNow about max.</p>\n\n<p>First question - Is it OK for max to ever be wrong? Because it may currently be wrong (in our scenario, where we update data[index] before handling max).</p>\n\n<p>Can it be wrong in some ways, not others? ie let's say our data is just two entries:</p>\n\n<pre><code>data[2] = { 3, 7 };\n</code></pre>\n\n<p>And we want to do <code>update(1, 2)</code> ie change the <code>7</code> to a <code>2</code>. (And thus update max!)</p>\n\n<p>Scenario A: set data first, then max:</p>\n\n<pre><code>data[1] = 2;\npause(); // ie scheduler pauses this thread\nmax = 0; // data[0]==3 is now max\n</code></pre>\n\n<p>If another thread comes in at <code>pause()</code>, then <code>data[max]</code> is wrong: <code>2</code> instead of <code>3</code> :-(</p>\n\n<p>Scenario B: set max first:</p>\n\n<pre><code>max = 0; // it will be \"shortly\"?\npause();\ndata[1] = 2;\n</code></pre>\n\n<p>Now a thread could read data[max] as 3 <em>while 7 is still in data</em>.  But 7 is going to become 2 \"soon\", so is that OK? Is it \"less wrong\" than scenario A?  Depends on usage?  (ie if the important thing is \"which is max\" we have that right. But if max was the only important thing, why store all the data at all?)</p>\n\n<p>It seems odd to ask \"is wrong OK\", but in some lock-free situations it actually is a valid question.  To me B has a chance to be OK for some uses, whereas A doesn't.</p>\n\n<p>Also, and this is important:</p>\n\n<p><strong>data[max] is always wrong, even in the perfect algorithm</strong></p>\n\n<p>By this I mean you need to realize that data[max], <em>as soon as you read it</em> is already out of date - if you are living in a lockfree world.  Because it may have changed as soon as you read it. (Also because data and max change independently.  But even if you had a function getMaxValue() it would be out of date as soon as it returns.) </p>\n\n<p>Is that OK?  Because, if not, you obviously need a lock.  But if it is OK, we can use it to our advantage - we might be able to return an answer which we know is somewhat incorrect / out-of-date, but no more incorrect than what you could tell from the outside.</p>\n\n<p>If neither scenario is OK, then you <em>must</em> update max and data[index] at the same time.  Which is hard since they don't fit into a lock-free sized chunk.</p>\n\n<p>So instead you can add a layer of indirection:</p>\n\n<pre><code>struct DataAndMax { double data[N]; int max; };\nDataAndMax * ptr;\n</code></pre>\n\n<p>Whenever you need to update max, you need to make a whole new DataAndMax struct (ie allocate a new one), somehow fill it all out nicely, and then atomically swap ptr to the new struct.\nAnd if some other thread changed ptr while you were preparing the new data, then you would need to start over, since you need their new data in your data.</p>\n\n<p>And if ptr has changed twice, then it may <em>look</em> like it hasn't changed, when it really has:  Let's say ptr currently has value <code>0xA000</code> and a 2nd thread allocates a new DataAndStruct at <code>0xB000</code>, and sets ptr to <code>0xB000</code>, and frees the old one at <code>0xA000</code>.  Now yet another thread (3rd) comes in, allocates yet another DataAndStruct - and low and behold the allocator gives you back <code>0xA000</code> (why not, it was just freed!). So this 3rd thread sets ptr to <code>0xA000</code>.</p>\n\n<p>And this all happens while you are trying to set ptr to <code>0xC000</code>.  All you see is that ptr <em>was</em> <code>0xA000</code>, and later still <em>is</em> <code>0xA000</code>, so you think it (and its data) hasn't changed.  Yet it has - it went from <code>0xA000</code> to <code>0xB000</code> (when you weren't looking) back to <code>0xA000</code> - the address is the same, but the data is different.  This is called the ABA problem.</p>\n\n<p>Now, if you knew the max number of threads, you could pre-allocate:</p>\n\n<pre><code>DataAndMax dataBufs[NUM_THREADS];\nDataAndMax * ptr; // current DataAndMax\n</code></pre>\n\n<p>And then never allocate/delete and never have ABA problems.  Or there's other ways to avoid ABA.</p>\n\n<p>Let's go back, and think about how we are going to - no matter what - return a max value that is potentially out of date.  Can we use that?</p>\n\n<p>So you come in, and first check if the index you are about to write to is the important one or not:</p>\n\n<pre><code>if (index != max) {\n    // we are not touching max,\n    // so nothing fancy here!\n    data[index] value;\n    return;\n}\n// else do it the hard way:\n//...\n</code></pre>\n\n<p><em>But this is already wrong.</em>  After the if and before the set, max may have changed.  Does <em>every</em> set need to update max!?!?</p>\n\n<p>So, if N is small, you could just linear <em>search</em> for max.  It may be wrong if someone makes an update while searching, but remember - it could also be wrong if someone makes an update <em>right after</em> searching or right after \"insert magic here\".  So searching, other than possibly being slow, is as correct as any algorithm.  You will find something that was, for a moment, max.\nIf N == 8, I would use searching.  Definitely.\nYou can search 8 entries using <code>memory_order_relaxed</code> possibly, and that will be faster than trying to maintain anything using stronger atomic ops.</p>\n\n<p>I have other ideas:</p>\n\n<p>More bookkeeping?  Store maxValue separately?</p>\n\n<pre><code>double data[N];\ndouble maxValue;\nint indexOfMax;\n\n\nbool wasMax = false;\nif (index == indexOfMax)\n    wasMax = true;\ndata[index] = value; \nif (wasMax || index == indexOfMax)\n    findMax(&amp;indexOfMax, &amp;maxValue); // linear search\n</code></pre>\n\n<p>That would probably need a CAS-loop somewhere.  Still linear search, but maybe less often?</p>\n\n<p>Maybe you need extra data at each entry? Not sure yet.</p>\n\n<p>Hmmmm.</p>\n\n<p>This is not simple.  Thus if there is a correct algorithm (and I <em>think</em> there is, within some constraints) it is unlikely to not have bugs.  ie a correct algorithm might actually exist, but you don't find it - what you instead find is an algorithm that just looks correct.</p>\n"}], "owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1502608757, "creation_date": 1499268297, "last_edit_date": 1499330873, "question_id": 44930320, "link": "https://stackoverflow.com/questions/44930320/how-to-lock-free-update-index-to-maximum-over-a-range", "title": "How to lock-free update index to maximum over a range?", "body": "<p>The problem is best explained with some simple code.</p>\n\n<pre><code>struct foo\n{\n    static constexpr auto N=8;\n    double data[N];            //  initialised at construction\n    int max;                   //  index to maximum: data[max] is largest value\n\n    // if value &lt; data[index]:\n    //   \u2013 update data[index] = value\n    //   - update max\n    void update(int index, double value)\n    {\n        if(value &gt;= data[index])\n            return;\n        data[index] = value;\n        if(index==max)         // max unaffected if index!=max\n            for(index=0; index!=N; ++index)\n                if(data[index] &gt; data[max])\n                    max = index;\n    }\n};\n</code></pre>\n\n<p>Now, I want to make <code>foo::update()</code> thread safe, i.e. allow concurrent calls from different threads, where participating threads cannot call with the same <code>index</code>. One way is to add a mutex or simple spinlock (the contention can be presumed low) to <code>foo</code>:</p>\n\n<pre><code>struct foo\n{\n    static constexpr auto N=8;\n    std::atomic_flag lock = ATOMIC_FLAG_INIT;\n    double data[N];\n    int max;\n\n    // index is unique to each thread\n    // if value &lt; data[index]:\n    //   \u2013 update data[index] = value\n    //   - update max\n    void update(int index, double value)\n    {\n        if(value &gt;= data[index])\n            return;\n        while(lock.test_and_set(std::memory_order_acquire));  // aquire spinlock\n          data[index] = value;\n          if(index==max)\n              for(index=0; index!=N; ++index)\n                  if(data[index] &gt; data[max])\n                      max = index;\n        lock.clear(std::memory_order_release);                // release spinlock\n    }\n};\n</code></pre>\n\n<p>However, how can I implement <code>foo::update()</code> <em>lock-free</em> (you may consider <code>data</code> and <code>max</code> to be <code>atomic</code>)?</p>\n\n<hr>\n\n<p>NOTE: this is a simpler version of the original post, without relation to the tree structure.</p>\n"}, {"tags": ["c++", "networking", "boost-asio", "wireshark"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1499268970, "post_id": 44930288, "comment_id": 76836787, "body": "<i>&quot;How is it possible&quot;</i>: packets can be (will be) buffered on the physical card, if the card runs out of buffer space because packets are not being processed fast enough then they will be discarded.  Differences in applications will mean that different packets get missed."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 5, "creation_date": 1499271486, "post_id": 44930288, "comment_id": 76838487, "body": "UDP is unreliable. You have to layer something on top of it to deal with lost packets etc"}, {"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1499275613, "post_id": 44930288, "comment_id": 76840863, "body": "Also, why <code>std::filebuf</code>? It&#39;s not intended to be used that way. Just <code>std::ofstream</code> (possibly turn off <code>stdio</code> sync)."}, {"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 2, "creation_date": 1499277471, "post_id": 44930288, "comment_id": 76841856, "body": "UDP is specifically a connectionless, unreliable, fire-and-forget protocol. You <i>will</i> lose some UDP datagrams, and by using UDP, you accept that fact. You either need to deal with data loss, or you need to use a reliable protocol."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1499277715, "post_id": 44930288, "comment_id": 76842022, "body": "Your code is completely unoptimized. For example, do you really need to call <code>bind</code> once per packet received? Do you need to call <code>sputn</code> after each packet? Do you need to wait for <code>sputn</code> to return before calling <code>async_receive_from</code>? Optimizing it will help. But no matter what you do, you will sometimes drop packets, duplicate packets, or receive packets out of order. If you can&#39;t handle that, don&#39;t use UDP."}, {"owner": {"reputation": 360, "user_id": 4401939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-b94_1fOqBjY/AAAAAAAAAAI/AAAAAAAAAEw/h7UwjP_UJrw/photo.jpg?sz=128", "display_name": "poukill", "link": "https://stackoverflow.com/users/4401939/poukill"}, "reply_to_user": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1499332426, "post_id": 44930288, "comment_id": 76864506, "body": "@black : <code>std::filebuf</code>because it is the fastest I have ever tried in my benchmarks a few years ago. I compared <code>std::ofstream</code> in text and binary mode and <code>std::filebuf</code> was really the fastest of all by a large margin. Anyway, in my real code, I use another processing code that does something else, I am not writing to a binary file. That&#39;s just for debugging here."}], "answers": [{"comments": [{"owner": {"reputation": 360, "user_id": 4401939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-b94_1fOqBjY/AAAAAAAAAAI/AAAAAAAAAEw/h7UwjP_UJrw/photo.jpg?sz=128", "display_name": "poukill", "link": "https://stackoverflow.com/users/4401939/poukill"}, "edited": false, "score": 0, "creation_date": 1499332777, "post_id": 44930865, "comment_id": 76864741, "body": "1400 bytes per packets, so below the MTU size. It gives about 5MB/s, but at a very high frequency. Without any buffering on my application, it is quite demanding I suppose."}], "tags": [], "owner": {"reputation": 88, "user_id": 7639721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bHxm2.png?s=128&g=1", "display_name": "He Ming", "link": "https://stackoverflow.com/users/7639721/he-ming"}, "is_accepted": false, "score": 1, "last_activity_date": 1499269806, "creation_date": 1499269806, "answer_id": 44930865, "question_id": 44930288, "link": "https://stackoverflow.com/questions/44930288/receiving-udp-packets-at-high-frequency-packet-loss/44930865#44930865", "title": "Receiving UDP packets at high frequency : packet loss?", "body": "<p>How much bytes in a packet? You make a buffer as 64K, let the size be 32K. Then <code>3.5k * 32k</code> means 112MB/s, I don't think a gigabit network afford it. And, you write packets to a file, the <code>sputn</code> may block you from receiving more packets, consequently the buffer of the driver overflowed, packets discarded.</p>\n"}, {"comments": [{"owner": {"reputation": 360, "user_id": 4401939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-b94_1fOqBjY/AAAAAAAAAAI/AAAAAAAAAEw/h7UwjP_UJrw/photo.jpg?sz=128", "display_name": "poukill", "link": "https://stackoverflow.com/users/4401939/poukill"}, "edited": false, "score": 0, "creation_date": 1499334061, "post_id": 44931155, "comment_id": 76865641, "body": "Is there any risk to increase the size of the receiving socket&#39;s buffer? For example, <code>m_udp_socket.set_option(boost::asio::socket_base::receive_bu&zwnj;&#8203;ffer_size(1000000))</code> will set a 1MB buffer. Can this only be good or is there any downsides ?"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "reply_to_user": {"reputation": 360, "user_id": 4401939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-b94_1fOqBjY/AAAAAAAAAAI/AAAAAAAAAEw/h7UwjP_UJrw/photo.jpg?sz=128", "display_name": "poukill", "link": "https://stackoverflow.com/users/4401939/poukill"}, "edited": false, "score": 0, "creation_date": 1499350429, "post_id": 44931155, "comment_id": 76877923, "body": "The only downside AFAIK is that it will use up more RAM (per socket) than it would otherwise.  Whether that&#39;s a significant problem or not will depend on how many big-buffered sockets you want to have open at once, and how much spare RAM is available on your machine :)"}], "tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": true, "score": 4, "last_activity_date": 1499270710, "creation_date": 1499270710, "answer_id": 44931155, "question_id": 44930288, "link": "https://stackoverflow.com/questions/44930288/receiving-udp-packets-at-high-frequency-packet-loss/44931155#44931155", "title": "Receiving UDP packets at high frequency : packet loss?", "body": "<blockquote>\n  <p>Is this possible that WireShark get a packet and that my application\n  does not ?</p>\n</blockquote>\n\n<p>Yes.  In particular, each socket has its own fixed-size incoming-data buffer, and if, at the moment the kernel tries to add the new incoming packet to that buffer, the buffer doesn't have enough available space to hold that packet, then the packet will not be added to the buffer, and so the application reading incoming data from that socket will not receive it.</p>\n\n<p>Given that, it's entirely possible that WireShark's buffer had room to accept the incoming packet, but your own app's buffer did not.</p>\n"}, {"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1499329944, "post_id": 44932389, "comment_id": 76862905, "body": "even in that case, you&#39;ll lose packets... later, but you&#39;ll lose them. Packets are lost as a side effect of the buffer filing process.  The buffer is there to absorb the fluctuations of packet cadence, but not a steady flux of packets that fills a buffer.  And this doesn&#39;t take into account noise errors at the wire level, or other means. Enlarging the buffer size is not the solution here."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1499390667, "post_id": 44932389, "comment_id": 76897675, "body": "@LuisColorado It is part of the solution. The other two parts are to make the reading process as fast as possible, by buffering the writing to the file, which I also mentioned, and to accept that there will always be some packet loss."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1499420673, "post_id": 44932389, "comment_id": 76910080, "body": "That&#39;s not part of the solution anyway.... enlarging the buffer size is a delaying the problem to see if it vanishes (or burying the head in ground to avoid fear) or not.  Read some queue theory and you&#39;ll get to this.  If the amount of data incoming is larger than the rate at which you can process it, the mean size of the queue will grow without limit (it&#39;s an unbounded linear operator, believe me or not)"}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 1, "last_activity_date": 1499275094, "creation_date": 1499275094, "answer_id": 44932389, "question_id": 44930288, "link": "https://stackoverflow.com/questions/44930288/receiving-udp-packets-at-high-frequency-packet-loss/44932389#44932389", "title": "Receiving UDP packets at high frequency : packet loss?", "body": "<p>In a word, yes.</p>\n\n<p>If you want to <em>fix</em> or <em>improve</em> this, rather than just ask about it, use a <em>much</em> bigger socket receive buffer than the default, as big as the platform will allow, and make sure your writes to the file are also buffered, with as large a buffer as you can afford given whatever your requirements are about data loss on crash.</p>\n"}], "owner": {"reputation": 360, "user_id": 4401939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-b94_1fOqBjY/AAAAAAAAAAI/AAAAAAAAAEw/h7UwjP_UJrw/photo.jpg?sz=128", "display_name": "poukill", "link": "https://stackoverflow.com/users/4401939/poukill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1752, "favorite_count": 0, "accepted_answer_id": 44931155, "answer_count": 3, "score": 3, "last_activity_date": 1499373122, "creation_date": 1499268207, "last_edit_date": 1499373122, "question_id": 44930288, "link": "https://stackoverflow.com/questions/44930288/receiving-udp-packets-at-high-frequency-packet-loss", "title": "Receiving UDP packets at high frequency : packet loss?", "body": "<p>I have a C++ application which uses a UDP Server (using Boost.Asio) that receives packets from a gigabit local network device at a high frequency (3500 packets per second). Some users report a few packet losses. So in the end I chose to run in parallel WireShark and my application to check if there are any packets that WireShark is able to receive but not my application.</p>\n\n<p>What I found is that WireShark does not receive every packet, it seems that it misses some. My application misses also a few more frames that Wireshark received correctly.</p>\n\n<p><strong>My questions</strong> : Is it possible WireShark gets packets that my application does not ? I thought maybe WireShark has low-level access to the IP stack and packets are discarded by the OS even if they are shown in WireShark ?\nIs it possible that the operation in (1) takes too much time such that the next <code>async_receive_from</code> is called too late?\nI would like to have opinions on this subject. Thanks.</p>\n\n<p>Here is the code I use (quite basic). udp_server.h :</p>\n\n<pre><code>#pragma once\n\n#include &lt;boost/asio.hpp&gt;\n#include &lt;boost/bind.hpp&gt;\n#include &lt;fstream&gt;\n\nconst int MAX_BUFFER_SIZE = 65537;\n\nusing boost::asio::ip::udp;\n\nclass UDPServer\n{\npublic:\n    UDPServer(boost::asio::io_service&amp; ios, udp::endpoint endpoint)\n        :m_io_service(ios),\n        m_udp_socket(m_io_service, endpoint)\n    {\n        // Resize the buffer to max size in the component property\n        m_recv_buffer.resize(MAX_BUFFER_SIZE);\n\n        m_output_file.open(\"out.bin\", std::ios::out | std::ios::binary);\n\n        StartReceive();\n    }\n\npublic:\n    void StartReceive()\n    {\n        m_udp_socket.async_receive_from(\n            boost::asio::buffer(m_recv_buffer), m_remote_endpoint,\n            boost::bind(&amp;UDPServer::HandleReceive, this,\n            boost::asio::placeholders::error,\n            boost::asio::placeholders::bytes_transferred));\n    }\n\nprivate:\n    void HandleReceive(const boost::system::error_code&amp; error, std::size_t bytes_transferred)\n    {\n        if (!error || error == boost::asio::error::message_size)\n        {\n            // Write to output -- (1)\n            m_output_file.sputn(&amp;m_recv_buffer[0], bytes_transferred);\n\n            // Start to receive again\n            StartReceive();\n        }\n    }\n\n    boost::asio::io_service&amp;    m_io_service;\n    udp::socket                 m_udp_socket;\n    udp::endpoint               m_remote_endpoint;\n    std::vector&lt;char&gt;           m_recv_buffer;\n    std::filebuf                m_output_file;\n};\n</code></pre>\n\n<p>main.cpp:</p>\n\n<pre><code>include &lt;boost/asio.hpp&gt;\n#include \"udp_server.h\"\n\nconst unsigned short PORT_NUMBER = 44444;\n\nint main()\n{\n    boost::asio::io_service ios;\n    boost::asio::ip::udp::endpoint endpoint(udp::endpoint(udp::v4(), PORT_NUMBER));\n    UDPServer server(ios, endpoint);\n    ios.run();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "lua", "scripting"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 3, "creation_date": 1499268161, "post_id": 44930244, "comment_id": 76836207, "body": "&quot;<i>Using <code>require</code> is apparently not supported when not using lua standalone.</i>&quot; Nonsense. There&#39;s nothing about <code>require</code> that needs the Lua executable."}, {"owner": {"reputation": 85, "user_id": 6204021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ad91e0e7caa4cbc49edd4b5dfdc23709?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6204021/max"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1499268357, "post_id": 44930244, "comment_id": 76836356, "body": "@NicolBolas I completely believe you, however using a <code>require</code> causes my script to not run at all, which is why I had that thought."}, {"owner": {"reputation": 85, "user_id": 6204021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ad91e0e7caa4cbc49edd4b5dfdc23709?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6204021/max"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1499268864, "post_id": 44930244, "comment_id": 76836704, "body": "Actually running the script on the command line with <code>lua code.lua</code> using <code>require</code> works and I can access the variable in the other file, but not when running the script from inside the C++ program. I have no idea why."}, {"owner": {"reputation": 3790, "user_id": 805875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbd9ac04d56f955c822cb28b5ab72fda?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/805875/nobody"}, "edited": false, "score": 1, "creation_date": 1499290216, "post_id": 44930244, "comment_id": 76848852, "body": "Are you actually loading the stdlib? (<code>#include &lt;lualib.h&gt;</code> , <a href=\"https://www.lua.org/manual/5.3/manual.html#luaL_openlibs\" rel=\"nofollow noreferrer\"><code>luaL_openlibs</code></a><code>( L )</code>) If you don&#39;t there&#39;s no <code>require</code>, which would explain why it doesn&#39;t work."}, {"owner": {"reputation": 85, "user_id": 6204021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ad91e0e7caa4cbc49edd4b5dfdc23709?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6204021/max"}, "reply_to_user": {"reputation": 3790, "user_id": 805875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbd9ac04d56f955c822cb28b5ab72fda?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/805875/nobody"}, "edited": false, "score": 0, "creation_date": 1499324847, "post_id": 44930244, "comment_id": 76859648, "body": "@nobody yes, unfortunately that&#39;s not the problem."}, {"owner": {"reputation": 3790, "user_id": 805875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbd9ac04d56f955c822cb28b5ab72fda?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/805875/nobody"}, "edited": false, "score": 0, "creation_date": 1499358399, "post_id": 44930244, "comment_id": 76883932, "body": "Try adding a <a href=\"https://stackoverflow.com/help/mcve\">MWE</a> to your question if you still want this solved. At present, there&#39;s not enough information to do anything but guess."}, {"owner": {"reputation": 85, "user_id": 6204021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ad91e0e7caa4cbc49edd4b5dfdc23709?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6204021/max"}, "edited": false, "score": 0, "creation_date": 1499459127, "post_id": 44930244, "comment_id": 76933514, "body": "I have solved my issue by running the second script with <code>lua_dofile</code> beforehand, this make all variables, tables and functions available to every other lua script in my program."}], "owner": {"reputation": 85, "user_id": 6204021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ad91e0e7caa4cbc49edd4b5dfdc23709?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6204021/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499268066, "creation_date": 1499268066, "question_id": 44930244, "link": "https://stackoverflow.com/questions/44930244/accessing-variables-from-different-scripts-in-a-lua-state", "title": "Accessing variables from different scripts in a lua_State", "body": "<p>I have the following problem:\nI am building a small (a toy really) game platform using C++ and lua (and well, SDL too).\nI can't seem to find out how to use variables inside a lua script that are defined in another lua script in the same working directory.\nI tried loading all scripts into a single lua_State, but that did not work.\nFor example:</p>\n\n<p>I have a file <code>code.lua</code> and another one <code>player.lua</code> (something like a class containing variables and functions for a player character). I run the file <code>code.lua</code> inside my C++ program (using <code>luaL_dofile</code>) but I also need that file to be able to access variables in <code>player.lua</code> and modify them too.</p>\n\n<p>Using <code>require</code> is apparently not supported when not using lua standalone. \nI am using Lua 5.3, so I guess <code>module()</code> doesn't work either. (I am very new to lua, excuse me if all of this is in fact trivial or just not the right way of doing things). Thanks for any help!</p>\n"}, {"tags": ["c++", "c++11", "boost", "lambda"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1499268289, "post_id": 44930191, "comment_id": 76836306, "body": "What do you think boost::lambda::_1 is doing there?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1499268472, "post_id": 44930191, "comment_id": 76836433, "body": "Question: why use Boost.Lambda when you have C++11?"}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1499281562, "post_id": 44930191, "comment_id": 76844126, "body": "If you want to call a function, then it seems you should use a <a href=\"http://www.boost.org/doc/libs/1_64_0/doc/html/lambda/le_in_details.html#lambda.bind_expressions\" rel=\"nofollow noreferrer\">bind expression</a>."}], "answers": [{"comments": [{"owner": {"reputation": 584, "user_id": 2950563, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/FQ8IX.gif?s=128&g=1", "display_name": "J&#233;r&#233;mi Panneton", "link": "https://stackoverflow.com/users/2950563/j%c3%a9r%c3%a9mi-panneton"}, "edited": false, "score": 0, "creation_date": 1499269428, "post_id": 44930421, "comment_id": 76837124, "body": "Range-based for loop would have been simpler for this use case."}, {"owner": {"reputation": 16382, "user_id": 5507349, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IaCUb.jpg?s=128&g=1", "display_name": "Edgar Rokj\u0101n", "link": "https://stackoverflow.com/users/5507349/edgar-rokj%c4%81n"}, "edited": false, "score": 1, "creation_date": 1499269637, "post_id": 44930421, "comment_id": 76837269, "body": "It does not answer OP&#39;s question."}, {"owner": {"reputation": 584, "user_id": 2950563, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/FQ8IX.gif?s=128&g=1", "display_name": "J&#233;r&#233;mi Panneton", "link": "https://stackoverflow.com/users/2950563/j%c3%a9r%c3%a9mi-panneton"}, "edited": false, "score": 0, "creation_date": 1499272573, "post_id": 44930421, "comment_id": 76839150, "body": "Indeed, but the OP also tagged the question C++11. Which is quite confusing since boost::lambda was meant to replicate the now standardized feature."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "is_accepted": false, "score": 2, "last_activity_date": 1499268551, "creation_date": 1499268551, "answer_id": 44930421, "question_id": 44930191, "link": "https://stackoverflow.com/questions/44930191/how-can-i-stdsqrtboostlambdaplaceholder1-type/44930421#44930421", "title": "How can I std::sqrt(boost::lambda::placeholder1_type)?", "body": "<p>Do it the C++11 way:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n#include &lt;array&gt;\n#include &lt;algorithm&gt;\n\nint main() {\n\n  std::array&lt;double, 6&gt; a = {1, 4, 9, 16, 25, 36};\n\n  std::for_each(a.begin(), a.end(),\n      [] (const auto&amp;v ) { std::cout &lt;&lt; sqrt(v) * 5.0 &lt;&lt; \" \"; }\n  );\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "is_accepted": true, "score": 1, "last_activity_date": 1499284239, "last_edit_date": 1499284239, "creation_date": 1499283733, "answer_id": 44934709, "question_id": 44930191, "link": "https://stackoverflow.com/questions/44930191/how-can-i-stdsqrtboostlambdaplaceholder1-type/44934709#44934709", "title": "How can I std::sqrt(boost::lambda::placeholder1_type)?", "body": "<p>You need to delay the call of <code>sqrt</code>. To achieve this, you should use a\n<a href=\"http://www.boost.org/doc/libs/1_64_0/doc/html/lambda/le_in_details.html#lambda.bind_expressions\" rel=\"nofollow noreferrer\">bind expression</a>.</p>\n\n<p>NB: You need to use a cast to select the correct <code>sqrt</code> overload.</p>\n\n<pre><code>#include &lt;boost/lambda/lambda.hpp&gt;\n#include &lt;boost/lambda/bind.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n\nint main()\n{\n    std::array&lt;double, 6&gt; a = {1, 4, 9, 16, 25, 36};\n\n    std::for_each(a.begin(), a.end(),\n        std::cout &lt;&lt; boost::lambda::bind(static_cast&lt;double(*)(double)&gt;(std::sqrt), boost::lambda::_1) &lt;&lt; \" \"\n    );\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 2 3 4 5 6 \n</code></pre>\n\n<p><kbd><a href=\"http://coliru.stacked-crooked.com/a/2c86e6c579d23cc1\" rel=\"nofollow noreferrer\">Live Sample</a></kbd></p>\n"}, {"tags": [], "owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "is_accepted": false, "score": 0, "last_activity_date": 1499284124, "creation_date": 1499284124, "answer_id": 44934810, "question_id": 44930191, "link": "https://stackoverflow.com/questions/44930191/how-can-i-stdsqrtboostlambdaplaceholder1-type/44934810#44934810", "title": "How can I std::sqrt(boost::lambda::placeholder1_type)?", "body": "<p>Ah, the good old days of Boost.Lambda</p>\n\n<pre><code>int main() {\n\n    std::array&lt;double, 6&gt; a = {1, 4, 9, 16, 25, 36};\n\n    std::for_each(a.begin(), a.end(),\n        std::cout &lt;&lt; boost::lambda::bind(static_cast&lt;double(*)(double)&gt;(std::sqrt), boost::lambda::_1 * 5.0) &lt;&lt; \" \"\n    );\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 35370, "user_id": 180275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/4GALY.jpg?s=128&g=1", "display_name": "Ren&#233; Nyffenegger", "link": "https://stackoverflow.com/users/180275/ren%c3%a9-nyffenegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 44934709, "answer_count": 3, "score": 3, "last_activity_date": 1499284239, "creation_date": 1499267939, "last_edit_date": 1499268137, "question_id": 44930191, "link": "https://stackoverflow.com/questions/44930191/how-can-i-stdsqrtboostlambdaplaceholder1-type", "title": "How can I std::sqrt(boost::lambda::placeholder1_type)?", "body": "<p>How do I <code>std::sqrt()</code> on a <code>boost::lambda::placeholder1_type</code>?</p>\n\n<p>The following program compiles and executes fine. Somehow, it manages to convert <code>boost::lambda::_1</code> to a double and multiply it with 5.0.</p>\n\n<pre><code>#include &lt;boost/lambda/lambda.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n\nint main() {\n\n  std::array&lt;double, 6&gt; a = {1, 4, 9, 16, 25, 36};\n\n  std::for_each(a.begin(), a.end(),\n      std::cout &lt;&lt; boost::lambda::_1 * 5.0 &lt;&lt; \" \"\n  );\n}\n</code></pre>\n\n<p>However, if I replace the <code>std::cout</code> line with</p>\n\n<pre><code>std::cout &lt;&lt; std::sqrt(boost::lambda::_1) &lt;&lt; \" \"\n</code></pre>\n\n<p>the compiler (g++) says </p>\n\n<blockquote>\n  <p>no known conversion for argument 1 from\n  \u2018boost::lambda::placeholder1_type {aka const\n  boost::lambda::lambda_functor >}\u2019 to\n  \u2018double\u2019</p>\n</blockquote>\n\n<p>So, how can I take the square root from <code>boost::lambda::_1</code> in this std::for_each loop?</p>\n"}, {"tags": ["c++", "winapi", "keylogger"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 5, "creation_date": 1499267952, "post_id": 44930152, "comment_id": 76836067, "body": "Display a window witch a check box. The user the has to check when he inputs a password."}, {"owner": {"reputation": 70, "user_id": 6372391, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KGJ3EPda6rs/AAAAAAAAAAI/AAAAAAAAAEs/koDm-L5HgGQ/photo.jpg?sz=128", "display_name": "Amir Qasemi", "link": "https://stackoverflow.com/users/6372391/amir-qasemi"}, "edited": false, "score": 0, "creation_date": 1499268524, "post_id": 44930152, "comment_id": 76836480, "body": "I am writing a keylogger so the user will not even know his keyboard input has been logged"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1499269438, "post_id": 44930152, "comment_id": 76837137, "body": "@AmirQasemi manni66&#39;s comment was clearly intended to be a joke."}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1499275079, "post_id": 44930152, "comment_id": 76840534, "body": "You know it&#39;s a password because the focus is on a password input control. How you determine that is up to you, but judging by how often password managers get it wrong I&#39;d say it&#39;s not easy."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 0, "last_activity_date": 1499275170, "creation_date": 1499275170, "answer_id": 44932413, "question_id": 44930152, "link": "https://stackoverflow.com/questions/44930152/differentiating-between-password-and-other-kind-of-keyboard-inputs-in-a-keylogge/44932413#44932413", "title": "Differentiating between password and other kind of keyboard inputs in a keylogger", "body": "<p>If the foreground app is using standard Win32 UI controls, then try this:</p>\n\n<ul>\n<li>use <code>GetForegroundWindow()</code> to get the <code>HWND</code> of the foreground window.</li>\n<li>then use <code>GetWindowThreadProcessId()</code> and <code>GetGUIThreadInfo()</code> to get the foreground window's currently focused child control.</li>\n<li>then use <code>GetClassName()</code> to check if it is a standard <code>EDIT</code> control (this check might fail in some UI frameworks! You might have to use the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ee684009.aspx\" rel=\"nofollow noreferrer\">UI Automation</a> API to detect the control type) </li>\n<li>then use <code>GetWindowLong/Ptr()</code> to check if it has the <code>ES_PASSWORD</code> style applied.</li>\n</ul>\n\n<p>However, if the foreground app is not using standard Win32 UI controls, and/or is custom-drawing them, or the like, then all bets are off.</p>\n"}], "owner": {"reputation": 70, "user_id": 6372391, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KGJ3EPda6rs/AAAAAAAAAAI/AAAAAAAAAEs/koDm-L5HgGQ/photo.jpg?sz=128", "display_name": "Amir Qasemi", "link": "https://stackoverflow.com/users/6372391/amir-qasemi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 44932413, "answer_count": 1, "score": -7, "last_activity_date": 1499275170, "creation_date": 1499267816, "last_edit_date": 1499270045, "question_id": 44930152, "link": "https://stackoverflow.com/questions/44930152/differentiating-between-password-and-other-kind-of-keyboard-inputs-in-a-keylogge", "title": "Differentiating between password and other kind of keyboard inputs in a keylogger", "body": "<p>I am writing a keylogger for windows. I am planning to get the pressed key with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646293(v=vs.85).aspx\" rel=\"nofollow noreferrer\">GetAsyncKeyState(KEY)</a> and a hidden console. After a key press has been identified I will get the current focused windows with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633505.aspx\" rel=\"nofollow noreferrer\">GetForegroundWindow</a> and indentify which program was on top when the key was pressed. I also want to be able to Differentiate between key presses for passwords and other kind of inputs. Is there a way to do it? How?</p>\n\n<p>I am not writing a malicious software. This is for an assignment in Advanced Programming course.</p>\n"}, {"tags": ["python", "c++"], "comments": [{"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1499267469, "post_id": 44929959, "comment_id": 76835724, "body": "One reference is stored in <code>sys.modules</code> dict after a module is imported (caching). But I&#39;m not sure where the other comes from."}, {"owner": {"reputation": 621, "user_id": 6489803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1010187672400302/picture?type=large", "display_name": "jackscorrow", "link": "https://stackoverflow.com/users/6489803/jackscorrow"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1499269680, "post_id": 44929959, "comment_id": 76837307, "body": "@freakish Ok, so it&#39;s not a problem with my code I suppose. But should I call <code>Py_DecRef</code> 3 times every time I use <code>PyImport</code> or something similar like <code>PyObject_GetAttrString</code> then? It seems odd to me."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1499270420, "post_id": 44929959, "comment_id": 76837807, "body": "I don&#39;t think so. You should only call <code>Py_DecRef</code> once. After you&#39;ve done working with it. <code>Py_Finalize</code> should take care of the rest. But perhaps you should wait for someone else to confirm it."}], "answers": [{"tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1499325213, "creation_date": 1499325213, "answer_id": 44942090, "question_id": 44929959, "link": "https://stackoverflow.com/questions/44929959/why-pyimport-importmodule-returns-a-pyobject-with-a-refcount-of-3-instead-of-1/44942090#44942090", "title": "Why PyImport_ImportModule returns a PyObject* with a refcount of 3 instead of 1", "body": "<p>You don't own the only reference to the new module. While in this case, it's simple to identify the other references - one is <code>sys.modules['scipy.stats']</code>, and one is the <code>stats</code> attribute of the <code>scipy</code> module object - in general, it's not your concern what other references a module might have.</p>\n\n<p>When you clear your reference to the module, you should only <code>Py_DECREF</code> once, because you're only clearing one reference, the one you own. The other references still exist and still need to be accounted for in the refcount.</p>\n"}], "owner": {"reputation": 621, "user_id": 6489803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1010187672400302/picture?type=large", "display_name": "jackscorrow", "link": "https://stackoverflow.com/users/6489803/jackscorrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 44942090, "answer_count": 1, "score": 1, "last_activity_date": 1499325213, "creation_date": 1499267251, "last_edit_date": 1499324883, "question_id": 44929959, "link": "https://stackoverflow.com/questions/44929959/why-pyimport-importmodule-returns-a-pyobject-with-a-refcount-of-3-instead-of-1", "title": "Why PyImport_ImportModule returns a PyObject* with a refcount of 3 instead of 1", "body": "<p>I'm working with Python C API in my C++ program and I've noticed an odd thing.</p>\n\n<p>While running a simple program like this in my debugger on my PC:</p>\n\n<pre><code>int main(int argc, const char * argv[]) {\n\n    Py_Initialize();\n    PyObject* scipy_stats_module = PyImport_ImportModule(\"scipy.stats\"); // importing \"scipy.stats\" module\n\n    Py_DecRef(scipy_stats_module);\n\n    if (Py_FinalizeEx() &lt; 0) {\n        PyErr_Print();\n        exit(-1);\n    }\n\n    return 0;\n\n}\n</code></pre>\n\n<p>I've seen that the <code>ob_refcnt</code> attribute of <code>scipy_stats_module</code>, right after its creation and before calling <code>Py_DecRef</code>, is set at 3 while I was expecting it to be equal to 1.</p>\n\n<p>Can somebody help me understand why is this happening? Is this a problem with my code or is it normal? Should I call <code>Py_DecRef</code> three times or just once?</p>\n\n<p>Thank you!</p>\n\n<p>P.S. I'm using Xcode 8.3.3 as IDE and debugger on my PC with macOS 10.12.5</p>\n"}, {"tags": ["c++", "arrays", "pointers", "buffer", "circular-buffer"], "comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1499267099, "post_id": 44929796, "comment_id": 76835441, "body": "You need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Your additional content about <code>snd_pcm_writei</code> has very little to do with your question."}, {"owner": {"reputation": 3868, "user_id": 2589553, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/490f0b6836112dc8929c72ed3f03bf68?s=128&d=identicon&r=PG", "display_name": "duong_dajgja", "link": "https://stackoverflow.com/users/2589553/duong-dajgja"}, "edited": false, "score": 2, "creation_date": 1499267113, "post_id": 44929796, "comment_id": 76835454, "body": "why don&#39;t simply use <code>memcopy</code>?"}, {"owner": {"reputation": 59, "user_id": 4832246, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5edc6ad8f56f8b8d6050808d8fd82fa0?s=128&d=identicon&r=PG&f=1", "display_name": "JohanPI", "link": "https://stackoverflow.com/users/4832246/johanpi"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1499279487, "post_id": 44929796, "comment_id": 76842978, "body": "Thank you for your comment, a working example has been added @PasserBy"}, {"owner": {"reputation": 59, "user_id": 4832246, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5edc6ad8f56f8b8d6050808d8fd82fa0?s=128&d=identicon&r=PG&f=1", "display_name": "JohanPI", "link": "https://stackoverflow.com/users/4832246/johanpi"}, "reply_to_user": {"reputation": 3868, "user_id": 2589553, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/490f0b6836112dc8929c72ed3f03bf68?s=128&d=identicon&r=PG", "display_name": "duong_dajgja", "link": "https://stackoverflow.com/users/2589553/duong-dajgja"}, "edited": false, "score": 0, "creation_date": 1499279548, "post_id": 44929796, "comment_id": 76843004, "body": "Thanks for your suggestion @duong_dajgja! I have added a test and a comment about memcpy"}, {"owner": {"reputation": 3868, "user_id": 2589553, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/490f0b6836112dc8929c72ed3f03bf68?s=128&d=identicon&r=PG", "display_name": "duong_dajgja", "link": "https://stackoverflow.com/users/2589553/duong-dajgja"}, "edited": false, "score": 0, "creation_date": 1499335631, "post_id": 44929796, "comment_id": 76866793, "body": "Not sure about your situation but if the reformatting does really take time then how about considering to parallelize the work (e.g. multi-threading)?"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 4832246, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5edc6ad8f56f8b8d6050808d8fd82fa0?s=128&d=identicon&r=PG&f=1", "display_name": "JohanPI", "link": "https://stackoverflow.com/users/4832246/johanpi"}, "edited": false, "score": 0, "creation_date": 1499335119, "post_id": 44938678, "comment_id": 76866441, "body": "Thanks for the suggestion, however if I get your idea correctly it would mean that I need to change the way I write data into the buffer to be copied from (ring_buffer in the example code). This would be highly problematic timing wise, it might no t even be possible."}], "tags": [], "owner": {"reputation": 3868, "user_id": 2589553, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/490f0b6836112dc8929c72ed3f03bf68?s=128&d=identicon&r=PG", "display_name": "duong_dajgja", "link": "https://stackoverflow.com/users/2589553/duong-dajgja"}, "is_accepted": false, "score": 0, "last_activity_date": 1499306575, "creation_date": 1499306575, "answer_id": 44938678, "question_id": 44929796, "link": "https://stackoverflow.com/questions/44929796/efficient-reformatting-of-ring-buffer-circular-buffer-to-continous-array/44938678#44938678", "title": "Efficient reformatting of ring buffer (circular buffer) to continous array", "body": "<p>I would like to suggest a ring buffer - like structure that is actually an array.</p>\n\n<p>Since your data is audio stream so I suppose that data would come in order (e.g. time-series data).</p>\n\n<p>Assume the buff has capacity of 100 elements. Once the buff gets full and you want to add a new element to the end, you first have to left-shift region from buff[1] to buff[99] by one using <code>memmove</code> then simply put the new element at buff[99]. Doing so you are sure that your ring buffer is always an array with correct order (from buff[0] to buff[99]). Now, simply <code>memcpy</code> whole region from buff[0] to buff[99] to the destination array as you desire.</p>\n"}], "owner": {"reputation": 59, "user_id": 4832246, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5edc6ad8f56f8b8d6050808d8fd82fa0?s=128&d=identicon&r=PG&f=1", "display_name": "JohanPI", "link": "https://stackoverflow.com/users/4832246/johanpi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 725, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1499306575, "creation_date": 1499266836, "last_edit_date": 1499279354, "question_id": 44929796, "link": "https://stackoverflow.com/questions/44929796/efficient-reformatting-of-ring-buffer-circular-buffer-to-continous-array", "title": "Efficient reformatting of ring buffer (circular buffer) to continous array", "body": "<p>I've successfully implemented a function that copies an arbitrary amount of values starting from an arbitrary point in a ring buffer to a continuous array but I would like to make it more efficient. Here's a minimum example of my code:</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\n\nusing namespace std;\n\n\n/*Foo: a function*/\nvoid Foo(int * print_array, int print_amount){\n    /*Simulate overhead*/\n    this_thread::sleep_for(chrono::microseconds(1000));\n    int sum = 0;\n    for (int i = 0; i &lt; print_amount; i++){\n        sum += print_array[i];          //Linear operation\n//      cout &lt;&lt; print_array[i] &lt;&lt; \" \"; //Uncomment to check if correct funtionality\n    }\n}\n\n/*Example function*/\nint main(){\n    /*Initialze ring buffer*/\n    int ring_buffer_elements = 32;                              //A largeish size\n    int ring_buffer_size = ring_buffer_elements * sizeof(int);\n    int * ring_buffer = (int *) malloc(ring_buffer_size);\n    for (int i = 0; i &lt; ring_buffer_elements; i++)\n        ring_buffer[i] = i;                                     //Fill buffer with ordered numbers\n\n    /*Initialze array*/\n    int array_elements = 16;                                    //A smaller largeish size\n    int array_size = array_elements * sizeof(int);\n    int * array = (int *) malloc(array_size);\n\n    /*Set reference pointers*/\n    int * start_pointer = ring_buffer;\n    int * end_pointer = ring_buffer + ring_buffer_elements;\n\n    /*Set moving copy pointer*/\n    int * copy_pointer = start_pointer;\n\n    /*Set \"random\" amount to be copied at each iteration*/  \n    int copy_amount = 11;\n\n    /*Set loop amount to check functionality or run time*/\n    int loop_amount = 1000;                                 //Set lower if checking functionality\n\n    /***WORKING METHOD***/\n    /*Start timer*/\n    auto start_time = chrono::high_resolution_clock::now();\n\n    /*\"Continuous\" loop*/\n    for (int i = 0; i &lt; loop_amount; i++){\n        /*Copy loop*/\n        for (int j = 0; j &lt; copy_amount; j++){\n            array[j] = *copy_pointer;           //Copy value from ring buffer\n            copy_pointer++;                     //Move pointer\n            if (copy_pointer &gt;= end_pointer)    \n                copy_pointer = start_pointer;   //Reset pointer if reached end of ring buffer\n        }\n        Foo(array, copy_amount);    //Call a function\n    }\n\n    /*Check run time*/\n    chrono::duration&lt;double&gt; run_time_ticks = chrono::high_resolution_clock::now() - start_time;\n    double run_time = run_time_ticks.count();\n\n    /*Print result*/\n    cout &lt;&lt; endl &lt;&lt; run_time &lt;&lt; endl;\n\n\n/***NAIVE METHOD***/\n    /*Reset moving pointer*/\n    copy_pointer = start_pointer;\n\n    /*Start timer*/\n    start_time = chrono::high_resolution_clock::now();\n\n    /*\"Continuous\" loop*/\n    for (int i = 0; i &lt; loop_amount; i++){\n        /*Compute how many elements must be copied after reaching end of ring buffer*/\n        int copy_remainder = copy_pointer + copy_amount - end_pointer; //Ugly pointer arithmetic?\n        /*Check if we need to loop back or not*/\n        if (copy_remainder &lt;= 0){\n            Foo(copy_pointer, copy_amount); //Call function\n            copy_pointer += copy_amount;    //Move pointer\n        } else {\n            Foo(copy_pointer, copy_amount-copy_remainder);  //Call function with part of values from copy pointer\n            Foo(start_pointer, copy_remainder);             //Call function with remainder of values from start of ring buffer\n            copy_pointer = start_pointer + copy_remainder;  //Move pointer\n        }\n    }\n\n    /*Check run time*/\n    run_time_ticks = chrono::high_resolution_clock::now() - start_time;\n    run_time = run_time_ticks.count();\n\n    /*Print result*/\n    cout &lt;&lt; endl &lt;&lt; run_time &lt;&lt; endl;\n\n\n    /***memcpy METHOD***/\n    /*Reset moving pointer*/\n    copy_pointer = start_pointer;\n\n    /*Initialize size reference*/\n    int int_size = (int) sizeof(int);\n\n    /*Start timer*/\n    start_time = chrono::high_resolution_clock::now();\n\n    /*\"Continuous\" loop*/\n    for (int i = 0; i &lt; loop_amount; i++){\n        /*Compute how many elements must be copied after reaching end of ring buffer*/\n        int copy_remainder = copy_pointer + copy_amount - end_pointer; //Ugly pointer arithmetic?\n        /*Check if we need to loop back or not*/\n        if (copy_remainder &lt;= 0){\n            memcpy(array, copy_pointer, copy_amount*int_size);  //Use memcpy\n            copy_pointer += copy_amount;                        //Move pointer\n        } else {\n            memcpy(array, copy_pointer, (copy_amount-copy_remainder)*int_size);                 //Use memcpy with part of values from copy pointer\n            memcpy(array+(copy_amount-copy_remainder), start_pointer, copy_remainder*int_size); //Use memcpy wih remainder of values from start of ring buffer\n            copy_pointer = start_pointer + copy_remainder;                                      //Move pointer\n        }\n        /*Call a function*/\n        Foo(array, copy_amount);\n    }\n\n    /*Check run time*/\n    run_time_ticks = chrono::high_resolution_clock::now() - start_time;\n    run_time = run_time_ticks.count();\n\n    /*Print result*/\n    cout &lt;&lt; endl &lt;&lt; run_time &lt;&lt; endl;\n\n}\n</code></pre>\n\n<p>The ring buffer is used for a continuously updating stream of audio data and thus the amount of latency introduced must be kept to a minimum, why I'm trying to improve it.</p>\n\n<p>I was thinking that copying the values in WORKING METHOD is redundant and that it should be possible to just pass through the original ring buffer data. My naive approach of doing this was to write with the original data and  whenever the data looped back write again (see NAIVE IMPROVEMENT).</p>\n\n<p>Indeed, in this minimum example this improvement is orders of magnitude quicker. However, in my real application <em>Foo</em> is replaced with a function that writes to a hardware buffer and has quite a overhead \u0323\u0323\u0323\u0323\u0323- the end result is slower than the WORKING METHOD code, meaning that I never should use it (or Foo in this case) more than once (per time to write audio data). (<strong>EDIT</strong> a simulated overhead was added to Foo to accurately depict this issue).</p>\n\n<p>My question is therefore if there is a quicker way to copy data from a ring buffer to a single, continuous array?</p>\n\n<p>(Also, the ring buffer will never need to loop back more than once per time to write: copy_amount is always less than ring_buffer_elements)</p>\n\n<p>Thanks!</p>\n\n<p><strong>EDIT</strong>\nReplaced original code snippet with minimum example as per Passer By's suggestion.</p>\n\n<p><strong>EDIT 2</strong>\nAdded a simulated overhead and an memcpy as per duong_dajgja's suggestion. In the example the memcpy method and the working method has essentially the same performance (with the latter having somewhat of an edge). In my application memcpy is about 3-4 % quicker than the working method when using the smallest buffer possible. So quicker, but regrettably far from significant.</p>\n"}, {"tags": ["c++", "qt5", "qmetaobject"], "comments": [{"owner": {"reputation": 3575, "user_id": 2750816, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c28ad318c9e95eda7bf7ee211db86a76?s=128&d=identicon&r=PG", "display_name": "Evgeny", "link": "https://stackoverflow.com/users/2750816/evgeny"}, "edited": false, "score": 0, "creation_date": 1499499548, "post_id": 44929746, "comment_id": 76942335, "body": "I think you should just add some method at <code>MultiItem</code> class for set <code>someEntries</code> values and mark this method  with <code>Q_INVOCABLE</code> and dont use property for changing values."}], "owner": {"reputation": 3190, "user_id": 1798015, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52308759088ab744fdca3fe619dde41d?s=128&d=identicon&r=PG", "display_name": "feedc0de", "link": "https://stackoverflow.com/users/1798015/feedc0de"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499266684, "creation_date": 1499266684, "question_id": 44929746, "link": "https://stackoverflow.com/questions/44929746/adding-options-to-existing-q-property-from-base-class-only-in-dereived-class", "title": "Adding options to existing Q_PROPERTY from base class only in dereived class", "body": "<p>I have a very simple base class which defines a normal Q_PROPERTY with READ and NOTIFY (WRITE is not in all dereived implementations possible).</p>\n\n<pre><code>class BaseClass : public QObject {\n    Q_OBJECT\n    Q_PROPERTY(QStringList someEntries READ someEntries NOTIFY someEntriesChanged)\n\npublic:\n    explicit BaseClass(QObject *parent = Q_NULLPTR) : QObject(parent) {}\n    virtual ~BaseClass() {}\n\n    virtual QStringList someEntries() const = 0;\n\n    void processEntries() {\n        for(auto entry : someEntries()) {\n            //process entry\n        }\n    }\n\nQ_SIGNALS:\n    void someEntriesChanged(const QStringList &amp;someEntries);\n};\n</code></pre>\n\n<p>Now I have 2 dereiving classes, of which one supports only one entry (<code>SingleItem</code>) and the other one supports multiple entries (<code>MultiItem</code>).</p>\n\n<p><code>SingleItem</code> converts the one QString-member to a QStringList when requested and allows setting it using the differently called property (<code>theEntry</code>):</p>\n\n<pre><code>class SingleItem : public BaseClass {\n    Q_OBJECT\n    Q_PROPERTY(QString theEntry READ theEntry WRITE setTheEntry NOTIFY theEntryChanged);\n\npublic:\n    explicit SingleItem(QObject *parent = Q_NULLPTR) : BaseClass(parent) {}\n    virtual ~SingleItem() {}\n\n    const QString &amp;theEntry() const { return m_theEntry; }\n    void setTheEntry(const QString &amp;theEntry) {\n        if(m_theEntry != theEntry)\n            Q_EMIT theEntryChanged(m_theEntry = theEntry);\n    }\n\n    // BaseClass interface\n    QStringList someEntries() const Q_DECL_OVERRIDE\n    { return QStringList { m_theEntry }; }\n\nQ_SIGNALS:\n    void theEntryChanged(const QString &amp;theEntry);\n\nprivate:\n    QString m_theEntry;\n};\n</code></pre>\n\n<p><code>MutliItem</code> stores a QStringList (for <code>someEntries</code>). I would like to write into that QStringList using the property defined in <code>BaseClass</code>. But I dont know how to add the WRITE option to the already defined Q_PROPERTY.</p>\n\n<pre><code>class MultiItem : public BaseClass {\n    Q_OBJECT\n    //Somehow add the setSomeEntries method to the property?\n\npublic:\n    explicit MultiItem(QObject *parent = Q_NULLPTR) : BaseClass(parent) {}\n    virtual ~MultiItem() {}\n\n    void setSomeEntries(const QStringList &amp;someEntries) {\n        if(m_someEntries != someEntries)\n            Q_EMIT someEntriesChanged(m_someEntries = someEntries);\n    }\n\n    // BaseClass interface\n    QStringList someEntries() const Q_DECL_OVERRIDE{ return m_someEntries; }\n\nprivate:\n    QStringList m_someEntries;\n};\n</code></pre>\n\n<p>I cannot add the WRITE option in <code>BaseClass</code> because it would violate the meaning. Not every object of <code>BaseClass</code> allows setting that property but objects of <code>MultiItem</code> should be written only using that property.</p>\n\n<p>Is this somehow possible without declaring a WRITE option to a <code>virtual ... = 0</code> in <code>BaseClass</code> that just logs a warning when called in <code>SingleItem</code>?</p>\n"}, {"tags": ["c++", "inheritance", "g++", "clang++"], "comments": [{"owner": {"reputation": 814, "user_id": 3574571, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/1CulI.jpg?s=128&g=1", "display_name": "Mquinteiro", "link": "https://stackoverflow.com/users/3574571/mquinteiro"}, "edited": false, "score": 0, "creation_date": 1499267308, "post_id": 44929632, "comment_id": 76835610, "body": "take a look to this <a href=\"https://stackoverflow.com/questions/357307/how-to-call-a-parent-class-function-from-derived-class-function\">link</a>"}, {"owner": {"reputation": 11476, "user_id": 2790047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5a7631a67903295da25dabb94e1f51b?s=128&d=identicon&r=PG", "display_name": "jodag", "link": "https://stackoverflow.com/users/2790047/jodag"}, "edited": false, "score": 0, "creation_date": 1499267722, "post_id": 44929632, "comment_id": 76835894, "body": "Is there any reason you want to use private virtual methods? If you make <code>f</code> a non-virtual method in <code>DA</code> the warning is removed."}, {"owner": {"reputation": 355, "user_id": 1115539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cec0d84a1f6636867a5089d504a926?s=128&d=identicon&r=PG", "display_name": "Sacchan", "link": "https://stackoverflow.com/users/1115539/sacchan"}, "reply_to_user": {"reputation": 11476, "user_id": 2790047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5a7631a67903295da25dabb94e1f51b?s=128&d=identicon&r=PG", "display_name": "jodag", "link": "https://stackoverflow.com/users/2790047/jodag"}, "edited": false, "score": 0, "creation_date": 1499268513, "post_id": 44929632, "comment_id": 76836470, "body": "@jodag: I cannot make f non-virtual, it overrides a function from A. And it is private since A is inherited privately."}, {"owner": {"reputation": 355, "user_id": 1115539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cec0d84a1f6636867a5089d504a926?s=128&d=identicon&r=PG", "display_name": "Sacchan", "link": "https://stackoverflow.com/users/1115539/sacchan"}, "reply_to_user": {"reputation": 814, "user_id": 3574571, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/1CulI.jpg?s=128&g=1", "display_name": "Mquinteiro", "link": "https://stackoverflow.com/users/3574571/mquinteiro"}, "edited": false, "score": 0, "creation_date": 1499268686, "post_id": 44929632, "comment_id": 76836583, "body": "@Mquinteiro: Unless I&#39;m mistaken, that link has nothing to do with my question, excepting the fact that the accepted answer also mentions multiple inheritance"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 4, "creation_date": 1499270003, "post_id": 44929632, "comment_id": 76837537, "body": "One can override a private virtual function. So the warning may be justified."}, {"owner": {"reputation": 355, "user_id": 1115539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cec0d84a1f6636867a5089d504a926?s=128&d=identicon&r=PG", "display_name": "Sacchan", "link": "https://stackoverflow.com/users/1115539/sacchan"}, "edited": false, "score": 0, "creation_date": 1499270191, "post_id": 44929632, "comment_id": 76837653, "body": "@manni66 Interesting, thank you. I agree that in that case, the warning is justified, though I still would like a way to tell the compiler that this is intentional"}, {"owner": {"reputation": 25661, "user_id": 430766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee7e736eeb33c4b03d4a5e6e813a9abc?s=128&d=identicon&r=PG", "display_name": "bitmask", "link": "https://stackoverflow.com/users/430766/bitmask"}, "edited": false, "score": 0, "creation_date": 1499270472, "post_id": 44929632, "comment_id": 76837848, "body": "One solution could be to move the implementation of <code>void f(char*)</code> to an intermediary class between <code>B</code> and <code>DB</code>. Then the compiler correctly understands what you are trying to do. Not sure if this works in your situation."}, {"owner": {"reputation": 259, "user_id": 7886227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hec3U.jpg?s=128&g=1", "display_name": "Dr t", "link": "https://stackoverflow.com/users/7886227/dr-t"}, "edited": false, "score": 0, "creation_date": 1499270542, "post_id": 44929632, "comment_id": 76837898, "body": "Have a look at this link:  <a href=\"https://useyourloaf.com/blog/disabling-clang-compiler-warnings/\" rel=\"nofollow noreferrer\">useyourloaf.com/blog/disabling-clang-compiler-warnings</a>    Clear example of what you may be looking for,"}, {"owner": {"reputation": 355, "user_id": 1115539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cec0d84a1f6636867a5089d504a926?s=128&d=identicon&r=PG", "display_name": "Sacchan", "link": "https://stackoverflow.com/users/1115539/sacchan"}, "reply_to_user": {"reputation": 259, "user_id": 7886227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hec3U.jpg?s=128&g=1", "display_name": "Dr t", "link": "https://stackoverflow.com/users/7886227/dr-t"}, "edited": false, "score": 0, "creation_date": 1499270763, "post_id": 44929632, "comment_id": 76838037, "body": "@Drt: As I stated in the question, I specifically want to avoid deactivating compiler warnings."}, {"owner": {"reputation": 259, "user_id": 7886227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hec3U.jpg?s=128&g=1", "display_name": "Dr t", "link": "https://stackoverflow.com/users/7886227/dr-t"}, "edited": false, "score": 1, "creation_date": 1499271422, "post_id": 44929632, "comment_id": 76838450, "body": "Your question ended with: &quot; i.e. telling the compiler that everything is designed as is intended?&quot;    Which i do believe is answered at the link I pointed out.  The Clang user manual states essentially the same thing.  You disable only for one line of code which is the really only practical way for you to &quot;Tell the compiler&quot; something...  and the instructions are in the user manual..."}], "answers": [{"tags": [], "owner": {"reputation": 355, "user_id": 1115539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cec0d84a1f6636867a5089d504a926?s=128&d=identicon&r=PG", "display_name": "Sacchan", "link": "https://stackoverflow.com/users/1115539/sacchan"}, "is_accepted": false, "score": 0, "last_activity_date": 1499270703, "creation_date": 1499270703, "answer_id": 44931152, "question_id": 44929632, "link": "https://stackoverflow.com/questions/44929632/hiding-a-private-overloaded-virtual-function/44931152#44931152", "title": "Hiding a private overloaded virtual function?", "body": "<p>What I ended up doing (for now) is using composition instead of private inheritance. So my code currently looks like</p>\n\n<pre><code>class A \n{ \nprotected: \n    virtual void f(int) = 0;\n};\n\nclass B \n{ \nprotected: \n    virtual void f(char*) = 0;\n};\n\nclass DA  \n{ \n    class D : A\n    {\n    private:\n        virtual void f(int) override {}\n    } d;\n};\n\nclass DB : public DA\n{ \n    class D : B\n    {\n    private:\n        virtual void f(char*) override {}\n    } d;\n};\n</code></pre>\n\n<p>I'm not 100% happy with this, as the <code>d</code> members cause additional syntactial overhead, but at least it works without changing the public interface.</p>\n"}, {"comments": [{"owner": {"reputation": 355, "user_id": 1115539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cec0d84a1f6636867a5089d504a926?s=128&d=identicon&r=PG", "display_name": "Sacchan", "link": "https://stackoverflow.com/users/1115539/sacchan"}, "edited": false, "score": 0, "creation_date": 1499273579, "post_id": 44931839, "comment_id": 76839750, "body": "True enough. In my real example (which is quite a bit more involved), the objects in the two signatures cannot actually be interpreted as each other, so it isn&#39;t quite as harmful"}], "tags": [], "owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "is_accepted": true, "score": 3, "last_activity_date": 1499273061, "creation_date": 1499273061, "answer_id": 44931839, "question_id": 44929632, "link": "https://stackoverflow.com/questions/44929632/hiding-a-private-overloaded-virtual-function/44931839#44931839", "title": "Hiding a private overloaded virtual function?", "body": "<blockquote>\n  <p>After all, DB cannot even see the hidden function (which might even be named the same by coincidence).</p>\n</blockquote>\n\n<p>Accessibility and visibility are different concepts in C++. <code>DA::f()</code> is by default <em>visible</em> inside <code>DB</code> (and then hidden by <code>DB::f()</code>), but it is not accessible, because it is private inside <code>DA</code>, and <code>DB</code> is not a friend of <code>DA</code>. One could argue that hiding a function that is inaccessible is harmless, because it cannot be called anyway. However, the distinction between hidden and inaccessible can be significant because visible and inaccessible functions do participate in overload resolution. If <code>db</code> is an object of type <code>DB</code>, then what does <code>db.f(0)</code> do? If <code>DA::f()</code> is visible but inaccessible, it will be selected as best match and the compiler will emit a diagnostic because it is inaccessible and therefore cannot be called. If <code>DA::f()</code> is hidden, however, the compiler will select the overload that accepts a pointer instead, and treat the literal <code>0</code> as a null pointer.</p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1499276850, "creation_date": 1499276850, "answer_id": 44932868, "question_id": 44929632, "link": "https://stackoverflow.com/questions/44929632/hiding-a-private-overloaded-virtual-function/44932868#44932868", "title": "Hiding a private overloaded virtual function?", "body": "<p>A possible way to fix the warning is to duplicate code of <code>DA::f</code> inside <code>DB</code>:</p>\n\n<pre><code>class DB : public DA, B \n{\n    virtual void f(int i) override\n    {\n         // copy implementation of DA::f(int) as you cannot do\n         // return DA::f(i);\n    }\nprivate:\n    virtual void f(char*) override {}\n};\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/b25886b2611985da\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<p>but a local <em>pragma</em> to remove warning seems more appropriate.</p>\n"}], "owner": {"reputation": 355, "user_id": 1115539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cec0d84a1f6636867a5089d504a926?s=128&d=identicon&r=PG", "display_name": "Sacchan", "link": "https://stackoverflow.com/users/1115539/sacchan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1297, "favorite_count": 1, "accepted_answer_id": 44931839, "answer_count": 3, "score": 9, "last_activity_date": 1499276850, "creation_date": 1499266369, "last_edit_date": 1499269897, "question_id": 44929632, "link": "https://stackoverflow.com/questions/44929632/hiding-a-private-overloaded-virtual-function", "title": "Hiding a private overloaded virtual function?", "body": "<p>I have a class hierarchy that works approximately like this:</p>\n\n<pre><code>class A \n{ \nprotected: \n    virtual void f(int) = 0;\n};\n\nclass B \n{ \nprotected: \n    virtual void f(char*) = 0;\n};\n\nclass DA : A \n{ \nprivate:\n    virtual void f(int) override {}\n};\n\nclass DB : public DA, B \n{ \nprivate:\n    virtual void f(char*) override {}\n};\n</code></pre>\n\n<p>When I try to compile with clang (or gcc, for that matter), it gives me the warning</p>\n\n<pre><code>&lt;source&gt;:22:18: warning: 'DB::f' hides overloaded virtual function [-Woverloaded-virtual]\n    virtual void f(char*) override {}\n                 ^\n&lt;source&gt;:16:18: note: hidden overloaded virtual function 'DA::f' declared here: type mismatch at 1st parameter ('int' vs 'char *')\n    virtual void f(int) override {}\n                 ^\n</code></pre>\n\n<p>Which I understand, but should it really give that warning? After all, <code>DB</code> cannot even see the hidden function (which might even be named the same by coincidence).</p>\n\n<p>If it wasn't private, I could use</p>\n\n<pre><code>using DA::f;\n</code></pre>\n\n<p>to clarify, of course, but the function is private, <code>DB</code> doesn't even know about it, and certainly shouldn't expose it.</p>\n\n<p>Is there a way to fix this without deactivating that warning, i.e. telling the compiler that everything is designed as is intended? </p>\n"}, {"tags": ["c++", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8255839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a3dbee5b413a856450de6f3eb45a07?s=128&d=identicon&r=PG&f=1", "display_name": "CL92", "link": "https://stackoverflow.com/users/8255839/cl92"}, "edited": false, "score": 0, "creation_date": 1499275300, "post_id": 44932018, "comment_id": 76840674, "body": "I thought that would work, but I am not sure what to pass for the param VARIANT &amp;Modal."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 9, "user_id": 8255839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a3dbee5b413a856450de6f3eb45a07?s=128&d=identicon&r=PG&f=1", "display_name": "CL92", "link": "https://stackoverflow.com/users/8255839/cl92"}, "edited": false, "score": 0, "creation_date": 1499275626, "post_id": 44932018, "comment_id": 76840870, "body": "Variant of type VT_BOOLEAN"}, {"owner": {"reputation": 9, "user_id": 8255839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a3dbee5b413a856450de6f3eb45a07?s=128&d=identicon&r=PG&f=1", "display_name": "CL92", "link": "https://stackoverflow.com/users/8255839/cl92"}, "edited": false, "score": 0, "creation_date": 1499275850, "post_id": 44932018, "comment_id": 76840998, "body": "Thank you, Dmitry."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1499273768, "creation_date": 1499273768, "answer_id": 44932018, "question_id": 44929537, "link": "https://stackoverflow.com/questions/44929537/preview-email-generated-by-microsoft-outlook-object-library/44932018#44932018", "title": "Preview email generated by Microsoft Outlook Object Library", "body": "<p>Of course. Instead of calling <code>MailItem.Send</code>, call <code>MailItem.Display</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 8255839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a3dbee5b413a856450de6f3eb45a07?s=128&d=identicon&r=PG&f=1", "display_name": "CL92", "link": "https://stackoverflow.com/users/8255839/cl92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499273768, "creation_date": 1499266123, "question_id": 44929537, "link": "https://stackoverflow.com/questions/44929537/preview-email-generated-by-microsoft-outlook-object-library", "title": "Preview email generated by Microsoft Outlook Object Library", "body": "<p>Is it possible to preview the email generated by Microsoft Outlook Object Library? </p>\n\n<p>I currently construct a MailItem, fill it with relevant information then send it. I would like to have Outlook open and preview the email and allow the user to send the email rather than having it automatically sent. </p>\n\n<p>Thank you. </p>\n"}, {"tags": ["c++", "list", "c++11", "stl", "iterator"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1499266112, "post_id": 44929500, "comment_id": 76834561, "body": "Your &quot;slow and working&quot; example does not work in general."}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "edited": false, "score": 0, "creation_date": 1499266155, "post_id": 44929500, "comment_id": 76834599, "body": "<code>std::find</code> maybe?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1499266167, "post_id": 44929500, "comment_id": 76834612, "body": "So what exactly is myElement? You did not show its type."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1499266210, "post_id": 44929500, "comment_id": 76834645, "body": "Also, this is logically not possible as <code>myElement</code> may occur in the list more than once."}, {"owner": {"reputation": 815, "user_id": 3442959, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2914aaad97291094f4ed8bb9863788cd?s=128&d=identicon&r=PG&f=1", "display_name": "S.H", "link": "https://stackoverflow.com/users/3442959/s-h"}, "edited": false, "score": 0, "creation_date": 1499266233, "post_id": 44929500, "comment_id": 76834669, "body": "doesn&#39;t std::find, need to iterate through the container?"}, {"owner": {"reputation": 815, "user_id": 3442959, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2914aaad97291094f4ed8bb9863788cd?s=128&d=identicon&r=PG&f=1", "display_name": "S.H", "link": "https://stackoverflow.com/users/3442959/s-h"}, "edited": false, "score": 0, "creation_date": 1499266266, "post_id": 44929500, "comment_id": 76834713, "body": "myElement is simply &quot;int&quot;"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1499266283, "post_id": 44929500, "comment_id": 76834725, "body": "The only way is to iterate through the container and compare the addresses.  Unless you can guarantee that only unique values exist."}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "edited": false, "score": 0, "creation_date": 1499266325, "post_id": 44929500, "comment_id": 76834755, "body": "@S.H yes, it works with <code>O(n)</code> worst case for <code>std::list</code>, while achieving <code>O(1)</code> for <code>std::vector</code>."}, {"owner": {"reputation": 815, "user_id": 3442959, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2914aaad97291094f4ed8bb9863788cd?s=128&d=identicon&r=PG&f=1", "display_name": "S.H", "link": "https://stackoverflow.com/users/3442959/s-h"}, "edited": false, "score": 0, "creation_date": 1499266331, "post_id": 44929500, "comment_id": 76834764, "body": "Why can&#39;t I convert from the element and its address to an iterator?"}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "edited": false, "score": 0, "creation_date": 1499266389, "post_id": 44929500, "comment_id": 76834826, "body": "@S.H because that&#39;s not how lists work, unfortunately."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1499266399, "post_id": 44929500, "comment_id": 76834844, "body": "If myElement  is an int the list only contains a copy."}, {"owner": {"reputation": 815, "user_id": 3442959, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2914aaad97291094f4ed8bb9863788cd?s=128&d=identicon&r=PG&f=1", "display_name": "S.H", "link": "https://stackoverflow.com/users/3442959/s-h"}, "edited": false, "score": 0, "creation_date": 1499266463, "post_id": 44929500, "comment_id": 76834905, "body": "@manni66: Sorry, my question was no specific enough, I have a <i>reference</i> (or, if you want, pointer) to that element. I edited the question"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "edited": false, "score": 0, "creation_date": 1499266546, "post_id": 44929500, "comment_id": 76834968, "body": "@iehrlich: How is O(1) achieved with <code>std::vector</code>?"}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1499266643, "post_id": 44929500, "comment_id": 76835053, "body": "Are you sure you need <code>std::list</code>? I think you need <code>std::vector</code> to achieve what you want."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1499266665, "post_id": 44929500, "comment_id": 76835072, "body": "If you can hold a referrence to the list entry why can&#39;t you store the iterator?"}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1499266711, "post_id": 44929500, "comment_id": 76835117, "body": "@LightnessRacesinOrbit: <code>v.begin() + (&amp;element - &amp;v[0])</code>"}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499266728, "post_id": 44929500, "comment_id": 76835136, "body": "@LightnessRacesinOrbit at this point, I confused myself :) O(1) might be achieved when re-constructing an iterator from the <i>pointer</i> to an element, not from the <i>value</i> of an element."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "edited": false, "score": 0, "creation_date": 1499266919, "post_id": 44929500, "comment_id": 76835300, "body": "@iehrlich: Oh yes indeed. Was also thinking of value lookup :)"}, {"owner": {"reputation": 815, "user_id": 3442959, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2914aaad97291094f4ed8bb9863788cd?s=128&d=identicon&r=PG&f=1", "display_name": "S.H", "link": "https://stackoverflow.com/users/3442959/s-h"}, "reply_to_user": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1499266953, "post_id": 44929500, "comment_id": 76835323, "body": "@BenjaminLindley: exactly, and now for a list, that&#39;d be great :)"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1499266965, "post_id": 44929500, "comment_id": 76835331, "body": "@BenjaminLindley: Of course, if the element <i>isn&#39;t</i> in the container, that&#39;s UB. In fact, frankly, since a vector&#39;s contents are individually placement new&#39;d into a big <code>char</code> buffer, I&#39;m not even convinced this pointer arithmetic is valid (it&#39;s not navigating around &quot;the same object&quot;)"}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 1, "creation_date": 1499267052, "post_id": 44929500, "comment_id": 76835404, "body": "@S.H. : Can&#39;t be done. I&#39;d suggest you take a look at where you got the reference to the element in the first place. Because wherever that was, it started out as an iterator. So if you needed an iterator in the first place, why&#39;d you discard it?"}, {"owner": {"reputation": 815, "user_id": 3442959, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2914aaad97291094f4ed8bb9863788cd?s=128&d=identicon&r=PG&f=1", "display_name": "S.H", "link": "https://stackoverflow.com/users/3442959/s-h"}, "reply_to_user": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1499267181, "post_id": 44929500, "comment_id": 76835511, "body": "@BenjaminLindley Legacy code..."}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 1, "creation_date": 1499267732, "post_id": 44929500, "comment_id": 76835898, "body": "Well then you&#39;ve either got to rewrite it, or stick with the O(n) algorithm. Because what you are asking for is not possible."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499268101, "post_id": 44929500, "comment_id": 76836168, "body": "<code>s&#47;Legacy&#47;bad&#47;</code> ;)"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1499268297, "post_id": 44929500, "comment_id": 76836312, "body": "It is likely doable if you break into the implementation of <code>list</code>, which is never a good idea"}, {"owner": {"reputation": 1083, "user_id": 6458245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2ec6741905a7fde013a7c33ecf1a370f?s=128&d=identicon&r=PG&f=1", "display_name": "JobHunter69", "link": "https://stackoverflow.com/users/6458245/jobhunter69"}, "edited": false, "score": 0, "creation_date": 1527913084, "post_id": 44929500, "comment_id": 88317332, "body": "upvoted because of downvotes"}], "answers": [{"comments": [{"owner": {"reputation": 815, "user_id": 3442959, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2914aaad97291094f4ed8bb9863788cd?s=128&d=identicon&r=PG&f=1", "display_name": "S.H", "link": "https://stackoverflow.com/users/3442959/s-h"}, "edited": false, "score": 0, "creation_date": 1499266538, "post_id": 44929659, "comment_id": 76834960, "body": "What if I know the address of the element?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1499266580, "post_id": 44929659, "comment_id": 76835003, "body": "<code>it != &amp;myElement</code> Are you sure that works?  I don&#39;t think there is any requirement for the value of the iterator to be the address of the object.  I think <code>&amp;(*it) != &amp;myElement</code> would be more correct."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 815, "user_id": 3442959, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2914aaad97291094f4ed8bb9863788cd?s=128&d=identicon&r=PG&f=1", "display_name": "S.H", "link": "https://stackoverflow.com/users/3442959/s-h"}, "edited": false, "score": 0, "creation_date": 1499266587, "post_id": 44929659, "comment_id": 76835010, "body": "@S.H: This answer shows you how to get from the address of the element to an iterator of the node."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1499266615, "post_id": 44929659, "comment_id": 76835035, "body": "@NathanOliver: <code>!=</code> but yes"}, {"owner": {"reputation": 815, "user_id": 3442959, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2914aaad97291094f4ed8bb9863788cd?s=128&d=identicon&r=PG&f=1", "display_name": "S.H", "link": "https://stackoverflow.com/users/3442959/s-h"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499267099, "post_id": 44929659, "comment_id": 76835440, "body": "@LightnessRacesinOrbit I know that I can use <code>it != &amp;myElement&#180;, but I can&#39;t use </code>std::list&lt;int&gt;::iterator = &amp;myElem&#180;. And that&#39;s just what I need"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 815, "user_id": 3442959, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2914aaad97291094f4ed8bb9863788cd?s=128&d=identicon&r=PG&f=1", "display_name": "S.H", "link": "https://stackoverflow.com/users/3442959/s-h"}, "edited": false, "score": 0, "creation_date": 1499268120, "post_id": 44929659, "comment_id": 76836178, "body": "@S.H. Tough cookies :) This is why we shall not mix pointers and iterators. Slap the original dev"}], "tags": [], "owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "is_accepted": false, "score": 2, "last_activity_date": 1499266701, "last_edit_date": 1499266701, "creation_date": 1499266413, "answer_id": 44929659, "question_id": 44929500, "link": "https://stackoverflow.com/questions/44929500/how-to-get-a-stdlisttiterator-from-an-element-of-that-list/44929659#44929659", "title": "How to get a std::list&lt;T&gt;::iterator from an element of that list?", "body": "<p>Given a list, you can only get to anything by starting from one end walking through it, making sure you don't go beyond the end.</p>\n\n<pre><code>const_iterator it, end;\nfor( it = myList.begin(), end = myList.end(); it!=end &amp;&amp; it != &amp;myElement; ++it)\n{\n    // do nothing, for loop terminates if \"it\" points to \"myElem\"\n      // or if we don't find your element.\n}\n</code></pre>\n\n<p>Of course, you could use a standard algorithm, like <a href=\"http://en.cppreference.com/w/cpp/algorithm/find\" rel=\"nofollow noreferrer\">std::find</a> to look for it.</p>\n\n<p>Alternatively, you could keep hold of the iterator when you insert, and under many conditions it will still be valid later on.</p>\n\n<p>If you want lookup speed, you should probably use something other than a list.</p>\n\n<hr>\n\n<p>If you have something like</p>\n\n<pre><code>int x = 42;\nint * this_might_be_handy = &amp;x;\nmyList.insert(x);\n</code></pre>\n\n<p>myList now has a COPY of the number - it has the value 42, but in a different memory location.</p>\n\n<p>If you kept pointers to ints in the list, that would be different. getting the value from the <code>front</code> of the list and looking at the address will not give the same address as <code>x</code>.</p>\n\n<p>But you would have to manage them smartly.</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499266720, "post_id": 44929712, "comment_id": 76835129, "body": "Here&#39;s an interesting question - are we absolutely guaranteed that <code>listElement</code> will be a reference to the same object that&#39;s stored in the container?"}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1499266831, "post_id": 44929712, "comment_id": 76835231, "body": "@LightnessRacesinOrbit I know this was discussed at length somewhere here.  I seem to recall that the conclusion was that the standard does not guarantee it, however most people don&#39;t seem bothered by that."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1499266843, "post_id": 44929712, "comment_id": 76835244, "body": "Just looked at C++14 25.2.5/1 and it seems yes we are"}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499267053, "post_id": 44929712, "comment_id": 76835406, "body": "@LightnessRacesinOrbit I&#39;m not sure I understand your question since I don&#39;t see how your standard quote answers the question."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499267956, "post_id": 44929712, "comment_id": 76836069, "body": "It says: <i>&quot;The first iterator i in the range [first,last) for which the following corresponding conditions hold: *i == value, pred(*i) != false, pred(*i) == false&quot;</i> and <i>&quot;At most last - first applications of the corresponding predicate.&quot;</i> This means (I think) that all invocations of your predicate must be given the result of dereferencing an iterator from the container (and such a result is always a reference to the actual element). It means your answer is correct even at the super-nitpick level: congrats!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499268043, "post_id": 44929712, "comment_id": 76836119, "body": "Okay technically I suppose there could be <i>last - result</i> spurious invocations that give your predicate a reference to some arbitrary local <code>int</code>"}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499268293, "post_id": 44929712, "comment_id": 76836308, "body": "@LightnessRacesinOrbit ah, I see you meant whether <code>std::find</code> creates copies before passing the value to the predicate, which intuitively makes sense that algorithms try to avoid that whenever they can"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499269670, "post_id": 44929712, "comment_id": 76837298, "body": "That&#39;s the badger. Don&#39;t get me wrong, I can&#39;t see a reason any implementation would actually do this. But I like to be sure ;) (although if we&#39;re to be <i>entirely</i> sure we have to look at the source code, because bugs happen and not all impls even pretend to be word-for-word compliant in the first place!)"}], "tags": [], "owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "is_accepted": false, "score": 5, "last_activity_date": 1499266582, "creation_date": 1499266582, "answer_id": 44929712, "question_id": 44929500, "link": "https://stackoverflow.com/questions/44929500/how-to-get-a-stdlisttiterator-from-an-element-of-that-list/44929712#44929712", "title": "How to get a std::list&lt;T&gt;::iterator from an element of that list?", "body": "<p>a <code>std::list&lt;int&gt;::iterator</code> is not an <code>int*</code>, you need to access the element in the iterator and get its address.  Also, <code>std::find_if</code> takes care of most of the boilerplate for you.</p>\n\n<pre><code>auto iter = std:find_if(myList.begin(), myList.end(),\n                        [&amp;myElement](const int &amp; listElement)\n                        { return &amp;myElement == &amp;listElement; });\n</code></pre>\n\n<p>Writing the loop out yourself would look like:</p>\n\n<pre><code>auto iter = myList.end();\n\nfor(auto i = myList.begin(); i != myList.end(); ++i)\n    if(&amp;*i == &amp;myElement)\n    {\n        iter = i;\n        break;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "is_accepted": true, "score": 3, "last_activity_date": 1586095384, "last_edit_date": 1586095384, "creation_date": 1525271192, "answer_id": 50137092, "question_id": 44929500, "link": "https://stackoverflow.com/questions/44929500/how-to-get-a-stdlisttiterator-from-an-element-of-that-list/50137092#50137092", "title": "How to get a std::list&lt;T&gt;::iterator from an element of that list?", "body": "<p>This is actually a good question and IMHO a shame that there is no std way to do what OP has asked. If you understand that a list node looks essentially like this</p>\n\n<pre><code>struct list_node {\n    list_node* prev;\n    list_node* next;\n    T yourType;\n}\n</code></pre>\n\n<p>it is bad that there is no default way to get to the node (the iterator is a pointer to the node) if you have a pointer to <code>yourType</code> without searching through the whole container.</p>\n\n<hr>\n\n<p>Since std is not helping you have to get your hands dirty:</p>\n\n<pre><code>#include &lt;list&gt;\n#include &lt;iostream&gt;\n\n//This is essentially what you are looking for:\nstd::list&lt;int&gt;::iterator pointerToIter (int* myPointer) {\n    //Calculates the distance in bytes from an iterator itself\n    //to the actual type that is stored at the position the\n    //iterator is pointing to.\n    size_t iterOffset = (size_t)&amp;(*((std::list&lt;void*&gt;::iterator)nullptr));\n    //Subtract the offset from the passed pointer and make an\n    //iterator out of it\n    std::list&lt;int&gt;::iterator iter;\n    *(intptr_t*)&amp;iter = (intptr_t)myPointer - iterOffset;\n    //You are done\n    return iter;\n}\n\nint main () {\n    std::list&lt;int&gt; intList;\n    intList.push_back (10);\n    int* i1 = &amp;intList.back ();\n    intList.push_back (20);\n    intList.push_back (30);\n    int* i3 = &amp;intList.back ();\n    intList.push_back (40);\n    intList.push_back (50);\n    int* i5 = &amp;intList.back ();\n\n    std::cout &lt;&lt; \"Size: \" &lt;&lt; intList.size () &lt;&lt; \" | Content: \";\n    for (const int&amp; value : intList)\n        std::cout &lt;&lt; value &lt;&lt; \" \";\n    std::cout &lt;&lt; std::endl;\n\n    intList.erase (pointerToIter (i1));\n    intList.erase (pointerToIter (i3));\n    intList.erase (pointerToIter (i5));\n\n    std::cout &lt;&lt; \"Size: \" &lt;&lt; intList.size () &lt;&lt; \" | Content: \";\n    for (const int&amp; value : intList)\n        std::cout &lt;&lt; value &lt;&lt; \" \";\n    std::cout &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>Output (to prove that it works as intended):</p>\n\n<blockquote>\n  <p>Size: 5 | Content: 10 20 30 40 50<br>\n  Size: 2 | Content: 20 40</p>\n</blockquote>\n\n<p>This works perfectly even if an implementation of std::list would use a different layout for the list-node or add some more members to it. I also included the assembler code generated to see that the function is essentially reduced to <code>myPointer - 0x10</code> (<code>0x10 = 16</code> is the size of 2 pointers on a 64bit machine).</p>\n\n<p>Assembler (with at least -O1):</p>\n\n<pre><code>std::list&lt;int&gt;::iterator pointerToIter (int* myPointer) {\n   0:   48 8d 47 f0             lea    rax,[rdi-0x10]\n}\n   4:   c3                      ret    \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 1926545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d14fb7ce518a039fa76f30fa0bc8457?s=128&d=identicon&r=PG", "display_name": "jafma", "link": "https://stackoverflow.com/users/1926545/jafma"}, "is_accepted": false, "score": 0, "last_activity_date": 1558106865, "creation_date": 1558106865, "answer_id": 56189495, "question_id": 44929500, "link": "https://stackoverflow.com/questions/44929500/how-to-get-a-stdlisttiterator-from-an-element-of-that-list/56189495#56189495", "title": "How to get a std::list&lt;T&gt;::iterator from an element of that list?", "body": "<p>This is a dissected, formalized (C++11) and commented version of the very interesting solution of Xatian above. That solution is O(1) (that is one of the reasons it is so interesting), but it assumes some things that should be taken into account (Xatian's deep knowledge of the STL implementation of lists is the other reason why it is so interesting).</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;list&gt;\n#include &lt;cstdint&gt;\n\nint main(void)\n{\n    // ASSUMPTIONS:\n\n    //  1.- nullptr == 0\n    //  2.- A std::list iterator is an object that contains just one thing: a pointer to the body of the iterator.\n    //  3.- A std::list iterator has a constructor that admits a pointer to a body provided by the user, which creates the iterator with that (assumed) existing body.\n\n\n    using DataType = int;\n    using DataList = std::list&lt;DataType&gt;;\n\n    std::cout &lt;&lt; \"Nullptr= \" &lt;&lt; reinterpret_cast&lt;size_t&gt;(nullptr) &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Size of a pointer = \" &lt;&lt; sizeof(nullptr) &lt;&lt; \", size of iterator = \" &lt;&lt; sizeof(DataList::iterator) &lt;&lt; std::endl;\n\n    static_assert(reinterpret_cast&lt;size_t&gt;(nullptr) == 0,\n                \"In this compiler, nullptr is not 0 and this will not work\");\n\n\n    // we have a list filled with something.\n    DataList mylist{1,2,3,4};\n    // and an iterator pointing to some data.\n    DataList::iterator itaux{mylist.begin()};\n    ++itaux;\n    ++itaux;\n\n\n    // 1. calculate the offset of the data in a list iterator w.r.t. the beginning of the iterator body\n\n    DataList::iterator it{nullptr}; // call the iterator constructor. Nullptr becomes the address of the body where the iterator would store prev/next/data\n                                // since nullptr is assumed to be 0, this is the same as to declare an iterator with its body at 0x00000000\n    DataType &amp; itp = *it; // this is a reference to the user's data in the iterator body\n                      // that iterator is a fake and does not contain any data, but since we are only dealing with addresses, no problem...\n    DataType * aitp = &amp; itp; // this gets the address equivalent to the reference, which is at some point in memory from 0\n    size_t iteroffset = reinterpret_cast&lt;size_t&gt;(aitp); // That address becomes, actually, the offset of the data w.r.t. the beginning of the iterator body\n\n    std::cout &lt;&lt; \"Offset from iterator body start to data = \" &lt;&lt; iteroffset &lt;&lt; std::endl;\n\n\n    // 2. we can get the pointer to the data from our existing iterator\n    DataType * mypointer = &amp;(*itaux);\n\n    // 3. we can create a valid iterator from the pointer to the data\n    DataList::iterator iter;\n    *(reinterpret_cast&lt;intptr_t*&gt;(&amp;iter)) = reinterpret_cast&lt;intptr_t&gt;(mypointer) - iteroffset; // the address of the beginning of the body (mypointer-iteroffset) is stored into \n                                                                                                // the pointer to the body that the iterator actually is\n\n    std::cout &lt;&lt; \"pointed element: \" &lt;&lt; (*iter) &lt;&lt; std::endl;\n\n    return(0);\n}\n</code></pre>\n\n"}], "owner": {"reputation": 815, "user_id": 3442959, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2914aaad97291094f4ed8bb9863788cd?s=128&d=identicon&r=PG&f=1", "display_name": "S.H", "link": "https://stackoverflow.com/users/3442959/s-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5154, "favorite_count": 1, "accepted_answer_id": 50137092, "answer_count": 4, "score": 2, "last_activity_date": 1586095384, "creation_date": 1499266023, "last_edit_date": 1499266798, "question_id": 44929500, "link": "https://stackoverflow.com/questions/44929500/how-to-get-a-stdlisttiterator-from-an-element-of-that-list", "title": "How to get a std::list&lt;T&gt;::iterator from an element of that list?", "body": "<p>Given a std:: list </p>\n\n<pre><code>std::list&lt; int &gt; myList\n</code></pre>\n\n<p>and a reference (or a pointer) to an element in that list</p>\n\n<pre><code>int&amp; myElement    |     int* pElement\n</code></pre>\n\n<p>So, basically I know the address of that element</p>\n\n<p>How can I get an <code>std::list&lt;int&gt;::iterator</code> to that element efficiently?</p>\n\n<p>A slow yet working example is</p>\n\n<pre><code>const_iterator it\nfor( it = myList.begin(); it != &amp;myElement; ++it)\n{\n    // do nothing, for loop terminates if \"it\" points to \"myElem\"\n}\n</code></pre>\n\n<p>Is there a quicker way? like</p>\n\n<pre><code>const_iterator it = magicToIteratorConverter( myList, myElem )\n</code></pre>\n\n<h2>Case of vector (but I need list):</h2>\n\n<p>For a vector, you could do the following:</p>\n\n<pre><code>const int* pStart = &amp;myVector[0] // address of first element\nconst int* pElement = &amp;myElem; // address of my element\nconst idx = static_cast&lt; int &gt;( pElement- pStart ); // no need to divide by size of an elem\n\nstd::vector&lt; int &gt;::iterator it = myVector.begin() + idx;\n</code></pre>\n\n<h2>Case of std::list:</h2>\n"}, {"tags": ["c++", "qt", "qsystemtrayicon"], "comments": [{"owner": {"reputation": 444, "user_id": 1692322, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/24049b96337ad66faa6d54363a8b0fad?s=128&d=identicon&r=PG", "display_name": "samdavydov", "link": "https://stackoverflow.com/users/1692322/samdavydov"}, "edited": false, "score": 4, "creation_date": 1499266130, "post_id": 44929345, "comment_id": 76834576, "body": "Looks like you really create a new icon on every function call (new QSystemTrayIcon ... notiTray-&gt;show()). You can create it just once (as a class member) and get it&#39;s image updated when needed."}, {"owner": {"reputation": 21, "user_id": 8119838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b6bf1519f5eb6953517f7358ddfb9ad?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Robinson", "link": "https://stackoverflow.com/users/8119838/luke-robinson"}, "reply_to_user": {"reputation": 444, "user_id": 1692322, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/24049b96337ad66faa6d54363a8b0fad?s=128&d=identicon&r=PG", "display_name": "samdavydov", "link": "https://stackoverflow.com/users/1692322/samdavydov"}, "edited": false, "score": 0, "creation_date": 1499331418, "post_id": 44929345, "comment_id": 76863837, "body": "Perfect, Thank you!"}, {"owner": {"reputation": 21, "user_id": 8119838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b6bf1519f5eb6953517f7358ddfb9ad?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Robinson", "link": "https://stackoverflow.com/users/8119838/luke-robinson"}, "reply_to_user": {"reputation": 444, "user_id": 1692322, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/24049b96337ad66faa6d54363a8b0fad?s=128&d=identicon&r=PG", "display_name": "samdavydov", "link": "https://stackoverflow.com/users/1692322/samdavydov"}, "edited": false, "score": 0, "creation_date": 1499334569, "post_id": 44929345, "comment_id": 76866024, "body": "If you want to make your comment an answer I&#39;ll mark it as the answer. :)"}], "owner": {"reputation": 21, "user_id": 8119838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b6bf1519f5eb6953517f7358ddfb9ad?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Robinson", "link": "https://stackoverflow.com/users/8119838/luke-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499265610, "creation_date": 1499265610, "question_id": 44929345, "link": "https://stackoverflow.com/questions/44929345/qsystemtrayicon-keeps-creating-new-icons", "title": "QSystemTrayIcon keeps creating new icons", "body": "<p>I've created a notification system that makes use of QSystemTrayIcon to alert the user. My issue is that each time a user receives a notification it creates a new icon so the system tray ends up full of these icons. </p>\n\n<p>I develop the program on a Linux machine and the issue doesn't occur here. However, I build the program on Windows 7 which is where the program is actually used and where the issue arises. This makes testing tricky for me as I have to go through quite a lengthy process to even run the program on Windows. So I'm kind of hoping someone can spot the issue and tell me exactly what is wrong but I appreciate any input so please if you have any idea do tell.</p>\n\n<p>My code:</p>\n\n<pre><code>QSystemTrayIcon* notiTray = new QSystemTrayIcon(this);\nnotiTray-&gt;setIcon(QIcon(\":/icon.png\"));\nnotiTray-&gt;setVisible(true);\nnotiTray-&gt;showMessage(\"Notifications, \"You have new notifications\", QSystemTrayIcon::Information, 60000);\nnotiTray-&gt;show();\nQApplication::alert(this, 1000);\n</code></pre>\n\n<p>This code is inside an if statement inside a function that gets called every 5 seconds to check for new notifications.</p>\n\n<p>At a guess I'd say it might be because a new SystemTrayIcon is made everytime a notification arises but I'm not 100% and I was hoping anyone might be able to confirm this to save me from going through an awful process of testing it on Windows.</p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["c++", "linux", "daemon"], "comments": [{"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1499265533, "post_id": 44929223, "comment_id": 76834098, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/35705451/is-changing-parent-process-necessary-when-daemonize-a-process\">Is changing parent process necessary when daemonize a process?</a>"}, {"owner": {"reputation": 959, "user_id": 6751556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PbVfI.png?s=128&g=1", "display_name": "Suraj S", "link": "https://stackoverflow.com/users/6751556/suraj-s"}, "edited": false, "score": 2, "creation_date": 1499265660, "post_id": 44929223, "comment_id": 76834195, "body": "Haha! the title should be &#39;Daemonize&#39; not &#39;Demonize&#39;.!!!"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 2, "creation_date": 1499265745, "post_id": 44929223, "comment_id": 76834254, "body": "Because the angels are getting out of hand"}, {"owner": {"reputation": 3868, "user_id": 2589553, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/490f0b6836112dc8929c72ed3f03bf68?s=128&d=identicon&r=PG", "display_name": "duong_dajgja", "link": "https://stackoverflow.com/users/2589553/duong-dajgja"}, "edited": false, "score": 0, "creation_date": 1499266347, "post_id": 44929223, "comment_id": 76834787, "body": "Your answer might be <a href=\"https://stackoverflow.com/questions/958249/whats-the-difference-between-nohup-and-a-daemon\">What&#39;s the difference between nohup and a daemon?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "is_accepted": false, "score": 3, "last_activity_date": 1499266014, "creation_date": 1499266014, "answer_id": 44929497, "question_id": 44929223, "link": "https://stackoverflow.com/questions/44929223/why-should-i-use-fork-to-daemonize-my-process/44929497#44929497", "title": "Why should I use fork() to daemonize my process?", "body": "<p>TL;DR the <code>fork()</code> call is not needed, it just helps providing a nice UI for the users of the program.</p>\n\n<p>A daemon uses <code>fork()</code> to create a duplicate of it. The child process then keeps running (in the background). The parent process may produce some output (status) then it exits.</p>\n\n<p>Of course you can write only the child part of the program and launch it using the command line you posted:</p>\n\n<pre><code>$ nohup myprogram 1&gt;2 2&gt;/dev/null &amp;\n</code></pre>\n\n<p>But if <strong>you write</strong> the daemon and <strong>I have to use it</strong>, I certainly prefer to use a simpler command line, without all that scaffolding needed to put the program in background and ensure its output doesn't make it stop and so on:</p>\n\n<pre><code>$ myprogram        # there is no need for anything else\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3847069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3162068f651afd01d9bacde423143ef7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/3847069/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1499268280, "creation_date": 1499265355, "last_edit_date": 1499268280, "question_id": 44929223, "link": "https://stackoverflow.com/questions/44929223/why-should-i-use-fork-to-daemonize-my-process", "title": "Why should I use fork() to daemonize my process?", "body": "<p>According to my purpose, I just want to let my process be running in the background. Then I could write normal program and run it with the following command:\nnohup myprogram  1>2 2>/dev/null &amp;</p>\n\n<p>Then this program will be running in the background, just like as a daemon.</p>\n\n<p>With this way, I do not need to call fork() for running in background. \nSo my question is what is the difference to run program in background with the above command between using fork() function?</p>\n"}, {"tags": ["c++", "operator-overloading"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1499265193, "post_id": 44929103, "comment_id": 76833820, "body": "<i>unused parameter</i> is <i>typically</i> a warning, not an error. Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Most likely you didn&#39;t provide a definition for your operator overload."}, {"owner": {"reputation": 1075, "user_id": 4282604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ujVHc.png?s=128&g=1", "display_name": "robbie", "link": "https://stackoverflow.com/users/4282604/robbie"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1499265244, "post_id": 44929103, "comment_id": 76833864, "body": "@AlgirdasPreid\u017eius Whoops, sorry! I did mean warning. Also, if you check the code, I did provide a definition."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1499265306, "post_id": 44929103, "comment_id": 76833913, "body": "There is no <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> in the question. All the relevant code should be present in the question itself, and not in external links."}, {"owner": {"reputation": 11476, "user_id": 2790047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5a7631a67903295da25dabb94e1f51b?s=128&d=identicon&r=PG", "display_name": "jodag", "link": "https://stackoverflow.com/users/2790047/jodag"}, "edited": false, "score": 0, "creation_date": 1499265545, "post_id": 44929103, "comment_id": 76834107, "body": "Templated functions and methods can&#39;t be compiled separately. Move the definition of <code>operator&lt;&lt;</code> into the header file."}], "owner": {"reputation": 1075, "user_id": 4282604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ujVHc.png?s=128&g=1", "display_name": "robbie", "link": "https://stackoverflow.com/users/4282604/robbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "closed_date": 1499265238, "answer_count": 0, "score": 0, "last_activity_date": 1499265222, "creation_date": 1499265068, "last_edit_date": 1499265222, "question_id": 44929103, "link": "https://stackoverflow.com/questions/44929103/undefined-reference-to-operator-overload", "closed_reason": "Duplicate", "title": "undefined reference to operator&lt;&lt; overload", "body": "<p>I'm writing a simple complex number C++ implementation as practice for overloading <code>operator</code>s. One of the operators I simply cannot get past is <code>&lt;&lt;</code>. I get an undefined reference error to it whenever I try to call it. <a href=\"https://gist.github.com/robbie0630/0e4f5f884f899e2d7d8c595cb4bbdaf9\" rel=\"nofollow noreferrer\">Here</a> is a gist link to my code. I am compiling it with the following:</p>\n\n<pre><code>g++ -std=c++11 main.cpp complex.cpp -Wall -Wextra -o complex\n</code></pre>\n\n<p>In addition to the unused parameter warning in <code>main()</code>, I get the following:</p>\n\n<pre><code>/tmp/cc7qVwEF.o: In function `main':\nmain.cpp:(.text+0x1c5): undefined reference to `std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp; rob::operator&lt;&lt; &lt;char, std::char_traits&lt;char&gt; &gt;(std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp;, rob::Complex const&amp;)'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 8313, "user_id": 7621674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/323bed98b2e655d5fa9ac6d23a72b995?s=128&d=identicon&r=PG", "display_name": "m7913d", "link": "https://stackoverflow.com/users/7621674/m7913d"}, "edited": false, "score": 0, "creation_date": 1499265218, "post_id": 44928908, "comment_id": 76833842, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/44395296/not-able-to-get-transparent-qrubberband/44418167#44418167\" title=\"not able to get transparent qrubberband\">stackoverflow.com/questions/44395296/&hellip;</a>. Note that the question itself already contains a large part of a possible solution."}, {"owner": {"reputation": 31, "user_id": 4531358, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-bUVsA1duhSI/AAAAAAAAAAI/AAAAAAAAB4U/IC0rHFkhkr4/photo.jpg?sz=128", "display_name": "Sandip", "link": "https://stackoverflow.com/users/4531358/sandip"}, "reply_to_user": {"reputation": 8313, "user_id": 7621674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/323bed98b2e655d5fa9ac6d23a72b995?s=128&d=identicon&r=PG", "display_name": "m7913d", "link": "https://stackoverflow.com/users/7621674/m7913d"}, "edited": false, "score": 0, "creation_date": 1499265886, "post_id": 44928908, "comment_id": 76834365, "body": "@m7913d , QPalette don&#39;t have option of setColor.  //pal.setColor();"}, {"owner": {"reputation": 8313, "user_id": 7621674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/323bed98b2e655d5fa9ac6d23a72b995?s=128&d=identicon&r=PG", "display_name": "m7913d", "link": "https://stackoverflow.com/users/7621674/m7913d"}, "edited": false, "score": 0, "creation_date": 1499266416, "post_id": 44928908, "comment_id": 76834862, "body": "<code>QPalette</code> has a <a href=\"http://doc.qt.io/qt-5/qpalette.html#setColor-1\" rel=\"nofollow noreferrer\"><code>setColor</code></a> method, but you should also specify a <a href=\"http://doc.qt.io/qt-5/qpalette.html#ColorRole-enum\" rel=\"nofollow noreferrer\"><code>ColorRole</code></a>. Note that the duplicate question does not use <code>QPalette</code>, although it may be possible too."}, {"owner": {"reputation": 31, "user_id": 4531358, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-bUVsA1duhSI/AAAAAAAAAAI/AAAAAAAAB4U/IC0rHFkhkr4/photo.jpg?sz=128", "display_name": "Sandip", "link": "https://stackoverflow.com/users/4531358/sandip"}, "reply_to_user": {"reputation": 8313, "user_id": 7621674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/323bed98b2e655d5fa9ac6d23a72b995?s=128&d=identicon&r=PG", "display_name": "m7913d", "link": "https://stackoverflow.com/users/7621674/m7913d"}, "edited": false, "score": 0, "creation_date": 1499403334, "post_id": 44928908, "comment_id": 76900596, "body": "@m7913d,  Nope, I tried with   pal.setColor(QPalette::Highlight, QColor(128,128,255));    But  it still fill up full rect with color. I need only border to be set with color."}, {"owner": {"reputation": 8313, "user_id": 7621674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/323bed98b2e655d5fa9ac6d23a72b995?s=128&d=identicon&r=PG", "display_name": "m7913d", "link": "https://stackoverflow.com/users/7621674/m7913d"}, "edited": false, "score": 0, "creation_date": 1499413157, "post_id": 44928908, "comment_id": 76905138, "body": "You may need to set the brush to transparent. Nevertheless, the answer you created is a good solution."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 4531358, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-bUVsA1duhSI/AAAAAAAAAAI/AAAAAAAAB4U/IC0rHFkhkr4/photo.jpg?sz=128", "display_name": "Sandip", "link": "https://stackoverflow.com/users/4531358/sandip"}, "is_accepted": false, "score": 1, "last_activity_date": 1499406975, "creation_date": 1499406975, "answer_id": 44963469, "question_id": 44928908, "link": "https://stackoverflow.com/questions/44928908/qt-draw-rectangle-on-qgraphicsitem/44963469#44963469", "title": "QT Draw Rectangle on QGraphicsitem", "body": "<p>@m7913d, tons of thanks for your value added suggestion.\nI have Override QRubberBand class &amp;  set QRubberBand class setGeometry, setPen &amp; it's color.</p>\n\n<p>Here is final solution code :</p>\n\n<pre><code>class roiFrame : public QRubberBand\n{\npublic:\n    roiFrame(Shape s, QWidget * p = 0):QRubberBand(s, p){}\n    ~roiFrame(){}\nprotected:\n    void paintEvent(QPaintEvent *pe)\n    {\n        Q_UNUSED(pe);\n        QStyleOptionRubberBand opt;\n        QStylePainter painter(this);\n        opt.initFrom(this);\n        QRect rectangle(0,0,30, 15);\n        QColor color(Qt::green);\n        painter.setPen(color);\n        painter.drawRect(rectangle);\n    }\n};\n</code></pre>\n\n<p><strong>Caller code :</strong></p>\n\n<pre><code>_rectFrame = new roiFrame(QRubberBand::Rectangle, this);\n_rectFrame-&gt;setGeometry(QRect(thumbMousePos.x() -1, thumbMousePos.y() - 1, thumbMousePos.x() + 1, thumbMousePos.y() + 1).normalized());\n_rectFrame-&gt;setAutoFillBackground(false);\n_rectFrame-&gt;show();\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4531358, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-bUVsA1duhSI/AAAAAAAAAAI/AAAAAAAAB4U/IC0rHFkhkr4/photo.jpg?sz=128", "display_name": "Sandip", "link": "https://stackoverflow.com/users/4531358/sandip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1210, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499406975, "creation_date": 1499264542, "last_edit_date": 1499266082, "question_id": 44928908, "link": "https://stackoverflow.com/questions/44928908/qt-draw-rectangle-on-qgraphicsitem", "title": "QT Draw Rectangle on QGraphicsitem", "body": "<p><strong>My work Environment:</strong> Qt 5.8 MSVC2015 64bit, QT GraphicsView, QGraphicsObject, Windows 7 64 bit.</p>\n\n<p>In my application I have added multiple QGraphicsitem, into a single graphic scene &amp; into a single graphic view.</p>\n\n<p>But I need to draw empty green color rectangle on top of QGraphicsitem image, as per mouse position. \nSo I tried with below :</p>\n\n<pre><code>QRubberBand* _rubberBand = new QRubberBand(QRubberBand::Rectangle, this);\n_rubberBand-&gt;setGeometry(QRect(MousePos.x() -2, MousePos.y() - 2, MousePos.x() + 2, MousePos.y() + 2).normalized());\n_rubberBand-&gt;setAutoFillBackground(false);\nQPalette pal;\npal.setBrush(QPalette::Highlight, QBrush(Qt::green));\n_rubberBand-&gt;setPalette(pal);\n_rubberBand-&gt;show();\n</code></pre>\n\n<p>Issue with QRubberBand, it changes size dynamically, I want draw small rectangle,   not flickery RubberBand. </p>\n\n<p><strong>QRubberBand Output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/7Ob1f.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Ob1f.jpg\" alt=\"QRubberBand Code OutPut\"></a></p>\n\n<p><strong>Expected Output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Irqxf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Irqxf.jpg\" alt=\"Expected Output\"></a></p>\n"}, {"tags": ["c++", "floating-point", "int", "precision", "integer-division"], "comments": [{"owner": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "edited": false, "score": 0, "creation_date": 1499264586, "post_id": 44928863, "comment_id": 76833344, "body": "what do you get when you <code>std::cout &lt;&lt; c</code> in your first example?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1499264768, "post_id": 44928863, "comment_id": 76833488, "body": "Can&#39;t reproduce, <code>c</code> is 2.5 for me. The problem may be in how you check the value of <code>c</code>."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 3, "creation_date": 1499264789, "post_id": 44928863, "comment_id": 76833510, "body": "There&#39;s nothing in the first code sample you&#39;ve shown that would do this; the second code sample is nonsense, because it uses uninitialized variables. Provide the smallest code sample you can come up with that <b>compiles, runs, and shows the problem</b>."}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1499265717, "post_id": 44928863, "comment_id": 76834229, "body": "It means that c is not a number. So either you&#39;ve printed it out wrongly or your code is not the code you posted (or the compiler is bugged, which we can rule out)."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1499265035, "post_id": 44929039, "comment_id": 76833700, "body": "While this might answer the problem including an explanation of why/how this code is an answer would make it better."}], "tags": [], "owner": {"reputation": 1251, "user_id": 4762308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3b4ee4a5ebfa7828d481dbd5d8859167?s=128&d=identicon&r=PG&f=1", "display_name": "Minar Mnr", "link": "https://stackoverflow.com/users/4762308/minar-mnr"}, "is_accepted": false, "score": 1, "last_activity_date": 1499265232, "last_edit_date": 1499265232, "creation_date": 1499264897, "answer_id": 44929039, "question_id": 44928863, "link": "https://stackoverflow.com/questions/44928863/c-integer-division-to-float/44929039#44929039", "title": "C++ Integer Division to Float", "body": "<p>You have to initialize every variables like your first example and also assign values of each and every variables.<br>\nTry this :</p>\n\n<pre><code>int v;\nint e;\nint a;\nint c;\nfloat r;\n\n\n\na = 5;\nc = 2;\ne = 5;\nv = 2;\n\nr = ((float)e - v) / (float)a / c;\ncout &lt;&lt; r;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8739, "user_id": 5603247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c27998979eedac7a3737411e77b0bf4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/5603247/hans-olsson"}, "edited": false, "score": 0, "creation_date": 1499265528, "post_id": 44929253, "comment_id": 76834095, "body": "Note that you can even use float r= .... for the  last declaration and assignment."}, {"owner": {"reputation": 63, "user_id": 5861729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7812766c31377deefd6423561a54844f?s=128&d=identicon&r=PG&f=1", "display_name": "Misha", "link": "https://stackoverflow.com/users/5861729/misha"}, "reply_to_user": {"reputation": 8739, "user_id": 5603247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c27998979eedac7a3737411e77b0bf4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/5603247/hans-olsson"}, "edited": false, "score": 0, "creation_date": 1499266380, "post_id": 44929253, "comment_id": 76834817, "body": "@HansOlsson that&#39;s true! Although I expect them to have code to get the values for v, e, a, and c between the declaration of the values and the last line."}], "tags": [], "owner": {"reputation": 63, "user_id": 5861729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7812766c31377deefd6423561a54844f?s=128&d=identicon&r=PG&f=1", "display_name": "Misha", "link": "https://stackoverflow.com/users/5861729/misha"}, "is_accepted": false, "score": 2, "last_activity_date": 1554737580, "last_edit_date": 1554737580, "creation_date": 1499265423, "answer_id": 44929253, "question_id": 44928863, "link": "https://stackoverflow.com/questions/44928863/c-integer-division-to-float/44929253#44929253", "title": "C++ Integer Division to Float", "body": "<p>Try converting each variable to float, and see if that fixes the problem. Also, in your second example, you never initialize your variables, which causes an error because their value is undefined, it could be anything. You also forgot to include the variable c.</p>\n\n<p>See if this throws an error:</p>\n\n<pre><code>int v = 1;\nint e = 1;\nint a = 1;\nint c = 1;\nfloat r;\n\nr = ((float)e - (float)v) / (float)a / (float)c;\n</code></pre>\n\n<p>Also, for converting between types, I would recommend you use 'static_cast&lt;type>(variable)' instead of '(type)variable'. It is the recommended way to cast types in c++, and it also makes conversions easier to spot when debugging. Your code would look like this:</p>\n\n<pre><code>int v = 1;\nint e = 1;\nint a = 1;\nint c = 1;\nfloat r;\n\nr = (static_cast&lt;float&gt;(e) - static_cast&lt;float&gt;(v)) / static_cast&lt;float&gt;(a) / static_cast&lt;float&gt;(c);\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8259662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc3bb38f7c5ce217ca0374b224701253?s=128&d=identicon&r=PG&f=1", "display_name": "Superrbo", "link": "https://stackoverflow.com/users/8259662/superrbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6458, "favorite_count": 0, "closed_date": 1499267309, "answer_count": 2, "score": 0, "last_activity_date": 1554737580, "creation_date": 1499264438, "last_edit_date": 1499266905, "question_id": 44928863, "link": "https://stackoverflow.com/questions/44928863/c-integer-division-to-float", "closed_reason": "Not suitable for this site", "title": "C++ Integer Division to Float", "body": "<p>My C++ program takes in three integer inputs and does some computations including division. At first, the end result was not a decimal. After searching a little on Stack Overflow (<a href=\"https://stackoverflow.com/questions/12447325/dividing-two-integers-to-produce-a-float-result\">Dividing two integers to produce a float result</a>), I found out that I'm supposed to add a (float), like this:</p>\n\n<pre><code>int a;\nint b;\nfloat c;\n\na = 5;\nb = 2;\n\nc = (float)a / b;\n</code></pre>\n\n<p>So I tried that but I ended up with my result being -nan(ind). First off, what does that mean? And second, how do I make my program work?</p>\n\n<p>Here is the math I am trying to do in my program by the way.</p>\n\n<pre><code>int v;\nint e;\nint a;\nfloat r;\n\nr = ((float)e - v) / ((float)a / 1000);\n</code></pre>\n\n<p><strong>Edit:</strong> Sorry, my mistake. I meant to type 1000 in the second example, not c.</p>\n"}, {"tags": ["c++", "opengl", "matrix"], "comments": [{"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1499264576, "post_id": 44928859, "comment_id": 76833333, "body": "Doesn&#39;t GLSL provide a <code>lookAt</code> function?  Is there a reason you are doing this by hand instead of letting the shader handle the calculation?"}, {"owner": {"reputation": 143, "user_id": 4617817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/18d97c7cebffa4112afbed5bfbabe99a?s=128&d=identicon&r=PG", "display_name": "Daan Meijer", "link": "https://stackoverflow.com/users/4617817/daan-meijer"}, "reply_to_user": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1499264754, "post_id": 44928859, "comment_id": 76833476, "body": "@0x5453 To save the shader from calculating so much and trying to figure out how the lookat matrix works."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 6, "creation_date": 1499264856, "post_id": 44928859, "comment_id": 76833567, "body": "@0x5453: &quot;<i>Doesn&#39;t GLSL provide a lookAt function?</i>&quot; No, it does not."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "reply_to_user": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 2, "creation_date": 1499264937, "post_id": 44928859, "comment_id": 76833630, "body": "@0x5453 glsl certainly doesnt, but there are opengl centric libraries that do, <a href=\"https://glm.g-truc.net/0.9.2/api/a00245.html\" rel=\"nofollow noreferrer\">glm</a> being one of them, and since its on github i suggest OP take a look at <a href=\"https://github.com/g-truc/glm/blob/master/glm/gtc/matrix_transform.inl#L511\" rel=\"nofollow noreferrer\">its implementation</a>"}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1499266629, "post_id": 44928859, "comment_id": 76835042, "body": "@Borgleader Ahh yes, glm is what I was thinking of."}, {"owner": {"reputation": 20114, "user_id": 691711, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/bf26891a2ec4eca6dd1962a6804f5a40?s=128&d=identicon&r=PG", "display_name": "zero298", "link": "https://stackoverflow.com/users/691711/zero298"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1499282860, "post_id": 44928859, "comment_id": 76844926, "body": "@Rabbid76 Your link is a link to this exact question.  Did you mis-paste?"}, {"owner": {"reputation": 143, "user_id": 4617817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/18d97c7cebffa4112afbed5bfbabe99a?s=128&d=identicon&r=PG", "display_name": "Daan Meijer", "link": "https://stackoverflow.com/users/4617817/daan-meijer"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1499284605, "post_id": 44928859, "comment_id": 76845933, "body": "@Rabbid76 I thought the up direction was positive y to move up wasn&#39;t it? And my projection matrix couldn&#39;t be the problem since it works fine with a view matrix with only a translation."}, {"owner": {"reputation": 143, "user_id": 4617817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/18d97c7cebffa4112afbed5bfbabe99a?s=128&d=identicon&r=PG", "display_name": "Daan Meijer", "link": "https://stackoverflow.com/users/4617817/daan-meijer"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1499284836, "post_id": 44928859, "comment_id": 76846067, "body": "@Rabbid76 Indeed."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 1, "creation_date": 1499302620, "post_id": 44928859, "comment_id": 76852636, "body": "How do you pass a Matrix4f to OpenGL? What is the conception behind matrix multiplication? I mean, is a point transformed by <code>M*p</code> or <code>p*M</code>? How do you use the result of <code>lookAt</code>? I mean, is it the matrix of the camera, or is it the inverse of it? We need to know these things to answer this question."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1499379431, "post_id": 44928859, "comment_id": 76894856, "body": "One piece still missing: the <code>operator*</code>, which is used to multiply two matrices together. But, if it has a sane implementation, that I don&#39;t know what could be the problem here. You have a row-major <code>Matrix4f</code>. <code>lookAt</code> returns the inverse camera matrix. It is all fine."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1499379545, "post_id": 44928859, "comment_id": 76894904, "body": "However, looking at the animation... is the camera field of view animated? It looks like as if it were changing"}, {"owner": {"reputation": 143, "user_id": 4617817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/18d97c7cebffa4112afbed5bfbabe99a?s=128&d=identicon&r=PG", "display_name": "Daan Meijer", "link": "https://stackoverflow.com/users/4617817/daan-meijer"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1499697288, "post_id": 44928859, "comment_id": 77003439, "body": "@geza No it&#39;s not animated I was moving around to see how it deformed"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 4617817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/18d97c7cebffa4112afbed5bfbabe99a?s=128&d=identicon&r=PG", "display_name": "Daan Meijer", "link": "https://stackoverflow.com/users/4617817/daan-meijer"}, "edited": false, "score": 0, "creation_date": 1499266650, "post_id": 44929385, "comment_id": 76835060, "body": "Good catch!. But indeed isn&#39;t the only problem."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 143, "user_id": 4617817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/18d97c7cebffa4112afbed5bfbabe99a?s=128&d=identicon&r=PG", "display_name": "Daan Meijer", "link": "https://stackoverflow.com/users/4617817/daan-meijer"}, "edited": false, "score": 0, "creation_date": 1499268852, "post_id": 44929385, "comment_id": 76836694, "body": "Can you please update the picture. What&#39;s wrong with it currently?"}], "tags": [], "owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "is_accepted": false, "score": 3, "last_activity_date": 1499265699, "creation_date": 1499265699, "answer_id": 44929385, "question_id": 44928859, "link": "https://stackoverflow.com/questions/44928859/incorrect-lookat-matrix/44929385#44929385", "title": "Incorrect lookat matrix", "body": "<p>You need to normalize s before u is calculated. I'm not sure if it is the only problem</p>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 4617817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/18d97c7cebffa4112afbed5bfbabe99a?s=128&d=identicon&r=PG", "display_name": "Daan Meijer", "link": "https://stackoverflow.com/users/4617817/daan-meijer"}, "edited": false, "score": 0, "creation_date": 1499286164, "post_id": 44932189, "comment_id": 76846863, "body": "What are the variables p and t?"}, {"owner": {"reputation": 143, "user_id": 4617817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/18d97c7cebffa4112afbed5bfbabe99a?s=128&d=identicon&r=PG", "display_name": "Daan Meijer", "link": "https://stackoverflow.com/users/4617817/daan-meijer"}, "edited": false, "score": 0, "creation_date": 1499287541, "post_id": 44932189, "comment_id": 76847563, "body": "It&#39;s seems to be working better <a href=\"https://media.giphy.com/media/QrMnqBBJZuATu/giphy.gif\" rel=\"nofollow noreferrer\">media.giphy.com/media/QrMnqBBJZuATu/giphy.gif</a>"}, {"owner": {"reputation": 143, "user_id": 4617817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/18d97c7cebffa4112afbed5bfbabe99a?s=128&d=identicon&r=PG", "display_name": "Daan Meijer", "link": "https://stackoverflow.com/users/4617817/daan-meijer"}, "edited": false, "score": 0, "creation_date": 1499288250, "post_id": 44932189, "comment_id": 76847934, "body": "It&#39;s not quite what I expected. What I want is to be able to make the lookAt matrix work(Or perhaps the functions around it that might not work) so I&#39;m able to construct environment for rendering a shadow map."}], "tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": false, "score": 3, "last_activity_date": 1536400750, "last_edit_date": 1536400750, "creation_date": 1499274446, "answer_id": 44932189, "question_id": 44928859, "link": "https://stackoverflow.com/questions/44928859/incorrect-lookat-matrix/44932189#44932189", "title": "Incorrect lookat matrix", "body": "<p>If your positions (<code>position</code>, <code>center</code>) and the <code>up</code> vector are in viewport space, then the Z-Axis of the view matrix is the inverse line of sight and the Y-Axis is the up vector. See the following code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/c9lGc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c9lGc.png\" alt=\"\"></a></p>\n\n<pre><code>Matrix4f Matrix4f::lookAt(const Vector3f&amp; position, const Vector3f&amp; center, const Vector3f&amp; up)\n{\n    Matrix4f out(1.0f); // I suppose this initilizes a 4*4 identity matrix\n\n    // Z-Axis is the line of sight\n    Vector3f z = position.substract(center).normalize(); // inverse line of sight\n\n    // Y-Axis is the up vector\n    Vector3f y = up;\n\n    // X-Axis is the cross product of Y-Axis and Z-Axis\n    Vector3f x = y.cross(z).normalize();\n\n    // orthonormalize the Y-Axis\n    y = z.cross( x );\n\n    out.mElements[0*4 + 0] = x.x;\n    out.mElements[0*4 + 1] = x.y;\n    out.mElements[0*4 + 2] = x.z;\n\n    out.mElements[1*4 + 0] = y.x;\n    out.mElements[1*4 + 1] = y.y;\n    out.mElements[1*4 + 2] = y.z;\n\n    out.mElements[2*4 + 0] = z.x;\n    out.mElements[2*4 + 1] = z.y;\n    out.mElements[2*4 + 2] = z.z;\n\n    return (out * Matrix4f::translation(Vector3f(-position.x, -position.y, -position.z)));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 1, "creation_date": 1499352267, "post_id": 44950323, "comment_id": 76879466, "body": "No needed trigonometry. And you may incur in sign issues. Your first approach was good, with the normalize-fix. Just that you defined a row-order matrix, instead of a col-order one, which is what OpenGL uses. Anyhow, your picture seems good, except for perhaps a triangle, closer to the camera, hidding the rest. Also, yes, <code>position</code> is where the camera is and <code>center</code> is where the camera looks at, both in world-coordinates."}], "tags": [], "owner": {"reputation": 143, "user_id": 4617817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/18d97c7cebffa4112afbed5bfbabe99a?s=128&d=identicon&r=PG", "display_name": "Daan Meijer", "link": "https://stackoverflow.com/users/4617817/daan-meijer"}, "is_accepted": true, "score": 1, "last_activity_date": 1499347632, "creation_date": 1499347632, "answer_id": 44950323, "question_id": 44928859, "link": "https://stackoverflow.com/questions/44928859/incorrect-lookat-matrix/44950323#44950323", "title": "Incorrect lookat matrix", "body": "<p>After hours of trying to make the lookat matrix working I had given up on way of constructing the lookat matrix, instead I constructed a lookat matrix based on the position of the camera and position the camera should look at, using trigonometry functions I was able to create the result which I was seeking.</p>\n\n<p>My current way of constructing a lookat matrix:</p>\n\n<pre><code>Matrix4f Matrix4f::lookAt(const Vector3f&amp; position, const Vector3f&amp; center) {\n        Vector3f deltaVector = (position - center).normalize();\n\n        fl32 yaw = (fl32)radToDeg(atan(deltaVector.x / deltaVector.z));\n        fl32 pitch = (fl32)radToDeg(acos(Vector2f(deltaVector.x, deltaVector.z).magnitude()));\n\n        if (deltaVector.z &gt; 0)\n            yaw = yaw - 180.0f;\n\n        Matrix4f yRotation = Matrix4f::rotation(Vector3f(0.0f, 1.0f, 0.0f), -yaw);\n        Matrix4f xRotation = Matrix4f::rotation(Vector3f(1.0f, 0.0f, 0.0f), pitch);\n\n        Matrix4f translation = Matrix4f::translation(position);\n\n        return (translation * (yRotation * xRotation));\n    }\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4617817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/18d97c7cebffa4112afbed5bfbabe99a?s=128&d=identicon&r=PG", "display_name": "Daan Meijer", "link": "https://stackoverflow.com/users/4617817/daan-meijer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "accepted_answer_id": 44950323, "answer_count": 3, "score": 3, "last_activity_date": 1536400750, "creation_date": 1499264433, "last_edit_date": 1499335975, "question_id": 44928859, "link": "https://stackoverflow.com/questions/44928859/incorrect-lookat-matrix", "title": "Incorrect lookat matrix", "body": "<p>I've started working on shadow maps for directional lights and for that I need a lookAt matrix, but when I tried constructing from example of an online tutorial it looked something like this:</p>\n\n<p><a href=\"https://image.prntscr.com/image/uUCk4rlIQoGnmROehxT2kA.png\" rel=\"nofollow noreferrer\"><img src=\"https://image.prntscr.com/image/uUCk4rlIQoGnmROehxT2kA.png\" alt=\"enter image description here\"></a></p>\n\n<p>It currently looks like this:\n<a href=\"https://media.giphy.com/media/QrMnqBBJZuATu/giphy.gif\" rel=\"nofollow noreferrer\">https://media.giphy.com/media/QrMnqBBJZuATu/giphy.gif</a></p>\n\n<p>I've tried multiple ways of constructing it but with no success, I checked if the normalization, cross and translation functions weren't correct but that wasn't the case. I've also tried changing from column-major matrices to row-major matrices but with no luck. Would someone be able to point out what I did wrong?</p>\n\n<p>Lookat matrix constructing:</p>\n\n<p>Center vector = (0, 0, 0),\nUp vector = (0, 1, 0)</p>\n\n<pre><code>Matrix4f Matrix4f::lookAt(const Vector3f&amp; position, const Vector3f&amp; center, const Vector3f&amp; up) {\n        Matrix4f out(1.0f); \n\n        Vector3f z = position.substract(center).normalize(); \n\n\n        Vector3f y = up;\n\n        Vector3f x = y.cross(z).normalize();\n\n        y = z.cross(x);\n\n        out.mElements[0 * 4 + 0] = x.x;\n        out.mElements[0 * 4 + 1] = x.y;\n        out.mElements[0 * 4 + 2] = x.z;\n\n        out.mElements[1 * 4 + 0] = y.x;\n        out.mElements[1 * 4 + 1] = y.y;\n        out.mElements[1 * 4 + 2] = y.z;\n\n        out.mElements[2 * 4 + 0] = z.x;\n        out.mElements[2 * 4 + 1] = z.y;\n        out.mElements[2 * 4 + 2] = z.z;\n\n        return (out * Matrix4f::translation(Vector3f(-position.x, -position.y, -position.z)));\n    }\n}\n</code></pre>\n\n<p>Credit for code: <a href=\"https://stackoverflow.com/users/5577765/rabbid76\">https://stackoverflow.com/users/5577765/rabbid76</a></p>\n\n<p>This is how I pass a matrix to the shader:</p>\n\n<pre><code>void Shader::setMat4(const char* name, const math::Matrix4f&amp; matrix){\n    glUniformMatrix4fv(getUniformLocation(name), 1, GL_TRUE, matrix.mElements);\n}\n</code></pre>\n\n<p>After I've calculated the lookAt matrix I directly pass it to the vertex shader to the uniform: <code>view</code> and calculate a point like this:</p>\n\n<pre><code>gl_Position = projection * view * model * vec4(vertexPosition, 1.0);\n</code></pre>\n\n<p>And this is how my matrix multiplication works:</p>\n\n<pre><code>Matrix4f Matrix4f::multiply(const Matrix4f&amp; other) const {\n    Matrix4f out;\n    for (int y = 0; y &lt; 4; y++) {\n        for (int x = 0; x &lt; 4; x++) {\n            fl32 o = 0;\n            for (int c = 0; c &lt; 4; c++) {\n                o += this-&gt;mElements[c + y * 4] * other.mElements[x + c * 4];                   }\n            out.mElements[x + y * 4] = o;\n        }\n    }\n    return out;\n}\n</code></pre>\n\n<p>Edit: updated picture\nEdit: Added a more detailed description</p>\n"}, {"tags": ["android", "c++", "qt", "c++11", "build"], "comments": [{"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1499266413, "post_id": 44928792, "comment_id": 76834855, "body": "Do the warnings come from the build tools, or from Qt Creator itself? If it&#39;s the latter, they are inconsequential."}, {"owner": {"reputation": 131, "user_id": 7850797, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/646cecbdd8472ce53970d0550dffb5d8?s=128&d=identicon&r=PG&f=1", "display_name": "no_ideaw", "link": "https://stackoverflow.com/users/7850797/no-ideaw"}, "reply_to_user": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1499267126, "post_id": 44928792, "comment_id": 76835464, "body": "@KubaOber i don&#39;t know! :("}, {"owner": {"reputation": 5281, "user_id": 1495627, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/05f7c73495dfcdc1b6b32b30fdb994f0?s=128&d=identicon&r=PG", "display_name": "Jean-Micha&#235;l Celerier", "link": "https://stackoverflow.com/users/1495627/jean-micha%c3%abl-celerier"}, "edited": false, "score": 0, "creation_date": 1499274327, "post_id": 44928792, "comment_id": 76840154, "body": "&quot;These are not just nonsignificant warnings! These are really important problems because Qt creator can&#39;t import Qt quick. Thus, my application won&#39;t have any visual object&quot;  I have the same warnings but my qtquick objects correctly show up so I think that you can safely ignore them."}, {"owner": {"reputation": 131, "user_id": 7850797, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/646cecbdd8472ce53970d0550dffb5d8?s=128&d=identicon&r=PG&f=1", "display_name": "no_ideaw", "link": "https://stackoverflow.com/users/7850797/no-ideaw"}, "reply_to_user": {"reputation": 5281, "user_id": 1495627, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/05f7c73495dfcdc1b6b32b30fdb994f0?s=128&d=identicon&r=PG", "display_name": "Jean-Micha&#235;l Celerier", "link": "https://stackoverflow.com/users/1495627/jean-micha%c3%abl-celerier"}, "edited": false, "score": 0, "creation_date": 1499281928, "post_id": 44928792, "comment_id": 76844339, "body": "@Jean-Micha&#235;lCelerier but they don&#39;t show up for me. just a white screen shows up."}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1499354311, "post_id": 44928792, "comment_id": 76881009, "body": "Where exactly do the warnings show up? Give us a screenshot."}], "owner": {"reputation": 131, "user_id": 7850797, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/646cecbdd8472ce53970d0550dffb5d8?s=128&d=identicon&r=PG&f=1", "display_name": "no_ideaw", "link": "https://stackoverflow.com/users/7850797/no-ideaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499264611, "creation_date": 1499264302, "last_edit_date": 1499264611, "question_id": 44928792, "link": "https://stackoverflow.com/questions/44928792/qt-errors-while-building-app", "title": "Qt errors while building app", "body": "<p>When I <strong>attempt</strong> to build my project for android, these errors occurs:</p>\n\n<pre><code>Warning: QML import could not be resolved in any of the import paths: QtQuick.Extras.Private.CppUtils\nWarning: QML import could not be resolved in any of the import paths: QtQuick.Extras.Private.CppUtils\nWarning: QML import could not be resolved in any of the import paths: QtQuick.Controls.Material.impl\nWarning: QML import could not be resolved in any of the import paths: QtQuick.Controls.impl\nWarning: QML import could not be resolved in any of the import paths: QtQuick.Controls.Universal.impl\n</code></pre>\n\n<p>These are not just nonsignificant warnings! These are really important problems because Qt creator can't import Qt quick.\nThus, my application won't have any visual object.\nHow can I solve this error?\nAlso this is .pro file of my project:</p>\n\n<pre><code>QT += qml quick\nCONFIG += c++11\nSOURCES += main.cpp \\\n    downloader.cpp \\\n    filemanager.cpp\nHEADERS += \\\n    downloader.h \\\n    filemanager.h\nRESOURCES += qml.qrc\nQT += network\nQT += xml\nQT += gui\nQML_IMPORT_PATH = /home/muhammad/Qt5.9.0/5.9/android_armv7/qml/\n#QML_DESIGNER_IMPORT_PATH =\nDEFINES += QT_DEPRECATED_WARNINGS\nqnx: target.path = /tmp/$${TARGET}/bin\nelse: unix:!android: target.path = /opt/$${TARGET}/bin\n!isEmpty(target.path): INSTALLS += target\nDISTFILES += \\\n    android/AndroidManifest.xml \\\n    android/gradle/wrapper/gradle-wrapper.jar \\\n    android/gradlew \\\n    android/res/values/libs.xml \\\n    android/build.gradle \\\n    android/gradle/wrapper/gradle-wrapper.properties \\\n    android/gradlew.bat \\\n    android/AndroidManifest.xml \\\n    android/gradle/wrapper/gradle-wrapper.jar \\\n    android/gradlew \\\n    android/res/values/libs.xml \\\n    android/build.gradle \\\n    android/gradle/wrapper/gradle-wrapper.properties \\\n    android/gradlew.bat\nANDROID_PACKAGE_SOURCE_DIR = $$PWD/android\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "resources", "directx-9"], "comments": [{"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1499453282, "post_id": 44928781, "comment_id": 76930687, "body": "Why are you using legacy Direct3D 9 if you are on Windows 8.1? Remember that <code>D3DX9</code> is deprecated, as is the DirectX SDK itself. If you are going to use the legacy DirectX SDK with VS 2017, be sure to read the bottom of the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ee663275.aspx\" rel=\"nofollow noreferrer\">MSDN page</a> for details on properly setting up the include/lib paths to mix an old DXSDK with the newer Windows 10 SDK you are using. See also <a href=\"https://blogs.msdn.microsoft.com/chuckw/2013/08/20/living-without-d3dx/\" rel=\"nofollow noreferrer\">Living without D3DX</a>."}], "answers": [{"tags": [], "owner": {"reputation": 480, "user_id": 5352316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-oK2QOTNvYFc/AAAAAAAAAAI/AAAAAAAAAII/h1l0UWM2OoI/photo.jpg?sz=128", "display_name": "TrisT", "link": "https://stackoverflow.com/users/5352316/trist"}, "is_accepted": true, "score": 1, "last_activity_date": 1499372679, "last_edit_date": 1499372679, "creation_date": 1499282336, "answer_id": 44934367, "question_id": 44928781, "link": "https://stackoverflow.com/questions/44928781/compiling-with-font-resource/44934367#44934367", "title": "Compiling with font resource", "body": "<p>(Read the answer until the end, or you'll waste a lot of time.)</p>\n\n<p>I got it. I had read over <a href=\"http://www.codeguru.com/cpp/g-m/gdi/fonthandlinganddetection/article.php/c16019/How-to-Use-a-Font-Without-Installing-It.htm\" rel=\"nofollow noreferrer\">this</a> blog post.</p>\n\n<blockquote>\n  <p>Here is an example on how to use AddFontMemResourceEx on a font file embedded in the resource.</p>\n</blockquote>\n\n<pre><code>HINSTANCE hResInstance = AfxGetResourceHandle( ); //Read the edit\n\nHRSRC res = FindResource(\n    hResInstance, \n    MAKEINTRESOURCE(IDR_MYFONT),\n    L\"BINARY\"  //Read The Edit\n); \nif (res) \n{\n    HGLOBAL mem = LoadResource(hResInstance, res);\n    void *data = LockResource(mem);\n    size_t len = SizeofResource(hResInstance, res);\n\n    DWORD nFonts;\n    m_fonthandle = AddFontMemResourceEx(\n        data,       // font resource\n        len,       // number of bytes in font resource \n        NULL,          // Reserved. Must be 0.\n        &amp;nFonts      // number of fonts installed\n        );\n\n    if(m_fonthandle==0)\n    {\n        MessageBox(L\"Font add fails\", L\"Error\");\n    }\n}\n</code></pre>\n\n<p><s>Though you need afxwin.h</s>, and from <a href=\"https://stackoverflow.com/questions/5543523/afxwin-h-file-is-missing-in-vc-express-edition\">here</a>:</p>\n\n<blockquote>\n  <p>afxwin.h is MFC and MFC is not included in the free version of VC++\n  (Express Edition)</p>\n</blockquote>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>You do not need to use <code>AfxGetResourceHandle</code> (why you would need <code>afxwin.h</code>), you can simply do: </p>\n\n<pre><code>HINSTANCE hResInstance = (HINSTANCE)GetModuleHandle(NULL);\n</code></pre>\n\n<p>And in <code>FindResource</code>, the 3rd parameter should be <code>RT_FONT</code>, and so you'd get:</p>\n\n<pre><code>HRSRC res = FindResource(hResInstance, MAKEINTRESOURCE(IDR_FONT1), RT_FONT);\n</code></pre>\n"}], "owner": {"reputation": 480, "user_id": 5352316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-oK2QOTNvYFc/AAAAAAAAAAI/AAAAAAAAAII/h1l0UWM2OoI/photo.jpg?sz=128", "display_name": "TrisT", "link": "https://stackoverflow.com/users/5352316/trist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2298, "favorite_count": 1, "accepted_answer_id": 44934367, "answer_count": 1, "score": 1, "last_activity_date": 1499372679, "creation_date": 1499264275, "last_edit_date": 1499265673, "question_id": 44928781, "link": "https://stackoverflow.com/questions/44928781/compiling-with-font-resource", "title": "Compiling with font resource", "body": "<p>I'm on windows 8.1, visual studio 2017.</p>\n\n<p>I'm using this pricedown font in a directx project I'm working on.</p>\n\n<p>I load it with <code>AddFontResourceEx</code> and create a font for it with <code>D3DXCreateFont</code>.</p>\n\n<p>When I hit \"Local Windows Debugger\" everything is fine, font renders. Be it in release or in debug mode.\nProblem arises when I go through any executable, it never renders said font, be it release or debug.</p>\n\n<p>So I went reading, I read the articles on msdn, <a href=\"https://msdn.microsoft.com/en-us/library/6e7446zd.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">this one</a> and others whenever needed.</p>\n\n<p>I don't think I'm doing anything wrong, my Resource View looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0t53e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0t53e.png\" alt=\"Resource View\"></a></p>\n\n<p>, and IDR_FONT1 looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yvza6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yvza6.png\" alt=\"enter image description here\"></a></p>\n\n<p>The file is automatically loaded into the solution explorer (I didn't add it, VS did from the Resource.rc file), as you can see here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pgxIa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pgxIa.png\" alt=\"enter image description here\"></a></p>\n\n<p>With these proprieties:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ytFEU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ytFEU.png\" alt=\"enter image description here\"></a></p>\n\n<p>I add it like so:</p>\n\n<pre><code>AddFontResourceEx(\"pricedown.ttf\", FR_PRIVATE, 0);\nthis-&gt;createFont(\"Pricedown\", 60, true, false);\n</code></pre>\n\n<p>Where createfont is my function to add the font (stripped down, it has arrays):</p>\n\n<pre><code>bool    D3D9Render::createFont(char *name, int size, bool bold, bool italic)\n{\n    D3DXCreateFont(m_pD3dDev, size, 0, (bold) ? FW_BOLD : FW_NORMAL, 0, (italic) ? 1 : 0, DEFAULT_CHARSET, OUT_DEFAULT_PRECIS, ANTIALIASED_QUALITY, DEFAULT_PITCH, name, &amp;m_pFont);\n    return true;\n}\n</code></pre>\n\n<p>I'm compiling it as x64 release.</p>\n\n<p>As I've said, it works and renders the font when I press \"Local Windows Debugger\" (in any mode including x64 release), but when I go to <code>project/x64/Release</code>, it just won't render the font. Even the executable size is adequate.</p>\n\n<p><code>GetLastError</code> on the <code>AddFontResource</code> is 2 (ERROR_FILE_NOT_FOUND)</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c++", "function"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1499264140, "post_id": 44928690, "comment_id": 76832933, "body": "Check your code base for <code>#define _API8810AFUNC</code>.  It should be defined as something(possible nothing, whitspace)."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1499264249, "post_id": 44928690, "comment_id": 76833054, "body": "Some implementations or external tools like to define empty <code>#define</code> names to &quot;tag&quot; certain variables or functions. Other times, they use defines as alias for compiler intrinsics."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1499265328, "post_id": 44928690, "comment_id": 76833938, "body": "Seriously. Google. Please."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1499265754, "post_id": 44928690, "comment_id": 76834259, "body": "<a href=\"https://stackoverflow.com/questions/37487907/macro-in-class-definition/37488286\">Related</a> (that one is about <code>dllexport</code>ed classes)."}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 1, "last_activity_date": 1499265298, "last_edit_date": 1499265298, "creation_date": 1499264330, "answer_id": 44928804, "question_id": 44928690, "link": "https://stackoverflow.com/questions/44928690/extra-underscored-name-in-a-c-function/44928804#44928804", "title": "Extra underscored name in a c++ function", "body": "<p>It depends.</p>\n\n<p>In this case, it's a macro &mdash; and one with an illegal name, to boot* &mdash; that expands to <code>__declspec(dllexport)</code>. We can easily Google this to find that <a href=\"https://msdn.microsoft.com/en-us/library/3y1sfaz2.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">it's a Microsoft <em>attribute</em> for use with DLLs</a>.</p>\n\n<p>It could also have expanded [conditionally] to nothing, or it could have expanded to a different attribute, or it could expand to a storage class specifier (like <code>static</code> or <code>extern</code>).</p>\n\n<p>To directly answer your question, the actual syntax of a function definition, per C++14, is as follows:</p>\n\n<p><em>function-definition</em>:<br>\n&nbsp;&nbsp;&nbsp;<em>attribute-specifier-seq<sub>opt</sub> decl-specifier-seq<sub>opt</sub> declarator virt-specifier-seq<sub>opt</sub> function-body</em><br>\n<em>function-body</em>:<br>\n&nbsp;&nbsp;&nbsp;<em>ctor-initializer<sub>opt</sub> compound-statement</em><br>\n&nbsp;&nbsp;&nbsp;<em>function-try-block</em><br>\n&nbsp;&nbsp;&nbsp;<code>= default ;</code><br>\n&nbsp;&nbsp;&nbsp;<code>= delete ;</code></p>\n\n<p>So it's a little more complicated than <em>\"type name (parameters) {statements}\"</em>, but you're not far off.</p>\n\n<hr>\n\n<p><sub>* <code>[C++14: 17.6.4.3.2]:</code> <em>[..]</em> Each name that <em>[..]</em> begins with an underscore followed by an uppercase letter (2.12) is reserved to the implementation for any use. <em>[..]</em></sub></p>\n"}], "owner": {"reputation": 3, "user_id": 8259455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28d1ecde72766688f9f891d4b39b455a?s=128&d=identicon&r=PG&f=1", "display_name": "Bowzerz", "link": "https://stackoverflow.com/users/8259455/bowzerz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "accepted_answer_id": 44928804, "answer_count": 1, "score": 0, "last_activity_date": 1499265298, "creation_date": 1499264036, "last_edit_date": 1499265099, "question_id": 44928690, "link": "https://stackoverflow.com/questions/44928690/extra-underscored-name-in-a-c-function", "title": "Extra underscored name in a c++ function", "body": "<p>I understand what c++ functions need: type name (parameters) {statements}. What is it called when a function has an extra name like this: </p>\n\n<pre><code>_API8810AFUNC int API8810A_GetAPI8810AUSBDeviceCnt(int *pnUSBDeviceCnt);?\n</code></pre>\n\n<p>_API8810AFUNC is defined as:</p>\n\n<pre><code>#ifdef _BUILD_API8810ADLL\n#define _API8810AFUNC  __declspec(dllexport )\n#else\n</code></pre>\n\n<p>Does the \"_API8810AFUNC\" mean the function needs to be called differently? And does this have a name in c++?</p>\n"}, {"tags": ["c++", "qt", "qt5", "qtableview"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499264017, "post_id": 44928356, "comment_id": 76832825, "body": "So you want the image to change to a generic like windows?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499264385, "post_id": 44928356, "comment_id": 76833183, "body": "QTableView or QTableWidget?"}, {"owner": {"reputation": 197, "user_id": 8259546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a31a5086de3c714ff7b8d4877a42c32f?s=128&d=identicon&r=PG&f=1", "display_name": "epi4", "link": "https://stackoverflow.com/users/8259546/epi4"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499265475, "post_id": 44928356, "comment_id": 76834052, "body": "In my small example I use QTableWidget, but I think it is the same with QTableView. I would like to change the &quot;drop&quot; preview to sth more understandable, like for example instead of displaying three floating item, to display one icon (indicating 3) like in windows"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 8259546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a31a5086de3c714ff7b8d4877a42c32f?s=128&d=identicon&r=PG&f=1", "display_name": "epi4", "link": "https://stackoverflow.com/users/8259546/epi4"}, "edited": false, "score": 0, "creation_date": 1499421629, "post_id": 44931936, "comment_id": 76910760, "body": "Thank you for information. You gave me the input for Qpixmap, but the solution didn&#39;t worked, because I also had a model implementation and mime data were ruined with mousePressEvent. I will post my final solution in case someone needs this"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 1, "last_activity_date": 1499273442, "creation_date": 1499273442, "answer_id": 44931936, "question_id": 44928356, "link": "https://stackoverflow.com/questions/44928356/qtableview-how-to-change-dragging-multiple-items-display/44931936#44931936", "title": "QTableView, how to change dragging multiple items display", "body": "<p>Taking this <a href=\"http://doc.qt.io/qt-5/dnd.html\" rel=\"nofollow noreferrer\">tutorial</a> as a reference, the mousePressEvent method is overwritten, and a new QPixmap is placed in QDrag:</p>\n\n<pre><code>void mousePressEvent(QMouseEvent *event){\n    if (event-&gt;button() == Qt::LeftButton){\n\n        QDrag *drag = new QDrag(this);\n        drag-&gt;setMimeData(new QMimeData());\n        drag-&gt;setPixmap(QPixmap(\"image.png\"));\n\n        drag-&gt;exec();\n    }\n    QTableView::mousePressEvent(event);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8B1vT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8B1vT.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 197, "user_id": 8259546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a31a5086de3c714ff7b8d4877a42c32f?s=128&d=identicon&r=PG&f=1", "display_name": "epi4", "link": "https://stackoverflow.com/users/8259546/epi4"}, "is_accepted": false, "score": 1, "last_activity_date": 1499422552, "creation_date": 1499422552, "answer_id": 44968286, "question_id": 44928356, "link": "https://stackoverflow.com/questions/44928356/qtableview-how-to-change-dragging-multiple-items-display/44968286#44968286", "title": "QTableView, how to change dragging multiple items display", "body": "<p>After eyllanesc's suggestion for QPixmap, I found the correct solution to my problem, so that I can keep the mime data coming from my model. I have re-implemented startDrag(Qt::DropActions supportedActions) in my QTreeView class, so that when multiple objects are moved, one icon will be displayed along with the number of items moved. Now looks like this:</p>\n\n<pre><code>void MyTreeView::startDrag(Qt::DropActions supportedActions)\n{\n    QModelIndexList indexes = selectedIndexes();\n    if (indexes.size() == 1)\n        return QAbstractItemView::startDrag(supportedActions);\n    if (indexes.count() &gt; 0) \n    {\n        QMimeData *data = model()-&gt;mimeData(indexes);\n        if (!data)\n           return;\n        QRect rect; \n        rect.adjust(horizontalOffset(), verticalOffset(), 0, 0);\n        QDrag *drag = new QDrag(this);\n\n        ActionTreeItem* pItem = static_cast&lt;ActionTreeItem*&gt;(indexes[0].internalPointer());\n        if (pItem != NULL)\n        {\n            QPixmap pixmap = myIcon.pixmap(myIcon.actualSize(QSize(32, 32)));\n            QPainter *paint = new QPainter(&amp;pixmap);\n            paint-&gt;setPen(Qt::black);\n            paint-&gt;setBrush(QBrush(Qt::white));\n            QRect numberRect(18, 18, 13, 13);\n            paint-&gt;drawRect(numberRect);\n            paint-&gt;drawText(numberRect, Qt::AlignHCenter | Qt::AlignVCenter, QString(\"%1\").arg(indexes.count()));\n           drag-&gt;setPixmap(pixmap);\n        }       \n       drag-&gt;setMimeData(data);\n       Qt::DropAction defaultDropAction = Qt::MoveAction;\n       drag-&gt;exec(supportedActions, defaultDropAction);\n    }\n  }\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 8259546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a31a5086de3c714ff7b8d4877a42c32f?s=128&d=identicon&r=PG&f=1", "display_name": "epi4", "link": "https://stackoverflow.com/users/8259546/epi4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 44931936, "answer_count": 2, "score": 2, "last_activity_date": 1555824076, "creation_date": 1499263089, "last_edit_date": 1555824076, "question_id": 44928356, "link": "https://stackoverflow.com/questions/44928356/qtableview-how-to-change-dragging-multiple-items-display", "title": "QTableView, how to change dragging multiple items display", "body": "<p>I have a QTableView with my own implemented QAbstractItemModel, in which I can drag and drop multiple items inside. My problem is that when dragging the items and while trying to drop them in a destination cell, it is not so obvious for the user what the result is going to be. For example, I have the following,but I would prefer sth like the default widows displaying, which makes all 3 items like one item:</p>\n\n<p>my QT Table</p>\n\n<p><img src=\"https://i.stack.imgur.com/b68nc.png\" alt=\"\"></p>\n\n<p>vs</p>\n\n<p>windows dragging n dropping folders</p>\n\n<p><img src=\"https://i.stack.imgur.com/XHf6J.png\" alt=\"\"></p>\n"}, {"tags": ["c++", "opengl", "glsl", "shadow", "framebuffer"], "comments": [{"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 3, "creation_date": 1499263310, "post_id": 44928083, "comment_id": 76832275, "body": "There are several problematic things: 1) Overriding of attribute bindings in your loop. Only the settings for the last mesh is stored here. OpenGL is a state machine, so what you set last will be used. 2) You are enabling wrong attribute locations (1 is enabled twice). The parameter to <code>glEnableVertexAttrib</code> should also match the first parameter of <code>glVertexAttribPointer</code>. 3) What does the last <code>glEnableVertexAttrib</code> do? 4) You set uniforms at a point where no shader is bound (at least I assume that since you bind the shader in the rendering code. 5) You never check <code>glCheckFramebufferStatus</code>."}, {"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1499263411, "post_id": 44928083, "comment_id": 76832359, "body": "I&#39;m also completely missing the code for writing to the shadowmap (including the shaders for doing that)."}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 1, "creation_date": 1499263818, "post_id": 44928083, "comment_id": 76832657, "body": "Within the shaders you provided I noticed in both you are not describing which version of GLSL <code>#version ### core</code>... and in your vertex shader you are not setting any layout locations nor any structures or uniforms. From your project&#39;s source I would need to compile it..."}, {"owner": {"reputation": 60, "user_id": 8013494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/972a1075d22cd89ad92549a47d48a826?s=128&d=identicon&r=PG&f=1", "display_name": "Haplue", "link": "https://stackoverflow.com/users/8013494/haplue"}, "reply_to_user": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1499264885, "post_id": 44928083, "comment_id": 76833592, "body": "@FrancisCugler I added the information of the shaders in the code, sorry for not doing it before."}, {"owner": {"reputation": 60, "user_id": 8013494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/972a1075d22cd89ad92549a47d48a826?s=128&d=identicon&r=PG&f=1", "display_name": "Haplue", "link": "https://stackoverflow.com/users/8013494/haplue"}, "reply_to_user": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1499265181, "post_id": 44928083, "comment_id": 76833808, "body": "@BDL 1) This is true, I&#39;m going to be honest and say I haven&#39;t got the complete hang on how to use OpenGL properly yet. I edited it and hopefully it&#39;s better now. 2) Awkward mistake of enabling it twice, I changed around nad hopefully it should be more correct now. 3) For some reason I thought that this was a small golden rule to not mess us upcoming code, but I may be incorrect, so I deleted it. 4) I assume you mean where I uniform the lightPos? In that case I added it to the render code, since I might change it around later. 5) I did this once but I should always have it around.I use it now"}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1499265244, "post_id": 44928083, "comment_id": 76833863, "body": "@Haplue yeah; it makes a difference between which version of GLSL you are using, and to know how you are defining your variables that are being passed from your C++ source to your shaders and back. These are extremely important."}, {"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1499265566, "post_id": 44928083, "comment_id": 76834123, "body": "I mean the <code>glUniform1i</code> calls for the textures"}, {"owner": {"reputation": 60, "user_id": 8013494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/972a1075d22cd89ad92549a47d48a826?s=128&d=identicon&r=PG&f=1", "display_name": "Haplue", "link": "https://stackoverflow.com/users/8013494/haplue"}, "reply_to_user": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1499272485, "post_id": 44928083, "comment_id": 76839092, "body": "@BDL I changed how I bind the textures in the code, still doesn&#39;t work though."}], "owner": {"reputation": 60, "user_id": 8013494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/972a1075d22cd89ad92549a47d48a826?s=128&d=identicon&r=PG&f=1", "display_name": "Haplue", "link": "https://stackoverflow.com/users/8013494/haplue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 529, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499267690, "creation_date": 1499262431, "last_edit_date": 1499267690, "question_id": 44928083, "link": "https://stackoverflow.com/questions/44928083/opengl-shadow-map-not-showing", "title": "OpenGL Shadow Map not showing", "body": "<p>I'm trying to get shadow mapping working on my project. I followed the tutorial at <a href=\"https://learnopengl.com/#!Advanced-Lighting/Shadows/Shadow-Mapping\" rel=\"nofollow noreferrer\">Learn OpenGL Tutorial</a>. For some reason, I can't see the shadows though, only the specularity from the lighting code in the fragment shader.\n<a href=\"https://imgur.com/a/fX2Qn\" rel=\"nofollow noreferrer\">Image from render</a>.</p>\n\n<p>Here's how I do the framebuffer setup (Where <code>frameBuffer</code> and <code>DepthMap</code> are two global <code>GLuint</code>):</p>\n\n<pre><code>void createFrameBuffer()\n{\n    glGenFramebuffers(1, &amp;frameBuffer);\n    glGenTextures(1, &amp;DepthMap);\n    glBindTexture(GL_TEXTURE_2D, DepthMap);\n\n    glTexImage2D(GL_TEXTURE_2D, 0, GL_DEPTH_COMPONENT,\n        SHADOW_WIDTH, SHADOW_HEIGHT, 0, GL_DEPTH_COMPONENT, GL_UNSIGNED_BYTE, NULL);\n\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);    \n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);\n    glBindFramebuffer(GL_FRAMEBUFFER, frameBuffer);\n\n    glFramebufferTexture2D(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_TEXTURE_2D, DepthMap, 0);\n    glDrawBuffer(GL_NONE);\n    glReadBuffer(GL_NONE);\n\n    glBindFramebuffer(GL_FRAMEBUFFER, 0);\n}\n</code></pre>\n\n<p>Then I proceed to setup the geometry</p>\n\n<pre><code>glGenVertexArrays(1, &amp;shadowVertexAttribute);\nglBindVertexArray(shadowVertexAttribute);\nglEnableVertexAttribArray(0);\nglEnableVertexAttribArray(1);\nglEnableVertexAttribArray(2);\n//Texture Map\nglUniform1i(glGetUniformLocation(sShaderProgram, \"DepthMap\"), 0);\nglActiveTexture(GL_TEXTURE0);\nglBindTexture(GL_TEXTURE_2D, DepthMap);\n//Normal Map\nglUniform1i(glGetUniformLocation(sShaderProgram, \"DiffuseMap\"), 1);\nglActiveTexture(GL_TEXTURE1);\nglBindTexture(GL_TEXTURE_2D, textureMap);\n\nglUniform3fv(glGetUniformLocation(sShaderProgram, \"lightPos\"), 1, glm::value_ptr(lightPos));\n\nGLuint shadowVertBuffer;\nGLuint shadowUVBuffer;\nGLuint shadowNormalBuffer;\nfor (int i = 0; i &lt; objmesh.size(); i++) {\n\n    glGenBuffers(1, &amp;shadowVertBuffer);\n    glBindBuffer(GL_ARRAY_BUFFER, shadowVertBuffer);\n    glBufferData(GL_ARRAY_BUFFER, objmesh[i]-&gt;vertices.size() * sizeof(glm::vec3), &amp;objmesh[i]-&gt;vertices[0], GL_STATIC_DRAW);\n    GLuint svertexPos = glGetAttribLocation(sShaderProgram, \"vertex_position\");\n    glVertexAttribPointer(svertexPos, 3, GL_FLOAT, GL_FALSE, 0, (void*)0);\n\n    glGenBuffers(1, &amp;shadowUVBuffer);\n    glBindBuffer(GL_ARRAY_BUFFER, shadowUVBuffer);\n    glBufferData(GL_ARRAY_BUFFER, objmesh[i]-&gt;uvs.size() * sizeof(glm::vec2), &amp;objmesh[i]-&gt;uvs[0], GL_STATIC_DRAW);\n    GLuint svertexUV = glGetAttribLocation(sShaderProgram, \"vertex_UV\");\n    glVertexAttribPointer(svertexUV, 2, GL_FLOAT, GL_FALSE, 0, (void*)0);\n\n    glGenBuffers(1, &amp;shadowNormalBuffer);\n    glBindBuffer(GL_ARRAY_BUFFER, shadowNormalBuffer);\n    glBufferData(GL_ARRAY_BUFFER, objmesh[i]-&gt;normals.size() * sizeof(glm::vec3), &amp;objmesh[i]-&gt;normals[0], GL_STATIC_DRAW);\n    GLuint svertexNormal = glGetAttribLocation(sShaderProgram, \"vertex_normal\");\n    glVertexAttribPointer(svertexNormal, 3, GL_FLOAT, GL_FALSE, 0, (void*)0);\n}\n</code></pre>\n\n<p>Finally, I render the shadows (or at least try):</p>\n\n<pre><code>if (shadows == true) {\n    glUseProgram(sShaderProgram);\n    glBindVertexArray(shadowVertexAttribute);\n\n    glm::mat4 lightProjection = glm::ortho(-3000.0f, 3000.0f, -3000.0f, \n        3000.0f, NEARPLANE, FARPLANE);\n    glm::mat4 lightView = glm::lookAt(lightPos, glm::vec3(0.0),\n        glm::vec3(0.0, 1.0, 0.0));\n    glm::mat4 lightSpaceMatrix = lightProjection * lightView;\n    glUniformMatrix4fv(glGetUniformLocation(sShaderProgram, \"lightSpaceMatrix\"), \n        1, GL_FALSE, glm::value_ptr(lightSpaceMatrix));\n\n    glUniformMatrix4fv(glGetUniformLocation(sShaderProgram, \"modelMatrix\"),\n        1, GL_FALSE, glm::value_ptr(mesh.modelMatrix));\n\n    //rendering to depthmap\n    glViewport(0, 0, SHADOW_WIDTH, SHADOW_HEIGHT);\n    glBindFramebuffer(GL_FRAMEBUFFER, frameBuffer);\n    glClear(GL_DEPTH_BUFFER_BIT);\nGLuint texLocation = glGetUniformLocation(sShaderProgram, \"DepthMap\");\n    glUniform1i(texLocation, 0);\n\n    texLocation = glGetUniformLocation(sShaderProgram, \"DiffuseMap\");\n    glUniform1i(texLocation, 1);\n\n    glActiveTexture(GL_TEXTURE0 + 0);\n    glBindTexture(GL_TEXTURE_2D, DepthMap);\n\n    glActiveTexture(GL_TEXTURE0 + 1);\n    glBindTexture(GL_TEXTURE_2D, textureMap);\n\n    glDrawArrays(GL_TRIANGLES, 0, mesh.vertices.size());\n    glBindFramebuffer(GL_FRAMEBUFFER, 0);\n    setViewPort();\n\n}\n</code></pre>\n\n<p>Here's also the Shadow Vertex and Shadow Fragment shader if needed.</p>\n\n<p>Vertex:</p>\n\n<pre><code>//Vertex Shader\n#version 440\n\nlayout(location = 0) in vec3 vertex_position;\nlayout(location = 1) in vec2 vertex_UV;\nlayout(location = 2) in vec3 vertex_normal;\n\nuniform mat4 modelMatrix;\nuniform mat4 lightSpaceMatrix;\n\nout vec3 outVertex;\nout vec2 outTexCoords;\nout vec3 outNormals;\nout vec4 outVertexLightSpace;\n\nlayout(binding = 3 , std140) uniform uniformBlock\n{\nvec3 camPos;\nmat4 world;\nmat4 LookAt;\nmat4 projection;\nmat4 MVP;\n};\n\nlayout(binding = 4 , std140) uniform materials\n{\nvec3 Diffuse;\nvec3 Ambient;\nvec3 Translucency;\n//char texturePath[128];\nfloat refraction;\nvec3 Specular;\nfloat PhongSpecular;\n};\nvoid main()\n{\n    outVertex = vec3(modelMatrix * vec4(vertex_position, 1.0));\n    outTexCoords = vertex_UV;\n    outNormals = transpose(inverse(mat3(modelMatrix))) * vertex_normal;\n    outVertexLightSpace = lightSpaceMatrix * vec4(vertex_position, 1.0f);\n    gl_Position = projection * LookAt * modelMatrix * vec4(vertex_position , \n1.0);\n}\n</code></pre>\n\n<p>Fragment:</p>\n\n<pre><code>//Fragment Shader\n#version 440\nout vec4 fragment_color;\n\nuniform sampler2D DepthMap;\nuniform sampler2D DiffuseMap;\nuniform vec3 lightPos;\n\nin vec3 outVertex;\nin vec2 outTexCoords;\nin vec3 outNormals;\nin vec4 outVertexLightSpace;\n\nlayout(binding = 3 , std140) uniform uniformBlock\n{\nvec3 camPos;\nmat4 world;\nmat4 LookAt;\nmat4 projection;\nmat4 MVP;\n };\n\nfloat CalculateShadow(vec4 fragPos){\n    vec3 projCoords = outVertexLightSpace.xyz / outVertexLightSpace.w;\n    projCoords = projCoords * 0.5 + 0.5;\n    float closestDepth = texture(DepthMap, projCoords.xy).r;\n    float currentDepth = projCoords.z;\n    float shadow;\n    if(currentDepth &gt; closestDepth) {\n        shadow = 1.0;\n    }\n    else {\n        shadow = 0.0;\n    }\n\n    return shadow;\n}\n\nvoid main()\n{\n    vec3 color = texture(DiffuseMap, outTexCoords).rgb;\n    vec3 normal = normalize(outNormals);\n    vec3 lightColor = vec3(1.0);\n    vec3 ambient  = 0.4 * color;\n    vec3 lightDir = normalize(lightPos - outVertex);\n    float diff = max(dot(lightDir, normal), 0.0);\n    vec3 diffuse = diff * lightColor;\n    vec3 viewDir = normalize(camPos - outVertex);\n    vec3 halfWayDir = normalize(lightDir + viewDir);\n    float spec = pow(max(dot(normal, halfWayDir), 0.0), 64.0);\n    vec3 specular = spec * lightColor;\n    float shadowValue = CalculateShadow(outVertexLightSpace);\n    vec3 lighting = (ambient + (1.0 - shadowValue) * (diffuse + specular)) * color;\n\n    fragment_color = vec4(lighting, 1.0);\n\n}\n</code></pre>\n\n<p>If you have any pointers to what could be wrong I'd be happy to hear them. Thank you for all your help in advance :D</p>\n"}, {"tags": ["c++", "qt", "c++11", "segmentation-fault", "c++14"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1499262410, "post_id": 44928010, "comment_id": 76831609, "body": "<code>pImpl(make_unique&lt;IMPL&gt;(argc, argv))</code> Looks very suspect.  <code>IMPL</code> does try to delete the pointer does it?"}, {"owner": {"reputation": 87362, "user_id": 176769, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PckCW.png?s=128&g=1", "display_name": "karlphillip", "link": "https://stackoverflow.com/users/176769/karlphillip"}, "edited": false, "score": 0, "creation_date": 1499262562, "post_id": 44928010, "comment_id": 76831717, "body": "Destructor implementation? What does it do? How are those child widgets instantiated?"}, {"owner": {"reputation": 447, "user_id": 2769425, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4ad318e101fc30cd104f179ebcc81c22?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/2769425/sean"}, "edited": false, "score": 0, "creation_date": 1499262590, "post_id": 44928010, "comment_id": 76831734, "body": "pImpl is defined as a <code>std::unique_ptr&lt;IMPL&gt;</code> in the <code>Bridge</code> header. From the C++ documentation: <code>std::make_unique</code> &quot;Constructs an object of type T and wraps it in a std::unique_ptr.&quot;"}, {"owner": {"reputation": 447, "user_id": 2769425, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4ad318e101fc30cd104f179ebcc81c22?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/2769425/sean"}, "edited": false, "score": 0, "creation_date": 1499262692, "post_id": 44928010, "comment_id": 76831811, "body": "The child widgets are handled for me. I designed the MainWindow in QT creator and added a <code>QComboBox</code>. I have a CMake file where I do this: <code>QT5_WRAP_CPP(mainwindow_moc ${CMAKE_SOURCE_DIR}&#47;include&#47;MainWindow.hh)</code> <code>QT5_WRAP_UI(mainwindow_ui ${CMAKE_SOURCE_DIR}&#47;include&#47;MainWindow.ui)</code>"}, {"owner": {"reputation": 447, "user_id": 2769425, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4ad318e101fc30cd104f179ebcc81c22?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/2769425/sean"}, "edited": false, "score": 0, "creation_date": 1499263504, "post_id": 44928010, "comment_id": 76832431, "body": "see edits. Also the <code>delete mainwindow</code> is from the code that does not segfault. The code that segfaults is the code where I use the unqiue_ptr and therefore I&#39;m not deleting it myself."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1499273434, "post_id": 44928010, "comment_id": 76839686, "body": "If you suspect double-delete, then Valgrind is the tool of first resort - it will normally give you a stack trace from both <code>delete</code> calls."}, {"owner": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "edited": false, "score": 0, "creation_date": 1499273766, "post_id": 44928010, "comment_id": 76839868, "body": "just remove <code>this</code> in <code>reset</code>"}], "answers": [{"comments": [{"owner": {"reputation": 447, "user_id": 2769425, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4ad318e101fc30cd104f179ebcc81c22?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/2769425/sean"}, "edited": false, "score": 0, "creation_date": 1499262864, "post_id": 44928124, "comment_id": 76831945, "body": "Sorry about that. Yeah, in this case, <code>this</code> is not a parent. I&#39;ll post an update to the question. Also the code you&#39;re referencing is the version that does not segfault. The version that segfaults is the one where i use a <code>std::unique_ptr</code>."}, {"owner": {"reputation": 447, "user_id": 2769425, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4ad318e101fc30cd104f179ebcc81c22?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/2769425/sean"}, "edited": false, "score": 0, "creation_date": 1499263255, "post_id": 44928124, "comment_id": 76832234, "body": "I updated the question with a snippet of my <code>MainWindow</code> header and source file. I hope that helps. The parent of my <code>MainWindow</code> class is <code>nullptr</code>"}, {"owner": {"reputation": 971, "user_id": 4124855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zkqyU.jpg?s=128&g=1", "display_name": "IlBeldus", "link": "https://stackoverflow.com/users/4124855/ilbeldus"}, "reply_to_user": {"reputation": 447, "user_id": 2769425, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4ad318e101fc30cd104f179ebcc81c22?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/2769425/sean"}, "edited": false, "score": 0, "creation_date": 1499264346, "post_id": 44928124, "comment_id": 76833151, "body": "could you try replacing <code>std::unique_ptr</code> with <code>QScopedPointer&lt;MainWindow,QScopedPointerDeleteLater&gt;</code> and see if it still segfaults?"}, {"owner": {"reputation": 8160, "user_id": 1035613, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b4d6ce44848765d7b02e4309c9efe9bb?s=128&d=identicon&r=PG", "display_name": "Dmitry Sazonov", "link": "https://stackoverflow.com/users/1035613/dmitry-sazonov"}, "edited": false, "score": 1, "creation_date": 1499265681, "post_id": 44928124, "comment_id": 76834207, "body": "@IlBeldus <code>QScopedPointerDeleteLater</code> will cause memory leak, if it will be invoked after stop of an event loop."}], "tags": [], "owner": {"reputation": 971, "user_id": 4124855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zkqyU.jpg?s=128&g=1", "display_name": "IlBeldus", "link": "https://stackoverflow.com/users/4124855/ilbeldus"}, "is_accepted": false, "score": 1, "last_activity_date": 1499262541, "creation_date": 1499262541, "answer_id": 44928124, "question_id": 44928010, "link": "https://stackoverflow.com/questions/44928010/qt-application-segmentation-fault-on-exit-when-using-stdunique-ptr-for-the-qma/44928124#44928124", "title": "QT Application segmentation fault on exit when using std::unique_ptr for the QMainWindow", "body": "<p>Difficult to tell for sure given you did not post code for MainWindow but I'd say you are deleting mainwindow twice.</p>\n\n<p><code>pImpl-&gt;mainwindow= new MainWindow(this);</code> if <code>this</code> is a parent it will delete MainWindow automatically upon destruction and same thing will do the unique_ptr</p>\n\n<p>Either use raw pointers and rely on Qt's parent-child cleanup or use smart pointers and do not pass a parent to MainWindow</p>\n"}, {"comments": [{"owner": {"reputation": 971, "user_id": 4124855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zkqyU.jpg?s=128&g=1", "display_name": "IlBeldus", "link": "https://stackoverflow.com/users/4124855/ilbeldus"}, "edited": false, "score": 1, "creation_date": 1499265956, "post_id": 44928772, "comment_id": 76834439, "body": "So solution is just to move <code>app(argc, argv)</code> at the beginning of the initalisation list, excelent spot.  on the PS I&#39;m not 100% sure you can, from <a href=\"http://doc.qt.io/qt-5/qapplication.html#QApplication\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qapplication.html#QApplication</a>: &quot;the data referred to by argc and argv must stay valid for the entire lifetime of the QApplication object.&quot; if you pass argc by value and it gets deleted it might be trouble"}, {"owner": {"reputation": 3839, "user_id": 38714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92b77abf2d0f60fbc2cba23bc6c759e7?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/38714/stephen"}, "edited": false, "score": 1, "creation_date": 1499267534, "post_id": 44928772, "comment_id": 76835770, "body": "@Dmitry QApplication takes argc by reference <code>QApplication(int &amp;argc, char **argv)</code>"}, {"owner": {"reputation": 8160, "user_id": 1035613, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b4d6ce44848765d7b02e4309c9efe9bb?s=128&d=identicon&r=PG", "display_name": "Dmitry Sazonov", "link": "https://stackoverflow.com/users/1035613/dmitry-sazonov"}, "reply_to_user": {"reputation": 3839, "user_id": 38714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92b77abf2d0f60fbc2cba23bc6c759e7?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/38714/stephen"}, "edited": false, "score": 0, "creation_date": 1499327336, "post_id": 44928772, "comment_id": 76861208, "body": "@StephenPape it doesn&#39;t matter :)"}], "tags": [], "owner": {"reputation": 8160, "user_id": 1035613, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b4d6ce44848765d7b02e4309c9efe9bb?s=128&d=identicon&r=PG", "display_name": "Dmitry Sazonov", "link": "https://stackoverflow.com/users/1035613/dmitry-sazonov"}, "is_accepted": false, "score": 3, "last_activity_date": 1499265522, "last_edit_date": 1499265522, "creation_date": 1499264249, "answer_id": 44928772, "question_id": 44928010, "link": "https://stackoverflow.com/questions/44928010/qt-application-segmentation-fault-on-exit-when-using-stdunique-ptr-for-the-qma/44928772#44928772", "title": "QT Application segmentation fault on exit when using std::unique_ptr for the QMainWindow", "body": "<p>Don't delete <code>MainWindow</code> after deleting <code>QApplication</code> instance. You need to somehow manage initialization and destruction order.</p>\n\n<pre><code>QApp::ctor Window::ctor Window::dtor QApp::dtor\n</code></pre>\n\n<p>Possible solution: destroy <code>MainWindow</code> directly inside <code>Bridge::~Bridge</code></p>\n\n<p>P.S. you don't need to pass <code>int argc</code> via reference.</p>\n\n<p>P.P.S. about processEvents() - you may create a separated thread and run your Qt part there. It is OK to use GUI not from main thread, ofc if you know, what you are doing :). Main rule - QApplication instance and all GUI should be created from one thread</p>\n"}, {"comments": [{"owner": {"reputation": 447, "user_id": 2769425, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4ad318e101fc30cd104f179ebcc81c22?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/2769425/sean"}, "edited": false, "score": 0, "creation_date": 1499270132, "post_id": 44930547, "comment_id": 76837609, "body": "This fixed my issue. Thanks."}], "tags": [], "owner": {"reputation": 3839, "user_id": 38714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92b77abf2d0f60fbc2cba23bc6c759e7?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/38714/stephen"}, "is_accepted": true, "score": 1, "last_activity_date": 1499268872, "creation_date": 1499268872, "answer_id": 44930547, "question_id": 44928010, "link": "https://stackoverflow.com/questions/44928010/qt-application-segmentation-fault-on-exit-when-using-stdunique-ptr-for-the-qma/44930547#44930547", "title": "QT Application segmentation fault on exit when using std::unique_ptr for the QMainWindow", "body": "<p>In your class, QApplication's destructor is being called before your mainwindow is destroyed. That's because class variables are initalized in the order they're listed, then destroyed in the opposite order.</p>\n\n<p>If you move <code>QApplication app;</code> so it's the first variable in the class, its destructor will be called last, AFTER mainwindow is destroyed, which is the correct behavior.</p>\n\n<p>The reason it works when you delete it explicitly is that you're deleting <code>mainwindow</code> via the IMPL's destructor. ~IMPL() runs before the class variable destructors are run, resulting in mainwindow being destroyed first.</p>\n"}], "owner": {"reputation": 447, "user_id": 2769425, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4ad318e101fc30cd104f179ebcc81c22?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/2769425/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1930, "favorite_count": 0, "accepted_answer_id": 44930547, "answer_count": 3, "score": 2, "last_activity_date": 1499268872, "creation_date": 1499262242, "last_edit_date": 1499263456, "question_id": 44928010, "link": "https://stackoverflow.com/questions/44928010/qt-application-segmentation-fault-on-exit-when-using-stdunique-ptr-for-the-qma", "title": "QT Application segmentation fault on exit when using std::unique_ptr for the QMainWindow", "body": "<p>I should clarify first, my question is, why does the segfault happen in the case where I use a <code>std::unique_ptr</code> but it doesn't when I change the code to use new and delete? I don't really have an issue here, since the segfault is fixed and I know I'm properly cleaning things up with new and delete. I just want to know why I couldn't use a <code>std::unique_ptr</code>.</p>\n\n<p>If I create my <code>QMainWindow</code> instance in a <code>std::unique_ptr</code> and my <code>MainWindow</code> creates a child window (e.g. opening a <code>QComboBox</code> or <code>ToolTip</code>), my application will segfault on exit. In this case, if my <code>MainWindow</code> does not create any child windows, there is no segfault.</p>\n\n<p>If I manage my <code>QMainWindow</code> instance myself with new and delete, there is no segfault regardless of whether or not I create a child window.</p>\n\n<p>This is my main, it simply calls <code>run</code> on my <code>Bridge</code> class that handles creating the instance of my <code>MainWindow</code> class and starting it.</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    Bridge bridge(argc, argv);\n    bridge.run(); // Handles starting the main window\n}\n</code></pre>\n\n<p><strong>This is a shortened version of my <code>Bridge</code> class that results in a segfault (using std::unique_ptr I get a segfault on exit):</strong></p>\n\n<pre><code>class Bridge::IMPL {\npublic:\n    IMPL(int&amp; argc, char ** argv) : \n        mainwindow(), isRunning(true), app(argc, argv) {}\n    ~IMPL() = default;\npublic:\n    std::unique_ptr&lt;MainWindow&gt; mainwindow;\n    bool isRunning;\n    QApplication app;\n};\n\nBridge::Bridge(int&amp; argc, char ** argv) :\n    pImpl(make_unique&lt;IMPL&gt;(argc, argv)) {\n\n    pImpl-&gt;mainwindow.reset(new MainWindow(this));\n}\n</code></pre>\n\n<p><strong>This is the Bridge class with no segfault (slightly modified to remove the <code>std::unique_ptr</code> and instead use new and delete. This version of the <code>Bridge</code> class DOES NOT CRASH):</strong></p>\n\n<pre><code>class Bridge::IMPL {\npublic:\n    IMPL(int&amp; argc, char ** argv) : \n        mainwindow(nullptr), isRunning(true), app(argc, argv) {}\n    ~IMPL() {\n        if (mainwindow) {\n            delete mainwindow;\n        }\n    }\npublic:\n    MainWindow* mainwindow;\n    bool isRunning;\n    QApplication app;\n};\n\nBridge::Bridge(int&amp; argc, char ** argv) :\n    pImpl(make_unique&lt;IMPL&gt;(argc, argv)) {\n\n    pImpl-&gt;mainwindow= new MainWindow(this);\n}\n</code></pre>\n\n<p><strong>This is the back-trace when a segfault would happen:</strong></p>\n\n<p><em>Also there is a weird print-out about <code>QBasicTimer</code> that doesn't get printed after I changed the code to use new and delete instead of <code>std::unique_ptr</code></em></p>\n\n<pre><code>QBasicTimer::start: QBasicTimer can only be used with threads started with QThread\n\nThread 1 \"application\" received signal SIGSEGV, Segmentation fault.\n0x00007fffe75bf2e2 in ?? () from /home/user/Qt/5.9/gcc_64/plugins/platforms/../../lib/libQt5XcbQpa.so.5\n(gdb) bt\n#0  0x00007fffe75bf2e2 in ?? () from /home/user/Qt/5.9/gcc_64/plugins/platforms/../../lib/libQt5XcbQpa.so.5\n#1  0x00007fffe75bf5c4 in ?? () from /home/user/Qt/5.9/gcc_64/plugins/platforms/../../lib/libQt5XcbQpa.so.5\n#2  0x00007fffe75b9669 in QXcbConnection::removeWindowEventListener(unsigned int) () from /home/user/Qt/5.9/gcc_64/plugins/platforms/../../lib/libQt5XcbQpa.so.5\n#3  0x00007fffe75ceafa in QXcbWindow::destroy() () from /home/user/Qt/5.9/gcc_64/plugins/platforms/../../lib/libQt5XcbQpa.so.5\n#4  0x00007fffe75cec07 in QXcbWindow::~QXcbWindow() () from /home/user/Qt/5.9/gcc_64/plugins/platforms/../../lib/libQt5XcbQpa.so.5\n#5  0x00007fffe43ce2ee in ?? () from /home/user/Qt/5.9/gcc_64/plugins/xcbglintegrations/libqxcb-glx-integration.so\n#6  0x00007ffff4b56f46 in QWindowPrivate::destroy() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Gui.so.5\n#7  0x00007ffff534ecd7 in QWidgetPrivate::deleteTLSysExtra() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Widgets.so.5\n#8  0x00007ffff53524d8 in QWidget::destroy(bool, bool) () from /home/user/Qt/5.9/gcc_64/lib/libQt5Widgets.so.5\n#9  0x00007ffff53598b0 in QWidget::~QWidget() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Widgets.so.5\n#10 0x00007ffff541ae7a in ?? () from /home/user/Qt/5.9/gcc_64/lib/libQt5Widgets.so.5\n#11 0x00007ffff4580b83 in QObjectPrivate::deleteChildren() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Core.so.5\n#12 0x00007ffff5359894 in QWidget::~QWidget() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Widgets.so.5\n#13 0x00007ffff540eac9 in QComboBox::~QComboBox() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Widgets.so.5\n#14 0x00007ffff4580b83 in QObjectPrivate::deleteChildren() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Core.so.5\n#15 0x00007ffff5359894 in QWidget::~QWidget() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Widgets.so.5\n#16 0x00007ffff5359ab9 in QWidget::~QWidget() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Widgets.so.5\n#17 0x00007ffff4580b83 in QObjectPrivate::deleteChildren() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Core.so.5\n#18 0x00007ffff5359894 in QWidget::~QWidget() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Widgets.so.5\n#19 0x00007ffff5359ab9 in QWidget::~QWidget() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Widgets.so.5\n#20 0x00007ffff4580b83 in QObjectPrivate::deleteChildren() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Core.so.5\n#21 0x00007ffff5359894 in QWidget::~QWidget() () from /home/user/Qt/5.9/gcc_64/lib/libQt5Widgets.so.5\n#22 0x0000000000421ed4 in MainWindow::~MainWindow() ()\n#23 0x0000000000421f0e in MainWindow::~MainWindow() ()\n#24 0x0000000000421698 in std::default_delete&lt;MainWindow&gt;::operator()(MainWindow*) const ()\n#25 0x0000000000421171 in std::unique_ptr&lt;MainWindow, std::default_delete&lt;MainWindow&gt; &gt;::~unique_ptr() ()\n#26 0x000000000042191c in Bridge::IMPL::~IMPL() ()\n#27 0x0000000000421942 in std::default_delete&lt;Bridge::IMPL&gt;::operator()(Bridge::IMPL*) const ()\n#28 0x0000000000421387 in std::unique_ptr&lt;Bridge::IMPL, std::default_delete&lt;Bridge::IMPL&gt; &gt;::~unique_ptr() ()\n#29 0x0000000000420cb0 in Bridge::~Bridge() ()\n#30 0x0000000000421c41 in main ()\n</code></pre>\n\n<p>It should also be noted that this <code>QApplication</code> is run using a while loop and calls to <code>app.processEvents()</code> rather than calling <code>exec()</code>. I realize that's not the best way to do it, however this app is part of another application that polls for events from somewhere else and since the nature of this application is more \"proof-of-concept\" than anything else, I wanted to keep it simple by having it all in one thread. See below for a snippet of my run method:</p>\n\n<pre><code>while (isRunning()) {\n    poller.poll(25);\n    app.processEvents();\n}\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>In my constructor for <code>MainWindow</code> the <code>this</code> I'm passing is not being set as the parent (the parent is <code>nullptr</code>):</p>\n\n<p>header:</p>\n\n<pre><code>class MainWindow: public QMainWindow\n{\n    Q_OBJECT\npublic:\n    class BridgeInterface{\n    public:\n        // Some pure virtual methods here\n    };\n\n    explicit MainWindow(BridgeInterface* interface, QWidget* parent = nullptr);\n\n// some more stuff...\n\nprivate:\n    class IMPL;\n    std::unique_ptr&lt;IMPL&gt; pImpl;\n};\n</code></pre>\n\n<p>source:</p>\n\n<pre><code>MainWindow::MainWindow(BridgeInterface* interface, QWidget* parent) :\n    QMainWindow(parent), pImpl(make_unique&lt;IMPL&gt;()) {\n\n    pImpl-&gt;ui-&gt;setupUi(this);\n    pImpl-&gt;bridgeInterface = interface;\n\n    // Connect slots and stuff\n}\n</code></pre>\n"}, {"tags": ["c++", "makefile"], "comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499264112, "post_id": 44927845, "comment_id": 76832905, "body": "Your auto-generated header dependencies should do the trick, no object file dependency on <code>.a</code> should be necessary. Check the target paths in the generated <code>.d</code> files, check the output of <code>make -d</code>."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499265279, "post_id": 44927845, "comment_id": 76833894, "body": "@MaximEgorushkin The problem is that if I remove <code>libmylib.a</code> from the <code>%.o</code> rule, the <code>lib</code> folder is build after the <code>.cpp</code> (due to the order of the dependencies in <code>$(MAIN)</code>), so the old header files are detected when building <code>.cpp</code> (I have to run make twice in this case)."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499266247, "post_id": 44927845, "comment_id": 76834690, "body": "Since you have a recursive make, just stick in <code>X:=$(shell ${MAKE} -C ${LIBDIR})</code> at the top of the file to make sure it is invoked first. This way you do need to mark the <code>.a</code> as phony, because it is not phony at all, it is a real file. Then see why the generated header dependencies do not work."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499266264, "post_id": 44927845, "comment_id": 76834711, "body": "Correction <code>X:=</code>."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499266453, "post_id": 44927845, "comment_id": 76834894, "body": "@MaximEgorushkin This seems to work - Is there a way to see the output of this <code>make</code> command in this case?"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499266499, "post_id": 44927845, "comment_id": 76834936, "body": "<code>$(info ${X})</code>."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499267559, "post_id": 44927845, "comment_id": 76835789, "body": "@MaximEgorushkin Thanks, almost there! Is there any (simple) way to keep the line feeds? Did not found anything easy looking on SO..."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499267688, "post_id": 44927845, "comment_id": 76835869, "body": "A better command is <code>$(shell ${MAKE} -C ${LIBDIR} &gt; $$(tty) 2&gt;&amp;1)</code>. No need to assign to a variable and no buffering."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499267924, "post_id": 44927845, "comment_id": 76836049, "body": "@MaximEgorushkin Thanks, perfect! Feel free if you want to make an answer out of this."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499268187, "post_id": 44927845, "comment_id": 76836226, "body": "But what about the generated dependencies, do they work as expected now?"}], "answers": [{"comments": [{"owner": {"reputation": 1582, "user_id": 3185943, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TJBWJ.png?s=128&g=1", "display_name": "blackghost", "link": "https://stackoverflow.com/users/3185943/blackghost"}, "edited": false, "score": 0, "creation_date": 1499283387, "post_id": 44930269, "comment_id": 76845207, "body": "Can&#39;t say I love the idea of invoking a submake via a <code>$(shell)</code> in the global scope...  This will not work as expected if the OP runs <code>make clean</code> for example, or will not fail if the upper layer makefile fails, etc."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1499270665, "last_edit_date": 1499270665, "creation_date": 1499268157, "answer_id": 44930269, "question_id": 44927845, "link": "https://stackoverflow.com/questions/44927845/build-make-lib-every-time-recompile-project-only-if-lib-is-newer/44930269#44930269", "title": "Build (make) lib every time, recompile project only if lib is newer", "body": "<p>With recursive makefiles you need to execute the sub-project makefiles in correct order because the dependency tree is incomplete (e.g. this makefile does not know that updating <code>$(LIBDIR)/build/lib/libmylib.a</code> also updates those headers). It is easy to do that with a shell script or a top-level makefile. </p>\n\n<p>Alternatively, your makefile must execute the sub-makefiles unconditionally in correct order, which can be done with <code>shell</code> function, e.g.:</p>\n\n<pre><code>LIBDIR := ../lib\npid := $(shell ps -o ppid= $$$$)\n$(shell ${MAKE} -C ${LIBDIR} &gt;/proc/$(pid)/fd/1 2&gt;/proc/$(pid)/fd/2)\n</code></pre>\n\n<p>That <code>$(LIBDIR)/build/lib/libmylib.a</code> rule should be removed, the object files should not depend on the <code>.a</code> and it should not be marked as <code>.PHONY</code>.</p>\n\n<p>This makes sure that building in <code>${LIBDIR}</code> happens before this makefile analyzes file timestamps in <code>${LIBDIR}</code>. </p>\n\n<p>Now your auto-generated header dependencies should just work.</p>\n"}, {"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499285643, "post_id": 44935124, "comment_id": 76846545, "body": "This makefile does not build correctly if the target is specified, e.g. <code>make myexe</code> doesn&#39;t build its prerequisite. This is because the dependency is missing."}, {"owner": {"reputation": 1582, "user_id": 3185943, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TJBWJ.png?s=128&g=1", "display_name": "blackghost", "link": "https://stackoverflow.com/users/3185943/blackghost"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499285950, "post_id": 44935124, "comment_id": 76846735, "body": "@MaximEgorushkin fair point :-)  Upper level makefile is indeed cleaner."}], "tags": [], "owner": {"reputation": 1582, "user_id": 3185943, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TJBWJ.png?s=128&g=1", "display_name": "blackghost", "link": "https://stackoverflow.com/users/3185943/blackghost"}, "is_accepted": false, "score": 0, "last_activity_date": 1499285356, "creation_date": 1499285356, "answer_id": 44935124, "question_id": 44927845, "link": "https://stackoverflow.com/questions/44927845/build-make-lib-every-time-recompile-project-only-if-lib-is-newer/44935124#44935124", "title": "Build (make) lib every time, recompile project only if lib is newer", "body": "<p>This might be a bit cleaner.</p>\n\n<pre><code>LIBDIR = ../lib\nSRCDIR = src\nOBJDIR = obj\nSRCS = $(SRCDIR)/main.cpp\n\nMAIN=myexe\n\nOBJS = $(SRCS:$(SRCDIR)/%.cpp=$(OBJDIR)/%.o)\nDEPS = $(OBJS:.o=.d)\n\nall: makelib\n    $(MAKE) $(MAIN)\n\ndebug: CFLAGS += -g -DDEBUG\ndebug: LFLAGS += -g\ndebug: $(MAIN)\n\n$(MAIN): $(OBJS)\n    $(CC) $^ -o $@ $(LIBS) $(LFLAGS)\n\n$(OBJDIR)/%.o: $(SRCDIR)/%.cpp\n    mkdir -p $(OBJDIR)\n    $(CC) -c -o $@ $(CFLAGS) $(INCS) -MD -MF $(patsubst %.o, %.d, $@) $&lt;\n\nmakelib:\n    make -C $(LIBDIR)\n\n-include $(DEPS)\n\n.PHONY: clean makelib\n\nclean:\n    $(RM) obj/* $(MAIN)\n</code></pre>\n\n<p>The main target <code>all</code> requires <code>makelib</code> to be built, and then it recursively calls itself for the target <code>$(MAIN)</code> (so all of <code>$(MAIN)</code>'s dependencies will be recalculated after <code>makelib</code> has finished building).</p>\n"}], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 44930269, "answer_count": 2, "score": 2, "last_activity_date": 1499285356, "creation_date": 1499261784, "last_edit_date": 1499262401, "question_id": 44927845, "link": "https://stackoverflow.com/questions/44927845/build-make-lib-every-time-recompile-project-only-if-lib-is-newer", "title": "Build (make) lib every time, recompile project only if lib is newer", "body": "<p>I have the following project structure:</p>\n\n<pre><code>lib/\n    Makefile\n    src/...\n    inc/...\n    build/\n        inc/...\n        lib/libmylib.a\nsubproj1/\n    src/main.cpp\n    Makefile \n</code></pre>\n\n<p>The <code>Makefile</code> in the <code>lib</code> folder is designed to create the file <code>libmylib.a</code> and copy the relevant header files to the <code>build/inc</code> folder.</p>\n\n<p>I want the <code>Makefile</code> in <code>subproj1</code> to always call <code>make -C ../lib</code>, but only re-compile file if headers have changed, and re-link only if necessary (one object file or <code>libmylib.a</code> is newer).</p>\n\n<p>I have the following (non-defined variables such as <code>CC</code> are defined in another file):</p>\n\n<pre><code>LIBDIR = ../lib\nSRCDIR = src\nOBJDIR = obj\nSRCS = $(SRCDIR)/main.cpp\n\nMAIN=myexe\n\nOBJS = $(SRCS:$(SRCDIR)/%.cpp=$(OBJDIR)/%.o)\nDEPS = $(OBJS:.o=.d)\n\nall: $(MAIN)\n\ndebug: CFLAGS += -g -DDEBUG\ndebug: LFLAGS += -g\ndebug: $(MAIN)\n\n$(MAIN): $(OBJS) $(LIBDIR)/build/lib/libmylib.a\n    $(CC) $^ -o $@ $(LIBS) $(LFLAGS)\n\n$(OBJDIR)/%.o: $(SRCDIR)/%.cpp $(LIBDIR)/build/lib/libmylib.a\n    mkdir -p $(OBJDIR)\n    $(CC) -c -o $@ $(CFLAGS) $(INCS) -MD -MF $(patsubst %.o, %.d, $@) $&lt;\n\n$(LIBDIR)/build/lib/libmylib.a:\n    make -C $(LIBDIR)\n\n-include $(DEPS)\n\n.PHONY: clean $(LIBDIR)/build/lib/libmylib.a\n\nclean:\n    $(RM) obj/* $(MAIN)\n</code></pre>\n\n<p>The above will re-compile <code>main.cpp</code> even if nothing has changed in the lib folder. If I remove <code>$(LIBDIR)/build/lib/libmylib.a</code> from the <code>$(OBJDIR)/%.o</code> rule, the <code>.cpp</code> file will not be re-compiled if a header changed (I would need to run <code>make</code> twice).</p>\n\n<p>Is there a way to have the <code>.cpp</code> files in <code>subproj1</code> being compiled only if the header files in <code>lib</code> have changed (or if the <code>.cpp</code> files themselves have changed), and to get <code>myexe</code> built only if one of the <code>.cpp</code> has been re-compiled (newer <code>.o</code>) or if <code>libmylib.a</code> is newer?</p>\n"}, {"tags": ["c++", "arrays", "cocos2d-x", "rapidjson"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 8257882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8245fdd1e539a40ae4fe73a79600f9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Deeds", "link": "https://stackoverflow.com/users/8257882/deeds"}, "edited": false, "score": 0, "creation_date": 1499271896, "post_id": 44928539, "comment_id": 76838756, "body": "For some reason this gives me an &quot;Assertion failed!&quot; error: &quot;Expression: rhs.IsString()&quot;."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 35, "user_id": 8257882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8245fdd1e539a40ae4fe73a79600f9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Deeds", "link": "https://stackoverflow.com/users/8257882/deeds"}, "edited": false, "score": 0, "creation_date": 1499271952, "post_id": 44928539, "comment_id": 76838788, "body": "@Deeds Which one?"}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 35, "user_id": 8257882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8245fdd1e539a40ae4fe73a79600f9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Deeds", "link": "https://stackoverflow.com/users/8257882/deeds"}, "edited": false, "score": 0, "creation_date": 1499272370, "post_id": 44928539, "comment_id": 76839006, "body": "@Deeds I wrote <code>doc</code> instead of <code>dataDoc</code> in the first snippet, maybe it was the problem... Answer edited."}, {"owner": {"reputation": 35, "user_id": 8257882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8245fdd1e539a40ae4fe73a79600f9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Deeds", "link": "https://stackoverflow.com/users/8257882/deeds"}, "edited": false, "score": 0, "creation_date": 1499336118, "post_id": 44928539, "comment_id": 76867140, "body": "Yes, I tried <code>auto &amp;people = dataDoc[0][&quot;people&quot;];</code>, but it gives that error."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 35, "user_id": 8257882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8245fdd1e539a40ae4fe73a79600f9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Deeds", "link": "https://stackoverflow.com/users/8257882/deeds"}, "edited": false, "score": 0, "creation_date": 1499363538, "post_id": 44928539, "comment_id": 76887104, "body": "@Deeds I have tested by recreating the object you showed and it works, so there is something that is not consistent in your question. Could you post a code that does not rely on an external source for the creation of the object so that I can test it?"}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 35, "user_id": 8257882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8245fdd1e539a40ae4fe73a79600f9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Deeds", "link": "https://stackoverflow.com/users/8257882/deeds"}, "edited": false, "score": 0, "creation_date": 1499417940, "post_id": 44928539, "comment_id": 76908233, "body": "@Deeds I am not sure the issue is what the <code>auto &amp;people = ...</code> line. I tried your code with a simple output to <code>std::cout</code> using a <code>Writer&lt;OStreamWrapper&gt;</code>, and I get the same error, so the issue is probably with the creation of <code>dataDoc</code>."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 35, "user_id": 8257882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8245fdd1e539a40ae4fe73a79600f9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Deeds", "link": "https://stackoverflow.com/users/8257882/deeds"}, "edited": false, "score": 0, "creation_date": 1499418734, "post_id": 44928539, "comment_id": 76908744, "body": "@Deeds Everything is fixed if you provide <code>&amp;allocator</code> to <code>doc</code> (see updated answer)."}], "tags": [], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "is_accepted": true, "score": 0, "last_activity_date": 1499418711, "last_edit_date": 1499418711, "creation_date": 1499263641, "answer_id": 44928539, "question_id": 44927836, "link": "https://stackoverflow.com/questions/44927836/accessing-rapidjsondocument-array-by-index/44928539#44928539", "title": "Accessing rapidjson::Document array by index", "body": "<p>First, there seems to be an issue in your code the way you create <code>doc</code> - You need to provide the allocator of <code>dataDoc</code>:</p>\n\n<pre><code>Document doc(&amp;allocator);\n</code></pre>\n\n<hr>\n\n<p>Then, <code>rapidjson::Document</code> inherits from <code>rapidjson::Value</code>, so you can simply treat it as a value and use the <code>[]</code> operator:</p>\n\n<pre><code>auto &amp;people = dataDoc[0][\"people\"];\n</code></pre>\n\n<p>You can also iterate through the whole document:</p>\n\n<pre><code>for (auto &amp;doc: dataDoc.getArray()) {\n    auto &amp;people = doc[\"people\"];\n}\n</code></pre>\n\n<p>Prior to C++11:</p>\n\n<pre><code>for (Value::ConstValueIterator itr = dataDoc.Begin(); \n     itr != dataDoc.End(); ++itr) {\n    auto &amp;people = (*itr)[\"people\"];\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8257882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8245fdd1e539a40ae4fe73a79600f9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Deeds", "link": "https://stackoverflow.com/users/8257882/deeds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1169, "favorite_count": 0, "accepted_answer_id": 44928539, "answer_count": 1, "score": 0, "last_activity_date": 1499418711, "creation_date": 1499261775, "last_edit_date": 1499417226, "question_id": 44927836, "link": "https://stackoverflow.com/questions/44927836/accessing-rapidjsondocument-array-by-index", "title": "Accessing rapidjson::Document array by index", "body": "<p>I have this code:</p>\n\n<pre><code>Document dataDoc;\ndataDoc.SetArray();\nDocument::AllocatorType &amp;allocator = dataDoc.GetAllocator();\n\nfor (size_t i = 0; i &lt; 10; ++i)\n{\n    ostringstream ss;\n    ss &lt;&lt; \"set_\" &lt;&lt; i + 1 &lt;&lt; \"_data\";\n\n    Document doc;\n    doc.Parse&lt;0&gt;(UserDefault::getInstance()-&gt;getStringForKey(ss.str().c_str()).c_str());\n    dataDoc.PushBack(doc, allocator);\n}\n</code></pre>\n\n<p>There's a <code>rapidjson::Document</code> \"dataDoc\" and I convert it to an array. Then I fill the array with <code>Document</code> objects that contain JSON objects that are fetched from <code>cocos2d::UserDefault</code> and parsed appropriately.</p>\n\n<p>This is the JSON object that is added to the dataDoc:</p>\n\n<pre><code>{\n  \"people\": [\n    {\n      \"name\": \"Peter\",\n      \"phone\": \"123\",\n      \"address\": \"Address 456\"\n    },\n    {\n      \"name\": \"Helen\",\n      \"phone\": \"123\",\n      \"address\": \"Address 456\"\n    },\n    {\n      \"name\": \"John\",\n      \"phone\": \"123\",\n      \"address\": \"Address 456\"\n    }\n  ]\n}\n</code></pre>\n\n<p>Now the dataDoc array contains 10 of these objects.</p>\n\n<p>I know that I can handle one object like this:</p>\n\n<pre><code>Document doc;\nrapidjson::Value &amp;people = doc[\"people\"];\nstring name = people[0][\"name\"].GetString();\n</code></pre>\n\n<p>But how can I access, for example, the first object in the dataDoc array by index and get the name value as above?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Tried also with this code:</p>\n\n<pre><code>vector&lt;string&gt; jsons;\njsons.push_back(\"{\\\"people\\\":[{\\\"name\\\":\\\"Peter\\\",\\\"phone\\\":\\\"123\\\",\\\"address\\\":\\\"Address 456\\\"},{\\\"name\\\":\\\"Helen\\\",\\\"phone\\\":\\\"123\\\",\\\"address\\\":\\\"Address 456\\\"},{\\\"name\\\":\\\"John\\\",\\\"phone\\\":\\\"123\\\",\\\"address\\\":\\\"Address 456\\\"}]}\");\njsons.push_back(\"{\\\"people\\\":[{\\\"name\\\":\\\"Peter\\\",\\\"phone\\\":\\\"123\\\",\\\"address\\\":\\\"Address 456\\\"},{\\\"name\\\":\\\"Helen\\\",\\\"phone\\\":\\\"123\\\",\\\"address\\\":\\\"Address 456\\\"},{\\\"name\\\":\\\"John\\\",\\\"phone\\\":\\\"123\\\",\\\"address\\\":\\\"Address 456\\\"}]}\");\njsons.push_back(\"{\\\"people\\\":[{\\\"name\\\":\\\"Peter\\\",\\\"phone\\\":\\\"123\\\",\\\"address\\\":\\\"Address 456\\\"},{\\\"name\\\":\\\"Helen\\\",\\\"phone\\\":\\\"123\\\",\\\"address\\\":\\\"Address 456\\\"},{\\\"name\\\":\\\"John\\\",\\\"phone\\\":\\\"123\\\",\\\"address\\\":\\\"Address 456\\\"}]}\");\n\nDocument dataDoc;\ndataDoc.SetArray();\nDocument::AllocatorType &amp;allocator = dataDoc.GetAllocator();\n\nfor (size_t i = 0; i &lt; 3; ++i)\n{\n    Document doc;\n    doc.Parse&lt;0&gt;(jsons.at(i).c_str());\n    dataDoc.PushBack(doc, allocator);\n}\n\nauto &amp;people = dataDoc[0][\"people\"];\n</code></pre>\n\n<p>But it gave me the same error. It points to line 1688 in \"document.h\" located at <code>...\\cocos2d\\external\\json\\</code>.</p>\n"}, {"tags": ["c++", "opencv", "comma", "mat", "opencv-mat"], "comments": [{"owner": {"reputation": 1073, "user_id": 3763139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gkUYr.jpg?s=128&g=1", "display_name": "Sopel", "link": "https://stackoverflow.com/users/3763139/sopel"}, "edited": false, "score": 0, "creation_date": 1499262187, "post_id": 44927829, "comment_id": 76831453, "body": "operator&lt;&lt; creates an intermidiate object that has operator, overloaded such that it builds the matrix"}], "answers": [{"tags": [], "owner": {"reputation": 3990, "user_id": 6095394, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7e512acda63343ac20eedd20c3964911?s=128&d=identicon&r=PG&f=1", "display_name": "pschill", "link": "https://stackoverflow.com/users/6095394/pschill"}, "is_accepted": true, "score": 8, "last_activity_date": 1499263235, "last_edit_date": 1499263235, "creation_date": 1499262407, "answer_id": 44928071, "question_id": 44927829, "link": "https://stackoverflow.com/questions/44927829/how-is-the-comma-separated-initializer-of-opencv-mat-implemented-with-c/44928071#44928071", "title": "How is the comma-separated initializer of OpenCV Mat implemented with C++?", "body": "<p>To allow an initialization like</p>\n\n<pre><code>Mat a = (Mat_&lt;double&gt;(3, 3) &lt;&lt; 0, 1, 2, 3, 4, 5, 6, 7, 8);\n</code></pre>\n\n<p>OpenCV first uses</p>\n\n<pre><code>template &lt;typename T&gt;\nMatCommaInitializer_&lt;T&gt; operator&lt;&lt;(Mat_&lt;T&gt;&amp;, T);\n</code></pre>\n\n<p>to return an intermediate object <code>MatCommaInitializer_&lt;T&gt;</code>. This object has an overloaded <code>operator,</code>, namely</p>\n\n<pre><code>template &lt;typename T2&gt;\nMatCommaInitializer_&lt;T&gt;&amp; operator,(T2 v);\n</code></pre>\n\n<p>which adds the value to the initializer. Then there is a constructor</p>\n\n<pre><code>template &lt;typename T&gt;\nexplicit Mat(MatCommaInitializer_&lt;T&gt; const&amp;);\n</code></pre>\n\n<p>to create a <code>Mat</code> object from a <code>MatCommaInitializer</code>.</p>\n\n<p><em>Note:</em> You can find such information in the OpenCV documentation <a href=\"http://docs.opencv.org/master/\" rel=\"noreferrer\">http://docs.opencv.org/master/</a> (<a href=\"http://docs.opencv.org/master/d6/d9e/classcv_1_1MatCommaInitializer__.html\" rel=\"noreferrer\">http://docs.opencv.org/master/d6/d9e/classcv_1_1MatCommaInitializer__.html</a>).</p>\n"}], "owner": {"reputation": 1100, "user_id": 4306274, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/557974ba869c9e9b23b5f21e9518f83d?s=128&d=identicon&r=PG&f=1", "display_name": "chaosink", "link": "https://stackoverflow.com/users/4306274/chaosink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 3, "accepted_answer_id": 44928071, "answer_count": 1, "score": 6, "last_activity_date": 1499263235, "creation_date": 1499261758, "last_edit_date": 1499262566, "question_id": 44927829, "link": "https://stackoverflow.com/questions/44927829/how-is-the-comma-separated-initializer-of-opencv-mat-implemented-with-c", "title": "How is the comma-separated initializer of OpenCV Mat implemented with C++?", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;opencv2/opencv.hpp&gt;\n\nusing namespace std;\nusing namespace cv;\n\nint main() {\n    Mat a = (Mat_&lt;double&gt;(3, 3) &lt;&lt; 0, 1, 2, 3, 4, 5, 6, 7, 8);\n\n    cout &lt;&lt; a &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>How is the comma-separated initializer of OpenCV Mat implemented with C++?</p>\n\n<p>How does the \"1\" get into the Mat after the \"0\"?</p>\n"}, {"tags": ["c++", "xml", "msxml"], "owner": {"reputation": 43, "user_id": 8254730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c821c838bbf8774cb3a2d31774153d3?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas D.", "link": "https://stackoverflow.com/users/8254730/nicolas-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1616951801, "creation_date": 1499261741, "last_edit_date": 1616951801, "question_id": 44927823, "link": "https://stackoverflow.com/questions/44927823/how-to-have-msxml-4-0-write-xa-in-xml-instead-of-crlf", "title": "How to have MSXML 4.0 write &amp;#xA; in XML instead of CR+LF?", "body": "<p>I have seen several questions about reading end-of-line or writing end-of-line for pretty formatting. It doesn't help me as I don't want to write end-of-lines but to escape them in a value.</p>\n<p>I have the following code to write a tag value in a XML file, using MSXML 4.0:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>    a_pIXMLDOMElement-&gt;Puttext ( l_VarText );\n</code></pre>\n<p><code>a_pIXMLDOMElement</code> is a <code>MSXML2::IXMLDOMElementPtr&amp;</code>.\nIt doesn't escape correctly end-of-lines: when <code>l_VarText</code> contains a CR, or a CR+LF or a LF, the resulting tag's value in the XML file contains CR+LF instead of <code>&amp;#xA;</code>.</p>\n<p>I have tried with <code>preserveWhiteSpace</code> set to <code>true</code> on <code>MSXML2::IXMLDOMDocument2Ptr</code> just after creating it, it changes nothing (original code was setting it to <code>false</code>).</p>\n<p>I have tried to escape the end-of-line myself before calling <code>Puttext</code>, the result is that instead of <code>&amp;#xA;</code> I got <code>&amp;amp;#xA;</code> in the tag value (MSXML escapes correctly the <code>&amp;</code>, so it mess up my escaping of end-of-lines).</p>\n<p>How to correctly escape end-of-lines while writing XML tag values with MSXML 4.0?</p>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1499261524, "post_id": 44927716, "comment_id": 76830931, "body": "No, you can&#39;t change <code>vector</code>.  Sounds like an XY problem though.  What is it that you actually need to accomplish?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1499261626, "post_id": 44927716, "comment_id": 76831018, "body": "Can&#39;t you put the checks you need to do <i>outside</i> the function, so you only call <code>push_back</code> with the right conditions matched?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1499261635, "post_id": 44927716, "comment_id": 76831027, "body": "If you are getting a compiler error with your code please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that generates that error."}, {"owner": {"reputation": 1515, "user_id": 6615552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/952cbb61ab387e04b000590e294c9fe8?s=128&d=identicon&r=PG&f=1", "display_name": "21koizyd", "link": "https://stackoverflow.com/users/6615552/21koizyd"}, "edited": false, "score": 0, "creation_date": 1499261658, "post_id": 44927716, "comment_id": 76831043, "body": "I want check size element which is <code>push_back</code> to container and add when he perform some condition."}], "answers": [{"tags": [], "owner": {"reputation": 935, "user_id": 5033969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c48d36998d3454bf1c3a847b5938f9b7?s=128&d=identicon&r=PG&f=1", "display_name": "arturx64", "link": "https://stackoverflow.com/users/5033969/arturx64"}, "is_accepted": false, "score": 2, "last_activity_date": 1499261839, "last_edit_date": 1499261839, "creation_date": 1499261731, "answer_id": 44927819, "question_id": 44927716, "link": "https://stackoverflow.com/questions/44927716/how-to-override-stl-container-function/44927819#44927819", "title": "how to override STL container function", "body": "<p>Inheritance for STL containers is bad approach. The vector is not supposed to have derived classes. There are no virtual method in the vector and virtual destructor ( the last one could make a lot of problems ).\nYou can create your own class and use vector as member. </p>\n"}, {"tags": [], "owner": {"reputation": 16382, "user_id": 5507349, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IaCUb.jpg?s=128&g=1", "display_name": "Edgar Rokj\u0101n", "link": "https://stackoverflow.com/users/5507349/edgar-rokj%c4%81n"}, "is_accepted": true, "score": 2, "last_activity_date": 1499262864, "last_edit_date": 1499262864, "creation_date": 1499261861, "answer_id": 44927877, "question_id": 44927716, "link": "https://stackoverflow.com/questions/44927716/how-to-override-stl-container-function/44927877#44927877", "title": "how to override STL container function", "body": "<p>Overriding means that you are going to inherit from <em>STL</em> container. Don't do that! <em>STL</em> containers are not designed for inheriting from them.</p>\n\n<hr>\n\n<p>As an option, you might encapsulate <em>std::vector</em> into some wrapper class and perform additional functionality before pushing, something like:</p>\n\n<pre><code>template&lt;typename T&gt;\nclass Wrapper\n{\npublic:\n    template&lt;typename U&gt;\n    void push(U&amp;&amp; e)\n    {\n         // some additional processing\n         data.push_back(std::forward&lt;U&gt;(e));\n    }\n\nprivate:\n    std::vector&lt;T&gt; data;\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 0, "last_activity_date": 1499262008, "creation_date": 1499262008, "answer_id": 44927930, "question_id": 44927716, "link": "https://stackoverflow.com/questions/44927716/how-to-override-stl-container-function/44927930#44927930", "title": "how to override STL container function", "body": "<p>You cant do that. Most classes in the <code>std</code> library are not meant to be inherited from. However, instead of changing it \"from the inside\" just do it \"from the outside\", for example:</p>\n\n<pre><code>template&lt;typename T&gt; myPush(std::vector&lt;T&gt;&amp; v,T element) {\n    if (someCondition()) { v.push(element); }\n}\n</code></pre>\n\n<p>Alternatively, you could do this:</p>\n\n<pre><code>struct MyCustomVector {\n     void my_push( T element);\n     /* pulic or private: */          // depends on what you want/need\n     std::vector&lt;T&gt; vect;\n};\n</code></pre>\n"}], "owner": {"reputation": 1515, "user_id": 6615552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/952cbb61ab387e04b000590e294c9fe8?s=128&d=identicon&r=PG&f=1", "display_name": "21koizyd", "link": "https://stackoverflow.com/users/6615552/21koizyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 975, "favorite_count": 0, "accepted_answer_id": 44927877, "answer_count": 3, "score": 0, "last_activity_date": 1499262864, "creation_date": 1499261478, "last_edit_date": 1499261695, "question_id": 44927716, "link": "https://stackoverflow.com/questions/44927716/how-to-override-stl-container-function", "title": "how to override STL container function", "body": "<p>It's possible, that override some function stl container with the same paremeters?\nI want override exactly <code>push_back</code> with some <code>if</code> inside function.\nI try but, always have error/information about that function is in vector.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 4, "creation_date": 1499261541, "post_id": 44927684, "comment_id": 76830943, "body": "why is there a <code>new</code> in your code? Or even more surprisingly, why do you have pointers to iterators?? You are returning a pointer to a iterator to a list that lives in the scope of the function. That pointer is garbage outside of the function (adding more <code>*</code> wont help)"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1499261690, "post_id": 44927684, "comment_id": 76831076, "body": "maybe the missing hint is: <code>openedTags</code> is not on the heap but on the stack and gets destroyed when the mehtod returns"}, {"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1499261695, "post_id": 44927684, "comment_id": 76831080, "body": "First get rid of pointers to iterator and decrement it like <code>--it;</code> instead."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1499261799, "post_id": 44927684, "comment_id": 76831154, "body": "Following @tobi303 The problem then is not the pointer per se (although unusual), but passing the list not as (const) reference..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1499262087, "post_id": 44927684, "comment_id": 76831375, "body": "Additionally, this kind of design offers greate opportunity for memory leaks - deleting the iterator object after not being needed any more is easily forgotten."}], "answers": [{"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": true, "score": 1, "last_activity_date": 1499263711, "last_edit_date": 1499263711, "creation_date": 1499263397, "answer_id": 44928460, "question_id": 44927684, "link": "https://stackoverflow.com/questions/44927684/pointer-overwritten-after-end-of-the-function/44928460#44928460", "title": "Pointer overwritten after end of the function", "body": "<p>The problem is passing the list by value:</p>\n\n<pre><code>QLinkedList&lt;hTag&gt;::iterator *lookForLastHTag(hTags tag, QLinkedList&lt;hTag&gt; openedTags)\n//                                                                      ^^\n</code></pre>\n\n<p>This results in a copy of the list being created, which is destroyed again as soon as control flow returns from the function.</p>\n\n<p>The iterator instance you return then refers a list that does not exist any more, if you use it, you end in undefined behaviour.</p>\n\n<p>To avoid this, you need to pass your list as either reference or pointer, preferrably a const one (as you do not modify it; however, you need to return a const_iterator then, too):</p>\n\n<pre><code>QLinkedList&lt;hTag&gt;::const_iterator* lookForLastHTag(hTags tag, QLinkedList&lt;hTag&gt; const&amp; openedTags)\n//                 ^                                                            ^    ^(!!!)\n</code></pre>\n\n<p>Then your iterator object will point to the original list as being passed to the function and you are fine with this first point.</p>\n\n<p>Additionally, you implemented a memory leak: If no element is found, the iterator remains unused, so you must delete it again before returning:</p>\n\n<pre><code>delete i;\nreturn nullptr;\n</code></pre>\n\n<p>Still, there is some non-negligible risk a user creating further memory leaks by forgetting to delete the returned pointer when not needed any more, especially, as this is a <em>very</em> unusual way to use iterators (sure, not your responsibility any more, but you can avoid this right from the start by better design):</p>\n\n<pre><code>QLinkedList&lt;hTag&gt;::const_iterator lookForLastHTag(hTags tag, QLinkedList&lt;hTag&gt; const&amp; openedTags)\n//                               ^ (no pointer!)\n{\n    QLinkedList&lt;hTag&gt;::const_iterator i = openTags.end();\n    while(i != openTags.begin())\n    {\n         --i;\n         if(i-&gt;tag == tag)\n             return i;\n    }\n    return openTags.end();\n}\n</code></pre>\n\n<p>As side effect, the code got less complicated, won't you agree?</p>\n\n<p>Side note: you might want to have a look at <a href=\"http://en.cppreference.com/w/cpp/algorithm/find\" rel=\"nofollow noreferrer\">std::find</a> instead; no need for re-inventing the wheel...</p>\n"}], "owner": {"reputation": 530, "user_id": 3371749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U2fVx.png?s=128&g=1", "display_name": "LuxGiammi", "link": "https://stackoverflow.com/users/3371749/luxgiammi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 44928460, "answer_count": 1, "score": -2, "last_activity_date": 1499266784, "creation_date": 1499261389, "last_edit_date": 1499266784, "question_id": 44927684, "link": "https://stackoverflow.com/questions/44927684/pointer-overwritten-after-end-of-the-function", "title": "Pointer overwritten after end of the function", "body": "<p>I have this function:</p>\n\n<pre><code>QLinkedList&lt;hTag&gt;::iterator *lookForLastHTag(hTags tag, QLinkedList&lt;hTag&gt; openedTags){\n    QLinkedList&lt;hTag&gt;::iterator *i = new QLinkedList&lt;hTag&gt;::iterator();\n    *i = openedTags.end();\n    while(*i != openedTags.begin()){\n        *i-=1;\n        if ((*(*i)).tag == tag)\n            return i;\n\n    }\n    return nullptr;\n}\n</code></pre>\n\n<p>written with the QT framework. It searches backwards through a singly linked list of <code>hTag</code>, a specific tag in an enumeration called <code>hTags</code> (please note that the former one is a struct and the second one is an enum class).</p>\n\n<p>The <code>hTag</code> struct is defined this way:</p>\n\n<pre><code>struct hTag{\n    hTags tag;\n    int hierarchy;\n};\n</code></pre>\n\n<p>whereas the hTags enum class just defines some tags.</p>\n\n<p>The problem is that, after the function returns the <code>i</code> pointer, it gets weirdly overwritten by other data. I don't understand that since I've allocated space dynamically in the heap for that iterator <em>just to avoid this problem</em>. I don't understand why the content of the pointer <code>i</code> (not the thing it points to, the 32-bit number inside <code>i</code>) is returned correctly (in the sense that the 32-bit number inside the pointer is correctly copied outside the function). However, the content of <code>i</code> (the pointee) isn't. Just after the end of the function, it gets overwritten with junk <strong>even if it's declared on the heap and <em>shouldn't</em> be influenced by the end of the function</strong>.</p>\n\n<p>Could you please help me sorting that problem out?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "c", "windows", "exe", "portable-executable"], "answers": [{"comments": [{"owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "edited": false, "score": 0, "creation_date": 1499325034, "post_id": 44931110, "comment_id": 76859769, "body": "thank you for reply :) but even if code is added, only the <code>VirtualSize</code> of <code>.txt</code> section would be loaded when executing right?"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "edited": false, "score": 0, "creation_date": 1499327244, "post_id": 44931110, "comment_id": 76861144, "body": "Difficult to say if any control is made on the size. Considering that the section itself will be extended to a multiple of architecture page (PECOFF spec), some OS versions loaders could simply copy the whole block. <b>But anyway after so heavy modifications to change also the <code>VirtualSize</code> value is not a big deal...</b>"}, {"owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "edited": false, "score": 0, "creation_date": 1499327623, "post_id": 44931110, "comment_id": 76861389, "body": "So your saying that <code>VirtualSize</code> isn&#39;t a big deal and loader will copy the whole block, meaning it will extend actual <code>.txt</code> section to a architecture page. Does this mean that <code>.txt</code> sections size which will be loaded will always be <code>RawDataSize</code>? Sorry if I misunderstood soemthing."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "edited": false, "score": 0, "creation_date": 1499329156, "post_id": 44931110, "comment_id": 76862397, "body": "I didn&#39;t say that. I said that after copying the data in the file, modifying also the <code>virtualSize</code> field at offset 0x8 adding the size of copied data cold be done to be sure the it will be loaded. <b>But at this point I really think we have talked too much of something that is not standard coding, and shouldn&#39;t be discussed because useful for bad practices.</b>"}], "tags": [], "owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1499270557, "creation_date": 1499270557, "answer_id": 44931110, "question_id": 44927518, "link": "https://stackoverflow.com/questions/44927518/pe-adding-code-at-the-end-of-txt-section/44931110#44931110", "title": "PE: Adding code at the end of .txt section", "body": "<p>Uhmmm, this hack code seems crafted to hide malicious code between sections.</p>\n\n<p>Going to your question, you are correct VirtualSize is the space really allocated in memory and RawSize is the the space used on disk to hold the section data.\nWhat you missed is (from MS PECOFF spec):</p>\n\n<blockquote>\n  <p><code>VirtualSize</code>:    The total size of the section when loaded into memory. If this value is greater than <code>SizeOfRawData</code>, the section is zero-padded. This field is valid only for executable images and should be set to zero for object files.</p>\n</blockquote>\n\n<p>This means that <strong>if a the result of <code>SizeOfRawData</code>-<code>VirtualSize</code> is positive we have some space available on disk actually filled with 0's</strong>.</p>\n\n<p>If that space is enough to hold the malicious code then adding the start of text section on disk with the <code>VirtualSize</code> you can get the start of 0's padded area that can be used to copy the code.</p>\n\n<p>The rest is story...</p>\n"}, {"comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1499468523, "post_id": 44958653, "comment_id": 76936917, "body": "<code>VirtualSize represents the unrounded size of the section</code> this absolute wrong. <code>VirtualSize</code> - this how many memory reserved for section. <code>SizeOfRawData</code> - this is how many bytes have section on disk. for example section (<code>.bss</code>) have uninitialized data - in this case <code>SizeOfRawData</code> will be 0 - so <code>VirtualSize</code> &gt; <code>SizeOfRawData</code>. from another size, because <code>SizeOfRawData</code> rounded to FileAligment (usual 512 bytes) can be and <code>VirtualSize &lt; SizeOfRawData</code>."}, {"owner": {"reputation": 1075, "user_id": 5377688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NpeXm.png?s=128&g=1", "display_name": "byteptr", "link": "https://stackoverflow.com/users/5377688/byteptr"}, "edited": false, "score": 0, "creation_date": 1499542970, "post_id": 44958653, "comment_id": 76955010, "body": "The question wasn&#39;t about uninitialized data sections where SizeOfRawData=0; even in that case VirtualSize is still going to be the unrounded size of the section &quot;in memory&quot;, there is just nothing to copy from disk. In almost any other case, the statement I made is a true implementation detail.  I agree its confusing and appears contrary to the spec, but this statement reflects how the MS Linker (and linkers that copied their behavior) are implemented. This also includes GNU and Borland Linkers.  Also note that a linker could round VirtualSize and still have a working executable."}, {"owner": {"reputation": 1075, "user_id": 5377688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NpeXm.png?s=128&g=1", "display_name": "byteptr", "link": "https://stackoverflow.com/users/5377688/byteptr"}, "edited": false, "score": 0, "creation_date": 1499543171, "post_id": 44958653, "comment_id": 76955064, "body": "As a side note on legacy behavior, Borland TLINK 4.x (from the early 90s) had VirtualSize and SizeOfRawData interchanged"}], "tags": [], "owner": {"reputation": 1075, "user_id": 5377688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NpeXm.png?s=128&g=1", "display_name": "byteptr", "link": "https://stackoverflow.com/users/5377688/byteptr"}, "is_accepted": true, "score": 1, "last_activity_date": 1499457271, "last_edit_date": 1499457271, "creation_date": 1499374370, "answer_id": 44958653, "question_id": 44927518, "link": "https://stackoverflow.com/questions/44927518/pe-adding-code-at-the-end-of-txt-section/44958653#44958653", "title": "PE: Adding code at the end of .txt section", "body": "<p>This is a great question and illustrates a very important point (or you might say quirk) about how the Windows loader calculates memory sizes.</p>\n\n<p>The PE/COFF spec does indeed describe VirtualSize as \"The total size of the section when loaded into memory\".  This is technically true if you consider total to be the total amount of REAL data that comprises the section, but it is not the total amount of memory Windows allocates for the section.  You'll find VirtualSize is often LESS than the amount Windows allocates for the section in memory because VirtualSize must be rounded UP to the nearest memory alignment value (set in the PE image).</p>\n\n<p>In other words, VirtualSize represents the unrounded size of the section while SizeOfRawData is the size of the data in the image file, but rounded up to the nearest file alignment padding value.  This is the reason VirtualSize is the better representation of the true \"raw\" size of the data, in memory or on disk.  The PE/COFF spec does not make this distinction.  Why one is rounded in the image file and not the other probably has its ancient roots in backwards compatibility.</p>\n\n<p>This is precisely why your shellcode uses VirtualSize to find the \"real\" end of data even as it resides in the image file.  Not surprisingly, you can calculate SizeOfRawData by rounding VirtualSize up to the file alignment's value, at least in well formed PE files.</p>\n\n<p>The shellcode simply used VirtualSize to find the end of the REAL code.  Between there and SizeOfRawData bytes, are just unused padding zeroes, making it a prime spot to add new code without affecting the size of the file or breaking addressing offsets within the PE file.</p>\n\n<p>In summary, the Windows loader essentially takes the VirtualSize value and rounds it up to the memory alignment value to get the real size of the memory allocation (and even this may be rounded up to the nearest 4k-minimum memory page).  Then up to SizeOfRawData bytes are copied from the file to the beginning of the memory section.  If it is less than the size of the section in memory, the remainder is zero filled.</p>\n"}], "owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1698, "favorite_count": 1, "accepted_answer_id": 44958653, "answer_count": 2, "score": 4, "last_activity_date": 1499457271, "creation_date": 1499260983, "last_edit_date": 1499262837, "question_id": 44927518, "link": "https://stackoverflow.com/questions/44927518/pe-adding-code-at-the-end-of-txt-section", "title": "PE: Adding code at the end of .txt section", "body": "<p>As I understand in <code>PE</code> file Virtual Size shows how much space it allocates for section during loading and Raw Size shows how big the section is on disk.</p>\n\n<p>I came across to this executable which did the following:</p>\n\n<p>It subtracted the virtual size (<code>offset 0x8</code>) from the raw data size (<code>offset 0x10</code>) and made sure there was some space(for example 100 bytes). At offset <code>0x14</code> from the text section header it found the offset in the file for the section itself. It added to this the virtual size, finding right where the section ends in the file. it copied some shellcode(which at the end eventually jumped to the original entry point of an executable to make sure original executable ran) to the end of the text section of the binary.</p>\n\n<p>Now I'm little confused here, if the Virtual Size shows the exact space which will be allocated for executable, would not adding code at the end of <code>.txt</code> section overwrite some other data of executable and make it crash? thanks.</p>\n"}, {"tags": ["c++", "java-native-interface"], "answers": [{"tags": [], "owner": {"reputation": 4346, "user_id": 6375113, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JHg5K.jpg?s=128&g=1", "display_name": "Bugs", "link": "https://stackoverflow.com/users/6375113/bugs"}, "is_accepted": true, "score": 0, "last_activity_date": 1499265124, "creation_date": 1499265124, "answer_id": 44929134, "question_id": 44927375, "link": "https://stackoverflow.com/questions/44927375/jvm-cant-find-class-when-using-jni-from-c/44929134#44929134", "title": "JVM can&#39;t find class when using JNI from C++", "body": "<p>Moved solution from question to answer:</p>\n\n<blockquote>\n  <p><strong>SOLUTION:</strong> I had to add the maven dependencies' JARs to the classpath. Now it works!</p>\n</blockquote>\n"}], "owner": {"reputation": 198, "user_id": 6639989, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH3gXjhHwGo/AAAAAAAAAAI/AAAAAAAAAHc/6NWjrnd-lkY/photo.jpg?sz=128", "display_name": "J&#225;nos Benjamin Antal", "link": "https://stackoverflow.com/users/6639989/j%c3%a1nos-benjamin-antal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 2, "accepted_answer_id": 44929134, "answer_count": 1, "score": 3, "last_activity_date": 1499265229, "creation_date": 1499260563, "last_edit_date": 1499265150, "question_id": 44927375, "link": "https://stackoverflow.com/questions/44927375/jvm-cant-find-class-when-using-jni-from-c", "title": "JVM can&#39;t find class when using JNI from C++", "body": "<p>I'm trying to call JAVA methods from C++ by JNI. First of all, I got <a href=\"https://www.codeproject.com/Articles/993067/Calling-Java-from-Cplusplus-with-JNI\" rel=\"nofollow noreferrer\">this</a> example, tried it out. I changed the path of JDK and after that I could run the examples and they properly worked.</p>\n\n<p>After that, I tried to import my own JAR file and use one class from it. I copied the code from the example and replaced the classpath and classname with my own:</p>\n\n<pre><code>void MyCPPClass::CallJava()\n{\n    JavaVM *jvm;                // Pointer to the JVM (Java Virtual Machine)\n    JNIEnv *env;                // Pointer to native interface\n\n    //==================== prepare loading of Java VM ============================\n\n    JavaVMInitArgs vm_args;                        // Initialization arguments\n    JavaVMOption* options = new JavaVMOption[ 1 ];   // JVM invocation options\n    options[ 0 ].optionString = \"-Djava.class.path=MyJar.jar\";   // where to find java .class\n    vm_args.version = JNI_VERSION_1_8;             // minimum Java version\n    vm_args.nOptions = 1;                          // number of options\n    vm_args.options = options;\n    vm_args.ignoreUnrecognized = false;     // invalid options make the JVM init fail\n\n    //================= load and initialize Java VM and JNI interface ===============\n\n    jint rc = JNI_CreateJavaVM( &amp;jvm, (void**)&amp;env, &amp;vm_args );  // YES !!\n    delete options;    // we then no longer need the initialisation options. \n\n    //========================= analyse errors if any  ==============================\n    // if process interuped before error is returned, it's because jvm.dll can't be \n    // found, i.e.  its directory is not in the PATH. \n\n    if( rc != JNI_OK )\n    {\n        exit( EXIT_FAILURE );\n    }    \n\n    jclass cls1 = env-&gt;FindClass( \"aaa/bbb/MyClass\" );\n    ...\n}\n</code></pre>\n\n<p>The JAR contains only one class <code>aaa.bbb.MyClass</code> and it's made with IntelliJ IDEA and <code>mvn package</code> command. I copied the JAR file next to my executable.</p>\n\n<p>A value of <code>rc</code> is always 0 (<code>JNI_OK</code>), but the value of <code>cls1</code> is always <code>NULL</code>. I think that JVM can find the JAR, because when I'm debugging I can't delete the JAR after <code>FindClass</code>.</p>\n\n<p>The JAR file contains the MyClass.class file, I checked it. </p>\n\n<p>I have checked some previous questions ( <a href=\"https://stackoverflow.com/questions/40911447/load-jar-file-in-c-using-jni\">1</a>, <a href=\"https://stackoverflow.com/questions/17989206/how-to-load-jar-file-in-c-using-jni\">2</a>, <a href=\"https://stackoverflow.com/questions/2025397/can-c-application-load-the-jar-file-using-jni\">3</a> and some others) yet, but I couldn't get where I made a mistake.</p>\n\n<p><strong>UPDATE:</strong> I tried to copy the MyClass.class file and MyJar.jar file into the directory of the example linked before, and JVM can't find <code>MyClass</code>. It's possible that something missing from my java source file? The package declaration is correct.</p>\n\n<p>What can cause that JVM can't find <code>MyClass</code>?</p>\n"}, {"tags": ["c++", "boost", "cmake", "static-linking"], "comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499263617, "post_id": 44927372, "comment_id": 76832527, "body": "Show complete linker command line that results in error. That <code>libinfinite.a</code> needs to precede the boost libraries in the command line."}, {"owner": {"reputation": 707, "user_id": 4066425, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/328007af45eea53b3f0fe7210f4bcc70?s=128&d=identicon&r=PG&f=1", "display_name": "stack user", "link": "https://stackoverflow.com/users/4066425/stack-user"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1499265305, "post_id": 44927372, "comment_id": 76833910, "body": "That libinfinite.a needs to precede the boost libraries in the command line - this solved the problem - thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1499265550, "creation_date": 1499265550, "answer_id": 44929316, "question_id": 44927372, "link": "https://stackoverflow.com/questions/44927372/references-undefined-when-linking-against-boost-1-63-static-libs/44929316#44929316", "title": "references undefined when linking against boost 1.63 static libs", "body": "<p>That <code>libinfinite.a</code> needs to precede the boost libraries in the command line.</p>\n"}], "owner": {"reputation": 707, "user_id": 4066425, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/328007af45eea53b3f0fe7210f4bcc70?s=128&d=identicon&r=PG&f=1", "display_name": "stack user", "link": "https://stackoverflow.com/users/4066425/stack-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 769, "favorite_count": 0, "accepted_answer_id": 44929316, "answer_count": 1, "score": 0, "last_activity_date": 1499265550, "creation_date": 1499260555, "last_edit_date": 1499262990, "question_id": 44927372, "link": "https://stackoverflow.com/questions/44927372/references-undefined-when-linking-against-boost-1-63-static-libs", "title": "references undefined when linking against boost 1.63 static libs", "body": "<p>I'm linking against boost statically.  When I do so, I get some undefined reference errors (below).</p>\n\n<pre><code>[100%] Linking CXX executable infiniteTests\n/home/wdog/src/protos/infinite/libinfinite.a(ServiceDiscovery.cpp.o): In function `boost::date_time::month_formatter&lt;boost::gregorian::greg_month, boost::date_time::simple_format&lt;char&gt;, char&gt;::format_month(boost::gregorian::greg_month const&amp;, std::ostream&amp;)':\n/home/wdog/src/3rdp/boost_1_63_0/boost/date_time/date_formatting.hpp:44: undefined reference to `boost::gregorian::greg_month::as_short_string() const'\n/home/wdog/src/3rdp/boost_1_63_0/boost/date_time/date_formatting.hpp:49: undefined reference to `boost::gregorian::greg_month::as_long_string() const'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>When I link dynamically, the references are presumably present, and the build links successfully.</p>\n\n<p>I need to be able to build this statically; requirement of the project.</p>\n\n<p>I'm building with cmake.  My link directories are ordered thus:</p>\n\n<pre><code>link_directories(\n    $ENV{PROJECT_LIB_DIR}\n    $ENV{BOOST_LIBRARY_DIR}\n    $ENV{HIREDIS_LIB_DIR}\n    $ENV{LIBEVENT_LIB_DIR}\n    $ENV{PROJECT_ROOT}\n    /usr/lib\n    /usr/local/lib\n)\n</code></pre>\n\n<p>My target link libaries are defined as:</p>\n\n<pre><code>target_link_libraries(\n    ${sThisProject}\n    ${Boost_LIBRARIES}\n    libhiredis.a\n    libevent.a\n    libevent_core.a\n    libevent_pthreads.a\n    libssl.so\n    libcrypto.so\n    libpthread.so.0\n)\n</code></pre>\n\n<p>Here's the CMakeLists.txt entry where I find boost:</p>\n\n<pre><code>find_package( Boost 1.63 EXACT REQUIRED COMPONENTS system chrono date_time filesystem program_options regex thread REQUIRED )\n</code></pre>\n\n<p>I also set the following:</p>\n\n<pre><code>SET (Boost_NO_SYSTEM_PATHS ON)\nSET (Boost_USE_STATIC_LIBS ON)\nSET (Boost_USE_MULTITHREADED ON)\nSET (Boost_USE_STATIC_RUNTIME ON)\n</code></pre>\n\n<p>I've checked that my build of 1.63 has successfully built the appropriate static lib - libboost_date_time.a - and it's present in ${BOOST}/stage/lib/</p>\n\n<p>It's my understanding that this can happen if the linker finds a boost static lib on the system install before the correct path.  </p>\n\n<p>Cmake appears to find the correct path for boost 1_63:</p>\n\n<p>(output during build:)</p>\n\n<pre><code>-- Boost version: 1.63.0\n-- Found the following Boost libraries:\n--   system\n--   chrono\n--   date_time\n--   filesystem\n--   program_options\n--   regex\n--   thread\n</code></pre>\n\n<p>I run fedora 25, so my system installed version of boost was 1_60, so to avoid the above problem, I uninstalled it completely:</p>\n\n<pre><code>sudo dnf remove boost boost-atomic boost-chrono boost-container boost-context boost-coroutine boost-date-time boost-devel boost-filesystem boost-graph boost-iostreams boost-locale boost-log boost-math boost-program-options boost-python boost-random boost-regex boost-serialization boost-signals boost-system boost-test boost-thread boost-timer boost-type_erasure boost-wave\n</code></pre>\n\n<p>I built but do not install 1.63 in a 3rd party directory in my source tree.  It's built with the following commands:</p>\n\n<pre><code>./bootstrap.sh\n./b2 -j8\n</code></pre>\n\n<p>I set linker output with:</p>\n\n<pre><code>SET (CMAKE_EXE_LINKER_FLAGS -v)\n</code></pre>\n\n<p>And determined via the following output that I'm linking against the correct static libary:</p>\n\n<pre><code>-o\n...\n/home/wdog/src/3rdp/boost_1_63_0/stage/lib/libboost_system.a\n/home/wdog/src/3rdp/boost_1_63_0/stage/lib/libboost_chrono.a\n**/home/wdog/src/3rdp/boost_1_63_0/stage/lib/libboost_date_time.a**\n/home/wdog/src/3rdp/boost_1_63_0/stage/lib/libboost_filesystem.a\n/home/wdog/src/3rdp/boost_1_63_0/stage/lib/libboost_program_options.a\n/home/wdog/src/3rdp/boost_1_63_0/stage/lib/libboost_regex.a\n/home/wdog/src/3rdp/boost_1_63_0/stage/lib/libboost_thread.a\n...\n</code></pre>\n\n<p>I've run out of ideas; is there something else I should check?</p>\n"}, {"tags": ["c++", "sparse-matrix", "armadillo"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1499260972, "post_id": 44927354, "comment_id": 76830492, "body": "wouldnt it be more efficient to simply leave the coefficients as they are? Whatever you win on AxB you have to invest for finding and manipulating the coefficients. In other words: How do you know that this will be an improvement?"}, {"owner": {"reputation": 111, "user_id": 7648144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cd685ecc7faf140098c94dad7f0f56df?s=128&d=identicon&r=PG&f=1", "display_name": "jack.l", "link": "https://stackoverflow.com/users/7648144/jack-l"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1499262063, "post_id": 44927354, "comment_id": 76831358, "body": "If you use the algorithm every, say, 10 time steps of the ODE solver you can save computation time, at least in theory.  There is a balance between the frequency with which you assess the significance of the terms, the number of terms that fail the threshold test, and the time saving capacity of this algorithm.  But obviously the more efficiently you locate and remove terms, the more situations in which it could reduce the overall computation time."}], "owner": {"reputation": 111, "user_id": 7648144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cd685ecc7faf140098c94dad7f0f56df?s=128&d=identicon&r=PG&f=1", "display_name": "jack.l", "link": "https://stackoverflow.com/users/7648144/jack-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1499260518, "creation_date": 1499260518, "question_id": 44927354, "link": "https://stackoverflow.com/questions/44927354/how-to-efficiently-remove-non-zero-elements-sprase-matrix-c", "title": "How to efficiently &#39;remove&#39; non-zero elements sprase matrix C++", "body": "<p>I've been working on an algorithm for removing non-zero elements from a large sparse (ish) matrix as a way of decreasing the computation time of a numerical solution to a large system of coupled ODEs of the form of the <a href=\"https://en.wikipedia.org/wiki/Logistic_function\" rel=\"nofollow noreferrer\">logistic equation</a>. </p>\n\n<p>The basic idea is that every T timesteps you assess which elements in the state matrix, B, are greater than some threshold. FOr those deemed insignificant (i.e. below the threshold) you remove (set to zero) the associated row/column in the sparse interaction matrix, A, so that the computation of AxB will require fewer flops.(Note the diagonal remains non-zero so that the associated elements of the state matrix do not blow up)</p>\n\n<p>The algorithm is as follows:</p>\n\n<ol>\n<li><p>Scan through B vector for elements less that thresh and record locations</p></li>\n<li><p>Iterate through non-zero elements of A matrix corresponding to locations recorded in 1. and record locations</p></li>\n<li>Set elements of A corresponding to locations recorded in 2. to zero.</li>\n</ol>\n\n<p>I need to separate steps 2. and 3. because if you set non-zero elements of a sparse matrix (arma::sp_mat) to zero, you destroy the iterators and therefore can't achieve the result in a single pass.</p>\n\n<p>Can anyone offer any suggestions as to how to improve this algorithm?</p>\n\n<p>(Note I'm not a computer scientist and so there may be an obvious improvement I'm not aware of.  MMMMMany thanks for trying!!)</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;armadillo&gt;\n\n\nusing namespace std;\nusing namespace arma;\nint main() {\n\nmat A = {{1, 0.2, 0, 0.2, 0, 0, 0.2, 0, 0.2, 0},\n         {0, 1, 0.2, 0, 0.2, 0, 0, 0.2, 0 , 0},\n         {0, 0, 1, 0.2, 0, 0, 0.2, 0, 0, 0.2},\n         {0.2, 0, 0, 1, 0.2, 0, 0.2, 0.2, 0, 0.2},\n         {0, 0.2, 0, 0.2, 1, 0.2, 0, 0, 0, 0.2},\n         {0, 0, 0.2, 0, 0.2, 1, 0, 0.2, 0, 0},\n         {0.2, 0, 0, 0.2, 0.2, 0, 1, 0, 0, 0.2},\n         {0, 0.2, 0, 0.2, 0, 0, 0, 1, 0.2, 0},\n         {0, 0, 0.2, 0, 0.2, 0.2, 0, 0, 1, 0},\n         {0, 0, 0, 0.2, 0, 0.2, 0, 0, 0.2, 1}};\nsp_mat Asp(A); // Interaction matrix in sparse representation\n\nvec B = {1, 1, 0.1, 1, 0.1, 1, 1, 0.1, 1, 1};\n\ndouble thresh = 0.2;\n\nvec index(Asp.n_rows); // obj for storing locations of insignificant elements b\n\nint count = 0;\nfor (int i=0; i&lt;B.n_rows; i++) {\n    if (B(i) &lt; thresh) {\n        index(count) = i;\n        count ++;\n    }\n}\n\nindex.resize(count);\n\nsp_mat tmp = Asp; // temp copy of interaction matrix\n\nfor (int i=0; i&lt;index.n_rows; i++) {\n    // iterate through non-zero elements in col corresponding to each element of index\n    sp_mat::iterator bc = tmp.begin_col(index(i));\n    sp_mat::iterator ec = tmp.end_col(index(i));\n\n    // iterate through non-zero elements in row corresponding to each element of index\n    sp_mat::row_iterator br = tmp.begin_row(index(i));\n    sp_mat::row_iterator er = tmp.end_row(index(i));\n\n    // mat for storing locations of non-zero elements to be removed\n    mat loc(2, 2 * tmp.n_cols);\n\n    int count2 = 0;\n    for (auto j = bc; j != ec; j++) {\n        loc(0, count2) = j.row();\n        loc(1, count2) = j.col();\n        count2++;\n    }\n\n    for (auto j = br; j != er; j++) {\n        loc(0, count2) = j.row();\n        loc(1, count2) = j.col();\n        count2++;\n    }\n\n    loc.resize(2, count2);\n\n    for (int j = 0; j &lt; loc.n_cols; j++) {\n        tmp(loc(0, j), loc(1, j)) = 0.0;\n    }\n}\n\ntmp.diag().ones();\n\ncout &lt;&lt; \"Number of non-zero terms interaction matrix = \" &lt;&lt; Asp.n_nonzero &lt;&lt; endl;\ncout &lt;&lt; \"Number of non-zero terms reduced matrix = \" &lt;&lt; tmp.n_nonzero &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Output: </p>\n\n<pre><code>Number of non-zero terms interaction matrix = 45\nNumber of non-zero terms reduced matrix = 24\n</code></pre>\n"}, {"tags": ["c++", "recursion", "variadic-templates"], "comments": [{"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1499261406, "post_id": 44927329, "comment_id": 76830836, "body": "I think this is the crux of the problem, but I don&#39;t want to answer without being absolutely sure. <a href=\"https://godbolt.org/g/G8WZbE\" rel=\"nofollow noreferrer\">godbolt.org/g/G8WZbE</a>. If I replace main with <code>&lt;int, int, int&gt;</code> it compiles: <a href=\"https://godbolt.org/g/sXTCBE\" rel=\"nofollow noreferrer\">godbolt.org/g/sXTCBE</a>. Same results with <code>-std=c++1z</code>. I think the compiler needs the types to be passed as parameters so that it can choose the right overload."}], "answers": [{"comments": [{"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1499261331, "post_id": 44927421, "comment_id": 76830776, "body": "This doesn&#39;t compile with gcc or clang once you put the main function in."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 1, "creation_date": 1499261939, "post_id": 44927421, "comment_id": 76831274, "body": "@MillieSmith: whoops, fixed my answer."}, {"owner": {"reputation": 23, "user_id": 5413121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A5Avwhqnewo/AAAAAAAAAAI/AAAAAAAAnMY/Z1h4r3I_Clc/photo.jpg?sz=128", "display_name": "Charles Blessing", "link": "https://stackoverflow.com/users/5413121/charles-blessing"}, "edited": false, "score": 0, "creation_date": 1499429262, "post_id": 44927421, "comment_id": 76915379, "body": "Thanks @VittorioRomeo, that makes perfect sense and also fixes the issue in my more specific case.  My confusion was in how the compiler interpreted the empty expansion - I didn&#39;t realise that an empty list could also match a ... argument, although now I think about it, it makes sense as that&#39;s how variadic function arguments work too."}], "tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": true, "score": 2, "last_activity_date": 1499261731, "last_edit_date": 1499261731, "creation_date": 1499260691, "answer_id": 44927421, "question_id": 44927329, "link": "https://stackoverflow.com/questions/44927329/termination-issue-on-recursive-template-function-in-variadic-template/44927421#44927421", "title": "Termination issue on recursive template function in variadic template", "body": "<p>You problem can be minimized as follows:</p>\n\n<pre><code>template&lt; typename ... Bases &gt;\nstruct Meta\n{\n    template&lt; typename T &gt;\n    void call(const T&amp; val)\n    {\n        callOnAllClasses&lt;T, Bases...&gt;(val);\n    }\n\n    template&lt; typename T, typename HeadClass &gt;\n    void callOnAllClasses(const T&amp; val)\n    {\n\n    }\n\n    template&lt; typename T, typename HeadClass, typename ... TailClasses &gt;\n    void callOnAllClasses(const T&amp; val)\n    {\n        callOnAllClasses&lt;T, TailClasses...&gt;(val);\n    }\n};\n\nstruct C : Meta&lt;int, int, int&gt; { };\n\nint main()\n{\n    C{}.call(5);\n}\n</code></pre>\n\n<p>When <code>TailClasses</code> is empty, both these signatures are ambiguous to the compiler:</p>\n\n<pre><code>template&lt; typename T, typename HeadClass &gt;\nvoid callOnAllClasses(const T&amp; val);\n\ntemplate&lt; typename T, typename HeadClass, typename ... TailClasses &gt;\nvoid callOnAllClasses(const T&amp; val);\n</code></pre>\n\n<p>Adding an extra template argument to the recursive case helps the compiler disambiguate between the variadic and non-variadic overloads when <code>TailClasses</code> is empty.</p>\n\n<pre><code>template&lt; typename T, typename HeadClass, typename T1, typename ... TailClasses &gt;\nvoid callOnAllClasses(const T&amp; val)\n{\n    auto pObj = dynamic_cast&lt;HeadClass*&gt;(this);\n    if ( pObj )\n        pObj-&gt;HeadClass::doSomething(val);\n    callOnAllClasses&lt;T, T1, TailClasses...&gt;(val);\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/g/GDLSSv\" rel=\"nofollow noreferrer\"><strong>live example on godbolt</strong></a></p>\n"}], "owner": {"reputation": 23, "user_id": 5413121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A5Avwhqnewo/AAAAAAAAAAI/AAAAAAAAnMY/Z1h4r3I_Clc/photo.jpg?sz=128", "display_name": "Charles Blessing", "link": "https://stackoverflow.com/users/5413121/charles-blessing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 44927421, "answer_count": 1, "score": 1, "last_activity_date": 1499261731, "creation_date": 1499260472, "question_id": 44927329, "link": "https://stackoverflow.com/questions/44927329/termination-issue-on-recursive-template-function-in-variadic-template", "title": "Termination issue on recursive template function in variadic template", "body": "<p>I am trying to create a utility class that will call a specific function on all classes in a list. The purpose behind this is to automate an element of reflection within a hierarchy of classes.</p>\n\n<p>I'm using Visual Studio 2015 to compile some C++ code and I'm getting a compile error when the recursive template function is unfolded because the compiler is having trouble distinguishing between the recursive function and the terminating function.</p>\n\n<p>I've extracted out the core of the class to a simple test case:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\ntemplate&lt; typename ... BaseClasses &gt;\nclass Meta\n{\npublic:\n    virtual ~Meta() {}\n\n    template&lt; typename T &gt;\n    void call(const T&amp; val)\n    {\n        callOnAllClasses&lt;T, BaseClasses...&gt;(val);\n    }\n\nprivate:\n    template&lt; typename T, typename HeadClass &gt;\n    void callOnAllClasses(const T&amp; val)\n    {\n        auto pObj = dynamic_cast&lt;HeadClass*&gt;(this);\n        if ( pObj )\n            pObj-&gt;HeadClass::doSomething(val);\n    }\n\n    template&lt; typename T, typename HeadClass, typename ... TailClasses &gt;\n    void callOnAllClasses(const T&amp; val)\n    {\n        auto pObj = dynamic_cast&lt;HeadClass*&gt;(this);\n        if ( pObj )\n            pObj-&gt;HeadClass::doSomething(val);\n        callOnAllClasses&lt;T, TailClasses...&gt;(val);\n    }\n};\n\nclass A\n{\npublic:\n    void doSomething(int i)\n    {\n        std::cout &lt;&lt; \"A:\" &lt;&lt; i &lt;&lt; std::endl;\n    }\n};\n\nclass B\n{\npublic:\n    void doSomething(int i)\n    {\n        std::cout &lt;&lt; \"B:\" &lt;&lt; i &lt;&lt; std::endl;\n    }\n};\n\nclass C : public B, public A, public Meta&lt;C,B,A&gt;\n{\n    public:\n    void doSomething(int i)\n    {\n        std::cout &lt;&lt; \"C:\" &lt;&lt; i &lt;&lt; std::endl;\n    }\n};\n\nint main()\n{\n    C c;\n    c.call(5);\n}\n</code></pre>\n\n<p>This results in the following error when compiled in Visual Studio 2015:</p>\n\n<pre><code>error C2668: 'Meta&lt;C,B,A&gt;::callOnAllClasses': ambiguous call to overloaded function\ncould be 'void Meta&lt;C,B,A&gt;::callOnAllClasses&lt;T,A,&gt;(const T &amp;)'\nor       'void Meta&lt;C,B,A&gt;::callOnAllClasses&lt;T,A&gt;(const T &amp;)'\n</code></pre>\n\n<p>I've never used variadic templates before so I'm at a bit of a loss as to why this might be going wrong. Any help would be much appreciated!</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499260539, "post_id": 44927299, "comment_id": 76830203, "body": "Do you want to detect when you get the last frame?"}, {"owner": {"reputation": 11, "user_id": 7840368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760eb23586b070670da41d51fe617f96?s=128&d=identicon&r=PG&f=1", "display_name": "Rex", "link": "https://stackoverflow.com/users/7840368/rex"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499260619, "post_id": 44927299, "comment_id": 76830255, "body": "Yes.............."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499260658, "post_id": 44927299, "comment_id": 76830288, "body": "Why do not you use the finished () signal, does this tell you when QVideo ends?"}, {"owner": {"reputation": 11, "user_id": 7840368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760eb23586b070670da41d51fe617f96?s=128&d=identicon&r=PG&f=1", "display_name": "Rex", "link": "https://stackoverflow.com/users/7840368/rex"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499260811, "post_id": 44927299, "comment_id": 76830383, "body": "The QMovie will loop, and the finished() won&#39;t be emitted."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499260825, "post_id": 44927299, "comment_id": 76830396, "body": "Or do you really want the QVideo to play forever?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499260900, "post_id": 44927299, "comment_id": 76830437, "body": "In very few cases a loop in Qt is used, it is not recommended. You could share your code to understand yourself better."}, {"owner": {"reputation": 11, "user_id": 7840368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760eb23586b070670da41d51fe617f96?s=128&d=identicon&r=PG&f=1", "display_name": "Rex", "link": "https://stackoverflow.com/users/7840368/rex"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499260962, "post_id": 44927299, "comment_id": 76830481, "body": "I want to play it once."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499261090, "post_id": 44927299, "comment_id": 76830578, "body": "I do not understand you, explain yourself better."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1499261417, "post_id": 44927299, "comment_id": 76830847, "body": "Please correct your code"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499262363, "post_id": 44927299, "comment_id": 76831580, "body": "see my answer :P"}], "answers": [{"comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 11, "user_id": 7840368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760eb23586b070670da41d51fe617f96?s=128&d=identicon&r=PG&f=1", "display_name": "Rex", "link": "https://stackoverflow.com/users/7840368/rex"}, "edited": false, "score": 0, "creation_date": 1499262669, "post_id": 44928049, "comment_id": 76831788, "body": "Please if my answer helps you mark it as correct please"}, {"owner": {"reputation": 11, "user_id": 7840368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760eb23586b070670da41d51fe617f96?s=128&d=identicon&r=PG&f=1", "display_name": "Rex", "link": "https://stackoverflow.com/users/7840368/rex"}, "edited": false, "score": 0, "creation_date": 1499262757, "post_id": 44928049, "comment_id": 76831862, "body": "&#39;void QMovie::frameChanged(int)&#39; is protected,how to deal with it?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 11, "user_id": 7840368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760eb23586b070670da41d51fe617f96?s=128&d=identicon&r=PG&f=1", "display_name": "Rex", "link": "https://stackoverflow.com/users/7840368/rex"}, "edited": false, "score": 0, "creation_date": 1499262826, "post_id": 44928049, "comment_id": 76831917, "body": "What version of Qt do you use? frameChanged is a signal: <a href=\"http://doc.qt.io/qt-4.8/qmovie.html#frameChanged\" rel=\"nofollow noreferrer\">doc.qt.io/qt-4.8/qmovie.html#frameChanged</a>"}, {"owner": {"reputation": 11, "user_id": 7840368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760eb23586b070670da41d51fe617f96?s=128&d=identicon&r=PG&f=1", "display_name": "Rex", "link": "https://stackoverflow.com/users/7840368/rex"}, "edited": false, "score": 0, "creation_date": 1499263150, "post_id": 44928049, "comment_id": 76832184, "body": "the version is 4.7.4"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 11, "user_id": 7840368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760eb23586b070670da41d51fe617f96?s=128&d=identicon&r=PG&f=1", "display_name": "Rex", "link": "https://stackoverflow.com/users/7840368/rex"}, "edited": false, "score": 0, "creation_date": 1499263286, "post_id": 44928049, "comment_id": 76832260, "body": "From where you say it is a protected method, I have reviewed the documentation for that version: <a href=\"https://doc.qt.io/archives/qt-4.7/qmovie.html#frameChanged\" rel=\"nofollow noreferrer\">doc.qt.io/archives/qt-4.7/qmovie.html#frameChanged</a> and it is not protected. What exactly is your error message?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 11, "user_id": 7840368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760eb23586b070670da41d51fe617f96?s=128&d=identicon&r=PG&f=1", "display_name": "Rex", "link": "https://stackoverflow.com/users/7840368/rex"}, "edited": false, "score": 0, "creation_date": 1499263384, "post_id": 44928049, "comment_id": 76832338, "body": "I&#39;ve used a new style of signal and slots connection, but I think you can implement it for your version easily. But share your code through github, drive or similar to help you"}, {"owner": {"reputation": 11267, "user_id": 903651, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3dda4f66a2b7cc9fdced12a0fbede58?s=128&d=identicon&r=PG", "display_name": "Adrian Maire", "link": "https://stackoverflow.com/users/903651/adrian-maire"}, "reply_to_user": {"reputation": 11, "user_id": 7840368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760eb23586b070670da41d51fe617f96?s=128&d=identicon&r=PG&f=1", "display_name": "Rex", "link": "https://stackoverflow.com/users/7840368/rex"}, "edited": false, "score": 0, "creation_date": 1499266178, "post_id": 44928049, "comment_id": 76834624, "body": "@Rex: reputation is the only reward to the time spent in helping. Voting helpful answer up is also a good idea. Maybe they will also vote your question which help you."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1499308435, "post_id": 44928049, "comment_id": 76854043, "body": "Share me your code through Github, drive or similar"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 0, "last_activity_date": 1499262679, "last_edit_date": 1499262679, "creation_date": 1499262347, "answer_id": 44928049, "question_id": 44927299, "link": "https://stackoverflow.com/questions/44927299/how-to-use-signal-framechangedint-to-play-the-qmovie-once-in-qt/44928049#44928049", "title": "how to use signal frameChanged(int) to play the QMovie once in QT", "body": "<p>You must use the <code>frameCount()</code> function to get the number of frames of QMovie.</p>\n\n<pre><code>QMovie *movie = new QMovie();\nmovie-&gt;setFileName(\"download.gif\");\nui-&gt;label-&gt;setMovie(movie);\n\nconnect(movie, &amp;QMovie::frameChanged, [=](int frameNumber){\n    if(frameNumber == movie-&gt;frameCount()-1){\n        movie-&gt;stop();\n        movie-&gt;deleteLater();\n    }\n});\nmovie-&gt;start();\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7840368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760eb23586b070670da41d51fe617f96?s=128&d=identicon&r=PG&f=1", "display_name": "Rex", "link": "https://stackoverflow.com/users/7840368/rex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 44928049, "answer_count": 1, "score": 0, "last_activity_date": 1499262679, "creation_date": 1499260375, "last_edit_date": 1499261344, "question_id": 44927299, "link": "https://stackoverflow.com/questions/44927299/how-to-use-signal-framechangedint-to-play-the-qmovie-once-in-qt", "title": "how to use signal frameChanged(int) to play the QMovie once in QT", "body": "<p>how to use frameChanged(int) to decide the frame is the last frame, i want to use the signal to stop the Qmovie to play it once instead of forever.</p>\n\n<pre><code>QMovie *movie = new QMovie();\nmovie-&gt;setFileName(\"C:/Qt/qtcreator-2.2.1/game/test/pikaqiu.gif\");\nQSize size = this-&gt;getLabelPointer()-&gt;size();\nmovie-&gt;setScaledSize(size);\nthis-&gt;getLabelPointer()-&gt;setMovie(movie);\nQObject::connect(movie,SIGNAL(finished()),movie,SLOT(deleteLater()));\nmovie-&gt;start();\nenter code here\ndelete this;\nmovie-&gt;stop();\n</code></pre>\n\n<p>`</p>\n"}, {"tags": ["c++", "timer", "synchronization", "c++14", "ctime"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1499260666, "post_id": 44927288, "comment_id": 76830296, "body": "Please indent your code."}], "answers": [{"tags": [], "owner": {"reputation": 6633, "user_id": 2378300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/852aed09b52c7514ed23f75f2921f6cc?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/2378300/jonas"}, "is_accepted": false, "score": 1, "last_activity_date": 1499324978, "last_edit_date": 1499324978, "creation_date": 1499289128, "answer_id": 44936064, "question_id": 44927288, "link": "https://stackoverflow.com/questions/44927288/keep-track-of-the-timer-repeatedly-in-c/44936064#44936064", "title": "Keep track of the timer repeatedly in C++", "body": "<p>Here is some inspiration, where the function <code>TimerLimitNOTHit</code> returns true if more than <code>X</code> ms has passed since it last returned true. </p>\n\n<pre><code>int X = ... // #0\n\nbool TimerLimitNOTHit()\n{\n    static auto start = std::chrono::steady_clock::now(); // #1\n    auto now = std::chrono::steady_clock::now(); \n    if (now - start &gt; std::chrono::milliseconds(X))\n    {\n        start = now // #2\n        return true;\n    }\n    return false\n}\n</code></pre>\n\n<p><code>#0</code> Defining the distance in time between two calls to <code>TimerLimitNOTHit</code> that return true.</p>\n\n<p><code>#1</code> Initialization depend on your application logic. In this example the function does not return true on the first call, this can changed by initializing <code>start</code> to zero.</p>\n\n<p><code>#2</code> start value for the next iteration, again it depends on your application logic. If you want a more steady true you could do some modulo arithmetic.</p>\n\n<p>Let me know if this is not what you were looking for.</p>\n\n<p><strong>Disclaimer</strong> </p>\n\n<p>I don't really like the use of <code>static</code> variables, but without a \"status\" parameter to the function I don't see how it can be avoided.\nFurthermore, the use of the global <code>X</code> variable does not fall to my likening neither. The variable <code>X</code> could be changed to a template variable, this better show intent and makes it a compile time constant.</p>\n"}], "owner": {"reputation": 3527, "user_id": 485539, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/d10de06616c8f4661387c74a4a40ec22?s=128&d=identicon&r=PG", "display_name": "codeLover", "link": "https://stackoverflow.com/users/485539/codelover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499324978, "creation_date": 1499260344, "last_edit_date": 1499322001, "question_id": 44927288, "link": "https://stackoverflow.com/questions/44927288/keep-track-of-the-timer-repeatedly-in-c", "title": "Keep track of the timer repeatedly in C++", "body": "<p>I've a library which accepts a vector of strings as argument &amp; pushes it to a vector of vector of strings (2D vector). \nI've a condition that \"right from the time 1st row is pushed to the 2D vector the timer should start &amp; for every \"X\" th milisecond I want to append some special string \"FLAG_BORDER\" at the end of the vector of string that i receive as argument to library.</p>\n\n<p><strong>LIBRARY CODE</strong></p>\n\n<pre><code>using namespace std;\nvector&lt;vector&lt;sring&gt;&gt; vecOfVecStrs;\nMyLibraryFunction(vector&lt;string&gt; vecstr)\n{\n    if(TimerLimitNOTHit()) // THIS FUNCTION TimerLimitNOTHit() checks if the \"X\" \n                           //    th milisecond is reached or not.\n    {\n          vecOfVecStrs.push_back(vecstr); // If \"X\"th ms time poeriod is NOT \n                                           // yet reached\n    }\n    else\n    {\n         vecstr.push_back(\"FLAG_BORDER\");\n         vecOfVecStrs.push_back(vecstr);\n    }\n</code></pre>\n\n<p><strong>APPLICATION CODE CALLING LIBRARY FUNCTION::</strong></p>\n\n<pre><code>int main()\n{\n    do_something();\n    vector&lt;string&gt; vecStr;\n    while(vecStr = Get_VecTor_of_strings())\n    {\n        MyLibraryFunction(vecStr);\n    }\n</code></pre>\n\n<blockquote>\n  <p>How do I implement the function TimerLimitNOTHit() here which should\n  keep track of the timer \"X\" milisec across function calls to\n  \"MyLibraryFunction()\" in C++ ?</p>\n</blockquote>\n\n<p><strong>EDITED: SEEMS LIKE FOUND AN ANSWER. wILL IT WORK ?</strong></p>\n\n<pre><code>int timeX = 30; //s\nbool keepTrack = false;\nint ci = 0;\nstd::vector&lt;int&gt; timeArray;\nstd::mutex m;\n\nbool keepTracking()\n{\n    std::unique_lock&lt;std::mutex&gt; lock(m);\n    return keepTrack;\n}\n\nvoid GlobalTimer()\n{\n    while (keepTracking())\n    {\n        std::this_thread::sleep_for(std::chrono::seconds(timeX));\n        timeArray[ci] = 1;\n    }\n}\n\n\n\n std::thread t1(GlobalTimer);\n</code></pre>\n"}, {"tags": ["c++", "sockets", "tcp"], "comments": [{"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1499259585, "post_id": 44926955, "comment_id": 76829469, "body": "in general, you <i>cannot</i> just send objects over sockets, you need to <i>serialize</i> them (and then deserialize the message on the receiving end)."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 2, "creation_date": 1499259609, "post_id": 44926955, "comment_id": 76829489, "body": "<code>strlen</code> is wrong, the correct size is available from <code>vector::size()</code>."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1499259626, "post_id": 44926955, "comment_id": 76829505, "body": "Is <code>buff</code> a vector of <i>strings</i>? More specifically a vector of <i>C-style zero.-terminated strings</i>? First of all, if you want to use strings use <code>std::string</code> instead of vectors of characters. Secondly, <code>buff.back()</code> gives you a <i>vector</i>, not something you can pass to <code>strlen</code>. Lastly you never remove anything from <code>buff</code> leading to an infinite loop."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1499259669, "post_id": 44926955, "comment_id": 76829540, "body": "@Borgleader: <code>buff</code> is a vector of vector, he&#39;s trying to get the length of one single array stored inside <code>buff</code>.  Of course, you can&#39;t just cast a vector object to a pointer."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1499259735, "post_id": 44926955, "comment_id": 76829609, "body": "On an unrelated note, check for error <i>directly</i> after you call <code>send</code>. Because otherwise the error code (which you for some reason don&#39;t report) can change and will be otherwise irrelevant or even undefined."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1499259742, "post_id": 44926955, "comment_id": 76829615, "body": "@BenVoigt Yes, I realized that after, comment removed. (in my defense, having buff and buffer, which are both vector&lt;T&gt; is confusing)"}, {"owner": {"reputation": 70, "user_id": 8103113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9c2b4dc708a17e38d50406f3f1f8aa91?s=128&d=identicon&r=PG&f=1", "display_name": "Lomezno", "link": "https://stackoverflow.com/users/8103113/lomezno"}, "edited": false, "score": 0, "creation_date": 1499260059, "post_id": 44926955, "comment_id": 76829835, "body": "I know i missed the <code>pop_back</code>. <code>buff</code> is a vector containing vectors with unsigned chars. Why I use it like this instead of <code>string</code>? because it&#39;s for binary data, using <code>string</code> wont cover all the 256 values that i need for this case. About <code>strlen</code>, yes you are right, <code>size()</code> is the one to use here."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1499260559, "post_id": 44926955, "comment_id": 76830217, "body": "It might be better to delete the buffer only <i>after</i> you check to see of the send worked or not. Otherwise you may delete something that hasn&#39;t been sent."}, {"owner": {"reputation": 70, "user_id": 8103113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9c2b4dc708a17e38d50406f3f1f8aa91?s=128&d=identicon&r=PG&f=1", "display_name": "Lomezno", "link": "https://stackoverflow.com/users/8103113/lomezno"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1499260816, "post_id": 44926955, "comment_id": 76830388, "body": "@Galik I cannot do that, once the sending process starts i cannot stop it. This little client is ment to send several files over tcp. So the only thing I can do is to wait and see on destination what happened"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1499261694, "post_id": 44926955, "comment_id": 76831078, "body": "It may be worth looking at this answer for robust socket code: <a href=\"https://stackoverflow.com/a/2014066/3807729\">stackoverflow.com/a/2014066/3807729</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": false, "score": 0, "last_activity_date": 1499261485, "last_edit_date": 1499261485, "creation_date": 1499259948, "answer_id": 44927148, "question_id": 44926955, "link": "https://stackoverflow.com/questions/44926955/how-to-send-on-socket-a-vectorunsigned-char/44927148#44927148", "title": "how to send on socket a vector&lt;unsigned char&gt;", "body": "<p>Here's one way you could do it:</p>\n\n<pre><code>   std::vector&lt;std::vector&lt;unsigned char&gt;&gt; buff;\n   //...\n   for (std::vector&lt;std::vector&lt;unsigned char&gt;&gt; i = buff.begin(); \n        i != buff.end(); ++i)\n   {\n     std::vector&lt;char&gt;::iterator next = i-&gt;begin();\n     while (next != i-&gt;end())\n     {\n       // if you don't have std::distance, use i-&gt;end() - next\n       n = send(sockfd, &amp;(*next), std::distance(next, i-&gt;end()), 0);\n       if (n &lt; 0)\n       {\n         std::cout&lt;&lt;\"ERROR writing to socket\"&lt;&lt;std::endl;\n           exit(1);\n       }\n       next += n;\n       if (n != i-&gt;end())\n       {\n         std::this_thread::yield();\n       }\n     }\n   }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 70, "user_id": 8103113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9c2b4dc708a17e38d50406f3f1f8aa91?s=128&d=identicon&r=PG&f=1", "display_name": "Lomezno", "link": "https://stackoverflow.com/users/8103113/lomezno"}, "edited": false, "score": 1, "creation_date": 1499260281, "post_id": 44927169, "comment_id": 76829998, "body": "This instruction is what i was looking for <code>&amp;(buff.back()[0])</code>. Thanks. May I ask, why the <code>[0]</code> ? could I also use <code>&amp;(buff.back().data())</code> ?"}, {"owner": {"reputation": 3004, "user_id": 4166517, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/667edb95b14a0c7d1a8c7307491bf438?s=128&d=identicon&r=PG&f=1", "display_name": "u354356007", "link": "https://stackoverflow.com/users/4166517/u354356007"}, "edited": false, "score": 0, "creation_date": 1499260368, "post_id": 44927169, "comment_id": 76830068, "body": "<code>&amp;(buff.back()[0])</code> points to the first element of <code>vector&lt;unsigned char&gt;</code> - is there a guarantee that elements of a vector are all in the same place, so first element + <code>buff.back().size()</code> bytes will cover all the vector and no garbage?"}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 2, "creation_date": 1499260651, "post_id": 44927169, "comment_id": 76830280, "body": "There is no guarantee that a socket send() will send the entire buffer.  And buff is a LIFO buffer?"}, {"owner": {"reputation": 70, "user_id": 8103113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9c2b4dc708a17e38d50406f3f1f8aa91?s=128&d=identicon&r=PG&f=1", "display_name": "Lomezno", "link": "https://stackoverflow.com/users/8103113/lomezno"}, "reply_to_user": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1499261087, "post_id": 44927169, "comment_id": 76830573, "body": "@Micha&#235;lRoy It actually doesnt matter if LIFO or FIFO as far as the data is properly transfered without loss."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 1, "creation_date": 1499261261, "post_id": 44927169, "comment_id": 76830713, "body": "It is not.  Some socket implementations will only take so many bytes in at a time. That&#39;s why send() returns the number of bytes accepted."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "reply_to_user": {"reputation": 70, "user_id": 8103113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9c2b4dc708a17e38d50406f3f1f8aa91?s=128&d=identicon&r=PG&f=1", "display_name": "Lomezno", "link": "https://stackoverflow.com/users/8103113/lomezno"}, "edited": false, "score": 1, "creation_date": 1499261617, "post_id": 44927169, "comment_id": 76831011, "body": "@lomezno  Sometimes data ordering does matter. :)"}, {"owner": {"reputation": 70, "user_id": 8103113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9c2b4dc708a17e38d50406f3f1f8aa91?s=128&d=identicon&r=PG&f=1", "display_name": "Lomezno", "link": "https://stackoverflow.com/users/8103113/lomezno"}, "reply_to_user": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1499261715, "post_id": 44927169, "comment_id": 76831089, "body": "@Micha&#235;lRoy I know, but not in this particular case :) I was checking the size of <code>send()</code> and for my case it send up to 2000bytes, which is more than enough for me."}], "tags": [], "owner": {"reputation": 939, "user_id": 6312818, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-exa9fGlNwbI/AAAAAAAAAAI/AAAAAAAAHQ8/CXKe0oTPiYc/photo.jpg?sz=128", "display_name": "Eyal Cinamon", "link": "https://stackoverflow.com/users/6312818/eyal-cinamon"}, "is_accepted": true, "score": -1, "last_activity_date": 1499260018, "creation_date": 1499260018, "answer_id": 44927169, "question_id": 44926955, "link": "https://stackoverflow.com/questions/44926955/how-to-send-on-socket-a-vectorunsigned-char/44927169#44927169", "title": "how to send on socket a vector&lt;unsigned char&gt;", "body": "<p>if you're trying to send all vectors within a vector, you're more or less on the right track... your loop however will never terminate as you never pop the last element from <code>buff</code></p>\n\n<pre><code>while(!buff.empty()){\n    // Sockets Layer Call: send(\n    n = send(sockfd, &amp;(buff.back()[0]), buff.back().size(), 0);\n    buff.pop_back();   // need to remove what you just sent?\n    std::this_thread::sleep_for(std::chrono::milliseconds(delay)) ;\n\n    if (n &lt; 0){\n        std::cout&lt;&lt;\"ERROR writting to socket\"&lt;&lt;std::endl;\n        exit(1);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 70, "user_id": 8103113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9c2b4dc708a17e38d50406f3f1f8aa91?s=128&d=identicon&r=PG&f=1", "display_name": "Lomezno", "link": "https://stackoverflow.com/users/8103113/lomezno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1105, "favorite_count": 0, "accepted_answer_id": 44927169, "answer_count": 2, "score": 0, "last_activity_date": 1499261485, "creation_date": 1499259445, "last_edit_date": 1499260123, "question_id": 44926955, "link": "https://stackoverflow.com/questions/44926955/how-to-send-on-socket-a-vectorunsigned-char", "title": "how to send on socket a vector&lt;unsigned char&gt;", "body": "<p>Im trying to do a simple client tcp (I have a server already working).\nI have defined 2 variables:</p>\n\n<ol>\n<li><code>std::vector&lt;unsigned char&gt; buffer(1000);</code></li>\n<li><p><code>std::vector&lt;std::vector&lt;unsigned char&gt;&gt; buff;</code>\n<code>buffer</code> I use it ot read chains of unsigned characters, when reading is done i store it on <code>buff</code> and I start reading again.\nI have defined all the process of adress, port, etc and when it comes to send strings of <code>buffer</code> I have problems.\nHere's what i tried so far:</p>\n\n<pre><code>while(!buff.empty()){\n    // Sockets Layer Call: send(\n    n = send(sockfd, buff.back(), buff.back.size(), 0);\n    std::this_thread::sleep_for(std::chrono::milliseconds(delay)) ;\n    buff.pop_back();\n\n    if (n &lt; 0){\n        std::cout&lt;&lt;\"ERROR writting to socket\"&lt;&lt;std::endl;\n        exit(1);\n    }\n}\n</code></pre></li>\n</ol>\n\n<p>I tried adding <code>(char *)</code> , also <code>reinterpret_cast</code>, but noithing seems to work. Any clue?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "arrays", "string", "char"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 11, "creation_date": 1499259359, "post_id": 44926886, "comment_id": 76829281, "body": "So you are not copying the string terminator <code>\\0</code>?"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1499259440, "post_id": 44926886, "comment_id": 76829351, "body": "That is not the problem but don&#39;t cast the return of <code>malloc</code> as there is no need and may hide problems, see <a href=\"https://stackoverflow.com/a/605858/8051589\">here on SO</a> why."}, {"owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "edited": false, "score": 0, "creation_date": 1499259476, "post_id": 44926886, "comment_id": 76829383, "body": "have you checked the actual value of <code>x</code>?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 1, "creation_date": 1499259530, "post_id": 44926886, "comment_id": 76829425, "body": "@AndreKampling the answer you link says that one does not need to cast, but nothing about the cast being a real problem"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1499259601, "post_id": 44926886, "comment_id": 76829482, "body": "@tobi303: As I said it is not the problem... But you may hide things wich could bring trouble."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1499259686, "post_id": 44926886, "comment_id": 76829561, "body": "@AndreKampling - The link is for <code>c</code> - not <code>c++</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1499259688, "post_id": 44926886, "comment_id": 76829563, "body": "@AndreKampling sorry I misread your &quot;That is not&quot; as refering to the comment before..."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1499259742, "post_id": 44926886, "comment_id": 76829617, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/11161609/garbage-being-printed-when-using-strcpy\">Garbage being printed when using strcpy</a>.  It uses <code>strcpy</code> instead of <code>memcpy</code> but it s the same thing basically."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 1, "creation_date": 1499260030, "post_id": 44926886, "comment_id": 76829816, "body": "@AndreKampling - <a href=\"https://stackoverflow.com/questions/3477741/why-does-c-require-a-cast-for-malloc-but-c-doesnt\" title=\"why does c require a cast for malloc but c doesnt\">stackoverflow.com/questions/3477741/&hellip;</a>"}, {"owner": {"reputation": 191, "user_id": 8222493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/60bb1c967f8edaf50b289e18b7263e27?s=128&d=identicon&r=PG", "display_name": "Samega 7Cattac", "link": "https://stackoverflow.com/users/8222493/samega-7cattac"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1499260095, "post_id": 44926886, "comment_id": 76829859, "body": "@NathanOliver No! Because I not working with strings during the copy (where is the question), only in the end."}, {"owner": {"reputation": 191, "user_id": 8222493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/60bb1c967f8edaf50b289e18b7263e27?s=128&d=identicon&r=PG", "display_name": "Samega 7Cattac", "link": "https://stackoverflow.com/users/8222493/samega-7cattac"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1499260143, "post_id": 44926886, "comment_id": 76829894, "body": "@4386427 That&#39;s correct!!! c++ need cast"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1499260229, "post_id": 44926886, "comment_id": 76829963, "body": "@4386427: Wow thank you didn&#39;t know that!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1499260307, "post_id": 44926886, "comment_id": 76830023, "body": "Use std::string!"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1499265171, "post_id": 44926886, "comment_id": 76833801, "body": "&quot;copy ... from a <code>char</code> array to a <code>char*</code>&quot; -- you&#39;re in deep trouble. You cannot copy characters to a pointer. You <b>must</b> copy them to <b>another array of <code>char</code></b>, typically one that&#39;s <b>pointed to</b> by a <code>char*</code>. A pointer is not an array and an array is not a pointer."}, {"owner": {"reputation": 191, "user_id": 8222493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/60bb1c967f8edaf50b289e18b7263e27?s=128&d=identicon&r=PG", "display_name": "Samega 7Cattac", "link": "https://stackoverflow.com/users/8222493/samega-7cattac"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1499265619, "post_id": 44926886, "comment_id": 76834163, "body": "@PeteBecker I know that. Everyone understood when I said &quot;copy from char array to a char *&quot; I don&#39;t mean literaly like x = y. Sorry if my english is not that good xD"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1499265915, "post_id": 44926886, "comment_id": 76834392, "body": "@Samega7Cattac -- your English is fine. My point is that the <b>difference</b> between a pointer and an array is extremely important, and beginners often overlook it. There are quite a few posts where (unlike yours) someone just uses a pointer that doesn&#39;t point anywhere."}], "answers": [{"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1499259852, "post_id": 44927057, "comment_id": 76829704, "body": "Shouldn&#39;t that be <code>output[x-2]</code> ?"}, {"owner": {"reputation": 191, "user_id": 8222493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/60bb1c967f8edaf50b289e18b7263e27?s=128&d=identicon&r=PG", "display_name": "Samega 7Cattac", "link": "https://stackoverflow.com/users/8222493/samega-7cattac"}, "edited": false, "score": 0, "creation_date": 1499259923, "post_id": 44927057, "comment_id": 76829748, "body": "Correct!! if I do <code>output[x - 2] = &#39;\\0&#39;</code> will work! Why <code>x - 2</code>? Because of the <code>\\r\\n</code> in the end of all commands."}, {"owner": {"reputation": 16949, "user_id": 7256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZFSI.jpg?s=128&g=1", "display_name": "janm", "link": "https://stackoverflow.com/users/7256/janm"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1499259933, "post_id": 44927057, "comment_id": 76829756, "body": "@4386427 Yes, indeed!"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 191, "user_id": 8222493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/60bb1c967f8edaf50b289e18b7263e27?s=128&d=identicon&r=PG", "display_name": "Samega 7Cattac", "link": "https://stackoverflow.com/users/8222493/samega-7cattac"}, "edited": false, "score": 1, "creation_date": 1499260248, "post_id": 44927057, "comment_id": 76829974, "body": "@Samega7Cattac - because a C-style string requires a termination char with the value zero. So if you have <code>abcdef\\r\\n</code> and only copies <code>abcdef</code> into the new buffer using <code>memcpy</code>, you don&#39;t have the termination. So you must add <code>&#39;\\0&#39;</code> after the <code>memcpy</code> to make it a valid C-style string."}], "tags": [], "owner": {"reputation": 16949, "user_id": 7256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZFSI.jpg?s=128&g=1", "display_name": "janm", "link": "https://stackoverflow.com/users/7256/janm"}, "is_accepted": true, "score": 9, "last_activity_date": 1499259941, "last_edit_date": 1499259941, "creation_date": 1499259715, "answer_id": 44927057, "question_id": 44926886, "link": "https://stackoverflow.com/questions/44926886/trash-using-memcpy/44927057#44927057", "title": "Trash using memcpy", "body": "<p>Welcome to C++.</p>\n\n<p>You are copying the values you care about but not the terminating '\\0' character. Assuming <code>x</code> is valid (that is: x > 3 and x &lt;= sizeof(buffer)) you can say:</p>\n\n<pre><code>output[x - 2] = '\\0';\n</code></pre>\n\n<p>after the call to <code>memcpy()</code> and you should get what you expect.</p>\n\n<p>However: when you're dealing with communications and buffers like this you need to be careful and check everything.</p>\n"}, {"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1499260238, "post_id": 44927235, "comment_id": 76829968, "body": "This does not remove the <code>\\r\\n</code> at the end of the data"}, {"owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1499260561, "post_id": 44927235, "comment_id": 76830220, "body": "@NathanOliver Resizing a std::string or a std::vector is trivial. Stripping the string of trailing whitespace is left as an exercise for the reader."}], "tags": [], "owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "is_accepted": false, "score": 0, "last_activity_date": 1499260345, "last_edit_date": 1499260345, "creation_date": 1499260179, "answer_id": 44927235, "question_id": 44926886, "link": "https://stackoverflow.com/questions/44926886/trash-using-memcpy/44927235#44927235", "title": "Trash using memcpy", "body": "<p>I think you shouldn't be using raw arrays and <code>memcpy</code> and the like here.</p>\n\n<p>You are probably better off with the containers from the C++ standard library:</p>\n\n<ul>\n<li><a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/container/vector</a></li>\n<li><a href=\"http://en.cppreference.com/w/cpp/string/basic_string\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/string/basic_string</a></li>\n<li><a href=\"https://stackoverflow.com/q/39200665/1025391\">Directly write into char* buffer of std::string</a></li>\n</ul>\n\n<p>Example:</p>\n\n<pre><code>std::vector&lt;char&gt; buffer(32);\nint x = libssh2_channel_read(channel, &amp;buffer[0], buffer.size());\n// probably x will be smaller or equal the current size of the buffer\nbuffer.resize(x);\n// if it's a string, why not have it as a std::string\nstd::string data(buffer.begin(), buffer.end());\nstd::cout &lt;&lt; data &lt;&lt; '\\n';\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 191, "user_id": 8222493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/60bb1c967f8edaf50b289e18b7263e27?s=128&d=identicon&r=PG", "display_name": "Samega 7Cattac", "link": "https://stackoverflow.com/users/8222493/samega-7cattac"}, "edited": false, "score": 0, "creation_date": 1499260740, "post_id": 44927405, "comment_id": 76830335, "body": "Can you explain why <code>std::string output{ buffer, buffer + x - 2 };</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "reply_to_user": {"reputation": 191, "user_id": 8222493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/60bb1c967f8edaf50b289e18b7263e27?s=128&d=identicon&r=PG", "display_name": "Samega 7Cattac", "link": "https://stackoverflow.com/users/8222493/samega-7cattac"}, "edited": false, "score": 0, "creation_date": 1499261060, "post_id": 44927405, "comment_id": 76830558, "body": "<code>buffer + x</code> one after the end of data, <code>- 2</code> because of &quot;\\r\\n&quot;"}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "reply_to_user": {"reputation": 191, "user_id": 8222493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/60bb1c967f8edaf50b289e18b7263e27?s=128&d=identicon&r=PG", "display_name": "Samega 7Cattac", "link": "https://stackoverflow.com/users/8222493/samega-7cattac"}, "edited": false, "score": 0, "creation_date": 1499261518, "post_id": 44927405, "comment_id": 76830926, "body": "@Samega7Cattac You give it the (address of) the first byte you <i>want</i> and of the first byte you <i>don&#39;t</i> want (one past the end less two for the CRLF)."}, {"owner": {"reputation": 191, "user_id": 8222493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/60bb1c967f8edaf50b289e18b7263e27?s=128&d=identicon&r=PG", "display_name": "Samega 7Cattac", "link": "https://stackoverflow.com/users/8222493/samega-7cattac"}, "edited": false, "score": 0, "creation_date": 1499261536, "post_id": 44927405, "comment_id": 76830937, "body": "@manni66 Ok, now I understand. But I need it to be char * because of other functions and converting string to char * sometimes can go bad"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "is_accepted": false, "score": 0, "last_activity_date": 1499260656, "creation_date": 1499260656, "answer_id": 44927405, "question_id": 44926886, "link": "https://stackoverflow.com/questions/44926886/trash-using-memcpy/44927405#44927405", "title": "Trash using memcpy", "body": "<p>Use std::string:</p>\n\n<pre><code>char buffer[32];\nint x = libssh2_channel_read(channel, buffer, sizeof(buffer));\nstd::string output{ buffer, buffer + x - 2 };\nlibssh2_channel_free(channel);\nchannel = NULL;\ncout &lt;&lt; output &lt;&lt; endl;\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 8222493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/60bb1c967f8edaf50b289e18b7263e27?s=128&d=identicon&r=PG", "display_name": "Samega 7Cattac", "link": "https://stackoverflow.com/users/8222493/samega-7cattac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "accepted_answer_id": 44927057, "answer_count": 3, "score": 0, "last_activity_date": 1499260656, "creation_date": 1499259261, "question_id": 44926886, "link": "https://stackoverflow.com/questions/44926886/trash-using-memcpy", "title": "Trash using memcpy", "body": "<p>I'm using memcpy to copy a specific number of chars from a char array to a char *. But when I read the char * have always trash in the end.</p>\n\n<p>I'm using libssh2 lib to send commands to my raspberry pi and receive the output.</p>\n\n<p><code>libssh2_channel_read</code> will return the number of chars of the output <code>int x</code> and the output text will be on the <code>char buffer[32]</code>.</p>\n\n<p>Code I'm using:</p>\n\n<pre><code>char buffer[32];\nint x = libssh2_channel_read(channel, buffer, sizeof(buffer));\nchar * output = (char *)malloc(sizeof(char)*x);\nmemcpy(output, buffer, x-2); // x - 2 because of \"\\r\\n\"\nlibssh2_channel_free(channel);\nchannel = NULL;\ncout &lt;&lt; output &lt;&lt; endl;\n</code></pre>\n\n<p>Example of output:</p>\n\n<pre><code>0\u2550\u2550\u00b2\u00b2\u00b2\u00b2\n</code></pre>\n\n<p>I only want the <code>0</code></p>\n"}]