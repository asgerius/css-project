[{"tags": ["c++", "llvm", "llvm-ir"], "comments": [{"owner": {"reputation": 9778, "user_id": 598057, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af77229cbfe1a0bff2b5ea064ef3271a?s=128&d=identicon&r=PG", "display_name": "Stanislav Pankevich", "link": "https://stackoverflow.com/users/598057/stanislav-pankevich"}, "edited": false, "score": 1, "creation_date": 1488451272, "post_id": 42544386, "comment_id": 72241047, "body": "Nice question. Make sure to also ask this on llvm-dev mailing list."}, {"owner": {"reputation": 383, "user_id": 809199, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d97d1076c911352886a0419abed5f646?s=128&d=identicon&r=PG", "display_name": "Juicebox", "link": "https://stackoverflow.com/users/809199/juicebox"}, "reply_to_user": {"reputation": 9778, "user_id": 598057, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af77229cbfe1a0bff2b5ea064ef3271a?s=128&d=identicon&r=PG", "display_name": "Stanislav Pankevich", "link": "https://stackoverflow.com/users/598057/stanislav-pankevich"}, "edited": false, "score": 1, "creation_date": 1488454164, "post_id": 42544386, "comment_id": 72242921, "body": "I&#39;ve just done it, thank you for giving me the idea :)"}], "answers": [{"tags": [], "owner": {"reputation": 6904, "user_id": 60462, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/64fd87fd2c140ee93f638a624bcc97c9?s=128&d=identicon&r=PG", "display_name": "Volker Stolz", "link": "https://stackoverflow.com/users/60462/volker-stolz"}, "is_accepted": false, "score": 0, "last_activity_date": 1545056818, "creation_date": 1545056818, "answer_id": 53817248, "question_id": 42544386, "link": "https://stackoverflow.com/questions/42544386/how-to-retrieve-llvminstruction-address-after-jit-code-generation/53817248#53817248", "title": "How to retrieve llvm::Instruction address after JIT code generation?", "body": "<p>It is not directly possible to do this for individual instructions, but you can get at least the address of the basic block that your instruction is in through the static <a href=\"https://llvm.org/doxygen/classllvm_1_1BlockAddress.html\" rel=\"nofollow noreferrer\">BlockAddress</a> helpers. Of course, as pointed out on the mailing list, any number of things could have happened to the LLVM instruction, or the whole basic block could have been optimised away.</p>\n"}], "owner": {"reputation": 383, "user_id": 809199, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d97d1076c911352886a0419abed5f646?s=128&d=identicon&r=PG", "display_name": "Juicebox", "link": "https://stackoverflow.com/users/809199/juicebox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1545056818, "creation_date": 1488412435, "question_id": 42544386, "link": "https://stackoverflow.com/questions/42544386/how-to-retrieve-llvminstruction-address-after-jit-code-generation", "title": "How to retrieve llvm::Instruction address after JIT code generation?", "body": "<p>While using <code>llvm::IRBuilder</code>, I collect <code>llvm::Instruction</code>s mapped with code locations and my wish is to be able to retrieve memory location of these instructions in the form {void* start, void* end} after the code generation has been done by the JIT compiler, is this possible ? (the intend is to insert software breakpoints and retrieve instruction from EIP when breaking).</p>\n"}, {"tags": ["c++", "gcc", "compiler-warnings", "vtk"], "comments": [{"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1488413696, "post_id": 42544349, "comment_id": 72224857, "body": "Does it still compile without the <code>-isystem</code> part? What about if you change <code>&quot;&quot;</code> to <code>&lt;&gt;</code> in the <code>#include</code>?"}, {"owner": {"reputation": 2135, "user_id": 3667089, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/591d11239b028c677149047326aa9209?s=128&d=identicon&r=PG&f=1", "display_name": "user3667089", "link": "https://stackoverflow.com/users/3667089/user3667089"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1488413807, "post_id": 42544349, "comment_id": 72224892, "body": "@NirFriedman Makes no difference with <code>&lt;&gt;</code>, without <code>-isystem</code> it won&#39;t be able to find where <code>vtkVersion.h</code> is."}, {"owner": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "edited": false, "score": 0, "creation_date": 1488414378, "post_id": 42544349, "comment_id": 72225069, "body": "You should be using <code>&lt;sstream&gt;</code> (or rather, the vtk library should). It&#39;s possible that giving -std=c++03 or similar will solve this. I&#39;m not entirely sure what version of C++ that gcc defaults to these days - a while back you had to actually ask to get C++11, but I believe a recent (as in the past year or two) change has moved that along to be either C++11 or C++14 as the default, and you have to request the OLD version instead."}, {"owner": {"reputation": 2135, "user_id": 3667089, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/591d11239b028c677149047326aa9209?s=128&d=identicon&r=PG&f=1", "display_name": "user3667089", "link": "https://stackoverflow.com/users/3667089/user3667089"}, "reply_to_user": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "edited": false, "score": 0, "creation_date": 1488414542, "post_id": 42544349, "comment_id": 72225116, "body": "@MatsPetersson adding <code>-std=c++03</code> is no better than adding <code>-Wno-deprecated</code>, I will try to file an issue with VTK but no guarantee they will fix it. Still confused why <code>-isystem</code> doesn&#39;t work though."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1488416761, "post_id": 42544349, "comment_id": 72225752, "body": "@user3667089 I suggested dropping the -isystem because I thought maybe it&#39;s getting the path somewhere else (and possibly the library is symlinked to a generic library dir). This is definitely a weird one. I would try testing against clang."}, {"owner": {"reputation": 656, "user_id": 1662174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fab9acb74f92aafd9675fc2d9dc2b624?s=128&d=identicon&r=PG", "display_name": "mirni", "link": "https://stackoverflow.com/users/1662174/mirni"}, "edited": false, "score": 0, "creation_date": 1488454466, "post_id": 42544349, "comment_id": 72243132, "body": "The best way would be to upgrade vtk. Version 7.1 has been released a few months ago..."}, {"owner": {"reputation": 2135, "user_id": 3667089, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/591d11239b028c677149047326aa9209?s=128&d=identicon&r=PG&f=1", "display_name": "user3667089", "link": "https://stackoverflow.com/users/3667089/user3667089"}, "reply_to_user": {"reputation": 656, "user_id": 1662174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fab9acb74f92aafd9675fc2d9dc2b624?s=128&d=identicon&r=PG", "display_name": "mirni", "link": "https://stackoverflow.com/users/1662174/mirni"}, "edited": false, "score": 0, "creation_date": 1488475380, "post_id": 42544349, "comment_id": 72257937, "body": "@mirni Building VTK 7.1 from source solved the problem. I am still curious why <code>-isystem</code> doesn&#39;t work."}, {"owner": {"reputation": 656, "user_id": 1662174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fab9acb74f92aafd9675fc2d9dc2b624?s=128&d=identicon&r=PG", "display_name": "mirni", "link": "https://stackoverflow.com/users/1662174/mirni"}, "edited": false, "score": 0, "creation_date": 1488562348, "post_id": 42544349, "comment_id": 72302528, "body": "I suspect that it is because the warning is generated using the preprocessor #warning directive, i.e. it is forced from code, and not by compiler (such as -Wunused-value or whatever else the compiler generates).  I don&#39;t have any evidence for this hypothesis though..."}], "owner": {"reputation": 2135, "user_id": 3667089, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/591d11239b028c677149047326aa9209?s=128&d=identicon&r=PG&f=1", "display_name": "user3667089", "link": "https://stackoverflow.com/users/3667089/user3667089"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 421, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488412224, "creation_date": 1488412224, "last_edit_date": 1495535390, "question_id": 42544349, "link": "https://stackoverflow.com/questions/42544349/why-doesnt-isystem-on-g-disable-wcpp-warnings", "title": "Why doesn&#39;t -isystem on g++ disable -Wcpp warnings", "body": "<p>I am on Ubuntu 16.04, GCC 5.4.</p>\n\n<p>According to <a href=\"https://stackoverflow.com/questions/1867065/how-to-suppress-gcc-warnings-from-library-headers\">here</a> one can disable warnings from external headers by treating them as system headers. However, when I am using VTK I came across a warning that I am unable to disable. Below is the minimum code to reproduce it</p>\n\n<pre><code>#include \"vtkVersion.h\"\n\nint main(){\n return 0;\n}\n</code></pre>\n\n<p>Compile it with <code>g++ main.cpp -isystem /usr/include/vtk-5.10/</code> return warning message </p>\n\n<pre><code>In file included from /usr/include/c++/5/backward/strstream:50:0,\n                 from /usr/include/vtk-5.10/vtkIOStream.h:108,\n                 from /usr/include/vtk-5.10/vtkSystemIncludes.h:40,\n                 from /usr/include/vtk-5.10/vtkIndent.h:24,\n                 from /usr/include/vtk-5.10/vtkObjectBase.h:43,\n                 from /usr/include/vtk-5.10/vtkObject.h:41,\n                 from /usr/include/vtk-5.10/vtkVersion.h:29,\n                 from Example.cpp:3:\n/usr/include/c++/5/backward/backward_warning.h:32:2: warning: #warning This file includes at least one deprecated or antiquated header which may be removed without further notice at a future date. Please use a non-deprecated interface with equivalent functionality instead. For a listing of replacement headers and interfaces, consult the file backward_warning.h. To disable this warning use -Wno-deprecated. [-Wcpp]\n #warning \\\n  ^\n</code></pre>\n\n<p>If VTK is not installed you can simply install it with <code>sudo apt-get install libvtk5-dev</code></p>\n\n<p>Why does the warnings appeared? In my code I have very strict compiler flags and I treat warnings as errors. However, not all external libraries are coded with such strict compiler flags, I am able to get away with including the external headers with the <code>-isystem</code> flag but VTK is giving me problems. My ugly workaround is adding <code>-Wno-deprecated</code> in my own compiler flags to get pass it but obviously this is not the right way to do it. What's the best way to solve this?</p>\n"}, {"tags": ["c++", "for-loop"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1488422712, "post_id": 42544258, "comment_id": 72227377, "body": "Why <i>would</i> &quot;realization_&quot; &lt;&lt; i &lt;&lt; &quot;.dat&quot; work?"}, {"owner": {"reputation": 15, "user_id": 7644278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5535ff1875ef6335983b73861ed662?s=128&d=identicon&r=PG&f=1", "display_name": "crazycrazy", "link": "https://stackoverflow.com/users/7644278/crazycrazy"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1488449540, "post_id": 42544258, "comment_id": 72239881, "body": "I thought it might work in the same way that if you do cout &lt;&lt; &quot;realization_&quot; &lt;&lt;  0 &lt;&lt; &quot;.dat&quot; you get realization_0.dat. There is a nice explanation below as to why that doesn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "is_accepted": true, "score": 1, "last_activity_date": 1488411852, "creation_date": 1488411852, "answer_id": 42544288, "question_id": 42544258, "link": "https://stackoverflow.com/questions/42544258/can-i-loop-over-file-names-that-differ-only-by-an-integer-number/42544288#42544288", "title": "Can I loop over file names that differ only by an integer number?", "body": "<p>As per <a href=\"http://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence</a>, the <code>+</code> operation will happen first. <code>(path + \"realization_\") &lt;&lt; i &lt;&lt; \".dat\";</code> then the compiler will attempt to look for a suitable operator <code>&lt;&lt;</code> between the resulting <code>std::string</code> and an <code>int</code> which isn't available, then it chokes.</p>\n\n<p>You probably want to use <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/to_string\" rel=\"nofollow noreferrer\"><code>std::to_string</code></a> to convert your numbers to string:</p>\n\n<pre><code>for (int i = 0; i &lt; 2; i++) {\n\n    string path = \"/Users/Olly/Documents/BScProject/WeakLensing/SIGNAL/\";\n\n    string mainFile = path + \"realization_\" + std::to_string(i) + \".dat\";\n\n    vector &lt;double&gt; Pos1, Pos2, E1, E2, Z, W, SC;\n    ifstream in(mainFile.c_str(), ios::in);\n    ......\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1584, "user_id": 507433, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3818d83836c493001105a54de88ccdbf?s=128&d=identicon&r=PG", "display_name": "MFH", "link": "https://stackoverflow.com/users/507433/mfh"}, "is_accepted": false, "score": 0, "last_activity_date": 1488411858, "creation_date": 1488411858, "answer_id": 42544290, "question_id": 42544258, "link": "https://stackoverflow.com/questions/42544258/can-i-loop-over-file-names-that-differ-only-by-an-integer-number/42544290#42544290", "title": "Can I loop over file names that differ only by an integer number?", "body": "<p>A string is not a stream!</p>\n\n<p>Use normal string-concatenation:</p>\n\n<pre><code> string mainFile = path + \"realization_\" + std::to_string(i) + \".dat\";\n</code></pre>\n\n<p>Note that <code>to_string</code> is only available starting with C++11.</p>\n"}, {"tags": [], "owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "is_accepted": false, "score": 0, "last_activity_date": 1488413894, "creation_date": 1488413894, "answer_id": 42544647, "question_id": 42544258, "link": "https://stackoverflow.com/questions/42544258/can-i-loop-over-file-names-that-differ-only-by-an-integer-number/42544647#42544647", "title": "Can I loop over file names that differ only by an integer number?", "body": "<p>The string 'mainFile' can not used that way.</p>\n\n<p>I would suggest using a std::stringstream :</p>\n\n<pre><code>std::stringstream ss;\nss &lt;&lt; \"/Users/Olly/Documents/BScProject/WeakLensing/SIGNAL/\"\n   &lt;&lt; \"realization_\" &lt;&lt; i &lt;&lt; \".dat\";\n\nstd::string mainFile = ss.str();\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7644278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5535ff1875ef6335983b73861ed662?s=128&d=identicon&r=PG&f=1", "display_name": "crazycrazy", "link": "https://stackoverflow.com/users/7644278/crazycrazy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 42544288, "answer_count": 3, "score": 1, "last_activity_date": 1488413894, "creation_date": 1488411696, "last_edit_date": 1488412136, "question_id": 42544258, "link": "https://stackoverflow.com/questions/42544258/can-i-loop-over-file-names-that-differ-only-by-an-integer-number", "title": "Can I loop over file names that differ only by an integer number?", "body": "<p>I have 100 files called \"realization_i.dat\", where i is an integer from 0 to 99. </p>\n\n<p>I want to loop over each file in order to import the data for use in manipulation in my code. </p>\n\n<p>I'm unsure on how to do this, but this is what I have so far:</p>\n\n<pre><code>for (int i = 0; i &lt; 99; i++) {\n\n    string path = \"/Users/Olly/Documents/BScProject/WeakLensing/SIGNAL/\";\n    string mainFile = path + \"realization_\" &lt;&lt; i &lt;&lt; \".dat\";\n    vector &lt;double&gt; Pos1, Pos2, E1, E2, Z, W, SC;\n    ifstream in(mainFile.c_str(), ios::in);\n</code></pre>\n\n<p>My thoughts are that, for i = 0, I would be inputting the data from the realization_0.dat file, and then realization_1.dat file, etc. up to realization_99.dat.</p>\n\n<p>I am getting the following error:</p>\n\n<pre><code>ShearStacks.cpp:41:49: error: invalid operands to binary expression\n      ('std::__1::basic_string&lt;char&gt;' and 'int')\n        string mainFile = path + \"realization_\" &lt;&lt; i &lt;&lt; \".dat\";\n</code></pre>\n\n<p>Can anyone explain why this doesn't work and suggest a new way of looping over the files? (Quite new to C++.)</p>\n"}, {"tags": ["c++", "callback", "function-pointers", "member-function-pointers"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488411689, "post_id": 42544230, "comment_id": 72224207, "body": "Did you read the posts under the tags you  provided, specifically under member-function-pointers?"}, {"owner": {"reputation": 103, "user_id": 1156608, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/db669aef9184c316739f568bfa4626c8?s=128&d=identicon&r=PG", "display_name": "TeroK", "link": "https://stackoverflow.com/users/1156608/terok"}, "edited": false, "score": 0, "creation_date": 1488411794, "post_id": 42544230, "comment_id": 72224240, "body": "Did couple of hours of searching all over the net. If you know a link to an answer, I&#39;d appreciate that."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1488412128, "post_id": 42544230, "comment_id": 72224371, "body": "What do you expect to happen if you set <code>p=&amp;A::callMe;</code> and then do <code>p(bb);</code>?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1488414960, "post_id": 42544230, "comment_id": 72225235, "body": "You need to know what kind of <code>this</code> to invoke the method on and that puts you in a sticky spot. if you want a generic function pointer that can hold anything, this can be done, but all type safety goes out the window. Your program becomes an accident waiting to happen unless you are very good and very, very careful. Have you considered discarding the exceptionally broad &quot;amy&quot; and having all of your classes you actually need to fit your problem extend a pure virtual base class that defines the function interface?"}, {"owner": {"reputation": 103, "user_id": 1156608, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/db669aef9184c316739f568bfa4626c8?s=128&d=identicon&r=PG", "display_name": "TeroK", "link": "https://stackoverflow.com/users/1156608/terok"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1488484016, "post_id": 42544230, "comment_id": 72263126, "body": "@aschepler that probably would not do any good, but not an issue as it&#39;s rather easily avoided."}, {"owner": {"reputation": 103, "user_id": 1156608, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/db669aef9184c316739f568bfa4626c8?s=128&d=identicon&r=PG", "display_name": "TeroK", "link": "https://stackoverflow.com/users/1156608/terok"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1488484427, "post_id": 42544230, "comment_id": 72263350, "body": "@user4581301 yes, I generally dislike function pointers due to all hazards out there, but they are irresistibly efficient when doing hard real time code. I&#39;ve checked also virtual methods route: they translate into if/else if/else structure in assembly and it gets slower when more choices become available. Calling a pointer will not slow down no matter how many callback choices you have available."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1488487016, "post_id": 42564899, "comment_id": 72264864, "body": "Looking at <code>FPointer</code>, you can strip out all of the <code>c_callback</code> because you always have an object and if you trust yourself all of the NULL pointer checks. What&#39;s going on in here is the &quot;all type safety goes out the window&quot; stuff I was talking about above. You can pack in anything you want and after that pray you got it right because the compiler can&#39;t help you."}, {"owner": {"reputation": 103, "user_id": 1156608, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/db669aef9184c316739f568bfa4626c8?s=128&d=identicon&r=PG", "display_name": "TeroK", "link": "https://stackoverflow.com/users/1156608/terok"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1488931056, "post_id": 42564899, "comment_id": 72447031, "body": "Found that MBED Callback class does this little bit more efficiently, but not very significant performance difference. Runs test in about 900ms. Removeing checking also saves few millisecs."}], "tags": [], "owner": {"reputation": 103, "user_id": 1156608, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/db669aef9184c316739f568bfa4626c8?s=128&d=identicon&r=PG", "display_name": "TeroK", "link": "https://stackoverflow.com/users/1156608/terok"}, "is_accepted": false, "score": 0, "last_activity_date": 1488486749, "last_edit_date": 1488486749, "creation_date": 1488485045, "answer_id": 42564899, "question_id": 42544230, "link": "https://stackoverflow.com/questions/42544230/c-function-pointer-to-a-non-static-member-function-of-any-class-type/42564899#42564899", "title": "C++ function pointer to a non-static member function of any class type", "body": "<p>Found one perfectly working solution from MBED project source codes (their FunctionPointer class):</p>\n\n<ul>\n<li><a href=\"https://developer.mbed.org/cookbook/FunctionPointer\" rel=\"nofollow noreferrer\">https://developer.mbed.org/cookbook/FunctionPointer</a></li>\n<li><a href=\"https://github.com/Seeed-Studio/mbed_ble/blob/master/mbed-src/api/FunctionPointer.h\" rel=\"nofollow noreferrer\">https://github.com/Seeed-Studio/mbed_ble/blob/master/mbed-src/api/FunctionPointer.h</a></li>\n<li><a href=\"https://github.com/Seeed-Studio/mbed_ble/blob/master/mbed-src/common/FunctionPointer.cpp\" rel=\"nofollow noreferrer\">https://github.com/Seeed-Studio/mbed_ble/blob/master/mbed-src/common/FunctionPointer.cpp</a></li>\n</ul>\n\n<p>Working example: </p>\n\n<pre><code>A foo;\nFunctionPointer  cb;\ncb.attach(&amp;foo,&amp;A::callMe);\nfor(i=0;i&lt;100000000;i++) //callback overhead test\n    cb.call();\n</code></pre>\n\n<p>The code inside FunctionPointer is not very obvious to me how it works. It memcpy some data etc. Any ideas if it could be simplified &amp; made faster? It still causes significantly more overhead compared to a case where class type is fixed, such as:</p>\n\n<pre><code>A foo;\ntypedef void (A::*MethodPtr) ();\nMethodPtr method = &amp;A::callMe;\nFoo *obj = &amp;foo;\nfor(i=0;i&lt;100000000;i++) //callback overhead test\n    (obj-&gt;*method)();\n</code></pre>\n\n<p>The above method is about 4x faster compared to FunctionPointer method when callMe contains only asm(\"nop\"). Some benchmarks on x86 &amp; GCC:</p>\n\n<ul>\n<li>direct call 205 ms</li>\n<li>the above function pointer example 258 ms</li>\n<li>FunctionPointer example 1049 ms</li>\n<li>std::function 3951 ms</li>\n</ul>\n\n<p>Any optimization ideas are very much appreciated!</p>\n"}], "owner": {"reputation": 103, "user_id": 1156608, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/db669aef9184c316739f568bfa4626c8?s=128&d=identicon&r=PG", "display_name": "TeroK", "link": "https://stackoverflow.com/users/1156608/terok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 719, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1488486749, "creation_date": 1488411527, "last_edit_date": 1488411719, "question_id": 42544230, "link": "https://stackoverflow.com/questions/42544230/c-function-pointer-to-a-non-static-member-function-of-any-class-type", "title": "C++ function pointer to a non-static member function of any class type", "body": "<p>I have seen a number of examples how to make a function pointer to a C++ class non-static member of a <em>specific</em> class type. However, I would have use for such pointer that would work for <em>any</em> type class. To demonstrate the idea, I wrote a pseudo example:</p>\n\n<pre><code>class A\n{\n    public:\n    A(){} //constructor    \n    void callMe() { /* do something */ }\n};\n\nclass B\n{\n    public:\n    B(){} //constructor    \n    void callMe() { /* do something */ }\n};\n\n\nmain()\n{\n    A aa;\n    B bb;\n\n    //pseudo part:\n    generic_method_pointer_type p; //how to define the type of p?\n\n    p=HOWTO;//set pointer p to point to A::callMe. How to do?\n\n    p(aa); //A::callMe on instance aa gets called\n\n    p=HOWTO;//set pointer p to point to B::callMe. How to do?\n\n    p(bb); //B::callMe on instance bb gets called\n}\n</code></pre>\n\n<p>Does this look possible?</p>\n\n<p>I know C++11 has new tricks such as <em>std::function</em> for this. I did some experiments on std::function and found it too slow for a real-time app running on a small microcontroller. That is why I would prefer direct hard coded pointers which would cause minimum overhead.</p>\n\n<p>Thank you for your advice!</p>\n"}, {"tags": ["c++", "templates", "c++17"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488409700, "post_id": 42543790, "comment_id": 72223483, "body": "You seem to want the template to create a constructor for you - that&#39;s not possible."}, {"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "edited": false, "score": 0, "creation_date": 1488409884, "post_id": 42543790, "comment_id": 72223559, "body": "@NeilButterworth Not my intention, just that if knew how to spell the specific constructor I wouldn&#39;t be asking the question. I&#39;ll edit to clarify"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488410073, "post_id": 42543790, "comment_id": 72223636, "body": "The <code>int</code> template parameter is a compile time thing - it doesn&#39;t make sense to pass it to a constructor at run time."}, {"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "edited": false, "score": 0, "creation_date": 1488410110, "post_id": 42543790, "comment_id": 72223647, "body": "@NeilButterworth read my comment on Brian&#39;s answer"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488410167, "post_id": 42543790, "comment_id": 72223669, "body": "Yes, but why not simply <code>Number &lt;3&gt; a;</code>?"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1488410367, "post_id": 42543790, "comment_id": 72223740, "body": "Perhaps something could be done with a constexpr function. I tried but failed and don&#39;t have the time to go further now."}, {"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "edited": false, "score": 0, "creation_date": 1488410385, "post_id": 42543790, "comment_id": 72223748, "body": "@NeilButterworth Oh, I see. I&#39;m just trying to do this c++17 style. The same way you&#39;d say <code>tuple a(2, 1.5)</code> to generate the type <code>tuple&lt;int, double&gt;</code> for <code>a</code> using template argument deduction for class <a href=\"http://open-std.org/JTC1/SC22/WG21/docs/papers/2016/p0091r1.html\" rel=\"nofollow noreferrer\">templates</a>. I&#39;m just wondering whether this technique incorporates non-type template parameters"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488410537, "post_id": 42543790, "comment_id": 72223801, "body": "@Lorah A constructor (or any other function) <i>does something</i>  - it&#39;s not a type. There is no way of generating what the constructor does from the type of the template."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1488410911, "post_id": 42543790, "comment_id": 72223936, "body": "@LorahAttkins The key point is that functions (including constructors) must know all the types they are involved with at compile time, but they cannot assume that their arguments are compile time expressions. E.g. if you imagine a factory function (a function that returns <code>Number&lt;I&gt;</code>), it must know it&#39;s signature at compile time. Since it is a template returning <code>Number&lt;I&gt;</code> it must know <code>I</code> at compile time. But it cannot know the <i>value</i> of its arguments at compile time. Only their type. That&#39;s the difference with <code>make_tuple</code>."}, {"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "edited": false, "score": 0, "creation_date": 1488410912, "post_id": 42543790, "comment_id": 72223937, "body": "@NeilButterworth In C++17 constructors can deduce the type of the class the same way the type of a function template can be deduced from its arguments. Knowing this, what I&#39;m asking is, can we extend this to non-type template parameters? (I mean surely we could wrap them in integral constants but that&#39;s just a workaround; is there a more elegant solution?)"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1488411010, "post_id": 42543790, "comment_id": 72223979, "body": "@LorahAttkins To clarify further vis a vis your last comment: this has nothing to do with deducing constructors. What you&#39;re asking is impossible; it would require a function to have a way to say: you can only call me with arguments that are <code>constexpr</code>. That does not exist in C++."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488411061, "post_id": 42543790, "comment_id": 72223994, "body": "@Lorah The point is that in C++ you cannot tell by looking at a function declaration  such as <code>int f(int n);</code> what it does. The compiler cannot possibly generate the code to do what it does. The same applies to constructors. What tuple and other constructors do is defined in code. Or maybe I am misunderstanding what you are asking here."}, {"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "edited": false, "score": 0, "creation_date": 1488411201, "post_id": 42543790, "comment_id": 72224038, "body": "@NeilButterworth No doubt, no doubt. I&#39;m asking for a user in Stack Overflow to write such a constructor, never said it would be auto generated"}, {"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "edited": false, "score": 0, "creation_date": 1488412982, "post_id": 42543790, "comment_id": 72224621, "body": "@NeilButterworth I posted a partial solution <a href=\"http://stackoverflow.com/a/42544425/4224575\">here</a>. If I were to rephrase the question, it&#39;d read &quot;can we do away with the integral constant in that solution&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "edited": false, "score": 0, "creation_date": 1488410031, "post_id": 42543884, "comment_id": 72223621, "body": "I assumed this could be done with an <code>integral_constant</code> argument (in the constructor) but then I got stuck when it came to converting a numeral to an integral constant. Maybe this is doable with an explicit deduction rule???"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "edited": false, "score": 1, "creation_date": 1488410354, "post_id": 42543884, "comment_id": 72223734, "body": "@LorahAttkins I don&#39;t think so. Template argument deduction only ever considers the types of arguments, not their values"}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": false, "score": 6, "last_activity_date": 1488409769, "creation_date": 1488409769, "answer_id": 42543884, "question_id": 42543790, "link": "https://stackoverflow.com/questions/42543790/can-template-argument-deduction-for-class-templates-work-for-non-type-template-p/42543884#42543884", "title": "Can template argument deduction for class templates work for non type template parameters?", "body": "<p>Template argument deduction for class templates can deduce non-type template parameters, but not in the way you're trying to do it.</p>\n\n<p>For example</p>\n\n<pre><code>template &lt;std::size_t size&gt;\nstruct ArrayWrapper {\n    ArrayWrapper(std::array&lt;int, size&gt; a);\n};\nint main() {\n    std:array&lt;int, 5&gt; a;\n    ArrayWrapper aw(a);  // ok; declares ArrayWrapper&lt;5&gt;\n}\n</code></pre>\n\n<p>But in your example you are trying to have a non-type template parameter deduced from the <em>value</em> of an argument. In general, the template deduction system of C++ does not support that, whether for class templates or in any other context.</p>\n"}, {"comments": [{"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "edited": false, "score": 0, "creation_date": 1488413270, "post_id": 42544372, "comment_id": 72224707, "body": "I was writing a similar solution (posted 5&#39; after this one). The way I was looking at it, you can have a conversion constructor with an int parameter while the deduction rule uses an integral constant. It&#39;s just a single conversion step away from what I was looking for. I thought some cunning use of the type system (or the ternary operator) could give us that"}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 4, "last_activity_date": 1488416746, "last_edit_date": 1488416746, "creation_date": 1488412350, "answer_id": 42544372, "question_id": 42543790, "link": "https://stackoverflow.com/questions/42543790/can-template-argument-deduction-for-class-templates-work-for-non-type-template-p/42544372#42544372", "title": "Can template argument deduction for class templates work for non type template parameters?", "body": "<p>Template deduction for constructors is still deduction - and deduction is all about types. The only way you can deduce a value is if that value is a non-type template argument of one of the types being deduced. So we can simply lift the <code>3</code> from a boring old <code>int</code> to a sophisticated, modern <code>std::integral_constant&lt;int, 3&gt;</code>:</p>\n\n<pre><code>template &lt;int I&gt; using int_t = std::integral_constant&lt;int, I&gt;;\ntemplate &lt;int I&gt; constexpr int_t&lt;I&gt; int_c;\n\ntemplate &lt;int I&gt;\nstruct Number {\n    Number(int_t&lt;I&gt; ) { }\n};\n\nint main()\n{\n    Number n(int_c&lt;3&gt; );\n}\n</code></pre>\n\n<hr />\n\n<p>Worth noting that the point of this feature is to avoid having to duplicate writing types (such as with <code>std::lock_guard</code>), or cases where naming the types may be impossible (such as class template specializations constructed with a lambda). Neither of those really apply here. When you have a value - that's it, just use the value:</p>\n\n<pre><code>Number&lt;3&gt; n;\n</code></pre>\n\n<p>That's the same number of characters as <code>Number n{3}</code>, which doesn't work, so there's nothing to gain. </p>\n"}, {"tags": [], "owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "is_accepted": false, "score": -2, "last_activity_date": 1488413564, "last_edit_date": 1488413564, "creation_date": 1488412701, "answer_id": 42544425, "question_id": 42543790, "link": "https://stackoverflow.com/questions/42543790/can-template-argument-deduction-for-class-templates-work-for-non-type-template-p/42544425#42544425", "title": "Can template argument deduction for class templates work for non type template parameters?", "body": "<p>I'm sharing my (partial) solution: </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;int I&gt;\nstruct Number\n{\n    // 1. \n    Number(int) {}\n};\n\n// 2. \ntemplate &lt;int K&gt; Number(std::integral_constant&lt;int, K&gt;) -&gt; Number&lt;K&gt;; \n\nint main()\n{\n    Number a{std::integral_constant&lt;int, 1&gt;{}}; // look ma, no \\&lt;&gt;/\n    (void)a; \n    return 0; \n}\n</code></pre>\n\n<p><a href=\"http://melpon.org/wandbox/permlink/SrNPtcwoDYJoy7y2\" rel=\"nofollow noreferrer\"><strong>Demo</strong></a></p>\n\n<p>What we do on the numbered comments above is: </p>\n\n<ol>\n<li><p>A one argument constructor. This serves as a conversion constructor for when we pass integral constants (comment this out and you get a compilation error)</p></li>\n<li><p>An explicit deduction rule</p></li>\n</ol>\n\n<p>What all this buys us, is the ability to <strong>declare a <code>Number</code> object w/o specifying template arguments</strong> i.e. by merely letting the constructor deduce them. Unfortunately, this solution is elegance-free, since the construction asks for an integral constant (which is then implicitly converted to an integer): </p>\n\n<pre><code>Number a{std::integral_constant&lt;int, 1&gt;{}}; // a := Number&lt;int&gt;\n</code></pre>\n\n<p>Taking this a step further would be to devise a way to simply write: </p>\n\n<pre><code>Number a{3}; \n</code></pre>\n\n<p>but the explicit deduction rule does not work for non-type template parameters, or at least I can't trick it to work. </p>\n"}], "owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 1, "answer_count": 3, "score": 5, "last_activity_date": 1488416746, "creation_date": 1488409339, "last_edit_date": 1488411459, "question_id": 42543790, "link": "https://stackoverflow.com/questions/42543790/can-template-argument-deduction-for-class-templates-work-for-non-type-template-p", "title": "Can template argument deduction for class templates work for non type template parameters?", "body": "<p>Can classes like the following take advantage of <a href=\"http://open-std.org/JTC1/SC22/WG21/docs/papers/2016/p0091r1.html\" rel=\"noreferrer\">template argument deduction for class templates</a>?</p>\n\n<pre><code>template &lt;int I&gt;\nstruct Number\n{\n    /* appropriate constructor here */\n}; \n</code></pre>\n\n<p>By \"take advantage\" I mean, is there a way to have (implicitly or explicitly) the value of <code>I</code> deduced? An example use would be the following: </p>\n\n<pre><code>Number a(3); // a's type is Number&lt;3&gt;\n</code></pre>\n"}, {"tags": ["c++", "unix", "process", "fork"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1488409336, "post_id": 42543737, "comment_id": 72223344, "body": "That&#39;s pretty much how it works in every other Unix shell."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488409339, "post_id": 42543737, "comment_id": 72223347, "body": "Any reason for not writing this in C, which it almost all is?"}, {"owner": {"reputation": 51, "user_id": 5390364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/93ecee766866060cad288650b6521d64?s=128&d=identicon&r=PG&f=1", "display_name": "HOAX", "link": "https://stackoverflow.com/users/5390364/hoax"}, "edited": false, "score": 0, "creation_date": 1488409698, "post_id": 42543737, "comment_id": 72223481, "body": "@NeilButterworth Just more comfortable with C++"}, {"owner": {"reputation": 51, "user_id": 5390364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/93ecee766866060cad288650b6521d64?s=128&d=identicon&r=PG&f=1", "display_name": "HOAX", "link": "https://stackoverflow.com/users/5390364/hoax"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1488409731, "post_id": 42543737, "comment_id": 72223496, "body": "@immibis just worried about my prompt not showing up really. Do you know how I could fix that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1488409766, "post_id": 42543737, "comment_id": 72223512, "body": "@HOAX That&#39;s not obvious from your code."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1488410223, "post_id": 42543737, "comment_id": 72223684, "body": "@HOAX The prompt does show up, it shows up on the third line of your output."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1488449290, "post_id": 42543737, "comment_id": 72239712, "body": "This is not an error, since <code>&amp;</code> is a request for concurrency, then you faced it! Child and parent are concurrent. I&#39;m not sure why you would consider this as an error as any shell will behave exactly the same and it is inherent to concurrency."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5390364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/93ecee766866060cad288650b6521d64?s=128&d=identicon&r=PG&f=1", "display_name": "HOAX", "link": "https://stackoverflow.com/users/5390364/hoax"}, "edited": false, "score": 0, "creation_date": 1488410144, "post_id": 42543888, "comment_id": 72223660, "body": "Thank you for the lengthy response, will look into my errors."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1488410586, "post_id": 42543888, "comment_id": 72223818, "body": "Note than in the POSIX shell (Bash, Korn, \u2026), an <code>&amp;</code> marks the end of a command unless it is followed by another <code>&amp;&amp;</code> (well, that still marks the end of the command \u2014 it&#39;s a different terminator, though) \u2014 or unless it&#39;s one of the obscure <a href=\"https://www.gnu.org/software/bash/manual/bash.html#Redirections\" rel=\"nofollow noreferrer\">Bash redirection</a> syntaxes that uses <code>&amp;</code> as the first character (<code>&amp;&gt;</code> and relatives)."}, {"owner": {"reputation": 51, "user_id": 5390364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/93ecee766866060cad288650b6521d64?s=128&d=identicon&r=PG&f=1", "display_name": "HOAX", "link": "https://stackoverflow.com/users/5390364/hoax"}, "edited": false, "score": 0, "creation_date": 1488414642, "post_id": 42543888, "comment_id": 72225152, "body": "Hey Sam, would I be able to use waitpid instead of handling the SIGCHLD directly? Having a hard time understanding this concept"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1488418889, "post_id": 42543888, "comment_id": 72226262, "body": "<code>waitpid()</code> blocks until the process terminates. Your program will be unable to do anything else until the child process terminates. You could use <code>WNOHANG</code>, but you still have to know when the child process terminates. You are approaching this issue from a completely wrong perspective. You need to figure out, first, what your program should be doing and then figure out the right system calls and how to use them, not the other way around."}], "tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": false, "score": 3, "last_activity_date": 1488410249, "last_edit_date": 1488410249, "creation_date": 1488409788, "answer_id": 42543888, "question_id": 42543737, "link": "https://stackoverflow.com/questions/42543737/having-issues-with-forking-a-process/42543888#42543888", "title": "Having issues with forking a process", "body": "<p>No, you are already at the command prompt:</p>\n\n<pre><code>osh&gt; child:0\ntotal 44\n</code></pre>\n\n<p>That's your command, prompt, the <code>osh&gt;</code> prompt.</p>\n\n<p>Your issue here is that your computer is doing exactly what you're telling it to do, and not what you wanted it to do. Your code (which has an unrelated, major bug, which I'll get to in the moment) says not to wait until the child process finishes, and proceed, if <code>&amp;</code> was entered.</p>\n\n<p>And that's exactly what happened. The child process got started, and your parent process immediately emitted the next <code>osh&gt;</code> prompt. And, it did it so fast, before the child process even got a change to produce any output. As such, the output from the child process appears on your terminal, after the <code>osh&gt;</code> prompt. Since your parent process already produced its prompt, it is now waiting for your next input, and it has no reason not to continue to wait, after the child process has terminated, and finished producing its output.</p>\n\n<p>That answers the question of what happened to your prompt. You did not explain what you expected to happen, so nothing further can be said about it; but if you want to reissue the prompt again, after the child process terminates, you can do that by properly handling the <code>SIGCHLD</code> signal. See your C++ book for more information.</p>\n\n<p>As far as your unrelated bug, it's actually two bugs:</p>\n\n<pre><code>if (*args[index - 1] == '&amp;')\n  status = true;\n\nargs[index - 1] = NULL; //re\n</code></pre>\n\n<p>First bug: anything that starts with <code>'&amp;'</code>, and not just \"&amp;\" by itself, will trigger the background job behavior.</p>\n\n<p>Second bug: if <code>'&amp;'</code> was not entered, this code will still chop off the last word that was entered. Which is why when you entered the command <code>ls -l</code>, you ended up executing <code>ls</code>, and getting the resulting output, from your first command.</p>\n"}], "owner": {"reputation": 51, "user_id": 5390364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/93ecee766866060cad288650b6521d64?s=128&d=identicon&r=PG&f=1", "display_name": "HOAX", "link": "https://stackoverflow.com/users/5390364/hoax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1488410249, "creation_date": 1488409071, "question_id": 42543737, "link": "https://stackoverflow.com/questions/42543737/having-issues-with-forking-a-process", "title": "Having issues with forking a process", "body": "<p>So I'm writing a UNIX shell for a class of mine and basically I take in an argument, if the argument has '&amp;' at the end of it then I need the parent process to invoke wait();.</p>\n\n<p>My problem here is that the program should accept inputs until I type exit, so everything is in a 'while' loop. Things run perfect until I call a command with '&amp;' at the end of it, and then I can see that the parent process ends, then the child ends, but then I'm not at my normal prompt to accept an input which is \"osh> \". </p>\n\n<p>So basically here's my normal output when I run a simple command:</p>\n\n<pre><code>osh&gt; ls -l\nchild:0\na.out  main  main.cpp  main.cpp~\nparent: 8695 \n</code></pre>\n\n<p>But then when I run a command with the '&amp;' at the end this happens:</p>\n\n<pre><code>osh&gt; ls -l &amp;\nparent: 27082\nosh&gt; child:0\ntotal 44\n-rwxr-xr-x 1 myuser users 10368 Mar  1 14:46 a.out\n-rwxr-xr-x 1 myuser users 23368 Mar  1 14:00 main\n-rw-r--r-- 1 myuser users  1658 Mar  1 14:46 main.cpp\n-rw-r--r-- 1 myuser users  1676 Mar  1 14:45 main.cpp~\n&lt;cursor is here accepting commands, but no osh&gt; prompt&gt;\n</code></pre>\n\n<p>If anyone has any comments or suggestions, would be appreciated. I feel like it's just a small bug but I've ran through a debugger multiple times and can't find anything. I just don't have that much experience forking things. Here's the full code to look at:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;iostream&gt;\n#include &lt;string.h&gt;\n#include &lt;string&gt;\n#include &lt;cstring&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAX_LINE 80 //the maximum length command\n\nusing namespace std;\n\nint main()\n{\n  char* args[MAX_LINE/2 + 1]; //command line arguments\n  char str[41]; //intitialize string for input\n  int should_run = 1; //flag to determine when to exit program\n  bool status; //status of whether or not an ampersand is in the passed argument\n\n  while (should_run) {\n    int index = 0;\n\n    cout &lt;&lt; \"osh&gt; \";\n    fflush(stdout);\n\n    cin.getline(str, 41);\n\n    args[index] = strtok(str, \" \");\n\n    while (args[index] != NULL) {\n      index++;\n      args[index] = strtok(NULL, \" \");\n    }\n\n    if (strcmp (args[0], \"exit\") == 0) //in input is \"exit\", exit the while loop\n      break;\n\n    if (*args[index - 1] == '&amp;') //check whether to run processes concurrently\n      status = true;\n\n    args[index - 1] = NULL; //remove &amp; to make sure arguments are valid\n\n    // (1) fork a child process using fork()\n    pid_t pid = fork();\n\n    if (pid &lt; 0) { //error handling\n      perror(\"Fork Failed.\");\n      break;\n      }\n    // (2) the child process will invoke execvp()\n    if (pid == 0) {\n      //child process\n      cout &lt;&lt; \"child:\" &lt;&lt; pid &lt;&lt; endl;\n      if ( execvp (args[0], args) == -1 ) {\n        perror (\"exec\");\n      }\n    }\n\n    // (3) if command didn't included &amp;, parent will invoke wait()\n    //parent process\n    if (pid &gt; 0) {\n        // parent process\n       if (!status) {\n         wait(0);\n         }\n       cout &lt;&lt; \"parent: \" &lt;&lt; pid &lt;&lt; endl;\n    }\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Edit: Also just realized that on my second output I posted, it shows \"osh>\" a second time after the parent process, not sure how to describe that error.</p>\n"}, {"tags": ["c++", "wiimote"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1488409236, "post_id": 42543733, "comment_id": 72223308, "body": "scrollbar overflow.. Please try to remove not relevant stuff. (see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1488409258, "post_id": 42543733, "comment_id": 72223316, "body": "You use <code>pBase</code> inside <code>WiimoteToLed::AccelerationEvent</code> where it is not defined"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1488409476, "post_id": 42543733, "comment_id": 72223401, "body": "What exactly is the point of <code>pBase</code> parameter in  <code>RegisterWrite</code>? Did you intentionally use a matching parameter name to hide the class member? Why such inconsistency between <code>RegisterRead</code> (uses class member) and <code>RegisterWrite</code> (uses a parameter)?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7423352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46dedb02b3eb1e8b12b4ffeff3fbedf?s=128&d=identicon&r=PG&f=1", "display_name": "Ben G.", "link": "https://stackoverflow.com/users/7423352/ben-g"}, "edited": false, "score": 0, "creation_date": 1488495455, "post_id": 42543814, "comment_id": 72269068, "body": "Is there a way I could call that pBase from zed_board? I&#39;ve tried using zed_board.pBase and zed_board-&gt;pBase but neither work."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 1, "user_id": 7423352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46dedb02b3eb1e8b12b4ffeff3fbedf?s=128&d=identicon&r=PG&f=1", "display_name": "Ben G.", "link": "https://stackoverflow.com/users/7423352/ben-g"}, "edited": false, "score": 0, "creation_date": 1488496207, "post_id": 42543814, "comment_id": 72269370, "body": "@BenG. why do you want to pass it as parameter when it is a member variable?"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 2, "last_activity_date": 1488409448, "creation_date": 1488409448, "answer_id": 42543814, "question_id": 42543733, "link": "https://stackoverflow.com/questions/42543733/pbase-not-defined-pbase-is-defined-in-the-included-class/42543814#42543814", "title": "&quot;pBase not defined&quot;? pBase is defined in the included class", "body": "<p>In <code>WiimoteToLed::AccelerationEvent</code> you call</p>\n\n<pre><code>zed_board-&gt;Write1Led(pBase,1,1);\n</code></pre>\n\n<p>but <code>pBase</code> is not declared in this scope. You have a <code>pBase</code> member of the <code>zed_board</code>, but that is a different one.</p>\n"}], "owner": {"reputation": 1, "user_id": 7423352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46dedb02b3eb1e8b12b4ffeff3fbedf?s=128&d=identicon&r=PG&f=1", "display_name": "Ben G.", "link": "https://stackoverflow.com/users/7423352/ben-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1539828573, "creation_date": 1488409054, "last_edit_date": 1489998249, "question_id": 42543733, "link": "https://stackoverflow.com/questions/42543733/pbase-not-defined-pbase-is-defined-in-the-included-class", "title": "&quot;pBase not defined&quot;? pBase is defined in the included class", "body": "<p>This program is supposed to read acceleration values from a Wii remote and light up LEDs based on those values. The only error I'm getting that prevents compilation is that pBase isn't defined in main.cpp. main.cpp includes ZedBoard.h and ZedBoard.cpp where pBase is defined so I'm failing to see the issue here. I've been trying to solve this for a while and I can't figure it out.</p>\n\n<p>ZedBoard.h</p>\n\n<pre><code>#ifndef ZEDBOARD_H\n#define ZEDBOARD_H\n\nconst int gpio_led1_offset = 0x12C;  // Offset for LED1\nconst int gpio_led2_offset = 0x130;  // Offset for LED2\nconst int gpio_led3_offset = 0x134;  // Offset for LED3\nconst int gpio_led4_offset = 0x138;  // Offset for LED4\nconst int gpio_led5_offset = 0x13C;  // Offset for LED5\nconst int gpio_led6_offset = 0x140;  // Offset for LED6\nconst int gpio_led7_offset = 0x144;  // Offset for LED7\nconst int gpio_led8_offset = 0x148;  // Offset for LED8\n\nconst int gpio_sw1_offset = 0x14C;  // Offset for Switch 1\nconst int gpio_sw2_offset = 0x150;  // Offset for Switch 2\nconst int gpio_sw3_offset = 0x154;  // Offset for Switch 3\nconst int gpio_sw4_offset = 0x158;  // Offset for Switch 4\nconst int gpio_sw5_offset = 0x15C;  // Offset for Switch 5\nconst int gpio_sw6_offset = 0x160;  // Offset for Switch 6\nconst int gpio_sw7_offset = 0x164;  // Offset for Switch 7\nconst int gpio_sw8_offset = 0x168;  // Offset for Switch 8\n\nconst int gpio_pbtnl_offset = 0x16C;  // Offset for left push button\nconst int gpio_pbtnr_offset = 0x170;  // Offset for right push button\nconst int gpio_pbtnu_offset = 0x174;  // Offset for up push button\nconst int gpio_pbtnd_offset = 0x178;  // Offset for down push button\nconst int gpio_pbtnc_offset = 0x17C;  // Offset for center push button\n\n\n// Physical base address of GPIO\nconst unsigned gpio_address = 0x400d0000;\n\n// Length of memory-mapped IO window\nconst unsigned gpio_size = 0xff;\n\n// Class Definition\nclass ZedBoard {\nprivate:\n    char *pBase;    // virtual address where I/O was mapped\n    int fd;         // file descriptor for dev memory\n    int dummyValue; // for testing without a Zedboard\npublic:\n    ZedBoard();             // Default Constructor\n    ~ZedBoard();    // Destructor\n    void RegisterWrite(char *pBase, int offset, int value);\n    int RegisterRead(int offset);\n    void Write1Led(char *pBase, int ledNum, int state);\n    void WriteAllLeds(int value);\n    int Read1Switch(int switchNum);\n    int ReadAllSwitches();\n};\n\n#endif\n</code></pre>\n\n<p>ZedBoard.cpp</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;iostream&gt;\n#include \"ZedBoard.h\"\n\nusing namespace std;\n\n/**\n * Constructor Initialize general-purpose I/O\n *  - Opens access to physical memory /dev/mem\n *  - Maps memory at offset 'gpio_address' into virtual address space\n *\n * @param  None Default constructor does not need arguments.\n * @return      None Default constructor does not return anything.\n */\n ZedBoard::ZedBoard(){\n    cout &lt;&lt; \"\\nStarting....\" &lt;&lt; endl;\n     // dummyValue = 99;\n     // Uncomment this block of code when connected to the Zedboard\n    fd = open( \"/dev/mem\", O_RDWR);\n    pBase = (char *) mmap(NULL,gpio_size,PROT_READ | PROT_WRITE,\n            MAP_SHARED,fd,gpio_address);\n    // Check error\n    if (pBase == MAP_FAILED)\n    {\n            cerr &lt;&lt; \"Mapping I/O memory failed - Did you run with 'sudo'?      \\n\";\n            exit(1); // Returns 1 to the operating system;\n    }\n\n}\n/**\n * Destructor to close general-purpose I/O.\n * - Uses virtual address where I/O was mapped.\n * - Uses file descriptor previously returned by 'open'.\n *\n * @param  None Destructor does not need arguments.\n * @return      None Destructor does not return anything.\n */\nZedBoard::~ZedBoard(){\n         munmap(pBase, gpio_size);\n}\n\n/*\n*   Write a 4-byte value at the specified general-purpose I/O location.\n*\n*      - Uses base address returned by 'mmap'.\n*      @parem offset    Offset where device is mapped.\n*      @param value             Value to be written.\n*/\nvoid ZedBoard::RegisterWrite(char *pBase, int offset, int value)\n{\n        * (int *) (pBase + offset) = value;\n//      dummyValue = value;\n}\n\n/**\n* Read a 4-byte value from the specified general-purpose I/O location.\n\n - Uses base address returned by 'mmap'.\n @param offset  Offset where device is mapped.\n @return                Value read.\n*/\nint ZedBoard::RegisterRead(int offset)\n{\n        return * (int *) (pBase + offset);\n//      return dummyValue;\n}\n\n/*\nChanges the state of an LED (ON or OFF)\n\n- Uses base address of I/O\n@param ledNum   LED number (0 to 7)\n@param state    State to change to (ON or OFF)\n*/\n\n/*\nShow lower 8 bits of integer value on LEDs\n- Calls Write1Led() to set all LEDs\n@param value    Value to show on LEDs\n*/\nvoid ZedBoard::WriteAllLeds(int value)\n{\n        cout &lt;&lt; \"\\nWriting to all LEDs....\" &lt;&lt; endl;\n                for(int i = 0; i &lt; 8; i++) {// write to all LEDs\n                        Write1Led(pBase, i, (value / (1&lt;&lt;i)) % 2);\n                }\n}\n\nvoid ZedBoard::Write1Led(char *pBase, int ledNum, int state)\n{\n        cout &lt;&lt; \"\\nWriting to LED \" &lt;&lt; ledNum &lt;&lt; \": LED state = \" &lt;&lt; state &lt;&lt; endl;\n        if (ledNum == 1)\n        {\n                RegisterWrite(pBase, gpio_led1_offset, state);\n        }\n        else\n        {\n                RegisterWrite(pBase, gpio_led1_offset + (ledNum * 4), state);\n        }\n}\n\n/*\nReads the value of a switch\n\n- Uses base address of I/O\n@param switchNum        Switch number (0 to 7)\n@return         Switch value read\n*/\nint ZedBoard::Read1Switch(int switchNum)\n{\n        cout &lt;&lt; \"\\nReading Switch \" &lt;&lt; switchNum &lt;&lt; endl;\n        //return RegisterRead(gpio_sw1_offset + (switchNum * 4));\n        return switchNum;\n}\n\n/*\n        Reads the switch values into a decimal integer\n\n        - Calls Read1Switch() to read all switches\n        @return         Switches' value read\n*/\nint ZedBoard::ReadAllSwitches()\n{\n        int switchValue = 0;\n        cout &lt;&lt; \"\\nReading all switches....\" &lt;&lt; endl;\n        for(int i = 7; i &gt;= 0; i--) {// read all switches\n                switchValue = (switchValue &lt;&lt; 1) + Read1Switch(i);\n        }\n        return switchValue;\n}\n</code></pre>\n\n<p>WiimoteAccel.h</p>\n\n<pre><code>    #ifndef WIIMOTEACCEL_H\n    #define WIIMOTEACCEL_H\n\n    class WiimoteAccel{\n    public:\n            WiimoteAccel();\n            ~WiimoteAccel();\n            void Wiimote();\n            void Listen();\n            virtual void AccelerationEvent(int code, int acceleration);\n    private:\n            int fd;\n    };\n\n    #endif\n\nWiimoteAccel.cpp\n\n#include &lt;stdlib.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;iostream&gt;\n#include \"ZedBoard.h\"\n#include \"WiimoteAccel.h\"\n\nWiimoteAccel::WiimoteAccel()\n{\n}\nWiimoteAccel::~WiimoteAccel()\n{\n}\n\nvoid WiimoteAccel::Wiimote()\n{\n        fd = open(\"/dev/input/event0\", O_RDONLY);\n        if (fd == -1)\n        {\n                std::cerr &lt;&lt; \"Error: Could not open event file - forgot sudo?\\n\";\n                exit(1);\n        }\n}\n\nvoid WiimoteAccel::Listen()\n{\n        for (;;)\n        {\n                // Read a packet of 16 bytes from Wiimote\n                char buffer[16];\n                read(fd, buffer, 16);\n                // Extract code (byte 10) and value (byte 12) from packet\n                int code = buffer[10];\n                short acceleration = * (short *) (buffer + 12);\n                this-&gt;AccelerationEvent(code, acceleration);\n        }\n}\n\nvoid WiimoteAccel::AccelerationEvent(int code, int acceleration)\n{\n        // Print them\n        std::cout &lt;&lt; \"Code = \" &lt;&lt; code &lt;&lt; \", acceleration = \" &lt;&lt; acceleration &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;iostream&gt;\n#include \"WiimoteAccel.h\"\n#include \"ZedBoard.h\"\n#include \"ZedBoard.cpp\"\n\nusing namespace std;\n\nclass WiimoteToLed : public WiimoteAccel {\nprivate:\n        ZedBoard* zed_board;\npublic:\n        WiimoteToLed(ZedBoard* zed_board);\n        ~WiimoteToLed();\n        void AccelerationEvent(int code, int acceleration)\n        {\n        int x = 0;\n        for(;;)\n        {\n                if (code == 3)\n                {\n                        cout &lt;&lt; \"ACCELERATION IS \"&lt;&lt; acceleration &lt;&lt;\"!\\n\";\n\n                        if(acceleration == 0)\n                        {\n                                x = 0;\n                        }\n                        else if(acceleration &gt; -100 &amp;&amp; acceleration &lt;= -75)\n                        {\n                                x = 1;\n                        }\n                        else if(acceleration &gt; -75 &amp;&amp; acceleration &lt;= -50)\n                        {\n                                x = 2;\n                        }\n                        else if(acceleration &gt; -50 &amp;&amp; acceleration &lt;= -25)\n                        {\n                                x = 3;\n                        }\n                        else if(acceleration &gt; -25 &amp;&amp; acceleration &gt; 0)\n                        {\n                                x = 4;\n                        }\n                        else if(acceleration &lt; 0 &amp;&amp; acceleration &gt;= 25)\n                        {\n                                x = 5;\n                        }\n                        else if(acceleration &lt; 25 &amp;&amp; acceleration &gt;= 50)\n                        {\n                                x = 6;\n                        }\n                        else if(acceleration &lt; 50 &amp;&amp; acceleration &gt;= 75)\n                        {\n                                x = 7;\n                        }\n                        else if(acceleration &lt; 75 &amp;&amp; acceleration &gt;= 100)\n                        {\n                            x = 8;\n                        }\n\n\n                    switch(x)\n                    {\n\n                    case 0:\n                            cout &lt;&lt; \"Wiimote isn't moving\\n\";\n                            zed_board-&gt;Write1Led(pBase,1,0);\n                            zed_board-&gt;Write1Led(pBase,2,0);\n                            zed_board-&gt;Write1Led(pBase,3,0);\n                            zed_board-&gt;Write1Led(pBase,4,0);\n                            zed_board-&gt;Write1Led(pBase,5,0);\n                            zed_board-&gt;Write1Led(pBase,6,0);\n                            zed_board-&gt;Write1Led(pBase,7,0);\n                            zed_board-&gt;Write1Led(pBase,8,0);\n\n\n                    case 1:\n\n                            zed_board-&gt;Write1Led(pBase,1,1);\n                            zed_board-&gt;Write1Led(pBase,2,0);\n                            zed_board-&gt;Write1Led(pBase,3,0);\n                            zed_board-&gt;Write1Led(pBase,4,0);\n                            zed_board-&gt;Write1Led(pBase,5,0);\n                            zed_board-&gt;Write1Led(pBase,6,0);\n                            zed_board-&gt;Write1Led(pBase,7,0);\n                            zed_board-&gt;Write1Led(pBase,8,0);\n\n\n                    case 2:\n                            zed_board-&gt;Write1Led(pBase,1,1);\n                            zed_board-&gt;Write1Led(pBase,2,1);\n                            zed_board-&gt;Write1Led(pBase,3,0);\n                            zed_board-&gt;Write1Led(pBase,4,0);\n                            zed_board-&gt;Write1Led(pBase,5,0);\n                            zed_board-&gt;Write1Led(pBase,6,0);\n                            zed_board-&gt;Write1Led(pBase,7,0);\n                            zed_board-&gt;Write1Led(pBase,8,0);\n\n                    case 3:\n                            zed_board-&gt;Write1Led(pBase,1,1);\n                            zed_board-&gt;Write1Led(pBase,2,1);\n                            zed_board-&gt;Write1Led(pBase,3,1);\n                            zed_board-&gt;Write1Led(pBase,4,0);\n                            zed_board-&gt;Write1Led(pBase,5,0);\n                            zed_board-&gt;Write1Led(pBase,6,0);\n                            zed_board-&gt;Write1Led(pBase,7,0);\n                            zed_board-&gt;Write1Led(pBase,8,0);\n                    case 4:\n                            zed_board-&gt;Write1Led(pBase,1,1);\n                            zed_board-&gt;Write1Led(pBase,2,1);\n                            zed_board-&gt;Write1Led(pBase,3,1);\n                            zed_board-&gt;Write1Led(pBase,4,1);\n                            zed_board-&gt;Write1Led(pBase,5,0);\n                            zed_board-&gt;Write1Led(pBase,6,0);\n                            zed_board-&gt;Write1Led(pBase,7,0);\n                            zed_board-&gt;Write1Led(pBase,8,0);\n\n                    case 5:\n\n                            zed_board-&gt;Write1Led(pBase,1,1);\n                            zed_board-&gt;Write1Led(pBase,2,1);\n                            zed_board-&gt;Write1Led(pBase,3,1);\n                            zed_board-&gt;Write1Led(pBase,4,1);\n                            zed_board-&gt;Write1Led(pBase,5,1);\n                            zed_board-&gt;Write1Led(pBase,6,0);\n                            zed_board-&gt;Write1Led(pBase,7,0);\n                            zed_board-&gt;Write1Led(pBase,8,0);\n\n                    case 6:\n                            zed_board-&gt;Write1Led(pBase,1,1);\n                            zed_board-&gt;Write1Led(pBase,2,1);\n                            zed_board-&gt;Write1Led(pBase,3,1);\n                            zed_board-&gt;Write1Led(pBase,4,1);\n                            zed_board-&gt;Write1Led(pBase,5,1);\n                            zed_board-&gt;Write1Led(pBase,6,1);\n                            zed_board-&gt;Write1Led(pBase,7,0);\n                            zed_board-&gt;Write1Led(pBase,8,0);\n\n                    case 7:\n                            zed_board-&gt;Write1Led(pBase,1,1);\n                            zed_board-&gt;Write1Led(pBase,2,1);\n                            zed_board-&gt;Write1Led(pBase,3,1);\n                            zed_board-&gt;Write1Led(pBase,4,1);\n                            zed_board-&gt;Write1Led(pBase,5,1);\n                            zed_board-&gt;Write1Led(pBase,6,1);\n                            zed_board-&gt;Write1Led(pBase,7,1);\n                            zed_board-&gt;Write1Led(pBase,8,0);\n\n                    case 8:\n                            zed_board-&gt;Write1Led(pBase,1,1);\n                            zed_board-&gt;Write1Led(pBase,2,1);\n                            zed_board-&gt;Write1Led(pBase,3,1);\n                            zed_board-&gt;Write1Led(pBase,4,1);\n                            zed_board-&gt;Write1Led(pBase,5,1);\n                            zed_board-&gt;Write1Led(pBase,6,1);\n                            zed_board-&gt;Write1Led(pBase,7,1);\n                            zed_board-&gt;Write1Led(pBase,8,1);\ndefault:\n\n                                cout &lt;&lt; \"Code = \" &lt;&lt; code &lt;&lt;'\\n';\n                        }\n                }\n\n                else\n                {\n                        continue;\n                }\n\n        }\n        }\n};\n\nWiimoteToLed::WiimoteToLed(ZedBoard* zed_board)\n{\n        Wiimote();\n}\n\nWiimoteToLed::~WiimoteToLed()\n{\n\n}\n\nint main()\n{\n        // Instantiate ZedBoard object statically\n        ZedBoard zed_board;\n        // Instantiate WiimoteToLed object statically, passing a pointer to the\n        // recently created ZedBoard object.\n        WiimoteToLed wiimote_to_led(&amp;zed_board);\n        // Enter infinite loop listening to events. The overridden function\n        // WiimoteToLed::AccelerationEvent() will be invoked when the user moves\n        // the Wiimote.\n        wiimote_to_led.Listen();\n        // Unreachable code, previous function has an infinite loop\n        return 0;\n}\n</code></pre>\n\n<p>makefile</p>\n\n<pre><code>WiimoteAccel: main.o WiimoteAccel.o\n        g++ main.o WiimoteAccel.o -o WiimoteAccel\n\nmain.o: main.cpp WiimoteAccel.h\n        g++ -g -Wall -c main.cpp\n\nWiimoteAccel.o: WiimoteAccel.cpp WiimoteAccel.h\n        g++ -g -Wall -c WiimoteAccel.cpp\n\nclean:\n        rm main.o WiimoteAccel.o WiimoteAccel\n</code></pre>\n"}, {"tags": ["c++", "clion"], "comments": [{"owner": {"reputation": 16953, "user_id": 2799037, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2uPVa.png?s=128&g=1", "display_name": "usr1234567", "link": "https://stackoverflow.com/users/2799037/usr1234567"}, "edited": false, "score": 0, "creation_date": 1488409080, "post_id": 42543709, "comment_id": 72223241, "body": "Unrelated to CMake, please drop the tag."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1488409396, "post_id": 42543709, "comment_id": 72223364, "body": "There is no such thing as &quot;importing&quot; in C++."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1488409463, "post_id": 42543709, "comment_id": 72223392, "body": "Just checking, you know your #ifndef/#define/#endif lines don&#39;t do anything useful, right?"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1488410384, "post_id": 42543709, "comment_id": 72223746, "body": "Most of us have the <code>#endif</code> at the <i>end</i> of the include file. And <code>Face.h</code> can get away with not including <code>&lt;vector&gt;</code> if it happens to get included after some other file that <i>does</i> include <code>&lt;vector&gt;</code>. <code>Vec3.h</code> doesn&#39;t use any vector, so it gets away free."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1488410474, "post_id": 42543709, "comment_id": 72223785, "body": "Finishing the comment many others have hinted at: <a href=\"https://en.wikipedia.org/wiki/Include_guard\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Include_guard</a>"}], "owner": {"reputation": 1, "user_id": 6397105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Epw6Y.png?s=128&g=1", "display_name": "Capacitor", "link": "https://stackoverflow.com/users/6397105/capacitor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488409382, "creation_date": 1488408935, "last_edit_date": 1488409382, "question_id": 42543709, "link": "https://stackoverflow.com/questions/42543709/clion-strangely-needs-no-import-for-1-class-but-fails-on-equalls-structured", "title": "CLion: Strangely needs no import for #1 class, but fails on equalls structured #2 class", "body": "<p>I am an absolute C/C++ beginner who's struggling with that problem for 3 days now. As following, I have a class <code>Geometry</code> with header and .cpp definition files. Just take a look:</p>\n\n<pre><code>//Geometry.h\n#ifndef PROJECT_GEOMETRY_H\n#define PROJECT_GEOMETRY_H\n\n#endif //PROJECT_GEOMETRY_H\n\n#include &lt;vector&gt;\n\nclass Geometry\n{\npublic:\n    std::vector&lt;Vec3&gt; vertices;\n    std::vector&lt;Face&gt; faces;\n\npublic:\n    Geometry();\n    ~Geometry();\n\npublic:\n    void rotate(char axis, float degrees);\n    void rotateAroundOrigin(char axis, float degrees, Vec3 origin);\n    void transform(double x, double y, double z);\n    void transform(Vec3 bar);\n};\n</code></pre>\n\n<p>and also <code>Vec3.h and Face.h</code></p>\n\n<pre><code>//Vec3.h\n#ifndef PROJECT_VEC3_H\n#define PROJECT_VEC3_H\n\n#endif //PROJECT_VEC3_H\n\nclass Vec3\n{\npublic:\n    Vec3(double x, double y, double z);\n    ~Vec3();\n\npublic:\n    double distance(Vec3 n);\n    void rotate(char axis, float deg);\n    void rotateAroundOrigin(char axis, float deg, Vec3 origin);\n    void rotateAroundOriginPrecomputed(char axis, float deg, Vec3 origin, float sine, float cosine);\n\nprivate:\n    void rZ(float deg, Vec3* origin, float* sine, float* cosine);\n    void rY(float deg, Vec3* origin, float* sine, float* cosine);\n    void rX(float deg, Vec3* origin, float* sine, float* cosine);\n\npublic:\n    double x;\n    double y;\n    double z;\n};\n</code></pre>\n\n<p>[<em>Please comment if you also need the .cpp files</em>]</p>\n\n<pre><code>//Face.h\n#ifndef PROJECT_FACE_H\n#define PROJECT_FACE_H\n\n#endif //PROJECT_FACE_\n\nclass Face\n{\npublic:\n    std::vector&lt;Vec3*&gt; vertices;\n\npublic:\n    Face();\n    Face(std::vector&lt;Vec3&gt; bar);\n    ~Face();\n\npublic:\n    Vec3 getMidpoint();\n};\n</code></pre>\n\n<p>The problem is, that the generic type of <code>vertices</code> is recognized without even importing the class <code>Vec3</code> [Which is suspicious enough on its own], but <code>Face</code> instead is thought to be a <em>variable</em> by CLion and is treated as <code>not declared in this scope</code> when compiling [The latter one being logical, 'cause class not imported, right?], though <code>Vec3</code> stays quiet at compile-time.</p>\n\n<p>All header files are in the same directory, <code>src/headers</code></p>\n\n<p>And <strong>yes</strong>, all files are referenced in <code>CMakeLists.txt</code></p>\n\n<p>[<em>And I just noticed that <code>Vec3.h</code> doesn't need to include <code>&lt;vector&gt;</code> (it all makes no sense!)</em>]</p>\n\n<p>I'm so sure I did something so stupidly <strong>wrong</strong> that the C/C++ veterans out there will be laughing their heads off or thinking of how stupid one person can be when looking at my code.</p>\n"}, {"tags": ["c++", "visual-studio-2015", "type-conversion"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1488408680, "post_id": 42543620, "comment_id": 72223066, "body": "The first mistake is not providing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1488408809, "post_id": 42543620, "comment_id": 72223120, "body": "Probably integer division getting truncated. 1/2 = 0"}, {"owner": {"reputation": 593, "user_id": 2779795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f32f53bb24e3e7fb1ef1935a5576540a?s=128&d=identicon&r=PG&f=1", "display_name": "huck_cussler", "link": "https://stackoverflow.com/users/2779795/huck-cussler"}, "edited": false, "score": 0, "creation_date": 1488408879, "post_id": 42543620, "comment_id": 72223150, "body": "Assuming uRate is an int and is equal to <code>-5</code>, <code>(uRate &#47; 10)</code> produces <code>-1</code>."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1488410485, "post_id": 42543620, "comment_id": 72223788, "body": "Also keep in mind, that 0.5 is one of those rare cases, a floating point value can represent."}], "answers": [{"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1488409481, "last_edit_date": 1488409481, "creation_date": 1488408863, "answer_id": 42543690, "question_id": 42543620, "link": "https://stackoverflow.com/questions/42543620/division-with-decimals/42543690#42543690", "title": "Division with decimals", "body": "<p>Just write</p>\n\n<pre><code>float fSpeed = 1 + (uRate / 10.0f);\n</code></pre>\n\n<p>In this case the expression <code>(uRate / 10.0f)</code> will have a floating value due to the <strong><em>usual arithmetic conversions</em></strong>.</p>\n"}], "owner": {"reputation": 8188, "user_id": 1390192, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2011214205e164fbfd409cf42a0d23c9?s=128&d=identicon&r=PG", "display_name": "tmighty", "link": "https://stackoverflow.com/users/1390192/tmighty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "closed_date": 1488410657, "accepted_answer_id": 42543690, "answer_count": 1, "score": 0, "last_activity_date": 1488409528, "creation_date": 1488408579, "last_edit_date": 1488409528, "question_id": 42543620, "link": "https://stackoverflow.com/questions/42543620/division-with-decimals", "closed_reason": "Duplicate", "title": "Division with decimals", "body": "<p>I'm running the following code:</p>\n\n<pre><code>float fSpeed = 1 + (uRate / 10);\n</code></pre>\n\n<p>uRate is -5.</p>\n\n<p>I was hoping to get the result 0.5 because (uRate / 10) should be -0.5</p>\n\n<p>However, fSpeed is 0.\nDoes anybody see my mistake?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "multithreading", "c++03"], "answers": [{"tags": [], "owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "is_accepted": false, "score": 3, "last_activity_date": 1488408170, "creation_date": 1488408170, "answer_id": 42543522, "question_id": 42543410, "link": "https://stackoverflow.com/questions/42543410/c03-null-pointer-versus-null-object-pattern-performance-implications/42543522#42543522", "title": "c++03 null pointer versus null object pattern: performance implications", "body": "<p>I feel like there is some information lacking here to really give the best answer, but I don't really see any reason to use pointers here at all. Presumably you are calling some library code, let's say it's a function called <code>void foo(int)</code>. You can't change this code, and it's not thread safe. But you can change your code, right? Instead of calling your code, call a wrapper around <code>foo</code>:</p>\n\n<pre><code>template &lt;class M&gt;\nvoid foo_wrapper(M&amp; mutex, int x); { std::lock_guard(mutex); foo(x); }\n</code></pre>\n\n<p>Now, you can simply write a trivial no-op mutex:</p>\n\n<pre><code>struct NoMutex {\n  void lock() {}\n  bool try_lock() { return true; }\n  void unlock() {}\n};\n\nstd::mutex m1;\nNoMutex m2;\nfoo_wrapper(m1, 0);  // thread safe\nfoo_wrapper(m2, 0);  // thread unsafe\n</code></pre>\n\n<p>Because the types are known to the compiler, the second call to <code>foo_wrapper</code> will not have any overhead whatsoever.</p>\n"}], "owner": {"reputation": 2019, "user_id": 78947, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec70afaed235b7af53b40b5588d93af8?s=128&d=identicon&r=PG", "display_name": "Simon Elliott", "link": "https://stackoverflow.com/users/78947/simon-elliott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "closed_date": 1488415964, "answer_count": 1, "score": -2, "last_activity_date": 1488408170, "creation_date": 1488407655, "last_edit_date": 1495541355, "question_id": 42543410, "link": "https://stackoverflow.com/questions/42543410/c03-null-pointer-versus-null-object-pattern-performance-implications", "closed_reason": "Needs more focus", "title": "c++03 null pointer versus null object pattern: performance implications", "body": "<p>I have some library code which sometimes needs to be run multithreaded, but more usually single threaded. It's a set of small routines which are called very frequently. Previous experience and profiling indicates that extra delays may be detrimental to performance, so I want to avoid unnecessary overheads. </p>\n\n<p>I can't provide a separate instance of the library for single and multithreaded use, nor can I provide a thread safe wrapper the single threaded version. Both these restrictions are due to the design of the library. </p>\n\n<p>My preferred way of protecting the routines when run multithreaded is to use a scoped mutex. My initial thought was along the lines of <a href=\"https://stackoverflow.com/a/10752342/78947\">this SO answer</a>.</p>\n\n<p>However most of the time the routines are run single threaded, and I don't like the overhead of the null pointer check. This is run on a very slow ARM9 processor and every cycle counts. </p>\n\n<p>In practice I'll probably go with the null pointer check and profile to see what it costs, but I'm wondering whether there's a better way. For example the null object pattern, or having the library call a callback. </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 3, "creation_date": 1488407311, "post_id": 42543281, "comment_id": 72222460, "body": "How can a number be <code>&gt; 9999</code> AND <code>&lt; 0</code> at the same time?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7644079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fec967e1be9e56391e4a93cfe3971115?s=128&d=identicon&r=PG&f=1", "display_name": "jackhhh", "link": "https://stackoverflow.com/users/7644079/jackhhh"}, "edited": false, "score": 0, "creation_date": 1488407488, "post_id": 42543328, "comment_id": 72222541, "body": "Thank you, that makes perfect sense haha. how so i use setfill so if its like a 23 it will be 0023? and any ideas on the date?"}, {"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "reply_to_user": {"reputation": 1, "user_id": 7644079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fec967e1be9e56391e4a93cfe3971115?s=128&d=identicon&r=PG&f=1", "display_name": "jackhhh", "link": "https://stackoverflow.com/users/7644079/jackhhh"}, "edited": false, "score": 0, "creation_date": 1488407675, "post_id": 42543328, "comment_id": 72222621, "body": "@jackhhh, <a href=\"http://en.cppreference.com/w/cpp/io/manip/setfill\" rel=\"nofollow noreferrer\">setfill explained</a>, and as for the Date, take a look into the <a href=\"https://theboostcpplibraries.com/boost.datetime\" rel=\"nofollow noreferrer\">boost datetime library</a>."}, {"owner": {"reputation": 1, "user_id": 7644079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fec967e1be9e56391e4a93cfe3971115?s=128&d=identicon&r=PG&f=1", "display_name": "jackhhh", "link": "https://stackoverflow.com/users/7644079/jackhhh"}, "edited": false, "score": 0, "creation_date": 1488408114, "post_id": 42543328, "comment_id": 72222827, "body": "the boost datetime library seems to be getting the actual date, i have to have it read just a date thats input."}, {"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "reply_to_user": {"reputation": 1, "user_id": 7644079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fec967e1be9e56391e4a93cfe3971115?s=128&d=identicon&r=PG&f=1", "display_name": "jackhhh", "link": "https://stackoverflow.com/users/7644079/jackhhh"}, "edited": false, "score": 0, "creation_date": 1488408233, "post_id": 42543328, "comment_id": 72222885, "body": "@jackhhh, if this is a school assignment and you aren&#39;t going to be fed bad input, you can just use cin &gt;&gt; MM; to grab the month, cin &gt;&gt; DD; to grab the day, and cin &gt;&gt; YYYY; to get the year from the user."}, {"owner": {"reputation": 1, "user_id": 7644079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fec967e1be9e56391e4a93cfe3971115?s=128&d=identicon&r=PG&f=1", "display_name": "jackhhh", "link": "https://stackoverflow.com/users/7644079/jackhhh"}, "edited": false, "score": 0, "creation_date": 1488409144, "post_id": 42543328, "comment_id": 72223266, "body": "Ok i will do that. Im not sure how to use setw / setfill based off of link you showed me. I cant get it to be like a 02 for February?"}], "tags": [], "owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "is_accepted": false, "score": 1, "last_activity_date": 1488407273, "creation_date": 1488407273, "answer_id": 42543328, "question_id": 42543281, "link": "https://stackoverflow.com/questions/42543281/c-getting-a-date-in-mm-dd-yyyy-format-and-loop/42543328#42543328", "title": "c++ Getting a date in MM DD YYYY format, and loop", "body": "<p>Check your boolean logic.\nACCT>9999&amp;&amp;ACCT&lt;0</p>\n\n<p>Can it be the case that ACCT is simultaneously larger than 9999, AND smaller than 0?</p>\n\n<p>Replace the AND (&amp;&amp;) with OR (||).</p>\n"}], "owner": {"reputation": 1, "user_id": 7644079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fec967e1be9e56391e4a93cfe3971115?s=128&d=identicon&r=PG&f=1", "display_name": "jackhhh", "link": "https://stackoverflow.com/users/7644079/jackhhh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "closed_date": 1488429527, "answer_count": 1, "score": -1, "last_activity_date": 1488412607, "creation_date": 1488407050, "last_edit_date": 1488412607, "question_id": 42543281, "link": "https://stackoverflow.com/questions/42543281/c-getting-a-date-in-mm-dd-yyyy-format-and-loop", "closed_reason": "Needs details or clarity", "title": "c++ Getting a date in MM DD YYYY format, and loop", "body": "<p>I am trying to write a program for my c++ class, I can't get the loop to work right and i'm lost on how to get the date. Any help would be appreciated. \nOk so i went ahead and updated the program and it fully \"works\" but it isnt aligning correctly, and when i try to define my name it isnt working, not sure what thats about. I mainly just need assistance with aligning the values into columns and with the dates being filled like 01 rather than 1</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n#include &lt;iomanip&gt;\n#include &lt;stdlib.h&gt;\n#defin studen name\n\nint main()\n{\n    int ACCT, MM, DD, YYYY, PYMNM;\n    double FEE, DWN, Tot, PYM;\n    system(\"cls\");\ncout&lt;&lt; \"Dr.Thad Zalfolkz service fee's\\n\";\ncout&lt;&lt; \"This program will ask you for your \\n\";\ncout&lt;&lt; \"account number, consultation date\\n\";\ncout&lt;&lt; \"treatment fee, and the initial payment.\\n\";\ncout&lt;&lt; \"Then calculate a payment plan.\\n\\n\";\n\ncout&lt;&lt;\"Please input your account number: \";\ncin&gt;&gt; ACCT;\nwhile (ACCT&gt;9999||ACCT&lt;0){\ncout&lt;&lt; \"\\nError, input a valid account number.\\n\";\ncin&gt;&gt; ACCT;\n}\ncout&lt;&lt; \"Please input the consultation date with a space between each. (MM DD YYYY)\";\ncin&gt;&gt; MM;\ncin&gt;&gt; DD;\ncin&gt;&gt; YYYY;\ncout&lt;&lt;\"Please input your treatment fee: $\";\ncin&gt;&gt; FEE;\nwhile (FEE&lt;0){\ncout&lt;&lt; \"\\nPlear input a valid fee.\\n\";\ncin&gt;&gt; FEE;\n}\ncout&lt;&lt;\"Please input your initial payment: \";\ncin&gt;&gt; DWN;\nwhile (DWN&lt;0){\ncout&lt;&lt; \"\\nPlear input a valid value.\\n\";\ncin&gt;&gt; DWN;\n}\n\ncout&lt;&lt;\"Please input your desired monthly payment: \";\ncin&gt;&gt; PYM;\ncout&lt;&lt;\"\\n\\n\\n\";\nwhile (PYM&lt;=0){\ncout&lt;&lt; \"\\nPlear input a valid value.\\n\";\ncin&gt;&gt; PYM;\n}\n\ncout&lt;&lt; \"Patient account number:\" &lt;&lt; ACCT&lt;&lt;endl;\ncout&lt;&lt; \"Consultation Date:\";\ncout&lt;&lt; MM;\ncout&lt;&lt;\"/\";\ncout&lt;&lt;DD;\ncout&lt;&lt; \"/\";\ncout&lt;&lt;YYYY&lt;&lt;endl;\ncout&lt;&lt; \"Treatment Fee                   $\"&lt;&lt;FEE &lt;&lt;endl;\ncout&lt;&lt; \"Initial Payment               $\"&lt;&lt;DWN &lt;&lt;endl;\ncout&lt;&lt; \"Balance                         $\"&lt;&lt;FEE-DWN &lt;&lt;endl&lt;&lt;endl;\ncout&lt;&lt; \"Payment     Due     Payment     Total   Outstanding \\n\";\ncout&lt;&lt; \"Number      Date    Amount      Paid    Balance \\n\";\nFEE=FEE-DWN;\nTot=DWN;\nPYMNM=0;\nwhile(FEE&gt;0){\n\n    if (FEE&lt;=PYM){ PYM=FEE;}\n    if (MM=12){ \n    MM=1;  \n    YYYY+1;\n}\n    MM+1;\n    ++PYMNM;\n    FEE=FEE-PYM;\n    Tot=Tot+PYM;\n    cout&lt;&lt; PYMNM;\n    cout&lt;&lt;\"     \";\n    cout&lt;&lt; MM;\n    cout&lt;&lt;\"/\";\n    cout&lt;&lt; DD ;\n    cout&lt;&lt; \"/\";\n    cout&lt;&lt; YYYY;\n    cout&lt;&lt;\"     \";\n    cout&lt;&lt; PYM; \n    cout&lt;&lt;\"     \";\n    cout&lt;&lt; Tot;\n    cout&lt;&lt;\"     \";\n    cout&lt;&lt; FEE;\n    cout&lt;&lt;\"     \\n\";\n\n}\n cout&lt;&lt;\"=========================Payment schedule printed by: =============================\";\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c++", "linux", "opengl", "nvidia", "glx"], "comments": [{"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "edited": false, "score": 8, "creation_date": 1488448322, "post_id": 42543010, "comment_id": 72239048, "body": "Might be a driver bug, but it&#39;s more likely that the driver simply refuses to hand out that many contexts and simply put a hard limit there. <b>Why are you creating that many contexts in the first place?</b> I see no good reason for needing that many. OpenGL contexts are kind of expensive to create and switching between them ain&#39;t cheap either."}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "edited": false, "score": 5, "creation_date": 1488448530, "post_id": 42543010, "comment_id": 72239194, "body": "Oh, and why are you creating that many threads, too? Unless you have a machine with over 100 CPU threads this makes no sense."}, {"owner": {"reputation": 4443, "user_id": 514429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fe592ad29095cc8b5edfc3c0dcdcd7b?s=128&d=identicon&r=PG", "display_name": "Utku Zihnioglu", "link": "https://stackoverflow.com/users/514429/utku-zihnioglu"}, "reply_to_user": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "edited": false, "score": 0, "creation_date": 1488480966, "post_id": 42543010, "comment_id": 72261286, "body": "You are right. Using so many threads/contexts definitely is not the most optimal but its just how the complete rendering pipeline is currently implemented. Most of the threads will be sleeping most of the time. If we cannot find a solution to this limitation we will have to explore options on reducing thread/context counts."}, {"owner": {"reputation": 4443, "user_id": 514429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fe592ad29095cc8b5edfc3c0dcdcd7b?s=128&d=identicon&r=PG", "display_name": "Utku Zihnioglu", "link": "https://stackoverflow.com/users/514429/utku-zihnioglu"}, "reply_to_user": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "edited": false, "score": 0, "creation_date": 1488562751, "post_id": 42543010, "comment_id": 72302746, "body": "It feels like the limitation comes from the drivers. We tried with different Nvidia Tesla/GTX GPUs with same results."}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "edited": false, "score": 0, "creation_date": 1488564246, "post_id": 42543010, "comment_id": 72303488, "body": "What is preventing you from sharing a small pool of OpenGL contexts between several threads? And what is preventing you from creating a small pool of worker threads between which the steps of the pipeline are divided? Search terms: &quot;thread work queue&quot;"}, {"owner": {"reputation": 4443, "user_id": 514429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fe592ad29095cc8b5edfc3c0dcdcd7b?s=128&d=identicon&r=PG", "display_name": "Utku Zihnioglu", "link": "https://stackoverflow.com/users/514429/utku-zihnioglu"}, "reply_to_user": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "edited": false, "score": 0, "creation_date": 1488828328, "post_id": 42543010, "comment_id": 72395512, "body": "Nothing is limiting us other than the design of the current implementation of a large pipeline. I agree that eventually we will have to switch to a producer/consumer model where we can limit the number of threads. However, currently, each thread has a long IO blocking event where they sleep most of the time and do OpenGL rendering for a small fraction of time. Ideally, until we can switch to a proper worker threads we can have a temporary solution that does not hit to the Nvidia drivers 128 OpenGL rendering context limit."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1488830171, "post_id": 42543010, "comment_id": 72396526, "body": "An idea: delete the context while the thread is sleeping or not rendering, saving somehow its state. Create again and restore the state when a thread needs it."}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1488833163, "post_id": 42543010, "comment_id": 72398015, "body": "@Ripi2: Do you have any idea how expensive that would be. Besides, I made the experience that NVidia&#39;s drivers can be crashed by creating/deleting a lot of contexts in short succession; probably there&#39;s some kind of delayed resource deallocation implemented and one simply exhausts internal resource limits. I don&#39;t recommend doing it."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "reply_to_user": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "edited": false, "score": 0, "creation_date": 1488834109, "post_id": 42543010, "comment_id": 72398482, "body": "@datenwolf: Of course my idea is quite far from optimal, but the OP is asking for a temporay solution until he get rid of that insane number of contexts."}, {"owner": {"reputation": 4443, "user_id": 514429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fe592ad29095cc8b5edfc3c0dcdcd7b?s=128&d=identicon&r=PG", "display_name": "Utku Zihnioglu", "link": "https://stackoverflow.com/users/514429/utku-zihnioglu"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1488841294, "post_id": 42543010, "comment_id": 72402071, "body": "@Ripi2 I actually tried to release the context by doing <code>glXMakeCurrent(display, NONE, NULL)</code> then delete the context, unmap the surface and even delete the surface. None of the steps allowed the thread to be freed up from the 128 limit. Only thing that freed up the thread was actually closing the display by running <code>XCloseDisplay(display)</code>"}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1488845428, "post_id": 42543010, "comment_id": 72403478, "body": "Not being able to delete a context until <code>XCloseDisplay(...)</code>makes no sense to me. Try installing an error handler and calling <code>XSync(...)</code> to see what&#39;s going on. And a shot in the dark: try using glx 1.4 <code>glXCreateNewContext(...)</code> or better <code>glXCreateContextAttribsARB(...)</code> if available"}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 3, "creation_date": 1488846134, "post_id": 42543010, "comment_id": 72403660, "body": "Found this: <a href=\"http://stackoverflow.com/questions/4951370/is-there-a-limit-to-how-many-opengl-rendering-contexts-you-can-create-simultaneo\" title=\"is there a limit to how many opengl rendering contexts you can create simultaneo\">stackoverflow.com/questions/4951370/&hellip;</a>"}, {"owner": {"reputation": 4443, "user_id": 514429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fe592ad29095cc8b5edfc3c0dcdcd7b?s=128&d=identicon&r=PG", "display_name": "Utku Zihnioglu", "link": "https://stackoverflow.com/users/514429/utku-zihnioglu"}, "edited": false, "score": 0, "creation_date": 1488847954, "post_id": 42543010, "comment_id": 72404183, "body": "Both <code>glXCreateNewContext</code> and <code>glXCreateContextAttribsARB</code> seems to be affected by the same limit."}, {"owner": {"reputation": 514, "user_id": 7671559, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wcE1huhny94/AAAAAAAAAAI/AAAAAAAAAGU/Wmov4fen7p0/photo.jpg?sz=128", "display_name": "Gert Wollny", "link": "https://stackoverflow.com/users/7671559/gert-wollny"}, "edited": false, "score": 0, "creation_date": 1491595851, "post_id": 42543010, "comment_id": 73640867, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4951370/is-there-a-limit-to-how-many-opengl-rendering-contexts-you-can-create-simultaneo\">Is there a limit to how many OpenGL rendering contexts you can create simultaneously?</a>"}, {"owner": {"reputation": 671, "user_id": 1656508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b35b87c1a442d3229244ff9982dcb7f?s=128&d=identicon&r=PG", "display_name": "andreaplanet", "link": "https://stackoverflow.com/users/1656508/andreaplanet"}, "edited": false, "score": 0, "creation_date": 1549028201, "post_id": 42543010, "comment_id": 95768134, "body": "Initially I too used multiple contexts with multiple threads only to get several issues, especially if you want that your software runs on many drivers and hardware. Actually I use only one context in the main UI thread and it&#39;s not an issue because all the heavy work is in separate threads using PBO&#39;s to upload the data to the GPU (no need to have a context in the worker thread that uses only the mapped pointer). Much better control. The trick is that none of the gl calls in the UI thread are blocking the driver / GPU, are not sending any huge data to the GPU, and the commands are grouped."}], "answers": [{"comments": [{"owner": {"reputation": 4443, "user_id": 514429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fe592ad29095cc8b5edfc3c0dcdcd7b?s=128&d=identicon&r=PG", "display_name": "Utku Zihnioglu", "link": "https://stackoverflow.com/users/514429/utku-zihnioglu"}, "edited": false, "score": 0, "creation_date": 1533679013, "post_id": 51689662, "comment_id": 90432667, "body": "I agree with you. That said, this question seemed to have gathered enough feedback/demand. I would rather keep the question open in case someone comes up with a resolution or a solid work-around."}], "tags": [], "owner": {"reputation": 1066, "user_id": 6804401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21097b2dd60f0774b18668330994b52d?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Olson", "link": "https://stackoverflow.com/users/6804401/jonathan-olson"}, "is_accepted": false, "score": 1, "last_activity_date": 1533417843, "creation_date": 1533417843, "answer_id": 51689662, "question_id": 42543010, "link": "https://stackoverflow.com/questions/42543010/multiple-openglx-rendering-contexts-fail-on-linux-with-proprietary-nvidia-driver/51689662#51689662", "title": "Multiple OpenGLX rendering contexts fail on Linux with proprietary Nvidia Drivers", "body": "<p>As discussed in the comments, it seems you're hitting a driver limitation because you're doing something highly unusual and unexpected. I'm answering this to remove it from the list of unanswered questions. </p>\n"}], "owner": {"reputation": 4443, "user_id": 514429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fe592ad29095cc8b5edfc3c0dcdcd7b?s=128&d=identicon&r=PG", "display_name": "Utku Zihnioglu", "link": "https://stackoverflow.com/users/514429/utku-zihnioglu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1276, "favorite_count": 3, "answer_count": 1, "score": 26, "last_activity_date": 1533417843, "creation_date": 1488405934, "question_id": 42543010, "link": "https://stackoverflow.com/questions/42543010/multiple-openglx-rendering-contexts-fail-on-linux-with-proprietary-nvidia-driver", "title": "Multiple OpenGLX rendering contexts fail on Linux with proprietary Nvidia Drivers", "body": "<p>When I try to run over 128 current OpenGLX rendering contexts on individual threads, the call to <code>glXMakeCurrent</code> starts failing.</p>\n\n<pre><code>Display *display = XOpenDisplay(\":0\")\nWindow root_win = RootWindow(display, screen);\nWindow win = XCreateWindow (display, root_win, ...)\nGLXContext context = glXCreateContext(display, visinfo, 0, True);\n\nglXMakeCurrent(display, win, context); &lt;---- Fails here on 128th\n</code></pre>\n\n<p>This issue only occurs with proprietary Nvidia drivers and Nvidia GPUs. I was not able to reproduce with Intel GPUs.</p>\n\n<p>Reproduction code <code>glx.cpp</code>:</p>\n\n<pre><code>#include &lt;GL/gl.h&gt;\n#include &lt;GL/glu.h&gt;\n#include &lt;GL/glx.h&gt;\n#include &lt;GL/glxext.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;thread&gt;\n#include &lt;vector&gt;\n#include &lt;mutex&gt;\n#include &lt;condition_variable&gt;\n#include &lt;chrono&gt;\n\n#define MAX_CONTEXTS 200;\n\nstd::mutex mutex;\nstd::condition_variable cond;\nbool will_stop = false;\n\nint numSuccessfulContexts = 0;\n#define EXIT_IF(condition, ...) if (condition) { printf(__VA_ARGS__); exit(EXIT_FAILURE);}\n#define RETURN_IF(condition, ...) if (condition) { printf(__VA_ARGS__); stop(); return; }\n\nvoid stop() {\n    std::lock_guard&lt;std::mutex&gt; lk(mutex);\n    will_stop = true;\n    cond.notify_all();\n}\n\nvoid createWindow() {\n    /* Init X and GLX */\n    Display *display = XOpenDisplay(\":0.0\");\n    RETURN_IF(!display, \"Cannot open X display\\n\");\n    int screen = DefaultScreen(display);\n    Window root_win = RootWindow(display, screen);\n    RETURN_IF(!glXQueryExtension(display, 0, 0),\"X Server doesn't support GLX extension\\n\");\n    /* Pick an FBconfig and visual */\n    static const int attributeList[] = { None };\n    int fbcount;\n    GLXFBConfig *fbconfig = glXChooseFBConfig(display, screen, attributeList, &amp;fbcount);\n\n    EXIT_IF(!fbconfig, \"Failed to get GLXFBConfig\\n\");\n    XVisualInfo *visinfo = glXGetVisualFromFBConfig(display, *fbconfig);\n    EXIT_IF(!visinfo, \"Failed to get XVisualInfo\\n\");\n    /* Create the X window */\n    XSetWindowAttributes winAttr ;\n    winAttr.colormap = XCreateColormap(display, root_win, visinfo-&gt;visual, AllocNone);\n    unsigned int mask = CWColormap;\n    Window win = XCreateWindow (display, root_win, 256, 64, 320, 320, 0,\n        visinfo-&gt;depth, InputOutput, visinfo-&gt;visual, mask, &amp;winAttr) ;\n    /* Create an OpenGL context and attach it to our X window */\n    GLXContext context = glXCreateContext(display, visinfo, 0, True);\n    EXIT_IF(!context, \"Could not create GL context\\n\");\n    RETURN_IF(! glXMakeCurrent(display, win, context), \"glXMakeCurrent failed 1. \\n\");\n    RETURN_IF(!glXIsDirect (display, glXGetCurrentContext()), \"Indirect GLX rendering context obtained\\n\");\n    RETURN_IF(!glXMakeCurrent(display, win, context), \"glXMakeCurrent failed 2.\\n\");\n\n    numSuccessfulContexts++;\n\n    std::unique_lock&lt;std::mutex&gt; lk(mutex);\n    cond.wait(lk, [] {return will_stop;});\n}\n\nint main(int argc, char *argv[]) {\n    std::vector&lt;std::thread&gt; ts;\n    printf(\"Starting, your computer might become unresponsive...\\n\");\n\n    int maxContexts = MAX_CONTEXTS;\n    while (maxContexts--) {\n    ts.push_back(std::thread(&amp;createWindow));\n    }\n\n    {\n    std::unique_lock&lt;std::mutex&gt; lk(mutex);\n    cond.wait_for(lk, std::chrono::seconds(10), []{return will_stop;});\n    }\n\n    if (!will_stop) {\n    stop();\n    }\n\n    for (auto&amp; v: ts) {\n    v.join();\n    }\n    printf(\"Done. Max concurrent contexts: %d\\n\", numSuccessfulContexts);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Build &amp; Run:</p>\n\n<pre><code>g++ -std=c++11 glx.cpp -L/usr/lib/nvidia-375 -lGL -lX11 -lGLU -lGLX -lpthread -o glx &amp;&amp; ./glx\n</code></pre>\n"}, {"tags": ["c++", "debugging", "linked-list"], "comments": [{"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 1, "creation_date": 1488405844, "post_id": 42542910, "comment_id": 72221752, "body": "What compiler and operating system are you using?  Also, I think your for-loop conditional should be temp-&gt;link() != current.  At the end of your for loop, temp <i>is</i> current, in order to break the loop."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 1, "creation_date": 1488405929, "post_id": 42542910, "comment_id": 72221789, "body": "... and you should then delete <code>current</code>, not <code>temp</code>."}], "owner": {"reputation": 45, "user_id": 7643976, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FiHOpt59zmY/AAAAAAAAAAI/AAAAAAAAAFU/6OHQTef0Ar4/photo.jpg?sz=128", "display_name": "Zack Maguffin", "link": "https://stackoverflow.com/users/7643976/zack-maguffin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488409840, "creation_date": 1488405532, "last_edit_date": 1488409840, "question_id": 42542910, "link": "https://stackoverflow.com/questions/42542910/c-list-tail-remove-debug", "title": "C++ List_tail_remove debug", "body": "<p>I'm not how to debug this one function of my code, When I remove and output my linked list it gives me a funky decimal. Any help would be appreciated.</p>\n\n<pre><code>void list_tail_remove(node*&amp; head_ptr)\n{\n    if (head_ptr == NULL)\n    {\n        cout &lt;&lt; \"Error:The Double linked List was never Created\" &lt;&lt; endl;\n    }\n    else\n    {\n        node* current = head_ptr;\n        while (current-&gt;link() != NULL)\n        {\n            current = current-&gt;link();\n        }\n\n        node* temp;\n        for (temp = head_ptr; temp != current; temp = temp-&gt;link())\n        {\n            temp = temp-&gt;link();\n        }\n        temp-&gt;set_link(NULL);\n        delete temp;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "function", "macros"], "comments": [{"owner": {"reputation": 708, "user_id": 6540292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dfac93d8c8c2c645ca2d70f2328e260?s=128&d=identicon&r=PG&f=1", "display_name": "Ray Fischer", "link": "https://stackoverflow.com/users/6540292/ray-fischer"}, "edited": false, "score": 0, "creation_date": 1488405840, "post_id": 42542818, "comment_id": 72221748, "body": "You can actually do this, but it means compiling the source code to a loadable library, loading the library, calling the function and then saving the result.  It involves dynamically linking in the library into the entire app to be tested and managing security concerns so that you don&#39;t open your testable app to attacks.  It&#39;s one of those problems that looks superficially easy but has layers and layers of added complexity.  If you want to pursue it anyway I suggest coursework in operating systems."}, {"owner": {"reputation": 2924, "user_id": 2066459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8408d7e5ef47a2e2af09f3c6da6e1a6?s=128&d=identicon&r=PG", "display_name": "Robert Jacobs", "link": "https://stackoverflow.com/users/2066459/robert-jacobs"}, "edited": false, "score": 0, "creation_date": 1488406172, "post_id": 42542818, "comment_id": 72221894, "body": "Since you functions are static, they will not be able to be called directly from any program. Even if they are linked in."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488407386, "post_id": 42542818, "comment_id": 72222496, "body": "There is <a href=\"http://www.boost.org/doc/libs/release/doc/html/boost_dll.html\" rel=\"nofollow noreferrer\">Boost.DLL</a>, which would allow you to create your test cases as &quot;plugins&quot; with a common interface. These test case plugins could then be dynamically loaded by the main application. From the <a href=\"http://www.boost.org/doc/libs/release/doc/html/boost_dll/tutorial.html\" rel=\"nofollow noreferrer\">tutorial</a> it looks fairly easy to use."}], "answers": [{"comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488407718, "post_id": 42542884, "comment_id": 72222647, "body": "Maybe <a href=\"http://www.boost.org/doc/libs/release/doc/html/boost_dll.html\" rel=\"nofollow noreferrer\">Boost.DLL</a> could be an alternative to directly calling LoadLibrary and GetProcAddress to mitigate the &quot;fragility&quot; issue."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "is_accepted": false, "score": 0, "last_activity_date": 1488406102, "last_edit_date": 1488406102, "creation_date": 1488405448, "answer_id": 42542884, "question_id": 42542818, "link": "https://stackoverflow.com/questions/42542818/call-function-from-arbitrary-souce-cpp-file-using-the-file-name-as-a-string/42542884#42542884", "title": "Call function from arbitrary souce .cpp file using the file name as a string", "body": "<p>In Standard C++ there is no direct means of doing this. However, most implementations  provide facilities for loading libraries, and calling named functions from those libraries, at run-time. For example, under Windows, you can call LoadLibrary to load a named DLL, and then call GetProcAddress to get a pointer to a named callable (C) function. Other operating systems provide similar features. This is not as useful a feature as it may seem, and tends to result in fragile code.</p>\n"}, {"tags": [], "owner": {"reputation": 2924, "user_id": 2066459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8408d7e5ef47a2e2af09f3c6da6e1a6?s=128&d=identicon&r=PG", "display_name": "Robert Jacobs", "link": "https://stackoverflow.com/users/2066459/robert-jacobs"}, "is_accepted": false, "score": 0, "last_activity_date": 1488406413, "creation_date": 1488406413, "answer_id": 42543119, "question_id": 42542818, "link": "https://stackoverflow.com/questions/42542818/call-function-from-arbitrary-souce-cpp-file-using-the-file-name-as-a-string/42543119#42543119", "title": "Call function from arbitrary souce .cpp file using the file name as a string", "body": "<p>Your files could have a class that is static global. In its constructor pass it the function address. This constructor updates a global vector of functions that can get called by the main framework. If you need input and output file names, then add them to the constructor's argument list and vector.</p>\n"}], "owner": {"reputation": 1, "user_id": 7643913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76bf486f039971d3fe5e4913a5427d22?s=128&d=identicon&r=PG&f=1", "display_name": "hangukhiphop", "link": "https://stackoverflow.com/users/7643913/hangukhiphop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488406413, "creation_date": 1488405204, "last_edit_date": 1488405597, "question_id": 42542818, "link": "https://stackoverflow.com/questions/42542818/call-function-from-arbitrary-souce-cpp-file-using-the-file-name-as-a-string", "title": "Call function from arbitrary souce .cpp file using the file name as a string", "body": "<p>I am going through coding problems online, and I thought of a system that could make testing really efficient. My plan is to </p>\n\n<ol>\n<li>give each problem a distinct .cpp file with one function that solves the problem and outputs the results to a .txt file</li>\n<li>create a .cpp file with a main function that takes 2 command line arguments: a string the file name for the problem I am currently solving and a string for the file name of the test case to be used for the problem.</li>\n</ol>\n\n<p>The main function first creates a FILE* to store the test case and another FILE* to create an empty output file. Then, it calls the function from the problem .cpp file specified in the command line.</p>\n\n<p>The function prototype for each problem file looks like this:</p>\n\n<p>static void Problem(FILE* test_case, FILE* output);</p>\n\n<p>The idea is to pass in the test case to a specific problem and have the \"Problem\" function write the results into an output text file.</p>\n\n<p>I've succeeded in running test cases for a specific problem and getting unique output files for each run. </p>\n\n<p>However, my current issue is enabling the main function to use the .cpp file name as an argument. It seems there is no direct way in C++ to call a function from a file using only the file name. I know that the preprocessor parses .cpp files and turns function names into function pointers. Is there a way I can do this at runtime? In other words, can I stream the .cpp file, search for the line that matches my function prototype, and return a pointer to that function? Is there some sort of macro I could use to cue the preprocessor to associate a file's name with its function?</p>\n\n<p>From my search for answers thus far, the simplest solution seems to be to create a map that matches function name to function. This seems tedious and inelegant to me. I figure I might as well just change the function call manually in my main file every time I switch problems, instead of setting the name of the file in the command line. I prefer not to do either.  </p>\n"}, {"tags": ["c++", "unique-ptr"], "comments": [{"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 2, "creation_date": 1488403667, "post_id": 42542331, "comment_id": 72220553, "body": "Polymorphism requires <code>virtual</code> methods. A virtual destructor would be a good start."}, {"owner": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "edited": false, "score": 1, "creation_date": 1488403768, "post_id": 42542331, "comment_id": 72220608, "body": "You definitely don&#39;t want a class to hold a <code>unique_ptr</code> to <i>itself</i>; but it looks like what you really mean is for a class to hold a <code>unique_ptr</code> of the same type (like a node in a linked list)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1488404023, "post_id": 42542331, "comment_id": 72220764, "body": "@Xirema This is a non-polymorphic type currently, so <code>dynamic_cast</code> will not work"}, {"owner": {"reputation": 149, "user_id": 4286117, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/87aa2c19c6c5b95a9b6330c0099a0b22?s=128&d=identicon&r=PG&f=1", "display_name": "sudgy", "link": "https://stackoverflow.com/users/4286117/sudgy"}, "edited": false, "score": 0, "creation_date": 1488405378, "post_id": 42542331, "comment_id": 72221543, "body": "Sorry, in writing this code up I forgot to make a virtual destructor.  That&#39;s present in my actual code."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488408990, "post_id": 42542331, "comment_id": 72223206, "body": "I think this would be fine because you are first moving <code>aa-&gt;a</code> into a temporary rvalue. At this point <code>aa-&gt;a</code> is in empty state, so you can safely destroy the outer A through the assignment. It can&#39;t have any effect to the inner A, because it has already been moved to the temporary. I don&#39;t think the inheritance really matters here, but maybe I&#39;m wrong."}, {"owner": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1488409176, "post_id": 42542331, "comment_id": 72223283, "body": "@zett42 I don&#39;t think there are any temporary <code>unique_ptr</code>s, only a temporary <code>unique_ptr&amp;&amp;</code>. The creation of a temporary r-value of type <code>unique_ptr</code> does <i>not</i> cause the source <code>unique_ptr</code> to release its owned object."}, {"owner": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "edited": false, "score": 0, "creation_date": 1488409200, "post_id": 42542331, "comment_id": 72223294, "body": "I agree that the inheritance doesn&#39;t matter, though."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1488410042, "post_id": 42542331, "comment_id": 72223624, "body": "Thinking about it, you are right. Only the <i>move assignment operator=</i> of the target unique_ptr will set the source unique_ptr to empty state. Citing from the <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr/operator%3D\" rel=\"nofollow noreferrer\">reference for unique_ptr move assignment</a>, &quot;Transfers ownership from r to *this as if by calling <code>reset(r.release())</code>&quot;, so source unique_ptr will be released first before target will be reset(). Still looks fine in my opinion."}], "answers": [{"comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488410187, "post_id": 42543929, "comment_id": 72223677, "body": "<code>reset(r.release())</code>...Yep, that&#39;s what I was looking up too. Thanks for providing simpler example."}, {"owner": {"reputation": 149, "user_id": 4286117, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/87aa2c19c6c5b95a9b6330c0099a0b22?s=128&d=identicon&r=PG&f=1", "display_name": "sudgy", "link": "https://stackoverflow.com/users/4286117/sudgy"}, "edited": false, "score": 1, "creation_date": 1488413082, "post_id": 42543929, "comment_id": 72224654, "body": "I just started compiling with c++14 recently and forgot about <code>make_unique</code>.  Thanks for that!  I thought I couldn&#39;t do it with polymorphic types but apparently <code>unique_ptr&lt;Derived&gt;</code> is castable to <code>unique_ptr&lt;Base&gt;</code>."}], "tags": [], "owner": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "is_accepted": true, "score": 5, "last_activity_date": 1488410291, "last_edit_date": 1592644375, "creation_date": 1488410035, "answer_id": 42543929, "question_id": 42542331, "link": "https://stackoverflow.com/questions/42542331/is-it-safe-to-assign-a-unique-ptr-to-another-unique-ptr-inside-the-first-one/42543929#42543929", "title": "Is it safe to assign a unique_ptr to another unique_ptr inside the first one?", "body": "<h3>This is safe.</h3>\n<p>The underlying issue is how the move-assignment for <code>unique_ptr</code> works. Note that an even simpler example, not involving inheritance, that demonstrates the same concern as your code would be a singly-linked list using <code>unique_ptr</code>:</p>\n<pre><code>class Node {\n  public:\n    unique_ptr&lt;Node&gt; next;\n};\n\n// ....\n\nlist_head = make_unique&lt;Node&gt;();\nlist_head-&gt;next = make_unique&lt;Node&gt;();\n// Delete the head:\nlist_head = list_head-&gt;next;\n</code></pre>\n<p>The key question is, does the destruction of the old <code>*list_head</code> node (which occurs as part of the assignment operation) also cause the destruction of the node that is being promoted to the head node?</p>\n<p>Note that it would be very surprising if <code>unique_ptr</code> could not handle this simple case!</p>\n<p>According to CppReference, the assignment operator <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr/operator%3D\" rel=\"nofollow noreferrer\">behaves &quot;as if by calling <code>reset(r.release())</code>&quot;</a>. This means that <code>r</code> (the right hand side, in this case the <code>unique_ptr</code> that originally owns the node being promoted) releases ownership of the object <em>before</em> the left-hand side <code>unique_ptr</code> is set.</p>\n<p>The deletion of the object originally owned by the assigned-to <code>unique_ptr</code> is actually the <em>last</em> step that occurs in the process. In the linked list example, the object being deleted (the old head node) already has a moved-from <code>unique_ptr</code> by the time it's destroyed.</p>\n<hr />\n<p><strong>Stylistic notes:</strong></p>\n<p>Having the raw pointers <code>b</code> and <code>c</code> in your code is surprising and confusing; the <code>unique_ptr</code>s that eventually own <code>*b</code> and <code>*c</code> are not <em>semantically</em> unique when there are raw pointers floating around pointing to the owned objects. (<code>unique_ptr::get()</code> is indeed useful--the weirdness here is that you've got multiple pointers in the same scope pointing at the same objects.)</p>\n<p>Using <code>new</code> with <code>unique_ptr</code> is reasonable but not &quot;best practice.&quot; I'd recommend using <code>make_unique</code> whenever and wherever possible. This has a benefit in terms of exception safety, but in my opinion it's also semantically clearer.</p>\n"}], "owner": {"reputation": 149, "user_id": 4286117, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/87aa2c19c6c5b95a9b6330c0099a0b22?s=128&d=identicon&r=PG&f=1", "display_name": "sudgy", "link": "https://stackoverflow.com/users/4286117/sudgy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6293, "favorite_count": 0, "accepted_answer_id": 42543929, "answer_count": 1, "score": 1, "last_activity_date": 1488410291, "creation_date": 1488403473, "last_edit_date": 1488405522, "question_id": 42542331, "link": "https://stackoverflow.com/questions/42542331/is-it-safe-to-assign-a-unique-ptr-to-another-unique-ptr-inside-the-first-one", "title": "Is it safe to assign a unique_ptr to another unique_ptr inside the first one?", "body": "<p>This question is confusing, so here's stripped-down version of what I'm trying to do:</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;iostream&gt;\n\nclass A {\n};\n\nclass B : public A {\n    public:\n        std::unique_ptr&lt;A&gt; a;\n};\n\nclass C : public A {\n    public:\n        int var;\n};\n\nint main()\n{\n    C* c = new C;\n    B* b = new B;\n    c-&gt;var = 3;\n    b-&gt;a = std::unique_ptr&lt;A&gt;(c);\n    std::unique_ptr&lt;A&gt; aa(b);\n    aa = std::move(static_cast&lt;B*&gt;(aa.get())-&gt;a);\n    std::cout &lt;&lt; static_cast&lt;C*&gt;(aa.get())-&gt;var;\n}\n</code></pre>\n\n<p>This is what I do:<br>\n - Make a class that holds a unique_ptr to itself (my specific case was polymorphic so that's what I did here)<br>\n - Make a unique_ptr of that class<br>\n - Assign the outside unique_ptr the value of the inner one</p>\n\n<p>Now, that last step will destroy the object that the unique_ptr was pointing at.  The value I am assigning it is something in that soon-to-be-deleted object.  However, by moving it, it probably isn't in there anymore.</p>\n\n<p>While this code compiles and runs fine (in valgrind too), I was wondering: is this safe?  Is there something nasty that happened that I didn't realize?  Is there any caveats to doing this?</p>\n\n<p>Edit: I forgot to put in virtual destructors.  Pretend all three classes have that.  It's there in my actual code.</p>\n"}, {"tags": ["c++", "video", "x264", "libx264"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7643604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/611705c4ff05670222f324ae1809234a?s=128&d=identicon&r=PG&f=1", "display_name": "H.A", "link": "https://stackoverflow.com/users/7643604/h-a"}, "edited": false, "score": 0, "creation_date": 1488574040, "post_id": 42579066, "comment_id": 72308468, "body": "you are right, I found a problem with the capture camera. It seems like Ubuntu 16.04 missed up the camera driver.I switched to older camera and now it works"}], "tags": [], "owner": {"reputation": 124, "user_id": 6546888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5df3f3c7596ae5c2a35e6b06bb7cb095?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Doilnitsyn", "link": "https://stackoverflow.com/users/6546888/alexey-doilnitsyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1488544613, "creation_date": 1488544613, "answer_id": 42579066, "question_id": 42542322, "link": "https://stackoverflow.com/questions/42542322/video-streaming-control-frame-rate-x264/42579066#42579066", "title": "Video streaming- control frame rate x264", "body": "<p>I suspect your computer cannot encode 25 fps in real-time. You are using one thread - this might be the bottleneck. Could you try encode offline with the same settings and check the encode speed?<p>\nAlso there might be frame rate issues with video capture / video camera. Try pipeline with video capture and immediate playback on a screen (no encoding) to make sure your camera is able to do 25 fps.</p>\n"}], "owner": {"reputation": 23, "user_id": 7643604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/611705c4ff05670222f324ae1809234a?s=128&d=identicon&r=PG&f=1", "display_name": "H.A", "link": "https://stackoverflow.com/users/7643604/h-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 2, "accepted_answer_id": 42579066, "answer_count": 1, "score": 2, "last_activity_date": 1488544613, "creation_date": 1488403427, "last_edit_date": 1488404853, "question_id": 42542322, "link": "https://stackoverflow.com/questions/42542322/video-streaming-control-frame-rate-x264", "title": "Video streaming- control frame rate x264", "body": "<p>I'm new to video coding, I found this <a href=\"https://github.com/RafaelPalomar/H264LiveStreamer\" rel=\"nofollow noreferrer\">https://github.com/RafaelPalomar/H264LiveStreamer</a> application code very useful to my project. I want to live stream a webcam over RTP . However, I'm having problem selecting the Frame Per Seconds (FPS). below is the function that controls the encoding param.</p>\n\n<pre><code>void x264Encoder::initilize()\n{\n  x264_param_default_preset(&amp;parameters, \"veryfast\", \"zerolatency\");\n  parameters.i_log_level =  X264_LOG_DEBUG;\n  parameters.i_threads = 1;\n  parameters.i_width = 640;\n  parameters.i_height = 480;\n  parameters.i_fps_num = 25;\n  parameters.i_fps_den = 1;\n  parameters.i_keyint_max = 25;\n  parameters.b_intra_refresh = 1;\n  parameters.rc.i_rc_method = X264_RC_CRF;\n  parameters.rc.i_vbv_buffer_size = 1000000;\n  parameters.rc.i_vbv_max_bitrate = 90000;\n  parameters.rc.f_rf_constant = 25;\n  parameters.rc.f_rf_constant_max = 35;\n  parameters.i_sps_id = 7;\n  // the following two value you should keep 1\n  parameters.b_repeat_headers = 1;    // to get header before every I-Frame\n  parameters.b_annexb = 1; // put start code in front of nal. we will remove start code later\n  x264_param_apply_profile(&amp;parameters, \"baseline\");\n\n  encoder = x264_encoder_open(&amp;parameters);\n  x264_picture_alloc(&amp;picture_in, X264_CSP_I420, parameters.i_width, parameters.i_height);\n  picture_in.i_type = X264_TYPE_AUTO;\n  picture_in.img.i_csp = X264_CSP_I420;\n  // i have initilized my color space converter for BGR24 to YUV420 because my opencv video capture gives BGR24 image. You can initilize according to your input pixelFormat\n  convertContext = sws_getContext(parameters.i_width,parameters.i_height, PIX_FMT_BGR24, parameters.i_width,parameters.i_height,PIX_FMT_YUV420P, SWS_FAST_BILINEAR, NULL, NULL, NULL);\n}\n</code></pre>\n\n<p>I'm using VLC as client whatever number i set i_fps_num to, I always get 12-14 FPS. fore example, in VLC Codec tab shows 25 FPS but in Stream statistics tab it shows it only display 13 FPS on average.  here is the X264 encoder output </p>\n\n<pre><code>x264 [debug]: frame=  72 QP=22.24 NAL=2 Slice:P Poc:144 I:97   P:116  SKIP:987  size=1464 bytes\nx264 [info]: frame I:1     Avg QP:20.06  size: 17848\nx264 [info]: frame P:72    Avg QP:22.12  size:  1337\nx264 [info]: mb I  I16..4: 40.2%  0.0% 59.8%\nx264 [info]: mb P  I16..4:  3.1%  0.0%  2.3%  P16..4:  8.3%  2.0%  0.6%  0.0%  0.0%    skip:83.7%\nx264 [info]: coded y,uvDC,uvAC intra: 53.6% 46.4% 7.4% inter: 3.0% 1.6% 0.0%\nx264 [info]: i16 v,h,dc,p: 11% 65% 12% 12%\nx264 [info]: i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 15% 46% 16%  3%  4%  3%  5%  3%  6%\nx264 [info]: i8c dc,h,v,p: 46% 42% 10%  2%\nx264 [info]: kb/s:312.60\n</code></pre>\n\n<p>the last frame number that was encoded is 72 while in VLC  stream statistics it shows that 133 frames are Displayed and 66 blocks are decoded for 10 seconds streaming in addition the video playback is bursty.</p>\n\n<p>my question is how to change the x264 parameters to get 25 FPS ?   </p>\n"}, {"tags": ["c++", "struct"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7643200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb6045e21c7ffeac7da1b793a24ec6f?s=128&d=identicon&r=PG&f=1", "display_name": "Nisback", "link": "https://stackoverflow.com/users/7643200/nisback"}, "edited": false, "score": 0, "creation_date": 1488404512, "post_id": 42542298, "comment_id": 72221046, "body": "I&#39;m really thankful, but I have a little question, the compiler now highlighting the operands before the veriable &quot; Max&quot; in the line &quot;&quot; \tcout &lt;&lt; Max &lt;&lt; &quot; is the older student &quot; &lt;&lt; endl; &quot; as there is no operator matches these operands. what does this mean and how to correct this error?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "reply_to_user": {"reputation": 1, "user_id": 7643200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb6045e21c7ffeac7da1b793a24ec6f?s=128&d=identicon&r=PG&f=1", "display_name": "Nisback", "link": "https://stackoverflow.com/users/7643200/nisback"}, "edited": false, "score": 0, "creation_date": 1488407083, "post_id": 42542298, "comment_id": 72222334, "body": "You have not provided an overload of <code>operator&lt;&lt;</code> for your structure, so <code>cout</code> doesn&#39;t know how to output it.  Either overload <code>operator&lt;&lt;</code> or output the members individually."}], "tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": true, "score": 3, "last_activity_date": 1488403360, "creation_date": 1488403360, "answer_id": 42542298, "question_id": 42542236, "link": "https://stackoverflow.com/questions/42542236/passing-a-function-in-a-program-has-a-struct-c/42542298#42542298", "title": "passing a function in a program has a struct c++", "body": "<p>You need to return the older student:</p>\n\n<pre><code>student getOlder(student s1, student s2)\n{\n  if (s1.age &gt; s2.age)\n  {\n     return s1;\n  }\n  return s2;\n}\n</code></pre>\n\n<p>Also, since you are not changing the content of <code>s1</code> or <code>s2</code>, they should be passed as constant references:</p>\n\n<pre><code>student getOlder(const student&amp; s1, const student&amp; s2)\n{\n // ...\n}\n</code></pre>\n\n<p><strong>Edit 1: Overloading comparison operators</strong><br>\nOptionally, you can add methods for comparison:  </p>\n\n<pre><code>struct student\n{\n  std::string name;\n  unsigned int age; // int implies age can be negative.\n  bool operator&gt;(const student&amp; s2)\n  {\n     return age &gt; s2.age;\n  }\n}\n</code></pre>\n\n<p>This allows you to write things like:</p>\n\n<pre><code>if (s1 &gt; s2)\n{\n  cout &lt;&lt; \"Student \" &lt;&lt; s1.name &lt;&lt; \" is older than \" &lt;&lt; s2.name &lt;&lt; endl;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7643200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb6045e21c7ffeac7da1b793a24ec6f?s=128&d=identicon&r=PG&f=1", "display_name": "Nisback", "link": "https://stackoverflow.com/users/7643200/nisback"}, "edited": false, "score": 0, "creation_date": 1488404771, "post_id": 42542411, "comment_id": 72221195, "body": "I&#39;m really thankful, but I have a little question, the compiler now highlighting the operands before the veriable &quot; Max&quot; in the line &quot;&quot; \tcout &lt;&lt; Max &lt;&lt; &quot; is the older student &quot; &lt;&lt; endl; &quot; as there is no operator matches these operands. what does this mean and how to correct this error?"}, {"owner": {"reputation": 86, "user_id": 7105837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd756bb5b7e2b1f2f1ef8ff3c1fc4bc?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Camilletti", "link": "https://stackoverflow.com/users/7105837/jordan-camilletti"}, "reply_to_user": {"reputation": 1, "user_id": 7643200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb6045e21c7ffeac7da1b793a24ec6f?s=128&d=identicon&r=PG&f=1", "display_name": "Nisback", "link": "https://stackoverflow.com/users/7643200/nisback"}, "edited": false, "score": 0, "creation_date": 1488463767, "post_id": 42542411, "comment_id": 72249598, "body": "This is happening because of printing a name, you&#39;re trying to print the student itself. Just replace &quot;Max&quot; with &quot;Max.name&quot; and it should work."}], "tags": [], "owner": {"reputation": 86, "user_id": 7105837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd756bb5b7e2b1f2f1ef8ff3c1fc4bc?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Camilletti", "link": "https://stackoverflow.com/users/7105837/jordan-camilletti"}, "is_accepted": false, "score": 0, "last_activity_date": 1488403799, "creation_date": 1488403799, "answer_id": 42542411, "question_id": 42542236, "link": "https://stackoverflow.com/questions/42542236/passing-a-function-in-a-program-has-a-struct-c/42542411#42542411", "title": "passing a function in a program has a struct c++", "body": "<p>The problem is that <code>result</code> in your final function was never declared. You can set it equal to <code>s1</code> or <code>s2</code> during the if/else:</p>\n\n<pre><code>student result;\nif(s1.age&gt;s2.age){\n    result=s1;\n}else{\n    result=s2;\n}\nreturn result\n</code></pre>\n\n<p>Or you could skip over the <code>result</code> part and just return the student:</p>\n\n<pre><code>if (s1.age &gt; s2.age)\n{\n    return (s1);\n}\n    return(s2);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7643200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb6045e21c7ffeac7da1b793a24ec6f?s=128&d=identicon&r=PG&f=1", "display_name": "Nisback", "link": "https://stackoverflow.com/users/7643200/nisback"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "closed_date": 1488403409, "accepted_answer_id": 42542298, "answer_count": 2, "score": -4, "last_activity_date": 1488413464, "creation_date": 1488403120, "last_edit_date": 1488413464, "question_id": 42542236, "link": "https://stackoverflow.com/questions/42542236/passing-a-function-in-a-program-has-a-struct-c", "closed_reason": "Needs details or clarity", "title": "passing a function in a program has a struct c++", "body": "<p>i'm struggling in solving this problem regardless of its simplicity but i don't know where is the exact error.</p>\n\n<p>this problem is a practice on structures and it requires from the user to input 2 students' names and their ages and returns the name of the older person using struct and a function for returning the name of the student.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nstruct student{\n    string name;\n    int age;\n};\n\nstudent getOlder(student s1, student s2);\n\nint main()\n{\n    student s1, s2, Max;\n\n    cout &lt;&lt; \"Enter the first sudent's name\" &lt;&lt; endl;\n    getline(cin, s1.name);\n\n    cout &lt;&lt; \"Enter the first sudent's age\" &lt;&lt; endl;\n    cin &gt;&gt; s1.age;\n\n    cout &lt;&lt; \"Enter the second sudent's name\" &lt;&lt; endl;\n    getline(cin, s2.name);\n\n    cout &lt;&lt; \"Enter the second sudent's age\" &lt;&lt; endl;\n    cin &gt;&gt; s2.age;\n    Max = getOlder(s1, s2);\n    cout &lt;&lt; Max &lt;&lt; \" is the older student \" &lt;&lt; endl;\n}\n\nstudent getOlder(student s1, student s2)\n{\n    if (s1.age &gt; s2.age){\n        cout &lt;&lt; s1.name &lt;&lt; endl;\n    }\n    cout &lt;&lt; s2.name &lt;&lt; endl;\n    return result;\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "memory"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 3, "creation_date": 1488402959, "post_id": 42542167, "comment_id": 72220160, "body": "Memory surrounding an array&#39;s content is undefined."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1488402966, "post_id": 42542167, "comment_id": 72220167, "body": "This is going to be implementation defined.  You need to detail what implementation you are using."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1488403070, "post_id": 42542167, "comment_id": 72220225, "body": "Your image link is broken. Dont link images, include them in the questions."}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 6, "creation_date": 1488403418, "post_id": 42542167, "comment_id": 72220435, "body": "Visual Studio&#39;s debug C++ library adds 0xfdfdfdfd around a memory allocation to detect buffer underflow/overflow.  This is implementation-specific and likely disappears if linked to the release C++ library."}, {"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 1, "creation_date": 1488404110, "post_id": 42542167, "comment_id": 72220820, "body": "<a href=\"http://stackoverflow.com/questions/4810664/how-do-i-use-arrays-in-c/4810668\">c++ arrays</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1488405285, "post_id": 42542167, "comment_id": 72221482, "body": "@NathanOliver ITYM it will depend on the implementation. &quot;implementation defined&quot; means that the C++ Standard requires the compiler to document the behaviour -- which is not the case here"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1488406920, "post_id": 42542167, "comment_id": 72222250, "body": "@M.M You are correct.  <i>implementation defined</i> was not correct."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488404373, "post_id": 42542498, "comment_id": 72220956, "body": "&quot;OS is responsible for doing free/delete&quot; - nope, the C or C++ library is responsible for that, as it is for malloc/new."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488404428, "post_id": 42542498, "comment_id": 72220995, "body": "&quot;but if you forget size you have requested you cannot get it back&quot; The whole point of new (and malloc) is that you don&#39;t need to remember the size - the library does it for you."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1488404515, "post_id": 42542498, "comment_id": 72221051, "body": "I didn&#39;t mean making the call, but the implementation. Would a clarification on that help? I don&#39;t think those are defined in standard, but I would like to see the source if it&#39;s otherwise."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1488404544, "post_id": 42542498, "comment_id": 72221072, "body": "<code>auto x=new int[10];</code> followed by <code>delete[] x;</code> will free all ten allocated <code>int</code> so does somewhere keep that information."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488404602, "post_id": 42542498, "comment_id": 72221096, "body": "@luk It&#39;s obviously defined that you don&#39;t need to hang on to the size, as neither free nor non-placement delete allow any way of specifying it."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 1, "creation_date": 1488404612, "post_id": 42542498, "comment_id": 72221107, "body": "@Walter No it does not have to. I gave the outline for memory management implementation which does not need to remember this. And it&#39;s not required by the standard AFAIK."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1488404718, "post_id": 42542498, "comment_id": 72221172, "body": "@NeilButterworth Ok, then I don&#39;t know what you say is wrong with my answer. Regarding the dynamic memory managment c/c++ is not responsible for any new/malloc/free/delete."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488404794, "post_id": 42542498, "comment_id": 72221210, "body": "&quot;Regarding the dynamic memory managment c/c++ is not responsible for any new/malloc/free/delete.&quot;  Of course C and C++ are responsible!  These are not OS system calls , they are functions in the standard library and/or compiler implementation."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1488405414, "post_id": 42542498, "comment_id": 72221565, "body": "@NeilButterworth But those calls need to get memory from the system/kernel. Don&#39;t they? They probably would need to free them too. I might be wrong. I did reword that fragment too. If I am wrong, then most certainly <i>please</i> explain how it works (or point to a material), so I can understand it, and avoid such mistakes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488405580, "post_id": 42542498, "comment_id": 72221646, "body": "@luk They certainly will need to interact with the OS at some point, but the interaction may be fairly minimal (for example, it&#39;s common for free/delete not to attempt to give memory back to the OS) and they are <i>not</i> themselves OS system calls."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1488406186, "post_id": 42542498, "comment_id": 72221904, "body": "&quot;<i>No they don&#39;t. ... if you forget size you have requested you cannot get it back.&quot;</i> You can&#39;t get the size indeed, but it has to be stored. Otherwise it&#39;d be impossible for <code>delete []</code> to decide <i>how many destructors</i> have to be called."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1488406875, "post_id": 42542498, "comment_id": 72222228, "body": "@HolyBlackCat No it doesn&#39;t. No destructors have to be run (these are ints and the compiler knows this) and so can fast path this situation and not remember <i>at all</i> how many items are in the array. It just has to know how to free memory"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1488406977, "post_id": 42542498, "comment_id": 72222278, "body": "@Mike Which requires knowing the size of the allocated block somehow,  any destructors being called is a bit of a red herring, and wouldn&#39;t apply to C code."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1488407091, "post_id": 42542498, "comment_id": 72222339, "body": "@NeilButterworth No, there are plenty of allocators which dont know the size of the allocation (just the upper bound) - see low fragmentation heaps (often called bucket heaps). And even if it DOES know the size of the allocation, this doesn&#39;t have to be linked at all to the number of items in the array. It just has to be big enough."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1488407168, "post_id": 42542498, "comment_id": 72222380, "body": "@MikeVine I&#39;ve meant that size has to be stored in general case (for types with non-trivial destructors). I really should&#39;ve said that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1488407287, "post_id": 42542498, "comment_id": 72222449, "body": "@Mike &quot; there are plenty of allocators which dont know the size of the allocation (just the upper bound&quot;  so it has to remember <i>something</i>  but  typically this is a size. You can of course write allocators that don&#39;t remember anything, but these tend not to be popular in real-world programs, and are not possible in C++, unless you use different allocators for types with and without destructors, which is also not a popular solution."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1488407626, "post_id": 42542498, "comment_id": 72222600, "body": "@NeilButterworth Go and read up on low fragmentation heaps. They do not have any per allocation overhead at all (in the best case) and so do not remember anything at all on a per allocation basis. They traditionally use addresses to segment the heap into buckets and from those know the size &lt; bucket size. Yes, from an allocation the heap could theoritcally tell you something like &#39;its less than 256 bytes, apart from that I know nothing&#39;. But that&#39;s useless in the context of the question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1488407809, "post_id": 42542498, "comment_id": 72222690, "body": "@Mike I never used the word &quot;overhead&quot;, and from the first article on LFHs I found: &quot;When the LFH is enabled, the system allocates memory in certain predetermined sizes&quot; so the size is known. I don&#39;t wish to carry this on  any further, as SO is not a discussion forum."}], "tags": [], "owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "is_accepted": false, "score": -1, "last_activity_date": 1488405418, "last_edit_date": 1495540810, "creation_date": 1488404095, "answer_id": 42542498, "question_id": 42542167, "link": "https://stackoverflow.com/questions/42542167/meaning-behind-memory-surrounding-array-c/42542498#42542498", "title": "Meaning behind memory surrounding array c++", "body": "<p>\"<em>I got to conclusion that they have to store their own size in order to free the memory.</em>\" No they don't.</p>\n\n<p>Array does not free it's memory. You never get an array from <code>new</code>/<code>malloc</code>. You get a pointer to memory under which you can store an array, but if you forget size you have requested you cannot get it back. The standard library often does depend on OS under the hood as well.</p>\n\n<p>And even OS does not have to remember it. There are implementations with very simple memory management which basically returns you current pointer to the free memory, and move the pointer by the requested size. <code>free</code> does nothing and freed memory is forgotten. </p>\n\n<p>Bottom line, <strong>memory management is implementation defined</strong>, and outside of what you get nothing is guaranteed. Compiler or OS can mess with it, so you need to look documentation specific for the environment.</p>\n\n<p>Bit patterns that you talk about, are often used as safe guards, or used for debugging. E.g: <a href=\"https://stackoverflow.com/questions/370195/when-and-why-will-an-os-initialise-memory-to-0xcd-0xdd-etc-on-malloc-free-new\">When and why will an OS initialise memory to 0xCD, 0xDD, etc. on malloc/free/new/delete?</a></p>\n"}, {"tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 2, "last_activity_date": 1488404958, "last_edit_date": 1488404958, "creation_date": 1488404309, "answer_id": 42542565, "question_id": 42542167, "link": "https://stackoverflow.com/questions/42542167/meaning-behind-memory-surrounding-array-c/42542565#42542565", "title": "Meaning behind memory surrounding array c++", "body": "<p>It typically means that you carried out your experiments using a debugging configuration of the project and debugging version of the standard library. That version of the library uses some pre-defined bit-patterns to mark the boundaries of each allocated memory block (\"no man's land\" areas). Later, it checks if these bit-patterns survived intact (e.g. at the moment of <code>delete[]</code>). If they did not, it implies that someone wrote beyond the boundaries of the memory block. Debug version of the library will issue a diagnostic message about the problem.</p>\n\n<p>If you compile your test program in release (optimized) configuration with release (optimized) version of the standard library, these \"no man's land\" areas will not be created, these bit-patterns will disappear from memory and the associated memory checks will disappear from the code.</p>\n\n<hr>\n\n<p>Note also the the memory layout you observed is typically specific for arrays of objects with no destructors or with trivial destructors (which is basically the same thing). In your case you were working with plain <code>unsigned long</code>.</p>\n\n<p>Once you start allocating arrays of objects with non-trivial destructors, you will observe that it is not just the size of memory block (in bytes) that's stored by the implementation, but the exact size of the array (in elements) is typically stored there as well.</p>\n"}], "owner": {"reputation": 68, "user_id": 7643712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b79748060f0338226e4b128159b8d3e2?s=128&d=identicon&r=PG&f=1", "display_name": "Kosmo", "link": "https://stackoverflow.com/users/7643712/kosmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 42542565, "answer_count": 2, "score": 2, "last_activity_date": 1488405418, "creation_date": 1488402877, "last_edit_date": 1488403316, "question_id": 42542167, "link": "https://stackoverflow.com/questions/42542167/meaning-behind-memory-surrounding-array-c", "title": "Meaning behind memory surrounding array c++", "body": "<p>I've been lately experimenting with dynamically allocated arrays. I got to conclusion that they have to store their own size in order to free the memory.</p>\n\n<p>So I dug a little in memory with pointers and found that 6*4 bytes directly before and 1*4 bytes directly after array don't change upon recompilation (aren't random garbage).</p>\n\n<p>I represented these as unsigned int types and printed them out in win console:</p>\n\n<p>Here's what I got:\n<img src=\"https://i.stack.imgur.com/ny25Y.png\" alt=\"Screenshot\"> (array's content is between <em>fdfdfdfd</em> uints in representation)</p>\n\n<p>So I figured out that third unsigned int directly before the array's first element is the size of allocated memory in bytes.</p>\n\n<p>However I cannot find any information about rest of them.</p>\n\n<p><strong>Q: Does anyone know what the memory surrounding array's content means and care to share?</strong></p>\n\n<p>The code used in program:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nvoid show(unsigned long val[], int n)\n{\n    using namespace std;\n\n    cout &lt;&lt; \"Array length: \" &lt;&lt; n &lt;&lt;endl;\n    cout &lt;&lt; \"hex: \";\n    for (int i = -6; i &lt; n + 1; i++)\n    {\n        cout &lt;&lt; hex &lt;&lt; (*(val + i)) &lt;&lt; \"|\";\n    }\n    cout &lt;&lt; endl &lt;&lt; \"dec: \";\n    for (int i = -6; i &lt; n + 1; i++)\n    {\n        cout &lt;&lt; dec &lt;&lt; (*(val + i)) &lt;&lt; \"|\";\n    }\n    cout &lt;&lt; endl;\n}\n\nint main()\n{\n    using namespace std;\n\n    unsigned long *a = new unsigned long[15]{ 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14 };\n    unsigned long *b = new unsigned long[15]{ 0 };\n    unsigned long *c = new unsigned long[17]{ 0 };\n\n    show(a, 15);\n    cout &lt;&lt; endl;\n    show(b, 15);\n    cout &lt;&lt; endl;\n    show(c, 17);\n    cout &lt;&lt; endl;\n\n    cout &lt;&lt; endl;\n    system(\"PAUSE\");\n\n    delete[] a;\n    delete[] b;\n    delete[] c;\n}\n</code></pre>\n"}, {"tags": ["c++", "string", "stl"], "comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1488402487, "post_id": 42542055, "comment_id": 72219920, "body": "What you&#39;re experiencing is undefined behavior. Only <code>t.p1()</code> and <code>t.p2()</code> truly &quot;work&quot;."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1488402560, "post_id": 42542055, "comment_id": 72219965, "body": "In order to get <code>p3</code> and <code>p4</code> to work you need to change the return type to <code>const std::string&amp;</code> so you still refer to the global strings instead of a copy made by returning by value."}, {"owner": {"reputation": 7687, "user_id": 3220983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ypq01.jpg?s=128&g=1", "display_name": "BuvinJ", "link": "https://stackoverflow.com/users/3220983/buvinj"}, "edited": false, "score": 0, "creation_date": 1488402634, "post_id": 42542055, "comment_id": 72219990, "body": "I think you&#39;re right Nathan!  I&#39;ll check..."}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 1, "creation_date": 1488402694, "post_id": 42542055, "comment_id": 72220015, "body": "The difference between <code>p3()</code> and <code>p4()</code> is where the string representation is located: for <code>p3()</code> the small string optimisation is probably used putting the characters into the string object itself. That gets overwritten before the string gets printed. For <code>p4()</code> the string representation is probably on the heap and probably not overwritten by the time the string is printed. Of course, there is no guarantee either way as the code results in undefined behavior."}, {"owner": {"reputation": 7687, "user_id": 3220983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ypq01.jpg?s=128&g=1", "display_name": "BuvinJ", "link": "https://stackoverflow.com/users/3220983/buvinj"}, "edited": false, "score": 0, "creation_date": 1488403051, "post_id": 42542055, "comment_id": 72220219, "body": "Nathan&#39;s answer works!  But, I over simplified my real use case.  I would like to return a new std::string under some conditions, and a const default under others. (So can&#39;t return a reference to the new one I created with function scope if I change the function signature that way)"}, {"owner": {"reputation": 7687, "user_id": 3220983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ypq01.jpg?s=128&g=1", "display_name": "BuvinJ", "link": "https://stackoverflow.com/users/3220983/buvinj"}, "edited": false, "score": 0, "creation_date": 1488407095, "post_id": 42542055, "comment_id": 72222341, "body": "Since returning a reference worked, I went and created a class member to store my dynamic strings in addition to the constants my function could return.  I hate having to do that, but it makes perfect sense.  Thanks everyone!"}], "owner": {"reputation": 7687, "user_id": 3220983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ypq01.jpg?s=128&g=1", "display_name": "BuvinJ", "link": "https://stackoverflow.com/users/3220983/buvinj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "closed_date": 1488402512, "answer_count": 0, "score": 1, "last_activity_date": 1488402390, "creation_date": 1488402390, "question_id": 42542055, "link": "https://stackoverflow.com/questions/42542055/trouble-with-stdstring-c-str", "closed_reason": "Duplicate", "title": "Trouble with std::string c_str()", "body": "<p>What am I missing here?  This is really irritating!  </p>\n\n<p>Essentially, in main() <code>t.p3()</code> ALWAYS produces random garbage as if the pointer is invalid, yet everything else ALWAYS works!  I determined that the difference is in the length of the string.  What voodoo is this? </p>\n\n<p>How do I get <code>t.p3()</code> to work?</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nstatic const std::string STRING1( \"xxxxxxxxxxxxxxx\" );\nstatic const std::string STRING2( \"xxxxxxxxxxxxxxxx\" ); // MAGIC 16 characters\n\nstruct Test\n{\n    std::string string1() const { return STRING1; }\n    std::string string2() const { return STRING2; }\n    const char * p1() const { return STRING1.c_str(); }\n    const char * p2() const { return STRING2.c_str(); }\n    const char * p3() const { return string1().c_str(); }\n    const char * p4() const { return string2().c_str(); }\n\n};\n\nint main(int argc, char *argv[])\n{\n    Test t;\n    std::cout &lt;&lt; t.p1() &lt;&lt; std::endl; // works\n    std::cout &lt;&lt; t.p2() &lt;&lt; std::endl; // works\n    std::cout &lt;&lt; t.p3() &lt;&lt; std::endl; // random garbage\n    std::cout &lt;&lt; t.p4() &lt;&lt; std::endl; // works\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "qt", "model-view-controller", "model"], "comments": [{"owner": {"reputation": 2789, "user_id": 1217285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1t2xu.jpg?s=128&g=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/1217285/dmitry"}, "edited": false, "score": 0, "creation_date": 1488442189, "post_id": 42541948, "comment_id": 72234985, "body": "I don&#39;t think it&#39;s a good idea to store mutex-protected data in the model in the first place. The views wold call <code>data()</code> method of the model quite often, even in the lack of much concurrency the overhead of locking and unlocking the mutex might be sufficient."}, {"owner": {"reputation": 2789, "user_id": 1217285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1t2xu.jpg?s=128&g=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/1217285/dmitry"}, "edited": false, "score": 0, "creation_date": 1488442193, "post_id": 42541948, "comment_id": 72234987, "body": "If your data is heavy enough, you could encapsulate its management in some <code>QObject</code> which would communicate the data changes via signals to the actual models which would store lightweight &quot;views&quot; of the data - for example, if your data stores long texts, the model could contain, say, first 140 characters of each item for the sake of displaying them in the view. For the access to full data (not for views connected to models so that the access doesn&#39;t occur that often) you could create your own model API which would retrieve the data synchronously."}, {"owner": {"reputation": 119, "user_id": 1716656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/44af46df18101375fdcd427589b09b34?s=128&d=identicon&r=PG", "display_name": "thedimitrius", "link": "https://stackoverflow.com/users/1716656/thedimitrius"}, "reply_to_user": {"reputation": 2789, "user_id": 1217285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1t2xu.jpg?s=128&g=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/1217285/dmitry"}, "edited": false, "score": 0, "creation_date": 1488443272, "post_id": 42541948, "comment_id": 72235642, "body": "That&#39;s indeed the correct way to go. But usage of boost&#39;s asio::io_service for processing update is forced by the framework I use. On the other hand - if the QAbstractItemModel interface functions don&#39;t throw, even the original code might work. If the processUpdate() emits layoutChanged() when the GUI thread is in data() call, waiting for locking mutex - nothing bad will happen. data() will return some wrong data(or maybe empty QVariant()), will display it for several moments, then it will process the signal, and very soon will start displaying correct data."}, {"owner": {"reputation": 126, "user_id": 7410473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IL96B.png?s=128&g=1", "display_name": "Matthew M.", "link": "https://stackoverflow.com/users/7410473/matthew-m"}, "edited": false, "score": 0, "creation_date": 1592922256, "post_id": 42541948, "comment_id": 110594499, "body": "Qt offers a QReadWriteLock, for example. You can still protect your model with a mutex. When you need to read the model (such as in data()), lock the mutex for Read-access. When you need to update the model, lock the mutex for Write-access (which precludes other threads taking both Read- or Write-access). Overhead of using a mutex may be a concern... but that&#39;s not unique to this application. Profile your code to see if it&#39;s a problem. If not, keep it simple and use a mutex."}], "answers": [{"comments": [{"owner": {"reputation": 14632, "user_id": 399908, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/56ea829e87b7772e36a35782dde9fb94?s=128&d=identicon&r=PG", "display_name": "Martin Hennings", "link": "https://stackoverflow.com/users/399908/martin-hennings"}, "edited": false, "score": 2, "creation_date": 1549294360, "post_id": 46661870, "comment_id": 95841656, "body": "It&#39;s not <i>&#39;fine&#39;</i> per se, see <a href=\"http://blog.hostilefork.com/qt-model-view-different-threads/\" rel=\"nofollow noreferrer\">blog.hostilefork.com/qt-model-view-different-threads</a>"}], "tags": [], "owner": {"reputation": 119, "user_id": 1716656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/44af46df18101375fdcd427589b09b34?s=128&d=identicon&r=PG", "display_name": "thedimitrius", "link": "https://stackoverflow.com/users/1716656/thedimitrius"}, "is_accepted": true, "score": 1, "last_activity_date": 1507623728, "creation_date": 1507623728, "answer_id": 46661870, "question_id": 42541948, "link": "https://stackoverflow.com/questions/42541948/qabstractitemmodel-thread-safety/46661870#46661870", "title": "QAbstractItemModel thread safety", "body": "<p>Found answer to my own question:\nIf the Model belongs to a different QThread, then the signals of this model will be connected to view using Qt::QueuedConnection, and it's fine.\nBut if (by default) the Model belongs to GUI QThread (a.k.a. QCoreApplication::instance()->thread()), the slot of Model will be executed immediately, causing calls to data(), columnCount(), etc, thus, it's not okay.</p>\n"}, {"tags": [], "owner": {"reputation": 14632, "user_id": 399908, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/56ea829e87b7772e36a35782dde9fb94?s=128&d=identicon&r=PG", "display_name": "Martin Hennings", "link": "https://stackoverflow.com/users/399908/martin-hennings"}, "is_accepted": false, "score": 1, "last_activity_date": 1549295575, "creation_date": 1549295575, "answer_id": 54519739, "question_id": 42541948, "link": "https://stackoverflow.com/questions/42541948/qabstractitemmodel-thread-safety/54519739#54519739", "title": "QAbstractItemModel thread safety", "body": "<p><code>QAbstractItemModel</code> is <a href=\"http://blog.hostilefork.com/qt-model-view-different-threads/\" rel=\"nofollow noreferrer\"><strong>not</strong> thread safe.</a></p>\n\n<p>This is mainly because signals across thread get queued.</p>\n\n<p>Imagine the following scenario of a model containing a <code>QList&lt;int&gt; list;</code> (ignoring <code>QModelIndex</code>):</p>\n\n<pre><code>background thread       GUI thread        +         signal queue, abbreviations for readability\n[MODEL]                 [VIEW]                      ( )\nbeginInsertRows(0, 1);   ...                        ( rowsAboutToBeAdded(0, 1) = add(1) )\nlist &lt;&lt; item();          (doing                     ( add(1) )\nendInsertRows();        something                   ( add(1), rowsAdded(0, 1) = added(1) )\nbeginRemoveRows(0, 1);    else)                     ( add(1), added(1), rowsAboutToBeRemoved(0, 1) = rem(1) )\nlist.removeAt(0);        ...                        ( add(1), added(1), rem(1) )\nendRemoveRows(0, 1);     ...                        ( add(1), added(1), rem(1), rowsRemoved(0, 1) = rmvd(1) )\n                         rowsAboutToBeAdded(0, 1);  ( added(1), rem(1), rmvd(1) )\n                         rowsAdded(0, 1);           ( rem(1), rmvd(1) )\n                         possible crash!\n</code></pre>\n\n<p>reason:</p>\n\n<p>in rowsAdded(), the view will sooner or later call</p>\n\n<pre><code>model()-&gt;data(model()-&gt;index(0, 0));\n</code></pre>\n\n<p>This model index is invalid, because the model has no rows anymore.</p>\n\n<p>In the best case it just returns an invalid <code>QVariant()</code>.</p>\n\n<p>In the worst case (no defensive checks) the model tries to access <code>list[0]</code>.</p>\n"}], "owner": {"reputation": 119, "user_id": 1716656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/44af46df18101375fdcd427589b09b34?s=128&d=identicon&r=PG", "display_name": "thedimitrius", "link": "https://stackoverflow.com/users/1716656/thedimitrius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1412, "favorite_count": 0, "accepted_answer_id": 46661870, "answer_count": 2, "score": 2, "last_activity_date": 1549295575, "creation_date": 1488401968, "last_edit_date": 1507547850, "question_id": 42541948, "link": "https://stackoverflow.com/questions/42541948/qabstractitemmodel-thread-safety", "title": "QAbstractItemModel thread safety", "body": "<p>My implementation of <code>QAbstractItemModel</code> is listening to some events, and processes updates in a separate thread.\nProcessing of an update may lead to layout and/or data change in the Model.\nThe storage of the data itself is <code>boost::mutex</code> - protected, every call of <code>QAbstractItemModel</code>'s interface functions (executed, if I understand correctly, in GUI thread), and the update processing functions (in a separate thread) lock the mutex.\nIs it okay to emit the signals layoutChanged/dataChanged while locking the same mutex that the data()/rowCount()/whatever may be trying to acquire at the same time?</p>\n\n<p>A piece of code:</p>\n\n<pre><code>class MyItemModel : public QAbstractItemModel {\n    Q_OBJECT\npublic:\n\n    void processUpdate(const Update&amp; update) {\n        Mservice.post([this, update]() {\n            boost::lock_guard&lt;boost::mutex&gt; lock (Mlock);\n            bool willModifyLayout = checkWillModifyLayout(update)\n            bool willModifyData = checkWillModifyData(update);\n            if (willModifyLayout) {\n                emit layoutAboutToBeChanged();\n            }\n                Mdata.processUpdate(update);\n            if (willModifyLayout) {\n                emit layoutChanged();\n            }\n            else if (willModifyData) {\n                emit dataChanged();\n            }            \n        });\n    }\n\n    virtual QVariant data(const QModelIndex &amp;index, int role) const Q_DECL_OVERRIDE {\n        boost::lock_guard&lt;boost::mutex&gt; lock (Mlock);\n        if (index.isValid()) return Mdata.data(index, role);\n    }\n\nprivate:\n    boost::mutex Mmutex;\n    boost::asio::service Mservice;\n    boost::asio::thread MserviceThread;\n    DataStorage Mdata;\n\n}\n</code></pre>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "is_accepted": false, "score": 2, "last_activity_date": 1488401980, "creation_date": 1488401980, "answer_id": 42541950, "question_id": 42541908, "link": "https://stackoverflow.com/questions/42541908/c-why-does-it-always-do-the-last-parameter-first/42541950#42541950", "title": "c++: why does it always do the last parameter first?", "body": "<p>The order of evaluation of function parameters is not defined in C or C++. If you need a specific order, assign the return values of those functions to named variables in the order you require, and then pass those variables to the function:</p>\n\n<pre><code>int a = askCalculation();\nint b = askNumber1();\nint c = askNumber2();\ncout &lt;&lt; calculate( a, b, c ) &lt;&lt; endl;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7643699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9d560103a2d17eccd636c87e634287?s=128&d=identicon&r=PG&f=1", "display_name": "C&#233;dric De Meester", "link": "https://stackoverflow.com/users/7643699/c%c3%a9dric-de-meester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1488402044, "answer_count": 1, "score": 1, "last_activity_date": 1488401980, "creation_date": 1488401821, "question_id": 42541908, "link": "https://stackoverflow.com/questions/42541908/c-why-does-it-always-do-the-last-parameter-first", "closed_reason": "Duplicate", "title": "c++: why does it always do the last parameter first?", "body": "<p>So i was just writing a simple calculator using functions and i wanted to be as easy used as possible. I basically wanted it that in 1 line of code you could do the whole process of asking numbers and the calculation and also calculating the result. but i have i problem. In the code down below, when i do in the main function \n\"cout &lt;&lt; calculate(askCalculation(), askNumber1(), askNumber2()) &lt;&lt; endl;\"\nand i run the program then i want it to first ask the calculation, then the first number and then the second number. But it does not do that, in fact it does it in the excact opposit way. is there a reason why, and how can i fix this?</p>\n\n<p>oh and pls i know you could just put the 3 ask funtion in 1 class to make it even more simple, but is there a way i can put the calculate funtion in that same class?</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint calculate(int calculation, int firstNumber, int lastNumber)\n{\n    switch(calculation)\n    {\n    case 1:\n        return firstNumber + lastNumber;\n        break;\n    case 2:\n        return firstNumber - lastNumber;\n        break;\n    case 3:\n        return firstNumber * lastNumber;\n        break;\n    case 4:\n        return firstNumber / lastNumber;\n        break;\n    }\n}\nint askNumber1()\n{\n    int a;\n    cout &lt;&lt; \"Give the first number\" &lt;&lt; endl;\n    cin &gt;&gt; a;\n    return a;\n}\n    int askNumber2()\n{\n    int b;\n    cout &lt;&lt; \"Give the second number\" &lt;&lt; endl;\n    cin &gt;&gt; b;\n    return b;\n}\nint askCalculation()\n{\n    int c;\n    cout &lt;&lt; \"what calculation do you want to do? add (1) subtract (2) multiplication (3) divide (4)\" &lt;&lt; endl;\n    cin &gt;&gt; c;\n    return c;\n}\nint main()\n{\n    cout &lt;&lt; calculate(askCalculation(), askNumber1(), askNumber2()) &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "cuda", "nvcc"], "comments": [{"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1488401107, "post_id": 42541611, "comment_id": 72219105, "body": "so what is your question?"}, {"owner": {"reputation": 4040, "user_id": 1923699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iTCs2.jpg?s=128&g=1", "display_name": "Tyler Jandreau", "link": "https://stackoverflow.com/users/1923699/tyler-jandreau"}, "edited": false, "score": 0, "creation_date": 1488401424, "post_id": 42541611, "comment_id": 72219287, "body": "Your problem isn&#39;t the template or the inheritance... your problem is that a definition for <code>assert</code> is not available for <b>device</b> code..."}, {"owner": {"reputation": 537, "user_id": 927046, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d6913f81d3894753b1de4e8cfa36446?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/927046/sam"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1488401547, "post_id": 42541611, "comment_id": 72219366, "body": "@talonmies oh yeah, duh... updated to include actual question."}, {"owner": {"reputation": 537, "user_id": 927046, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d6913f81d3894753b1de4e8cfa36446?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/927046/sam"}, "reply_to_user": {"reputation": 4040, "user_id": 1923699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iTCs2.jpg?s=128&g=1", "display_name": "Tyler Jandreau", "link": "https://stackoverflow.com/users/1923699/tyler-jandreau"}, "edited": false, "score": 1, "creation_date": 1488401556, "post_id": 42541611, "comment_id": 72219375, "body": "@TylerJandreau it is for compute capability &gt;= 2.0, see <a href=\"http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#assertion\" rel=\"nofollow noreferrer\">docs.nvidia.com/cuda/cuda-c-programming-guide/&hellip;</a>"}, {"owner": {"reputation": 4040, "user_id": 1923699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iTCs2.jpg?s=128&g=1", "display_name": "Tyler Jandreau", "link": "https://stackoverflow.com/users/1923699/tyler-jandreau"}, "edited": false, "score": 0, "creation_date": 1488401617, "post_id": 42541611, "comment_id": 72219414, "body": "Ah I did not know that. Good show, Sam. It&#39;s been a while."}, {"owner": {"reputation": 537, "user_id": 927046, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d6913f81d3894753b1de4e8cfa36446?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/927046/sam"}, "edited": false, "score": 0, "creation_date": 1488402477, "post_id": 42541611, "comment_id": 72219917, "body": "I would appreciate it if the downvoters and/or those voting to close could add a comment with a brief explanation - is there something else you&#39;d like me to add?"}], "answers": [{"comments": [{"owner": {"reputation": 537, "user_id": 927046, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d6913f81d3894753b1de4e8cfa36446?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/927046/sam"}, "edited": false, "score": 0, "creation_date": 1488908816, "post_id": 42640460, "comment_id": 72435506, "body": "Ah, great. FWIW I can also confirm this as a workaround for CUDA 7.0."}], "tags": [], "owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "is_accepted": true, "score": 2, "last_activity_date": 1488862217, "creation_date": 1488862217, "answer_id": 42640460, "question_id": 42541611, "link": "https://stackoverflow.com/questions/42541611/cannot-call-assert-from-inherited-class/42640460#42640460", "title": "Cannot call assert() from inherited class", "body": "<blockquote>\n  <p>What is wrong with it? </p>\n</blockquote>\n\n<p>I'm not sure there is anything wrong with it.  As you've already indicated, it compiles fine under CUDA 8, so it's likely an \"issue\" with CUDA 7.5 etc.  Updating to CUDA 8 is probably a good approach to handling it.</p>\n\n<blockquote>\n  <p>Or, if nothing, is there a workaround?</p>\n</blockquote>\n\n<p>Below seems to be a workaround on CUDA 7.5, according to my test.  I'm sure there are other possibilities as well.</p>\n\n<p>One CUDA 7.5 workaround possibility:</p>\n\n<pre><code>$ cat t952.cu\n#include &lt;assert.h&gt;\n\n__host__ __device__\nvoid my_assert(bool condition){\n\n  assert(condition);\n}\n\ntemplate &lt;typename T&gt;\nstruct base {};\n\ntemplate &lt;typename T&gt;\nstruct A : base&lt;T&gt;\n{\n    __host__ __device__ void f()\n    {\n        my_assert(0);\n    }\n};\n$ nvcc -c t952.cu\n$ nvcc --version\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2015 NVIDIA Corporation\nBuilt on Tue_Aug_11_14:27:32_CDT_2015\nCuda compilation tools, release 7.5, V7.5.17\n$\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 927046, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d6913f81d3894753b1de4e8cfa36446?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/927046/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 42640460, "answer_count": 1, "score": 0, "last_activity_date": 1488908412, "creation_date": 1488400765, "last_edit_date": 1488908412, "question_id": 42541611, "link": "https://stackoverflow.com/questions/42541611/cannot-call-assert-from-inherited-class", "title": "Cannot call assert() from inherited class", "body": "<p>The below fails to compile with <code>nvcc</code> (v6.0 though 7.5). Scientific Linux; GCC v4.4.7. What is wrong with it? Or, if nothing, is there a workaround?</p>\n\n<pre><code>#include &lt;assert.h&gt;\n\ntemplate &lt;typename T&gt;\nstruct base {};\n\ntemplate &lt;typename T&gt;\nstruct A : base&lt;T&gt;\n{\n    __host__ __device__ void f()\n    {\n        assert(0);\n    }\n};\n\nint main()\n{\n    A&lt;int&gt; a;\n    a.f();\n    return 0;\n}\n</code></pre>\n\n<p>This is the most minimal I was able to get this example. It appears that both <code>base</code> and <code>A</code> must class templates to hit the error, which is given below.</p>\n\n<pre><code>sam@machine:$ nvcc mwe.cu \nmwe.cu: In member function \u2018void A&lt;T&gt;::f()\u2019:\nmwe.cu:11:66: error: expected id-expression before \u2018__PRETTY_FUNCTION__\u2019\n         assert(0);\n</code></pre>\n\n<p><strong>Edit:</strong> After testing on a different system with v8.0 of the CUDA toolkit (and gcc v4.9.2), it appears to compile just fine. But unfortunately upgrading to CUDA 8.0 is out of my hands.</p>\n"}, {"tags": ["c++", "sox"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 4671756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b7e2b87829a404ae10e8bf407f30eafb?s=128&d=identicon&r=PG&f=1", "display_name": "Tom_Anks", "link": "https://stackoverflow.com/users/4671756/tom-anks"}, "edited": false, "score": 4, "creation_date": 1488401156, "post_id": 42541688, "comment_id": 72219128, "body": "I would prefer to do it through SoX as it&#39;s relatively lightweight and only uses one line of code for the conversion (and I know that it works)"}], "tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 0, "last_activity_date": 1488401036, "creation_date": 1488401036, "answer_id": 42541688, "question_id": 42541588, "link": "https://stackoverflow.com/questions/42541588/any-way-i-can-get-sox-to-just-print-the-amplitude-values-from-a-wav-file/42541688#42541688", "title": "Any way I can get SoX to just print the amplitude values from a wav file?", "body": "<p>A wav file consists of a trivial header plus a long list of 16 bit pcm samples.</p>\n\n<p>Here's some code to read one, not quite sure of its development status.</p>\n\n<pre><code>#define WAVE_FORMAT_PCM 0x01\n#define WAVE_FORMAT_IEEE_FLOAT  0x03\n#define WAVE_FORMAT_ALAW    0x06  /*8 - bit ITU - T G.711 A - law */\n#define WAVE_FORMAT_MULAW   0x07 /* 8 - bit ITU - T G.711 \u00b5 - law */\n#define WAVE_FORMAT_EXTENSIBLE 0xFFFE\n\n\ntypedef struct\n{\n    short format_tag;\n    short channels;\n    short block_align;\n    short bits_per_sample;\n    unsigned long format_length;\n    unsigned long sample_rate;\n    unsigned long avg_bytes_sec;\n\n    unsigned long data_size;\n    unsigned char *sound_buffer;\n} WAV;\n\nWAV *loadwav(const char* filename, int *err);\nWAV *floadwav(FILE *fp, int *err);\nvoid killwav(WAV *wav);\n\nstatic void readformatchunk(FILE *fp, WAV *wav, int *err);\nstatic void readdatachunk(FILE *fp, WAV *wav, int *err);\nstatic void readunknownchunk(FILE *fp, int *err);\nstatic double freadieee754(FILE *fp, int bigendian);\nstatic float freadieee754f(FILE *fp, int bigendian);\nstatic int fget16le(FILE *fp);\nstatic long fget32le(FILE *fp);\n\nWAV *loadwav16stereo(const char *filename, int *err)\n{\n\n}\nWAV *loadwav(const char* filename, int *err)\n{\n    WAV *answer;\n    FILE *fp;\n\n    if (err)\n        *err = 0;\n    fp = fopen(filename, \"rb\");\n    if (!fp)\n    {\n        *err = -2;\n        return 0;\n    }\n    answer = floadwav(fp, err);\n    fclose(fp);\n\n    return answer;\n}\n\nWAV *floadwav(FILE *fp, int *err)\n{\n    short format_tag, channels, block_align, bits_per_sample;\n    unsigned long format_length, sample_rate, avg_bytes_sec, i;\n\n    unsigned char *sound_buffer;\n    int data_size;\n\n    WAV *answer = 0;\n    unsigned char id[4];\n    unsigned long size;\n\n    if (err)\n        *err = 0;\n\n    answer = malloc(sizeof(WAV));\n    if (!answer)\n        goto out_of_memory;\n    answer-&gt;sound_buffer = 0;\n\n    fread(id, sizeof(unsigned char), 4, fp);\n\n    if (strncmp(id, \"RIFF\", 4))\n        goto parse_error;\n\n    size = fget32le(fp);\n    fread(id, sizeof(unsigned char), 4, fp);\n    if (strncmp(id, \"WAVE\", 4))\n        goto parse_error;\n\n    while (1)\n    {\n        if (fread(id, sizeof(unsigned char), 4, fp) != 4)\n            goto parse_error;\n        if (!strncmp(id, \"fmt \", 4))\n        {\n            readformatchunk(fp, answer, err);\n            if (*err)\n                goto parse_error;\n        }\n        else if (!strncmp(id, \"data\", 4))\n        {\n            readdatachunk(fp, answer, err);\n            if (*err)\n                goto parse_error;\n            break;\n        }\n        else\n        {\n        }\n    }\n\n\n    return answer;\n\nparse_error:\n    if (err)\n        *err = -3;\n    killwav(answer);\n    return 0;\nout_of_memory:\n    if (err)\n        *err = -1;\n    killwav(answer);\n    return 0;\n}\n\nvoid killwav(WAV *wav)\n{\n    if (wav)\n    {\n        free(wav-&gt;sound_buffer);\n        free(wav);\n    }\n}\n\nint wav_Nchannels(WAV *wav)\n{\n    return wav-&gt;channels;\n}\n\nint wav_samplerate(WAV *wav)\n{\n    return wav-&gt;sample_rate;\n}\n\nunsigned short *wav_samplesasshort(WAV *wav, long *Nsamples)\n{\n    unsigned short *answer = 0;\n    long N;\n    long i;\n\n    if (wav-&gt;format_tag == WAVE_FORMAT_PCM &amp;&amp; wav-&gt;bits_per_sample == 8)\n    {\n        N = wav-&gt;data_size;\n        answer = malloc(N * sizeof(short));\n        if (!answer)\n            goto out_of_memory;\n        for (i = 0; i &lt; N; i++)\n        {\n            answer[i] = (wav-&gt;sound_buffer[i] - 128) * 256;\n        }\n    }\n    else if (wav-&gt;format_tag == WAVE_FORMAT_PCM &amp;&amp; wav-&gt;bits_per_sample == 16)\n    {\n        short *sbuffer = (short *) wav-&gt;sound_buffer;\n        N = wav-&gt;data_size/2;\n        answer = malloc(N * sizeof(short));\n        if (!answer)\n            goto out_of_memory;\n        for (i = 0; i &lt; N; i++)\n        {\n            answer[i] = sbuffer[i];\n        }\n    }\n    else if (wav-&gt;format_tag == WAVE_FORMAT_IEEE_FLOAT &amp;&amp; wav-&gt;bits_per_sample == 32)\n    {\n        float *fbuffer = (float *)wav-&gt;sound_buffer;\n        N = wav-&gt;data_size / 4;\n        answer = malloc(N * sizeof(short));\n        if (!answer)\n            goto out_of_memory;\n        for (i = 0; i &lt; N; i++)\n        {\n            answer[i] = (short)(fbuffer[i] * SHRT_MAX);\n        }\n    }\n    else if (wav-&gt;format_tag == WAVE_FORMAT_IEEE_FLOAT &amp;&amp; wav-&gt;bits_per_sample == 32)\n    {\n        float *dbuffer = (float *)wav-&gt;sound_buffer;\n        N = wav-&gt;data_size / 8;\n        answer = malloc(N * sizeof(short));\n        if (!answer)\n            goto out_of_memory;\n        for (i = 0; i &lt; N; i++)\n        {\n            answer[i] = (short)(dbuffer[i] * SHRT_MAX);\n        }\n    }\n    if (Nsamples)\n        *Nsamples = N;\n    return answer;\n\nout_of_memory:\n    return 0;\n}\n\nstatic void readformatchunk(FILE *fp, WAV *wav, int *err)\n{\n    short format_tag, channels, block_align, bits_per_sample;\n    unsigned long format_length, sample_rate, avg_bytes_sec, i;\n    short cb_size = 0;\n    short valid_bits_per_sample;\n    unsigned long channel_mask;\n    unsigned char guid[16];\n\n    format_length = fget32le(fp);\n    if (format_length &lt; 16)\n        goto parse_error;\n    //fread(&amp;format_tag, sizeof(short), 1, fp);\n    format_tag = fget16le(fp);\n    //fread(&amp;channels, sizeof(short), 1, fp);\n    channels = fget16le(fp);\n    //fread(&amp;sample_rate, sizeof(unsigned long), 1, fp);\n    sample_rate = fget32le(fp);\n    //fread(&amp;avg_bytes_sec, sizeof(short), 1, fp);\n    avg_bytes_sec = fget32le(fp);\n    //fread(&amp;block_align, sizeof(short), 1, fp);\n    block_align = fget16le(fp);\n    //fread(&amp;bits_per_sample, sizeof(short), 1, fp);\n    bits_per_sample = fget16le(fp);\n\n    if (format_length &gt; 16)\n    {\n        cb_size = fget16le(fp);\n    }\n    if (cb_size &gt;= 22)\n    {\n        valid_bits_per_sample = fget16le(fp);\n        channel_mask = fget32le(fp);\n        fread(&amp;guid, 1, 16, fp);\n\n        cb_size -= 22;\n        for (i = 0; i &lt; cb_size; i++)\n            fgetc(fp);\n    }\n    else\n    {\n        for (i = 0; i &lt; cb_size; i++)\n            fgetc(fp);\n    }\n    wav-&gt;format_tag = format_tag;\n    wav-&gt;channels = channels;\n    wav-&gt;bits_per_sample = bits_per_sample;\n    wav-&gt;sample_rate = sample_rate;\n\n    return;\nparse_error:\n    *err = -1;\n}\n\nstatic void readdatachunk(FILE *fp, WAV *wav, int *err)\n{\n    unsigned long data_size;\n    unsigned long i;\n    unsigned char *sound_buffer;\n    unsigned char *buff8;\n    short *buff16;\n    float *bufffloat;\n    double *buffdouble;\n\n    data_size = fget32le(fp);\n    wav-&gt;data_size = data_size;\n    if (wav-&gt;format_tag == WAVE_FORMAT_PCM &amp;&amp; wav-&gt;bits_per_sample == 8)\n    {\n        buff8 = malloc(data_size);\n        for (i = 0; i &lt; data_size; i++)\n        {\n            buff8[i] = fgetc(fp);\n        }\n        wav-&gt;sound_buffer = buff8;\n    }\n    else if (wav-&gt;format_tag == WAVE_FORMAT_PCM &amp;&amp; wav-&gt;bits_per_sample == 16)\n    {\n        buff16 = malloc(data_size/2 * sizeof(short));\n        for (i = 0; i &lt; data_size/2; i++)\n        {\n            buff16[i] = fget16le(fp);\n        }\n        wav-&gt;sound_buffer = buff16;\n    }\n    else if (wav-&gt;format_tag == WAVE_FORMAT_IEEE_FLOAT &amp;&amp; wav-&gt;bits_per_sample == 32)\n    {\n        bufffloat = malloc(data_size / 4 * sizeof(float));\n        for (i = 0; i &lt; data_size / 4; i++)\n        {\n            bufffloat[i] = freadieee754f(fp, 0);\n        }\n        wav-&gt;sound_buffer = bufffloat;\n\n    }\n    else if (wav-&gt;format_tag == WAVE_FORMAT_IEEE_FLOAT &amp;&amp; wav-&gt;bits_per_sample == 64)\n    {\n        buffdouble = malloc(data_size / 8 * sizeof(float));\n        for (i = 0; i &lt; data_size / 8; i++)\n        {\n            buffdouble[i] = freadieee754(fp, 0);\n        }\n        wav-&gt;sound_buffer = buffdouble;\n    }\n    return;\nparse_error:\n    *err = -3;\n    return;\nout_of_memory:\n    *err = -1;\n    return;\n}\n\nstatic void readunknownchunk(FILE *fp, int *err)\n{\n    unsigned long data_size;\n\n    data_size = fget32le(fp);\n    while (data_size--)\n    {\n        if (fgetc(fp) == EOF)\n            goto parse_error;\n    }\n    return;\nparse_error:\n    *err = -3;\n    return;\n}\n\nstatic int wav_is_16bitstereo(WAV *wav)\n{\n\n}\n\n/*\n* read a double from a stream in ieee754 format regardless of host\n*  encoding.\n*  fp - the stream\n*  bigendian - set to if big bytes first, clear for little bytes\n*              first\n*\n*/\nstatic double freadieee754(FILE *fp, int bigendian)\n{\n    unsigned char buff[8];\n    int i;\n    double fnorm = 0.0;\n    unsigned char temp;\n    int sign;\n    int exponent;\n    double bitval;\n    int maski, mask;\n    int expbits = 11;\n    int significandbits = 52;\n    int shift;\n    double answer;\n\n    /* read the data */\n    for (i = 0; i &lt; 8; i++)\n        buff[i] = fgetc(fp);\n    /* just reverse if not big-endian*/\n    if (!bigendian)\n    {\n        for (i = 0; i &lt; 4; i++)\n        {\n            temp = buff[i];\n            buff[i] = buff[8 - i - 1];\n            buff[8 - i - 1] = temp;\n        }\n    }\n    sign = buff[0] &amp; 0x80 ? -1 : 1;\n    /* exponet in raw format*/\n    exponent = ((buff[0] &amp; 0x7F) &lt;&lt; 4) | ((buff[1] &amp; 0xF0) &gt;&gt; 4);\n\n    /* read inthe mantissa. Top bit is 0.5, the successive bits half*/\n    bitval = 0.5;\n    maski = 1;\n    mask = 0x08;\n    for (i = 0; i &lt; significandbits; i++)\n    {\n        if (buff[maski] &amp; mask)\n            fnorm += bitval;\n\n        bitval /= 2.0;\n        mask &gt;&gt;= 1;\n        if (mask == 0)\n        {\n            mask = 0x80;\n            maski++;\n        }\n    }\n    /* handle zero specially */\n    if (exponent == 0 &amp;&amp; fnorm == 0)\n        return 0.0;\n\n    shift = exponent - ((1 &lt;&lt; (expbits - 1)) - 1); /* exponent = shift + bias */\n    /* nans have exp 1024 and non-zero mantissa */\n    if (shift == 1024 &amp;&amp; fnorm != 0)\n        return sqrt(-1.0);\n    /*infinity*/\n    if (shift == 1024 &amp;&amp; fnorm == 0)\n    {\n\n#ifdef INFINITY\n        return sign == 1 ? INFINITY : -INFINITY;\n#endif\n        return  (sign * 1.0) / 0.0;\n    }\n    if (shift &gt; -1023)\n    {\n        answer = ldexp(fnorm + 1.0, shift);\n        return answer * sign;\n    }\n    else\n    {\n        /* denormalised numbers */\n        if (fnorm == 0.0)\n            return 0.0;\n        shift = -1022;\n        while (fnorm &lt; 1.0)\n        {\n            fnorm *= 2;\n            shift--;\n        }\n        answer = ldexp(fnorm, shift);\n        return answer * sign;\n    }\n}\n\n\nstatic float freadieee754f(FILE *fp, int bigendian)\n{\n    unsigned long buff = 0;\n    unsigned long buff2 = 0;\n    unsigned long mask;\n    int sign;\n    int exponent;\n    int shift;\n    int i;\n    int significandbits = 23;\n    int expbits = 8;\n    double fnorm = 0.0;\n    double bitval;\n    double answer;\n\n    for (i = 0; i&lt;4; i++)\n        buff = (buff &lt;&lt; 8) | fgetc(fp);\n    if (!bigendian)\n    {\n        for (i = 0; i&lt;4; i++)\n        {\n            buff2 &lt;&lt;= 8;\n            buff2 |= (buff &amp; 0xFF);\n            buff &gt;&gt;= 8;\n        }\n        buff = buff2;\n    }\n\n    sign = (buff &amp; 0x80000000) ? -1 : 1;\n    mask = 0x00400000;\n    exponent = (buff &amp; 0x7F800000) &gt;&gt; 23;\n    bitval = 0.5;\n    for (i = 0; i&lt;significandbits; i++)\n    {\n        if (buff &amp; mask)\n            fnorm += bitval;\n        bitval /= 2;\n        mask &gt;&gt;= 1;\n    }\n    if (exponent == 0 &amp;&amp; fnorm == 0.0)\n        return 0.0f;\n    shift = exponent - ((1 &lt;&lt; (expbits - 1)) - 1); /* exponent = shift + bias */\n\n    if (shift == 128 &amp;&amp; fnorm != 0.0)\n        return (float)sqrt(-1.0);\n    if (shift == 128 &amp;&amp; fnorm == 0.0)\n    {\n#ifdef INFINITY\n        return sign == 1 ? INFINITY : -INFINITY;\n#endif\n        return (sign * 1.0f) / 0.0f;\n    }\n    if (shift &gt; -127)\n    {\n        answer = ldexp(fnorm + 1.0, shift);\n        return (float)answer * sign;\n    }\n    else\n    {\n        if (fnorm == 0.0)\n        {\n            return 0.0f;\n        }\n        shift = -126;\n        while (fnorm &lt; 1.0)\n        {\n            fnorm *= 2;\n            shift--;\n        }\n        answer = ldexp(fnorm, shift);\n        return (float)answer * sign;\n    }\n}\n\nstatic int fget16le(FILE *fp)\n{\n    int c1, c2;\n\n    c1 = fgetc(fp);\n    c2 = fgetc(fp);\n\n    return ((c2 ^ 128) - 128) * 256 + c1;\n}\n\nstatic long fget32le(FILE *fp)\n{\n    int c1, c2, c3, c4;\n\n    c1 = fgetc(fp);\n    c2 = fgetc(fp);\n    c3 = fgetc(fp);\n    c4 = fgetc(fp);\n    return ((c4 ^ 128) - 128) * 256 * 256 * 256 + c3 * 256 * 256 + c2 * 256 + c1;\n}\n\n\nvoid wavfilemain(void)\n{\n    int err;\n    WAV *wav = loadwav(\"C:\\\\Users\\\\Malcolm\\\\Documents\\\\Visual Studio 2013\\\\Projects\\\\ANSIScratch\\\\ANSIScratch\\\\LaserBlast.wav\", &amp;err);\n    short *samples;\n    long N;\n    long i;\n\n    printf(\"here %p\\n\", wav);\n    printf(\"%d fmt %d bits %d channels %d\\n\", wav-&gt;sample_rate, wav-&gt;format_tag, wav-&gt;bits_per_sample, wav-&gt;channels);\n    samples = wav_samplesasshort(wav, &amp;N);\n\n    killwav(wav);\n} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 4671756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b7e2b87829a404ae10e8bf407f30eafb?s=128&d=identicon&r=PG&f=1", "display_name": "Tom_Anks", "link": "https://stackoverflow.com/users/4671756/tom-anks"}, "edited": false, "score": 0, "creation_date": 1489496191, "post_id": 42542515, "comment_id": 72687184, "body": "This is perfect, thank you. Is there any chance you could share your whole  C++ code? I have the code compiling apart from &quot;verbose&quot; which isn&#39;t defined - what exactly is the function of &quot;verbose&quot;?"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "reply_to_user": {"reputation": 47, "user_id": 4671756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b7e2b87829a404ae10e8bf407f30eafb?s=128&d=identicon&r=PG&f=1", "display_name": "Tom_Anks", "link": "https://stackoverflow.com/users/4671756/tom-anks"}, "edited": false, "score": 0, "creation_date": 1489541788, "post_id": 42542515, "comment_id": 72713559, "body": "I just dumped this out of my command-line app, figuring that it would be obvious that&#39;s irrelevant.  <code>verbose</code> was just set if I pass <code>-v</code> as a command line argument.  I&#39;ve removed that from my answer.  I really don&#39;t see the need to post my full code, because it&#39;s huge and even more irrelevant to what you&#39;re asking."}, {"owner": {"reputation": 47, "user_id": 4671756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b7e2b87829a404ae10e8bf407f30eafb?s=128&d=identicon&r=PG&f=1", "display_name": "Tom_Anks", "link": "https://stackoverflow.com/users/4671756/tom-anks"}, "edited": false, "score": 0, "creation_date": 1489570373, "post_id": 42542515, "comment_id": 72724261, "body": "That&#39;s fair enough, I got libsndfile doing what I wanted anyway (selecting a wav file and getting its frequency out) but I&#39;d never come across the term verbose when it comes to coding. Thanks!"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "reply_to_user": {"reputation": 1800, "user_id": 1885442, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1aa1fb55aeb2c530e2d4f13b90abf2e1?s=128&d=identicon&r=PG", "display_name": "Szczepan Ho\u0142yszewski", "link": "https://stackoverflow.com/users/1885442/szczepan-ho%c5%82yszewski"}, "edited": false, "score": 0, "creation_date": 1582488216, "post_id": 42542515, "comment_id": 106785764, "body": "@SzczepanHo\u0142yszewski of course you are entitled to do that. Allow me to highlight that if you read the question more carefully, you&#39;ll see they wanted to get WAV amplitude in their C++ program and in fact found it annoying to do any kind of external file conversions. The fact is, SoX <i>does not</i> provide any feature for doing what was being asked so I provided a couple of simple alternatives that were better fit for purpose. This may not fit your idealized view of what software engineering is about, but I&#39;m afraid that is just reality. We often have to use solutions that we did not expect."}], "tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": true, "score": 0, "last_activity_date": 1489541952, "last_edit_date": 1489541952, "creation_date": 1488404169, "answer_id": 42542515, "question_id": 42541588, "link": "https://stackoverflow.com/questions/42541588/any-way-i-can-get-sox-to-just-print-the-amplitude-values-from-a-wav-file/42542515#42542515", "title": "Any way I can get SoX to just print the amplitude values from a wav file?", "body": "<p>If you want the data specifically for use in C++, it's very easy to use something like <a href=\"http://www.mega-nerd.com/libsndfile/\" rel=\"nofollow noreferrer\">Libsndfile</a>.  It's a pretty mature C library, but comes with a convenient C++ wrapper (sndfile.hh).</p>\n\n<p>Here's example usage lifted from something I wrote recently where I needed easy access to audio data.</p>\n\n<pre><code>std::string infile_name = \"/path/to/vocal2.wav\";\n\n// Open input file.\nSndfileHandle infile_handle( infile_name );\nif( !infile_handle || infile_handle.error() != 0 )\n{\n    std::cerr &lt;&lt; \"Unable to read \" &lt;&lt; infile_name &lt;&lt; std::endl;\n    std::cerr &lt;&lt; infile_handle.strError() &lt;&lt; std::endl;\n    return 1;\n}\n\n// Show file stats\nint64_t in_frames = infile_handle.frames();\nint in_channels = infile_handle.channels();\nint in_samplerate = infile_handle.samplerate();\nstd::cerr &lt;&lt; \"Input file: \" &lt;&lt; infile_name &lt;&lt; std::endl;\nstd::cerr &lt;&lt; \" * Frames      : \" &lt;&lt; std::setw(6) &lt;&lt; in_frames &lt;&lt; std::endl;\nstd::cerr &lt;&lt; \" * Channels    : \" &lt;&lt; std::setw(6) &lt;&lt; in_channels &lt;&lt; std::endl;\nstd::cerr &lt;&lt; \" * Sample Rate : \" &lt;&lt; std::setw(6) &lt;&lt; in_samplerate &lt;&lt; std::endl;\n\n// Read audio data as float\nstd::vector&lt;float&gt; in_data( in_frames * in_channels );\ninfile_handle.read( in_data.data(), in_data.size() );\n</code></pre>\n\n<p>If you just want to use SoX on the command line and get text output, you can do something like this:</p>\n\n<pre><code>sox vocal2.wav -t f32 - | od -ve -An | more\n</code></pre>\n\n<p>Here I've specified an output of raw 32-bit float, and run it through GNU <em>od</em>.  It's a little frustrating that you can't tell <em>od</em> how many columns you want, but you can clean that up with other simple tools.  Have a look at the manpage for <em>od</em> if you want different sample encodings.</p>\n"}], "owner": {"reputation": 47, "user_id": 4671756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b7e2b87829a404ae10e8bf407f30eafb?s=128&d=identicon&r=PG&f=1", "display_name": "Tom_Anks", "link": "https://stackoverflow.com/users/4671756/tom-anks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1135, "favorite_count": 0, "accepted_answer_id": 42542515, "answer_count": 2, "score": 3, "last_activity_date": 1489541952, "creation_date": 1488400672, "question_id": 42541588, "link": "https://stackoverflow.com/questions/42541588/any-way-i-can-get-sox-to-just-print-the-amplitude-values-from-a-wav-file", "title": "Any way I can get SoX to just print the amplitude values from a wav file?", "body": "<p>I'm using a simple line of code:</p>\n\n<pre><code>sox vocal2.wav -t dat vocal2.dat\n</code></pre>\n\n<p>via SoX to convert a wav file to a text file showing the amplitude values at certain time positions. The output data also has a header showing sample rate and number of channels. </p>\n\n<p>I need to use the amplitude data in a C++ program to determine the pitch of the input, but it's annoying to have to convert the file, drag the data into Excel, copy one column, save it to a new .txt file and then work with it.</p>\n\n<p>Is there a way I can tell SoX to JUST output the amplitude in the converted file?</p>\n"}, {"tags": ["c++", "precision"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488401151, "post_id": 42541548, "comment_id": 72219125, "body": "What&#39;s actually wrong checking against <code>std::numeric_limits</code>?"}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 1, "creation_date": 1488401391, "post_id": 42541548, "comment_id": 72219267, "body": "If the distance between the most significant non-zero bit and the least significant non-zero bit of the positive value is less or equal to <code>std::numeric_limits&lt;double&gt;::digits</code> I&#39;d think the <code>int64_t</code> can be stored losslessly in a <code>double</code> (I think it is less or equal but there is a chance that I got an off by one error here)."}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1488402013, "post_id": 42541548, "comment_id": 72219664, "body": "doesn&#39;t Christoph&#39;s answer demonstrate via the standard wording that a cast will &quot;remove all extra range and precision&quot;"}, {"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1488404816, "post_id": 42541548, "comment_id": 72221223, "body": "Checking <code>std::numeric_limits</code> will give me the 2^53 boundary, but won&#39;t tell me if a given integer &gt;2^53, like 2^54, will fit. It also assumes IEEE representation if I&#39;m not mistaken."}], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1488401233, "post_id": 42541719, "comment_id": 72219172, "body": "Some proof example for this?"}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488401798, "post_id": 42541719, "comment_id": 72219533, "body": "An IEEE double stores numbers with a binary floating point. So a number which is a multiple of a power of 2, ie has low bits zero, is like 3,000,000 in decimal. It can be represented exactly despite the approximation."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1488401931, "post_id": 42541719, "comment_id": 72219617, "body": "There&#39;s no guarantee the compiler or the target FPU uses that IEEE double encoding."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 1, "creation_date": 1488402173, "post_id": 42541719, "comment_id": 72219772, "body": "2^1000 is exactly representable as a double and has zero as bottom bits. not gonna fit into a uint64_t though."}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1488407711, "post_id": 42541719, "comment_id": 72222640, "body": "No, IEEE 754 is not requires. But it will use a binary floating point. It can represent multiples of powers of two exactly until it runs out of exponent, which means very large numbers indeed."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1488436345, "post_id": 42541719, "comment_id": 72231953, "body": "@malcolm: it could use a base which is a power of 2; at least one historic CPU used base 16. That will mean that the number of bits of precision varies depending on the first hex digit."}], "tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": -3, "last_activity_date": 1488401173, "creation_date": 1488401173, "answer_id": 42541719, "question_id": 42541548, "link": "https://stackoverflow.com/questions/42541548/how-to-determine-if-a-given-int64-t-can-be-stored-losslessly-in-a-double/42541719#42541719", "title": "How to determine if a given int64_t can be stored losslessly in a double?", "body": "<p>You need to test the lower bits. If they are zero, the number will be stored losslessly.</p>\n"}, {"comments": [{"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1488404967, "post_id": 42541830, "comment_id": 72221304, "body": "Does this assume IEEE representation?"}, {"owner": {"reputation": 523, "user_id": 1539607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9386388dbd2f7e2b6146a1324765692?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1539607/andrew"}, "edited": false, "score": 0, "creation_date": 1488406272, "post_id": 42541830, "comment_id": 72221951, "body": "This indeed looks like IEEE 754.  If you have a Linux system, then you can examine /usr/include/x86_64-linux-gnu/ieee754.h to see how floating point values are internally represented.  Within this file you can see that mantissa0 has 20 bits and mantissa1 has 32 bits (totally 52 bits).  This implies that a 64-bit integer can populate any consecutive 52 bits loselessly. For completeness, you can loselessly store consecutive 23 bits into a float and (if supported) all 64 bits into a long double."}, {"owner": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "edited": false, "score": 2, "creation_date": 1488407964, "post_id": 42541830, "comment_id": 72222762, "body": "You&#39;d need to remove the sign-bit first... And I&#39;m not aware of any HW available &quot;with ease&quot; that isn&#39;t IEEE-compatible (at least as far as the layout of the bits - there are some implementations that &quot;cheat&quot; on the specifics of rounding, required precision in some calculations, and so on)"}, {"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1488431880, "post_id": 42541830, "comment_id": 72230276, "body": "The original code snippet would go into an infinite loop if the value being tested was 0; I edited it to reflect what I believe works."}], "tags": [], "owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "is_accepted": true, "score": 9, "last_activity_date": 1488467431, "last_edit_date": 1488467431, "creation_date": 1488401586, "answer_id": 42541830, "question_id": 42541548, "link": "https://stackoverflow.com/questions/42541548/how-to-determine-if-a-given-int64-t-can-be-stored-losslessly-in-a-double/42541830#42541830", "title": "How to determine if a given int64_t can be stored losslessly in a double?", "body": "<p>As long as low bits are 0, you can have more high order bits set (because you can increase the double's exponent). I reduced the requirement to unsigned to make the bit shifting not have to worry about sign bits but I believe it should be adaptable.</p>\n\n<pre><code>bool fits_in_double_losslessly (uint64_t v)\n{\n    const uint64_t largest_int = 1ULL &lt;&lt; 53;\n\n    while ((v &gt; largest_int) &amp;&amp; !(v &amp; 1))\n    {\n        v &gt;&gt;= 1;\n    }\n\n    return v &lt;= largest_int;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1488765394, "post_id": 42548127, "comment_id": 72361752, "body": "Your alternative suggestion is elegant. Important to note, though, that it requires a check to make sure <code>m</code> is not the minimum or maximum value of its integer type."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1488788861, "post_id": 42548127, "comment_id": 72369911, "body": "@ptomato How to handle that? <i>Unsigned</i> arithmetic is guaranteed to wrap around, but the question asked about a signed type.  Signed integer overflow and underflow is undefined behavior. (And implementations typically do whatever the hardware does.) That said, on most compilers for most targets, the behavior is specified as producing a number of opposite sign, and the test will still work."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 2, "last_activity_date": 1488789341, "last_edit_date": 1488789341, "creation_date": 1488435489, "answer_id": 42548127, "question_id": 42541548, "link": "https://stackoverflow.com/questions/42541548/how-to-determine-if-a-given-int64-t-can-be-stored-losslessly-in-a-double/42548127#42548127", "title": "How to determine if a given int64_t can be stored losslessly in a double?", "body": "<p>Subtract the highest bit set from the lowest bit set, add one to avoid fencepost error, compare to the number of bits in the mantissa.  Remember that the leading 1 of the mantissa is implicit in IEEE.  If the mantissa can hold the entire range of bits in use, it can store that number exactly.</p>\n\n<p>Alternatively, see if <code>static_cast&lt;double&gt;(m) != static_cast&lt;double&gt;(m+1) &amp;&amp; static_cast&lt;double&gt;(m) != static_cast&lt;double&gt;(m-1)</code>.  This works for an <em>unsigned</em> value, but for a <em>signed</em> type, portable code would need to check that the value will not overflow or underflow, as that is undefined behavior.  Then again, some implementations might not have <code>int64_t</code> either.  On many implementations, however, signed overflow or underflow will still give you a different number with the opposite sign, which will properly test as distinct.</p>\n"}, {"comments": [{"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1488765521, "post_id": 42586245, "comment_id": 72361774, "body": "Good thinking with the <code>volatile</code> keyword. This will hopefully do what I <i>thought</i> my original code would do. If it works on all the platforms where I need it to work, I&#39;ll give you the checkmark."}, {"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1490848271, "post_id": 42586245, "comment_id": 73297625, "body": "Unfortunately it didn&#39;t work on all platforms. Apparently compilers will do this even via a conversion that preserves the excess precision. Really good suggestion though."}, {"owner": {"reputation": 572, "user_id": 660162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12930a58200c8095f26d7620c35fd2d7?s=128&d=identicon&r=PG", "display_name": "Bob Miller", "link": "https://stackoverflow.com/users/660162/bob-miller"}, "reply_to_user": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1490848994, "post_id": 42586245, "comment_id": 73297799, "body": "Hmm...I still think the basic premise should work, because if we know that a value is really written to disk and then read back then there is no way to store the excess precision. The question therefore becomes how to force that to be the case. May I ask for an example of a platform where it didn&#39;t work so I may experiment?"}, {"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1490852181, "post_id": 42586245, "comment_id": 73298958, "body": "Sure. See <a href=\"https://bugzilla.gnome.org/show_bug.cgi?id=779399\" rel=\"nofollow noreferrer\">bugzilla.gnome.org/show_bug.cgi?id=779399</a> for the actual use case. The architectures where it didn&#39;t work were armhf and ppc64el."}, {"owner": {"reputation": 572, "user_id": 660162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12930a58200c8095f26d7620c35fd2d7?s=128&d=identicon&r=PG", "display_name": "Bob Miller", "link": "https://stackoverflow.com/users/660162/bob-miller"}, "reply_to_user": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1490853231, "post_id": 42586245, "comment_id": 73299403, "body": "Ok awesome. I have an armhf setup I&#39;ll bring home from work tomorrow to see if I can reproduce the issue. I suspect my implementation of the idea is just slightly wrong somehow. This is the problem with volatile having so few valid use cases ;)"}, {"owner": {"reputation": 572, "user_id": 660162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12930a58200c8095f26d7620c35fd2d7?s=128&d=identicon&r=PG", "display_name": "Bob Miller", "link": "https://stackoverflow.com/users/660162/bob-miller"}, "reply_to_user": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1491001852, "post_id": 42586245, "comment_id": 73378772, "body": "Just an update: I looked at it yesterday but haven&#39;t managed to get it to behave like the automated tests you linked (on my available compilers the code you have worked properly on armhf). I should be able to take another look some time this weekend to see if I can track down the root cause."}, {"owner": {"reputation": 572, "user_id": 660162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12930a58200c8095f26d7620c35fd2d7?s=128&d=identicon&r=PG", "display_name": "Bob Miller", "link": "https://stackoverflow.com/users/660162/bob-miller"}, "reply_to_user": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1491241534, "post_id": 42586245, "comment_id": 73455076, "body": "I&#39;ve reproduced the failure from your link, but I have not yet been able to determine why. Looking at the generated assembly, the value is indeed being written to memory and read back. I&#39;m surprised that any type of excess precision problem could occur in such a case. I&#39;ll take another look sometime this week, but if I can&#39;t figure it out by then I&#39;ll call it a loss and delete this answer. Oh well :/"}, {"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1491269737, "post_id": 42586245, "comment_id": 73466214, "body": "Yeah, I basically chalked it up to &quot;compilers are tricksy&quot;. But please don&#39;t delete the answer! I think it&#39;s still valuable."}], "tags": [], "owner": {"reputation": 572, "user_id": 660162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12930a58200c8095f26d7620c35fd2d7?s=128&d=identicon&r=PG", "display_name": "Bob Miller", "link": "https://stackoverflow.com/users/660162/bob-miller"}, "is_accepted": false, "score": 1, "last_activity_date": 1488575281, "last_edit_date": 1488575281, "creation_date": 1488566520, "answer_id": 42586245, "question_id": 42541548, "link": "https://stackoverflow.com/questions/42541548/how-to-determine-if-a-given-int64-t-can-be-stored-losslessly-in-a-double/42586245#42586245", "title": "How to determine if a given int64_t can be stored losslessly in a double?", "body": "<p>A common theme among the other answers is the concern about whether or not you can assume that the doubles are implemented via IEEE 754 or not.</p>\n\n<p>I'd argue that for many purposes your original method is best: cast the given int64_t to a double, then assign the result back to a second int64_t, and compare the two.</p>\n\n<p>Regarding your concern about excess precision, that shouldn't be applicable as long as you know that the value has actually been written to memory and read back, because at that stage there shouldn't be any way for the compiler to store the \"excess precision\" for that variable. Based on the answers at your original link, I believe the following example would be enough to force that behavior:</p>\n\n<pre><code>bool losslessRoundTrip(int64_t valueToTest)\n{\n    double newRepresentation;\n    *((volatile double *)&amp;newRepresentation) = static_cast&lt;double&gt;(valueToTest);\n    int64_t roundTripValue = static_cast&lt;int64_t&gt;(newRepresentation);\n    return roundTripValue == valueToTest;\n}\n</code></pre>\n\n<p>I suspect that simply declaring newRepresentation as volatile would be enough, but I don't use the volatile keyword enough to be sure, so I've simply adapted the solution from your link. </p>\n\n<p>The nice thing about your original method is that it should work for pretty much anything supporting the right casts and operators, as long as you only care about whether you can come back to the initial type like this. For example, here is a generic implementation:</p>\n\n<pre><code>template&lt;typename T1, typename T2&gt;\nbool losslessRoundTrip(T1 valueToTest)\n{\n    T2 newRepresentation;\n    *((volatile T2 *)&amp;newRepresentation) = static_cast&lt;T2&gt;(valueToTest);\n    T1 roundTripValue = static_cast&lt;T1&gt;(newRepresentation);\n    return roundTripValue == valueToTest;\n}\n</code></pre>\n\n<p>Please note that this might not be the best answer for your question, because it still seems a cheat to check whether you can store it as a double by...storing it as a double. Still, I don't know how else to avoid relying on mechanics of the internal representation.</p>\n\n<p>It also doesn't <I>quite</I> check whether it was losslessly stored in the double, but rather whether the round-trip from int64_t to double, and back to an int64_t is lossless on that platform. I don't know whether it's possible for there to be casting errors that cancel out when casts are applied in both directions (I'll appeal to someone with more knowledge for that), but in my opinion, I usually consider it close enough to \"lossless\" if I can get the initial value back if I convert back to the same type.</p>\n"}], "owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 786, "favorite_count": 1, "accepted_answer_id": 42541830, "answer_count": 4, "score": 9, "last_activity_date": 1488789341, "creation_date": 1488400532, "last_edit_date": 1495542325, "question_id": 42541548, "link": "https://stackoverflow.com/questions/42541548/how-to-determine-if-a-given-int64-t-can-be-stored-losslessly-in-a-double", "title": "How to determine if a given int64_t can be stored losslessly in a double?", "body": "<p>I'd like to determine if a given 64-bit integer can be stored losslessly in a double. Right now I have this code:</p>\n\n<pre><code>static_cast&lt;int64_t&gt;(static_cast&lt;double&gt;(value)) == value\n</code></pre>\n\n<p>However, I believe this is not always accurate due to <a href=\"https://stackoverflow.com/questions/503436/how-to-deal-with-excess-precision-in-floating-point-computations\">excess precision</a> on some platforms.</p>\n\n<p>Note that I'm not asking for the <a href=\"https://stackoverflow.com/questions/1848700/biggest-integer-that-can-be-stored-in-a-double\">largest integer such that all smaller integers can be stored losslessly</a>, which is 2^53. I need to know if a given integer N is losslessly storeable even if N+1 and N-1 are not.</p>\n\n<p>Is there something in the standard library, maybe similar to <code>std::numeric_limits</code>, that will tell me this?</p>\n"}, {"tags": ["c++", "visual-c++", "vector", "binary"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1488401153, "post_id": 42541533, "comment_id": 72219126, "body": "My advice would be to use a single dimension vector, make it a member of a class, and use that class to fake the vector has two dimensions by overloading the <code>operator()</code>.  That should help to speed up the reading as you can read the whole file into a single vector."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1488401235, "post_id": 42541533, "comment_id": 72219175, "body": "Example of what @NathanOliver writes about (sans <code>vector</code>, but easily modified to use <code>vector</code>)."}, {"owner": {"reputation": 47, "user_id": 6799132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c35d3f0655307a1b19871d3555801cdf?s=128&d=identicon&r=PG&f=1", "display_name": "Ildon", "link": "https://stackoverflow.com/users/6799132/ildon"}, "edited": false, "score": 0, "creation_date": 1488402527, "post_id": 42541533, "comment_id": 72219948, "body": "Sry i don&#39;t get it..:( What i&#39;ve done now is that i stored all elements of the .bin File in a Vector called Elements. This Vector is part of an class with the Name Test. And How do i create now the 2dVector with overloading the operator() ? Do you have maybe a code example ? Sorry for my stupid Question but i never used overloading operators :/"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 6799132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c35d3f0655307a1b19871d3555801cdf?s=128&d=identicon&r=PG&f=1", "display_name": "Ildon", "link": "https://stackoverflow.com/users/6799132/ildon"}, "edited": false, "score": 0, "creation_date": 1488411819, "post_id": 42542916, "comment_id": 72224259, "body": "THX for your Help i really appreciate it. But i have another Question. With this Method i am creating a vector and pretending that it is a 2d Vector.... Because my Problem is that the main purpose of my code (end result) should be 6 different vectors. Every Vector is containing one column of the matrix from the binary File. and i&#39;m not sure if i&#39;ll get this with that method.. Do you maybe have also an idea how i could realize that... sorry for circumstances :/"}, {"owner": {"reputation": 47, "user_id": 6799132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c35d3f0655307a1b19871d3555801cdf?s=128&d=identicon&r=PG&f=1", "display_name": "Ildon", "link": "https://stackoverflow.com/users/6799132/ildon"}, "edited": false, "score": 0, "creation_date": 1488412934, "post_id": 42542916, "comment_id": 72224609, "body": "Maybe i explained wrong my Intention in the Question.. i created a new Question with better explanation. i didn&#39;t deleted this Question because the answer wasa good explanation and maybe someone else will need it"}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": true, "score": 1, "last_activity_date": 1488405554, "creation_date": 1488405554, "answer_id": 42542916, "question_id": 42541533, "link": "https://stackoverflow.com/questions/42541533/read-2d-vector-from-binary-file-c/42542916#42542916", "title": "Read 2D vector from binary File C++", "body": "<p>Suggestion: eliminate the copying by reading directly <a href=\"http://en.cppreference.com/w/cpp/container/vector/data\" rel=\"nofollow noreferrer\">into the <code>vector</code> with <code>std::vector::data</code></a> </p>\n\n<pre><code>ifstream file(\"C:\\\\XXX.bin\", ios::in | ios::binary | ios::ate);\nchar * buffer;\nlong size;\nfile.seekg(0, std::ios::end); \nsize = file.tellg();  \n//allocate a properly sized vector of doubles. Probably should test that size \n// is evenly divisible\nvector&lt;double&gt; buffer(size/sizeof(double));\n// read into the vector of doubles by lying and saying it's an array of char \nfile.read((char*)buffer.data(), size);\nfile.close();   \n</code></pre>\n\n<p>Note that the vector is 1D. Access to this vector requires a bit of math. You could </p>\n\n<pre><code>buffer[map2dto1d(row, column)];\n</code></pre>\n\n<p>where</p>\n\n<pre><code>size_t map2dto1d(size_t row, size_t column)\n{\n    return row * numberColumns + column;\n}\n</code></pre>\n\n<p>but you are better off wrapping the <code>vector</code> in a class that stores the row and column information along with a properly sized <code>vector</code> and forces the user to index correctly. </p>\n\n<p>Something like this:</p>\n\n<pre><code>class Matrix\n{\nprivate:\n    size_t rows, columns;\n    std::vector&lt;double&gt; matrix;\npublic:\n    // zero initialized matrix of row by column\n    Matrix(size_t numrows, size_t numcols):\n        rows(numrows), columns(numcols), matrix(rows * columns)\n    {\n         // can place file reading logic here, but make sure the file matches \n         // numrows * numcols when reading and throw an exception if it doesn't\n    }\n\n    // matrix of row by column using provided in vector. in will be \n    // consumed by this constructor \n    // make sure in is big enough to support rows * columns\n    Matrix(size_t numrows, size_t numcols, std::vector&lt;double&gt; &amp;&amp; in):\n        rows(numrows), columns(numcols), matrix(std::move(in))\n    {\n\n    }\n\n    double &amp; operator()(size_t row, size_t column)\n    {\n        // check bounds here if you care\n        return matrix[row * columns + column];\n    }\n\n    double operator()(size_t row, size_t column) const\n    {\n        // check bounds here if you care\n        return matrix[row * columns + column];\n    }\n\n    size_t getRows() const\n    {\n        return rows;\n    }\n    size_t getColumns() const\n    {\n        return columns;\n    }\n\n};\n// convenience function for printing matrix\nstd::ostream &amp; operator&lt;&lt;(std::ostream &amp;  out, const Matrix &amp; in)\n{\n    for (int i = 0; i &lt; in.getRows(); i++)\n    {\n        for (int j = 0; j &lt; in.getColumns(); j++)\n        {\n            out &lt;&lt; in(i,j) &lt;&lt; ' ';\n        }\n        out &lt;&lt; std::endl;\n    }\n\n    return out;\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6799132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c35d3f0655307a1b19871d3555801cdf?s=128&d=identicon&r=PG&f=1", "display_name": "Ildon", "link": "https://stackoverflow.com/users/6799132/ildon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "accepted_answer_id": 42542916, "answer_count": 1, "score": 0, "last_activity_date": 1488405554, "creation_date": 1488400465, "question_id": 42541533, "link": "https://stackoverflow.com/questions/42541533/read-2d-vector-from-binary-file-c", "title": "Read 2D vector from binary File C++", "body": "<p>i have some Problem reading a 2D Vector from a binary File: </p>\n\n<p>For Example: </p>\n\n<p>My Binary File is structured like this : </p>\n\n<pre><code>243524\n764756\n746384\n</code></pre>\n\n<p>Now i want to create a 2D Vector which looks exactly like the bin File.</p>\n\n<p>What i've done so Far:</p>\n\n<p>I created a 1D Vector which contains all Elements. Then i created a Loop and filled the 2D Vector.</p>\n\n<p>My Problem ist that i have a huge .bin File and the for loop cost a lot of Time. \nis there a possibility to get the 2DVector faster ? </p>\n\n<p>My Code :</p>\n\n<pre><code>ifstream file(\"C:\\\\XXX.bin\", ios::in | ios::binary | ios::ate);\nchar * buffer;\nlong size;\nfile.seekg(0, std::ios::end); \nsize = file.tellg();  \n\nbuffer = new char[size];\nfile.read(buffer, size);\nfile.close();   \n\n\ndouble* double_values = (double*)buffer;//reinterpret as doubles\nvector&lt;double&gt; buffer2(double_values, double_values + (size / sizeof(double)));\n\n//cout &lt;&lt; \"Filling matrix with test numbers.\";\nint h = 0;\nfor (int i = 0; i &lt; (size / sizeof(double)) / row; i++)\n{\n    vector&lt;double&gt; temp;\n    for (int j = 0; j &lt; row; j++)\n    {\n        if (h&lt;size / sizeof(double))\n        {\n            temp.push_back(buffer2[h]);\n            h++;\n        }\n\n    }\n\n    bin_file.push_back(temp);\n}\n</code></pre>\n\n<p>Hope that sb can Help me :)</p>\n"}, {"tags": ["c++", "static", "static-libraries"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1488400298, "post_id": 42541389, "comment_id": 72218660, "body": "Global variables are only guaranteed to be initialized before the first odr-use of an entity in its containing translation unit. If you never use the TU, you&#39;re not guaranteed to have globals initialized."}, {"owner": {"reputation": 542, "user_id": 2931220, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/MHW6g.png?s=128&g=1", "display_name": "Zyend", "link": "https://stackoverflow.com/users/2931220/zyend"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1488401774, "post_id": 42541389, "comment_id": 72219520, "body": "Ok. So I&#39;ve to find a workaround to &quot;properly&quot; force their initialization...good."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488411164, "post_id": 42541389, "comment_id": 72224028, "body": "What is the actual use case of this? I find it pretty in line with expectation that the mere linking to a static library doesn&#39;t have side effects. If I don&#39;t use something, I shouldn&#39;t have to pay for it, that&#39;s a design principle behind C and C++."}], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488400279, "post_id": 42541448, "comment_id": 72218653, "body": "You honor your nick, really! All my respect."}, {"owner": {"reputation": 542, "user_id": 2931220, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/MHW6g.png?s=128&g=1", "display_name": "Zyend", "link": "https://stackoverflow.com/users/2931220/zyend"}, "edited": false, "score": 0, "creation_date": 1488400546, "post_id": 42541448, "comment_id": 72218793, "body": "Thanks. Well...at first glance there&#39;s no &quot;clean&quot; solution to fix that issue. I&#39;m not a fan of #pragma statements as it would make the whole thing dirty as possible..."}, {"owner": {"reputation": 38726, "user_id": 301883, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/937b36681a56def2b41c438a00e12b46?s=128&d=identicon&r=PG", "display_name": "Edward Strange", "link": "https://stackoverflow.com/users/301883/edward-strange"}, "edited": false, "score": 0, "creation_date": 1488400687, "post_id": 42541448, "comment_id": 72218864, "body": "I defined some macros that basically allowed me to &quot;DECLARE_FILE(x)&quot; &quot;DEFINE_FILE(x)&quot; in the library header/cpp and then &quot;USE_FILE(x)&quot; in the main of my program.  These would create a static int that was externed and then in the main it would be assigned to.  This caused the translation unit to get included and thus the registration to happen.  Something like that anyway, don&#39;t recall specifically what I did."}, {"owner": {"reputation": 542, "user_id": 2931220, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/MHW6g.png?s=128&g=1", "display_name": "Zyend", "link": "https://stackoverflow.com/users/2931220/zyend"}, "edited": false, "score": 0, "creation_date": 1488400932, "post_id": 42541448, "comment_id": 72218998, "body": "Do you have a concrete example of a DECLAIRE_FILE and USE_FILE macros ?"}], "tags": [], "owner": {"reputation": 38726, "user_id": 301883, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/937b36681a56def2b41c438a00e12b46?s=128&d=identicon&r=PG", "display_name": "Edward Strange", "link": "https://stackoverflow.com/users/301883/edward-strange"}, "is_accepted": false, "score": 8, "last_activity_date": 1488400160, "last_edit_date": 1495541836, "creation_date": 1488400160, "answer_id": 42541448, "question_id": 42541389, "link": "https://stackoverflow.com/questions/42541389/c-static-class-member-not-initialized-in-a-static-library/42541448#42541448", "title": "C++ static class member not initialized in a * static library *", "body": "<p>You have to actually use A::_inner somehow or that part of code won't be included.  Either that or use something else in that file.  Linkers don't have to link in translation units that are never used, even if they'd have observable side effects.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/4383602/how-to-force-inclusion-of-unused-object-definitions-in-a-library\">How to force inclusion of &quot;unused&quot; object definitions in a library</a></p>\n"}], "owner": {"reputation": 542, "user_id": 2931220, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/MHW6g.png?s=128&g=1", "display_name": "Zyend", "link": "https://stackoverflow.com/users/2931220/zyend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1269, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1488400160, "creation_date": 1488399966, "question_id": 42541389, "link": "https://stackoverflow.com/questions/42541389/c-static-class-member-not-initialized-in-a-static-library", "title": "C++ static class member not initialized in a * static library *", "body": "<p>I'm currently facing an annoying issue with C++.</p>\n\n<p>Actually, I don't even understand why I didn't face it for the past 20 years :(</p>\n\n<p>In my current context, we heavily use c++ executables (mostly in Linux embedded systems) <strong>statically</strong> linked with our proprietary static libs.\nAnd we do use static libs for technical and optimization reasons.</p>\n\n<p>Over the past years, indeed, I used to create shared libs though...</p>\n\n<p>So I began to write some classes with static class members. Such as follow:</p>\n\n<pre><code>class Inner\n{\npublic:\n   Inner()\n   {\n     std::cout &lt;&lt; \"CTOR Inner\" &lt;&lt; std::endl;\n   }\n};\n\nclass A\n{\nstatic Inner _inner;\n\n...\n};\n\n// in the .cpp\n\nInner A::_inner;\n\n///////////////////////\n</code></pre>\n\n<p>Very basic use-case, isn't it ?</p>\n\n<p>But in my unit-tests, linked with the lib, I can't see the <code>std::cout</code> statement in the console.\nWhereas, if I move my class Inner and A into the executable source-code...it works fine.</p>\n\n<p>I'm sure it's a very basic issue and I realize I've never faced over the past years.\nIs it an issue related to the compilers ?\nPlease note that I tested both cases on Windows and Linux (Debian, Gcc 4.9).</p>\n\n<p>Any idea is welcome.</p>\n\n<p>Z.</p>\n"}, {"tags": ["python", "c++", "cython"], "comments": [{"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1488406195, "post_id": 42541211, "comment_id": 72221911, "body": "It&#39;s Cython getting confused (so it&#39;s giving you an internal error instead of a useful error message), but it&#39;s probably something you&#39;ve done. I&#39;d guess the problem is with <code>modelname</code> - try creating a <code>std::string</code> temporary variable. (That is a guess though)"}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1488444524, "post_id": 42541211, "comment_id": 72236404, "body": "Your code works for me on Cython 0.23.4 (which is a little old now) once I&#39;ve added the relevant standard library cimports. So I don&#39;t know what the issue is."}], "owner": {"reputation": 3478, "user_id": 839375, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e29d1f71d86b4fb3e5c328eff132c980?s=128&d=identicon&r=PG", "display_name": "Jzl5325", "link": "https://stackoverflow.com/users/839375/jzl5325"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488399418, "creation_date": 1488399418, "question_id": 42541211, "link": "https://stackoverflow.com/questions/42541211/cython-passing-classes-to-py-call-code-error", "title": "Cython Passing Classes to_py_call_code error", "body": "<p>I am attempting to wrap two C++ classes using cython 0.25.2 (conda-forge build).  Have them defined as:</p>\n\n<pre><code>cdef extern from \"Isd.h\" namespace \"csm\":\n    cdef cppclass CppIsd \"csm::Isd\":\n        Isd() except +\n\ncdef extern from \"MdisPlugin.h\":\n    cdef cppclass CppMdisPlugin \"MdisPlugin\":\n        MdisPlugin() except +\n        string getPluginName()\n        string getManufacturer()\n        string getReleaseDate()\n        string getCsmVersion\n        size_t getNumModels()\n        string getModelName(size_t modelIndex)\n        bool canModelBeConstructedFromISD(const CppIsd &amp;isd, const string &amp;modelname)\n        string convertISDToModelState(const CppIsd &amp;isd, const string &amp;modelname)\n</code></pre>\n\n<p>The Isd class is just a stub, exposed as:</p>\n\n<pre><code>cdef class Isd:\n    cdef unique_ptr[CppIsd] thisptr\n    def __init__(self):\n        self.thisptr.reset(new CppIsd())\n</code></pre>\n\n<p>The final 2 methods of the CppMdisPlugin are throwing the following:  AttributeError: 'ErrorType' object has no attribute 'to_py_call_code' (Line 12552 in ExprNodes.py).</p>\n\n<p>The minimal wrapper code is:</p>\n\n<pre><code>cdef class MdisPlugin:\n    cdef:\n        unique_ptr[CppMdisPlugin] thisptr\n\n    def __init__(self):\n        self.thisptr.reset(new CppMdisPlugin())\n\n    def from_isd(self, Isd isd, modelname):\n        return deref(self.thisptr).convertISDToModelState(deref(isd.thisptr), modelname)\n</code></pre>\n\n<p>Is the error being raised caused by a miss definition in the .pyx file or something happening internal to Cython?</p>\n"}, {"tags": ["c++", "string", "c++11", "c++14"], "comments": [{"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 2, "creation_date": 1488399652, "post_id": 42541210, "comment_id": 72218294, "body": "you can get an iterator to point to anywhere you want to use it as the end. Just do <code>std::advance(str.begin(), n)</code> and use that as the end."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 1, "creation_date": 1488402461, "post_id": 42541210, "comment_id": 72219909, "body": "What do you want to do with the resulting substring? And what should happen to the remainder of the string?"}, {"owner": {"reputation": 23, "user_id": 6875838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6047840a4fdeb309ce8d3b98a32e3497?s=128&d=identicon&r=PG", "display_name": "Kushal Agrawal", "link": "https://stackoverflow.com/users/6875838/kushal-agrawal"}, "reply_to_user": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1488430212, "post_id": 42541210, "comment_id": 72229673, "body": "@ChristianHackl I didn&#39;t need the remainder of the string, just needed the part before the end character."}, {"owner": {"reputation": 23, "user_id": 6875838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6047840a4fdeb309ce8d3b98a32e3497?s=128&d=identicon&r=PG", "display_name": "Kushal Agrawal", "link": "https://stackoverflow.com/users/6875838/kushal-agrawal"}, "reply_to_user": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1488430384, "post_id": 42541210, "comment_id": 72229741, "body": "@vu1p3n0x Another intuitive answer, thanks, but it would take linear time, just like all other suggestions :) And I&#39;m not even sure we can simply assign iterators to string::end which might be a const iterator."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1488472303, "post_id": 42541210, "comment_id": 72255796, "body": "@KushalAgrawal: What I meant is if you have considered memory consumption. A C string does not really become smaller if you set a character to null. The remainder still occupies memory until <code>free</code> is called on the first character&#39;s address. This may or may not be important for your current problem."}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1488472545, "post_id": 42541210, "comment_id": 72255975, "body": "@KushalAgrawal complexity for <code>std::advance</code> is constant if the iterator satisfies &quot;RandomAccessIterator&quot; which <code>std::string::iterator</code> does"}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1488474643, "post_id": 42541210, "comment_id": 72257461, "body": "Good question, but you accepted the wrong answer. Either Kerrek SB&#39;s or Nicol Bolas was the correct answer."}], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1488400221, "post_id": 42541258, "comment_id": 72218618, "body": "Mind you, that&#39;s <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/resize#Complexity\" rel=\"nofollow noreferrer\">documented as linear complexity too</a>; some implementations could choose to reallocate unconditionally (assuming you wish to reduce memory usage), others might only do so if the string shrinks below the reallocation threshold."}, {"owner": {"reputation": 23, "user_id": 6875838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6047840a4fdeb309ce8d3b98a32e3497?s=128&d=identicon&r=PG", "display_name": "Kushal Agrawal", "link": "https://stackoverflow.com/users/6875838/kushal-agrawal"}, "edited": false, "score": 0, "creation_date": 1488400463, "post_id": 42541258, "comment_id": 72218751, "body": "Well it still takes linear time, so it&#39;s not really much of an improvement over something like substr, but thanks for the quick answer :)"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1488401672, "post_id": 42541258, "comment_id": 72219451, "body": "Or you could use <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/erase\" rel=\"nofollow noreferrer\">std::basic_string::erase</a> (first version with default second argument), which has the same theoretical (and, afaik, practical) complexity."}, {"owner": {"reputation": 2933, "user_id": 6350858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfeae5d1ddef3ed5e81e88bdd30063f?s=128&d=identicon&r=PG&f=1", "display_name": "Ap31", "link": "https://stackoverflow.com/users/6350858/ap31"}, "edited": false, "score": 1, "creation_date": 1488401831, "post_id": 42541258, "comment_id": 72219556, "body": "<code>std::vector::resize</code> is guaranteed not to reallocate when resizing down (in order to preserve the iterators). Could it be the same holds for the <code>string</code>? In any case, <code>resize</code> should be amortized O(1)"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 2933, "user_id": 6350858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfeae5d1ddef3ed5e81e88bdd30063f?s=128&d=identicon&r=PG&f=1", "display_name": "Ap31", "link": "https://stackoverflow.com/users/6350858/ap31"}, "edited": false, "score": 0, "creation_date": 1488402099, "post_id": 42541258, "comment_id": 72219724, "body": "@Ap31:The standard does not impose the same requirement on <code>std::basic_string::resize</code>, and as far as I can see, the &quot;documentation&quot; referred to above is not drawn from the C++ standard."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 23, "user_id": 6875838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6047840a4fdeb309ce8d3b98a32e3497?s=128&d=identicon&r=PG", "display_name": "Kushal Agrawal", "link": "https://stackoverflow.com/users/6875838/kushal-agrawal"}, "edited": false, "score": 2, "creation_date": 1488406631, "post_id": 42541258, "comment_id": 72222114, "body": "@KushalAgrawal: Please show me <i>in the standard</i> where the complexity of <code>resize</code> is defined to be linear. I&#39;m being serious; I can&#39;t find <i>any</i> statement of its complexity. Cppreference is a great site, but like any secondary source, it is not authoritative."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488412460, "post_id": 42541258, "comment_id": 72224468, "body": "From <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4296.pdf\" rel=\"nofollow noreferrer\">C++14 working draft (Nov. 2014)</a> page 667: &quot;If n &lt;= size(), the function replaces the string designated by *this with a string of length n whose elements are a <b>copy</b> of the initial elements of the original string designated by *this&quot; (bold font added by me)... this could imply linear complexity."}, {"owner": {"reputation": 23, "user_id": 6875838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6047840a4fdeb309ce8d3b98a32e3497?s=128&d=identicon&r=PG", "display_name": "Kushal Agrawal", "link": "https://stackoverflow.com/users/6875838/kushal-agrawal"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1488430135, "post_id": 42541258, "comment_id": 72229644, "body": "@NicolBolas, it&#39;s linear in the size of the new string formed after resizing.  <a href=\"http://www.cplusplus.com/reference/string/string/resize/\" rel=\"nofollow noreferrer\">Here</a>&#39;s another source I use for c++ reference which states that resize takes linear time."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1488432408, "post_id": 42541258, "comment_id": 72230433, "body": "@zett42: Implication means nothing. The &quot;as if&quot; rule easily allows implementations to not copy anything and just move some pointers around and write a new NUL character. Unless the standard has a <i>direct statement</i> about the complexity requirement, the implementations can do anything they want, so long as they get the same results. Without a statement about complexity, then we must assume it is implementation-defined (and therefore likely to be reasonable)."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 23, "user_id": 6875838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6047840a4fdeb309ce8d3b98a32e3497?s=128&d=identicon&r=PG", "display_name": "Kushal Agrawal", "link": "https://stackoverflow.com/users/6875838/kushal-agrawal"}, "edited": false, "score": 0, "creation_date": 1488432425, "post_id": 42541258, "comment_id": 72230440, "body": "@KushalAgrawal: I asked for something <i>authoritative</i>, not another secondary source."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 1, "creation_date": 1488433111, "post_id": 42541258, "comment_id": 72230680, "body": "@NicolBolas <code>basic_string</code>&#39;s specification leaves a lot to be desired because it dates from the COW-era, where even a shrinking <code>resize</code> may well require a full allocation+copy. A full paper is probably needed to completely clean it up."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1488433423, "post_id": 42541258, "comment_id": 72230788, "body": "@T.C.: Technically, <code>vector::resize</code> <i>also</i> has no complexity specification. Anywhere. So such a paper should clean that up too."}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": true, "score": 5, "last_activity_date": 1488399571, "creation_date": 1488399571, "answer_id": 42541258, "question_id": 42541210, "link": "https://stackoverflow.com/questions/42541210/make-c-stdstring-end-at-specified-character/42541258#42541258", "title": "Make C++ std::string end at specified character?", "body": "<p>You can use <code>resize</code>:</p>\n\n<pre><code>std::string s = /* ... */;\n\nif (auto n = s.find(c); n != s.npos) {\n  s.resize(n);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 0, "last_activity_date": 1488399909, "last_edit_date": 1488399909, "creation_date": 1488399606, "answer_id": 42541275, "question_id": 42541210, "link": "https://stackoverflow.com/questions/42541210/make-c-stdstring-end-at-specified-character/42541275#42541275", "title": "Make C++ std::string end at specified character?", "body": "<blockquote>\n  <p>TL;DR, is there any \"end\" character for an std::string? Can I make the end iterator point to the current character somehow?</p>\n</blockquote>\n\n<p>Not really. <code>std::string</code> uses the <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/size\" rel=\"nofollow noreferrer\"><code>std::string::size()</code></a> function to keep track of the number of characters stored and maintained independently of any <em>sentinel characters</em> like <code>'\\0'</code>.</p>\n\n<p>Though these are considered when a <code>std::string</code> is initialized from a <code>const char*</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1488399616, "creation_date": 1488399616, "answer_id": 42541280, "question_id": 42541210, "link": "https://stackoverflow.com/questions/42541210/make-c-stdstring-end-at-specified-character/42541280#42541280", "title": "Make C++ std::string end at specified character?", "body": "<p><code>std::string</code> does not have an \"end character\" like c style strings.  You can have many null terminators inside a single <code>std::string</code>.  If you want to the string to end after a certain character then you need to <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/erase\" rel=\"nofollow noreferrer\"><code>erase</code></a> the rest of the characters in the string after that last character.</p>\n\n<p>In your case that would give you something like</p>\n\n<pre><code>string_variable.erase(pos_of_last_character + 1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6875838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6047840a4fdeb309ce8d3b98a32e3497?s=128&d=identicon&r=PG", "display_name": "Kushal Agrawal", "link": "https://stackoverflow.com/users/6875838/kushal-agrawal"}, "edited": false, "score": 0, "creation_date": 1488400516, "post_id": 42541423, "comment_id": 72218777, "body": "Thanks for the quick and very detailed answer :)"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1488400778, "post_id": 42541423, "comment_id": 72218913, "body": "You could simplify the code to just <code>auto end = std::find(str.begin(), str.end(), &#39;r&#39;);</code> so you get either an iterator pointing to the first <code>&#39;r&#39;</code> or the original <code>end</code> iterator (using <code>std::find</code> instead of <code>string.find</code> means you don&#39;t even need to check return values). Still has to do the same work, so if you are processing as you go the explicit loop avoids iterating twice (once to find stop point, once to do work), but if you need to use the computed <code>end</code> many times, this simplifies matters, and the code is easier to read either way."}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1488465728, "post_id": 42541423, "comment_id": 72251052, "body": "How do you imagine c_str not being usable as a C string?"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "reply_to_user": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1488472560, "post_id": 42541423, "comment_id": 72255982, "body": "@Cubbi: It would only be usable for C functions which take a pointer and a size argument. It would not be usable for something like <code>strlen</code>, which expects to encounter <code>&#39;\\0&#39;</code> at a valid address."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1488472870, "post_id": 42541423, "comment_id": 72256234, "body": "@Cubbi, from <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/c_str\" rel=\"nofollow noreferrer\"><code>std::string::c_str()</code> documentation</a>. * <code>c_str()</code> and <code>data()</code> perform the same function.&quot; From <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/data\" rel=\"nofollow noreferrer\"><code>std::string::data()</code> documentation</a>: <i>The returned array is not required to be null-terminated.</i>. That&#39;s what a user has to deal with when a <code>std::string</code> does not have a null character in it."}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 2, "creation_date": 1488473606, "post_id": 42541423, "comment_id": 72256742, "body": "The returned array is absolutely required to be null-terminated. Pay attention to &quot;before C++11&quot; and &quot;since C++11&quot; tags on both pages. c_str is always null-terminated, data is null-terminated as of C++11"}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1488474414, "post_id": 42541423, "comment_id": 72257299, "body": "Latest edit is stil wrong, c_str() was always required to be null-terminated. Before and after C++11. It was data() that changed spec."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1488474999, "post_id": 42541423, "comment_id": 72257683, "body": "@Cubbi. I see the difference now."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1488474970, "last_edit_date": 1488474970, "creation_date": 1488400103, "answer_id": 42541423, "question_id": 42541210, "link": "https://stackoverflow.com/questions/42541210/make-c-stdstring-end-at-specified-character/42541423#42541423", "title": "Make C++ std::string end at specified character?", "body": "<blockquote>\n  <p>is there any \"end\" character for an std::string? </p>\n</blockquote>\n\n<p>No. It is possible to define a <code>std::string</code> that is not null terminated. You won't be able to do a few things for such strings, such as treat the return value of <code>std::string:data()</code> as a null terminated C string <sup>1</sup>, but a <code>std::string</code> can be constructed that way.</p>\n\n<blockquote>\n  <p>Can I make the end iterator point to the current character somehow?</p>\n</blockquote>\n\n<p>To get a <code>std::string::iterator</code> point to a certain character, you'll have to traverse the string.</p>\n\n<p>E.g.</p>\n\n<pre><code>std::string str = \"This is a string\";\nauto iter = str.begin();\nauto end = iter;\nwhile ( end != str.end() &amp;&amp; *end != 'r' )\n   ++end; \n</code></pre>\n\n<p>After that, the range defined by <code>iter</code> and <code>end</code> contains the string <code>\"This is a st\"</code>.</p>\n\n<p>If that is not acceptable, you'll have to adapt your code to check the value of the character for every step.</p>\n\n<pre><code>std::string str = \"This is a string\";\nauto iter = str.begin();\n\n// Break when 'r' is encountered or end of string is reached.\nwhile ( iter != str.end() &amp;&amp; *iter != 'r' )\n{\n   // Use *iter\n   ...\n}\n</code></pre>\n\n<p><sup>1</sup> Thanks are due to @Cubbi for pointing out an error in what I stated. <code>std::string::data()</code> can return a <code>char const*</code> that is not null terminated if using a version of C++ earlier than C++11. If using C++11 or later, <code>std::string::data()</code> is required to return a null terminated <code>char const*</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1488466458, "post_id": 42547905, "comment_id": 72251593, "body": "&quot;are standard library implementations written by complete morons?&quot; For the longest time, <code>&lt;regex&gt;</code> on gcc&#39;s default standard library was evidence of &quot;yes, some of it was written by complete morons&quot;.  ;)"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1488471186, "post_id": 42547905, "comment_id": 72255027, "body": "@T.C.: BTW, is that &quot;timsong-cpp&quot; GitHub page officially where issues are stored now, or is it just a 3rd party listing?"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 2, "creation_date": 1488471402, "post_id": 42547905, "comment_id": 72255172, "body": "@NicolBolas That&#39;s my site :) (because I hate linking to a massive page for a single issue)"}], "tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 3, "last_activity_date": 1488434439, "creation_date": 1488434439, "answer_id": 42547905, "question_id": 42541210, "link": "https://stackoverflow.com/questions/42541210/make-c-stdstring-end-at-specified-character/42547905#42547905", "title": "Make C++ std::string end at specified character?", "body": "<p>The logical answer here is <code>basic_string::resize</code>. What the <em>standard</em> says about this function is:</p>\n\n<blockquote>\n  <p>Effects: Alters the length of the string designated by <code>*this</code> as follows:</p>\n  \n  <ul>\n  <li>If <code>n &lt;= size()</code>, the function replaces the string designated by <code>*this</code> with a string of length <code>n</code> whose elements are a copy of the initial elements of the original string designated by <code>*this</code>.</li>\n  <li>If <code>n &gt; size()</code>, the function replaces the string designated by <code>*this</code> with a string of length <code>n</code> whose first <code>size()</code> elements are a copy of the original string designated by <code>*this</code>, and whose remaining elements are all initialized to <code>c</code>.</li>\n  </ul>\n</blockquote>\n\n<p>Now, that looks very much like linear time. However, the standard does not specifically state that things will happen this way. They only state that it will be \"as if\" things happen this way. Therefore, an implementation is completely free to implement the shrinking version of <code>resize</code> by shifting one pointer and writing a NUL character. Nothing in the standard would forbid such an implementation.</p>\n\n<p>So the real question is... are standard library implementations written by complete morons? It's certainly possible that they are. But it's probably wise not to assume so.</p>\n\n<p>Personally, I'd just use <code>resize</code> on the assumption that the library implementers know what they're doing. After all, if they can't write an optimization as simple as that, then who knows what other things they're doing wrong? If you can't trust your standard library implementation not to do stupid things, then you shouldn't be using it in performance-critical code.</p>\n"}], "owner": {"reputation": 23, "user_id": 6875838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6047840a4fdeb309ce8d3b98a32e3497?s=128&d=identicon&r=PG", "display_name": "Kushal Agrawal", "link": "https://stackoverflow.com/users/6875838/kushal-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1245, "favorite_count": 0, "accepted_answer_id": 42541258, "answer_count": 5, "score": 2, "last_activity_date": 1488474970, "creation_date": 1488399407, "question_id": 42541210, "link": "https://stackoverflow.com/questions/42541210/make-c-stdstring-end-at-specified-character", "title": "Make C++ std::string end at specified character?", "body": "<p>Let's say I am traversing a string of length n. I want it to end at a specific character that fulfils some conditions. I know that <strong>C style strings</strong> can be terminated at the <strong>i'th</strong> position by simply assigning the character <strong>'\\0'</strong> at position <strong>i</strong> in the character array.</p>\n\n<p>Is there any way to achieve the same result in an <strong>std::string</strong> (C++ style string)? I can think of substr, erase, etc. but all of them are linear in their complexity, which I cannot afford to use.</p>\n\n<p>TL;DR, is there any \"end\" character for an std::string? Can I make the end iterator point to the current character somehow? </p>\n"}, {"tags": ["c++", "c++14", "template-meta-programming", "boost-hana"], "comments": [{"owner": {"reputation": 1567, "user_id": 800347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Buq1.jpg?s=128&g=1", "display_name": "Jason Rice", "link": "https://stackoverflow.com/users/800347/jason-rice"}, "edited": false, "score": 0, "creation_date": 1488701218, "post_id": 42541148, "comment_id": 72341741, "body": "made an issue related to this <a href=\"https://github.com/boostorg/hana/issues/324\" rel=\"nofollow noreferrer\">github.com/boostorg/hana/issues/324</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4954, "user_id": 893819, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2wHm8.jpg?s=128&g=1", "display_name": "odinthenerd", "link": "https://stackoverflow.com/users/893819/odinthenerd"}, "edited": false, "score": 0, "creation_date": 1488449178, "post_id": 42544408, "comment_id": 72239626, "body": "thanks for the hana::sort then hana::group idea will benchmark"}, {"owner": {"reputation": 4954, "user_id": 893819, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2wHm8.jpg?s=128&g=1", "display_name": "odinthenerd", "link": "https://stackoverflow.com/users/893819/odinthenerd"}, "edited": false, "score": 0, "creation_date": 1488450838, "post_id": 42544408, "comment_id": 72240771, "body": "how does this relate to the speed of tuple_t (which I should be using here I think)?"}, {"owner": {"reputation": 1567, "user_id": 800347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Buq1.jpg?s=128&g=1", "display_name": "Jason Rice", "link": "https://stackoverflow.com/users/800347/jason-rice"}, "reply_to_user": {"reputation": 4954, "user_id": 893819, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2wHm8.jpg?s=128&g=1", "display_name": "odinthenerd", "link": "https://stackoverflow.com/users/893819/odinthenerd"}, "edited": false, "score": 0, "creation_date": 1488472843, "post_id": 42544408, "comment_id": 72256216, "body": "<code>tuple_t</code> is just a convenience that makes a tuple of <code>hana::type</code> wrapped <code>T</code>s. If <code>transition</code> has no state then I would suggest avoiding the additional template instantiation by not wrapping it in <code>hana::type</code>. See <code>hana::experimental::types</code>."}, {"owner": {"reputation": 2976, "user_id": 627587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b7225df5b0728daa170646a5c5a4bfda?s=128&d=identicon&r=PG", "display_name": "Louis Dionne", "link": "https://stackoverflow.com/users/627587/louis-dionne"}, "edited": false, "score": 0, "creation_date": 1488475647, "post_id": 42544408, "comment_id": 72258094, "body": "Can you post a gist to your implementation w/ this representation?"}], "tags": [], "owner": {"reputation": 1567, "user_id": 800347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Buq1.jpg?s=128&g=1", "display_name": "Jason Rice", "link": "https://stackoverflow.com/users/800347/jason-rice"}, "is_accepted": true, "score": 3, "last_activity_date": 1488506707, "last_edit_date": 1488506707, "creation_date": 1488412592, "answer_id": 42544408, "question_id": 42541148, "link": "https://stackoverflow.com/questions/42541148/how-do-i-speed-up-many-different-hanafilters-on-the-same-input-data/42544408#42544408", "title": "how do I speed up many different hana::filters on the same input data?", "body": "<p>If all of your values will have no run-time state (ie <code>hana::type</code>) then one large piece of low hanging fruit would be to use an empty representation of a tuple.</p>\n\n<pre><code>template &lt;typename ...Xs&gt;\nstruct ding_bat_tuple { };\n</code></pre>\n\n<p><code>hana::tuple</code> has to support run-time values and it has several gnarly constructors that make instantiating it an expensive operation.</p>\n\n<p>The cool thing is that you can specialize a few Hana functions for your empty tuple to make it a <code>hana::Sequence</code> getting its corresponding functions for free (like <code>hana::filter</code>)</p>\n\n<p>Here is an example:\n<a href=\"https://github.com/ricejasonf/nbdl/blob/master/include/mpdef/list.hpp\" rel=\"nofollow noreferrer\">https://github.com/ricejasonf/nbdl/blob/master/include/mpdef/list.hpp</a></p>\n\n<p>Also, if the size of <code>types</code> is small, you could use <code>hana::sort</code> then <code>hana::group</code> which might be faster for that use case.</p>\n\n<h3>Update</h3>\n\n<p>I made a benchmark of the \"group by\" algorithm using metabench with both tuple representations. The empty tuple is faster, but honestly I was expecting the difference to be more staggering. Note that 20 is really 200 elements in the tuple.\n<a href=\"https://i.stack.imgur.com/f5iPJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f5iPJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the gist of the benchmark source code:</p>\n\n<p><a href=\"https://gist.github.com/ricejasonf/c9cfea01876b58d5778abcd934b14484\" rel=\"nofollow noreferrer\">https://gist.github.com/ricejasonf/c9cfea01876b58d5778abcd934b14484</a></p>\n"}], "owner": {"reputation": 4954, "user_id": 893819, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2wHm8.jpg?s=128&g=1", "display_name": "odinthenerd", "link": "https://stackoverflow.com/users/893819/odinthenerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 42544408, "answer_count": 1, "score": 2, "last_activity_date": 1488506707, "creation_date": 1488399189, "question_id": 42541148, "link": "https://stackoverflow.com/questions/42541148/how-do-i-speed-up-many-different-hanafilters-on-the-same-input-data", "title": "how do I speed up many different hana::filters on the same input data?", "body": "<p>Sorry for my minimal example being quite big. This is a working hana algorithm that essentially filters the transitions of 8 different states out of a big tuple of all the transitions. </p>\n\n<p>Although it works it is a bit slow especially since I actually need filter each of like 200 states rather than 8. How can I make it faster?</p>\n\n<pre><code>template&lt;int I, int J, typename T&gt;  //dummy representation of a transition\nstruct transition {\n    static constexpr int source = I;\n    static constexpr int dest = J;\n};\n\ntemplate&lt;int I&gt;  //just to save typing in my test\nauto m() {\n    return hana::type_c&lt;transition&lt;I,99,void&gt;&gt;;\n}\n\n//big test data\nauto types = hana::make_tuple(m&lt;1&gt;(), m&lt;2&gt;(), m&lt;3&gt;(), m&lt;4&gt;(), m&lt;5&gt;(), m&lt;6&gt;(), m&lt;7&gt;(), m&lt;8&gt;(), m&lt;9&gt;(), m&lt;10&gt;(), m&lt;11&gt;(), m&lt;12&gt;(), m&lt;13&gt;(), m&lt;14&gt;(), m&lt;15&gt;(), m&lt;16&gt;(), m&lt;17&gt;(), m&lt;18&gt;(), m&lt;19&gt;(), m&lt;20&gt;(), m&lt;21&gt;(), m&lt;22&gt;(), m&lt;23&gt;(), m&lt;24&gt;(), m&lt;25&gt;(), m&lt;26&gt;(), m&lt;27&gt;(), m&lt;28&gt;(), m&lt;29&gt;(), m&lt;30&gt;(), m&lt;31&gt;(), m&lt;32&gt;(), m&lt;33&gt;(), m&lt;34&gt;(), m&lt;35&gt;(), m&lt;36&gt;(), m&lt;37&gt;(), m&lt;38&gt;(), m&lt;39&gt;(), m&lt;40&gt;(), m&lt;41&gt;(), m&lt;42&gt;(), m&lt;43&gt;(), m&lt;44&gt;(), m&lt;45&gt;(), m&lt;46&gt;(), m&lt;47&gt;(), m&lt;48&gt;(), m&lt;49&gt;(), m&lt;50&gt;(), m&lt;51&gt;(), m&lt;52&gt;(), m&lt;53&gt;(), m&lt;54&gt;(), m&lt;55&gt;(), m&lt;56&gt;(), m&lt;57&gt;(), m&lt;58&gt;(), m&lt;59&gt;(), m&lt;60&gt;(), m&lt;61&gt;(), m&lt;62&gt;(), m&lt;63&gt;(), m&lt;64&gt;(), m&lt;65&gt;(), m&lt;66&gt;(), m&lt;67&gt;(), m&lt;68&gt;(), m&lt;69&gt;(), m&lt;70&gt;(), m&lt;71&gt;(), m&lt;72&gt;(), m&lt;73&gt;(), m&lt;74&gt;(), m&lt;75&gt;(), m&lt;76&gt;(), m&lt;77&gt;(), m&lt;78&gt;(), m&lt;79&gt;(), m&lt;80&gt;(), m&lt;81&gt;(), m&lt;82&gt;(), m&lt;83&gt;(), m&lt;84&gt;(), m&lt;85&gt;(), m&lt;86&gt;(), m&lt;87&gt;(), m&lt;88&gt;(), m&lt;89&gt;(), m&lt;90&gt;(), m&lt;91&gt;(), m&lt;92&gt;(), m&lt;93&gt;(), m&lt;94&gt;(), m&lt;95&gt;(), m&lt;96&gt;(), m&lt;97&gt;(), m&lt;98&gt;(), m&lt;99&gt;(), m&lt;100&gt;(), m&lt;101&gt;(), m&lt;102&gt;(), m&lt;103&gt;(), m&lt;104&gt;(), m&lt;105&gt;(), m&lt;106&gt;(), m&lt;107&gt;(), m&lt;108&gt;(), m&lt;109&gt;(), m&lt;110&gt;(), m&lt;111&gt;(), m&lt;112&gt;(), m&lt;113&gt;(), m&lt;114&gt;(), m&lt;115&gt;(), m&lt;116&gt;(), m&lt;117&gt;(), m&lt;118&gt;(), m&lt;119&gt;(), m&lt;120&gt;(), m&lt;121&gt;(), m&lt;122&gt;(), m&lt;123&gt;(), m&lt;124&gt;(), m&lt;125&gt;(), m&lt;126&gt;(), m&lt;127&gt;(), m&lt;128&gt;(), m&lt;129&gt;(), m&lt;130&gt;(), m&lt;131&gt;(), m&lt;132&gt;(), m&lt;133&gt;(), m&lt;134&gt;(), m&lt;135&gt;(), m&lt;136&gt;(), m&lt;137&gt;(), m&lt;138&gt;(), m&lt;139&gt;(), m&lt;140&gt;(), m&lt;141&gt;(), m&lt;142&gt;(), m&lt;143&gt;(), m&lt;144&gt;(), m&lt;145&gt;(), m&lt;146&gt;(), m&lt;147&gt;(), m&lt;148&gt;(), m&lt;149&gt;(), m&lt;150&gt;(), m&lt;151&gt;(), m&lt;152&gt;(), m&lt;153&gt;(), m&lt;154&gt;(), m&lt;155&gt;(), m&lt;156&gt;(), m&lt;157&gt;(), m&lt;158&gt;(), m&lt;159&gt;(), m&lt;160&gt;(), m&lt;161&gt;(), m&lt;162&gt;(), m&lt;163&gt;(), m&lt;164&gt;(), m&lt;165&gt;(), m&lt;166&gt;(), m&lt;167&gt;(), m&lt;168&gt;(), m&lt;169&gt;(), m&lt;170&gt;(), m&lt;171&gt;(), m&lt;172&gt;(), m&lt;173&gt;(), m&lt;174&gt;(), m&lt;175&gt;(), m&lt;176&gt;(), m&lt;177&gt;(), m&lt;178&gt;(), m&lt;179&gt;(), m&lt;180&gt;(), m&lt;181&gt;(), m&lt;182&gt;(), m&lt;183&gt;(), m&lt;184&gt;(), m&lt;185&gt;(), m&lt;186&gt;(), m&lt;187&gt;(), m&lt;188&gt;(), m&lt;189&gt;(), m&lt;190&gt;(), m&lt;191&gt;(), m&lt;192&gt;(), m&lt;193&gt;(), m&lt;194&gt;(), m&lt;195&gt;(), m&lt;196&gt;(), m&lt;197&gt;(), m&lt;198&gt;(), m&lt;199&gt;(), m&lt;200&gt;(), m&lt;201&gt;(), m&lt;202&gt;(), m&lt;203&gt;(), m&lt;204&gt;(), m&lt;205&gt;(), m&lt;206&gt;(), m&lt;207&gt;(), m&lt;208&gt;(), m&lt;209&gt;(), m&lt;210&gt;(), m&lt;211&gt;(), m&lt;212&gt;(), m&lt;213&gt;(), m&lt;214&gt;(), m&lt;215&gt;(), m&lt;216&gt;(), m&lt;217&gt;(), m&lt;218&gt;(), m&lt;219&gt;(), m&lt;220&gt;(), m&lt;221&gt;(), m&lt;222&gt;(), m&lt;223&gt;(), m&lt;224&gt;(), m&lt;225&gt;(), m&lt;226&gt;(), m&lt;227&gt;(), m&lt;228&gt;(), m&lt;229&gt;(), m&lt;230&gt;(), m&lt;231&gt;(), m&lt;232&gt;(), m&lt;233&gt;(), m&lt;234&gt;(), m&lt;235&gt;(), m&lt;236&gt;(), m&lt;237&gt;(), m&lt;238&gt;(), m&lt;239&gt;(), m&lt;240&gt;(), m&lt;241&gt;(), m&lt;242&gt;(), m&lt;243&gt;(), m&lt;244&gt;(), m&lt;245&gt;(), m&lt;246&gt;(), m&lt;247&gt;(), m&lt;248&gt;(), m&lt;249&gt;(), m&lt;250&gt;(), m&lt;251&gt;(), m&lt;252&gt;(), m&lt;253&gt;(), m&lt;254&gt;(), m&lt;255&gt;(), m&lt;256&gt;(), m&lt;257&gt;(), m&lt;258&gt;(), m&lt;259&gt;(), m&lt;260&gt;(), m&lt;261&gt;(), m&lt;262&gt;(), m&lt;263&gt;(), m&lt;264&gt;(), m&lt;265&gt;(), m&lt;266&gt;(), m&lt;267&gt;(), m&lt;268&gt;(), m&lt;269&gt;(), m&lt;270&gt;(), m&lt;271&gt;(), m&lt;272&gt;(), m&lt;273&gt;(), m&lt;274&gt;(), m&lt;275&gt;(), m&lt;276&gt;(), m&lt;277&gt;(), m&lt;278&gt;(), m&lt;279&gt;(), m&lt;280&gt;(), m&lt;281&gt;(), m&lt;282&gt;(), m&lt;283&gt;(), m&lt;284&gt;(), m&lt;285&gt;(), m&lt;286&gt;(), m&lt;287&gt;(), m&lt;288&gt;(), m&lt;289&gt;(), m&lt;290&gt;(), m&lt;291&gt;(), m&lt;292&gt;(), m&lt;293&gt;(), m&lt;294&gt;(), m&lt;295&gt;(), m&lt;296&gt;(), m&lt;297&gt;(), m&lt;298&gt;(), m&lt;299&gt;(), m&lt;300&gt;(), m&lt;301&gt;(), m&lt;302&gt;(), m&lt;303&gt;(), m&lt;304&gt;(), m&lt;305&gt;(), m&lt;306&gt;(), m&lt;307&gt;(), m&lt;308&gt;(), m&lt;309&gt;(), m&lt;310&gt;(), m&lt;311&gt;(), m&lt;312&gt;(), m&lt;313&gt;(), m&lt;314&gt;(), m&lt;315&gt;(), m&lt;316&gt;(), m&lt;317&gt;(), m&lt;318&gt;(), m&lt;319&gt;(), m&lt;320&gt;(), m&lt;321&gt;(), m&lt;322&gt;(), m&lt;323&gt;(), m&lt;324&gt;(), m&lt;325&gt;(), m&lt;326&gt;(), m&lt;327&gt;(), m&lt;328&gt;(), m&lt;329&gt;(), m&lt;330&gt;(), m&lt;331&gt;(), m&lt;332&gt;(), m&lt;333&gt;(), m&lt;334&gt;(), m&lt;335&gt;(), m&lt;336&gt;(), m&lt;337&gt;(), m&lt;338&gt;(), m&lt;339&gt;(), m&lt;340&gt;(), m&lt;341&gt;(), m&lt;342&gt;(), m&lt;343&gt;(), m&lt;344&gt;(), m&lt;345&gt;(), m&lt;346&gt;(), m&lt;347&gt;(), m&lt;348&gt;(), m&lt;349&gt;(), m&lt;350&gt;(), m&lt;351&gt;(), m&lt;352&gt;(), m&lt;353&gt;(), m&lt;354&gt;(), m&lt;355&gt;(), m&lt;356&gt;(), m&lt;357&gt;(), m&lt;358&gt;(), m&lt;359&gt;(), m&lt;360&gt;(), m&lt;361&gt;(), m&lt;362&gt;(), m&lt;363&gt;(), m&lt;364&gt;(), m&lt;365&gt;(), m&lt;366&gt;(), m&lt;367&gt;(), m&lt;368&gt;(), m&lt;369&gt;(), m&lt;370&gt;(), m&lt;371&gt;(), m&lt;372&gt;(), m&lt;373&gt;(), m&lt;374&gt;(), m&lt;375&gt;(), m&lt;376&gt;(), m&lt;377&gt;(), m&lt;378&gt;(), m&lt;379&gt;(), m&lt;380&gt;(), m&lt;381&gt;(), m&lt;382&gt;(), m&lt;383&gt;(), m&lt;384&gt;(), m&lt;385&gt;(), m&lt;386&gt;(), m&lt;387&gt;(), m&lt;388&gt;(), m&lt;389&gt;(), m&lt;390&gt;(), m&lt;391&gt;(), m&lt;392&gt;(), m&lt;393&gt;(), m&lt;394&gt;(), m&lt;395&gt;(), m&lt;396&gt;(), m&lt;397&gt;(), m&lt;398&gt;(), m&lt;399&gt;(), m&lt;400&gt;(), m&lt;401&gt;(), m&lt;402&gt;(), m&lt;403&gt;(), m&lt;404&gt;(), m&lt;405&gt;(), m&lt;406&gt;(), m&lt;407&gt;(), m&lt;408&gt;(), m&lt;409&gt;(), m&lt;410&gt;(), m&lt;411&gt;(), m&lt;412&gt;(), m&lt;413&gt;(), m&lt;414&gt;(), m&lt;415&gt;(), m&lt;416&gt;(), m&lt;417&gt;(), m&lt;418&gt;(), m&lt;419&gt;(), m&lt;420&gt;(), m&lt;421&gt;(), m&lt;422&gt;(), m&lt;423&gt;(), m&lt;424&gt;(), m&lt;425&gt;(), m&lt;426&gt;(), m&lt;427&gt;(), m&lt;428&gt;(), m&lt;429&gt;(), m&lt;430&gt;(), m&lt;431&gt;(), m&lt;432&gt;(), m&lt;433&gt;(), m&lt;434&gt;(), m&lt;435&gt;(), m&lt;436&gt;(), m&lt;437&gt;(), m&lt;438&gt;(), m&lt;439&gt;(), m&lt;440&gt;(), m&lt;441&gt;(), m&lt;442&gt;(), m&lt;443&gt;(), m&lt;444&gt;(), m&lt;445&gt;(), m&lt;446&gt;(), m&lt;447&gt;(), m&lt;448&gt;(), m&lt;449&gt;(), m&lt;450&gt;(), m&lt;451&gt;(), m&lt;452&gt;(), m&lt;453&gt;(), m&lt;454&gt;(), m&lt;455&gt;(), m&lt;456&gt;(), m&lt;457&gt;(), m&lt;458&gt;(), m&lt;459&gt;(), m&lt;460&gt;(), m&lt;461&gt;(), m&lt;462&gt;(), m&lt;463&gt;(), m&lt;464&gt;(), m&lt;465&gt;(), m&lt;466&gt;(), m&lt;467&gt;(), m&lt;468&gt;(), m&lt;469&gt;(), m&lt;470&gt;(), m&lt;471&gt;(), m&lt;472&gt;(), m&lt;473&gt;(), m&lt;474&gt;(), m&lt;475&gt;(), m&lt;476&gt;(), m&lt;477&gt;(), m&lt;478&gt;(), m&lt;479&gt;(), m&lt;480&gt;(), m&lt;481&gt;(), m&lt;482&gt;(), m&lt;483&gt;(), m&lt;484&gt;(), m&lt;485&gt;(), m&lt;486&gt;(), m&lt;487&gt;(), m&lt;488&gt;(), m&lt;489&gt;(), m&lt;490&gt;(), m&lt;491&gt;(), m&lt;492&gt;(), m&lt;493&gt;(), m&lt;494&gt;(), m&lt;495&gt;(), m&lt;496&gt;(), m&lt;497&gt;(), m&lt;498&gt;(), m&lt;499&gt;(), m&lt;500&gt;(), m&lt;501&gt;(), m&lt;502&gt;(), m&lt;503&gt;(), m&lt;504&gt;(), m&lt;505&gt;(), m&lt;506&gt;(), m&lt;507&gt;(), m&lt;508&gt;(), m&lt;509&gt;(), m&lt;510&gt;(), m&lt;511&gt;(), m&lt;512&gt;(), m&lt;513&gt;(), m&lt;514&gt;(), m&lt;515&gt;(), m&lt;516&gt;(), m&lt;517&gt;(), m&lt;518&gt;(), m&lt;519&gt;(), m&lt;520&gt;(), m&lt;521&gt;(), m&lt;522&gt;(), m&lt;523&gt;(), m&lt;524&gt;(), m&lt;525&gt;(), m&lt;526&gt;(), m&lt;527&gt;(), m&lt;528&gt;(), m&lt;529&gt;(), m&lt;530&gt;(), m&lt;531&gt;(), m&lt;532&gt;(), m&lt;533&gt;(), m&lt;534&gt;(), m&lt;535&gt;(), m&lt;536&gt;(), m&lt;537&gt;(), m&lt;538&gt;(), m&lt;539&gt;(), m&lt;540&gt;(), m&lt;541&gt;(), m&lt;542&gt;(), m&lt;543&gt;(), m&lt;544&gt;(), m&lt;545&gt;(), m&lt;546&gt;(), m&lt;547&gt;(), m&lt;548&gt;(), m&lt;549&gt;(), m&lt;550&gt;(), m&lt;551&gt;(), m&lt;552&gt;(), m&lt;553&gt;(), m&lt;554&gt;(), m&lt;555&gt;(), m&lt;556&gt;(), m&lt;557&gt;(), m&lt;558&gt;(), m&lt;559&gt;(), m&lt;560&gt;(), m&lt;561&gt;(), m&lt;562&gt;(), m&lt;563&gt;(), m&lt;564&gt;(), m&lt;565&gt;(), m&lt;566&gt;(), m&lt;567&gt;(), m&lt;568&gt;(), m&lt;569&gt;(), m&lt;570&gt;(), m&lt;571&gt;(), m&lt;572&gt;(), m&lt;573&gt;(), m&lt;574&gt;(), m&lt;575&gt;(), m&lt;576&gt;(), m&lt;577&gt;(), m&lt;578&gt;(), m&lt;579&gt;(), m&lt;580&gt;(), m&lt;581&gt;(), m&lt;582&gt;(), m&lt;583&gt;(), m&lt;584&gt;(), m&lt;585&gt;(), m&lt;586&gt;(), m&lt;587&gt;(), m&lt;588&gt;(), m&lt;589&gt;(), m&lt;590&gt;(), m&lt;591&gt;(), m&lt;592&gt;(), m&lt;593&gt;(), m&lt;594&gt;(), m&lt;595&gt;(), m&lt;596&gt;(), m&lt;597&gt;(), m&lt;598&gt;(), m&lt;599&gt;(), m&lt;600&gt;(), m&lt;601&gt;(), m&lt;602&gt;(), m&lt;603&gt;(), m&lt;604&gt;(), m&lt;605&gt;(), m&lt;606&gt;(), m&lt;607&gt;(), m&lt;608&gt;(), m&lt;609&gt;(), m&lt;610&gt;(), m&lt;611&gt;(), m&lt;612&gt;(), m&lt;613&gt;(), m&lt;614&gt;(), m&lt;615&gt;(), m&lt;616&gt;(), m&lt;617&gt;(), m&lt;618&gt;(), m&lt;619&gt;(), m&lt;620&gt;(), m&lt;621&gt;(), m&lt;622&gt;(), m&lt;623&gt;(), m&lt;624&gt;(), m&lt;625&gt;(), m&lt;626&gt;(), m&lt;627&gt;(), m&lt;628&gt;(), m&lt;629&gt;(), m&lt;630&gt;(), m&lt;631&gt;(), m&lt;632&gt;(), m&lt;633&gt;(), m&lt;634&gt;(), m&lt;635&gt;(), m&lt;636&gt;(), m&lt;637&gt;(), m&lt;638&gt;(), m&lt;639&gt;(), m&lt;640&gt;(), m&lt;641&gt;(), m&lt;642&gt;(), m&lt;643&gt;(), m&lt;644&gt;(), m&lt;645&gt;(), m&lt;646&gt;(), m&lt;647&gt;(), m&lt;648&gt;(), m&lt;649&gt;(), m&lt;650&gt;(), m&lt;651&gt;(), m&lt;652&gt;(), m&lt;653&gt;(), m&lt;654&gt;(), m&lt;655&gt;(), m&lt;656&gt;(), m&lt;657&gt;(), m&lt;658&gt;(), m&lt;659&gt;(), m&lt;660&gt;(), m&lt;661&gt;(), m&lt;662&gt;(), m&lt;663&gt;(), m&lt;664&gt;(), m&lt;665&gt;(), m&lt;666&gt;(), m&lt;667&gt;(), m&lt;668&gt;(), m&lt;669&gt;(), m&lt;670&gt;(), m&lt;671&gt;(), m&lt;672&gt;(), m&lt;673&gt;(), m&lt;674&gt;(), m&lt;675&gt;(), m&lt;676&gt;(), m&lt;677&gt;(), m&lt;678&gt;(), m&lt;679&gt;(), m&lt;680&gt;(), m&lt;681&gt;(), m&lt;682&gt;(), m&lt;683&gt;(), m&lt;684&gt;(), m&lt;685&gt;(), m&lt;686&gt;(), m&lt;687&gt;(), m&lt;688&gt;(), m&lt;689&gt;(), m&lt;690&gt;(), m&lt;691&gt;(), m&lt;692&gt;(), m&lt;693&gt;(), m&lt;694&gt;(), m&lt;695&gt;(), m&lt;696&gt;(), m&lt;697&gt;(), m&lt;698&gt;(), m&lt;699&gt;(), m&lt;700&gt;(), m&lt;701&gt;(), m&lt;702&gt;(), m&lt;703&gt;(), m&lt;704&gt;(), m&lt;705&gt;(), m&lt;706&gt;(), m&lt;707&gt;(), m&lt;708&gt;(), m&lt;709&gt;(), m&lt;710&gt;(), m&lt;711&gt;(), m&lt;712&gt;(), m&lt;713&gt;(), m&lt;714&gt;(), m&lt;715&gt;(), m&lt;716&gt;(), m&lt;717&gt;(), m&lt;718&gt;(), m&lt;719&gt;(), m&lt;720&gt;(), m&lt;721&gt;(), m&lt;722&gt;(), m&lt;723&gt;(), m&lt;724&gt;(), m&lt;725&gt;(), m&lt;726&gt;(), m&lt;727&gt;(), m&lt;728&gt;(), m&lt;729&gt;(), m&lt;730&gt;(), m&lt;731&gt;(), m&lt;732&gt;(), m&lt;733&gt;(), m&lt;734&gt;(), m&lt;735&gt;(), m&lt;736&gt;(), m&lt;737&gt;(), m&lt;738&gt;(), m&lt;739&gt;(), m&lt;740&gt;(), m&lt;741&gt;(), m&lt;742&gt;(), m&lt;743&gt;(), m&lt;744&gt;(), m&lt;745&gt;(), m&lt;746&gt;(), m&lt;747&gt;(), m&lt;748&gt;(), m&lt;749&gt;(), m&lt;750&gt;(), m&lt;751&gt;(), m&lt;752&gt;(), m&lt;753&gt;(), m&lt;754&gt;(), m&lt;755&gt;(), m&lt;756&gt;(), m&lt;757&gt;(), m&lt;758&gt;(), m&lt;759&gt;(), m&lt;760&gt;(), m&lt;761&gt;(), m&lt;762&gt;(), m&lt;763&gt;(), m&lt;764&gt;(), m&lt;765&gt;(), m&lt;766&gt;(), m&lt;767&gt;(), m&lt;768&gt;(), m&lt;769&gt;(), m&lt;770&gt;(), m&lt;771&gt;(), m&lt;772&gt;(), m&lt;773&gt;(), m&lt;774&gt;(), m&lt;775&gt;(), m&lt;776&gt;(), m&lt;777&gt;(), m&lt;778&gt;(), m&lt;779&gt;(), m&lt;780&gt;(), m&lt;781&gt;(), m&lt;782&gt;(), m&lt;783&gt;(), m&lt;784&gt;(), m&lt;785&gt;(), m&lt;786&gt;(), m&lt;787&gt;(), m&lt;788&gt;(), m&lt;789&gt;(), m&lt;790&gt;(), m&lt;791&gt;(), m&lt;792&gt;(), m&lt;793&gt;(), m&lt;794&gt;(), m&lt;795&gt;(), m&lt;796&gt;(), m&lt;797&gt;(), m&lt;798&gt;(), m&lt;799&gt;(), m&lt;800&gt;(), m&lt;801&gt;(), m&lt;802&gt;(), m&lt;803&gt;(), m&lt;804&gt;(), m&lt;805&gt;(), m&lt;806&gt;(), m&lt;807&gt;(), m&lt;808&gt;(), m&lt;809&gt;(), m&lt;810&gt;(), m&lt;811&gt;(), m&lt;812&gt;(), m&lt;813&gt;(), m&lt;814&gt;(), m&lt;815&gt;(), m&lt;816&gt;(), m&lt;817&gt;(), m&lt;818&gt;(), m&lt;819&gt;(), m&lt;820&gt;(), m&lt;821&gt;(), m&lt;822&gt;(), m&lt;823&gt;(), m&lt;824&gt;(), m&lt;825&gt;(), m&lt;826&gt;(), m&lt;827&gt;(), m&lt;828&gt;(), m&lt;829&gt;(), m&lt;830&gt;(), m&lt;831&gt;(), m&lt;832&gt;(), m&lt;833&gt;(), m&lt;834&gt;(), m&lt;835&gt;(), m&lt;836&gt;(), m&lt;837&gt;(), m&lt;838&gt;(), m&lt;839&gt;(), m&lt;840&gt;(), m&lt;841&gt;(), m&lt;842&gt;(), m&lt;843&gt;(), m&lt;844&gt;(), m&lt;845&gt;(), m&lt;846&gt;(), m&lt;847&gt;(), m&lt;848&gt;(), m&lt;849&gt;(), m&lt;850&gt;(), m&lt;851&gt;(), m&lt;852&gt;(), m&lt;853&gt;(), m&lt;854&gt;(), m&lt;855&gt;(), m&lt;856&gt;(), m&lt;857&gt;(), m&lt;858&gt;(), m&lt;859&gt;(), m&lt;860&gt;(), m&lt;861&gt;(), m&lt;862&gt;(), m&lt;863&gt;(), m&lt;864&gt;(), m&lt;865&gt;(), m&lt;866&gt;(), m&lt;867&gt;(), m&lt;868&gt;(), m&lt;869&gt;(), m&lt;870&gt;(), m&lt;871&gt;(), m&lt;872&gt;(), m&lt;873&gt;(), m&lt;874&gt;(), m&lt;875&gt;(), m&lt;876&gt;(), m&lt;877&gt;(), m&lt;878&gt;(), m&lt;879&gt;(), m&lt;880&gt;(), m&lt;881&gt;(), m&lt;882&gt;(), m&lt;883&gt;(), m&lt;884&gt;(), m&lt;885&gt;(), m&lt;886&gt;(), m&lt;887&gt;(), m&lt;888&gt;(), m&lt;889&gt;(), m&lt;890&gt;(), m&lt;891&gt;(), m&lt;892&gt;(), m&lt;893&gt;(), m&lt;894&gt;(), m&lt;895&gt;(), m&lt;896&gt;(), m&lt;897&gt;(), m&lt;898&gt;(), m&lt;899&gt;(), m&lt;900&gt;(), m&lt;901&gt;(), m&lt;902&gt;(), m&lt;903&gt;(), m&lt;904&gt;(), m&lt;905&gt;(), m&lt;906&gt;(), m&lt;907&gt;(), m&lt;908&gt;(), m&lt;909&gt;(), m&lt;910&gt;(), m&lt;911&gt;(), m&lt;912&gt;(), m&lt;913&gt;(), m&lt;914&gt;(), m&lt;915&gt;(), m&lt;916&gt;(), m&lt;917&gt;(), m&lt;918&gt;(), m&lt;919&gt;(), m&lt;920&gt;(), m&lt;921&gt;(), m&lt;922&gt;(), m&lt;923&gt;(), m&lt;924&gt;(), m&lt;925&gt;(), m&lt;926&gt;(), m&lt;927&gt;(), m&lt;928&gt;(), m&lt;929&gt;(), m&lt;930&gt;(), m&lt;931&gt;(), m&lt;932&gt;(), m&lt;933&gt;(), m&lt;934&gt;(), m&lt;935&gt;(), m&lt;936&gt;(), m&lt;937&gt;(), m&lt;938&gt;(), m&lt;939&gt;(), m&lt;940&gt;(), m&lt;941&gt;(), m&lt;942&gt;(), m&lt;943&gt;(), m&lt;944&gt;(), m&lt;945&gt;(), m&lt;946&gt;(), m&lt;947&gt;(), m&lt;948&gt;(), m&lt;949&gt;(), m&lt;950&gt;(), m&lt;951&gt;(), m&lt;952&gt;(), m&lt;953&gt;(), m&lt;954&gt;(), m&lt;955&gt;(), m&lt;956&gt;(), m&lt;957&gt;(), m&lt;958&gt;(), m&lt;959&gt;(), m&lt;960&gt;(), m&lt;961&gt;(), m&lt;962&gt;(), m&lt;963&gt;(), m&lt;964&gt;(), m&lt;965&gt;(), m&lt;966&gt;(), m&lt;967&gt;(), m&lt;968&gt;(), m&lt;969&gt;(), m&lt;970&gt;(), m&lt;971&gt;(), m&lt;972&gt;(), m&lt;973&gt;(), m&lt;974&gt;(), m&lt;975&gt;(), m&lt;976&gt;(), m&lt;977&gt;(), m&lt;978&gt;(), m&lt;979&gt;(), m&lt;980&gt;(), m&lt;981&gt;(), m&lt;982&gt;(), m&lt;983&gt;(), m&lt;984&gt;(), m&lt;985&gt;(), m&lt;986&gt;(), m&lt;987&gt;(), m&lt;988&gt;(), m&lt;989&gt;(), m&lt;990&gt;(), m&lt;991&gt;(), m&lt;992&gt;(), m&lt;993&gt;(), m&lt;994&gt;(), m&lt;995&gt;(), m&lt;996&gt;(), m&lt;997&gt;(), m&lt;998&gt;(), m&lt;999&gt;());\n\n//goal is to make a tuple of tuples, one for each states transitions\nauto result = hana::make_tuple(\nhana::filter(types, [](auto a) {\n    return hana::integral_c&lt;bool, (decltype(a)::type::source == 1)&gt;;\n}),\nhana::filter(types, [](auto a) {\n    return hana::integral_c&lt;bool, (decltype(a)::type::source == 2)&gt;;\n}),  \nhana::filter(types, [](auto a) {\n    return hana::integral_c&lt;bool, (decltype(a)::type::source == 3)&gt;;\n}),  \nhana::filter(types, [](auto a) {\n    return hana::integral_c&lt;bool, (decltype(a)::type::source == 4)&gt;;\n}),  \nhana::filter(types, [](auto a) {\n    return hana::integral_c&lt;bool, (decltype(a)::type::source == 5)&gt;;\n}), \nhana::filter(types, [](auto a) {\n    return hana::integral_c&lt;bool, (decltype(a)::type::source == 6)&gt;;\n}), \nhana::filter(types, [](auto a) {\n    return hana::integral_c&lt;bool, (decltype(a)::type::source == 7)&gt;;\n}));\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1488399050, "post_id": 42541054, "comment_id": 72217934, "body": "The right tool to solve such problems is your debugger. You should step through your code line-by-line <i>before</i> asking on Stack Overflow. For more help, please read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs (by Eric Lippert)</a>. At a minimum, you should &#91;edit] your question to include a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable</a> example that reproduces your problem, along with the observations you made in the debugger."}, {"owner": {"reputation": 77, "user_id": 1535153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/RslmI.png?s=128&g=1", "display_name": "Scientist42", "link": "https://stackoverflow.com/users/1535153/scientist42"}, "edited": false, "score": 0, "creation_date": 1488399250, "post_id": 42541054, "comment_id": 72218066, "body": "Several life advices: 1- Study how HW works (doing modulo each time is probably not the best thing to do) 2 - First think about problem in your mind and then try to figure out all possible cases, that can go wrong. =&gt; Solve them first. 3 - You should inform user about the INT range"}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1488407773, "post_id": 42541054, "comment_id": 72222676, "body": "Some advice: 0) <code>iostream</code> is not <code>iostream.h</code>.  Also, for C library headers, you might want to use the <code>cX</code> verison instead of the <code>X.h</code> version (e.g. <code>cstdio</code> instead of <code>stdio.h</code>).  1) You use the names <code>atbilde</code> and <code>answer</code> for the same variable; choose one or the other.  2) <code>void main()</code> is a non-standard extenstion.  While Visual Studio supports it, not all compilers are guaranteed to do so.  If you want to make your code more portable, you can use the standard <code>int main()</code>."}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1488407919, "post_id": 42541054, "comment_id": 72222741, "body": "3) You can replace the <code>do...while</code> loop in your <code>if (n &gt; m)</code> statement&#39;s body with <code>continue</code>, which will go to the main loop&#39;s condition check; if you do so, I suggest initialising the <code>char</code> to <code>&#39;y&#39;</code>, and change string <code>&quot;Max number of interval has to be larger than min number!&quot;</code> to <code>&quot;Max number of interval has to be larger than min number!\\nPut the numbers again!\\n&quot;</code>, so the behaviour stays the same."}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1488408020, "post_id": 42541054, "comment_id": 72222784, "body": "4) Assuming the range is inclusive (i.e. the range <code>3..5</code> consists of <code>3, 4, 5</code>), there is exactly one situation where the range will contain no even numbers, which you have mentioned in your question.  You can check for this situation with an <code>if</code>; when encountered, you can provide your desired special output, prompt the user for whether they want to continue, and use <code>continue</code> to restart the loop."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1488399337, "post_id": 42541166, "comment_id": 72218117, "body": "this really should be a comment if this is all you are going to provide."}], "tags": [], "owner": {"reputation": 23041, "user_id": 1149664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac4f96b553d2e45776bd6235fee4222d?s=128&d=identicon&r=PG", "display_name": "Johan Lundberg", "link": "https://stackoverflow.com/users/1149664/johan-lundberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1488399240, "creation_date": 1488399240, "answer_id": 42541166, "question_id": 42541054, "link": "https://stackoverflow.com/questions/42541054/c-check-if-there-are-no-even-numbers-in-given-interval/42541166#42541166", "title": "C++ - Check if there are no even numbers in given interval", "body": "<p>Some hints to help you along the way: If there was no even number in the range, you will not enter into the loop. What will <code>j</code> be then? How do you react on that value?</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 7213908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f4bb435d65f458fb71e2925a16d273b?s=128&d=identicon&r=PG&f=1", "display_name": "Sela12", "link": "https://stackoverflow.com/users/7213908/sela12"}, "is_accepted": false, "score": 0, "last_activity_date": 1488405667, "creation_date": 1488405667, "answer_id": 42542939, "question_id": 42541054, "link": "https://stackoverflow.com/questions/42541054/c-check-if-there-are-no-even-numbers-in-given-interval/42542939#42542939", "title": "C++ - Check if there are no even numbers in given interval", "body": "<p>I tried to fix your code, I did the best I could from what I understood you were tring to do.\nI cleaned it up, fixed spelling and grammer, I deleted unnecessary stuff, I also made it more compact and nice to look at.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main() {\n    int max=0, min=1, sum=0; product = 1, amount = 0; // max, min - entered by user, product - product of all even numbers in interval, sum - sum of all even numbers in interval. amount - amount of even numbers in interval\n    char x=Y; // Entered by user to know if to quit or continue to continue.\n\n    while ((x == Y) || (x == y))\n    {\n        while (min &gt; max) { // System detects whether minimum is bigger than maximum\n            cin.clear();  // Clears screen so if this part runs again it wouldn't get messy.\n            cin.ignore();\n            cout &lt;&lt; \"Max has to be larger than min!\";\n            cout &lt;&lt; \"\\n Enter the min number of interval!  \";\n            cin &gt;&gt; min;\n            cout &lt;&lt; \"\\n Enter the max number of interval!  \";\n            cin &gt;&gt; max;\n        }\n\n        for (; min &lt;= max; min++)\n        {\n            if (min % 2 == 0)\n            {\n                sum+=n;\n                count++;\n                product*=n;\n            }\n        }\n        if (count == 0)\n        {\n            product=0;\n            cout &lt;&lt; \"There are no even numbers in interval!\";\n        }\n        else\n        {\n            cout &lt;&lt; \"\\n The amount of the even numbers in interval: \" &lt;&lt; amount &lt;&lt; \",the product of the even numbers: \" &lt;&lt; product &lt;&lt; \",the sum of the even numbers: \" sum &lt;&lt; \"\\n\\n\";\n        }\n        cout &lt;&lt; \"Repeat? (Y/N) \";\n        x=getchar;\n        system(\"cls\");\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6161295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef28853f601ed3625641b36703ded14?s=128&d=identicon&r=PG&f=1", "display_name": "Guuuson", "link": "https://stackoverflow.com/users/6161295/guuuson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1525683909, "creation_date": 1488398860, "last_edit_date": 1525683909, "question_id": 42541054, "link": "https://stackoverflow.com/questions/42541054/c-check-if-there-are-no-even-numbers-in-given-interval", "title": "C++ - Check if there are no even numbers in given interval", "body": "<p>I have to write a program on C++ which finds all even numbers in range given by user. Here's the code I have written so far:    </p>\n\n<pre><code>#pragma hdrstop\n#pragma argsused\n\n#include &lt;tchar.h&gt;\n#include &lt;iostream.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nvoid main() {\nint m, n, j = 1; // m and n- numbers entered by user, j- product of all even numbers in interval\nchar atbilde; // A letter entered by user, of which system decides wether to continue or to stop programme\n\ndo {\n    j = 1;\n    cout &lt;&lt; \"Enter the min number of interval!  \";\n    cin &gt;&gt; n;\n    cout &lt;&lt; \"Enter the max number of interval!  \";\n    cin &gt;&gt; m;\n    if (n &gt; m) { // Detects wether \u201en\u201d is larger than \u201em\u201d\ncout &lt;&lt; \"Max number of interval has to be larger than min number!\";\n        do { // If max number is larger than min number, screen is cleared\n            cin.clear();\n            cin.ignore();\n            cout &lt;&lt; \"Enter the numbers again!\";\n            cout &lt;&lt; \"\\n Enter the min number of interval!  \";\n            cin &gt;&gt; n;\n            cout &lt;&lt; \"\\n Enter the max number of interval!  \";\n            cin &gt;&gt; m;\n        }\n        while (n &gt; m);\n    }\n\n    cout &lt;&lt; \"Even  numbers in given interval: \";\n    for (; n &lt;= m; n++)\n    { \n        if (n % 2 == 0)\n        { // Detects, wether there are even numbers in given interval\n                if (n != 0) {\n\n                    cout &lt;&lt; n &lt;&lt; \" \";\n                    j *= n;\n\n                }\n\n                if ((n == m) &amp;&amp; (n % 2 != 0)) {\n                    j=0;\n                }\n\n        }\n\n    }\n        cout &lt;&lt; \"\\n The product of found even numbers: \" &lt;&lt; j &lt;&lt; \" \";\n\n\n    cout &lt;&lt; \"\\n Repeat? (Y/N) \";\n    cin &gt;&gt; answer;\n    system(\"cls\");\n\n}\nwhile (tolower(answer) != 'n');\n}\n</code></pre>\n\n<p>But I have a small problem, so I can't get the program 100% done because of the problem. \nLike, user enters range, whose min and max number is the same and it's odd. In that case program has to print out a sentence \"there were no even numbers in interval\" in place of \"The product of found even numbers:\". I have searched the solution in internet, but haven't found it.\nI hope you'll know the right solution.</p>\n"}, {"tags": ["c++", "c", "ubuntu", "gcc", "compilation"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 5, "creation_date": 1488398750, "post_id": 42541002, "comment_id": 72217754, "body": "Object files are not directly executable."}, {"owner": {"reputation": 212, "user_id": 5712993, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1ffcc2475b46d64ef87424d23da85206?s=128&d=identicon&r=PG&f=1", "display_name": "yoyo_fun", "link": "https://stackoverflow.com/users/5712993/yoyo-fun"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1488398836, "post_id": 42541002, "comment_id": 72217809, "body": "@CaptainObvlious I know but my I would like to understand why. Why can&#39;t they be executed even if the source file that they are compiled from DOES NOT link top any kind of external file ?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1488398887, "post_id": 42541002, "comment_id": 72217841, "body": "you need linkage for standard functions, like <code>printf</code>, and such. and even if you don&#39;t use them, you need an <i>entrypoint</i>, startup code to initialize heap, stack..."}, {"owner": {"reputation": 212, "user_id": 5712993, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1ffcc2475b46d64ef87424d23da85206?s=128&d=identicon&r=PG&f=1", "display_name": "yoyo_fun", "link": "https://stackoverflow.com/users/5712993/yoyo-fun"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1488399296, "post_id": 42541002, "comment_id": 72218092, "body": "@Jean-Fran&#231;oisFabre  I do not use the printf function but I do not even #include the stdio and any other thing. Even if I do not include anything in my code do I still need linkeage for standard function ? If yes then why do I need them ?"}, {"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 2, "creation_date": 1488399312, "post_id": 42541002, "comment_id": 72218106, "body": "Well the operating system told you it didn&#39;t recognize it the file format as an executable. That&#39;s WHY!"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1488399314, "post_id": 42541002, "comment_id": 72218107, "body": "I think the error message comtains a pretty good clue: the result of  <code>-c</code> is not in the rigjt format to be executed. (Neither is the output of <code>gcc -S</code>, although arguably it has been &quot;compiled&quot;.)"}, {"owner": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "edited": false, "score": 1, "creation_date": 1488399366, "post_id": 42541002, "comment_id": 72218131, "body": "Useful reading: <a href=\"https://en.wikipedia.org/wiki/Executable_and_Linkable_Format\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Executable_and_Linkable_Format</a>"}, {"owner": {"reputation": 212, "user_id": 5712993, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1ffcc2475b46d64ef87424d23da85206?s=128&d=identicon&r=PG&f=1", "display_name": "yoyo_fun", "link": "https://stackoverflow.com/users/5712993/yoyo-fun"}, "reply_to_user": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "edited": false, "score": 0, "creation_date": 1488399417, "post_id": 42541002, "comment_id": 72218157, "body": "@ScottMermelstein Thank you Scott. A helpful answer."}, {"owner": {"reputation": 212, "user_id": 5712993, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1ffcc2475b46d64ef87424d23da85206?s=128&d=identicon&r=PG&f=1", "display_name": "yoyo_fun", "link": "https://stackoverflow.com/users/5712993/yoyo-fun"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1488399587, "post_id": 42541002, "comment_id": 72218257, "body": "@Jean-Fran&#231;oisFabre  That is certainly not what the question is abut. You CAN write a program that does not communicate with the exterior. The fact that it has no practical purpose is completely irrelevant to the question that I asked."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488399649, "post_id": 42541002, "comment_id": 72218292, "body": "Because <code>main</code> is not the startup code of a program."}, {"owner": {"reputation": 212, "user_id": 5712993, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1ffcc2475b46d64ef87424d23da85206?s=128&d=identicon&r=PG&f=1", "display_name": "yoyo_fun", "link": "https://stackoverflow.com/users/5712993/yoyo-fun"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488399730, "post_id": 42541002, "comment_id": 72218346, "body": "@Olaf What is the startup code of a program ?"}, {"owner": {"reputation": 212, "user_id": 5712993, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1ffcc2475b46d64ef87424d23da85206?s=128&d=identicon&r=PG&f=1", "display_name": "yoyo_fun", "link": "https://stackoverflow.com/users/5712993/yoyo-fun"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1488399841, "post_id": 42541002, "comment_id": 72218398, "body": "@CaptainObvlious  Why have I been blocked from asking questions ???"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1488401128, "post_id": 42541002, "comment_id": 72219116, "body": "@yoyo_fun: <code>man execl</code> will give you a pretty good overview of what happens prior to <code>main</code> be called (and also what happens after <code>main</code> returns). <code>execl</code> is crucial because, according to Posix, once the shell has identified which executable image is to be run, &quot;the shell executes the utility in a separate utility environment... with actions equivalent to calling the execl() function... with the path argument set to the pathname resulting from the search, arg0 set to the command name, and the remaining execl() arguments set to the command arguments (if any) and the null terminator.&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488401694, "post_id": 42541002, "comment_id": 72219464, "body": "@yoyo_fun: Learn how to search: <code>c startup code</code> shows links to multiple useful sites."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488401864, "post_id": 42541002, "comment_id": 72219581, "body": "@yoyo_fun: A program which has no effect to the environment, i.e. no <b>observable behaviour</b> can be reduced to no existence. Which the compiler is allowed to do."}, {"owner": {"reputation": 212, "user_id": 5712993, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1ffcc2475b46d64ef87424d23da85206?s=128&d=identicon&r=PG&f=1", "display_name": "yoyo_fun", "link": "https://stackoverflow.com/users/5712993/yoyo-fun"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1488402134, "post_id": 42541002, "comment_id": 72219749, "body": "@Olaf No, it is still a program that can put the processor to do all kinds of operations on all kinds of operators in the memory and in the registries. And for this a program does not need to import any library. It can do mathematical operations on numbers that are hardcoded. This does not mean the program does not exist. And the question &#39;why a program needs to be linked even if it does not import absolutely anything?&#39; is still a valid and interesting question."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1488402161, "post_id": 42541002, "comment_id": 72219763, "body": "@yoyo_fun: Please read the standard!"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1488444986, "post_id": 42541002, "comment_id": 72236734, "body": "Why the <code>c++</code> tag since you are talking of a C program ?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1488445451, "post_id": 42541002, "comment_id": 72237058, "body": "@yoyo_fun: if some answer (perhaps mine&#39;s) fits your expectations, please accept it."}, {"owner": {"reputation": 3649, "user_id": 294569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05c97ccc8981952c53fa09dadfafb132?s=128&d=identicon&r=PG", "display_name": "Damian", "link": "https://stackoverflow.com/users/294569/damian"}, "edited": false, "score": 1, "creation_date": 1488483125, "post_id": 42541002, "comment_id": 72262540, "body": "This is a convention that was define. The executable needs a place to start, so someone came up with calling it main in C/C++"}], "answers": [{"comments": [{"owner": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "edited": false, "score": 0, "creation_date": 1488399163, "post_id": 42541120, "comment_id": 72218004, "body": "OP doesn&#39;t use any functions from any libraries.  In the example code quoted above, there are no functions that need to be linked."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2933559"}, "edited": false, "score": 0, "creation_date": 1488399279, "post_id": 42541120, "comment_id": 72218079, "body": "If a program is freestanding then you don&#39;t need to link any external functions at all."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1488399412, "post_id": 42541120, "comment_id": 72218154, "body": "But you do need to link the system entry point that eventually calls main()."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "edited": false, "score": 1, "creation_date": 1488399448, "post_id": 42541120, "comment_id": 72218178, "body": "@ScottMermelstein - No way to answer both comments but, you&#39;re both wrong - there are external functions that are needed, setup/teardown of the environment for example.  Look at the machinations necessary in an assembly program to make it free standing and compare to the <code>.s</code> output from a <code>gcc -s source.c</code>"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1488399464, "post_id": 42541120, "comment_id": 72218184, "body": "@bace1000 - see my comment to Scott"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2933559"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1488399571, "post_id": 42541120, "comment_id": 72218247, "body": "@ryyker Since when has <code>exit</code> been a keyword?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1488399700, "post_id": 42541120, "comment_id": 72218329, "body": "@bace1000 - my mistake, it is a function. I never use it, but have seen it, I misspoke before verifying what it really was."}], "tags": [], "owner": {"reputation": 4412, "user_id": 1953914, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9bdaf013f56c9c785496b4226d6f1f9f?s=128&d=identicon&r=PG", "display_name": "hashier", "link": "https://stackoverflow.com/users/1953914/hashier"}, "is_accepted": false, "score": -2, "last_activity_date": 1488399091, "creation_date": 1488399091, "answer_id": 42541120, "question_id": 42541002, "link": "https://stackoverflow.com/questions/42541002/when-we-compile-a-source-code-that-contains-a-main-without-linking-why-cant/42541120#42541120", "title": "When we compile a source code that contains a &#39;main&#39; without linking, why can&#39;t we run it?", "body": "<p>Even the most basic commands like <code>exit</code> aren't directly in the language and need to be linked.</p>\n\n<p><a href=\"http://en.cppreference.com/w/c/program/exit\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/program/exit</a></p>\n"}, {"comments": [{"owner": {"reputation": 212, "user_id": 5712993, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1ffcc2475b46d64ef87424d23da85206?s=128&d=identicon&r=PG&f=1", "display_name": "yoyo_fun", "link": "https://stackoverflow.com/users/5712993/yoyo-fun"}, "edited": false, "score": 0, "creation_date": 1488399692, "post_id": 42541217, "comment_id": 72218325, "body": "Thank you for your answer.... many people here seem to be very rude to the beginner programmers, even if my question was not asked before I am downvoted to oblivion."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 6, "last_activity_date": 1488445038, "last_edit_date": 1488445038, "creation_date": 1488399439, "answer_id": 42541217, "question_id": 42541002, "link": "https://stackoverflow.com/questions/42541002/when-we-compile-a-source-code-that-contains-a-main-without-linking-why-cant/42541217#42541217", "title": "When we compile a source code that contains a &#39;main&#39; without linking, why can&#39;t we run it?", "body": "<p>Read Levine's <a href=\"http://iecc.com/linkers/\" rel=\"nofollow noreferrer\"><em>Linkers &amp; Loaders</em></a>.</p>\n\n<p>Read about <a href=\"https://en.wikipedia.org/wiki/Executable_and_Linkable_Format\" rel=\"nofollow noreferrer\">ELF</a>.</p>\n\n<p>Try compiling with <code>gcc -v</code> (you'll see what are the actual programs used: <code>cc1</code> to <a href=\"https://en.wikipedia.org/wiki/Compiler\" rel=\"nofollow noreferrer\">compile</a> C code into some assembler, <code>as</code> to <a href=\"https://en.wikipedia.org/wiki/Assembly_language#Assembler\" rel=\"nofollow noreferrer\">assemble</a> that into some object file, <a href=\"https://sourceware.org/binutils/docs/ld/\" rel=\"nofollow noreferrer\"><code>ld</code></a> &amp; <a href=\"https://gcc.gnu.org/onlinedocs/gccint/Collect2.html\" rel=\"nofollow noreferrer\"><code>collect2</code></a> to <a href=\"https://en.wikipedia.org/wiki/Linker_(computing)\" rel=\"nofollow noreferrer\">link</a>). Look also at the generated assembler file with <code>gcc -S -fverbose-asm -O</code>. Notice that <code>gcc</code> knows about (and compiles <em>specially</em>) the <code>main</code> function. And the starting point of your executable is provided by some <a href=\"https://en.wikipedia.org/wiki/Crt0\" rel=\"nofollow noreferrer\">crt0</a>, etc (it is <em>not</em> <code>main</code> but some <code>_start</code> routine coded in assembler which calls your <code>main</code>....).</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Object_code\" rel=\"nofollow noreferrer\">Object files</a> are not the same as <a href=\"https://en.wikipedia.org/wiki/Executable\" rel=\"nofollow noreferrer\">executables</a>. The executable contains stuff like <a href=\"https://en.wikipedia.org/wiki/Crt0\" rel=\"nofollow noreferrer\">crt0</a> and the <a href=\"https://en.wikipedia.org/wiki/C_standard_library\" rel=\"nofollow noreferrer\">C standard library</a>, or some way to <a href=\"https://en.wikipedia.org/wiki/Dynamic_linker\" rel=\"nofollow noreferrer\">dynamically link</a> it as a <a href=\"https://en.wikipedia.org/wiki/Library_%28computing%29#Shared_libraries\" rel=\"nofollow noreferrer\">shared object</a> (and you need to link your <code>source.o</code> -compiled from your empty <code>main</code> in <code>source.c</code>- into an executable because of that).</p>\n\n<p>On Linux, play with <a href=\"http://man7.org/linux/man-pages/man1/objdump.1.html\" rel=\"nofollow noreferrer\">objdump(1)</a> &amp; <a href=\"http://man7.org/linux/man-pages/man1/readelf.1.html\" rel=\"nofollow noreferrer\">readelf(1)</a> (on some existing binaries, and also on your <code>source.o</code> object file)</p>\n\n<p>See also <a href=\"http://man7.org/linux/man-pages/man5/elf.5.html\" rel=\"nofollow noreferrer\">elf(5)</a>, <a href=\"http://man7.org/linux/man-pages/man2/execve.2.html\" rel=\"nofollow noreferrer\">execve(2)</a>, <a href=\"http://man7.org/linux/man-pages/man8/ld-linux.8.html\" rel=\"nofollow noreferrer\">ld-linux(8)</a>, <a href=\"http://www.tldp.org/HOWTO/Assembly-HOWTO/\" rel=\"nofollow noreferrer\">Linux assembly howto</a>, <a href=\"http://man7.org/linux/man-pages/man2/syscalls.2.html\" rel=\"nofollow noreferrer\">syscalls(2)</a>, <a href=\"http://advancedlinuxprogramming.com/\" rel=\"nofollow noreferrer\">Advanced Linux Programming</a>, <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/\" rel=\"nofollow noreferrer\">Operating Systems: Three Easy Pieces</a>, and (to understand about <code>libc.so</code>) Drepper's <a href=\"https://www.akkadia.org/drepper/dsohowto.pdf\" rel=\"nofollow noreferrer\"><em>How To Write Shared Libraries</em></a>, the <a href=\"https://en.wikipedia.org/wiki/Compilers:_Principles,_Techniques,_and_Tools\" rel=\"nofollow noreferrer\">Dragon Book</a> ... </p>\n\n<p><sup>(you need to read entire books to understand the details; I gave some references)</sup></p>\n\n<p>Look also into Common Lisp &amp; <a href=\"http://sbcl.org/\" rel=\"nofollow noreferrer\">SBCL</a>. Its compiler has a very different model (really different from C).</p>\n"}, {"comments": [{"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1488401088, "post_id": 42541686, "comment_id": 72219091, "body": "for this specific example didnt need the stack pointer to be initialized, generally that is the bare minimum, stack pointer and branch to the C language entry point.  REAL C programs with .data and .bss other things need to happen in the bootstrap."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1488424756, "post_id": 42541686, "comment_id": 72227922, "body": "as well as a proper system call to exit, which is operating system dependent how that happens."}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 3, "last_activity_date": 1488401029, "creation_date": 1488401029, "answer_id": 42541686, "question_id": 42541002, "link": "https://stackoverflow.com/questions/42541002/when-we-compile-a-source-code-that-contains-a-main-without-linking-why-cant/42541686#42541686", "title": "When we compile a source code that contains a &#39;main&#39; without linking, why can&#39;t we run it?", "body": "<p>You dont have a bootstrap.  you are in this chicken and egg problem.  </p>\n\n<p>The code (for that function) is there, but there are assumptions, first and foremost you need a stack.  Depending on the architecture your return address may be on that stack for example.  The return value may be on that stack.  The C language itself doesnt provide for that directly in the language there is always at least a little bit of assembly or some other language required in order to \"bootstrap\" your function.  For example in ARM for gnu:</p>\n\n<p>bs.s</p>\n\n<pre><code>.globl _start\n_start:\n    mov sp,#0x8000\n    bl main\n    b .\n</code></pre>\n\n<p>so.c</p>\n\n<pre><code>int main ( void )\n{\n    return(0);\n}\n</code></pre>\n\n<p>For ARM the function is complete the instructions dont need to be modified by the linker. but there is no address space defined, either specified or the disassembler assumes zero as the address for this object, but it is an object not a loadable binary.</p>\n\n<pre><code>00000000 &lt;main&gt;:\n   0:   e3a00000    mov r0, #0\n   4:   e12fff1e    bx  lr\n</code></pre>\n\n<p>now if we add the bootstrap and link to some address we get a real, executable, program</p>\n\n<pre><code>00008000 &lt;_start&gt;:\n    8000:   e3a0d902    mov sp, #32768  ; 0x8000\n    8004:   eb000000    bl  800c &lt;main&gt;\n    8008:   eafffffe    b   8008 &lt;_start+0x8&gt;\n\n0000800c &lt;main&gt;:\n    800c:   e3a00000    mov r0, #0\n    8010:   e12fff1e    bx  lr\n</code></pre>\n\n<p>It doesnt mean one couldnt craft an operating system nor an environment where you could load functions in this way, using the compilers object output.  But that is the reason for the word chain, tool chain.  Compiler makes assembly language, the assembler assembles the assembly language, combined with other necessary objects (bootstrap plus compiler libraries plus C libraries, etc) the linker defines the address spaces for everything and modifies the code/data as needed to resolve externals.  A sequence or chain of events to get the final result.</p>\n"}], "owner": {"reputation": 212, "user_id": 5712993, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1ffcc2475b46d64ef87424d23da85206?s=128&d=identicon&r=PG&f=1", "display_name": "yoyo_fun", "link": "https://stackoverflow.com/users/5712993/yoyo-fun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 2, "accepted_answer_id": 42541217, "answer_count": 3, "score": 1, "last_activity_date": 1488445038, "creation_date": 1488398686, "last_edit_date": 1488399079, "question_id": 42541002, "link": "https://stackoverflow.com/questions/42541002/when-we-compile-a-source-code-that-contains-a-main-without-linking-why-cant", "title": "When we compile a source code that contains a &#39;main&#39; without linking, why can&#39;t we run it?", "body": "<p>I am learning about compiling process and I know that linking is mainly used to link a binary file which contains a 'main' function with other binary files that contain other helper functions that are used in our main functions.</p>\n\n<p>However when I try to run an object file with the code:</p>\n\n<pre><code>int main() {\n    return 0;\n}\n</code></pre>\n\n<p>Compiled with the -c command in gcc on Ubuntu, I try to run it and I get the error:</p>\n\n<blockquote>\n  <p>\"bash: ./source.o: cannot execute binary file: Exec format error\"</p>\n</blockquote>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1488398689, "post_id": 42540954, "comment_id": 72217724, "body": "bar() is called first."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1488398713, "post_id": 42540954, "comment_id": 72217734, "body": "As long the <i>observable behaviour</i> is the same, there might be no function call at all. And pick <b>one</b> language! C and C++ are different languages with very different semantics!"}, {"owner": {"reputation": 23041, "user_id": 1149664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac4f96b553d2e45776bd6235fee4222d?s=128&d=identicon&r=PG", "display_name": "Johan Lundberg", "link": "https://stackoverflow.com/users/1149664/johan-lundberg"}, "edited": false, "score": 0, "creation_date": 1488398774, "post_id": 42540954, "comment_id": 72217773, "body": "Similar but more intricate for C++17: <a href=\"http://stackoverflow.com/questions/38501587/what-are-the-evaluation-order-guarantees-introduced-by-c17\" title=\"what are the evaluation order guarantees introduced by c17\">stackoverflow.com/questions/38501587/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488400727, "post_id": 42541000, "comment_id": 72218888, "body": "Please use the <i>valid</i> standard, not an outdated version for reference. And this does not specify how the generated machine code works."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 0, "last_activity_date": 1488401265, "last_edit_date": 1488401265, "creation_date": 1488398681, "answer_id": 42541000, "question_id": 42540954, "link": "https://stackoverflow.com/questions/42540954/what-is-the-function-execution-order-in-code-like-foobar/42541000#42541000", "title": "What is the function execution order in code like foo(bar())?", "body": "<p>There is a sequence point after function argument evaluation (i.e. before the code of any function is entered). Hence, <code>bar()</code> must be evaluated before <code>foo(...)</code> will be entered. Confer, for example, the <a href=\"http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C11 standard</a>:</p>\n\n<blockquote>\n  <p>6.5.2.2 Function calls: (10) There is a sequence point after the evaluations of the function designator and the actual arguments but before the actual call. Every evaluation in the calling function (including other function calls) that is not otherwise specifically sequenced before or after the execution of the body of the called function is indeterminately sequenced with respect to the execution of the called function.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1488398960, "post_id": 42541005, "comment_id": 72217881, "body": "Are you sure?  [expr.call] states <i>The evaluations of the postfix expression and of the arguments are all unsequenced relative to one another. All side effects of argument evaluations are sequenced before the function is entered</i>"}, {"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1488399167, "post_id": 42541005, "comment_id": 72218008, "body": "@NathanOliver Yeah, the standard quotes in the linked Q&amp;A seem to support this."}], "tags": [], "owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "is_accepted": true, "score": 3, "last_activity_date": 1488399563, "last_edit_date": 1495540433, "creation_date": 1488398691, "answer_id": 42541005, "question_id": 42540954, "link": "https://stackoverflow.com/questions/42540954/what-is-the-function-execution-order-in-code-like-foobar/42541005#42541005", "title": "What is the function execution order in code like foo(bar())?", "body": "<blockquote>\n  <ol>\n  <li>Is it required that <code>bar()</code> is called first [\u2026]?</li>\n  </ol>\n</blockquote>\n\n<p>The code is required to behave as if that's what's happening.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Is it permitted that the compiler reorders the above [\u2026]?</li>\n  </ol>\n</blockquote>\n\n<p>Yes, if the observable behavior is the same as if <code>bar()</code> was evaluated first.</p>\n\n<p>This is known as the <a href=\"https://stackoverflow.com/q/15718262/3425536\"><strong>\"as-if\" rule</strong></a>:</p>\n\n<blockquote>\n  <p>[\u2026] an implementation is free to disregard any requirement of this International Standard as long as the result is as if the requirement had been obeyed, as far as can be determined from the observable behavior of the program.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": false, "score": 0, "last_activity_date": 1488398697, "creation_date": 1488398697, "answer_id": 42541006, "question_id": 42540954, "link": "https://stackoverflow.com/questions/42540954/what-is-the-function-execution-order-in-code-like-foobar/42541006#42541006", "title": "What is the function execution order in code like foo(bar())?", "body": "<p>If you have the following statement</p>\n\n<pre><code>foo(bar());\n</code></pre>\n\n<p>The function <code>bar()</code> will be called before <code>foo()</code>. The compiler cannot reorder these function calls.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488398865, "post_id": 42541028, "comment_id": 72217827, "body": "That would complete forbid inlining and full-code optimisation. If that is about C++, it is very different for C."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488398948, "post_id": 42541028, "comment_id": 72217874, "body": "@Olaf No it doesn&#39;t, it simply explains what the observable behavior is. The observable behavior is that <code>bar()</code> is evaluated first."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488399114, "post_id": 42541028, "comment_id": 72217982, "body": "&quot;is sequenced <b>before execution</b> of every expression or statement in the body of the called function.&quot; - that goes much further than observable behaviour. OB allows to reorder statements arbitrarily, as long the OB does not change. This line explicitly forbids it. It might be because of C++ having constructors/destructors, etc. But it is definitively way more restrictive than in C (the question is unfortunately tagged both)."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488399818, "post_id": 42541028, "comment_id": 72218388, "body": "@Olaf: But 1.9 [intro.execution] says &quot;[conforming implemenations] need not copy or emulate the structure of the abstract machine. Rather, conforming implementations are required to emulate (only) the observable behavior of the abstract machine as explained below.&quot; That applies also to &quot;sequenced before&quot;; only observable behaviour is required to happen in order."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1488399953, "post_id": 42541028, "comment_id": 72218472, "body": "@rici: If you refer to the C++ standard: I&#39;m not really into it (I&#39;m a C person). If that is so, it should be part of the answer as it relaxes requirements indeed. I just wanted to point out from the text shown, it would be more strict than in C."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488400123, "post_id": 42541028, "comment_id": 72218560, "body": "The citation is not related to when <code>a</code> and <code>b</code> are evaluated relative to each other. <code>a</code> is not the body of the function, but the expression yielding a function. The body is the code at the function definition."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488400621, "post_id": 42541028, "comment_id": 72218825, "body": "@Olaf: I&#39;m fully aware of your Cness :) and indeed it is from the C++ standard (I should have written 1.9.1, though). But it&#39;s essentially the same definition of &quot;sequenced before&quot; as provided by the C standard (although the sequenced-before <i>rules</i> are different); in both cases, it only applies to observed behaviour. (It&#39;s also possible that C++ and C can observe different behaviours, but the clauses look very similar to me.)"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488400672, "post_id": 42541028, "comment_id": 72218856, "body": "@Olaf: <code>a</code> <b>is</b> the &quot;postfix expression designating the called function&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488400982, "post_id": 42541028, "comment_id": 72219033, "body": "@riciYes, I got that from your comment, but it cannot be concluded from the answer, which makes my comment relevant. Not sure, but doesn&#39;t C++17 (at least) support defered evaluation? That would raise the question to another level of too broad, I suspect."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1488401058, "post_id": 42541028, "comment_id": 72219070, "body": "&quot;... postfix expression designating ...&quot; - Whatever, I did not recall the exact term. Point is it is definitively not the function body the answer refers to."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 5, "last_activity_date": 1488398767, "creation_date": 1488398767, "answer_id": 42541028, "question_id": 42540954, "link": "https://stackoverflow.com/questions/42540954/what-is-the-function-execution-order-in-code-like-foobar/42541028#42541028", "title": "What is the function execution order in code like foo(bar())?", "body": "<p>In C++, [intro.execution]:</p>\n\n<blockquote>\n  <p>When calling a function (whether or not the function is inline), every value computation and side effect associated with any argument expression, or with the postfix expression designating the called function, is sequenced before execution of every expression or statement in the body of the called function.</p>\n</blockquote>\n\n<p><code>bar()</code> must be evaluated before the call to <code>foo</code> begins. </p>\n\n<p>There was some change in C++17 that the expression <code>a(b)</code> now evaluates <code>a</code> before <code>b</code> whereas before they were unsequenced. In this case, the evaluation of <code>foo</code> doesn't do anything, it's just an identifier. But had we had <code>foo()(bar())</code>, then the call to <code>foo()</code> would be sequenced before the call to <code>bar()</code>, whereas prior to C++17, the two were unsequenced. </p>\n"}, {"comments": [{"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 0, "creation_date": 1488399983, "post_id": 42541313, "comment_id": 72218488, "body": "The result of <code>bar()</code> is not necessarily passed as a copy, for example if <code>foo</code> takes its parameter as a reference."}, {"owner": {"reputation": 91, "user_id": 2112278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da46df2aadfcfbe52c744dc6fe6275f2?s=128&d=identicon&r=PG", "display_name": "J.Guarin", "link": "https://stackoverflow.com/users/2112278/j-guarin"}, "reply_to_user": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 0, "creation_date": 1488400249, "post_id": 42541313, "comment_id": 72218634, "body": "granted, would you please put an example?"}, {"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 0, "creation_date": 1488400325, "post_id": 42541313, "comment_id": 72218676, "body": "<code>void foo(const type&amp;) { }</code>"}, {"owner": {"reputation": 91, "user_id": 2112278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da46df2aadfcfbe52c744dc6fe6275f2?s=128&d=identicon&r=PG", "display_name": "J.Guarin", "link": "https://stackoverflow.com/users/2112278/j-guarin"}, "reply_to_user": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 0, "creation_date": 1488400995, "post_id": 42541313, "comment_id": 72219037, "body": "You are right. I would improve the answer. Thank you."}], "tags": [], "owner": {"reputation": 91, "user_id": 2112278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da46df2aadfcfbe52c744dc6fe6275f2?s=128&d=identicon&r=PG", "display_name": "J.Guarin", "link": "https://stackoverflow.com/users/2112278/j-guarin"}, "is_accepted": false, "score": 0, "last_activity_date": 1511395156, "last_edit_date": 1511395156, "creation_date": 1488399721, "answer_id": 42541313, "question_id": 42540954, "link": "https://stackoverflow.com/questions/42540954/what-is-the-function-execution-order-in-code-like-foobar/42541313#42541313", "title": "What is the function execution order in code like foo(bar())?", "body": "<p>It's same as :</p>\n\n<pre><code>type bar_result = bar();\nfoo(bar_result);\n</code></pre>\n\n<ol>\n<li>bar() will be called first. </li>\n<li>bar_result is passed as a copy/referencie.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "is_accepted": false, "score": 2, "last_activity_date": 1488399721, "creation_date": 1488399721, "answer_id": 42541314, "question_id": 42540954, "link": "https://stackoverflow.com/questions/42540954/what-is-the-function-execution-order-in-code-like-foobar/42541314#42541314", "title": "What is the function execution order in code like foo(bar())?", "body": "<p>In addition to what others have said, you might consider </p>\n\n<pre><code>  foo( bar1(), bar2() );\n</code></pre>\n\n<p>which is a more interesting case. Here, the order is allowed to be [bar1, bar2, foo] or [bar2, bar1, foo].</p>\n"}], "owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 42541005, "answer_count": 6, "score": 1, "last_activity_date": 1511395156, "creation_date": 1488398531, "question_id": 42540954, "link": "https://stackoverflow.com/questions/42540954/what-is-the-function-execution-order-in-code-like-foobar", "title": "What is the function execution order in code like foo(bar())?", "body": "<p>Assume we have code like this in C or C++:</p>\n\n<pre><code>foo(bar());\n</code></pre>\n\n<p>What is the function execution order in this case?</p>\n\n<ol>\n<li>Is it required that <code>bar()</code> is called first, and <code>foo()</code> is called no earlier than <code>bar()</code> returns, in which case <code>foo()</code> is passed the return value of <code>bar()</code>?</li>\n<li>Is it permitted that the compiler reorders the above, namely that it calls <code>foo()</code> first, and delays calling <code>bar()</code> until in the code of <code>foo()</code> the value of <code>foo()</code>\u2019s parameter is actually needed?</li>\n</ol>\n\n<p>Case 2 could be useful for optimization should <code>foo()</code> be defined like this:</p>\n\n<pre><code>void foo(someType par) {\n    if(someTest())\n        baz1();\n    else\n        baz2(par);\n}\n</code></pre>\n\n<p>In which case calling <code>bar()</code> could even be completely skipped if <code>someTest()</code> returns <code>false</code>.</p>\n\n<p>However, case 2 would also make the programmer have to be more careful, as it could sometimes lead to subtle bugs (for example with recurrence).</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1488398660, "post_id": 42540950, "comment_id": 72217710, "body": "It&#39;s the same reason the sky is blue: because <code>std::getline()</code>&#39;s second parameter is a <code>std::string</code> (well, <code>std::basic_string</code>, to be pedantic). That&#39;s what <code>std::getline()</code> is."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488398820, "post_id": 42540950, "comment_id": 72217796, "body": "So what&#39;s <i>from &#39;String&#39;</i> mentioned in the error message. Your own stuff?"}, {"owner": {"reputation": 7, "user_id": 7248961, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-g5hE0elbD6Q/AAAAAAAAAAI/AAAAAAAAHlA/aZ8oHBeAP0Q/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/7248961/nick"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488398895, "post_id": 42540950, "comment_id": 72217845, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 Yes, I made some realization for MY string"}, {"owner": {"reputation": 7, "user_id": 7248961, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-g5hE0elbD6Q/AAAAAAAAAAI/AAAAAAAAHlA/aZ8oHBeAP0Q/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/7248961/nick"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1488398954, "post_id": 42540950, "comment_id": 72217877, "body": "@SamVarshavchik And can&#39;t I find another variants except <code>getline()</code>"}, {"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1488398961, "post_id": 42540950, "comment_id": 72217883, "body": "Because <code>std::string</code> is not a <code>String</code> and a <code>String</code> is not a <code>std::string</code>. C++ 101."}], "answers": [{"tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": true, "score": 0, "last_activity_date": 1488400906, "creation_date": 1488400906, "answer_id": 42541646, "question_id": 42540950, "link": "https://stackoverflow.com/questions/42540950/using-getline-with-own-class-c/42541646#42541646", "title": "Using getline with own class C++", "body": "<p>You are welcome to write your own <code>getline</code> function that uses your string class:  </p>\n\n<pre><code>std::istream&amp;\nstd::getline(std::istream&amp; input_stream, My_String&amp; s, char delimiter = '\\n')\n{\n  //...\n  return input_stream;\n}\n</code></pre>\n\n<p>There are many advantages to using <code>std::string</code> instead of developing your own string class.</p>\n"}], "owner": {"reputation": 7, "user_id": 7248961, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-g5hE0elbD6Q/AAAAAAAAAAI/AAAAAAAAHlA/aZ8oHBeAP0Q/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/7248961/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "accepted_answer_id": 42541646, "answer_count": 1, "score": -1, "last_activity_date": 1488400906, "creation_date": 1488398518, "question_id": 42540950, "link": "https://stackoverflow.com/questions/42540950/using-getline-with-own-class-c", "title": "Using getline with own class C++", "body": "<p>Sorry,I create an own class of <code>string</code> with overloading operators and function <code>at()</code>. I created it for inluding it in another my class. I don't have problems with anything except one. </p>\n\n<p>My error is :</p>\n\n<pre><code>std::basic_istream&lt;_Elem,_Traits&gt;&amp;std::getline(std::basic_istream&lt;_Elem,_Traits&gt;&amp;,std::basic_string&lt;_Elem,_Traits,_Alloc&gt; &amp;)': could not deduce template argument for 'std::basic_string&lt;_Elem,_Traits,_Alloc&gt; &amp;' from 'String' \n</code></pre>\n\n<p>The problem is in <code>getline()</code> function. This function doesn't take MY <code>string</code> as an argument <code>str</code> .Can I find another close variant to <code>getline()</code> for reading my file with using <code>MY string</code>?</p>\n\n<p>Why can't <code>getline()</code> work with MY string, why does it wait for some real string?</p>\n\n<p>My function is: </p>\n\n<pre><code>void City::readRecordings(char *fileName, char *num, std::vector&lt;string&gt; lines)\n{\n\n    string str;\n    //std::ifstream fin(fileName);\n    readRecord &gt;&gt;str;\n    int readCount = 0;\n    int n = atoi(num);\n    readRecord.open(fileName);\n    while (!readRecord.eof())\n    {\n        std::getline(readRecord, str);/*here is Error, It can't use my String str , it waits for usual string*/\n        readCount++;\n        lines.push_back(str);\n    }\n\n    if (0 == readCount)\n    {\n        std::cout &lt;&lt; \"ERROR: The file, which you are trying to open, is empty or it stops out\" &lt;&lt; end;\n        exit(-1);\n    }\n    if (n &gt; readCount)\n    {\n        std::cout &lt;&lt; \"!Warning!\" &lt;&lt; end;\n        std::cout &lt;&lt; \"You want to read  \" &lt;&lt; n &lt;&lt; \" recordings\" &lt;&lt; \" But AVAILABLE: \" &lt;&lt; readCount &lt;&lt; \" recordings\" &lt;&lt; end;\n        printRecordsFromFile(readCount, lines);\n    }\n    else\n    {\n        printRecordsFromFile(n, lines);\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "boost"], "comments": [{"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1488402293, "post_id": 42540933, "comment_id": 72219821, "body": "Are they black also in Thread A?"}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "reply_to_user": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1488402446, "post_id": 42540933, "comment_id": 72219901, "body": "AH, changing <code>w_lock.release();</code> to <code>w_lock.unlock();</code> seems to have fixed it. Thanks for your time."}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1488402664, "post_id": 42540933, "comment_id": 72220005, "body": "Oh right, good catch. I usually prefer to use scoped locks (taking advantage of RAII), so I rarely need to unlock explicitly."}], "owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488398465, "creation_date": 1488398465, "question_id": 42540933, "link": "https://stackoverflow.com/questions/42540933/lock-webcam-frames-across-threads-using-boostthread", "title": "lock webcam frames across threads using boost::thread", "body": "<p>I am trying to use boost::lock to add thread safety to a camera read, but I am stuck. in Thread A, the frame writer, I have:</p>\n\n<p>.h</p>\n\n<pre><code>#include &lt;boost/thread/locks.hpp&gt; \n#include &lt;boost/thread/shared_mutex.hpp&gt; \n#include &lt;boost/system/config.hpp&gt;\n\ntypedef boost::shared_mutex Lock;\n    typedef boost::unique_lock&lt; Lock &gt; WriteLock;\n    typedef boost::shared_lock&lt; Lock &gt; ReadLock;\n    Lock OccamLock;\n</code></pre>\n\n<p>.cpp</p>\n\n<pre><code>    WriteLock w_lock(OccamLock); \n\n//calls frames from camera\n\n            cv::Mat f1 = cv::Mat_&lt;uchar&gt;(images[0]-&gt;height, images[0]-&gt;width, (uchar*)images[0]-&gt;data[0], images[0]-&gt;step[0]);\n\n\n            f1.copyTo(img0);\n\n            w_lock.release();\n</code></pre>\n\n<p>in Thread B, the reader, I have:</p>\n\n<p>.h</p>\n\n<pre><code>typedef boost::shared_mutex Lock;\n    typedef boost::unique_lock&lt; Lock &gt; WriteLock;\n    typedef boost::shared_lock&lt; Lock &gt; ReadLock;\n</code></pre>\n\n<p>.cpp</p>\n\n<pre><code>  ReadLock r_lock(oGrab-&gt;OccamLock);  //oGrab is the reference to the class in Thread A\n\n                imgs[0] = oGrab-&gt;img0;\n\n                r_lock.release();\n</code></pre>\n\n<p>This compiles, but the frames are black. Where am I screwing this up? (I am new to boost, please forgive idiocy)</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "class", "include"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1488397473, "post_id": 42540581, "comment_id": 72217012, "body": "This answers the question for user supplies includes: <a href=\"http://stackoverflow.com/questions/7347033/including-headers-inside-class-declaration-definition\" title=\"including headers inside class declaration definition\">stackoverflow.com/questions/7347033/&hellip;</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1488397513, "post_id": 42540581, "comment_id": 72217029, "body": "For standard headers IMHO you should only ever include them in the global space at the beginning of the header."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1488397578, "post_id": 42540581, "comment_id": 72217065, "body": "@NathanOliver This example uses a standard header. I can hardly imagine a scenario where including a standard header in a class definition would work."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1488397661, "post_id": 42540581, "comment_id": 72217105, "body": "@Fran&#231;oisAndrieux I believe you are right I&#39;m just not certain if it would never work."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1488397858, "post_id": 42540581, "comment_id": 72217224, "body": "@NathanOliver: Even if would always work, it certainly has no bearing on the proposed goal: <i>&quot;I wa[nt] it to be memory efficient.&quot;</i>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1488400737, "post_id": 42540581, "comment_id": 72218894, "body": "@NathanOliver <i>&quot;I&#39;m just not certain if it would never work.&quot;</i> Weird wrapper and template trickery? Not as long anything is consolidated in the <code>std</code> namespace. That cannot appear inside a class declaration."}], "answers": [{"tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": true, "score": 5, "last_activity_date": 1488397950, "last_edit_date": 1488397950, "creation_date": 1488397611, "answer_id": 42540660, "question_id": 42540581, "link": "https://stackoverflow.com/questions/42540581/is-it-possible-to-include-in-a-c-class/42540660#42540660", "title": "Is it possible to #include in a C++ class?", "body": "<blockquote>\n  <p>Is it possible to #include in a C++ class?</p>\n</blockquote>\n\n<p>As for your question title: It is possible, yes.</p>\n\n<p>You should note though that the c(++) preprocessor just expands the text from the <code>#include</code>'d file, and the c++ validation is checked in another phase of compilation.</p>\n\n<p>Code like</p>\n\n<pre><code>class FileInputOutput {\n#include &lt;fstream&gt;\n};\n</code></pre>\n\n<p>will inject all the text from <code>fstream</code> inside your class.</p>\n\n<p>That's most probably not what you want.</p>\n\n<p>Just to use the class declarations from <code>fstream</code> do</p>\n\n<pre><code>#include &lt;fstream&gt;\n\nclass FileInputOutput {\n    std::fstream fs;\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 1, "last_activity_date": 1488397661, "creation_date": 1488397661, "answer_id": 42540676, "question_id": 42540581, "link": "https://stackoverflow.com/questions/42540581/is-it-possible-to-include-in-a-c-class/42540676#42540676", "title": "Is it possible to #include in a C++ class?", "body": "<p><code>#include</code> just results in copy/paste of the included file contents by the preprocessor during compilation.\nSo yes, sure, you can do that, but it doesn't buy you anything efficiency wise. It's just as if you had written the contents of the included file directly inline in the including file.</p>\n"}, {"tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": false, "score": 2, "last_activity_date": 1488400019, "last_edit_date": 1488400019, "creation_date": 1488397804, "answer_id": 42540723, "question_id": 42540581, "link": "https://stackoverflow.com/questions/42540581/is-it-possible-to-include-in-a-c-class/42540723#42540723", "title": "Is it possible to #include in a C++ class?", "body": "<p>The Preprocessor in C++ (and in C) behaves by effectively copying the text of the referenced file into the file that used the <code>#include</code> statement.</p>\n\n<p>So when you write code like this:</p>\n\n<p>Something.h</p>\n\n<pre><code>int my_rand() {\n    return 4; //chosen by dice roll, guaranteed to be fair\n}\n</code></pre>\n\n<p>Main.cpp</p>\n\n<pre><code>#include \"Something.h\"\n\nint main() {\n    return my_rand();\n}\n</code></pre>\n\n<p>The final file before the proper compilation starts looks like this.</p>\n\n<pre><code>int my_rand() {\n    return 4; //chosen by dice roll, guaranteed to be fair\n}\n\nint main() {\n    return my_rand();\n}\n</code></pre>\n\n<p>In your case, writing something like</p>\n\n<pre><code>class my_class {\n    #include&lt;fstream&gt;\n/*...*/\n};\n</code></pre>\n\n<p>Will result in some very strange behavior, and will almost certainly not compile, because the entire contents of <code>&lt;fstream&gt;</code> will be copied into the middle of your class, and it's extremely unlikely that you've written your class in a way that will accomodate that, or that <code>&lt;fstream&gt;</code> is written to handle being injected into a different class.</p>\n\n<p>There are some cases where you can <code>#include</code> in the middle of your program like that, however. Observe:</p>\n\n<p>My Resource.txt</p>\n\n<pre><code>R\"D(\nBlah Blah Blah Blah Blah\n)D\"\n</code></pre>\n\n<p>Main.cpp</p>\n\n<pre><code>int main() {\n    std::string blah_string = \"\" //The \"\" is unnecessary, but I use it to make Intellisense shut up\n#include \"My Resource.txt\"\n    ;\n    std::cout &lt;&lt; blah_string &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>Which will correctly print out</p>\n\n<pre><code>Blah Blah Blah Blah Blah\n</code></pre>\n\n<p>To the console, because it's the same as writing</p>\n\n<pre><code>int main() {\n    std::string blah_string = \nR\"D(\nBlah Blah Blah Blah Blah\n)D\"\n    ;\n    std::cout &lt;&lt; blah_string &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 66, "user_id": 6436554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ECu1c.png?s=128&g=1", "display_name": "MysteryBlokHed", "link": "https://stackoverflow.com/users/6436554/mysteryblokhed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 42540660, "answer_count": 3, "score": -3, "last_activity_date": 1488400019, "creation_date": 1488397361, "question_id": 42540581, "link": "https://stackoverflow.com/questions/42540581/is-it-possible-to-include-in-a-c-class", "title": "Is it possible to #include in a C++ class?", "body": "<p>I have this header file for C++ that's supposed to make file input easier to code, but I was it to be memory efficient.\n<br>\nI have a class in my header file that looks like this:</p>\n\n<pre><code>class FileInputOutput {\n    #include &lt;fstream&gt;\n</code></pre>\n\n<p>But I'm not sure if it would include that anyways like the <code>#include</code> statements at the top, or if it would just include it when the class was called.\n<br>\n<br>\nCan anyone help me out?</p>\n"}, {"tags": ["c++", "function"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1488396831, "post_id": 42540352, "comment_id": 72216637, "body": "you defined <code>check</code> to take no parameters, but you are trying to call it with 3 parameters - so first you need to change that. Also <code>Angle a</code> inside <code>check</code> is not the same instance as <code>Angle a1</code> in <code>main</code>, so that quite likely won&#39;t do what you want it to do"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7622525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a6f48dd2478628c8ac01e008b9310a?s=128&d=identicon&r=PG&f=1", "display_name": "Boyer", "link": "https://stackoverflow.com/users/7622525/boyer"}, "edited": false, "score": 0, "creation_date": 1488397150, "post_id": 42540428, "comment_id": 72216842, "body": "Hmm, I could swear I tried that a while ago and it didn&#39;t work, and now it does... Weird.. Thanks anyway!"}], "tags": [], "owner": {"reputation": 6770, "user_id": 378418, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ea588ebbc4eaa80b537abe2af155308e?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/378418/luke"}, "is_accepted": true, "score": 0, "last_activity_date": 1488396802, "creation_date": 1488396802, "answer_id": 42540428, "question_id": 42540352, "link": "https://stackoverflow.com/questions/42540352/setting-arguments-in-function/42540428#42540428", "title": "Setting arguments in function", "body": "<p>You can see an example of a function taking an argument if you look at <code>set_degrees()</code>. Making <code>check()</code> take arguments would look something like this:</p>\n\n<pre><code>int check(int degrees, int minutes, int seconds) {\n    // (Use these values somehow)\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7622525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a6f48dd2478628c8ac01e008b9310a?s=128&d=identicon&r=PG&f=1", "display_name": "Boyer", "link": "https://stackoverflow.com/users/7622525/boyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 42540428, "answer_count": 1, "score": -2, "last_activity_date": 1488396854, "creation_date": 1488396522, "question_id": 42540352, "link": "https://stackoverflow.com/questions/42540352/setting-arguments-in-function", "title": "Setting arguments in function", "body": "<p>My code is this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string.h&gt;\nusing namespace std;\n\nclass Angle {\n    private:\n        int degrees, minutes, seconds;\n    public:\n        Angle(){} //required in the assignment \n        Angle(int degrees, int minutes, int seconds){\n            this-&gt;degrees=degrees;\n            this-&gt;minutes=minutes;\n            this-&gt;seconds=seconds;\n        }\n\n        void set_degrees(int const degrees){\n            this-&gt;degrees=degrees;\n        }\n        void set_minutes(int const minutes){\n            this-&gt;minutes=minutes;\n        }\n        void set_seconds(int const seconds){\n            this-&gt;seconds=seconds;\n        }\n\n    int getDegrees(){\n        return degrees;\n    }\n    int getMinutes(){\n        return minutes;\n    }\n    int getSeconds(){\n        return seconds;\n    }\n\n    int to_seconds(){\n        return degrees*3600+minutes*60+seconds; \n    }\n};\n\nint check(){\n    Angle a;\n    if (a.getDegrees()&lt;360 &amp;&amp; a.getMinutes()&lt;60 &amp;&amp; a.getSeconds()&lt;60) return 1;  \n    else return 0;\n}\n\nint main() {\n\n    Angle a1;\n    int deg, min, sec;\n    cin &gt;&gt; deg &gt;&gt; min &gt;&gt; sec;\n\n    if (check(deg, min, sec)) {\n\n        a1.set_degrees(deg);\n        a1.set_minutes(min);\n        a1.set_seconds(sec);\n        cout &lt;&lt; a1.to_seconds();\n\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I don't know how to set the arguments in the <code>check</code> function so it will work in it's implementation in the main function. I can't change anything in the main function because it's preset by my professor, assuming I can't place it in the <code>Angle</code> class. I get a \"Too many arguments to function <code>int check()</code>\" error.</p>\n"}, {"tags": ["c++", "arrays", "pointers", "dynamic"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1488397026, "post_id": 42540277, "comment_id": 72216758, "body": "Don&#39;t miss out on this wonderful answer about memory and undefined behavior. <a href=\"http://stackoverflow.com/questions/6441218/can-a-local-variables-memory-be-accessed-outside-its-scope/6445794#6445794\" title=\"can a local variables memory be accessed outside its scope\">stackoverflow.com/questions/6441218/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3943076"}, "edited": false, "score": 0, "creation_date": 1488396748, "post_id": 42540354, "comment_id": 72216592, "body": "Let&#39;s imagine that I remove the elements from the vector which I want to delete (pa.pop_back(); delete[] a). Is it totally safe?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1488396897, "post_id": 42540354, "comment_id": 72216682, "body": "That makes <code>pa</code> completely safe, but you still have to know that you can&#39;t dereference <code>a</code> anymore without reassigning it."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1488396527, "creation_date": 1488396527, "answer_id": 42540354, "question_id": 42540277, "link": "https://stackoverflow.com/questions/42540277/what-happens-when-i-delete-dynamic-array/42540354#42540354", "title": "What happens when I delete dynamic array?", "body": "<p>Your statement about how delete[] works is backwards. It deletes the elements but not the pointer. Continuing to use the pointer after its contents have been deleted, as you're doing, is undefined behavior. This means that literally anything is allowed to happen if you do it, so you shouldn't do it. It's by pure luck that you can still access the elements now, and bad things will happen in the future if you do it.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3943076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "closed_date": 1488396942, "answer_count": 1, "score": 0, "last_activity_date": 1488396527, "creation_date": 1488396244, "last_edit_date": 1488396406, "question_id": 42540277, "link": "https://stackoverflow.com/questions/42540277/what-happens-when-i-delete-dynamic-array", "closed_reason": "Duplicate", "title": "What happens when I delete dynamic array?", "body": "<p>I made a dynamic array (example):</p>\n\n<pre><code>int *a;\na = new int[3];\na[0] = 10; a[1] = 20; a[2] = 30;\n</code></pre>\n\n<p>Than I create a vector which stores pointers:</p>\n\n<pre><code>vector&lt;int*&gt; pa;\npa.push_back(&amp;a[0]);\n</code></pre>\n\n<p>After I deleted (freed) the memory with \"delete[] a;\", I can still access to the  element, that I push_backed. (cout &lt;&lt; *pa[0]; output: 10)</p>\n\n<p>Why is this happen? When I \"delete[] a\", it only deletes the pointer to the elements, but the elements are still accessable?</p>\n"}, {"tags": ["python", "c++"], "comments": [{"owner": {"reputation": 3189, "user_id": 7016303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dYmXc.jpg?s=128&g=1", "display_name": "Mikel F", "link": "https://stackoverflow.com/users/7016303/mikel-f"}, "edited": false, "score": 0, "creation_date": 1488396154, "post_id": 42540201, "comment_id": 72216231, "body": "You need to do some research on IPC (Interprocess communications) mechanisms."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1488396161, "post_id": 42540201, "comment_id": 72216234, "body": "have you looked at C++ bindings for python? You can call a C++ class/method/function from within python"}, {"owner": {"reputation": 455, "user_id": 4533695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36609bdd5d2040262013fd57ef71b4c?s=128&d=identicon&r=PG", "display_name": "Ceros", "link": "https://stackoverflow.com/users/4533695/ceros"}, "edited": false, "score": 1, "creation_date": 1488396202, "post_id": 42540201, "comment_id": 72216246, "body": "You can not pass a pointer as the address is only valid for the owning process."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1488396207, "post_id": 42540201, "comment_id": 72216251, "body": "The most common methods are named pipes and memory mapping."}], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 4533695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36609bdd5d2040262013fd57ef71b4c?s=128&d=identicon&r=PG", "display_name": "Ceros", "link": "https://stackoverflow.com/users/4533695/ceros"}, "edited": false, "score": 0, "creation_date": 1488396872, "post_id": 42540332, "comment_id": 72216665, "body": "Websocket or RESTful with CppRest (Casablanca)"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 455, "user_id": 4533695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36609bdd5d2040262013fd57ef71b4c?s=128&d=identicon&r=PG", "display_name": "Ceros", "link": "https://stackoverflow.com/users/4533695/ceros"}, "edited": false, "score": 0, "creation_date": 1488397514, "post_id": 42540332, "comment_id": 72217030, "body": "@Ceros that&#39;s just sockets (as I already mentioned) just with an extra protocol layer on top."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": true, "score": 3, "last_activity_date": 1488397280, "last_edit_date": 1488397280, "creation_date": 1488396419, "answer_id": 42540332, "question_id": 42540201, "link": "https://stackoverflow.com/questions/42540201/pass-data-from-one-exe-to-another/42540332#42540332", "title": "Pass Data from One .exe to Another", "body": "<p>There are <em>many</em> ways two executables can exchange data.</p>\n\n<p>Some examples:</p>\n\n<ul>\n<li><p>write/read data to/from a shared file (don't forget locking so they don't stumble on eachother).</p></li>\n<li><p>use TCP or UDP sockets between the processes to exchange data.</p></li>\n<li><p>use shared memory.</p></li>\n<li><p>if one application starts the other you can pass data via commandline arguments or in the environment.</p></li>\n<li><p>use pipes between the processes.</p></li>\n<li><p>use Unix domain sockets between the processes.</p></li>\n</ul>\n\n<p>And there are more options but the above are probably the most common ones.</p>\n\n<p>What you need to research is IPC (Inter-Process Communication).</p>\n"}], "owner": {"reputation": 41, "user_id": 3034822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1137810154/picture?type=large", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3034822/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 42540332, "answer_count": 1, "score": 0, "last_activity_date": 1488611859, "creation_date": 1488395993, "last_edit_date": 1488611859, "question_id": 42540201, "link": "https://stackoverflow.com/questions/42540201/pass-data-from-one-exe-to-another", "title": "Pass Data from One .exe to Another", "body": "<p>I'm relatively inexperienced with C++, but I need to build a framework to shuffle some data around. Not necessarily relevant, but the general flow path of my data needs to go like this:</p>\n\n<ol>\n<li>Data is generated in a python script</li>\n<li>The python object is passed to a compiled C++ extension</li>\n<li>The C++ extension makes some changes and passes the data (presumably a pointer?) to compiled C++/CUDA code (.exe)</li>\n<li>C++/CUDA .exe does stuff</li>\n<li>Data is handled back in the python script and sent to more python functions</li>\n</ol>\n\n<p>Step 3. is where I'm having trouble. How would I go about calling the .exe containing the CUDA code in a way that it can access the data that is seen in the C++ python extension? I assume I should be able to pass a pointer somehow, but I'm having trouble finding resources that explain how. I've seen references to creating shared memory, but I'm unclear on the details there, as well.</p>\n"}, {"tags": ["c++", "stl", "containers", "unions", "c++17"], "answers": [{"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 2, "last_activity_date": 1488398406, "last_edit_date": 1488398406, "creation_date": 1488397006, "answer_id": 42540478, "question_id": 42540198, "link": "https://stackoverflow.com/questions/42540198/union-instead-of-aligned-storage-t-as-part-of-node-type-of-container/42540478#42540478", "title": "union instead of aligned_storage_t as part of node type of container", "body": "<p>First, the closer analogue is actually:</p>\n\n<pre><code>union U\n{\n    U() { }\n    ~U() { }\n    T value;\n};\n</code></pre>\n\n<p>in case <code>T</code> isn't trivially destructible. </p>\n\n<p>That said, the <code>union</code> is going to be necessary when you want a literal type. Can't use placement-new in a <code>constexpr</code> constructor so that's out to start with. That's a big win in that direction.</p>\n\n<p>One advantage of <code>aligned_storage_t</code> is that you don't need to worry the potential of <code>T</code> overloading <code>operator&amp;()</code>. <code>new (&amp;u.value) T</code> might do something weird and might not compile at all. <code>new (&amp;storage) T</code> doesn't have that problem, while being more ergonomic than <code>new (std::addressof(u.value)) T</code>. </p>\n"}], "owner": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 42540478, "answer_count": 1, "score": 3, "last_activity_date": 1490543868, "creation_date": 1488395991, "last_edit_date": 1490543868, "question_id": 42540198, "link": "https://stackoverflow.com/questions/42540198/union-instead-of-aligned-storage-t-as-part-of-node-type-of-container", "title": "union instead of aligned_storage_t as part of node type of container", "body": "<p>Containers <code>std::list&lt; T &gt;/std::map&lt; T &gt;/std::set&lt; T &gt;</code> (not full list) to store an elements uses <em>node types</em>, which differs from <code>T</code>, as opposite to, say, <code>std::vector</code> or <code>std::array</code>.</p>\n\n<p>If I pass some allocator <code>A</code> to them, then it will be \"converted\" to <code>node_allocator_type</code> by means of something like:</p>\n\n<pre><code>using allocator_traits = typename std::allocator_traits&lt; A &gt;::template rebind_traits&lt; node_type &gt;;\nusing node_allocator_type = typename allocator_traits::allocator_type;\n</code></pre>\n\n<p>Standard library implementations (<a href=\"https://github.com/llvm-mirror/libcxx/blob/master/include/__tree\" rel=\"nofollow noreferrer\">libc++</a>, <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/stl_tree.h#L230\" rel=\"nofollow noreferrer\">libstdc++</a>) may use an analogue of <a href=\"http://en.cppreference.com/w/cpp/types/aligned_storage\" rel=\"nofollow noreferrer\"><code>std::aligned_storage_t&lt; sizeof(T), alignof(T) &gt;</code></a> as a constituent of the <em>node type</em> as a place to store value of type <code>T</code>. \"Past the end\" or \"root\" elements may have no storage for a value of type <code>T</code>. Life circle of the value is \"manually\" managed by containers by means of using in-place <code>::operator new</code> and manual calling of a destructor finally.</p>\n\n<p>Is it valid to use single-element <code>union</code> in form</p>\n\n<pre><code>union U\n{\n    U() { ; }\n    T value;\n};\n</code></pre>\n\n<p>instead of <code>std::aligned_storage_t&lt; sizeof(T), alignof(T) &gt;</code>?</p>\n\n<p>Which properties of <code>std::aligned_storage_t</code> (internally it may be implemented as a properly aligned array of type <code>char [sizeof(T)];</code>) are crucial in the mentioned use case and prevail over all potential advantages of the above <code>union</code>?</p>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1488395516, "post_id": 42540036, "comment_id": 72215819, "body": "The set stores the comparator.  How would it store it if it does not know the type?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 2, "creation_date": 1488395597, "post_id": 42540036, "comment_id": 72215870, "body": "<code>std::set&lt;T, std::function&lt;bool(T, T)&gt;&gt;</code> seems close to what you want. You can plug a more or less arbitrary comparator into this at runtime."}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 5, "creation_date": 1488395617, "post_id": 42540036, "comment_id": 72215880, "body": "Comparisons are really cheap operations for many types. Imposing a mandatory dynamic dispatch to make choice of order at run-time would cause significant performance degradation (that was certainly true at the time the class templates were defined but I&#39;m pretty sure that is still true). You can choose to have a binary predicate which does dynamic dispatch, e.g., using <code>std::function&lt;bool(T const&amp;, T const&amp;)&gt;</code> if you feel you need t use different choices."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1488395775, "post_id": 42540036, "comment_id": 72215965, "body": "@Igor I don&#39;t think that would work because you have no way of actually assigning that function."}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 3, "creation_date": 1488395888, "post_id": 42540036, "comment_id": 72216043, "body": "@zett42: <code>std::set</code> (and the other associative containers in the standard library) have a constructor overload taking the comparison object."}, {"owner": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "edited": false, "score": 0, "creation_date": 1488395991, "post_id": 42540036, "comment_id": 72216108, "body": "Igor/Dietmar why not answer?  I think this is good, thanks."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1488396872, "post_id": 42540036, "comment_id": 72216666, "body": "@Dietmar, cool! Another day on SO, learned something new. <a href=\"http://coliru.stacked-crooked.com/a/d2354d7491800d30\" rel=\"nofollow noreferrer\">And it actually works</a>."}], "answers": [{"comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488397240, "post_id": 42540448, "comment_id": 72216890, "body": "Great, but credits should be given to Dietmar who came up with this idea originally. So no vote from me."}, {"owner": {"reputation": 23041, "user_id": 1149664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac4f96b553d2e45776bd6235fee4222d?s=128&d=identicon&r=PG", "display_name": "Johan Lundberg", "link": "https://stackoverflow.com/users/1149664/johan-lundberg"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488397506, "post_id": 42540448, "comment_id": 72217023, "body": "This is not a new thing... I did give credit to the commenters and now also added their names."}], "tags": [], "owner": {"reputation": 23041, "user_id": 1149664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac4f96b553d2e45776bd6235fee4222d?s=128&d=identicon&r=PG", "display_name": "Johan Lundberg", "link": "https://stackoverflow.com/users/1149664/johan-lundberg"}, "is_accepted": false, "score": 2, "last_activity_date": 1488398866, "last_edit_date": 1488398866, "creation_date": 1488396876, "answer_id": 42540448, "question_id": 42540036, "link": "https://stackoverflow.com/questions/42540036/why-is-stl-set-comparator-only-specified-via-template/42540448#42540448", "title": "why is STL set comparator only specified via template?", "body": "<p>As pointed out in the comments (igor and dietmar) you can do this via <code>std::function</code>:</p>\n\n<pre><code>#include &lt;set&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;typename T&gt;\nusing Dynamic_set= std::set&lt;T, std::function&lt;bool(const T&amp;, const T&amp;)&gt;&gt;;\n\nint main(int argc, char **argv)\n{  \n   auto absSet = Dynamic_set&lt;int&gt;([](const auto&amp;a, const auto&amp;b){ return abs(a)&lt;abs(b) ;});\n   absSet.emplace(1);\n   absSet.emplace(2);\n   absSet.emplace(-1);\n   std::cout &lt;&lt; absSet.size() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>prints <code>2</code>. Note that using auto as above avoids <em>most vexing parse</em> issues.</p>\n\n<p>More general:</p>\n\n<pre><code>template&lt;typename Key, typename Allocator = std::allocator&lt;Key&gt;&gt;\nusing Dynamic_set= std::set&lt;Key, std::function&lt;bool(const Key&amp;, const Key&amp;)&gt;, Allocator&gt;;\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/e48db498d81f2945\" rel=\"nofollow noreferrer\">Live demo</a> </p>\n"}, {"comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1488397184, "post_id": 42540460, "comment_id": 72216863, "body": "<a href=\"http://coliru.stacked-crooked.com/a/8a959d8227db4842\" rel=\"nofollow noreferrer\">Live demo</a> based on your idea. Almost the same except that I created some alias templates to make the solution easily reusable."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488397609, "post_id": 42540460, "comment_id": 72217084, "body": "It would be interesting to compare performance of static vs. dynamic comparator."}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488400290, "post_id": 42540460, "comment_id": 72218657, "body": "@zett42: I added a benchmark for a dynamic comparison function to <a href=\"https://github.com/dietmarkuehl/cputube/blob/master/cpu/test/search-integer.cpp\" rel=\"nofollow noreferrer\">github.com/dietmarkuehl/cputube/blob/master/cpu/test/&hellip;</a> It indicates that the overhead for small sets is rather large. For large sets a visible impact remains but it isn&#39;t as significant. The main caveat with my results is that I currently have only access to a computer which isn&#39;t really suitable for doing interesting benchmarks but I&#39;d think the results wouldn&#39;t be that different on a &quot;real&quot; computer."}], "tags": [], "owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "is_accepted": true, "score": 5, "last_activity_date": 1488397920, "last_edit_date": 1488397920, "creation_date": 1488396919, "answer_id": 42540460, "question_id": 42540036, "link": "https://stackoverflow.com/questions/42540036/why-is-stl-set-comparator-only-specified-via-template/42540460#42540460", "title": "why is STL set comparator only specified via template?", "body": "<p>For many uses, the default choice of comparison, i.e., using <code>std::less&lt;T&gt;</code> which uses <code>a &lt; b</code> works very well. This comparison doesn't do any dynamic dispatch which would allow a choice of order without affecting the type because the dynamic dispatch would likely cause a performance degradation. Adding a dynamic dispatch certainly caused a performance degradation at the time the interface was defined and I'd think it is still true and unlikely to go away entirely.</p>\n\n<p>If you want to choose the order without affecting the type you can use <code>std::function&lt;bool(T const&amp;, T const&amp;)&gt;</code> (or <code>std::function&lt;bool(T, T)&gt;</code> if <code>T</code> happens to be a cheap to copy type like the built-in types). You'd need to specify the comparison object as a constructor argument in this case. For example:</p>\n\n<pre><code>std::set&lt;int, std::function&lt;bool(int, int)&gt;&gt; values{std::less&lt;int&gt;()};\n</code></pre>\n\n<p>Note that the above code uses curlies as otherwise it would be a function declaration rather than an object definition. Also note that assigning a <code>std:set&lt;int, std::function&lt;bool(int, int)&gt;&gt;</code> to another one with different comparison function will not work: the code would compile but the assignment will create a set which is incorrectly ordered. For example:</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n#include &lt;set&gt;\n\nint main() {\n    std::set&lt;int, std::function&lt;bool(int, int)&gt;&gt; values1{std::less&lt;int&gt;()};\n    values1.insert(1);\n    values1.insert(2);\n    values1.insert(3);\n    std::set&lt;int, std::function&lt;bool(int, int)&gt;&gt; values2{std::greater&lt;int&gt;()};\n    values2 = values1;\n    for (auto v: values2) {\n        std::cout &lt;&lt; v &lt;&lt; '\\n';\n    }\n}\n</code></pre>\n\n<p>This prints the values in ascending order although it should print them in descending order.</p>\n"}], "owner": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "accepted_answer_id": 42540460, "answer_count": 2, "score": 3, "last_activity_date": 1488398866, "creation_date": 1488395382, "question_id": 42540036, "link": "https://stackoverflow.com/questions/42540036/why-is-stl-set-comparator-only-specified-via-template", "title": "why is STL set comparator only specified via template?", "body": "<p>The only way to supply custom comparator to the std::set container is via the template specialization.  Which means that the comparator detail will leak to all users of the set.  Is there a way around it and why such a strange decision choice was made?  Shouldn't I be able to have a method which returns a set ordered to my liking but w/o everyone having to know what the ordering is?</p>\n"}, {"tags": ["python", "c++", "arrays", "fedora-25"], "comments": [{"owner": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "edited": false, "score": 0, "creation_date": 1488398017, "post_id": 42539958, "comment_id": 72217319, "body": "If you were missing the definition of PyArray_SimpleNewFromData, you would have a compiling error.  If you&#39;re getting a segmentation violation, this issue is likely entirely a C++ issue.  Does <code>b</code> look like a valid pointer?  Are you sure that <code>size</code> is not set too big?  If it&#39;s the memory-size of <code>b</code>, then maybe you need to set <code>dims[0] = size&#47;sizeof(int16_t)</code>?"}, {"owner": {"reputation": 9, "user_id": 7643203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868fda30231a4fd24188c257c1b685f1?s=128&d=identicon&r=PG&f=1", "display_name": "janK", "link": "https://stackoverflow.com/users/7643203/jank"}, "reply_to_user": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "edited": false, "score": 0, "creation_date": 1488442371, "post_id": 42539958, "comment_id": 72235107, "body": "Solved. It turned out that I should have called &quot;import_array ()&quot; in the initialization. So, the numpy/array part was not initialized"}, {"owner": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "edited": false, "score": 0, "creation_date": 1488469725, "post_id": 42539958, "comment_id": 72254011, "body": "Comments on Stack Overflow are considered ephemeral; they aren&#39;t guaranteed to exist from one point to another.  You should write up (and later accept) a detailed answer to this.  The goal of questions in Stack Overflow is to not only solve your problem, but help people in the future who have a similar problem.  Self-answering is allowed, and doing so will make it more clear that your problem had a solution (as well as giving you a bit of reputation and ensuring that the answer is available in a more permanent field.)"}], "owner": {"reputation": 9, "user_id": 7643203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868fda30231a4fd24188c257c1b685f1?s=128&d=identicon&r=PG&f=1", "display_name": "janK", "link": "https://stackoverflow.com/users/7643203/jank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1492365893, "creation_date": 1488395144, "last_edit_date": 1492365893, "question_id": 42539958, "link": "https://stackoverflow.com/questions/42539958/handling-c-array-in-python-a-crash", "title": "Handling C array in Python, a crash", "body": "<p>I have a C++ library, handling the reading and processing of DAB data (prety large, multithreading)\nI am writing (trying to write) a Python interface for that. The interface contains some callbacks, one for the audio. That one is called from within the library with as parameters a C array with PCM samples, the number of samples and the samplerate. To \"transfer\" the data to the Python interface the C array is \"Python\"-ed, and the C callback calls then a Python function (the reference of which is passed earlier on)</p>\n\n<p>The question is that I am probably doing something wrong since the library - when called from Python - crashes on precise the PyArray_SimpleNewFromData  call.\nTo me - a newby in Python - it would seem that a C library containing the implementation of PyArray_SimpleNewFromData (which actually seems a macro) is missing (the error is consistently a segmentation violation.</p>\n\n<p>If so, is there a library that I am missing (and where to find that?)</p>\n\n<p>My system:\nFedora 25, 64b\nPython 3.5</p>\n\n<pre><code>void    callback_audio (int16_t *b, int size, int rate) {\n\n    PyObject *arglist;\n\n    PyObject *result;\n\n    PyObject *theArray;\n\n    PyGILState_STATE gstate;\n\n    npy_intp dims [1];\n\n    dims [0] = size;\n\n    if (size == 0)\n        return;\n\n    gstate  = PyGILState_Ensure ();\n\n    theArray = PyArray_SimpleNewFromData (1, dims, NPY_SHORT, (void *)b);\n\n    arglist = Py_BuildValue (\"Oh\", theArray, rate);\n\n    result  = PyEval_CallObject (callbackAudio, arglist);\n\n    Py_DECREF (arglist);\n\n    Py_DECREF (theArray);\n\n    PyGILState_Release (gstate);\n\n}\n</code></pre>\n\n<p>Any help appreciated</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "qt", "graph", "qgraphicsview", "qgraphicsscene"], "comments": [{"owner": {"reputation": 2002, "user_id": 2763000, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a5ea0af3a37d8989110a8fb4c656efb2?s=128&d=identicon&r=PG&f=1", "display_name": "goug", "link": "https://stackoverflow.com/users/2763000/goug"}, "edited": false, "score": 0, "creation_date": 1488395764, "post_id": 42539905, "comment_id": 72215961, "body": "It&#39;s not very clear what you want. All of these coordinate systems are relative to each other and for any given implementation of mousePressEvent, either for widgets or for scene items, you&#39;ll be working in that object&#39;s coordinate system. If you want the mouse event in scene coordinates, then reimplement QGraphicsScene::mousePressEvent. If you want them in view coordinates, them reimplement QGraphicsView::mousePressEvent, and so on. I would read &quot;true position on graphic scene&quot; as implying that QGraphicsScene::mousePressEvent is the right place, but it&#39;s not clear."}, {"owner": {"reputation": 83, "user_id": 4885271, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1120053238010749/picture?type=large", "display_name": "cherioss", "link": "https://stackoverflow.com/users/4885271/cherioss"}, "reply_to_user": {"reputation": 2002, "user_id": 2763000, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a5ea0af3a37d8989110a8fb4c656efb2?s=128&d=identicon&r=PG&f=1", "display_name": "goug", "link": "https://stackoverflow.com/users/2763000/goug"}, "edited": false, "score": 0, "creation_date": 1488395870, "post_id": 42539905, "comment_id": 72216033, "body": "thanks, I&#39;ll try it."}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1488396380, "post_id": 42539905, "comment_id": 72216372, "body": "Why handle events on the top-level window? The purpose of the graphics scene system is to provide items that you can interact with. You can have all sorts of interaction with the items themselves - they were designed to make that easy."}, {"owner": {"reputation": 83, "user_id": 4885271, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1120053238010749/picture?type=large", "display_name": "cherioss", "link": "https://stackoverflow.com/users/4885271/cherioss"}, "edited": false, "score": 0, "creation_date": 1488398338, "post_id": 42539905, "comment_id": 72217521, "body": "Beacause I am noob with Qt, I don&#39;t know Qt and it&#39;s my first advanced GUI app."}], "answers": [{"tags": [], "owner": {"reputation": 25560, "user_id": 2068642, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/DYTnZ.jpg?s=128&g=1", "display_name": "TheDarkKnight", "link": "https://stackoverflow.com/users/2068642/thedarkknight"}, "is_accepted": false, "score": 4, "last_activity_date": 1488464725, "last_edit_date": 1488464725, "creation_date": 1488451086, "answer_id": 42553049, "question_id": 42539905, "link": "https://stackoverflow.com/questions/42539905/qt-qgraphicview-and-qgraphicscene-mouse-position/42553049#42553049", "title": "Qt QGraphicView and QGraphicScene mouse position", "body": "<p>QGraphics, like other graphics frameworks, uses multiple coordinate systems and you need to consider which system you're working in when dealing with coordinates.</p>\n\n<p>We can think of a <code>QGraphicsScene</code>as a world, within which there are objects that are represented by <code>QGraphicsItem</code>s ( or <code>QGraphicsObject'</code>s. if you want them to use signals and slots).</p>\n\n<p>To view an area of the world, we use one or more <code>QGraphicsView</code>s.</p>\n\n<p>In order to map between the different coordinate systems, Qt provides the useful mapTo and mapFrom functions.</p>\n\n<p>Starting at the top, with a QGraphicsView, we can convert a coordinate and use <code>QGraphicsView::mapToScene</code> to get the coordinate in the scene's coordinate system. From this, if an item resides at that coordinate, we can get the coordinate relative to the item, using <code>QGraphicsItem::mapFromScene</code>.</p>\n\n<p>So, with the three levels (view, scene and item) think about which system the coordinate is in and where you want to be dealing with it.</p>\n\n<blockquote>\n  <p>how get true position on graphic scene?</p>\n</blockquote>\n\n<p>Hopefully you should now be thinking that the coordinate you have been provided in the MainWindow is in the view's coordinate system and you can <strong>map to</strong> the <strong>scene's</strong> coordinate system.</p>\n\n<pre><code>QPointF scenePoint = mapToScene(event-&gt;Pos());\n</code></pre>\n\n<p>However, this is overcomplicating things and you'll find it easier to work directly with the scene and the items it contains, by overloading the item's own mouseMove/Press/Release events, which provide <code>QGraphicsScene</code> coordinates.</p>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 4885271, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1120053238010749/picture?type=large", "display_name": "cherioss", "link": "https://stackoverflow.com/users/4885271/cherioss"}, "is_accepted": true, "score": -2, "last_activity_date": 1492268446, "creation_date": 1492268446, "answer_id": 43427565, "question_id": 42539905, "link": "https://stackoverflow.com/questions/42539905/qt-qgraphicview-and-qgraphicscene-mouse-position/43427565#43427565", "title": "Qt QGraphicView and QGraphicScene mouse position", "body": "<p>I solved this problem with make my object, which inherit QGraphicView (MyQGraphicView) and then I declared function mousePressedEvent for this object. This help me.</p>\n"}], "owner": {"reputation": 83, "user_id": 4885271, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1120053238010749/picture?type=large", "display_name": "cherioss", "link": "https://stackoverflow.com/users/4885271/cherioss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1628, "favorite_count": 0, "accepted_answer_id": 43427565, "answer_count": 2, "score": 0, "last_activity_date": 1492268446, "creation_date": 1488394956, "question_id": 42539905, "link": "https://stackoverflow.com/questions/42539905/qt-qgraphicview-and-qgraphicscene-mouse-position", "title": "Qt QGraphicView and QGraphicScene mouse position", "body": "<p>I have project which display inner structure of ELF binary files. I use QGraphicsView and QGraphicsScene. So I can display blocks on graphics scene, but I need after mouse click on single block display content of this block. I am trying use function:</p>\n\n<pre><code>void MainWindow::mousePressEvent(QMouseEvent* event)\n{\n   ui-&gt;textEdit-&gt;append(QString(\"x = %1, y = %2\").arg(event-&gt;Pos().x()).arg(event-&gt;Pos().y()));\n}\n</code></pre>\n\n<p>But position is tracking in whole window. Problem is, that width and height of window is dynamical and height of QGraphicsScene may be greater than window's. So I can't track single block.</p>\n\n<p>I tryed some function like:\nmapFromScene, mapToScene, mapFromGlobal, ... but I don't know, how theese functions works, but position what I get wasn't right.</p>\n\n<p>It occurred to me that position should be calculated by scrollbar of QGraphicalView and size of window, but it's hard to calculated precisely and it's not correct solution.</p>\n\n<p>Some idea, how get true position on graphic scene? Thanks for any help.</p>\n"}, {"tags": ["c++", "c++builder", "firemonkey", "c++builder-10.1-berlin"], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1488395515, "creation_date": 1488395515, "answer_id": 42540074, "question_id": 42539885, "link": "https://stackoverflow.com/questions/42539885/firemonkey-custom-control-click-events-firing-in-designer/42540074#42540074", "title": "Firemonkey custom control click events firing in designer", "body": "<p>Use the <a href=\"http://docwiki.embarcadero.com/Libraries/en/System.Classes.TComponent.ComponentState\" rel=\"nofollow noreferrer\"><code>ComponentState</code></a> property.  It has a <code>csDesigning</code> flag enabled when your control is being used in the Form Designer.</p>\n\n<pre><code>void __fastcall MyControl::SubControlClick(TObject *Sender)\n{\n    if( !ComponentState.Contains(csDesigning) )\n    {\n         //do stuff here\n    }\n}\n</code></pre>\n\n<p>Alternatively, simply don't assign the <code>OnClick</code> handlers at design-time to begin with:</p>\n\n<pre><code>__fastcall MyControl::MyControl(TComponent *Owner)\n    : TBaseControl(Owner)\n{\n    ...\n    FSubControl = new TWhatever(this);\n    if( !ComponentState.Contains(csDesigning) )\n        FSubControl-&gt;OnClick = &amp;SubControlClick;\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 2790, "user_id": 3298987, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Xxzcp.png?s=128&g=1", "display_name": "James Hogle", "link": "https://stackoverflow.com/users/3298987/james-hogle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 42540074, "answer_count": 1, "score": 0, "last_activity_date": 1488395515, "creation_date": 1488394889, "question_id": 42539885, "link": "https://stackoverflow.com/questions/42539885/firemonkey-custom-control-click-events-firing-in-designer", "title": "Firemonkey custom control click events firing in designer", "body": "<p>I have a custom Firemonkey control that has several sub components.  These sub components have OnClick events associated with them that are setup in the control's constructor. I have noticed that when I click on the custom control in my design view, the OnClick events of these sub components are getting fired.  </p>\n\n<p>Is there a particular setting or best practice I need to employ to prevent this from happening?</p>\n\n<p>Is there something I can check in my C++ code to see if this event is being run in the designer vs at run time? Something like:</p>\n\n<pre><code>void __fastcall MyControlOnClick( TObject * Sender )\n{\n    if( InDesigner == false )\n    {\n         //do stuff here\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "rvalue-reference", "rvalue", "pass-by-rvalue-reference"], "comments": [{"owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "edited": false, "score": 1, "creation_date": 1488394778, "post_id": 42539808, "comment_id": 72215345, "body": "<a href=\"https://isocpp.org/blog/2012/11/universal-references-in-c11-scott-meyers\" rel=\"nofollow noreferrer\">isocpp.org/blog/2012/11/&hellip;</a>"}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 2, "creation_date": 1488395037, "post_id": 42539808, "comment_id": 72215490, "body": "Your arguments <code>A1</code> and <code>A2</code> are <b>not</b> rvalue references! Instead, they are <i>forwarding references</i>. These are something <i>entirely</i> different which just happens to use a similar looking syntax."}], "owner": {"reputation": 741, "user_id": 1773011, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/274b28985e391bb9d3d9bf53f8bc7b7c?s=128&d=identicon&r=PG", "display_name": "lightrek", "link": "https://stackoverflow.com/users/1773011/lightrek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "closed_date": 1488395446, "answer_count": 0, "score": 0, "last_activity_date": 1488394654, "creation_date": 1488394654, "last_edit_date": 1592644375, "question_id": 42539808, "link": "https://stackoverflow.com/questions/42539808/an-rvalue-reference-can-only-bind-to-non-const-rvalues", "closed_reason": "Duplicate", "title": "An rvalue reference can only bind to non-const rvalues?", "body": "<p>Previous post indicated a rvalue reference can only bind to non-const rvalues:\n<a href=\"https://stackoverflow.com/questions/15681691/difference-between-returning-a-const-reference-and-rvalue-reference#comment22263043_15681727\">Difference between returning a const reference and rvalue reference</a></p>\n<p>However, if that's true, how <a href=\"https://msdn.microsoft.com/en-us/library/dd293668.aspx\" rel=\"nofollow noreferrer\">perfect forwarding</a> works?</p>\n<p>For this definition for <a href=\"https://msdn.microsoft.com/en-us/library/dd293668.aspx\" rel=\"nofollow noreferrer\">perfect forwarding</a>:</p>\n<pre><code>template &lt;typename T, typename A1, typename A2&gt;  \nT* factory(A1&amp;&amp; a1, A2&amp;&amp; a2)  \n{  \n   return new T(std::forward&lt;A1&gt;(a1), std::forward&lt;A2&gt;(a2));  \n}  \n</code></pre>\n<p>It seems the factory function could take any types of data: const lvalue, lvalue, rvalue.</p>\n<p>(P.S. seems rvalue reference could do everything, but I rarely see code write by other using it, why not? It seems rvalue reference for a function argument could not only do the things a lvalue reference could do but also improves efficiency by avoiding unnecessary copies)</p>\n"}, {"tags": ["c++", "binaryfiles", "binary-data"], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1488394881, "post_id": 42539834, "comment_id": 72215411, "body": "The value 9 is actually <code>\\t</code>. 10 is <code>\\n</code>. The fact that both are considered white space is what causes the issue."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1488395211, "post_id": 42539834, "comment_id": 72215618, "body": "Or rather, <code>readFile &gt;&gt; ws</code> skips over the <code>\\t</code> character only, then reading the four bytes <code>00 00 00 0a</code>, interpreted as a little-endian 4-byte integer is the value 167772160. This is still well defined (I believe). However, the next read attempt reads beyond the EOF. That is UB, and displaying 167772160 is a valid form of undefined behavior."}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": false, "score": 4, "last_activity_date": 1488394897, "last_edit_date": 1495540827, "creation_date": 1488394732, "answer_id": 42539834, "question_id": 42539637, "link": "https://stackoverflow.com/questions/42539637/garbage-value-when-getting-integer-value-from-binary-file-in-c/42539834#42539834", "title": "Garbage value when getting integer value from binary file in c++", "body": "<p><code>readFile &gt;&gt; ws;</code> discards white space, which is non-sense for a binary stream. In this case, the character value 9 (which is <code>'\\t'</code>) is skipped, corrupting your stream. Simply remove that line.</p>\n\n<p>The second problem is you are not checking the state of the stream between reading and displaying the value. EOF is only detected <em>after</em> a read would exceed the end of the file. This is why you get your invalid value twice, the second time the read fails and simply leaves <code>temp</code> with it's previous value. <a href=\"https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong\">See this question</a> for a more details.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1488395159, "last_edit_date": 1495542321, "creation_date": 1488395159, "answer_id": 42539963, "question_id": 42539637, "link": "https://stackoverflow.com/questions/42539637/garbage-value-when-getting-integer-value-from-binary-file-in-c/42539963#42539963", "title": "Garbage value when getting integer value from binary file in c++", "body": "<p><a href=\"https://stackoverflow.com/a/42539834/434551\">The answer by Fran\u00e7ois Andrieux</a> already has the answer to the question of why your code behaves the way it does.</p>\n\n<p>Here are couple of methods to fix the problem.</p>\n\n<ol>\n<li><p>Use a <code>for</code> loop to read the numbers. It mirrors the loop used to write to it.</p>\n\n<pre><code>readFile.open(\"file.dat\", ios::binary);\nfor (int i = 5; i &lt;= 10 ; i++)\n{\n   readFile.read((char*)(&amp;temp), sizeof(temp));\n   cout &lt;&lt; \"temp: \" &lt;&lt; temp &lt;&lt; endl;\n}\nreadFile.close();\n</code></pre></li>\n<li><p>Use the <code>while</code> loop correctly.</p>\n\n<pre><code>readFile.open(\"file.dat\", ios::binary);\nwhile (readFile.read((char*)(&amp;temp), sizeof(temp)))\n{\n   cout &lt;&lt; \"temp: \" &lt;&lt; temp &lt;&lt; endl;\n}\nreadFile.close();\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 455, "user_id": 7060957, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-LFKw5xZ6Gog/AAAAAAAAAAI/AAAAAAAADLU/la21eIPRu3c/photo.jpg?sz=128", "display_name": "Younghoon Jeong", "link": "https://stackoverflow.com/users/7060957/younghoon-jeong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1488395159, "creation_date": 1488394154, "last_edit_date": 1488394274, "question_id": 42539637, "link": "https://stackoverflow.com/questions/42539637/garbage-value-when-getting-integer-value-from-binary-file-in-c", "title": "Garbage value when getting integer value from binary file in c++", "body": "<p>I am studying binary file of C++ nowadays. I made a example code for it, but it does not work well.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\nusing namespace std;\n\nint main() {\n    ofstream writeFile;\n    ifstream readFile;\n    int temp = 1;\n\n    writeFile.open(\"file.dat\", ios::binary);\n\n    for (int i = 5; i &lt;= 10 ; i++) // range 5 to 10\n        writeFile.write((char*)(&amp;i), sizeof(i));\n\n    writeFile.close();\n\n    readFile.open(\"file.dat\", ios::binary);\n    readFile.seekg(0);\n    while (!readFile.eof()) {\n        readFile.read((char*)(&amp;temp), sizeof(temp));\n        cout &lt;&lt; \"temp: \" &lt;&lt; temp &lt;&lt; endl;\n        readFile &gt;&gt; ws;\n    }\n    readFile.close();\n\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>Here is the result:</p>\n\n<pre><code>temp: 5\ntemp: 6\ntemp: 7\ntemp: 8\ntemp: 167772160\ntemp: 167772160\n</code></pre>\n\n<p>When I change the range not to include 9 (for example, 5 to 8), it works well. Also, When I make the same code with double type, it works well. So I think the integer 9 is problem. Can you tell me why?</p>\n"}, {"tags": ["c++", "templates", "structure"], "comments": [{"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 3, "creation_date": 1488394294, "post_id": 42539604, "comment_id": 72215064, "body": "Have the name printed from a function overloaded on <code>employee</code> and <code>human</code> (well, <code>const</code> references thereof) instead of printing it directly. The usual rule applies: an extra level of indirection solves the problem. With C++17 you could use <code>if constexpr</code> but that isn&#39;t really available, yet."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1488394450, "post_id": 42539604, "comment_id": 72215166, "body": "<i>write a program that prints the name of the human/employee with maximum sort_param.use template programming.</i> What&#39;s the input to the function/program?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1488394576, "post_id": 42539604, "comment_id": 72215241, "body": "If you need to know the type, a template is the wrong approach. You should overload the function instead. Even on a smaller scale, like Dietmar K&#252;hl suggested"}], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1488395825, "post_id": 42539822, "comment_id": 72216004, "body": "Surely, that should be <code>void print_name(const employee&amp; emp) { ... }</code>, etc. The question is tagged <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> for a reason, no?"}, {"owner": {"reputation": 750, "user_id": 7054387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-6bDjhl9WjJI/AAAAAAAAAAI/AAAAAAAAAA0/HLJVVOTCc1Q/photo.jpg?sz=128", "display_name": "Fatemeh Karimi", "link": "https://stackoverflow.com/users/7054387/fatemeh-karimi"}, "edited": false, "score": 0, "creation_date": 1488400311, "post_id": 42539822, "comment_id": 72218667, "body": "i did&#39;nt want to use function overloading. but i think this is the most efficient and usefull one. anyway, thank you!"}], "tags": [], "owner": {"reputation": 148, "user_id": 7625372, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aFIK_dx7NHw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oAUv2wMoGDMJsxTGhyN_hvM8jlWA/mo/photo.jpg?sz=128", "display_name": "Alborz", "link": "https://stackoverflow.com/users/7625372/alborz"}, "is_accepted": true, "score": 2, "last_activity_date": 1488396375, "last_edit_date": 1488396375, "creation_date": 1488394689, "answer_id": 42539822, "question_id": 42539604, "link": "https://stackoverflow.com/questions/42539604/how-to-figure-out-which-type-is-passed-to-a-template-defined-function/42539822#42539822", "title": "how to figure out which type is passed to a template-defined function?", "body": "<p>use an overloaded function, just call your function with one of arguments those type can be <em>human</em> or <em>employee</em>.</p>\n\n<pre><code>void print_name(const employee&amp; emp)\n{\n     cout &lt;&lt; emp.h.name &lt;&lt; endl;\n}\nvoid print_name(const human&amp; hum)\n{\n     cout &lt;&lt; hum.name &lt;&lt; endl;\n}\n</code></pre>\n\n<p><em>The argument are edited.</em></p>\n"}], "owner": {"reputation": 750, "user_id": 7054387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-6bDjhl9WjJI/AAAAAAAAAAI/AAAAAAAAAA0/HLJVVOTCc1Q/photo.jpg?sz=128", "display_name": "Fatemeh Karimi", "link": "https://stackoverflow.com/users/7054387/fatemeh-karimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 42539822, "answer_count": 1, "score": 0, "last_activity_date": 1488396375, "creation_date": 1488394059, "last_edit_date": 1488394359, "question_id": 42539604, "link": "https://stackoverflow.com/questions/42539604/how-to-figure-out-which-type-is-passed-to-a-template-defined-function", "title": "how to figure out which type is passed to a template-defined function?", "body": "<p>I have a problem doing my homework. the problem I faced is this:\nthe question is this:\n((write a program that prints the name of the human/employee with maximum sort_param.use template programming.))\nhuman and employee are defined like this:</p>\n\n<pre><code>struct human\n{\nchar name[30];\nchar * family;\nint id;\nint sort_param;\n};\n\nstruct employee\n{\nhuman h;\nchar post[50];\nint sort_param;\n};\n</code></pre>\n\n<p>as you see, printing the name of the employee/human depends on the type that is passed to the function.\nmy question is:\nhow can I tell the computer to act depend on the data type. I mean if the type is employee  then:</p>\n\n<pre><code>cout &lt;&lt; employee.h.name &lt;&lt; endl;\n</code></pre>\n\n<p>if the type is human then:</p>\n\n<pre><code>cout &lt;&lt; human.name &lt;&lt; endl;\n</code></pre>\n"}, {"tags": ["c++", "unordered-map", "memory-mapped-files", "solaris-10", "g++4.9"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488393920, "post_id": 42539507, "comment_id": 72214836, "body": "<i>&quot;How can I use a memory mapped file using <code>mmap</code> to store and read data?&quot;</i> Hmm, maybe using a custom allocator (placement <code>new</code>) for <code>unordered_map</code>? Pointers may become a problem though."}, {"owner": {"reputation": 6643, "user_id": 2032021, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c1c31bca855c458b3f218ef6a303184d?s=128&d=identicon&r=PG", "display_name": "Dr. Debasish Jana", "link": "https://stackoverflow.com/users/2032021/dr-debasish-jana"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488394055, "post_id": 42539507, "comment_id": 72214894, "body": "Yes to get both side of the world and save memory but get O(1) access too"}, {"owner": {"reputation": 65414, "user_id": 768469, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/383724e63ab04b146277912c16f27f54?s=128&d=identicon&r=PG", "display_name": "Nemo", "link": "https://stackoverflow.com/users/768469/nemo"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488398310, "post_id": 42539507, "comment_id": 72217502, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 - <a href=\"http://www.boost.org/libs/interprocess\" rel=\"nofollow noreferrer\">Boost.Interprocess</a> provides &quot;offset_ptr&quot; and related allocators for doing this sort of thing. I have not used it myself, though."}], "owner": {"reputation": 6643, "user_id": 2032021, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c1c31bca855c458b3f218ef6a303184d?s=128&d=identicon&r=PG", "display_name": "Dr. Debasish Jana", "link": "https://stackoverflow.com/users/2032021/dr-debasish-jana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 351, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488393742, "creation_date": 1488393742, "question_id": 42539507, "link": "https://stackoverflow.com/questions/42539507/c-how-do-i-store-and-read-an-unordered-map-in-a-memory-mapped-file", "title": "c++: How do I store and read an unordered_map in a memory mapped file", "body": "<p>I would like to store and later read an <code>unordered_map</code> in a memory-mapped file using <code>C++</code> on <code>Solaris</code> (compiler <code>g++ 4.9.2</code>). I have quite a large data that needs to be stored as a key-value pair. But, maintaining an <code>unordered_map</code> in memory takes up lot of memory at the same time key-value pair provides me access in O(1) time for the underlying data How can I use a memory mapped file using <code>mmap</code> to store and read data? </p>\n"}, {"tags": ["c++", "node.js", "v8"], "answers": [{"comments": [{"owner": {"reputation": 934, "user_id": 4503893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612451f6f88491023d8367e0a8b141f7?s=128&d=identicon&r=PG", "display_name": "sp3c1", "link": "https://stackoverflow.com/users/4503893/sp3c1"}, "edited": false, "score": 0, "creation_date": 1488894729, "post_id": 42627432, "comment_id": 72426134, "body": "Thanks. That would mean that when you invoke <code>dispose()</code> through <code>reset()</code> or <code>destructor()</code> all of the memory should be cleared? As I am seeing some behaviour that would say it doesn&#39;t also execution time on such is same as copying staff into <code>std::string</code>."}], "tags": [], "owner": {"reputation": 1, "user_id": 7666817, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d97baeda32b79e5683e72316672a1ab3?s=128&d=identicon&r=PG", "display_name": "Gus Goose", "link": "https://stackoverflow.com/users/7666817/gus-goose"}, "is_accepted": false, "score": 0, "last_activity_date": 1488808495, "creation_date": 1488808495, "answer_id": 42627432, "question_id": 42539401, "link": "https://stackoverflow.com/questions/42539401/v8-concatenation-of-persistent-string/42627432#42627432", "title": "v8: Concatenation of persistent string", "body": "<ul>\n<li>Yes, that is what you need to do.</li>\n<li>No, it does not create a copy of the persisted string, only a memory reference.</li>\n<li>No, you need a Local handle to do anything relevant.</li>\n</ul>\n"}], "owner": {"reputation": 934, "user_id": 4503893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612451f6f88491023d8367e0a8b141f7?s=128&d=identicon&r=PG", "display_name": "sp3c1", "link": "https://stackoverflow.com/users/4503893/sp3c1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488808495, "creation_date": 1488393332, "question_id": 42539401, "link": "https://stackoverflow.com/questions/42539401/v8-concatenation-of-persistent-string", "title": "v8: Concatenation of persistent string", "body": "<p>If I have  </p>\n\n<p><code>Nan::Persistent&lt;String&gt; persistedString</code> </p>\n\n<p>and want to concatenate it with some <code>Local&lt;String&gt; localString</code></p>\n\n<p>do I need create a new local from persisted first, concat then rest the persistent?</p>\n\n<pre><code>Local&lt;String&gt; baseString = Nan::New(persistedString);\npersistedString.reset(String::Concat(baseString, localString));\n</code></pre>\n\n<p>If so is this creating copy of persisted before concat? Or is it just referencing the memory?</p>\n\n<p>Also is there a way to get string size out of <code>persistent&lt;string&gt;</code> without performing this operation?</p>\n"}, {"tags": ["c++", "audio", "uwp", "ms-media-foundation", "wasapi"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1488398554, "post_id": 42539274, "comment_id": 72217648, "body": "<i>&quot;this does not work&quot;</i> is not a problem statement. Please take the <a href=\"https://stackoverflow.com/tour\">tour</a>, visit the <a href=\"https://stackoverflow.com/help\">help center</a>, and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> in particular."}, {"owner": {"reputation": 21, "user_id": 2207520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4c8ffbc25470b078095adcf4d1aa62?s=128&d=identicon&r=PG", "display_name": "Tagh_azog", "link": "https://stackoverflow.com/users/2207520/tagh-azog"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1488441796, "post_id": 42539274, "comment_id": 72234768, "body": "I linked just right below one guy with the error statement..."}, {"owner": {"reputation": 1257, "user_id": 5110855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93f29bdd015d8a9b204efd66fb798c72?s=128&d=identicon&r=PG&f=1", "display_name": "mofo77", "link": "https://stackoverflow.com/users/5110855/mofo77"}, "edited": false, "score": 0, "creation_date": 1488831815, "post_id": 42539274, "comment_id": 72397367, "body": "Did you check this blog : <a href=\"https://blogs.msdn.microsoft.com/mediasdkstuff/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/mediasdkstuff</a>"}, {"owner": {"reputation": 21, "user_id": 2207520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4c8ffbc25470b078095adcf4d1aa62?s=128&d=identicon&r=PG", "display_name": "Tagh_azog", "link": "https://stackoverflow.com/users/2207520/tagh-azog"}, "edited": false, "score": 1, "creation_date": 1488970136, "post_id": 42539274, "comment_id": 72463074, "body": "Yes but nothing that helped me. Simply, I have a BYTE* buffer containing the audio samples, as simple as that. I want that buffer to be played on speakers... in C++, using Media Foundation, for UWP. (so no desktop only code that do not work for UWP). As such, I can&#39;t use for instance the MFCreateAudioRenderer with a MediaSink since it works only for desktop and not UWP."}], "owner": {"reputation": 21, "user_id": 2207520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4c8ffbc25470b078095adcf4d1aa62?s=128&d=identicon&r=PG", "display_name": "Tagh_azog", "link": "https://stackoverflow.com/users/2207520/tagh-azog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 604, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1488454224, "creation_date": 1488392901, "last_edit_date": 1495539976, "question_id": 42539274, "link": "https://stackoverflow.com/questions/42539274/rendering-pcm-audio-bufferin-c-using-media-foundation-wasapi-for-uwp", "title": "rendering PCM audio bufferin C++ using Media Foundation/WASAPI for UWP", "body": "<p>It's hard to find anything on the web reliable for audio rendering (there is capture, record and save to file, but rendering to speakers are rare using Media Foundation).\nThe problem I have is that the tutorial of audio rendering provided by Microsoft are... all for desktop application.\nThere is one that could be used for UWP as it is using <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd316756(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>WASAPI</code></a>:</p>\n\n<p>But... the uuid of lines fails on UWP:</p>\n\n<pre><code>const CLSID CLSID_MMDeviceEnumerator = __uuidof(MMDeviceEnumerator);\nconst IID IID_IMMDeviceEnumerator = __uuidof(IMMDeviceEnumerator);\nconst IID IID_IAudioClient = __uuidof(IAudioClient);\nconst IID IID_IAudioRenderClient = __uuidof(IAudioRenderClient);\n</code></pre>\n\n<p>Someone seemed to have the same problem:\n<a href=\"https://stackoverflow.com/questions/17493603/wasapi-windows-store-app-initialization\">WASAPI + windows store app initialization</a></p>\n\n<blockquote>\n  <p>Error: operand of __uuidof must have a class or enum type for which __declspec(uuid('..')) has been specified.</p>\n</blockquote>\n\n<p>Nobody really answered that as well and even more the link he provides is not reachable (or at least not anymore). I Can't figure out how to activate the output audio device and stream audio to it on Universal Windows Platform.</p>\n\n<p>I am using Media Foundation for a specific scenario and I use a Source Reader to get asynchronously audio decoded PCM samples.</p>\n\n<p>While there are samples that should work on Standalone desktop builds, I can't find anywhere something that is compatible with Universal Windows Platform...</p>\n\n<p>Anyone has done something similar (audio rendering using Media Foundation or WASAPI with C++ for UWP?) or at least got better links that would help me?</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["c++", "pointers", "polymorphism", "shared-ptr", "initializer-list"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 4, "creation_date": 1488394967, "post_id": 42539001, "comment_id": 72215463, "body": "Is just using a variadic constructor acceptable, because if so, <a href=\"http://ideone.com/4jdhfZ\" rel=\"nofollow noreferrer\">wouldn&#39;t something like this work</a> ? Or is an explicit initializer list a requirement of yours."}], "answers": [{"comments": [{"owner": {"reputation": 5241, "user_id": 2515628, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/AQ2kB.jpg?s=128&g=1", "display_name": "Igor \u0160evo", "link": "https://stackoverflow.com/users/2515628/igor-%c5%a0evo"}, "edited": false, "score": 0, "creation_date": 1488392306, "post_id": 42539063, "comment_id": 72213910, "body": "This would have to be done in the <code>main()</code> method. Is there a way to do this from the constructor?"}, {"owner": {"reputation": 11096, "user_id": 541208, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2dfc2e563d2150994a6e06ef37f9e7be?s=128&d=identicon&r=PG", "display_name": "TankorSmash", "link": "https://stackoverflow.com/users/541208/tankorsmash"}, "reply_to_user": {"reputation": 5241, "user_id": 2515628, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/AQ2kB.jpg?s=128&g=1", "display_name": "Igor \u0160evo", "link": "https://stackoverflow.com/users/2515628/igor-%c5%a0evo"}, "edited": false, "score": 0, "creation_date": 1488392826, "post_id": 42539063, "comment_id": 72214219, "body": "I don&#39;t have access to a compiler, but can&#39;t you do, in the constructor, <code>vec.push_back(shared_ptr&lt;A&gt;(x.get()));</code> ? One of the constructors for shared_ptr takes a pointer, so this seems like it should work <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr/shared_ptr\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/memory/shared_ptr/shared_ptr</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1488392897, "post_id": 42539063, "comment_id": 72214267, "body": "No, because the inputs being passed to the constructor are not <code>shared_ptr</code> objects to begin with. You would have to do something more like this instead: <code>Test test = { std::make_shared&lt;A&gt;(), std::shared_ptr&lt;A&gt;(new B()) };</code>  Then you could do <code>vec.push_back(x);</code>"}], "tags": [], "owner": {"reputation": 11096, "user_id": 541208, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2dfc2e563d2150994a6e06ef37f9e7be?s=128&d=identicon&r=PG", "display_name": "TankorSmash", "link": "https://stackoverflow.com/users/541208/tankorsmash"}, "is_accepted": false, "score": 1, "last_activity_date": 1488392118, "creation_date": 1488392118, "answer_id": 42539063, "question_id": 42539001, "link": "https://stackoverflow.com/questions/42539001/smart-pointer-polymorphism-in-collections/42539063#42539063", "title": "Smart pointer polymorphism in collections", "body": "<p>You're making new <code>shared_ptr</code>s on the following line</p>\n\n<pre><code>        vec.push_back(std::make_shared&lt;A&gt;(x));\n</code></pre>\n\n<p>It doesn't matter what <code>x</code> was, you made a new <code>A</code> with its values.</p>\n\n<p>You probably want to create a <code>shared_ptr&lt;A&gt;</code> and pass the pointer from <code>x.get()</code> to the new empty <code>shared_ptr&lt;A&gt;</code></p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 5, "last_activity_date": 1488396070, "last_edit_date": 1488396070, "creation_date": 1488393955, "answer_id": 42539569, "question_id": 42539001, "link": "https://stackoverflow.com/questions/42539001/smart-pointer-polymorphism-in-collections/42539569#42539569", "title": "Smart pointer polymorphism in collections", "body": "<p><code>std::initializer_list&lt;T&gt;</code> holds the passed objects by value, so there can be no polymorhism. Also <code>std::make_shared&lt;A&gt;</code> always makes an object of type <code>A</code>, not some type that derives from <code>A</code>. You need another approach. </p>\n\n<p>Since you have an arbitrary number of arguments with arbitrary types, you'll probably need a variadic template constructor.</p>\n\n<p>Edit: My code suggestion was way too complicated. The comment by WhozCraig is much better: </p>\n\n<blockquote>\n<pre><code>template&lt;class... Args&gt;\nTest(Args&amp;&amp;... args) :\n    vec { std::make_shared&lt;std::remove_reference_t&lt;Args&gt;&gt;(std::forward&lt;Args&gt;(args))... }\n{\n}\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": false, "score": 2, "last_activity_date": 1488396149, "creation_date": 1488396149, "answer_id": 42540248, "question_id": 42539001, "link": "https://stackoverflow.com/questions/42539001/smart-pointer-polymorphism-in-collections/42540248#42540248", "title": "Smart pointer polymorphism in collections", "body": "<p>You are inserting to the vector using <code>std::make_shared&lt;A&gt;()</code>. You are copying a bunch of <code>B</code> and <code>A</code> into a bunch of <code>A</code>.</p>\n\n<p>If you want the syntax in your main to work, the simplest way to do that is a template :</p>\n\n<pre><code>struct Foo {\n    template&lt;typename... Args&gt;\n    Foo(Args... args) :\n        vec{std::make_shared&lt;Args&gt;(std::move(args))...}\n    {}\n\nprivate:\n    std::vector&lt;std::shared_ptr&lt;A&gt;&gt; vec;\n};\n</code></pre>\n"}], "owner": {"reputation": 5241, "user_id": 2515628, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/AQ2kB.jpg?s=128&g=1", "display_name": "Igor \u0160evo", "link": "https://stackoverflow.com/users/2515628/igor-%c5%a0evo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 1, "accepted_answer_id": 42539569, "answer_count": 3, "score": 5, "last_activity_date": 1488396149, "creation_date": 1488391913, "last_edit_date": 1495541828, "question_id": 42539001, "link": "https://stackoverflow.com/questions/42539001/smart-pointer-polymorphism-in-collections", "title": "Smart pointer polymorphism in collections", "body": "<p>I am trying to initialize a collection of pointers to class <code>A</code> through an initializer list. However, the initializer list cannot use reference as a template type.</p>\n\n<p>I have the following code.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\n#include &lt;algorithm&gt;\n#include &lt;vector&gt;\n#include &lt;initializer_list&gt;\n#include &lt;memory&gt;\n\nstruct A\n{\n    virtual void f() const noexcept { std::cout &lt;&lt; \"A\"; }\n};\n\nstruct B : public A\n{\n    virtual void f() const noexcept override { std::cout &lt;&lt; \"B\"; }\n};\n\nclass Test\n{\n    std::vector&lt;std::shared_ptr&lt;A&gt;&gt; vec;\npublic:\n    Test(const std::initializer_list&lt;A&gt;&amp; list)\n    //Test(const std::initializer_list&lt;A&amp;&gt;&amp; list) &lt;------ Solution?\n    {\n        for (auto&amp; x : list)\n            vec.push_back(std::make_shared&lt;A&gt;(x));\n    }\n    void print()\n    {\n        std::for_each(vec.begin(), vec.end(), [](auto x) { x-&gt;f(); });\n    }\n};\n\nint main()\n{\n    Test test = { A(), B() };\n    test.print();\n}\n</code></pre>\n\n<p>The code prints:</p>\n\n<blockquote>\n  <p>AA</p>\n</blockquote>\n\n<p>It should print:</p>\n\n<blockquote>\n  <p>AB</p>\n</blockquote>\n\n<p>Is there a simple way to do this, without having to create pointers in the calling method?</p>\n\n<p>The related article (<a href=\"https://stackoverflow.com/questions/27502968/how-do-i-implement-polymorphism-with-stdshared-ptr\">How do I implement polymorphism with std::shared_ptr?</a>) did not provide much help with this problem.</p>\n"}, {"tags": ["c++", "arduino", "arduino-esp8266"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1488392010, "post_id": 42538987, "comment_id": 72213714, "body": "You are trying to <i>call</i> <code>MyClass::handler</code> as a static member function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1488392107, "post_id": 42538987, "comment_id": 72213787, "body": "What is the full type of <code>String</code>?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1488393417, "post_id": 42538987, "comment_id": 72214568, "body": "Try <code>m_server.on(uri, HTTP_GET, std::bind(&amp;MyClass::handler, this, String(uri));</code>  Or, maybe a lambda will work instead:  <code>String str_uri(uri); m_server.on(uri, HTTP_GET, [this, str_uri]() { this-&gt;handler(str_uri); });</code>"}, {"owner": {"reputation": 10512, "user_id": 2296997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/PXClb.jpg?s=128&g=1", "display_name": "4m1r", "link": "https://stackoverflow.com/users/2296997/4m1r"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1488422682, "post_id": 42538987, "comment_id": 72227366, "body": "this worked.  thanks @RemyLebeau <code>server.on(&quot;&#47;edit&quot;, HTTP_GET, std::bind(&amp;SolarServer::handleFileRead, this, path))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 498, "user_id": 772976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ba1cca362ec1a5d17bc742f2291f2f1?s=128&d=identicon&r=PG", "display_name": "George Newton", "link": "https://stackoverflow.com/users/772976/george-newton"}, "is_accepted": false, "score": 0, "last_activity_date": 1488442678, "creation_date": 1488442678, "answer_id": 42550074, "question_id": 42538987, "link": "https://stackoverflow.com/questions/42538987/trying-to-pass-a-string-to-bound-function-c/42550074#42550074", "title": "Trying to pass a String to bound function C++", "body": "<p>lvalue required as unary '&amp;' operand is saying that a variable is required to take the address from. In the case of your method:</p>\n\n<pre><code>void begin(const char* uri) \n{\n    m_server.on(uri, HTTP_GET, std::bind(&amp;MyClass::handler(&amp;path), this));\n}\n</code></pre>\n\n<p>path is undefined - so in this case path is not an addressable variable. As mentioned in the comment above, by @Remy Lebeau, if you pass in the param uri - then you have a valid addressable variable.</p>\n"}, {"tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1488472976, "creation_date": 1488472976, "answer_id": 42561096, "question_id": 42538987, "link": "https://stackoverflow.com/questions/42538987/trying-to-pass-a-string-to-bound-function-c/42561096#42561096", "title": "Trying to pass a String to bound function C++", "body": "<p>When you do</p>\n\n<pre><code>std::bind(&amp;MyClass::handleFileRead(edit), this)\n</code></pre>\n\n<p>you attempt to <strong><em>call</em></strong> <code>MyClass::handleFileRead(edit)</code>, and take the pointer of the result as the argument to the <code>std::bind</code> call. This is of course not valid, especially since the function doesn't return anything as well as it's not being a <code>static</code> member function..</p>\n\n<p>You should not <em>call</em> the function, just pass a pointer to it (and set the argument):</p>\n\n<pre><code>std::bind(&amp;MyClass::handleFileRead, this, edit)\n//                                ^       ^\n// Note not calling the function here     |\n//                                        |\n//       Note passing edit as argument here\n</code></pre>\n"}], "owner": {"reputation": 10512, "user_id": 2296997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/PXClb.jpg?s=128&g=1", "display_name": "4m1r", "link": "https://stackoverflow.com/users/2296997/4m1r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 42561096, "answer_count": 2, "score": -1, "last_activity_date": 1488472976, "creation_date": 1488391884, "last_edit_date": 1488466751, "question_id": 42538987, "link": "https://stackoverflow.com/questions/42538987/trying-to-pass-a-string-to-bound-function-c", "title": "Trying to pass a String to bound function C++", "body": "<p>In this example, how do you pass a String to the bound \"handler\" function?</p>\n\n<pre><code>// MyClass.h\n\nclass MyClass {\npublic:\n    MyClass(ESP8266WebServer&amp; server) : m_server(server);\n    void begin();\n    void handler(String path);    \nprotected:\n    ESP8266WebServer&amp; m_server;\n};\n\n// MyClass.cpp\n...\nvoid MyClass::begin() {\n\n  String edit = \"/edit.htm\";\n\n  m_server.on(\"/edit\", HTTP_GET, std::bind(&amp;MyClass::handleFileRead(edit), this));\n...\n</code></pre>\n\n<p>Every which way I try I get: </p>\n\n<pre><code>error: lvalue required as unary '&amp;' operand\n</code></pre>\n"}, {"tags": ["c++", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": true, "score": 1, "last_activity_date": 1488391248, "creation_date": 1488391248, "answer_id": 42538812, "question_id": 42538785, "link": "https://stackoverflow.com/questions/42538785/runtime-error-for-c-code-based-on-pointers/42538812#42538812", "title": "runtime error for c++ code (based on pointers)", "body": "<p>You are trying to access the <code>i</code> member of an uninitialized pointer.</p>\n\n<p>You need to allocate memory for <code>b</code>:</p>\n\n<pre><code>b = new a();\nb-&gt;i = 1;\na* c= new a(*b);\ncout &lt;&lt; c-&gt;i;\ndelete b;\ndelete c;\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/935979972d135688\" rel=\"nofollow noreferrer\">Live Demo</a></p>\n"}], "owner": {"reputation": 31, "user_id": 7633875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bded7dfd3c2eaac236c0967194fd28d?s=128&d=identicon&r=PG&f=1", "display_name": "noobron", "link": "https://stackoverflow.com/users/7633875/noobron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1488412574, "accepted_answer_id": 42538812, "answer_count": 1, "score": -6, "last_activity_date": 1488391589, "creation_date": 1488391143, "last_edit_date": 1488391589, "question_id": 42538785, "link": "https://stackoverflow.com/questions/42538785/runtime-error-for-c-code-based-on-pointers", "closed_reason": "Not suitable for this site", "title": "runtime error for c++ code (based on pointers)", "body": "<p>I am getting a runtime error for the following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nstruct a\n{\n    int i;\n}*b;\n\nint main() {\n   b-&gt;i = 1;\n   a* c = new a(*b);\n   cout &lt;&lt; c-&gt;i; \n   return 0;\n}\n</code></pre>\n\n<p>Can anyone give me the reason for the error?</p>\n"}, {"tags": ["c++", "c", "visual-studio-2013"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1488391253, "post_id": 42538709, "comment_id": 72213267, "body": "Cannot reproduce in MSVC 2015. Is this the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem?"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1488391326, "post_id": 42538709, "comment_id": 72213302, "body": "I fail to reproduce the claimed behavior with Visual C++ 2015 update 3."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1488391367, "post_id": 42538709, "comment_id": 72213328, "body": "@WeatherVane Checking on VS 2013."}, {"owner": {"reputation": 143, "user_id": 7642609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd518fbe65cd6ae295871173b1a9a7ff?s=128&d=identicon&r=PG&f=1", "display_name": "AvD", "link": "https://stackoverflow.com/users/7642609/avd"}, "reply_to_user": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "edited": false, "score": 0, "creation_date": 1488391484, "post_id": 42538709, "comment_id": 72213397, "body": "@yellowantphil Compiling as C or as C++ both gave the same behavior,"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "edited": false, "score": 0, "creation_date": 1488391707, "post_id": 42538709, "comment_id": 72213542, "body": "@yellowantphil The last few editions should have become much better with C99 support."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1488391728, "post_id": 42538709, "comment_id": 72213557, "body": "Just wanted to say, running this through -O2 on clang 3.9.1 (I know, unrelated to the question, but I was curious) yields a <a href=\"http://pastebin.com/SMW3Wb6x\" rel=\"nofollow noreferrer\">pretty funny asm result</a>. Whoever the team is that did their loop analysis should be proud =)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1488391741, "post_id": 42538709, "comment_id": 72213565, "body": "Tested on both VS15 and VS13, both as cpp and c. Each time the output is what is expected. Could you maybe provide us with the exact build number of the compiler. The generated assembly would also be fun to look at."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "edited": false, "score": 0, "creation_date": 1488392023, "post_id": 42538709, "comment_id": 72213724, "body": "@yellowantphil: I don&#39;t know why you were annoyed. VS2013 had rather extensive core language support for C99, especially by Update 5."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1488392076, "post_id": 42538709, "comment_id": 72213767, "body": "VS2013 Update 5 does indeed exhibit this bug in Release mode in both x64 and Win32 configurations. Exactly as the OP described."}, {"owner": {"reputation": 143, "user_id": 7642609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd518fbe65cd6ae295871173b1a9a7ff?s=128&d=identicon&r=PG&f=1", "display_name": "AvD", "link": "https://stackoverflow.com/users/7642609/avd"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488392079, "post_id": 42538709, "comment_id": 72213769, "body": "@Ajay Brahmakshatriya I have this:Microsoft Visual Studio Professional 2013 Version 12.0.40629.00 Update 5     Microsoft.NET Framework Version 4.6.01038     Visual C++ 2013   06177 - 004 - 0447006 - 02743"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1488392699, "post_id": 42538709, "comment_id": 72214141, "body": "Off topic: <code>for (int y = row; y &lt;= row; ++y)</code> looks wacky. Give you one iteration, but there are clearer ways to write this. I assume this is an artifact of forcing the bug?"}, {"owner": {"reputation": 143, "user_id": 7642609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd518fbe65cd6ae295871173b1a9a7ff?s=128&d=identicon&r=PG&f=1", "display_name": "AvD", "link": "https://stackoverflow.com/users/7642609/avd"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1488392987, "post_id": 42538709, "comment_id": 72214320, "body": "@user4581301 I know..., but the bug is also there if you have more than 1 iterations. I just wanted to show a &quot;minimal&quot; example."}, {"owner": {"reputation": 143, "user_id": 7642609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd518fbe65cd6ae295871173b1a9a7ff?s=128&d=identicon&r=PG&f=1", "display_name": "AvD", "link": "https://stackoverflow.com/users/7642609/avd"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1488393557, "post_id": 42538709, "comment_id": 72214655, "body": "@Weather Vane, Yes this definitely is the minimal illustration of the problem that I could make, and please note that the question is not about VS 2015"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1488394075, "post_id": 42538709, "comment_id": 72214902, "body": "@AvD after that became clear, I upvoted your question. Those accusing a compiler of having a bug must be very sure of their ground, since the bug is usually in the code."}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488393617, "post_id": 42539224, "comment_id": 72214683, "body": "Also the fact that it is adding 12 to eax instead of 4 hints that the constant evaluation considers y to be 1 instead of 0."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488393754, "post_id": 42539224, "comment_id": 72214748, "body": "BTW to me it appears that it has performed a loop interchange. It is the outer loop that is being executed 3 times. The inner loop(of y) is being executed one time correctly. But the y is just taking the wrong value."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488393797, "post_id": 42539224, "comment_id": 72214765, "body": "can I ask you to print some more values from A? I suspect it is going to print 11,0,0,11,0,0,11,0,0."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488393905, "post_id": 42539224, "comment_id": 72214826, "body": "@Ajay Brahmakshatriya: Yes, it is adding 12 for the same reason: some how it believes that inner cycle should not iterate. So it prepares for the next iteration of the outer cycle. It just makes no sense."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488393978, "post_id": 42539224, "comment_id": 72214864, "body": "No, I think it does realize that the inner loop is going to execute once. But it just assumes the wrong value for y. Instead of assuming 0 it assumes 1."}, {"owner": {"reputation": 143, "user_id": 7642609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd518fbe65cd6ae295871173b1a9a7ff?s=128&d=identicon&r=PG&f=1", "display_name": "AvD", "link": "https://stackoverflow.com/users/7642609/avd"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488394063, "post_id": 42539224, "comment_id": 72214899, "body": "@Ajay Brahmakshatriya, No, when I print 9 values I get 11,0,0,0,0,0,0,0,0"}, {"owner": {"reputation": 143, "user_id": 7642609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd518fbe65cd6ae295871173b1a9a7ff?s=128&d=identicon&r=PG&f=1", "display_name": "AvD", "link": "https://stackoverflow.com/users/7642609/avd"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488394201, "post_id": 42539224, "comment_id": 72214995, "body": "@Ajay Brahmakshatriya, when I execute the outer loop 3 times, the inner loop is always executed only 1 time, so then I do get 11,0,0,11,0,0,11,0,0"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488394448, "post_id": 42539224, "comment_id": 72215163, "body": "So there are multiple bugs here. The unnecessary checking of esi for no reason which causes the loop to terminate and the improper calculation of the offsets into A (should be eax +=4 instead on 12)."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488394500, "post_id": 42539224, "comment_id": 72215196, "body": "Wow, they screwed up really bad."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488395237, "post_id": 42539224, "comment_id": 72215635, "body": "@Ajay Brahmakshatriya: The +=12 apparently comes from the fact that this is the original <i>outer</i> cycle, which is supposed to skip 12 bytes every iteration (if it were to make more than 1). I omitted the code that re-calculated the value of <code>eax</code> before each run of inner disassembly cycle. That recalculation makes it correct (i.e. justifies +=12). I re-included that code now."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488395413, "post_id": 42539224, "comment_id": 72215757, "body": "That makes sense. I was confused because I couldn&#39;t see the recalculation code. Thanks for the clarification."}, {"owner": {"reputation": 143, "user_id": 7642609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd518fbe65cd6ae295871173b1a9a7ff?s=128&d=identicon&r=PG&f=1", "display_name": "AvD", "link": "https://stackoverflow.com/users/7642609/avd"}, "edited": false, "score": 0, "creation_date": 1488396048, "post_id": 42539224, "comment_id": 72216146, "body": "I was most surprised that A[index] and *(A+index) behave differently. Shouldn&#39;t the parser already guarantee identical behavior?"}, {"owner": {"reputation": 143, "user_id": 7642609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd518fbe65cd6ae295871173b1a9a7ff?s=128&d=identicon&r=PG&f=1", "display_name": "AvD", "link": "https://stackoverflow.com/users/7642609/avd"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488399435, "post_id": 42539224, "comment_id": 72218167, "body": "@Ajay Brahmakshatriya, about the compiler version: I use the same compiler as you: <code>Microsoft (R) C&#47;C++ Optimizing Compiler Version 18.00.40629 for x86</code>. But do not forget to optimize for speed /O2 if you want to see the bug..."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 143, "user_id": 7642609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd518fbe65cd6ae295871173b1a9a7ff?s=128&d=identicon&r=PG&f=1", "display_name": "AvD", "link": "https://stackoverflow.com/users/7642609/avd"}, "edited": false, "score": 0, "creation_date": 1488425941, "post_id": 42539224, "comment_id": 72228243, "body": "@AvD, oh yes! Also similar result on Win64 too. Just a change of registers."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 9, "last_activity_date": 1488395813, "last_edit_date": 1488395813, "creation_date": 1488392710, "answer_id": 42539224, "question_id": 42538709, "link": "https://stackoverflow.com/questions/42538709/possible-c-c-compiler-bug-in-visual-studio-2013/42539224#42539224", "title": "Possible C/C++ compiler bug in Visual Studio 2013", "body": "<p>Yes, it appears to be a compiler bug. In Win32 version of the code the compiler uses register <code>esi</code> to represent <code>y</code> and register <code>edx</code> to represent <code>x</code>. As @Ajay Brahmakshatriya correctly noted in the comments, it appears that the compiler performed an attempt to exchange the cycles (swap the outer with the inner), but ended up with incorrect code. The very last conditional jump instruction, which is supposed to represent the [exchanged] inner cycle, for some reason transfers control to a location that checks <code>esi</code> as well. That check ends iterations prematurely.</p>\n\n<pre><code>0018206B  xor         esi,esi             ; This is `y`\n0018206D  xor         edx,edx             ; This is `x`\n...\n00182070  test        esi,esi  \n00182072  jg          main+5Ch (018209Ch) ; Exit from the outer cycle?\n\n00182074  lea         eax,[edx+esi*2]     ; Recalculate the starting storage location\n00182077  add         eax,esi             ; for the next cycle:\n00182079  lea         ecx,[A]             ; eax = esi * 3 + edx\n0018207F  lea         eax,[ecx+eax*4]     ; eax = &amp;A[eax]\n...\n00182082  mov         ecx,1               ; It is not exactly clear to me what this is \n00182087  sub         ecx,esi             ; supposed to do, but when `esi` is `0`, it \n00182089  add         esi,ecx             ; leaves `ecx` as 1, which is correct \n                                          ; number of iterations for outer cycle\n...\n00182090  mov         dword ptr [eax],0Bh ; Storing the value\n00182096  lea         eax,[eax+0Ch]       ; Updating the pointer for the next storage location \n00182099  dec         ecx  \n0018209A  jne         main+50h (0182090h) ; Outer cycle [exchanged]\n\n0018209C  inc         edx  \n0018209D  cmp         edx,3  \n001820A0  jl          main+30h (0182070h) ; Inner cycle [exchanged]: for some reason it\n                                          ; jumps to `test esi,esi`, which is what\n                                          ; suddenly terminates the iterations\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 7642609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd518fbe65cd6ae295871173b1a9a7ff?s=128&d=identicon&r=PG&f=1", "display_name": "AvD", "link": "https://stackoverflow.com/users/7642609/avd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 42539224, "answer_count": 1, "score": 14, "last_activity_date": 1488395813, "creation_date": 1488390908, "question_id": 42538709, "link": "https://stackoverflow.com/questions/42538709/possible-c-c-compiler-bug-in-visual-studio-2013", "title": "Possible C/C++ compiler bug in Visual Studio 2013", "body": "<p>The following C or C++ code should have as output \"11,11,11,\"\nhowever using Visual Studio Professional 2013 (Version 12.0.40629.00 Update 5) the output is \"11,0,0,\"! This only occurs in a release build, and disappears when optimization is turned off. Is this a compiler bug?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int A[100] = { 0 };\n    int row = 0;   // BUG disappears if we make this const or short or char...\n    int ncols = 3; // BUG disappears if we make this const or short or char...\n\n    for (int y = row; y &lt;= row; ++y)\n    {\n        for (int x = 0; x &lt; ncols; ++x)\n        {\n            const int index = y * ncols + x;\n\n            //A[index] = 11;           // (no bug !)\n            *(A + index) = 11;       // BUG!!!\n            //*(A + y*ncols+x) = 11;   // (no bug !)\n            //*(A + (y*ncols+x)) = 11; // BUG!!!\n        }\n    }\n\n    for (int x = 0; x &lt; ncols; ++x)\n    {\n        printf(\"%d,\", A[x]);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "pointers", "reference"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1488390642, "post_id": 42538606, "comment_id": 72212908, "body": "the second one doesn&#39;t compile. Also references cannot (normally) be null, so you don&#39;t need a null check before accessing them"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1488390726, "post_id": 42538606, "comment_id": 72212946, "body": "@UnholySheep: I don&#39;t like to start with &quot;references cannot be null&quot; -- it&#39;s all the wrong way round. I&#39;d much rather say &quot;pointers may be null and not point to an object&quot;. That way round makes it immediately clear that pointers are more complex than references and require a more complex API."}, {"owner": {"reputation": 47, "user_id": 7274529, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4y1mGwLDOX8/AAAAAAAAAAI/AAAAAAAAIsE/M5p1M-OrmWQ/photo.jpg?sz=128", "display_name": "Gagan", "link": "https://stackoverflow.com/users/7274529/gagan"}, "edited": false, "score": 0, "creation_date": 1488390747, "post_id": 42538606, "comment_id": 72212962, "body": "Sorry. Copy paste mistake. Corrected. Thanks."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1488390787, "post_id": 42538606, "comment_id": 72212988, "body": "In many ways, the use case for <code>T&amp;</code> is similar to a non-null <code>T * const</code>. If your application doesn&#39;t allow the pointer to be null or to be reassigned to another instance, you can use references for clarity and brevity."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1488390949, "post_id": 42538606, "comment_id": 72213089, "body": "On a scale from 1 to 10, with one end as the best, it&#39;s justified to degree 6.28."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 2, "creation_date": 1488390980, "post_id": 42538606, "comment_id": 72213110, "body": "Voted to close as opinion-based."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 2, "creation_date": 1488392148, "post_id": 42538606, "comment_id": 72213802, "body": "@Cheersandhth.-Alf Gray field. Not really POB."}], "answers": [{"comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1488390924, "post_id": 42538693, "comment_id": 72213070, "body": "Two other concerns:  pointers take up space, and you can have arrays of pointers."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 4, "creation_date": 1488391336, "post_id": 42538693, "comment_id": 72213307, "body": "@stark References have a size, it just can&#39;t be obtained with <code>sizeof</code> directly. In practice, I don&#39;t know of an implementation where it isn&#39;t the size of a pointer. And I believe the phrase &quot;Use pointers when you need pointers&quot; covers the concern &quot;you can have arrays of pointers&quot;."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1488391849, "post_id": 42538693, "comment_id": 72213619, "body": "@stark, strictly spoken you can&#39;t have array of references, but you can work around by using <a href=\"http://en.cppreference.com/w/cpp/utility/functional/reference_wrapper\" rel=\"nofollow noreferrer\">std::reference_wrapper</a>. <a href=\"http://coliru.stacked-crooked.com/a/627f1f7cde8f575e\" rel=\"nofollow noreferrer\">Demo</a>."}, {"owner": {"reputation": 41213, "user_id": 215568, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05685e6c3945f4bd23bf1f967861aeb?s=128&d=identicon&r=PG", "display_name": "Donnie", "link": "https://stackoverflow.com/users/215568/donnie"}, "edited": false, "score": 0, "creation_date": 1488558448, "post_id": 42538693, "comment_id": 72300171, "body": "Perhaps the hierarchy would have been more obvious thus:  Pass by value when you can, use references when you can&#39;t (or shouldn&#39;t), unless something requires you to use a pointer."}], "tags": [], "owner": {"reputation": 41213, "user_id": 215568, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05685e6c3945f4bd23bf1f967861aeb?s=128&d=identicon&r=PG", "display_name": "Donnie", "link": "https://stackoverflow.com/users/215568/donnie"}, "is_accepted": false, "score": 3, "last_activity_date": 1488390867, "creation_date": 1488390867, "answer_id": 42538693, "question_id": 42538606, "link": "https://stackoverflow.com/questions/42538606/how-justified-is-to-use-reference-instead-of-pointer-for-the-ease-of-use-in-c/42538693#42538693", "title": "how justified is to use reference instead of pointer for the ease of use in C++?", "body": "<p>Use pointers when you need pointers, use references when you don't but don't want to pass by value. The fact that one takes one more character than the other to use should be the least of your concerns.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 7274529, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4y1mGwLDOX8/AAAAAAAAAAI/AAAAAAAAIsE/M5p1M-OrmWQ/photo.jpg?sz=128", "display_name": "Gagan", "link": "https://stackoverflow.com/users/7274529/gagan"}, "edited": false, "score": 0, "creation_date": 1488396472, "post_id": 42538713, "comment_id": 72216427, "body": "Basically, other than a check for nullptr, reference serves only one additional purpose. You can use object.member rather than object-&gt;member."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 47, "user_id": 7274529, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4y1mGwLDOX8/AAAAAAAAAAI/AAAAAAAAIsE/M5p1M-OrmWQ/photo.jpg?sz=128", "display_name": "Gagan", "link": "https://stackoverflow.com/users/7274529/gagan"}, "edited": false, "score": 0, "creation_date": 1488396570, "post_id": 42538713, "comment_id": 72216488, "body": "That is true but it&#39;s only a minor issue in the overall scheme of things. If we could use the &quot;.&quot; syntax for pointers and the &quot;-&gt;&quot; syntax for references, I would still recommend using references."}, {"owner": {"reputation": 47, "user_id": 7274529, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4y1mGwLDOX8/AAAAAAAAAAI/AAAAAAAAIsE/M5p1M-OrmWQ/photo.jpg?sz=128", "display_name": "Gagan", "link": "https://stackoverflow.com/users/7274529/gagan"}, "edited": false, "score": 0, "creation_date": 1488532626, "post_id": 42538713, "comment_id": 72282711, "body": "Only thing that tells me no to use reference that by looking at code, I don&#39;t know if a pointer is being sent to func.  Like func(abcd) where abcd is some variable."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1488390919, "creation_date": 1488390919, "answer_id": 42538713, "question_id": 42538606, "link": "https://stackoverflow.com/questions/42538606/how-justified-is-to-use-reference-instead-of-pointer-for-the-ease-of-use-in-c/42538713#42538713", "title": "how justified is to use reference instead of pointer for the ease of use in C++?", "body": "<p>As a coding guideline, it is better to use references instead of pointers. When an argument is of a reference type, the function can simply use the object. When an argument is of a pointer type, you always have to add logic to deal with the argument being a NULL pointer.</p>\n"}, {"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1488392214, "post_id": 42539055, "comment_id": 72213850, "body": "Perhaps <i>reckless</i> rather than <i>courageous</i>."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488392372, "post_id": 42539055, "comment_id": 72213957, "body": "<i>Using a reference requires correct initialization at compile time</i> ... <a href=\"http://coliru.stacked-crooked.com/a/7780504d41cfdb8d\" rel=\"nofollow noreferrer\">not necessarily</a>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488392597, "post_id": 42539055, "comment_id": 72214074, "body": "@zett42 Good point!"}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488392900, "post_id": 42539055, "comment_id": 72214268, "body": "I would write it like this: When using pointers, it&#39;s the responsibility of the function that has pointer parameters to check for valid pointers (!= nullptr), whereas using references it&#39;s the responsibility of the caller to pass valid reference arguments."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488393370, "post_id": 42539055, "comment_id": 72214539, "body": "@zett42 Adopted. Sorry calling your example silly ;-)"}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488394275, "post_id": 42539055, "comment_id": 72215052, "body": "I think whenever one does something like this, the universe silently reboots after moving one into a parallel universe where this hasn&#39;t happened yet ;-)"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488394424, "post_id": 42539055, "comment_id": 72215144, "body": "@zett42 Sounds like you&#39;re an enlightened person. Thank you."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1488394472, "post_id": 42539055, "comment_id": 72215179, "body": "@user2079303 Somehow, yes."}, {"owner": {"reputation": 47, "user_id": 7274529, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4y1mGwLDOX8/AAAAAAAAAAI/AAAAAAAAIsE/M5p1M-OrmWQ/photo.jpg?sz=128", "display_name": "Gagan", "link": "https://stackoverflow.com/users/7274529/gagan"}, "edited": false, "score": 0, "creation_date": 1488396164, "post_id": 42539055, "comment_id": 72216237, "body": "Courageous or reckless or both. But when I&#39;m the one to call my function, I guess it can work.  Though I do check for pointers, I just removed that line from the question. Guess I shouldn&#39;t have."}], "tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 3, "last_activity_date": 1488394535, "last_edit_date": 1488394535, "creation_date": 1488392091, "answer_id": 42539055, "question_id": 42538606, "link": "https://stackoverflow.com/questions/42538606/how-justified-is-to-use-reference-instead-of-pointer-for-the-ease-of-use-in-c/42539055#42539055", "title": "how justified is to use reference instead of pointer for the ease of use in C++?", "body": "<blockquote>\n<pre><code> void func(stStates *states)\n {\n     states-&gt;nextState = 0;\n }\n</code></pre>\n</blockquote>\n\n<p>Writing such code is courageous!</p>\n\n<p>At least you should assert, that no <code>nullptr</code> is passed before dereferencing the pointer parameter:</p>\n\n<pre><code>void func(stStates *states)\n{\n   assert(states);\n   states-&gt;nextState = 0;\n}\n</code></pre>\n\n<p>or you handle that smoothly, if you don't require to have a valid instance of <code>stStates</code> passed when your function is called:</p>\n\n<pre><code>void func(stStates *states)\n{\n   if(states) {\n       states-&gt;nextState = 0;\n   }\n}\n</code></pre>\n\n<p>Neither of these mentioned methods will save you from invalid pointers passed in like:</p>\n\n<pre><code>stStates* states; // &lt;&lt; uninitialized, points elsewhere\nfunc(states);\n</code></pre>\n\n<p><sub>Well there may be a compiler warning.</sub></p>\n\n<hr>\n\n<p>Using a reference on the other hand mostly requires correct initialization at compile time, and avoids the problems stated above.</p>\n\n<p>Though you still can do silly things like <a href=\"http://coliru.stacked-crooked.com/a/7780504d41cfdb8d\" rel=\"nofollow noreferrer\">this</a>, and the compiler won't warn you about it:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    int* p = nullptr;\n    int&amp; r = *p;\n    r = 42;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>clang++ -std=c++14 -Os -Wall -lboost_timer -lboost_system main.cpp &amp;&amp; ./a.out\nbash: line 7: 26635 Illegal instruction     (core dumped) ./a.out\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7274529, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4y1mGwLDOX8/AAAAAAAAAAI/AAAAAAAAIsE/M5p1M-OrmWQ/photo.jpg?sz=128", "display_name": "Gagan", "link": "https://stackoverflow.com/users/7274529/gagan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "closed_date": 1489618076, "answer_count": 3, "score": 0, "last_activity_date": 1488394535, "creation_date": 1488390543, "last_edit_date": 1488391528, "question_id": 42538606, "link": "https://stackoverflow.com/questions/42538606/how-justified-is-to-use-reference-instead-of-pointer-for-the-ease-of-use-in-c", "closed_reason": "Opinion-based", "title": "how justified is to use reference instead of pointer for the ease of use in C++?", "body": "<p>how justified is to use reference instead of pointer because you can access the members with '.' instead of '<code>-&gt;</code>' operator.\nLike inside the function</p>\n\n<pre><code>void func(stStates &amp;states)\n{\n   states.nextState = 0;\n}\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>void func(stStates *states)\n{\n   states-&gt;nextState = 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "opengl", "unicode"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 3, "creation_date": 1488390495, "post_id": 42538578, "comment_id": 72212828, "body": "A <code>char</code> in C++ is one byte, and <code>%c</code> says you&#39;re passing a <code>char</code>."}, {"owner": {"reputation": 3423, "user_id": 4317639, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-51v9SCix-tY/AAAAAAAAAAI/AAAAAAAAAFc/OJYPEymZCVE/photo.jpg?sz=128", "display_name": "erol yeniaras", "link": "https://stackoverflow.com/users/4317639/erol-yeniaras"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1488390624, "post_id": 42538578, "comment_id": 72212896, "body": "@chris: That`s a very good point. I tried to render it as a string as well. Then it gave a totally different unicode character."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1488390740, "post_id": 42538578, "comment_id": 72212958, "body": "You have used <code>%c</code>, which with <code>sprint</code> is a placeholder for a single <code>char</code> value. You&#39;re passing it <code>\\u394</code>, which with most C++ implementation will not be a single byte, i.e. not of type <code>char</code>. What you need to do depends on what the relevant GLStudio function requires. If it wants a wide string, pass it that. If wants an UTF-8 encoded narrow string, pass it that."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1488390760, "post_id": 42538578, "comment_id": 72212971, "body": "If you&#39;re programming in C++, why don&#39;t you use <code>std::string</code> and <code>std::ostringstream</code> for formatting strings?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1488390839, "post_id": 42538578, "comment_id": 72213017, "body": "Or why use formatting at all? Why not simply do <code>strcpy(somebuffer, &quot;\\u0394P&quot;)</code> (to continue with the C functions)?"}, {"owner": {"reputation": 3423, "user_id": 4317639, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-51v9SCix-tY/AAAAAAAAAAI/AAAAAAAAAFc/OJYPEymZCVE/photo.jpg?sz=128", "display_name": "erol yeniaras", "link": "https://stackoverflow.com/users/4317639/erol-yeniaras"}, "edited": false, "score": 0, "creation_date": 1488390900, "post_id": 42538578, "comment_id": 72213055, "body": "Friends, thanks for awesome comments. I am updating someone else`s code so I have to &quot;kinda&quot; use sprintf. But will definitely fix the character (1 byte) issue."}, {"owner": {"reputation": 3423, "user_id": 4317639, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-51v9SCix-tY/AAAAAAAAAAI/AAAAAAAAAFc/OJYPEymZCVE/photo.jpg?sz=128", "display_name": "erol yeniaras", "link": "https://stackoverflow.com/users/4317639/erol-yeniaras"}, "edited": false, "score": 0, "creation_date": 1488393479, "post_id": 42538578, "comment_id": 72214598, "body": "I am trying the suggestions. Why did the question get down-vote? Please help me improve the question if not in good shape. Thanks."}, {"owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "edited": false, "score": 0, "creation_date": 1582215249, "post_id": 42538578, "comment_id": 106708729, "body": "You&#39;ll also need to make sure the renderer has access to the font file at runtime or, in the case of some rendering engines, at build time so it can generate the correct glyphs as textures. It depends what mode you are generating text in what you need to worry about -- does it generate them on the fly or &quot;bake&quot; text into textures and then reference those textures, either as a whole or as individual glyphs within the texture? The different modes have different trade-offs in terms of runtime performance and texture overhead, so YMMV."}], "answers": [{"tags": [], "owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "is_accepted": false, "score": 2, "last_activity_date": 1488390877, "creation_date": 1488390877, "answer_id": 42538696, "question_id": 42538578, "link": "https://stackoverflow.com/questions/42538578/unicode-character-greek-capital-letter-delta-is-rendered-as-white-vertical-re/42538696#42538696", "title": "Unicode character &quot;GREEK CAPITAL LETTER DELTA&quot; is rendered as &quot;White vertical rectangle&quot; in c++ and GLStudio", "body": "<p>This entirely depends on the encoding expected by the renderer. There's a good chance it expects or supports UTF-8:</p>\n\n<pre><code>sprintf(somebuffer, u8\"\\u0394P\");\n</code></pre>\n\n<p>This forms the string <code>&lt;capital delta&gt;&lt;P&gt;</code> encoded in UTF-8 and writes it to the buffer (without checking size or using a more suitable C function like <code>strncpy</code>). It's then up to the renderer to take those bytes and render them how you expect.</p>\n\n<p>What's going on currently is very likely passing an <code>int</code> argument in place of the <code>%c</code> placeholder that expects a <code>char</code>. I would imagine that while undefined behaviour, it's taking the first byte and treating that as a <code>char</code>. </p>\n"}], "owner": {"reputation": 3423, "user_id": 4317639, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-51v9SCix-tY/AAAAAAAAAAI/AAAAAAAAAFc/OJYPEymZCVE/photo.jpg?sz=128", "display_name": "erol yeniaras", "link": "https://stackoverflow.com/users/4317639/erol-yeniaras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582215276, "creation_date": 1488390440, "last_edit_date": 1582215276, "question_id": 42538578, "link": "https://stackoverflow.com/questions/42538578/unicode-character-greek-capital-letter-delta-is-rendered-as-white-vertical-re", "title": "Unicode character &quot;GREEK CAPITAL LETTER DELTA&quot; is rendered as &quot;White vertical rectangle&quot; in c++ and GLStudio", "body": "<p>Programming language: <code>C++</code>, Renderer: <code>GLStudio</code>.</p>\n\n<p>I want to render Unicode Character <code>'GREEK CAPITAL LETTER DELTA' (U+0394)</code> as in: <code>\u0394P</code></p>\n\n<p>The code is:</p>\n\n<pre><code>sprintf(somebuffer,\"%cP\",'\\u0394');\n</code></pre>\n\n<p>however the result is WHITE VERTICAL RECTANGLE' (U+25AF) as below:</p>\n\n<pre><code>\u25afP\n</code></pre>\n\n<p>Here is the reference I used: <a href=\"http://unicodes\" rel=\"nofollow noreferrer\">http://www.fileformat.info/info/unicode/char/25af/index.htm</a></p>\n\n<p>Obviously there is a unicode mapping issue on the renderer but I could not pinpoint it exactly so wanted to try my chances in SO before trying to draw an actual opengl triangle as a workaround. Any help or suggestion is greatly appreciated!</p>\n"}, {"tags": ["c++", "memory", "memory-alignment", "avx"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1488390639, "post_id": 42538564, "comment_id": 72212905, "body": "That&#39;s a little less than 10MB. How much (virtual?) memory do you have in your system? Can the system guarantee that it can allocate a contiguous chunk of memory (which is probably the problem you have)?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1488390911, "post_id": 42538564, "comment_id": 72213061, "body": "Oh and you <i>do</i> check if the allocation function returns a null pointer?"}, {"owner": {"reputation": 123, "user_id": 6658320, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh6.googleusercontent.com/-Or8CoZC9cmc/AAAAAAAAAAI/AAAAAAAAAA4/23CAEyWZ0Tw/photo.jpg?sz=128", "display_name": "Aliya Clark", "link": "https://stackoverflow.com/users/6658320/aliya-clark"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1488391039, "post_id": 42538564, "comment_id": 72213148, "body": "I have 12GB memory. I am sorry I need more than 10MB. its not 2000*1300. its  2000*1300*17*17. if I use new it works fine and there is no issue. However memory usage goes to its peak around 11.9. In advanced settings it says &quot;Total paging file size for all drives is 15247MB&quot;  which is system managed for only drive C"}, {"owner": {"reputation": 123, "user_id": 6658320, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh6.googleusercontent.com/-Or8CoZC9cmc/AAAAAAAAAAI/AAAAAAAAAA4/23CAEyWZ0Tw/photo.jpg?sz=128", "display_name": "Aliya Clark", "link": "https://stackoverflow.com/users/6658320/aliya-clark"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1488391189, "post_id": 42538564, "comment_id": 72213233, "body": "Yes it returns a null pointer. Thanks for the tip. I&#39;ll modify the question."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1488391596, "post_id": 42538564, "comment_id": 72213457, "body": "SSE/AVX requires alignment of 32? Can you put that in the question?"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1488391630, "post_id": 42538564, "comment_id": 72213486, "body": "What happens if you try to use regular malloc of <code>2000*1300*17*17 + 32</code>? If that fails, you know that it&#39;s a memory issue, and not an alignment issue."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1488391657, "post_id": 42538564, "comment_id": 72213502, "body": "MSDN says <code>_aligned_malloc</code> sets <code>errno</code> too. Assuming that&#39;s the right platform, was it set to ENOMEM or EINVAL?"}, {"owner": {"reputation": 123, "user_id": 6658320, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh6.googleusercontent.com/-Or8CoZC9cmc/AAAAAAAAAAI/AAAAAAAAAA4/23CAEyWZ0Tw/photo.jpg?sz=128", "display_name": "Aliya Clark", "link": "https://stackoverflow.com/users/6658320/aliya-clark"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1488395488, "post_id": 42538564, "comment_id": 72215804, "body": "@MooingDuck It worked fine when I allocate memory with <code>new</code>. But `malloc() doesn&#39;t work returns a null pointer."}, {"owner": {"reputation": 123, "user_id": 6658320, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh6.googleusercontent.com/-Or8CoZC9cmc/AAAAAAAAAAI/AAAAAAAAAA4/23CAEyWZ0Tw/photo.jpg?sz=128", "display_name": "Aliya Clark", "link": "https://stackoverflow.com/users/6658320/aliya-clark"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1488396593, "post_id": 42538564, "comment_id": 72216505, "body": "@Useless it returns <code>ENOMEM</code> . Can some one please suggest me a solution for this. Is there a way to allocate memory free store."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1488825177, "post_id": 42538564, "comment_id": 72393789, "body": "@AliyaClark: I find it very surprising that <code>new</code> can allocate this ~3Gb, but <code>malloc</code> can&#39;t. More likely it&#39;s time-based, rather than the code itself. It depends on what other programs are running in the background.  My advice would be to replace your algorithm with something that doesn&#39;t require 3Gb of contiguous memory. Prefer working with blocks of ~16Mb at a time. Consider using a file-backed memory map, and only map ~16Mb at a time."}], "answers": [{"tags": [], "owner": {"reputation": 1935, "user_id": 2688641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/dnRQq.jpg?s=128&g=1", "display_name": "Christoph Diegelmann", "link": "https://stackoverflow.com/users/2688641/christoph-diegelmann"}, "is_accepted": false, "score": 2, "last_activity_date": 1489072437, "last_edit_date": 1592644375, "creation_date": 1489072437, "answer_id": 42698909, "question_id": 42538564, "link": "https://stackoverflow.com/questions/42538564/allocating-aligned-memory-for-larger-arrays/42698909#42698909", "title": "Allocating aligned memory for larger arrays", "body": "<h3>On memory allocation:</h3>\n<p>I seems you are actually trying to alocate <code>2000*1300*17*17*4</code> <code>32 bytes</code> elements. This is means you are trying to allocate 96 GB while your system has only 12 GB memory.</p>\n<p>Since <code>new</code> is working but malloc not it seems <em>your local</em> implementation of <code>new</code> seems to be able to allocate huge amounts of <em>virtual memory</em>. Malloc allocates from the heap which means it is usally limited to the physical amount of memory you've got. That's the reason it fails.</p>\n<p>As the dataset is bigger than your main memory you might want to allocate the memory using <code>mmap</code> which maps a file into virtual memory making it accessable <em>as if</em> it was in physical memory (but it will only partially be cached in memory). I'm not sure if it's guaranteed but <code>mmap</code> usally aligns on optimal <em>page size boundary</em> (almost always 4096 byte).</p>\n<p>Anyway you will have a huge performance loss due to the fact that your disk is <strong>way</strong> slower than your RAM. This is so serious that using AVX will probably not speed up anything at all.</p>\n<h3>On the performance loss of using unaligned memory:</h3>\n<p>On modern hardware (say Intel's Haswell onwards I think) this depends on your access patterns. Unaligned access should have almost no performance overhead on iterating over the array in memory order (each cache line will still be loaded only once). If you access it in <em>random order</em> than you will often cross the <em>64 byte cache line boundry</em>. This means your processor will have to <em>load 2 lines into cache and remove 2 lines from the cache</em> instead of only one. While this might be a serious problem for some situations in your case the disk will slows things down so much that you will barely notice this.</p>\n<h3>Addtional tips (or a shot in the dark):</h3>\n<p>The way you gave the size of the array (<code>2000*1300*17*17*4</code>) suggests that you are using a multidimensional array (e.g. <code>auto x = new __m256[2000][1300][17][17][4]</code>). So some tipps on that:</p>\n<ul>\n<li>Iterate through it mostly sequential</li>\n<li>Check if it is sparse (meaning some of the memory will never be accessed) and shrink it if possible.</li>\n</ul>\n<p>You could try to flatten the array and do more complex index calculation yourself in order to reduce the amount of memory need. If you get it to fit completely into your RAM you can start to optimise your code (using AVX and/or aligned memory).</p>\n<p><em>&quot;Total paging file size for all drives is 15247MB&quot;</em> suggests that you actually using only parts of that <em>96 GB</em> so there might be a way to further reduce your usage.</p>\n<p>In that case you might also want to ask another question on how to reduce the memory usage with more info on what you are doing.</p>\n"}], "owner": {"reputation": 123, "user_id": 6658320, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh6.googleusercontent.com/-Or8CoZC9cmc/AAAAAAAAAAI/AAAAAAAAAA4/23CAEyWZ0Tw/photo.jpg?sz=128", "display_name": "Aliya Clark", "link": "https://stackoverflow.com/users/6658320/aliya-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1489072437, "creation_date": 1488390414, "last_edit_date": 1495540439, "question_id": 42538564, "link": "https://stackoverflow.com/questions/42538564/allocating-aligned-memory-for-larger-arrays", "title": "Allocating aligned memory for larger arrays", "body": "<p>In my program I want to allocate <code>32 byte</code> aligned memory to use SSE/AVX. The amount I want to allocate is somewhere around <code>2000*1300*17*17*4(large data set)</code>. I tried using functions <code>_aligned_malloc()</code> and <code>_mm_malloc</code> but for larger sizes it doesn't allocate memory and results in a access violation exception. If the amount allocated is small like around <code>512*320*4*17*17(small data set)</code> then the code work fine. </p>\n\n<p>Here these functions return a null pointer when allocation is done for large data set.But works fine when input data size is small. Also here if I just use unaligned memory allocation using <code>new</code> then code works fine for large data set too.<br>\nFinally Can someone tell me Is there any significant performance gains in using aligned memory for AVX.</p>\n\n<p>Edit: After some research according to this <a href=\"https://stackoverflow.com/questions/240212/what-is-the-difference-between-new-delete-and-malloc-free\">post</a> it says that <code>new</code> allocate memory from free store and <code>malloc()</code> allocate memory from heap. Here I am exceeding maximum heap size as <code>_aligned_malloc()</code> return <code>errno</code> 12 which means <code>ENOMEM</code>  in that case Can someone tell me a work around for this. </p>\n"}, {"tags": ["c++", "c++11", "templates"], "comments": [{"owner": {"reputation": 1116, "user_id": 5813151, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6ab74bcd2266233421ac0c4ba8e19465?s=128&d=identicon&r=PG", "display_name": "moonboy", "link": "https://stackoverflow.com/users/5813151/moonboy"}, "edited": false, "score": 0, "creation_date": 1488390411, "post_id": 42538495, "comment_id": 72212778, "body": "i notice that you are declaring class Test and friending class test, but Test is a struct. Is this intentional?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488390415, "post_id": 42538495, "comment_id": 72212786, "body": "<i>&quot;However the class Test is compiled successfully without error.&quot;</i> What do you mean? I&#39;d suspect the compiler stops befor statring to complain about <code>Test</code>."}, {"owner": {"reputation": 115, "user_id": 1301515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be4b433488a2cc30ae1885baed500414?s=128&d=identicon&r=PG&f=1", "display_name": "Premkumar U", "link": "https://stackoverflow.com/users/1301515/premkumar-u"}, "reply_to_user": {"reputation": 1116, "user_id": 5813151, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6ab74bcd2266233421ac0c4ba8e19465?s=128&d=identicon&r=PG", "display_name": "moonboy", "link": "https://stackoverflow.com/users/5813151/moonboy"}, "edited": false, "score": 0, "creation_date": 1488390660, "post_id": 42538495, "comment_id": 72212915, "body": "@tramstheman Its a typo. Sorry. \u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 I tried compiling the test by commenting out base variable. This way it is successfully compiled. Will update the question"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1488391938, "post_id": 42538495, "comment_id": 72213669, "body": "g++ chokes, clang++ swallows."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1488392874, "post_id": 42538495, "comment_id": 72214251, "body": "Shouldn&#39;t it be <code>template &lt;typename... type&gt; friend class Base&lt;type&gt;;</code> ?"}, {"owner": {"reputation": 1116, "user_id": 5813151, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6ab74bcd2266233421ac0c4ba8e19465?s=128&d=identicon&r=PG", "display_name": "moonboy", "link": "https://stackoverflow.com/users/5813151/moonboy"}, "edited": false, "score": 1, "creation_date": 1488393546, "post_id": 42538495, "comment_id": 72214651, "body": "I just ran your code as posted and it compiles and runs fine. What compiler are you using?"}, {"owner": {"reputation": 115, "user_id": 1301515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be4b433488a2cc30ae1885baed500414?s=128&d=identicon&r=PG&f=1", "display_name": "Premkumar U", "link": "https://stackoverflow.com/users/1301515/premkumar-u"}, "reply_to_user": {"reputation": 1116, "user_id": 5813151, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6ab74bcd2266233421ac0c4ba8e19465?s=128&d=identicon&r=PG", "display_name": "moonboy", "link": "https://stackoverflow.com/users/5813151/moonboy"}, "edited": false, "score": 0, "creation_date": 1488437731, "post_id": 42538495, "comment_id": 72232583, "body": "@tramstheman TDM Gcc 64 bit in windows 10."}, {"owner": {"reputation": 115, "user_id": 1301515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be4b433488a2cc30ae1885baed500414?s=128&d=identicon&r=PG&f=1", "display_name": "Premkumar U", "link": "https://stackoverflow.com/users/1301515/premkumar-u"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488560890, "post_id": 42538495, "comment_id": 72301727, "body": "@n.m. Is clang correct or g++ correct? Any explanations please..."}, {"owner": {"reputation": 1116, "user_id": 5813151, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6ab74bcd2266233421ac0c4ba8e19465?s=128&d=identicon&r=PG", "display_name": "moonboy", "link": "https://stackoverflow.com/users/5813151/moonboy"}, "edited": false, "score": 0, "creation_date": 1488571307, "post_id": 42538495, "comment_id": 72307031, "body": "can you edit the question to include the your console logs?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488623405, "post_id": 42538495, "comment_id": 72320964, "body": "I don&#39;t know, just observed this."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1488964615, "post_id": 42538495, "comment_id": 72459394, "body": "I found the <code>Test</code> class inheriting from those private classes being legal in the C++11 standard (see 11.3), but could not find anything specific explicitly excluding this for template classes. Provided I did not oversee it, I do not see any reason why there should be a difference with template classes, so I conclude clang is correct and gcc errs..."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 1301515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be4b433488a2cc30ae1885baed500414?s=128&d=identicon&r=PG&f=1", "display_name": "Premkumar U", "link": "https://stackoverflow.com/users/1301515/premkumar-u"}, "edited": false, "score": 0, "creation_date": 1488786798, "post_id": 42592971, "comment_id": 72368839, "body": "I will check this. But the class named &quot;Inner&quot; is not private in the code given by you. For me it is my requirement."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 115, "user_id": 1301515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be4b433488a2cc30ae1885baed500414?s=128&d=identicon&r=PG&f=1", "display_name": "Premkumar U", "link": "https://stackoverflow.com/users/1301515/premkumar-u"}, "edited": false, "score": 0, "creation_date": 1488962455, "post_id": 42592971, "comment_id": 72458136, "body": "@PremkumarU Why should the Inner class be private? Your own template class inherits publicly, too, from those private inner classes..."}, {"owner": {"reputation": 115, "user_id": 1301515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be4b433488a2cc30ae1885baed500414?s=128&d=identicon&r=PG&f=1", "display_name": "Premkumar U", "link": "https://stackoverflow.com/users/1301515/premkumar-u"}, "edited": false, "score": 0, "creation_date": 1488995126, "post_id": 42592971, "comment_id": 72481012, "body": "@ben Your workaround works. I am really wondering how you find this workaround. I am happy to accept this as my answer and award bounty. But if possible could you please explain how do you found this workaround? Thank you"}, {"owner": {"reputation": 115, "user_id": 1301515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be4b433488a2cc30ae1885baed500414?s=128&d=identicon&r=PG&f=1", "display_name": "Premkumar U", "link": "https://stackoverflow.com/users/1301515/premkumar-u"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1488995380, "post_id": 42592971, "comment_id": 72481174, "body": "@Aconcagua I want that inner struct to be part of the class template and at the same time that inner struct need not to be accessed away from my library. That is why I make it private and be accessible from the class template because of friend declaration. Is there any other alternative design which is better than my approach?"}, {"owner": {"reputation": 96, "user_id": 7656928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ace1b630b93ebaf36b435297f4b80e7?s=128&d=identicon&r=PG&f=1", "display_name": "ben", "link": "https://stackoverflow.com/users/7656928/ben"}, "reply_to_user": {"reputation": 115, "user_id": 1301515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be4b433488a2cc30ae1885baed500414?s=128&d=identicon&r=PG&f=1", "display_name": "Premkumar U", "link": "https://stackoverflow.com/users/1301515/premkumar-u"}, "edited": false, "score": 0, "creation_date": 1489009808, "post_id": 42592971, "comment_id": 72489265, "body": "@PremkumarU I&#39;m not too sure what else you could do if you&#39;d like to directly inherit. I noticed you inherited publicly from Base, so I assumed this would work for your example. Another way to hide BaseInherit as an implementation detail would be to put it in an anonymous namespace. I&#39;ll also update the answer to explain how I worked it out."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1489045899, "post_id": 42592971, "comment_id": 72501960, "body": "An alternative could have been letting an inner (proxy) class of the template class inherit the private member classes. This would have worked fine with GCC, too, for the cost of having to access the inherited members via <code>object.proxy.memberN</code>."}], "tags": [], "owner": {"reputation": 96, "user_id": 7656928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ace1b630b93ebaf36b435297f4b80e7?s=128&d=identicon&r=PG&f=1", "display_name": "ben", "link": "https://stackoverflow.com/users/7656928/ben"}, "is_accepted": true, "score": 1, "last_activity_date": 1489010861, "last_edit_date": 1489010861, "creation_date": 1488609464, "answer_id": 42592971, "question_id": 42538495, "link": "https://stackoverflow.com/questions/42538495/making-a-class-or-struct-to-be-friend-of-all-template-instantiated-class/42592971#42592971", "title": "Making a class or struct to be friend of all template instantiated class?", "body": "<p>Here's a workaround for this odd issue...</p>\n\n<p>Create a struct with a nested struct that inherits the inner structs :</p>\n\n<pre><code>template &lt;class... Types&gt;\nstruct BaseInherit {\n  struct Inner : public Types::Inner... {};\n};\n</code></pre>\n\n<p>Then, inherit from BaseInherit's nested inner in Base :</p>\n\n<pre><code>template &lt;class... Types&gt;\nclass Base : public BaseInherit &lt;Types...&gt;::Inner {};\n</code></pre>\n\n<p>This is what I had to do for GCC (6.3.1).</p>\n\n<p>Edit: Forgot to say that you would then add BaseInherit as the friend struct, and not Base. Example :</p>\n\n<pre><code>class S1 {\n\n  template &lt;class... Types&gt;\n  friend struct BaseInherit;\n\n  struct Inner { int member1, member2; };\n\n};\n</code></pre>\n\n<p>Edit : How the workaround was found - I was trying to figure out the order in which the compiler would deduce variadic templates when inheriting. Since it complained when they were directly inherited, I thought that it may work in the scope of the class. Of course, we can't inherit from its own nested struct, so we put it in another struct / public class's nested struct.</p>\n"}], "owner": {"reputation": 115, "user_id": 1301515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be4b433488a2cc30ae1885baed500414?s=128&d=identicon&r=PG&f=1", "display_name": "Premkumar U", "link": "https://stackoverflow.com/users/1301515/premkumar-u"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 1, "accepted_answer_id": 42592971, "answer_count": 1, "score": 2, "last_activity_date": 1489010861, "creation_date": 1488390206, "last_edit_date": 1488390717, "question_id": 42538495, "link": "https://stackoverflow.com/questions/42538495/making-a-class-or-struct-to-be-friend-of-all-template-instantiated-class", "title": "Making a class or struct to be friend of all template instantiated class?", "body": "<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nstruct s1;\n\ntemplate &lt;typename... type&gt;\nclass Base : public type::inner...\n{\n    friend struct s1;\n\n};\n\nstruct Test;\n\nstruct s1\n{\n    template &lt;typename... type&gt;\n    friend class Base;\n\n    friend class Test;\n\n    private:\n    struct inner {\n\n    int member1;\n    int member2;\n    };\n};\n\nstruct s2\n{\n    struct inner {\n\n    int member3;\n    int member4;\n    };\n};\n\nstruct Test : public s1::inner, public s2::inner\n{\n\n};\n\nint main()\n{\n    Base&lt;s1, s2&gt; base;\n    base.member1 = 0;\n\n    Test t;\n    t.member3 = 22;\n\n    cout &lt;&lt; \"Hello world!\" &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>When I tried to compile the above code I am getting the below error</p>\n\n<p>In instantiation of 'class Base':\nerror: 'struct s1::inner' is private</p>\n\n<p>However the class Test is compiled successfully without error when tried to compile this program by commenting out the base variable. I want to make the template class named Base to be friend of struct s1. How do I do that?</p>\n"}, {"tags": ["c++", "opencv", "flann"], "comments": [{"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1488392549, "post_id": 42538310, "comment_id": 72214042, "body": "I think this is related: <a href=\"https://github.com/opencv/opencv/issues/5937\" rel=\"nofollow noreferrer\">github.com/opencv/opencv/issues/5937</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1150, "user_id": 1789718, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3fe641a6a3acaaede04ec4a239f78e41?s=128&d=identicon&r=PG", "display_name": "Luca", "link": "https://stackoverflow.com/users/1789718/luca"}, "is_accepted": false, "score": 0, "last_activity_date": 1488459175, "creation_date": 1488459175, "answer_id": 42556052, "question_id": 42538310, "link": "https://stackoverflow.com/questions/42538310/error-when-using-lsh-index-in-opencvflann/42556052#42556052", "title": "Error when using LSH index in opencv::flann", "body": "<p>Was using the wrong descritptor type, solution:</p>\n\n<pre><code>cv::UMat descriptors1 = cv::UMat (1, 100, CV_8UC1);\ncv::UMat descriptors2 = cv::UMat (1, 100, CV_8UC1);\n</code></pre>\n"}], "owner": {"reputation": 1150, "user_id": 1789718, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3fe641a6a3acaaede04ec4a239f78e41?s=128&d=identicon&r=PG", "display_name": "Luca", "link": "https://stackoverflow.com/users/1789718/luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488459175, "creation_date": 1488389607, "question_id": 42538310, "link": "https://stackoverflow.com/questions/42538310/error-when-using-lsh-index-in-opencvflann", "title": "Error when using LSH index in opencv::flann", "body": "<p>I'm trying to use LSH implementation of flann in opencv: </p>\n\n<pre><code>const int mySizes[1]={100};\ncv::Mat descriptors1 = cv::Mat::zeros(1,mySizes,CV_32F);\ncv::Mat descriptors2 = cv::Mat::zeros(1,mySizes,CV_32F);\n\ncv::Ptr&lt;cv::DescriptorMatcher&gt; matcher_;\nmatcher_ = new cv::FlannBasedMatcher(new cv::flann::LshIndexParams(20,10,2));\nstd::vector&lt;cv::DMatch&gt; matches;\nmatcher_-&gt;match(descriptors1, descriptors2, matches);\n\nstd::cout &lt;&lt; matches[0].distance &lt;&lt; std::endl;\n</code></pre>\n\n<p>more precisely i want to obtain the LSH distance between <code>descriptors1</code> and <code>descriptors2</code> using <code>matches[0].distance</code>.</p>\n\n<p>But when i run this code i get:</p>\n\n<pre><code>OpenCV Error: Unsupported format or combination of formats (type=5\n) in buildIndex_, file /home/lpuglia/repository/opencv/modules/flann/src/miniflann.cpp, line 315\nterminate called after throwing an instance of 'cv::Exception'\n  what():  /home/lpuglia/repository/opencv/modules/flann/src/miniflann.cpp:315: error: (-210) type=5\n in function buildIndex_\n</code></pre>\n\n<p>The code is pretty simple, what am I doing wrong?</p>\n"}, {"tags": ["c++", "cmake", "yocto", "recipe", "openembedded"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1563815599, "post_id": 42538230, "comment_id": 100816820, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/9017573/608639\">Define preprocessor macro through CMake?</a>"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 2, "creation_date": 1563835499, "post_id": 42538230, "comment_id": 100824354, "body": "@jww: The question you suggest as a duplicate is about &quot;internal&quot; adding the flags, within project&#39;s <code>CMakeLists.txt</code>. Current question is about &quot;external&quot; adding the flags, specifically in Yocto - quite a different thing."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1563843799, "post_id": 42538230, "comment_id": 100825905, "body": "@Tsyvarev - Yeah, I thought that too. Then I reviewed the accepted answer."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1563870511, "post_id": 42538230, "comment_id": 100833879, "body": "The <a href=\"https://stackoverflow.com/a/42578353/3440745\">accepted answer</a> tells mostly about Yocto way (&quot;external&quot;) of setting preprocessor macros. Only its last paragraph notes about <code>CMakeLists.txt</code> (&quot;internal&quot;) way. But this note is crucial for the external way to work: If the project <b>rewrites</b> compiler flags (<code>CMAKE_CXX_FLAGS</code>), then all &quot;external&quot; settings will be lost. So the correct way for the project is <b>appending</b> flags instead."}], "answers": [{"comments": [{"owner": {"reputation": 1314, "user_id": 7533828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e0ee5284a696702ff1a076ad33cf727?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas Novotny", "link": "https://stackoverflow.com/users/7533828/tomas-novotny"}, "reply_to_user": {"reputation": 101, "user_id": 2308323, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/16cd1958ea3e2ac94ba20c0c76d7b6c0?s=128&d=identicon&r=PG", "display_name": "AntoineC", "link": "https://stackoverflow.com/users/2308323/antoinec"}, "edited": false, "score": 0, "creation_date": 1488903394, "post_id": 42578353, "comment_id": 72432272, "body": "@AntoineC Thanks for the information. So please accept the answer. And just out of curiosity, which variable did you set?"}, {"owner": {"reputation": 101, "user_id": 2308323, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/16cd1958ea3e2ac94ba20c0c76d7b6c0?s=128&d=identicon&r=PG", "display_name": "AntoineC", "link": "https://stackoverflow.com/users/2308323/antoinec"}, "edited": false, "score": 0, "creation_date": 1488907212, "post_id": 42578353, "comment_id": 72434666, "body": "I set TARGET_CFLAGS. Setting TARGET_CXXFLAGS do not change anything (at least for FANN project)"}], "tags": [], "owner": {"reputation": 1314, "user_id": 7533828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e0ee5284a696702ff1a076ad33cf727?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas Novotny", "link": "https://stackoverflow.com/users/7533828/tomas-novotny"}, "is_accepted": true, "score": 7, "last_activity_date": 1488544771, "last_edit_date": 1488544771, "creation_date": 1488542378, "answer_id": 42578353, "question_id": 42538230, "link": "https://stackoverflow.com/questions/42538230/how-to-add-preprocessor-definition-in-cmake-projet-build-by-yocto/42578353#42578353", "title": "How to add preprocessor definition in CMAKE projet build by Yocto", "body": "<p>I'm using this assignment for a target build in my recipe files (also based on cmake):</p>\n\n<pre><code># This flag is also propagated to CXXFLAGS\nTARGET_CFLAGS += \"-DSOME_FLAG\"\n</code></pre>\n\n<p>I'm not sure why CFLAGS are propagated to CXXFLAGS, so you can also try <code>TARGET_CXXFLAGS</code> variable in OpenEmbeedded. See <a href=\"http://www.yoctoproject.org/docs/2.1/mega-manual/mega-manual.html#var-TARGET_CXXFLAGS\" rel=\"noreferrer\" title=\"Yocto documentation\">Yocto mega manual</a>.</p>\n\n<p>Please note that this will add flags only for a target build (i.e. the result will be used only on target). I see that you  are also building native variant, so <code>BUILD_CXXFLAGS</code> might be helpful. There is also <code>BUILDSDK_CXXFLAGS</code> for nativesdk variant (this is not your case). These variables are clearly described in <a href=\"http://www.yoctoproject.org/docs/2.1/mega-manual/mega-manual.html#var-CXXFLAGS\" rel=\"noreferrer\">the manual in the CXXFLAGS variable description</a>.</p>\n\n<p>By the way, one thing which is related to the CMake: If you use <code>set(CMAKE_CXX_FLAGS \"-DDEBUG\")</code> in your CMakeLists.txt, you need to repeat CMAKE_CXX_FLAGS on the right side, i.e. <code>set(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -DDEBUG\")</code>, otherwise your flags would be overwritten. Please see <a href=\"http://voices.canonical.com/jussi.pakkanen/2013/03/26/a-list-of-common-cmake-antipatterns/\" rel=\"noreferrer\" title=\"this blog\">this blog</a> for more information.</p>\n"}], "owner": {"reputation": 101, "user_id": 2308323, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/16cd1958ea3e2ac94ba20c0c76d7b6c0?s=128&d=identicon&r=PG", "display_name": "AntoineC", "link": "https://stackoverflow.com/users/2308323/antoinec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6175, "favorite_count": 1, "accepted_answer_id": 42578353, "answer_count": 1, "score": 2, "last_activity_date": 1488544771, "creation_date": 1488389329, "question_id": 42538230, "link": "https://stackoverflow.com/questions/42538230/how-to-add-preprocessor-definition-in-cmake-projet-build-by-yocto", "title": "How to add preprocessor definition in CMAKE projet build by Yocto", "body": "<p>I'm working on a existant project that use CMake to configure and generate.\nThe target is an ARM device, so I build all the system with Yocto/OpenEmbedded.</p>\n\n<p>I manage to build a recipe to build the cmake project.\nIt looks like that:</p>\n\n<pre><code>DESCRIPTION = \"FANN LIB\"\n\nLICENSE = \"CLOSED\"\n\ninherit cmake\n\nSRCREV = \"${AUTOREV}\"\n\nPV = \"1.0\"\n\nSRC_URI = \"git://github.com/libfann/fann.git;branch=master;protocol=git\"\n\nS = \"${WORKDIR}/git\"\nBBCLASSEXTEND = \"native\" \n\nFILES_${PN} += \"/usr/lib/cmake/\"\n</code></pre>\n\n<p>In the code there are \"#ifdef DEBUG\" that I would like to activate. So I would like to add DEBUG to the C/C++ Flags.</p>\n\n<p>I found that I could use</p>\n\n<pre><code>EXTRA_OECMAKE += \"CXXFLAGS='-DDEBUG'\"\nEXTRA_OECMAKE = \"set(CMAKE_CXX_FLAGS \"-DDEBUG\")\"\n</code></pre>\n\n<p>But booth replace all CFlags and that is not what I want (plus it broke compilation!)</p>\n\n<p>I just would like taht -DDEBUG is added when calling the compiler! :-)</p>\n\n<p>How can I add a preprocessor definition in a CMake based project in a Yocto recipe?</p>\n"}, {"tags": ["c++", "stl", "iterator", "set", "stdset"], "comments": [{"owner": {"reputation": 102109, "user_id": 1600898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/01377f8b31f24b0265854666b29d0c03?s=128&d=identicon&r=PG", "display_name": "user4815162342", "link": "https://stackoverflow.com/users/1600898/user4815162342"}, "edited": false, "score": 1, "creation_date": 1488388769, "post_id": 42538013, "comment_id": 72211765, "body": "You can&#39;t, you need to remove the pair and insert the new one."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1488388778, "post_id": 42538013, "comment_id": 72211770, "body": "This has nothing to do with <code>std::pair</code>, it&#39;s a limitation imposed by <code>std::set</code>."}], "answers": [{"comments": [{"owner": {"reputation": 92, "user_id": 5326381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ea052a5d28766260d70c65a189df74b?s=128&d=identicon&r=PG&f=1", "display_name": "Tudor Versoiu", "link": "https://stackoverflow.com/users/5326381/tudor-versoiu"}, "edited": false, "score": 0, "creation_date": 1488389041, "post_id": 42538071, "comment_id": 72211919, "body": "Oh, now I understand... This was bugging me for some time and had no idea why it didn&#39;t work. Thanks!"}], "tags": [], "owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "is_accepted": false, "score": 6, "last_activity_date": 1488388772, "creation_date": 1488388772, "answer_id": 42538071, "question_id": 42538013, "link": "https://stackoverflow.com/questions/42538013/how-do-i-update-a-member-in-a-set-of-stdpair/42538071#42538071", "title": "How do I update a member in a set of std::pair?", "body": "<p>Members of <code>std::set</code> are <code>const</code>, because changing them could make their ordering invalid. You would have to erase the pair and re-insert it after it was changed.</p>\n"}], "owner": {"reputation": 92, "user_id": 5326381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ea052a5d28766260d70c65a189df74b?s=128&d=identicon&r=PG&f=1", "display_name": "Tudor Versoiu", "link": "https://stackoverflow.com/users/5326381/tudor-versoiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3337, "favorite_count": 0, "closed_date": 1488388992, "answer_count": 1, "score": 3, "last_activity_date": 1488388772, "creation_date": 1488388597, "question_id": 42538013, "link": "https://stackoverflow.com/questions/42538013/how-do-i-update-a-member-in-a-set-of-stdpair", "closed_reason": "Duplicate", "title": "How do I update a member in a set of std::pair?", "body": "<p>I tried doing this:</p>\n\n<pre><code>std::set&lt; pair&lt;int, int&gt; &gt; mySet;\n\n// fill the set with something\n\nmySet.find( make_pair(someValueX, someValueY) )-&gt;first = newX;\n</code></pre>\n\n<p>But I get the following error on compilation:</p>\n\n<pre><code>error: assignment of member 'std::pair&lt;int, int&gt;::first' in read-only object|\n||=== Build failed: 1 error(s), 0 warning(s) (0 minute(s), 0 second(s)) ===||\n</code></pre>\n"}, {"tags": ["c++", "qt", "opengl", "qquickitem", "qopenglfunctions"], "comments": [{"owner": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "edited": false, "score": 0, "creation_date": 1488410547, "post_id": 42538001, "comment_id": 72223805, "body": "Are you asking how to create a QQuickItem that renders the contents of a texture?"}, {"owner": {"reputation": 4578, "user_id": 6626554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Cn7Ya.png?s=128&g=1", "display_name": "TheWaterProgrammer", "link": "https://stackoverflow.com/users/6626554/thewaterprogrammer"}, "reply_to_user": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "edited": false, "score": 0, "creation_date": 1488434477, "post_id": 42538001, "comment_id": 72231199, "body": "yes in a way. I see some methods like <a href=\"http://doc.qt.io/qt-5/qsgsimpletexturenode.html#setTexture\" rel=\"nofollow noreferrer\">setTexture</a> available in QSGSimpleTextureNode. But not able to figure out how to pass the <code>GLuint</code> that I got from <a href=\"http://doc.qt.io/qt-5/qopenglframebufferobject.html#takeTexture\" rel=\"nofollow noreferrer\">takeTexture</a> into some method which can take the texture &amp; display it on a QQuickItem."}, {"owner": {"reputation": 4578, "user_id": 6626554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Cn7Ya.png?s=128&g=1", "display_name": "TheWaterProgrammer", "link": "https://stackoverflow.com/users/6626554/thewaterprogrammer"}, "reply_to_user": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "edited": false, "score": 0, "creation_date": 1488435136, "post_id": 42538001, "comment_id": 72231429, "body": "discussion <a href=\"http://stackoverflow.com/questions/32162215/adding-a-background-image-to-a-qquickitem\">here</a> suggests how to create a <code>QSGTexture</code> from an image &amp; <code>setTexture</code> using it. is there a way I can create a <code>QSGTexture</code> from a Gluint &amp; then call <code>setTexture</code> on the window ?"}, {"owner": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "edited": false, "score": 1, "creation_date": 1488440921, "post_id": 42538001, "comment_id": 72234249, "body": "<code>item-&gt;window()-&gt;createTextureFromId(texture_id)</code> will give you a <code>QSGTexture</code>. Then combine it with a geometry node, geometry and a material node."}, {"owner": {"reputation": 4578, "user_id": 6626554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Cn7Ya.png?s=128&g=1", "display_name": "TheWaterProgrammer", "link": "https://stackoverflow.com/users/6626554/thewaterprogrammer"}, "reply_to_user": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "edited": false, "score": 0, "creation_date": 1488461182, "post_id": 42538001, "comment_id": 72247647, "body": "@peppe is it possible for you to give a sample of what to do after creating a <code>QSGTexture</code> out of the <code>GLuint texture_id</code> ? Is some way I can tell my method <code>updatePaintNode</code> to use this <code>QSGTexture</code> &amp; render it ? or if there is a better way, please suggest"}, {"owner": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "edited": false, "score": 0, "creation_date": 1488467308, "post_id": 42538001, "comment_id": 72252214, "body": "Check out some of the examples that create a custom QQuickItem. Yes, you need to override <code>updatePaintNode</code> and return a minimal tree of nodes to render your texture. At a minimum, you need geometry (a quad) and a material that draws your texture."}, {"owner": {"reputation": 4578, "user_id": 6626554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Cn7Ya.png?s=128&g=1", "display_name": "TheWaterProgrammer", "link": "https://stackoverflow.com/users/6626554/thewaterprogrammer"}, "reply_to_user": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "edited": false, "score": 0, "creation_date": 1488647515, "post_id": 42538001, "comment_id": 72328586, "body": "@peppe thanks <code>updatePaintNode</code> with a correct <code>TextureNode</code> worked. You can pls post the same as an answer. it will great if can explain some more about how the Qt scene graph works along with your answer (iff u wish)"}], "owner": {"reputation": 4578, "user_id": 6626554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Cn7Ya.png?s=128&g=1", "display_name": "TheWaterProgrammer", "link": "https://stackoverflow.com/users/6626554/thewaterprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488405881, "creation_date": 1488388570, "last_edit_date": 1488405881, "question_id": 42538001, "link": "https://stackoverflow.com/questions/42538001/how-to-map-a-saved-texture-directly-on-a-quickitem-display-it", "title": "How to map a saved texture directly on a QuickItem &amp; display it?", "body": "<p>In my <code>Qt app</code> with <code>C++</code>, I am using a <code>QQuickItem</code> derived class to display textures which are produced on every frame render by running some filters on each frame render. this works fine.</p>\n\n<p>Next, I used the <code>takeTexture</code> method provided by <code>QOpenGLFramebufferObject</code> to save some textures &amp; display them back whenever required. These saved textures are of type <code>GLuint</code>s. I am able to display it back using the normal OpenGL rendering pipeline. It works well.</p>\n\n<p>But, Is there a way I can avoid the rendering pipeline calls &amp; <strong>map this saved texture on GPU memory directly to my <code>QQuickItem</code></strong>?</p>\n"}, {"tags": ["c++", "dictionary", "boost", "set", "boost-hana"], "answers": [{"tags": [], "owner": {"reputation": 1567, "user_id": 800347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Buq1.jpg?s=128&g=1", "display_name": "Jason Rice", "link": "https://stackoverflow.com/users/800347/jason-rice"}, "is_accepted": true, "score": 1, "last_activity_date": 1488413736, "creation_date": 1488413736, "answer_id": 42544617, "question_id": 42537912, "link": "https://stackoverflow.com/questions/42537912/boost-hana-create-a-map-from-a-set-and-a-default-value/42544617#42544617", "title": "boost hana: create a map from a set and a default value", "body": "<p><code>hana::set</code> is <code>hana::Foldable</code> so you can use <code>hana::unpack</code>. Consider this example:</p>\n\n<pre><code>#include &lt;boost/hana.hpp&gt;\n\nnamespace hana = boost::hana;\n\n\nint main() {\n  constexpr auto make_pair_with = hana::curry&lt;2&gt;(hana::flip(hana::make_pair));\n\n  auto result = hana::unpack(\n    hana::make_set(hana::type_c&lt; int &gt;, hana::type_c&lt; float &gt;),\n    hana::make_map ^hana::on^ make_pair_with(false)\n  );\n\n  auto expected = hana::make_map(\n    hana::make_pair(hana::type_c&lt; int &gt;, false),\n    hana::make_pair(hana::type_c&lt; float &gt;, false)\n  );\n\n  BOOST_HANA_RUNTIME_ASSERT(result == expected);\n} \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2976, "user_id": 627587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b7225df5b0728daa170646a5c5a4bfda?s=128&d=identicon&r=PG", "display_name": "Louis Dionne", "link": "https://stackoverflow.com/users/627587/louis-dionne"}, "is_accepted": false, "score": 1, "last_activity_date": 1488475930, "creation_date": 1488475930, "answer_id": 42562120, "question_id": 42537912, "link": "https://stackoverflow.com/questions/42537912/boost-hana-create-a-map-from-a-set-and-a-default-value/42562120#42562120", "title": "boost hana: create a map from a set and a default value", "body": "<p>Jason's answer is perfect, but here's the same thing using a lambda instead (I usually find that more readable):</p>\n\n<pre><code>#include &lt;boost/hana.hpp&gt;\nnamespace hana = boost::hana;\n\n\nint main() {\n  auto types = hana::make_set(hana::type_c&lt; int &gt;, hana::type_c&lt; float &gt;);\n  auto result = hana::unpack(types, [](auto ...t) {\n    return hana::make_map(hana::make_pair(t, false)...);\n  });\n\n  auto expected = hana::make_map(\n    hana::make_pair(hana::type_c&lt; int &gt;, false),\n    hana::make_pair(hana::type_c&lt; float &gt;, false)\n  );\n\n  BOOST_HANA_RUNTIME_ASSERT(result == expected);\n}\n</code></pre>\n"}], "owner": {"reputation": 2046, "user_id": 4821621, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4df545070351d076eddb7572d3eb8bfc?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Buch", "link": "https://stackoverflow.com/users/4821621/benjamin-buch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 42544617, "answer_count": 2, "score": 2, "last_activity_date": 1488475930, "creation_date": 1488388306, "last_edit_date": 1488405561, "question_id": 42537912, "link": "https://stackoverflow.com/questions/42537912/boost-hana-create-a-map-from-a-set-and-a-default-value", "title": "boost hana: create a map from a set and a default value", "body": "<p>I have a boost::hana::set of types and want to create a map with it, where the values are bool's.</p>\n\n<pre><code>// I have a hana set:\nauto my_set = hana::make_set(hana::type_c&lt; int &gt;, hana::type_c&lt; float &gt; ...);\n\n// and want to transform it to a map with a given runtime value as values:\nauto wanted_map = hana::make_map(\n    hana::make_pair(hana::type_c&lt; int &gt;, false),\n    hana::make_pair(hana::type_c&lt; float &gt;, false),\n    ...\n);\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 2279, "user_id": 1370785, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/oASta.jpg?s=128&g=1", "display_name": "jiveturkey", "link": "https://stackoverflow.com/users/1370785/jiveturkey"}, "edited": false, "score": 0, "creation_date": 1488388524, "post_id": 42537842, "comment_id": 72211622, "body": "What is your Error and why is TypeList simply a Class of types? (another Null class)"}], "answers": [{"comments": [{"owner": {"reputation": 23041, "user_id": 1149664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac4f96b553d2e45776bd6235fee4222d?s=128&d=identicon&r=PG", "display_name": "Johan Lundberg", "link": "https://stackoverflow.com/users/1149664/johan-lundberg"}, "reply_to_user": {"reputation": 77, "user_id": 7501059, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0923949e94d423abe16dc624d92183d9?s=128&d=identicon&r=PG&f=1", "display_name": "Helvinion", "link": "https://stackoverflow.com/users/7501059/helvinion"}, "edited": false, "score": 0, "creation_date": 1488485106, "post_id": 42540086, "comment_id": 72263704, "body": "By the way, wherever you are with an 11 year old compiler you should consider leaving or demand an upgrade."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1488485845, "post_id": 42540086, "comment_id": 72264135, "body": "I have one that is from 2003  :-("}], "tags": [], "owner": {"reputation": 23041, "user_id": 1149664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac4f96b553d2e45776bd6235fee4222d?s=128&d=identicon&r=PG", "display_name": "Johan Lundberg", "link": "https://stackoverflow.com/users/1149664/johan-lundberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1488484845, "last_edit_date": 1488484845, "creation_date": 1488395581, "answer_id": 42540086, "question_id": 42537842, "link": "https://stackoverflow.com/questions/42537842/metaprogramming-wrong-number-of-template-arguments/42540086#42540086", "title": "Metaprogramming, wrong number of template arguments", "body": "<p>The problem seems to be that you sprinkled a few too many <code>typename</code>s at the usage of <code>IntegerList</code> and <code>TypeList</code>. The following compiles:</p>\n\n<pre><code>template &lt;class H, class T&gt;\nstruct IntegerList&lt;TypeList&lt; H,  T&gt; &gt; :  public std::list&lt;Integer*&gt;\n{ \n  typedef TypeList&lt; H,  T&gt; List_t;\n  typedef H Head_t;\n  typedef T Tail_t;\n  . . .\n}\n</code></pre>\n\n<p>Full example <a href=\"http://coliru.stacked-crooked.com/a/5086e3015dc12ea0\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/5086e3015dc12ea0</a></p>\n"}], "owner": {"reputation": 77, "user_id": 7501059, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0923949e94d423abe16dc624d92183d9?s=128&d=identicon&r=PG&f=1", "display_name": "Helvinion", "link": "https://stackoverflow.com/users/7501059/helvinion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 42540086, "answer_count": 1, "score": 0, "last_activity_date": 1488484845, "creation_date": 1488388115, "question_id": 42537842, "link": "https://stackoverflow.com/questions/42537842/metaprogramming-wrong-number-of-template-arguments", "title": "Metaprogramming, wrong number of template arguments", "body": "<p>I am trying C++ metaprogrammation. I have a TypeList class which contain a head type and a tail type which is another TypeList or the NullType at the end of the list. </p>\n\n<p>I also have a IntegerList class which is a list of pointers on Integers (Well, it was a logging system, but I deleted as much code as I could, and Integer* elements replaced Logger* elements)</p>\n\n<p>My file won't compile as g++ complains that I am using a \"wrong number of template arguments (1, should be 2)\", and I don't understand why.</p>\n\n<p>Where did I do wrong ? I just copied some code from a website I trust, it should work... I mostly decided to use meta-programming because it seemed to be a pretty interresting thing to do, but I am begining to loose my mind already ^^.</p>\n\n<p>Thank you in advance.</p>\n\n<p>PS. I have a pretty old g++ compiler that I cannot change (2006), but another g++ from 2013 gave me the same error.</p>\n\n<p>PS2. I think that this cold wouldn't compile because Integer is not a class, but I get the same error with a real class, so I believe that my error happen before this is checked.</p>\n\n<p>IntegerList.hpp :</p>\n\n<pre><code>#include &lt;list&gt;\n\ntypedef int Integer;\n\nclass NullType\n{\n};\n\ntemplate&lt;class H, class T&gt;\nclass TypeList\n{\n    typedef H Head;\n    typedef T Tail;\n};\n\ntemplate&lt;class T&gt;\nstruct IntegerList : public std::list&lt;Integer*&gt;\n{\n};\n\ntemplate&lt;&gt;\nstruct IntegerList&lt;NullType&gt; : public std::list&lt;Integer*&gt;\n{\n};\n\ntemplate &lt;class H, class T&gt;\nstruct IntegerList&lt;TypeList&lt;typename H, typename T&gt; &gt; :  public std::list&lt;Integer*&gt;\n{ //                                              ^ error right there\n  typedef TypeList&lt;typename H, typename T&gt; List_t;\n  typedef typename H Head_t;\n  typedef typename T Tail_t;\n\n  IntegerList()\n  {\n    push_back( new Head_t );\n    IntegerList&lt;Tail_t&gt; tmp;\n    merge( tmp );\n  }\n\n  ~IntegerList()\n  {\n    IntegerList&lt;List_t&gt;::iterator it;\n    for ( it=begin(); it!=end(); ++it )\n      delete *it;\n  }\n};\n</code></pre>\n\n<p>main.cpp:</p>\n\n<pre><code>#include \"IntegerList.hpp\"\n\nint main(int argc, char **argv)\n{  \n   // wrong number of template arguments (1, should be 2)\n  IntegerList&lt;TypeList&lt;Integer, NullType&gt; &gt; mylist;\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1488389047, "post_id": 42537811, "comment_id": 72211927, "body": "Don&#39;t use an array, use a vector."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 6783187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65570769617e25662c2ffd4092bf60b7?s=128&d=identicon&r=PG&f=1", "display_name": "Urasam", "link": "https://stackoverflow.com/users/6783187/urasam"}, "edited": false, "score": 0, "creation_date": 1488389990, "post_id": 42538200, "comment_id": 72212522, "body": "Oh ok then it makes sense not being able to use std::array, thanks :)"}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 3, "last_activity_date": 1488390487, "last_edit_date": 1495541828, "creation_date": 1488389200, "answer_id": 42538200, "question_id": 42537811, "link": "https://stackoverflow.com/questions/42537811/using-streamsize-for-the-size-of-an-array-is-not-working/42538200#42538200", "title": "Using streamsize for the size of an array is not working", "body": "<p>You can only pass constexpr values as template parameters, which clearly isn't possible in this case given that the size is known only at runtime.</p>\n\n<p>The underlying problem here is that you are using the wrong tool for the job: <code>std::array</code> encapsulates a statically allocated array, whose size must be known at compile time. If you need dynamic allocation, use <code>std::vector</code>. </p>\n\n<p>For a more in-depth comparison between <code>std::vector</code> and <code>std::array</code> see <a href=\"https://stackoverflow.com/questions/4424579/stdvector-versus-stdarray-in-c/4424658#4424658\">std::vector versus std::array in C++</a></p>\n"}, {"comments": [{"owner": {"reputation": 109, "user_id": 6783187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65570769617e25662c2ffd4092bf60b7?s=128&d=identicon&r=PG&f=1", "display_name": "Urasam", "link": "https://stackoverflow.com/users/6783187/urasam"}, "edited": false, "score": 0, "creation_date": 1488443913, "post_id": 42540022, "comment_id": 72236016, "body": "Thanks for the different approaches! Is there a big difference between the last two? Is one better than the other (e.g. in performance)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 109, "user_id": 6783187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65570769617e25662c2ffd4092bf60b7?s=128&d=identicon&r=PG&f=1", "display_name": "Urasam", "link": "https://stackoverflow.com/users/6783187/urasam"}, "edited": false, "score": 1, "creation_date": 1488445957, "post_id": 42540022, "comment_id": 72237401, "body": "I imagine doing a larger block read will have better performance than doing single-byte reads. But use a profiler to make sure."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 2, "last_activity_date": 1488445839, "last_edit_date": 1488445839, "creation_date": 1488395350, "answer_id": 42540022, "question_id": 42537811, "link": "https://stackoverflow.com/questions/42537811/using-streamsize-for-the-size-of-an-array-is-not-working/42540022#42540022", "title": "Using streamsize for the size of an array is not working", "body": "<p>You don't need to use <code>file.ignore()</code>, you can use <code>file.seekg()</code> to get the file size:</p>\n\n<pre><code>// determine file size\nfile.seekg(0, std::ios_base::end);\nstd::streamsize length = file.tellg();\nfile.seekg(0, std::ios_base::beg);\n</code></pre>\n\n<p>Or, just use a platform-specific API function, like <code>GetFileSize()</code> on Windows or <code>stat()</code> on Linux (or equivilents).</p>\n\n<p>That said, <code>std::array</code> is a fixed-length array, you have to specify its size at compile-time.  For dynamic allocations at runtime, use <code>std::vector</code> instead:</p>\n\n<pre><code>// read data into buffer\nstd::vector&lt;char&gt; buffer;\nbuffer.resize(length);\nfile.read(buffer.data(), length);\n</code></pre>\n\n<p>Or, simply read the file into the target memory directly and avoid the temp buffer altogether:</p>\n\n<pre><code>// read game file into memory\nfile.read(memory.begin() + 0x200, length);\n</code></pre>\n\n<p>Or, even skip retrieving the file size at all:</p>\n\n<pre><code>// read game file into memory\nstd::copy(\n    std::istreambuf_iterator&lt;char&gt;(file),\n    std::istreambuf_iterator&lt;char&gt;(),\n    memory.begin() + 0x200\n);\n</code></pre>\n\n<p>In any case, be sure to watch out for memory overflows!  Make sure <code>memory</code> is large enough to hold the entire <code>file</code> data.</p>\n"}], "owner": {"reputation": 109, "user_id": 6783187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65570769617e25662c2ffd4092bf60b7?s=128&d=identicon&r=PG&f=1", "display_name": "Urasam", "link": "https://stackoverflow.com/users/6783187/urasam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 42538200, "answer_count": 2, "score": 0, "last_activity_date": 1516865790, "creation_date": 1488388028, "last_edit_date": 1516865790, "question_id": 42537811, "link": "https://stackoverflow.com/questions/42537811/using-streamsize-for-the-size-of-an-array-is-not-working", "title": "Using streamsize for the size of an array is not working", "body": "<p>I somehow can't get it right to use <code>std::streamsize</code> to create an array.</p>\n\n<pre><code>// determine file size\nfile.ignore(std::numeric_limits&lt;std::streamsize&gt;::max());\nstd::streamsize length = file.gcount();\nfile.clear();\nfile.seekg(0, std::ios_base::beg);\n\n// read data into buffer\nstd::array&lt;char, length&gt; buffer;\nfile.read(buffer.data(), length);\n\n// copy the game into memory\nstd::copy(buffer.begin(), buffer.end(), memory.begin() + 0x200);\n</code></pre>\n\n<p>Error (translated from German)</p>\n\n<blockquote>\n  <p>The expression must be a constant value</p>\n</blockquote>\n\n<p>Does anyone have any ideas on solving this problem? Any help is appreciated!</p>\n"}, {"tags": ["c++", "visual-studio", "visual-studio-2013", "kissfft"], "answers": [{"comments": [{"owner": {"reputation": 57972, "user_id": 131140, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/11b4048e49b8b89f670cc984059d1677?s=128&d=identicon&r=PG", "display_name": "Goz", "link": "https://stackoverflow.com/users/131140/goz"}, "edited": false, "score": 0, "creation_date": 1488405363, "post_id": 42539472, "comment_id": 72221534, "body": "Thanks for the response ... and yeah .. I have tried the using statements.  Had the same thought myself :)  Sadly it didn&#39;t work :(  You are right on the struct redef errors ... good idea on the pre including the headers!"}], "tags": [], "owner": {"reputation": 7007, "user_id": 3343, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/37f8bd7a5b49c886bd82541c7e5c339e?s=128&d=identicon&r=PG", "display_name": "Mark Borgerding", "link": "https://stackoverflow.com/users/3343/mark-borgerding"}, "is_accepted": false, "score": 1, "last_activity_date": 1488417287, "last_edit_date": 1488417287, "creation_date": 1488393602, "answer_id": 42539472, "question_id": 42537795, "link": "https://stackoverflow.com/questions/42537795/compiling-kiss-fft-with-float-and-double-support-in-the-same-app/42539472#42539472", "title": "Compiling kiss fft with float and double support in the same app", "body": "<p>Interesting idea, but you might have better luck just hacking on the files e.g. making <code>kiss_fft_scalar</code> a template parameter.   One problem is that the header files will be including other header files like <code>stdlib.h</code>.  I suppose you could pre-emptively include those files before you do your namespace trick.</p>\n\n<p>I'm guessing the struct redef errors are for the <code>kiss_fft_state</code> in <code>_kiss_fft_guts.h</code>?\nIt might work if you have separate Float/Double .cpp files and <em>using</em> directives before inclusion of the .c files.</p>\n\n<p>If you decide to templatize it, you could take a look at the <a href=\"https://bitbucket.org/eigen/eigen/src/ef6d89748176edf76e75b2c06805fe374672bd00/unsupported/Eigen/src/FFT/ei_kissfft_impl.h?at=default&amp;fileviewer=file-view-default\" rel=\"nofollow noreferrer\"> Eigen (partial) c++ port of kissfft.</a></p>\n"}, {"tags": [], "owner": {"reputation": 57972, "user_id": 131140, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/11b4048e49b8b89f670cc984059d1677?s=128&d=identicon&r=PG", "display_name": "Goz", "link": "https://stackoverflow.com/users/131140/goz"}, "is_accepted": true, "score": 0, "last_activity_date": 1488450711, "creation_date": 1488450711, "answer_id": 42552914, "question_id": 42537795, "link": "https://stackoverflow.com/questions/42537795/compiling-kiss-fft-with-float-and-double-support-in-the-same-app/42552914#42552914", "title": "Compiling kiss fft with float and double support in the same app", "body": "<p>So I've discovered that Eigen has done the work of templating kiss FFT for me.  Yay to other people doing the hard work! ;)</p>\n\n<p>Eigen is available here:</p>\n\n<p><a href=\"https://bitbucket.org/eigen/eigen/src\" rel=\"nofollow noreferrer\">https://bitbucket.org/eigen/eigen/src</a></p>\n\n<p>and the kiss fft implementation is under</p>\n\n<p>\"unsupported/Eigen/src/FFT/\"</p>\n"}], "owner": {"reputation": 57972, "user_id": 131140, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/11b4048e49b8b89f670cc984059d1677?s=128&d=identicon&r=PG", "display_name": "Goz", "link": "https://stackoverflow.com/users/131140/goz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "accepted_answer_id": 42552914, "answer_count": 2, "score": 0, "last_activity_date": 1488450711, "creation_date": 1488387952, "question_id": 42537795, "link": "https://stackoverflow.com/questions/42537795/compiling-kiss-fft-with-float-and-double-support-in-the-same-app", "title": "Compiling kiss fft with float and double support in the same app", "body": "<p>I'm trying to get kiss fft to compile both float and double implementations in the same app using visual studio 2013.  I see that all I need to do is set the kiss_fft_scalar to double and re-compile to get double.</p>\n\n<p>To this end I put together a header whereby I include the headers with kiss_fft_scalar changed inside 2 different namespaces as follows:</p>\n\n<pre><code>namespace KissFloat\n{\n    #undef KISS_FFT_H\n    #undef KISS_FTR_H\n    #define kiss_fft_scalar float\n    #include \"kiss_fft.h\"\n    #include \"tools/kiss_fftr.h\"\n};\n\nnamespace KissDouble\n{\n    #undef KISS_FFT_H\n    #undef KISS_FTR_H\n    #define kiss_fft_scalar double\n    #include \"kiss_fft.h\"\n    #include \"tools/kiss_fftr.h\"\n};\n</code></pre>\n\n<p>I can't however figure out how to include the cpp code.  I've tried a seperate KissFloat and KissDouble file. I've then tried a few things in the cpp file but everything I try ends up with compile errors.  usually relating to struct redefinition.</p>\n\n<p>Can anyone think of a way to make this work?  Or am I just better off re-writing kiss fft using templates?</p>\n"}, {"tags": ["c++", "oop", "design-patterns"], "comments": [{"owner": {"reputation": 24103, "user_id": 506441, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GQFUj.jpg?s=128&g=1", "display_name": "Daniel T.", "link": "https://stackoverflow.com/users/506441/daniel-t"}, "edited": false, "score": 0, "creation_date": 1488388139, "post_id": 42537692, "comment_id": 72211394, "body": "This question probably belongs in <a href=\"http://softwareengineering.stackexchange.com\">softwareengineering.stackexchange.com</a>"}, {"owner": {"reputation": 640, "user_id": 2294936, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uPAUU.gif?s=128&g=1", "display_name": "Nyashes", "link": "https://stackoverflow.com/users/2294936/nyashes"}, "reply_to_user": {"reputation": 24103, "user_id": 506441, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GQFUj.jpg?s=128&g=1", "display_name": "Daniel T.", "link": "https://stackoverflow.com/users/506441/daniel-t"}, "edited": false, "score": 0, "creation_date": 1488388451, "post_id": 42537692, "comment_id": 72211570, "body": "@DanielT.  Well it&#39;s based on a real problem I&#39;m encountering so I posted on SO by default without really thinking about it, but now that I read my question again, you are probably right, maybe crosspost?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 24103, "user_id": 506441, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GQFUj.jpg?s=128&g=1", "display_name": "Daniel T.", "link": "https://stackoverflow.com/users/506441/daniel-t"}, "edited": false, "score": 0, "creation_date": 1488388618, "post_id": 42537692, "comment_id": 72211687, "body": "@DanielT. The question asks about a specific C++ programming problem, I don&#39;t think it needs to be migrated to SE Software Engineering."}], "answers": [{"comments": [{"owner": {"reputation": 640, "user_id": 2294936, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uPAUU.gif?s=128&g=1", "display_name": "Nyashes", "link": "https://stackoverflow.com/users/2294936/nyashes"}, "edited": false, "score": 0, "creation_date": 1488389211, "post_id": 42537824, "comment_id": 72212020, "body": "Thanks, that was really helpful. I&#39;ll take some time to read the sources ou provided."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 640, "user_id": 2294936, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uPAUU.gif?s=128&g=1", "display_name": "Nyashes", "link": "https://stackoverflow.com/users/2294936/nyashes"}, "edited": false, "score": 0, "creation_date": 1488389415, "post_id": 42537824, "comment_id": 72212150, "body": "@AlexandreTHOUVENIN If you&#39;re able to spot the patterns used in some code, these are easy to find ;-)"}, {"owner": {"reputation": 640, "user_id": 2294936, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uPAUU.gif?s=128&g=1", "display_name": "Nyashes", "link": "https://stackoverflow.com/users/2294936/nyashes"}, "edited": false, "score": 0, "creation_date": 1488389875, "post_id": 42537824, "comment_id": 72212433, "body": "True, but to be fair I don&#39;t know more than 3 or 4 design patterns, so I usually solve my problem and move on. This time since it looked like a general OOP problem I wondered if it already had a (better/similar) solution. and it has one. Call it wrong order ^^&#39;"}], "tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": true, "score": 1, "last_activity_date": 1488388904, "last_edit_date": 1495535390, "creation_date": 1488388061, "answer_id": 42537824, "question_id": 42537692, "link": "https://stackoverflow.com/questions/42537692/how-do-you-call-an-interface-standing-between-a-class-and-its-base-class/42537824#42537824", "title": "How do you call an interface standing between a class and its base class?", "body": "<blockquote>\n  <p>Do this OOP problem have a name? </p>\n</blockquote>\n\n<p>Yes, it's called <a href=\"https://stackoverflow.com/questions/7085265/what-is-c-mixin-style\">Mixin Pattern</a>.</p>\n\n<p>A related pattern you've been also using is the <a href=\"https://sourcemaking.com/design_patterns/template_method/cpp/1\" rel=\"nofollow noreferrer\">Template Method Pattern</a>.</p>\n\n<blockquote>\n  <p>Is this example a good way to solve this problem in C++? </p>\n</blockquote>\n\n<p>Depends on the situation and use cases. But that style isn't inherently bad and used in many API's. Microsoft's ATL is one example.</p>\n\n<blockquote>\n  <p>is there a better/cleaner way to solve this problem in C++?</p>\n</blockquote>\n\n<p>Again depends on your use case. There are more than one way to provide multiple interface implementations.</p>\n"}], "owner": {"reputation": 640, "user_id": 2294936, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uPAUU.gif?s=128&g=1", "display_name": "Nyashes", "link": "https://stackoverflow.com/users/2294936/nyashes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 42537824, "answer_count": 1, "score": 0, "last_activity_date": 1488388904, "creation_date": 1488387644, "question_id": 42537692, "link": "https://stackoverflow.com/questions/42537692/how-do-you-call-an-interface-standing-between-a-class-and-its-base-class", "title": "How do you call an interface standing between a class and its base class?", "body": "<p>Note: I tagged design patterns just in (the unlikely) case it is actually one. If it's not I'll remove the tag.</p>\n\n<p>consider this example: </p>\n\n<pre><code>template &lt;class _base&gt;\nstruct SplitPrint: public _base\n{\n    virtual void printPositive(int positive) = 0;\n    virtual void printNegative(int negative) = 0;\n    void print( int number) override\n    { \n        _base::print(number);\n        if (number &gt;= 0)\n            printPositive(number);\n        else\n            printNegative(number);\n    }\n};\n\nstruct Interface\n{\n    virtual void print( int number) = 0;\n};\n\n//implements the interface\nstruct NormalImplementer : public Interface\n{\n    void print( int number) override { std::cout &lt;&lt; number &lt;&lt; \"\\n\"; }\n};\n\n//Still implements the interface\nstruct DifferentImplementer : public SplitPrint&lt;NormalImplementer&gt;\n{\n    void printPositive (int number) override { if (number &gt; 10) std::cout &lt;&lt; \"big\" &lt;&lt; \"\\n\"; }\n    void printNegative (int number) override { if (number &lt; -10) std::cout &lt;&lt; \"small\" &lt;&lt; \"\\n\"; }\n};\n\n//Still implements the interface\nstruct TellSign : public SplitPrint&lt;DifferentImplementer&gt;\n{\n    void printPositive (int number) override { std::cout &lt;&lt; \"also, positive\" &lt;&lt; \"\\n\"; }\n    void printNegative (int number) override { std::cout &lt;&lt; \"also, negative\" &lt;&lt; \"\\n\"; }\n};\n\n\nint main()\n{\n  NormalImplementer printer1;\n  DifferentImplementer printer2;\n  TellSign printer3;\n\n  printer1.print(5); //5\n  printer1.print(-42); //-42\n\n  printer2.print(5); //5\n  printer2.print(-42); //-42 small\n\n  printer3.print(5); //5 also, positive\n  printer3.print(-42); //-42 small also, negative\n}\n</code></pre>\n\n<p>Here I split the pure virtual method \"print\" in two other methods, DifferentImplementer doesn't have to know how to print a number (silly example but hopefully you understand what I mean) as long as it knows how to print a positive number and how to print a negative one.</p>\n\n<p>Do this OOP problem have a name? Is this example a good way to solve this problem in C++? is there a better/cleaner way to solve this problem in C++?</p>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 4815, "user_id": 3087601, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ad2f9879fa1dea6fd47a45052ad02a09?s=128&d=identicon&r=PG&f=1", "display_name": "Zereges", "link": "https://stackoverflow.com/users/3087601/zereges"}, "edited": false, "score": 0, "creation_date": 1488387777, "post_id": 42537687, "comment_id": 72211154, "body": "<code>std::optional</code> will be in C++17."}, {"owner": {"reputation": 245, "user_id": 5336225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0282dc7ca7dbcd3a710b15953d24d7a4?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/5336225/sagar"}, "reply_to_user": {"reputation": 4815, "user_id": 3087601, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ad2f9879fa1dea6fd47a45052ad02a09?s=128&d=identicon&r=PG&f=1", "display_name": "Zereges", "link": "https://stackoverflow.com/users/3087601/zereges"}, "edited": false, "score": 0, "creation_date": 1488387872, "post_id": 42537687, "comment_id": 72211208, "body": "@Zereges Yes its in C++17. But i want to know how can i initialize it after declaration."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1488387928, "post_id": 42537687, "comment_id": 72211249, "body": "Do note you initialize when you declare it.  After you declare it you can only assign to it."}, {"owner": {"reputation": 245, "user_id": 5336225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0282dc7ca7dbcd3a710b15953d24d7a4?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/5336225/sagar"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1488388073, "post_id": 42537687, "comment_id": 72211345, "body": "@NathanOliver thank you very much for your comment. Yes as you can see i have declared it inside the structure. So when i create the object of the structure it will be intialized automatically and hold any thing as per the property of std::optional. As correctly pointed out by you i want to assign it to a valid Test object. Can you please let me know how can i do it ?"}], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 5336225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0282dc7ca7dbcd3a710b15953d24d7a4?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/5336225/sagar"}, "edited": false, "score": 0, "creation_date": 1488775912, "post_id": 42537914, "comment_id": 72364327, "body": "Thank you so much for your time and reply."}, {"owner": {"reputation": 4026, "user_id": 8414561, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa61454588bc140dada53391e1eb3c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Null", "link": "https://stackoverflow.com/users/8414561/dev-null"}, "edited": false, "score": 0, "creation_date": 1502252716, "post_id": 42537914, "comment_id": 78122539, "body": "You can also use it like this: <code>obj.test = 10;</code> thanks to implicit conversion. Could you please accept this answer."}], "tags": [], "owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "is_accepted": false, "score": 3, "last_activity_date": 1488388322, "creation_date": 1488388322, "answer_id": 42537914, "question_id": 42537687, "link": "https://stackoverflow.com/questions/42537687/how-to-initialize-the-stdoptional-of-a-user-defined-data-type/42537914#42537914", "title": "How to initialize the std::optional of a user defined data type", "body": "<pre><code>obj.test = make_optional&lt;Test&gt;(10);\n</code></pre>\n\n<blockquote>\n  <p>----> is this correct??</p>\n</blockquote>\n\n<p>Yes it is. You could also do it like this:</p>\n\n<pre><code>obj.test = Test(10);\n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 5336225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0282dc7ca7dbcd3a710b15953d24d7a4?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/5336225/sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2286, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1516865857, "creation_date": 1488387634, "last_edit_date": 1516865857, "question_id": 42537687, "link": "https://stackoverflow.com/questions/42537687/how-to-initialize-the-stdoptional-of-a-user-defined-data-type", "title": "How to initialize the std::optional of a user defined data type", "body": "<p>I am trying to learn new features of C++ 17.</p>\n\n<p>Please find the below code:</p>\n\n<pre><code>class Test\n{\npublic:\n      Test(int x):y(x){}\n      ~Test(){}\n      int getx()\n      {\n          return x;\n      }\nprivate:\n      int x;\n};\nstruct Container\n{\n    std::optional&lt;Test&gt; test;\n};\nint main()\n{\n    struct Container obj;\n    // here i want to initialize the member \"test\" of \n    // struct Container\n    obj.test = make_optional&lt;Test&gt;(10); ----&gt; is this correct??\n}\n</code></pre>\n\n<p>Can someone please let me know how to initialize a <code>std::optional</code>? For example, if I declare it like:</p>\n\n<pre><code>std::optional&lt;Test&gt; t\n</code></pre>\n\n<p>How can I initialize it?</p>\n"}, {"tags": ["c++", "sfml", "2d-games"], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 7592072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6115e8b9fc628e6363dea9200d9057?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Smirnov", "link": "https://stackoverflow.com/users/7592072/nikita-smirnov"}, "edited": false, "score": 0, "creation_date": 1488388453, "post_id": 42537762, "comment_id": 72211572, "body": "But it should be drawn before dying."}, {"owner": {"reputation": 769, "user_id": 7592072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6115e8b9fc628e6363dea9200d9057?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Smirnov", "link": "https://stackoverflow.com/users/7592072/nikita-smirnov"}, "edited": false, "score": 0, "creation_date": 1488388733, "post_id": 42537762, "comment_id": 72211744, "body": "try to remove   gameDisplay.clear(); back to main loop from function."}, {"owner": {"reputation": 1096, "user_id": 4477125, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JYZmH.jpg?s=128&g=1", "display_name": "Lorence Hernandez", "link": "https://stackoverflow.com/users/4477125/lorence-hernandez"}, "edited": false, "score": 0, "creation_date": 1488389559, "post_id": 42537762, "comment_id": 72212237, "body": "it doesnt matter though its a bad habit for C++, but its should still work since  it already pass all the data it needs to pass to the hidden buffer, its not like hidden buffer holds a reference to the rectangleshape object."}, {"owner": {"reputation": 15, "user_id": 7459522, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48030491dd70777103a1c5e773a97f07?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph H", "link": "https://stackoverflow.com/users/7459522/joseph-h"}, "edited": false, "score": 0, "creation_date": 1488393485, "post_id": 42537762, "comment_id": 72214604, "body": "Thanks guys but I have tried everything everyone has suggested and &quot;thing&quot; still doesn&#39;t show up ;/"}, {"owner": {"reputation": 15, "user_id": 7459522, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48030491dd70777103a1c5e773a97f07?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph H", "link": "https://stackoverflow.com/users/7459522/joseph-h"}, "edited": false, "score": 0, "creation_date": 1488394425, "post_id": 42537762, "comment_id": 72215145, "body": "Actually I sorted it out don&#39;t worry :&#163;"}], "tags": [], "owner": {"reputation": 33, "user_id": 7631082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6864599e5773f2c61b1c74b59594af77?s=128&d=identicon&r=PG&f=1", "display_name": "capi1500", "link": "https://stackoverflow.com/users/7631082/capi1500"}, "is_accepted": false, "score": 0, "last_activity_date": 1488387825, "creation_date": 1488387825, "answer_id": 42537762, "question_id": 42537644, "link": "https://stackoverflow.com/questions/42537644/c-sfml-sprite-not-showing-working/42537762#42537762", "title": "C++ SFML sprite not showing/working", "body": "<p>The problem is that you create RectangleShape thing in function Thing::thingspawn(...) and it is destroyed after it ends.\nTry to put declaration of it as member of the Thing class</p>\n"}, {"tags": [], "owner": {"reputation": 1096, "user_id": 4477125, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JYZmH.jpg?s=128&g=1", "display_name": "Lorence Hernandez", "link": "https://stackoverflow.com/users/4477125/lorence-hernandez"}, "is_accepted": false, "score": 0, "last_activity_date": 1488391775, "last_edit_date": 1495540432, "creation_date": 1488391775, "answer_id": 42538960, "question_id": 42537644, "link": "https://stackoverflow.com/questions/42537644/c-sfml-sprite-not-showing-working/42538960#42538960", "title": "C++ SFML sprite not showing/working", "body": "<p>The <code>thing</code> is rendering correctly but in just a bad habit way. like what <strong>capi1500</strong> said,</p>\n\n<p>But the real problem is that <code>int blockcolor = (255, 0, 0);</code> results a black color when you pass it to the <code>sf::Color</code>. you wont see a black drawing in a black canvas right?</p>\n\n<p>You can see here on how to construct a color from an integer: <a href=\"https://stackoverflow.com/questions/7358533/how-to-pack-argb-to-one-integer-uniquely\">How to pack ARGB to one integer uniquely?</a></p>\n\n<p>for now change the color of the <code>thing</code> using the predefined colors of sf::Color like sf::Color::Green or pass each component using  the another constructor    <code>Color (Uint8 red, Uint8 green, Uint8 blue, Uint8 alpha=255)</code> </p>\n\n<p>SFML's sf::Color's documentation: <a href=\"http://www.sfml-dev.org/documentation/2.4.2/classsf_1_1Color.php\" rel=\"nofollow noreferrer\">http://www.sfml-dev.org/documentation/2.4.2/classsf_1_1Color.php</a></p>\n"}], "owner": {"reputation": 15, "user_id": 7459522, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48030491dd70777103a1c5e773a97f07?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph H", "link": "https://stackoverflow.com/users/7459522/joseph-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1488391775, "creation_date": 1488387487, "question_id": 42537644, "link": "https://stackoverflow.com/questions/42537644/c-sfml-sprite-not-showing-working", "title": "C++ SFML sprite not showing/working", "body": "<p>I am trying to make a program so that a red block falls from the top of the screen and the player has to avoid it. When I run the program I can see and move the player(paddle) but I can't see the enemy or \"thing\" sprite. Please help me because I have tried everything with the code and it still doesn't work :/</p>\n\n<p>things.h</p>\n\n<pre><code>#include &lt;SFML/Graphics.hpp&gt;\n#include &lt;iostream&gt;\nusing namespace sf;\nusing namespace std;\n#pragma once\n\nclass Thing\n{\npublic:\nvoid thingspawn(RenderWindow &amp;gameDisplay, int &amp;enemystartx, int &amp;enemystarty, int &amp;enemywidth, int &amp;enemyheight, int &amp;blockcolor)\n{\n    RectangleShape thing(Vector2f(enemywidth, enemyheight));\n    thing.setFillColor(Color(blockcolor));\n    thing.setPosition(enemystartx, enemystarty);\n    gameDisplay.clear();\n    gameDisplay.draw(thing);\n\n\n\n}\n};\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;SFML/Graphics.hpp&gt;\n#include \"things.h\"\nusing namespace std;\nusing namespace sf;\n\nint main()\n{\nRenderWindow gameDisplay(VideoMode(1366, 768), \"Game\", Style::Fullscreen);\ngameDisplay.setMouseCursorVisible(false);\ngameDisplay.clear();\nint enemystarty = -200;\nint enemystartx = 300;\nint enemyheight = 100;\nint enemywidth = 100;\nint enemyspeed = 0.3f;\nint enemycount = 1;\nint dodged = 0;\nint blockcolor = (255, 0, 0);\n\nRectangleShape player(Vector2f(300, 30));\nplayer.setFillColor(Color(0, 0, 255));\nplayer.setPosition(400, 728);\n\n\nwhile (gameDisplay.isOpen())\n{\n    Event evnt;\n    while (gameDisplay.pollEvent(evnt))\n    {\n        switch (evnt.type)\n        {\n        case Event::Closed:\n            gameDisplay.close();\n        case Event::KeyPressed:\n            if (Keyboard::isKeyPressed(Keyboard::Q))\n                gameDisplay.close();\n\n        }\n    }\n\n\n    if (Keyboard::isKeyPressed(Keyboard::Right))\n        if (player.getPosition().x &lt; 1000)\n            player.move(0.2f, 0.0f);\n    if (Keyboard::isKeyPressed(Keyboard::Left))\n        if (player.getPosition().x &gt; 50)\n            player.move(-0.2f, 0.0f);\n\n    Thing thingobject;\n    thingobject.thingspawn(gameDisplay, enemystartx, enemystarty, enemywidth, enemyheight, blockcolor);\n\n    enemystarty += enemyspeed;\n\n\n    gameDisplay.draw(player);\n    gameDisplay.display();\n\n\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["python", "c++", "dll", "machine-learning", "runtime"], "answers": [{"tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 0, "last_activity_date": 1488401663, "creation_date": 1488401663, "answer_id": 42541854, "question_id": 42537634, "link": "https://stackoverflow.com/questions/42537634/how-to-implement-a-predictive-model-10-types-with-100-parameters-in-c-when-a/42541854#42541854", "title": "How to implement a predictive model (10 types with 100 parameters) in C++ when a DLL (+header) is the expected delivery?", "body": "<p>I strongly suspect that the function should be <code>bool isDocumentReliable(std::wstring pathname)</code>, but that's a minor detail. The main question, <em>by far</em>, should be: How are we going to prototype this? Don't expect this to work straight away. </p>\n\n<p>If you've got a boss that thinks Machine Learning is like writing software, and it either works or not, tell him he's flat out wrong. </p>\n"}], "owner": {"reputation": 57, "user_id": 1828006, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/c1ec150d252ba7a8ccad77b8f38000f1?s=128&d=identicon&r=PG", "display_name": "Sqandr", "link": "https://stackoverflow.com/users/1828006/sqandr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1488401663, "creation_date": 1488387466, "question_id": 42537634, "link": "https://stackoverflow.com/questions/42537634/how-to-implement-a-predictive-model-10-types-with-100-parameters-in-c-when-a", "title": "How to implement a predictive model (10 types with 100 parameters) in C++ when a DLL (+header) is the expected delivery?", "body": "<p>My desktop application process documents (10 types exist) to provide intelligence using 100s of parameters. Thru supervised training, I came up with a predictive model that uses 100 of the parameters to indicate whether a document is a reliable source of information or not. The training and testing of the Machine Learning model was done in Python. Currently I need to implement the prediction part, which uses the parameters weights from the training part, into my [MFC/VC++] desktop application.</p>\n\n<p>The suggested architecture is to provide a DLL plus header that exposes a function:</p>\n\n<p><code>bool isDocumentReliable(int docID)</code></p>\n\n<p>Based on the type of the document, the prediction uses a set of parameters to calculate the probability of the document being reliable. Based on risk assessment (requirements of the business) we translate the probability into a <code>true/false</code> answer. </p>\n\n<p>I am looking for some architectural/implementation information to guide my implementation. </p>\n\n<p>That's my first Machine Learning project and my questions are:</p>\n\n<ol>\n<li>What are the questions I need to be asking?</li>\n<li>Should the parameters be hard-coded into my functions? or</li>\n<li>Should the parameters be read from text files at runtime?</li>\n</ol>\n"}, {"tags": ["c++", "performance", "curl", "download", "libcurl"], "comments": [{"owner": {"reputation": 64787, "user_id": 892493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UxAIF.png?s=128&g=1", "display_name": "drew010", "link": "https://stackoverflow.com/users/892493/drew010"}, "edited": false, "score": 0, "creation_date": 1488391562, "post_id": 42537572, "comment_id": 72213443, "body": "What&#39;s the code for your WRITEFUNCTION?  Is it any quicker if you comment those two lines out and let curl do the write just for testing?"}], "answers": [{"comments": [{"owner": {"reputation": 4964, "user_id": 556899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0620f543129132d44fef456b3ab31a39?s=128&d=identicon&r=PG", "display_name": "stgatilov", "link": "https://stackoverflow.com/users/556899/stgatilov"}, "edited": false, "score": 0, "creation_date": 1594487259, "post_id": 42634245, "comment_id": 111146013, "body": "In 99.9% of cases buffers should grow exponentially. That would probably fix the problem."}], "tags": [], "owner": {"reputation": 161, "user_id": 7642607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a89f3ac45c44f5e77689b6b1caa139a?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer Parkin", "link": "https://stackoverflow.com/users/7642607/spencer-parkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1488829518, "creation_date": 1488829518, "answer_id": 42634245, "question_id": 42537572, "link": "https://stackoverflow.com/questions/42537572/libcurl-download-speed-too-slow/42634245#42634245", "title": "libcurl download speed too slow", "body": "<p>I had claimed to have tested with a dummy write function, but I actually hadn't.  When I tested with a dummy write function, the download speed was fast.</p>\n\n<p>So I investigated why my write function was slow and discovered that I was using an in-memory stream class that wasn't initialized with the required buffer size, so it was growing as needed.  The growth of the buffer was probably small, and every time it grew, it probably needed to copy the entire contents of the old buffer into the new one....so, long story short: I'm dumb, and the write stream was slow.</p>\n\n<p>Now I initialize my memory stream to the total size of the file so that it never has to grow.  Ugh!  Problem solved.</p>\n"}], "owner": {"reputation": 161, "user_id": 7642607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a89f3ac45c44f5e77689b6b1caa139a?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer Parkin", "link": "https://stackoverflow.com/users/7642607/spencer-parkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1783, "favorite_count": 0, "accepted_answer_id": 42634245, "answer_count": 1, "score": 1, "last_activity_date": 1488829518, "creation_date": 1488387300, "question_id": 42537572, "link": "https://stackoverflow.com/questions/42537572/libcurl-download-speed-too-slow", "title": "libcurl download speed too slow", "body": "<p>I have a case where I'm using libcurl with c++ to download a 240 MB file, but it takes 15 minutes to do so.  I have made sure that my write callback is as fast as possible.  It is just writing into an in-memory buffer that is plenty big-enough for the data.  When I use the curl command to download this same file from the same server, it takes less than a minute.  When I use a browser to download the file, it also takes less than a minute.  Is it possible that I'm using libcurl incorrectly?  Here's a snippet of my code...</p>\n\n<pre><code>wxString postFields;\npostFields += \"package_name=\" + packageName;\n\nif( desiredVersion != 0 )\n        postFields += wxString::Format( \"&amp;package_version=v%d\", desiredVersion );\n\ncurl_easy_reset( curlHandleEasy );\n\ncurl_slist_free_all( headers );\nheaders = nullptr;\n\nheaders = curl_slist_append( headers, \"Content-Type: application/x-www-form-urlencoded\" );\nheaders = curl_slist_append( headers, \"Accept: application/x-zip-compressed\" );\n\nurl = \"http://\" + packageServer + \":7000/package_download\";\nurlData = url.c_str();\n\nbinResponse = new BinaryResponse( packageSize );\n\ncurl_easy_setopt( curlHandleEasy, CURLOPT_HTTPHEADER, headers );\ncurl_easy_setopt( curlHandleEasy, CURLOPT_POSTFIELDS, postFieldsData );\ncurl_easy_setopt( curlHandleEasy, CURLOPT_URL, urlData );\ncurl_easy_setopt( curlHandleEasy, CURLOPT_WRITEFUNCTION, &amp;Response::WriteCallback );\ncurl_easy_setopt( curlHandleEasy, CURLOPT_WRITEDATA, binResponse );\n\ncurlCode = curl_easy_perform( curlHandleEasy );\n</code></pre>\n\n<p>Is there something wrong with my request setup?  If I change my write callback to be a dummy routine that just claims to have written the data, but just throws it away (to be as fast as possible), my download rate is still super slow.</p>\n\n<p>Is it possible that the bottle neck is some sort of security scanning on the network that I'm being subjected to that the browser and curl command aren't?</p>\n"}, {"tags": ["c++", "operator-overloading"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1488387834, "post_id": 42537441, "comment_id": 72211180, "body": "Unfortunately, <a href=\"http://stackoverflow.com/a/34954015/434551\">the relevant answer in the dupe</a> is way down."}], "answers": [{"tags": [], "owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "is_accepted": true, "score": 4, "last_activity_date": 1488387337, "last_edit_date": 1488387337, "creation_date": 1488387120, "answer_id": 42537507, "question_id": 42537441, "link": "https://stackoverflow.com/questions/42537441/cant-use-operator-as-a-method/42537507#42537507", "title": "Can&#39;t use operator&lt;&lt; as a method?", "body": "<p>Your <code>std::ostream&amp; MyClass::operator&lt;&lt; (std::ostream &amp;stream)</code> is used when you write <code>MyClass m; m &lt;&lt; std::cout;</code>. That is not what you intended.</p>\n\n<p>If you add <code>std::ostream &amp;std::ostream::operator&lt;&lt;(const MyClass &amp;m)</code> then that would work for <code>MyClass m; std::cout &lt;&lt; m;</code>, but it requires you to change the standard headers, which you cannot, so the non-member version is the only viable option.</p>\n\n<p>Note that the non-member version is not part of <code>MyClass</code> and therefore cannot access <code>private</code> members of <code>MyClass</code>. If you need that you can add <code>friend std::ostream&amp; operator&lt;&lt; (std::ostream &amp;stream, const MyClass &amp;mc);</code> to <code>MyClass</code> to make that possible.</p>\n"}, {"comments": [{"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1488387267, "post_id": 42537529, "comment_id": 72210794, "body": "@GoverNator: The word &quot;method&quot; doesn&#39;t really exist in C++. The OP used it as a synonym for what is correctly called &quot;member function&quot;."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1488387280, "post_id": 42537529, "comment_id": 72210802, "body": "<i>thats a rule in C++.</i>?? Not really. After all, <code>ostream</code> has some of them as member functions."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1488387381, "post_id": 42537529, "comment_id": 72210868, "body": "@RSahu: OK, what about <i>&quot;It&#39;s a rule in C++ that you have to make <code>operator&lt;&lt;</code> a non-member function if it takes a right-hand side argument of another class&quot;</i>?"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1488387582, "post_id": 42537529, "comment_id": 72211002, "body": "@RSahu: Better now?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1488387724, "post_id": 42537529, "comment_id": 72211110, "body": "it is definitely better :)"}], "tags": [], "owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "is_accepted": false, "score": 1, "last_activity_date": 1488387297, "last_edit_date": 1488387297, "creation_date": 1488387173, "answer_id": 42537529, "question_id": 42537441, "link": "https://stackoverflow.com/questions/42537441/cant-use-operator-as-a-method/42537529#42537529", "title": "Can&#39;t use operator&lt;&lt; as a method?", "body": "<p>Your <code>operator&lt;&lt;</code> must be a non-member function. You cannot make it a \"method\" if you want to use it with <code>std::cout</code> on the left-hand side and your own class on the right-hand side.</p>\n\n<p>But you can declare the <code>operator&lt;&lt;</code> as a friend if it needs access to <code>private</code> data of <code>MyClass</code>.</p>\n"}], "owner": {"reputation": 351, "user_id": 556070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/213d2878f365320266c15eb32bb38784?s=128&d=identicon&r=PG", "display_name": "Nix", "link": "https://stackoverflow.com/users/556070/nix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "closed_date": 1488387367, "accepted_answer_id": 42537507, "answer_count": 2, "score": 0, "last_activity_date": 1488387337, "creation_date": 1488386925, "question_id": 42537441, "link": "https://stackoverflow.com/questions/42537441/cant-use-operator-as-a-method", "closed_reason": "Duplicate", "title": "Can&#39;t use operator&lt;&lt; as a method?", "body": "<p>I used to define operator&lt;&lt; as a function, like I did with most of my operators.</p>\n\n<pre><code>class MyClass {\n    int myAttribute;\n\npublic :\n\n    MyClass(int attr):\n        myAttribute(attr){}\n\n    int getter() {return myAttribute;}\n};\n\nMyClass operator+(MyClass mc1, MyClass mc2)\n{\n    MyClass mc(mc1.getter()+mc2.getter());\n    return mc;\n}\n\nstd::ostream&amp; operator&lt;&lt; (std::ostream &amp;stream, MyClass mc)\n{\n    stream &lt;&lt; mc.getter();\n    return stream;\n}\n</code></pre>\n\n<p>All this works well but I was told that I could define it as a method. I removed the definitions of operator+ and operator&lt;&lt; and I got no problem with operator+</p>\n\n<pre><code>MyClass MyClass::operator+(MyClass mc1)\n{\n    MyClass mc(mc1.getter()+myAttribute);\n    return mc;\n}\n</code></pre>\n\n<p>but it's doesn't work with operator&lt;&lt;</p>\n\n<pre><code>std::ostream&amp; MyClass::operator&lt;&lt; (std::ostream &amp;stream)\n{\n    stream &lt;&lt; myAttribute;\n    return stream;\n}\n</code></pre>\n\n<p>I get the error : </p>\n\n<pre><code>error: no match for 'operator&lt;&lt;' (operand types are 'std::ostream {aka std::basic_ostream&lt;char&gt;}' and 'MyClass')\n</code></pre>\n\n<p>What do I miss ?</p>\n"}, {"tags": ["python", "c++", "python-3.x"], "answers": [{"comments": [{"owner": {"reputation": 352, "user_id": 5898049, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/5y8bg.jpg?s=128&g=1", "display_name": "VISWESWARAN NAGASIVAM", "link": "https://stackoverflow.com/users/5898049/visweswaran-nagasivam"}, "edited": false, "score": 0, "creation_date": 1491111685, "post_id": 43098573, "comment_id": 73404513, "body": "Thank you for your help! Much appreciated!"}], "tags": [], "owner": {"reputation": 70, "user_id": 7487216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26b950c3cca6817c3ed67d0618829571?s=128&d=identicon&r=PG", "display_name": "Jejos", "link": "https://stackoverflow.com/users/7487216/jejos"}, "is_accepted": true, "score": 4, "last_activity_date": 1490803145, "creation_date": 1490803145, "answer_id": 43098573, "question_id": 42537291, "link": "https://stackoverflow.com/questions/42537291/embedding-python-with-c/43098573#43098573", "title": "Embedding Python with C++", "body": "<p>On the one hand your test file 2 imports Tk which expects a valid command line (like e.g. for windows <code>C:\\&gt;python script.py -yourarguments</code>) for some reasons. On the other hand you embed python and thus don't have a command line. That's what python complains (\"module 'sys' has no attribute 'argv'\"). You should create a fake command line directly after Py_Initialize() with something like:</p>\n\n<pre><code>Py_Initialize();\nwchar_t const *dummy_args[] = {L\"Python\", NULL};  // const is needed because literals must not be modified\nwchar_t const **argv = dummy_args;\nint             argc = sizeof(dummy_args)/sizeof(dummy_args[0])-1;\nPySys_SetArgv(argc, const_cast&lt;wchar_t **&gt;(argv)); // const_cast allowed, because PySys_SetArgv doesn't change argv\n</code></pre>\n\n<p>Your test file 1 doesn't import Tk and thus doesn't expect a valid command line. That's the reason why it works without the code above.</p>\n"}], "owner": {"reputation": 352, "user_id": 5898049, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/5y8bg.jpg?s=128&g=1", "display_name": "VISWESWARAN NAGASIVAM", "link": "https://stackoverflow.com/users/5898049/visweswaran-nagasivam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 837, "favorite_count": 0, "accepted_answer_id": 43098573, "answer_count": 1, "score": 2, "last_activity_date": 1490803145, "creation_date": 1488386528, "last_edit_date": 1495542348, "question_id": 42537291, "link": "https://stackoverflow.com/questions/42537291/embedding-python-with-c", "title": "Embedding Python with C++", "body": "<p><strong>Problem:</strong> Strange exception is thrown when embedding Python with C++.</p>\n\n<p><strong>Program:</strong></p>\n\n<pre><code>bool embedd::execute_python(std::string location)\n{\n    if (std::ifstream(location))\n    {\n            const char* file_location = location.c_str();\n            FILE* file_pointer;\n            // Initialize the Python interpreter\n            Py_Initialize();\n            file_pointer = _Py_fopen(file_location, \"r\");\n            // Run the Python file\n            PyRun_SimpleFile(file_pointer, file_location);\n            // Finalize the Python interpreter\n            Py_Finalize();\n        return true;\n    }\n    return false;\n}\n</code></pre>\n\n<p><strong>What does the above code snippet should do:</strong>  The function should first check whether the passed argument is a valid location of the python file. If the file is present then it should execute the Python file.</p>\n\n<p><strong>Am I getting expected results:</strong>  yes and no.</p>\n\n<p><strong>what is going wrong:</strong> </p>\n\n<p>Test file 1:</p>\n\n<pre><code>print(\"Hello world\")\n</code></pre>\n\n<p><strong>Result :</strong> Successful execution and getting proper output</p>\n\n<p>Test file 2:</p>\n\n<pre><code>from tkinter import *\nroot = Tk()\nroot.mainloop()\n</code></pre>\n\n<blockquote>\n  <p>Result : Exception  root = Tk() File\n  \"C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python35-32\\Lib\\tkinter__init__.py\",\n  line 1863, in <strong>init</strong> baseName = os.path.basename(sys.argv[0])\n  AttributeError: module 'sys' has no attribute 'argv'</p>\n</blockquote>\n\n<p>Tested with some other file and found that when-ever we import modules(any) like tkinter, uuid, os etc similar exception gets thrown. on digging briefly about this the process monitor of my IDE told \"Symbol file is not loaded\" e.g no symbol file loaded for tk86t.dll </p>\n\n<p><strong>Python Version</strong> : 3.5.2  </p>\n\n<p>Links which I do have referred:\n<a href=\"https://stackoverflow.com/questions/12230210/attributeerror-module-object-has-no-attribute-argv-when-using-python-h\">SO - 1</a> found the bug has been fixed from Python 2.3 here <a href=\"http://bugs.python.org/issue839151\" rel=\"nofollow noreferrer\">BUGS</a></p>\n"}, {"tags": ["c++", "greedy"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1488385162, "post_id": 42536798, "comment_id": 72209271, "body": "Did you try stepping through your code, in a debugger, to figure out the source of the crash?"}, {"owner": {"reputation": 143, "user_id": 6810253, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2713318810fb2f6a7184215fca951bd8?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6810253/coder"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1488385333, "post_id": 42536798, "comment_id": 72209391, "body": "I don&#39;t know how to do that ,please tell me."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1488385515, "post_id": 42536798, "comment_id": 72209534, "body": "<code>sort(ratio.begin(),ratio.end(), std::greater&lt;double&gt;());</code>, and don&#39;t use a variable length array because it&#39;s non-standard (<code>double weight[j]</code>)"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1488385635, "post_id": 42536798, "comment_id": 72209619, "body": "Actually the more I look at it, the less <code>double(weight[j]);     max=max+(ratio[j]*weight[j]);</code> makes any sense"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1488385639, "post_id": 42536798, "comment_id": 72209623, "body": "@abhi11095 Do a query in your favorite search engine. You will find loads of tutorials. This should get you started: <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1488385693, "post_id": 42536798, "comment_id": 72209663, "body": "@AlgirdasPreid\u017eius: It may not be clear from the post, but the program doesn&#39;t compile. Not sure how OP got an executable at all, perhaps it&#39;s from an earlier successful compilation that includes other bugs."}, {"owner": {"reputation": 256, "user_id": 2206013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07cade7ed9cb6146f56ee74b2dea405c?s=128&d=identicon&r=PG", "display_name": "ZeroUltimax", "link": "https://stackoverflow.com/users/2206013/zeroultimax"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1488385697, "post_id": 42536798, "comment_id": 72209671, "body": "@AlgirdasPreid\u017eius I agree with that."}, {"owner": {"reputation": 143, "user_id": 6810253, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2713318810fb2f6a7184215fca951bd8?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6810253/coder"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1488385749, "post_id": 42536798, "comment_id": 72209718, "body": "@Andy G It worked but exe file is crashing"}, {"owner": {"reputation": 143, "user_id": 6810253, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2713318810fb2f6a7184215fca951bd8?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6810253/coder"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1488386243, "post_id": 42536798, "comment_id": 72210057, "body": "@AlgirdasPreid\u017eius: Thanks man"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1488386890, "post_id": 42536798, "comment_id": 72210559, "body": "<code>ratio[i]=double(val[i]&#47;wt[i])</code> probably won&#39;t do what you expected"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1488386973, "post_id": 42536798, "comment_id": 72210612, "body": "@AndyG Well.. I didn&#39;t try to compile it. I saw the question is about unexpected behavior - and immediately suggested using the debugger to resolve such an issue."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 6810253, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2713318810fb2f6a7184215fca951bd8?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6810253/coder"}, "edited": false, "score": 0, "creation_date": 1488385575, "post_id": 42536904, "comment_id": 72209577, "body": "D:\\COdeBlock Projects\\Fractional Knapsack\\main.cpp|12|error: missing template arguments before &#39;)&#39; token| now this"}], "tags": [], "owner": {"reputation": 256, "user_id": 2206013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07cade7ed9cb6146f56ee74b2dea405c?s=128&d=identicon&r=PG", "display_name": "ZeroUltimax", "link": "https://stackoverflow.com/users/2206013/zeroultimax"}, "is_accepted": false, "score": 0, "last_activity_date": 1488385577, "last_edit_date": 1488385577, "creation_date": 1488385451, "answer_id": 42536904, "question_id": 42536798, "link": "https://stackoverflow.com/questions/42536798/greedy-algorithm-implemented-in-fractional-knapsack/42536904#42536904", "title": "Greedy Algorithm implemented in fractional knapsack", "body": "<p>A quick look at the error message reveal the problem lies with the line \n<code>sort(ratio.begin(),ratio.end(),greater());</code></p>\n\n<p>My guess is that you want \n<code>sort(ratio.begin(),ratio.end(),greater&lt;double&gt;());</code></p>\n\n<p>The sort method expects a comparator. If you look at the <a href=\"http://www.cplusplus.com/reference/functional/greater/\" rel=\"nofollow noreferrer\">doc</a> for greater, there's an example on how to use it.</p>\n"}, {"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1488646123, "post_id": 42564070, "comment_id": 72328131, "body": "Learn how to indent first. Your mess is making people&#39;s eyes painful"}], "tags": [], "owner": {"reputation": 143, "user_id": 6810253, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2713318810fb2f6a7184215fca951bd8?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6810253/coder"}, "is_accepted": false, "score": 0, "last_activity_date": 1488482245, "creation_date": 1488482245, "answer_id": 42564070, "question_id": 42536798, "link": "https://stackoverflow.com/questions/42536798/greedy-algorithm-implemented-in-fractional-knapsack/42564070#42564070", "title": "Greedy Algorithm implemented in fractional knapsack", "body": "<p>I got the right code.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include&lt;vector&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\ndouble fractional_knapsack(vector&lt;int&gt;&amp; val,vector&lt;int&gt;&amp; wt,int   weight)//vectors of values and their respective weights and max weight are passed as parameter\n{\nint sz=val.size();\n\nvector&lt;double&gt; ratio(sz); //vector to store ratio of values and weights\n\nfor(int i=0;i&lt;sz;i++){\n    ratio[i]=(val[i]/wt[i]);\n}\nfor(int i=0;i&lt;sz;i++){\nfor(int j=i+1;j&lt;sz;j++){\n    if(ratio[i]&lt;ratio[j]){\n        int temp;\n        temp=ratio[i];\n        ratio[i]=ratio[j];\n        ratio[j]=temp;\n\n        temp=val[i];\n        val[i]=val[j];\n        val[j]=temp;\n\n        temp=wt[i];\n        wt[i]=wt[j];\n        wt[j]=temp;\n    }\n }\n}\n\n//sort(ratio.begin(),ratio.end(),greater&lt;double&gt;());\n// sort(val.begin(),val.end(),greater&lt;int&gt;());\n//sort(wt.begin(),wt.end(),greater&lt;int&gt;());\n//reverse(ratio.begin(),ratio.end());\n\ndouble max=0.0;\nint j=0;\n\nint quantity_left =weight;\nwhile(wt[j]&lt;=quantity_left&amp;&amp;j&lt;sz){\n        //double(wt[j]);\n\n    max=max+(ratio[j]*wt[j]);\n    cout&lt;&lt;max&lt;&lt;\" \";\n    quantity_left=quantity_left-wt[j];\n    j++;\n\n}\nif(wt[j]&gt;quantity_left&amp;&amp;j&lt;sz){\n    max=max+(ratio[j]*quantity_left);\n   // cout&lt;&lt;max&lt;&lt;\" \";\n}\n\nreturn max;\n}\nint main()\n{  int max_weight,n;\ncin&gt;&gt;n&gt;&gt;max_weight;\nvector&lt;int&gt;values(n);\nvector&lt;int&gt;weights(n);\nfor(int i=0;i&lt;n;i++){\n    cin&gt;&gt;values[i];\n}\nfor(int i=0;i&lt;n;i++){\n    cin&gt;&gt;weights[i];\n}\ndouble result=fractional_knapsack(values,weights,max_weight);\n\ncout&lt;&lt;result;\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 6810253, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2713318810fb2f6a7184215fca951bd8?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6810253/coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1402, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1488482245, "creation_date": 1488385114, "last_edit_date": 1488386539, "question_id": 42536798, "link": "https://stackoverflow.com/questions/42536798/greedy-algorithm-implemented-in-fractional-knapsack", "title": "Greedy Algorithm implemented in fractional knapsack", "body": "<pre><code>#include &lt;iostream&gt;\n#include&lt;vector&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\ndouble fractional_knapsack(vector&lt;int&gt;&amp; val,vector&lt;int&gt;&amp; wt,int    weight)//vectors of values and their respective weights and max weight are   passed as parameter\n{\nint sz=val.size();\nvector&lt;double&gt; ratio(sz); //vector to store ratio of values and weights\nfor(int i=0;i&lt;sz;i++){\n    ratio[i]=double(val[i]/wt[i]);\n}\nsort(ratio.begin(),ratio.end(),greater());\n//reverse(ratio.begin(),ratio.end());\ndouble max=0.0;\nint j=0;\nwhile(max&lt;=weight&amp;&amp;j&lt;sz){\n        double(weight[j]);\n    max=max+(ratio[j]*weight[j]);\n}\nreturn max;\n}\nint main()\n{  int max_weight,n;\ncin&gt;&gt;n&gt;&gt;max_weight;\nvector&lt;int&gt;values;\nvector&lt;int&gt;weights;\nfor(int i=0;i&lt;n;i++){\n    cin&gt;&gt;values[i];\n}\nfor(int i=0;i&lt;n;i++){\n    cin&gt;&gt;weights[i];\n}\ndouble result=fractional_knapsack(values,weights,max_weight);\ncout&lt;&lt;\"done/n\";\ncout&lt;&lt;result;\nreturn 0;\n}\n</code></pre>\n\n<p>D:\\COdeBlock Projects\\Fractional Knapsack\\main.cpp|12|error: missing template arguments before '(' token|</p>\n\n<p>it is compiling in devcpp but program_name.exe is crashing</p>\n\n<p>in the method <code>fractional_knapsack(vector&lt;int&gt;&amp; val,vector&lt;int&gt;&amp; wt,int weight)</code> why we pass vector as refrence.</p>\n"}, {"tags": ["c++", "datetime", "boost", "gregorian-calendar"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488386987, "post_id": 42536379, "comment_id": 72210620, "body": "Posix time starts in 1970. Gregorian calendar starts in 1572 (and the facet supports dates earlier than that)."}, {"owner": {"reputation": 12235, "user_id": 368896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/86b2d19edca5143a705619f0bc0bb04e?s=128&d=identicon&r=PG", "display_name": "Dan Nissenbaum", "link": "https://stackoverflow.com/users/368896/dan-nissenbaum"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488387301, "post_id": 42536379, "comment_id": 72210815, "body": "Thanks.  Does Posix also support dates prior to 1970 (via negative values)?  I assume it does."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1488387714, "post_id": 42536379, "comment_id": 72211101, "body": "I looked in the documentation after typing the comment. Apparently posix_time::time_facet extends gregorian::date_facet."}, {"owner": {"reputation": 12235, "user_id": 368896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/86b2d19edca5143a705619f0bc0bb04e?s=128&d=identicon&r=PG", "display_name": "Dan Nissenbaum", "link": "https://stackoverflow.com/users/368896/dan-nissenbaum"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488387739, "post_id": 42536379, "comment_id": 72211118, "body": "That&#39;s very helpful, thanks."}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 2, "creation_date": 1488387752, "post_id": 42536379, "comment_id": 72211135, "body": "Those two are typedefs. (<a href=\"https://github.com/boostorg/date_time/blob/6015e3039114c0f2ba456e00dd50404e3fb88275/include/boost/date_time/gregorian/gregorian_io.hpp#L32\" rel=\"nofollow noreferrer\">1</a> <a href=\"https://github.com/boostorg/date_time/blob/6015e3039114c0f2ba456e00dd50404e3fb88275/include/boost/date_time/posix_time/posix_time_io.hpp#L38\" rel=\"nofollow noreferrer\">2</a> ). So it&#39;s really <code>boost::date_time::date_facet</code> and <code>boost::date_time::time_facet</code>. <a href=\"http://www.boost.org/doc/libs/1_63_0/doc/html/date_time/date_time_io.html\" rel=\"nofollow noreferrer\">Documentation</a> says: &quot;The boost::date_time::time_facet is an extension of the boost::date_time::date_facet.&quot;"}], "owner": {"reputation": 12235, "user_id": 368896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/86b2d19edca5143a705619f0bc0bb04e?s=128&d=identicon&r=PG", "display_name": "Dan Nissenbaum", "link": "https://stackoverflow.com/users/368896/dan-nissenbaum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 800, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488385376, "creation_date": 1488383943, "last_edit_date": 1495541355, "question_id": 42536379, "link": "https://stackoverflow.com/questions/42536379/what-is-the-difference-between-boostposix-timetime-facet-and-boostgregoria", "title": "What is the difference between boost::posix_time::time_facet and boost::gregorian::date_facet?", "body": "<p>Different answers to <a href=\"https://stackoverflow.com/questions/5018188/how-to-format-a-datetime-to-string-using-boost\">this question about formatting date + time strings using Boost</a> use different facets.</p>\n\n<p><a href=\"https://stackoverflow.com/a/5020490/368896\">One answer</a> uses <code>boost::posix_time::time_facet</code>, and the <a href=\"https://stackoverflow.com/a/24265390/368896\">other answer</a> uses <code>boost::gregorian::date_facet</code> (note that the latter also includes the <strong>time</strong>, despite the name of the facet class).</p>\n\n<p>I.e., we have:</p>\n\n<pre><code>boost::posix_time::time_facet(\"%Y-%m-%d %H:%M:%S\");\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>boost::gregorian::date_facet(\"%Y-%m-%d %H:%M:%S\");\n</code></pre>\n\n<p>(with irrelevant characters slightly adjusted by me from the linked answers).</p>\n\n<p>Notice, again, that the <code>boost::gregorian::date_facet</code> includes the <strong>time</strong>, so in a sense calling it a <code>date_facet</code> is a bit deceptive, especially when contrasting it with <code>boost::posix_time::time_facet</code>, whose developers clearly felt should include \"time\" in the name of the facet class.</p>\n\n<p>Also notice that <code>boost::posix_time::time_facet</code> includes the <strong>date</strong>, which is perhaps more intuitive (though it is possible to think of purely formatting <em>times</em>, but not <em>dates</em>, so maybe it shouldn't be more intuitive that a \"time\" facet can include the \"date\" than that a \"date\" facet can include the \"time\").</p>\n\n<p>But back specifically to my question: I feel that somehow I must be missing something important involving the <code>gregorian</code> aspect of things if I use the <code>boost::posix_time</code> version - people wouldn't bother making a namespace to represent the <em>Gregorian</em> calendar if that doesn't matter, right?</p>\n\n<p>And conversely - is <code>boost::gregorian</code>'s version missing something important from the <code>boost::posix_time</code> version?</p>\n\n<p>Is one of them a superset of the other?  Alternatively, do their features overlap, but differ?</p>\n\n<p><strong>What is the difference between <code>boost::posix_time::time_facet</code> and <code>boost::gregorian::date_facet</code>?</strong></p>\n"}, {"tags": ["c++", "linux", "qt", "qt-creator"], "comments": [{"owner": {"reputation": 5817, "user_id": 4742108, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/GvE0m.jpg?s=128&g=1", "display_name": "Velkan", "link": "https://stackoverflow.com/users/4742108/velkan"}, "edited": false, "score": 0, "creation_date": 1488450325, "post_id": 42536376, "comment_id": 72240429, "body": "Tried to valgrind it?"}, {"owner": {"reputation": 7, "user_id": 6092009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a72b87e67fcd540059e780a1b0ff770?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Da", "link": "https://stackoverflow.com/users/6092009/mohammad-da"}, "reply_to_user": {"reputation": 5817, "user_id": 4742108, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/GvE0m.jpg?s=128&g=1", "display_name": "Velkan", "link": "https://stackoverflow.com/users/4742108/velkan"}, "edited": false, "score": 0, "creation_date": 1488450581, "post_id": 42536376, "comment_id": 72240596, "body": "No. just searched for what it mean, and didn&#39;t find any relevant answer."}], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 6092009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a72b87e67fcd540059e780a1b0ff770?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Da", "link": "https://stackoverflow.com/users/6092009/mohammad-da"}, "is_accepted": true, "score": 0, "last_activity_date": 1488978379, "creation_date": 1488978379, "answer_id": 42672192, "question_id": 42536376, "link": "https://stackoverflow.com/questions/42536376/running-application-from-qt-creator-give-an-error-qxcbconnection-then-abort/42672192#42672192", "title": "Running Application from Qt Creator give an error QXcbConnection then Abort", "body": "<p>It was just a wrong configuration. Unchecked <code>Clear system environment</code> to solve the error:\n<a href=\"https://i.stack.imgur.com/0HPgI.png\" rel=\"nofollow noreferrer\">Settings picture</a></p>\n"}], "owner": {"reputation": 7, "user_id": 6092009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a72b87e67fcd540059e780a1b0ff770?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Da", "link": "https://stackoverflow.com/users/6092009/mohammad-da"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 42672192, "answer_count": 1, "score": -1, "last_activity_date": 1488978379, "creation_date": 1488383940, "question_id": 42536376, "link": "https://stackoverflow.com/questions/42536376/running-application-from-qt-creator-give-an-error-qxcbconnection-then-abort", "title": "Running Application from Qt Creator give an error QXcbConnection then Abort", "body": "<p>I'm building a game as Homework <a href=\"https://github.com/mdahamshi/reversi\" rel=\"nofollow noreferrer\">reversitQT</a>\n,The project was working Ok in linux mint 17, when I upgraded to Linux mint 18, I imported the project to the Qt creator, and started to receive this error: </p>\n\n<pre><code>QXcbConnection: Could not connect to display \n</code></pre>\n\n<p>With the application abort as in the picture:\n<a href=\"https://i.stack.imgur.com/tATIs.png\" rel=\"nofollow noreferrer\">error message</a>\n<br><br>\n<strong>* The built program run fine when I run it from the terminal</strong>\n<br>\n<br>\n<strong>Old System Info:</strong>\n<br>\nLinux mint 17  - 3.19 kernel\n<br>\nQt Creator based on Qt 5.7\n<br><br>\n<strong>New System Info:</strong>\n<br>\nLinux mint 18  -  4.4 kernel\n<br>\nQt creator based on Qt 5.8</p>\n"}, {"tags": ["java", "c++", "windows", "opencv", "java-native-interface"], "comments": [{"owner": {"reputation": 363, "user_id": 5164938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c574fa591acf9fd1316c33fa338eda0?s=128&d=identicon&r=PG&f=1", "display_name": "Region39", "link": "https://stackoverflow.com/users/5164938/region39"}, "edited": false, "score": 0, "creation_date": 1600383787, "post_id": 42536366, "comment_id": 113079185, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/6092200/how-to-fix-an-unsatisfiedlinkerror-cant-find-dependent-libraries-in-a-jni-pro\">How to fix an UnsatisfiedLinkError (Can&#39;t find dependent libraries) in a JNI project</a>"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 2278538, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2e20f6c452a3beca66504116fe3bbba4?s=128&d=identicon&r=PG", "display_name": "KSK", "link": "https://stackoverflow.com/users/2278538/ksk"}, "edited": false, "score": 1, "creation_date": 1513370013, "post_id": 42536848, "comment_id": 82642903, "body": "@isacikgoz It seems obvious now, but when the error message kept saying: &quot;Can&#39;t find dependent libraries&quot; I didn&#39;t know that there really were other libraries that would need to be loaded.  I used a DLL dependency walker to find the dependent libraries and loaded them as you suggest and now it works!  Thank you."}], "tags": [], "owner": {"reputation": 96, "user_id": 1537318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4dc30bd9263e94788efd51f74e15f08?s=128&d=identicon&r=PG", "display_name": "isacikgoz", "link": "https://stackoverflow.com/users/1537318/isacikgoz"}, "is_accepted": true, "score": 5, "last_activity_date": 1488463504, "last_edit_date": 1495541828, "creation_date": 1488385284, "answer_id": 42536848, "question_id": 42536366, "link": "https://stackoverflow.com/questions/42536366/how-to-solve-java-lang-unsatisfiedlinkerror-cant-find-dependent-libraries-wi/42536848#42536848", "title": "How to solve &quot;java.lang.UnsatisfiedLinkError: Can&#39;t find dependent libraries&quot; without System32?", "body": "<p>The best practice for this issue is to load dependent libraries by yourself with calling the library load method:</p>\n\n<pre><code>System.loadLibrary(\"opencv_1\");\nSystem.loadLibrary(\"opencv_2\");\n...\n</code></pre>\n\n<p>After you load dependent libararies now you can safely load your own dll file with the same way:</p>\n\n<pre><code>System.loadLibrary(\"MyFile\");\n</code></pre>\n\n<p>This should resolve the <code>can't file dependent libraries</code> error.</p>\n\n<p>Another workaround (no the best practice) is to copy dependent dll files (in your case opencv dlls) to System32 folder.</p>\n\n<p>Why this is happening?</p>\n\n<p>I think, when you set <code>java.library.path</code> argument, you are responsible to load dependent libraries of the library, not the OS itself. I'm not sure to be honest.</p>\n\n<p>As mentioned in the <a href=\"https://stackoverflow.com/a/6092576/1537318\">How to fix an UnsatisfiedLinkError (Can't find dependent libraries) in a JNI project</a>\n,  you can check your path by adding <code>-XshowSettings:properties -version</code> argument to the virtual machine.</p>\n"}, {"tags": [], "owner": {"reputation": 3373, "user_id": 2830167, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/E9eEy.jpg?s=128&g=1", "display_name": "ZhaoGang", "link": "https://stackoverflow.com/users/2830167/zhaogang"}, "is_accepted": false, "score": 1, "last_activity_date": 1543885222, "creation_date": 1543885222, "answer_id": 53604197, "question_id": 42536366, "link": "https://stackoverflow.com/questions/42536366/how-to-solve-java-lang-unsatisfiedlinkerror-cant-find-dependent-libraries-wi/53604197#53604197", "title": "How to solve &quot;java.lang.UnsatisfiedLinkError: Can&#39;t find dependent libraries&quot; without System32?", "body": "<p>For ones who are hitting the complain: <code>Can't find dependent libraries</code> and visiting this post for a solution: </p>\n\n<p>this complain means that the dll which failed to load is depending on some other dlls. By using a depedency walker: <a href=\"http://www.dependencywalker.com/\" rel=\"nofollow noreferrer\">http://www.dependencywalker.com/</a>,   we can tell what dlls are required. By loading them ( <code>System.loadLibrary(\"dependedDll\");</code> ) before the failed loading dll, we can solve this issue.</p>\n"}], "owner": {"reputation": 278, "user_id": 4057608, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/DpUDg.jpg?s=128&g=1", "display_name": "Utku Ufuk", "link": "https://stackoverflow.com/users/4057608/utku-ufuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15229, "favorite_count": 2, "accepted_answer_id": 42536848, "answer_count": 2, "score": 3, "last_activity_date": 1600375302, "creation_date": 1488383905, "last_edit_date": 1488400373, "question_id": 42536366, "link": "https://stackoverflow.com/questions/42536366/how-to-solve-java-lang-unsatisfiedlinkerror-cant-find-dependent-libraries-wi", "title": "How to solve &quot;java.lang.UnsatisfiedLinkError: Can&#39;t find dependent libraries&quot; without System32?", "body": "<p>I'm working on a Java project on Eclipse, which uses C++ OpenCV libraries via JNI. Some image processing algorithms are implemented with OpenCV on the native side, and I wish to use them from java using JNI.</p>\n\n<p>I have built a C++ DLL project to link to Java, which resulted in a <code>MyLibrary.dll</code> file. I compiled OpenCV with GCC 6.3 compiler and I compiled the C++ code with the same GCC 6.3 compiler on Eclipse CDT (along with MinGW Linker). I also checked if there are any dependency issues using <a href=\"http://www.dependencywalker.com/\" rel=\"nofollow noreferrer\">Dependency Walker</a>. I had no errors thus far.</p>\n\n<p>Afterwards, I tried to load the library from Java code as follows:<br>\n<code>System.loadLibrary(\"MyLibrary\")</code></p>\n\n<p>I have set the path with <code>-Djava.library.path=path\\to\\MyLibrary</code>, and and made sure that JVM knows the address of the native libraries. I also added the required OpenCV libraries next to <code>MyLibrary.dll</code>.</p>\n\n<p>However I get the following error:</p>\n\n<pre><code>Exception in thread \"main\" java.lang.UnsatisfiedLinkError: MyLibrary.dll: Can't find dependent libraries\nat java.lang.ClassLoader$NativeLibrary.load(Native Method)\nat java.lang.ClassLoader.loadLibrary0(Unknown Source)\nat java.lang.ClassLoader.loadLibrary(Unknown Source)\nat java.lang.Runtime.loadLibrary0(Unknown Source)\nat java.lang.System.loadLibrary(Unknown Source)\n...\n</code></pre>\n\n<p>Then the problem goes away, when I move the dependent OpenCV libraries into the <code>System32</code> folder. </p>\n\n<p>My question is; how can I solve this issue <strong>without moving</strong> the required DLL files into the <code>System32</code> folder?</p>\n"}, {"tags": ["c++", "eigen"], "comments": [{"owner": {"reputation": 256, "user_id": 2206013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07cade7ed9cb6146f56ee74b2dea405c?s=128&d=identicon&r=PG", "display_name": "ZeroUltimax", "link": "https://stackoverflow.com/users/2206013/zeroultimax"}, "edited": false, "score": 0, "creation_date": 1488384810, "post_id": 42536344, "comment_id": 72209018, "body": "I&#39;d suggest going to <a href=\"https://math.stackexchange.com\">Mathematics</a> for that question and applying the algorithms with eigen."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1488390293, "post_id": 42536344, "comment_id": 72212717, "body": "Can <a href=\"https://eigen.tuxfamily.org/dox/classEigen_1_1LLT.html\" rel=\"nofollow noreferrer\">this</a> be helpful?"}, {"owner": {"reputation": 37, "user_id": 1243403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7973b8fdb3f6c1371ce470fefd977ea5?s=128&d=identicon&r=PG&f=1", "display_name": "DJ Guion", "link": "https://stackoverflow.com/users/1243403/dj-guion"}, "edited": false, "score": 0, "creation_date": 1488448326, "post_id": 42536344, "comment_id": 72239051, "body": "Yes Bob, I found that yesterday right after I&#39;d asked the question here. Thank you very much"}], "answers": [{"tags": [], "owner": {"reputation": 423, "user_id": 673137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f217be419e3bd103d75f4bc8dd4ee9?s=128&d=identicon&r=PG", "display_name": "Mr. White", "link": "https://stackoverflow.com/users/673137/mr-white"}, "is_accepted": false, "score": 0, "last_activity_date": 1497791256, "creation_date": 1497791256, "answer_id": 44615320, "question_id": 42536344, "link": "https://stackoverflow.com/questions/42536344/eigen-find-a-triangular-matrix/44615320#44615320", "title": "Eigen: find a triangular matrix", "body": "<p>It's the Cholesky decomposition (LLT) you're after,\nor the LDLT if the eigenvalues of your matrix could be zero.</p>\n\n<p>See <a href=\"https://eigen.tuxfamily.org/dox/group__TopicLinearAlgebraDecompositions.html\" rel=\"nofollow noreferrer\">https://eigen.tuxfamily.org/dox/group__TopicLinearAlgebraDecompositions.html</a> for an overview.</p>\n"}], "owner": {"reputation": 37, "user_id": 1243403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7973b8fdb3f6c1371ce470fefd977ea5?s=128&d=identicon&r=PG&f=1", "display_name": "DJ Guion", "link": "https://stackoverflow.com/users/1243403/dj-guion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1516865991, "creation_date": 1488383839, "last_edit_date": 1516865991, "question_id": 42536344, "link": "https://stackoverflow.com/questions/42536344/eigen-find-a-triangular-matrix", "title": "Eigen: find a triangular matrix", "body": "<p>I'm using the Eigen library in C++ and have a symmetric matrix <code>M</code> of size <code>n</code>, how can I find the triangular matrix <code>L</code> such that <code>M = Lt x L</code>?</p>\n"}, {"tags": ["c++", "overloading", "rvalue", "ambiguous"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488383986, "post_id": 42536333, "comment_id": 72208453, "body": "Show us the code in question, and not what you assume/expect it to be."}, {"owner": {"reputation": 307, "user_id": 668180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/12f3241ea33a5817f8ad86fb4e161479?s=128&d=identicon&r=PG&f=1", "display_name": "tuk", "link": "https://stackoverflow.com/users/668180/tuk"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488384438, "post_id": 42536333, "comment_id": 72208756, "body": "The post already shows the code in question.  I&#39;ve made no assumptions &amp; have no expectations."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488384858, "post_id": 42536333, "comment_id": 72209064, "body": "Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of <b>your</b> implementation."}], "answers": [{"tags": [], "owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "is_accepted": true, "score": 3, "last_activity_date": 1488384140, "creation_date": 1488384140, "answer_id": 42536449, "question_id": 42536333, "link": "https://stackoverflow.com/questions/42536333/ambiguous-rvalue-arguments-cause-compiler-to-choose-incorrect-overload/42536449#42536449", "title": "Ambiguous/rvalue arguments cause compiler to choose incorrect overload", "body": "<blockquote>\n  <p><strong>[sequence.reqmts]/14</strong> For every sequence container defined in this Clause and in Clause 21:</p>\n  \n  <p>(14.2) \u2014 If the member functions of the forms:</p>\n\n<pre><code>template &lt;class InputIterator&gt; // such as insert()\nrt fx1(const_iterator p, InputIterator first, InputIterator last);\ntemplate &lt;class InputIterator&gt; // such as append(), assign()\nrt fx2(InputIterator first, InputIterator last);\ntemplate &lt;class InputIterator&gt; // such as replace()\nrt fx3(const_iterator i1, const_iterator i2, InputIterator first, InputIterator last);\n</code></pre>\n  \n  <p>are called with a type <code>InputIterator</code> that does not qualify as an input iterator, then these functions shall not participate in overload resolution.</p>\n</blockquote>\n\n<p>This is typically implemented with a touch of SFINAE. You can check the headers of your favorite standard library implementation for details.</p>\n"}], "owner": {"reputation": 307, "user_id": 668180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/12f3241ea33a5817f8ad86fb4e161479?s=128&d=identicon&r=PG&f=1", "display_name": "tuk", "link": "https://stackoverflow.com/users/668180/tuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 42536449, "answer_count": 1, "score": -4, "last_activity_date": 1488384140, "creation_date": 1488383813, "question_id": 42536333, "link": "https://stackoverflow.com/questions/42536333/ambiguous-rvalue-arguments-cause-compiler-to-choose-incorrect-overload", "title": "Ambiguous/rvalue arguments cause compiler to choose incorrect overload", "body": "<p>I have a home grown template class called <code>Vec</code> which is a pale shadow of: <code>std::vector&lt;T&gt;</code> </p>\n\n<p>To avoid re-inventing the wheel the header overloads for <code>assign</code> are copied from: <code>std::vector::assign</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/cpkLT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cpkLT.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>..so</p>\n\n<p><a href=\"https://i.stack.imgur.com/a5Gcp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a5Gcp.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As part of testing <code>Str</code> class, ..test code is also run against <code>std::vector&lt;T&gt;</code> to ensure equivalent output... </p>\n\n<p>If <code>std::vector&lt;T&gt;</code> is used then compiler will choose the correct overload:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JVUU6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JVUU6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>However, when <code>Vec&lt;T&gt;</code> is used then compiler insists on choosing the incorrect overload:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6OFwm.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6OFwm.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>There is an obvious work around via casting the args to lvalues prior to use:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qOgEg.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qOgEg.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Question:\nGiven that both <code>Vec&lt;T&gt;</code> and <code>std::vector&lt;T&gt;</code> use identical header overloads for their respective <code>assign</code> ...how is <code>std::vector&lt;T&gt;</code> able to implement rvalues arg without confusing the compiler?</p>\n"}, {"tags": ["c++", "windows", "multithreading", "c++11", "visual-studio-2015"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1488383939, "post_id": 42535990, "comment_id": 72208416, "body": "<i>&quot;Is this behavior documented?&quot;</i> - Yes, sort of: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dn633971.aspx\" rel=\"nofollow noreferrer\">Dynamic-Link Library Best Practices</a>."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1488384332, "post_id": 42535990, "comment_id": 72208693, "body": "&quot;The Old New Thing&quot; has a small series on DLL shutdown, in summary from the point when DllMain is called during DLL shutdown (which is before statics are destroyed) all bets are off as as many OS calls have been &quot;electrified&quot; and will fail in unexpected ways.  Found link <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20100122-00/?p=15193\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/oldnewthing/20100122-00/?p=15193</a>"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1488384390, "post_id": 42535990, "comment_id": 72208727, "body": "did you mark the class as DLLExport?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1488385858, "post_id": 42535990, "comment_id": 72209797, "body": "@RichardHodges: No class members or object references are accessed from outside the DLL. There is no need to export the class or class members."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1488387945, "post_id": 42535990, "comment_id": 72211263, "body": "@RichardHodges: nope, there&#39;s no need to."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1488387967, "post_id": 42535990, "comment_id": 72211282, "body": "@RichardCritten: thanks for the link and the explanation."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1488390147, "post_id": 42535990, "comment_id": 72212611, "body": "What about the constructor and destructor? Aren&#39;t they called from the main module."}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1488411780, "post_id": 42535990, "comment_id": 72224232, "body": "See <a href=\"http://stackoverflow.com/questions/10915233/stdthreadjoin-hangs-if-called-after-main-exits-when-using-vs2012-rc\" title=\"stdthreadjoin hangs if called after main exits when using vs2012 rc\">stackoverflow.com/questions/10915233/&hellip;</a>, most likely the same - the dtor of <code>StaticThreadTest</code> is called when the dll is unloaded which might happen after <code>main</code> exits."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1488421850, "post_id": 42535990, "comment_id": 72227105, "body": "In most cases, the best way to avoid the whole sticky mess is to avoid static objects.  Have an explicit initialization routine in your DLL and create your global objects there; have an explicit uninitialization routine as well to destroy them."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1488433618, "post_id": 42535990, "comment_id": 72230858, "body": "@HarryJohnston: It&#39;s obvious, but very inconvenient for the DLL clients."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1488433664, "post_id": 42535990, "comment_id": 72230880, "body": "@RudolfsBundulis: It <i>should</i> be called after <code>main</code> exits! I don&#39;t see why that must cause trouble with threads."}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1488445112, "post_id": 42535990, "comment_id": 72236815, "body": "@VioletGiraffe: see the bug in Microsoft Connect in the SO link - in the case a thread is joined after main exits you hit a bug in the runtime. As simple as that."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1488446741, "post_id": 42535990, "comment_id": 72237925, "body": "@RudolfsBundulis: It&#39;s curious that it occurs when the thread is hosted in a DLL but not in .exe as long as you&#39;re using v140 runtime. I wonder if they fixed it for .exe, or if it&#39;s just a coincidence."}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1488458390, "post_id": 42535990, "comment_id": 72245804, "body": "@VioletGiraffe well, imho, since they are advising that these things should not be done inside <code>DllMain</code>, and <code>DllMain</code> is from where the dtors of static objects are invoked, I think it is kind of a no mans land. I mean there  is no fixed term here imho - they tell that noone should do this, they know there are issues, they may fix some (since we see that it has improved from v120), but there are no guarantees."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1488459419, "post_id": 42535990, "comment_id": 72246513, "body": "@RudolfsBundulis: you&#39;re right, I understand. It&#39;s just annoying because this issue makes using certain libraries more cumbersome (the client needs to explicitly call a deinitializer function)."}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1488460012, "post_id": 42535990, "comment_id": 72246873, "body": "@VioletGiraffe I wonder if this is still something else, I put together an example with a different way of termination (conditional variable + mutex) and I can&#39;t get that to hang. I can put it on github if you like, and you can check if you can make that hang. Maybe this is still something else?"}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1488460154, "post_id": 42535990, "comment_id": 72246971, "body": "@RudolfsBundulis: sure, share a link to gist. Does my code hang on your machine?"}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1488460445, "post_id": 42535990, "comment_id": 72247169, "body": "@VioletGiraffe first time I use Gist, hope I do this right :D here goes: <a href=\"https://gist.github.com/rubu/315725af4fa694cdb79f7517e6812451\" rel=\"nofollow noreferrer\">gist.github.com/rubu/315725af4fa694cdb79f7517e6812451</a> . I&#39;ll try the atomic stuff in a sec."}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1488461106, "post_id": 42535990, "comment_id": 72247592, "body": "@VioletGiraffe actually I can&#39;t get it to hang with your code."}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1488462388, "post_id": 42535990, "comment_id": 72248580, "body": "@VioletGiraffe oh, then I have possibly solved this:D But I&#39;ll still try to make it hang with the atomic stuff, since now I&#39;m already curious."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1488489629, "post_id": 42535990, "comment_id": 72266291, "body": "@VioletGiraffe, if the library <i>must</i> uninitialize cleanly on program exit (in most cases this is just a waste of time) can&#39;t the <i>client</i> have a static global to deal with the initialization and uninitialization?"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1488489747, "post_id": 42535990, "comment_id": 72266362, "body": "I&#39;m not sure how relevant this is to your scenario, but I discuss some possible workarounds <a href=\"http://stackoverflow.com/a/35833437/886887\">here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "edited": false, "score": 0, "creation_date": 1488463502, "post_id": 42557250, "comment_id": 72249398, "body": "Hm. I was, in fact, using a condition variable in the original code where I first encountered the issue. I only came up with the busy wait while working on an MRCE."}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "reply_to_user": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "edited": false, "score": 0, "creation_date": 1488463595, "post_id": 42557250, "comment_id": 72249470, "body": "@VioletGiraffe there is something weird in this, when I added more logging I actually noticed that the thread is not terminated in a gracefull manner, <code>join()</code> just returns and that is it. So I&#39;ll keep debugging."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1488489380, "post_id": 42557250, "comment_id": 72266145, "body": "It shouldn&#39;t matter what mechanism you use to wait for the thread; if the destructor is being run inside DllMain, you hold a lock that the thread needs in order to exit.  The only two relevant factors are whether the destructor is in fact being run inside DllMain and (if so) whether the thread had already exited by the time DllMain was started.  (I&#39;m not sure what the exact rules are for when a destructor is run inside DllMain.)"}], "tags": [], "owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "is_accepted": false, "score": 1, "last_activity_date": 1488466929, "last_edit_date": 1488466929, "creation_date": 1488462592, "answer_id": 42557250, "question_id": 42535990, "link": "https://stackoverflow.com/questions/42535990/worker-threads-are-forcibly-terminated-prior-to-the-destruction-of-static-object/42557250#42557250", "title": "Worker threads are forcibly terminated prior to the destruction of static objects in a DLL (but not .exe)?", "body": "<p>It seems that using a different synchronisation mechanism instead of a busy loop (<code>std::mutex</code> + <code>std::condition_variable</code>) eliminates this.</p>\n\n<p>The following example demonstrates both mechanisms:</p>\n\n<pre><code>#include \"thread-test-dll.h\"\n\n#include &lt;thread&gt;\n#include &lt;mutex&gt;\n#include &lt;condition_variable&gt;\n#include &lt;iostream&gt;\n//#define _BUSY_WAIT\n#ifdef _BUSY_WAIT\n#include &lt;atomic&gt;\n#endif\n\nclass foo\n{\npublic:\n    foo() \n#ifdef _BUSY_WAIT\n        : termination_requested_(false),\n        terminated_gracefully_(false)\n#endif\n    {\n        std::cout &lt;&lt; \"foo::foo()...\\n\";\n    }\n\n    void run()\n    {\n#define _USE_LAMBDA\n#ifdef _USE_LAMBDA\n        thread_ = std::thread([&amp;]() {\n            work();\n        });\n#else\n        thread_ = std::thread(&amp;foo::work, this);\n#endif\n    }\n\n    ~foo()\n    {\n        std::cout &lt;&lt; \"foo::~foo()...\\n\";\n        if (thread_.joinable())\n        {\n#ifdef _BUSY_WAIT\n            termination_requested_ = true;\n#else\n            condition_variable_.notify_all();\n#endif\n            thread_.join();\n            std::cout &lt;&lt; \"thread joined...\\n\";\n        }\n        else\n        {\n            std::cout &lt;&lt; \"thread was not joinable...\\n\";\n        }\n#ifdef _BUSY_WAIT\n        std::cout &lt;&lt; \"terminated_gracefully_ = \" &lt;&lt; terminated_gracefully_ &lt;&lt; \"\\n\";\n#endif\n    }\n\n    void work()\n    {\n#ifdef _BUSY_WAIT\n        while (!termination_requested_);\n        terminated_gracefully_ = true;\n#else\n        std::unique_lock&lt;std::mutex&gt; mutex_lock(mutex_);\n        condition_variable_.wait(mutex_lock);\n#endif\n        std::cout &lt;&lt; \"foo:work() terminating...\\n\";\n    }\n\nprivate:\n#ifdef _BUSY_WAIT\n    std::atomic&lt;bool&gt; termination_requested_;\n    std::atomic&lt;bool&gt; terminated_gracefully_;\n#endif\n    std::thread thread_;\n    std::mutex mutex_;\n    std::condition_variable condition_variable_;\n};\n\nstatic foo instance;\n\nvoid runThread()\n{\n    instance.run();\n}\n</code></pre>\n\n<p>But I'll still look into if I can make it hang with <code>std::atomic</code> since if that is the cause it is still a different issue than the one on calling <code>std::thread::join()</code> after <code>main</code> has exited.</p>\n"}], "owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1488466929, "creation_date": 1488382850, "question_id": 42535990, "link": "https://stackoverflow.com/questions/42535990/worker-threads-are-forcibly-terminated-prior-to-the-destruction-of-static-object", "title": "Worker threads are forcibly terminated prior to the destruction of static objects in a DLL (but not .exe)?", "body": "<p>Consider the following code. All of the following was compiled and executed in Visual Studio 2015 using the v140 C++ runtime:</p>\n\n<pre><code>#include &lt;thread&gt;\n#include &lt;atomic&gt;\n#include &lt;sstream&gt;\n\n#include &lt;Windows.h&gt;\n\nstruct StaticThreadTest\n{\n    ~StaticThreadTest()\n    {\n        _terminationRequested = true;\n        if (_thread.joinable())\n            _thread.join();\n\n        std::ostringstream ss;\n        ss &lt;&lt; \"Thread finished gracefully: \" &lt;&lt; _threadFinishedGracefully &lt;&lt; \"\\n\";\n        OutputDebugStringA(ss.str().c_str());\n    }\n\n    void startThread()\n    {\n        _thread = std::thread([&amp;]() {\n            while (!_terminationRequested);\n\n            _threadFinishedGracefully = true;\n        });\n    }\n\n    std::thread _thread;\n    std::atomic&lt;bool&gt; _terminationRequested {false};\n    std::atomic&lt;bool&gt; _threadFinishedGracefully {false};\n};\n\nstatic StaticThreadTest thread;\n\nint main()\n{\n    thread.startThread();\n\n    return 0;\n} \n</code></pre>\n\n<p>It works just as expected - \"Thread finished gracefully: 1\" is printed and the application exits.</p>\n\n<p>However, if I move this code to a DLL (create an empty DLL, export one function from it, place the <code>StaticThreadTest</code> object in the dll's .cpp, call <code>thread.startThread()</code> from the exported function and call this exported function from <code>main.cpp</code>), the code sometimes prints \"Thread finished gracefully: 0\", but more often than not it just hangs in <code>thread.join()</code>.</p>\n\n<p>Is this behavior documented? Is it a bug in the runtime or is this intended?</p>\n\n<p>Of note: the same code but compiled with the v120 toolset hangs 100% of the time even in <code>main.cpp</code> (in the exe). Seems as if there was a bug in the v120 toolset, and in v140 it is fixed for .exe but not for .dll.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1280, "user_id": 793519, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/3RBS2.jpg?s=128&g=1", "display_name": "vincent", "link": "https://stackoverflow.com/users/793519/vincent"}, "edited": false, "score": 2, "creation_date": 1488383280, "post_id": 42535980, "comment_id": 72207908, "body": "Base on your loop counter, how many numbers do you expect to see?"}, {"owner": {"reputation": 9, "user_id": 7642278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/201ecf8ee02fe11ab92c8078ef8bba79?s=128&d=identicon&r=PG&f=1", "display_name": "Kiyea Hei", "link": "https://stackoverflow.com/users/7642278/kiyea-hei"}, "reply_to_user": {"reputation": 1280, "user_id": 793519, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/3RBS2.jpg?s=128&g=1", "display_name": "vincent", "link": "https://stackoverflow.com/users/793519/vincent"}, "edited": false, "score": 0, "creation_date": 1488384519, "post_id": 42535980, "comment_id": 72208817, "body": "@vincent those loops were only meant to print the first column. To give you people an idea of what i&#39;m trying to do here."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1488386168, "post_id": 42535980, "comment_id": 72210017, "body": "If that is <i>all</i> you have been asked to do, what about <code>std::cout &lt;&lt; &quot;1\\n223\\n44365\\n8864910\\n44365\\n223\\n1\\n223\\n44365\\n8864910\\&zwnj;&#8203;n44365\\n223\\n1\\n&quot;;</code>"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1488386271, "post_id": 42535980, "comment_id": 72210072, "body": "Alternatively:  <code>static const int vals[] = {1,223,44365,8864910};</code> and then print out elements of that ."}], "answers": [{"comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1488387583, "post_id": 42537341, "comment_id": 72211003, "body": "Trouble is, I think the OP can&#39;t work out the formula (and neither can I)."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6076417"}, "is_accepted": false, "score": 0, "last_activity_date": 1488386993, "last_edit_date": 1488386993, "creation_date": 1488386672, "answer_id": 42537341, "question_id": 42535980, "link": "https://stackoverflow.com/questions/42535980/printing-number-pattern/42537341#42537341", "title": "Printing number pattern", "body": "<p>You need Nested loop. Think about formula to get patten, and do in your nested loop, like this</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n#include &lt;conio.h&gt;\nusing namespace std;\n\nint main(){\nint j, i, n=3;\nfor(j=0;j&lt;=n;j++)\n{ // YOU CAN ADD FORMULA\n    for(i=1;i&lt;=j;i++)\n        {\n            // YOU CAN ADD FORMULA\n        }\n        cout&lt;&lt;\"\\n\";\n}\n\nfor(j=0;j&lt;=n;j++)\n{ // YOU CAN ADD FORMULA\n\n    for(i=0;i&lt;=n-j;i++)\n        {\n           // YOU CAN ADD FORMULA\n        }\n        cout&lt;&lt;\"\\n\";\n}\n\ngetch();\nreturn 0;\n}\n</code></pre>\n\n<p>Improve by your self</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7649550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40001f6f454eef08dc32bcba4ecf24ff?s=128&d=identicon&r=PG&f=1", "display_name": "Helper", "link": "https://stackoverflow.com/users/7649550/helper"}, "is_accepted": false, "score": 2, "last_activity_date": 1488484400, "creation_date": 1488484400, "answer_id": 42564701, "question_id": 42535980, "link": "https://stackoverflow.com/questions/42535980/printing-number-pattern/42564701#42564701", "title": "Printing number pattern", "body": "<p><a href=\"https://i.stack.imgur.com/LO3Ml.jpg\" rel=\"nofollow noreferrer\">See image for the logic of the pattern</a></p>\n\n<p>thats basically the logic behind this pattern. once you make this, you can easily invert and then use nested loop to print it twice.</p>\n"}], "owner": {"reputation": 9, "user_id": 7642278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/201ecf8ee02fe11ab92c8078ef8bba79?s=128&d=identicon&r=PG&f=1", "display_name": "Kiyea Hei", "link": "https://stackoverflow.com/users/7642278/kiyea-hei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1488484400, "creation_date": 1488382836, "last_edit_date": 1488386346, "question_id": 42535980, "link": "https://stackoverflow.com/questions/42535980/printing-number-pattern", "title": "Printing number pattern", "body": "<p>I'm working on a c++ assignment and one of the questions requires me to print this pattern of numbers below:</p>\n\n<pre><code>1\n223\n44365\n8864910\n44365\n223\n1\n223\n44365\n8864910\n44365\n223\n1\n</code></pre>\n\n<p>I can see that the first column consists of squares if 2,and i can print it as:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cmath&gt;\nusing namespace std;\n\nint main(){\n  for (int i=0;i&lt;=3;i++){\n    cout&lt;&lt;pow(2,i)&lt;&lt;endl;\n  }\n  for (int i=2;i&gt;=0;i--){\n    cout&lt;&lt;pow(2,i)&lt;&lt;endl;\n  }\n  return 0;\n}\n</code></pre>\n\n<p>it gives me the output:</p>\n\n<pre><code>1\n2\n4\n8\n4\n2\n1\n</code></pre>\n\n<p>but I don't see the pattern the rest of the numbers correspond to. Any help?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1488382765, "post_id": 42535935, "comment_id": 72207491, "body": "Why are you using both <code>cin &gt;&gt; player1;</code> and <code>cin.getline(player1);</code>?"}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 1, "creation_date": 1488385860, "post_id": 42535935, "comment_id": 72209799, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/5838711/stdcin-in-input-with-spaces\">std::cin in input with spaces?</a>"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1488386568, "post_id": 42535935, "comment_id": 72210291, "body": "Post only real code, please."}], "answers": [{"comments": [{"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 1, "creation_date": 1488383730, "post_id": 42536038, "comment_id": 72208237, "body": "The second line won&#39;t even compile. There is no member function <code>std::istream::getline</code> which accepts a <code>std::string</code>. You have to use the non-member function. <code>getline(cin, player1)</code>"}, {"owner": {"reputation": 19, "user_id": 7593676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gDGEx.jpg?s=128&g=1", "display_name": "J.Zuber", "link": "https://stackoverflow.com/users/7593676/j-zuber"}, "reply_to_user": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1488393622, "post_id": 42536038, "comment_id": 72214687, "body": "@Benjamin Lindley thank you very much. However, when i try this it only gives me the last name for example. When i enter [Joshua Zuber] it returns only [Zuber]."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6899834"}, "is_accepted": false, "score": 0, "last_activity_date": 1488382964, "creation_date": 1488382964, "answer_id": 42536038, "question_id": 42535935, "link": "https://stackoverflow.com/questions/42535935/how-do-i-take-a-users-input-that-has-spaces-and-return-it-to-a-string/42536038#42536038", "title": "How do I take a users input that has spaces and return it to a string?", "body": "<p>The reason your behavior is happening is because of these 2 lines:</p>\n\n<pre><code>cin &gt;&gt; player1;\ncin.getline(player1);\n</code></pre>\n\n<p>In the first line, <code>cin</code> will ignore whitespace, and in the second one, it will not. So just remove the first line in the snippet above, and it should accept a name with spaces.</p>\n"}], "owner": {"reputation": 19, "user_id": 7593676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gDGEx.jpg?s=128&g=1", "display_name": "J.Zuber", "link": "https://stackoverflow.com/users/7593676/j-zuber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1488382964, "creation_date": 1488382706, "question_id": 42535935, "link": "https://stackoverflow.com/questions/42535935/how-do-i-take-a-users-input-that-has-spaces-and-return-it-to-a-string", "title": "How do I take a users input that has spaces and return it to a string?", "body": "<pre><code>/* Programmer: Joshua Zuber\n   Program Desc: This is a game that can keep track of players scores!\n   Program Name:  Score Tracker\n   Clean Compile Date: \n*/\n\n#include&lt;iostream&gt;\n#include&lt;string&gt;\n#include&lt;iomanip&gt;\n#include&lt;cstdlib&gt;\n#include&lt;ctime&gt;\n#include &lt;vector&gt;\n\n\n\nusing namespace std;\n\nint main()\n\n{\n\n    // Player Variables\n\n    string player1\n    string player2;\n    string player3;\n    string player4;\n    string player5;\n\n\n    // Variables\n    char again = 'y';\n    char menu1 = 'y';\n    int pNumb;\n\n    // Game Arrays\n    string player1G[] = \"\";\n    string player2G[] = \"\";\n    string player3G[] = \"\";\n    string player4G[] = \"\";\n    string player5G[] = \"\";\n\n    // Score Arrays\n    string player1S[] = \"\";\n    string player2S[] = \"\";\n    string player3S[] = \"\";\n    string player4S[] = \"\";\n    string player5S[] = \"\";\n\n\n\n\n    while (toupper(again) == 'Y')\n    {\n        cout &lt;&lt; \"Welcome to Score Tracker!\" &lt;&lt; \"\\n\\n\";\n\n\n        while (toupper(menu1) == 'Y')\n        {\n            cout &lt;&lt;  \"1. \"  &lt;&lt; player1 &lt;&lt; \"\\n\\n\";\n            cout &lt;&lt;  \"2. \"  &lt;&lt; player2 &lt;&lt; \"\\n\\n\";\n            cout &lt;&lt;  \"3. \"  &lt;&lt; player3 &lt;&lt; \"\\n\\n\";\n            cout &lt;&lt;  \"4. \"  &lt;&lt; player4 &lt;&lt; \"\\n\\n\";\n            cout &lt;&lt;  \"5. \"  &lt;&lt; player5 &lt;&lt; \"\\n\\n\";\n            cout &lt;&lt; \"Please select a player to add your favorite games and scores!\";\n            cin &gt;&gt; pNumb;\n            system(\"cls\");\n\n\n            if (pNumb == 1)\n            {\n                cout &lt;&lt; \"Please enter a name for player 1!\" &lt;&lt; \"\\n\\n\";\n                cin &gt;&gt; player1;\n                cin.getline(player1);\n                cout &lt;&lt; \"\\n\\n\" &lt;&lt; \"Would you like to return to menu? Y/N \" &lt;&lt; \"\\n\\n\";\n                     cin &gt;&gt; menu1 ; \n                     system(\"cls\");\n            }\n        }\n    }\n} \n</code></pre>\n\n<p>How do I take a users input that has spaces and return it to a string?\nI am trying to make a simple program that takes 5 users names and has them input their 3 favorite games but i am having trouble with just getting them to input their names for the menu.</p>\n"}, {"tags": ["c++", "xcode", "macos", "compiler-errors", "g++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488382408, "post_id": 42535792, "comment_id": 72207236, "body": "You cannot have more than one <code>main()</code> entry point in an executable."}, {"owner": {"reputation": 77, "user_id": 5665761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5b46ae7543be6208eb2ed87f011777f5?s=128&d=identicon&r=PG&f=1", "display_name": "mjfred", "link": "https://stackoverflow.com/users/5665761/mjfred"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488382650, "post_id": 42535792, "comment_id": 72207403, "body": "Ah, thanks! So what should I change in the second script to compile them simultaneously? By changing &#39;main&#39; to &#39;second&#39; for example, I can successfully compile them together, but only the code from the first script will run and print."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488382752, "post_id": 42535792, "comment_id": 72207479, "body": "If you cange the function name to <code>second()</code> you have to call it explicitely from the remaining <code>main()</code> function to run it. Don&#39;t forget to forward declare <code>second()</code> there."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 5665761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5b46ae7543be6208eb2ed87f011777f5?s=128&d=identicon&r=PG&f=1", "display_name": "mjfred", "link": "https://stackoverflow.com/users/5665761/mjfred"}, "edited": false, "score": 0, "creation_date": 1488382817, "post_id": 42535891, "comment_id": 72207536, "body": "Perfect, thank you! After changing &#39;main&#39; in secondFile, how then can I call it from the first script? Would I then only use <code>g++ -o main.cpp</code> or would I still use <code>g++ -o main.cpp secondFile.cpp</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6899834"}, "reply_to_user": {"reputation": 77, "user_id": 5665761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5b46ae7543be6208eb2ed87f011777f5?s=128&d=identicon&r=PG&f=1", "display_name": "mjfred", "link": "https://stackoverflow.com/users/5665761/mjfred"}, "edited": false, "score": 0, "creation_date": 1488383066, "post_id": 42535891, "comment_id": 72207748, "body": "For example, if your new function was called <code>func</code>, then go in your <code>main()</code> function, and at the end of it before the <code>return 0;</code>, add the line <code>func();</code>. For running this, use <code>g++ -o main.cpp secondFile.cpp exec_name</code>. In addition, you will have to forward declare the function <code>func</code>, before <code>main()</code>, with something like <code>int func();</code>. Last but not least, if you found this answer helpful, don&#39;t forget to mark it correct, so that it can help future users gain knowledge and not ask the same question multiple times!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6899834"}, "is_accepted": true, "score": 0, "last_activity_date": 1488382605, "creation_date": 1488382605, "answer_id": 42535891, "question_id": 42535792, "link": "https://stackoverflow.com/questions/42535792/duplicate-symbol-when-attempting-to-compile-two-cpp-files-from-xcode-in-ter/42535891#42535891", "title": "&quot;Duplicate symbol&quot; when attempting to compile two .cpp files (from XCode) in terminal (MacOSX)", "body": "<p>The reason for your error is simple. You have 2 <code>main()</code> functions. As you should know, in a C++ program, the function <code>main()</code> generally defines the entry point of a program. When each of the files are compiled together, and have their own <code>main()</code> function, the compiler gets confused and throws an error. To solve this, simply change the name of the <code>main()</code> function in one file, and call it from the other file, if you are planning to run them together.</p>\n"}], "owner": {"reputation": 77, "user_id": 5665761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5b46ae7543be6208eb2ed87f011777f5?s=128&d=identicon&r=PG&f=1", "display_name": "mjfred", "link": "https://stackoverflow.com/users/5665761/mjfred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 42535891, "answer_count": 1, "score": -1, "last_activity_date": 1488382605, "creation_date": 1488382333, "question_id": 42535792, "link": "https://stackoverflow.com/questions/42535792/duplicate-symbol-when-attempting-to-compile-two-cpp-files-from-xcode-in-ter", "title": "&quot;Duplicate symbol&quot; when attempting to compile two .cpp files (from XCode) in terminal (MacOSX)", "body": "<p>I have two .cpp files, main.cpp and secondFile.cpp:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    std::cout &lt;&lt; \"Hello, World!\\n\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"I was also able to add this line!\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>And</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    std::cout &lt;&lt; \"This was from the second file!\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>I have successfully run <code>g++ -o main.cpp main</code> and <code>g++ -o secondFile.cpp secondFile</code>, as well as run each of their corresponding executables. However when I attempt to compile them simultaneously into a single executable <code>g++ -o main.cpp secondFile.cpp bothScripts</code> or <code>clang++ main.cpp secondFile.cpp -o bothScripts</code> I receive the following error:</p>\n\n<p>\"duplicate symbol _main in:\n    /var/folders/49/38grlkzs44zcth3v_dw9m9dm0000gn/T/main-d43536.o\n    /var/folders/49/38grlkzs44zcth3v_dw9m9dm0000gn/T/secondfile-2bee63.o\nld: 1 duplicate symbol for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\"</p>\n\n<p>Clearly something is being loaded twice, but I am unsure whether this is a library (iostream), that I've named both sections 'main', or something else entirely. There are certainly questions similar to this already, but many are convoluted and not as fundamental for new C++ members (hence my question here).</p>\n\n<p>Context: My rationale is to practice building executables from multiple .cpp files. Is there a better way to go about this? (New to C++ but not to programming/code as a whole.)</p>\n"}, {"tags": ["c++", "multithreading", "openmp", "gmp"], "answers": [{"comments": [{"owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 0, "creation_date": 1488382685, "post_id": 42535802, "comment_id": 72207436, "body": "This increases memory requirements though, no? Since I need <code>n</code> &quot;copies&quot; of <code>x</code>, one per thread. Also, does this also mean I do not run the risk of two cores computing collatz for the same <code>x</code> at the same time?"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1488386571, "post_id": 42535802, "comment_id": 72210292, "body": "<code>private</code> variables are uninitialized, which would clearly be an issue in this code."}], "tags": [], "owner": {"reputation": 2448, "user_id": 623046, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/20820c7da6c7774f48091720a8cd355e?s=128&d=identicon&r=PG", "display_name": "Tim B", "link": "https://stackoverflow.com/users/623046/tim-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1488382359, "creation_date": 1488382359, "answer_id": 42535802, "question_id": 42535647, "link": "https://stackoverflow.com/questions/42535647/thread-safety-while-looping-with-openmp/42535802#42535802", "title": "Thread safety while looping with OpenMP", "body": "<p>You could well be right about collisions with <code>x</code>. You can mark <code>x</code> as private by:</p>\n\n<pre><code>#pragma omp parallel private(x)\n</code></pre>\n\n<p>This way each thread gets their own \"version\" of the variable <code>x</code>, which should make this thread-safe. By default, variables declared before a <code>#pragma omp parallel</code> are public, so there is one shared instance between all of the threads.</p>\n"}, {"comments": [{"owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 0, "creation_date": 1488382776, "post_id": 42535887, "comment_id": 72207498, "body": "Could you explain this a bit more, what does &quot;touching <code>x</code> with atomic instructions&quot; mean?"}, {"owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 0, "creation_date": 1488383079, "post_id": 42535887, "comment_id": 72207751, "body": "Attempting this yields me a <code>error: invalid operator for \u2018#pragma omp atomic\u2019 before \u2018;\u2019 token x++;</code> error."}, {"owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 0, "creation_date": 1488383191, "post_id": 42535887, "comment_id": 72207832, "body": "I guess this could work with <code>#pragma omp critical</code> instead, but then I wonder whether the overhead will make it a better solution when compared to making <code>x</code> private."}, {"owner": {"reputation": 367, "user_id": 7634537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf27226e6106402174481f80b9225cf?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian Kl&#246;tzl", "link": "https://stackoverflow.com/users/7634537/fabian-kl%c3%b6tzl"}, "reply_to_user": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 0, "creation_date": 1488383208, "post_id": 42535887, "comment_id": 72207844, "body": "Oh, wait. Your <code>x</code> is not a built-in type but something special. I guess OpenMP can&#39;t handle that."}, {"owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 0, "creation_date": 1488383253, "post_id": 42535887, "comment_id": 72207887, "body": "Exactly, <code>x</code> is of a non-standard type so atomic doesn&#39;t know how to handle it."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1488386497, "post_id": 42535887, "comment_id": 72210240, "body": "<code>#pragma omp critical</code> is incorrect! Even if it doesn&#39;t crash immediately. You use <code>x</code> in other unprotected parts of the code - they can see inconsistent states and even modify it concurrently."}], "tags": [], "owner": {"reputation": 367, "user_id": 7634537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf27226e6106402174481f80b9225cf?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian Kl&#246;tzl", "link": "https://stackoverflow.com/users/7634537/fabian-kl%c3%b6tzl"}, "is_accepted": false, "score": 0, "last_activity_date": 1488382856, "last_edit_date": 1488382856, "creation_date": 1488382592, "answer_id": 42535887, "question_id": 42535647, "link": "https://stackoverflow.com/questions/42535647/thread-safety-while-looping-with-openmp/42535887#42535887", "title": "Thread safety while looping with OpenMP", "body": "<p>You might want to touch <code>x</code> only with atomic instructions.</p>\n\n<pre><code>#pragma omp atomic\nx++;\n</code></pre>\n\n<p>This ensures that all threads see the same value of <code>x</code> without requires mutexes or other synchronization techniques.</p>\n"}, {"comments": [{"owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 0, "creation_date": 1488391219, "post_id": 42538553, "comment_id": 72213252, "body": "This defeats the purpose of using GMP though, no? Since the for loop will only run up to maximum value of <code>long</code>. I wanted to use a multiprecision library in order to not be constrained by variable size."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 0, "creation_date": 1488408135, "post_id": 42538553, "comment_id": 72222841, "body": "Well, it still uses GMP for the actual collatz run. For the sake of demonstration I added a sketch how you could manually do the worksharing based on GMP objects. You can start that one after the other finished with the first 2^63 numbers."}, {"owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 0, "creation_date": 1488459209, "post_id": 42538553, "comment_id": 72246370, "body": "Thank you for such a throughout and well written answer!"}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 5, "last_activity_date": 1488402749, "last_edit_date": 1488402749, "creation_date": 1488390384, "answer_id": 42538553, "question_id": 42535647, "link": "https://stackoverflow.com/questions/42535647/thread-safety-while-looping-with-openmp/42538553#42538553", "title": "Thread safety while looping with OpenMP", "body": "<p>I assume what you want to do is to check if the collatz conjecture holds for all numbers. The program you posted is wrong on many levels both serially and in parallel.</p>\n\n<pre><code>if (mpz_cmp_ui(x.get_mpz_t(), 1)) break;\n</code></pre>\n\n<p>Means that it will break when <code>x != 1</code>. If you replace it with the correct <code>0 == mpz_cmp_ui</code>, the code will just continue to test <code>2</code> over and over again. You have to have two variables anyway, one for the outer loop that represents what you want to check, and one for the inner loop performing the check. It's easier to get this right if you make a function for that:</p>\n\n<pre><code>void check_collatz(mpz_class n) {\n    while (n != 1) {\n        n = collatz(n);\n    }\n}\n\nint main() {\n    mpz_class x = 1;\n    while (true) {\n        std::cout &lt;&lt; x.get_str(10);\n        check_collatz(x);\n        x++;\n    }\n}\n</code></pre>\n\n<p>The <code>while (true)</code> loop is bad to reason about and parallelize, so let's just make an equivalent <code>for</code> loop:</p>\n\n<pre><code>for (mpz_class x = 1;; x++) {\n    check_collatz(x);\n}\n</code></pre>\n\n<p>Now, we can talk about <strong>parallelizing</strong> the code. The basis for OpenMP parallelizing is a <em>worksharing construct</em>. You cannot just slap <code>#pragma omp parallel</code> on a while loop. Fortunately you can easily mark certain canonical for loops with <code>#pragma omp parallel for</code>. For that, however, you cannot use <code>mpz_class</code> as a loop variable, and you must specify an end for the loop:</p>\n\n<pre><code>#pragma omp parallel for\nfor (long check = 1; check &lt;= std::numeric_limits&lt;long&gt;::max(); check++)\n{\n    check_collatz(check);\n}\n</code></pre>\n\n<p>Note that <code>check</code> is implicitly private, there is a copy for each thread working on it. Also OpenMP will take care of distributing the work [1 ... 2^63] among threads. When a thread calls <code>check_collatz</code> a new, private, <code>mpz_class</code> object will be created for it.</p>\n\n<p>Now, you might notice, that repeatedly creating a new <code>mpz_class</code> object in each loop iteration is costly (memory allocation). You can reuse that (by breaking <code>check_collatz</code> again) and creating a thread-private <code>mpz_class</code> working object. For this, you split the compound <code>parallel for</code> into separate <code>parallel</code> and <code>for</code> pragmas:</p>\n\n<pre><code>#include &lt;gmpxx.h&gt;\n#include &lt;iostream&gt;\n#include &lt;limits&gt;\n\n// Avoid copying objects by taking and modifying a reference\nvoid collatz(mpz_class&amp; n)\n{\n    if (mpz_odd_p(n.get_mpz_t()))\n    {\n        n *= 3;\n        n += 1;\n    }\n    else\n    {\n        n /= 2;\n    }\n}\n\nint main()\n{\n#pragma omp parallel\n    {\n        mpz_class x;\n#pragma omp for\n        for (long check = 1; check &lt;= std::numeric_limits&lt;long&gt;::max(); check++)\n        {\n            // Note: The structure of this fits perfectly in a for loop.\n            for (x = check; x != 1; collatz(x));\n        }\n    }\n}\n</code></pre>\n\n<p>Note that declaring <code>x</code> in the parallel region will make sure it is <strong>implicitly private and properly initialized</strong>. You should prefer that to declaring it outside and marking it <code>private</code>. This will often lead to confusion because explicitly <code>private</code> variables from outside scope are unitialized.</p>\n\n<p>You might complain that this only checks the first 2^63 numbers. Just let it run. This gives you enough time to master OpenMP to expert level and write your own custom worksharing for GMP objects.</p>\n\n<p>You were concerned about having extra objects for each thread. This is <strong>essential</strong> for good performance. You cannot solve this efficiently with locks/critical sections/atomics. You would have to protect each and every <strong>read and write</strong> to your only relevant variable. There would be no parallelism left.</p>\n\n<p>Note: The huge for loop will likely have a load imbalance. So some threads will probably finish a few centuries earlier than the others. You could fix that with  dynamic scheduling, or smaller static chunks.</p>\n\n<p>Edit: For academic sake, here is one idea how to implement the worksharing directly on GMP objects:</p>\n\n<pre><code>#pragma omp parallel\n    {\n        // Note this is not a \"parallel\" loop\n        // these are just separate loops on distinct strided \n        int nthreads = omp_num_threads();\n        mpz_class check = 1;\n        // we already checked those in the other program\n        check += std::numeric_limits&lt;long&gt;::max(); \n        check += omp_get_thread_num();\n        mpz_class x;\n        for (; ; check += nthreads)\n        {\n            // Note: The structure of this fits perfectly in a for loop.\n            for (x = check; x != 1; collatz(x));\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "accepted_answer_id": 42538553, "answer_count": 3, "score": 0, "last_activity_date": 1488402749, "creation_date": 1488381909, "last_edit_date": 1592644375, "question_id": 42535647, "link": "https://stackoverflow.com/questions/42535647/thread-safety-while-looping-with-openmp", "title": "Thread safety while looping with OpenMP", "body": "<p>I'm working on a small <a href=\"https://github.com/bemeurer/collatz\" rel=\"nofollow noreferrer\">Collatz conjecture calculator</a> using C++ and GMP, and I'm trying to implement parallelism on it using OpenMP, but I'm coming across issues regarding thread safety. As it stands, attempting to run the code will yield this:</p>\n<pre><code>*** Error in `./collatz': double free or corruption (fasttop): 0x0000000001140c40 ***\n*** Error in `./collatz': double free or corruption (fasttop): 0x00007f4d200008c0 ***\n[1]    28163 abort (core dumped)  ./collatz\n</code></pre>\n<p>This is the code to reproduce the behaviour.</p>\n<pre><code> #include &lt;iostream&gt;\n #include &lt;gmpxx.h&gt;\n \n mpz_class collatz(mpz_class n) {\n     if (mpz_odd_p(n.get_mpz_t())) {\n         n *= 3;\n         n += 1;\n     } else {\n         n /= 2;\n     }\n     return n;\n }\n \n int main() {\n     mpz_class x = 1;\n #pragma  omp parallel\n     while (true) {\n         //std::cout &lt;&lt; x.get_str(10);\n         while (true) {\n             if (mpz_cmp_ui(x.get_mpz_t(), 1)) break;\n             x = collatz(x);\n         }\n         x++;\n         //std::cout &lt;&lt; &quot; OK&quot; &lt;&lt; std::endl;\n     }\n }\n</code></pre>\n<p>Given that I did not get this error when I uncomment the outputs to screen, which are slow, I assume the issue at hand has to do with thread safety, and in particular with concurrent threads trying to increment <code>x</code> at the same time.</p>\n<p>Am I correct in my assumptions? How can I fix this and make it safe to run?</p>\n"}, {"tags": ["c++", "algorithm", "dictionary", "data-structures"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1488382174, "post_id": 42535624, "comment_id": 72207058, "body": "<i>&quot;I don&#39;t want to lock the map for erasing expired ones.&quot;</i> You could store the hashes that need to be erased in a separate container, and go through that locking the map only for single rease operations."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1488385789, "post_id": 42535624, "comment_id": 72209746, "body": "This is an extremely broad architecture question beyond the scope of a C++ programming problem."}, {"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1488468265, "post_id": 42535624, "comment_id": 72252969, "body": "How large is the session state anyway? Counts in the billions would seem to call for external storage, and frequently rather different performance trade-offs and algorithms than would be suitable for RAM."}], "answers": [{"tags": [], "owner": {"reputation": 371, "user_id": 4931938, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206656018498800/picture?type=large", "display_name": "Dimitri Bosteels", "link": "https://stackoverflow.com/users/4931938/dimitri-bosteels"}, "is_accepted": false, "score": 1, "last_activity_date": 1488382444, "creation_date": 1488382444, "answer_id": 42535835, "question_id": 42535624, "link": "https://stackoverflow.com/questions/42535624/whats-the-most-efficient-data-structure-for-store-huge-number-of-sessions/42535835#42535835", "title": "What&#39;s the most efficient data structure for store huge number of sessions?", "body": "<p>I don't think a map is really the best collection. With what you said in mind, I would go for a Set (an unordered one if you don't need an order). As you will never have 2 times the same Session they will all be different, and you don't really need an association which a map offers, or I didn't understand your problem correctly.</p>\n"}, {"tags": [], "owner": {"reputation": 4581, "user_id": 2791577, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rFnoU.png?s=128&g=1", "display_name": "keith", "link": "https://stackoverflow.com/users/2791577/keith"}, "is_accepted": false, "score": 2, "last_activity_date": 1488388975, "last_edit_date": 1488388975, "creation_date": 1488382553, "answer_id": 42535875, "question_id": 42535624, "link": "https://stackoverflow.com/questions/42535624/whats-the-most-efficient-data-structure-for-store-huge-number-of-sessions/42535875#42535875", "title": "What&#39;s the most efficient data structure for store huge number of sessions?", "body": "<p>Using a data structure is probably too simple if you have a very high number of sessions, you will need a slightly different approach.</p>\n\n<p>Look into storing session data in Redis or another key value store. This would be more normal for servers with high load. Redis and most others offer persistence and don't have locking issues if you need to clear things out in the background.</p>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 1, "last_activity_date": 1488391546, "last_edit_date": 1488391546, "creation_date": 1488390959, "answer_id": 42538722, "question_id": 42535624, "link": "https://stackoverflow.com/questions/42535624/whats-the-most-efficient-data-structure-for-store-huge-number-of-sessions/42538722#42538722", "title": "What&#39;s the most efficient data structure for store huge number of sessions?", "body": "<p>Simple solution: use a hash table. When you are searching a bucket for an entry, delete any expired sessions you come across. This is almost free, since you are searching the chain anyway. It doesn't guarantee that sessions will be deleted immediately on expiry, but it is highly probable that the chain containing an expired session will be searched not long afterwards.</p>\n\n<p>You should presize the hashtable to a fixed number of buckets representing what you expect to be the capacity of the server. That avoids the need to rehash, and that means that each bucket chain can be independently locked. You don't need a lock for every chain, though; you can use the same lock for several -- even many -- chains. Choose a number of locks sufficient that your expected lock contention will be low under peak request pressure; you can compute a good number based on the number of simultaneously active handler threads you have. A chain search will take very little time if the chain is memory-resident, so it will almost always complete before a context-switch. So \"simultaneously active\" means that they are actually mapped to a CPU and running, not  just mapped to a kernel process. So with even a small vector of locks, you should be able to reduce bucket chain contention to a very low level.</p>\n"}, {"comments": [{"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1488890191, "post_id": 42559268, "comment_id": 72423095, "body": "Downvoter? It&#39;s customary to provide a reason for the downvote."}, {"owner": {"reputation": 10390, "user_id": 596370, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8571b5b8d990c5ed1220f78cc3b55c49?s=128&d=identicon&r=PG", "display_name": "rashok", "link": "https://stackoverflow.com/users/596370/rashok"}, "edited": false, "score": 0, "creation_date": 1540273952, "post_id": 42559268, "comment_id": 92792326, "body": "This is the perfect solution which I am planning to use."}], "tags": [], "owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "is_accepted": false, "score": 0, "last_activity_date": 1488468052, "creation_date": 1488468052, "answer_id": 42559268, "question_id": 42535624, "link": "https://stackoverflow.com/questions/42535624/whats-the-most-efficient-data-structure-for-store-huge-number-of-sessions/42559268#42559268", "title": "What&#39;s the most efficient data structure for store huge number of sessions?", "body": "<p>One way to handle this is to create a hash map to hold the sessions, and a MRU (most recently used) list. The MRU list is implemented as a doubly-linked list. Whenever a user accesses the site, his session is moved back to the top of the MRU list. Also, whenever a session is created, the system checks the last item in the MRU list to see if the oldest session has expired, so that you can delete it.</p>\n\n<p>Or, you could delete all of the expired sessions at the end of the list.</p>\n\n<p>In addition, you'll want to have your lookup code delete an expired session if it hasn't already been deleted.</p>\n\n<p>So, when you get a request, the sequence of events looks something like this:</p>\n\n<pre><code>session = get session info from user token\nif no session\n    create session\n    add to front of MRU list\nelse if session has expired\n    delete from mru list\n    remove from hash map\nelse // session has not expired\n    move session to front of MRU list\nend\n\n// delete expired sessions\np = last item in MRU list\nwhile p has expired\n    prev = p-&gt;prev\n    remove from MRU list\n    delete from hash map\n    p = prev\nend\n</code></pre>\n\n<p>If you're worried that cleaning up expired sessions will lock your hash map for too long, set a limit on the number of expired sessions you'll remove at any one time. If you set it to only clean up two expired sessions when a new session is added, you'll minimize the amount of time your data structure is locked, and expired sessions won't linger too long.</p>\n"}], "owner": {"reputation": 476, "user_id": 1211764, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2f8a6dc39f706fb5baf124308e73aa3e?s=128&d=identicon&r=PG", "display_name": "bugs king", "link": "https://stackoverflow.com/users/1211764/bugs-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1488468052, "creation_date": 1488381853, "question_id": 42535624, "link": "https://stackoverflow.com/questions/42535624/whats-the-most-efficient-data-structure-for-store-huge-number-of-sessions", "title": "What&#39;s the most efficient data structure for store huge number of sessions?", "body": "<p>For every client, the server creates a session for that specific client. A session has a expire time of 1 day. So that will end up with up to billion of sessions.</p>\n\n<p>Suppose I use a hash map, then look up will be fast when a client communicates with server. However, I need to erase those expired sessions, for example once an hour. During the erase, then it may take some time due to the huge number, and this will cause server not being able to handle communication from the client.</p>\n\n<p>So are there any high performance solution for this? i.e. I don't want to lock the map for erasing expired ones.</p>\n"}, {"tags": ["c++", "smart-pointers", "vtk"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4810516, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2ZhEYRNw4vo/AAAAAAAAAAI/AAAAAAAAAD0/VaO8F6hDpww/photo.jpg?sz=128", "display_name": "bdan629", "link": "https://stackoverflow.com/users/4810516/bdan629"}, "edited": false, "score": 0, "creation_date": 1488471394, "post_id": 42555030, "comment_id": 72255162, "body": "Thank you for the help.  This definitely filled the gaps in my understanding."}, {"owner": {"reputation": 656, "user_id": 1662174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fab9acb74f92aafd9675fc2d9dc2b624?s=128&d=identicon&r=PG", "display_name": "mirni", "link": "https://stackoverflow.com/users/1662174/mirni"}, "reply_to_user": {"reputation": 27, "user_id": 4810516, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2ZhEYRNw4vo/AAAAAAAAAAI/AAAAAAAAAD0/VaO8F6hDpww/photo.jpg?sz=128", "display_name": "bdan629", "link": "https://stackoverflow.com/users/4810516/bdan629"}, "edited": false, "score": 0, "creation_date": 1488562414, "post_id": 42555030, "comment_id": 72302575, "body": "Glad it was of use :)"}], "tags": [], "owner": {"reputation": 656, "user_id": 1662174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fab9acb74f92aafd9675fc2d9dc2b624?s=128&d=identicon&r=PG", "display_name": "mirni", "link": "https://stackoverflow.com/users/1662174/mirni"}, "is_accepted": true, "score": 1, "last_activity_date": 1488456247, "creation_date": 1488456247, "answer_id": 42555030, "question_id": 42535600, "link": "https://stackoverflow.com/questions/42535600/array-of-vtksmartpointers/42555030#42555030", "title": "Array of vtkSmartPointers", "body": "<p>vtkSmartPointers are meant to be passed around (copied), and you can as well create an array, or much better a container (e.g. std::vector) of them. </p>\n\n<pre><code>typedef vtkSmartPointer&lt;vtkMRMLLinearTransformNode&gt; NodePtr;\n\nNodePtr CreateNode() {\n  NodePtr node = NodePtr::New();\n  node-&gt;ApplyTransform(xfm);\n  return node;\n}\n\nstd::vector&lt;NodePtr&gt; nodes;\nfor (int i = 0; i &lt; nNodes; ++i) {\n   nodes.push_back(CreateNode());\n}\n</code></pre>\n\n<p>In the same intuitive way you can return a vector of smartpointers from a function, or pass it as an argument to another function.</p>\n\n<p>The only dangerous thing is to expose the raw pointer from underneath the vtkSmartPointer when returning from a function. Always return a smartpointer (just like CreateNode() example above).</p>\n\n<pre><code>vtkMRMLLinearTransformNode* BadFooWillCrash() {\n   NodePtr node = NodePtr::New();\n   // do something with node\n\n   // the smart pointer will go out of scope and the object will be deleted!\n   return node;\n}\n</code></pre>\n\n<p>Taking a raw pointer as an argument is quite alright.</p>\n\n<pre><code>void WorkNode(vtkMRMLLinearTransformNode* node) {\n   // do something with node\n}\n\nNodePtr newNode = NodePtr::New();\nWorkNode(newNode); \n</code></pre>\n\n<p>Just as well you may pass a smartpointer as an argument</p>\n\n<pre><code>void WorkNode2(NodePtr node) {\n   // do something with node\n}\n</code></pre>\n\n<p>This is because in vtk the reference counter is kept inside the object itself, so the pointee object knows how many pointers point to it (you can try GetReferenceCount() method). The drawback is that the objects to be managed by vtkSmartPointer must be derived from vtkObject.</p>\n\n<p>Some more info you can find here\n<a href=\"http://www.vtk.org/Wiki/VTK/Tutorials/SmartPointers\" rel=\"nofollow noreferrer\">http://www.vtk.org/Wiki/VTK/Tutorials/SmartPointers</a></p>\n"}], "owner": {"reputation": 27, "user_id": 4810516, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2ZhEYRNw4vo/AAAAAAAAAAI/AAAAAAAAAD0/VaO8F6hDpww/photo.jpg?sz=128", "display_name": "bdan629", "link": "https://stackoverflow.com/users/4810516/bdan629"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 0, "accepted_answer_id": 42555030, "answer_count": 1, "score": 0, "last_activity_date": 1516866143, "creation_date": 1488381788, "last_edit_date": 1516866143, "question_id": 42535600, "link": "https://stackoverflow.com/questions/42535600/array-of-vtksmartpointers", "title": "Array of vtkSmartPointers", "body": "<p>Writing a program in C++. I have a function which creates several <code>vtkSmartPointers</code> as follows:</p>\n\n<pre><code>vtkSmartPointer&lt; vtkMRMLLinearTransformNode &gt; transformNode =\n  vtkSmartPointer&lt; vtkMRMLLinearTransformNode &gt;::New();\nvtkSmartPointer&lt; vtkMRMLLinearTransformNode &gt; transformNode2 =\n  vtkSmartPointer&lt; vtkMRMLLinearTransformNode &gt;::New();\n</code></pre>\n\n<p>Outside of this function I want to have a global array or vector of <code>vtkMRMLLinearTransformNodes</code> which I can add <code>transformNode</code> and <code>transformNode2</code> to. So that later in the code I can access them in another function.</p>\n\n<p>I am having trouble understanding how I would do this. It is beyond my level of expertise in pointers. Can anyone help me out? A little explanation would also help me fill the gap in my understanding of <code>vtkSmartPointers</code>.</p>\n"}, {"tags": ["c++", "c++11", "destructor", "copy-constructor", "unique-ptr"], "comments": [{"owner": {"reputation": 2933, "user_id": 6350858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfeae5d1ddef3ed5e81e88bdd30063f?s=128&d=identicon&r=PG&f=1", "display_name": "Ap31", "link": "https://stackoverflow.com/users/6350858/ap31"}, "edited": false, "score": 0, "creation_date": 1488382409, "post_id": 42535584, "comment_id": 72207238, "body": "<a href=\"https://godbolt.org/g/rFoUWi\" rel=\"nofollow noreferrer\">godbolt.org/g/rFoUWi</a> - clang 3.9.1 does behaves that way here"}, {"owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1488382597, "post_id": 42535584, "comment_id": 72207370, "body": "Also with clang:  Error(s):  source_file.cpp:27:12: error: call to implicitly-deleted copy constructor of &#39;Ship&#39;     return tmp;..."}, {"owner": {"reputation": 2933, "user_id": 6350858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfeae5d1ddef3ed5e81e88bdd30063f?s=128&d=identicon&r=PG&f=1", "display_name": "Ap31", "link": "https://stackoverflow.com/users/6350858/ap31"}, "edited": false, "score": 0, "creation_date": 1488382731, "post_id": 42535584, "comment_id": 72207463, "body": "yes, all 4 compilers say that the copy constructor is implicitly deleted when you define a destructor"}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "edited": false, "score": 0, "creation_date": 1488382781, "post_id": 42535584, "comment_id": 72207501, "body": "This is due to <code>unique_ptr</code>. <code>unique_ptr</code> cannot be copied thus the implicit copy constructor is declared deleted."}], "answers": [{"comments": [{"owner": {"reputation": 34061, "user_id": 616460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yiloe.png?s=128&g=1", "display_name": "Jason C", "link": "https://stackoverflow.com/users/616460/jason-c"}, "edited": false, "score": 0, "creation_date": 1488382757, "post_id": 42535828, "comment_id": 72207483, "body": "Re your afaik: buildShip returning a value doesn&#39;t imply the need for an explicit copy constructor. It&#39;s not a special case, it&#39;s the same deal as anything else, the implicit one may be fine, or it may not, but that doesn&#39;t depend on buildShip. It does use <i>a</i> copy constructor, but doesn&#39;t necessarily require an <i>explicit</i> one."}], "tags": [], "owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "is_accepted": false, "score": 0, "last_activity_date": 1488382759, "last_edit_date": 1488382759, "creation_date": 1488382430, "answer_id": 42535828, "question_id": 42535584, "link": "https://stackoverflow.com/questions/42535584/why-does-the-insertion-of-user-defined-destructor-require-an-user-defined-copy-c/42535828#42535828", "title": "Why does the insertion of user defined destructor require an user defined copy constructor", "body": "<p>The idea is that, if the compiler-generated destructor is not good enough for your class, then chances are the copy constructor and copy assignment operator are also not good enough, so the compiler <em>may</em> delete the implicit implementations of those copy operations.  Technically, the compiler may still give you implicit copy operations even if you have a user-defined destructor, but that behavior is deprecated in c++11.</p>\n\n<p>See <a href=\"https://en.wikipedia.org/wiki/Rule_of_three_(C%2B%2B_programming)\" rel=\"nofollow noreferrer\">Rule of Three</a></p>\n\n<p>AFAIK, you still need a copy constructor because <code>buildShip()</code> returns by value.</p>\n\n<p>(However, it's interesting that you are able to compile the versions that use an implicit copy constructor.  You shouldn't be able to do that because of the <code>unique_ptr</code> member...)</p>\n"}, {"comments": [{"owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1488383628, "post_id": 42536007, "comment_id": 72208151, "body": "Just for making sure that I understand it: Including the user defined destructor prevents the compiler from auto generating a move operator. Because the move operator is missing, return of the buildShip function tries to copy the tmp Ship, thereby calling the default copy constructor, which then tries to copy the tmp, and thereby the unique_ptr, which produces an error. Right?"}, {"owner": {"reputation": 3808, "user_id": 1597714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/mH9hv.png?s=128&g=1", "display_name": "AMA", "link": "https://stackoverflow.com/users/1597714/ama"}, "reply_to_user": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1488383840, "post_id": 42536007, "comment_id": 72208327, "body": "yes, line <code>return tmp;</code> tries to use a copy ctor of <code>Ship</code> which is explicitly deleted because of the <code>unique_ptr</code> member."}, {"owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1488446311, "post_id": 42536007, "comment_id": 72237638, "body": "Thanks @AMA great  answer again! Like you already provided for my previous <a href=\"http://stackoverflow.com/questions/42491544/c-how-to-avoid-access-of-members-of-a-object-that-was-not-yet-initialized\">question</a>."}], "tags": [], "owner": {"reputation": 3808, "user_id": 1597714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/mH9hv.png?s=128&g=1", "display_name": "AMA", "link": "https://stackoverflow.com/users/1597714/ama"}, "is_accepted": true, "score": 11, "last_activity_date": 1488383212, "last_edit_date": 1495535390, "creation_date": 1488382895, "answer_id": 42536007, "question_id": 42535584, "link": "https://stackoverflow.com/questions/42535584/why-does-the-insertion-of-user-defined-destructor-require-an-user-defined-copy-c/42536007#42536007", "title": "Why does the insertion of user defined destructor require an user defined copy constructor", "body": "<p>The code gets compiled because <code>buildShip()</code> would use the move constructor automatically generated by the compiler when returning <code>tmp</code>. Adding user-declared destructor prevents the compiler from auto-generating one. E.g., see <a href=\"https://stackoverflow.com/questions/29289956/c11-virtual-destructors-and-auto-generation-of-move-special-functions\">this</a> or <a href=\"https://stackoverflow.com/questions/33932824/why-does-destructor-disable-generation-of-implicit-move-methods\">this</a> questions. And the compiler-generated copy constructor can not be used because of the member <code>up</code> which is <code>std::unique_ptr</code>. And copy constuctor of <code>unique_ptr</code> is explicitly deleted.</p>\n\n<p>So this will compile, because the compiler is explicitly asked to generate the move constructor:</p>\n\n<pre><code>class Ship\n{\npublic:\n    Ship(){}\n    Ship(Ship&amp;&amp;) = default;\n    ~Ship(){}\n    std::unique_ptr&lt;container&gt; up;\n};\n</code></pre>\n"}], "owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 42536007, "answer_count": 2, "score": 3, "last_activity_date": 1488383212, "creation_date": 1488381748, "last_edit_date": 1488382568, "question_id": 42535584, "link": "https://stackoverflow.com/questions/42535584/why-does-the-insertion-of-user-defined-destructor-require-an-user-defined-copy-c", "title": "Why does the insertion of user defined destructor require an user defined copy constructor", "body": "<p>The following code compiles:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\nusing namespace std;\n\nclass container\n{\npublic:\n    container(){}\n    ~container(){}\n};\n\nclass Ship\n{\npublic:\n    Ship(){}\n    //Ship(const Ship &amp; other){cout&lt;&lt;\"COPY\"&lt;&lt;endl;}\n    //~Ship(){}\n\n    std::unique_ptr&lt;container&gt; up;\n};\n\nShip buildShip()\n{\n    Ship tmp;\n    return tmp;\n}\n\nint main(int argc, char *argv[])\n{\n    return 0;\n}\n</code></pre>\n\n<p>But if we include the user defined destructor <code>~Ship(){}</code>, the code will only compile if we also include the user defined copy constructor <code>Ship(const Ship &amp; other){cout&lt;&lt;\"COPY\"&lt;&lt;endl;}</code></p>\n\n<p>In short:  </p>\n\n<p>Compiles:</p>\n\n<pre><code>Ship(){}\n//Ship(const Ship &amp; other){cout&lt;&lt;\"COPY\"&lt;&lt;endl;}\n//~Ship(){}\n</code></pre>\n\n<p>Compiles:</p>\n\n<pre><code>Ship(){}\nShip(const Ship &amp; other){cout&lt;&lt;\"COPY\"&lt;&lt;endl;}\n~Ship(){}\n</code></pre>\n\n<p>Does NOT Compile:</p>\n\n<pre><code>Ship(){}\n//Ship(const Ship &amp; other){cout&lt;&lt;\"COPY\"&lt;&lt;endl;}\n~Ship(){}\n</code></pre>\n\n<p>Why does the insertion of user defined destructor require an user defined copy constructor and why do we need a copy constructor in the above example at all? </p>\n\n<p>I would expect that there is no copy constructor needed in the example above, as unique_ptr can not even be copied.</p>\n"}, {"tags": ["c++", "opencv", "vector"], "comments": [{"owner": {"reputation": 256, "user_id": 2206013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07cade7ed9cb6146f56ee74b2dea405c?s=128&d=identicon&r=PG", "display_name": "ZeroUltimax", "link": "https://stackoverflow.com/users/2206013/zeroultimax"}, "edited": false, "score": 0, "creation_date": 1488386849, "post_id": 42535583, "comment_id": 72210523, "body": "What part of your algorithm does your profiler indicate consumes the most time?"}, {"owner": {"reputation": 5320, "user_id": 4480180, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1970535e346ac19a4642c5ac27c97998?s=128&d=identicon&r=PG&f=1", "display_name": "justHelloWorld", "link": "https://stackoverflow.com/users/4480180/justhelloworld"}, "reply_to_user": {"reputation": 256, "user_id": 2206013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07cade7ed9cb6146f56ee74b2dea405c?s=128&d=identicon&r=PG", "display_name": "ZeroUltimax", "link": "https://stackoverflow.com/users/2206013/zeroultimax"}, "edited": false, "score": 0, "creation_date": 1488388513, "post_id": 42535583, "comment_id": 72211613, "body": "I didn&#39;t profile it, but it&#39;s good practice to avoid to operate on single elements and prefer specific functions which operates on the whole vector/array/data structure, don&#39;t you think?"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1488395703, "post_id": 42535583, "comment_id": 72215930, "body": "Did you miss a <code>abs</code>? <code>std::sqrt(std::abs(val))</code> ?"}, {"owner": {"reputation": 5320, "user_id": 4480180, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1970535e346ac19a4642c5ac27c97998?s=128&d=identicon&r=PG&f=1", "display_name": "justHelloWorld", "link": "https://stackoverflow.com/users/4480180/justhelloworld"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1488450609, "post_id": 42535583, "comment_id": 72240614, "body": "@Miki oh gosh I did :D However, operating element looks so inefficient to me."}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1488452848, "post_id": 42535583, "comment_id": 72242077, "body": "I made a couple of tests yesterday.. both were something like 2x faster then your approach, but the speed up make sense only for something like 10000 rows. I think that your descriptors are much less, so in practice there&#39;s no difference. Are you still interested in those?"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1488452948, "post_id": 42535583, "comment_id": 72242149, "body": "Surf are 64 floats, right? Or 128? I forgot ;)"}, {"owner": {"reputation": 5320, "user_id": 4480180, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1970535e346ac19a4642c5ac27c97998?s=128&d=identicon&r=PG&f=1", "display_name": "justHelloWorld", "link": "https://stackoverflow.com/users/4480180/justhelloworld"}, "edited": false, "score": 0, "creation_date": 1488453125, "post_id": 42535583, "comment_id": 72242263, "body": "64! No, because it would mean 10k descriptors per image, which are <b>really</b> too many! However describing 5k images takes around 120s and 4s for this normalization (called RootSURF). I guess that we can achieve some improvement by parallelize it."}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1488455639, "post_id": 42535583, "comment_id": 72243916, "body": "I agree, that&#39;s why I haven&#39;t posted an answer. Can&#39;t you parallelize on image basis?"}], "owner": {"reputation": 5320, "user_id": 4480180, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1970535e346ac19a4642c5ac27c97998?s=128&d=identicon&r=PG&f=1", "display_name": "justHelloWorld", "link": "https://stackoverflow.com/users/4480180/justhelloworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488381747, "creation_date": 1488381747, "question_id": 42535583, "link": "https://stackoverflow.com/questions/42535583/efficiently-perform-a-signed-square-root-on-a-l1-normalized-opencv-descriptor", "title": "Efficiently perform a signed square root on a L1 normalized OpenCV descriptor", "body": "<p>I have matrix where each row is a SURF descriptor in 64 dimensions. For each row, I need to:</p>\n\n<ol>\n<li>L1 normalize it</li>\n<li>For each element, compute its signed square root</li>\n</ol>\n\n<p>The only way that I came out with this is:</p>\n\n<pre><code>template &lt;typename T&gt; int sgn(T val) {\n    return (T(0) &lt; val) - (val &lt; T(0));\n}\n\nvoid SURFOpenCV::ComputeDescriptors(cv::Mat &amp;img, cv::Mat1f &amp;descriptors){\n    descriptors.release();\n    std::vector&lt;cv::KeyPoint&gt; pts;\n    surf-&gt;detectAndCompute(img, cv::Mat(), pts, descriptors);\n    //if there is at least one keypoint\n    if(pts.size()){\n        // For each row\n        for (int i = 0; i &lt; descriptors.rows; ++i) {\n            // Perform L1 normalization on the whole descriptor\n            cv::normalize(descriptors.row(i), descriptors.row(i), 1.0, 0.0, cv::NORM_L1);\n            for (int j = 0; j&lt;descriptors.cols; j++) {\n                float val = descriptors.at&lt;float&gt;(i,j);\n                descriptors.at&lt;float&gt;(i,j) = sgn(val) * std::sqrt(val);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>But since <strong>performance are crucial</strong>, this looks kinda inefficient to me. Any better (faster) solution?</p>\n"}, {"tags": ["c++", "winapi"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 3, "creation_date": 1488381677, "post_id": 42535318, "comment_id": 72206676, "body": "Check the return value of <code>MoveFile</code> and when you see it says that it failed, use <code>GetLastError</code> to find out why."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1488388198, "post_id": 42535318, "comment_id": 72211438, "body": "Per the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365239.aspx\" rel=\"nofollow noreferrer\"><code>MoveFile()</code></a> documentation: &quot;<i><code>lpNewFileName</code> [in] The new name for the file or directory. <b>The new name must not already exist</b>. A new file may be on a different file system or drive. A new directory must be on the same drive.</i>&quot; Does the <code>test2</code> directory already exist?  Consider using <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb762164.aspx\" rel=\"nofollow noreferrer\"><code>SHFileOperation()</code></a> or <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb775771.aspx\" rel=\"nofollow noreferrer\"><code>IFileOperation</code></a> instead of <code>MoveFile()</code>."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1488395992, "post_id": 42535318, "comment_id": 72216110, "body": "If these are both directories then what you hope to happen won&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1488386326, "post_id": 42535960, "comment_id": 72210129, "body": "<code>GetLastErrorAsString()</code> leaks memory in case the <code>std::string</code> c&#39;tor raises an exception. It also calls <code>GetLastError()</code> tenuously late. A better implementation has been published in <a href=\"http://stackoverflow.com/documentation/winapi/2573/error-reporting-and-handling/9378/\">this documentation topic</a>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1488388304, "post_id": 42535960, "comment_id": 72211495, "body": "Also, writing to <code>std::cout</code> may indirectly cause <code>GetLastError()</code> to reset.  It is meaningless to call <code>GetLastError()</code> if <code>MoveFile()</code> succeeds. You must call <code>GetLastError()</code> only if <code>MoveFile()</code> fails, and must do so before any other Win32 API functions are called, eg: <code>if (!MoveFile(input1.c_str(), input2.c_str())) { string msg = GetLastErrorAsString(); cout &lt;&lt; &quot;fail: &quot; &lt;&lt; msg &lt;&lt; endl; } else { cout &lt;&lt; &quot;ok&quot; &lt;&lt; endl; }</code>"}, {"owner": {"reputation": 904, "user_id": 6717168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b475396cbf62745254210e11d7b3846?s=128&d=identicon&r=PG", "display_name": "user", "link": "https://stackoverflow.com/users/6717168/user"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1488390698, "post_id": 42535960, "comment_id": 72212934, "body": "@RemyLebeau Thank you for pointing this out, I edited the answer with it"}, {"owner": {"reputation": 904, "user_id": 6717168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b475396cbf62745254210e11d7b3846?s=128&d=identicon&r=PG", "display_name": "user", "link": "https://stackoverflow.com/users/6717168/user"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1488390831, "post_id": 42535960, "comment_id": 72213014, "body": "@IInspectable Good point, I&#39;ve looked at your link and will definitely update this answer (and my own GetLastError function) with it (but very likely this will be tomorrow)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1488394235, "post_id": 42535960, "comment_id": 72215019, "body": "I would have used a simple <code>std::vector</code> or even a fixed-size array instead of <code>std::unique_ptr</code> with a custom deleter. You don&#39;t have to let <code>FormatMessage()</code> allocate the buffer memory. But if you do, you can <a href=\"http://stackoverflow.com/a/15067510/65863\">use <code>LocalFree()</code> directly as the deleter</a> (even on Windows 10, despite the warning in the documentation). You don&#39;t need to use a lambda to delegate to <code>HeapFree()</code>."}], "tags": [], "owner": {"reputation": 904, "user_id": 6717168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b475396cbf62745254210e11d7b3846?s=128&d=identicon&r=PG", "display_name": "user", "link": "https://stackoverflow.com/users/6717168/user"}, "is_accepted": false, "score": 2, "last_activity_date": 1488390668, "last_edit_date": 1488390668, "creation_date": 1488382774, "answer_id": 42535960, "question_id": 42535318, "link": "https://stackoverflow.com/questions/42535318/moving-files-from-one-directory-into-another/42535960#42535960", "title": "Moving files from one directory into another", "body": "<pre><code>std::string GetLastErrorAsString()\n{\n    //Get the error message, if any.\n    DWORD errorMessageID = ::GetLastError();\n    if (errorMessageID == 0)\n        return std::string(); //No error message has been recorded\n\n    LPSTR messageBuffer = nullptr;\n    size_t size = FormatMessageA(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL, errorMessageID, MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), (LPSTR)&amp;messageBuffer, 0, NULL);\n\n    std::string message(messageBuffer, size);\n\n    //Free the buffer.\n    LocalFree(messageBuffer);\n\n    return message;\n}\nint main()\n{\n    string input1 = \"C:\\\\test1\\\\\";\n    string input2 = \"C:\\\\test2\\\\\";\n    if (!MoveFile(input1.c_str(), input2.c_str()))\n    {\n        string msg = GetLastErrorAsString(); \n        cout &lt;&lt; \"fail: \" &lt;&lt; msg &lt;&lt; endl;\n    }\n    else {\n        cout &lt;&lt; \"ok\" &lt;&lt; endl;\n    }\n    system(\"pause\");\n}\n</code></pre>\n\n<p>Your code works for me, you may have to set the character set to <code>use multi-byte character set</code> in your project properties.\nIf not, provide us with the error.\nCheck if you have the write rights on C:.\nCheck if there already is a <code>test2</code> folder in C: (or if there is not a <code>test1</code> folder in C:).</p>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 7635248, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b4c5235b670027ed48ce17b06b1a880a?s=128&d=identicon&r=PG&f=1", "display_name": "Robbie J", "link": "https://stackoverflow.com/users/7635248/robbie-j"}, "is_accepted": false, "score": 1, "last_activity_date": 1488452182, "creation_date": 1488452182, "answer_id": 42553476, "question_id": 42535318, "link": "https://stackoverflow.com/questions/42535318/moving-files-from-one-directory-into-another/42553476#42553476", "title": "Moving files from one directory into another", "body": "<p>I resovled the issue by removing the \\\\ from test2. Folder test 2 doesn't exist. Thank you for the replies and the test code. I think SHFileOperation will be a better option as I have to transfer files from a floppy to my C drive.                                                                                   string input1 = \"C:\\\\test1\\\\\";\n       string input2 = \"C:\\\\test2\";</p>\n"}], "owner": {"reputation": 69, "user_id": 7635248, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b4c5235b670027ed48ce17b06b1a880a?s=128&d=identicon&r=PG&f=1", "display_name": "Robbie J", "link": "https://stackoverflow.com/users/7635248/robbie-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8268, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1488452182, "creation_date": 1488381038, "last_edit_date": 1488385349, "question_id": 42535318, "link": "https://stackoverflow.com/questions/42535318/moving-files-from-one-directory-into-another", "title": "Moving files from one directory into another", "body": "<p>I would like to copy all files from test1 into test2. The code compiles but nothing happens.     </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;windows.h&gt;\n\nusing namespace std;\n\nint main()\n{\n    string input1 = \"C:\\\\test1\\\\\";\n    string input2 = \"C:\\\\test2\\\\\";\n    MoveFile(input1.c_str(), input2.c_str());\n}\n</code></pre>\n\n<p>I was considering xcopy but it would not accept a pre defined string. Is there a work around?</p>\n"}, {"tags": ["c++", "omnet++", "inet"], "comments": [{"owner": {"reputation": 881, "user_id": 7468409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab57b2e3e39875d76d335efce70e1129?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Kirsche", "link": "https://stackoverflow.com/users/7468409/michael-kirsche"}, "edited": false, "score": 0, "creation_date": 1488530610, "post_id": 42535280, "comment_id": 72281508, "body": "Can you elaborate a bit more about your scenario? You are using the IdealMAC and the IdealWirelessNic I assume?"}], "owner": {"reputation": 380, "user_id": 5546467, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-xJ2yavjQS3Q/AAAAAAAAAAI/AAAAAAAAADM/JJt22RHRLCc/photo.jpg?sz=128", "display_name": "rebrid", "link": "https://stackoverflow.com/users/5546467/rebrid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 453, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1549078833, "creation_date": 1488380915, "last_edit_date": 1549078833, "question_id": 42535280, "link": "https://stackoverflow.com/questions/42535280/how-to-detect-collisions-at-receiver-in-omnet-and-inet-framework", "title": "How to detect collisions at receiver in OMNeT++ and INET Framework", "body": "<p>I am trying to understand the behavior of Radio.cc (in inet/physicallayer/common/packetlevel/).</p>\n\n<p>In particular I want to know how it can detect collisions.</p>\n\n<p>I would expect something like:</p>\n\n<pre><code>if(radio==IDLE and newFrame arrives){\n    radio = RECEIVING;\n    startReception();\n}\nelse\n   if(radio==RECEIVING and newFrame arrives)\n      impossible to receive --&gt; COLLISION! --&gt; stop()\n</code></pre>\n\n<p>But for what I have seen, if two frames arrive at the receiver at the same time, the reception of the first one is '<em>Reception started: ignored</em>' and the second is passed to the MAC layer, which says '<em>contains bit errors or collision, dropping it</em>' (IdealMac).</p>\n\n<p>My question is, shouldn't the receiver block both frames (because it cannot receive two at the same time) or pass both of them to the upper MAC layer, which then reads them as erroneous frames?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1488380819, "post_id": 42535163, "comment_id": 72205943, "body": "Development time may be faster if you use a simple <code>for</code> loop."}, {"owner": {"reputation": 212, "user_id": 6881791, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b48ea546905ef3c14ffc721d54f7eec?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Imbs", "link": "https://stackoverflow.com/users/6881791/xavier-imbs"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1488380850, "post_id": 42535163, "comment_id": 72205973, "body": "I think I&#39;ll get fired if I do that: I need to do this quite a few times."}, {"owner": {"reputation": 818, "user_id": 7095889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28dd263cb10743a750eff5b85bb91bd5?s=128&d=identicon&r=PG&f=1", "display_name": "Yuriy Ivaskevych", "link": "https://stackoverflow.com/users/7095889/yuriy-ivaskevych"}, "edited": false, "score": 2, "creation_date": 1488381097, "post_id": 42535163, "comment_id": 72206165, "body": "Last parameter for <a href=\"http://en.cppreference.com/w/cpp/algorithm/find\" rel=\"nofollow noreferrer\"><code>std::find_if_not</code></a> should be an unary predicate - you can use lambda."}], "answers": [{"comments": [{"owner": {"reputation": 212, "user_id": 6881791, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b48ea546905ef3c14ffc721d54f7eec?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Imbs", "link": "https://stackoverflow.com/users/6881791/xavier-imbs"}, "edited": false, "score": 1, "creation_date": 1488381177, "post_id": 42535333, "comment_id": 72206237, "body": "<code>v.size() - 1</code> is evaluated in unsigned arithmetic. Not good if the vector is empty."}, {"owner": {"reputation": 6654, "user_id": 111143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yhf9U.jpg?s=128&g=1", "display_name": "Tommy Andersen", "link": "https://stackoverflow.com/users/111143/tommy-andersen"}, "reply_to_user": {"reputation": 212, "user_id": 6881791, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b48ea546905ef3c14ffc721d54f7eec?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Imbs", "link": "https://stackoverflow.com/users/6881791/xavier-imbs"}, "edited": false, "score": 0, "creation_date": 1488381253, "post_id": 42535333, "comment_id": 72206310, "body": "@XavierImbs I do not think it does ( <a href=\"http://ideone.com/uuw5PC\" rel=\"nofollow noreferrer\">ideone.com/uuw5PC</a> ) but added cast to clarify."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1488381409, "post_id": 42535333, "comment_id": 72206435, "body": "Now you limit the supported size of vector by half. Also <code>v.at(i) != 0</code> is not good for doubles."}, {"owner": {"reputation": 6654, "user_id": 111143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yhf9U.jpg?s=128&g=1", "display_name": "Tommy Andersen", "link": "https://stackoverflow.com/users/111143/tommy-andersen"}, "reply_to_user": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1488381528, "post_id": 42535333, "comment_id": 72206549, "body": "@luk32 For simplicity I used <code>int</code>."}, {"owner": {"reputation": 212, "user_id": 6881791, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b48ea546905ef3c14ffc721d54f7eec?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Imbs", "link": "https://stackoverflow.com/users/6881791/xavier-imbs"}, "edited": false, "score": 3, "creation_date": 1488381932, "post_id": 42535333, "comment_id": 72206869, "body": "!= 0 is fine for doubles, if you know what you are doing."}], "tags": [], "owner": {"reputation": 6654, "user_id": 111143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yhf9U.jpg?s=128&g=1", "display_name": "Tommy Andersen", "link": "https://stackoverflow.com/users/111143/tommy-andersen"}, "is_accepted": false, "score": 0, "last_activity_date": 1488381239, "last_edit_date": 1488381239, "creation_date": 1488381100, "answer_id": 42535333, "question_id": 42535163, "link": "https://stackoverflow.com/questions/42535163/find-the-last-non-zero-element-in-a-stdvector/42535333#42535333", "title": "Find the last non-zero element in a std::vector", "body": "<p>A simple <code>for</code> loop can also do the trick, see live sample: <a href=\"http://ideone.com/dVNOKk\" rel=\"nofollow noreferrer\">http://ideone.com/dVNOKk</a></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nint main() {\n    std::vector&lt;int&gt; v{1, 2, 3, 4, 1, 2, 3, 0, 4, 1, 2, 3, 4, 0, 0, 0};\n\n    for (int i = static_cast&lt;int&gt;(v.size()) - 1; i &gt;= 0; --i) {\n        if (v.at(i) != 0) {\n            std::cout &lt;&lt; \"Last non-zero at: \" &lt;&lt; i &lt;&lt; '\\n';\n            break;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output: <code>Last non-zero at: 12</code></p>\n"}, {"comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1488381694, "post_id": 42535428, "comment_id": 72206695, "body": "Some explanations of the code would be useful, that&#39;s why I downvoted."}, {"owner": {"reputation": 212, "user_id": 6881791, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b48ea546905ef3c14ffc721d54f7eec?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Imbs", "link": "https://stackoverflow.com/users/6881791/xavier-imbs"}, "edited": false, "score": 1, "creation_date": 1488381742, "post_id": 42535428, "comment_id": 72206725, "body": "For me it is useful as it is. Thank you. (The only thing I don&#39;t like is the comparison to std::numeric_limits&lt;double&gt;::epsilon())."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488381953, "post_id": 42535428, "comment_id": 72206884, "body": "Do you really understand why he uses <code>return std::fabs(v - 0) &gt; std::numeric_limits&lt;double&gt;::epsilon()</code> instead of just <code>return v != 0</code> ? You may, but other people looking at the code may not..."}, {"owner": {"reputation": 212, "user_id": 6881791, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b48ea546905ef3c14ffc721d54f7eec?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Imbs", "link": "https://stackoverflow.com/users/6881791/xavier-imbs"}, "edited": false, "score": 0, "creation_date": 1488382064, "post_id": 42535428, "comment_id": 72206973, "body": "Using epsilon is infact an arbitrary and in fact a poor choice. But the main part of the answer is useful to me."}, {"owner": {"reputation": 44381, "user_id": 471160, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/9Z23A.jpg?s=128&g=1", "display_name": "marcinj", "link": "https://stackoverflow.com/users/471160/marcinj"}, "edited": false, "score": 0, "creation_date": 1488382314, "post_id": 42535428, "comment_id": 72207171, "body": "I have added some comment on epsilon compare, actually epsilon() might  not be what OP wants, and some other value would be better as it depends on what values are present in this vector."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 212, "user_id": 6881791, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b48ea546905ef3c14ffc721d54f7eec?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Imbs", "link": "https://stackoverflow.com/users/6881791/xavier-imbs"}, "edited": false, "score": 0, "creation_date": 1488382351, "post_id": 42535428, "comment_id": 72207194, "body": "@XavierImbs on the other hand, without context, epsilon isn&#39;t any more arbitrary or a poor choice than 1e-8 or 0. (But yeah, introducing a new tolerance in the answer might lead a reader to interpret it as something that is &quot;better&quot;, when they&#39;re all arbitrary)."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1488382882, "post_id": 42535428, "comment_id": 72207584, "body": "I still don&#39;t understand <code>fabs(v - 0)</code>. Why is it better than <code>fabs(v)</code> ?"}, {"owner": {"reputation": 212, "user_id": 6881791, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b48ea546905ef3c14ffc721d54f7eec?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Imbs", "link": "https://stackoverflow.com/users/6881791/xavier-imbs"}, "edited": false, "score": 0, "creation_date": 1488382956, "post_id": 42535428, "comment_id": 72207644, "body": "Other than the fact that the answerer is explicitly centring the comparison about 0, there isn&#39;t."}, {"owner": {"reputation": 44381, "user_id": 471160, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/9Z23A.jpg?s=128&g=1", "display_name": "marcinj", "link": "https://stackoverflow.com/users/471160/marcinj"}, "edited": false, "score": 0, "creation_date": 1488383293, "post_id": 42535428, "comment_id": 72207918, "body": "yes this <code>- 0</code> is not needed, at least for the case as in question."}], "tags": [], "owner": {"reputation": 44381, "user_id": 471160, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/9Z23A.jpg?s=128&g=1", "display_name": "marcinj", "link": "https://stackoverflow.com/users/471160/marcinj"}, "is_accepted": true, "score": 9, "last_activity_date": 1488382092, "last_edit_date": 1488382092, "creation_date": 1488381336, "answer_id": 42535428, "question_id": 42535163, "link": "https://stackoverflow.com/questions/42535163/find-the-last-non-zero-element-in-a-stdvector/42535428#42535428", "title": "Find the last non-zero element in a std::vector", "body": "<p>Example:</p>\n\n<pre><code>std::vector&lt;double&gt; v{1.32, 1.423, 2.543, 3.534, 4.2, 0};\n\nauto result1 = std::find_if(std::rbegin(v), std::rend(v), [](auto&amp; v) { return std::fabs(v - 0) &gt; std::numeric_limits&lt;double&gt;::epsilon(); } );\nif (result1 != std::rend(v)) {\n    std::cout &lt;&lt; *result1 &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; std::distance(std::begin(v), (result1 + 1).base());\n}\n</code></pre>\n\n<p>outputs:</p>\n\n<pre><code>4.2\n4\n</code></pre>\n\n<p>[edit]</p>\n\n<p>more explanation on:</p>\n\n<pre><code>std::fabs(v - 0) &gt; std::numeric_limits&lt;double&gt;::epsilon(); }\n</code></pre>\n\n<p>in OP question there was:</p>\n\n<blockquote>\n  <p>Also, is there a way I can introduce a predicate to compare on, say a tolerance of 1e-8?</p>\n</blockquote>\n\n<p>so this is such tolerance check, you can replace <code>epsilon</code> use with some other value.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1488381902, "last_edit_date": 1488381902, "creation_date": 1488381390, "answer_id": 42535447, "question_id": 42535163, "link": "https://stackoverflow.com/questions/42535163/find-the-last-non-zero-element-in-a-stdvector/42535447#42535447", "title": "Find the last non-zero element in a std::vector", "body": "<blockquote>\n  <p>but I'm having difficulty in combining this with std::distance and a forward iterator amounts.begin()</p>\n</blockquote>\n\n<p>Reverse iterators have member function <code>base</code> that returns a non-reverse iterator with the relation <code>&amp;*(rit.base() - 1) == &amp;*rit</code>. So, you can use the following:</p>\n\n<pre><code> std::distance(amounts.begin(), found.base()) - 1;\n</code></pre>\n\n<p>Another option:</p>\n\n<pre><code> amounts.size() - std::distance(amounts.rbegin(), found) - 1\n</code></pre>\n\n<blockquote>\n  <p>Also, is there a way I can introduce a predicate to compare on, say a tolerance of 1e-8?</p>\n</blockquote>\n\n<p>Yes. In fact, you must use a predicate, even for the exact comparison, since that's what <code>std::find_if_not</code> expects as the third parameter (instead of value of an element).</p>\n"}], "owner": {"reputation": 212, "user_id": 6881791, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b48ea546905ef3c14ffc721d54f7eec?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Imbs", "link": "https://stackoverflow.com/users/6881791/xavier-imbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2073, "favorite_count": 1, "accepted_answer_id": 42535428, "answer_count": 3, "score": 2, "last_activity_date": 1488382092, "creation_date": 1488380626, "question_id": 42535163, "link": "https://stackoverflow.com/questions/42535163/find-the-last-non-zero-element-in-a-stdvector", "title": "Find the last non-zero element in a std::vector", "body": "<p>I'm trying to find the index of the last non-zero element in a <code>std::vector&lt;double&gt;</code>. If the last element in the vector is non-zero then it should return the index of that last element.</p>\n\n<p>I believe I can use <code>std::find_if_not</code>, <em>reverse</em> iterators and <code>std::distance</code>, based on this:</p>\n\n<p><code>std::find_if_not(amounts.rbegin(), amounts.rend(), 0.0)</code></p>\n\n<p>where <code>amounts</code> is a <code>std::vector&lt;double&gt;</code>, but I'm having difficulty in combining this with <code>std::distance</code> and a forward iterator <code>amounts.begin()</code>.</p>\n\n<p>Also, is there a way I can introduce a predicate to compare on, say a tolerance of 1e-8?</p>\n\n<p>I'm using C++11.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1488383559, "post_id": 42535154, "comment_id": 72208105, "body": "&quot;<i>I understand that move constructor is not generated even if any other constructor is written by the programmer</i>&quot; That&#39;s not true. Only the presence of copy constructors/assignment prevents the generation of move constructors."}, {"owner": {"reputation": 1474, "user_id": 6483824, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3fc10ff38e7bf1b5a7b5e62399016ccb?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/6483824/mike"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1488385576, "post_id": 42535154, "comment_id": 72209580, "body": "@NicolBolas thanks, I looked up item 17 in Effective Modern C++, and also move construcor/assignment operator and destructor prevents generation of move constructor or assignment operator."}], "answers": [{"comments": [{"owner": {"reputation": 1474, "user_id": 6483824, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3fc10ff38e7bf1b5a7b5e62399016ccb?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/6483824/mike"}, "edited": false, "score": 0, "creation_date": 1488452949, "post_id": 42536756, "comment_id": 72242150, "body": "thank you, I am reading now item 27 from Effective Modern C++ which deals with ways on how to avoid problems with universal (or now forwarding) reference constructors. Too bad Scott Meyers is not going deep into SFINAE."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 5, "last_activity_date": 1488384964, "creation_date": 1488384964, "answer_id": 42536756, "question_id": 42535154, "link": "https://stackoverflow.com/questions/42535154/why-compilers-generate-a-copy-move-constructors-when-there-is-a-templated-constr/42536756#42536756", "title": "Why compilers generate a copy/move constructors when there is a templated constructor?", "body": "<p>You understand wrong.</p>\n\n<pre><code>struct noisy {\n  noisy() { std::cout &lt;&lt; \"ctor()\\n\"; }\n  noisy(noisy&amp;&amp;) { std::cout &lt;&lt; \"ctor(&amp;&amp;)\\n\"; }\n  noisy(noisy const&amp;) { std::cout &lt;&lt; \"ctor(const&amp;)\\n\"; }\n  noisy&amp; operator=(noisy&amp;&amp;) { std::cout &lt;&lt; \"asgn(&amp;&amp;)\\n\"; return *this; }\n  noisy&amp; operator=(noisy const&amp;) { std::cout &lt;&lt; \"asgn(const&amp;)\\n\"; return *this; }\n};\n\nstruct test {\n  noisy n;\n  test(int x) { (void)x; }\n};\n</code></pre>\n\n<p><code>test</code> has generated move/copy construct/assignment.</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/fef25824692fa06b\" rel=\"noreferrer\">Live example</a>.</p>\n\n<p>A copy/move construct/assignment written by a programmer results in the other ones being suppressed.</p>\n\n<p>Now, writing a constructor suppresses the zero-argument constructor.  That may be why you are confused.</p>\n\n<hr>\n\n<p>Templated constructors with the same signature as copy constructors are not copy constructors because the standard says so.</p>\n\n<p>As it happens, templated code is rarely the correct code for a copy or move constructor/assignment.</p>\n\n<p>The fact that forwarding references often grab <code>self&amp;</code> and <code>self const&amp;&amp;</code> copy/move over the actual copy/move operations is a problem.  C++ isn't perfect.</p>\n\n<p>Usually the way to avoid this is:</p>\n\n<pre><code>template&lt;class T,\n  class=std::enable_if_t&lt;\n    !std::is_same&lt;std::decay_t&lt;T&gt;, Person&gt;::value\n  &gt;\n&gt;\nPerson(T&amp;&amp; t) : s(std::forward&lt;T&gt;(t)) {\n  std::cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>or <code>!std::is_base_of&lt;Person, std::decay_t&lt;T&gt;&gt;::value</code> which covers some other situations (like inheriting constructors).</p>\n"}], "owner": {"reputation": 1474, "user_id": 6483824, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3fc10ff38e7bf1b5a7b5e62399016ccb?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/6483824/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "accepted_answer_id": 42536756, "answer_count": 1, "score": 3, "last_activity_date": 1488384964, "creation_date": 1488380601, "last_edit_date": 1495540433, "question_id": 42535154, "link": "https://stackoverflow.com/questions/42535154/why-compilers-generate-a-copy-move-constructors-when-there-is-a-templated-constr", "title": "Why compilers generate a copy/move constructors when there is a templated constructor?", "body": "<p>Mechanism for this is well explained here: <a href=\"https://stackoverflow.com/questions/24832143/template-copy-constructor-does-not-prevent-compiler-generated-move-constructor\">Template &quot;copy constructor&quot; does not prevent compiler-generated move constructor</a>, but I would like to better undestand why it is made this way. I understand that move constructor is not generated even if any other constructor is written by the programmer, because it is an indication that construction of object is non trivial and auto generated constructor will probably be wrong. Then why templated constructors that have the same signature as copy constructors are not simply named copy constructors?</p>\n\n<p>Example:</p>\n\n<pre><code>class Person {\n public:\n  template&lt;typename T&gt;\n    Person(T&amp;&amp; t) : s(std::forward&lt;T&gt;(t)) {\n      std::cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; \"\\n\";\n    }\n\n  Person(int n) {\n    std::cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; \"\\n\";\n  }\n\n  // No need to declare copy/move constructors as compiler will do this implicitly\n  // Templated constructor does not inhibit it.\n  //Person(const Person&amp;) = default;\n  //Person(Person&amp;&amp;) = default;\n\n private:\n  std::string s;\n};\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code>Person p(\"asd\");        // OK!\n//Person p4(p);         // error as Person(T&amp;&amp;) is a better match\n</code></pre>\n\n<p>if I make <code>p</code> const:</p>\n\n<pre><code>const Person p(\"asd\");\nPerson p4(p);           // thats ok, generator constructor is a better match\n</code></pre>\n\n<p>but if I explicitly delete even a move constructor with:</p>\n\n<pre><code>Person(Person&amp;&amp;) = delete;\n</code></pre>\n\n<p>then auto generation of constructors is inhibited.</p>\n"}, {"tags": ["c++", "sdl", "sdl-2"], "comments": [{"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1488456028, "post_id": 42535126, "comment_id": 72244214, "body": "It should be <code>while</code>, not <code>if</code>. But yes, on almost every case you have to respond to platform-specific messages (which SDL internally does when it generates event queue) or window system will not update or even ask user&#39;s permission to kill application that isn&#39;t responding to its signals."}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 7524370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff7b24c1a8d9c0fd7d9ddab534514cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Johan Eriksson", "link": "https://stackoverflow.com/users/7524370/johan-eriksson"}, "is_accepted": false, "score": 3, "last_activity_date": 1488405856, "creation_date": 1488405856, "answer_id": 42542990, "question_id": 42535126, "link": "https://stackoverflow.com/questions/42535126/what-does-sdl-pollevent-do/42542990#42542990", "title": "What does SDL_PollEvent do?", "body": "<p>We do not need to handle all events, some SDL will take care of for us. Events related to the window properties will be taken care of automatically. In order to resize a window, you will have to add the flag SDL_WINDOW_RESIZABLE when creating the window. While SDL will take care of the actual resizing of the window, it might still require some event handling as the surface will have a different size to paint at, it will not automatically resize any images we try to draw in it. </p>\n\n<p>While I have not found an answer in the documentation to <em>why</em> SDL_PollEvent behave as you describe above, or if this is behavior is intended, it works slightly different on different systems. At osx it is possible to move the window without the above function, but the X for closing will not be displayed. By adding the function again, the window can be moved, minimized and closed properly.</p>\n\n<p>According to <a href=\"https://wiki.libsdl.org/SDL_PollEvent\" rel=\"nofollow noreferrer\">documentation</a>, SDL_PollEvent is meant to do what you describe, look if there are any events and retrieve them. </p>\n"}, {"tags": [], "owner": {"reputation": 1927, "user_id": 740696, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8e6b6f969d3e9ca3197876b78a5d3747?s=128&d=identicon&r=PG", "display_name": "Casper Beyer", "link": "https://stackoverflow.com/users/740696/casper-beyer"}, "is_accepted": false, "score": 2, "last_activity_date": 1488797478, "last_edit_date": 1488797478, "creation_date": 1488692684, "answer_id": 42604970, "question_id": 42535126, "link": "https://stackoverflow.com/questions/42535126/what-does-sdl-pollevent-do/42604970#42604970", "title": "What does SDL_PollEvent do?", "body": "<p>Events are not happening right now, they have already occurred in the past, you are getting notifications that they did occur in the order they occured.</p>\n\n<p>The frozen window is a side effect of an implementation detail, set appropriate flags to enable/disable window properties and functionality like resizing, fullscreen, etc.</p>\n\n<p><code>SDL_PollEvent</code> calls <code>SDL_PumpEvents</code>, removes the first event in the stack and copies it into the pointer given.</p>\n\n<p><code>SDL_PumpEvents</code> calls into the operating system's event processing API and transforms platform events into SDL_Events, pushing them onto the SDL event stack.</p>\n\n<p>Now the reason windows are frozen on some platforms is that, that is how that platform event loop works, unless you \"pump\" its event loop it will be considered an unresponsive window and the window manager will want to kill it and its process.</p>\n"}], "owner": {"reputation": 8566, "user_id": 3591953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/23cc49b10dd8c521a3d16365a5beff97?s=128&d=identicon&r=PG&f=1", "display_name": "g_b", "link": "https://stackoverflow.com/users/3591953/g-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1200, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1488797478, "creation_date": 1488380509, "question_id": 42535126, "link": "https://stackoverflow.com/questions/42535126/what-does-sdl-pollevent-do", "title": "What does SDL_PollEvent do?", "body": "<p>I am reading an introductory book code about SDL and there is sample code like this:</p>\n\n<pre><code>void Game::handleEvents()\n{\n    SDL_Event event;\n    if (SDL_PollEvent(&amp;event))\n    {\n        switch (event.type)\n        {\n        case SDL_QUIT:\n            m_bRunning = false;\n            break;\n        default:\n            break;\n        }\n    }\n}\n</code></pre>\n\n<p>I understand that this will look into the event queue and if there is anything, retrieve it and the run it to the switch statement. Before I added this code, the window was displayed but you cannot drag or drop, close, or resize the window. Now that I added this code, I can close the window which was what I expected. What I didn't expect was I am able to drag and drop the window.</p>\n\n<p>I thought this would be a separate event that I would need to include in the switch statement in the future. Why did drag and drop also work? Its the SDL_PollEvent (because I commented the switch statement but left the 'if', I was still able to drag) but why is that? Also, why only drag and drop was automatically functional? Why not resize?</p>\n"}, {"tags": ["c++", "arrays", "sfml"], "comments": [{"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 2, "creation_date": 1488380468, "post_id": 42535062, "comment_id": 72205691, "body": "Search for <code>std::vector</code>."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 3, "creation_date": 1488381073, "post_id": 42535062, "comment_id": 72206149, "body": "Why are you making a game when you haven&#39;t mastered the basics of C++?"}, {"owner": {"reputation": 3618, "user_id": 3316645, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bootU.png?s=128&g=1", "display_name": "domsson", "link": "https://stackoverflow.com/users/3316645/domsson"}, "edited": false, "score": 0, "creation_date": 1488381118, "post_id": 42535062, "comment_id": 72206181, "body": "<a href=\"http://en.cppreference.com/w/cpp/container\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container</a>"}, {"owner": {"reputation": 1096, "user_id": 4477125, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JYZmH.jpg?s=128&g=1", "display_name": "Lorence Hernandez", "link": "https://stackoverflow.com/users/4477125/lorence-hernandez"}, "edited": false, "score": 0, "creation_date": 1488381883, "post_id": 42535062, "comment_id": 72206828, "body": "just be sure not to store sf::Texture object directly in a vector as it is not a lightweight object :)"}], "answers": [{"tags": [], "owner": {"reputation": 60876, "user_id": 2060725, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WUKmO.png?s=128&g=1", "display_name": "nvoigt", "link": "https://stackoverflow.com/users/2060725/nvoigt"}, "is_accepted": false, "score": 0, "last_activity_date": 1488455483, "creation_date": 1488455483, "answer_id": 42554745, "question_id": 42535062, "link": "https://stackoverflow.com/questions/42535062/sfml-put-all-objects-in-array/42554745#42554745", "title": "sfml - put all objects in array", "body": "<p>You could use a container from the standard library, the most basic one is the <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector&lt;&gt;</code></a>. <code>sf::Texture</code>objects are heavy objects that should not be needlessly copied around. You should keep them in one place and only <em>reference</em> them when needed.</p>\n\n<pre><code>std::vector&lt;sf::Sprite*&gt; sprites;\nstd::vector&lt;sf::Texture*&gt; textures;\n\nvoid CreateTile(const std::string&amp; file, const sf::Vector2f&amp; position)\n{\n    sf::Texture* texture = new sf::Texture();\n    texture-&gt;loadFromFile(file);\n\n    textures-&gt;push_back(texture);\n\n    sf::Sprite* tile = new sf::Sprite();\n    tile-&gt;setTexture(*texture);\n    tile-&gt;setPosition(position);\n\n    sprites-&gt;push_back(tile);\n}\n</code></pre>\n\n<p>And as this aims to be modern C++, you should <strong>not</strong> use raw pointers like above. Use <em>smart</em> pointers like <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow noreferrer\"><code>std::shared_ptr</code></a>.</p>\n\n<p><strong>Warning:</strong> The solution will not be to just copy this code and hope it somehow works. Get a good book on the basics of C++ and read it cover to cover. There is no shortcuts. You need to learn the language if you want to code a game.</p>\n"}], "owner": {"reputation": 47, "user_id": 4724252, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-8sakZ5fdsg8/AAAAAAAAAAI/AAAAAAAAAXU/wOGYAgb8MBk/photo.jpg?sz=128", "display_name": "nelsoncookie 23", "link": "https://stackoverflow.com/users/4724252/nelsoncookie-23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1488455483, "creation_date": 1488380391, "question_id": 42535062, "link": "https://stackoverflow.com/questions/42535062/sfml-put-all-objects-in-array", "title": "sfml - put all objects in array", "body": "<p>i'm working on a game and want that when i create an object it gets added to an array (so it's easier to draw and maybe\nchange coords and stuff).\nI only don't know how to do it.\nIf it helps here is my function:</p>\n\n<pre><code>void CreateTile(string Texture, sf::Vector2f Pos)\n{\n    sf::Texture texture;\n    texture.loadFromFile(Texture);\n    sf::Sprite Tile;\n    Tile.setTexture(texture);\n    Tile.setPosition(Pos);\n}\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++", "c++11", "unions", "list-initialization"], "answers": [{"comments": [{"owner": {"reputation": 7339, "user_id": 741988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8724aa47446c1ed0516acd4c1f642bd5?s=128&d=identicon&r=PG", "display_name": "BTownTKD", "link": "https://stackoverflow.com/users/741988/btowntkd"}, "edited": false, "score": 0, "creation_date": 1488380538, "post_id": 42535090, "comment_id": 72205734, "body": "That&#39;s a bummer.  Is there a simple way to initialize the full union to zero?  Or is &#39;memset&#39; the only way?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 7339, "user_id": 741988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8724aa47446c1ed0516acd4c1f642bd5?s=128&d=identicon&r=PG", "display_name": "BTownTKD", "link": "https://stackoverflow.com/users/741988/btowntkd"}, "edited": false, "score": 3, "creation_date": 1488380631, "post_id": 42535090, "comment_id": 72205809, "body": "@BTownTKD Put the largest member first?"}, {"owner": {"reputation": 7339, "user_id": 741988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8724aa47446c1ed0516acd4c1f642bd5?s=128&d=identicon&r=PG", "display_name": "BTownTKD", "link": "https://stackoverflow.com/users/741988/btowntkd"}, "edited": false, "score": 0, "creation_date": 1488381246, "post_id": 42535090, "comment_id": 72206298, "body": "Oh. Yeah. Durp."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 3, "creation_date": 1488383733, "post_id": 42535090, "comment_id": 72208240, "body": "My understanding of <i>padding is initialized to zero bits</i> is that the remaining part of the union will be set to 0."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1488392286, "post_id": 42535090, "comment_id": 72213893, "body": "@SergeBallesta I tested it on an exemple of a related question, It seems you are right! I edit my answer, now it forward to your answer!"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 6, "creation_date": 1488392297, "post_id": 42535090, "comment_id": 72213904, "body": "This is <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#694\" rel=\"nofollow noreferrer\">core issue 694</a>. The stated intent is to zero out the entire union."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1488438280, "post_id": 42535090, "comment_id": 72232846, "body": "@SergeBallesta I&#39;m not quite sure that the space reserved for inactive members of the union counts as padding. Padding is normally the area <i>outside</i> of members, introduced for alignment purposes."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1488438636, "post_id": 42535090, "comment_id": 72233016, "body": "@T.C. Unfortunately, &quot;padding&quot; is wonderfully underspecified in the standard (it doesn&#39;t even have an index entry!). Are the parts of a union&#39;s inactive members which don&#39;t overlap the active member really padding? Wouldn&#39;t padding be more like extra space at the end for array-alignment purposes?"}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1488440757, "post_id": 42535090, "comment_id": 72234149, "body": "@Angew, Here is a quote of issue 694, that explain why the C commitee added &quot;and padding is zero-initialized&quot;: <i>The C committee is considering changing the definition of zero-initialization of unions to guarantee that <b>the bytes of the entire union</b> are set to zero before assigning 0, converted to the appropriate type, to the first member.</i> But it seems to apply to zero initialization, which is performed only on static object no?"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1488441551, "post_id": 42535090, "comment_id": 72234640, "body": "@Oliv If you read the quotes in the A, you&#39;ll see that zero-init happens as part of this value-init. And I&#39;ve read the rationale, which would IMO be realised by the proposed 2008 resolution. However, I cannot be sure that the actually accepted 2010 resolution has the same effect, especially since it&#39;s preceded with &quot;The C Committee has changed its approach to this question&quot;. It&#39;s very possible the intent is to zero-out the entire union, but I don&#39;t really see how this wording about padding guarantees that."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1488441748, "post_id": 42535090, "comment_id": 72234738, "body": "@Angew 9.5 Unions [class.union] says <i>Each non-static data member is allocated as if it were the sole member of a struct.</i>. So at first member initialization time, it should be considered at the sole member and padding should be all bytes after it - But I would not rely too much on all C++ implementers understanding the standard that way ;-)"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1488441903, "post_id": 42535090, "comment_id": 72234834, "body": "@SergeBallesta Good find, it seems that&#39;s the intent, then. However, as you say, it&#39;s far from unambiguous."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1488442607, "post_id": 42535090, "comment_id": 72235249, "body": "@Angew: even it your answer is the accepted one, and if I reallly think that the intent is that all bytes of the union are set to 0, I&#39;ve added a warning in my answer :-)"}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1488450353, "post_id": 42535090, "comment_id": 72240447, "body": "@Angew, @SergeBallesta, @Angew Is the union <code>SomeData</code>  not an aggregate? This is important because according to the standard, aggregate initialization does not cause zero initialization, no?"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1488452682, "post_id": 42535090, "comment_id": 72241977, "body": "@Oliv Doesn&#39;t matter. Aggregate initialisation is the <b>second</b> bullet point under 8.5.4/3 (and starts with &quot;Otherwise&quot;), while value initialisation is the <b>first</b> (the one I quoted). So, since the first bullet point applies, value-init happens and aggregate-init does not."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1488453827, "post_id": 42535090, "comment_id": 72242703, "body": "@Angew, You are right, my reference was the C++14 standard, in this last standard, the first bullet only applies to copy initilization. With this change to the standard, is there any risk that compilers remove this zero initialization?"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1488454241, "post_id": 42535090, "comment_id": 72242987, "body": "@Oliv Wow, that&#39;s quite a change! When I have the time, I will definitely incorporate it into the answer (even though the Q specifies C++11, it&#39;s definitely very relevant). However, since the brace-init-list is empty, it effectively means that the first member will be initialised from an empty initializer list (C++14 8.5.1/7), which again means value-init. But even less is then known about padding, aparently."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1488746998, "post_id": 42535090, "comment_id": 72356600, "body": "@Angew The final wording is basically identical to WG14 N1387, linked in the issue, and the stated intent of that paper is clearly for this wording to reflect the &quot;byte-flooding&quot; behavior."}], "tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": true, "score": 7, "last_activity_date": 1488452569, "last_edit_date": 1488452569, "creation_date": 1488380443, "answer_id": 42535090, "question_id": 42534992, "link": "https://stackoverflow.com/questions/42534992/c11-empty-list-initialization-of-a-union-is-it-guaranteed-to-initialize-the/42535090#42535090", "title": "C++11 empty list Initialization of a union - is it guaranteed to initialize the full length of the union?", "body": "<p>No, it is not guaranteed that the entire union will be zeroed out. Only the first declared member of the union, plus any padding, is guaranteed to be zeroed (proof below).</p>\n\n<p>So to ensure the entire memory region of the union object is zeroed, you have these options:</p>\n\n<ul>\n<li>Order the members such that the largest member is first and thus the one zeroed out.</li>\n<li>Use <code>std::memset</code> or equivalent functionality. To prevent accidentally forgetting that, you can of course give <code>SomeData</code> a default constructor which will call this.</li>\n</ul>\n\n<hr>\n\n<p>Quoting C++11:</p>\n\n<p>8.5.4 [dcl.init.list]/3</p>\n\n<blockquote>\n  <p>List-initialization of an object or reference of type <code>T</code> is defined as follows:</p>\n  \n  <ul>\n  <li>If the initializer list has no elements and <code>T</code> is a class type with a default constructor, the object is\n  value-initialized.</li>\n  </ul>\n</blockquote>\n\n<p>8.5 [dcl.init]/7</p>\n\n<blockquote>\n  <p>To <em>value-initialize</em> an object of type <code>T</code> means:</p>\n  \n  <ul>\n  <li>if <code>T</code> is a (possibly cv-qualified) class type (Clause 9) with a user-provided constructor (12.1), then the\n  default constructor for <code>T</code> is called (and the initialization is ill-formed if <code>T</code> has no accessible default\n  constructor);</li>\n  <li>if <code>T</code> is a (possibly cv-qualified) non-union class type without a user-provided constructor, then the object\n  is zero-initialized and, if <code>T</code>\u2019s implicitly-declared default constructor is non-trivial, that constructor is\n  called.</li>\n  <li>...</li>\n  <li>otherwise, the object is zero-initialized.</li>\n  </ul>\n</blockquote>\n\n<p>8.5 [dcl.init]/5:</p>\n\n<blockquote>\n  <p>To <em>zero-initialize</em> an object or reference of type <code>T</code> means:</p>\n  \n  <p>...</p>\n  \n  <ul>\n  <li>if <code>T</code> is a (possibly cv-qualified) union type, the object\u2019s first non-static named data member is zero-initialized\n  and padding is initialized to zero bits;</li>\n  </ul>\n</blockquote>\n\n<p>From these quotes, you can see that using <code>{}</code> to initialise <code>data</code> will cause the object to be value-initialized (since <code>SomeData</code> is a class type with a default constructor).</p>\n\n<p>Value-initializing a union without a user-provided default constructor (which <code>SomeData</code> is) means zero-initializing it.</p>\n\n<p>Finally, zero-initializing a union means zero-initializing its first non-static named data member.</p>\n"}, {"comments": [{"owner": {"reputation": 7339, "user_id": 741988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8724aa47446c1ed0516acd4c1f642bd5?s=128&d=identicon&r=PG", "display_name": "BTownTKD", "link": "https://stackoverflow.com/users/741988/btowntkd"}, "edited": false, "score": 0, "creation_date": 1488388317, "post_id": 42536286, "comment_id": 72211505, "body": "Interesting!  That would be a happy interpretation indeed.  Is there anything in the spec which clarifies the definition of &quot;padding&quot; in a union?"}, {"owner": {"reputation": 583, "user_id": 1948525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5bccd182ec2401b4f8e031067b45d1?s=128&d=identicon&r=PG", "display_name": "SJHowe", "link": "https://stackoverflow.com/users/1948525/sjhowe"}, "edited": false, "score": 0, "creation_date": 1488473263, "post_id": 42536286, "comment_id": 72256528, "body": "Interesting. It does mean, surely, that everyone needs to put the largest member first in a union to get the entire union initialised to zero, right?"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 583, "user_id": 1948525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5bccd182ec2401b4f8e031067b45d1?s=128&d=identicon&r=PG", "display_name": "SJHowe", "link": "https://stackoverflow.com/users/1948525/sjhowe"}, "edited": false, "score": 0, "creation_date": 1488479537, "post_id": 42536286, "comment_id": 72260420, "body": "@SJHowe More exactly, if the first member in the union is the greastest, you are sure that all bytes in union will be set to 0."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 6, "last_activity_date": 1488442422, "last_edit_date": 1592644375, "creation_date": 1488383663, "answer_id": 42536286, "question_id": 42534992, "link": "https://stackoverflow.com/questions/42534992/c11-empty-list-initialization-of-a-union-is-it-guaranteed-to-initialize-the/42536286#42536286", "title": "C++11 empty list Initialization of a union - is it guaranteed to initialize the full length of the union?", "body": "<p>The entire union will be zeroed out. More exactly the first member of the union will be default initialized and all the remaining bytes in the union will be set to 0 as <em>padding</em>.</p>\n<p>References (emphasize mine):</p>\n<blockquote>\n<p>8.5 Initializers [dcl.init]<br/>...<br/></p>\n<p>5 To zero-initialize an object or reference of type T means:<br/>...<br/>\n\u2014 if T is a (possibly cv-qualified) union type, the object\u2019s first non-static named data member is zero initialized\n<strong>and padding is initialized to zero bits</strong>;</p>\n</blockquote>\n<p>That means that the first member of the union (here <code>std::uint8_t Byte;</code>) will be initialized to a 0 and that all other bytes in the union will be set to 0 because they are padding bytes.</p>\n<hr />\n<p>But <strong>beware</strong>. As stated by Angew <em>&quot;padding&quot; is wonderfully underspecified in the standard</em> and a C compiler could interpret that the padding bytes in a union are only the bytes that follow the largest member. I would really find that weird because compatibility changes are specifically documented and previous versions (C) first initialized everything to 0 and next did specific initialization. But a new implementer could not be aware of it...</p>\n<p>TL/DR: I really think that the intent of the standard is that all bytes in the union are set to 0 in OP's example, but for a mission critical program, I would certainly add an explicit 0 constructor...</p>\n"}], "owner": {"reputation": 7339, "user_id": 741988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8724aa47446c1ed0516acd4c1f642bd5?s=128&d=identicon&r=PG", "display_name": "BTownTKD", "link": "https://stackoverflow.com/users/741988/btowntkd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "accepted_answer_id": 42535090, "answer_count": 2, "score": 12, "last_activity_date": 1488452569, "creation_date": 1488380190, "last_edit_date": 1488380494, "question_id": 42534992, "link": "https://stackoverflow.com/questions/42534992/c11-empty-list-initialization-of-a-union-is-it-guaranteed-to-initialize-the", "title": "C++11 empty list Initialization of a union - is it guaranteed to initialize the full length of the union?", "body": "<p>In C++11, I have the following union:</p>\n\n<pre><code>union SomeData\n{\n    std::uint8_t Byte;\n    std::uint16_t Word;\n    std::uint32_t DWord;\n    unsigned char String[128];\n};\n</code></pre>\n\n<p>If I initialize the union thusly;</p>\n\n<pre><code>SomeData data {};\n</code></pre>\n\n<p>Is it guaranteed that the <em>entire</em> contents of the union will be \"zero'd\" out?  Put another way; is an empty list-initializer of a union <em>functionally equivalent</em> to memset-ing the union to Zero?:</p>\n\n<pre><code>memset(&amp;data, 0, sizeof(data));\n</code></pre>\n\n<p>In particular, I'm concerned about the string data.  I'd like to ensure the entire length of the string contains zeros.  It appears to work in my current compiler, but does <em>the language of the spec</em> guarantee this to always be true?</p>\n\n<p>If not: is there a better way to initialize the full length of the union to zero?</p>\n"}, {"tags": ["c++", "loops", "while-loop", "initialization", "declaration"], "answers": [{"tags": [], "owner": {"reputation": 4967, "user_id": 1935008, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3500ff2f9f622b0cc68319d62ede7244?s=128&d=identicon&r=PG", "display_name": "Ilya Kobelevskiy", "link": "https://stackoverflow.com/users/1935008/ilya-kobelevskiy"}, "is_accepted": false, "score": 1, "last_activity_date": 1488380359, "creation_date": 1488380359, "answer_id": 42535042, "question_id": 42534977, "link": "https://stackoverflow.com/questions/42534977/c-declaration-and-initialization-variables-inside-while-loops/42535042#42535042", "title": "c++ declaration and initialization variables inside while loops", "body": "<p>Your understanding is correct, and another possible solution would be to declare variable outside of a loop:</p>\n\n<pre><code>int inner_loop_count = 0;\nwhile (num &gt;= 0 &amp;&amp; num &lt;= 3)\n{\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "is_accepted": true, "score": 2, "last_activity_date": 1488380418, "creation_date": 1488380418, "answer_id": 42535078, "question_id": 42534977, "link": "https://stackoverflow.com/questions/42534977/c-declaration-and-initialization-variables-inside-while-loops/42535078#42535078", "title": "c++ declaration and initialization variables inside while loops", "body": "<p>You can't practically define a loop counter inside the loop body. A <code>static</code> could work technically in a given context, as you mention. But if the loop was entered a second time that counter would not start at 0.</p>\n\n<p>So instead, use a <code>for</code> loop.</p>\n\n<p>That's what it's &ldquo;for&rdquo;:</p>\n\n<pre><code>for( int num = 0; num &lt;= 3; ++num )\n{\n    // ...\n}\n</code></pre>\n\n<p>It's defined by equivalence with a <code>while</code> loop placed in an enclosing braces block where the <code>int num = 0</code> declaration is placed.</p>\n\n<p>The update <code>++num</code> is placed at the bottom of the loop body in that equivalent, like this:</p>\n\n<pre><code>// Equivalent:\n{\n    int num = 0;\n    while( num &lt;= 3 )\n    {\n        // ...\n        ++num;\n    }\n}\n</code></pre>\n\n<p>&hellip; which you avoid having to write by using the <code>for</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1646, "user_id": 3904492, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ak0QY.jpg?s=128&g=1", "display_name": "Starlord", "link": "https://stackoverflow.com/users/3904492/starlord"}, "is_accepted": false, "score": 0, "last_activity_date": 1488380468, "creation_date": 1488380468, "answer_id": 42535106, "question_id": 42534977, "link": "https://stackoverflow.com/questions/42534977/c-declaration-and-initialization-variables-inside-while-loops/42535106#42535106", "title": "c++ declaration and initialization variables inside while loops", "body": "<blockquote>\n  <p>My understanding that the loop scope is between the braces {} and cannot be used to define a loop counter, because the declaration and the initialization will be redone each time.</p>\n</blockquote>\n\n<p>You are correct</p>\n\n<p>You can declare you counter outside your while loop like this:</p>\n\n<pre><code>int inner_loop_count = 0;\nwhile (num &gt;= 0 &amp;&amp; num &lt;= 3)\n{\n    cout &lt;&lt; \"Loop # \" &lt;&lt; ++inner_loop_count &lt;&lt; \"\\n\"; //beware..Counts +1 before loop is done. First looping will count as 1, but is actually number 0\n    num++;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1488380613, "creation_date": 1488380613, "answer_id": 42535159, "question_id": 42534977, "link": "https://stackoverflow.com/questions/42534977/c-declaration-and-initialization-variables-inside-while-loops/42535159#42535159", "title": "c++ declaration and initialization variables inside while loops", "body": "<p>A1. Yes, your understanding is spot on. An automatic variable is local to its block (delimited by <code>{}</code>), so it cannot be used as a loop counter if declared within the loop body.</p>\n\n<p>A2. Your 2. suggestion is the typical way to use a counter in a <code>while</code> loop, although isolating the counter with an outer block is usually not necessary. Another possibility: <code>for</code> loop control structure, which does exactly the same, with different syntax (i.e. it is syntactic sugar).</p>\n\n<p>Also, you can use a global variable - which is quite similar to using a local static variable.</p>\n"}, {"tags": [], "owner": {"reputation": 55713, "user_id": 26095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WLsjF.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/26095/sean"}, "is_accepted": false, "score": 1, "last_activity_date": 1488380700, "creation_date": 1488380700, "answer_id": 42535192, "question_id": 42534977, "link": "https://stackoverflow.com/questions/42534977/c-declaration-and-initialization-variables-inside-while-loops/42535192#42535192", "title": "c++ declaration and initialization variables inside while loops", "body": "<p>Your understanding is correct. Another possible solution is to use a <code>for</code> loop:</p>\n\n<pre><code>using namespace std;\n\nint main()\n{\n    for(int num = 0, inner_loop_count = 1; num &lt;=3; num++, inner_loop_count++)\n    {\n        cout &lt;&lt; \"Loop # \" &lt;&lt; inner_loop_count &lt;&lt; \"\\n\"; \n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1533, "user_id": 6204556, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/EJxCy.jpg?s=128&g=1", "display_name": "Shadi", "link": "https://stackoverflow.com/users/6204556/shadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15757, "favorite_count": 1, "accepted_answer_id": 42535078, "answer_count": 5, "score": 2, "last_activity_date": 1488380700, "creation_date": 1488380155, "question_id": 42534977, "link": "https://stackoverflow.com/questions/42534977/c-declaration-and-initialization-variables-inside-while-loops", "title": "c++ declaration and initialization variables inside while loops", "body": "<p>In the following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main()\n{\n    int num = 0;\n\n    while (num &gt;= 0 &amp;&amp; num &lt;= 3)\n    {\n        int inner_loop_count = 0;\n        cout &lt;&lt; \"Loop # \" &lt;&lt; ++inner_loop_count &lt;&lt; \"\\n\";\n        num++;\n    }\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<blockquote>\n  <p>Loop # 1<br>\n  Loop # 1<br>\n  Loop # 1<br>\n  Loop # 1</p>\n</blockquote>\n\n<p>My understanding that the loop scope is between the braces {} and cannot be used to define a loop counter, because the declaration and the initialization will be redone each time.</p>\n\n<p>I tried the following solution:</p>\n\n<ol>\n<li>using static keyword. (Regardless of goodness or badness).</li>\n<li>including while itself inside outer {} and declare the counter variable there just right before while.</li>\n</ol>\n\n<p><strong>Question #1:</strong> Is my understanding correct?<br>\n<strong>Question #2:</strong> Are there any other -technically- possible solutions?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "bit-manipulation", "bit-shift", "sign-extension"], "answers": [{"tags": [], "owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "is_accepted": false, "score": 2, "last_activity_date": 1488379792, "creation_date": 1488379792, "answer_id": 42534822, "question_id": 42534749, "link": "https://stackoverflow.com/questions/42534749/signed-extension-from-24-bit-to-32-bit-in-c/42534822#42534822", "title": "Signed extension from 24 bit to 32 bit in C++", "body": "<p>Assuming both representations are two's complement, simply</p>\n\n<pre><code>upper_byte = (Signed_byte(incoming_msb) &gt;= 0? 0 : Byte(-1));\n</code></pre>\n\n<p>where</p>\n\n<pre><code>using Signed_byte = signed char;\nusing Byte = unsigned char;\n</code></pre>\n\n<p>and <code>upper_byte</code> is a variable representing the missing fourth byte.</p>\n\n<p>The conversion to <code>Signed_byte</code> is formally implementation-dependent, but a two's complement implementation doesn't have a choice, really.</p>\n"}, {"comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1488380990, "post_id": 42535210, "comment_id": 72206085, "body": "Placing a value in a bit field so small that the extracted value is not equal, must surely be implementation-defined behavior. Still I like this. :)"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1488382480, "post_id": 42535210, "comment_id": 72207289, "body": "How do you compile this? I get some &quot;error: address of bit-field requested&quot;. Works if I remove that <code>.i24</code> in the memcpy, maybe that&#39;s what you meant?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1488383002, "post_id": 42535210, "comment_id": 72207692, "body": "@harold yes. This was made up without compiling"}], "tags": [], "owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1553056773, "last_edit_date": 1553056773, "creation_date": 1488380753, "answer_id": 42535210, "question_id": 42534749, "link": "https://stackoverflow.com/questions/42534749/signed-extension-from-24-bit-to-32-bit-in-c/42535210#42535210", "title": "Signed extension from 24 bit to 32 bit in C++", "body": "<p>You can use a <a href=\"https://graphics.stanford.edu/~seander/bithacks.html#FixedSignExtend\" rel=\"nofollow noreferrer\">bitfield</a></p>\n\n<pre><code>template&lt;size_t L&gt;\ninline int32_t sign_extend_to_32(const char *x)\n{\n  struct {int32_t i: L;} s;\n  memcpy(&amp;s, x, 3);\n  return s.i;\n  // or\n  return s.i = (x[2] &lt;&lt; 16) | (x[1] &lt;&lt; 8) | x[0]; // assume little endian\n}\n</code></pre>\n\n<p>Easy and no undefined behavior invoked</p>\n\n<pre><code>int32_t r = sign_extend_to_32&lt;24&gt;(your_3byte_array);\n</code></pre>\n\n<p>Of course <em>copying the bytes to the upper 3 bytes in the int32 and then shifting everything to the right</em> as you thought is also a good idea. There's no undefined behavior if you use <code>memcpy</code> like above. An alternative is <code>reinterpret_cast</code> in C++ and union in C, which can avoid the use of <code>memcpy</code>. However there's an <a href=\"https://stackoverflow.com/q/8415895/995714\"><em>implementation defined behavior</em></a> because right shift is not always a sign-extension shift (although almost all modern compilers do that)</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1488381061, "creation_date": 1488381061, "answer_id": 42535325, "question_id": 42534749, "link": "https://stackoverflow.com/questions/42534749/signed-extension-from-24-bit-to-32-bit-in-c/42535325#42535325", "title": "Signed extension from 24 bit to 32 bit in C++", "body": "<p>You could let the compiler process itself the sign extension. Assuming that the lowest significant byte is byte1 and the high significant byte is byte3;</p>\n\n<pre><code>int val = (signed char) byte3;                // C guarantees the sign extension\nval &lt;&lt; 16;                                    // shift the byte at its definitive place\nval |= ((int) (unsigned char) byte2) &lt;&lt; 8;    // place the second byte\nval |= ((int) (unsigned char) byte1;          // and the least significant one\n</code></pre>\n\n<p>I have used C style cast here when <code>static_cast</code> would have been more C++ish, but as an old dinosaur (and Java programmer) I find C style cast more readable for integer conversions.</p>\n"}, {"comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1488382078, "post_id": 42535633, "comment_id": 72206979, "body": "Why so complicated though? You could just <code>(value ^ m) - m</code> with <code>m = 1 &lt;&lt; (bits - 1)</code>"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1488382810, "post_id": 42535633, "comment_id": 72207528, "body": "@harold if you think you have a better answer go ahead and answer the question yourself. I&#39;m having a hard time convincing myself that it works, but if it does you&#39;ll get a +1 from me."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1488383235, "post_id": 42535633, "comment_id": 72207872, "body": "Fair enough, I just thought maybe there&#39;s a reason for it"}], "tags": [], "owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "is_accepted": false, "score": 0, "last_activity_date": 1488381868, "creation_date": 1488381868, "answer_id": 42535633, "question_id": 42534749, "link": "https://stackoverflow.com/questions/42534749/signed-extension-from-24-bit-to-32-bit-in-c/42535633#42535633", "title": "Signed extension from 24 bit to 32 bit in C++", "body": "<p>Here's a method that works for any bit count, even if it's not a multiple of 8. This assumes you've already assembled the 3 bytes into an integer <code>value</code>.</p>\n\n<pre><code>const int bits = 24;\nint mask = (1 &lt;&lt; bits) - 1;\nbool is_negative = (value &amp; ~(mask &gt;&gt; 1)) != 0;\nvalue |= -is_negative &amp; ~mask;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1488383655, "post_id": 42536138, "comment_id": 72208176, "body": "Another benefit of bit-twiddling in this way is that you&#39;re not limited to a 32-bit int - it works just as well on a 64-bit int for example. I&#39;d change the type, perhaps to a template parameter, and make <code>bits</code> a function parameter as well."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1488384124, "post_id": 42536138, "comment_id": 72208556, "body": "@MarkRansom good points, is that approximately what you meant?"}, {"owner": {"reputation": 749, "user_id": 2790016, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7c732b2e41421012ba51b6707713a620?s=128&d=identicon&r=PG&f=1", "display_name": "Beto", "link": "https://stackoverflow.com/users/2790016/beto"}, "edited": false, "score": 0, "creation_date": 1488384243, "post_id": 42536138, "comment_id": 72208632, "body": "I need a signed 32 not unsigned though"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 749, "user_id": 2790016, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7c732b2e41421012ba51b6707713a620?s=128&d=identicon&r=PG&f=1", "display_name": "Beto", "link": "https://stackoverflow.com/users/2790016/beto"}, "edited": false, "score": 0, "creation_date": 1488384843, "post_id": 42536138, "comment_id": 72209047, "body": "@Beto you can just use signed types here, at least I see no way for it to break (unless <code>bits</code> is something unreasonable). Makes the rest of the code more dangerous though."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1488386228, "post_id": 42536138, "comment_id": 72210049, "body": "Perfect. I like the way you split <code>m</code> assignment into two parts to make sure the shifting occurs on the proper type."}], "tags": [], "owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "is_accepted": false, "score": 10, "last_activity_date": 1488384103, "last_edit_date": 1488384103, "creation_date": 1488383200, "answer_id": 42536138, "question_id": 42534749, "link": "https://stackoverflow.com/questions/42534749/signed-extension-from-24-bit-to-32-bit-in-c/42536138#42536138", "title": "Signed extension from 24 bit to 32 bit in C++", "body": "<p>You could use:</p>\n\n<pre><code>uint32_t sign_extend_24_32(uint32_t x) {\n    const int bits = 24;\n    uint32_t m = 1u &lt;&lt; (bits - 1);\n    return (x ^ m) - m;\n}\n</code></pre>\n\n<p>This works because:</p>\n\n<ul>\n<li>if the old sign was 1, then the XOR makes it zero and the subtraction will set it and borrow through all higher bits, setting them as well.</li>\n<li>if the old sign was 0, the XOR will set it, the subtract resets it again and doesn't borrow so the upper bits stay 0.</li>\n</ul>\n\n<p>Templated version</p>\n\n<pre><code>template&lt;class T&gt;\nT sign_extend(T x, const int bits) {\n    T m = 1;\n    m &lt;&lt;= bits - 1;\n    return (x ^ m) - m;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2474, "user_id": 3606363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/NGUHv.jpg?s=128&g=1", "display_name": "notadam", "link": "https://stackoverflow.com/users/3606363/notadam"}, "is_accepted": false, "score": 0, "last_activity_date": 1556581526, "creation_date": 1556581526, "answer_id": 55912127, "question_id": 42534749, "link": "https://stackoverflow.com/questions/42534749/signed-extension-from-24-bit-to-32-bit-in-c/55912127#55912127", "title": "Signed extension from 24 bit to 32 bit in C++", "body": "<p>This is a pretty old question, but I recently had to do the same (while dealing with 24-bit audio samples), and wrote my own solution for it. It's using a similar principle as <a href=\"https://stackoverflow.com/a/42535210\">this</a> answer, but more generic, and potentially generates better code after compiling.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;size_t Bits, typename T&gt;\ninline constexpr T sign_extend(const T&amp; v) noexcept {\n    static_assert(std::is_integral&lt;T&gt;::value, \"T is not integral\");\n    static_assert((sizeof(T) * 8u) &gt;= Bits, \"T is smaller than the specified width\");\n    if constexpr ((sizeof(T) * 8u) == Bits) return v;\n    else {\n        using S = struct { signed Val : Bits; };\n        return reinterpret_cast&lt;const S*&gt;(&amp;v)-&gt;Val;\n    }\n}\n</code></pre>\n\n<p>This has no hard-coded math, it simply lets the compiler do the work and figure out the best way to sign-extend the number. With certain widths, this can even generate a native sign-extension instruction in the assembly, such as <a href=\"https://www.felixcloutier.com/x86/movsx:movsxd\" rel=\"nofollow noreferrer\">MOVSX</a> on x86.</p>\n\n<p>This function assumes you copied your N-bit number into the lower N bits of the type you want to extend it to. So for example:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int16_t a = -42;\nint32_t b{};\nmemcpy(&amp;b, &amp;a, sizeof(a));\nb = sign_extend&lt;16&gt;(b);\n</code></pre>\n\n<p>Of course it works for any number of bits, extending it to the full width of the type that contained the data.</p>\n"}], "owner": {"reputation": 749, "user_id": 2790016, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7c732b2e41421012ba51b6707713a620?s=128&d=identicon&r=PG&f=1", "display_name": "Beto", "link": "https://stackoverflow.com/users/2790016/beto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3533, "favorite_count": 1, "answer_count": 6, "score": 6, "last_activity_date": 1556644846, "creation_date": 1488379625, "last_edit_date": 1556644846, "question_id": 42534749, "link": "https://stackoverflow.com/questions/42534749/signed-extension-from-24-bit-to-32-bit-in-c", "title": "Signed extension from 24 bit to 32 bit in C++", "body": "<p>I have 3 unsigned bytes that are coming over the wire separately.</p>\n\n<pre><code>[byte1, byte2, byte3]\n</code></pre>\n\n<p>I need to convert these to a signed 32-bit value but I am not quite sure how to handle the sign of the negative values. </p>\n\n<p>I thought of copying the bytes to the upper 3 bytes in the int32 and then shifting everything to the right but I read this may have unexpected behavior.</p>\n\n<p>Is there an easier way to handle this? </p>\n\n<p>The representation is using two's complement.</p>\n"}, {"tags": ["c++", "opencv", "video", "video-capture"], "comments": [{"owner": {"reputation": 18948, "user_id": 3051961, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b81cbd6deac24f756452266ff2e8d3ce?s=128&d=identicon&r=PG", "display_name": "ZdaR", "link": "https://stackoverflow.com/users/3051961/zdar"}, "edited": false, "score": 1, "creation_date": 1488393002, "post_id": 42534731, "comment_id": 72214330, "body": "Read some basic Opencv Tutorials on how to read a video file and fetch the frames from that file, Then simply apply your knowledge of <code>addWeighted</code> on the 2 frames fetched from respective videos"}, {"owner": {"reputation": 3, "user_id": 3452205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe217a2335f70a3209927a14ae21d0f7?s=128&d=identicon&r=PG", "display_name": "AnthonyGR1", "link": "https://stackoverflow.com/users/3452205/anthonygr1"}, "reply_to_user": {"reputation": 18948, "user_id": 3051961, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b81cbd6deac24f756452266ff2e8d3ce?s=128&d=identicon&r=PG", "display_name": "ZdaR", "link": "https://stackoverflow.com/users/3051961/zdar"}, "edited": false, "score": 0, "creation_date": 1488399523, "post_id": 42534731, "comment_id": 72218217, "body": "@ZdaR Thanks for the reply. I have investigated this and have used the image difference to output some results which are acceptable. I&#39;ll look into using addWeighted() on the individual frames soon. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11548990, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WstT0j0hLn4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reWkxVvHv56Tt0e40GyNQDC79MbMA/mo/photo.jpg?sz=128", "display_name": "Siddharth Singh", "link": "https://stackoverflow.com/users/11548990/siddharth-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1588665109, "creation_date": 1588665109, "answer_id": 61608263, "question_id": 42534731, "link": "https://stackoverflow.com/questions/42534731/how-can-i-merge-2-videos-together-in-opencv-similar-to-that-of-a-simulcam/61608263#61608263", "title": "How can I merge 2 videos together in OpenCV? Similar to that of a SimulCam", "body": "<p>perform operation on every frame of video</p>\n\n<pre><code>import cv2\nimport numpy as np\n\nvideo1 = cv2.VideoCapture('output.avi')\nvideo2 = cv2.VideoCapture('output1.avi')\n\nwhile True:\n\n    ret1, frame1 = video1.read()\n    ret2, frame2 = video2.read()\n    if ret1==False or ret2==False:\n        break\n\n    frame1=cv2.resize(frame1, (240,320))\n    frame2=cv2.resize(frame2, (240,320))\n\n    dst = cv2.addWeighted(frame1,0.3,frame2,0.7,0)\n    cv2.imshow('dst',dst)\n    key = cv2.waitKey(1)\n    if key==ord('q'):\n        break\n\ncv2.destroyAllWindows()\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3452205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe217a2335f70a3209927a14ae21d0f7?s=128&d=identicon&r=PG", "display_name": "AnthonyGR1", "link": "https://stackoverflow.com/users/3452205/anthonygr1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2260, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1588665109, "creation_date": 1488379580, "question_id": 42534731, "link": "https://stackoverflow.com/questions/42534731/how-can-i-merge-2-videos-together-in-opencv-similar-to-that-of-a-simulcam", "title": "How can I merge 2 videos together in OpenCV? Similar to that of a SimulCam", "body": "<p>I am looking for a way to combine/blend 2 videos irrespective of alignment in OpenCV.</p>\n\n<p>I have 2 videos of the same scene, one is a ball rolling fast, the other slow from a standardised start point.</p>\n\n<p>I have managed to work out how to use AddWeighted() previously to blend two images together, but have little knowledge of performing something similar for Videos.</p>\n\n<p>I understand that it involves reading frames of the respective sources and processing them.. but that is all.</p>\n\n<hr>\n\n<p>Any help or direction would be greatly appreciated.</p>\n"}, {"tags": ["c++", "c++11", "language-lawyer", "one-definition-rule"], "comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 4, "creation_date": 1488379165, "post_id": 42534495, "comment_id": 72204679, "body": "All that&#39;s needed in your example code is <b><i>the value</i></b> of <code>i</code>. That means it can be optimized away and does not need to have allocated storage."}], "answers": [{"comments": [{"owner": {"reputation": 1839, "user_id": 4463557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/uMZ2v.png?s=128&g=1", "display_name": "Jo&#227;o Afonso", "link": "https://stackoverflow.com/users/4463557/jo%c3%a3o-afonso"}, "edited": false, "score": 0, "creation_date": 1488390871, "post_id": 42535720, "comment_id": 72213035, "body": "Thanks for the very comprehensive answer (+1)"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 9, "last_activity_date": 1488393439, "last_edit_date": 1488393439, "creation_date": 1488382146, "answer_id": 42535720, "question_id": 42534495, "link": "https://stackoverflow.com/questions/42534495/continuation-of-i-just-can-not-understand-dr-712/42535720#42535720", "title": "Continuation of &quot;I just can not understand DR 712&quot;", "body": "<p>I am trying to translate my understanding of standardese \"used\" and \"one definition rule used\" to something more intuitive here.  Terms other than \"used\" and \"ODR-used\" are not intended as standard-defined terms below.</p>\n\n<hr>\n\n<p>Something being ODR-used basically means \"we need it to have an identity\".  This usually means someone is taking a reference or pointer to it.</p>\n\n<p>If you only need the <em>value</em> of something, this doesn't always make it ODR-used.  The value of a compile-time constant does not require identity.</p>\n\n<p>In C++, identity basically means \"it must actually have storage somewhere\".</p>\n\n<p>The standard doesn't say \"it is ODR used if we need it to have an identity\", because then different compilers will have different rules to determine if they <em>need</em> the identity.  As an example, if an operation is inlined and the reference elided, does that mean it no longer needs an identity?</p>\n\n<p>So the standard describes what ODR-used means, and distinguishes it from the value being used.</p>\n\n<pre><code>int j = i;\n</code></pre>\n\n<p>this doesn't need the identity of <code>i</code>.  It just needs its value.  <code>const int i = 1;</code> has a value that cannnot (under defined behavior) change.</p>\n\n<pre><code>int const* pj = &amp;i;\n</code></pre>\n\n<p>this <em>does</em> need an identity.  Two different pointers to <code>i</code> must agree on the location of <code>i</code> under the standard.</p>\n\n<pre><code>void foo( const int&amp; x ) {\n  int j = x;\n}\nfoo(i);\n</code></pre>\n\n<p>This also needs an identity for <code>i</code>.  We take a reference to <code>i</code>.  Even though the only thing we do is just that reference its value, the (short, theoretical) existence of that reference means it had an identity.</p>\n\n<pre><code>const int a = 3; const int b = 4;\nint i = (a&lt;2)?a:b;\n</code></pre>\n\n<p>the defect there was that this required <code>a</code> and <code>b</code> to have identity (they where ODR-used), because the the interaction of <code>?</code> with the used-rules.  The defect was saying \"we should fix this\".</p>\n\n<p><a href=\"http://www.open-std.org/JTC1/SC22/WG21/docs/cwg_defects.html#712\" rel=\"nofollow noreferrer\">Link to DR 712</a></p>\n\n<p>And after that resolution, only the value of <code>a</code> and <code>b</code> are required by that expression, not their identity, so they don't need to have storage.</p>\n\n<p>We care if something has storage because things requiring storage have to have a unique point of definition.  They cannot exist purely in a header file, basically.</p>\n\n<p>Note that with inline variables in C++17 we may care less about this; under the as-if rule, the inline storage location created can be erased from existence if nobody actually pays attention to the identity.  As functions taking <code>const&amp;</code> can \"accidentally\" force identity requirements on things intended to be value-only tokens, this is a nice relaxing of the rules.</p>\n"}], "owner": {"reputation": 1839, "user_id": 4463557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/uMZ2v.png?s=128&g=1", "display_name": "Jo&#227;o Afonso", "link": "https://stackoverflow.com/users/4463557/jo%c3%a3o-afonso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 42535720, "answer_count": 1, "score": 5, "last_activity_date": 1488393439, "creation_date": 1488378984, "last_edit_date": 1495539968, "question_id": 42534495, "link": "https://stackoverflow.com/questions/42534495/continuation-of-i-just-can-not-understand-dr-712", "title": "Continuation of &quot;I just can not understand DR 712&quot;", "body": "<p>This is basically a continuation of <a href=\"https://stackoverflow.com/q/42516175/4463557\">my prior question</a> about DR 712. Let me first explain why I'm insisting in looking at something that could be considered old, as the C++11 Standard, but my problem is that the section [basic.def.odr] is already difficult to understand in C++11, and I want to cover this completely before I delve into the same section in the current draft, which in my opinion, is even more complicated.</p>\n\n<p>The answer to my prior question by <a href=\"https://stackoverflow.com/users/4029014/austin-hastings\">Austing Hasting</a>s was great, but I still have one little point that is not clear in [basic.def.odr]/2 in C++11. Consider this little and very simple example:</p>\n\n<pre><code>const int i = 1;\nint main()\n{\n    int j = i;\n}\n</code></pre>\n\n<p>From [basic.def.odr]/2 in C++11 <code>i</code> is <strong>not</strong> <code>odr-used</code> in <code>int j = i;</code> as <code>i</code> is an object that satisfies the requirement for appearing in a constant expression and the lvalue-to-rvalue conversion is immediately applied to <code>i</code>. That doesn't make much sense to me, as <code>i</code> is clealy being used in the declaration <code>int j = i;</code>, as can be seen in the slightly modified code shown <a href=\"https://godbolt.org/g/APx5zo\" rel=\"nofollow noreferrer\">here</a>, where I forced the variable <code>i</code> not to be optimized out of the compiled code.</p>\n\n<p>Of course, there must be something wrong in my reasoning above, for I don't believe C++11 could be wrong in such a simple example. Again, what am I missing now???  </p>\n"}, {"tags": ["c++", "boost", "visual-studio-2013", "intel-composer"], "comments": [{"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1488391771, "post_id": 42534470, "comment_id": 72213581, "body": "I see the same <code>BOOST_LIBRARYDIR</code> path in both cases. Does this directory contain both sets of binaries? The libraries are identified by a toolset tag, and CMake searches for a <a href=\"https://github.com/Kitware/CMake/blob/master/Modules/FindBoost.cmake#L418\" rel=\"nofollow noreferrer\">different tag depending on the compiler</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2259, "user_id": 374845, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68e90bb3a4cb97dab8e40b37aaf1b371?s=128&d=identicon&r=PG", "display_name": "Sergey Shandar", "link": "https://stackoverflow.com/users/374845/sergey-shandar"}, "is_accepted": true, "score": 1, "last_activity_date": 1492454710, "creation_date": 1492454710, "answer_id": 43457524, "question_id": 42534470, "link": "https://stackoverflow.com/questions/42534470/intel-compiler-in-visual-studio-not-finding-boost-libraries/43457524#43457524", "title": "Intel compiler in visual studio not finding boost libraries", "body": "<p>Currently, Boost NuGet packages do not have binaries for Intel compiler. Boost NuGet package contains binaries from the <a href=\"https://sourceforge.net/projects/boost/files/boost-binaries/\" rel=\"nofollow noreferrer\">Prebuilt windows binaries</a> only. In the future, I'm happy to add new binaries as soon as they are available to download from some trusted resource.</p>\n"}], "owner": {"reputation": 558, "user_id": 5403968, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b32bb8cb5029a32c6ee6fc71fe52453e?s=128&d=identicon&r=PG&f=1", "display_name": "Sashank", "link": "https://stackoverflow.com/users/5403968/sashank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 43457524, "answer_count": 1, "score": 0, "last_activity_date": 1492454710, "creation_date": 1488378917, "question_id": 42534470, "link": "https://stackoverflow.com/questions/42534470/intel-compiler-in-visual-studio-not-finding-boost-libraries", "title": "Intel compiler in visual studio not finding boost libraries", "body": "<p>I am trying to install mlpack in vs2013. msvc2013 is not compatible, so I am using Intel C++ compiler XE 14.0. However, Intel compiler is not finding the boost libraries.</p>\n\n<p>Using only MSVC - </p>\n\n<pre><code>C:\\projects\\mlpack-2.1.1\\build&gt; cmake -G \"Visual Studio 12 2013 Win64\" ....\n-DBOOST_INCLUDEDIR:PATH=\"C:\\projects\\mlpack-2.1.1\\packages\\boost.1.63.0.0\\lib\\native\\include\" \n-DBOOST_LIBRARYDIR:PATH=\"C:\\projects\\mlpack-2.1.1\\packages\\boost_libs\" ..\n</code></pre>\n\n<p>Output - </p>\n\n<pre><code>....\nFound the following Boost libraries:\n  program_options\n  unit_test_framework\n  serialization\n....\n</code></pre>\n\n<p>Using MSVC and Intel toolkit - </p>\n\n<pre><code>C:\\projects\\mlpack-2.1.1\\build&gt; cmake -G \"Visual Studio 12 2013 Win64\" -T\"Intel C++ compiler XE 14.0\" ....\n-DBOOST_INCLUDEDIR:PATH=\"C:\\projects\\mlpack-2.1.1\\packages\\boost.1.63.0.0\\lib\\native\\include\" \n-DBOOST_LIBRARYDIR:PATH=\"C:\\projects\\mlpack-2.1.1\\packages\\boost_libs\" ..\n</code></pre>\n\n<p>Output - </p>\n\n<pre><code>Could not find the following Boost libraries:\n      boost_program_options\n      boost_unit_test_framework\n      boost_serialization\n</code></pre>\n\n<p>Why is the intel unable to find? I installed the boost libraries using NuGet package manager. Should I use some other boost libs for intel compiler?</p>\n"}, {"tags": ["c++", "audio", "signal-processing"], "comments": [{"owner": {"reputation": 3006, "user_id": 908485, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/6f510f3602936562bfe5a27bbc681db4?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142 Rumian", "link": "https://stackoverflow.com/users/908485/pawe%c5%82-rumian"}, "edited": false, "score": 0, "creation_date": 1488380032, "post_id": 42534392, "comment_id": 72205353, "body": "HI, welcome to StackOverflow. Can you please add more specific information to your question - current results, expected results, what is your exact problem etc. In current state this question is too broad and will probably be closed soon."}, {"owner": {"reputation": 1, "user_id": 7641816, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210501328587731/picture?type=large", "display_name": "Edward James", "link": "https://stackoverflow.com/users/7641816/edward-james"}, "reply_to_user": {"reputation": 3006, "user_id": 908485, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/6f510f3602936562bfe5a27bbc681db4?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142 Rumian", "link": "https://stackoverflow.com/users/908485/pawe%c5%82-rumian"}, "edited": false, "score": 0, "creation_date": 1488380627, "post_id": 42534392, "comment_id": 72205807, "body": "Thank you for your reply. My problem is that I have two hard coded delay lines that I can manually change to align two signals going in. I&#39;m using a DI signal and a microphone signal from a bass amp. If I use this code in its current state it will delay the DI signal, but what I want it to do, is take the two signals and align them within the DSP for it to output them in phase with one and other."}, {"owner": {"reputation": 3006, "user_id": 908485, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/6f510f3602936562bfe5a27bbc681db4?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142 Rumian", "link": "https://stackoverflow.com/users/908485/pawe%c5%82-rumian"}, "edited": false, "score": 0, "creation_date": 1488381003, "post_id": 42534392, "comment_id": 72206096, "body": "That&#39;s a bit better - if only you could edit your original question to include these information, as finding crucial questions in comments is not always easy ;)"}, {"owner": {"reputation": 8313, "user_id": 7621674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/323bed98b2e655d5fa9ac6d23a72b995?s=128&d=identicon&r=PG", "display_name": "m7913d", "link": "https://stackoverflow.com/users/7621674/m7913d"}, "edited": false, "score": 0, "creation_date": 1489009219, "post_id": 42534392, "comment_id": 72488948, "body": "Perhaps, <a href=\"https://forum.kde.org/viewtopic.php?f=74&amp;t=118619\" rel=\"nofollow noreferrer\">this implementation</a> using Eigen may be usefull for you. As an alternative, you can calculate the <a href=\"https://en.wikipedia.org/wiki/Cross-correlation#Time_delay_analysis\" rel=\"nofollow noreferrer\">cross correlation</a> yourself based on <a href=\"http://stackoverflow.com/questions/15138634/eigen-is-there-an-inbuilt-way-to-calculate-sample-covariance\">this post</a>"}], "owner": {"reputation": 1, "user_id": 7641816, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210501328587731/picture?type=large", "display_name": "Edward James", "link": "https://stackoverflow.com/users/7641816/edward-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 592, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488381405, "creation_date": 1488378713, "last_edit_date": 1488381405, "question_id": 42534392, "link": "https://stackoverflow.com/questions/42534392/cross-correlation-of-two-signals-di-and-microphone", "title": "Cross-Correlation of Two Signals (DI and Microphone)", "body": "<p>I'm wondering if anyone would possibly be able to give me some advice on how to implement a cross-correlation function within two simple delay lines that I have set up. My problem is that I have two hard coded delay lines that I can manually change to align two signals going in. I'm using a DI signal and a microphone signal from a bass amp. If I use this code in its current state it will delay the DI signal, but what I want it to do, is take the two signals and align them within the DSP for it to output them in phase with one and other. My current code can be seen below:</p>\n\n<pre><code>#include &lt;Bela.h&gt;\n#define DELAY_BUFFER_SIZE 44100\n// Buffer holding previous samples per channel\nfloat gDelayBuffer_l[DELAY_BUFFER_SIZE] = {0};\nfloat gDelayBuffer_r[DELAY_BUFFER_SIZE] = {0};\n// Write pointer\nint gDelayBufWritePtr = 0;\n// Amount of delay\nfloat gDelayAmount = 1;\n// Amount of feedback\nfloat gDelayFeedbackAmount = 0;\n// Level of pre-delay input\nfloat gDelayAmountPre = 1;\n// Amount of delay in samples \nint gDelayInSamples = 22050;\n\n// Buffer holding previous samples per channel\nfloat hDelayBuffer_l[DELAY_BUFFER_SIZE] = {0};\nfloat hDelayBuffer_r[DELAY_BUFFER_SIZE] = {0};\n// Write pointer\nint hDelayBufWritePtr = 0;\n// Amount of delay\nfloat hDelayAmount = 1;\n// Amount of feedback\nfloat hDelayFeedbackAmount = 0;\n// Level of pre-delay input\nfloat hDelayAmountPre = 1;\n// Amount of delay in samples \nint hDelayInSamples = 44100;\n\nbool setup(BelaContext *context, void *userData)\n{\n\n    return true;\n}\n\nvoid render(BelaContext *context, void *userData)\n{\n\n    for(unsigned int n = 0; n &lt; context-&gt;analogFrames; n++) {\n\n        float out_l = 0;\n        float out_r = 0;\n\n        // Read audio inputs\n        out_l = analogRead(context,n,0);\n        out_r = analogRead(context,n,1);\n\n        // Increment delay buffer write pointer\n        if(++gDelayBufWritePtr&gt;DELAY_BUFFER_SIZE)\n            gDelayBufWritePtr = 0;\n\n\n               // Increment delay buffer write pointer\n\n        // Calculate the sample that will be written into the delay buffer...\n        // 1. Multiply the current (dry) sample by the pre-delay gain level (set above)\n        // 2. Get the previously delayed sample from the buffer, multiply it by the feedback gain and add it to the current sample\n        float del_input_l = (gDelayAmountPre * out_l + gDelayBuffer_l[(gDelayBufWritePtr-gDelayInSamples+DELAY_BUFFER_SIZE)%DELAY_BUFFER_SIZE] * gDelayFeedbackAmount);\n        float del_input_r = (gDelayAmountPre * out_r + gDelayBuffer_r[(gDelayBufWritePtr-gDelayInSamples+DELAY_BUFFER_SIZE)%DELAY_BUFFER_SIZE] * gDelayFeedbackAmount);\n\n\n        //  Now we can write it into the delay buffer\n        gDelayBuffer_l[gDelayBufWritePtr] = del_input_l;\n        gDelayBuffer_r[gDelayBufWritePtr] = del_input_r;\n\n\n\n        // Get the delayed sample (by reading `gDelayInSamples` many samples behind our current write pointer) and add it to our output sample\n        out_l = gDelayBuffer_l[(gDelayBufWritePtr-gDelayInSamples+DELAY_BUFFER_SIZE)%DELAY_BUFFER_SIZE] * gDelayAmount;\n        out_r = gDelayBuffer_r[(gDelayBufWritePtr-gDelayInSamples+DELAY_BUFFER_SIZE)%DELAY_BUFFER_SIZE] * gDelayAmount;\n\n       // Write the sample into the output buffer\n        analogWrite(context, n, 0, out_l);\n        analogWrite(context, n, 1, out_r);\n\n    }\n    for(unsigned int n = 0; n &lt; context-&gt;analogFrames; n++) {\n\n        float out_l = 0;\n        float out_r = 0;\n\n        // Read audio inputs\n       out_l = analogRead(context,n,2);\n        out_r = analogRead(context,n,3);\n        // Increment delay buffer write pointer\n        if(++hDelayBufWritePtr&gt;DELAY_BUFFER_SIZE)\n            hDelayBufWritePtr = 0;\n\n               // Increment delay buffer write pointer\n        if(++hDelayBufWritePtr&gt;DELAY_BUFFER_SIZE)\n            hDelayBufWritePtr = 0;\n\n        // Calculate the sample that will be written into the delay buffer...\n        // 1. Multiply the current (dry) sample by the pre-delay gain level (set above)\n        // 2. Get the previously delayed sample from the buffer, multiply it by the feedback gain and add it to the current sample\n        float del_input_l = (hDelayAmountPre * out_l + hDelayBuffer_l[(hDelayBufWritePtr-hDelayInSamples+DELAY_BUFFER_SIZE)%DELAY_BUFFER_SIZE] * hDelayFeedbackAmount);\n        float del_input_r = (hDelayAmountPre * out_r + hDelayBuffer_r[(hDelayBufWritePtr-hDelayInSamples+DELAY_BUFFER_SIZE)%DELAY_BUFFER_SIZE] * hDelayFeedbackAmount);\n\n\n\n        //  Now we can write it into the delay buffer\n        hDelayBuffer_l[hDelayBufWritePtr] = del_input_l;\n        hDelayBuffer_r[hDelayBufWritePtr] = del_input_r;\n\n        // Get the delayed sample (by reading `gDelayInSamples` many samples behind our current write pointer) and add it to our output sample\n        out_l = hDelayBuffer_l[(hDelayBufWritePtr-hDelayInSamples+DELAY_BUFFER_SIZE)%DELAY_BUFFER_SIZE] * hDelayAmount;\n        out_r = hDelayBuffer_r[(hDelayBufWritePtr-hDelayInSamples+DELAY_BUFFER_SIZE)%DELAY_BUFFER_SIZE] * hDelayAmount;\n\n        // Write the sample into the output buffer\n\n        analogWrite(context, n, 2, out_l);\n        analogWrite(context, n, 3, out_r);\n\n\n\n}\n}\nvoid cleanup(BelaContext *context, void *userData)\n{\n}\n</code></pre>\n"}]