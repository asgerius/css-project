[{"tags": ["c++"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1565223054, "post_id": 57403578, "comment_id": 101288781, "body": "possible issue is with copy of <code>Data</code>: default one is &quot;wrong&quot; as no longer pointing on self."}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1565223162, "post_id": 57403578, "comment_id": 101288807, "body": "@Jarod42 of course, I&#39;ll edit"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1565223473, "post_id": 57403578, "comment_id": 101288863, "body": "Passing <code>this</code> to its member just add some dependency that we have to care, including: Not use <code>this</code> pointer until object is constructed, lifetime, ..."}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1565223659, "post_id": 57403578, "comment_id": 101288896, "body": "@Jarod42 so this code is simply wrong? Yet, it works fine."}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1565224512, "post_id": 57403578, "comment_id": 101289054, "body": "@Jarod42 as I understand, the space for the Data instance is allocated before the constructor is run, so it should be fine."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 2, "creation_date": 1565224688, "post_id": 57403578, "comment_id": 101289091, "body": "As long as the member you pass <code>this</code> to only stores the pointer and doesn&#39;t try accessing members in <code>this</code>, it&#39;s fine."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 2, "creation_date": 1565227801, "post_id": 57403578, "comment_id": 101289629, "body": "One alternative is, instead of storing a <code>_data</code> pointer in your <code>OtherData</code> class (and having to worry about it becoming invalid e.g. after a copy), have your <code>Data</code> class pass <code>this</code> as a method-argument to any <code>OtherData</code> methods that need access to the common data.  This assumes/enforces that only the <code>Data</code> class will be calling those methods, and it&#39;s fairly robust in that the passed in <code>this</code>-pointer argument will always be valid.  (It may add a small amount of runtime overhead for the extra argument, but OTOH it reduces memory usage by not storing redundant pointers)"}], "answers": [{"comments": [{"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565224042, "post_id": 57403740, "comment_id": 101288974, "body": "I went with option A (I do not want to copy/move). What about @Jarod42&#39;s comment concerning using this before the object is constructed?"}], "tags": [], "owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 0, "last_activity_date": 1565223847, "creation_date": 1565223847, "answer_id": 57403740, "question_id": 57403578, "link": "https://stackoverflow.com/questions/57403578/is-it-ok-to-pass-this-to-member/57403740#57403740", "title": "Is it ok to pass this to member?", "body": "<p>This is a frail design. Copy or move around the initial <code>Data</code> (e.g. passing as argument by value) object and you've got mayhem.</p>\n\n<h3>Option A: disable copying and moving of <code>Data</code> objects</h3>\n\n<p>One way of dealing with this is to just disable copying and moving. Once a <code>Data</code> object is created it cannot be copied or moved, thus ensuring the pointers within <code>OtherData</code> stay valid. This is quick solution, but very restrictive, however it can be acceptable in some very specific scenarios.</p>\n\n<pre><code>struct Data\n{\n     Data() { /* .. */ }\n\n     Data(const Data&amp;) = delete;\n     Data(Data&amp;&amp;) = delete;\n     Data&amp; operator=(const Data&amp;) = delete;\n     Data&amp; operator=(Data&amp;&amp;) = delete;\n};\n</code></pre>\n\n<h3>Option B: use smart pointers</h3>\n\n<p>Whenever you've dealing with a resource that needs to be accessed from multiple objects, consider smart pointers - which implement RAII. Now you have to choose between <code>unique_ptr</code> and <code>shared_ptr</code>. If the <code>CommonData</code> needs to live as long as <code>Data</code> objects (no <code>OtherData</code> outlive <code>Data</code>) then you can use <code>unique_ptr</code>, else you need <code>shared_ptr</code>.</p>\n\n<p>Example using <code>unique_ptr</code>:</p>\n\n<pre><code>#include &lt;memory&gt;\n\nstruct CommonData\n{\n    int a;\n\n    CommonData(int a) : a{a} {}\n};\n\nstruct Data;\n\nstruct OtherData\n{\n    OtherData(const CommonData* common_data) : _common_data { common_data } {}\n    const CommonData* _common_data;\n    int getCommonData() const;\n};\n\nstruct Data\n{\n    Data()\n        : _common_data{std::make_unique&lt;CommonData&gt;(1) },\n        _data1 { _common_data.get() },\n        _data2 {  _common_data.get() }\n    {}\n\n    // this field must be declared before any `OtherData` fields\n    std::unique_ptr&lt;CommonData&gt; _common_data;\n    OtherData _data1, _data2;\n};\n\nint OtherData::getCommonData() const  { return _common_data-&gt;a; }\n</code></pre>\n"}], "owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565223847, "creation_date": 1565222327, "last_edit_date": 1565223523, "question_id": 57403578, "link": "https://stackoverflow.com/questions/57403578/is-it-ok-to-pass-this-to-member", "title": "Is it ok to pass this to member?", "body": "<p>I have a class <code>Data</code>. That class contains 2 (or more) instances of class <code>OtherData</code>. Now, each instance of <code>OtherData</code> (stored as a member in class <code>Data</code>) has some data in common. I do not want each instance of <code>OtherData</code> to have a copy of that data they have in common. For example, <code>OtherData</code> could share an object of type <code>CommonData</code>. </p>\n\n<p>Now, I decided to store the common data in the <code>Data</code> class. Upon construction, the instances of <code>OtherData</code> would then receive a pointer to the <code>Data</code> instance in order to be able to access the common data. I decided to do it that way to avoid the implementation of the class <code>CommonData</code>. It just seemed easier and shorter.</p>\n\n<p>A short example:</p>\n\n<pre><code>// the class which contains the common data as well as the instances of OtherData\nstruct Data;\n\nstruct OtherData\n{\n    OtherData(const Data* data) : _data { data } {}\n    const Data* _data;\n    int getCommonData() const;\n};\n\nstruct Data\n{\n    Data() : _data1 { this }, _data2 { this } {}\n    Data(const Data&amp;) = delete;\n    Data(Data&amp;&amp;) = delete;\n    Data&amp; operator=(const Data&amp;) = delete;\n    Data&amp; operator=(Data&amp;&amp;) = delete;\n    OtherData _data1, _data2;\n    int getData() const { return 1; }\n};\n\nint OtherData::getCommonData() const  { return _data-&gt;getData(); }\n</code></pre>\n\n<p>Now, from an instance of <code>OtherData</code>, I can easily obtain the common data.</p>\n\n<p>I usually avoid passing <code>this</code> to a member, I hate circular dependencies (with that I mean an object containing another object and the latter having a reference or pointer to the former). However, it seemed so easy and I fail to demonstrate it's a bad design.</p>\n\n<p>So, my question is: would you avoid such design, and why? Or do you think it is acceptable?</p>\n"}, {"tags": ["c++", "function", "class", "templates", "mixing"], "comments": [{"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1565222142, "post_id": 57403519, "comment_id": 101288585, "body": "You can&#39;t have a cpp file when using templates. Put it all in the header file."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 1, "creation_date": 1565224249, "post_id": 57403519, "comment_id": 101289007, "body": "@TheQuantumPhysicist You <i>can</i> if you instantiate the versions you&#39;d like to support in the cpp file explicitly (which sort of removes many of the benefits of using templates but sometimes makes sense)."}, {"owner": {"reputation": 21, "user_id": 9431744, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155473593588207/picture?type=large", "display_name": "Christian Galleisky", "link": "https://stackoverflow.com/users/9431744/christian-galleisky"}, "edited": false, "score": 0, "creation_date": 1565234106, "post_id": 57403519, "comment_id": 101290706, "body": "You guys are awesome thanks so much!"}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565280306, "post_id": 57403519, "comment_id": 101313161, "body": "@TedLyngmo I know man... I wrote that comment like 12 AM at night, and I was thinking &quot;Oh, do I have to mention specializations? Maybe not... I think anyone reading my comment will know I&#39;m talking about the specific example&quot;... I was wrong :-) I do this all template specialization thing often to solve circular dependency problems."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 1, "creation_date": 1565281516, "post_id": 57403519, "comment_id": 101313765, "body": "@TheQuantumPhysicist  There&#39;s always one :-)"}], "answers": [{"comments": [{"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "reply_to_user": {"reputation": 21, "user_id": 9431744, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155473593588207/picture?type=large", "display_name": "Christian Galleisky", "link": "https://stackoverflow.com/users/9431744/christian-galleisky"}, "edited": false, "score": 2, "creation_date": 1565241957, "post_id": 57403595, "comment_id": 101292355, "body": "@ChristianGalleisky If this answers your question, please mark it as an Answer. This helps others and encourages contributers"}], "tags": [], "owner": {"reputation": 1030, "user_id": 4080543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09a1ce48bfe85fb56524408afe18fe89?s=128&d=identicon&r=PG&f=1", "display_name": "MTMD", "link": "https://stackoverflow.com/users/4080543/mtmd"}, "is_accepted": false, "score": 0, "last_activity_date": 1565222837, "last_edit_date": 1565222837, "creation_date": 1565222431, "answer_id": 57403595, "question_id": 57403519, "link": "https://stackoverflow.com/questions/57403519/mixing-class-and-function-templates/57403595#57403595", "title": "Mixing Class and Function templates", "body": "<p>Yes you can have a class template that includes a function template. Your problem is that you are trying to remove function definitions from header files. When you are using templates, you should include the function definitions in the header file. Note that you can practice such pattern only when you use template. Here is an example:</p>\n\n<p>header.h</p>\n\n<pre><code>template &lt;class T&gt;\nclass fun{\npublic:\n  template&lt;class U, class V&gt; T add(U u, V v) {\n          return u + v;\n  }\nprivate:\n  T data;\n};\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"header.h\"\n\nint main () {\n        fun&lt;int&gt; f;\n        std::cout &lt;&lt; f.add(10, 12) &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "is_accepted": true, "score": 0, "last_activity_date": 1565226692, "creation_date": 1565226692, "answer_id": 57404011, "question_id": 57403519, "link": "https://stackoverflow.com/questions/57403519/mixing-class-and-function-templates/57404011#57404011", "title": "Mixing Class and Function templates", "body": "<p>The class template definitions need to be known at compile-time to generate the class from the template, so the most common method is to include the definitions in the header file. If you still want to keep the interface and method definitions seperated you could use a <code>.tpp</code> file.</p>\n\n<p>Here's a general approach, that creates a class from externally unique data types.</p>\n\n<p>I.e. That you want <code>template &lt;class U, class V&gt; T fun&lt;T&gt;::add(U a, V b){return a+b;}</code> instead of <code>template &lt;class T, class U&gt; T fun&lt;T&gt;::add(T a, U b){return a+b;}</code></p>\n\n<p>header.h:</p>\n\n<pre><code>template &lt;class T&gt;\nclass fun{\npublic:\n    template&lt;class U, class V&gt; T add(U, V);\nprivate:\n    T data;\n};\n\n#include \"header.tpp\"\n</code></pre>\n\n<p>header.tpp:</p>\n\n<pre><code>// out of class definition of fun&lt;T&gt;::add&lt;U, V&gt; \ntemplate&lt;class T&gt; // for the enclosing class template\ntemplate&lt;class U, class V&gt; // for the member function template\nT fun&lt;T&gt;::add(U a, V b) { return a + b; }\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9431744, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155473593588207/picture?type=large", "display_name": "Christian Galleisky", "link": "https://stackoverflow.com/users/9431744/christian-galleisky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 1, "accepted_answer_id": 57404011, "answer_count": 2, "score": 1, "last_activity_date": 1565233951, "creation_date": 1565221564, "last_edit_date": 1565233951, "question_id": 57403519, "link": "https://stackoverflow.com/questions/57403519/mixing-class-and-function-templates", "title": "Mixing Class and Function templates", "body": "<p>Hi I am trying to make a C++ class template and have it poses a function template too.. it boils down to </p>\n\n<pre><code>template &lt;class T&gt; \nclass fun{\npublic:\n    template&lt;class U, class V&gt; T add(U, V);\nprivate:\n    T data;};\n</code></pre>\n\n<p>I've have tried rewriting the signature in the cpp file (as opposed to the header file written above) many different ways. I'm starting to think that you can't have a class as a template AND have it have function templates as well.. Can you?</p>\n\n<p>In the cpp file it looks like this and I get an error saying my declaration of the function \"add\" in the cpp file is incompatible with my declaration of \"add\" in the header file.</p>\n\n<p>This is my function template in the cpp file.</p>\n\n<pre><code>template &lt;class T, class U&gt; T fun&lt;T&gt;::add(T a, U b){return a+b;}\n</code></pre>\n"}, {"tags": ["c++", "implicit-conversion", "gcc-warning"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1565222966, "post_id": 57403497, "comment_id": 101288760, "body": "The more verbose error messages with gcc 9 point towards the static_cast as the source of the warning. The warning goes away if only the static_cast gets passed as a parameter. gcc seems to have a beef with the <code>int</code> getting converted to <code>size_t</code>, but only for the addition operation. Apparently an explicit cast to <code>size_t</code> is insufficient to shut it up for the <code>+</code> operator, but it keeps it silent if the result is passed as a parameter."}, {"owner": {"reputation": 846, "user_id": 8360627, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213497434168304/picture?type=large", "display_name": "John Ilacqua", "link": "https://stackoverflow.com/users/8360627/john-ilacqua"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1565223218, "post_id": 57403497, "comment_id": 101288819, "body": "Something interesting to note is that if I move the <code>sizeof</code> into a local variable, it warns if it&#39;s declared as <code>auto</code>, but not if it&#39;s declared as <code>size_t</code>. Perhaps something odd in the return type of <code>sizeof</code>?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1565227657, "post_id": 57403497, "comment_id": 101289609, "body": "Surely the warning pertains to the conversion from <code>i</code> to <code>size_t</code>, not the addition . Perhaps clang treats the explicit cast as programmer meta-communication to suppress the warning"}, {"owner": {"reputation": 846, "user_id": 8360627, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213497434168304/picture?type=large", "display_name": "John Ilacqua", "link": "https://stackoverflow.com/users/8360627/john-ilacqua"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1565239119, "post_id": 57403497, "comment_id": 101291650, "body": "@M.M in asking the question, I was assuming that the warning does what the documentation says it does and only warn on implicit conversions, so was thinking for some reason gcc was doing an implicit conversion somewhere in that call. As stated in the now-accepted answer, the issue is in gcc&#39;s implementation of the warning not matching its documentation, not that it&#39;s doing an unexpected implicit conversion."}], "answers": [{"comments": [{"owner": {"reputation": 846, "user_id": 8360627, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213497434168304/picture?type=large", "display_name": "John Ilacqua", "link": "https://stackoverflow.com/users/8360627/john-ilacqua"}, "edited": false, "score": 0, "creation_date": 1565223074, "post_id": 57403600, "comment_id": 101288787, "body": "It&#39;s not supposed to warn for the explicit cast, only for implicit ones. There is no warning without performing arithmetic on the result of the cast with the result of <code>sizeof</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 846, "user_id": 8360627, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213497434168304/picture?type=large", "display_name": "John Ilacqua", "link": "https://stackoverflow.com/users/8360627/john-ilacqua"}, "edited": false, "score": 0, "creation_date": 1565227084, "post_id": 57403600, "comment_id": 101289524, "body": "@JohnIlacqua: Who says it&#39;s not supposed to warn for explicit casts? Compilers can warn about anything they like. (BTW, there&#39;s n no such thing as an &quot;implicit cast&quot;; a cast is an explicit conversion.)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 846, "user_id": 8360627, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213497434168304/picture?type=large", "display_name": "John Ilacqua", "link": "https://stackoverflow.com/users/8360627/john-ilacqua"}, "edited": false, "score": 0, "creation_date": 1565227260, "post_id": 57403600, "comment_id": 101289546, "body": "@JohnIlacqua: But the behavior does seem to contradict gcc&#39;s documentation. The OP explicitly used <code>-Wsign-conversion</code> when invoking gcc, and the documentation says &quot;An explicit cast silences the warning&quot;."}, {"owner": {"reputation": 1295, "user_id": 2279765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432916361960d8ddbb2d4bdb8369b78f?s=128&d=identicon&r=PG", "display_name": "Tomer", "link": "https://stackoverflow.com/users/2279765/tomer"}, "edited": false, "score": 0, "creation_date": 1565227738, "post_id": 57403600, "comment_id": 101289618, "body": "I have updated my answer and added the relevant text from the GCC documentation. Hope this now clarifies it."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1565228375, "post_id": 57403600, "comment_id": 101289719, "body": "It turns out this is a known bug in gcc. See my answer."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 2, "creation_date": 1565228413, "post_id": 57403600, "comment_id": 101289725, "body": "@Tomer: The docs you linked specify for <code>-Wsign-conversion</code> itself (emphasis added): &quot;Warn for <i>implicit</i> conversions that may change the sign of an integer value, like assigning a signed integer expression to an unsigned integer variable. <i>An explicit cast silences the warning.</i>&quot; The cast here is explicit, the addition is <code>size_t + size_t</code> and the result is passed as <code>size_t</code>, so no implicit casting is occurring."}], "tags": [], "owner": {"reputation": 1295, "user_id": 2279765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432916361960d8ddbb2d4bdb8369b78f?s=128&d=identicon&r=PG", "display_name": "Tomer", "link": "https://stackoverflow.com/users/2279765/tomer"}, "is_accepted": false, "score": -2, "last_activity_date": 1565231089, "last_edit_date": 1565231089, "creation_date": 1565222484, "answer_id": 57403600, "question_id": 57403497, "link": "https://stackoverflow.com/questions/57403497/gcc-size-t-and-sizeof-arithmetic-conversion-to-int/57403600#57403600", "title": "gcc size_t and sizeof arithmetic conversion to int", "body": "<p>The warning is correct.</p>\n\n<p>If <code>i</code> has a negative value the casting will be problematic. Your function should return an unsigned value (e.g. unsigned int).</p>\n\n<p>From GCC documentation - <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html</a>:</p>\n\n<blockquote>\n  <p>For C++, also warn for confusing overload resolution for user-defined conversions; and conversions that never use a type conversion operator: conversions to <code>void</code>, the same type, a base class or a reference to them. Warnings about conversions between signed and unsigned integers are disabled by default in C++ unless <code>-Wsign-conversion</code> is explicitly enabled.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 846, "user_id": 8360627, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213497434168304/picture?type=large", "display_name": "John Ilacqua", "link": "https://stackoverflow.com/users/8360627/john-ilacqua"}, "edited": false, "score": 0, "creation_date": 1565235244, "post_id": 57404123, "comment_id": 101290923, "body": "Thanks. I had assumed that the warning was correctly implemented and that there was some sort of unexpected implicit conversion happening, but that makes sense - for some reason, in certain contexts the explicit cast fails to silence the warning."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 5, "last_activity_date": 1565386118, "last_edit_date": 1565386118, "creation_date": 1565228105, "answer_id": 57404123, "question_id": 57403497, "link": "https://stackoverflow.com/questions/57403497/gcc-size-t-and-sizeof-arithmetic-conversion-to-int/57404123#57404123", "title": "gcc size_t and sizeof arithmetic conversion to int", "body": "<p>This is a known bug in gcc, now fixed but not yet released.</p>\n\n<p>The warning is valid (compilers can warn about anything they like), but gcc's behavior contradicts its own documentation. There is an existing bug report for this problem (see below).</p>\n\n<p>Here's a simpler test case that illustrates the issue:</p>\n\n<pre><code>#include &lt;cstddef&gt;\nint main() {\n    int i = 42;\n    size_t s0 = sizeof (int) + (size_t)i;\n    size_t s1 = sizeof (int) + static_cast&lt;size_t&gt;(i);\n}\n</code></pre>\n\n<p>When I compile it on my system using gcc 9.1.0, I get:</p>\n\n<pre><code>$ g++ -Wsign-conversion -c c.cpp\nc.cpp: In function \u2018int main()\u2019:\nc.cpp:4:32: warning: conversion to \u2018long unsigned int\u2019 from \u2018int\u2019 may change the sign of the result [-Wsign-conversion]\n    4 |     size_t s0 = sizeof (int) + (size_t)i;\n      |                                ^~~~~~~~~\nc.cpp:5:32: warning: conversion to \u2018long unsigned int\u2019 from \u2018int\u2019 may change the sign of the result [-Wsign-conversion]\n    5 |     size_t s1 = sizeof (int) + static_cast&lt;size_t&gt;(i);\n      |                                ^~~~~~~~~~~~~~~~~~~~~~\n$ \n</code></pre>\n\n<p>Note that the warning occurs both for a C-style cast and for a <code>static_cast</code>.</p>\n\n<p>It's true that the conversion may change the sign of the result (converting a negative <code>int</code> to <code>size_t</code> yields a positive result), but gcc's documentation for <code>-Wsign-conversion</code> says:</p>\n\n<pre><code>'-Wsign-conversion'\n     Warn for implicit conversions that may change the sign of an\n     integer value, like assigning a signed integer expression to an\n     unsigned integer variable.  An explicit cast silences the warning.\n     In C, this option is enabled also by '-Wconversion'.\n</code></pre>\n\n<p>In this case, an explicit cast is not silencing the warning.</p>\n\n<p>This bug has already been reported:<br>\n<a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=87519\" rel=\"nofollow noreferrer\">Bug 87519 - -Wsign-conversion -Wconversion explicit cast fails to silence warning</a><br>\nI've added my test case and a link to this question and answer to the bug report.</p>\n\n<p>A <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=87519#c12\" rel=\"nofollow noreferrer\">new comment</a> from Marek Polacek on the bug report:</p>\n\n<blockquote>\n  <p>Fixed on trunk, will backport to 9.3 later.</p>\n</blockquote>\n\n<p>The fix is commit <code>61e52125c935279af11b10d27060a96bff7477a4</code> in the gcc git repo, committed 2019-08-08.</p>\n"}], "owner": {"reputation": 846, "user_id": 8360627, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213497434168304/picture?type=large", "display_name": "John Ilacqua", "link": "https://stackoverflow.com/users/8360627/john-ilacqua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "accepted_answer_id": 57404123, "answer_count": 2, "score": 4, "last_activity_date": 1565386118, "creation_date": 1565221439, "question_id": 57403497, "link": "https://stackoverflow.com/questions/57403497/gcc-size-t-and-sizeof-arithmetic-conversion-to-int", "title": "gcc size_t and sizeof arithmetic conversion to int", "body": "<p>I decided to test compile a project with -Wsign-conversion enabled, to see what warnings would come up, and came across something that doesn't seem right, where gcc behaves differently than clang. Can someone please tell me which is correct?</p>\n\n<p>I have a function that takes a <code>size_t</code> param:</p>\n\n<pre><code>void func(size_t) {}\n</code></pre>\n\n<p>some other struct</p>\n\n<pre><code>struct Test {};\n</code></pre>\n\n<p>and calling code</p>\n\n<pre><code>int i = some_initialiser();\nfunc(sizeof(Test) + static_cast&lt;size_t&gt;(i));\n</code></pre>\n\n<p>So from my understanding, <code>sizeof</code> returns <code>size_t</code>, and arithmetic between two variables of type <code>size_t</code> should return a <code>size_t</code>, so there shouldn't be any conversion here other than my <code>static_cast</code>, but gcc gives me the warning</p>\n\n<pre><code> warning: conversion to \u2018long unsigned int\u2019 from \u2018int\u2019 may change the sign of the result [-Wsign-conversion]\n</code></pre>\n\n<p>Clang doesn't warn here, but does warn if I remove the <code>static_cast</code> in the function call, as expected.</p>\n"}, {"tags": ["c++", "types", "floating-point"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1565221401, "post_id": 57403466, "comment_id": 101288433, "body": "change <code>4 &#47; 3</code> to <code>4.0 &#47; 3.0</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1565221888, "post_id": 57403466, "comment_id": 101288532, "body": "It is a basic property of C or C++ expressions; the type of an expression only depends on the operands to the expression.  Not on any outside context.  IMO It makes the language much easier to understand . I like knowing that <code>4&#47;3</code> is always <code>1</code>  , not that <code>FOO(4&#47;3)</code> might receive a different value to <code>BAR(4&#47;3)</code>."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 3, "creation_date": 1565222090, "post_id": 57403466, "comment_id": 101288577, "body": "Because the integer calculation precedes the conversion to float."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565224321, "post_id": 57403466, "comment_id": 101289021, "body": "Go with what&#39;s easiest to read until it has been proven to be too slow, but in order to support nightmarish stuff like e to the power of pi, <code>pow</code> can be an expensive function. <code>pow(r, 3)</code> will often be far, far more expensive than <code>r*r*r</code>. Since this program is doomed to be limited by user interaction, it won&#39;t matter, but when you write more mathematically intensive programs, be suspicious of <code>pow</code>"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1565231369, "post_id": 57403466, "comment_id": 101290243, "body": "&quot;Why does a declared float calculate partially in integers?&quot;  Your question is <i>mu</i>.  It does not."}], "answers": [{"tags": [], "owner": {"reputation": 1269, "user_id": 3294286, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/o9tJ2.jpg?s=128&g=1", "display_name": "Sebastian D&#39;Agostino", "link": "https://stackoverflow.com/users/3294286/sebastian-dagostino"}, "is_accepted": true, "score": 4, "last_activity_date": 1565221729, "creation_date": 1565221729, "answer_id": 57403531, "question_id": 57403466, "link": "https://stackoverflow.com/questions/57403466/why-does-a-declared-float-calculate-partially-in-integers/57403531#57403531", "title": "Why does a declared float calculate partially in integers?", "body": "<p>When you use integer numbers in a division, the compiler understands that it has to perform an integer division.</p>\n\n<pre><code>std::cout &lt;&lt; 4 / 3;\n</code></pre>\n\n<p>That means that 4 divided 3 equals 1, and the rest can be obtained by doing <code>4 % 3</code> (that's the <strong>modulo</strong> operator)</p>\n\n<p>If you want to get a floating point division, at least one of the operands has to be a floating point type. For example:</p>\n\n<pre><code>std::cout &lt;&lt; 4.0 / 3;\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>std::cout &lt;&lt; 4 / 3.0;\n</code></pre>\n\n<p>They can also be both floating points.</p>\n\n<p>By doing this, you will be producing the expected output of 1.33333333333</p>\n"}], "owner": {"reputation": 5, "user_id": 11866312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2QsYY.jpg?s=128&g=1", "display_name": "Buggsy", "link": "https://stackoverflow.com/users/11866312/buggsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57403531, "answer_count": 1, "score": -6, "last_activity_date": 1565222111, "creation_date": 1565221209, "last_edit_date": 1565222111, "question_id": 57403466, "link": "https://stackoverflow.com/questions/57403466/why-does-a-declared-float-calculate-partially-in-integers", "title": "Why does a declared float calculate partially in integers?", "body": "<p>volume of sphere is (4/3)(pi)(r^3) not (1)(pi)(r^3)</p>\n\n<p>Why would it calculate (4/3) in integers?  I expect an explicitly declared float variable to calculate in float, not integers.</p>\n\n<p>I have tried:</p>\n\n<pre><code>float v = float(4/3) * 3.14159 * pow(r, 3);\n</code></pre>\n\n<p>I double floated ya, and it still aint floating.</p>\n\n<pre><code>    cout &lt;&lt; \"  Calculate volume of sphere\\n\";\ncout &lt;&lt; \"  __________________________\\n\";\nfloat r;\ncout &lt;&lt; \"  enter radius: \";\ncin &gt;&gt; r;\nfloat v = (4 / 3) * 3.14159 * pow(r, 3);\ncout &lt;&lt; \"  volume = \" &lt;&lt; v &lt;&lt; \"\\n\";\ncout &lt;&lt; 4 / 3;  //  4/3 equals one?  Are you kidding me?\n</code></pre>\n\n<p>I expect 4/3 to equal 1.333, not 1.</p>\n"}, {"tags": ["c++", "pimpl-idiom", "template-instantiation"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1565220821, "post_id": 57403349, "comment_id": 101288309, "body": "Interesting reading: <a href=\"http://oliora.github.io/2015/12/29/pimpl-and-rule-of-zero.html\" rel=\"nofollow noreferrer\">pimpl-and-rule-of-zero.html</a>"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1565220908, "post_id": 57403349, "comment_id": 101288330, "body": "You <i>can</i> (and often should) use a <code>unique_ptr</code> for <code>pimpl</code> as long as ju declare a destructor in the class carrying the <code>unique_ptr</code>. Example: <a href=\"https://www.fluentcpp.com/2017/09/22/make-pimpl-using-unique_ptr/\" rel=\"nofollow noreferrer\">fluentcpp.com/2017/09/22/make-pimpl-using-unique_ptr</a>"}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565221283, "post_id": 57403349, "comment_id": 101288405, "body": "@TedLyngmo not really: you cannot default-declare it, which is the whole point of my question"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1565221376, "post_id": 57403349, "comment_id": 101288427, "body": "And also <a href=\"https://herbsutter.com/gotw/_101/\" rel=\"nofollow noreferrer\">GotW #101: Compilation Firewalls, Part 2</a>"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1565221424, "post_id": 57403349, "comment_id": 101288439, "body": "Yes, you can declare it (<code>~Class();</code>), then implement (with <code>~Class() {}</code>, or with <code>~Class() = default;</code>). once the pimpl is complete."}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565221517, "post_id": 57403349, "comment_id": 101288458, "body": "@TedLyngmo I&#39;m sorry for not being specific in the prev comment. I want to write <code>~PimplMe() = default</code> <b>in the header</b>"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 2, "creation_date": 1565222006, "post_id": 57403349, "comment_id": 101288559, "body": "Ok, but I think you are causing more work than it&#39;s worth with that requirement. By moving the definition of the dtor into the implementation file, after the pimpl is completely defined, you&#39;re all set."}], "answers": [{"comments": [{"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 0, "creation_date": 1565222015, "post_id": 57403540, "comment_id": 101288561, "body": "&quot;Solution is simply to default them right in the source file instead.&quot; I am aware of this solution, and find it boilerplate"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 2, "creation_date": 1565222103, "post_id": 57403540, "comment_id": 101288578, "body": "@NikitaPetrenko Boilerplate? You put one line for the destructor last in the implementation file to make it work. Compare that with your proposal."}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565222473, "post_id": 57403540, "comment_id": 101288647, "body": "@TedLyngmo my proposal is written only once for the whole library, it is asymptotically better :)"}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565222643, "post_id": 57403540, "comment_id": 101288694, "body": "@TedLyngmo and, by the way, @Jarod42 gave a link to the same idea that I&#39;ve implemented, but which reuses <code>std::unique_ptr</code>"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 0, "creation_date": 1565222662, "post_id": 57403540, "comment_id": 101288698, "body": "@NikitaPetrenko :-) I&#39;ll give you that! My own version of what you are doing looked fairly similar and I was also on the verge of dividing it into two files etc. I folded eventually :-) My goal was however to create a <code>copyable_unique_ptr</code> that could be used with <code>pimpl</code> to be able to use the <code>default</code> copy ctor and assignment operator of the carrying class (which <code>unique_ptr</code> don&#39;t support)."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 0, "creation_date": 1565222843, "post_id": 57403540, "comment_id": 101288736, "body": "@NikitaPetrenko Yeah, the link Jarod42 shared seems to resemble what I&#39;ve seen before. Good stuff."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 1, "creation_date": 1565223126, "post_id": 57403540, "comment_id": 101288797, "body": "@NikitaPetrenko But doesn&#39;t your solution instead need boilerplate of calling <code>MakePimplPtr</code>? I don&#39;t see a reduction of boilerplate."}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 0, "creation_date": 1565223786, "post_id": 57403540, "comment_id": 101288918, "body": "@eerorika well, I could add a constructor which would not require it. It is not the point -- what I want is to escape from defining destructors and move operators in the .cpp file."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 2, "creation_date": 1565225135, "post_id": 57403540, "comment_id": 101289158, "body": "@NikitaPetrenko You trade off the smallest amount of boilerplate for a runtime penalty? I&#39;m very skeptical of this idea. The pimpl pattern requires a lot of boilerplate anyway. If what you want is to reduce boilerplate, you should skip the pimpl pattern altogether. Otherwise, <code>MyClass::~MyClass() = default;</code> is barely any boilerplate at all. You can still define the move operations in the header file; only the destructor needs to be in the cpp file."}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1565225459, "post_id": 57403540, "comment_id": 101289220, "body": "@Justin if one uses pimpl for performance critical code, then I have bad news for him. Second, using the approach proposed in the answer leads to cryptic errors like <code>incomplete type</code> (though they are compile-time, but it is possible to avoid them)"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 0, "creation_date": 1565226252, "post_id": 57403540, "comment_id": 101289376, "body": "@NikitaPetrenko For someone having implemented pimpl a few times, an error like <code>incomplete type</code> sounds familiar and I&#39;d quickly google the resolution, if I didn&#39;t remember it right away."}, {"owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565226907, "post_id": 57403540, "comment_id": 101289489, "body": "@TedLyngmo maybe I&#39;m a little too keen on perfection, but I believe that the most universal solution which <code>unique_ptr</code> provides is far from perfect. And, for such a popular idiom, one should come up with something that is perfectly tailored (if the language permits -- C++ always does, that&#39;s why I like it)"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "edited": false, "score": 0, "creation_date": 1565227147, "post_id": 57403540, "comment_id": 101289533, "body": "@NikitaPetrenko I like the ambition for sure! Cheers!"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1565222394, "last_edit_date": 1565222394, "creation_date": 1565221832, "answer_id": 57403540, "question_id": 57403349, "link": "https://stackoverflow.com/questions/57403349/implementing-pimpl-friendly-unique-ptr/57403540#57403540", "title": "Implementing pimpl-friendly unique_ptr", "body": "<blockquote>\n  <p>One may not default destructor and move operator right in the header file</p>\n</blockquote>\n\n<p>Solution is simply to default them right in the source file instead.</p>\n\n<p>While it might not be obvious how to implement PIMPL with unique pointer, it is certainly not impossible, and by writing a re-usable template, the non-obvious parts can be repeated conveniently.</p>\n\n<p>I've written following in the past; I haven't checked if latest standard versions offer a way to simplify it:</p>\n\n<pre><code>// pimpl.hpp (add header guards of your choice)\n\n#include &lt;memory&gt;\ntemplate &lt;class T&gt;\nclass pimpl {\npublic:\n    pimpl(pimpl&amp;&amp;);\n\n    ~pimpl();\n\n    template &lt;class... Args&gt;\n    pimpl(Args&amp;&amp;...);\n\n    T* operator-&gt;();\n    const T* operator-&gt;() const;\n\n    T&amp; operator*();\n    const T&amp; operator*() const;\n\nprivate:\n    std::unique_ptr&lt;T&gt; m;\n};\n</code></pre>\n\n<hr>\n\n<pre><code>// pimpl_impl.hpp (add header guards of your choice)\n#include &lt;utility&gt;\n#include \"pimpl.hpp\"\n\ntemplate &lt;class T&gt;\npimpl&lt;T&gt;::pimpl(pimpl&amp;&amp;) = default;\n\ntemplate &lt;class T&gt;\npimpl&lt;T&gt;::~pimpl() = default;\n\ntemplate &lt;class T&gt;\ntemplate &lt;class... Args&gt;\npimpl&lt;T&gt;::pimpl(Args&amp;&amp;... args) : m{new T{std::forward&lt;Args&gt;(args)...}} {}\n\ntemplate &lt;class T&gt;\nT* pimpl&lt;T&gt;::operator-&gt;() {\n    return m.get();\n}\n\ntemplate &lt;class T&gt;\nconst T* pimpl&lt;T&gt;::operator-&gt;() const {\n    return m.get();\n}\n\ntemplate &lt;class T&gt;\nT&amp; pimpl&lt;T&gt;::operator*() {\n    return *m.get();\n}\n\ntemplate &lt;class T&gt;\nconst T&amp; pimpl&lt;T&gt;::operator*() const {\n    return *m.get();\n}\n</code></pre>\n\n<hr>\n\n<pre><code>// usage.hpp (add header guards of your choice)\n#include \"pimpl.hpp\"\n\nstruct my_class {\n    my_class();\n    ~my_class();\n\nprivate:\n    pimpl&lt;struct my_impl&gt; m;\n};\n</code></pre>\n\n<hr>\n\n<pre><code>// usage.cpp\n#include \"usage.hpp\"\n#include \"pimpl_impl.hpp\"\n\nstruct my_impl {};\n\nmy_class::my_class() = default;\nmy_class::~my_class() = default;\n</code></pre>\n"}], "owner": {"reputation": 818, "user_id": 7091875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553895fe341c842ebba11da4deef8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Petrenko", "link": "https://stackoverflow.com/users/7091875/nikita-petrenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1565222394, "creation_date": 1565220151, "question_id": 57403349, "link": "https://stackoverflow.com/questions/57403349/implementing-pimpl-friendly-unique-ptr", "title": "Implementing pimpl-friendly unique_ptr", "body": "<p>It is widely known that <code>std::unique_ptr</code> may not be conveniently used to implement pimpl idiom: one may not <strong>default</strong> destructor and move operator <strong>right in the header file</strong> (e.g., <a href=\"https://stackoverflow.com/questions/9954518/stdunique-ptr-with-an-incomplete-type-wont-compile\">std::unique_ptr with an incomplete type won&#39;t compile</a>). Some people suggest using <code>std::shared_ptr</code> instead, because it uses some trick with destructor that overcomes it (probably just type erasure, but I'm not sure).</p>\n\n<p>I've tried to create a special smart pointer for this case, here's the implementation:</p>\n\n<pre><code>#include &lt;utility&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;class&gt;\nclass PimplPtr;\n\ntemplate &lt;class T, class... Args&gt;\nPimplPtr&lt;T&gt; MakePimplPtr(Args&amp;&amp;... args);\n\ntemplate &lt;class T&gt;\nclass PimplPtr {\n    static_assert(std::is_class_v&lt;T&gt;, \"PimplPtr is only intented for use with classes\");\n\n    template &lt;class S, class... Args&gt;\n    friend PimplPtr&lt;S&gt; MakePimplPtr(Args&amp;&amp;... args);\npublic:\n    PimplPtr() = default;\n    PimplPtr(const PimplPtr&amp;) = delete;\n    PimplPtr(PimplPtr&amp;&amp; other) {\n        ptr_ = other.ptr_;\n        other.ptr_ = nullptr;\n        dest_caller_ = other.dest_caller_;\n    }\n    PimplPtr&amp; operator=(const PimplPtr&amp;) = delete;\n    PimplPtr&amp; operator=(PimplPtr&amp;&amp; other) {\n        Reset();\n        ptr_ = other.ptr_;\n        other.ptr_ = nullptr;\n        dest_caller_ = other.dest_caller_;\n    }\n\n    ~PimplPtr() {\n        Reset();\n    }\n\n    void Reset() {\n        if (!ptr_) {\n            return;\n        }\n        // first call the destructor\n        dest_caller_(ptr_);\n        // then free the memory\n        operator delete(ptr_);\n        ptr_ = nullptr;\n    }\n\n    T* operator-&gt;() const {\n        return ptr_;\n    }\n\n    T&amp; operator*() const {\n        return *ptr_;\n    }\nprivate:\n    explicit PimplPtr(T* ptr) noexcept \n        : ptr_(ptr), dest_caller_(&amp;PimplPtr::DestCaller) {\n    }\n\n    static void DestCaller(T* ptr) {\n        ptr-&gt;~T();\n    }\n\n    using DestCallerT = void (*)(T*);\n\n    // pointer to \"destructor\"\n    DestCallerT dest_caller_;\n    T* ptr_{nullptr};\n};\n\ntemplate &lt;class T, class... Args&gt;\nPimplPtr&lt;T&gt; MakePimplPtr(Args&amp;&amp;... args) {\n    return PimplPtr{new T(std::forward&lt;Args&gt;(args)...)};\n}\n</code></pre>\n\n<p>Alternatively, one may replace pointer to function with type-erasure, though it will be less efficient, I think.</p>\n\n<p>It works:</p>\n\n<pre><code>class PimplMe {\npublic:\n    PimplMe();\n\n    // compiles\n    PimplMe(PimplMe&amp;&amp;) = default;\n    ~PimplMe() = default;\nprivate:\n    class Impl;\n    PimplPtr&lt;Impl&gt; impl_;\n};\n</code></pre>\n\n<p>The only downside I see is the little extra overhead involved: one also has to store a pointer to \"destructor\". </p>\n\n<p>I think that it is not a great deal, because 8-byte overhead is insignificant in pimpl use cases, and my question is of pure interest: is there some practical trick to eliminate space overhead caused by <code>dest_caller_</code>?</p>\n\n<p>I can think of splitting <code>PimplPtr</code> into declaration <code>pimpl.hpp</code> and definition <code>pimpl_impl.hpp</code>, and explicitly instantiating <code>template PimplPtr&lt;PimplMe::Impl&gt;::Reset()</code> in <code>impl.cpp</code>, but I believe it is ugly.</p>\n\n<p>Declaring <code>dest_caller_</code> as a static member is not a solution, at least because it will require synchronization in multi-threaded case.</p>\n"}, {"tags": ["c++", "system", "compiler-optimization"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1565219893, "post_id": 57403252, "comment_id": 101288128, "body": "Does <a href=\"https://stackoverflow.com/questions/381244/purpose-of-memory-alignment\">Purpose of memory alignment</a> and its answers help?"}, {"owner": {"reputation": 607, "user_id": 11205473, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e2QagE3M10o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdhLHiSw77o3MkHX86h0frNwn3yDw/mo/photo.jpg?sz=128", "display_name": "User 10482", "link": "https://stackoverflow.com/users/11205473/user-10482"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565220103, "post_id": 57403252, "comment_id": 101288171, "body": "@user4581301 I did have a look at this. It does outline the issue but didn&#39;t address the memory address multiplicity restriction. Thanks"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565220638, "post_id": 57403252, "comment_id": 101288279, "body": "Think of the performance problem covered in the first answer&#39;s section on speed: If the data is not aligned, multiple reads may be required. If the hardware is lined up to read 16 bit chunks, for unaligned data the CPU may have to read 16 bits, keep the upper 8, read 16 bits, keep the lower 8, assemble and place in register. This sucks. Many CPUs nip this problem in the bud by rejecting it. Those that allow it accept  the performance hit"}, {"owner": {"reputation": 607, "user_id": 11205473, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e2QagE3M10o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdhLHiSw77o3MkHX86h0frNwn3yDw/mo/photo.jpg?sz=128", "display_name": "User 10482", "link": "https://stackoverflow.com/users/11205473/user-10482"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565221184, "post_id": 57403252, "comment_id": 101288384, "body": "@user4581301 Yep, I understand what you are trying to say. The answer linked says similar. But, my question is about different issue; the issue of address itself, not the data pointed to, to be a multiple of data size. If that were not the case, I could simply move the address and extract the chunk of memory holding my data-of-appropriate-size in one read. (as I said in the latter part of the question)"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1565225247, "post_id": 57403252, "comment_id": 101289176, "body": "@User10482 I don;t understand what distinction you are drawing between the answers you&#39;ve found and been given and the question you are asking, which you seem to think is different, but isn&#39;t."}, {"owner": {"reputation": 607, "user_id": 11205473, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e2QagE3M10o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdhLHiSw77o3MkHX86h0frNwn3yDw/mo/photo.jpg?sz=128", "display_name": "User 10482", "link": "https://stackoverflow.com/users/11205473/user-10482"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1565225962, "post_id": 57403252, "comment_id": 101289322, "body": "@user207421 Explanation by immibis in the comments <a href=\"https://stackoverflow.com/a/57403564/11205473\">here</a> and answer by Tanque <a href=\"https://stackoverflow.com/a/57403499/11205473\">here</a> cleared the confusion that I specifically had."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565223812, "post_id": 57403333, "comment_id": 101288922, "body": "Except in systems with very unusual hardware you cannot do an unaligned access with a single access. ARM allows unaligned access, but it comes at a cost and with caveats."}], "tags": [], "owner": {"reputation": 500, "user_id": 5280925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8b66528b6528271dff348e018d612f7?s=128&d=identicon&r=PG&f=1", "display_name": "Skrino", "link": "https://stackoverflow.com/users/5280925/skrino"}, "is_accepted": false, "score": 1, "last_activity_date": 1565221648, "last_edit_date": 1565221648, "creation_date": 1565220048, "answer_id": 57403333, "question_id": 57403252, "link": "https://stackoverflow.com/questions/57403252/data-alignment-reason-for-restriction-on-memory-address-being-multiple-of-data/57403333#57403333", "title": "Data Alignment: Reason for restriction on memory address being multiple of data type size", "body": "<p>The assumption about that statement is not necessarily true. I don't want to re-iterate the answer you linked to describing the reasons for using and highly preferring aligned access, but there are architectures that do support unaligned memory access -- ARM for example (check out this <a href=\"https://stackoverflow.com/a/32095106/5280925\">SO answer</a>). </p>\n\n<p>But your question, I think, really comes down to hardware architecture, specifically the data bus design, and the accompanying instructions set that engineers at various silicon manufacturers have designed.</p>\n\n<hr>\n\n<p>Some Cortex-M cores explicitly allow you to enable a CPU to trigger an exception on <em>un-</em> aligned access by configuring a Usage Fault register, which means that you <em>can</em> \"utilize\" unaligned memory access in rare use-cases.</p>\n"}, {"comments": [{"owner": {"reputation": 182, "user_id": 2430796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5zu9P.jpg?s=128&g=1", "display_name": "Tanque", "link": "https://stackoverflow.com/users/2430796/tanque"}, "edited": false, "score": 0, "creation_date": 1565222139, "post_id": 57403499, "comment_id": 101288584, "body": "Regarding 1. One can still retrieve any byte from the loaded word via specific assembly instructions: <code>loadLeastSignificantByte $addressOfWord</code> etc."}], "tags": [], "owner": {"reputation": 182, "user_id": 2430796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5zu9P.jpg?s=128&g=1", "display_name": "Tanque", "link": "https://stackoverflow.com/users/2430796/tanque"}, "is_accepted": true, "score": 0, "last_activity_date": 1565224865, "last_edit_date": 1565224865, "creation_date": 1565221469, "answer_id": 57403499, "question_id": 57403252, "link": "https://stackoverflow.com/questions/57403252/data-alignment-reason-for-restriction-on-memory-address-being-multiple-of-data/57403499#57403499", "title": "Data Alignment: Reason for restriction on memory address being multiple of data type size", "body": "<p>Usually a processors internal addresses points to a whole word. This is because you don't want your (simple) processor be able to address a word at a random byte (or even worse: bit) because</p>\n\n<ol>\n<li><p>You waste addressable memory: presuming the biggest possible address your processor is able to process is the max value of its word size, and you can multiply that by the size of your word to calculate the amount of storage you can address. (Each unique address points to a full word) The \"address\" I'm talking about here is not necessarily looking like the address which might be stored in a pointer of a higher programming language. The pointer address addresses each byte, which will be interpreted by a compiler or interpreter into the corresponding assembly instructions (discarding unwanted bytes from the loaded word) </p></li>\n<li><p>A word loaded from memory could be anything, a value or the next instruction of the program you are running on your processor - the previous word loaded into the processor will often give an indication what the following word that gets loaded is used for: another instruction (eg arithmetic operation, load or store instruction) which might be followed by operands (values or addresses). Being able to address unaligned words would complicate a processor a lot in easy words. </p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 607, "user_id": 11205473, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e2QagE3M10o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdhLHiSw77o3MkHX86h0frNwn3yDw/mo/photo.jpg?sz=128", "display_name": "User 10482", "link": "https://stackoverflow.com/users/11205473/user-10482"}, "edited": false, "score": 0, "creation_date": 1565223300, "post_id": 57403564, "comment_id": 101288835, "body": "Okay, so it&#39;s some kind of hardware limitation on the address pointer. Applying to the example, it means I can point to 0000, 0002, 0004.... but not 0001, 0003 etc, right?) But, it seems so easy to implement one that can point anywhere. Just store the odd address in stack pointer register or any address register and read memory pointed by it. (in whatever size chunk it forces (2 bytes in the example)"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 607, "user_id": 11205473, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e2QagE3M10o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdhLHiSw77o3MkHX86h0frNwn3yDw/mo/photo.jpg?sz=128", "display_name": "User 10482", "link": "https://stackoverflow.com/users/11205473/user-10482"}, "edited": false, "score": 3, "creation_date": 1565223535, "post_id": 57403564, "comment_id": 101288875, "body": "@User10482 The pointer can point anywhere. But pretend you&#39;re a CPU connected to a 16-bit memory system (so the memory sees address 0000 as a 16-bit word, and address 0001 as a different 16-bit word, they don&#39;t overlap). When the program asks for 16 bits at 0000 you request 0000 from the memory. When the program asks for 16 bits at 0002 you request 0001 from the memory. When the program asks for 8 bits at 0003 you request 0001 from the memory and throw away half. What do you do when the program asks for 16 bits at 0003?"}, {"owner": {"reputation": 607, "user_id": 11205473, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e2QagE3M10o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdhLHiSw77o3MkHX86h0frNwn3yDw/mo/photo.jpg?sz=128", "display_name": "User 10482", "link": "https://stackoverflow.com/users/11205473/user-10482"}, "edited": false, "score": 0, "creation_date": 1565224844, "post_id": 57403564, "comment_id": 101289120, "body": "<i>(so the memory sees address 0000 as a 16-bit word, and address 0001 as a different 16-bit word, <b>they don&#39;t overlap</b>)</i> that makes so much sense now. The program is seeing the memory as uniquely addressed 1 byte sized pieces, but the processor is seeing it as sequentially numbered chunks of 2 bytes. Now I see the problem! Thanks."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 607, "user_id": 11205473, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e2QagE3M10o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdhLHiSw77o3MkHX86h0frNwn3yDw/mo/photo.jpg?sz=128", "display_name": "User 10482", "link": "https://stackoverflow.com/users/11205473/user-10482"}, "edited": false, "score": 2, "creation_date": 1565225305, "post_id": 57403564, "comment_id": 101289192, "body": "@User10482 And it can get a bit crazier than that. Thanks to virtual memory the addresses you are seeing in a program could be radically different from how the programs memory is actually laid out in storage."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1565225678, "post_id": 57403564, "comment_id": 101289261, "body": "and of course the reason they design the memory system that way is because fetching 2 chunks takes twice as long as fetching 1 chunk, no matter how big the chunks are. So they want to have really big chunks. (nowadays, bigger than 16 bits)"}], "tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 0, "last_activity_date": 1565222124, "creation_date": 1565222124, "answer_id": 57403564, "question_id": 57403252, "link": "https://stackoverflow.com/questions/57403252/data-alignment-reason-for-restriction-on-memory-address-being-multiple-of-data/57403564#57403564", "title": "Data Alignment: Reason for restriction on memory address being multiple of data type size", "body": "<blockquote>\n  <p>Assuming it's true, why \" But words can only be fetched at even addresses. \" be true? </p>\n</blockquote>\n\n<p>The memory actually stores words. The processor actually addresses the memory in words, and fetches a word at a time.</p>\n\n<p>When you fetch a byte, it actually fetches a word, then ignores either the first half or the second half.</p>\n\n<p>On 32-bit processors, it fetches a 32-bit word, then ignores three quarters; fetching a 16-bit word on a 32-bit processor ignores half the word.</p>\n\n<p>If the 16-bit word you want to fetch (on a 16-bit processor) isn't aligned, then the processor has to fetch two words, take half of each word and then re-combine them. So even on processor designs where it works, it's often slower.</p>\n\n<p>A lot of processor designs don't bother - either they just won't allow it, or they force the operating system to handle it (which is very slow).</p>\n\n<p>(Not all types of processors work this way - e.g. 8-bit processors usually fetch a byte at a time)</p>\n\n<blockquote>\n  <p>Can't the memory/stack pointer point to 0001 in the example and then read a word of information starting there?</p>\n</blockquote>\n\n<p>If the processor supports it, yes.</p>\n"}], "owner": {"reputation": 607, "user_id": 11205473, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e2QagE3M10o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdhLHiSw77o3MkHX86h0frNwn3yDw/mo/photo.jpg?sz=128", "display_name": "User 10482", "link": "https://stackoverflow.com/users/11205473/user-10482"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 1, "accepted_answer_id": 57403499, "answer_count": 3, "score": 4, "last_activity_date": 1565224865, "creation_date": 1565219100, "last_edit_date": 1565219916, "question_id": 57403252, "link": "https://stackoverflow.com/questions/57403252/data-alignment-reason-for-restriction-on-memory-address-being-multiple-of-data", "title": "Data Alignment: Reason for restriction on memory address being multiple of data type size", "body": "<p>I understand the general concept of data alignment, but what I do not understand is the restriction on memory address value, forced to be a multiple of the size of underlying data type.</p>\n\n<p><a href=\"https://stackoverflow.com/a/672482/11205473\">This answer</a> explains the data alignment well.</p>\n\n<p><strong>Quote:</strong></p>\n\n<blockquote>\n  <p>Let's look at a memory map:</p>\n\n<pre><code>+----+\n|0000| \n|0001|\n+----+\n|0002|\n|0003|\n+----+\n|0004|\n|0005|\n+----+\n| .. |\n</code></pre>\n  \n  <p>At each address there is a byte which can be accessed individually. But words can only be fetched at even addresses. So if we read a word at 0000, we read the bytes at 0000 and 0001. But if we want to read the word at position 0001, we need two read accesses. First 0000,0001 and then 0002,0003 and we only keep 0001,0002.</p>\n</blockquote>\n\n<p><strong>Question:</strong></p>\n\n<p>Assuming it's true, why <strong>\" But words can only be fetched at even addresses. \"</strong>  be true? Can't the memory/stack pointer point to 0001 in the example and then read a word of information starting there?</p>\n\n<p>We know the machine can read memory in blocks of 2 bytes with one read action, (in the example [0000, 0001] or [0002, 0003]). So if my address register is pointing to 0001 (odd address instead of even), then I can read 2 bytes from there (i.e. 0001 and 0002) directly in one read action, right?</p>\n"}, {"tags": ["c++", "visual-c++"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 2, "creation_date": 1565218051, "post_id": 57403133, "comment_id": 101287778, "body": "You should not include <code>.cc</code> files. I assume these are part of your project / already being built as part of your executable."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1565218131, "post_id": 57403133, "comment_id": 101287796, "body": "Are you cross-compiling <code>linux</code> code under <code>Visual Studio</code>? I am trying to figure out the <code>visual-c++</code> tag."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1565218184, "post_id": 57403133, "comment_id": 101287803, "body": "What version of C++ are you using?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1565218314, "post_id": 57403133, "comment_id": 101287827, "body": "Possibly the IDE is detecting the cc extension and thinking,  <i>I should compile and link these.</i> This leaves you with an <code>ocr::a</code> in banana.obj, another in apple.obj and yet another in main.obj."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 3, "creation_date": 1565218656, "post_id": 57403133, "comment_id": 101287911, "body": "I don&#39;t think it&#39;s the IDE. I suspect OP has added the files to the project <i>and</i> <code>#include</code>d them."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565219363, "post_id": 57403133, "comment_id": 101288030, "body": "However they got there, three objects are being linked. ccs6XmP2,  ccEkxDgJ, and cco0dUCm all define <code>ocr::a</code>. ccs6XmP2 and ccEkxDgJ define <code>ocr::b</code>. This lines up very well with the three cc files all being compiled and linked. This wraps around to two lessons: 1) Don&#39;t use file names that the tools (or you) could mistake as code to be compiled for header files and 2) avoid putting definitions in header files."}], "answers": [{"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": true, "score": 1, "last_activity_date": 1565223335, "creation_date": 1565223335, "answer_id": 57403696, "question_id": 57403133, "link": "https://stackoverflow.com/questions/57403133/multiple-definition-already-defined-here/57403696#57403696", "title": "multiple definition, already defined here", "body": "<p>Because you're compiling apple.cc <em>and</em> banana.cc <em>and</em> main.cc in your project.</p>\n\n<p>So you're compiling this file:</p>\n\n<pre><code>namespace ocr{\n    int a = 5;\n}\n</code></pre>\n\n<p>and this file:</p>\n\n<pre><code>namespace ocr{\n    int a = 5;\n}\n\nnamespace ocr{\n    int b = a;\n}\n</code></pre>\n\n<p>and this file:</p>\n\n<pre><code>namespace ocr{\n    int a = 5;\n}\n\nnamespace ocr{\n    int b = a;\n}\n\nint main()\n{\n    return 0;\n}\n</code></pre>\n\n<p>Obviously <code>ocr::a</code> is defined in all three files, and <code>ocr::b</code> is defined in two of them.</p>\n"}, {"tags": [], "owner": {"reputation": 442, "user_id": 9932916, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tzXpqeGz2Kg/AAAAAAAAAAI/AAAAAAAAAAA/-OUONdsc09A/photo.jpg?sz=128", "display_name": "Tagger5926", "link": "https://stackoverflow.com/users/9932916/tagger5926"}, "is_accepted": false, "score": 0, "last_activity_date": 1565236521, "creation_date": 1565236521, "answer_id": 57404996, "question_id": 57403133, "link": "https://stackoverflow.com/questions/57403133/multiple-definition-already-defined-here/57404996#57404996", "title": "multiple definition, already defined here", "body": "<p>Don't have enough reputation to comment but I just want to elaborate on this, just in case there is still confusion.</p>\n\n<p>If you want to share some variables between files, create a header file and declare it there.\ni.e.</p>\n\n<pre><code>    // common.h\n    namespace ocr{ int a, b; }\n\n    // banana.cc\n    #include \"common.h\"\n    void initAppple(){\n        ocr::a = 4;\n    }\n    // apple.cc\n    #include \"common.h\n    void initBanana(){\n        ocr::b = a;\n    }\n    // main.cc\n    #include \"common.h\"\n    int main(){ initApple(); initBanana(); }\n</code></pre>\n\n<p>And then when you compile main.cc, link it with apple.cc and banana.cc instead of \"including\" it.</p>\n\n<p><code>g++ main.cc apple.cc banana.cc -o output</code></p>\n\n<p>Note that you can't just declare and initialize separately in global scope, which is why you probably need to use a setter function such as the ones above (initApple() etc). Or use extern inside the header file and define it inside the source file.</p>\n"}], "owner": {"reputation": 47, "user_id": 9566965, "user_type": "registered", "profile_image": "https://graph.facebook.com/616913391989186/picture?type=large", "display_name": "Lin Paul", "link": "https://stackoverflow.com/users/9566965/lin-paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 57403696, "answer_count": 2, "score": 0, "last_activity_date": 1565236521, "creation_date": 1565217962, "question_id": 57403133, "link": "https://stackoverflow.com/questions/57403133/multiple-definition-already-defined-here", "title": "multiple definition, already defined here", "body": "<p>I have three simple files.\n\u201dbanana.cc\u201c</p>\n\n<pre><code>namespace ocr{\n    int a = 5;\n}\n</code></pre>\n\n<p>\"apple.cc\"</p>\n\n<pre><code>#include \"banana.cc\"\n\nnamespace ocr{\n    int b = a;\n}\n</code></pre>\n\n<p>\"main.cc\"</p>\n\n<pre><code>#include \"apple.cc\"\nint main()\n{\n    return 0;\n}\n\n</code></pre>\n\n<pre><code>/tmp/ccs6XmP2.o:(.data+0x0): multiple definition of `ocr::a'\n/tmp/ccEkxDgJ.o:(.data+0x0): first defined here\n/tmp/ccs6XmP2.o:(.bss+0x0): multiple definition of `ocr::b'\n/tmp/ccEkxDgJ.o:(.bss+0x0): first defined here\n/tmp/cco0dUCm.o:(.data+0x0): multiple definition of `ocr::a'\n/tmp/ccEkxDgJ.o:(.data+0x0): first defined here\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>after compiler insert all the #include, main.cc is like:</p>\n\n<pre><code>namespace ocr{\n    int a = 5;\n}\n\nnamespace ocr{\n    int b = a;\n}\n\nint main()\n{\n    return 0;\n}\n\n\n</code></pre>\n\n<p>why this will cause redefinition?\nThank you.</p>\n"}, {"tags": ["c++", "mongodb", "mongo-cxx-driver"], "answers": [{"comments": [{"owner": {"reputation": 1385, "user_id": 8202606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aP46CW5acPM/AAAAAAAAAAI/AAAAAAAAACY/J6U8GUmqfng/photo.jpg?sz=128", "display_name": "Federico Caccia", "link": "https://stackoverflow.com/users/8202606/federico-caccia"}, "edited": false, "score": 0, "creation_date": 1565224762, "post_id": 57402976, "comment_id": 101289110, "body": "Great, that&#39;s a good explanation on what could be going on this another question also: <a href=\"https://stackoverflow.com/questions/57384733/why-do-i-get-error-resulting-in-state-dead-in-mongodb?noredirect=1#comment101287365_57384733\" title=\"why do i get error resulting in state dead in mongodb\">stackoverflow.com/questions/57384733/&hellip;</a>"}, {"owner": {"reputation": 317, "user_id": 4814955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f09e787a9a9294a67f6e3c30c3f31?s=128&d=identicon&r=PG&f=1", "display_name": "Mykeul", "link": "https://stackoverflow.com/users/4814955/mykeul"}, "edited": false, "score": 0, "creation_date": 1606209339, "post_id": 57402976, "comment_id": 114886556, "body": "Since version 4.2, there is no longer 16MB for a transaction: limit:<a href=\"https://docs.mongodb.com/manual/core/transactions-production-consideration/#oplog-size-limit\" rel=\"nofollow noreferrer\">docs.mongodb.com/manual/core/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5778, "user_id": 8698101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32951f0068d47dfdc1dfc90ff44612b?s=128&d=identicon&r=PG&f=1", "display_name": "B. Fleming", "link": "https://stackoverflow.com/users/8698101/b-fleming"}, "is_accepted": true, "score": 4, "last_activity_date": 1565216662, "creation_date": 1565216662, "answer_id": 57402976, "question_id": 57402919, "link": "https://stackoverflow.com/questions/57402919/mongodb-error-using-transactions-total-size-of-all-transaction-operations-must/57402976#57402976", "title": "MongoDB error using transactions: Total size of all transaction operations must be less than 16793600. Actual size is 16793810: generic server error", "body": "<p>The transaction size refers to the size of the data in bytes, not the number of documents. It's a 16 MB limit. If your transaction size exceeds this 16 MB limit, you will receive this error.</p>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 10972883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gXdFe.jpg?s=128&g=1", "display_name": "Aziz F Dagli", "link": "https://stackoverflow.com/users/10972883/aziz-f-dagli"}, "is_accepted": false, "score": 0, "last_activity_date": 1595745546, "creation_date": 1595745546, "answer_id": 63096935, "question_id": 57402919, "link": "https://stackoverflow.com/questions/57402919/mongodb-error-using-transactions-total-size-of-all-transaction-operations-must/63096935#63096935", "title": "MongoDB error using transactions: Total size of all transaction operations must be less than 16793600. Actual size is 16793810: generic server error", "body": "<p>Mongodb 4.2 version transactions size larger than previous versions. Recently I faced same problem, i solved the problem by upgrading mongodb.</p>\n<p><a href=\"https://jira.mongodb.org/browse/SERVER-36330\" rel=\"nofollow noreferrer\">https://jira.mongodb.org/browse/SERVER-36330</a></p>\n"}], "owner": {"reputation": 1385, "user_id": 8202606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aP46CW5acPM/AAAAAAAAAAI/AAAAAAAAACY/J6U8GUmqfng/photo.jpg?sz=128", "display_name": "Federico Caccia", "link": "https://stackoverflow.com/users/8202606/federico-caccia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 2, "accepted_answer_id": 57402976, "answer_count": 2, "score": 0, "last_activity_date": 1595745546, "creation_date": 1565216208, "question_id": 57402919, "link": "https://stackoverflow.com/questions/57402919/mongodb-error-using-transactions-total-size-of-all-transaction-operations-must", "title": "MongoDB error using transactions: Total size of all transaction operations must be less than 16793600. Actual size is 16793810: generic server error", "body": "<p>I'm working with mongodb transactions in c++. The steps I\u2019m performing are the following:</p>\n\n<ol>\n<li>create session</li>\n<li>create a bulk_write for this session, where I have\nmultiple inserts to a collection</li>\n<li>start transaction</li>\n<li>execute bulk_write</li>\n<li>commit transaction</li>\n</ol>\n\n<p>This is the code snippet for the algorithm:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\n#include &lt;bsoncxx/builder/stream/document.hpp&gt;\n#include &lt;bsoncxx/json.hpp&gt;\n#include &lt;bsoncxx/exception/exception.hpp&gt;\n#include &lt;mongocxx/client.hpp&gt;\n#include &lt;mongocxx/instance.hpp&gt;\n#include &lt;mongocxx/exception/exception.hpp&gt;\n#include &lt;mongocxx/exception/logic_error.hpp&gt;\n#include &lt;mongocxx/exception/operation_exception.hpp&gt;\n\n\nint main(int argc, char** argv)\n{\n    /* Parameters */\n\n    std::string db_uri = \"&lt;PROVIDE URI TO CONNECT WITH A MONGO DB WITH REPLICA SETS&gt;\";\n    std::string db_name = \"db_0\";\n    std::string collection0_name = \"coll_0\";\n    int N_INSERTS = 100000;\n\n    /* Init connection */\n\n    static mongocxx::instance inst{};\n    mongocxx::uri client_uri = mongocxx::uri(db_uri);\n    mongocxx::options::client client_options;\n    mongocxx::options::ssl ssl_options;\n    ssl_options.allow_invalid_certificates(true);\n    client_options.ssl_opts(ssl_options);\n    mongocxx::client client = mongocxx::client(client_uri, client_options);\n\n    /* Reinit collection */\n\n    mongocxx::database db = client[db_name];        \n    auto builder = bsoncxx::builder::stream::document{};\n    bsoncxx::document::value doc_value = builder\n    &lt;&lt; \"Hello\" &lt;&lt; \"MongoDB\"\n    &lt;&lt; bsoncxx::builder::stream::finalize;    \n    db[collection0_name].insert_one(doc_value.view()); /* insert a dummy doc */    \n    db[collection0_name].delete_many({}); /* delete all docs */\n\n    /* Create session */\n\n    mongocxx::client_session session = client.start_session();\n\n    /* Start transaction */\n\n    session.start_transaction();\n\n    /* Create bulk operations */\n\n    mongocxx::bulk_write op0 = db[collection0_name].create_bulk_write(session);\n\n    /* Fill insert bulk operations */\n\n    for (int i = 0; i &lt; N_INSERTS; i++){\n\n        mongocxx::model::insert_one insert_one{\n            bsoncxx::builder::basic::make_document(\n                bsoncxx::builder::basic::kvp(\"field0\", i),\n                bsoncxx::builder::basic::kvp(\"field1\", i),\n                bsoncxx::builder::basic::kvp(\"field2\", i)\n            )\n        };\n\n        op0.append(insert_one);\n    }\n\n    /* Execute transaction */\n\n    try {\n        bulk_op-&gt;execute();\n    }\n    catch (std::exception&amp; e){     \n        std::cerr &lt;&lt; \"Bulk write exception: \" &lt;&lt; e.what() &lt;&lt; std::endl;\n        session.abort_transaction();\n    }    \n\n    session.commit_transaction();   \n\n    return 0;\n}\n</code></pre>\n\n<p>which you can compile using the following command in a linux system with mongocxx installed:</p>\n\n<pre><code>c++ --std=c++11 test.cpp -o test -I/usr/local/include/mongocxx/v_noabi -I/usr/local/include/bsoncxx/v_noabi -L/usr/local/lib -lmongocxx -lbsoncxx\n</code></pre>\n\n<p>While executing I get the following error:</p>\n\n<pre><code>Total size of all transaction operations must be less than 16793600. Actual size is 16793810: generic server error\n</code></pre>\n\n<p>But I'm only inserting 100k docs.</p>\n\n<p>What could be generating the error?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 4, "creation_date": 1565214663, "post_id": 57402714, "comment_id": 101286941, "body": "You don&#39;t &quot;initialize constructors&quot;  - constructors initialize things."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565215478, "post_id": 57402714, "comment_id": 101287147, "body": "If it&#39;s <code>boost::asio</code> you are using and you have a relatively new version of boost, use <code>io_context</code> instead of <code>io_service</code>. <code>io_service</code> is just a typedef for backwards compatibility."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1565217878, "post_id": 57402714, "comment_id": 101287742, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6724626/c-constructor\">C++ Constructor</a>"}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1565214750, "post_id": 57402731, "comment_id": 101286972, "body": "The class name is <code>Foo</code>, not <code>Test</code>.  <code>Test()</code> is a method of the <code>Foo</code> class"}], "tags": [], "owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": false, "score": 1, "last_activity_date": 1565214732, "last_edit_date": 1565214732, "creation_date": 1565214701, "answer_id": 57402731, "question_id": 57402714, "link": "https://stackoverflow.com/questions/57402714/call-constructor-of-member-object/57402731#57402731", "title": "Call constructor of member object", "body": "<p>You could initialize the members in your class constructor's initialization list</p>\n\n<pre><code>Foo::Foo() : mgr(m) {}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1565216934, "post_id": 57402747, "comment_id": 101287518, "body": "@TedLyngmo yes, it should"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 1, "creation_date": 1565218326, "post_id": 57402747, "comment_id": 101287831, "body": "Declaring <code>m</code> before <code>mgr</code> is super subtle but is crucial here, since members are initialized in order of declaration. If <code>m</code> is declared after <code>mgr</code>, then the initializer <code>mgr(m)</code> will use an unitialized object and will almost certainly cause Undefined Behavior."}, {"owner": {"reputation": 605, "user_id": 4594919, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/511d2cc35d3a273b16b25b6d382522d8?s=128&d=identicon&r=PG&f=1", "display_name": "Irinel Iovan", "link": "https://stackoverflow.com/users/4594919/irinel-iovan"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1565407881, "post_id": 57402747, "comment_id": 101355262, "body": "@alterigel Amazing answer, you saved me. I was wondering why i&#39;m gettin core crash, that was impossible to find out.  It seems that this was the cause, order of declaration was different from order of initialization. xD"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 4, "last_activity_date": 1565216919, "last_edit_date": 1565216919, "creation_date": 1565214847, "answer_id": 57402747, "question_id": 57402714, "link": "https://stackoverflow.com/questions/57402714/call-constructor-of-member-object/57402747#57402747", "title": "Call constructor of member object", "body": "<p>You need to initialize the <code>mgr</code> member inside the <code>Foo</code> class constructor, not in the <code>Test()</code> class method:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Foo\n{\npublic:\n    Foo();\n    void Test();\n\nprivate:\n    asio::io_service m;\n\nprotected:\n    amy::connector mgr;\n};\n\nFoo::Foo() : mgr(m) // &lt;-- initialize here!\n{\n}\n\nvoid Foo::Test()\n{\n    // use mgr here as needed...\n}\n</code></pre>\n"}], "owner": {"reputation": 605, "user_id": 4594919, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/511d2cc35d3a273b16b25b6d382522d8?s=128&d=identicon&r=PG&f=1", "display_name": "Irinel Iovan", "link": "https://stackoverflow.com/users/4594919/irinel-iovan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 57402747, "answer_count": 2, "score": -1, "last_activity_date": 1565217674, "creation_date": 1565214555, "last_edit_date": 1565217674, "question_id": 57402714, "link": "https://stackoverflow.com/questions/57402714/call-constructor-of-member-object", "title": "Call constructor of member object", "body": "<p>I try to implement the amySQL, AND I want to intialize this connector intro test function.</p>\n\n<pre><code>class Foo\n{\npublic:\n    void Test();\n\nprotected:\n    amy::connector mgr;\n\nprivate:\n    asio::io_service m;\n};\n\nvoid Foo::Test()\n{\n    mgr(m);\n}\n</code></pre>\n\n<p>However when i want to compile i get this error:</p>\n\n<pre><code>error: no match for call to '(amy::connector {aka amy::basic_connector&lt;amy::mysql_service&gt;}) (asio::io_service&amp;)'\n  mgr(m);\n</code></pre>\n\n<p>What i do wrong here?\n Repository to amy sql  <a href=\"https://github.com/liancheng/amy\" rel=\"nofollow noreferrer\">https://github.com/liancheng/amy</a></p>\n"}, {"tags": ["c++", "constructor", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 1, "creation_date": 1565215092, "post_id": 57402711, "comment_id": 101287053, "body": "If you come from Java environment, you&#39;d better forget everything you learned there and treat C++ as a completely new language. For one thing, <code>new</code> is considered bad practice in modern C++ and you definitely don&#39;t want to create every single object with <code>new</code>."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1565215189, "post_id": 57402711, "comment_id": 101287077, "body": "For array of objects without default constructor: <a href=\"https://stackoverflow.com/questions/4754763/object-array-initialization-without-default-constructor\">Object array initialization without default constructor</a>, for possible memory leaks: <a href=\"https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three\">What is The Rule of Three?</a> (not really a leak, but an issue nevertheless)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1565215269, "post_id": 57402711, "comment_id": 101287097, "body": "vectors <i>are</i> dynamic memory allocation."}, {"owner": {"reputation": 115, "user_id": 11740409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyuvQ.jpg?s=128&g=1", "display_name": "Drade", "link": "https://stackoverflow.com/users/11740409/drade"}, "edited": false, "score": 0, "creation_date": 1565215313, "post_id": 57402711, "comment_id": 101287104, "body": "Yes I have learned that &#39;new&#39; is not recommended by c++ core guidelines, I&#39;m just trying to use it to learn how it works before moving on to the other ways of doing it."}, {"owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "edited": false, "score": 0, "creation_date": 1565216438, "post_id": 57402711, "comment_id": 101287398, "body": "I posted an answer showing how to use a contiguous array of Layers using placement-new. It&#39;s much closer to what you wanted in your original question, and you don&#39;t have the extra layer of indirection that comes from using an array of pointers (meaning it&#39;s more memory-efficent too)."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 11740409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyuvQ.jpg?s=128&g=1", "display_name": "Drade", "link": "https://stackoverflow.com/users/11740409/drade"}, "edited": false, "score": 0, "creation_date": 1565215881, "post_id": 57402770, "comment_id": 101287263, "body": "Thank you, this is very clear (I&#39;ll look up the Rule of 3/5/0, this seems pretty important). I have a question about std::unique_ptr, I understand it is useful as it deletes the object if the pointer becomes inaccessible, but if you implement pointers correctly and delete everything then are they useful in any way?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 115, "user_id": 11740409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyuvQ.jpg?s=128&g=1", "display_name": "Drade", "link": "https://stackoverflow.com/users/11740409/drade"}, "edited": false, "score": 0, "creation_date": 1565216036, "post_id": 57402770, "comment_id": 101287304, "body": "@aurelien Smart pointers allow you to write safer memory management code. Any time you can replace <code>delete</code>/<code>delete[]</code> with <code>std::unique_ptr</code> (or <code>std::shared_ptr</code>), you should. Modern C++ code should avoid calling <code>new</code>/<code>new[]</code> directly whenever possible. In this case, a <code>std::vector</code> would be a better choice, but <code>std::unique_ptr</code> offers a compromise so you can still use <code>new</code>/<code>new[]</code> manually without having to use <code>delete</code>/<code>delete[]</code> manually."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1565216571, "last_edit_date": 1565216571, "creation_date": 1565215073, "answer_id": 57402770, "question_id": 57402711, "link": "https://stackoverflow.com/questions/57402711/new-array-of-objects-with-constructor-that-needs-parameters-in-c/57402770#57402770", "title": "new array of objects with constructor that needs parameters in C++", "body": "<blockquote>\n  <p>I need to create a Network of n layers, each containing a different number of neurons (passed as an array of length n):</p>\n</blockquote>\n\n<p>You won't be able to do that with a fixed array of <code>Layer</code> objects.  Although there is a syntax available for the <code>new[]</code> operator to initialize all of the elements of the allocated array with the <em>same</em> constructor value, there is no syntax for initializing them with <em>different</em> values, at least not when the values are coming from another array.</p>\n\n<p>To do what you are asking for, you will have to create an array of <code>Layer*</code> pointers (or better, an array of <code>std::unique_ptr&lt;Layer&gt;</code> objects in C++11 and later), and then dynamically create each <code>Layer</code> object with a different constructor value as needed.  You were close in doing that, but you are just missing an extra layer of indirection in your array declaration:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Network {\nprivate:\n    unsigned int _nb_layers;\n    Layer** _layers; // &lt;-- DYNAMIC ARRAY OF POINTERS, NOT OBJECTS!\n\npublic:\n    Network(unsigned int nb_layers, unsigned int* nb_neurons);\n    ~Network();\n\n    const Layer* getLayer(unsigned int index) const;\n};\n\nNetwork::Network(unsigned int nb_layers, unsigned int *nb_neurons) {\n    _nb_layers = nb_layers;\n    _layers = new Layer*[nb_layers]; // &lt;-- ALLOCATE ARRAY OF POINTERS FIRST\n\n    for(int i = 0; i &lt; nb_layers; i++) {\n        _layers[i] = new Layer(nb_neurons[i]); // &lt;-- THEN MAKE EACH POINTER POINT TO AN OBJECT\n    }\n}\n\nconst Layer* Network::getLayer(unsigned int index) const {\n    Expects(index &lt; _nb_layers);\n\n    return _layers[index];\n}\n\nNetwork::~Network() {\n    for (int i = 0; i &lt; _nb_layers; ++i)\n        delete _layers[i]; // &lt;-- NEED TO FREE EACH OBJECT FIRST\n    delete[] _layers; // &lt;-- THEN FREE THE ARRAY ITSELF\n}\n</code></pre>\n\n<p>In C++11 and later, you can do this instead:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Network {\nprivate:\n    unsigned int _nb_layers;\n    std::unique_ptr&lt;std::unique_ptr&lt;Layer&gt;[]&gt; _layers;\n\npublic:\n    Network(unsigned int nb_layers, unsigned int* nb_neurons);\n    // ~Network(); // &lt;-- NOT NEEDED!\n\n    const Layer* getLayer(unsigned int index) const;\n};\n\nNetwork::Network(unsigned int nb_layers, unsigned int *nb_neurons) {\n    _nb_layers = nb_layers;\n    _layers.reset( new std::unique_ptr&lt;Layer&gt;[nb_layers] );\n\n    for(int i = 0; i &lt; nb_layers; i++) {\n        _layers[i].reset( new Layer(nb_neurons[i]) );\n        // or, in C++14 and later:\n        // _layers[i] = std::make_unique&lt;Layer&gt;(nb_neurons[i]);\n    }\n}\n\nconst Layer* Network::getLayer(unsigned int index) const {\n    Expects(index &lt; _nb_layers);\n\n    return _layers[index].get();\n}\n\n/*\nNetwork::~Network()\n{\n    // NOTHING TO DO HERE!\n}\n*/\n\n</code></pre>\n\n<p>And BTW, both of your classes are violating the <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">Rule of 3/5/0</a>.  Neither of the classes is implementing a copy constructor or a copy assignment operator in order to make <em>copies</em> of their respective arrays from one class instance to another.  Or, in the case of C++11 and later, a move constructor and a move assignment operator to <em>move</em> their respective arrays from one class instance to another.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1565215535, "last_edit_date": 1565215535, "creation_date": 1565215225, "answer_id": 57402789, "question_id": 57402711, "link": "https://stackoverflow.com/questions/57402711/new-array-of-objects-with-constructor-that-needs-parameters-in-c/57402789#57402789", "title": "new array of objects with constructor that needs parameters in C++", "body": "<p>The line</p>\n\n<pre><code>_layers[i] = new Layer(nb_neurons[i]);\n</code></pre>\n\n<p>suffers from two problems.</p>\n\n<ol>\n<li>There is a type mismatch. <code>_layers[i]</code> is an object while the RHS is a pointer.</li>\n<li><code>_layers[i]</code> is a <code>const</code> object. Hence, you can't assign anything to it after it is initialized.</li>\n</ol>\n\n<p>You can resolve the above problem as well as the default constructor problem using</p>\n\n<pre><code>std::vector&lt;Layer*&gt; _layers;\n</code></pre>\n\n<p>For better and easier memory management, use a vector of smart pointers.</p>\n\n<pre><code>std::vector&lt;std::unique_ptr&lt;Layer&gt;&gt; _layers;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>std::vector&lt;std::shared_ptr&lt;Layer&gt;&gt; _layers;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": false, "score": 0, "last_activity_date": 1565217441, "last_edit_date": 1565217441, "creation_date": 1565216377, "answer_id": 57402943, "question_id": 57402711, "link": "https://stackoverflow.com/questions/57402711/new-array-of-objects-with-constructor-that-needs-parameters-in-c/57402943#57402943", "title": "new array of objects with constructor that needs parameters in C++", "body": "<p>You can do this, but you'll have to use placement new. Let's look at how this could be done. </p>\n\n<p>First, we're going to create a class that represents a block of memory. This will be used in conjunction with placement new to create layers. It doesn't need any functions, because it's just used for the purposes of allocating memory of the right size and alignment. </p>\n\n<pre><code>template&lt;size_t count, size_t alignment&gt;\nstruct alignas(alignment) memory {\n    std::array&lt;unsigned char, count&gt; bytes;\n};\n</code></pre>\n\n<p>The two parameters given here allow us to specify the size and alignment of the block of memory. In our case, we want blocks of memory with the same size and alignment of a <code>Layer</code>:</p>\n\n<pre><code>using layer_memory = memory&lt;sizeof(Layer), alignof(Layer)&gt;; \n</code></pre>\n\n<p>We can use this to create a class representing an array of layers. I split it up into four parts:\n- The data members (a pointer to the memory, and a variable storing the number of layers\n- The member functions (used to access individual layers)\n- The constructors (used to make the <code>LayerArray</code> from a list of sizes\n- The destructor (used to delete the block of memory we allocated)</p>\n\n<pre><code>class LayerArray {\n\n    //* PART ONE: DATA MEMBERS *//\n   private:\n    layer_memory* mem;\n    size_t count;\n\n    //* PART TWO: MEMBER FUNCTIONS *//\n   public:\n    // Get a pointer to the memory as an array of Layers\n    Layer* data() {\n        return reinterpret_cast&lt;Layer*&gt;(mem); \n    }\n    Layer const* data() const {\n        return reinterpret_cast&lt;Layer const*&gt;(mem); \n    }\n    // Dereference the i-th block of memory as a Layer\n    Layer&amp; operator[](size_t i) {\n        return data()[i]; \n    }\n    Layer const&amp; operator[](size_t i) const {\n        return data()[i]; \n    }\n\n    //* PART THREE: CONSTRUCTORS *//\n\n    // Convenience constructor from initializer list\n    LayerArray(std::initializer_list&lt;unsigned&gt; counts)\n      : LayerArray(counts.begin(), counts.size()) {}\n\n    // Move constructor\n    LayerArray(LayerArray&amp;&amp; other)\n      : mem(other.mem)\n      , count(other.count)\n    {\n       other.mem = nullptr;\n       other.count = 0;\n    }\n\n    // Constructor that uses an array of layer sizes\n    LayerArray(const unsigned int* layer_size_counts, size_t count)\n      : mem(new layer_memory[count])\n      , count(count) \n    {\n        for(size_t i = 0; i &lt; count; i++) {\n            auto layer_size = layer_size_counts[i]; \n\n            // Create the new layer in the i-th block of memory\n            new (mem + i) Layer(layer_size); \n        }\n    }\n\n    //* PART FOUR: DESTRUCTOR *//\n    ~LayerArray() {\n        for(size_t i = 0; i &lt; count; i++) {\n            Layer&amp; layer = data()[i]; // Get the layer\n            layer.~Layer(); // Manually call the destructor for the Layer\n        }\n        delete[] mem; \n    }\n};\n</code></pre>\n\n<p>This allows us to create a <strong>contiguous</strong> array of layers, and instantiate them with different sizes:</p>\n\n<pre><code>int main() {\n    // Create an array of layers with the specified sizes\n    LayerArray layers { 50, 50, 50, 10, 3 };\n\n    // Do other stuff...\n}\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 11740409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyuvQ.jpg?s=128&g=1", "display_name": "Drade", "link": "https://stackoverflow.com/users/11740409/drade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1097, "favorite_count": 0, "accepted_answer_id": 57402770, "answer_count": 3, "score": 2, "last_activity_date": 1565217441, "creation_date": 1565214544, "question_id": 57402711, "link": "https://stackoverflow.com/questions/57402711/new-array-of-objects-with-constructor-that-needs-parameters-in-c", "title": "new array of objects with constructor that needs parameters in C++", "body": "<p>Before I start with my question, let me say that I know that I can solve my problem easily using the standard library or gsl library (e.g. <code>std::Vector</code>). But I'm trying to learn C++ and dynamic memory allocation, so I would like to know if there is a way to solve it without using a Vector or anything similar.</p>\n\n<p>I have a <code>Layer</code> class that contains a number of neurons determined when the object is created (through dynamic memory allocation):</p>\n\n<pre><code>class Layer {\nprivate:\n    unsigned int _size;\n    const Neuron* _neurons;\n\npublic:\n    Layer(unsigned int size);\n    ~Layer();\n\n    const Neuron* getNeuron(unsigned int index) const;\n};\n\nLayer::Layer(unsigned int size) {\n    _size = size;\n    _neurons = new Neuron[size];\n}\n\nconst Neuron* Layer::getNeuron(unsigned int index) const {\n    Expects(index &lt; _size);\n\n    return &amp;_neurons[index];\n}\n\nLayer::~Layer() {\n    delete[] _neurons;\n}\n</code></pre>\n\n<p>Now the challenge is in the <code>Network</code> class: I need to create a Network of n layers, each containing a different number of neurons (passed as an array of length n):</p>\n\n<pre><code>class Network {\nprivate:\n    unsigned int _nb_layers;\n    const Layer* _layers;\n\npublic:\n    Network(unsigned int nb_layers, unsigned int* nb_neurons);\n    ~Network();\n\n    const Layer* getLayer(unsigned int index) const;\n};\n\nNetwork::Network(unsigned int nb_layers, unsigned int *nb_neurons) {\n    _nb_layers = nb_layers;\n    _layers = new Layer[nb_layers];\n\n    for(int i = 0; i &lt; nb_layers; i++) {\n        _layers[i] = new Layer(nb_neurons[i]);\n    }\n}\n\nconst Layer* Network::getLayer(unsigned int index) const {\n    Expects(index &lt; _nb_layers);\n\n    return &amp;_layers[index];\n}\n\nNetwork::~Network() {\n    delete _layers;\n}\n</code></pre>\n\n<p>The problem is that the Network constructor fails, because <code>_layers = new Layer[nb_layers]</code> tries to call the constructor with no parameters, which fails.\nAlso, <code>_layers[i] = new Layer(nb_neurons[i])</code> fails because \"No viable overloaded '='\", which I do not understand.\nHow can I fix this using dynamic memory allocation instead of <code>std::Vector</code>?</p>\n\n<p>Finally, is the way I implemented dynamic memory allocation correct and without any memory leak? I'm wondering what happens to my <code>unsigned int *nb_neurons</code> in the Network constructor since the values are being used but I'm never deleting it.\n(As a background, I'm been coding in Java, Python and PHP for years)</p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["c++", "qt", "oop", "templates", "design-patterns"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9088793"}, "edited": false, "score": 1, "creation_date": 1565218234, "post_id": 57402705, "comment_id": 101287810, "body": "<a href=\"https://doc.qt.io/qt-5/qvariant.html\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qvariant.html</a>?"}, {"owner": {"reputation": 37, "user_id": 5939106, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRvou.jpg?s=128&g=1", "display_name": "shubhamcr7", "link": "https://stackoverflow.com/users/5939106/shubhamcr7"}, "edited": false, "score": 0, "creation_date": 1565246676, "post_id": 57402705, "comment_id": 101294110, "body": "could you show me via some code as per my attached code snippet. I am still not able to understand how I can use QVariant here."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5939106, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRvou.jpg?s=128&g=1", "display_name": "shubhamcr7", "link": "https://stackoverflow.com/users/5939106/shubhamcr7"}, "edited": false, "score": 0, "creation_date": 1566046254, "post_id": 57403848, "comment_id": 101537387, "body": "I am marking this as accepted answer as my Approach 2 with QVariant worked. The member variables which existed in Base class and were templated, I made them of QVariant type and it works gracefully."}], "tags": [], "owner": {"reputation": 2002, "user_id": 2763000, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a5ea0af3a37d8989110a8fb4c656efb2?s=128&d=identicon&r=PG&f=1", "display_name": "goug", "link": "https://stackoverflow.com/users/2763000/goug"}, "is_accepted": true, "score": 0, "last_activity_date": 1565224970, "creation_date": 1565224970, "answer_id": 57403848, "question_id": 57402705, "link": "https://stackoverflow.com/questions/57402705/stuck-on-design-due-to-the-data-type-varying-at-run-time/57403848#57403848", "title": "Stuck on Design due to the data type varying at run time", "body": "<p>The QVariant class (referenced in the comment) does exactly this. It's designed to store values of varying types. You can inspect it to determine the type that's stored, and you can pass it around, store it to settings, and so on. There's no need to reinvent it. </p>\n"}], "owner": {"reputation": 37, "user_id": 5939106, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRvou.jpg?s=128&g=1", "display_name": "shubhamcr7", "link": "https://stackoverflow.com/users/5939106/shubhamcr7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "accepted_answer_id": 57403848, "answer_count": 1, "score": 1, "last_activity_date": 1565224970, "creation_date": 1565214519, "last_edit_date": 1565215046, "question_id": 57402705, "link": "https://stackoverflow.com/questions/57402705/stuck-on-design-due-to-the-data-type-varying-at-run-time", "title": "Stuck on Design due to the data type varying at run time", "body": "<p>I have a class in my C++/Qt application which has some member variables whose data type can differ at run time depending on which option user has selected. Those member variables have corresponding getter and setter methods.</p>\n\n<p>Now, I tried to solve this problem using the following 2 approaches but none of them worked.\n<br><br>\nApproach 1: I made a base class \"Base\" and derived 3 classes from it, namely \"IntProperty\", \"FloatProperty\" and \"StringProperty\". Now these 3 classes have the corresponding member variables with int, float and string type respectively and their getters and setters. I kept the common member variables and methods in base class. The problem is that I am not able to invoke the methods of Derived classes using Base class object. Please the code corresponding to Approach 1 for more clarity.</p>\n\n<p>Approach 2: I tried to solve it using templates but the problem with it is that the user program is a Qt class which has Q_OBJECT macro defined in it and it errors out saying cannot use templates with Q_OBJECT. See code for approach 2 for clarity.</p>\n\n<p>I am stuck in it and cannot think of a design pattern or other technique using which I can tackle this problem. I have been programming sleeplessly for few nights and will be dead by tomorrow if I don't get the answer.</p>\n\n<pre><code>/****************** Approach 1 ******************/\nclass Base\n{\n   ...\n}\n\nclass IntProperty : public Base \n{\n  public:\n    int getProp() { return prop; }\n  private:\n    int prop;\n}\n\nclass FloatProperty : public Base \n{\n  public:\n    double getProp() { return prop; }\n  private:\n    double prop;\n}\n\nclass StringProperty : public Base \n{\n  public:\n    string getProp() { return prop; }\n  private:\n    string prop;\n}\n\nclass UserProgram : public QDialog\n{\n    Q_OBJECT\n\n  private:\n    Base* base;\n\n  public:\n    void user()\n    {\n        /// Trying to take the advantage of runtime polymorphism\n        Base* base = new IntProperty();\n        base-&gt;getProp(); /// compile time error. Ofcourse because there is no\n                         /// method named getProp() in Base class. I am unable \n                         /// to define this method in base class because I cannot decide what should I keep the return type for \n                         /// this method.\n    }\n}\n\n\n/******************* Approach 2 *********************/\ntemplate &lt;typename T&gt;\nclass Base\n{\n  private:\n    T prop;\n  public:\n    T getProp() { return prop; }\n}\n\ntemplate &lt;typename T&gt;\nclass UserProgram() : public QDialog\n{\n    Q_OBJECT\n  public:\n    void user() \n    {\n        base = new Base&lt;T&gt;;\n    }\n  private:\n    Base&lt;T&gt;* base; /// error cannot use template with Q_OBJECT\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "qt"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1565214088, "post_id": 57402613, "comment_id": 101286776, "body": "Do both sides use Qt? If so, what versions of Qt do you use?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 3, "creation_date": 1565214500, "post_id": 57402613, "comment_id": 101286888, "body": "Please show the Python code as well. Your QT code is fine, so you are likely not decoding the bytes properly on the Python side."}, {"owner": {"reputation": 1208, "user_id": 10879061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd339757af5995ab15d4f5759b270fc2?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Lambden", "link": "https://stackoverflow.com/users/10879061/rob-lambden"}, "edited": false, "score": 1, "creation_date": 1565214630, "post_id": 57402613, "comment_id": 101286932, "body": "AFAIK all current C++ implementations do use IEEE standard for doubles.  Try getting a wireshark trace and seeing what you&#39;re sending, and also passing the message on the same system to check it is translating back and forth correctly."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1565217224, "post_id": 57402613, "comment_id": 101287579, "body": "Can you use PyQt5 or PySide2 on the python side? What version of Qt do you use?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1565233046, "post_id": 57402613, "comment_id": 101290526, "body": "Whether you make assumptions or not, you should still document the packet format at the byte level. That way, if you are wondering whether things are working correctly, you can dump the packet bytes and check the sender independently."}, {"owner": {"reputation": 1081, "user_id": 468603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d863f374f48bdb8cc516e006dc5196f4?s=128&d=identicon&r=PG", "display_name": "Xofo", "link": "https://stackoverflow.com/users/468603/xofo"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1565235243, "post_id": 57402613, "comment_id": 101290922, "body": "@david-schwartz - You are correct, I will update my answer. To Remy -  I ditched the Python tool I was using and just used netcat and good hexdump."}], "answers": [{"tags": [], "owner": {"reputation": 1081, "user_id": 468603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d863f374f48bdb8cc516e006dc5196f4?s=128&d=identicon&r=PG", "display_name": "Xofo", "link": "https://stackoverflow.com/users/468603/xofo"}, "is_accepted": true, "score": 0, "last_activity_date": 1565235873, "creation_date": 1565235873, "answer_id": 57404904, "question_id": 57402613, "link": "https://stackoverflow.com/questions/57402613/serializing-a-double-for-transmit-over-udp-arm-to-x86/57404904#57404904", "title": "Serializing a Double for transmit over UDP (ARM to x86)", "body": "<p>I updated the question and using xxd and netcat I observed the following data:</p>\n\n<p>%> nc -l -u -p 2488 | xxd -u -cols 12</p>\n\n<pre><code>00000000: AAAA 4260 E5D0 223B 3440 FFFF  ..B`..\";4@..\n0000000c: AAAA 4260 E5D0 223B 3540 FFFF  ..B`..\";5@..\n00000018: AAAA 4260 E5D0 223B 3640 FFFF  ..B`..\";6@..\n00000024: AAAA 4260 E5D0 223B 3740 FFFF  ..B`..\";7@..\n00000030: AAAA 4260 E5D0 223B 3840 FFFF  ..B`..\";8@..\n0000003c: AAAA 4260 E5D0 223B 3940 FFFF  ..B`..\";9@..\n00000048: AAAA 4260 E5D0 223B 3A40 FFFF  ..B`..\";:@..\n00000054: AAAA 4260 E5D0 223B 3B40 FFFF  ..B`..\";;@..\n</code></pre>\n\n<p>I used Christopher Vickery's IEEE 754 Analyzer(<a href=\"https://babbage.cs.qc.cuny.edu/IEEE-754/\" rel=\"nofollow noreferrer\">https://babbage.cs.qc.cuny.edu/IEEE-754/</a>) to look at the values. And looking at the first value it produced a result of:</p>\n\n<pre><code>Decimal value: 2.023100000000000164845914696343243122100830078125E1\n\nNormalized binary value: 1.010000111011001000101101000011100101011000000100001b4\n</code></pre>\n\n<p>Which is what I would expect. Yes the values are little Endian as I expected, and they are being transmitted correctly.</p>\n\n<p>So the culprit was the tool I was using to originally examine the data (<em>which I can trouble shoot</em>).</p>\n"}], "owner": {"reputation": 1081, "user_id": 468603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d863f374f48bdb8cc516e006dc5196f4?s=128&d=identicon&r=PG", "display_name": "Xofo", "link": "https://stackoverflow.com/users/468603/xofo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57404904, "answer_count": 1, "score": 0, "last_activity_date": 1565235873, "creation_date": 1565213929, "last_edit_date": 1565235309, "question_id": 57402613, "link": "https://stackoverflow.com/questions/57402613/serializing-a-double-for-transmit-over-udp-arm-to-x86", "title": "Serializing a Double for transmit over UDP (ARM to x86)", "body": "<p>I am trying to serialize a Double (on an ARM) in some C++ (QT) code and sending it to x86 via UDP. Both devices are Little Endian, both running Linux. My questions are, is it safe to assume that both are using IEEE-754?</p>\n\n<p>My initial attempts did not seem to work. I did the following and sent it via datagram.</p>\n\n<pre><code>void QSendDouble::Send()\n{\n   // Start value is 19.231, value increments by 1 each second\n   dblval = dblval + 1.0;\n\n   QByteArray packet;\n   packet.append('\\xAA'); // Start Marker\n   packet.append('\\xAA'); // Start Marker\n\n   QByteArray data(reinterpret_cast&lt;const char*&gt;(&amp;dblval), sizeof(dblval));\n   packet.append(data);\n\n   packet.append('\\xFF'); // End Marker\n   packet.append('\\xFF'); // End Marker\n\n   udpsocket-&gt;writeDatagram(packet.constData(), QHostAddress::LocalHost, 7711);\n}\n</code></pre>\n\n<p>My belief is that I have made some wrong assumptions.</p>\n\n<p>QT is used to send a Double encoded as a byte array, and Python is used to receive the bytes on the x86 end.</p>\n"}, {"tags": ["c++", "cmake", "find", "package"], "answers": [{"tags": [], "owner": {"reputation": 390, "user_id": 770468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/384e276e57998bf2885caf1a582f7a3c?s=128&d=identicon&r=PG", "display_name": "Lasall", "link": "https://stackoverflow.com/users/770468/lasall"}, "is_accepted": true, "score": 2, "last_activity_date": 1565246833, "creation_date": 1565246833, "answer_id": 57406661, "question_id": 57402549, "link": "https://stackoverflow.com/questions/57402549/cmake-find-package-relative-path-in-cmakelists-txt-subfolder/57406661#57406661", "title": "cmake find_package relative path in CMakeLists.txt subfolder", "body": "<p>You can get the global path in <code>MYLIBConfig.cmake</code> with <a href=\"https://cmake.org/cmake/help/latest/variable/CMAKE_CURRENT_LIST_DIR.html\" rel=\"nofollow noreferrer\">CMAKE_CURRENT_LIST_DIR</a>:</p>\n\n<pre><code>set(MYLIB_INCLUDE_DIRS ${CMAKE_CURRENT_LIST_DIR}/include/)\n</code></pre>\n\n<p>Or if you want a relative path to the <a href=\"https://cmake.org/cmake/help/latest/variable/CMAKE_CURRENT_SOURCE_DIR.html\" rel=\"nofollow noreferrer\">currently processed source</a> you can get it accordingly with <a href=\"https://cmake.org/cmake/help/latest/command/file.html#path-conversion\" rel=\"nofollow noreferrer\">file</a>:</p>\n\n<pre><code>file(RELATIVE_PATH MYLIB_INCLUDE_DIRS ${CMAKE_CURRENT_SOURCE_DIR} ${CMAKE_CURRENT_LIST_DIR}/include/)\n</code></pre>\n"}], "owner": {"reputation": 1021, "user_id": 2137370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b92c5a40d0a2e92ce33b9ed6ca876a4f?s=128&d=identicon&r=PG", "display_name": "evolved", "link": "https://stackoverflow.com/users/2137370/evolved"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 1, "accepted_answer_id": 57406661, "answer_count": 1, "score": 1, "last_activity_date": 1565246833, "creation_date": 1565213515, "last_edit_date": 1565213851, "question_id": 57402549, "link": "https://stackoverflow.com/questions/57402549/cmake-find-package-relative-path-in-cmakelists-txt-subfolder", "title": "cmake find_package relative path in CMakeLists.txt subfolder", "body": "<p>I have the following file structure and would like to use a cmake config file <code>MYLIBConfig.cmake</code> which is used by all <code>CMakeLists.txt</code> files in the projects to include headers located in a folder <code>include</code> on the top level. </p>\n\n<pre><code>MYLIBConfig.cmake\ninclude/\n    header_a.h\n    header_b.h\nsrc/\n    project_a/\n        CMakeLists.txt\n        main.cpp\n    project_b/\n        CMakeLists.txt\n        main.cpp\n</code></pre>\n\n<p>A <code>CMakeLists.txt</code> containts the following:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.14)\n\nfind_package(MYLIB REQUIRED PATHS ${CMAKE_CURRENT_SOURCE_DIR}/../../)\n\nproject(projecta)\n\nset(CMAKE_CXX_STANDARD 17)\n\nadd_executable(projecta main.cpp)\n\nmessage(${MYLIB_INCLUDE_DIRS}) # Outpus /include/ which is the problem. Should be a relative path to the include folder\n\ntarget_include_directories(${PROJECT_NAME}\n        PRIVATE\n            ${MYLIB_INCLUDE_DIRS}\n        )\n</code></pre>\n\n<p>The MYLIBConfig.cmake has currently the following content:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.14)\n\n#message(${PREFIX})\n\nset(MYLIB_INCLUDE_DIRS ${CMAKE_PREFIX_PATH}/include/)\n</code></pre>\n\n<p>With this setup, I am not able to include the headers in my main.cpp files using <code>#include \"header_a.h\"</code> because they are not found.</p>\n\n<p>The problem is that I don't know if my usage of <code>find_package</code> is correct because the set variable <code>MYLIB_INCLUDE_DIRS</code> is just <code>/include/</code> when I use <code>message(message(${MYLIB_INCLUDE_DIRS})</code> inside the <code>CMakeLists.txt</code>. Is there a cmake variable that I can use in the <code>MYLIBConfig.cmake</code> file that sets a path which is relative to the \"currently active\" <code>CMakeLists.txt</code>? Or is there another way to achieve a working include using a config file? I know that I could just use a relative path inside the <code>target_include_directories</code> of every <code>CMakeLists.txt</code> but I would like to use a config file to have the flexibility of changing the include folders and possibly set more variables. In the config file I also tried to use ${CMAKE_PREFIX_PATH} and ${CMAKE_CURRENT_SOURCE_DIR} but these variables did not work either.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Another way I think it could work is when the <code>MYLIB_INCLUDE_DIRS</code> would result in a global path. Would this be the appropriate way? And how could this be done?</p>\n"}, {"tags": ["c++", "templates", "reference"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1565213984, "post_id": 57402532, "comment_id": 101286738, "body": "I believe on most systems placing value in a register is a single operation, no matter if the length is shorter or equal to the length of the register."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565214190, "post_id": 57402532, "comment_id": 101286799, "body": "Personally I wouldn&#39;t bother with this.  The possible little bit of performance you save  is not worth having to duplicate every function based on if it is small or large.  That adds a lot more maintenance cost to a project."}, {"owner": {"reputation": 41, "user_id": 11898386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3f63c682ddec1cd18052392930af44?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter van Ooijen", "link": "https://stackoverflow.com/users/11898386/wouter-van-ooijen"}, "edited": false, "score": 0, "creation_date": 1565249198, "post_id": 57402532, "comment_id": 101295299, "body": "For one single function I might not bother with this, but it is a fundamental problem that occurs over and over in the libraries I write (sometimes with multiple parameters). I think a reasonable solution is not <i>that</i> complicated, so I hoped for someone to have solved this for me."}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565255997, "post_id": 57402532, "comment_id": 101298795, "body": "Don&#39;t bother about that. Read-only: pass const T&amp;. The compiler will know how to treat it efficiently. Always keep in mind that compilers are very smart."}], "answers": [{"comments": [{"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1565214091, "post_id": 57402609, "comment_id": 101286777, "body": "Unfortunately, this returns false for pointer types, which are likely better passed by value than by reference."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565214092, "post_id": 57402609, "comment_id": 101286778, "body": "You might want to use the size of the type instead.  This wont pick up things like an enum or small classes."}, {"owner": {"reputation": 41, "user_id": 11898386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3f63c682ddec1cd18052392930af44?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter van Ooijen", "link": "https://stackoverflow.com/users/11898386/wouter-van-ooijen"}, "edited": false, "score": 0, "creation_date": 1565249369, "post_id": 57402609, "comment_id": 101295381, "body": "My idea was indeed to specialize on the size of the type. I think at the user side that boils down to either pass&lt; t &gt;::t (ugly) or the same wrapped in a macro (ugly). I was hoping for someone to have found a better solution."}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565255921, "post_id": 57402609, "comment_id": 101298738, "body": "I think it&#39;s not worth it to use std::is_fundamental. Just pass const T&amp;. The compiler will know what to do."}], "tags": [], "owner": {"reputation": 416, "user_id": 10291440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bp4ZW.jpg?s=128&g=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/10291440/bryan"}, "is_accepted": false, "score": 3, "last_activity_date": 1565214335, "last_edit_date": 1565214335, "creation_date": 1565213901, "answer_id": 57402609, "question_id": 57402532, "link": "https://stackoverflow.com/questions/57402532/passing-a-read-only-parameter-in-c-copy-or-reference-or/57402609#57402609", "title": "Passing a read-only parameter in C++: copy or reference, or", "body": "<p>You can use <code>std::is_fundamental</code> to check if the value is a built in type and overload/specialize to pass by value if true.</p>\n\n<p>There are more things to specialize for using the type support library <code>&lt;type_traits&gt;</code>\nsuch as  <code>is_enum</code>, <code>is_trivially_copyable</code>, <code>is_array</code> and many more. I would recommend checking it out and seeing what works best for you.</p>\n\n<p>Reference link for <code>std::is_fundamental</code> :<br>\n<a href=\"https://en.cppreference.com/w/cpp/types/is_fundamental\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/types/is_fundamental</a><br>\nReference link for <code>&lt;type_traits&gt;</code>:<br>\n<a href=\"https://en.cppreference.com/w/cpp/header/type_traits\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/header/type_traits</a></p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 11898386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3f63c682ddec1cd18052392930af44?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter van Ooijen", "link": "https://stackoverflow.com/users/11898386/wouter-van-ooijen"}, "edited": false, "score": 1, "creation_date": 1565278766, "post_id": 57408987, "comment_id": 101312363, "body": "Thanks for the suggestion, but it doesn&#39;t scale up well to multiple parameters. But it can trivially be converted to fast_copy&lt; T &gt;::t , which could be hidden behind a macro."}, {"owner": {"reputation": 41, "user_id": 11898386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3f63c682ddec1cd18052392930af44?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter van Ooijen", "link": "https://stackoverflow.com/users/11898386/wouter-van-ooijen"}, "edited": false, "score": 0, "creation_date": 1565278829, "post_id": 57408987, "comment_id": 101312394, "body": "&quot;GCC generates the same code for const T&amp; and T parameters&quot; I hope it doesn&#39;t do that things that have a cpopy constructor: passing a ref should never invoke the copy constructor!"}, {"owner": {"reputation": 1240, "user_id": 11880191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f7c67f5b651601f4d883ae1fce0d58?s=128&d=identicon&r=PG&f=1", "display_name": "Joel Filho", "link": "https://stackoverflow.com/users/11880191/joel-filho"}, "reply_to_user": {"reputation": 41, "user_id": 11898386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3f63c682ddec1cd18052392930af44?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter van Ooijen", "link": "https://stackoverflow.com/users/11898386/wouter-van-ooijen"}, "edited": false, "score": 0, "creation_date": 1565287840, "post_id": 57408987, "comment_id": 101316484, "body": "@WoutervanOoijen Fair point about the scaling. I don&#39;t think there&#39;s a way to implicitly construct a type that depends on T in the parameter of the function (see std::forward implementation, for example, that requires explicitly naming T), otherwise that would be very easy to do what you need. And, by the code generated by GCC, I mean each function&#39;s code. The copy constructor is called before the object is put on the registers/stack."}], "tags": [], "owner": {"reputation": 1240, "user_id": 11880191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f7c67f5b651601f4d883ae1fce0d58?s=128&d=identicon&r=PG&f=1", "display_name": "Joel Filho", "link": "https://stackoverflow.com/users/11880191/joel-filho"}, "is_accepted": false, "score": 0, "last_activity_date": 1565255325, "creation_date": 1565255325, "answer_id": 57408987, "question_id": 57402532, "link": "https://stackoverflow.com/questions/57402532/passing-a-read-only-parameter-in-c-copy-or-reference-or/57408987#57408987", "title": "Passing a read-only parameter in C++: copy or reference, or", "body": "<p>Expanding from Bryan's answer and your additional question, hopefully to make it clear:</p>\n\n<p>You can compose a type trait using Bryan's information and, if you want, the size. For this example, I'm using <code>std::is_trivially_copyable</code> and an implementation-defined maximum size:</p>\n\n<pre><code>template &lt;typename T&gt;\ninline constexpr bool is_efficiently_copyable_v =\n    std::is_trivially_copyable_v&lt;T&gt; &amp;&amp; (sizeof(T) &lt;= magic_size);\n</code></pre>\n\n<p>Then, you can use this trait to define which function to use with SFINAE (or concepts in C++20), making them mutually exclusive:</p>\n\n<pre><code>template &lt;typename T&gt;\nauto f(const T&amp;) -&gt; std::enable_if_t&lt;!is_efficiently_copyable_v&lt;T&gt;&gt;;\n\ntemplate &lt;typename T&gt;\nauto f(T) -&gt; std::enable_if_t&lt;is_efficiently_copyable_v&lt;T&gt;&gt;;\n</code></pre>\n\n<p>(You can also use any other flavor of SFINAE you want)</p>\n\n<p>This way, your function <code>f</code>'s interface always receives the parameter in your desired way. <a href=\"https://godbolt.org/z/XHMbpl\" rel=\"nofollow noreferrer\">Live example</a>: Notice which functions are called in the assembly output. </p>\n\n<hr/>\n\n<p>Just a small side note: GCC generates the same code for <code>const T&amp;</code> and <code>T</code> parameters in all architectures I tested, but Clang doesn't, so beware of that if you just want to go the const reference route. <a href=\"https://godbolt.org/z/_DrP2o\" rel=\"nofollow noreferrer\">Live example</a>: you may change the parameter type in the <code>main</code> function and between compilers to verify this.</p>\n"}], "owner": {"reputation": 41, "user_id": 11898386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3f63c682ddec1cd18052392930af44?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter van Ooijen", "link": "https://stackoverflow.com/users/11898386/wouter-van-ooijen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1565255325, "creation_date": 1565213446, "question_id": 57402532, "link": "https://stackoverflow.com/questions/57402532/passing-a-read-only-parameter-in-c-copy-or-reference-or", "title": "Passing a read-only parameter in C++: copy or reference, or", "body": "<p>I have a template function, that accepts a read-only parameter of the templated type. This is a library function for various platforms, from 8-bit (AVR8) to 32 bit (Cortex). How to pass this parameter? </p>\n\n<pre><code>template&lt; typename T &gt;\nvoid f( const T p ){ ... }\n\ntemplate&lt; typename T &gt;\nvoid f( const T &amp; p ){ ... }\n</code></pre>\n\n<p>By value is (probably) more efficient for parameter types that are smaller than a pointer, by reference is (probably) more efficient for parameter types that are larger than a pointer, and/or expensive to copy. </p>\n\n<p>Is there any standard way to abstract this choice, like</p>\n\n<pre><code>template&lt; typename T &gt;\nvoid f( pass_efficiently&lt; T &gt; p ){ ... }\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["c++", "c++14", "c++20"], "comments": [{"owner": {"reputation": 182843, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 7, "creation_date": 1565213301, "post_id": 57402464, "comment_id": 101286513, "body": "Well, it&#39;s clear from looking that <code>char8_t</code> is an 8 bit type. Also, <i>The signedness of char depends on the compiler and the target platform: the defaults for ARM and PowerPC are typically unsigned, the defaults for x86 and x64 are typically signed.</i> while <code>char8_t</code> is <b>always</b> unsigned."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1565213380, "post_id": 57402464, "comment_id": 101286544, "body": "&quot; or does char8_t has an extra edge?&quot; - what do you mean by that?"}, {"owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "edited": false, "score": 0, "creation_date": 1565214280, "post_id": 57402464, "comment_id": 101286824, "body": "I mean any other benefits"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565214421, "post_id": 57402464, "comment_id": 101286865, "body": "Rats. I was hoping you meant like the magic sword from The Sword and the Sorcerer."}, {"owner": {"reputation": 11713, "user_id": 43534, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6b36958661c789010d95b27325154828?s=128&d=identicon&r=PG", "display_name": "Miral", "link": "https://stackoverflow.com/users/43534/miral"}, "edited": false, "score": 0, "creation_date": 1565249508, "post_id": 57402464, "comment_id": 101295453, "body": "Logically, code can assume that a string of <code>char8_t</code> always contains UTF-8 text (barring bugs), whereas it is less safe to assume any particular encoding of a <code>char</code> string without additional knowledge of the environment."}, {"owner": {"reputation": 61429, "user_id": 572743, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9941673f566f229bc536c1c2b558884e?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/572743/damon"}, "edited": false, "score": 6, "creation_date": 1565254139, "post_id": 57402464, "comment_id": 101297779, "body": "Well, there <i>are</i> benefits. The <code>char</code> type, like much of C++&#39;s C heritage is, and has always been annoyingly broken. You do not know whether it&#39;s signed or not, and very strictly you do not even know how many bits it has (though 8 is a rather safe bet, there&#39;s no guarantee whatsoever). The <code>char8_t</code> type gives both guarantees. Unluckily, nobody was bold enough to simply &quot;fix&quot; the broken original type (which could admittedly break existing code, but so what... modern C++ is incompatible with legacy C++ anyway). Much like nobody could be bothered to make <code>size_t</code> or <code>ptrdiff_t</code> a <i>proper</i> type."}, {"owner": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "reply_to_user": {"reputation": 61429, "user_id": 572743, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9941673f566f229bc536c1c2b558884e?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/572743/damon"}, "edited": false, "score": 2, "creation_date": 1565255051, "post_id": 57402464, "comment_id": 101298273, "body": "@Damon according to <a href=\"https://stackoverflow.com/questions/57402464/is-c20-char8-t-the-same-as-our-old-char/57402487?noredirect=1#comment101288657_57402487\">this comment</a>, there is no requirement that <code>char8_t</code> is exactly eight bits, so nothing changed in that regard\u2026"}, {"owner": {"reputation": 61429, "user_id": 572743, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9941673f566f229bc536c1c2b558884e?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/572743/damon"}, "reply_to_user": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "edited": false, "score": 0, "creation_date": 1565286210, "post_id": 57402464, "comment_id": 101315798, "body": "@Holger: Funnily, the C++ standard <b>indeed</b> doesn&#39;t require that there be exactly 8 bits. Nor does it require that for any of the &lt;cstdint&gt; stuff, it merely says &quot;Yeah, blah blah, same as in C&quot;. Now, C doesn&#39;t say either... it says &quot;Yeah, blah blah POSIX&quot;. Luckily, POSIX <i>does</i> say :-) This is a <i>&quot;exact width type&quot;</i> in POSIX talk (as opposed to the <code>_least</code> or  <code>_fast</code> types, which are, at least as large, and could be, well, basically anything)."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 61429, "user_id": 572743, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9941673f566f229bc536c1c2b558884e?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/572743/damon"}, "edited": false, "score": 2, "creation_date": 1587623649, "post_id": 57402464, "comment_id": 108584580, "body": "@Damon C has always guaranteed that <code>char</code> has <i>at least</i> 8 bits. POSIX and most other systems like Windows guarantee that <code>char</code> is exactly 8 bits. But C does <b>not</b> say &quot;Yeah, blah blah POSIX&quot;. POSIX incorporates the C standard, not the other way around. And unless C suddenly decides to alienate a huge part of its niche, they&#39;re not going to make an exactly eight bit type mandatory, because C is the primary language used to program all the modern embedded/niche hardware which has bytes bigger than eight bits."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 10, "creation_date": 1565214415, "post_id": 57402487, "comment_id": 101286862, "body": "@MichaelDorgan But 98 is bigger than 17 and 98 was... not so fun to work with ;)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1565214671, "post_id": 57402487, "comment_id": 101286943, "body": "You might want to mention that <code>char</code>, unlike <code>char8_t</code>, may be either signed or unsigned. It&#39;s possible for <code>char</code> and <code>char8_t</code> to have the same range and representation (with both having the same <i>underlying type</i>, <code>unsigned char</code>), but they&#39;re still distinct types."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1565214675, "post_id": 57402487, "comment_id": 101286944, "body": "@NathanOliver Better."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 3, "creation_date": 1565214789, "post_id": 57402487, "comment_id": 101286989, "body": "@MichaelDorgan: Isn&#39;t the &quot;compatibility&quot; with C which increases complexity? as sign issue of <code>char</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1565214876, "post_id": 57402487, "comment_id": 101287006, "body": "@KeithThompson I&#39;ve added a paragraph about that."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 11, "creation_date": 1565215375, "post_id": 57402487, "comment_id": 101287117, "body": "@MichaelDorgan in case you are unaware, C also has <code>char16_t</code>, <code>char32_t</code> and associated char/string literals and manipulation functions. (As well as <code>char</code>, <code>unsigned char</code>, <code>signed char</code>, <code>int8_t</code> and <code>uint8_t</code> of course)"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 4, "creation_date": 1565216208, "post_id": 57402487, "comment_id": 101287336, "body": "For some definition of &quot;exactly the same&quot;. A key feature of <code>char8_t</code> is that it doesn&#39;t alias everything under the sun."}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 4, "creation_date": 1565216294, "post_id": 57402487, "comment_id": 101287355, "body": "So, did we actually need another name from something that already exists?"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1565216630, "post_id": 57402487, "comment_id": 101287437, "body": "What happens when we exceed <code>size_t</code> number of integer types?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1565217073, "post_id": 57402487, "comment_id": 101287543, "body": "@MichaelChourdakis I believe it was done for consistences sake.  It makes it a lot easier to write a macro to get <code>charN_t</code> when <code>8</code> is a valid <code>N</code>"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1565217477, "post_id": 57402487, "comment_id": 101287637, "body": "<code>using utf8 = char8_t;</code>  Naming aside, a char8_t isn&#39;t a character, it is a UTF-8 encoding unit.  Probably a quibble.  I&#39;m just happy seeing C++ become more, and more Unicode savvy without resorting to third party utilities (even excellent ones like ICU)."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1565217685, "post_id": 57402487, "comment_id": 101287692, "body": "@M.M - Yup aware.  I kinda have to be as its my job to make sure all those things continue to work.  But when I&#39;m in system/OS land and having to deal with C++ edge cases again and again...  Anyway, so yeah and get off my lawn :)"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 17, "creation_date": 1565218655, "post_id": 57402487, "comment_id": 101287910, "body": "@MichaelChourdakis: &quot;<i>So, did we actually need another name from something that already exists?</i>&quot; Yes. If I give you a <code>const char*</code>, is it UTF-8 encoded? You don&#39;t know. If I instead give you a <code>const char8_t *</code>, then if it <i>isn&#39;t</i> UTF-8 encoded, <i>I am a liar</i>. Types matter, and if C++ is going to get decent Unicode support, we must have types that represent strings encoded in a Unicode encoding, not merely whatever the compiler felt like. The only real problem with <code>char8_t</code> is that few existing APIs that <i>could</i> take them do so. And that&#39;s a problem that will be solved as Unicode gets done."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 12, "creation_date": 1565222515, "post_id": 57402487, "comment_id": 101288657, "body": "Interestingly, there&#39;s no requirement that <code>char8_t</code> is exactly 8 bits. Since it has the same representation as <code>unsigned char</code>, it&#39;s <code>CHAR_BIT</code> bits. Unlike <code>uint8_t</code>, which isn&#39;t defined if there&#39;s no 8-bit integral type, <code>char8_t</code> is always defined. (There are probably no hosted implementations with <code>CHAR_BIT != 8</code>.)"}, {"owner": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1565251298, "post_id": 57402487, "comment_id": 101296287, "body": "@KeithThompson that makes me wonder how an application will process real life UTF-8 encoded text, which is definitely a sequence of 8Bit-Bytes, when there is no no 8-bit integral type. There is no need to process a single UTF-8 unit, except when you are implementing the very code which will assemble them into a Unicode codepoint, which should be implemented only once (preferable in a standard library). That method needs to be able to define the input as array of 8 bit units, which UTF-8 encoded text always is. When reading the element, any integral type of at least 8 bit suffices."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "edited": false, "score": 2, "creation_date": 1565253297, "post_id": 57402487, "comment_id": 101297324, "body": "@Holger: <code>CHAR_BITS</code> is <i>at least</i> 8.  Assume we are dealing with an implementation where <code>CHAR_BITS</code> is (eg) 9, and our UTF-8 encoded text is arriving over the network.  The call to <code>read</code> (or whatever the networking primitive is called) will receive octets from the network, and store them in 9-bit bytes (using the word in its C++ standard meaning) in memory.  Similarly a file containing UTF-8 will store each UTF-8 sub-unit in a 9-bit byte (with a leading zero bit).  The file will not pack nine UTF-8 units into eight 9-bit bytes.  (Or at least, it won&#39;t unless somebody is being silly)."}, {"owner": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1565254488, "post_id": 57402487, "comment_id": 101297975, "body": "@MartinBonner and that automatism also works in the other direction, i.e. the ninth bit is always discarded when writing a sequence of these 9 bit bytes to a file or sending data over the network? Well <i>that\u2019s</i> what I\u2019d call silly. But let\u2019s not judge that hypothetical architecture, let\u2019s talk about the C++ standard that takes so much care to support such hypothetical systems transparently. What do you think, how many real life applications handle these aspects of the standard correctly, in that these applications will work smoothly on such systems?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "edited": false, "score": 1, "creation_date": 1565255943, "post_id": 57402487, "comment_id": 101298753, "body": "@Holger As Martin says, incoming UTF-8 data would probably have to be stored in bytes rather than in octets. As for writing output, my guess is that writing data to a text stream would strip it to 8 bits, but writing to a binary stream would retain all <code>CHAR_BIT</code> bits (because you have to be able to read back the same binary data you wrote). But it&#39;s unlikely to matter, because as far as I know all hosted implementations have <code>CHAR_BIT==8</code>. (Some DSPs set <code>CHAR_BIT</code> to 16 or 32, but they&#39;re not hosted so they don&#39;t have to support standard I/O.)"}, {"owner": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1565256424, "post_id": 57402487, "comment_id": 101299040, "body": "@KeithThompson but would that imply that applications have to read UTF-8 input with special functions or are unsigned bytes and \u201cUTF-8 units\u201d, i.e. <code>char8_t</code>,  just interchangeable, even on those exotic systems? I also have the feeling that it hardly ever matters, however, there must be a reason why the C++ standard committee puts such a burden on the programmer\u2026"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "edited": false, "score": 0, "creation_date": 1565307687, "post_id": 57402487, "comment_id": 101322911, "body": "@Holger: <code>char8_t</code> by definition has the same size, range, and representation as <code>unsigned char</code>, whatever size that is. Probably there would be some way to translate 8-bit UTF-8 text to a form that could be stored on such a system. It&#39;s unlikely to come up in practice. I&#39;m not sure what burden you&#39;re referring to."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "edited": false, "score": 1, "creation_date": 1587624266, "post_id": 57402487, "comment_id": 108584839, "body": "@Holger That&#39;s not a hypothetical architecture - 9 bit bytes have existed in the past in real hardware, and C ran on it, and it did exactly that - the top bit is simply ignored when reading or writing octet-based network or storage data. <i>To this day</i> systems like that exist, although the new ones are merely emulating 9 bit byte hardware on top of 8 bit byte hardware. (I call the 9 bit byte the &quot;banker&#39;s byte&quot;, because of course the only people willing to keep the 9 bit byte going are the financial industry, where they&#39;ll do anything to not have to rewrite software.)"}, {"owner": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "reply_to_user": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 1, "creation_date": 1587624884, "post_id": 57402487, "comment_id": 108585119, "body": "@mtraceur that\u2019s contradicting. When the C implementation simply ignores the 9th bit, the behavior is just as if the standard said \u201ca byte has 8 bits\u201d, but the standard is not saying it. It allows C implementations which do <i>not</i> ignore the bit and require the application programmer to deal with it."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "edited": false, "score": 0, "creation_date": 1587633534, "post_id": 57402487, "comment_id": 108589622, "body": "@Holger I said it is ignored specifically when doing I/O over octet byte mediums, with &quot;ignored&quot; obviously meaning set to zero on read, unused on write, as you were already discussing in prior comments. The bit is fully accessible and usable the rest of the time. The whole C implementation does not ignore it, just some I/O routines in the provided libraries do."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 51, "last_activity_date": 1565214854, "last_edit_date": 1565214854, "creation_date": 1565213225, "answer_id": 57402487, "question_id": 57402464, "link": "https://stackoverflow.com/questions/57402464/is-c20-char8-t-the-same-as-our-old-char/57402487#57402487", "title": "Is C++20 &#39;char8_t&#39; the same as our old &#39;char&#39;?", "body": "<p><code>char8_t</code> is not the same as <code>char</code>.  It behaves exactly the same as <code>unsigned char</code> though per <a href=\"https://timsong-cpp.github.io/cppwp/basic.fundamental#9\" rel=\"noreferrer\">[basic.fundamental]/9</a></p>\n\n<blockquote>\n  <p><strong>Type <code>char8_\u00adt</code> denotes a distinct type whose underlying type is <code>unsigned char</code></strong>. Types <code>char16_\u00adt</code> and <code>char32_\u00adt</code> denote distinct types whose underlying types are <code>uint_\u00adleast16_\u00adt</code> and <code>uint_\u00adleast32_\u00adt</code>, respectively, in <code>&lt;cstdint&gt;.</code></p>\n</blockquote>\n\n<p><sup>emphasis mine</sup></p>\n\n<hr>\n\n<p>Do note that since the standard calls it a <em>distinct type</em>, code like</p>\n\n<pre><code>std::cout &lt;&lt; std::is_same_v&lt;unsigned char, char8_t&gt;;\n</code></pre>\n\n<p>will print <code>0</code>(false), even though <code>char8_t</code> is implemented as a <code>unsigned char</code>.  This is because it is not an alias, but a distinct type.</p>\n\n<hr>\n\n<p>Another thing to note is that <code>char</code> can either be implemented as a <code>signed char</code> or <code>unsigned char</code>.  That means it is possible for <code>char</code> to have the same range and representation as <code>char8_t</code>, but they are still separate types.  <code>char</code>, <code>signed char</code>, <code>unsigned char</code>, and <code>char8_t</code> are the same size, but they are all distinct types.</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 6689863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCFrB.jpg?s=128&g=1", "display_name": "Mala", "link": "https://stackoverflow.com/users/6689863/mala"}, "edited": false, "score": 8, "creation_date": 1565729186, "post_id": 57453713, "comment_id": 101441305, "body": "Why is it char8_t not uchar8_t?"}, {"owner": {"reputation": 925, "user_id": 11634221, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZROx.jpg?s=128&g=1", "display_name": "Tom Honermann", "link": "https://stackoverflow.com/users/11634221/tom-honermann"}, "reply_to_user": {"reputation": 101, "user_id": 6689863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCFrB.jpg?s=128&g=1", "display_name": "Mala", "link": "https://stackoverflow.com/users/6689863/mala"}, "edited": false, "score": 15, "creation_date": 1565746000, "post_id": 57453713, "comment_id": 101445006, "body": "Because <code>char8_t</code> is consistent with <code>char16_t</code> and <code>char32_t</code> (also unsigned types)."}], "tags": [], "owner": {"reputation": 925, "user_id": 11634221, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZROx.jpg?s=128&g=1", "display_name": "Tom Honermann", "link": "https://stackoverflow.com/users/11634221/tom-honermann"}, "is_accepted": false, "score": 46, "last_activity_date": 1565558573, "creation_date": 1565558573, "answer_id": 57453713, "question_id": 57402464, "link": "https://stackoverflow.com/questions/57402464/is-c20-char8-t-the-same-as-our-old-char/57453713#57453713", "title": "Is C++20 &#39;char8_t&#39; the same as our old &#39;char&#39;?", "body": "<p>Disclaimer: I'm the author of the <code>char8_t</code> <a href=\"http://wg21.link/p0482\" rel=\"noreferrer\">P0482</a> and <a href=\"http://wg21.link/p1423\" rel=\"noreferrer\">P1423</a> proposals.</p>\n\n<p>In C++20, <code>char8_t</code> is a distinct type from all other types.  In the related proposal for C, <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2231.htm\" rel=\"noreferrer\">N2231</a> (which is in need of an update and re-proposal to WG14), <code>char8_t</code> would be a typedef of <code>unsigned char</code> similar to the existing typedefs for <code>char16_t</code> and <code>char32_t</code>.</p>\n\n<p>In C++20, <code>char8_t</code> has an underlying representation that matches <code>unsigned char</code>.  It therefore has the same size (at least 8-bit, but may be larger), alignment, and integer conversion rank as <code>unsigned char</code>, but has different aliasing rules.</p>\n\n<p>In particular, <code>char8_t</code> was not added to the list of types at <a href=\"http://eel.is/c++draft/expr#basic.lval-11\" rel=\"noreferrer\">[basic.lval]p11</a>. <a href=\"http://eel.is/c++draft/basic#life-6.4\" rel=\"noreferrer\">[basic.life]p6.4</a>, <a href=\"http://eel.is/c++draft/basic#types-2\" rel=\"noreferrer\">[basic.types]p2</a>, or <a href=\"http://eel.is/c++draft/basic#types-4\" rel=\"noreferrer\">[basic.types]p4</a>.  This means that, unlike <code>unsigned char</code>, it cannot be used for the underlying storage of objects of another type, nor can it be used to examine the underlying representation of objects of other types; in other words, it cannot be used to alias other types.  A consequence of this is that objects of type <code>char8_t</code> can be accessed via pointers to <code>char</code> or <code>unsigned char</code>, but pointers to <code>char8_t</code> cannot be used to access <code>char</code> or <code>unsigned char</code> data.  In other words:</p>\n\n<pre><code>reinterpret_cast&lt;const char   *&gt;(u8\"text\"); // Ok.\nreinterpret_cast&lt;const char8_t*&gt;(\"text\");   // Undefined behavior.\n</code></pre>\n\n<p>The motivation for a distinct type with these properties is:</p>\n\n<ol>\n<li><p>To provide a distinct type for UTF-8 character data vs character data with an encoding that is either locale dependent or that requires separate specification.</p></li>\n<li><p>To enable overloading for ordinary string literals vs UTF-8 string literals (since they may have different encodings).</p></li>\n<li><p>To ensure an unsigned type for UTF-8 data (whether <code>char</code> is signed or unsigned is implementation defined).</p></li>\n<li><p>To enable better performance via a non-aliasing type; optimizers can better optimize types that do not alias other types.</p></li>\n</ol>\n"}], "owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7846, "favorite_count": 9, "accepted_answer_id": 57402487, "answer_count": 2, "score": 45, "last_activity_date": 1565558573, "creation_date": 1565213000, "last_edit_date": 1565260248, "question_id": 57402464, "link": "https://stackoverflow.com/questions/57402464/is-c20-char8-t-the-same-as-our-old-char", "title": "Is C++20 &#39;char8_t&#39; the same as our old &#39;char&#39;?", "body": "<p>In the CPP reference <a href=\"https://en.cppreference.com/w/cpp/language/types\" rel=\"noreferrer\">documentation</a>,</p>\n\n<p>I noticed for <code>char</code></p>\n\n<blockquote>\n  <p>The character types are large enough to represent any UTF-8 eight-bit\n  code unit (since C++14)</p>\n</blockquote>\n\n<p>and for <code>char8_t</code></p>\n\n<blockquote>\n  <p>type for UTF-8 character representation, required to be large enough\n  to represent any UTF-8 code unit (8 bits)</p>\n</blockquote>\n\n<p>Does that mean both are the same type? Or does <code>char8_t</code> have some other feature?</p>\n"}, {"tags": ["c++", "linux", "pthreads", "scheduled-tasks", "scheduler"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565213081, "post_id": 57402348, "comment_id": 101286442, "body": "50 kHz is pretty hardcore for a timer. If you can get it, you&#39;re spending a LOT of time servicing it."}, {"owner": {"reputation": 740, "user_id": 5275945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/02e26f954321fb0b208690369b38a22f?s=128&d=identicon&r=PG&f=1", "display_name": "Mihai", "link": "https://stackoverflow.com/users/5275945/mihai"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1565213432, "post_id": 57402348, "comment_id": 101286566, "body": "@JohnBollinger yeah sorry, my bad, it&#39;s late here, i&#39;ll change that"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1565219253, "post_id": 57402348, "comment_id": 101288017, "body": "I&#39;m not sure 50kHz is even doable on most common hardware.  Most likely the timer is going off &quot;as fast as possible&quot; (hence the 100% CPU usage) but not 50,000 times per second."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1565218830, "creation_date": 1565218830, "answer_id": 57403223, "question_id": 57402348, "link": "https://stackoverflow.com/questions/57402348/posix-timer-on-sched-rr-thread-is-using-100-cpu/57403223#57403223", "title": "Posix Timer on SCHED_RR Thread is using 100% CPU", "body": "<p>As presented, your program does not behave as you describe.  This is because you program the timer as a one-shot, not a repeating timer.  For a timer that fires every 20000 ns, you want to set a 20000-ns interval:</p>\n\n<pre><code>    ts.it_interval.tv_nsec = 20000;\n</code></pre>\n\n<p>Having modified that, I get a program that works produces heavy load on one core.</p>\n\n<blockquote>\n  <ol>\n  <li>Why 100% CPU Usage since the thread is supposed to be sleeping while waiting for the timer to fire, so other tasks can be scheduled\n  in theory right? even if this is a high priority thread.</li>\n  </ol>\n</blockquote>\n\n<p>Sure, your thread blocks in <code>epoll_wait()</code> to await timer ticks, if in fact it manages to loop back there before the timer ticks again.  On my machine, your program consumes only about 30% of one core, which seems to confirm that such blocking will indeed happen.  That you see 100% CPU use suggests that my computer runs the program more efficiently than yours does, for whatever reason.</p>\n\n<p>But you have to appreciate that the load is <em>very</em> heavy.  You are asking to perform all the processing of the timer itself, the epoll call, the read, and <code>func15ns()</code> once every 20000 ns.  Yes, whatever time may be left, if any, is available to be scheduled for another task, but the task swap takes a bit more time again.  20000 ns is not very much time.  Consider that just <a href=\"https://people.eecs.berkeley.edu/~rcs/research/interactive_latency.html\" rel=\"nofollow noreferrer\">fetching a word from main memory costs about 100 ns</a> (though reading one from cache is of course faster).</p>\n\n<p>In particular, do not neglect the work other than <code>func15ns()</code>.  If the latter indeed takes only 15 ns to run then it's the least of your worries.  You're performing two system calls, and these are expensive.  Just how expensive depends on a lot of factors, but consider that removing the <code>epoll_wait()</code> call reduces the load for me from 30% to 25% of a core (and note that the whole epoll setup is superfluous here because simply allowing the <code>read()</code> to block serves the purpose).</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>I checked using pidstat the number of context switches and it seems that it's very small, close to 0, both voluntary and involuntary\n  ones. Is this normal? While waiting for the timer to fire the\n  scheduler should schedule other tasks right? I should see at least\n  20000 * 2 context switches / sec</li>\n  </ol>\n</blockquote>\n\n<p>You're occupying a full CPU with a high priority task, so why do you expect switching?</p>\n\n<p>On the other hand, I'm also observing a low number of context switches for the process running your (modified) program, even though it's occupying only 25% of a core. I'm not prepared at the moment to reason about why that is.</p>\n"}], "owner": {"reputation": 740, "user_id": 5275945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/02e26f954321fb0b208690369b38a22f?s=128&d=identicon&r=PG&f=1", "display_name": "Mihai", "link": "https://stackoverflow.com/users/5275945/mihai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565218830, "creation_date": 1565212339, "last_edit_date": 1565213466, "question_id": 57402348, "link": "https://stackoverflow.com/questions/57402348/posix-timer-on-sched-rr-thread-is-using-100-cpu", "title": "Posix Timer on SCHED_RR Thread is using 100% CPU", "body": "<p>I have the following code snippet:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n\n#include &lt;unistd.h&gt;\n#include &lt;sys/epoll.h&gt;\n#include &lt;sys/timerfd.h&gt;\n\nint main() {\n    std::thread rr_thread([](){\n      struct sched_param params = {5};\n      pthread_setschedparam(pthread_self(), SCHED_RR, &amp;params);\n\n      struct itimerspec ts;\n      struct epoll_event ev;\n      int tfd ,epfd;\n\n      ts.it_interval.tv_sec = 0;\n        ts.it_interval.tv_nsec = 0;\n        ts.it_value.tv_sec = 0;\n        ts.it_value.tv_nsec = 20000; // 50 kHz timer\n\n      tfd = timerfd_create(CLOCK_MONOTONIC, 0);\n      timerfd_settime(tfd, 0, &amp;ts, NULL);\n      epfd = epoll_create(1);\n\n      ev.events = EPOLLIN;\n      epoll_ctl(epfd, EPOLL_CTL_ADD, tfd, &amp;ev);\n\n      while (true) {\n        epoll_wait(epfd, &amp;ev, 1, -1); // wait forever for the timer\n        read(tfd, &amp;missed, sizeof(missed));\n\n        // Here i have a blocking function (dummy in this example) which\n        // takes on average 15ns to execute, less than the timer period anyways\n        func15ns();\n      }\n\n    });\n\n    rr_thread.join();\n}\n</code></pre>\n\n<p>I have a posix thread using the SCHED_RR policy and on this thread there is a POSIX Timer running with a timeout of 20000ns = 50KHz = 50000 ticks/sec.</p>\n\n<p>After the timer fires i am executing a function that takes roughly 15ns so less than the timer period, but this doesn't really matter.</p>\n\n<p>When i execute this i am getting 100% CPU Usage, the whole system is getting slow but i don't understand why this is happening and some things are confusing.</p>\n\n<ol>\n<li><p>Why 100% CPU Usage since the thread is supposed to be sleeping while waiting for the timer to fire, so other tasks can be scheduled in theory right? even if this is a high priority thread.</p></li>\n<li><p>I checked using pidstat the number of context switches and it seems that it's very small, close to 0, both voluntary and involuntary ones. Is this normal? While waiting for the timer to fire the scheduler should schedule other tasks right? I should see at least 20000 * 2 context switches / sec</p></li>\n</ol>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 4, "creation_date": 1565211348, "post_id": 57402136, "comment_id": 101285922, "body": "Are you sure this is a minimal example? Have you checked whether your randomisation works without use of any other classes?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 3, "creation_date": 1565211553, "post_id": 57402136, "comment_id": 101285986, "body": "<code>SGGame game(delta,                       numStates,                       numActions,                       payoffs,                       probabilities,                       unconstrained);</code> looks suspicious in the constructor. It looks like you create a local variable <code>game</code> which ends its scope at closing <code>}</code>"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1565211769, "post_id": 57402136, "comment_id": 101286046, "body": "<code>SGGame game(delta, numStates, numActions, payoffs, probabilities, unconstrained);</code> creates a temporary object of type <code>SGGame</code> and immediately destroys it. That&#39;s almost always a mistake. But with all the (probably irrelevant) code in that constructor, it&#39;s not possible to say for sure without putting in a great deal of time that wouldn&#39;t be necessary if you removed code that doesn&#39;t contribute to the problem."}, {"owner": {"reputation": 1588, "user_id": 1899494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d8bff769c85b3fc72eec038070928ff?s=128&d=identicon&r=PG", "display_name": "hugo", "link": "https://stackoverflow.com/users/1899494/hugo"}, "edited": false, "score": 1, "creation_date": 1565211786, "post_id": 57402136, "comment_id": 101286052, "body": "Your code is neither minimal, nor sufficient to understand your issue, and what you&#39;re trying to express with that code... You said &quot;it is always creating a game with two players, one state, and one action, regardless of inputs&quot;, but how do you know that? Where is the code that leads you to that conclusion?"}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 1, "creation_date": 1565212039, "post_id": 57402136, "comment_id": 101286122, "body": "Welcome to Stack Overflow. We ask that people pot <a href=\"https://stackoverflow.com/hlp/mcve\">minimal complete examples</a> of malfunctioning code, and this is not just for our benefit. When you write code, it behooves you to build up from the simple to the complex, testing often, and developing new functionality <i>in isolation</i> as much as possible. In a case like this, when you have written a lot of tightly coupled code since your last test, it&#39;s best to retreat: pare away code, testing at every step, until the error disappears. This will make the bug  much easier to see."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1565212688, "post_id": 57402136, "comment_id": 101286320, "body": "I expect  the  the problem is you are not initializing the base <code>SGGame</code> of <code>RandomGame</code>. Instead you create a new <code>SGGame</code> that has no connection to the one that is the base of <code>RandomGame</code>. That new one <code>game</code> goes out of scope and all of your randomization work is thrown away."}], "answers": [{"tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": true, "score": 1, "last_activity_date": 1565213618, "last_edit_date": 1565213618, "creation_date": 1565213123, "answer_id": 57402477, "question_id": 57402136, "link": "https://stackoverflow.com/questions/57402136/constructor-function-is-not-working-properly/57402477#57402477", "title": "Constructor Function is not working properly", "body": "<p>At the end of your constructor, you create the <code>SGGame</code> object, but don't actually do anything with it. It's just discarded. </p>\n\n<p>Because <code>SGGame</code> is a base class of <code>RandomGame</code>, the logic inside your constructor should be moved into it's own function, which can then be passed to the constructor for <code>SGGame</code>. </p>\n\n<p>We'll call this function <code>generateRandomGame</code>:</p>\n\n<pre><code>class RandomGame : public SGGame {\nprivate:\n  int numactions;\n\npublic:\n  RandomGame(int numPlayers, int numStates, int numactions)\n    : SGGame(generateRandomGame(numPlayers, numStates, numactions))\n    , numactions(numactions) {}\n  // Other stuff...\n};\n\n</code></pre>\n\n<p>Based on the code in your original constructor, <code>generateRandomGame</code> should look something like this:</p>\n\n<pre><code>SGGame generateRandomGame(int numPlayers, int numStates, int numactions) {\n\n    unsigned seed = std::chrono::system_clock::now().time_since_epoch().count();\n    std::default_random_engine generator(seed);\n\n    std::uniform_real_distribution&lt;double&gt; distribution(1e-6, 1 - (1e-6));\n    double delta = distribution(generator);\n\n    vector&lt;bool&gt; unconstrained(numPlayers, false);\n\n    vector&lt;vector&lt;int&gt;&gt; numActions(numStates,\n                                   vector&lt;int&gt;(numPlayers, numactions));\n    vector&lt;int&gt; numActions_total(numStates, pow(numactions, numPlayers));\n\n    // Payoffs\n\n    vector&lt;vector&lt;vector&lt;double&gt;&gt;&gt; payoffs(\n        numStates, vector&lt;vector&lt;double&gt;&gt;(pow(numactions, numPlayers),\n                                          vector&lt;double&gt;(numPlayers, 0.0)));\n    unsigned int i, j, k, l;\n    for (i = 0; i &lt; numStates; i++) {\n        for (j = 0; j &lt; numActions_total[i]; j++) {\n            for (k = 0; k &lt; numPlayers; k++) {\n                std::uniform_real_distribution&lt;double&gt; distribution(0, 10);\n\n                payoffs[i][j][k] = distribution(generator);\n            }\n        }\n    }\n    // Transition probabilities\n    vector&lt;vector&lt;vector&lt;double&gt;&gt;&gt; probabilities(\n        numStates,\n        vector&lt;vector&lt;double&gt;&gt;(\n            pow(numactions, numPlayers),\n            vector&lt;double&gt;(numStates,\n                           1.0))); // 1.0 as initial value, but then randomize\n    // randomize transition probabilities\n    double prob_sum;\n    for (i = 0; i &lt; numStates; i++) {\n        for (j = 0; j &lt; numActions_total[i]; j++) {\n            prob_sum = 0.0;\n            for (k = 0; k &lt; numStates; k++) {\n                std::uniform_real_distribution&lt;double&gt; distribution(0, 1.0);\n                probabilities[i][j][k] = distribution(generator);\n                // normalize probabilities\n                prob_sum += probabilities[i][j][k];\n            }\n            for (k = 0; k &lt; numStates; k++) {\n                probabilities[i][j][k] = probabilities[i][j][k] / prob_sum;\n            }\n        }\n    }\n    return SGGame(delta, numStates, numActions, payoffs, probabilities,\n                  unconstrained);\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11898459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3cbc4c1631ad14aad927bd50f2d222?s=128&d=identicon&r=PG&f=1", "display_name": "IJWolff", "link": "https://stackoverflow.com/users/11898459/ijwolff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1565213184, "accepted_answer_id": 57402477, "answer_count": 1, "score": -3, "last_activity_date": 1565213618, "creation_date": 1565211071, "question_id": 57402136, "link": "https://stackoverflow.com/questions/57402136/constructor-function-is-not-working-properly", "closed_reason": "Not suitable for this site", "title": "Constructor Function is not working properly", "body": "<p>I wrote a constructor function for a class RandomGame which inherits from a different class, SGGame. However, the constructor is not functioning properly. </p>\n\n<p>It is supposed to create a stochastic game with random payoffs and transition probabilities given interger inputs of number of players, actions, and states. Right now, it is always creating a game with two players, one state, and one action, regardless of inputs. </p>\n\n<p>Here is the constructor function: </p>\n\n<pre><code>class RandomGame : public SGGame\n{\nprivate:\n  int numactions;\npublic:\n  RandomGame(int numPlayers,\n             int numStates,\n             int numactions)\n  {\n\n          unsigned seed = std::chrono::system_clock::now().time_since_epoch().count();\n          std::default_random_engine generator (seed);\n\n          std::uniform_real_distribution&lt;double&gt; distribution(1e-6,1-(1e-6));\n          double delta = distribution(generator);\n\n          vector&lt;bool&gt; unconstrained(numPlayers,false);\n\n          vector&lt; vector&lt; int &gt; &gt; numActions(numStates,vector&lt;int&gt;(numPlayers,numactions));\n          vector&lt;int&gt; numActions_total(numStates,pow(numactions, numPlayers));\n\n  // Payoffs\n\n          vector&lt; vector&lt; vector&lt;double&gt; &gt; &gt;\n                  payoffs(numStates,vector&lt; vector&lt;double&gt; &gt;(pow(numactions, numPla\nyers),vector&lt;double&gt;(numPlayers,0.0)));\n          unsigned int i,j,k,l;\n          for(i=0;i&lt;numStates;i++)\n          {\n            for(j=0;j&lt;numActions_total[i];j++)\n            {\n               for(k=0;k&lt;numPlayers;k++)\n               {\n                 std::uniform_real_distribution&lt;double&gt; distribution(0,10);\n\n                 payoffs[i][j][k] = distribution(generator);\n               }\n            }\n          }\n  // Transition probabilities\n          vector &lt; vector&lt; vector&lt;double&gt; &gt; &gt;\n                  probabilities(numStates,vector&lt; vector&lt;double&gt; &gt;(pow(numactions,\nnumPlayers), vector&lt;double&gt;(numStates,1.0))); // 1.0 as initial value, but then ran\ndomize\n          // randomize transition probabilities\n          double prob_sum;\n          for(i=0;i&lt;numStates;i++)\n          {\n            for(j=0;j&lt;numActions_total[i];j++)\n            {\n              prob_sum = 0.0;\n              for(k=0;k&lt;numStates;k++)\n              {\n                std::uniform_real_distribution&lt;double&gt; distribution(0,1.0);\n                probabilities[i][j][k] = distribution(generator);\n                // normalize probabilities\n                prob_sum += probabilities[i][j][k];\n              }\n              for(k=0;k&lt;numStates;k++)\n              {\n                probabilities[i][j][k] = probabilities[i][j][k]/prob_sum;\n              }\n            }\n          }\n          SGGame game(delta,\n                      numStates,\n                      numActions,\n                      payoffs,\n                      probabilities,\n                      unconstrained);\n  }\n\n}; ```\n\n// decleration of the class SGGame: the constructor I call at the bottom of that code uses an SGGame constructor which creates an SGGame with the given inputs. \n\n``` ```\nclass SGGame\n{\nprivate:\n  double delta; /*!&lt; The discount factor. */\n  int numPlayers; /*!&lt; The number of players. */\n  int numStates; /*!&lt; The number of states, must be at least 1. */\n  vector&lt; vector&lt;int&gt; &gt; numActions; /*!&lt; Gives the number of each\n                                       player's actions in each\n                                       state. In particular, player i\n                                       has numActions[s][i] actions in\n                                       state s. Should note that a\n                                       pair (a1,a2) is mapped into an\n                                       action profile using the\n                                       formula\n                                       a=a1+a2*numActions[s][a1], and\n                                       generalized to n&gt;2. */\n  vector&lt;int&gt; numActions_total; /*!&lt; Total number of action profiles\n                                   for each state. */\n\n  vector&lt; vector&lt;SGPoint&gt; &gt; payoffs; /*!&lt; Gives the payoffs of the\n                                        players as a function of the\n                                        action profile. In particular,\n                                        payoffs[s][a][i] are player\n                                        i's payoffs in state s when\n                                        action profile a is played. */\n\n  vector&lt; vector&lt; vector&lt;double&gt; &gt; &gt; probabilities; /*!&lt; State\n                                                       transition\n                                                       probabilities:\n                                                       probabilities[s][a][s']\n                                                       is the\n                                                       probability of\n                                                       transitioning\n                                                       to state s'\n                                                       when action\n                                                       profile a is\n                                                       played in state\n                                                       s. */\n vector&lt; vector&lt;bool&gt; &gt; eqActions; /*!&lt; Indicates which action profiles\n                                   are allowed to be played on path in\n                                   each state. By default, initialized\n                                   to true for all action\n                                   profiles. Allows one to, for\n                                   example, look at strongly symmetric\n                                   equilibria (by first excluding\n                                   asymmetric action profiles from the\n                                   lists). Players can always deviate\n                                   to action profiles which are not\n                                   allowed on path. */\n\n  vector&lt;bool&gt; unconstrained; /*!&lt; If unconstrained[i]=true, the\n                                 algorithm will not impose incentive\n                                 compatibility as a constraint for\n                                 player i. */ ```\n\n// call to the constructor which is not working properly: \n``` ```\nRandomGame game(2,3,4); ```\n</code></pre>\n"}, {"tags": ["c++", "opencl", "glm-math"], "answers": [{"tags": [], "owner": {"reputation": 501, "user_id": 4083078, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/54cb2765c41c930e79afcc184c78b1f1?s=128&d=identicon&r=PG&f=1", "display_name": "Octo", "link": "https://stackoverflow.com/users/4083078/octo"}, "is_accepted": true, "score": 3, "last_activity_date": 1565212095, "creation_date": 1565212095, "answer_id": 57402299, "question_id": 57402125, "link": "https://stackoverflow.com/questions/57402125/opencl-alignment-issue/57402299#57402299", "title": "OpenCL alignment issue", "body": "<p>I was misusing the vstore function.\nI should have used the 2nd parameter to specify the index in the array.\n<a href=\"https://www.khronos.org/registry/OpenCL/sdk/1.0/docs/man/xhtml/vstoren.html\" rel=\"nofollow noreferrer\">https://www.khronos.org/registry/OpenCL/sdk/1.0/docs/man/xhtml/vstoren.html</a></p>\n\n<pre><code>__kernel void fill_array(__global float *output_values)\n{\n    int i = get_global_id(0);\n    float3 pos = (float3)(1.0, 2.0, 3.0);\n    vstore3(pos, i, output_values);\n}\n</code></pre>\n"}], "owner": {"reputation": 501, "user_id": 4083078, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/54cb2765c41c930e79afcc184c78b1f1?s=128&d=identicon&r=PG&f=1", "display_name": "Octo", "link": "https://stackoverflow.com/users/4083078/octo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 57402299, "answer_count": 1, "score": 0, "last_activity_date": 1565212095, "creation_date": 1565210984, "last_edit_date": 1565211308, "question_id": 57402125, "link": "https://stackoverflow.com/questions/57402125/opencl-alignment-issue", "title": "OpenCL alignment issue", "body": "<p>I want to fill an array of <code>glm::vec3</code> with an OpenCL kernel.\nAll I want to do is fill the array with <code>[1.0, 2.0, 3.0]</code>.</p>\n\n<p>So upon success I should get the triplet repeated 256 times.</p>\n\n<pre><code>[1.0, 2.0, 3.0][1.0, 2.0, 3.0][1.0, 2.0, 3.0] ... [1.0, 2.0, 3.0]\n</code></pre>\n\n<p>However the result looks like this</p>\n\n<pre><code>[1.0, 2.0, 2.0][2.0, 2.0, 2.0] ... [2.0, 2.0, 2.0]\n</code></pre>\n\n<p>Why?</p>\n\n<p>Here is the code for the kernel</p>\n\n<pre><code>__kernel void fill_array(__global float *output_values)\n{\n    int i = get_global_id(0);\n    float3 pos = (float3)(1.0, 2.0, 3.0);\n    vstore3(pos, 0, &amp;(output_values[i]));\n}\n</code></pre>\n\n<p>And here is the code to run it</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;vector&gt;\n#include \"glm/glm.hpp\"\n\n#ifdef __APPLE__\n#include &lt;OpenCL/opencl.h&gt;\n#else\n#include &lt;CL/cl.h&gt;\n#endif\n\n#define MAX_SOURCE_SIZE (0x100000)\n\nint main(void) \n{\n    std::vector&lt;glm::vec3&gt; values;\n    values.resize(256);\n\n    // Load the kernel source code into the array source_str\n    FILE *fp;\n    char *source_str;\n    size_t source_size;\n\n    fp = fopen(\"E:/Dev/fill_array_kernel.cl\", \"r\");\n    if (!fp) {\n        fprintf(stderr, \"Failed to load kernel.\\n\");\n        exit(1);\n    }\n    source_str = (char*)malloc(MAX_SOURCE_SIZE);\n    source_size = fread( source_str, 1, MAX_SOURCE_SIZE, fp);\n    fclose( fp );\n\n    // Get platform and device information\n    cl_platform_id platform_id = NULL;\n    cl_device_id device_id = NULL;   \n    cl_uint ret_num_devices;\n    cl_uint ret_num_platforms;\n    cl_int ret = clGetPlatformIDs(1, &amp;platform_id, &amp;ret_num_platforms);\n    ret = clGetDeviceIDs( platform_id, CL_DEVICE_TYPE_ALL, 1, \n            &amp;device_id, &amp;ret_num_devices);\n\n    // Create an OpenCL context\n    cl_context context = clCreateContext( NULL, 1, &amp;device_id, NULL, NULL, &amp;ret);\n\n    // Create a command queue\n    cl_command_queue command_queue = clCreateCommandQueue(context, device_id, 0, &amp;ret);\n\n    // Create memory buffers on the device for each vector \n    cl_mem output_mem = clCreateBuffer(context, CL_MEM_WRITE_ONLY, values.size() * sizeof(glm::vec3), NULL, &amp;ret);\n\n    // Create a program from the kernel source\n    cl_program program = clCreateProgramWithSource(context, 1, \n            (const char **)&amp;source_str, (const size_t *)&amp;source_size, &amp;ret);\n\n    // Build the program\n    ret = clBuildProgram(program, 1, &amp;device_id, NULL, NULL, NULL);\n    if(ret != CL_SUCCESS)\n    {\n        cl_build_status build_status;\n        ret = clGetProgramBuildInfo(program, device_id, CL_PROGRAM_BUILD_STATUS, sizeof(cl_build_status), &amp;build_status, NULL);\n        size_t ret_val_size;\n        ret = clGetProgramBuildInfo(program, device_id, CL_PROGRAM_BUILD_LOG, 0, NULL, &amp;ret_val_size);\n        char *build_log = (char*)malloc(sizeof(char)*(ret_val_size + 1));\n        ret = clGetProgramBuildInfo(program, device_id, CL_PROGRAM_BUILD_LOG, ret_val_size, build_log, NULL);\n        build_log[ret_val_size] = '\\0';\n        printf(\"%s\\n\", build_log);\n        free(build_log);\n        return -1;\n    }\n\n    // Create the OpenCL kernel\n    cl_kernel kernel = clCreateKernel(program, \"fill_array\", &amp;ret);\n\n    // Set the arguments of the kernel\n    ret = clSetKernelArg(kernel, 0, sizeof(cl_mem), (void *)&amp;output_mem);\n\n    // Execute the OpenCL kernel on the list\n    size_t global_item_size = values.size(); // Process the entire lists\n    size_t local_item_size = 64; // Process in groups of 64\n    ret = clEnqueueNDRangeKernel(command_queue, kernel, 1, NULL, \n            &amp;global_item_size, &amp;local_item_size, 0, NULL, NULL);\n\n    // Read the memory buffer C on the device to the local variable C\n    ret = clEnqueueReadBuffer(command_queue, output_mem, CL_TRUE, 0, values.size() * sizeof(glm::vec3), values.data(), 0, NULL, NULL);\n\n    // Clean up\n    ret = clFlush(command_queue);\n    ret = clFinish(command_queue);\n    ret = clReleaseKernel(kernel);\n    ret = clReleaseProgram(program);\n    ret = clReleaseMemObject(output_mem);\n    ret = clReleaseCommandQueue(command_queue);\n    ret = clReleaseContext(context);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "api", "user-interface"], "answers": [{"tags": [], "owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "is_accepted": false, "score": 1, "last_activity_date": 1565208879, "creation_date": 1565208879, "answer_id": 57401724, "question_id": 57401666, "link": "https://stackoverflow.com/questions/57401666/do-all-gui-frameworks-use-windows-api/57401724#57401724", "title": "Do all GUI frameworks use Windows API?", "body": "<p>Yes. They all use the Windows API eventually (When run under Windows of course). The Win32 API is the API that can do anything Windows is capable of. The API defines the platform for a developer.</p>\n"}, {"comments": [{"owner": {"reputation": 7679, "user_id": 896012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/05779413dbb3915fa5b2f3ed82d66007?s=128&d=identicon&r=PG", "display_name": "Gupta", "link": "https://stackoverflow.com/users/896012/gupta"}, "edited": false, "score": 0, "creation_date": 1565209111, "post_id": 57401735, "comment_id": 101285052, "body": "if that is the case, how Qt can provide you lots of nice controls that do not exist in standard windows controls?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 7679, "user_id": 896012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/05779413dbb3915fa5b2f3ed82d66007?s=128&d=identicon&r=PG", "display_name": "Gupta", "link": "https://stackoverflow.com/users/896012/gupta"}, "edited": false, "score": 1, "creation_date": 1565209219, "post_id": 57401735, "comment_id": 101285098, "body": "@Gupta you get a generic canvas and start drawing. Wire in a the code to handle the non-graphical bells and whistles that the component does and you&#39;ve got a custom component."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1565209424, "post_id": 57401735, "comment_id": 101285173, "body": "That is an important point. A GUI framework need not use the windows common controls. It may implement its own control on a canvas."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "reply_to_user": {"reputation": 7679, "user_id": 896012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/05779413dbb3915fa5b2f3ed82d66007?s=128&d=identicon&r=PG", "display_name": "Gupta", "link": "https://stackoverflow.com/users/896012/gupta"}, "edited": false, "score": 4, "creation_date": 1565209482, "post_id": 57401735, "comment_id": 101285199, "body": "@Gupta, the application&#39;s top-level window will have to be a Windows &quot;window&quot; object with a window procedure that handles window messages in order to interact with the desktop and window manager. Internally it can reinvent the wheel. It doesn&#39;t have to use standard windows controls. But not integrating with the native controls of the OS will make an application stick out like a sore thumb."}, {"owner": {"reputation": 7679, "user_id": 896012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/05779413dbb3915fa5b2f3ed82d66007?s=128&d=identicon&r=PG", "display_name": "Gupta", "link": "https://stackoverflow.com/users/896012/gupta"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565209700, "post_id": 57401735, "comment_id": 101285282, "body": "@user4581301 OK. so these frameworks need to render their own controls and handle the events themselves, right? But at the deepest level it is the OS API."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "reply_to_user": {"reputation": 7679, "user_id": 896012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/05779413dbb3915fa5b2f3ed82d66007?s=128&d=identicon&r=PG", "display_name": "Gupta", "link": "https://stackoverflow.com/users/896012/gupta"}, "edited": false, "score": 3, "creation_date": 1565209896, "post_id": 57401735, "comment_id": 101285373, "body": "@Gupta an interesting design choice in Qt is that Qt doesn&#39;t use native widgets (neither for Windows nor any other OS), preferring to draw its own widgets instead.  That is Qt contains code that mimics the look-and-feel of native widgets under various OS&#39;s, rather than actually instantiating any native widgets.  It does this because (according to Qt devs) it&#39;s easier to get consistent API behavior across many OS&#39;s this way."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 7679, "user_id": 896012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/05779413dbb3915fa5b2f3ed82d66007?s=128&d=identicon&r=PG", "display_name": "Gupta", "link": "https://stackoverflow.com/users/896012/gupta"}, "edited": false, "score": 0, "creation_date": 1565211536, "post_id": 57401735, "comment_id": 101285983, "body": "@Gupta yes. eryksun&#39;s comment laid it out a lot better than I did."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 6, "last_activity_date": 1565208951, "creation_date": 1565208951, "answer_id": 57401735, "question_id": 57401666, "link": "https://stackoverflow.com/questions/57401666/do-all-gui-frameworks-use-windows-api/57401735#57401735", "title": "Do all GUI frameworks use Windows API?", "body": "<p>Ultimately, any UI framework must use the OS's native UI APIs under the hood, and that is the Win32 API and GDI/GDI+ on Windows, yes.</p>\n"}, {"tags": [], "owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "is_accepted": false, "score": 2, "last_activity_date": 1565212429, "creation_date": 1565212429, "answer_id": 57402369, "question_id": 57401666, "link": "https://stackoverflow.com/questions/57401666/do-all-gui-frameworks-use-windows-api/57402369#57402369", "title": "Do all GUI frameworks use Windows API?", "body": "<p>The controls you see as \"Win32\" are just predefined classes in Windows. For example, a \"button\" class handles WM_PAINT, WM_ERASEBKGND, WM_LBUTTONDOWN etc to provide the functions you expect (say, the WM_COMMAND when a button is clicked, is posted from the button when it detects a WM_LBUTTONDOWN/UP in it's client area).</p>\n\n<p>For custom controls, not found in plain Win32, QT (and other libraries) provide their own ready-to-use classes with custom messages. Eventually everything reduces to plain WM_PAINT for painting, only that in predefined classes the painting is also predefined.</p>\n\n<p>In theory, a 3rd party library might even write directly to the video card with a driver - in reality however everyone uses the normal drawing API - that is, Direct2D, GDI+ and GDI.</p>\n"}], "owner": {"reputation": 39, "user_id": 11898317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23e1217dafec08f8c376238c61c364b0?s=128&d=identicon&r=PG&f=1", "display_name": "summit", "link": "https://stackoverflow.com/users/11898317/summit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 1, "closed_date": 1565293123, "answer_count": 3, "score": 3, "last_activity_date": 1565212429, "creation_date": 1565208597, "question_id": 57401666, "link": "https://stackoverflow.com/questions/57401666/do-all-gui-frameworks-use-windows-api", "closed_reason": "Needs more focus", "title": "Do all GUI frameworks use Windows API?", "body": "<p>Microsoft provides Windows API to draw GUI on windows. Do all gui frameworks like Qt, Tk, wxWidgets, GTK, WTL, AWT, Cocoa and Swing etc. use Windows API to draw GUI on windows? We use gui frameworks methods to create gui and on backend they also uses Windows API to draw GUI on windows?</p>\n"}, {"tags": ["c++", "data-structures"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565208252, "post_id": 57401571, "comment_id": 101284717, "body": "Linked hash table?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 4, "creation_date": 1565208445, "post_id": 57401571, "comment_id": 101284788, "body": "Seems like a regular linked list that uses a pool of preallocated nodes."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1565208596, "post_id": 57401571, "comment_id": 101284840, "body": "Nodes that refer to other nodes in the same list is a linked list. In this case, a double-linked list. The links are simply using indexes instead of pointers, but they are still links nontheless."}, {"owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "edited": false, "score": 0, "creation_date": 1565208596, "post_id": 57401571, "comment_id": 101284841, "body": "What are you using this data-structure for? It should have fast lookup and delete, but I don&#39;t think the performance will be much better than that of a well-implemented hash-set (unless you needed fast transversal of a very sparse hash-set)"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1565208696, "post_id": 57401571, "comment_id": 101284888, "body": "Also, hashing seems to be unnecessary here. You can allocate and destroy nodes in the array in O(1) time and O(n) memory. (Not sure how exactly the algorithm for that is called, but I have an implementation <a href=\"https://github.com/HolyBlackCat/imp-re/blob/master/src/utils/resource_allocator.h\" rel=\"nofollow noreferrer\">lying around</a>)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1565208705, "post_id": 57401571, "comment_id": 101284895, "body": "On a side note: &quot;<i>One note is <code>T</code> must have some way of representing &quot;no value&quot;</i>&quot; - sounds like a job for <code>std::optional&lt;T&gt;</code>, or maybe <code>std::variant&lt;T, nullptr_t&gt;</code>"}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1565209623, "post_id": 57401571, "comment_id": 101285257, "body": "@Yksisarvinen we just call it a <code>List</code>, but since it&#39;s used and performs quite different from a normal linked list I was hoping there was a special name"}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "reply_to_user": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "edited": false, "score": 0, "creation_date": 1565209766, "post_id": 57401571, "comment_id": 101285310, "body": "@J.AntonioPerez It&#39;s used for objects in a game. They die and are created quite often, and we need to traverse them quite quickly. There were lots of implementations we used and benchmarked, and (one similar to this one) ended up being the best."}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1565209809, "post_id": 57401571, "comment_id": 101285330, "body": "@HolyBlackCat yes, hashing is not really needed here, it&#39;s just to get a good spread throughout the array."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1565210130, "post_id": 57401571, "comment_id": 101285481, "body": "Dynamic allocation is not essential to a linked list. The links are."}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1565210703, "post_id": 57401571, "comment_id": 101285684, "body": "@RemyLebeau yes, if I were going for a general purpose version of this, I&#39;d certainly do that. In our particular case, there&#39;s sensible &quot;empty&quot; values we use, but your suggestion is certainly cleaner."}], "answers": [{"comments": [{"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1565209846, "post_id": 57401623, "comment_id": 101285346, "body": "I was hoping for a better name but I guess there isn&#39;t any"}], "tags": [], "owner": {"reputation": 5848, "user_id": 1075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70efe94a6c2237ec96f429402a03a27d?s=128&d=identicon&r=PG", "display_name": "Renat", "link": "https://stackoverflow.com/users/1075282/renat"}, "is_accepted": false, "score": 4, "last_activity_date": 1565208356, "creation_date": 1565208356, "answer_id": 57401623, "question_id": 57401571, "link": "https://stackoverflow.com/questions/57401571/name-of-this-data-structure/57401623#57401623", "title": "Name of this Data Structure?", "body": "<p>It is linked list. It's mentioned on Wikipedia as <a href=\"https://en.wikipedia.org/wiki/Linked_list#Linked_lists_using_arrays_of_nodes\" rel=\"nofollow noreferrer\">\"Linked list using arrays of nodes\"</a></p>\n"}, {"tags": [], "owner": {"reputation": 5867, "user_id": 9125195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75fc90d1f6de6ff28c739b85bdb82f4c?s=128&d=identicon&r=PG&f=1", "display_name": "Sid S", "link": "https://stackoverflow.com/users/9125195/sid-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1565209372, "creation_date": 1565209372, "answer_id": 57401829, "question_id": 57401571, "link": "https://stackoverflow.com/questions/57401571/name-of-this-data-structure/57401829#57401829", "title": "Name of this Data Structure?", "body": "<p>It's a double-linked linked list, implemented with a C-style array.</p>\n"}], "owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565209372, "creation_date": 1565208063, "question_id": 57401571, "link": "https://stackoverflow.com/questions/57401571/name-of-this-data-structure", "title": "Name of this Data Structure?", "body": "<p>So I recently came across a data structure roughly like this:</p>\n\n<pre><code>template&lt;class T&gt;\nstruct Node {\n    size_t m_next;\n    size_t m_prev;\n    T m_key;\n}\n\ntemplate&lt;class T, size_t N&gt;\nstruct DS {\n    Node&lt;T&gt; m_elements[N];\n    size_t m_head;\n    size_t m_tail;\n}\n\n</code></pre>\n\n<p>I simplified a bit, just to keep this brief: I don't do error handling when <code>DS</code> gets too full. Normally <code>N</code> is large enough that this isn't a concern. </p>\n\n<p>One note is <code>T</code> must have some way of representing \"no value\"; why this is needed can be seen below. (I'll refer to this value as <code>TOMBSTONE</code> below.)</p>\n\n<p>The API for this data structure is roughly the same as for a linked list, but it performs much better because everything fits nicely in the cache.</p>\n\n<p>The actual implementation is different from a linked list in that it doesn't need to allocate any new memory for new nodes. For example, pushing to the back of <code>DS</code> is roughly like this:</p>\n\n<pre><code>void DS::push_back(T t) {\n    size_t attempt = 0;\n    size_t i = hash(t, attempt++);\n    while (true) {\n        if (m_elements[i] == TOMBSTONE) {\n            m_elements[m_tail].m_next = i;\n            m_elements[i] = Node(N, m_tail, t);\n            m_tail = i;\n            break;\n        }\n        i = hash(t, attempt++);\n    }\n}\n</code></pre>\n\n<p>where <code>hash(T t, size_t attempt)</code> finds places to try to insert new elements. (This is so there's nice spread, rather than clumping everything at the start.)</p>\n\n<p>I hesitate to call this a linked list because of the vast performance and implementation differences from a normal linked list. I also want to point out that this question is not about <em>when</em> to use what data-structures, or if the above data-structure is good/fast/safe/whatever. This data-structure works quite well for us in the very specific situation we use it in.</p>\n\n<p>Is there any name for this particular implementation/data-structure?</p>\n"}, {"tags": ["c++", "cmake", "icc"], "comments": [{"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1565209226, "post_id": 57401493, "comment_id": 101285101, "body": "Does <a href=\"https://software.intel.com/en-us/articles/unresolved-external-symbol-_intel_sse2_strlen\" rel=\"nofollow noreferrer\">this</a> help?"}, {"owner": {"reputation": 319, "user_id": 2987773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c1274ca382555b43ed009b6de70b9be?s=128&d=identicon&r=PG&f=1", "display_name": "user2987773", "link": "https://stackoverflow.com/users/2987773/user2987773"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1565209744, "post_id": 57401493, "comment_id": 101285299, "body": "@PaulSanders No luck with that."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1565209830, "post_id": 57401493, "comment_id": 101285338, "body": "So you are linking against the relevant library?  Strange."}, {"owner": {"reputation": 319, "user_id": 2987773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c1274ca382555b43ed009b6de70b9be?s=128&d=identicon&r=PG&f=1", "display_name": "user2987773", "link": "https://stackoverflow.com/users/2987773/user2987773"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1565210380, "post_id": 57401493, "comment_id": 101285580, "body": "Which ones are the relevant ones?"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1565210650, "post_id": 57401493, "comment_id": 101285665, "body": "According to the article, libirc.lib."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1565224672, "post_id": 57401493, "comment_id": 101289088, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 319, "user_id": 2987773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c1274ca382555b43ed009b6de70b9be?s=128&d=identicon&r=PG&f=1", "display_name": "user2987773", "link": "https://stackoverflow.com/users/2987773/user2987773"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1565372403, "post_id": 57401493, "comment_id": 101347440, "body": "@PaulSanders I just noticed that the libirc.a library does not reside in the usual directory where libraries are installed; so I linked it using an absolute path in my CMakeLists.txt and it works now."}], "owner": {"reputation": 319, "user_id": 2987773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c1274ca382555b43ed009b6de70b9be?s=128&d=identicon&r=PG&f=1", "display_name": "user2987773", "link": "https://stackoverflow.com/users/2987773/user2987773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 881, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565207728, "creation_date": 1565207728, "question_id": 57401493, "link": "https://stackoverflow.com/questions/57401493/undefined-reference-to-intel-fast-memcpy-intel-fast-memmove", "title": "Undefined Reference to _intel_fast_memcpy _intel_fast_memmove", "body": "<p>I am compiled a library using intel c++ compiler. But now when I use in a program, I get the following errors. (This may be a duplicate question).</p>\n\n<pre><code>/usr/local/lib/libGE.a(Genotype.o): In function `std::char_traits&lt;char&gt;::length(char const*)':\n/usr/include/c++/7.4.0/bits/char_traits.h:320: undefined reference to `__intel_sse2_strlen'\n/usr/local/lib/libGE.a(Genotype.o): In function `int* std::__copy_move&lt;true, true, std::random_access_iterator_tag&gt;::__copy_m&lt;int&gt;(int const*, int const*, int*)':\n/usr/include/c++/7.4.0/bits/stl_algobase.h:368: undefined reference to `_intel_fast_memmove'\n/usr/include/c++/7.4.0/bits/stl_algobase.h:368: undefined reference to `_intel_fast_memmove'\n/usr/include/c++/7.4.0/bits/stl_algobase.h:368: undefined reference to `_intel_fast_memmove'\n/usr/include/c++/7.4.0/bits/stl_algobase.h:368: undefined reference to `_intel_fast_memmove'\n/usr/local/lib/libGE.a(Genotype.o): In function `int* std::__copy_move&lt;false, true, std::random_access_iterator_tag&gt;::__copy_m&lt;int&gt;(int const*, int const*, int*)':\n/usr/include/c++/7.4.0/bits/stl_algobase.h:368: undefined reference to `_intel_fast_memmove'\n/usr/local/lib/libGE.a(Phenotype.o):/usr/include/c++/7.4.0/bits/stl_algobase.h:368: more undefined references to `_intel_fast_memmove' follow\n/usr/local/lib/libGE.a(CFGrammar.o): In function `std::char_traits&lt;char&gt;::copy(char*, char const*, unsigned long)':\n/usr/include/c++/7.4.0/bits/char_traits.h:350: undefined reference to `_intel_fast_memcpy'\n/usr/include/c++/7.4.0/bits/char_traits.h:350: undefined reference to `_intel_fast_memcpy'\n/usr/include/c++/7.4.0/bits/char_traits.h:350: undefined reference to `_intel_fast_memcpy'\n/usr/include/c++/7.4.0/bits/char_traits.h:350: undefined reference to `_intel_fast_memcpy'\n/usr/local/lib/libGE.a(CFGrammar.o): In function `std::char_traits&lt;char&gt;::length(char const*)':\n</code></pre>\n"}, {"tags": ["c++", "cuda", "nvidia", "gpgpu"], "answers": [{"comments": [{"owner": {"reputation": 1088, "user_id": 2343779, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/029cf86907c4176eaaa833dda677a134?s=128&d=identicon&r=PG", "display_name": "stix", "link": "https://stackoverflow.com/users/2343779/stix"}, "edited": false, "score": 0, "creation_date": 1565209474, "post_id": 57401826, "comment_id": 101285195, "body": "So then your answer is, in general, &quot;yes&quot; to whether or not I should mirror the data?"}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "reply_to_user": {"reputation": 1088, "user_id": 2343779, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/029cf86907c4176eaaa833dda677a134?s=128&d=identicon&r=PG", "display_name": "stix", "link": "https://stackoverflow.com/users/2343779/stix"}, "edited": false, "score": 2, "creation_date": 1565209560, "post_id": 57401826, "comment_id": 101285237, "body": "For best performance, I would mirror the data (provide buffers in each GPU&#39;s own memory).  Is it mandatory to mirror the data if you have P2P enabled?  Generally no, not mandatory."}], "tags": [], "owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "is_accepted": false, "score": 2, "last_activity_date": 1565209729, "last_edit_date": 1565209729, "creation_date": 1565209341, "answer_id": 57401826, "question_id": 57401490, "link": "https://stackoverflow.com/questions/57401490/do-i-need-to-mirror-input-buffers-textures-across-multiple-gpus-in-cuda/57401826#57401826", "title": "Do I need to mirror input buffers/textures across multiple GPUs in CUDA?", "body": "<p><a href=\"http://on-demand.gputechconf.com/gtc/2013/presentations/S3072-Mixing-Graphics-Compute-Multi-GPU.pdf\" rel=\"nofollow noreferrer\">Texturing</a>, as well as ordinary global data access, is possible \"remotely\", if you have enabled peer access.  Since such access occurs over NVLink (or the peer-capable fabric), it will generally be slower.</p>\n\n<p>For \"smallish\" input buffers, it may be that the GPU caching mechanisms tend to reduce or mitigate the penalty associated with remote access. The GPU has specific read-only caches that are designed to help with read-only/input data, and of course the texturing mechanism has its own cache. Detailed performance statements are not possible unless actual analysis is done with actual code.</p>\n"}, {"comments": [{"owner": {"reputation": 1088, "user_id": 2343779, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/029cf86907c4176eaaa833dda677a134?s=128&d=identicon&r=PG", "display_name": "stix", "link": "https://stackoverflow.com/users/2343779/stix"}, "edited": false, "score": 0, "creation_date": 1565286755, "post_id": 57402983, "comment_id": 101316025, "body": "Unified memory simply means the memory space is unified from a code point of view. It doesn&#39;t mean that it&#39;s efficient to access memory space on another card. I&#39;ve verified that the hard way..."}], "tags": [], "owner": {"reputation": 2926, "user_id": 514025, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f1bbef1a5883ccabdd682ccec2e736c?s=128&d=identicon&r=PG", "display_name": "Bill Yan", "link": "https://stackoverflow.com/users/514025/bill-yan"}, "is_accepted": false, "score": -1, "last_activity_date": 1565216707, "creation_date": 1565216707, "answer_id": 57402983, "question_id": 57401490, "link": "https://stackoverflow.com/questions/57401490/do-i-need-to-mirror-input-buffers-textures-across-multiple-gpus-in-cuda/57402983#57402983", "title": "Do I need to mirror input buffers/textures across multiple GPUs in CUDA?", "body": "<p>If you use > Pascal level gpu, they have unified memory. you don't need data migration.</p>\n\n<blockquote>\n  <p>When code running on a CPU or GPU accesses data allocated this way (often called CUDA managed data), the CUDA system software and/or the hardware takes care of migrating memory pages to the memory of the accessing processor. </p>\n</blockquote>\n\n<p><a href=\"https://devblogs.nvidia.com/unified-memory-cuda-beginners/\" rel=\"nofollow noreferrer\">https://devblogs.nvidia.com/unified-memory-cuda-beginners/</a></p>\n\n<p>if you use the old school way to allocation buffer (cuMalloc), you do need to mirror data I think.</p>\n"}], "owner": {"reputation": 1088, "user_id": 2343779, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/029cf86907c4176eaaa833dda677a134?s=128&d=identicon&r=PG", "display_name": "stix", "link": "https://stackoverflow.com/users/2343779/stix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1565216707, "creation_date": 1565207721, "last_edit_date": 1565213580, "question_id": 57401490, "link": "https://stackoverflow.com/questions/57401490/do-i-need-to-mirror-input-buffers-textures-across-multiple-gpus-in-cuda", "title": "Do I need to mirror input buffers/textures across multiple GPUs in CUDA?", "body": "<p><strong>TL;DR: Do I need to mirror read-only lookup textures and input buffers across multiple devices when doing Multi-GPU programming with CUDA (whether it is a strict requirement or for best performance)?</strong></p>\n\n<p>I have a GPU kernel which takes in two textures for lookups and two (smallish) buffers for input data. </p>\n\n<p>I've expanded my code to allow for multiple GPUs (our system will have a max of 8, but for testing I'm on a smaller dev system using only 2). Our system uses NVLINK and we have UVA enabled. </p>\n\n<p>My setup involves making device 0 a sort of \"master\" or \"root\" device where the final result is stored and the final serial (serial as in only executable on one GPU) operations occur. All devices are set up to allow peer access to dev 0. The kernel is invoked multiple times on each device in a loop of the form:</p>\n\n<pre><code>for(unsigned int f = 0; f &lt; maxIterations; f++)\n{\n    unsigned int devNum = f % maxDevices; //maxIterations &gt;&gt; maxDevices\n    cudaSetDevice(devNum);\n    cudaDeviceSynchronize(); //Is this really needed?\n    executeKernel&lt;&lt;&lt;&gt;&gt;&gt;(workBuffers[devNum], luTex1, luTex2, inputBufferA, inputBufferB);\n    cudaMemcpyAsync(&amp;bigGiantBufferOnDev0[f * bufferStride],\n                     workBuffers[devNum],\n                     sizeof(float) * bufferStride,\n                     cudaMemcpyDeviceToDevice);\n}\n</code></pre>\n\n<p>As one can see, each device has its own \"work buffer\" for writing out intermediate results, and these results are then memcpy'd to device 0. </p>\n\n<p>The work (output) buffers are several orders of magnitude larger in size than the input buffers, and I noticed when I'd made a mistake and accessed buffers across devices that there was a major performance hit (presumably because kernels were accessing memory on another device). I haven't however noticed a similar hit with the read only input buffers after fixing the output buffer issue. </p>\n\n<p>Which brings me to my question: Do I actually need to mirror these input buffers and textures across devices, or is there a caching mechanism that makes this unnecessary? Why do I notice such a massive performance hit when accessing the work buffers across devices, but seemingly incur no such penalty with the inputs buffers/textures?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 4756, "user_id": 10001688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kvhzK.jpg?s=128&g=1", "display_name": "Michael Bianconi", "link": "https://stackoverflow.com/users/10001688/michael-bianconi"}, "edited": false, "score": 0, "creation_date": 1565207032, "post_id": 57401322, "comment_id": 101284244, "body": "You&#39;re going to need to make a copy of that array."}, {"owner": {"reputation": 4756, "user_id": 10001688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kvhzK.jpg?s=128&g=1", "display_name": "Michael Bianconi", "link": "https://stackoverflow.com/users/10001688/michael-bianconi"}, "edited": false, "score": 2, "creation_date": 1565207086, "post_id": 57401322, "comment_id": 101284270, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7454990/why-cant-we-pass-arrays-to-function-by-value\">Why can&#39;t we pass arrays to function by value?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "reply_to_user": {"reputation": 4756, "user_id": 10001688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kvhzK.jpg?s=128&g=1", "display_name": "Michael Bianconi", "link": "https://stackoverflow.com/users/10001688/michael-bianconi"}, "edited": false, "score": 0, "creation_date": 1565207103, "post_id": 57401322, "comment_id": 101284278, "body": "@MichaelBianconi Is that really the only way? I did it in my original code but I really want to know if there&#39;s a way to do that in the same one"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1565207119, "post_id": 57401322, "comment_id": 101284284, "body": "Ditch the raw arrays and switch to using <a href=\"https://en.cppreference.com/w/cpp/container/array\" rel=\"nofollow noreferrer\"><code>std::array</code></a>.  That will behave like a normal object and make a copy when passed by value."}, {"owner": {"reputation": 846, "user_id": 7511460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cz0P7.png?s=128&g=1", "display_name": "Adrien Givry", "link": "https://stackoverflow.com/users/7511460/adrien-givry"}, "edited": false, "score": 0, "creation_date": 1565207160, "post_id": 57401322, "comment_id": 101284308, "body": "<code>int arr[5][6]</code> in your function parameters is equivalent to <code>int** arr</code>. What your function receive is just a pointer to a memory location containing an integer (The first element of your array). What will happen is that <code>num1</code> will modify the content of your array, so <code>num2</code> return value will be affected."}, {"owner": {"reputation": 5719, "user_id": 5348875, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e050e66d97a3f54b0453533428088e6c?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5348875/daniel"}, "edited": false, "score": 0, "creation_date": 1565207303, "post_id": 57401322, "comment_id": 101284368, "body": "have you considered using <code>std::vector</code>?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 846, "user_id": 7511460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cz0P7.png?s=128&g=1", "display_name": "Adrien Givry", "link": "https://stackoverflow.com/users/7511460/adrien-givry"}, "edited": false, "score": 2, "creation_date": 1565207349, "post_id": 57401322, "comment_id": 101284382, "body": "@AdrienGivry No, it&#39;s not <code>int **arr</code>. Only the top-level array decays, which makes it <code>int (*arr)[6]</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "reply_to_user": {"reputation": 5719, "user_id": 5348875, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e050e66d97a3f54b0453533428088e6c?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5348875/daniel"}, "edited": false, "score": 0, "creation_date": 1565207375, "post_id": 57401322, "comment_id": 101284392, "body": "@Daniel No, I didn&#39;t learn about vectors yet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565207414, "post_id": 57401322, "comment_id": 101284407, "body": "@NathanOliver I don&#39;t understand. Can you please explain more?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "reply_to_user": {"reputation": 846, "user_id": 7511460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cz0P7.png?s=128&g=1", "display_name": "Adrien Givry", "link": "https://stackoverflow.com/users/7511460/adrien-givry"}, "edited": false, "score": 0, "creation_date": 1565207445, "post_id": 57401322, "comment_id": 101284422, "body": "@AdrienGivry Yeah, I know what happends. Thanks anyway."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565207717, "post_id": 57401322, "comment_id": 101284526, "body": "<i><code>int arr[5][6]</code> in your function parameters is equivalent to <code>int** arr</code></i> is troublesome and leads to many bad assumptions that will make you suffer."}, {"owner": {"reputation": 5719, "user_id": 5348875, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e050e66d97a3f54b0453533428088e6c?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5348875/daniel"}, "edited": false, "score": 0, "creation_date": 1565207790, "post_id": 57401322, "comment_id": 101284549, "body": "@R4Z7 vectors are arrays with dynamic size (that means, not constant size). When you pass a vector as an argument to a function, the compiler creates a copy of it, so the original variable doesn&#39;t change it&#39;s value when you modify its copy inside a function. Take a quick look <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">here</a>, this might solve your problem."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 846, "user_id": 7511460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cz0P7.png?s=128&g=1", "display_name": "Adrien Givry", "link": "https://stackoverflow.com/users/7511460/adrien-givry"}, "edited": false, "score": 0, "creation_date": 1565207889, "post_id": 57401322, "comment_id": 101284597, "body": "@AdrienGivry <code>int arr[5][6] in your function parameters is equivalent to int** arr</code> -- Please no.  If it were equivalent, the C++ compiler would never complain if you tried to assign one to the other."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1565208594, "post_id": 57401322, "comment_id": 101284839, "body": "@R4Z7 -- <a href=\"https://stackoverflow.com/questions/27410943/returning-arrays-from-a-function-in-c/27411483#27411483\">See this answer</a>.  Basically very easy -- just wrap a struct around your array, and instantly you have an &quot;array&quot; that&#39;s copyable, assignable, can pass it to functions and return it by value, etc.  All you need is to use an extra <code>.</code> syntax to access the array."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "edited": false, "score": 0, "creation_date": 1565207338, "post_id": 57401368, "comment_id": 101284376, "body": "Alright! so all I need to do it to create a 2D array in the function and then sa that the 2D array = arr every time and then at the end of the function do mutation to the value I created? But then, what do I call in the main function? arr or arrLoc"}, {"owner": {"reputation": 86, "user_id": 5861893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2e6800d176600dbe655e749368dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "dpuleri", "link": "https://stackoverflow.com/users/5861893/dpuleri"}, "edited": false, "score": 0, "creation_date": 1565207417, "post_id": 57401368, "comment_id": 101284411, "body": "<code>arrLoc</code> won&#39;t be available in the main function as its scope is limited to the <code>num1()</code> function. If you would like to mutate the original array then your implementation in the correction would be fine. Are you asking how to pass the array to the <code>num1()</code> function? You wouldn&#39;t need to change what you&#39;re doing because <code>arr</code> will automatically be a const pointer in the function and the new array is local only."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "edited": false, "score": 0, "creation_date": 1565207487, "post_id": 57401368, "comment_id": 101284439, "body": "But it&#39;ll act like arr in the function?"}, {"owner": {"reputation": 86, "user_id": 5861893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2e6800d176600dbe655e749368dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "dpuleri", "link": "https://stackoverflow.com/users/5861893/dpuleri"}, "edited": false, "score": 0, "creation_date": 1565207571, "post_id": 57401368, "comment_id": 101284469, "body": "Yes since you named the parameter <code>arr</code>. You could name it <code>pointer2Arr</code> and it would also act like a <code>const</code> pointer to the original <code>arr</code> in your main function."}, {"owner": {"reputation": 86, "user_id": 5861893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2e6800d176600dbe655e749368dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "dpuleri", "link": "https://stackoverflow.com/users/5861893/dpuleri"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1565286309, "post_id": 57401368, "comment_id": 101315832, "body": "@Jarod42, you&#39;re right. I didn&#39;t proofread the code fully."}], "tags": [], "owner": {"reputation": 86, "user_id": 5861893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2e6800d176600dbe655e749368dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "dpuleri", "link": "https://stackoverflow.com/users/5861893/dpuleri"}, "is_accepted": false, "score": 1, "last_activity_date": 1565286345, "last_edit_date": 1565286345, "creation_date": 1565207157, "answer_id": 57401368, "question_id": 57401322, "link": "https://stackoverflow.com/questions/57401322/is-there-a-way-to-create-a-function-that-doesnt-change-the-arrgument-in-the-pro/57401368#57401368", "title": "Is there a way to create a function that doesn&#39;t change the arrgument in the program", "body": "<p>Since you are essentially passing a pointer to the 2D array to the function there is no way to modify the parameter <code>arr</code> without modifying the array <code>arr</code> in your main function.</p>\n\n<p>A possible solution would be to pass <code>arr</code> as <code>const</code> and then copy it to a temporary array for modification.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int num1(const int arr[5][6],int count){\n    int arrLoc[5][6];\n    for (int i = 0; i &lt; 5; i++) {\n        for (int j = 0; j &lt; 6; j++) {\n            arrLoc[i][j] = arr[i][j];\n            if (arrLoc[i][j] == 1) {\n                count++;\n                arrLoc[i][j] = 0;\n            }\n        }\n    }\n    // mutate local copy while leaving `arr` unmodified\n    mutation(arrLoc);\n    return count;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "edited": false, "score": 0, "creation_date": 1565208544, "post_id": 57401480, "comment_id": 101284821, "body": "No, It only takes a single array it gives me an error when I am trying to do 2D array."}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 0, "creation_date": 1565208700, "post_id": 57401480, "comment_id": 101284890, "body": "@R427 I&#39;ve fixed the syntax.  Sorry about that!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "edited": false, "score": 0, "creation_date": 1565208862, "post_id": 57401480, "comment_id": 101284956, "body": "all good but why do I need 2 {{ that&#39;s just how the syntax works? and how do I call them so they&#39;ll print the return value?"}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 0, "creation_date": 1565208971, "post_id": 57401480, "comment_id": 101284998, "body": "@R4Z7 <a href=\"https://stackoverflow.com/questions/11734861/when-can-outer-braces-be-omitted-in-an-initializer-list\">Here&#39;s a more thorough explanation than I could ever give</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "edited": false, "score": 0, "creation_date": 1565209115, "post_id": 57401480, "comment_id": 101285057, "body": "Ok, but how do I print the value to the screen? That&#39;s the last qustion I just need to mark you as the answer I just need to see if both of them print 1"}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 0, "creation_date": 1565209561, "post_id": 57401480, "comment_id": 101285238, "body": "@R4Z7 C++ doesn&#39;t have built-in printing of collections :\\  So you&#39;d need loops like <code>for(auto&amp;&amp; row : arr){ for(int elem : row){ std::cout &lt;&lt; elem &lt;&lt; &#39;\\t&#39;; } std::cout &lt;&lt; std::endl; }</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "edited": false, "score": 0, "creation_date": 1565210872, "post_id": 57401480, "comment_id": 101285753, "body": "I want to print the return of the functions, not the 2d array"}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 0, "creation_date": 1565211046, "post_id": 57401480, "comment_id": 101285804, "body": "@R4Z7 Oh, well you would do that the same way you were already doing it in your question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "edited": false, "score": 0, "creation_date": 1565211072, "post_id": 57401480, "comment_id": 101285814, "body": "That doesn&#39;t work this is the error: <a href=\"https://docs.microsoft.com/en-us/cpp/error-messages/tool-errors/linker-tools-error-lnk2019?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev15.query%3FappId%3DDev15IDEF1%26l%3DEN-US%26k%3Dk(LNK2019)%26rd%3Dtrue&amp;view=vs-2019\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/cpp/error-messages/tool-errors/&hellip;</a>  it&#39;s an error with LNK2019"}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 0, "creation_date": 1565211258, "post_id": 57401480, "comment_id": 101285888, "body": "@R4Z7 You need to make sure that the type signatures match between both your forward declaration and your function definition."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "edited": false, "score": 0, "creation_date": 1565211375, "post_id": 57401480, "comment_id": 101285930, "body": "I am calling it as an int arrgument in the funtion. how do I need to call it?"}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 0, "creation_date": 1565212228, "post_id": 57401480, "comment_id": 101286172, "body": "You call it the same way, but you need to make sure that both lines which start with <code>int num*</code> (where * is either 1 or 2) go on to say <code>(arr_6_5 arr, int count)</code>.  If you&#39;re getting a linker error, that probably means that in your function definition, you still have <code>int arr[5][6]</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "edited": false, "score": 0, "creation_date": 1565213526, "post_id": 57401480, "comment_id": 101286599, "body": "I know that, but what do I need to change the int arr[5][6] to?"}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 1, "creation_date": 1565213862, "post_id": 57401480, "comment_id": 101286706, "body": "@R4Z7 <code>std::array&lt;std::array&lt;int, 6&gt;, 5&gt; arr</code>, or just <code>arr_6_5 arr</code> (assuming you have the relevant <code>using</code> statement)."}], "tags": [], "owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "is_accepted": true, "score": 5, "last_activity_date": 1565208631, "last_edit_date": 1565208631, "creation_date": 1565207654, "answer_id": 57401480, "question_id": 57401322, "link": "https://stackoverflow.com/questions/57401322/is-there-a-way-to-create-a-function-that-doesnt-change-the-arrgument-in-the-pro/57401480#57401480", "title": "Is there a way to create a function that doesn&#39;t change the arrgument in the program", "body": "<p>C arrays don't support proper value semantics in the way that most other things in C++ (or in C) do.  An alternative which does work as one might expect is <code>std::array</code>.  To get your 6 wide by 5 tall array, the type is <code>std::array&lt;std::array&lt;int, 6&gt;, 5&gt;</code>.  Since that's a little verbose, you might want a <code>using</code> statement, e.g.</p>\n\n<pre><code>using arr_6_5 = std::array&lt;std::array&lt;int, 6&gt;, 5&gt;;\n</code></pre>\n\n<p>EDIT: Unfortunately, declaring such an array is a little annoying.  You actually need two layers of curly braces per array: one for the the wrapping <code>std::array</code>, and one for the C-style array that it wraps (these layers of indirection are eliminated during compilation, however). </p>\n\n<pre><code>const arr_6_5 arr = {{\n  {{0, 0, 0, 1, 0, 0}} ,   \n  {{0, 0, 0, 0, 0, 0}} ,   \n  {{0, 0, 0, 0, 0, 0}} ,\n  {{0, 0, 0, 0, 0, 0}} ,\n  {{0, 0, 0, 0, 0, 0}}\n}};\n</code></pre>\n\n<p>And you would change the type signature of <code>num1</code> and <code>num2</code> to</p>\n\n<pre><code>int num1(arr_6_5 arr, int count);\nint num2(arr_6_5 arr, int count);\n</code></pre>\n\n<p>If you <em>do</em> want to edit the original array, then it's <code>arr_6_5 &amp; arr</code>, and if you want to read the original and not make a copy then it's <code>arr_6_5 const&amp; arr</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11336869"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1565611957, "accepted_answer_id": 57401480, "answer_count": 2, "score": 1, "last_activity_date": 1565286345, "creation_date": 1565206893, "question_id": 57401322, "link": "https://stackoverflow.com/questions/57401322/is-there-a-way-to-create-a-function-that-doesnt-change-the-arrgument-in-the-pro", "closed_reason": "Needs details or clarity", "title": "Is there a way to create a function that doesn&#39;t change the arrgument in the program", "body": "<p>I created a code.I want to use the same varible in 2 functions, but I don't want the funtion to change the value to the other function. To make my self more clear here is an example:</p>\n\n<pre><code>int num1(int arr[5][6],int count);\nint num2(int arr[5][6],int count2);\n   int main()\n   {\n       int count = 0;\n    int count2 = 0;\n    int arr[5][6] = {\n   {0, 0, 0, 1, 0, 0} ,   \n   {0, 0, 0, 0, 0, 0} ,   \n   {0, 0, 0, 0, 0, 0} ,\n   {0, 0, 0, 0, 0, 0} ,\n   {0, 0, 0, 0, 0, 0}\n    };\n    cout &lt;&lt; num1(arr,count);\n    cout &lt;&lt; num2(arr,count2);\n    return 0;\n    }\nint num1(int arr[5][6],int count){\n    for (int i = 0; i &lt; 5; i++) {\n        for (int j = 0; j &lt; 6; j++) {\n            if(arr[i][j] == 1){\n            count++;\n            arr[i][j] = 0;\n            }\n        }\n    }\n    return count;\n}\nint num2(int arr[5][6],int count2){\n    for (int i = 0; i &lt; 5; i++) {\n        for (int j = 0; j &lt; 6; j++) {\n            if(arr[i][j] == 1){\n             count2++;\n            arr[i][j] = 0;\n            }\n\n        }\n    }\n    return count2;\n}\n</code></pre>\n\n<p>This code will print <a href=\"http://prntscr.com/oppxki\" rel=\"nofollow noreferrer\">1 and 0</a> because num1 changes the only '1' in arr to '0' and because of that num2 will get an array which all of the places have  0. what I want is for BOTH of the functions to print 1 so the output will be <code>\"11\"</code> insted of <code>10</code>. And no, without making a new array I really want to know if there's a way to do it with a single array</p>\n"}, {"tags": ["python", "c++", "cython"], "comments": [{"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1565208965, "post_id": 57401078, "comment_id": 101284991, "body": "I&#39;m surprised there is such a thing as <code>b&#39;\u043f\u0440\u0438\u0432\u0435\u0442&#39;</code>, I thought bytes would contain only ASCII literal characters...."}, {"owner": {"reputation": 1, "user_id": 11898078, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8GkWN_FBn7w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcKB4Ol-Nabd06eVVGP7-b96i1yqQ/photo.jpg?sz=128", "display_name": "Rodion", "link": "https://stackoverflow.com/users/11898078/rodion"}, "reply_to_user": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1565245587, "post_id": 57401078, "comment_id": 101293611, "body": "Exactly, &#39;\u043f\u0440\u0438\u0432\u0435\u0442&#39; is not ascii and function can&#39;t take it, but i need to."}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1565246469, "post_id": 57401078, "comment_id": 101294016, "body": "When I type <code>a=b&#39;\u043f\u0440\u0438\u0432\u0435\u0442&#39;</code> in my Python-interpreter I get an error, because bytes can contain only ASCII literals (Python3.7), I&#39;m not sure which Python version you are using, that it works for you (<code>u&#39;\u043f\u0440\u0438\u0432\u0435\u0442&#39;</code> would work, but it is not what your are doing)."}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1565246519, "post_id": 57401078, "comment_id": 101294044, "body": "Maybe you should add, that you still using Python2, which by now is no longer &quot;default&quot;."}, {"owner": {"reputation": 1, "user_id": 11898078, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8GkWN_FBn7w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcKB4Ol-Nabd06eVVGP7-b96i1yqQ/photo.jpg?sz=128", "display_name": "Rodion", "link": "https://stackoverflow.com/users/11898078/rodion"}, "reply_to_user": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1565253213, "post_id": 57401078, "comment_id": 101297264, "body": "I use python 3.6, and tree.add_word(&#39;hello&#39;) or tree.add_word(&#39;\u043f\u0440\u0438\u0432\u0435\u0442&#39;), tree.add_word(u&#39;\u043f\u0440\u0438\u0432\u0435\u0442&#39;) return the same error."}], "answers": [{"tags": [], "owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "is_accepted": false, "score": 3, "last_activity_date": 1565258026, "last_edit_date": 1565258026, "creation_date": 1565257158, "answer_id": 57409583, "question_id": 57401078, "link": "https://stackoverflow.com/questions/57401078/how-to-use-unicode-strings-in-python-wrapping-for-c-class-with-cython/57409583#57409583", "title": "How to use unicode strings in python wrapping for c++ class with cython?", "body": "<p>C++ strings are internally a <code>char</code> array, so really operate on a \"bytes\" level rather than a unicode level. Therefore Cython doesn't automatically support a <code>unicode/str</code> &lt;-> <code>std::string</code> conversion. However, you have two fairly simple options:</p>\n\n<ol>\n<li><p>Use the <code>unicode/str.encode</code> function to get a bytes representation of the unicode object:</p>\n\n<pre><code>def add_word(self, word):\n    if isinstance(word,str): # Python3 version - use unicode for Python 2\n        word = word.encode()\n    return self.c_tree.add_word(word) \n</code></pre>\n\n<p>The main thing you have to be careful of is that the encoding that C++ uses to interpret it is the same as Python uses to encode it (Python uses utf8 by default).</p></li>\n<li><p>Convert to the C++ type <code>std::wstring</code> - internally an array of <code>wchar_t</code>. Unfortunately Cython doesn't wrap <code>wstring</code> by default or provide automatic conversions, and therefore you'll need to write your own wrapper. Use the <a href=\"https://github.com/cython/cython/blob/master/Cython/Includes/libcpp/string.pxd\" rel=\"nofollow noreferrer\">Cython wrapping of <code>std::string</code></a> as a reference - you may well only need to wrap the constructors anyway. I've used <a href=\"https://docs.python.org/3/c-api/unicode.html#c.PyUnicode_AsWideChar\" rel=\"nofollow noreferrer\">the Python C API</a> for the conversion to a <code>wchar_t*</code>.</p>\n\n<pre><code>from libc.stddef cimport wchar_t\n\ncdef extern from \"&lt;string&gt;\" namespace std:\n    cdef cppclass wstring:\n        wstring() except +\n        wstring(size_t, wchar_t) except +\n\n        const wchar_T* data()\n\ncdef extern from \"Python.h\":\n     # again, not wrapped by cython a s adefault\n     Py_ssize_t PyUnicode_AsWideChar(object o, wchar_t *w, Py_ssize_t size) except -1\n\n# conversion function\ncdef wstring to_wstring(s):\n    # create 0-filled output\n    cdef wstring out = wstring(len(s),0)\n    PyUnicode_AsWideChar(s, &lt;wchar_t*&gt;out.data(),len(s)) # note cast to remove const \n     # I'm not convinced this is 100% acceptable according the standard but practically it should work\n    return out\n</code></pre></li>\n</ol>\n\n<p>Which of these options your prefer largely depends on what your C++ accepts for unicode strings.</p>\n"}], "owner": {"reputation": 1, "user_id": 11898078, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8GkWN_FBn7w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcKB4Ol-Nabd06eVVGP7-b96i1yqQ/photo.jpg?sz=128", "display_name": "Rodion", "link": "https://stackoverflow.com/users/11898078/rodion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565258026, "creation_date": 1565205802, "last_edit_date": 1565253323, "question_id": 57401078, "link": "https://stackoverflow.com/questions/57401078/how-to-use-unicode-strings-in-python-wrapping-for-c-class-with-cython", "title": "How to use unicode strings in python wrapping for c++ class with cython?", "body": "<p>I am currently working on a pet-project. My goal now is to write a wrapper for c++ class to python with cython. The thing is that i have to work with russian text (unicode), but cython wrapping takes only bytes, despite of c++ class method, that are capable of process unicode string properly. I read Cython documentation and tried to find it in google, but found nothing.</p>\n\n<p>How can i change my code, so my python wrapper could take unicode strings?</p>\n\n<p>Here is a link to my github repo with the current code files\n<a href=\"https://github.com/rproskuryakov/lemmatizer/tree/trie\" rel=\"nofollow noreferrer\">https://github.com/rproskuryakov/lemmatizer/tree/trie</a></p>\n\n<p>\"trie.pxd\"</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from libcpp.string cimport string\nfrom libcpp cimport bool\n\ncdef extern from \"Trie.cpp\":\n    pass\n\n# Declare the class with cdef\ncdef extern from \"Trie.h\": \n    cdef cppclass Trie:\n        Trie() except +\n        void add_word(string word)  # function that should take unicode\n        bool find(string word)  # function that should take unicode\n\n</code></pre>\n\n<p>\"pytrie.pyx\"</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from trie cimport Trie  # link to according .pxd file\n\n# Create a Cython extension type which holds a C++ instance\n# as an attribute and create a bunch of forwarding methods\n# Python extension type.\ncdef class PyTrie:\n    cdef Trie c_tree # Hold a C++ instance which we're wrapping\n\n    def __cinit__(self):\n        self.c_tree = Trie()\n\n    def add_word(self, word): \n        return self.c_tree.add_word(word) \n\n    def find(self, word): \n        return self.c_tree.find(word)\n</code></pre>\n\n<p>Here is what i get in python.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>&gt;&gt;&gt; tree.add_word(b'hello') # works if i got english into ascii\n&gt;&gt;&gt; tree.add_word(b'\u043f\u0440\u0438\u0432\u0435\u0442') # doesnt work\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"wrapper/pytrie.pyx\", line 13, in pytrie.PyTrie.add_word\n  File \"stringsource\", line 15, in string.from_py.__pyx_convert_string_from_py_std__in_string\nTypeError: expected bytes, str found\n</code></pre>\n"}, {"tags": ["c++", "exception", "binary-search-tree"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 1, "creation_date": 1565205868, "post_id": 57401068, "comment_id": 101283760, "body": "I always find it amusing when question on StackOverflow is about stack overflow."}, {"owner": {"reputation": 15, "user_id": 10752064, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283481844996176/picture?type=large", "display_name": "Christian Dominguez", "link": "https://stackoverflow.com/users/10752064/christian-dominguez"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1565205920, "post_id": 57401068, "comment_id": 101283780, "body": "Haha, that&#39;s exactly what I thought too!"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1565205921, "post_id": 57401068, "comment_id": 101283782, "body": "<code>else if (root)</code> -- You already tested if <code>root</code> is NULL.  No need for the <code>else if (root)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10752064, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283481844996176/picture?type=large", "display_name": "Christian Dominguez", "link": "https://stackoverflow.com/users/10752064/christian-dominguez"}, "edited": false, "score": 0, "creation_date": 1565205984, "post_id": 57401084, "comment_id": 101283807, "body": "Wow, that worked! I can&#39;t believe I missed that! You&#39;re a god send!"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "reply_to_user": {"reputation": 15, "user_id": 10752064, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283481844996176/picture?type=large", "display_name": "Christian Dominguez", "link": "https://stackoverflow.com/users/10752064/christian-dominguez"}, "edited": false, "score": 0, "creation_date": 1565206114, "post_id": 57401084, "comment_id": 101283866, "body": "@ChristianDominguez If this is Visual Studio, when the exception is thrown look at the Stack Frame. That would tell you a lot."}, {"owner": {"reputation": 15, "user_id": 10752064, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283481844996176/picture?type=large", "display_name": "Christian Dominguez", "link": "https://stackoverflow.com/users/10752064/christian-dominguez"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1565206260, "post_id": 57401084, "comment_id": 101283926, "body": "Noted. Thanks for the tip! @drescherjm"}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": true, "score": 2, "last_activity_date": 1565206020, "last_edit_date": 1565206020, "creation_date": 1565205824, "answer_id": 57401084, "question_id": 57401068, "link": "https://stackoverflow.com/questions/57401068/having-an-issue-with-an-exception-stack-overflow-being-thrown-when-using-an-in/57401084#57401084", "title": "Having an issue with an exception (Stack overflow) being thrown when using an In Order traversal member function", "body": "<pre><code>displayInOrder(root);\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>displayInOrder(root-&gt;left);\n</code></pre>\n\n<p>The first version is infinitely recursive because you are calling the same function with the exact same parameters. This leads to stack overflow, as you've found.</p>\n"}], "owner": {"reputation": 15, "user_id": 10752064, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283481844996176/picture?type=large", "display_name": "Christian Dominguez", "link": "https://stackoverflow.com/users/10752064/christian-dominguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 57401084, "answer_count": 1, "score": 0, "last_activity_date": 1565215801, "creation_date": 1565205768, "last_edit_date": 1565215801, "question_id": 57401068, "link": "https://stackoverflow.com/questions/57401068/having-an-issue-with-an-exception-stack-overflow-being-thrown-when-using-an-in", "title": "Having an issue with an exception (Stack overflow) being thrown when using an In Order traversal member function", "body": "<p>I'm trying to test out my recursive In Order traversal function on a Binary Search Tree but I keep getting an exception thrown (Stack Overflow) when I call that particular function to display nodes on the tree. Am I missing a key part of code? </p>\n\n<p>I've tried looking up how to handle the exception elsewhere but nothing has worked so far. I've also changed the function to a <code>const</code> because I wasn't sure if that's what the compiler (Visual Studio 2017) wanted. I have tested the Pre-Order and Post-Order traversal functions and both work as intended. </p>\n\n<p>In-Order traversal function is a private member function of another class and is called by a separate public function that simply passes the <code>root</code> of the tree to <code>displayInOrder</code>. </p>\n\n<pre><code>void displayInOrder(TreeNode *&amp;root) const {\n\n        if (root == NULL) {\n\n            return;\n\n        }\n\n        else if (root) {\n\n            displayInOrder(root);\n            cout &lt;&lt; root-&gt;value &lt;&lt; \" \";\n            displayInOrder(root-&gt;right);\n        }\n    }\n</code></pre>\n\n<blockquote>\n  <p>Exception thrown at 0x00C22FE9 in Binary Tree Application.exe:\n  0xC0000005: Access violation writing location 0x00CA0F60.</p>\n</blockquote>\n"}, {"tags": ["c++", "graphics"], "comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1565206076, "post_id": 57401052, "comment_id": 101283850, "body": "GraphViz can do this sort of thing for you; you can either use its calculations to generate your own graphics, or you can have your program output an ASCII representation of the graph you want to display, and then pass that ASCII representation into the &quot;dot&quot; utility and it will output a bitmap file containing the graph."}, {"owner": {"reputation": 29, "user_id": 10498074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B3WoYulbejw/AAAAAAAAAAI/AAAAAAAAAGo/SoIAl8PUXbg/photo.jpg?sz=128", "display_name": "zukayu", "link": "https://stackoverflow.com/users/10498074/zukayu"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1565397539, "post_id": 57401052, "comment_id": 101354189, "body": "Thanks for the directions, I&#39;ll checki that out."}], "owner": {"reputation": 29, "user_id": 10498074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B3WoYulbejw/AAAAAAAAAAI/AAAAAAAAAGo/SoIAl8PUXbg/photo.jpg?sz=128", "display_name": "zukayu", "link": "https://stackoverflow.com/users/10498074/zukayu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565207362, "creation_date": 1565205696, "last_edit_date": 1565207362, "question_id": 57401052, "link": "https://stackoverflow.com/questions/57401052/how-to-represent-dfs-bfs-graphs-and-trees-using-graphics-in-c", "title": "How to Represent DFS BFS Graphs and Trees using Graphics in C++", "body": "<p>So I want to implement Breadth first Search and Depth First Search in C++ and then also want to show it Graphically. \nLike initially I want to show the graph entered by the User (stored in Adjacency matrix) and then After Traversing via Bfs Or Dfs I want to show one by one the node Processed.</p>\n\n<p>The DFS BFS Codes are Ready but now i want to extend it to graphical representation. \nI want that as the first vertice is processed, A circle inside which vertexName is printed is added on the screen then the next Vertex processed is added and joined to the previous vertex which is already there on the screen and so on the process continues. </p>\n\n<p>Kindly Guide me to make such kind of Graphical Representation in C++</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1565205585, "post_id": 57400925, "comment_id": 101283628, "body": "<a href=\"https://stackoverflow.com/questions/1424510/\">My attempt at value initialization is interpreted as a function declaration, and why doesn&#39;t A a(()); solve it?</a> is a more appropriate duplicate. <a href=\"https://stackoverflow.com/q/27613904/1968\">Why \u201cFoo f(Bar());\u201d can be a declaration of a function that takes type Bar and returns type Foo?</a> that you linked to is marked as a duplicate of it."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1565205769, "post_id": 57400925, "comment_id": 101283710, "body": "@Remy Yes. You\u2019re also right that this isn\u2019t actually an MVP, although it\u2019s so similar that even professionals (exhibit A: yours truly) regularly confuse it. It definitely goes in the same direction as far as expected vs actual behaviour is concerned."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1565205913, "post_id": 57400925, "comment_id": 101283776, "body": "@KonradRudolph I almost rode it off as MVP, too. I had to look up MVP before posting my answer, just to make sure."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1565205608, "post_id": 57400952, "comment_id": 101283643, "body": "Maybe you should mention &quot;Most Vexing Parse&quot; somewhere in the answer as well, for future searches as well as giving OP some keywords to research.."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1565205751, "post_id": 57400952, "comment_id": 101283702, "body": "@JesperJuhl <code>A a();</code> is not actually an example of &quot;most vexing parse&quot;, which is why I didn&#39;t mention it. Though it is commonly confused with &quot;most vexing parse&quot;."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 4, "last_activity_date": 1565205248, "creation_date": 1565205248, "answer_id": 57400952, "question_id": 57400925, "link": "https://stackoverflow.com/questions/57400925/classname-classobject-does-not-invoke-any-constructor/57400952#57400952", "title": "classname classobject(); does not invoke any constructor", "body": "<p>If something looks like a function declaration, the C++ standard requires it be treated as a function declaration.</p>\n\n<p><code>A a();</code> does not default-construct an object <code>a</code> of type <code>A</code>.  It declares a function <code>a</code> that takes no input parameters and returns an <code>A</code> object as output.</p>\n\n<p>To default-construct a variable <code>a</code>, you need to drop the parenthesis:</p>\n\n<p><code>A a;</code></p>\n\n<p>Or, in C++11 and later, you can use curly braces instead of parenthesis:</p>\n\n<p><code>A a{};</code></p>\n"}], "owner": {"reputation": 473, "user_id": 8355696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0e39f22e8c126be22a6db9c08fb67a?s=128&d=identicon&r=PG&f=1", "display_name": "Pranjal Kaler", "link": "https://stackoverflow.com/users/8355696/pranjal-kaler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1565205645, "accepted_answer_id": 57400952, "answer_count": 1, "score": -2, "last_activity_date": 1565209458, "creation_date": 1565205129, "last_edit_date": 1565209458, "question_id": 57400925, "link": "https://stackoverflow.com/questions/57400925/classname-classobject-does-not-invoke-any-constructor", "closed_reason": "Duplicate", "title": "classname classobject(); does not invoke any constructor", "body": "<p>If I have a following situation:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nclass A {\npublic:\n    A() {\n        cout &lt;&lt; \"Inside A\" &lt;&lt; endl;\n    }\n};\n\nint main() {\n    A a();\n    return 0;\n}\n</code></pre>\n\n<p>Why is the constructor not invoked?</p>\n"}, {"tags": ["c++", "ternary-operator", "operator-precedence"], "comments": [{"owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 7, "creation_date": 1565205102, "post_id": 57400874, "comment_id": 101283448, "body": "I think the ternary operator has precedence over the &lt;&lt; operator. And so the first branch of the ternary was 1, and the other 2 &lt;&lt; std;:endl"}, {"owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "edited": false, "score": 0, "creation_date": 1565205156, "post_id": 57400874, "comment_id": 101283470, "body": "Look at operator precedence. &lt;&lt; is higher than == and ?? (see: <a href=\"https://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/operator_precedence</a>)"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 18, "creation_date": 1565205167, "post_id": 57400874, "comment_id": 101283475, "body": "This also fixes the error: <code>std::cout &lt;&lt; ((abs(c2-c1) == abs(r2-r1)) ? 1 : 2) &lt;&lt; std::endl;</code>.  No need for an intermediate variable."}, {"owner": {"reputation": 1378, "user_id": 6370924, "user_type": "registered", "profile_image": "https://graph.facebook.com/1728062080744924/picture?type=large", "display_name": "Meraj al Maksud", "link": "https://stackoverflow.com/users/6370924/meraj-al-maksud"}, "edited": false, "score": 0, "creation_date": 1565206967, "post_id": 57400874, "comment_id": 101284227, "body": "Here is an <a href=\"https://stackoverflow.com/questions/31300738/why-ternary-operator-does-not-support-blocks\">interesting question</a> I found searching through this site before asking here."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1565247717, "post_id": 57400874, "comment_id": 101294603, "body": "This problem is caused by the repurposing of the shift operator - <code>int x = whatever ? 1 &lt;&lt; 2 : 1 &lt;&lt; 3;</code> has the &quot;obvious&quot; meaning."}, {"owner": {"reputation": 71117, "user_id": 297408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/69caC.png?s=128&g=1", "display_name": "Andriy M", "link": "https://stackoverflow.com/users/297408/andriy-m"}, "reply_to_user": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 8, "creation_date": 1565271481, "post_id": 57400874, "comment_id": 101307998, "body": "@Neo: Just to set the record straight, seeing as your upvoted comment has gained a little more visibility now that the question&#39;s got into HNQ \u2013 the fact that the third argument ended up being <code>2 &lt;&lt; std::endl</code> rather than <code>2</code> means the <code>&lt;&lt;</code> operator has precedence <i>over the ternary operator</i>, not the other way round. I&#39;m sure that&#39;s what you meant to say but for some reason ended up saying the opposite."}], "answers": [{"tags": [], "owner": {"reputation": 369, "user_id": 10152624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/929c5eaef1240eb94f6bdc99d2f19e52?s=128&d=identicon&r=PG&f=1", "display_name": "salcc", "link": "https://stackoverflow.com/users/10152624/salcc"}, "is_accepted": false, "score": 12, "last_activity_date": 1565377956, "last_edit_date": 1565377956, "creation_date": 1565205100, "answer_id": 57400919, "question_id": 57400874, "link": "https://stackoverflow.com/questions/57400874/how-is-the-return-type-of-a-ternary-operator-determined/57400919#57400919", "title": "How is the return type of a ternary operator determined?", "body": "<p>You have to put parentheses around a ternary operation:</p>\n\n<pre><code>std::cout &lt;&lt; ((abs(c2-c1) == abs(r2-r1)) ? 1 : 2) &lt;&lt; std::endl;\n</code></pre>\n\n<p>If not the the <code>&lt;&lt;</code> operator goes to the <code>2</code> and it gives an error because it doesn't have such overloaded function.</p>\n\n<p>This happens because the bitwise left shift operator (<code>&lt;&lt;</code>) has a higher precedence than the ternary operator. You can see the full list of operators and their precedence in <a href=\"https://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">this page of the C++ reference</a>. </p>\n"}, {"comments": [{"owner": {"reputation": 1378, "user_id": 6370924, "user_type": "registered", "profile_image": "https://graph.facebook.com/1728062080744924/picture?type=large", "display_name": "Meraj al Maksud", "link": "https://stackoverflow.com/users/6370924/meraj-al-maksud"}, "edited": false, "score": 0, "creation_date": 1565268057, "post_id": 57400933, "comment_id": 101305631, "body": "So my guess is: the compiler tried to binary this part <code>1 : 2 &lt;&lt; std::endl</code> and failed."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1378, "user_id": 6370924, "user_type": "registered", "profile_image": "https://graph.facebook.com/1728062080744924/picture?type=large", "display_name": "Meraj al Maksud", "link": "https://stackoverflow.com/users/6370924/meraj-al-maksud"}, "edited": false, "score": 0, "creation_date": 1565268113, "post_id": 57400933, "comment_id": 101305669, "body": "@MerajalMaksud Yes.  Basically the two things it would return became <code>1</code> and <code>(2 &lt;&lt; std::endl)</code>"}, {"owner": {"reputation": 2565, "user_id": 1108505, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a7e091fdb18efecace362189bc5f0bf5?s=128&d=identicon&r=PG", "display_name": "Tanner Swett", "link": "https://stackoverflow.com/users/1108505/tanner-swett"}, "reply_to_user": {"reputation": 1378, "user_id": 6370924, "user_type": "registered", "profile_image": "https://graph.facebook.com/1728062080744924/picture?type=large", "display_name": "Meraj al Maksud", "link": "https://stackoverflow.com/users/6370924/meraj-al-maksud"}, "edited": false, "score": 4, "creation_date": 1565268933, "post_id": 57400933, "comment_id": 101306230, "body": "@MerajalMaksud Almost, but not quite. It tried to compile <code>2 &lt;&lt; std::endl</code> and failed."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1565274938, "post_id": 57400933, "comment_id": 101310111, "body": "As a fun fact, <code>std::cout &lt;&lt; 2 - (abs(c2-c1) == abs(r2-r1)) &lt;&lt; std::endl;</code> is equivalent to the fixed code."}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 2, "creation_date": 1565284582, "post_id": 57400933, "comment_id": 101315104, "body": "The original code is actually parsed as <code>(std::cout &lt;&lt; (abs(c2-c1) == abs(r2-r1))) ? 1 : (2 &lt;&lt; std::endl);</code> &quot;Fortunately&quot;, iostreams can be converted to boolean expressions, i.e., the first part will not cause errors (just unexpected behavior)."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 65, "last_activity_date": 1565292259, "last_edit_date": 1565292259, "creation_date": 1565205176, "answer_id": 57400933, "question_id": 57400874, "link": "https://stackoverflow.com/questions/57400874/how-is-the-return-type-of-a-ternary-operator-determined/57400933#57400933", "title": "How is the return type of a ternary operator determined?", "body": "<p>This has nothing to do with how the return type is deduced and everything to do with <a href=\"https://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"noreferrer\">operator precedence</a>.  When you have</p>\n\n<pre><code>std::cout &lt;&lt; (abs(c2-c1) == abs(r2-r1)) ? 1 : 2 &lt;&lt; std::endl;\n</code></pre>\n\n<p>it isn't</p>\n\n<pre><code>std::cout &lt;&lt; ((abs(c2-c1) == abs(r2-r1)) ? 1 : 2) &lt;&lt; std::endl;\n</code></pre>\n\n<p>because <code>?:</code> has lower precedence than <code>&lt;&lt;</code>.  That means what you actually have is</p>\n\n<pre><code>(std::cout &lt;&lt; (abs(c2-c1) == abs(r2-r1))) ? 1 : (2 &lt;&lt; std::endl);\n</code></pre>\n\n<p>and this is why you get an error about an <code>&lt;unresolved overloaded function type&gt;</code>.  Just use parentheses like </p>\n\n<pre><code>std::cout &lt;&lt; ((abs(c2-c1) == abs(r2-r1)) ? 1 : 2) &lt;&lt; std::endl;\n</code></pre>\n\n<p>and you'll be okay.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 8, "last_activity_date": 1565292266, "last_edit_date": 1565292266, "creation_date": 1565205191, "answer_id": 57400938, "question_id": 57400874, "link": "https://stackoverflow.com/questions/57400874/how-is-the-return-type-of-a-ternary-operator-determined/57400938#57400938", "title": "How is the return type of a ternary operator determined?", "body": "<p>Due to <a href=\"http://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence</a>, that line is treated as:</p>\n\n<pre><code>(std::cout &lt;&lt; (abs(c2-c1) == abs(r2-r1))) ? 1 : (2 &lt;&lt; std::endl);\n</code></pre>\n\n<p>Change it to</p>\n\n<pre><code>std::cout &lt;&lt; ((abs(c2-c1) == abs(r2-r1)) ? 1 : 2) &lt;&lt; std::endl;\n//           ^----------------------------------^\n//           Surrounding parentheses\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15754, "user_id": 9835872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PN0Lq.jpg?s=128&g=1", "display_name": "ruohola", "link": "https://stackoverflow.com/users/9835872/ruohola"}, "is_accepted": false, "score": 5, "last_activity_date": 1565339832, "last_edit_date": 1565339832, "creation_date": 1565267070, "answer_id": 57412529, "question_id": 57400874, "link": "https://stackoverflow.com/questions/57400874/how-is-the-return-type-of-a-ternary-operator-determined/57412529#57412529", "title": "How is the return type of a ternary operator determined?", "body": "<p>It's easy to see the mistake when the parsing order is visualized:</p>\n\n<pre><code>std::cout &lt;&lt; (abs(c2-c1) == abs(r2-r1)) ? 1 : 2 &lt;&lt; std::endl;\n\\_______/                                                      &lt;--- #1\n             \\________________________/   V   \\~~~~error~~~/   &lt;--- #2\n             \\_____________________________________________/   &lt;--- #3\n\\__________________________________________________________/   &lt;--- #4\n\\___________________________________________________________/  &lt;--- #5\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 4, "last_activity_date": 1565276636, "last_edit_date": 1565276636, "creation_date": 1565268674, "answer_id": 57413059, "question_id": 57400874, "link": "https://stackoverflow.com/questions/57400874/how-is-the-return-type-of-a-ternary-operator-determined/57413059#57413059", "title": "How is the return type of a ternary operator determined?", "body": "<p>The literal answer to the question you asked is the algorithm in the <a href=\"http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2017/n4659.pdf#section.8.16\" rel=\"nofollow noreferrer\">[expr.cond] secton of the C++ language standard.</a></p>\n\n<p>The basic rule \u201cdetermined whether an implicit conversion sequence can be formed from the second operand to the target type determined for the third operand, and vice versa.\u201d  If there isn\u2019t one possible conversion, or there is more than one, it\u2019s a syntax error, but there are several special cases (which don\u2019t apply here):</p>\n\n<ul>\n<li>If both are arithmetic or <code>enum</code> types, you get the same kind of implicit conversion for <code>p ? a : b</code> that determines the type of an expression such as <code>a + b</code> or <code>a * b</code>.</li>\n<li>One of the targets may be a <code>throw</code> expression, and is treated as having the type of the other.</li>\n<li>If one of the targets is a bitfield, so is the type of the conditional expression</li>\n<li>Pointers with different qualifiers (such as <code>const</code> and <code>volatile</code>) have their qualifiers unified.</li>\n</ul>\n\n<p>The result is a glvalue if the targets are glvalues of the same type, and a prvalue otherwise.</p>\n\n<p>When in doubt, you can always explicitly cast one or both of the operands so that they have the same type.</p>\n\n<p>Your actual problem here is operator precedence, as the accepted answer explains.  That is, the compiler parses the third operand as <code>2 &lt;&lt; std::endl</code>, rather than 2.</p>\n"}, {"tags": [], "owner": {"reputation": 1378, "user_id": 6370924, "user_type": "registered", "profile_image": "https://graph.facebook.com/1728062080744924/picture?type=large", "display_name": "Meraj al Maksud", "link": "https://stackoverflow.com/users/6370924/meraj-al-maksud"}, "is_accepted": false, "score": 1, "last_activity_date": 1565377730, "last_edit_date": 1592644375, "creation_date": 1565377730, "answer_id": 57435865, "question_id": 57400874, "link": "https://stackoverflow.com/questions/57400874/how-is-the-return-type-of-a-ternary-operator-determined/57435865#57435865", "title": "How is the return type of a ternary operator determined?", "body": "<p>According to <a href=\"https://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">cppreference</a>:</p>\n<blockquote>\n<p>When parsing an expression, an operator which is listed on some row of the table above with a precedence will be bound tighter (as if by parentheses) to its arguments than any operator that is listed on a row further below it with a lower precedence. For example, the expressions <code>std::cout &lt;&lt; a &amp; b</code> and <code>*p++</code> are parsed as <code>(std::cout &lt;&lt; a) &amp; b</code> and <code>*(p++)</code>, and not as <code>std::cout &lt;&lt; (a &amp; b)</code> or <code>(*p)++</code>.</p>\n<p>Operators that have the same precedence are bound to their arguments in the direction of their associativity. For example, the expression <code>a = b = c</code> is parsed as <code>a = (b = c)</code>, and not as <code>(a = b) = c</code> because of right-to-left associativity of assignment, but <code>a + b - c</code> is parsed <code>(a + b) - c</code> and not <code>a + (b - c)</code> because of left-to-right associativity of addition and subtraction.</p>\n<p>Associativity specification is redundant for unary operators and is only shown for completeness: unary prefix operators always associate right-to-left (<code>delete ++*p</code> is <code>delete (++(*p)))</code> and unary postfix operators always associate left-to-right (<code>a[1][2]++</code> is <code>((a[1])[2])++</code>). Note that the associativity is meaningful for member access operators, even though they are grouped with unary postfix operators: <code>a.b++</code> is parsed <code>(a.b)++</code> and not <code>a.(b++)</code>.</p>\n<p>Operator precedence is unaffected by operator overloading. For example, <code>std::cout &lt;&lt; a ? b : c;</code> parses as <code>(std::cout &lt;&lt; a) ? b : c;</code> because the precedence of arithmetic left shift is higher than the conditional operator.</p>\n</blockquote>\n"}], "owner": {"reputation": 1378, "user_id": 6370924, "user_type": "registered", "profile_image": "https://graph.facebook.com/1728062080744924/picture?type=large", "display_name": "Meraj al Maksud", "link": "https://stackoverflow.com/users/6370924/meraj-al-maksud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4333, "favorite_count": 2, "closed_date": 1565463965, "accepted_answer_id": 57400933, "answer_count": 6, "score": 32, "last_activity_date": 1571854034, "creation_date": 1565204855, "last_edit_date": 1571854034, "question_id": 57400874, "link": "https://stackoverflow.com/questions/57400874/how-is-the-return-type-of-a-ternary-operator-determined", "closed_reason": "Duplicate", "title": "How is the return type of a ternary operator determined?", "body": "<p>I was solving a problem about movement of a bishop on a chessboard. At one point of my code, I had the following statement:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::cout &lt;&lt; (abs(c2-c1) == abs(r2-r1)) ? 1 : 2 &lt;&lt; std::endl;\n</code></pre>\n\n<p>This generates the following error:</p>\n\n<blockquote>\n<pre><code>error: invalid operands of types 'int' and '&lt;unresolved overloaded function type&gt;' to binary 'operator&lt;&lt;'\n</code></pre>\n</blockquote>\n\n<p>However, I instantaneously fixed this error by including an additional variable in my code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int steps = (abs(c2-c1) == abs(r2-r1)) ? 1 : 2;\nstd::cout &lt;&lt; steps &lt;&lt; std::endl;\n</code></pre>\n\n<p>How does the ternary operator work, and how is its return type determined (as the compiler called it <code>&lt;unresolved overloaded function type&gt;</code>)?</p>\n"}, {"tags": ["c++", "openscenegraph"], "answers": [{"tags": [], "owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "is_accepted": true, "score": 0, "last_activity_date": 1569340260, "creation_date": 1569340260, "answer_id": 58084045, "question_id": 57400687, "link": "https://stackoverflow.com/questions/57400687/how-can-i-set-shininess-on-an-osggeometry-without-setting-a-material-in-opensc/58084045#58084045", "title": "How can I set shininess on an osg::Geometry without setting a material in OpenSceneGraph", "body": "<p>I asked the same question on the OSG forum (which was not working in August, which was the only reason I asked this question on SO since this is not really a good place to ask OSG questions...)</p>\n\n<p>If you set the color mode on the material to AMBIENT_AND_DIFFUSE, you can still use a color array and set the shininess too.</p>\n\n<pre><code>pMaterial-&gt;setColorMode(osg::Material::AMBIENT_AND_DIFFUSE)\n</code></pre>\n\n<p>The original answer on the OSG forum:</p>\n\n<p><a href=\"http://forum.openscenegraph.org/viewtopic.php?t=17877\" rel=\"nofollow noreferrer\">original answer on the OSG forum</a></p>\n"}], "owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 58084045, "answer_count": 1, "score": 0, "last_activity_date": 1569340260, "creation_date": 1565203974, "question_id": 57400687, "link": "https://stackoverflow.com/questions/57400687/how-can-i-set-shininess-on-an-osggeometry-without-setting-a-material-in-opensc", "title": "How can I set shininess on an osg::Geometry without setting a material in OpenSceneGraph", "body": "<p>I have an osg::Geometry on whose state set I used to set a material that I made shiny via osg::Material::setShininess(). The problem is that now I have the need to set various colors across the geometry. I tried doing this with the geometry's color array, but that approach didn't work unless I stopped setting a material on the geometry's state set.</p>\n\n<p>I understand the logic here, that a material should override a color array, but I'm curious if there's some other way to make the geometry shiny now that I can't set a material on its state set?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1565203681, "post_id": 57400567, "comment_id": 101282760, "body": "<code>std::thread newThread(&amp;Application::run, this);</code> the thread goes out of scope when <code>void Application::start()</code> ends."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1565203742, "post_id": 57400567, "comment_id": 101282791, "body": "<code>while (running)</code> ... <code>running = true;</code> - the <code>running</code> variable is accessed/modified from multiple threads. It needs synchronization. And I&#39;ll bet that&#39;s not the only data-race in your code."}, {"owner": {"reputation": 3174, "user_id": 10493338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/198IL.jpg?s=128&g=1", "display_name": "Michael Kemmerzell", "link": "https://stackoverflow.com/users/10493338/michael-kemmerzell"}, "edited": false, "score": 1, "creation_date": 1565203823, "post_id": 57400567, "comment_id": 101282841, "body": "There is also missing a <code>detach</code> or <code>join</code> which would lead to a crash later on"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1565204291, "post_id": 57400567, "comment_id": 101283085, "body": "Multithreaded programming is much more than figuring out how to start multiple threads.  You have to learn synchronization techniques also, and that in itself is not a trivial topic."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1565204388, "post_id": 57400567, "comment_id": 101283135, "body": "I&#39;ll bet you could remove at least 90% of that code and still get the problem. Once you&#39;ve eliminated distractions, if you can see what&#39;s wrong in the code you&#39;re done. If you can&#39;t, post the <b>smallest</b> program you can come up with that compiles, runs, and shows the problem."}, {"owner": {"reputation": 115, "user_id": 8338615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971aac686c830f2fb36f66efe5a70b63?s=128&d=identicon&r=PG", "display_name": "SuperSim135", "link": "https://stackoverflow.com/users/8338615/supersim135"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1565206714, "post_id": 57400567, "comment_id": 101284117, "body": "@PaulMcKenzie is the point of threading to run asynchronous processes?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1565206935, "post_id": 57400567, "comment_id": 101284207, "body": "Yes, that is the point.  But there is much more to it than just starting threads.  Mutexes, semaphores, atomic variables, condition variables, etc.  Look at your <code>running</code> variable.  As the comment before pointed out, if that is a static variable, or if it isn&#39;t static but you&#39;re accessing the same object instance, that <code>run</code> function is not thread safe."}, {"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1565209246, "post_id": 57400567, "comment_id": 101285110, "body": "Also what do you thing would happen when you exit main if you have secondary threads running. Your code must manage its threads. Beside that, it make no sense to start a thread if main thread does nothing no even waiting!"}, {"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1565209966, "post_id": 57400567, "comment_id": 101285409, "body": "Multithreaded code without proper synchronization between threads would be like blind people running through an intersection with heavy traffic. You will get crashes."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1565212112, "post_id": 57400567, "comment_id": 101286146, "body": "@Phil1970 -- it isn&#39;t self-evident that there&#39;s something wrong with exiting <code>main</code> while other threads are running. In Java, if I remember correctly, that&#39;s perfectly okay, and the program continues to run until all the threads have terminated."}], "answers": [{"comments": [{"owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "reply_to_user": {"reputation": 115, "user_id": 8338615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971aac686c830f2fb36f66efe5a70b63?s=128&d=identicon&r=PG", "display_name": "SuperSim135", "link": "https://stackoverflow.com/users/8338615/supersim135"}, "edited": false, "score": 0, "creation_date": 1565205471, "post_id": 57400797, "comment_id": 101283580, "body": "@SuperSim135 You&#39;d need to create more <code>Thread</code> objects, but yeah, sure."}], "tags": [], "owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "is_accepted": true, "score": 2, "last_activity_date": 1565204913, "last_edit_date": 1565204913, "creation_date": 1565204449, "answer_id": 57400797, "question_id": 57400567, "link": "https://stackoverflow.com/questions/57400567/when-trying-to-start-a-thread-in-my-base-class-visual-studio-aborts-my-program/57400797#57400797", "title": "When trying to start a thread in my base class, Visual Studio aborts my program due to a debug error", "body": "<p>As <a href=\"https://stackoverflow.com/users/487892/drescherjm\">drescherjm</a> already commented, when <code>Application::start</code> finishes (which is immediately after <code>Application::run</code> changes <code>running</code> to <code>true</code>, which happens at its <em>start</em>) the destructor of <code>newThread</code> is called.</p>\n\n<p>According to <a href=\"https://en.cppreference.com/w/cpp/thread/thread/~thread\" rel=\"nofollow noreferrer\">the cppreference page for Thread::~thread</a>, the destructor of a currently-running <code>thread</code> calls <code>std::terminate()</code>, which according to <a href=\"https://en.cppreference.com/w/cpp/error/terminate\" rel=\"nofollow noreferrer\">this</a> calls (by default) <code>std::abort()</code>, leading to the message you see.</p>\n\n<p>In short, you can't have a running <code>Thread</code> going out of scope.<br>\nIf it fits, you can simply call <code>newThread.join()</code> in <code>Application::start</code>, which will hold it until the thread finishes.</p>\n\n<p>Or you can call <code>newThread.detach()</code>. This will make <code>newThread</code> saparate from the main thread, making it impossible to <code>join</code> - which can be good or bad, it depends on your needs. In this state, albeit the thread itself still running, the <code>newThread</code> variable could be destructed in peace (as detaching a thread disconnects it from the variable in which it's held).</p>\n"}], "owner": {"reputation": 115, "user_id": 8338615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971aac686c830f2fb36f66efe5a70b63?s=128&d=identicon&r=PG", "display_name": "SuperSim135", "link": "https://stackoverflow.com/users/8338615/supersim135"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 57400797, "answer_count": 1, "score": -2, "last_activity_date": 1565204913, "creation_date": 1565203480, "question_id": 57400567, "link": "https://stackoverflow.com/questions/57400567/when-trying-to-start-a-thread-in-my-base-class-visual-studio-aborts-my-program", "title": "When trying to start a thread in my base class, Visual Studio aborts my program due to a debug error", "body": "<p>When I start my thread from my base class, it runs fine, then Visual Studio tells me that there is an abort error.</p>\n\n<p>I'm using Visual Studio Community 19, and when I debug my program Visual Studio shows me a break point \"(x)\" right after I create the new thread and \nan error message pops along with a dialog asking me if I would like to abort, retry, or ignore.</p>\n\n<p>It looks something like this:</p>\n\n<hr>\n\n<p>Microsoft Visual C++ Runtime Library</p>\n\n<p>(x) Debug Error!</p>\n\n<p>Program: C\\Users\\Super\\Desktop\\Void\\Debug\\Void.exe</p>\n\n<p>abort() has been called</p>\n\n<p>(Press Retry to debug the application)</p>\n\n<hr>\n\n<p>If I don't create a new thread, and I just call the \"run()\" function, the program runs without any debug errors.</p>\n\n<p>//This is the code that starts the thread</p>\n\n<pre><code>void Application::start()\n{\n    std::thread newThread(&amp;Application::run, this);\n\n    while (!running)\n    {\n        std::cout &lt;&lt; \"Not Running!\" &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>//This is the code that the application runs</p>\n\n<pre><code>void Application::run()\n{\n    setup();\n    running = true;\n\n    //using namespace std::chrono;\n\n    auto lastTime = std::chrono::high_resolution_clock::now();\n    auto timer = std::chrono::high_resolution_clock::now();\n\n    double delta = 0;\n    int ticks = 0;\n\n    while (running)\n    {\n        setTargetTPS(60);\n        auto now = std::chrono::high_resolution_clock::now();\n\n        delta += std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(now - lastTime).count() / ns;\n\n        lastTime = now;\n\n        while (delta &gt; 1)\n        {\n            update();\n            ticks++;\n            delta--;\n        }\n\n        if     (std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(std::chrono::high_resolution_clock::now() - timer).count() &gt; 1000)\n        {\n            timer = std::chrono::high_resolution_clock::now();\n            tps = ticks;\n            ticks = 0;\n\n            std::cout &lt;&lt; \"TPS: \" &lt;&lt; tps &lt;&lt; std::endl;\n        }\n    }\n\n}\n</code></pre>\n\n<p>//Game is a subclass of Application, I use it like this</p>\n\n<pre><code>#include \"Game.h\"\n\nint main()\n{\n    Game* game = new Game();\n    game-&gt;start();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "pdf", "visual-studio-2017"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1565203807, "post_id": 57400562, "comment_id": 101282834, "body": "<b><i>but sometimes it throws an exception</i></b> Exception for no symbols? I thought that was just a warning in the output window. Since the lack of symbols does not effect your ability to run a program. I think whatever exception you have is not due to the missing symbols. Symbols are important if you think you have found a bug in the library or want to debug your programs interaction with a compiled binary."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1565204361, "post_id": 57400562, "comment_id": 101283121, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 839, "user_id": 2832872, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/709868624/picture?type=large", "display_name": "Diego Fernando Pava", "link": "https://stackoverflow.com/users/2832872/diego-fernando-pava"}, "edited": false, "score": 0, "creation_date": 1565204880, "post_id": 57400562, "comment_id": 101283364, "body": "I just added more information, if you want me to post all the code I can do so because when I tried a minimal pdf creation process it runs all the time."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1565205462, "post_id": 57400562, "comment_id": 101283578, "body": "The exception is an Access Violation in the <code>jagpdf-1.4.dll</code> dll. Could be a bug in that dll or caused by Undefined Behavior in your code. That has nothing to do with the symbols not loaded. The symbols not loaded prevent you from looking into the dll to see the variable and other names in the disassembly at the address of the crash."}, {"owner": {"reputation": 839, "user_id": 2832872, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/709868624/picture?type=large", "display_name": "Diego Fernando Pava", "link": "https://stackoverflow.com/users/2832872/diego-fernando-pava"}, "edited": false, "score": 0, "creation_date": 1565228094, "post_id": 57400562, "comment_id": 101289678, "body": "Thank you, so I was looking in the wrong place... this is bad news because I have no idea how to debug this one."}], "answers": [{"tags": [], "owner": {"reputation": 1057, "user_id": 1669243, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/78cf4fe32ac26c49d554366e4ec55dd2?s=128&d=identicon&r=PG", "display_name": "JosephA", "link": "https://stackoverflow.com/users/1669243/josepha"}, "is_accepted": true, "score": -1, "last_activity_date": 1565502629, "creation_date": 1565502629, "answer_id": 57447646, "question_id": 57400562, "link": "https://stackoverflow.com/questions/57400562/symbol-file-not-loaded-in-vs2017-only-happens-10-of-the-time-with-jagpdf/57447646#57447646", "title": "symbol file not loaded in VS2017 only happens 10% of the time with JAGPDF", "body": "<p>It sounds as if you have found a bug in the PDF library you are using.  You have to file a bug report with the PDF software provider. Hopefully they can provide you support.</p>\n"}], "owner": {"reputation": 839, "user_id": 2832872, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/709868624/picture?type=large", "display_name": "Diego Fernando Pava", "link": "https://stackoverflow.com/users/2832872/diego-fernando-pava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 57447646, "answer_count": 1, "score": -2, "last_activity_date": 1565571722, "creation_date": 1565203434, "last_edit_date": 1565571722, "question_id": 57400562, "link": "https://stackoverflow.com/questions/57400562/symbol-file-not-loaded-in-vs2017-only-happens-10-of-the-time-with-jagpdf", "title": "symbol file not loaded in VS2017 only happens 10% of the time with JAGPDF", "body": "<p><a href=\"https://i.stack.imgur.com/zOOSP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zOOSP.png\" alt=\"enter image description here\"></a>I couldn't find a solution to this problem. I have a very simple program to generate a PDF using JAGPDF. If i am opening the program from visual studio (same input, same parameters) it runs to the end without errors 90% of the time, but sometimes it throws an exception  telling me that symbols not loaded for jagpdf-1.4.dll</p>\n\n<p>If I run the executable directly, 90% it creates the PDF correctly and 10% of the time created a corrupted pdf that I cannot open. How can I solve this problem?</p>\n\n<p>EDIT: I put a screenshot of the error I'm getting, it is very dificult to reproduce because the program runs normally about 90% of the time, so I have to press build several times until it crashes...</p>\n\n<p>EDIT 2: Since it seems the bug is from the library, (I already send them a message reporting it but doubt they'll do something about it because last release was years ago). </p>\n\n<p>I sort of solved the problem by wrapping the function around a loop using try and catch where if the first time it fails then the exception is caught and the function is tried again until it passes.  I put a limit of 10 times it can run the loop before terminating it.</p>\n\n<p>The thinking was that, as the events seem to be statistically independent, the loop will reduce the chance of it failing from 0.1 to 0.1^n with n the number of loops.</p>\n\n<p>So now the program is crashing with a probability of 0.0000001% instead of 10%.</p>\n\n<p>With this fix I am happy to report no fails for this weeks data.</p>\n\n<p>Thank you all for pointing me to the direction of the error.</p>\n"}, {"tags": ["c++", "c-preprocessor"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1565203559, "post_id": 57400549, "comment_id": 101282703, "body": "&quot;I want to write a macro&quot; - Stop right there and reconsider. Macros are <i>evil</i>. You don&#39;t want to use them except as a last resort when they are the <i>only</i> option left."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1565203585, "post_id": 57400549, "comment_id": 101282716, "body": "Usually you&#39;d use Boost.Preprocessor for this kind of fancy macros."}, {"owner": {"reputation": 33, "user_id": 11897847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yDEYQYQABKU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regFl3M34LLS3P2k4FWxfFlNG6Mbw/photo.jpg?sz=128", "display_name": "Ymls", "link": "https://stackoverflow.com/users/11897847/ymls"}, "edited": false, "score": 0, "creation_date": 1565204422, "post_id": 57400549, "comment_id": 101283161, "body": "Thank you for the super quick responses. These functions are super boring and  and I agree with avoiding macros at all costs. They&#39;re just super repetitive and I feel like writing the same thing 400 times is a little pointless.  These classes often consist of tens of functions that I need to use so I end up with 4 lines of code per function times ten or more usually so I think the use of macros to shorten these is justified. I will look at Boost.Preprocessor, thank you!"}, {"owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "edited": false, "score": 0, "creation_date": 1565206012, "post_id": 57400549, "comment_id": 101283820, "body": "You can write easily if you can have a max number of parameter by providing a conversion from <code>__VA_ARGS__</code> to another macro with fixed number of arguments."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11897847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yDEYQYQABKU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regFl3M34LLS3P2k4FWxfFlNG6Mbw/photo.jpg?sz=128", "display_name": "Ymls", "link": "https://stackoverflow.com/users/11897847/ymls"}, "edited": false, "score": 0, "creation_date": 1565254009, "post_id": 57401133, "comment_id": 101297714, "body": "Works great on g++ but the macro expands a little weird with more than one parameter in MSVC (second parameter ends up as just (int, something) instead of ::std::enable_if_t&lt;type_&gt; name_. Thank you so much for all your help :)"}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 5, "last_activity_date": 1565293369, "last_edit_date": 1565293369, "creation_date": 1565206035, "answer_id": 57401133, "question_id": 57400549, "link": "https://stackoverflow.com/questions/57400549/creating-a-c-macro-that-allows-for-easy-creation-of-virtual-function-wrapper-f/57401133#57401133", "title": "Creating a C++ macro that allows for easy creation of virtual-function wrapper functions", "body": "<p>Here's your macro.</p>\n\n<p>Usage:</p>\n\n<pre><code>VFUNC(1, int, foo)\nVFUNC_P(1, int, foo, (int,x))\nVFUNC_P(1, int, foo, (int,x), (float,y))\n</code></pre>\n\n<p>Implementation:</p>\n\n<pre><code>#define CAT(x, y) CAT_(x, y)\n#define CAT_(x, y) x##y\n\n#define VA_COUNT(...) VA_COUNT_(__VA_ARGS__, 5, 4, 3, 2, 1,)\n#define VA_COUNT_(p5, p4, p3, p2, p1, x, ...) x\n\n#define FOR_EACH(macro, ...) CAT(FOR_EACH_, VA_COUNT(__VA_ARGS__))(macro, __VA_ARGS__)\n#define FOR_EACH_1(m, p1                ) m p1\n#define FOR_EACH_2(m, p1, p2            ) m p1 , m p2\n#define FOR_EACH_3(m, p1, p2, p3        ) m p1 , m p2 , m p3\n#define FOR_EACH_4(m, p1, p2, p3, p4    ) m p1 , m p2 , m p3 , m p4\n#define FOR_EACH_5(m, p1, p2, p3, p4, p5) m p1 , m p2 , m p3 , m p4 , m p5\n\n#define VFUNC_param_decl(type_, name_) ::std::enable_if_t&lt;1, type_&gt; name_\n#define VFUNC_param_use(type_, name_) name_\n\n#define VFUNC(index_, return_type_, name_) \\\n    return_type_ name_() \\\n    { return call_vfunc(index_, this); }\n\n#define VFUNC_P(index_, return_type_, name_, ...) \\\n    return_type_ name_( FOR_EACH(VFUNC_param_decl, __VA_ARGS__) ) \\\n    { return call_vfunc(index_, this, FOR_EACH(VFUNC_param_use, __VA_ARGS__)); }\n</code></pre>\n\n<p>The simple implementation provided above has a few limitations:</p>\n\n<ul>\n<li>There is a separate macro for functions with 0 parameters.</li>\n<li>You need to prepare <code>O(n)</code> boilerplate macros, where <code>n</code> is the maximum amount of function parameters you want to support. The code above supports up to 5 parameters.</li>\n</ul>\n\n<p>There is a way to fix both of those problems, but it would require even more ugly macros. It doesn't seem to be worth it.</p>\n\n<hr>\n\n<p>You could rewrite those macros to use Boost.Preprocessor library. (Use <code>BOOST_PP_VARIADIC_TO_SEQ</code> + <code>BOOST_PP_SEQ_FOR_EACH</code> or something similar.)</p>\n\n<p>It would allow you to get rid of the boilerplate (because it would be provided by the library).</p>\n"}], "owner": {"reputation": 33, "user_id": 11897847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yDEYQYQABKU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regFl3M34LLS3P2k4FWxfFlNG6Mbw/photo.jpg?sz=128", "display_name": "Ymls", "link": "https://stackoverflow.com/users/11897847/ymls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 3, "accepted_answer_id": 57401133, "answer_count": 1, "score": 2, "last_activity_date": 1565293369, "creation_date": 1565203352, "question_id": 57400549, "link": "https://stackoverflow.com/questions/57400549/creating-a-c-macro-that-allows-for-easy-creation-of-virtual-function-wrapper-f", "title": "Creating a C++ macro that allows for easy creation of virtual-function wrapper functions", "body": "<p>I am writing a modification for an old game and am utilizing basic reverse engineering to achieve my goal. Essentially I have been recreating simple versions of reverse engineered game structs and interfaces in my own code, building my solution as a shared object and loading it in the game. </p>\n\n<p>My current solution to keeping the code simple is to only include the functions I need in \"my versions\" of the reverse engineered interfaces, and to do that I simply write something like:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class GameManager {\npublic:\n    Game* GetGame();\n    Game* NextGame();\n    Game* PreviousGame();\n    int   GameCount();\n...\n};\n</code></pre>\n\n<p>and then implement the functions as simple wrappers that call the original functions by index in the virtual method table. This way I can only include what I need, etc etc.</p>\n\n<p>Each of these consists of essentially <code>SomeType* SomeFunction(int param){ typedef thiscall blabla; call_vfunc(1,this,param); }</code></p>\n\n<p>I want to write a macro that automates this process, something simple and easy use like <code>#define VFUNC(index, returnType, name, parameters)</code>.</p>\n\n<p>I messed around with it and made a few failed attempts at achieving this. The most recent one looks like so:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#define VFUNC(index, returnType, name, ...) returnType name(__VA_ARGS__) { return call_vfunc(index, this, ##__VA_ARGS__); }\n</code></pre>\n\n<p>This works when the function doesn't take any parameters but the problem is that once I introduce parameters (for exaxmple, writing <code>VFUNC(12, int, someFunction, int someParam)</code> I end up passing the whole declaration when I only want to pass the names of the parameters. I've been thinking of a way I can turn (int a, int b, int c) into (a,b,c) so I can just pass them in to call_vfunc but so far I have nothing.</p>\n\n<p><strong>TLDR:</strong> I'm wanting to write a macro that automates the process of creating these virtual-function \"wrapper functions\".</p>\n\n<p>Thank you. Any help or direction is greatly appreciated =)\nI'll keep you updated if I figure it out.</p>\n"}, {"tags": ["c++", "oop"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1565203089, "post_id": 57400453, "comment_id": 101282491, "body": "Let me ask you this: If the class has a protected member, can it be accessed from outside of the class?"}, {"owner": {"reputation": 29, "user_id": 11824409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7504faacc3159e2d9d659a115c90844f?s=128&d=identicon&r=PG&f=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/11824409/karan-singh"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565203155, "post_id": 57400453, "comment_id": 101282522, "body": "nope as only public members are allowed to be accessed from outside"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1565203162, "post_id": 57400453, "comment_id": 101282528, "body": "Note: Protected inheritance is usually a bug. It very rarely is what you actually want. Composition or private inheritance is more likely to be what you <i>actually</i> want."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1565203244, "post_id": 57400453, "comment_id": 101282570, "body": "@KaranSingh Okay, so lets extend that to the base class.  If it is protected, should we be able to access it, i.e. get pointer to it?"}, {"owner": {"reputation": 29, "user_id": 11824409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7504faacc3159e2d9d659a115c90844f?s=128&d=identicon&r=PG&f=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/11824409/karan-singh"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565203666, "post_id": 57400453, "comment_id": 101282753, "body": "aren&#39;t we accessing the child class using the pointer of base class and not vice versa?? @NathanOliver"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565203792, "post_id": 57400453, "comment_id": 101282825, "body": "In your code you are trying to store the child class, using a pointer to it&#39;s base.  See how that is a problem?"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1565206774, "post_id": 57400453, "comment_id": 101284142, "body": "Why would you expect it to work like this? What difference should private/protected/public inheritance make? Sorry, but the reason you can&#39;t do that is because the language doesn&#39;t allow it. BTW: Check out Liskov Substitution Principle. According to that, a derived class instance is also a base class instance. So, applying that logic to your code, a son is a father which doesn&#39;t make sense if you translate that to human relationships. Avoid such linguistic conflicts, like they are also present in the terms &quot;parent class&quot; and &quot;child class&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 1030, "user_id": 4080543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09a1ce48bfe85fb56524408afe18fe89?s=128&d=identicon&r=PG&f=1", "display_name": "MTMD", "link": "https://stackoverflow.com/users/4080543/mtmd"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1565204984, "post_id": 57400709, "comment_id": 101283401, "body": "@Yksisarvinen. Indeed. Changed accordingly. Thank you."}, {"owner": {"reputation": 29, "user_id": 11824409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7504faacc3159e2d9d659a115c90844f?s=128&d=identicon&r=PG&f=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/11824409/karan-singh"}, "edited": false, "score": 0, "creation_date": 1565204988, "post_id": 57400709, "comment_id": 101283402, "body": "how can I use both protected inheritance and method overriding at the same time ?"}, {"owner": {"reputation": 1030, "user_id": 4080543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09a1ce48bfe85fb56524408afe18fe89?s=128&d=identicon&r=PG&f=1", "display_name": "MTMD", "link": "https://stackoverflow.com/users/4080543/mtmd"}, "edited": false, "score": 0, "creation_date": 1565205018, "post_id": 57400709, "comment_id": 101283416, "body": "@Chipster. I <i>think</i>, it should and it&#39;s actually a very interesting point you brought up."}, {"owner": {"reputation": 1030, "user_id": 4080543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09a1ce48bfe85fb56524408afe18fe89?s=128&d=identicon&r=PG&f=1", "display_name": "MTMD", "link": "https://stackoverflow.com/users/4080543/mtmd"}, "reply_to_user": {"reputation": 29, "user_id": 11824409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7504faacc3159e2d9d659a115c90844f?s=128&d=identicon&r=PG&f=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/11824409/karan-singh"}, "edited": false, "score": 0, "creation_date": 1565205190, "post_id": 57400709, "comment_id": 101283485, "body": "@KaranSingh, I am not sure what exactly you are asking. But, probably using a fried function can help you."}, {"owner": {"reputation": 29, "user_id": 11824409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7504faacc3159e2d9d659a115c90844f?s=128&d=identicon&r=PG&f=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/11824409/karan-singh"}, "edited": false, "score": 0, "creation_date": 1565205363, "post_id": 57400709, "comment_id": 101283542, "body": "@MTMD I wanted to create a virtual function in father class which will be overridden in its child class with protected inheritance, is it possible?"}, {"owner": {"reputation": 29, "user_id": 11824409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7504faacc3159e2d9d659a115c90844f?s=128&d=identicon&r=PG&f=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/11824409/karan-singh"}, "edited": false, "score": 0, "creation_date": 1565205780, "post_id": 57400709, "comment_id": 101283717, "body": "@Yksisarvinen why is it not advised to create dynamic memory inside constructor?"}, {"owner": {"reputation": 1030, "user_id": 4080543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09a1ce48bfe85fb56524408afe18fe89?s=128&d=identicon&r=PG&f=1", "display_name": "MTMD", "link": "https://stackoverflow.com/users/4080543/mtmd"}, "edited": false, "score": 0, "creation_date": 1565205862, "post_id": 57400709, "comment_id": 101283756, "body": "Yes. You can achieve that with a friend member. In case you may need more help on that, please ask it as separate question (answering that question here makes it hard for future users to use this post)."}, {"owner": {"reputation": 29, "user_id": 11824409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7504faacc3159e2d9d659a115c90844f?s=128&d=identicon&r=PG&f=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/11824409/karan-singh"}, "edited": false, "score": 0, "creation_date": 1565206062, "post_id": 57400709, "comment_id": 101283844, "body": "@MTMD doesn&#39;t friend class inherits private members also, then how could i get protected inheritance?"}], "tags": [], "owner": {"reputation": 1030, "user_id": 4080543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09a1ce48bfe85fb56524408afe18fe89?s=128&d=identicon&r=PG&f=1", "display_name": "MTMD", "link": "https://stackoverflow.com/users/4080543/mtmd"}, "is_accepted": false, "score": 4, "last_activity_date": 1565205965, "last_edit_date": 1565205965, "creation_date": 1565204065, "answer_id": 57400709, "question_id": 57400453, "link": "https://stackoverflow.com/questions/57400453/error-father-is-an-inaccessible-base-of-son/57400709#57400709", "title": "error: \u2018father\u2019 is an inaccessible base of \u2018son\u2019", "body": "<p>A protected member of a class is accessible by the class itself and it's children. A similar logic applies to protected inheritance. That is, when you have a protected inheritance only the class and it's children are \"aware\" of such inheritance. Hence, with your code (use of protected inheritance), you could easily cast son to father within the son class as shown it what follows.</p>\n\n<pre><code>class father\n{\npublic:\n  int n = 10;\n};\nclass son : protected father\n{\nvoid tmp(){father *f = new son;}\npublic:\n  son()\n  {\n    cout &lt;&lt; n;\n  }\n};\n</code></pre>\n\n<p>However, to achieve what you wish to achieve, you must use public inheritance (to make it possible for others to be \"aware\" of the existence of such inheritance).</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nclass father\n{\npublic:\n  int n = 10;\n};\nclass son : public father\n{\npublic:\n  son()\n  {\n    cout &lt;&lt; n;\n  }\n};\nint main()\n{\n  father *f;\n  f = new son;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11824409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7504faacc3159e2d9d659a115c90844f?s=128&d=identicon&r=PG&f=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/11824409/karan-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565205965, "creation_date": 1565202986, "last_edit_date": 1565204446, "question_id": 57400453, "link": "https://stackoverflow.com/questions/57400453/error-father-is-an-inaccessible-base-of-son", "title": "error: \u2018father\u2019 is an inaccessible base of \u2018son\u2019", "body": "<p>Why am I not able to create a pointer of base class and point it to child class when access modifiers are put as private or protected ?</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nclass father\n{\n     public:\n     int n=10;\n};\n\nclass son:protected father\n{\npublic:\n    son(){\n        cout&lt;&lt;n;\n    }\n};\n\nint main()\n{\n    father *f;\n    f=new son;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++14", "c++17", "std-function", "stdbind"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1565202663, "post_id": 57400372, "comment_id": 101282277, "body": "If you have a functor that has state, you cannot get a plain function pointer from it."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1565202837, "post_id": 57400372, "comment_id": 101282357, "body": "If you ever find yourself using <code>void*</code> in C++, your first thought should be &quot;I&#39;m <i>probably</i> doing it wrong&quot;. There are <i>very</i>, <i>VERY</i> few situations in C++ where a <code>void*</code> is the correct solution."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1565202906, "post_id": 57400372, "comment_id": 101282390, "body": "@JesperJuhl, I don&#39;t see any <code>void*</code>. The OP mentioned an external API that takes a <code>void(*)()</code>."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1565202965, "post_id": 57400372, "comment_id": 101282420, "body": "@chris I was simply reacting to &quot;and return a void pointer&quot;.. and making a general statement about <code>void*</code> \ud83d\ude09"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1565203078, "post_id": 57400372, "comment_id": 101282487, "body": "@st91, What is the full structure of the function you need this function pointer for? C APIs with callbacks are supposed to also have a way to pass state through. If they don&#39;t, the solutions go from ugly to hacky and the primary way to get a clean solution is for the API to be updated in a future version."}, {"owner": {"reputation": 47, "user_id": 8679582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccfff8ec1d6b5b3e70cab10279a27484?s=128&d=identicon&r=PG&f=1", "display_name": "sam91", "link": "https://stackoverflow.com/users/8679582/sam91"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565203399, "post_id": 57400372, "comment_id": 101282623, "body": "@NathanOliver @chris Yes, I understand that. But is there a way to bind a static member function with the class object and get a void pointer to the function. Since external API need it to be a void pointer to the function, it becomes necessary for me to convert it. I tried using &#39;std::function&lt;void()&gt;` but it returns the <code>std::function type</code> and not <code>void(*)()</code>."}, {"owner": {"reputation": 47, "user_id": 8679582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccfff8ec1d6b5b3e70cab10279a27484?s=128&d=identicon&r=PG&f=1", "display_name": "sam91", "link": "https://stackoverflow.com/users/8679582/sam91"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1565203573, "post_id": 57400372, "comment_id": 101282709, "body": "@chris, the full structure of function is: <code>int getResource(void **handle, uint32_t vector)</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1565203589, "post_id": 57400372, "comment_id": 101282718, "body": "@st91 A static function doesn&#39;t belong to an instance of the class, so you don&#39;t need to bind it to anything (give it state).  A member function belongs to an instance, so you have to bind it to an instance (it has state).  You can easily get a <code>void(*)(base*)</code> from <code>print</code> without using bind.  That doesn&#39;t match <code>void(*)()</code> though, so you&#39;re still out of luck if that is what the C API wants."}, {"owner": {"reputation": 13563, "user_id": 992490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac727873c5724326c84ed245faa9fe6c?s=128&d=identicon&r=PG", "display_name": "Marshall Clow", "link": "https://stackoverflow.com/users/992490/marshall-clow"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1565203666, "post_id": 57400372, "comment_id": 101282755, "body": "@st91 - I think that @NathanOliver said clearly; if you have a functor that has state, you&#39;re not going to be able to convert that to a plain old function pointer; i.e <code>void(*)()</code>"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1565203733, "post_id": 57400372, "comment_id": 101282788, "body": "There&#39;s no clean way to do that. A function pointer is just that, 8 bytes or whatever storing an address of a function. There&#39;s no room for extra state in there on any system that I know of. The reason I ask about the API is that there&#39;s still a chance it could pass user data through by other means. For example, the Windows API passes state into the window procedure as data part of the call done on window creation. It&#39;s conceivable that there&#39;s an API out there that does user state through global state accessed from the callback. It&#39;s hard to decide without all the info."}, {"owner": {"reputation": 47, "user_id": 8679582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccfff8ec1d6b5b3e70cab10279a27484?s=128&d=identicon&r=PG&f=1", "display_name": "sam91", "link": "https://stackoverflow.com/users/8679582/sam91"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1565204394, "post_id": 57400372, "comment_id": 101283143, "body": "@chris, thanks. Is it possible to convert <code>std::function&lt;void()&gt;</code> to <code>void(*)()</code> anyway?"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1565204686, "post_id": 57400372, "comment_id": 101283280, "body": "No, <code>std::function</code> is a type-erased function. For example, the result of your <code>bind</code> call. It stores that functor as well as what it needs for destroying, copying, and moving the stored function. Any conversion to a function pointer that needs extra data will need a separate place for the data. If the API doesn&#39;t provide designated space for the data, you have to provide your own. There&#39;s simply no good place to put it. It&#39;s far from ideal, but the API author should have known that when designing it this way."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 2, "creation_date": 1565204829, "post_id": 57400372, "comment_id": 101283339, "body": "That said, I&#39;m intrigued why the parameter is a <code>void**</code> and how the API says this parameter is supposed to be used."}, {"owner": {"reputation": 47, "user_id": 8679582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccfff8ec1d6b5b3e70cab10279a27484?s=128&d=identicon&r=PG&f=1", "display_name": "sam91", "link": "https://stackoverflow.com/users/8679582/sam91"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1565205027, "post_id": 57400372, "comment_id": 101283418, "body": "@chris, thanks for your explanation. <code>void**</code> in the external api is used to register an event handler with the test operating system."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1565207922, "post_id": 57400372, "comment_id": 101284607, "body": "@st91 does the external API allow you to pass any kind of user-defined value to the function you give it?  If so, then use that value to pass your object&#39;s <code>this</code> pointer to a free-floating function or class <code>static</code> method. That is the most common and preferred way to use C++ non-static class methods with C-based callback APIs (there are other ways, such as using thunks)."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 8679582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccfff8ec1d6b5b3e70cab10279a27484?s=128&d=identicon&r=PG&f=1", "display_name": "sam91", "link": "https://stackoverflow.com/users/8679582/sam91"}, "edited": false, "score": 0, "creation_date": 1565978900, "post_id": 57496130, "comment_id": 101524623, "body": "That totally makes sense. Thanks for the explaination @Dmitry Gordon"}], "tags": [], "owner": {"reputation": 2151, "user_id": 5902079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4df4530b8e41c66ac12d17f96cd70c6c?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Gordon", "link": "https://stackoverflow.com/users/5902079/dmitry-gordon"}, "is_accepted": false, "score": 3, "last_activity_date": 1566071139, "last_edit_date": 1566071139, "creation_date": 1565790835, "answer_id": 57496130, "question_id": 57400372, "link": "https://stackoverflow.com/questions/57400372/unable-to-convert-return-value-of-stdbind-to-void-function-pointer/57496130#57496130", "title": "unable to convert return value of std::bind to void function pointer", "body": "<p>Unfortunately you can't convert the result of <code>std::bind</code> to a function pointer and the reasons are quite simple. Let's try to imagine how <code>std::bind</code> could work. You have a function which takes some argument and a value and you want to get something callable that can be called without parameters. The only possible way to do it without generating new code in run-time is to create a functional object which stores the original function and the bound argument with overloaded <code>operator()</code>. Actually <code>std::_Bind_helper</code> is very similar to this description. </p>\n\n<p>So as a result you get an object of some type which has some members. So it cannot be somehow converted to a pointer to the function which cannot store any arguments.</p>\n"}], "owner": {"reputation": 47, "user_id": 8679582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccfff8ec1d6b5b3e70cab10279a27484?s=128&d=identicon&r=PG&f=1", "display_name": "sam91", "link": "https://stackoverflow.com/users/8679582/sam91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1566071139, "creation_date": 1565202606, "question_id": 57400372, "link": "https://stackoverflow.com/questions/57400372/unable-to-convert-return-value-of-stdbind-to-void-function-pointer", "title": "unable to convert return value of std::bind to void function pointer", "body": "<p>I am new to functional library. I want to bind a static class method with the object of the class and return a void pointer to the function. I tried using std::bind but it cannot convert a class member function to free floating pointer to the function</p>\n\n<p>Here is a test code that I have:</p>\n\n<pre><code>class base{\n    void (*fn)();\n    int m_var;\npublic:\n    base(int var): fn(std::bind(print, this)), m_var(var){\n        std::cout &lt;&lt; \"base ctor\\n\";\n        fn(); //something like this. fn should be a void pointer to the function.\n    }\n\n    static void print(base *b){\n        std::cout &lt;&lt; b-&gt;m_var &lt;&lt; \"\\n\";\n    }\n};\n\nint main(){\n    base *b = new base(5);\n    return 0;\n}\n\n</code></pre>\n\n<p>This is the error I get:</p>\n\n<pre><code>error: cannot convert \u2018std::_Bind_helper&lt;false, void (&amp;)(base*), base*&gt;::type\u2019 {aka \u2018std::_Bind&lt;void (*(base*))(base*)&gt;\u2019} to \u2018void (*)()\u2019 in initialization\n</code></pre>\n\n<p>I know that I cannot convert class member to a free floating function, but I need the return type of std::bind to be a void pointer as that is an input to one of the external libraries I am using. Any help/suggestion is appreciated.</p>\n"}, {"tags": ["c++", "pointers", "variadic-functions"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1565202055, "post_id": 57400206, "comment_id": 101282026, "body": "Don&#39;t use raw arrays or pointers with c++ code. Use <code>std::array</code>, <code>std::vector</code>, or smart pointers."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1565202219, "post_id": 57400206, "comment_id": 101282099, "body": "<code>int p[degree];</code> -- This is not valid C++.  Dynamic arrays in C++ are done by using <code>std::vector</code>, as specified in the comment by @\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6"}, {"owner": {"reputation": 31, "user_id": 4744302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a507b012f96ea34d5aa6d6ffda0ea71?s=128&d=identicon&r=PG&f=1", "display_name": "Blueper", "link": "https://stackoverflow.com/users/4744302/blueper"}, "edited": false, "score": 0, "creation_date": 1565202296, "post_id": 57400206, "comment_id": 101282124, "body": "I&#39;m trying to understand the results more than I&#39;m trying to fix the problem. I know I can just use vectors but I&#39;d prefer to know <i>why</i> that solution works and mine doesn&#39;t."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1565202360, "post_id": 57400206, "comment_id": 101282146, "body": "@Blueper And to see why it works or does not work, one may want to actually compile your code and run it.  Thus syntax does matter."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1565202477, "post_id": 57400206, "comment_id": 101282201, "body": "@Blueper Well, let&#39;s start with that <code>int p[degree];</code> isn&#39;t valid c++ standard code."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1565202696, "post_id": 57400206, "comment_id": 101282293, "body": "&quot;I&#39;m trying to understand the results more than I&#39;m trying to fix the problem&quot; - Trying to reason about the behaviour of broken code is an effort in futility."}, {"owner": {"reputation": 31, "user_id": 4744302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a507b012f96ea34d5aa6d6ffda0ea71?s=128&d=identicon&r=PG&f=1", "display_name": "Blueper", "link": "https://stackoverflow.com/users/4744302/blueper"}, "edited": false, "score": 0, "creation_date": 1565203047, "post_id": 57400206, "comment_id": 101282474, "body": "I mean, the code does compile. It might not be &quot;valid&quot; c++ but the compiler does something with it and I&#39;m trying to understand what that something is."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1565203758, "post_id": 57400206, "comment_id": 101282803, "body": "@Blueper <i>I mean, the code does compile</i> -- All the persons using Visual Studio have a bewildered look."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4744302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a507b012f96ea34d5aa6d6ffda0ea71?s=128&d=identicon&r=PG&f=1", "display_name": "Blueper", "link": "https://stackoverflow.com/users/4744302/blueper"}, "edited": false, "score": 0, "creation_date": 1565202654, "post_id": 57400292, "comment_id": 101282270, "body": "Ah, beautiful explanation. Thank you very much! That makes perfect sense.  The requirements stem from my own stubbornness rather than any assignment ^^&quot; I just wanted to get a better grasp for how the compiler works.  Thanks again!"}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1565202286, "creation_date": 1565202286, "answer_id": 57400292, "question_id": 57400206, "link": "https://stackoverflow.com/questions/57400206/passing-class-with-array-member-into-overload-of-function-that-uses-that-array-m/57400292#57400292", "title": "Passing class with array member into overload of function that uses that array member", "body": "<p>The problem is these two lines:</p>\n\n<pre><code>int p[degree];\n</code></pre>\n\n<p>and</p>\n\n<pre><code>_terms = p;\n</code></pre>\n\n<p>The first (besides not being a non-portable <a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">variable-length array</a> extension of your compiler) defined <code>p</code> to be a <strong><em>local</em></strong> variable.</p>\n\n<p>The second line makes <code>_terms</code> point to the first element of this array.</p>\n\n<p>Then the constructor ends, and the life-time of <code>p</code> with it, leaving you with an invalid pointer in <code>_terms</code>.</p>\n\n<p>The natural solution is to use <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code></a> instead. And if you need to use pointers (because assignment/exercise requirements) you need to use dynamic allocation (using <code>new[]</code>, and also then you need to learn about <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">the rule of three/five</a>).</p>\n"}], "owner": {"reputation": 31, "user_id": 4744302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a507b012f96ea34d5aa6d6ffda0ea71?s=128&d=identicon&r=PG&f=1", "display_name": "Blueper", "link": "https://stackoverflow.com/users/4744302/blueper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1565202286, "creation_date": 1565201953, "question_id": 57400206, "link": "https://stackoverflow.com/questions/57400206/passing-class-with-array-member-into-overload-of-function-that-uses-that-array-m", "title": "Passing class with array member into overload of function that uses that array member", "body": "<p>I'm trying to implement a polynomial class consisting of an int (degree) and an integer array (the coefficients for each term). I have a function to print the polynomial, which works fine when I pass in the degree and term array directly, but things get funky when I try to put those values into an instance of my polynomial class.</p>\n\n<p>I am using variadic arguments in the polynomial's constructor, such that you should be able to call polynomial(degree, ). I made sure to output each term in my va_list so I know I'm targeting what I want to.</p>\n\n<p>Here's my class:</p>\n\n<pre><code>class polynomial{\n    public:\n        polynomial(int degree...){\n            va_list args;\n            _degree = degree;\n            int p[degree];\n            va_start(args,degree);\n            for(int i = 0; i &lt; degree; i++){\n                p[i] = va_arg(args,int);\n                cout &lt;&lt; p[i] &lt;&lt; endl; //just to verify that I'm grabbing the right values.\n            }\n            va_end(args);\n            _terms = p;\n        }\n        int degree(){return _degree;}\n        int* terms(){return _terms;}\n    private:\n        int _degree;\n        int* _terms;\n};\n</code></pre>\n\n<p>And here's the function(s) I'm using to print the polynomial:</p>\n\n<pre><code>void printArray(int*p, int l){\n    std::cout &lt;&lt; \"[\";\n    for(int i = 0; i &lt; l; i++){\n        std::cout &lt;&lt; p[i];\n        if(i != l-1) std::cout &lt;&lt; \",\";\n    }    \n    std::cout &lt;&lt; \"]\" &lt;&lt; std::endl;\n}\nvoid printArray(polynomial p){ \n    printArray(p.terms(), p.degree());\n}\n</code></pre>\n\n<p>my main function:</p>\n\n<pre><code>int main()\n{\n    int a[3] = {2,5,3};\n    printArray(a,3);\n    polynomial p1(3,2,5,3);\n    printArray(p1.terms(), p1.degree());\n    printArray(p1);\n    return 0;\n}\n</code></pre>\n\n<p>and the output:</p>\n\n<pre><code>[2,5,3]\n2\n5\n3\n[2,0,94004573]\n[1,0,1]\n\n</code></pre>\n\n<p>As you can see, I call printArray() 3 times. The first time, I directly create an integer array and pass it and its length into printArray(). This time, it works fine, outputting [2,5,3] as expected. The second time, I again use the first implementation of printArray(), but this time I pass in the int* and int from an instance of my polynomial. This time, I get some array whose first two elements always seem to be 0 and 2 and whose last value is some garbage value.\nThe third time, I simply pass in the polynomial to the second implementation of printArray(). This seems to output [1,0,1] consistently (which is of course incorrect).</p>\n\n<p>I suppose it wouldn't be too confusing if the second and third calls to printArray() generated the same garbage values, but as it stands, I am fairly lost in terms of what's happening behind the scene. Any help at all would be appreciated. Thank you!</p>\n"}, {"tags": ["c++", "qt", "qtwebkit"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11897725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04eae7b252e5647fd4d308466e697b8?s=128&d=identicon&r=PG&f=1", "display_name": "Faberix", "link": "https://stackoverflow.com/users/11897725/faberix"}, "is_accepted": true, "score": 0, "last_activity_date": 1565717531, "creation_date": 1565717531, "answer_id": 57482693, "question_id": 57400183, "link": "https://stackoverflow.com/questions/57400183/loading-webpages-in-local-network-using-qwebview/57482693#57482693", "title": "Loading Webpages in local network using QWebView", "body": "<p>I have found a workaround: I now use a QWebEngineView instead of a QWebView and it works. I have no idea why it didn't using a QWebView...</p>\n"}], "owner": {"reputation": 1, "user_id": 11897725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04eae7b252e5647fd4d308466e697b8?s=128&d=identicon&r=PG&f=1", "display_name": "Faberix", "link": "https://stackoverflow.com/users/11897725/faberix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 57482693, "answer_count": 1, "score": 0, "last_activity_date": 1565717531, "creation_date": 1565201835, "last_edit_date": 1565252938, "question_id": 57400183, "link": "https://stackoverflow.com/questions/57400183/loading-webpages-in-local-network-using-qwebview", "title": "Loading Webpages in local network using QWebView", "body": "<p>I am writing a program that uses a QWebView to display a webpage hosted on a server within the local network. Unfortunatly, it does not work with any local webpage (e.g. 192.168.1.1).</p>\n\n<p>One webpage in the network is also acessible from outside (using dyndns). Accessing that page works, if I do so using the dyndns url (as it does with any remote webpage such as www.qwant.com), but not if I use it's local ip. Using Firefox, all those local pages were loaded successfully.</p>\n\n<p>This is my code that should display the page:</p>\n\n<pre><code>QNetworkProxyFactory::setUseSystemConfiguration(true);\nui-&gt;webView-&gt;load(settings.value(SETTINGS_KEY_URL).toUrl());\nui-&gt;webView-&gt;show();\n</code></pre>\n\n<p>I added the setUseSystemConfiguration(true) after I read <a href=\"https://forum.qt.io/topic/18231/qtwebkit-can-not-display-image-in-case-of-local-network-path\" rel=\"nofollow noreferrer\">https://forum.qt.io/topic/18231/qtwebkit-can-not-display-image-in-case-of-local-network-path</a>, but it did not solve my problem.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1565202207, "post_id": 57400153, "comment_id": 101282097, "body": "<code>void overloaded_function(std::string&amp;&amp; param)</code> - here <code>param</code> has a name, so it&#39;s a lvalue. Without <code>std::move</code> or <code>std::forward</code> to cast it back to a rvalue ref, it will remain lvalue."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1565202392, "post_id": 57400263, "comment_id": 101282167, "body": "A mention of <a href=\"https://stackoverflow.com/questions/13725747/concise-explanation-of-reference-collapsing-rules-requested-1-a-a-2\">reference collapsing</a> (not the best link, but all I could find in a minute) might also be in order."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 2, "last_activity_date": 1565202150, "creation_date": 1565202150, "answer_id": 57400263, "question_id": 57400153, "link": "https://stackoverflow.com/questions/57400153/role-of-stdforward/57400263#57400263", "title": "Role of std::forward", "body": "<p>The problem is that in</p>\n\n<pre><code>template &lt;typename T&gt;\nvoid pass_through(T&amp;&amp; param) {\n    overloaded_function(param);\n}\n</code></pre>\n\n<p><code>param</code> is a named variable.  Since it has a name, it is an lvalue, even though it is a reference to an rvalue.  Since it is an lvalue, you call the lvalue function.</p>\n\n<p>You need <code>std::forward</code> to \"re-cast\" it back into a rvalue if it came in as an rvalue.</p>\n\n<hr>\n\n<p>Also note that <code>T</code> is not <code>string&amp;&amp;</code>.  Since you passed a <code>string&amp;&amp;</code>, <code>T&amp;&amp;</code> deduces <code>T</code> to <code>string</code> and the <code>&amp;&amp;</code> is kept to make it an rvalue reference.</p>\n"}], "owner": {"reputation": 935, "user_id": 9225379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b56343fbe3088bb85db6759811b36685?s=128&d=identicon&r=PG&f=1", "display_name": "EnDelt64", "link": "https://stackoverflow.com/users/9225379/endelt64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 57400263, "answer_count": 1, "score": 1, "last_activity_date": 1565202150, "creation_date": 1565201698, "question_id": 57400153, "link": "https://stackoverflow.com/questions/57400153/role-of-stdforward", "title": "Role of std::forward", "body": "<p>Following is the code brought from <a href=\"https://stackoverflow.com/questions/3582001/advantages-of-using-forward\">this question</a>.</p>\n\n<pre><code>// [I]\nvoid overloaded_function(const std::string&amp; param) {\n    std::cout &lt;&lt; \"const std::string&amp; version: \" &lt;&lt; param &lt;&lt; '\\n';\n}\n\n// [II]\nvoid overloaded_function(std::string&amp;&amp; param) {\n    std::cout &lt;&lt; \"std::string&amp;&amp; version: \" &lt;&lt; param &lt;&lt; '\\n';\n}\n\ntemplate &lt;typename T&gt;\nvoid pass_through_f(T&amp;&amp; param) {\n    overloaded_function(std::forward&lt;T&gt;(param));\n}\n\ntemplate &lt;typename T&gt;\nvoid pass_through(T&amp;&amp; param) {\n    overloaded_function(param);\n}\n\nint main() {\n    std::string str = \"Hello World\";\n\n    pass_through_f(str);            // (1)\n    pass_through_f(std::move(str)); // (2)\n\n    std::cout &lt;&lt; \"----------\\n\";\n\n    pass_through(str);              // (3)\n    pass_through(std::move(str));   // (4)\n\n    return 0;\n}\n</code></pre>\n\n<pre><code>const std::string&amp; version: Hello World\nstd::string&amp;&amp; version: Hello World\n----------\nconst std::string&amp; version: Hello World\nconst std::string&amp; version: Hello World\n</code></pre>\n\n<p>When I use <code>pass_through_f()</code>, the result between <code>(1)</code> and <code>(2)</code> is different but they are same when <code>pass_though()</code> is called.</p>\n\n<p>My question is, how is the result of <code>(4)</code> same with <code>(3)</code>? Here's type inferencing process that I thought:</p>\n\n<ol>\n<li><p>In <code>(4)</code>, return value of some function is r-value, so <code>T</code> of <code>pass_through()</code> is inferred as a type same with passed argument. Thus <code>T</code> is <code>std::string&amp;&amp;</code>.</p></li>\n<li><p><code>std::string&amp;&amp;</code> is r-value reference, and r-value reference is r-value so it calls <code>overloaded_function() [II]</code>. Thus its result is same with when <code>std::forward</code> is used.</p></li>\n</ol>\n\n<p>But result is different with my thought. I think I'm misunderstanding something about the way <code>std::forward</code> works.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 3, "creation_date": 1565200051, "post_id": 57399767, "comment_id": 101281217, "body": "<code>for (int i : arr) {</code> the problem is the size of arr is unknown. It decays into a pointer."}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 9, "creation_date": 1565200056, "post_id": 57399767, "comment_id": 101281219, "body": "Your array doesn&#39;t have a size so for each can&#39;t work, use a <code>std::vector</code> or <code>std::array</code> instead"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 4, "creation_date": 1565200058, "post_id": 57399767, "comment_id": 101281221, "body": "You are victim of <a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\"><code>arr</code> decaying to a pointer</a>."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1565200157, "post_id": 57399767, "comment_id": 101281257, "body": "Use <code>std::array&lt;int&gt;</code>, not dumb, regular arrays.  Then you wouldn&#39;t have the issue you are seeing now."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2201041"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565200461, "post_id": 57399767, "comment_id": 101281387, "body": "@user4581301 Well the very question OP linked is a pretty good dupe as far as content. Maybe it could use a clearer answer (that mentions containers for example) though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2201041"}, "edited": false, "score": 0, "creation_date": 1565200496, "post_id": 57399767, "comment_id": 101281401, "body": "@James Lee The answer is the question you linked is more or less what I would have said... Can you be more specific about what parts of it you&#39;re struggling with?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1565200598, "post_id": 57399767, "comment_id": 101281445, "body": "Avoid raw C-style arrays. Use <code>std::array</code> or <code>std::vector</code> <i>always</i>."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565203557, "post_id": 57399767, "comment_id": 101282701, "body": "For more information , the blurb for range_expression in <a href=\"https://en.cppreference.com/w/cpp/language/range-for\" rel=\"nofollow noreferrer\">cppreference&#39;s page on range-based for</a> describes where the <code>begin</code> and <code>end</code> not being declared in the error messages come from. Pointers cannot have an <code>end</code> because of the lack of size, and what&#39;s the point of <code>begin</code> without <code>end</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 4, "creation_date": 1565201064, "post_id": 57399909, "comment_id": 101281642, "body": "&quot;If you wanna get fancy, you can also use the &lt;algorithm&gt; library&quot; - I wouldn&#39;t call that &quot;getting fancy&quot;, I would call that &quot;getting <i>sensible</i>&quot;."}, {"owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1565201340, "post_id": 57399909, "comment_id": 101281729, "body": "I think you&#39;re right. I updated the post to better explain and introduce <code>accumulate</code>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1565201599, "post_id": 57399909, "comment_id": 101281840, "body": "What if the vector is empty?  Oops, a division by 0."}, {"owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "edited": false, "score": 0, "creation_date": 1565202198, "post_id": 57399909, "comment_id": 101282091, "body": "That\u2019ll produce a NaN value, which I feel is an acceptable return value for a function taking the average of an empty list"}, {"owner": {"reputation": 3371, "user_id": 358277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e79ce9b4a8f96291d88217102ba10ed2?s=128&d=identicon&r=PG", "display_name": "Fabio Fracassi", "link": "https://stackoverflow.com/users/358277/fabio-fracassi"}, "edited": false, "score": 1, "creation_date": 1565202861, "post_id": 57399909, "comment_id": 101282366, "body": "Instead of c-array and size you can use <a href=\"https://en.cppreference.com/w/cpp/container/span\" rel=\"nofollow noreferrer\">std::span</a> which landed in C++20 (or use a backport)"}], "tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": true, "score": 4, "last_activity_date": 1565206290, "last_edit_date": 1592644375, "creation_date": 1565200589, "answer_id": 57399909, "question_id": 57399767, "link": "https://stackoverflow.com/questions/57399767/how-to-fix-for-each-loop-in-c/57399909#57399909", "title": "How to fix for each loop in C++?", "body": "<p>The type <code>int arr[]</code> decays into a raw pointer, and as a result there's no way to get the size of the array it refers to.</p>\n<p>Instead of using raw arrays, it'd be better just to use either <code>std::vector</code>:</p>\n<pre><code>double avg(std::vector&lt;int&gt; const&amp; v) {\n    double sum = 0;\n    for(int i : v) \n        sum += i;\n    return sum / v.size();\n}\n</code></pre>\n<p>Or <code>std::array</code>, which acts like a C-array but is copyable and doesn't decay into a pointer:</p>\n<pre><code>template&lt;size_t N&gt;\ndouble avg(std::array&lt;int, N&gt; const&amp; arr) {\n    double sum = 0;\n    for(int i : arr) {\n        sum += i;\n    return sum / N;\n}\n</code></pre>\n<p>Or, if you really have to use arrays, pass the size as a parameter:</p>\n<pre><code>double avg(int arr[], size_t size) {\n    double sum = 0;\n    for(int i = 0; i &lt; size; i++) {\n        sum += arr[i];\n    }\n    return sum / size;\n}\n</code></pre>\n<h3>Leveraging the C++ standard library</h3>\n<p>The C++ standard library has a lot of useful functions, and one of them, <code>accumulate</code>, does the job perfectly. It takes a begin and end iterator, as well as the initial value, and computes the sum over the range:</p>\n<pre><code>#include &lt;numeric&gt;\n\ndouble avg(std::vector&lt;int&gt; const&amp; v) {\n    return std::accumulate(v.begin(), v.end(), 0.0) / v.size();\n}\n\ndouble avg(int[] arr, size_t size) {\n    return std::accumulate(arr + 0, arr + size, 0.0) / size;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "is_accepted": false, "score": 3, "last_activity_date": 1565200813, "creation_date": 1565200813, "answer_id": 57399965, "question_id": 57399767, "link": "https://stackoverflow.com/questions/57399767/how-to-fix-for-each-loop-in-c/57399965#57399965", "title": "How to fix for each loop in C++?", "body": "<p>Functions may not take arrays as parameters. You get a pointer there. Though you can pass a reference to an array to a function as a parameter. Here is an example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\ntemplate &lt;typename T, auto n&gt;\nvoid print(const T(&amp;arr)[n]) {\n  for (auto&amp;&amp; t : arr) {\n    std::cout &lt;&lt; t &lt;&lt; ' ';\n  }\n  std::cout &lt;&lt; '\\n';\n}\n\nint main() {\n  int arr[]{ 1, 2, 3, 4, 5 };\n  print(arr);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 2 3 4 5\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3035, "user_id": 1413244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BaB5H.png?s=128&g=1", "display_name": "jwezorek", "link": "https://stackoverflow.com/users/1413244/jwezorek"}, "is_accepted": false, "score": 1, "last_activity_date": 1565201227, "creation_date": 1565201227, "answer_id": 57400058, "question_id": 57399767, "link": "https://stackoverflow.com/questions/57399767/how-to-fix-for-each-loop-in-c/57400058#57400058", "title": "How to fix for each loop in C++?", "body": "<p>If you want to actually pass an array, not switch to using a vector you can do it with a template function parametrized on the size of the array i.e.</p>\n\n<pre><code>template &lt;int N&gt;\ndouble avg(int (&amp;arr)[N] ) {\n    double sum = 0;\n    int size = 0;\n    for (int i : arr) {\n        sum += i;\n        size += 1;\n    }\n    return sum / size;\n}\n\nint main()\n{\n    int ary[] = { 1,2,3,4,5,6 };\n\n    std::cout &lt;&lt; avg(ary);\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 11897633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea0a75b3e85b5da358226383732c1d6?s=128&d=identicon&r=PG&f=1", "display_name": "James Lee", "link": "https://stackoverflow.com/users/11897633/james-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 57399909, "answer_count": 3, "score": 1, "last_activity_date": 1565206290, "creation_date": 1565199930, "question_id": 57399767, "link": "https://stackoverflow.com/questions/57399767/how-to-fix-for-each-loop-in-c", "title": "How to fix for each loop in C++?", "body": "<p>I'm currently trying to program a function that would find the average of elements in an array of integers in C++.</p>\n\n<p>I've looked at <a href=\"https://stackoverflow.com/questions/28853974/new-c11-for-loop-causes-error-begin-was-not-declared-in-this-scope\">new c++11 for loop causes: &quot;error: \u2018begin\u2019 was not declared in this scope&quot;</a> but I don't quite understand the problem and how to fix it.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>double avg(int arr[]) {\n    double sum = 0;\n    int size = 0;\n    for (int i : arr) {\n        sum += i;\n        size += 1;\n    }\n    return sum / size;\n}\n</code></pre>\n\n<p>It gives me errors that \"'begin' was not declared in this scope\" and \"'end' was not declared in this scope\".\nCould somebody explain why the error is occurring and possible ways to fix it?</p>\n"}, {"tags": ["c++", "record", "realsense"], "comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565200875, "post_id": 57399755, "comment_id": 101281557, "body": "Is this on Windows? If so, either your program or some other program has the file open I assume. Try this: Add a <code>{</code> before <code>rs2::config cfg;</code> and add a <code>}</code> after <code>pipe-&gt;stop();</code> to see if it&#39;s closed when all the <code>rs2</code> variables goes out of scope."}, {"owner": {"reputation": 31, "user_id": 7158314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ea64f7a464b8c71b643d9e388b40018?s=128&d=identicon&r=PG&f=1", "display_name": "Gytis Bernotas", "link": "https://stackoverflow.com/users/7158314/gytis-bernotas"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565254584, "post_id": 57399755, "comment_id": 101298038, "body": "@TedLyngmo Yes, this is Windows, but I don&#39;t see any reason why it would be different for other OS. In any case, I added curly brackets as suggested and this seems to do the trick. Thanks!"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565259492, "post_id": 57399755, "comment_id": 101300858, "body": "You&#39;re welcome! The difference is that in Posix systems you&#39;d be able to rename the file while it is open."}], "answers": [{"comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565259406, "post_id": 57408812, "comment_id": 101300811, "body": "Great, now you just need to figure out which one of the objects it is that kept the file open and see if there&#39;s a way to make it close the file without scoping that object out."}], "tags": [], "owner": {"reputation": 31, "user_id": 7158314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ea64f7a464b8c71b643d9e388b40018?s=128&d=identicon&r=PG&f=1", "display_name": "Gytis Bernotas", "link": "https://stackoverflow.com/users/7158314/gytis-bernotas"}, "is_accepted": false, "score": 1, "last_activity_date": 1565268094, "last_edit_date": 1565268094, "creation_date": 1565254724, "answer_id": 57408812, "question_id": 57399755, "link": "https://stackoverflow.com/questions/57399755/cannot-rename-rosbag-file-after-recording/57408812#57408812", "title": "Cannot rename rosbag file after recording", "body": "<p>As suggested by @TedLyngmo, adding curly brackets allowed me to change the filename on the fly. Code as follows:</p>\n\n<pre><code>\nint main(int argc, char* argv[])\n{\n    {\n        rs2::config cfg;\n        rs2::device device;\n        auto pipe = std::make_shared&lt;rs2::pipeline&gt;();\n\n        cfg.disable_all_streams();\n        cfg.enable_stream(RS2_STREAM_DEPTH, 640, 480, RS2_FORMAT_Z16, 30);\n\n        cfg.enable_record_to_file(\"tmp.bag\");\n        pipe-&gt;start(cfg);\n        device = pipe-&gt;get_active_profile().get_device();\n        std::this_thread::sleep_for(std::chrono::milliseconds(1000));\n        device.as&lt;rs2::recorder&gt;().pause();\n        pipe-&gt;stop();\n    }\n    int res = std::rename(\"tmp.bag\", \"test.bag\");\n    if (res == 0)\n        std::cout &lt;&lt; \"File successfully renamed\" &lt;&lt; std::endl;\n    else\n        std::cout &lt;&lt; \"Error renaming file\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>I studied <a href=\"https://dev.intelrealsense.com/docs/rs-record-playback\" rel=\"nofollow noreferrer\">rs-record-playback</a> a bit more and the code below fixes the renaming issue. </p>\n\n<pre><code>\nint main(int argc, char* argv[]) \n{\n    rs2::device device;\n    auto pipe = std::make_shared&lt;rs2::pipeline&gt;();\n\n    pipe-&gt;start();\n    device = pipe-&gt;get_active_profile().get_device();\n\n    if (!device.as&lt;rs2::recorder&gt;())\n    {\n        pipe-&gt;stop(); // Stop the pipeline with the default configuration\n        pipe = std::make_shared&lt;rs2::pipeline&gt;();\n\n        rs2::config cfg;\n        cfg.disable_all_streams();\n        cfg.enable_stream(RS2_STREAM_DEPTH, 640, 480, RS2_FORMAT_Z16, 30);\n        cfg.enable_record_to_file(\"tmp.bag\");\n\n        pipe-&gt;start(cfg); \n        device = pipe-&gt;get_active_profile().get_device();\n    }\n    // record for 1 sec, if conditions can be added to check if recorder is initialised \n    std::this_thread::sleep_for(std::chrono::milliseconds(1000));\n\n    // if condition can be added to check if recording has been completed\n    pipe-&gt;stop();\n    pipe = std::make_shared&lt;rs2::pipeline&gt;(); // reset the shared pointer\n\n    pipe-&gt;start();\n    device = pipe-&gt;get_active_profile().get_device();\n\n    int res = std::rename(\"tmp.bag\", \"testing.bag\");\n    if (res == 0)\n        std::cout &lt;&lt; \"File successfully renamed\" &lt;&lt; std::endl;\n    else\n        std::cout &lt;&lt; \"Error renaming file\" &lt;&lt; std::endl;\n\n    pipe-&gt;stop();\n    pipe = std::make_shared&lt;rs2::pipeline&gt;();\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7158314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ea64f7a464b8c71b643d9e388b40018?s=128&d=identicon&r=PG&f=1", "display_name": "Gytis Bernotas", "link": "https://stackoverflow.com/users/7158314/gytis-bernotas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565268094, "creation_date": 1565199878, "question_id": 57399755, "link": "https://stackoverflow.com/questions/57399755/cannot-rename-rosbag-file-after-recording", "title": "Cannot rename rosbag file after recording", "body": "<p>I would like to record a rosbag file with a specific name; however, I only know it after the recording is halfway done, so I cannot set the filename here:</p>\n\n<pre><code>cfg.enable_record_to_file(\"some/path/filename.bag\");\n</code></pre>\n\n<p>I have tried to rename the new file as shown below without satisfactory success. I have also used std::experimental::filesystem::rename, with the same outcome. What did work was to record a second video (on the fly) and only then rename the first. This indicates that the (both) rename functions work, but I cannot change the filename it as it seems the file is still open in my current program. </p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n    rs2::config cfg;\n    rs2::device device;\n    auto pipe = std::make_shared&lt;rs2::pipeline&gt;();\n\n    cfg.disable_all_streams();\n    cfg.enable_stream(RS2_STREAM_DEPTH, 640, 480, RS2_FORMAT_Z16, 30);\n\n    cfg.enable_record_to_file(\"tmp.bag\");\n    pipe-&gt;start(cfg);\n    device = pipe-&gt;get_active_profile().get_device();\n    std::this_thread::sleep_for(std::chrono::milliseconds(1000));\n    device.as&lt;rs2::recorder&gt;().pause();\n    pipe-&gt;stop();\n\n    int res = std::rename(\"tmp.bag\", \"test.bag\");\n    if (res == 0)\n        std::cout &lt;&lt; \"File successfully renamed\" &lt;&lt; std::endl;\n    else\n        std::cout &lt;&lt; \"Error renaming file\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>I wonder how to 'unload' the produced video from the pipeline (pipe->stop() did not work), so I can rename the generated rosbag files on the fly.</p>\n"}, {"tags": ["c++", "linux", "assembly", "floating-point", "x86-64"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1565199748, "post_id": 57399669, "comment_id": 101281064, "body": "Stepped through it in the debugger?"}, {"owner": {"reputation": 129, "user_id": 11470640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5189e54a5bf827efbb9939ff29b9abff?s=128&d=identicon&r=PG&f=1", "display_name": "BackSpace7777777", "link": "https://stackoverflow.com/users/11470640/backspace7777777"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1565199911, "post_id": 57399669, "comment_id": 101281149, "body": "Indeed, it seems that cvtss2sd xmm0,xmm0 is right after the call. Any idea why?"}, {"owner": {"reputation": 1362, "user_id": 1366027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8113fc570a09e03414126d8cda5f971c?s=128&d=identicon&r=PG", "display_name": "pcarter", "link": "https://stackoverflow.com/users/1366027/pcarter"}, "edited": false, "score": 2, "creation_date": 1565200930, "post_id": 57399669, "comment_id": 101281586, "body": "What is the prototype for the <code>floatingPointTest</code> in your C code?"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1565202165, "post_id": 57399669, "comment_id": 101282074, "body": "There are two possibilities here. You have defined the prototype of <code>floatingPointTest</code> to return <code>float</code> instead of <code>double</code> and/or your first parameter to <code>floatingPointTest</code> is wrong. Your assembly code suggests your function take a a <i>C</i> <code>long</code> (quadword in 64-bit GCC) and returns a double. The correct prototype is <code>extern double floatingPointTest(long val);</code>"}, {"owner": {"reputation": 129, "user_id": 11470640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5189e54a5bf827efbb9939ff29b9abff?s=128&d=identicon&r=PG&f=1", "display_name": "BackSpace7777777", "link": "https://stackoverflow.com/users/11470640/backspace7777777"}, "edited": false, "score": 0, "creation_date": 1565202853, "post_id": 57399669, "comment_id": 101282361, "body": "It works now, I had the prototype as returning a float instead of a double. Thanks!"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1565205914, "post_id": 57399669, "comment_id": 101283777, "body": "If an answer solved your problem consider marking this as solved by accepting the answer. The hows and whys of doing so can be found here:  <a href=\"https://meta.stackexchange.com/a/5235/271768\">meta.stackexchange.com/a/5235/271768</a>"}], "answers": [{"tags": [], "owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "is_accepted": true, "score": 2, "last_activity_date": 1565204627, "last_edit_date": 1565204627, "creation_date": 1565202987, "answer_id": 57400454, "question_id": 57399669, "link": "https://stackoverflow.com/questions/57399669/how-to-properly-return-a-double-in-linux-asm/57400454#57400454", "title": "How to properly return a double in linux asm", "body": "<p>You don't show us a critical piece of information - what the <em>C++</em> prototype of the function <code>floatingPointTest</code> that you used was. A couple of things could cause this behaviour. </p>\n\n<ul>\n<li><p>You declared <code>floatingPointTest</code> to take a <code>float</code> or <code>double</code> as the first parameter to the function when it should have been an integer. Your assembly code uses this instruction:</p>\n\n<pre><code>cvtsi2sd    xmm0,rdi\n</code></pre>\n\n<p>We can infer that the first parameter (in <em>RDI</em>) should be a signed <code>long</code> because you use <em>RDI</em> as a source operand and because <a href=\"https://www.felixcloutier.com/x86/cvtsi2sd\" rel=\"nofollow noreferrer\"><code>cvtsi2sd</code></a> with a 64-bit register will convert a signed quadword integer from 64-bit register to a double-precision floating-point value in the destination XMM register.</p></li>\n<li><p>Your prototype was declared to have a return type of <code>float</code> instead of <code>double</code>. Since your assembly code only does math as scalar doubles you need to return a <code>double</code> from the function. </p></li>\n</ul>\n\n<p>A correct prototype for <em>C++</em> could be written as:</p>\n\n<pre><code>extern \"C\" double floatingPointTest(long val);\n</code></pre>\n\n<hr>\n\n<h2>Observations</h2>\n\n<p>Your code doesn't use <em>RBX</em> so there is no need to save/restore it. You don't actually need the stack frame and you can multiply a number by itself by passing the same register as source and destination to <code>mulsd</code>. This code would have done the same thing:</p>\n\n<pre><code>floatingPointTest:\n        cvtsi2sd    xmm0, rdi\n        mulsd       xmm0, xmm0\n        ret\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 11470640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5189e54a5bf827efbb9939ff29b9abff?s=128&d=identicon&r=PG&f=1", "display_name": "BackSpace7777777", "link": "https://stackoverflow.com/users/11470640/backspace7777777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 57400454, "answer_count": 1, "score": 0, "last_activity_date": 1565204627, "creation_date": 1565199434, "last_edit_date": 1565204437, "question_id": 57399669, "link": "https://stackoverflow.com/questions/57399669/how-to-properly-return-a-double-in-linux-asm", "title": "How to properly return a double in linux asm", "body": "<p>When I call the function it returns 0.0000 when it should be returning 25.0000</p>\n\n<p>I've tried looking for similar issues but I could find none. I have tried looking through Intel's manuals and nothing has worked so far.</p>\n\n<p>I call the function through c++</p>\n\n<pre><code>   double t=floatingPointTest(5);\n   printf(\"%f\\n\",t);\n</code></pre>\n\n<p>The asm function:</p>\n\n<pre><code>floatingPointTest:\n        push    rbx\n        push    rbp\n        mov     rbp,rsp\n\n        cvtsi2sd    xmm0,rdi\n        cvtsi2sd    xmm1,rdi\n        mulsd       xmm0,xmm1\n\n        mov     rsp,rbp\n        pop     rbp\n        pop     rbx\n        ret\n</code></pre>\n\n<p>I get 0.0000 even though rdi is 5</p>\n"}, {"tags": ["c++", "opencv", "image-processing"], "comments": [{"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 5, "creation_date": 1565199583, "post_id": 57399559, "comment_id": 101280998, "body": "<a href=\"https://en.wikipedia.org/wiki/Lossy_compression\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Lossy_compression</a>"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 1, "creation_date": 1565199590, "post_id": 57399559, "comment_id": 101281002, "body": "A quick Google search suggests that cvid is the Cinepak codec, see: <a href=\"https://www.loc.gov/preservation/digital/formats/fdd/fdd000062.shtml\" rel=\"nofollow noreferrer\">loc.gov/preservation/digital/formats/fdd/fdd000062.shtml</a>.  Looks like your online tool thought it was a good bet."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 2, "creation_date": 1565199915, "post_id": 57399559, "comment_id": 101281153, "body": "To answer how to make your software robust to these differences, we&#39;ll need some more information. What video analysis techniques are you performing that are so sensitive to this? What methods of adding numeric tolerance are known for that technique and have you tried them? Have you considered using uncompressed video?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1565200070, "post_id": 57399559, "comment_id": 101281227, "body": "Different compression algorithms. Different absolute pixel values. Unless you use <i>lossless</i> compression, the end result <i>is</i> going to be different."}, {"owner": {"reputation": 344, "user_id": 9206602, "user_type": "registered", "profile_image": "https://graph.facebook.com/570699829938009/picture?type=large", "display_name": "Rakeeb Hossain", "link": "https://stackoverflow.com/users/9206602/rakeeb-hossain"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1565200146, "post_id": 57399559, "comment_id": 101281254, "body": "@alterigel My technique involves converting RGB values of pixels to some other quantity and using a summed-area table to check if the average quantity is above a certain threshold. The software detects certain features in video."}], "answers": [{"comments": [{"owner": {"reputation": 450, "user_id": 804705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c55eb43de88ce8994faf61af4877cd11?s=128&d=identicon&r=PG", "display_name": "Dima Mironov", "link": "https://stackoverflow.com/users/804705/dima-mironov"}, "edited": false, "score": 1, "creation_date": 1565204109, "post_id": 57399701, "comment_id": 101282989, "body": ".mp4 and .avi as file extensions refer to container format, and there exist codecs, (codificators, you call them), that can be packed both to .avi and .mp4. (Say MPEG-4 Video)"}], "tags": [], "owner": {"reputation": 1, "user_id": 11740271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a64ad2a9ebaa343ba9d06bcdbe5056d?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Z.", "link": "https://stackoverflow.com/users/11740271/alejandro-z"}, "is_accepted": false, "score": 0, "last_activity_date": 1565199591, "creation_date": 1565199591, "answer_id": 57399701, "question_id": 57399559, "link": "https://stackoverflow.com/questions/57399559/why-does-changing-the-format-of-a-video-change-its-pixel-values/57399701#57399701", "title": "Why does changing the format of a video change its pixel values?", "body": "<p>The answer is acctually curious. The changing values is due to the codifications used to compres the raw video. MP4 use h.264 and AVI uses xvid. The way that every frame I, B and P is processes is slightly different and that make the data in every pixel change a bit.</p>\n"}], "owner": {"reputation": 344, "user_id": 9206602, "user_type": "registered", "profile_image": "https://graph.facebook.com/570699829938009/picture?type=large", "display_name": "Rakeeb Hossain", "link": "https://stackoverflow.com/users/9206602/rakeeb-hossain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1565199591, "creation_date": 1565198954, "question_id": 57399559, "link": "https://stackoverflow.com/questions/57399559/why-does-changing-the-format-of-a-video-change-its-pixel-values", "title": "Why does changing the format of a video change its pixel values?", "body": "<p>I have built a software that analyzes videos using OpenCV and C++, but I've recently noticed a weird ambiguity: </p>\n\n<p>I have two versions of the same video, an MP4 and an AVI converted using an online tool. If I feed both the video files into OpenCV (as VideoCapture objects) and, before any processing at all, if I simply output the value of a certain pixel at (x,y), the pixel values do not match.</p>\n\n<p><strong>Sample code:</strong></p>\n\n<pre><code>    VideoCapture cap(filename);\n\n    if (!cap.isOpened()) return;\n\n    //Load a frame\n    Mat frame;\n    cap &gt;&gt; frame;\n    std::cout &lt;&lt; frame.at&lt;Vec3b&gt;(316,316)[0] &lt;&lt; std::endl;\n</code></pre>\n\n<p><strong>Output for AVI:</strong></p>\n\n<pre><code>176\n</code></pre>\n\n<p><strong>Output for MP4:</strong></p>\n\n<pre><code>159\n</code></pre>\n\n<p>This is problematic for my software and is a curious result. I've noticed that the decompression type of the video changes from cvid (in the AVI) to avc1 (in the MP4). </p>\n\n<p>What is the explanation for these ambiguities and how would someone building video analysis software counteract them?</p>\n"}, {"tags": ["c++", "c++11", "templates", "perfect-forwarding", "template-argument-deduction"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1565198759, "post_id": 57399435, "comment_id": 101280647, "body": "Well, totally depends on the use case :-P ..."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1565198867, "post_id": 57399435, "comment_id": 101280711, "body": "The second case is a universal reference and it forwards both: lvalues as lvalues, rvalues as rvalues."}, {"owner": {"reputation": 7427, "user_id": 293195, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/seTSX.png?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/293195/gabriel"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1565199244, "post_id": 57399435, "comment_id": 101280866, "body": "@SamVarshavchik: The second argument is actually: <code>rvalue_Reference := typename std::remove_reference_t&lt;T&gt;&amp;&amp;</code> and is not a forwarding-reference (universal reference) as far as I know... so your statement is incorrect."}, {"owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "edited": false, "score": 1, "creation_date": 1565201632, "post_id": 57399435, "comment_id": 101281857, "body": "<a href=\"https://stackoverflow.com/questions/56416819/why-forwarding-return-value-is-needed/56417076#56417076\">Possible dupe</a> (Similar question, but I wrote an answer that answers this question too)"}], "answers": [{"tags": [], "owner": {"reputation": 239, "user_id": 11881207, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jJFxAOFQ7gc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regtTcJ6xYD4CLfuqlU3pUD7r7QYw/photo.jpg?sz=128", "display_name": "Okan Barut", "link": "https://stackoverflow.com/users/11881207/okan-barut"}, "is_accepted": true, "score": 1, "last_activity_date": 1565217176, "last_edit_date": 1565217176, "creation_date": 1565213482, "answer_id": 57402538, "question_id": 57399435, "link": "https://stackoverflow.com/questions/57399435/is-forwarding-an-rvalue-as-an-rvalue-a-use-case/57402538#57402538", "title": "Is forwarding an rvalue as an rvalue a use case?", "body": "<p>I believe this is a duplicate of: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/56361755/what-is-the-purpose-of-stdforwards-rvalue-reference-overload\">What is the purpose of std::forward()&#39;s rvalue reference overload?</a></p>\n\n<p>Please also read the included paper: </p>\n\n<p><a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2951.html\" rel=\"nofollow noreferrer\">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2951.html</a></p>\n"}], "owner": {"reputation": 7427, "user_id": 293195, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/seTSX.png?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/293195/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 57402538, "answer_count": 1, "score": 1, "last_activity_date": 1565217176, "creation_date": 1565198330, "last_edit_date": 1565198452, "question_id": 57399435, "link": "https://stackoverflow.com/questions/57399435/is-forwarding-an-rvalue-as-an-rvalue-a-use-case", "title": "Is forwarding an rvalue as an rvalue a use case?", "body": "<p>I am wondering about forwarding:\nThe standard implements <code>std::forward</code> basically with two overloads:</p>\n\n<ol>\n<li>To forward <strong>lvalues</strong> as <strong>lvalues/rvalues</strong> (dep. of <code>T</code>)</li>\n</ol>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename T&gt;\nT&amp;&amp; forward(lvalue_Reference v){ \n    return static_cast&lt;T&amp;&amp;&gt;(v); \n};  \n</code></pre>\n\n<ol start=\"2\">\n<li>To forward <strong>rvalues</strong> as <strong>rvalues</strong></li>\n</ol>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename T&gt;\nT&amp;&amp; forward(rvalue_Reference v){  \n    // static-assert: T is not an lvalue-Reference\n    return static_cast&lt;T&amp;&amp;&gt;(v); \n};  \n</code></pre>\n\n<p>First case comes to play when</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename T&gt;\nvoid foo(T&amp;&amp; a) { doSomething(std::forward&lt;T&gt;(a)); /* a is lvalue -&gt; matches 1. overload */ }\n</code></pre>\n\n<p>The second case makes sense, but what is an example of triggering it?</p>\n"}, {"tags": ["android", "c++", "qt", "qt5", "gstreamer"], "answers": [{"tags": [], "owner": {"reputation": 4401, "user_id": 1281264, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/10501b5548f74ef7aa4100091d8e7fc6?s=128&d=identicon&r=PG", "display_name": "StereoMatching", "link": "https://stackoverflow.com/users/1281264/stereomatching"}, "is_accepted": true, "score": 0, "last_activity_date": 1566134939, "creation_date": 1566134939, "answer_id": 57545036, "question_id": 57399406, "link": "https://stackoverflow.com/questions/57399406/use-gstreamer-to-record-audio-on-androidwith-qt5/57545036#57545036", "title": "Use gstreamer to record audio on android(with Qt5)", "body": "<p>I find out a solution, problem is I did not register appropriate plugins, correct plugins should be</p>\n\n<pre><code>GST_PLUGIN_STATIC_DECLARE(coreelements);\nGST_PLUGIN_STATIC_DECLARE(coretracers);\nGST_PLUGIN_STATIC_DECLARE(adder);\nGST_PLUGIN_STATIC_DECLARE(audioconvert);\nGST_PLUGIN_STATIC_DECLARE(audiomixer);\nGST_PLUGIN_STATIC_DECLARE(audiorate);\nGST_PLUGIN_STATIC_DECLARE(audioresample);\nGST_PLUGIN_STATIC_DECLARE(audiotestsrc);\nGST_PLUGIN_STATIC_DECLARE(typefindfunctions);\nGST_PLUGIN_STATIC_DECLARE(videoconvert);\nGST_PLUGIN_STATIC_DECLARE(videorate);\nGST_PLUGIN_STATIC_DECLARE(videoscale);\nGST_PLUGIN_STATIC_DECLARE(videotestsrc);\nGST_PLUGIN_STATIC_DECLARE(volume);\nGST_PLUGIN_STATIC_DECLARE(autodetect);\nGST_PLUGIN_STATIC_DECLARE(videofilter);\nGST_PLUGIN_STATIC_DECLARE(playback);\nGST_PLUGIN_STATIC_DECLARE(audioparsers);\nGST_PLUGIN_STATIC_DECLARE(auparse);\nGST_PLUGIN_STATIC_DECLARE(multipart);\nGST_PLUGIN_STATIC_DECLARE(wavenc);\nGST_PLUGIN_STATIC_DECLARE(wavpack);\nGST_PLUGIN_STATIC_DECLARE(wavparse);\nGST_PLUGIN_STATIC_DECLARE(androidmedia);\nGST_PLUGIN_STATIC_DECLARE(opengl);\nGST_PLUGIN_STATIC_DECLARE(opensles);\n\nGST_PLUGIN_STATIC_DECLARE(autoconvert);\nGST_PLUGIN_STATIC_DECLARE(amrnb);\nGST_PLUGIN_STATIC_DECLARE(amrwbdec);\n</code></pre>\n\n<p>They are not the miminum list of the plugins and I don't have times to optimize it yet, I do not need to compile a libgstreamer_android.so to make them work on my phone, but they still work.</p>\n"}], "owner": {"reputation": 4401, "user_id": 1281264, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/10501b5548f74ef7aa4100091d8e7fc6?s=128&d=identicon&r=PG", "display_name": "StereoMatching", "link": "https://stackoverflow.com/users/1281264/stereomatching"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 57545036, "answer_count": 1, "score": 1, "last_activity_date": 1566134939, "creation_date": 1565198162, "last_edit_date": 1565243746, "question_id": 57399406, "link": "https://stackoverflow.com/questions/57399406/use-gstreamer-to-record-audio-on-androidwith-qt5", "title": "Use gstreamer to record audio on android(with Qt5)", "body": "<p>Trying to record audio on android with gstreamer(enable permission of audio record already), I prefer gstreamer but not the java api because there are more functions need to be added in the future, like\nconvert the audio to specific format(S16LE, channels=1, rate=16000 etc), encode as wav, separate video/audio and so on</p>\n\n<p>The pipeline I am using are</p>\n\n<pre><code>openslessrc ! audioconvert ! wavenc ! fakesink\n</code></pre>\n\n<p>and</p>\n\n<pre><code>openslessrc ! audioconvert ! wavenc ! openslessink location=\\\"%1\\\"\n</code></pre>\n\n<p>But both of them give me error message</p>\n\n<pre><code>E IAudioFlinger: createRecord returned error -22\nE AudioRecord: AudioFlinger could not create record track, status: -22\nE libOpenSLES: android_audioRecorder_realize(0xcea58a00) error creating AudioRecord object; status -22\nW libOpenSLES: Leaving Object::Realize (SL_RESULT_CONTENT_UNSUPPORTED)\n</code></pre>\n\n<p>Part of my .pro file</p>\n\n<pre><code>#plugins\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstcoreelements.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgsttypefindfunctions.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstvideoconvert.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstvideorate.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstvideoscale.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstvideofilter.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstautodetect.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstvideotestsrc.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstplayback.a\n#LIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstsoup.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstx264.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstvideoparsersbad.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstandroidmedia.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstopengl.a\n\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstopensles.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstaudioconvert.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstaudiotestsrc.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstautodetect.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstautoconvert.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstaudioresample.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstplayback.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstwavenc.a\nLIBS += $${GSTREAMER_ROOT}/lib/gstreamer-1.0/libgstvoaacenc.a\n\nLIBS += -lOpenSLES\n\n#LIBS += $${GSTREAMER_ROOT}/lib/libavcodec.a\n\n\n#plugin libs\nLIBS += $${GSTREAMER_ROOT}/lib/liborc-0.4.a\nLIBS += $${GSTREAMER_ROOT}/lib/libgstgl-1.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libgraphene-1.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libpng16.a\nLIBS += $${GSTREAMER_ROOT}/lib/libjpeg.a\nLIBS += $${GSTREAMER_ROOT}/lib/libx264.a\nLIBS += $${GSTREAMER_ROOT}/lib/libgstvideo-1.0.a\n#LIBS += $${GSTREAMER_ROOT}/lib/libgstbadbase-1.0.a\n#LIBS += $${GSTREAMER_ROOT}/lib/libgstbadvideo-1.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libgstaudio-1.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libgstpbutils-1.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libgsttag-1.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libgstphotography-1.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libgstcontroller-1.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libgstcodecparsers-1.0.a\nLIBS += -lEGL -lGLESv2\n\n#gstreamer libs\nLIBS += $${GSTREAMER_ROOT}/lib/libgstbase-1.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libgstreamer-1.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libgmodule-2.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libgobject-2.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libglib-2.0.a\nLIBS += $${GSTREAMER_ROOT}/lib/libffi.a\n#LIBS += $${GSTREAMER_ROOT}/lib/libpcre.a\nLIBS += $${GSTREAMER_ROOT}/lib/libiconv.a\nLIBS += $${GSTREAMER_ROOT}/lib/libintl.a\nLIBS += $${GSTREAMER_ROOT}/lib/libz.a\n</code></pre>\n\n<p>Initialization codes of gstreamer, in main.cpp</p>\n\n<pre><code>extern \"C\"\n{\n\n#include &lt;gst/gst.h&gt;\n\n#ifdef Q_OS_ANDROID\nGST_PLUGIN_STATIC_DECLARE(coreelements);\nGST_PLUGIN_STATIC_DECLARE(typefindfunctions);\nGST_PLUGIN_STATIC_DECLARE(videoconvert);\nGST_PLUGIN_STATIC_DECLARE(videorate);\nGST_PLUGIN_STATIC_DECLARE(videoscale);\nGST_PLUGIN_STATIC_DECLARE(videofilter);\nGST_PLUGIN_STATIC_DECLARE(autodetect);\nGST_PLUGIN_STATIC_DECLARE(playback);\nGST_PLUGIN_STATIC_DECLARE(videotestsrc);\nGST_PLUGIN_STATIC_DECLARE(playback);\n//GST_PLUGIN_STATIC_DECLARE(soup);\nGST_PLUGIN_STATIC_DECLARE(x264);\nGST_PLUGIN_STATIC_DECLARE(videoparsersbad);\nGST_PLUGIN_STATIC_DECLARE(androidmedia);\nGST_PLUGIN_STATIC_DECLARE(opengl);\n//GST_PLUGIN_STATIC_DECLARE(qmlgl);\n\nGST_PLUGIN_STATIC_DECLARE(opensles);\nGST_PLUGIN_STATIC_DECLARE(audioconvert);\nGST_PLUGIN_STATIC_DECLARE(audiotestsrc);\nGST_PLUGIN_STATIC_DECLARE(autodetect);\nGST_PLUGIN_STATIC_DECLARE(autoconvert);\nGST_PLUGIN_STATIC_DECLARE(audioresample);\nGST_PLUGIN_STATIC_DECLARE(playback);\nGST_PLUGIN_STATIC_DECLARE(wavenc);\n//GST_PLUGIN_STATIC_DECLARE(voaacenc);\n\n#endif\n\n}\n\nint main(int argc, char *argv[])\n{\n    gst_init (&amp;argc, &amp;argv);\n\n#ifdef Q_OS_ANDROID\n    GST_PLUGIN_STATIC_REGISTER(coreelements);\n    GST_PLUGIN_STATIC_REGISTER(typefindfunctions);\n    GST_PLUGIN_STATIC_REGISTER(videoconvert);\n    GST_PLUGIN_STATIC_REGISTER(videorate);\n    GST_PLUGIN_STATIC_REGISTER(videoscale);\n    GST_PLUGIN_STATIC_REGISTER(videofilter);\n    GST_PLUGIN_STATIC_REGISTER(autodetect);\n    GST_PLUGIN_STATIC_REGISTER(playback);\n    //GST_PLUGIN_STATIC_REGISTER(soup);\n    GST_PLUGIN_STATIC_REGISTER(videotestsrc);\n    GST_PLUGIN_STATIC_REGISTER(x264);\n    GST_PLUGIN_STATIC_REGISTER(videoparsersbad);\n    GST_PLUGIN_STATIC_REGISTER(androidmedia);\n    GST_PLUGIN_STATIC_REGISTER(opengl);\n    //GST_PLUGIN_STATIC_REGISTER(qmlgl);\n\n    GST_PLUGIN_STATIC_REGISTER(opensles);\n    GST_PLUGIN_STATIC_REGISTER(audioconvert);\n    GST_PLUGIN_STATIC_REGISTER(audiotestsrc);\n    GST_PLUGIN_STATIC_REGISTER(autodetect);\n    GST_PLUGIN_STATIC_REGISTER(autoconvert);\n    GST_PLUGIN_STATIC_REGISTER(audioresample);\n    GST_PLUGIN_STATIC_REGISTER(playback);\n    GST_PLUGIN_STATIC_REGISTER(wavenc);\n    //GST_PLUGIN_STATIC_REGISTER(voaacenc);\n\n    gst_debug_set_active(TRUE);\n    gst_debug_set_default_threshold(GST_LEVEL_NONE);\n#endif\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "c", "arrays", "string"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1565197354, "post_id": 57399227, "comment_id": 101279977, "body": "String <i>is</i> a byte array with terminating <code>&#39;\\0&#39;</code> character. So yeah, you will need it&#39;s size to accommodate it too."}, {"owner": {"reputation": 1782, "user_id": 7970461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee57a85b60ce9c462d95f972ea1811e?s=128&d=identicon&r=PG&f=1", "display_name": "R.J. Dunnill", "link": "https://stackoverflow.com/users/7970461/r-j-dunnill"}, "edited": false, "score": 0, "creation_date": 1565197608, "post_id": 57399227, "comment_id": 101280093, "body": "Aren&#39;t you missing a null-terminator?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1565197624, "post_id": 57399227, "comment_id": 101280103, "body": "Why are you making a wonky typedef <code>BYTE</code>? This is like imposing the terminology of another language on C where it doesn&#39;t belong. In C we call these <code>unsigned char</code> or <code>uint8_t</code> if you prefer."}, {"owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "reply_to_user": {"reputation": 1782, "user_id": 7970461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee57a85b60ce9c462d95f972ea1811e?s=128&d=identicon&r=PG&f=1", "display_name": "R.J. Dunnill", "link": "https://stackoverflow.com/users/7970461/r-j-dunnill"}, "edited": false, "score": 0, "creation_date": 1565197721, "post_id": 57399227, "comment_id": 101280154, "body": "@R.J.Dunnill, C++ understands a non-null terminated buffer representing a string when you specify the size."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1565197753, "post_id": 57399227, "comment_id": 101280170, "body": "@KonradRudolph It clearly isn&#39;t."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 3, "creation_date": 1565197840, "post_id": 57399227, "comment_id": 101280212, "body": "@LeeDanielCrocker Please actually <b>read</b> the question, not just the code. OP has C++ code; but they want to know how to do the same in C."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1565197876, "post_id": 57399227, "comment_id": 101280234, "body": "If the question is about C, then he should include C code."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 2, "creation_date": 1565197892, "post_id": 57399227, "comment_id": 101280243, "body": "@Konrad OK, sorry for the mess. I misread."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1565198801, "post_id": 57399227, "comment_id": 101280668, "body": "@KonradRudolph As per C++ and C tag policies, it is fine to use both tags for questions regarding &quot;Compatibility or porting code between C and C++&quot;. This tag usage is the community consensus - it should have both tags. <a href=\"https://stackoverflow.com/tags/c%2b%2b/info\">stackoverflow.com/tags/c%2b%2b/info</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1565198956, "post_id": 57399227, "comment_id": 101280746, "body": "I&#39;ll add both tags. Anyone disagreeing kindly take it up on meta <a href=\"https://meta.stackoverflow.com/questions/374306/proposed-update-to-c-and-c-tag-usage-wikis\">here</a> instead of vandalizing this question with edits."}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1565199546, "post_id": 57399227, "comment_id": 101280979, "body": "@LeeDanielCrocker: Requesting how to do something in C code does not require supplying C code as an example. Supplying C++ code to explain or illustrate some part of their question is fine, and it does not mean their question is about C++."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1565202468, "post_id": 57399227, "comment_id": 101282194, "body": "Fair enough. Though we generally prefer &quot;here&#39;s my code, what&#39;s wrong&quot; questions to &quot;how do I write...&quot; questions."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1565204993, "post_id": 57399227, "comment_id": 101283405, "body": "@Lundin I\u2019m not sure why you\u2019re addressing me: I\u2019m fine with both tags (although I don\u2019t find it strictly necessary here). I objected to people removing the C tag."}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1565209909, "post_id": 57399227, "comment_id": 101285379, "body": "@LeeDanielCrocker: We who? Stack Overflow is a site for general programming questions and answers. \u201cWhat is wrong with this code?\u201d is a subset of suitable questions. As far as \u201cwe\u201d are concerned, it is at best a distraction from the main purpose and ought to be a minor subset. Most code with a bug does not exemplify general principles that would be useful for others to look up and learn from (and many of those that might just duplicate some previously explained issue, just in a different form is not conducive to searching). \u201cHow do I do X?\u201d questions are more suitable for the main purpose."}], "answers": [{"comments": [{"owner": {"reputation": 2078, "user_id": 1184801, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/03bdf23b59e23cfd6e479e4b0ba1eb35?s=128&d=identicon&r=PG", "display_name": "Dan James Palmer", "link": "https://stackoverflow.com/users/1184801/dan-james-palmer"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1565197780, "post_id": 57399288, "comment_id": 101280185, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 every changes my tags for the OP. The first line states the code IS in C++ but I want it in C. This works a treat and will accept when able"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 2078, "user_id": 1184801, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/03bdf23b59e23cfd6e479e4b0ba1eb35?s=128&d=identicon&r=PG", "display_name": "Dan James Palmer", "link": "https://stackoverflow.com/users/1184801/dan-james-palmer"}, "edited": false, "score": 0, "creation_date": 1565197857, "post_id": 57399288, "comment_id": 101280221, "body": "@DanJamesPalmer Please don&#39;t play games, even unintentionally. If you want C, show us C code. Don&#39;t use C++ as a way to demonstrate C code. <i>These are two different languages with different tools and approaches suitable to each</i>. That C++ can use C code is not a reason to confuse the two."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 6, "creation_date": 1565198105, "post_id": 57399288, "comment_id": 101280349, "body": "@tadman That\u2019s an unfair accusation. The tags say C, the title says C, the body of the question says C. We (me included!) are just all jumping at the sight of C++ code and ignore mentions of C in tags and title like Pavlovian dogs (because we\u2019ve been conditioned to expect mis-tagging between the two languages) but the question makes it clear why the C++ code is included, and how it\u2019s relevant and legitimate."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1565198199, "post_id": 57399288, "comment_id": 101280386, "body": "@KonradRudolph There is C++ code present which is a red herring, and that&#39;s really not called for. I&#39;m of the opinion that if there&#39;s C++ code in the question, it is, <i>by definition</i>, a C++ question and should be tagged as such. If you want C and C only, don&#39;t even go there, just use C and deal."}], "tags": [], "owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "is_accepted": true, "score": 12, "last_activity_date": 1565198190, "last_edit_date": 1565198190, "creation_date": 1565197639, "answer_id": 57399288, "question_id": 57399227, "link": "https://stackoverflow.com/questions/57399227/convert-c-byte-array-to-a-c-string/57399288#57399288", "title": "Convert C++ byte array to a C string", "body": "<p>Strings in C <em>are</em> byte arrays which are zero-terminated. So all you need to do is copy the array into a new buffer with sufficient space for a trailing zero byte:</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef unsigned char BYTE;\n\nint main() {\n    BYTE byteArray[5] = { 0x48, 0x65, 0x6C, 0x6C, 0x6F };\n    char str[(sizeof byteArray) + 1];\n    memcpy(str, byteArray, sizeof byteArray);\n    str[sizeof byteArray] = 0; // Null termination.\n    printf(\"%s\\n\", str);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 0, "creation_date": 1565197747, "post_id": 57399305, "comment_id": 101280166, "body": "You&#39;re missing the <code>&#39;\\0&#39;</code>."}, {"owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 0, "creation_date": 1565197973, "post_id": 57399305, "comment_id": 101280286, "body": "It looks slow. Why clear the entire buffer before a copy? Also <code>strcpy()</code> is incorrect since the source is not null terminated."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 1, "creation_date": 1565198129, "post_id": 57399305, "comment_id": 101280361, "body": "@AlexisWilke right, I could just <code>memcpy()</code>, which doesn&#39;t need a cast also. No need to clear indeed, I could just append the NULL terminator, right?"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 1, "last_activity_date": 1565199615, "last_edit_date": 1565199615, "creation_date": 1565197693, "answer_id": 57399305, "question_id": 57399227, "link": "https://stackoverflow.com/questions/57399227/convert-c-byte-array-to-a-c-string/57399305#57399305", "title": "Convert C++ byte array to a C string", "body": "<p>C strings are null terminated, so the size of the string will be the size of the array plus one, for the null terminator. Then you could use <a href=\"http://www.cplusplus.com/reference/cstring/memcpy/\" rel=\"nofollow noreferrer\"><code>memcpy()</code></a> to copy the string, like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef unsigned char BYTE;\n\nint main(void)\n{\n  BYTE byteArray[5] = { 0x48, 0x65, 0x6C, 0x6C, 0x6F };\n\n  // +1 for the NULL terminator\n  char str[sizeof(byteArray) + 1];\n  // Copy contents\n  memcpy(str, byteArray, sizeof(byteArray));\n  // Append NULL terminator\n  str[sizeof(byteArray)] = '\\0';\n\n  printf(\"%s\\n\", str);    \n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>Hello</p>\n</blockquote>\n\n<p><a href=\"https://wandbox.org/permlink/mz0T7rUlQ0eVKd4B\" rel=\"nofollow noreferrer\">Run it online</a></p>\n"}, {"comments": [{"owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 1, "creation_date": 1565198063, "post_id": 57399336, "comment_id": 101280329, "body": "Only if the string is really large the <code>.. = { &#39;\\0&#39; }</code> is going to be a real waste."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 0, "creation_date": 1565198113, "post_id": 57399336, "comment_id": 101280352, "body": "@AlexisWilke So as I said the terminating zero can be appended manually.:)"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 1, "creation_date": 1565198267, "post_id": 57399336, "comment_id": 101280418, "body": "@gsamaras No I need not. But this variant is already shown in my answer.:)"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1565198484, "post_id": 57399336, "comment_id": 101280509, "body": "I thought you meant <code>s</code> as the <code>byteArray</code>, which would be wrong, now it&#39;s fine, misread that, \u03c3\u03c5\u03b3\u03b3\u03bd\u03ce\u03bc\u03b7! :)"}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1565198521, "last_edit_date": 1565198521, "creation_date": 1565197877, "answer_id": 57399336, "question_id": 57399227, "link": "https://stackoverflow.com/questions/57399227/convert-c-byte-array-to-a-c-string/57399336#57399336", "title": "Convert C++ byte array to a C string", "body": "<p>Here is a demonstrative program that shows how it can be done.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef unsigned char BYTE;\n\nint main(void) \n{\n    BYTE byteArray[5] = { 0x48, 0x65, 0x6C, 0x6C, 0x6F };\n    char s[sizeof( byteArray ) + sizeof( ( char )'\\0' )] = { '\\0' };\n\n    memcpy( s, byteArray, sizeof( byteArray ) );\n\n    puts( s );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>Hello\n</code></pre>\n\n<p>Pay attention to that the character array is zero initialized. Otherwise after the call of memcpy you have to append the terminating zero \"manually\".</p>\n\n<pre><code>s[sizeof( s ) - 1] = '\\0';\n</code></pre>\n\n<p>or </p>\n\n<pre><code>s[sizeof( byteArray )] = '\\0';\n</code></pre>\n\n<p>The last variant should be used when the size of the character array much greater than the size of byteArray.</p>\n"}], "owner": {"reputation": 2078, "user_id": 1184801, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/03bdf23b59e23cfd6e479e4b0ba1eb35?s=128&d=identicon&r=PG", "display_name": "Dan James Palmer", "link": "https://stackoverflow.com/users/1184801/dan-james-palmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8746, "favorite_count": 0, "accepted_answer_id": 57399288, "answer_count": 3, "score": 1, "last_activity_date": 1565203289, "creation_date": 1565197322, "last_edit_date": 1565203289, "question_id": 57399227, "link": "https://stackoverflow.com/questions/57399227/convert-c-byte-array-to-a-c-string", "title": "Convert C++ byte array to a C string", "body": "<p>I'm trying to convert a byte array to a string in C but I can't quite figure it out.</p>\n\n<p>I have an example of what works for me in C++ but I need to convert it to C.</p>\n\n<p>The C++ code is below:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\ntypedef unsigned char BYTE;\n\nint main(int argc, char *argv[])\n{\n  BYTE byteArray[5] = { 0x48, 0x65, 0x6C, 0x6C, 0x6F };\n  std::string s(reinterpret_cast&lt;char*&gt;(byteArray), sizeof(byteArray));\n  std::cout &lt;&lt; s &lt;&lt; std::endl;\n\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Can anyone point me in the right direction?</p>\n"}, {"tags": ["c++", "visual-c++", "include-path"], "comments": [{"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1565197320, "post_id": 57399105, "comment_id": 101279960, "body": "Visual Studio has build targets for Debug and Release builds, and x86 and x64 builds: which are you using, and can you confirm that you added this directory to the &quot;Include Directories&quot; property specifically for the build you&#39;re trying to compile?"}, {"owner": {"reputation": 11, "user_id": 11897397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0VfdBo-gGkc/AAAAAAAAAAI/AAAAAAAAAGc/7LI_uM4kgDs/photo.jpg?sz=128", "display_name": "AncientScarab", "link": "https://stackoverflow.com/users/11897397/ancientscarab"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1565197454, "post_id": 57399105, "comment_id": 101280019, "body": "@Xirema I am using the build target &quot;Release&quot;, and the Platform is &quot;Active(Win32)&quot;. I am unsure what you mean by the last section"}, {"owner": {"reputation": 11, "user_id": 11897397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0VfdBo-gGkc/AAAAAAAAAAI/AAAAAAAAAGc/7LI_uM4kgDs/photo.jpg?sz=128", "display_name": "AncientScarab", "link": "https://stackoverflow.com/users/11897397/ancientscarab"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1565197978, "post_id": 57399105, "comment_id": 101280291, "body": "@Xirema after reading your comment again, I have figured out that on the main screen for visual studio i was running debug and not release. Thank you so much for the help!"}], "answers": [{"tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": false, "score": 2, "last_activity_date": 1565198266, "creation_date": 1565198266, "answer_id": 57399423, "question_id": 57399105, "link": "https://stackoverflow.com/questions/57399105/cannot-access-glfw-glfw3-h-in-visual-studio-2019/57399423#57399423", "title": "Cannot access GLFW/glfw3.h in Visual Studio 2019", "body": "<p>You need to make sure that you add the configuration properties to the correct build target and platform for your code.</p>\n\n<p>If you only add these properties to the \"Debug\" Build Target and then try to compile in \"Release\" (or vise-versa) then the compiler won't be able to find your libraries.</p>\n\n<p>You should manually change these properties for each Build Target you intend to build for, and for each Platform you intend to build for. Often (especially for newer programmers), it's best if you just stick with one of each (I recommend Debug for build target and x64 for Platform), so that you don't have to perform this step repeatedly.</p>\n\n<p>Alternatively, if there's no difference in your libraries between debug and release (which commonly happens if you don't build the libraries yourself and just use whatever the vendor provided) you can choose, when setting your configuration, to affect ALL build targets; although this probably won't work for ALL platforms (since Win32 code can't be linked with x64 code). So you'll still need to specifically choose the correct platform for your code.</p>\n"}], "owner": {"reputation": 11, "user_id": 11897397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0VfdBo-gGkc/AAAAAAAAAAI/AAAAAAAAAGc/7LI_uM4kgDs/photo.jpg?sz=128", "display_name": "AncientScarab", "link": "https://stackoverflow.com/users/11897397/ancientscarab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 920, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1565198266, "creation_date": 1565196799, "question_id": 57399105, "link": "https://stackoverflow.com/questions/57399105/cannot-access-glfw-glfw3-h-in-visual-studio-2019", "title": "Cannot access GLFW/glfw3.h in Visual Studio 2019", "body": "<p>I am trying to develop a game using GLFW and C++, but to do this I need to add add a new \"Include Directory\", how would I go about this?</p>\n\n<p>So far, I have tried to add it to \"Configuration Properties/VC++ Directories/Include Directories\" and to \"C\\C++/General/Additional Include Directories\" and both have been unsuccessful.</p>\n\n<p>In the Project File, I have a libraries folder, and inside it are a folder called \"GLFW\", and a file called \"glfw3.lib\". Inside the \"GLFW\" folder, there are two files called \"glfw3.h\" and \"glfw3native.h\". I am unsure what else to post in this section so apologies on that part.</p>\n\n<p>I expect to be able to do the code \"#include \" but it comes up with an error saying that it cannot open the source file.</p>\n\n<p>I appreciate any help you can give!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1565197042, "post_id": 57399044, "comment_id": 101279830, "body": "<code>std::cin &gt;&gt; tags[i];</code> and if there is no <code>tags[i]</code>? For example <code>tags</code> is empty? Sometimes as you gotta <a href=\"https://en.cppreference.com/w/cpp/container/vector/push_back\" rel=\"nofollow noreferrer\"><code>push_back</code></a> against bugs like this or they&#39;ll walk all over ya."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1565201492, "post_id": 57399044, "comment_id": 101281797, "body": "<i>I reach the tags user input prompt, the program crashes</i> -- The program didn&#39;t actually crash.  You received an assertion which halted the program -- a crash implies that the program just suddenly stopped working because of a memory violation or similar error.  -- <i>and gives me a debug assertion failed error saying &quot;expression: vector subscript out of range&quot;</i> -- ok, so what in that error message is not understood?  Seems clear to me what the issue is."}], "answers": [{"tags": [], "owner": {"reputation": 7744, "user_id": 9666018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2959ed405ad18cbca6aa3efe01bc7d?s=128&d=identicon&r=PG&f=1", "display_name": "Armin Montigny", "link": "https://stackoverflow.com/users/9666018/armin-montigny"}, "is_accepted": true, "score": 0, "last_activity_date": 1565203803, "creation_date": 1565203803, "answer_id": 57400645, "question_id": 57399044, "link": "https://stackoverflow.com/questions/57399044/user-input-strings-into-string-vector-and-validating-it/57400645#57400645", "title": "User input strings into string vector and validating it", "body": "<p>You made only a minor logical error.</p>\n\n<p>As user4581301  has already written in his comment:</p>\n\n<p>When you define a vector, it initially has 0 elements. Meaning, even not element 0. So, after </p>\n\n<pre><code>std::vector&lt;std::string&gt; tags;\n</code></pre>\n\n<p>tags contains no elements, even not <code>tags[0]</code>. And if you try to write a value into <code>tags[i]</code>, with <code>int i = 0;</code> you create an out of bounds error. You write somewhere random in the memory.</p>\n\n<p>How to avoid that?. You can create a vector with a given size in the constructor or you can use the vectors <code>resize</code> function or best, use the function intended for this use case: <code>push_back()</code>.</p>\n\n<p>Change code to:</p>\n\n<pre><code> std::vector&lt;std::string&gt; tags;\n    std::cout &lt;&lt; \"Tags: \";\n    std::string strTag;\n    if (std::cin &gt;&gt; strTag)\n        tags.push_back(strTag);\n    p.setTags(tags);\n    std::cout &lt;&lt; p.getTags().at(i) &lt;&lt; std::endl;\n    std::cout &lt;&lt; std::endl;\n    i++;\n</code></pre>\n\n<p>There are of course other possibilities. But this is easy to understand.</p>\n"}], "owner": {"reputation": 29, "user_id": 8292224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ba3ac79f37b025b08cce00db878afd?s=128&d=identicon&r=PG&f=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/8292224/casper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1565709870, "accepted_answer_id": 57400645, "answer_count": 1, "score": -1, "last_activity_date": 1565203803, "creation_date": 1565196529, "question_id": 57399044, "link": "https://stackoverflow.com/questions/57399044/user-input-strings-into-string-vector-and-validating-it", "closed_reason": "Not suitable for this site", "title": "User input strings into string vector and validating it", "body": "<p>So I'm creating a social media functionality program and I'm trying to store strings into a string vector by user input that act like tags. But before they are stored into the vector, they have to be validated by having a hashtag symbol before the string. If it is valid, the tag will be stored into the vector but if not valid it should repeat the user input prompt until it is valid.</p>\n\n<p>Post.cpp</p>\n\n<pre><code>#include \"pch.h\"\n\n//Regex\nstd::string posterRegex = \"[A-Za-z0-9]{8,}\";\nstd::string messageRegex = \"[A-Za-z0-9]{1,}\";\n\n//Validates data against a user-defined string\nbool validatePost(std::string regexStr, std::string data)\n{\n    return std::regex_match(data, std::regex(regexStr));\n}\n\nbool validateVector(const std::vector&lt;std::string&gt; &amp;in)\n{\n    return std::none_of(std::begin(in), std::end(in), [](std::string \n    const &amp;s)\n    {\n        return s.find(\"#\") == std::string::npos;\n    });\n}\n\nPost::Post()\n{\n}\n\nPost::Post(std::string poster, std::string message, \nstd::vector&lt;std::string&gt; tags, std::vector&lt;User*&gt; taggedUsers)\n{\n    setPoster(poster);\n    setMessage(message);\n    setTags(tags);\n    setTaggedUsers(taggedUsers);\n}\n\n\nPost::~Post()\n{\n}\n\nvoid Post::setPoster(std::string poster)\n{\n    for (;;)\n    {\n        bool bValid = validatePost(posterRegex, poster);\n        if (bValid)\n        {\n            this-&gt;poster = poster;\n            break;\n        }\n        else\n        {\n            std::cout &lt;&lt; \"Please enter a valid name!\\n\";\n            std::cout &lt;&lt; std::endl;\n            std::cout &lt;&lt; \"Poster: \";\n            std::cin.clear();\n            std::cin.ignore(512, '\\n');\n            std::cin &gt;&gt; poster;\n        }\n    }\n}\n\nvoid Post::setMessage(std::string message)\n{\n    for (;;)\n    {\n        bool bValid = validatePost(messageRegex, message);\n        if (bValid)\n        {\n            this-&gt;message = message;\n            break;\n        }\n        else\n        {\n            std::cout &lt;&lt; \"Please enter a valid message!\\n\";\n            std::cout &lt;&lt; std::endl;\n            std::cout &lt;&lt; \"Message: \";\n            std::cin.clear();\n            std::cin.ignore(512, '\\n');\n            std::cin &gt;&gt; message;\n        }\n    }\n}\n\nvoid Post::setTags(std::vector&lt;std::string&gt; tags)\n{\n    for (;;)\n    {\n                int i = 0;\n        bool bValid = validateVector(tags);\n        if (bValid)\n        {\n            this-&gt;tags = tags;\n            break;\n        }\n        else\n        {\n            std::cout &lt;&lt; \"Please enter a valid tag(s)!\\n\";\n            std::cout &lt;&lt; std::endl;\n            std::cout &lt;&lt; \"Tag(s): \";\n            std::cin.clear();\n            std::cin.ignore(512, '\\n');\n            std::cin &gt;&gt; tags[i];\n        }\n    }\n}\n\nstd::ostream &amp; operator&lt;&lt;(std::ostream&amp; osObject, const Post&amp; coObject)\n{\n    osObject &lt;&lt; coObject.poster &lt;&lt; \" - \" &lt;&lt; coObject.message;\n    return osObject;\n}\n</code></pre>\n\n<p>Main.cpp</p>\n\n<pre><code>#include \"pch.h\"\n\nPost p;\n\nint main()\n{\n\n    int i = 0;\n    std::string poster;\n    std::cout &lt;&lt; \"Poster: \";\n    std::cin &gt;&gt; poster;\n    p.setPoster(poster);\n    std::cout &lt;&lt; p.getPoster() &lt;&lt; std::endl;\n    std::cout &lt;&lt; std::endl;\n\n    std::string message;\n    std::cout &lt;&lt; \"Message: \";\n    std::cin &gt;&gt; message;\n    p.setMessage(message);\n    std::cout &lt;&lt; p.getMessage() &lt;&lt; std::endl;\n    std::cout &lt;&lt; std::endl;\n\n    std::vector&lt;std::string&gt; tags;\n    std::cout &lt;&lt; \"Tags: \";\n    std::cin &gt;&gt; tags[i];\n    p.setTags(tags);\n    std::cout &lt;&lt; p.getTags().at(i) &lt;&lt; std::endl;\n    std::cout &lt;&lt; std::endl;\n    i++;\n}\n</code></pre>\n\n<p>The program runs fine but when I reach the tags user input prompt, the program crashes and gives me a debug assertion failed error saying \"expression: vector subscript out of range\".</p>\n"}, {"tags": ["c++", "optimization", "c++17"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1565196523, "post_id": 57399021, "comment_id": 101279602, "body": "Have you benchmarked different approaches? Have you had discussions with other compiler engineers about this? There&#39;s probably a reason here. It&#39;s not the sort of thing you&#39;d decide by a coin toss unless the difference really didn&#39;t matter."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1565196659, "post_id": 57399021, "comment_id": 101279666, "body": "A pointer and size lets you take old c-string functions and change them to using a <code>string_view</code> with the only change at the call site being <code>foo(ptr, size)</code> -&gt; <code>foo({ptr, size})</code>"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1565196824, "post_id": 57399021, "comment_id": 101279737, "body": "@NathanOliver It would be the same if string_view took pointer pointer."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1565196904, "post_id": 57399021, "comment_id": 101279775, "body": "@Justin Not at all.  If it took two pointers you need to change <code>foo(ptr, size)</code> -&gt; <code>foo({ptr, ptr + size})</code> which is more typing."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1565197172, "post_id": 57399021, "comment_id": 101279889, "body": "Oh, there is no <code>string_view(char const*, char const*)</code> constructor. TIL."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1565197210, "post_id": 57399021, "comment_id": 101279910, "body": "@NathanOliver Question isn&#39;t about the interface of string_view, it&#39;s about the implementation."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1565197234, "post_id": 57399021, "comment_id": 101279920, "body": "std::vector and std::string need to store the capacity beside size so obviously there must be 3 fields"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 4, "creation_date": 1565197306, "post_id": 57399021, "comment_id": 101279951, "body": "@phuclv Note that OP isn&#39;t questioning why 3 fields, OP is pointing out that those 3 fields are all pointers rather than a pointer and 2 sizes."}, {"owner": {"reputation": 23279, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1565215949, "post_id": 57399021, "comment_id": 101287286, "body": "I just want to say that that I agree with @Barry and Justin replies."}, {"owner": {"reputation": 2990, "user_id": 10803671, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mt-5s4Zqfyk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i_80atK5hWxwK60_Ren7qQV1TVuQ/mo/photo.jpg?sz=128", "display_name": "ALX23z", "link": "https://stackoverflow.com/users/10803671/alx23z"}, "edited": false, "score": 0, "creation_date": 1565251883, "post_id": 57399021, "comment_id": 101296599, "body": "It might be meaningle for default ``"}, {"owner": {"reputation": 23279, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "edited": false, "score": 0, "creation_date": 1565432628, "post_id": 57399021, "comment_id": 101358979, "body": "it is amazing how this question got put on hold because it is &quot;opinion based&quot;... total nonsense, I would bet my monthly salary that if we could magically summon mclow, chandler or godbolt they would be able to give us a reason."}], "owner": {"reputation": 23279, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 1, "closed_date": 1565365069, "answer_count": 0, "score": 3, "last_activity_date": 1565196430, "creation_date": 1565196430, "question_id": 57399021, "link": "https://stackoverflow.com/questions/57399021/is-there-a-reason-why-string-view-implementation-uses-pointer-size-instead-of-po", "closed_reason": "Opinion-based", "title": "Is there a reason why string_view implementation uses pointer,size instead of pointer,pointer", "body": "<p>As you may know C++17 string view can be implemented either as a pair of 2 pointers(begin, end), or pointer(begin), and size.\nI noticed in one implementation that it is implemented with pointer, size.</p>\n\n<p>Is there a good reason why this was done, or was it just a coin-toss kind of a decision?</p>\n\n<p>I wonder since vector implementations usually have 3 pointers, instead of pointer, size, size. </p>\n\n<p>Only reasonable explanation I have is that .size() may be called more often than .end() so we optimize for that(end requires addition, but size is free from computation).</p>\n"}, {"tags": ["c++", "constructor", "inline", "linker-errors", "constexpr"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1565196078, "post_id": 57398905, "comment_id": 101279392, "body": "Why did you make the constructor <code>constexpr</code>? Do you understand the ramifications of doing that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1565196108, "post_id": 57398905, "comment_id": 101279410, "body": "Why do you think you need so many namespaces?"}, {"owner": {"reputation": 65, "user_id": 10619432, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5aW30E7zm9Y/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsZ30xMujQrPTOuRLjNargdPVy9Q/mo/photo.jpg?sz=128", "display_name": "Sebastian Kucharzyk", "link": "https://stackoverflow.com/users/10619432/sebastian-kucharzyk"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1565196551, "post_id": 57398905, "comment_id": 101279611, "body": "@LightnessRacesinOrbit , Could you elaborate what you mean by &quot;ramifications&quot;?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1565196754, "post_id": 57398905, "comment_id": 101279703, "body": "@SebastianKucharzyk Consequences of doing so most probably."}, {"owner": {"reputation": 65, "user_id": 10619432, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5aW30E7zm9Y/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsZ30xMujQrPTOuRLjNargdPVy9Q/mo/photo.jpg?sz=128", "display_name": "Sebastian Kucharzyk", "link": "https://stackoverflow.com/users/10619432/sebastian-kucharzyk"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1565197739, "post_id": 57398905, "comment_id": 101280164, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6, This object is supposed to be lightweight and all things needed for its configuration (i.e. registers) known during the compile time. Therefore I thought that it would be nice to make constructors of both Registers and Executor constexpr so they can be instantiated during the compile time. Do you consider this as bad practice?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1565198052, "post_id": 57398905, "comment_id": 101280318, "body": "@SebastianKucharzyk It doesn&#39;t is a matter of <i>bad practice</i> or not, that&#39;s just what you need to get it working. Also I don&#39;t understand what&#39;s your concern about <i>lightweight</i>."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 10619432, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5aW30E7zm9Y/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsZ30xMujQrPTOuRLjNargdPVy9Q/mo/photo.jpg?sz=128", "display_name": "Sebastian Kucharzyk", "link": "https://stackoverflow.com/users/10619432/sebastian-kucharzyk"}, "edited": false, "score": 0, "creation_date": 1565196912, "post_id": 57398995, "comment_id": 101279778, "body": "Oh, if it&#39;s inline then linking error makes perfect sense. Thanks!"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 65, "user_id": 10619432, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5aW30E7zm9Y/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsZ30xMujQrPTOuRLjNargdPVy9Q/mo/photo.jpg?sz=128", "display_name": "Sebastian Kucharzyk", "link": "https://stackoverflow.com/users/10619432/sebastian-kucharzyk"}, "edited": false, "score": 0, "creation_date": 1565196937, "post_id": 57398995, "comment_id": 101279785, "body": "@SebastianKucharzyk No at all. You are welcome.:)"}, {"owner": {"reputation": 65, "user_id": 10619432, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5aW30E7zm9Y/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsZ30xMujQrPTOuRLjNargdPVy9Q/mo/photo.jpg?sz=128", "display_name": "Sebastian Kucharzyk", "link": "https://stackoverflow.com/users/10619432/sebastian-kucharzyk"}, "edited": false, "score": 0, "creation_date": 1565197427, "post_id": 57398995, "comment_id": 101280010, "body": "from Moscov, why no at all? When I include Executor.h in OpcodesImmediateExecutorTests.cpp and try to instantiate it then it can see only the declaration of an inline function and its body is in a different translation unit so he cannot link it. Right?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 65, "user_id": 10619432, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5aW30E7zm9Y/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsZ30xMujQrPTOuRLjNargdPVy9Q/mo/photo.jpg?sz=128", "display_name": "Sebastian Kucharzyk", "link": "https://stackoverflow.com/users/10619432/sebastian-kucharzyk"}, "edited": false, "score": 1, "creation_date": 1565197531, "post_id": 57398995, "comment_id": 101280053, "body": "@SebastianKucharzyk You are right. A definition of an inline function shall be in each compilation unit where its definition is required."}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 3, "last_activity_date": 1565201505, "last_edit_date": 1565201505, "creation_date": 1565196322, "answer_id": 57398995, "question_id": 57398905, "link": "https://stackoverflow.com/questions/57398905/constexpr-constructor-defined-in-cpp-file-causes-linking-error/57398995#57398995", "title": "Constexpr constructor defined in .cpp file causes linking error", "body": "<p>The function is implicitly an inline function. It should be defined in any compilation unit that calls it.</p>\n\n<p>From the c++17 Standard (10.1.5 The constexpr specifier)</p>\n\n<blockquote>\n  <p>1 The constexpr specifier shall be applied only to the definition of a\n  variable or variable template or the declaration of a function or\n  function template. <strong>A function or static data member declared with\n  the constexpr specifier is implicitly an inline function or\n  variable</strong>...</p>\n</blockquote>\n"}], "owner": {"reputation": 65, "user_id": 10619432, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5aW30E7zm9Y/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsZ30xMujQrPTOuRLjNargdPVy9Q/mo/photo.jpg?sz=128", "display_name": "Sebastian Kucharzyk", "link": "https://stackoverflow.com/users/10619432/sebastian-kucharzyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "closed_date": 1565196131, "accepted_answer_id": 57398995, "answer_count": 1, "score": 0, "last_activity_date": 1565201505, "creation_date": 1565195921, "last_edit_date": 1565196494, "question_id": 57398905, "link": "https://stackoverflow.com/questions/57398905/constexpr-constructor-defined-in-cpp-file-causes-linking-error", "closed_reason": "Duplicate", "title": "Constexpr constructor defined in .cpp file causes linking error", "body": "<p>I have a problem with linking constexpr constructor between two projects in one Visual Studio solution.</p>\n\n<p>I have two projects in my Visual Studio 2019 Solution: </p>\n\n<ul>\n<li>NES_Core</li>\n<li>NES_Core_Tests</li>\n</ul>\n\n<p>The first one is .lib project, the other is basic GTest project. Both use C++17.</p>\n\n<p>I have the following class declared in executor.h in NES_Core:</p>\n\n<pre><code>namespace nes::cpu::opcodes::immediate {\n    class Executor\n    {\n    public:\n        constexpr Executor(registers::Registers&amp; registers) noexcept;\n        ~Executor() = default;\n        Executor(Executor&amp; rhs) = delete;\n        Executor(Executor&amp;&amp; rhs) = delete;\n        Executor&amp; operator=(const Executor&amp; rhs) = delete;\n        Executor&amp; operator=(Executor&amp;&amp; rhs) = delete;\n    private:\n        registers::Registers&amp; registers_;\n    };\n}\n</code></pre>\n\n<p>And the definition in executor.cpp:</p>\n\n<pre><code>namespace nes::cpu::opcodes::immediate {\n    constexpr Executor::Executor(registers::Registers&amp; registers) noexcept :\n        registers_(registers)\n    {\n    }\n}\n</code></pre>\n\n<p>Later on I try to create Executor object in OpcodesImmediateExecutorTests.cpp in NES_Core_Tests project:</p>\n\n<pre><code>#include \"pch.h\"\n#include \"nes/cpu/registers/registers.h\"\n#include \"nes/cpu/opcodes/immediate/executor.h\"\n\nclass OPCodes_ : public ::testing::Test\n{\npublic:\n    OPCodes_() :\n        reg_(),\n        ie_(reg_)\n    {\n\n    }\n    nes::cpu::registers::Registers reg_;\n    nes::cpu::opcodes::immediate::Executor ie_;\n};\n</code></pre>\n\n<p>Unfortunately, it fails on linking:</p>\n\n<blockquote>\n  <p>OpcodesImmediateExecutorTests.obj : error LNK2019: unresolved external symbol \"public: __thiscall nes::cpu::opcodes::immediate::Executor::Executor(struct nes::cpu::registers::Registers &amp;)\" (??0Executor@immediate@opcodes@cpu@nes@@QAE@AAURegisters@registers@34@@Z) referenced in function \"public: __thiscall OPCodes_::OPCodes_(void)\" (??0OPCodes_@@QAE@XZ)</p>\n</blockquote>\n\n<p>What is more, when I remove constexpr keyword from .h and .cpp linking is performed just fine. Do you guys have any ideas why this could happen?</p>\n"}, {"tags": ["c++", "makefile", "cmake", "g++"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1565195249, "post_id": 57398675, "comment_id": 101278943, "body": "So the linker is telling you that <code>agent_client_register</code> etc. have not been defined. Where do you think the definitions of those functions are?"}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1565195531, "post_id": 57398675, "comment_id": 101279120, "body": "@john, in <code>Agent&#47;agent_client.cpp</code>, this file compiled to object and object added by linker, but it doesn&#39;t work, and <code>Agent&#47;agent_client.h</code> includes into <code>Agent&#47;agent_main.cpp</code> with necessary declarations."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1565195838, "post_id": 57398675, "comment_id": 101279275, "body": "I wasn&#39;t asking about <i>declarations</i>, the problem is missing <i>definitions</i>. So same question again. Do you recognise the names of these functions? Are the definitions in code you have written (or downloaded or copied or whatever). There&#39;s no indication yet that anything isn&#39;t working, so far it just seems that you simply don&#39;t have the definitions for these functions. Unless you can tell me different."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1565195998, "post_id": 57398675, "comment_id": 101279349, "body": "@user3360601 what is the content of your cpp file <code>agent_client.cpp</code>?"}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1565196392, "post_id": 57398675, "comment_id": 101279536, "body": "@john, I updated post to make you see that makefile and gcc compile that binary, cmake doesn&#39;t"}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1565196423, "post_id": 57398675, "comment_id": 101279559, "body": "@GuillaumeRacicot, this is cmake problem, because source are compilable by makefile"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1565196877, "post_id": 57398675, "comment_id": 101279763, "body": "So your cmake command has <code>libcore.so</code> where your gcc command has <code>-lcore</code>. I guess that&#39;s the issue."}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1565197149, "post_id": 57398675, "comment_id": 101279871, "body": "@john, no, because 8021qbg lib, that I mentioned in the post, builds the same way.  Cmake replace this lib name from target dependencies. This is something another"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1565197269, "post_id": 57398675, "comment_id": 101279937, "body": "@user3360601 OK, I still think it would help to know where the definitions of the missing functions are supposed to be. Otherwise it&#39;s guesswork."}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1565197612, "post_id": 57398675, "comment_id": 101280094, "body": "@john, they are all in one folder and I see these definitions"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1565205596, "post_id": 57398675, "comment_id": 101283636, "body": "@user3360601 I give up, I think you&#39;re being very obscure. This should be relatively easy, but you aren&#39;t supplying the necessary information."}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1565206544, "post_id": 57398675, "comment_id": 101284049, "body": "@john, make and gcc can build this lib, so I am confused about cmake. I don&#39;t know how to fix it."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1565207143, "post_id": 57398675, "comment_id": 101284297, "body": "I may be missing something, but the second (makefile) example produces an empty <code>libagent.so</code> because your sources are all cpp files, not listed by <code>wildcard *.c</code>"}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1565207717, "post_id": 57398675, "comment_id": 101284525, "body": "@AlexCohn, o! I will check it tomorrow, I missed that!"}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1565244752, "post_id": 57398675, "comment_id": 101293278, "body": "Good point by Alex, I was just trying to look for the *.c files in the gcc line as well. You may want to insert print line just before the $(CC) line: <code>@echo $(filter %.c,$^) </code>. Then change that to <code>@echo $(filter %.cpp,$^)</code> and also change <code>${wildcard Agent&#47;*.[c,h]}</code> -&gt; <code>${wildcard Agent&#47;*.[cpp,h]}</code>. Then I will assume that you get the same error. If so John&#39;s line of questioning comes back. Where are the missing functions defined? - i.e. where is the body of the code of function agent_client_register, i.e.: <code>agent_client_register(){...some-lines-of-code...}</code>, the linker can&#39;t find it."}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1565253828, "post_id": 57398675, "comment_id": 101297600, "body": "@john, I updated  my question , please check it if you can help me. I see that this is not about cmake problem."}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1565253836, "post_id": 57398675, "comment_id": 101297607, "body": "@code_fodder ,  I updated my question , please check it if you can help me. I see that this is not about cmake problem"}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1565253846, "post_id": 57398675, "comment_id": 101297611, "body": "@AlexCohn, I updated my question , please check it if you can help me. I see that this is not about cmake problem"}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1565255026, "post_id": 57398675, "comment_id": 101298255, "body": "@user3360601 it seems like this function <code>agent_client_register</code> is not getting compiled in the x86 machine. Can you add a line of code into that function that cuases an error like <code>bob;</code> just after <code>s_prot_id = prot_id;</code>. This should cause the compilation of that file to fail in <b>both</b> cases with <code>bob was not declared....</code> error. Can you confirm that both fail (arm gcc and x86 gcc)? I am wandering if that bit of code is #define&#39;d out or somthing like that... So if they both give that warning then both are successfully trying to compile that function body."}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1565255651, "post_id": 57398675, "comment_id": 101298597, "body": "@code_fodder, on both machines it founds &#39;bob&#39; at compiling time. <code>bob was not declared</code>, yes."}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1565255927, "post_id": 57398675, "comment_id": 101298742, "body": "@code_fodder, I updated the post with check for object agent_client.cpp.o and it has function definition inside."}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1565256434, "post_id": 57398675, "comment_id": 101299050, "body": "@code_fodder, x86 is SUSE 11 sp3 x64"}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 1, "creation_date": 1565256928, "post_id": 57398675, "comment_id": 101299370, "body": "I would try to declare <code>agent_client_register()</code> and the rest of them as <b><code>extern &quot;C&quot;</code></b> in <b>agent_client.h</b> and make sure this header is included in both  <b>agent_client.cpp</b> and <b>agent_main.cpp</b>."}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 1, "creation_date": 1565257526, "post_id": 57398675, "comment_id": 101299684, "body": "@AlexCohn, strange, that on arm machine with gcc 9.1 it is unnecessary, BUT on x86 it works! Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1565258114, "post_id": 57409746, "comment_id": 101300043, "body": "It seems that in one case, <b>gcc</b> is invoked instead of <b>g++</b>."}], "tags": [], "owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "is_accepted": false, "score": 1, "last_activity_date": 1565257659, "creation_date": 1565257659, "answer_id": 57409746, "question_id": 57398675, "link": "https://stackoverflow.com/questions/57398675/why-two-targets-linking-differently-using-cmake/57409746#57409746", "title": "Why two targets linking differently using cmake?", "body": "<p>The main point was not in cmake, and even not in make commands. I think this is about gcc versions support. On x86 I have gcc v4.3.4.</p>\n\n<p>As @AlexCohn said in the comments </p>\n\n<blockquote>\n  <p>I would try to declare agent_client_register() and the rest of them as\n  extern \"C\" in agent_client.h and make sure this header is included in\n  both agent_client.cpp and agent_main.cpp</p>\n</blockquote>\n"}], "owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565257659, "creation_date": 1565195005, "last_edit_date": 1565256413, "question_id": 57398675, "link": "https://stackoverflow.com/questions/57398675/why-two-targets-linking-differently-using-cmake", "title": "Why two targets linking differently using cmake?", "body": "<p>I have this target that compiles ok.</p>\n\n<pre><code>#\nfile(GLOB SOURCE_FILES\n        8021QBG/*.h\n        8021QBG/*.cpp\n        )\nadd_library(8021qbg SHARED\n        ${SOURCE_FILES}\n        )\nset_target_properties(8021qbg PROPERTIES LINKER_LANGUAGE CXX)\nset(CMAKE_CXX_FLAGS_CUSTOM \" \")\nset_target_properties(8021qbg PROPERTIES COMPILE_FLAGS \" ${CMAKE_CXX_FLAGS_CUSTOM} ${CMAKE_CXX_FLAGS_COMMON}\")\nadd_dependencies(8021qbg core )\ntarget_link_libraries(8021qbg  -L${PROJECT_BINARY_DIR})\ntarget_link_libraries(8021qbg  -L/home/user/protocol_so )\ntarget_link_libraries(8021qbg  -L${PROJECT_SOURCE_DIR}/lib64 )\ntarget_link_libraries(8021qbg  -L${PROJECT_SOURCE_DIR})\ntarget_link_libraries(8021qbg protocol_common thread vip core m xml2)\n\ntarget_include_directories(8021qbg PUBLIC\n        8021QBG\n        nte-encap\n        )\n</code></pre>\n\n<p>and this that fails.</p>\n\n<pre><code>#\nfile(GLOB SOURCE_FILES\n        Agent/*.h\n        Agent/*.cpp\n        )\nadd_library(agent SHARED\n        ${SOURCE_FILES}\n        )\nset_target_properties(agent PROPERTIES LINKER_LANGUAGE CXX)\nset(CMAKE_CXX_FLAGS_CUSTOM \" \")\nset_target_properties(agent PROPERTIES COMPILE_FLAGS \" ${CMAKE_CXX_FLAGS_CUSTOM} ${CMAKE_CXX_FLAGS_COMMON}\")\nadd_dependencies(agent core)\ntarget_link_libraries(agent  -L${PROJECT_BINARY_DIR})\ntarget_link_libraries(agent  -L/home/user/protocol_so )\ntarget_link_libraries(agent  -L${PROJECT_SOURCE_DIR}/lib64 )\ntarget_link_libraries(agent  -L${PROJECT_SOURCE_DIR})\ntarget_link_libraries(agent protocol_common thread vip core xml2 pthread)\ntarget_include_directories(agent PUBLIC\n        Agent\n        nte-encap\n        )\n</code></pre>\n\n<p>Also these targets have the same flags:</p>\n\n<pre><code>set (CMAKE_CXX_FLAGS_COMMON \"-g -fpermissive -std=gnu89 -Wall -O0 -m64 -fPIC -DLINUX -DCPU_64 -DXSTREAM \")\nset (CMAKE_SHARED_LINKER_FLAGS \"-Wl,--unresolved-symbols=ignore-in-shared-libs -shared -Wl,-rpath,/home/user/protocol_so:/home/user/cmake_libs/lib64:libwifi\")\nif(NOT CMAKE_CXX_CREATE_SHARED_LIBRARY)\n    set(CMAKE_CXX_CREATE_SHARED_LIBRARY\n            \"&lt;CMAKE_CXX_COMPILER&gt; &lt;CMAKE_SHARED_LIBRARY_CXX_FLAGS&gt; &lt;LANGUAGE_COMPILE_FLAGS&gt; &lt;LINK_FLAGS&gt; &lt;CMAKE_SHARED_LIBRARY_CREATE_CXX_FLAGS&gt; &lt;SONAME_FLAG&gt;&lt;TARGET_SONAME&gt; -o &lt;TARGET&gt; &lt;OBJECTS&gt; &lt;LINK_LIBRARIES&gt;\")\nendif()\n</code></pre>\n\n<p>This is linker stage</p>\n\n<pre><code>/usr/bin/g++  -fPIC -g -Wl,--unresolved-symbols=ignore-in-shared-libs -shared -Wl,-rpath,/home/user/protocol_so:/home/user/cmake_libs/lib64:libwifi -shared -Wl,-soname,libagent.so -o libagent.so CMakeFiles/agent.dir/Agent/agent_common.cpp.o CMakeFiles/agent.dir/Agent/agent_main.cpp.o CMakeFiles/agent.dir/Agent/agent_client.cpp.o CMakeFiles/agent.dir/Agent/agent_cmd.cpp.o CMakeFiles/agent.dir/Agent/agent_go.cpp.o -L/home/user/cmake_libs/cmake-build-debug-rurem -L/home/user/protocol_so -L/home/user/cmake_libs/lib64 -L/home/user/cmake_libs -lprotocol_common -lthread -lvip libcore.so -lxml2 -lpthread -L/home/user/cmake_libs/lib64 -lprotocol_common -lthread -lvip -lcrypto -lglib-2.0 -lm -lxml2 -lpthread -Wl,-rpath,/home/user/cmake_libs/cmake-build-debug-rurem \n</code></pre>\n\n<p>This is error codes</p>\n\n<pre><code>/home/user/cmake_libs/Agent/agent_main.cpp:47: undefined reference to `agent_client_register'\n/home/user/cmake_libs/Agent/agent_main.cpp:48: undefined reference to `agent_client_unregister'\n/home/user/cmake_libs/Agent/agent_main.cpp:49: undefined reference to `agent_client_register_task'\n/home/user/cmake_libs/Agent/agent_main.cpp:50: undefined reference to `agent_client_unregister_task'\n</code></pre>\n\n<p>Cmake compiles each *.cpp file to *.o object and than linker combine them in one *.so lib -> in the linker stage I got this error. </p>\n\n<p>Sources located in \"Agent\" folder and I add it to the target 'agent'.</p>\n\n<p><strong>UDP></strong>\nsimple makefile and GCC build this library.\nmakefile part:</p>\n\n<pre><code>libagent.so: ${wildcard Agent/*.[c,h]} libcore.so\n    $(CC) $(CFLAGS) -fPIC -shared -o $@ $(filter %.c,$^) $(IPATH) $(RPATH) $(TE_VIP) -lcore -lxml2 -lpthread\n</code></pre>\n\n<p>gcc command</p>\n\n<pre><code>gcc -g -Wall -O0 -m64 -Wl,--unresolved-symbols=ignore-in-shared-libs  -fPIC -shared -o libagent.so  -Inte-include -Ixst_inc -Ixst_tls -L./lib64 -L./cmake-build-debug-rurem -Wl,-rpath,/home/user/protocol_so:/home/user/lib64:libwifi -DLINUX -DCPU_64 -DXSTREAM -lprotocol_common -lthread -lvip -lcore -lxml2 -lpthread\n\n</code></pre>\n\n<p><strong>UDP#2.</strong></p>\n\n<p>on arm machine with gcc v9.1.0 it builds successfully via makefile.</p>\n\n<p>on x86 machine with gcc v4.3.4 I have such undefined referencies. </p>\n\n<p>this is compiling command</p>\n\n<pre><code>g++ -g -Wall -O0 -m64 -Wl,--unresolved-symbols=ignore-in-shared-libs  -fPIC -shared -o 0libagent.so -Inte-include -Iinc -Itls -L/home/user/cmake_libs/lib64 -L/home/user/cmake_libs -Wl,-rpath,/home/user/protocol_so:/home/user/cmake_libs/lib64:libwifi -DLINUX -DCPU_64 -DXSTREAM -lprotocol_common -lthread -lvip -lcore -lxml2 -lpthread Agent/agent_main.cpp Agent/agent_cmd.cpp Agent/agent_client.cpp Agent/agent_go.cpp Agent/agent_common.cpp\n</code></pre>\n\n<p>This is piece of <code>agent_main.cpp</code> that causes errors:\n<a href=\"https://i.stack.imgur.com/NmGDt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NmGDt.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is function that defined in <code>agent_client.cpp</code> that causes undefined reference\n<a href=\"https://i.stack.imgur.com/Lipwd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lipwd.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>UPD#3</strong></p>\n\n<p>nm says that definitions are in objects.</p>\n\n<pre><code>&gt; nm CMakeFiles/agent.dir/Agent/agent_client.cpp.o\n...\n00000000000007e2 T _Z21agent_client_registeriP20_protocol_callback_t\n0000000000000000 T _Z21agent_client_run_taskiPv\n0000000000000033 T _Z22agent_client_do_actionPviS_S_\n...\n</code></pre>\n\n<p><strong>x86 machine - SUSE 11 sp3 x64</strong></p>\n\n<p>Why it fails? \nHow to fix it?</p>\n"}, {"tags": ["c++", "codeblocks"], "comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1565194660, "post_id": 57398519, "comment_id": 101278652, "body": "&quot;Sometimes&quot;? Consistently? For what input? We like <a href=\"https://stackoverflow.com/help/mcve\">minimal complete examples</a> here."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 4, "creation_date": 1565194666, "post_id": 57398519, "comment_id": 101278655, "body": "You&#39;re relying on exact equality of floating-point numbers. That&#39;s a bad idea and often goes wrong. When it goes wrong, you probably get a ... stack overflow"}, {"owner": {"reputation": 105, "user_id": 11847831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2c611db1be095a29fe47c424d0c560?s=128&d=identicon&r=PG&f=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/11847831/matteo"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1565194968, "post_id": 57398519, "comment_id": 101278809, "body": "@Useless: long double has a very big precision: it can&#39;t be an overflow."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 3, "creation_date": 1565195204, "post_id": 57398519, "comment_id": 101278916, "body": "And: stack overflow is not floating-point overflow. It means your recursion doesn&#39;t terminate in a reasonable number of levels."}, {"owner": {"reputation": 105, "user_id": 11847831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2c611db1be095a29fe47c424d0c560?s=128&d=identicon&r=PG&f=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/11847831/matteo"}, "edited": false, "score": 0, "creation_date": 1565195272, "post_id": 57398519, "comment_id": 101278958, "body": "Is there any way to bypass this error?"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 4, "creation_date": 1565195375, "post_id": 57398519, "comment_id": 101279017, "body": "1/ Don&#39;t use floating point. Or 2/ decide on the level of precision you really need, choose an appropriate value for <code>epsilon</code>, and use the expression I already showed you. Oh, and it might be worth reading <a href=\"https://stackoverflow.com/q/588004/212858\">this</a> other question for background."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565197348, "post_id": 57398519, "comment_id": 101279972, "body": "Handy reading: <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a> and <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">What Every Computer Scientist Should Know About Floating-Point Arithmetic</a>"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1565199361, "post_id": 57398519, "comment_id": 101280913, "body": "Recommended reading: <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">What Every Computer Scientist Should Know About Floating-Point Arithmetic</a> , <a href=\"https://stackoverflow.com/q/588004/5910058\">Is floating point math broken?</a> , <a href=\"https://randomascii.wordpress.com/2017/06/19/sometimes-floating-point-math-is-perfect/\" rel=\"nofollow noreferrer\">Sometimes Floating Point Math is Perfect</a> . Please read and comprehend all 3, then try again."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 11847831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2c611db1be095a29fe47c424d0c560?s=128&d=identicon&r=PG&f=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/11847831/matteo"}, "edited": false, "score": 0, "creation_date": 1565195214, "post_id": 57398701, "comment_id": 101278927, "body": "Error: &#39;root&#39; was not declared in this scope"}, {"owner": {"reputation": 105, "user_id": 11847831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2c611db1be095a29fe47c424d0c560?s=128&d=identicon&r=PG&f=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/11847831/matteo"}, "edited": false, "score": 0, "creation_date": 1565195345, "post_id": 57398701, "comment_id": 101278999, "body": "Error: expected &#39;,&#39; or &#39;;&#39; before &#39;return&#39;"}, {"owner": {"reputation": 21554, "user_id": 1329296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1026699dbf4140d3fc7262842428e808?s=128&d=identicon&r=PG", "display_name": "lenik", "link": "https://stackoverflow.com/users/1329296/lenik"}, "reply_to_user": {"reputation": 105, "user_id": 11847831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2c611db1be095a29fe47c424d0c560?s=128&d=identicon&r=PG&f=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/11847831/matteo"}, "edited": false, "score": 0, "creation_date": 1565195570, "post_id": 57398701, "comment_id": 101279141, "body": "sorry for syntax, i&#39;m writing python code most of the time"}], "tags": [], "owner": {"reputation": 21554, "user_id": 1329296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1026699dbf4140d3fc7262842428e808?s=128&d=identicon&r=PG", "display_name": "lenik", "link": "https://stackoverflow.com/users/1329296/lenik"}, "is_accepted": false, "score": 1, "last_activity_date": 1565196900, "last_edit_date": 1565196900, "creation_date": 1565195081, "answer_id": 57398701, "question_id": 57398519, "link": "https://stackoverflow.com/questions/57398519/problem-with-a-recursive-function-check-if-a-number-is-a-perfect-square/57398701#57398701", "title": "Problem with a recursive function (check if a number is a perfect square)", "body": "<p>Try this:</p>\n\n<pre><code>#include &lt;cmath&gt;\n\nbool isPerfectSquare( long num ) {\n    long root = long(sqrt(float(num)));\n    return root * root == num;\n}\n</code></pre>\n\n<p>You'll get <code>True</code> if <code>num</code> is a perfect square or <code>False</code> if not.</p>\n"}, {"comments": [{"owner": {"reputation": 21554, "user_id": 1329296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1026699dbf4140d3fc7262842428e808?s=128&d=identicon&r=PG", "display_name": "lenik", "link": "https://stackoverflow.com/users/1329296/lenik"}, "edited": false, "score": 0, "creation_date": 1565197301, "post_id": 57399198, "comment_id": 101279949, "body": "should not use a recursion where a simple loop will suffice"}, {"owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "reply_to_user": {"reputation": 21554, "user_id": 1329296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1026699dbf4140d3fc7262842428e808?s=128&d=identicon&r=PG", "display_name": "lenik", "link": "https://stackoverflow.com/users/1329296/lenik"}, "edited": false, "score": 1, "creation_date": 1565197481, "post_id": 57399198, "comment_id": 101280032, "body": "It compiles to a loop, and the asker seemed to want to do things recursively"}], "tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": false, "score": 1, "last_activity_date": 1565197742, "last_edit_date": 1592644375, "creation_date": 1565197226, "answer_id": 57399198, "question_id": 57398519, "link": "https://stackoverflow.com/questions/57398519/problem-with-a-recursive-function-check-if-a-number-is-a-perfect-square/57399198#57399198", "title": "Problem with a recursive function (check if a number is a perfect square)", "body": "<p>You're probably getting a stack overflow error (which is when you use up the entirety of a thread's stack, and it crashes). If you compile with optimizations enabled, the compiler should be able to optimize <code>Square</code> so that it's tail-recursive, which will prevent the stack overflow error.</p>\n<p>That being said, we can make <code>Square</code> shorter and friendlier to optimization by removing the references, and just calculating the multiplication directly (which is very cheap):</p>\n<pre><code>bool is_square(long long k, long long n = 0) {\n    if(n * n &gt;= k)\n        return n * n == k;\n    else\n        return is_square(k, n + 1);\n}\n</code></pre>\n<p>With optimization turned on (use the <code>-O2</code> compiler flag for gcc and clang, or <code>/Ox</code> for msvc), <a href=\"https://godbolt.org/z/JTXV9s\" rel=\"nofollow noreferrer\"><strong>this compiles to a simple loop</strong></a>:</p>\n<pre><code>is_square(long long, long long):\n        mov     rax, rsi\n        imul    rax, rsi\n        cmp     rdi, rax\n        jle     .L3\n.L2:\n        add     rsi, 1\n        mov     rax, rsi\n        imul    rax, rsi\n        cmp     rax, rdi\n        jl      .L2\n.L3:\n        cmp     rdi, rax\n        sete    al\n        ret\n</code></pre>\n<h3>Fast solution using <code>cmath</code> library:</h3>\n<pre><code>#include &lt;cmath&gt;\n\nbool is_square(long long k) {\n    long double real_root = sqrt((long double)k); \n    long long integral_root = llround(real_root);\n    return integral_root * integral_root == k;\n}\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 11847831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2c611db1be095a29fe47c424d0c560?s=128&d=identicon&r=PG&f=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/11847831/matteo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "closed_date": 1565709816, "answer_count": 2, "score": -2, "last_activity_date": 1565197742, "creation_date": 1565194407, "last_edit_date": 1565194849, "question_id": 57398519, "link": "https://stackoverflow.com/questions/57398519/problem-with-a-recursive-function-check-if-a-number-is-a-perfect-square", "closed_reason": "Not suitable for this site", "title": "Problem with a recursive function (check if a number is a perfect square)", "body": "<p>I'm trying to write, in CodeBlocks, a recursive function that check if a natural number (a long double) is a perfect square. This function called \"Square\" takes in input, by reference, the long double S and n (setted in the beginning at 1), a bool T and the long double to compare. </p>\n\n<p>Here the code:</p>\n\n<pre><code>void Square(long double&amp; S, long double&amp; n, bool&amp; T,long double k){\n        S=S+2*n+1;\n        n++;\n        if(S==k){\n             T=true;\n        }\n\n        if(S&gt;k){\n            T=false;\n\n        }\n\n        if(S&lt;k){\n            Square(S,n,T,k);\n        }\n}\n</code></pre>\n\n<p>And in the main function:</p>\n\n<pre><code>long double S,n,k;\n\nbool T=false;\n\nfor(long double b=1;b&lt;50000;b++){\n\n    for(long double a=1;a&lt;b;a++){\n\n        S=1;\n        n=1;\n        T=false;\n\n        k=12*a*b*b*b-3*a*a*a*a;\n\n        Square(S,n,T,k);\n\n        if(T==true){\n            cout&lt;&lt;a&lt;&lt;\"    \"&lt;&lt;b&lt;&lt;\"   \"&lt;&lt;k&lt;&lt;endl;\n        }\n    }\n}\n</code></pre>\n\n<p>Sometimes occours this error: \"Process returned -1073741571 (0xC00000FD)\" (for example when (a = 108 and b = 121) and the program stops. Any help?</p>\n"}, {"tags": ["c++", "modulo"], "comments": [{"owner": {"reputation": 27334, "user_id": 7758804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UBA7j.jpg?s=128&g=1", "display_name": "Trenton McKinney", "link": "https://stackoverflow.com/users/7758804/trenton-mckinney"}, "edited": false, "score": 1, "creation_date": 1565197003, "post_id": 57398512, "comment_id": 101279813, "body": "<a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question</a> &amp;  <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal, Reproducible Example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1565197338, "post_id": 57399017, "comment_id": 101279966, "body": "Well you have to take the exact limit (as in my answer), otherwise you won&#39;t get the correct answer in some cases (for ex. if N is 5 &#215; 10^18 and K is 2 &#215; 10^9)."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1565228096, "post_id": 57399017, "comment_id": 101289680, "body": "@Phil1970 the condition is that N \u2a7d 10&#185;\u2078 so what you said never happens"}], "tags": [], "owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1565196424, "creation_date": 1565196424, "answer_id": 57399017, "question_id": 57398512, "link": "https://stackoverflow.com/questions/57398512/how-to-use-modulo-when-denominator-is-out-of-unsigned-long-long-int-bounds/57399017#57399017", "title": "How to use modulo when denominator is out of unsigned long long int bounds?", "body": "<p>You don't really need a bigint library because</p>\n\n<ul>\n<li>if K > 10<sup>9</sup> then K<sup>2</sup> > 10<sup>18</sup> > N, hence N % K<sup>2</sup> = N. No need to calculate K<sup>2</sup></li>\n<li>if K \u2a7d 10<sup>9</sup> then you can calculate <code>N % (K*K)</code> using the normal <code>uint64_t</code> without overflow</li>\n</ul>\n\n<p>FWIW there's also a 128-bit type in most modern compilers in 64-bit mode. GCC, Clang and ICC call it <a href=\"https://gcc.gnu.org/onlinedocs/gcc/_005f_005fint128.html\" rel=\"nofollow noreferrer\"><code>__int128</code></a></p>\n\n<p>See <a href=\"https://stackoverflow.com/q/16088282/995714\">Is there a 128 bit integer in gcc?</a></p>\n"}, {"tags": [], "owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "is_accepted": true, "score": 0, "last_activity_date": 1575342536, "last_edit_date": 1575342536, "creation_date": 1565196987, "answer_id": 57399137, "question_id": 57398512, "link": "https://stackoverflow.com/questions/57398512/how-to-use-modulo-when-denominator-is-out-of-unsigned-long-long-int-bounds/57399137#57399137", "title": "How to use modulo when denominator is out of unsigned long long int bounds?", "body": "<p>Well if <strong>K<sup>2</sup></strong> is bigger than <strong>N</strong> then <strong>N % K<sup>2</sup></strong> is equal to <strong>N</strong>.</p>\n\n<p>Example:</p>\n\n<blockquote>\n  <p>253 % 17<sup>2</sup> = 253 % 289 = 253</p>\n</blockquote>\n\n<p>Assuming 64-bit <code>unsigned long long</code>, the maximum value that can be squared without overflow is 2<sup>32</sup> - 1 which is equal to 0xFFFFFFFF (or 4'294'967'295).</p>\n\n<p>Thus you can simply have the following code:</p>\n\n<pre><code>unsigned long long compute(unsigned long long n, unsigned long long k)\n{\n    if (k &gt; 0xFFFFFFFF)\n    {\n        // k\u00b2 is bigger than n (require more than 64 bits), so the modulo is n\n        return n;\n    }\n\n     return n % (k * k);\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10600034, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xyaRQJcUCPs/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBk2BHTlRGfT7xGn5L2onx0EjkXug/mo/photo.jpg?sz=128", "display_name": "Mandar Pande", "link": "https://stackoverflow.com/users/10600034/mandar-pande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 57399137, "answer_count": 2, "score": 0, "last_activity_date": 1575342536, "creation_date": 1565194378, "last_edit_date": 1565228193, "question_id": 57398512, "link": "https://stackoverflow.com/questions/57398512/how-to-use-modulo-when-denominator-is-out-of-unsigned-long-long-int-bounds", "title": "How to use modulo when denominator is out of unsigned long long int bounds?", "body": "<p>Given 1 \u2264 N \u2264 10<sup>18</sup> and 1 \u2264 K \u2264 10<sup>18</sup>, how do I do the operation N % K<sup>2</sup>? The K<sup>2</sup> (Denominator) goes out of bounds for unsigned long long int when K is near the value 10<sup>18</sup>, so I cannot store the value K2.</p>\n"}, {"tags": ["c++", "boost", "gzip", "boost-iostreams"], "comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1565193137, "post_id": 57398069, "comment_id": 101277916, "body": "In the underlying gzip library you have to keep the same gzip stream structure instance live between calls, so I guess similarly that you need to keep the same instance returned by gzip_decompressor() between calls"}, {"owner": {"reputation": 666, "user_id": 1788702, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f03cebcc66a47a156a3bf0af1d13541?s=128&d=identicon&r=PG", "display_name": "igor", "link": "https://stackoverflow.com/users/1788702/igor"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1565193212, "post_id": 57398069, "comment_id": 101277956, "body": "I tried that, but seems like I can&#39;t &#39;push&#39; more data, or it needed to be pushed in some different way"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1565193757, "post_id": 57398069, "comment_id": 101278228, "body": "Or is it the instance of filtering_streambuf&lt;input&gt; decompress? And only push the decompressor the first time?"}, {"owner": {"reputation": 666, "user_id": 1788702, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f03cebcc66a47a156a3bf0af1d13541?s=128&d=identicon&r=PG", "display_name": "igor", "link": "https://stackoverflow.com/users/1788702/igor"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1565193913, "post_id": 57398069, "comment_id": 101278298, "body": "Yes, I made it a class were the filtering_streambuf&lt;input&gt; is a class member, and I set the gzip_decompressor() in the constructor. Then fire message I push is fine (correctly decompressed), but the second one cause an error"}], "owner": {"reputation": 666, "user_id": 1788702, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f03cebcc66a47a156a3bf0af1d13541?s=128&d=identicon&r=PG", "display_name": "igor", "link": "https://stackoverflow.com/users/1788702/igor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565193285, "creation_date": 1565192651, "last_edit_date": 1565193285, "question_id": 57398069, "link": "https://stackoverflow.com/questions/57398069/boost-gzip-chunked-data-decompose", "title": "Boost Gzip chunked data decompose", "body": "<p>I'm trying to you boost::iostreams library to decompose gziped data.\nI do able to do that for simple data.</p>\n\n<pre><code>TEST_F(GzipTest, ZipStringChuncks)\n{\n    using namespace boost::iostreams;\n\n    string str_part1 { \n        char(0x1f), char(0x8b), char(0x08), char(0x00), char(0xca), char(0xb5),\n        char(0x07), char(0x53), char(0x00), char(0x03), char(0xcb), char(0x48),\n        char(0xcd), char(0xc9), char(0xc9), char(0x57), char(0x28), char(0xcf),\n        char(0x2f), char(0xca), char(0x49), char(0xe1), char(0x02), char(0x00),\n        char(0x2d), char(0x3b), char(0x08), char(0xaf), char(0x0c), char(0x00),\n        char(0x00), char(0x00)\n    };\n\n    filtering_streambuf&lt;input&gt; decompress;\n    decompress.push(gzip_decompressor());\n    decompress.push(boost::iostreams::array_source(str_part1.data(), str_part1.size()));\n\n    stringstream sstream_decompress;\n    try {\n        boost::iostreams::copy(decompress, sstream_decompress);\n    } catch (const gzip_error &amp;exception) {\n        EXPECT_TRUE(false) &lt;&lt; exception.what() &lt;&lt; endl;\n    } catch (...) {\n        EXPECT_TRUE(false) &lt;&lt; \"ERROR GZIP\" &lt;&lt; endl;\n    }\n\n    string unziped_str = sstream_decompress.str();\n    EXPECT_EQ(unziped_str, \"hello world\\n\");\n}\n</code></pre>\n\n<p>The issue is that I need to decompress chunks of related data coming from the network. So I need to be able to decompress the first one before I get the second one. When the second one arrives as I understand it should be aware of the first one some how.</p>\n\n<p>I need something like this:</p>\n\n<pre><code>string some_data = \"...data...\";\nstring chunks[2] = compress_in_chunks(some_data);\nfor(string chunk in chunks) {\n    string decompressed_str = decompress(chunk); \n    cout &lt;&lt; decompressed_str &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Is there a way to do it with boost? </p>\n\n<p>Couldn't find detailed documentation only few examples.  </p>\n"}, {"tags": ["c++", "unit-testing", "c++11", "compiler-optimization"], "comments": [{"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 5, "creation_date": 1565192635, "post_id": 57398001, "comment_id": 101277656, "body": "Replace <code>if</code> with <code>if constexpr</code> and the compiler will definitely remove your code"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565193007, "post_id": 57398001, "comment_id": 101277848, "body": "The typical way to guard against this is to use compile time dispatch.  Instead of having an unconditional loop, you test <code>T</code> for its characteristics.  If it is a built in type, then you never even call the loop so you <b>know</b> it isn&#39;t taken."}, {"owner": {"reputation": 763, "user_id": 1844547, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6940d1a1ecbaf9e0c1168a5e42595c34?s=128&d=identicon&r=PG", "display_name": "Borph", "link": "https://stackoverflow.com/users/1844547/borph"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565193149, "post_id": 57398001, "comment_id": 101277920, "body": "@NathanOliver for the loop that&#39;s the current way but falls into my &quot;I would do it simpler&quot; and get away with it, hence the question."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 4, "creation_date": 1565194447, "post_id": 57398001, "comment_id": 101278552, "body": "Are you saying that, in the automotive industry, you use compilers that are &quot;exceptionally buggy&quot; yet regardless &quot;certified&quot;? Isn&#39;t this incredibly bad news? Do you have a plan to resolve this problem and potentialy save lives?"}, {"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1565203454, "post_id": 57398001, "comment_id": 101282653, "body": "Performance is measured with a profiler. You can always measure performance in a unit test if you want to ensure that a particular function don\u2019t take too much time to execute."}, {"owner": {"reputation": 763, "user_id": 1844547, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6940d1a1ecbaf9e0c1168a5e42595c34?s=128&d=identicon&r=PG", "display_name": "Borph", "link": "https://stackoverflow.com/users/1844547/borph"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1565252515, "post_id": 57398001, "comment_id": 101296911, "body": "@LightnessRacesinOrbit unfortunately everything is very commercial. A GCC or Clang is superior in a lot of terms, but doesn&#39;t have qualification for safety relevant functionality. Some not-done optimizations are probably not priority."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1565271749, "post_id": 57398001, "comment_id": 101308165, "body": "@Borph Missed optimisations are one thing; you suggested there were many outright bugs, though!"}, {"owner": {"reputation": 763, "user_id": 1844547, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6940d1a1ecbaf9e0c1168a5e42595c34?s=128&d=identicon&r=PG", "display_name": "Borph", "link": "https://stackoverflow.com/users/1844547/borph"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1565359980, "post_id": 57398001, "comment_id": 101341866, "body": "@LightnessRacesinOrbit Well, mainly they are bad in terms of standard-compliance and optimization (just got shocked today). But there are (few) outright bugs sometimes, too! They get reported back and such, but hey, I sometimes get the impression that expensive certified compilers are just taken to be able to sue someone if something bad happens in the field :-(."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1565360182, "post_id": 57398001, "comment_id": 101341990, "body": "@Borph Lol nice"}], "answers": [{"comments": [{"owner": {"reputation": 763, "user_id": 1844547, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6940d1a1ecbaf9e0c1168a5e42595c34?s=128&d=identicon&r=PG", "display_name": "Borph", "link": "https://stackoverflow.com/users/1844547/borph"}, "edited": false, "score": 0, "creation_date": 1565253653, "post_id": 57398162, "comment_id": 101297502, "body": "That&#39;s not as generic as expected, but a viable idea! You can have any dummy string literal passed into a function or so. If it&#39;s optimized out, you know the whole block was optimized out."}, {"owner": {"reputation": 4501, "user_id": 5747415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WgeaU.jpg?s=128&g=1", "display_name": "Dirk Herrmann", "link": "https://stackoverflow.com/users/5747415/dirk-herrmann"}, "edited": false, "score": 0, "creation_date": 1565302872, "post_id": 57398162, "comment_id": 101321831, "body": "Good approach - better than the constexpr approach, because unless I am mistaken even with the constexpr you can not be sure the code is not compiled in: The compiler could still put in some redundant conditional check that loads a constant 0 from memory (which could be the compile-time result of the constexpr) and checks it to be a non-zero value."}], "tags": [], "owner": {"reputation": 355, "user_id": 2384326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e3bc1752929650ff7a2e7d757652cd9?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/2384326/brian"}, "is_accepted": false, "score": 4, "last_activity_date": 1565192976, "creation_date": 1565192976, "answer_id": 57398162, "question_id": 57398001, "link": "https://stackoverflow.com/questions/57398001/how-to-ensure-some-code-is-optimized-away/57398162#57398162", "title": "How to ensure some code is optimized away?", "body": "<p>There may be a more elegant way, and it's not a unit test, but if you're just looking for that particular string, and you can make it unique, </p>\n\n<pre><code>strings $COMPILED_BINARY | grep \"Arg was\"\n</code></pre>\n\n<p>should show you if the string is being included</p>\n"}, {"comments": [{"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1565195054, "post_id": 57398456, "comment_id": 101278843, "body": "But does this really answer the question if <code>The compilers might be certified but are exceptionally buggy</code> is one reason/concerns why the OP wants to do unit testing? Even though the compiler has to optimize the <code>constexpr</code> away, it might be buggy in the given case and that portion of the code might find its way into the compilation."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 1, "creation_date": 1565195396, "post_id": 57398456, "comment_id": 101279035, "body": "@t.niese If the compiler&#39;s behavior cannot be relied upon, then there is no possible answer that would satisfy the OP&#39;s requirements. I&#39;m operating under the understanding that &quot;the compilers are buggy&quot; is colloquial synedoche for &quot;I&#39;m worried that what we&#39;re doing is non-standard behavior, and thus cannot be relied upon for other environments&quot;. If the compilers the OP is using are truly buggy or unreliable, then the only possible advice we could give them is &quot;stop using a buggy compiler&quot;."}, {"owner": {"reputation": 763, "user_id": 1844547, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6940d1a1ecbaf9e0c1168a5e42595c34?s=128&d=identicon&r=PG", "display_name": "Borph", "link": "https://stackoverflow.com/users/1844547/borph"}, "edited": false, "score": 0, "creation_date": 1565251978, "post_id": 57398456, "comment_id": 101296649, "body": "@Xirema That&#39;s a nice solution and helpful, but C++17 only and unfortunately we have only C++11. :-("}, {"owner": {"reputation": 763, "user_id": 1844547, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6940d1a1ecbaf9e0c1168a5e42595c34?s=128&d=identicon&r=PG", "display_name": "Borph", "link": "https://stackoverflow.com/users/1844547/borph"}, "reply_to_user": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1565252274, "post_id": 57398456, "comment_id": 101296783, "body": "@t.niese True, you are really safe only when you test it. But it&#39;s a nice feature enforcing the compiler&#39;s decision similar to template specialization tricks."}], "tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": false, "score": 4, "last_activity_date": 1565194139, "creation_date": 1565194139, "answer_id": 57398456, "question_id": 57398001, "link": "https://stackoverflow.com/questions/57398001/how-to-ensure-some-code-is-optimized-away/57398456#57398456", "title": "How to ensure some code is optimized away?", "body": "<p><code>if constexpr</code> is the canonical C++ expression (since C++17) for this kind of test.</p>\n\n<pre><code>constexpr bool DEBUG = /*...*/;\n\nint main() {\n    if constexpr(DEBUG) {\n        std::cerr &lt;&lt; \"We are in debugging mode!\" &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>If <code>DEBUG</code> is false, then the code to print to the console won't generate at all. So if you have things like log statements that you need for checking the behavior of your code, but which you don't want to interact with in production code, you can hide them inside <code>if constexpr</code> expressions to eliminate the code entirely once the code is moved to production.</p>\n"}, {"tags": [], "owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "is_accepted": false, "score": 3, "last_activity_date": 1565198488, "creation_date": 1565198488, "answer_id": 57399469, "question_id": 57398001, "link": "https://stackoverflow.com/questions/57398001/how-to-ensure-some-code-is-optimized-away/57399469#57399469", "title": "How to ensure some code is optimized away?", "body": "<p>Looking at your question, I see several (sub-)questions in it that require an answer. Not all answers might be possible with your bare-metal compilers as hardware vendors don't care that much about C++.</p>\n\n<p>The first question is: How do I write code in a way that I'm sure it gets optimized. The obvious answer here is to put everything in a single compilation unit so the caller can see the implementation.</p>\n\n<p>The second question is: How can I force a compiler to optimize. Here <code>constexpr</code> is a bless. Depending on whether you have support for C++11, C++14, C++17 or even the upcoming C++20, you'll get different feature sets of what you can do in a constexpr function. For the usage:</p>\n\n<pre><code>constexpr char c = std::string_view{\"my_very_long_string\"}[7];\n</code></pre>\n\n<p>With the code above, <code>c</code> is defined as a constexpr variable. Because you apply it to the variable, you require some things:</p>\n\n<ul>\n<li>Your compiler should optimize the code so the value of <code>c</code> is known at compile time. This even holds true for -O0 builds!</li>\n<li>All functions used for calculate <code>c</code> are constexpr and available. (and by result, enforce the behaviour of the first question)</li>\n<li>No undefined behaviour is allowed to be triggered in the calculation of <code>c</code>. (For the given value)</li>\n</ul>\n\n<p>The negative about this is: Your input needs to be known at compile time.</p>\n\n<p>C++17 also provides <code>if constexpr</code> which has similar requirements: condition needs to be calculated at compile time. The result is that 1 branch of the code ain't allowed to be compiled (as it even can contain elements that don't work on the type you are using).</p>\n\n<p>Which than brings us to the question: How do I ensure sufficient optimizations for my program to run fast enough, even if my compiler ain't well behaving. Here the only relevant answer is: create benchmarks and compare the results. Take the effort to setup a CI job that automates this for you. (And yes, you can even use external hardware although not being that easy) In the end, you have some requirements: handling A should take less than X seconds. Do A several times and time it. Even if they don't handle everything, as long as it's within the requirements, its fine.</p>\n\n<p>Note: As this is about debug, you most likely can track the size of an executable as well. As soon as you start using streams, a lot of conversions to string ... your exe size will grow. (And you'll find it a bless as you will immediately find commits which add 10% to the image size)</p>\n\n<p>And than the final question: You have a buggy compiler, it doesn't meet my requirements. Here the only answer is: Replace it. In the end, you can use any compiler to compiler your code to bare metal, as long as the linker scripts work. If you need a start, <a href=\"https://youtu.be/c9Xt6Me3mJ4\" rel=\"nofollow noreferrer\">C++Now 2018: Michael Caisse \u201cModern C++ in Embedded Systems\u201d</a> gives you a very good idea of what you need to use a different compiler. (Like a recent Clang or GCC, on which you even can log bugs if the optimization ain't good enough)</p>\n"}, {"tags": [], "owner": {"reputation": 4501, "user_id": 5747415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WgeaU.jpg?s=128&g=1", "display_name": "Dirk Herrmann", "link": "https://stackoverflow.com/users/5747415/dirk-herrmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1565304246, "creation_date": 1565304246, "answer_id": 57421516, "question_id": 57398001, "link": "https://stackoverflow.com/questions/57398001/how-to-ensure-some-code-is-optimized-away/57421516#57421516", "title": "How to ensure some code is optimized away?", "body": "<p>This is not an answer to \"How to ensure some code is optimized away?\" but to your summary line \"Can a unit test be written that e.g. whole loops are optimized away?\".</p>\n\n<p>First, the answer depends on how far you see the scope of unit-testing - so if you put in performance tests, you might have a chance.</p>\n\n<p>If in contrast you understand unit-testing as a way to test the functional behaviour of the code, you don't.  For one thing, optimizations (if the compiler works correctly) shall not change the behaviour of standard-conforming code.</p>\n\n<p>With incorrect code (code that has undefined behaviour) optimizers can do what they want.  (Well, for code with undefined behaviour the compiler can do it also in the non-optimizing case, but sometimes only the deeper analyses peformed during optimization make it possible for the compiler to detect that some code has undefined behaviour.)  Thus, if you write unit-tests for some piece of code with undefined behaviour, the test results may differ when you run the tests with and without optimization.  But, strictly speaking, this only tells you that the compiler translated the code both times in a different way - it does not guarantee you that the code is optimized in the way you want it to be.</p>\n"}, {"comments": [{"owner": {"reputation": 13842, "user_id": 759253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0136e90dfd678a82c1dbba77dcbfc28e?s=128&d=identicon&r=PG", "display_name": "Igor R.", "link": "https://stackoverflow.com/users/759253/igor-r"}, "edited": false, "score": 0, "creation_date": 1601159303, "post_id": 64082971, "comment_id": 113320006, "body": "But the compiler doesn&#39;t see \u2019nop\u2019 implementation, so it cannot optimize it out! It will always fail at link-time."}, {"owner": {"reputation": 394, "user_id": 14347140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438f080441f199a5a3b2ec37eb4d21e9?s=128&d=identicon&r=PG", "display_name": "kisch", "link": "https://stackoverflow.com/users/14347140/kisch"}, "reply_to_user": {"reputation": 13842, "user_id": 759253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0136e90dfd678a82c1dbba77dcbfc28e?s=128&d=identicon&r=PG", "display_name": "Igor R.", "link": "https://stackoverflow.com/users/759253/igor-r"}, "edited": false, "score": 0, "creation_date": 1601160073, "post_id": 64082971, "comment_id": 113320151, "body": "Shame on me. You&#39;re right of course. It would work for the OP&#39;s second example, though. I put the solution into the first example without thinking. Please allow me to fix my badness."}, {"owner": {"reputation": 763, "user_id": 1844547, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6940d1a1ecbaf9e0c1168a5e42595c34?s=128&d=identicon&r=PG", "display_name": "Borph", "link": "https://stackoverflow.com/users/1844547/borph"}, "edited": false, "score": 0, "creation_date": 1601455103, "post_id": 64082971, "comment_id": 113410457, "body": "That is a great idea! When this works, it&#39;s my favourite solution, as it&#39;s portable and generic."}], "tags": [], "owner": {"reputation": 394, "user_id": 14347140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438f080441f199a5a3b2ec37eb4d21e9?s=128&d=identicon&r=PG", "display_name": "kisch", "link": "https://stackoverflow.com/users/14347140/kisch"}, "is_accepted": false, "score": 1, "last_activity_date": 1601160354, "last_edit_date": 1601160354, "creation_date": 1601158373, "answer_id": 64082971, "question_id": 57398001, "link": "https://stackoverflow.com/questions/57398001/how-to-ensure-some-code-is-optimized-away/64082971#64082971", "title": "How to ensure some code is optimized away?", "body": "<p>Insert a reference to external data or function into the block that should be verified to be optimised away. Like this:</p>\n<pre><code>extern void nop();\nconstexpr bool isDebugging = false; // somehow a global flag\nvoid foo(int arg) {\n    if( isDebugging ) {\n        nop();\n        std::cout &lt;&lt; &quot;Arg was &quot; &lt;&lt; arg &lt;&lt; std::endl; // may not appear in production binary!\n    }\n    // normal code here...\n}\n</code></pre>\n<p>In Debug-Builds, link with an implementation of nop() in a extra compilation unit nop.cpp:</p>\n<pre><code>void nop() {}\n</code></pre>\n<p>In Release-Builds, don't provide an implementation.\nRelease builds will only link if the optimisable code is eliminated.</p>\n<p>`- kisch</p>\n"}, {"comments": [{"owner": {"reputation": 763, "user_id": 1844547, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6940d1a1ecbaf9e0c1168a5e42595c34?s=128&d=identicon&r=PG", "display_name": "Borph", "link": "https://stackoverflow.com/users/1844547/borph"}, "edited": false, "score": 0, "creation_date": 1601564366, "post_id": 64083423, "comment_id": 113452656, "body": "That&#39;s a good hint for example 1, but unfortunately very specific for one compiler. To have a good feeling about optimization, a check for all compilers we support would be needed."}], "tags": [], "owner": {"reputation": 394, "user_id": 14347140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438f080441f199a5a3b2ec37eb4d21e9?s=128&d=identicon&r=PG", "display_name": "kisch", "link": "https://stackoverflow.com/users/14347140/kisch"}, "is_accepted": false, "score": 0, "last_activity_date": 1601163744, "last_edit_date": 1601163744, "creation_date": 1601162980, "answer_id": 64083423, "question_id": 57398001, "link": "https://stackoverflow.com/questions/57398001/how-to-ensure-some-code-is-optimized-away/64083423#64083423", "title": "How to ensure some code is optimized away?", "body": "<p>Here's another different way that also covers the first example.\nYou can verify (at runtime) that the code has been eliminated, by comparing two labels placed around it.</p>\n<p>This relies on the GCC extension &quot;Labels as Values&quot; <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html</a></p>\n<pre><code>before:\n    for(size_t i = 0; i&lt;elements; i++)\n        buffer[i].~T();\nbehind:\n    if (intptr_t(&amp;&amp;behind) != intptr_t(&amp;&amp;before)) abort();\n</code></pre>\n<p>It would be nice if you could check this in a static_assert(), but sadly the difference of &amp;&amp;label expressions is not accepted as compile-time constant.</p>\n<p>GCC insists on inserting a runtime comparison, even though both labels are in fact at the same address.</p>\n<p>Interestingly, if you compare the addresses (type void*) directly, without casting them to intptr_t, GCC falsely optimises away the if() as &quot;always true&quot;, whereas clang correctly optimises away the complete if() as &quot;always false&quot;, even at -O1.</p>\n"}, {"tags": [], "owner": {"reputation": 394, "user_id": 14347140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438f080441f199a5a3b2ec37eb4d21e9?s=128&d=identicon&r=PG", "display_name": "kisch", "link": "https://stackoverflow.com/users/14347140/kisch"}, "is_accepted": false, "score": 1, "last_activity_date": 1601169526, "creation_date": 1601169526, "answer_id": 64083931, "question_id": 57398001, "link": "https://stackoverflow.com/questions/57398001/how-to-ensure-some-code-is-optimized-away/64083931#64083931", "title": "How to ensure some code is optimized away?", "body": "<p>Here's another nice solution using inline assembly.\nThis uses assembler directives only, so it might even be kind of portable (checked with clang).</p>\n<pre><code>constexpr bool isDebugging = false; // somehow a global flag\nvoid foo(int arg) {\n    if( isDebugging ) {\n        asm(&quot;.globl _marker\\n_marker:\\n&quot;);\n        std::cout &lt;&lt; &quot;Arg was &quot; &lt;&lt; arg &lt;&lt; std::endl; // may not appear in production binary!\n    }\n    // normal code here...\n}\n</code></pre>\n<p>This would leave an exported linker symbol in the compiled executable, if the code isn't optimised away. You can check for this symbol using nm(1).</p>\n<p>clang can even stop the compilation right away:</p>\n<pre><code>constexpr bool isDebugging = false; // somehow a global flag\nvoid foo(int arg) {\n    if( isDebugging ) {\n        asm(&quot;_marker=1\\n&quot;);\n        std::cout &lt;&lt; &quot;Arg was &quot; &lt;&lt; arg &lt;&lt; std::endl; // may not appear in production binary!\n    }\n    asm volatile (\n        &quot;.ifdef _marker\\n&quot;\n        &quot;.err \\&quot;code not optimised away\\&quot;\\n&quot;\n        &quot;.endif\\n&quot;\n    );\n    // normal code here...\n}\n</code></pre>\n"}], "owner": {"reputation": 763, "user_id": 1844547, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6940d1a1ecbaf9e0c1168a5e42595c34?s=128&d=identicon&r=PG", "display_name": "Borph", "link": "https://stackoverflow.com/users/1844547/borph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "answer_count": 7, "score": 4, "last_activity_date": 1601564466, "creation_date": 1565192418, "last_edit_date": 1601564466, "question_id": 57398001, "link": "https://stackoverflow.com/questions/57398001/how-to-ensure-some-code-is-optimized-away", "title": "How to ensure some code is optimized away?", "body": "<p><strong>tl;dr</strong>: Can it be ensured somehow (e.g. by writing a unit test) that some things are optimized away, e.g. whole loops?</p>\n<p>The usual approach to be sure that something is not included in the production build is wrapping it with <code>#if...#endif</code>. But I prefer to stay with C++ mechanics instead. Even there, instead of complicated template specializations I like to keep implementations simple and argue &quot;hey, the compiler will optimize this out anyway&quot;.</p>\n<p>Context is embedded SW in automotive (binary size matters) with often poor compilers. They are certified in the sense of safety, but usually not good in optimizations.</p>\n<p><strong>Example 1</strong>: In a container the destruction of elements is typically a loop:</p>\n<pre><code>for(size_t i = 0; i&lt;elements; i++)\n    buffer[i].~T();\n</code></pre>\n<p>This works also for build-in types such as <code>int</code>, as the standard allows the explicit call of the destructor also for any scalar types (C++11 12.4-15). In such case the loop does nothing and is optimized out. In GCC it is, but in another (Aurix) not, I saw a literally empty loop in the disassembly! So that needed a template specialization to fix it.</p>\n<p><strong>Example 2</strong>: Code, which is intended for debugging, profiling or fault-injection etc. only:</p>\n<pre><code>constexpr bool isDebugging = false; // somehow a global flag\nvoid foo(int arg) {\n    if( isDebugging ) {\n        // Albeit 'dead' section, it may not appear in production binary!\n        // (size, security, safety...)\n        // 'if constexpr..' not an option (C++11)\n        std::cout &lt;&lt; &quot;Arg was &quot; &lt;&lt; arg &lt;&lt; std::endl;\n    }\n    // normal code here...\n}\n</code></pre>\n<p>I can look at the disassembly, sure. But being an upstream platform software it's hard to control all targets, compilers and their options one might use. The fear is big that due to any reason a downstream project has a code bloat or performance issue.</p>\n<p><strong>Bottom line:</strong> Is it possible to write the software in a way, that certain code is known to be optimized away in a safe manner as a <code>#if</code> would do? Or a unit tests, which give a fail if optimization is not as expected?</p>\n<p>[Timing tests come to my mind for the first problem, but being bare-metal I don't have convenient tools yet.]</p>\n"}, {"tags": ["c++", "algorithm"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1565192548, "post_id": 57398000, "comment_id": 101277624, "body": "Use a min-heap / max-heap of N elements."}, {"owner": {"reputation": 4756, "user_id": 10001688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kvhzK.jpg?s=128&g=1", "display_name": "Michael Bianconi", "link": "https://stackoverflow.com/users/10001688/michael-bianconi"}, "edited": false, "score": 0, "creation_date": 1565192551, "post_id": 57398000, "comment_id": 101277625, "body": "Is the vector sorted?"}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 2, "creation_date": 1565193199, "post_id": 57398000, "comment_id": 101277944, "body": "<a href=\"https://en.wikipedia.org/wiki/Quickselect\" rel=\"nofollow noreferrer\">Quick select</a> perhaps?"}, {"owner": {"reputation": 7679, "user_id": 896012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/05779413dbb3915fa5b2f3ed82d66007?s=128&d=identicon&r=PG", "display_name": "Gupta", "link": "https://stackoverflow.com/users/896012/gupta"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1565194184, "post_id": 57398000, "comment_id": 101278411, "body": "@PaulMcKenzie but you should first insert all of the item into min/max heap that takes O(NLogN), No?"}, {"owner": {"reputation": 6812, "user_id": 1410303, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/UVBNS.png?s=128&g=1", "display_name": "SomeDude", "link": "https://stackoverflow.com/users/1410303/somedude"}, "edited": false, "score": 0, "creation_date": 1565194302, "post_id": 57398000, "comment_id": 101278470, "body": "Using a min-heap/max heap of <code>K</code> elements is enough, no need of size of <code>N</code>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1565194680, "post_id": 57398000, "comment_id": 101278664, "body": "I should have said a min or max heap of <code>K</code> elements.  The size of <code>N</code> is irrelevant.  Maybe <a href=\"https://stackoverflow.com/questions/56507928/keeping-only-n-smallest-elements-with-stl-with-duplicates/56508520#56508520\">this answer</a> is of any help?"}, {"owner": {"reputation": 972, "user_id": 7201420, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/33b5cf8a2891b9e747526da974d24e33?s=128&d=identicon&r=PG&f=1", "display_name": "Maras", "link": "https://stackoverflow.com/users/7201420/maras"}, "edited": false, "score": 0, "creation_date": 1565195774, "post_id": 57398000, "comment_id": 101279232, "body": "Min/max heap works in O(n log k), not a big difference from sorting the array in O(n log n) for a bigger k tbh."}], "answers": [{"tags": [], "owner": {"reputation": 972, "user_id": 7201420, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/33b5cf8a2891b9e747526da974d24e33?s=128&d=identicon&r=PG&f=1", "display_name": "Maras", "link": "https://stackoverflow.com/users/7201420/maras"}, "is_accepted": false, "score": 0, "last_activity_date": 1565195174, "last_edit_date": 1565195174, "creation_date": 1565192560, "answer_id": 57398045, "question_id": 57398000, "link": "https://stackoverflow.com/questions/57398000/whats-the-most-efficient-algo-for-finding-the-smallest-largest-k-elements-in-an/57398045#57398045", "title": "What&#39;s the most efficient algo for finding the smallest/largest K elements in an unsorted array?", "body": "<p>Take a look at median of medians algorithm (<a href=\"https://en.m.wikipedia.org/wiki/Median_of_medians\" rel=\"nofollow noreferrer\">https://en.m.wikipedia.org/wiki/Median_of_medians</a>). It takes O(n) time and does exactly that. It's one of the most efficient algorithms if not the best one.</p>\n"}, {"tags": [], "owner": {"reputation": 7027, "user_id": 1735922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a82aaa47327bba0f9657c32ce20c8914?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1735922/john"}, "is_accepted": true, "score": 6, "last_activity_date": 1565193614, "creation_date": 1565193614, "answer_id": 57398323, "question_id": 57398000, "link": "https://stackoverflow.com/questions/57398000/whats-the-most-efficient-algo-for-finding-the-smallest-largest-k-elements-in-an/57398323#57398323", "title": "What&#39;s the most efficient algo for finding the smallest/largest K elements in an unsorted array?", "body": "<p><a href=\"https://en.cppreference.com/w/cpp/algorithm/partial_sort\" rel=\"noreferrer\">Partial_sort</a> will put the least (greatest) K elements in the front of a container, and sort them.  Call it like</p>\n\n<pre><code>std::partial_sort(arr.begin(), arr.begin() + K, arr.end());\nstd::partial_sort(arr.begin(), arr.begin() + K, arr.end(), std::greater&lt;&gt;());\n</code></pre>\n\n<p>It will run about N log K time</p>\n"}, {"tags": [], "owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "is_accepted": false, "score": 5, "last_activity_date": 1565193728, "creation_date": 1565193728, "answer_id": 57398354, "question_id": 57398000, "link": "https://stackoverflow.com/questions/57398000/whats-the-most-efficient-algo-for-finding-the-smallest-largest-k-elements-in-an/57398354#57398354", "title": "What&#39;s the most efficient algo for finding the smallest/largest K elements in an unsorted array?", "body": "<p>The standard library <a href=\"https://en.cppreference.com/w/cpp/algorithm/nth_element\" rel=\"noreferrer\"><code>std::nth_element</code></a> algorithm does what you want in O(n) complexity. Given the call:</p>\n\n<pre><code>std::nth_element(arr.begin(), arr.begin() + K, arr.end());\n</code></pre>\n\n<p>The Kth element is the element that would occur if the whole range was sorted. Elements before the Kth will all be less than or equal to the Kth element.</p>\n\n<p>By default the algorithm uses the less-than operator. If you want the largest K elements you can use a different compare function, such as:</p>\n\n<pre><code>std::nth_element(arr.begin(), arr.begin() + K, arr.end(), std::greater&lt;&gt;{});\n</code></pre>\n"}], "owner": {"reputation": 11584, "user_id": 1142881, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/99836a8fe8fb744bfa64210a2bf7cc23?s=128&d=identicon&r=PG&f=1", "display_name": "SkyWalker", "link": "https://stackoverflow.com/users/1142881/skywalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 57398323, "answer_count": 3, "score": 0, "last_activity_date": 1565195174, "creation_date": 1565192416, "last_edit_date": 1565192583, "question_id": 57398000, "link": "https://stackoverflow.com/questions/57398000/whats-the-most-efficient-algo-for-finding-the-smallest-largest-k-elements-in-an", "title": "What&#39;s the most efficient algo for finding the smallest/largest K elements in an unsorted array?", "body": "<p>I have an unsorted vector of N elements and would like to find the K lowest or largest elements. K is expected to be K &lt;&lt; N way smaller than N but the algo should be robust to be efficient also for larger values of K e.g. 50-80% of N.</p>\n\n<p>Thinking along the lines of reusing Quicksort would mean using exactly the Kth smallest/largest element as pivot to partition. But finding the Kth smallest/largest value is already computing the solution to the OP. </p>\n\n<p>Here is the partition bit of Quicksort:</p>\n\n<pre><code>template&lt;typename T&gt;\nint partition(std::vector&lt;T&gt;&amp; arr, int low, int high, T pivot) {\n    int i = (low - 1); \n\n    for (int j = low; j &lt;= high - 1; ++j) {\n        if (arr[j] &lt;= pivot) {\n            i++;\n            std::swap(arr[i], arr[j]);\n        }\n    }\n    std::swap(arr[i + 1], arr[high]);\n    return (i + 1);\n}\n</code></pre>\n\n<p>If I knew what the <code>pivot</code> value would be corresponding to the Kth smallest/largest then I can use the partition above to solve my OP.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 9, "creation_date": 1565191410, "post_id": 57397662, "comment_id": 101277002, "body": "<code>#include &lt;bits&#47;stdc++.h&gt; using namespace std;</code> - Don&#39;t do that."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 5, "creation_date": 1565191439, "post_id": 57397662, "comment_id": 101277019, "body": "<code>cin &gt;&gt; n; long long int c[n],h[n],a[n]</code> is not C++. See <a href=\"https://stackoverflow.com/questions/1887097/why-arent-variable-length-arrays-part-of-the-c-standard\" title=\"why arent variable length arrays part of the c standard\">stackoverflow.com/questions/1887097/&hellip;</a>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1565191604, "post_id": 57397662, "comment_id": 101277106, "body": "Also, if you know the input already, why are you posting input statements, like the variable <code>t</code>, and <code>cin</code>?  Just give us a code sample with the variables already filled in with the data.  Not only will your example become a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, you will make it easier to focus on the issue, and make it easier to debug for yourself."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1565191628, "post_id": 57397662, "comment_id": 101277120, "body": "This probably happens due to <code>j</code> becoming zero or negative. But your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is missing half the required inputs... What do you see when you step through this program in a debugger?"}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1565191774, "post_id": 57397662, "comment_id": 101277214, "body": "What numbers should go into <code>c[]</code>? What does that variable represent?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1565191865, "post_id": 57397662, "comment_id": 101277267, "body": "This isn&#39;t C++ code."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1565191948, "post_id": 57397662, "comment_id": 101277324, "body": "<i>and not doing any operation on it at all,</i> -- What?? It looks like you&#39;re doing a whole lot of &quot;stuff&quot; in-between after you get the input and before you output the results."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 5, "creation_date": 1565192036, "post_id": 57397662, "comment_id": 101277375, "body": "<b>Recommended reading:</b> <a href=\"https://stackoverflow.com/q/31816095/560648\">Why should I not #include &lt;bits/stdc++.h&gt;?</a>"}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 3, "creation_date": 1565193328, "post_id": 57397662, "comment_id": 101278017, "body": "Use <code>std::vector</code> instead of variable sized arrays, and then use <code>at</code> instead of <code>operator[]</code>.  That will show you where your bug is."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1565196277, "post_id": 57397662, "comment_id": 101279489, "body": "<code>begin</code> and <code>end</code> are terrible variable names after doing <code>using namespace std;</code> - the <code>std</code> namespace contains <code>std::begin</code> and <code>std::end</code>."}], "answers": [{"tags": [], "owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "is_accepted": false, "score": 2, "last_activity_date": 1565196921, "last_edit_date": 1565196921, "creation_date": 1565193362, "answer_id": 57398247, "question_id": 57397662, "link": "https://stackoverflow.com/questions/57397662/why-is-the-sort-changing-my-input-array/57398247#57398247", "title": "why is the sort() changing my input array?", "body": "<p>Here is a version of your code written in reasonably decent C++. I didn't touch the loop in the middle because I have no clue what it's doing. You're using obscure variable names and no comments and doing all kinds of bizarre things with indexes and mixing them up with user input.</p>\n\n<p>Now, reading indexes from user input and using them isn't bad, though in a real program you'd want to be doing lots of bounds checking on that input to make sure people weren't feeding you bad data. But doing all that stuff with such poorly named variables with no explanation is going to leave anybody looking at it scratching their head. Don't do that.</p>\n\n<p>Also, avoid the use of <code>begin</code> and <code>end</code> as variable names, especially if they hold indexes. In most cases it will confuse things terribly as <code>begin</code> and <code>end</code> are important identifiers in the standard library and always refer to iterators, which are sort of like indexes, but most definitely not indexes, adding greatly to the confusion. <code>beginidx</code> and <code>endidx</code> could be acceptable substitutes in this case.</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n#include &lt;iterator&gt;\n\nusing ::std::vector;\nusing ::std::sort;\nusing ::std::copy_n;\nusing ::std::copy;\nusing ::std::fill;\nusing ::std::istream_iterator;\nusing ::std::ostream_iterator;\nusing ::std::cin;\nusing ::std::cout;\n\nint main() {\n// your code goes here\n   using vec_el_t = long long int;\n   int t;\n   cin &gt;&gt; t;\n   while (t--) {\n      int const n = []() { int n; cin &gt;&gt; n; return n; }();\n      vector&lt;vec_el_t&gt; c{n}, h{n}, a{n};\n      copy_n(istream_iterator&lt;vec_el_t&gt;{cin}, n, c.begin());\n      copy_n(istream_iterator&lt;vec_el_t&gt;{cin}, n, h.begin());\n\n      // Suggested debugging code:\n      // cout &lt;&lt; \"h before sort: \"\n      // copy(h.begin(), h.end(), ostream_iterator&lt;vec_el_t&gt;{cout, \" \"});\n      // cout &lt;&lt; '\\n';\n\n      sort(h.begin(), h.end());\n\n      // Suggested debugging code:\n      // cout &lt;&lt; \"h after sort: \"\n      // copy(h.begin(), h.end(), ostream_iterator&lt;vec_el_t&gt;{cout, \" \"});\n      // cout &lt;&lt; '\\n';\n\n      fill(a.begin(), a.end(), 0);\n\n      // Weird, unexplained algorithm begins here\n      int i = 0;\n      int begin = (i + 1) - c[i];\n      int end = (i + 1) + c[i];\n      int j = begin;\n      while (i &lt; n) {\n         a[j - 1]++;\n         j++;\n         if (j &gt; end){\n            i++;\n            begin = (i + 1) - c[i];\n            end = (i + 1) + c[i];\n            j = begin;\n         }\n      }\n      // Weird unexplained algorithm ends here\n\n      sort(a.begin(), a.end());\n      copy(h.begin(), h.end(), ostream_iterator&lt;vec_el_t&gt;{cout, \" \"});\n   }\n   return 0;\n}\n</code></pre>\n\n<p>Changes made...  Use <code>vector</code> not a variable length array, which isn't valid C++ anyway and will only work in g++ and clang. Don't use explicit loops if there is an algorithm that will do the job. Try to make as many things <code>const</code> as you can so you can make sure that the compiler catches it if you try to change things you didn't mean to change. Avoid <code>using std;</code> and if you want to import names from <code>::std</code> import exactly the ones you need. Don't use compiler or library implementation specific header files and use the ones from the standard instead (i.e. no <code>bits/stdc++.h</code>).</p>\n\n<p>As for your problem, I have no idea. I suspect that the index manipulation combined with looping isn't doing what you expect. If you print out the arrays before and after sorting, you will discover that <code>sort</code> only alters order, and not content.</p>\n\n<p>As a general rule, <strong>always</strong> suspect your own code first and make absolutely sure it's correct. And if you really think it's the library code, prove it beyond a shadow of a doubt before coming here to ask why the library isn't doing what it says it does.</p>\n\n<p>The complicated code I didn't touch looks rife with opportunities for out-of-bounds access, and that results in undefined behavior, which means your program might do <a href=\"https://stackoverflow.com/questions/56979248/why-does-this-simple-program-result-in-puppies-puppies-puppies-to-the-console\">absolutely anything</a> in that case. You might change uses of <code>operator []</code> with calls to the <a href=\"https://en.cppreference.com/w/cpp/container/vector/at\" rel=\"nofollow noreferrer\"><code>at</code></a> function (one of the many perks of using <code>vector</code>) instead. That way, attempts at out-of-bounds access will throw an exception.</p>\n"}, {"tags": [], "owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "is_accepted": false, "score": 1, "last_activity_date": 1565263476, "creation_date": 1565263476, "answer_id": 57411463, "question_id": 57397662, "link": "https://stackoverflow.com/questions/57397662/why-is-the-sort-changing-my-input-array/57411463#57411463", "title": "why is the sort() changing my input array?", "body": "<p>Within these lines you are accessing <code>a</code> outside its limits:</p>\n\n<pre><code>int i=0;\nint begin=(i+1)-c[i];  // begin = 1 - c[0]; &lt;&lt;-- this could be arbitrarily small!\nint end = (i+1)+c[i];  // unrelated\nint j=begin;           // also equal to 1-c[0]\nwhile(i&lt;n){\n    a[j-1]++;          // increment a[-c[0]] which is UB unless c[0]==0\n</code></pre>\n\n<p>This means undefined behavior (UB), i.e., it could do nothing, it could segfault, or (what apparently happened in your case) access elements of an adjacent data structure.</p>\n"}], "owner": {"reputation": 1, "user_id": 11320567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ssfJ.png?s=128&g=1", "display_name": "Abhishekk", "link": "https://stackoverflow.com/users/11320567/abhishekk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1565263476, "creation_date": 1565191224, "last_edit_date": 1565191887, "question_id": 57397662, "link": "https://stackoverflow.com/questions/57397662/why-is-the-sort-changing-my-input-array", "title": "why is the sort() changing my input array?", "body": "<p>i am stuck on a problem where, after taking input of an array and sorting it and not doing any operation on it at all, the output shows a different array?</p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\nint main() {\n// your code goes here\nint t;\ncin&gt;&gt;t;\nwhile(t--){\n    int n;\n    cin&gt;&gt;n;\n    long long int c[n],h[n],a[n];\n    for(int i=0;i&lt;n;i++){\n        cin&gt;&gt;c[i];\n    }\n    for(int i=0;i&lt;n;i++){\n        cin&gt;&gt;h[i];\n    }\n    sort(h,h+n);\n    for(int i=0;i&lt;n;i++){\n        a[i]=0;\n    }\n    int i=0;\n    int begin=(i+1)-c[i];\n    int end = (i+1)+c[i];\n    int j=begin;\n    while(i&lt;n){\n        a[j-1]++;\n        j++;\n        if(j&gt;end){\n            i++;\n            begin=(i+1)-c[i];\n            end= (i+1)+c[i];\n            j=begin;\n        }\n    }\n\n    sort(a,a+n);\n    for(int i=0;i&lt;n;i++){\n        cout&lt;&lt;h[i]&lt;&lt;\" \";\n    }\n }\n return 0;\n }\n</code></pre>\n\n<p>input for h[]={8,8,8,8,8}..n=5\noutput h[]={10,10,9,9,8}</p>\n"}, {"tags": ["c++", "performance"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 6, "creation_date": 1565190612, "post_id": 57397374, "comment_id": 101276569, "body": "What did you find when you profiled your application? Why is <code>std::set</code> not the correct structure? We have no idea what are your purposes and requirements."}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1565190648, "post_id": 57397374, "comment_id": 101276589, "body": "At a guess, your performance issue comes not from the recursion as such but from the call to <code>kid.neighbors()</code>."}, {"owner": {"reputation": 3035, "user_id": 1413244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BaB5H.png?s=128&g=1", "display_name": "jwezorek", "link": "https://stackoverflow.com/users/1413244/jwezorek"}, "edited": false, "score": 0, "creation_date": 1565190689, "post_id": 57397374, "comment_id": 101276612, "body": "Well, based on the above std::unordered_set would be better because std::set&#39;s orderedness doesnt seem to matter."}, {"owner": {"reputation": 3035, "user_id": 1413244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BaB5H.png?s=128&g=1", "display_name": "jwezorek", "link": "https://stackoverflow.com/users/1413244/jwezorek"}, "edited": false, "score": 0, "creation_date": 1565190728, "post_id": 57397374, "comment_id": 101276634, "body": "What is the average number of neighbors each PointId has?"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1565190814, "post_id": 57397374, "comment_id": 101276668, "body": "What optimization level did you build with, and how did you profile?"}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1565191079, "post_id": 57397374, "comment_id": 101276821, "body": "It&#39;s not like that recursion alone resulted in that long time, most times invalid recursion results in stack overflow; Profile the function."}, {"owner": {"reputation": 1383, "user_id": 5764943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea68c9e133d76d392afa823a31191ce1?s=128&d=identicon&r=PG&f=1", "display_name": "T Kambi", "link": "https://stackoverflow.com/users/5764943/t-kambi"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1565191764, "post_id": 57397374, "comment_id": 101277211, "body": "@SergeyA is <code>std::set</code> like hashset in C#? If not that itself will increase the performance of <code>find</code> from O(log n) to O(1). @jwezorek the neighbors are controlled by how much you want, in the function is 6 (+1 for the id itself)  As I said, I am new to C++, not sure how to profile. will add more info why I think the function is cause of concern."}, {"owner": {"reputation": 3035, "user_id": 1413244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BaB5H.png?s=128&g=1", "display_name": "jwezorek", "link": "https://stackoverflow.com/users/1413244/jwezorek"}, "edited": false, "score": 1, "creation_date": 1565191799, "post_id": 57397374, "comment_id": 101277227, "body": "Can item A be neighbors to item B and item C also neighbors to item B? I think your data structure doesnt have cycles from children to parents i.e. it a DAG but that doesnt mean it is impossible to not explore the same node multiple times. Your test (x == id) just tests that you do not re=explore a parent but what about re-exploring a child you already explored when exploring another parent?"}, {"owner": {"reputation": 405, "user_id": 7080683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vHnjck4jA_4/AAAAAAAAAAI/AAAAAAAAACE/wU6N3qQY4hM/photo.jpg?sz=128", "display_name": "Arne J", "link": "https://stackoverflow.com/users/7080683/arne-j"}, "reply_to_user": {"reputation": 3035, "user_id": 1413244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BaB5H.png?s=128&g=1", "display_name": "jwezorek", "link": "https://stackoverflow.com/users/1413244/jwezorek"}, "edited": false, "score": 0, "creation_date": 1565191858, "post_id": 57397374, "comment_id": 101277262, "body": "Although there is certainly room for optimization, the fact that it takes forever is a logical bug : I have the impression the recursion can jump from one item to a neighboring one, and then back again. That results in an infinite loop. @jwezorek you beat me to it"}, {"owner": {"reputation": 3035, "user_id": 1413244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BaB5H.png?s=128&g=1", "display_name": "jwezorek", "link": "https://stackoverflow.com/users/1413244/jwezorek"}, "edited": false, "score": 0, "creation_date": 1565191932, "post_id": 57397374, "comment_id": 101277314, "body": "std::set is a binary search tree i.e. O(log n) lookups. std::unordered_set is a hash table."}, {"owner": {"reputation": 1383, "user_id": 5764943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea68c9e133d76d392afa823a31191ce1?s=128&d=identicon&r=PG&f=1", "display_name": "T Kambi", "link": "https://stackoverflow.com/users/5764943/t-kambi"}, "reply_to_user": {"reputation": 3035, "user_id": 1413244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BaB5H.png?s=128&g=1", "display_name": "jwezorek", "link": "https://stackoverflow.com/users/1413244/jwezorek"}, "edited": false, "score": 0, "creation_date": 1565192115, "post_id": 57397374, "comment_id": 101277411, "body": "@jwezorek I think you have a point there, I should skip the whole funcation if It is already in the set"}, {"owner": {"reputation": 405, "user_id": 7080683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vHnjck4jA_4/AAAAAAAAAAI/AAAAAAAAACE/wU6N3qQY4hM/photo.jpg?sz=128", "display_name": "Arne J", "link": "https://stackoverflow.com/users/7080683/arne-j"}, "edited": false, "score": 0, "creation_date": 1565192353, "post_id": 57397374, "comment_id": 101277541, "body": "Just so you know, if you have a really large data structure a recursive function like this might still become problematic : the program stack grows with a collection of neighbors for each level of recursion."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1565193992, "post_id": 57397374, "comment_id": 101278332, "body": "You probably want to return right away if id is found in the reference set, otherwise you are going to find the same thing over and over again."}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1565191322, "post_id": 57397617, "comment_id": 101276946, "body": "Second one hardly will help if <code>neighbors</code> returns by value, and it is very likely so"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1565191425, "post_id": 57397617, "comment_id": 101277007, "body": "@Slava Yes well the OP can at least look at that area. They might need to adjust their API."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1565191560, "post_id": 57397617, "comment_id": 101277080, "body": "Not sure how you can adjust here, looks like that method calculates result so unlikely it can return const reference, anyway due to move semantics I doubt that  will help significantly or at all."}, {"owner": {"reputation": 1383, "user_id": 5764943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea68c9e133d76d392afa823a31191ce1?s=128&d=identicon&r=PG&f=1", "display_name": "T Kambi", "link": "https://stackoverflow.com/users/5764943/t-kambi"}, "edited": false, "score": 0, "creation_date": 1565192537, "post_id": 57397617, "comment_id": 101277618, "body": "So if I just <code>insert</code> it will not create duplicates?"}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 1, "last_activity_date": 1565191092, "creation_date": 1565191092, "answer_id": 57397617, "question_id": 57397374, "link": "https://stackoverflow.com/questions/57397374/recursive-function-and-performance-in-c/57397617#57397617", "title": "Recursive function and performance in C++", "body": "<p>This is wasteful.</p>\n\n<pre><code>if (refSet.find(id) == refSet.end())\n    refSet.insert(id);\n</code></pre>\n\n<p>There's no need to check if something is a member of a set before inserting it, just insert it anyway.</p>\n\n<pre><code>refSet.insert(id);\n</code></pre>\n\n<p>That said this is not an order of magnitude improvement.</p>\n\n<p>This might also help</p>\n\n<pre><code>const auto&amp; ids = kid.neighbors(id, 7);\n</code></pre>\n\n<p>Depends on what <code>neighbors</code> returns but it looks like you're copying some collection or other.</p>\n"}, {"comments": [{"owner": {"reputation": 1383, "user_id": 5764943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea68c9e133d76d392afa823a31191ce1?s=128&d=identicon&r=PG&f=1", "display_name": "T Kambi", "link": "https://stackoverflow.com/users/5764943/t-kambi"}, "edited": false, "score": 1, "creation_date": 1565193885, "post_id": 57398088, "comment_id": 101278283, "body": "Your concern is very well possible. Also, is <code>if(refSet.insert(id).second){ ..recursive. }</code> is same as you suggestion and is it better or worse for perfomance."}, {"owner": {"reputation": 3035, "user_id": 1413244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BaB5H.png?s=128&g=1", "display_name": "jwezorek", "link": "https://stackoverflow.com/users/1413244/jwezorek"}, "reply_to_user": {"reputation": 1383, "user_id": 5764943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea68c9e133d76d392afa823a31191ce1?s=128&d=identicon&r=PG&f=1", "display_name": "T Kambi", "link": "https://stackoverflow.com/users/5764943/t-kambi"}, "edited": false, "score": 0, "creation_date": 1565194200, "post_id": 57398088, "comment_id": 101278422, "body": "I dont think that is the same because I think insert will return the inserted item whether it is there or not ... you would want .insert to return something that evaluates to false in the case where it is already there ... if i understamd your question. But regardless if your code is really exploring the same nodes multiple times that behavior would dwarf individual mico-optimizations anyway as if it is rexploring the the same nodes multiple times its formal time complexity is worse than it needs to be."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1565194273, "post_id": 57398088, "comment_id": 101278452, "body": "You may be able to take advantage of <a href=\"https://en.cppreference.com/w/cpp/container/set/insert\" rel=\"nofollow noreferrer\"><code>std::set::insert</code></a>&#39;s return value to simplify this further."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1565198999, "post_id": 57398088, "comment_id": 101280764, "body": "@jwezorek <code>insert</code> returns iterator to the item (inserted or not) and flag if insertion did happen. So this way is more efficient - not doing 2 lookups in the worst case."}], "tags": [], "owner": {"reputation": 3035, "user_id": 1413244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BaB5H.png?s=128&g=1", "display_name": "jwezorek", "link": "https://stackoverflow.com/users/1413244/jwezorek"}, "is_accepted": true, "score": 4, "last_activity_date": 1565192750, "creation_date": 1565192750, "answer_id": 57398088, "question_id": 57397374, "link": "https://stackoverflow.com/questions/57397374/recursive-function-and-performance-in-c/57398088#57398088", "title": "Recursive function and performance in C++", "body": "<p>Without more information my guess would be that multiple PointIds can be neighbors with the same PointIds, even though there is a parent/child relation that holds. </p>\n\n<p>In other words, this code is performing a depth-first search on a directed acyclic graph but is not checking for revisits the way a typical depth-first search does. This means you will be exploring the same nodes many times which is extremely inefficient.</p>\n\n<p>Change </p>\n\n<pre><code>if (refSet.find(id) == refSet.end())\n    refSet.insert(id);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>if (refSet.find(id) != refSet.end())\n    return;\nrefSet.insert(id);\n</code></pre>\n\n<p>Also you should use an std::unordered_set instead of an std::set but that is a lesser concern if the above is true. </p>\n"}], "owner": {"reputation": 1383, "user_id": 5764943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea68c9e133d76d392afa823a31191ce1?s=128&d=identicon&r=PG&f=1", "display_name": "T Kambi", "link": "https://stackoverflow.com/users/5764943/t-kambi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 57398088, "answer_count": 2, "score": 0, "last_activity_date": 1565192750, "creation_date": 1565190291, "last_edit_date": 1565192353, "question_id": 57397374, "link": "https://stackoverflow.com/questions/57397374/recursive-function-and-performance-in-c", "title": "Recursive function and performance in C++", "body": "<p>I am new to C++, I would appreciate if anyone and help me to validate the below function or help me improve it.</p>\n\n<pre><code>void RecursiveKnn(std::set&lt;PointId&gt; &amp;refSet, const PointId &amp;id, const KD3Index &amp;kid, int const lvl)\n{\n    if (refSet.find(id) == refSet.end())\n        refSet.insert(id);\n\n    if (lvl &lt; m_knn)\n    {\n        auto ids = kid.neighbors(id, 7);\n        for (auto x : ids)\n        {\n            if (x == id)\n                continue;\n            RecursiveKnn(refSet, x, kid, lvl+1);\n        }\n    }\n}\n</code></pre>\n\n<p>I have written a recursive function to run and generate a set of hierarchical objects. basically, start with one object, get next/nearby objects and so on for the next level. Along with it, I want to avoid duplicates as well. The levels are limited to 3 - 4 and do not expect to go any further.</p>\n\n<p>This function is called millions of time and is taking forever to run. I would really appreciate if anyone can suggest any improvement. On top of my head I am sure <code>std::set</code> is not the correct data structure to use but, I don't know what to use.</p>\n\n<p>EDIT: The reason, I find the function to have the performance problem is that. At first I have a single function with 3 nested for loop. which worked within reasonable time. When I changed it to a recursive function, The process did not complete for more than an hour.</p>\n"}, {"tags": ["c++", "vulkan"], "comments": [{"owner": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 0, "creation_date": 1565199564, "post_id": 57397293, "comment_id": 101280991, "body": "Why not render to the swapchain image directly?"}, {"owner": {"reputation": 91, "user_id": 11003927, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zHv0H7n4l3M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOy8xWLquUFiC4KwXB7mwxagoCnFg/mo/photo.jpg?sz=128", "display_name": "Facundo Villa", "link": "https://stackoverflow.com/users/11003927/facundo-villa"}, "reply_to_user": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 0, "creation_date": 1565203199, "post_id": 57397293, "comment_id": 101282545, "body": "@krOoze Yes, but what if I want to use a framebuffer with multiple attachments for deferred rendering. Should I set the swapchain&#39;s image as one of the attachments, should i copy the result from one of my attachments to the swapchain?"}, {"owner": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 0, "creation_date": 1565204376, "post_id": 57397293, "comment_id": 101283131, "body": "That is the part I do not understand. Why &quot;copy&quot;, when you can use the swapchain image in the first place? Of course you can copy as well (via <code>vkCmdCopyImage</code>; at the performance cost of making extra copy, which is not that bad unless 8K or something)."}, {"owner": {"reputation": 91, "user_id": 11003927, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zHv0H7n4l3M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOy8xWLquUFiC4KwXB7mwxagoCnFg/mo/photo.jpg?sz=128", "display_name": "Facundo Villa", "link": "https://stackoverflow.com/users/11003927/facundo-villa"}, "reply_to_user": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 0, "creation_date": 1565207793, "post_id": 57397293, "comment_id": 101284553, "body": "@krOoze Yes that&#39;s what I&#39;m not sure about. How should I approach framebuffers and renderpasses in a deferred renderer (offscreen renderer) setup?"}], "answers": [{"tags": [], "owner": {"reputation": 5299, "user_id": 126546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5300f94d7227aca52dfe170ce14a225c?s=128&d=identicon&r=PG", "display_name": "Jesse Hall", "link": "https://stackoverflow.com/users/126546/jesse-hall"}, "is_accepted": true, "score": 0, "last_activity_date": 1565223147, "creation_date": 1565223147, "answer_id": 57403674, "question_id": 57397293, "link": "https://stackoverflow.com/questions/57397293/vulkan-present-to-swapchain-from-offscreen-buffer/57403674#57403674", "title": "Vulkan: Present to Swapchain from Offscreen Buffer", "body": "<p>There are multiple options if you want to consider extra copies, but assuming you want to render your final image directly into the swapchain, image, there are two basic options.</p>\n\n<p>First, if you don't want to use multiple subpasses, on each frame you'll use one framebuffer for each pass. The final framebuffer will use the swapchain image for that frame as its color attachment. For each framebuffer, you'll use a different renderpass, since the framebuffer attachment counts/formats/etc. will likely be different. You can create all of the renderpasses and non-swapchain framebuffers up front and reuse them on each frame.</p>\n\n<p>For the swapchain framebuffer, create one for each swapchain image when you first create the swapchain, and then on each frame use the framebuffer that matches the swapchain image for that frame. Try to avoid destroying and recreating objects all the time; instead cache and reuse them -- the reason they're distinct objects is to allow you to amortize the creation cost over many uses. (Single-subpass renderpasses should be cheap to create, but on at least one architecture an framebuffer is expensive to create, and multi-subpass renderpasses can also be expensive on some architectures.)</p>\n\n<p>Secondly, if you want to do the whole thing as a single renderpass with multiple subpasses to take advantage of tile memory on some GPUs, the process is very similar. You'd have a single renderpass, but each subpass corresponds to one of the renderpasses in the first option, and will use similar attachments. Because you have just one renderpass you'll also have just one framebuffer per frame. Since the final subpass will write to the swapchain image, though, you'll need a separate framebuffer object for each swapchain image; all of these framebuffers will be identical except for the swapchain image attachment.</p>\n"}], "owner": {"reputation": 91, "user_id": 11003927, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zHv0H7n4l3M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOy8xWLquUFiC4KwXB7mwxagoCnFg/mo/photo.jpg?sz=128", "display_name": "Facundo Villa", "link": "https://stackoverflow.com/users/11003927/facundo-villa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "closed_date": 1565336774, "accepted_answer_id": 57403674, "answer_count": 1, "score": -4, "last_activity_date": 1565223147, "creation_date": 1565190021, "last_edit_date": 1565192902, "question_id": 57397293, "link": "https://stackoverflow.com/questions/57397293/vulkan-present-to-swapchain-from-offscreen-buffer", "closed_reason": "Needs more focus", "title": "Vulkan: Present to Swapchain from Offscreen Buffer", "body": "<p>I'm trying make a deferred renderer in Vulkan so I need to present the resultant image from my deferred rendering framebuffer to the screen, but I don't know exactly how.</p>\n\n<p>My idea is:\nAdd the image acquired from the swapchain at the end of my framebuffer and add a subpass to render the end result to it.\nBut, should I create multiple copies of my framebuffer(one copy for every swapchain image), or delete the framebuffer and renderpass and recreate them every frame while setting the last image as the swapchain's image.</p>\n\n<p>Is there other way to do it?</p>\n\n<p>Should I make another set of pipelines, render passes and framebuffers to copy the result to the swapchain's images?</p>\n\n<p>I tried looking at SaschaWillems examples and I think he is doing the double renderpass approach but I wondered if there was another way to do it.</p>\n"}, {"tags": ["c++", "multithreading", "exception", "stack-unwinding"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1565189750, "post_id": 57397184, "comment_id": 101276080, "body": "Dummy object with a destructor that <code>join</code>s the thread?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1565189760, "post_id": 57397184, "comment_id": 101276087, "body": "<a href=\"https://en.cppreference.com/w/cpp/thread/thread/~thread\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/thread/thread/~thread</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1565189782, "post_id": 57397184, "comment_id": 101276097, "body": "See: <a href=\"http://scottmeyers.blogspot.com/2013/12/threadraii-thread-suspension-trouble.html\" rel=\"nofollow noreferrer\">scottmeyers.blogspot.com/2013/12/&hellip;</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1565190227, "post_id": 57397184, "comment_id": 101276370, "body": "Create the thread object outside the <code>try</code>, initialize it inside the <code>try</code>, and in the <code>catch</code> check if it&#39;s <code>joinable</code> and then <code>join</code> it?"}, {"owner": {"reputation": 3356, "user_id": 4451432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97b46aba1c1ec6b780b9735f0ec7f885?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Popov", "link": "https://stackoverflow.com/users/4451432/ilya-popov"}, "edited": false, "score": 1, "creation_date": 1565190279, "post_id": 57397184, "comment_id": 101276398, "body": "Two options: a) create your thread outside of the try-block (edit: this is what previous commenter suggests) b) instead of <code>std::thread</code> use variation that joins on destruction, such as this <a href=\"https://github.com/josuttis/jthread\" rel=\"nofollow noreferrer\">github.com/josuttis/jthread</a>"}, {"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1565192714, "post_id": 57397184, "comment_id": 101277708, "body": "In that case, I would simply move the <code>join</code> after the <code>catch</code> (and declare <code>joinableThread</code> before the <code>try</code> and move lambda into it after the <code>try</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 1, "last_activity_date": 1565191561, "last_edit_date": 1565191561, "creation_date": 1565191214, "answer_id": 57397658, "question_id": 57397184, "link": "https://stackoverflow.com/questions/57397184/c-exception-not-caught-program-terminates-with-abort/57397658#57397658", "title": "C++ Exception not caught, program terminates with abort", "body": "<p>I think it's a bad idea to join thread during stack unwiding. Pausing destructors until the uncontrolled event in the future happens makes the application very hard to reason about.</p>\n\n<p>I believe, this is one of the reasons why <code>std::thread</code> destructor throws instead of joining the thread.</p>\n\n<p>Now, to your questions. </p>\n\n<p>The first solution is uber-simple - wrap <code>std::thread</code> in your own object which calls <code>join</code> it it's destructor. I think, it is not the great approach for reasons stated above.</p>\n\n<p>Second option is do another wrapper object - one which detaches the thread in it's destructor. This is better in my opinion, but you obviously have a problem of a thread which now can't be joined and waited for completion. </p>\n\n<p>To alleviate that, you can augment your thread to signal it's completion through any mechanism of your choosing, and than wait for that signal (signaled from otherwise detached thread). However, this will still be open to issues if the local thread uses objects who are going to be destructed during stack unwinding. I see no good solution for this problem.</p>\n"}], "owner": {"reputation": 311, "user_id": 6859187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eDc2g.gif?s=128&g=1", "display_name": "Lefteris Eleftheriades", "link": "https://stackoverflow.com/users/6859187/lefteris-eleftheriades"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565191561, "creation_date": 1565189595, "last_edit_date": 1565190054, "question_id": 57397184, "link": "https://stackoverflow.com/questions/57397184/c-exception-not-caught-program-terminates-with-abort", "title": "C++ Exception not caught, program terminates with abort", "body": "<p>This program terminates before the exception handler is caught</p>\n\n<pre><code>void main(){\n    try{\n\n       work1();\n\n       std::thread joinableThread(\n           [](){\n               work2();\n           }\n       );\n\n       work3();\n\n       throw std::runtime_error(\"catch me if you can\");\n\n       joinableThread.join();\n\n    } catch(const std::runtime_error&amp; ex){\n       std::cout &lt;&lt; \"You did it!\" &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>I would like to process the exception handler but the program terminates during stack unwinding. What can I do to ensure that the thread is joined during stack unwidning?</p>\n"}, {"tags": ["c++", "c++17", "variadic-templates", "template-meta-programming", "generic-lambda"], "answers": [{"comments": [{"owner": {"reputation": 31004, "user_id": 391104, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ec5ada4e8208a8fa410847ae421bf229?s=128&d=identicon&r=PG", "display_name": "q0987", "link": "https://stackoverflow.com/users/391104/q0987"}, "edited": false, "score": 0, "creation_date": 1565360102, "post_id": 57397157, "comment_id": 101341941, "body": "I tried your code in the first section and it doesn&#39;t pass compiler error C2760: syntax error: unexpected token &#39;)&#39;, expected &#39;expression&#39;. I am using VS2017 v15.8.8"}], "tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": true, "score": 6, "last_activity_date": 1565360452, "last_edit_date": 1565360452, "creation_date": 1565189527, "answer_id": 57397157, "question_id": 57397058, "link": "https://stackoverflow.com/questions/57397058/why-stdintegral-constant-is-necessary-in-exploding-a-stdtuple/57397157#57397157", "title": "why std::integral_constant is necessary in exploding a std::tuple?", "body": "<blockquote>\n  <p>Why I have to use std::integral_constant{} instead of simply Idx in the following statement?</p>\n</blockquote>\n\n<p>Because function arguments are never <em>constant expressions</em>. You can simply pass the indices as non-type template parameters instead, which are <em>constant expressions</em>. This works especially well with a C++20 template lambda:</p>\n\n<pre><code>template &lt;std::size_t... Idx&gt;\nauto make_index_dispatcher(std::index_sequence&lt;Idx...&gt;) \n{\n    return [](auto&amp;&amp; f) { (f.template operator()&lt;Idx&gt;(), ...); };\n}\n\ntemplate &lt;typename Tuple, typename Func&gt;\nvoid for_each(Tuple&amp;&amp; t, Func&amp;&amp; f) \n{\n    constexpr auto n = std::tuple_size&lt;std::decay_t&lt;Tuple&gt;&gt;::value;\n    auto dispatcher = make_index_dispatcher&lt;n&gt;();\n    dispatcher([&amp;f, &amp;t]&lt;auto Idx&gt;(){ f(std::get&lt;Idx&gt;(std::forward&lt;Tuple&gt;(t))); });\n}\n</code></pre>\n\n<p><a href=\"https://gcc.godbolt.org/z/Ja0joH\" rel=\"nofollow noreferrer\"><strong>live example on godbolt.org</strong></a></p>\n\n<hr>\n\n<blockquote>\n  <p>Why we cannot pass std::index_sequence by reference?</p>\n</blockquote>\n\n<p>You can, but you need to invoke your function with an lvalue like with any other non-<code>const</code> reference. This compiles:</p>\n\n<pre><code>template &lt;std::size_t... Idx&gt;\nauto make_index_dispatcher(std::index_sequence&lt;Idx...&gt;&amp;) \n{\n}\n\nint main()\n{\n    std::index_sequence&lt;&gt; is;        \n    make_index_dispatcher(is);\n}\n</code></pre>\n\n<p>Also, it's completely useless.</p>\n\n<hr>\n\n<p>Also, your entire code can simply be:</p>\n\n<pre><code>int main() \n{\n    std::apply([](auto&amp;&amp;... xs)\n    {\n        ((std::cout &lt;&lt; xs &lt;&lt; ','), ...);\n    }, std::make_tuple(1, 42.1, \"hi\"));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "is_accepted": false, "score": 4, "last_activity_date": 1565190328, "last_edit_date": 1565190328, "creation_date": 1565189740, "answer_id": 57397227, "question_id": 57397058, "link": "https://stackoverflow.com/questions/57397058/why-stdintegral-constant-is-necessary-in-exploding-a-stdtuple/57397227#57397227", "title": "why std::integral_constant is necessary in exploding a std::tuple?", "body": "<blockquote>\n  <p>Why I have to use std::integral_constant{} instead of simply Idx in the following statement?</p>\n  \n  <p>Is it true that std::get expected compile-time constant expression while Idx is NOT a compile-time constant expression?</p>\n</blockquote>\n\n<p><code>std::get&lt;&gt;</code> expects a compile-time expression, but you are not actually using <code>idx</code> directly (which is not a compile-time expression).</p>\n\n<p><code>std::integral_constant&lt;std::size_t, I&gt;</code> has a convenient <code>constexpr</code> conversion operator to <code>std::size_t</code> which returns <code>I</code>, so when you do:</p>\n\n<pre><code>std::get&lt;idx&gt;(...)\n</code></pre>\n\n<p>...you are actually doing <code>std::get&lt;(std::size_t)idx&gt;</code>, and <code>(std::size_t)idx</code> is a compile-time expression since the conversion operator is <code>constexpr</code>.</p>\n\n<p>If you do not wrap <code>Idx</code> inside a <code>std::integral_constant</code>, the type of <code>idx</code> in the generic lambda will be <code>std::size_t</code>, and all the above will not work.</p>\n"}, {"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 2, "last_activity_date": 1565203935, "last_edit_date": 1565203935, "creation_date": 1565203425, "answer_id": 57400561, "question_id": 57397058, "link": "https://stackoverflow.com/questions/57397058/why-stdintegral-constant-is-necessary-in-exploding-a-stdtuple/57400561#57400561", "title": "why std::integral_constant is necessary in exploding a std::tuple?", "body": "<blockquote>\n  <p>Why I have to use std::integral_constant{} instead of simply Idx in the following statement? </p>\n</blockquote>\n\n<p>Just for fun... </p>\n\n<p>What you say is true (as far I known) until C++17 (because the <code>std::get()</code> template argument must be known compile time and the use of <code>std::integral_constant</code> is an elegant way to pass a compile-time-known constant as type of an <code>auto</code> parameter in a generic (C++14 or later) lambda; see other answers for clearer explanations) but not true anymore (not necessarily you have to use <code>std::integral_constant</code>) starting from C++20.</p>\n\n<p>In fact, C++20 introduces template lambdas, so you can rewrite your code as follows, passing the <code>Idx</code> values as template parameters and without <code>std::integral_constant</code></p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;iostream&gt;\n#include &lt;utility&gt;\n\ntemplate &lt;std::size_t... Idx&gt;\nauto make_index_dispatcher(std::index_sequence&lt;Idx...&gt;) \n{\n    return [](auto&amp;&amp; f) { (f.template operator()&lt;Idx&gt;(), ...); };\n} // ......................^^^^^^^^^^^^^^^^^^^^^^^^^^^^   modified lambda call                        \n\ntemplate &lt;std::size_t N&gt;\nauto make_index_dispatcher() \n{\n    return make_index_dispatcher(std::make_index_sequence&lt;N&gt;{});\n}\n\ntemplate &lt;typename Tuple, typename Func&gt;\nvoid for_each(Tuple&amp;&amp; t, Func&amp;&amp; f) \n{\n    constexpr auto n = std::tuple_size&lt;std::decay_t&lt;Tuple&gt;&gt;::value;\n    auto dispatcher = make_index_dispatcher&lt;n&gt;();\n    dispatcher([&amp;f, &amp;t]&lt;std::size_t I&gt;() { f(std::get&lt;I&gt;(std::forward&lt;Tuple&gt;(t))); });\n} // ..................^^^^^^^^^^^^^^^^^ template parameter added, argument removed\n\nint main() \n{\n    for_each(std::make_tuple(1, 42.1, \"hi\"), [](auto&amp;&amp; e) {std::cout &lt;&lt; e &lt;&lt; \",\"; });\n}\n</code></pre>\n"}], "owner": {"reputation": 31004, "user_id": 391104, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ec5ada4e8208a8fa410847ae421bf229?s=128&d=identicon&r=PG", "display_name": "q0987", "link": "https://stackoverflow.com/users/391104/q0987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 57397157, "answer_count": 3, "score": 2, "last_activity_date": 1565360452, "creation_date": 1565189200, "last_edit_date": 1565205108, "question_id": 57397058, "link": "https://stackoverflow.com/questions/57397058/why-stdintegral-constant-is-necessary-in-exploding-a-stdtuple", "title": "why std::integral_constant is necessary in exploding a std::tuple?", "body": "<pre><code>#include &lt;iostream&gt;\n\n#include &lt;tuple&gt;\n#include &lt;iostream&gt;\n#include &lt;utility&gt;\n\ntemplate &lt;std::size_t... Idx&gt;\nauto make_index_dispatcher(std::index_sequence&lt;Idx...&gt;) \n{\n    return [](auto&amp;&amp; f) { (f(std::integral_constant&lt;std::size_t, Idx&gt;{}), ...); };\n}\n\ntemplate &lt;std::size_t N&gt;\nauto make_index_dispatcher() \n{\n    return make_index_dispatcher(std::make_index_sequence&lt;N&gt;{});\n}\n\ntemplate &lt;typename Tuple, typename Func&gt;\nvoid for_each(Tuple&amp;&amp; t, Func&amp;&amp; f) \n{\n    constexpr auto n = std::tuple_size&lt;std::decay_t&lt;Tuple&gt;&gt;::value;\n    auto dispatcher = make_index_dispatcher&lt;n&gt;();\n    dispatcher([&amp;f, &amp;t](auto idx) { f(std::get&lt;idx&gt;(std::forward&lt;Tuple&gt;(t))); });\n}\n\nint main() \n{\n    for_each(std::make_tuple(1, 42.1, \"hi\"), [](auto&amp;&amp; e) {std::cout &lt;&lt; e &lt;&lt; \",\"; });\n}\n</code></pre>\n\n<p><strong>Question 1></strong> Why I have to use <code>std::integral_constant&lt;std::size_t, Idx&gt;{}</code> instead of simply <code>Idx</code> in the following statement? Based on my understanding, <code>std::integral_constant&lt;std::size_t, Idx&gt;</code> is a type. Is it true that <code>std::integral_constant&lt;std::size_t, Idx&gt;{}</code> is a value of <code>Idx</code>?</p>\n\n<p>// OK</p>\n\n<pre><code>template &lt;std::size_t... Idx&gt;\nauto make_index_dispatcher(std::index_sequence&lt;Idx...&gt;) \n{\n    return [](auto&amp;&amp; f) { (f(std::integral_constant&lt;std::size_t, Idx&gt;{}), ...); };\n}\n</code></pre>\n\n<p>// Error</p>\n\n<pre><code>template &lt;std::size_t... Idx&gt;\nauto make_index_dispatcher(std::index_sequence&lt;Idx...&gt;) \n{\n    return [](auto&amp;&amp; f) { (f(Idx), ...); };\n}\n</code></pre>\n\n<p>Is it true that <code>std::get</code> expected compile-time constant expression while <code>Idx</code> is NOT a compile-time constant expression?</p>\n\n<p><strong>Question 2></strong> Why we cannot pass <code>std::index_sequence</code> by reference?</p>\n\n<p>// Error:\n<code>auto make_index_dispatcher(std::index_sequence&lt;Idx...&gt;&amp;)</code></p>\n\n<p>Thank you</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1565188330, "post_id": 57396671, "comment_id": 101275273, "body": "The function insertion returns nothing.:)"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 1, "creation_date": 1565188354, "post_id": 57396671, "comment_id": 101275286, "body": "You should be more careful when you use copy/paste programming."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1565188410, "post_id": 57396671, "comment_id": 101275320, "body": "<code>tree* insertion(int data)</code> -- Looking for the <code>return ptr;</code> in that function...looking...looking...can&#39;t find it.  Undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11896545, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GQV-sG4oUes/AAAAAAAAAAI/AAAAAAAAAO8/-v_bKWecH0I/photo.jpg?sz=128", "display_name": "Anki", "link": "https://stackoverflow.com/users/11896545/anki"}, "edited": false, "score": 0, "creation_date": 1565292630, "post_id": 57396818, "comment_id": 101318412, "body": "Thank you for helping it was a copy-paste mistake"}], "tags": [], "owner": {"reputation": 204, "user_id": 10863549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e264c3689d2cd60f061384a8a1b6348?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Zamboni", "link": "https://stackoverflow.com/users/10863549/marco-zamboni"}, "is_accepted": true, "score": 1, "last_activity_date": 1565188377, "creation_date": 1565188377, "answer_id": 57396818, "question_id": 57396671, "link": "https://stackoverflow.com/questions/57396671/regarding-tree-traversal/57396818#57396818", "title": "Regarding tree traversal", "body": "<p>In every recursive function you call <code>preorder</code> and not the correct function. (In <code>inorder</code> you should call <code>inorder</code> and in <code>postorder</code> call <code>postorder</code></p>\n\n<p>EDIT: I see that the function insertion is of type tree* but returns nothing; maybe you forgot a <code>return ptr</code></p>\n"}], "owner": {"reputation": 3, "user_id": 11896545, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GQV-sG4oUes/AAAAAAAAAAI/AAAAAAAAAO8/-v_bKWecH0I/photo.jpg?sz=128", "display_name": "Anki", "link": "https://stackoverflow.com/users/11896545/anki"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1565188473, "accepted_answer_id": 57396818, "answer_count": 1, "score": -4, "last_activity_date": 1565188377, "creation_date": 1565187945, "question_id": 57396671, "link": "https://stackoverflow.com/questions/57396671/regarding-tree-traversal", "closed_reason": "Not suitable for this site", "title": "Regarding tree traversal", "body": "<p>Tried code for tree traversal but I'm not getting the expected output.</p>\n\n<pre><code>tree* insertion(int data)\n{\n tree *ptr=new tree();\n ptr-&gt;data=data;\n ptr-&gt;left=NULL;\n ptr-&gt;right=NULL;\n}\nvoid preorder(tree* root)\n{\nif(root==NULL)\n    return;\ncout&lt;&lt;root-&gt;data&lt;&lt;\" \";\npreorder(root-&gt;left);\npreorder(root-&gt;right);\n}\nvoid postorder(tree* root)\n{\nif(root==NULL)\n    return;\npreorder(root-&gt;left);\npreorder(root-&gt;right);\ncout&lt;&lt;root-&gt;data&lt;&lt;\" \";\n}\nvoid inorder(tree* root)\n{\nif(root==NULL)\n    return;\npreorder(root-&gt;left);\ncout&lt;&lt;root-&gt;data&lt;&lt;\" \";\npreorder(root-&gt;right);\n}\n</code></pre>\n\n<p>expected output: (a) Inorder (Left, Root, Right) : 4 2 5 1 3\n(b) Preorder (Root, Left, Right) : 1 2 4 5 3\n(c) Postorder (Left, Right, Root) : 4 5 2 3 1</p>\n\n<p>My output: Preorder traversal : 1 2 4 5 3\nPostorder traversal : 2 4 5 3 1\nInorder traversal : 2 4 5 1 3</p>\n"}, {"tags": ["c++", "pytorch", "libraries"], "answers": [{"tags": [], "owner": {"reputation": 138, "user_id": 11864933, "user_type": "registered", "profile_image": "https://graph.facebook.com/2328098633952547/picture?type=large", "display_name": "Mateusz Boruch", "link": "https://stackoverflow.com/users/11864933/mateusz-boruch"}, "is_accepted": true, "score": 1, "last_activity_date": 1565364473, "creation_date": 1565364473, "answer_id": 57433147, "question_id": 57396623, "link": "https://stackoverflow.com/questions/57396623/loading-pytorch-model-in-c-problem-with-libtorch-dll/57433147#57433147", "title": "Loading pytorch model in C++, problem with libtorch.dll", "body": "<p>Ok, ive actually came up with solution by my own.</p>\n\n<p>For some reasons which i completly do not understand i had to put .dll files in my project folder.\nSetting up the path for additional libraries in linker properties seems to not work for those libraries, at least on my PC.</p>\n\n<p>This is very confusing because other, random library which i downloaded for test, I can place wherever i want, all I need to do is just set up correct path in Linker properties.</p>\n\n<p>But not THIS particular library (libtorch).</p>\n\n<p>Anyway, problem is solved, hope that someday someone finds this usefull :)</p>\n"}], "owner": {"reputation": 138, "user_id": 11864933, "user_type": "registered", "profile_image": "https://graph.facebook.com/2328098633952547/picture?type=large", "display_name": "Mateusz Boruch", "link": "https://stackoverflow.com/users/11864933/mateusz-boruch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 969, "favorite_count": 1, "accepted_answer_id": 57433147, "answer_count": 1, "score": 3, "last_activity_date": 1565364473, "creation_date": 1565187796, "last_edit_date": 1565188579, "question_id": 57396623, "link": "https://stackoverflow.com/questions/57396623/loading-pytorch-model-in-c-problem-with-libtorch-dll", "title": "Loading pytorch model in C++, problem with libtorch.dll", "body": "<p>I'm trying to load neural network model trained with pytorch to C++ program.\nThere is a <a href=\"https://pytorch.org/tutorials/advanced/cpp_export.html\" rel=\"nofollow noreferrer\">tutorial</a> how to do it, but can't get it working.</p>\n\n<p>The console appears, and then I get,</p>\n\n<blockquote>\n  <p>\"The Code execution cannot proceed, because the object xxx.dll was not found\".</p>\n</blockquote>\n\n<p>Sometimes it is c10.dll, other time torch.dll, or caffe2.dll.</p>\n\n<p>I checked my C/C++ and Linker properties like 50 times.<br>\nI checked it with using debug and release version of libtorch.<br>\nI ran it on Debug x86, Debug x64, Release x86, Release x64.<br>\nAnd I added those files manually to Debug folder (where .exe file is)<br>\nNone of it worked.</p>\n\n<p>This is my code</p>\n\n<pre><code>#include \"pch.h\"\n#include &lt;torch/script.h&gt;\n#include &lt;memory&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::cout &lt;&lt; \"Hello World!\\n\"; \n}\n</code></pre>\n\n<p>This is how I set directory for header files:</p>\n\n<pre><code> $(SolutionDir)libtorch\\include\n</code></pre>\n\n<p>...and linker directory for additional libraries:</p>\n\n<pre><code>$(SolutionDir)libtorch\\lib\n</code></pre>\n\n<p>...and all .lib files I added:</p>\n\n<pre><code>torch.lib;onnxifi_loader.lib;onnxifi_dummy.lib;onnx_proto.lib;onnx.lib;libprotoc.lib;libprotobuf-lite.lib;libprotobuf.lib;foxi_loader.lib;foxi_dummy.lib;cpuinfo.lib;clog.lib;caffe2_module_test_dynamic.lib;caffe2_detectron_ops.lib;caffe2.lib;c10.lib;\n</code></pre>\n\n<p>It's not that some function or classes from this library are not working. I cannot compile a simple \"Hello World\" program.</p>\n\n<p>I even downloaded some random .dll file to check if it is this particular library problem, and other .dll worked with no problems.</p>\n\n<p>I set up the project manually, and followed the instruction from the link I sent (with creating project with CMAKE), and still I have this error.</p>\n\n<p>I'm working on it for few hours and I'm pretty annoyed about this.I ran out of ideas. I really don't know what else I could miss in this situation.</p>\n\n<p>I'm running VS 2017 Community, version 15.9.14 on Windows 10.</p>\n"}, {"tags": ["c++", "initialization", "language-lawyer", "c++17", "conversion-operator"], "comments": [{"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1565188497, "post_id": 57396416, "comment_id": 101275384, "body": "Over at <a href=\"https://rextester.com/NZZMM41358\" rel=\"nofollow noreferrer\">RexTester</a>, I also got <code>note: or &#39;Bar::Bar(const Bar &amp;)&#39;</code>, which makes a bit more sense."}, {"owner": {"reputation": 6883, "user_id": 3043539, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9b4da211d51b30b90ac532d6f0b07884?s=128&d=identicon&r=PG&f=1", "display_name": "Constructor", "link": "https://stackoverflow.com/users/3043539/constructor"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1565189954, "post_id": 57396416, "comment_id": 101276190, "body": "@PaulSanders Rextester uses an old version of <i>MSVC</i> (provided together with <i>Microsoft Visual Studio 2015</i>), in godbolt that I have used <i>MSVC 19.22</i> (provided together with the latest <i>MSVS 2019 version 16.2</i>) is available."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565189098, "post_id": 57396850, "comment_id": 101275740, "body": "Call this an extension then for gcc and clang?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565189964, "post_id": 57396850, "comment_id": 101276197, "body": "@NathanOliver Maybe? I think of extensions as like.. things that definitely aren&#39;t in the language that compilers added anyway. Like... expression-statements are certainly an extension. This is more like, a pre-interpretation of a core language issue? It&#39;s a bit fuzzy."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 8, "last_activity_date": 1565188508, "creation_date": 1565188508, "answer_id": 57396850, "question_id": 57396416, "link": "https://stackoverflow.com/questions/57396416/different-behavior-of-direct-and-copy-initialization-on-ms-vc-using-user-defi/57396850#57396850", "title": "Different behavior of direct and copy initialization on MS VC++ (using user-defined conversion operators)", "body": "<p>I think this is basically a manifestation of <a href=\"https://wg21.link/cwg2327\" rel=\"noreferrer\">CWG 2327</a>, which dealt with this example:</p>\n\n<pre><code>struct Cat {};\nstruct Dog { operator Cat(); };\n\nDog d;\nCat c(d);\n</code></pre>\n\n<p>The crux of the issue was that we don't allow for guaranteed copy elision in this case - because we go through <code>Cat</code>'s move constructor rather than just initializing via <code>Dog::operator Cat()</code> directly.</p>\n\n<p>And it seems like gcc and clang both already implement the <em>intent</em> of the issue - which is to do overload resolution on both the constructors and conversion functions at the same time. </p>\n\n<p>In your example:</p>\n\n<pre><code>Bar b2(foo);\n</code></pre>\n\n<p>Per the letter of the standard, we consider constructors (and <a href=\"http://eel.is/c++draft/dcl.init#17.6.2.sentence-2\" rel=\"noreferrer\">only constructors</a>) - which are <code>Bar(X)</code>, <code>Bar(Bar const&amp;)</code>, and <code>Bar(Bar&amp;&amp;)</code>. All three of those are viable, the first by way of <code>Foo::operator X() const</code> and the second and third by way of <code>Foo::operator Bar() const</code>. We can prefer <code>Bar(Bar&amp;&amp;)</code> to <code>Bar(Bar const&amp;)</code> but we have way of disambiguating between <code>Bar(X)</code> and <code>Bar(Bar&amp;&amp;)</code>. MSVC is following the standard in correctly rejecting this initialization. It is not a bug.</p>\n\n<p>But the spirit of CWG 2327 is that this should invoke <code>Foo::operator Bar() const</code> directly, which is what gcc and clang do. It is hard to say that this is a bug on their side either since that's probably the behavior we actually want to happen, and will likely be the way it is specified at some point in the future. </p>\n"}], "owner": {"reputation": 6883, "user_id": 3043539, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9b4da211d51b30b90ac532d6f0b07884?s=128&d=identicon&r=PG&f=1", "display_name": "Constructor", "link": "https://stackoverflow.com/users/3043539/constructor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1565188508, "creation_date": 1565187104, "last_edit_date": 1565188457, "question_id": 57396416, "link": "https://stackoverflow.com/questions/57396416/different-behavior-of-direct-and-copy-initialization-on-ms-vc-using-user-defi", "title": "Different behavior of direct and copy initialization on MS VC++ (using user-defined conversion operators)", "body": "<p>The following code <a href=\"https://godbolt.org/z/-ARWs4\" rel=\"nofollow noreferrer\">compiles fine</a> with both <em>g++ 9.1</em> and <em>clang 8.0.0</em> (compilation flags are <code>-std=c++17 -Wall -Wextra -Werror -pedantic-errors</code>), but not with <em>MSVC 19.22</em> (compilation flags are <code>/std:c++17 /permissive-</code>):</p>\n\n<pre><code>struct X{};\n\nstruct Bar\n{\n    Bar() = default;\n\n    Bar(X){}\n};\n\nstruct Foo\n{\n    operator X() const\n    {\n        return X{};\n    }\n\n    operator Bar() const\n    {\n        return Bar{};\n    }\n};\n\nint main()\n{\n    Foo foo;\n    [[maybe_unused]]Bar b1 = foo; // OK\n    [[maybe_unused]]Bar b2(foo);  // failed\n}\n</code></pre>\n\n<p><em>MSVC</em> compilation errors:</p>\n\n<pre><code>&lt;source&gt;(27): error C2668: 'Bar::Bar': ambiguous call to overloaded function\n&lt;source&gt;(8): note: could be 'Bar::Bar(Bar &amp;&amp;)'\n&lt;source&gt;(7): note: or       'Bar::Bar(X)'\n&lt;source&gt;(27): note: while trying to match the argument list '(Foo)'\n</code></pre>\n\n<p>Is it a bug in <em>MSVC</em>? </p>\n"}, {"tags": ["javascript", "c++", "node.js", "n-api"], "comments": [{"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1565620145, "post_id": 57396412, "comment_id": 101399660, "body": "Are you ok with setting it one time? like <code>my_napi_module.callback_func = xyz</code>?"}, {"owner": {"reputation": 6810, "user_id": 1668622, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/2RRcb.png?s=128&g=1", "display_name": "frans", "link": "https://stackoverflow.com/users/1668622/frans"}, "reply_to_user": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1565620364, "post_id": 57396412, "comment_id": 101399767, "body": "Would be a workaround for me - since the solution I&#39;m working on has to work with emscripten and N-API at some time. But setting the callback from JS would at least be a good starting point :)"}, {"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 1, "creation_date": 1565620725, "post_id": 57396412, "comment_id": 101399979, "body": "Look at these two threads then <a href=\"https://stackoverflow.com/questions/29165155/calling-javascript-from-c-with-node-js\" title=\"calling javascript from c with node js\">stackoverflow.com/questions/29165155/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/46559457/v8-extracting-a-global-object-from-nodejs-in-c\" title=\"v8 extracting a global object from nodejs in c\">stackoverflow.com/questions/46559457/&hellip;</a>. So basically you will use the second article to extract the function from the global object and then use the first approach to actually call the function. This gets both the things done as to what you want"}, {"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1566066932, "post_id": 57396412, "comment_id": 101542168, "body": "any update on the links I posted?"}, {"owner": {"reputation": 6810, "user_id": 1668622, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/2RRcb.png?s=128&g=1", "display_name": "frans", "link": "https://stackoverflow.com/users/1668622/frans"}, "reply_to_user": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1566194909, "post_id": 57396412, "comment_id": 101564748, "body": "They&#39;re indeed helpful since it seems to be an actually working examples. My problem is still that I have a thread which produces data I want to &#39;send&#39; to the JavaScript world and I haven&#39;t found a way yet to get into the main thread apart from calling a C++ function from JavaScript. In this case I&#39;m polling anyway and I don&#39;t need to call a JavaScript function anymore. Maybe this is the better approach in this case since calling JavaScript functions is much better supported by frameworks like Emscripten and N-API and I can keep my code generic."}], "answers": [{"tags": [], "owner": {"reputation": 6810, "user_id": 1668622, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/2RRcb.png?s=128&g=1", "display_name": "frans", "link": "https://stackoverflow.com/users/1668622/frans"}, "is_accepted": false, "score": 4, "last_activity_date": 1565263039, "last_edit_date": 1565263039, "creation_date": 1565256954, "answer_id": 57409522, "question_id": 57396412, "link": "https://stackoverflow.com/questions/57396412/call-an-existing-javascript-function-from-a-c-node-js-addon-from-another-thr/57409522#57409522", "title": "Call an existing JavaScript function from a C++ Node.js addon - from another thread", "body": "<p><strong>This is NOT an answer</strong> - just some research outcomes..</p>\n\n<p>Looks like the code I have to write has to look like this - currently I don't know how to set up everything to work..</p>\n\n<p>Most of the code is taken from this <a href=\"https://github.com/abhi-bit/eventing/blob/master/v8_consumer/src/v8worker.cc\" rel=\"nofollow noreferrer\">eventing fork</a>.</p>\n\n<p>These value have to be available - seems like I have to initialize them in the module initialization..</p>\n\n<pre><code>static v8::Persistent&lt;v8::Context&gt; context_;\nstatic v8::Isolate *isolate_;\n</code></pre>\n\n<p>This function does both turning <code>log_message_callback()</code> from the JavaScript wold into a \n<code>v8::Function</code> and calling it. A more sophisticated approach would separate these steps:</p>\n\n<pre><code>extern \"C\" {\n\nvoid log_message_callback(char const* message) {\n  v8::Locker locker(isolate_);\n  v8::Isolate::Scope isolate_scope(isolate_);\n  v8::HandleScope handle_scope(isolate_);\n  auto context = context_.Get(isolate_);\n  v8::Context::Scope context_scope(context);\n\n  v8::Persistent&lt;v8::Function&gt; log_message_callback_fn;\n\n  /// this is only needed once - just for demonstration\n  {\n    auto global = context-&gt;Global();\n    v8::Local&lt;v8::Value&gt; log_message_callback_def;\n    if (!global-&gt;Get(\n          context, v8Str(isolate_, \"log_message_callback\")).ToLocal(&amp;log_message_callback_def)) {\n      return;\n    }\n\n    if (!log_message_callback_def-&gt;IsFunction()) {\n      return;\n    }\n\n\n    if (log_message_callback_def-&gt;IsFunction()) {\n      auto on_update_fun = log_message_callback_def.As&lt;v8::Function&gt;();\n      log_message_callback_fn.Reset(isolate_, on_update_fun);\n    }\n  }  \n\n  v8::Local&lt;v8::Value&gt; args[2];\n  log_message_callback_fn.Get(isolate_)-&gt;Call(context-&gt;Global(), 2, args);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1014, "user_id": 2157864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rjwPF.jpg?s=128&g=1", "display_name": "Satyan", "link": "https://stackoverflow.com/users/2157864/satyan"}, "is_accepted": false, "score": 5, "last_activity_date": 1565645475, "creation_date": 1565645475, "answer_id": 57468507, "question_id": 57396412, "link": "https://stackoverflow.com/questions/57396412/call-an-existing-javascript-function-from-a-c-node-js-addon-from-another-thr/57468507#57468507", "title": "Call an existing JavaScript function from a C++ Node.js addon - from another thread", "body": "<blockquote>\n  <p>JavaScript functions can normally only be called from a native addon's\n  main thread. You may get more information about it from</p>\n</blockquote>\n\n<p>.\n<a href=\"https://nodejs.org/dist/latest-v11.x/docs/api/n-api.html#n_api_asynchronous_thread_safe_function_calls\" rel=\"noreferrer\">https://nodejs.org/dist/latest-v11.x/docs/api/n-api.html#n_api_asynchronous_thread_safe_function_calls</a></p>\n\n<p>The <strong>napi_call_function()</strong> can be used for calling a JavaScript function from native layer. The documentation has a code snippet for it's usage as well.\n<a href=\"https://nodejs.org/dist/latest-v11.x/docs/api/n-api.html#n_api_napi_call_function\" rel=\"noreferrer\">https://nodejs.org/dist/latest-v11.x/docs/api/n-api.html#n_api_napi_call_function</a></p>\n"}], "owner": {"reputation": 6810, "user_id": 1668622, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/2RRcb.png?s=128&g=1", "display_name": "frans", "link": "https://stackoverflow.com/users/1668622/frans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 2, "answer_count": 2, "score": 8, "last_activity_date": 1566195039, "creation_date": 1565187086, "last_edit_date": 1566195039, "question_id": 57396412, "link": "https://stackoverflow.com/questions/57396412/call-an-existing-javascript-function-from-a-c-node-js-addon-from-another-thr", "title": "Call an existing JavaScript function from a C++ Node.js addon - from another thread", "body": "<p>Maybe I just don't search for the right terms but I'm stuck..</p>\n\n<p>I need to call a JavaScript function from C++, very similar to what can be <a href=\"https://nodejs.org/api/n-api.html#n_api_napi_call_function\" rel=\"noreferrer\">done using the plain C API</a>.</p>\n\n<p>Note: I <em>don't</em> want to pass a <em>callback</em> to the C++ code but I already know the name of the function to be called!</p>\n\n<p>So for example I have a function like this in JavaScript:</p>\n\n<pre><code>function log_message_callback(context, message) {\n  console.log(`${context}: ${message}`);\n}\n\nmy_napi_module.initialize();   // &lt;-- starts thread that would call log_message_callback\n\n</code></pre>\n\n<p>And from C++ I want to call it (btw, from a thread different from the main thread):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;napi.h&gt;\n\nvoid log_message_callback(char const* message) {\n  // magic Napi code which would call log_message_callback in JavaScript\n} \n\nvoid some_thread_fn() {\n  log_message_callback(\"hello world\");\n}\n</code></pre>\n\n<p>Can I do this? How would I do this? And what should I have been looking for?!</p>\n"}, {"tags": ["c++", "shared-libraries", "protocol-buffers", "zeromq", "static-linking"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1565187033, "post_id": 57396271, "comment_id": 101274463, "body": "I think you need to compile libprotobuf and libzmq with <code>-fPIC</code> or <code>-fPIE</code> as well."}, {"owner": {"reputation": 1, "user_id": 6356339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1752e53b46a91c863c726e08e0fb1e66?s=128&d=identicon&r=PG&f=1", "display_name": "Luigis", "link": "https://stackoverflow.com/users/6356339/luigis"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1565187535, "post_id": 57396271, "comment_id": 101274787, "body": "@botje I tried to compile libzmq with -fPIC following <a href=\"https://github.com/zeromq/zyre/issues/609\" rel=\"nofollow noreferrer\">this link</a> but didin&#39;t solve the problem"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1565188281, "post_id": 57396271, "comment_id": 101275245, "body": "Did you remove any built files first? Did you make sure to link against the newly generated libzmq?"}, {"owner": {"reputation": 1, "user_id": 6356339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1752e53b46a91c863c726e08e0fb1e66?s=128&d=identicon&r=PG&f=1", "display_name": "Luigis", "link": "https://stackoverflow.com/users/6356339/luigis"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1565194501, "post_id": 57396271, "comment_id": 101278576, "body": "@botje yes I remove every libzmq file before recompiling, I find them using <code>find &#47; -name &quot;*libzmq*&quot;</code>"}], "owner": {"reputation": 1, "user_id": 6356339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1752e53b46a91c863c726e08e0fb1e66?s=128&d=identicon&r=PG&f=1", "display_name": "Luigis", "link": "https://stackoverflow.com/users/6356339/luigis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565186668, "creation_date": 1565186668, "question_id": 57396271, "link": "https://stackoverflow.com/questions/57396271/how-to-static-link-zmq-and-protobuf-in-a-shared-library", "title": "How to static link zmq and protobuf in a shared library?", "body": "<p>My goal is to create a shared library that includes statically protobuf and zeromq libraries. They should be inside <code>libfoo.so</code> </p>\n\n<p>I have <code>foo.cpp</code> </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;zmq.hpp&gt;\n#include &lt;string.h&gt;\n#include \"messages.pb.h\"\n#include \"foo.h\"\n\nint fooFunction(){ \n// Use zmq and protobuf\n}\n</code></pre>\n\n<p>To compile I use the following commands</p>\n\n<p><code>c++ -Wall -fPIC -c foo.cpp -o foo.o</code></p>\n\n<p><code>c++ -fPIC -c messages.pb.cc -o messages.o</code></p>\n\n<p><code>c++ -shared -Wl,-soname,libfoo.so -o libfoo.so  foo.o messages.o /usr/lib/libprotobuf.a /usr/local/lib/libzmq.a</code></p>\n\n<p>This error appears: </p>\n\n<pre><code>/usr/bin/ld: /usr/local/lib/libzmq.a(src_libzmq_la-ctx.o): relocation R_X86_64_PC32 against symbol `stderr@@GLIBC_2.2.5' can not be used when making a shared object; recompile with -fPIC\n/usr/bin/ld: final link failed: Bad value\n</code></pre>\n\n<p>I tried to recompile zmq with this flags <code>./configure --enable-static --disable-shared</code> but nothing happend.`</p>\n\n<p>I tried to link with the following command but didn't solve my problem: <code>c++ -shared -Wl,-soname,libfoo.so -o libfoo.so  foo.o messages.o -Bstatic -lprotobuf -lzmq</code></p>\n"}, {"tags": ["c++", "winapi"], "comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 3, "creation_date": 1565186625, "post_id": 57396098, "comment_id": 101274212, "body": "You&#39;re mallocing the wrong size. <code>sizeof(startUpInfo)</code> is the size of a <i>pointer</i>, not the size of the struct.  Use <code>sizeof(STARTUPINFOA)</code>, or better yet use <code>new STARTUPINFOA</code>.  (Same for <code>processInformation</code>)."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1565186946, "post_id": 57396098, "comment_id": 101274405, "body": "If you would add error checking to your code, then the system would tell you what you did wrong. So many questions in the winapi tag can readily by answered by the asker if only error checking was performed."}, {"owner": {"reputation": 111, "user_id": 7756046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491bee253b4c38ac4b1a5d3c685c10a7?s=128&d=identicon&r=PG&f=1", "display_name": "Llallum", "link": "https://stackoverflow.com/users/7756046/llallum"}, "edited": false, "score": 0, "creation_date": 1565186960, "post_id": 57396098, "comment_id": 101274411, "body": "Thank you everyone for your help. I realize that I am using the startUpInfo which is a pointer and now it works."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1565187064, "post_id": 57396098, "comment_id": 101274481, "body": "Before you leave this topic, try and add error checking and see what it tells you. Hopefully that will help convince you of the importance and value of error checking."}, {"owner": {"reputation": 111, "user_id": 7756046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491bee253b4c38ac4b1a5d3c685c10a7?s=128&d=identicon&r=PG&f=1", "display_name": "Llallum", "link": "https://stackoverflow.com/users/7756046/llallum"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1565187290, "post_id": 57396098, "comment_id": 101274627, "body": "I&#39;d thought that it is just a boolean so I used the if statement, however, I realized that I should should GetLastError. Thank you for your time in answering my question. @DavidHeffernan"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 2, "creation_date": 1565187357, "post_id": 57396098, "comment_id": 101274668, "body": "Yeah, you need to check the return value first to see if there was an error, and then call <code>GetLastError</code> if there was. Most win32 functions are like that, but not all. Have to check the doc for each one. Btw, the second argument to <code>CreateProcess</code> should point to a writeable buffer (a literal is not).  Your code gets away with it because of a quirk with the ANSI implementation, but you would not get away with it if you used <code>CreateProcessW</code>. And you should be using <code>CreateProcessW</code>."}], "owner": {"reputation": 111, "user_id": 7756046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491bee253b4c38ac4b1a5d3c685c10a7?s=128&d=identicon&r=PG&f=1", "display_name": "Llallum", "link": "https://stackoverflow.com/users/7756046/llallum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 410, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565186321, "creation_date": 1565186110, "last_edit_date": 1565186321, "question_id": 57396098, "link": "https://stackoverflow.com/questions/57396098/how-can-i-use-lpstartupinfo-and-lpprocessinfo-properly-in-createprocessa", "title": "How can I use LPSTARTUPINFO and LPPROCESSINFO properly in CreateProcessA?", "body": "<p>I tried to use the tutorials around about using the CreateProcessA wherein it uses the <code>STARTUPINFOA</code> and <code>LPPROCESS_INFORMATION</code>.</p>\n\n<p>However, when I tried to use the LPSTARTUPINFOA and LPPROCESS_INFORMATION and sadly it didn't work. </p>\n\n<pre><code>//Working\n\nSTARTUPINFOA startUpInfo = {0};\n\nPROCESS_INFORMATION processInformation = {0};\n\nstartUpInfo.cb = sizeof(STARTUPINFOA);\n\nCreateProcessA(NULL, \"c:\\\\windows\\\\system32\\\\calc.exe\", NULL, NULL, FALSE, 0, NULL, NULL, &amp;startUpInfo, &amp;processInformation);\n\n\n//Fails\n\n\nLPSTARTUPINFOA startUpInfo;\n\nLPPROCESS_INFORMATION processInformation;\n\nstartUpInfo = (LPSTARTUPINFOA)malloc(sizeof(startUpInfo));\n\nprocessInformation = (LPPROCESS_INFORMATION)malloc(sizeof(processInformation));\n\nZeroMemory(startUpInfo, sizeof(STARTUPINFOA));\n\nZeroMemory(processInformation, sizeof(PROCESS_INFORMATION));\n\nstartUpInfo-&gt;cb = sizeof(STARTUPINFOA);\n\nCreateProcessA(NULL,\"c:\\\\windows\\\\system32\\\\calc.exe\", NULL, NULL, FALSE, 0, NULL, NULL, startUpInfo, processInformation);\n</code></pre>\n\n<p>I expect that both would work successfully, however, I wonder why <code>LPSTARTUPINFOA</code> and <code>LPPROCESS_INFORMATION</code> fails. Is there anyone who can enlighten me about my error in this program below.</p>\n"}, {"tags": ["c#", "c++", ".net", ".net-core", "wrapper"], "answers": [{"tags": [], "owner": {"reputation": 7489, "user_id": 2183287, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f994c77448da7979a598ef76d270de67?s=128&d=identicon&r=PG&f=1", "display_name": "fatihk", "link": "https://stackoverflow.com/users/2183287/fatihk"}, "is_accepted": true, "score": 1, "last_activity_date": 1565341704, "creation_date": 1565341704, "answer_id": 57426844, "question_id": 57395942, "link": "https://stackoverflow.com/questions/57395942/passing-a-c-array-to-c-layer-through-net-core/57426844#57426844", "title": "Passing a C++ Array to C# Layer through Net Core", "body": "<p>Great!, Finally I have found out the problem. In the delegate declaration, I just had to introduce parameter <em>SizeParamIndex</em> :</p>\n\n<pre><code>delegate void OnSpeechEndedInter(\n            [In, MarshalAs(UnmanagedType.LPArray, SizeParamIndex = 1)] short[] untouched, \n            int untouchedSize, \n            [In, MarshalAs(UnmanagedType.LPArray, SizeParamIndex = 3)] short[] audioAfterPostSpeechUntilSilenceTrigger,\n            int audioAfterPostSpeechUntilSilenceTriggerSize);\n</code></pre>\n\n<p>Because the marshaler cannot determine the size of an unmanaged array, we have to pass it in as a separate parameter considering the signature of the method and zero based indexing. </p>\n"}], "owner": {"reputation": 7489, "user_id": 2183287, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f994c77448da7979a598ef76d270de67?s=128&d=identicon&r=PG&f=1", "display_name": "fatihk", "link": "https://stackoverflow.com/users/2183287/fatihk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 57426844, "answer_count": 1, "score": 1, "last_activity_date": 1565341704, "creation_date": 1565185575, "last_edit_date": 1565247334, "question_id": 57395942, "link": "https://stackoverflow.com/questions/57395942/passing-a-c-array-to-c-layer-through-net-core", "title": "Passing a C++ Array to C# Layer through Net Core", "body": "<p>I have a native library and what I'm trying to do is to write a .NET Core wrapper to this native library.</p>\n\n<p>On the native side i have an event called <em>OnSpeechEnded</em> :</p>\n\n<pre><code>virtual void OnSpeechEnded(SpeechEndInfo seInfo) = 0;\n</code></pre>\n\n<p>and native struct <em>SpeechEndInfo</em> has the following structure:</p>\n\n<pre><code>struct SpeechEndInfo\n{\n    std::vector&lt;AudioData&gt; UntouchedData;\n    std::vector&lt;AudioData&gt; AudioAfterPostSpeechUntilSilenceTrigger;\n};\n</code></pre>\n\n<p>Corresponding .NET Standard Class:</p>\n\n<pre><code> public struct SpeechEndedInfo\n    {\n        public SpeechEndedInfo(short[] untouchedData, short[] audioAfterPostSpeechUntilSilenceTrigger)\n        {\n            UntouchedData = new short[untouchedData.Length];\n            untouchedData.CopyTo(UntouchedData, 0);\n\n\n            AudioAfterPostSpeechUntilSilenceTrigger = new short[audioAfterPostSpeechUntilSilenceTrigger.Length];\n            audioAfterPostSpeechUntilSilenceTrigger.CopyTo(AudioAfterPostSpeechUntilSilenceTrigger, 0);\n\n\n        }\n\n        public short[] UntouchedData { get; set; }\n        public short[] AudioAfterPostSpeechUntilSilenceTrigger { get; set; }\n    };\n</code></pre>\n\n<p>On .NET Standard side, the following delegate is defined:</p>\n\n<pre><code>delegate void OnSpeechEndedInter(\n            [In, MarshalAs(UnmanagedType.LPArray)] short[] untouched, \n            int untouchedSize, \n            [In, MarshalAs(UnmanagedType.LPArray)] short[] audioAfterPostSpeechUntilSilenceTrigger,\n            int audioAfterPostSpeechUntilSilenceTriggerSize);\n</code></pre>\n\n<p>Declaring pinvoke:</p>\n\n<pre><code>[DllImport(\"VadLite.Pinvokable.dll\", CallingConvention = CallingConvention.Cdecl)]\n        private static extern void RegisterToSpeechEndedEvent(IntPtr parameters, [MarshalAs(UnmanagedType.FunctionPtr)]OnSpeechEndedInter onSpeechEndedInter);\n</code></pre>\n\n<p>Declaring _onSpeechEndedInter:</p>\n\n<pre><code> private OnSpeechEndedInter _onSpeechEndedInter;\n</code></pre>\n\n<p>Assigning a method to the event:</p>\n\n<pre><code> _onSpeechEndedInter = invokedMethod;\n</code></pre>\n\n<p>...</p>\n\n<pre><code>void invokedMethod(short[] untouchedData, \n            int untouchedSize, \n            short[] audioAfterPostSpeechUntilSilenceTrigger,\n            int audioAfterPostSpeechUntilSilenceTriggerSize)\n        {\n            OnSpeechEnded?.Invoke(new SpeechEndedInfo(untouchedData, audioAfterPostSpeechUntilSilenceTrigger));\n        }\n</code></pre>\n\n<p>Finally, the code where native arrays are sent:</p>\n\n<pre><code>RegisterToSpeechEndedEvent(\n        void * possiblyOperations,\n        void __stdcall onSpeechEndedListener(const int16_t* pUntouchedData, int pUntouchedDataSize, const int16_t *vAudioAfterPostSpeechUntilSilenceTrigger, int vAudioAfterPostSpeechUntilSilenceTriggerSize))\n    {\n\n        auto op = (OperationParameters *)possiblyOperations;\n        op-&gt;OnSpeechEnded([onSpeechEndedListener](SpeechEndInfo ssInfo) {\n\n\n            std::vector&lt;int16_t&gt; untouchedData;\n            std::vector&lt;int16_t&gt; audioAfterPostSpeechUntilSilenceTrigger;\n\n            for (auto &amp; audioData : ssInfo.UntouchedData)\n            {\n                untouchedData.insert(untouchedData.end(), audioData.Samples, audioData.Samples + audioData.SampleCount);\n            }\n\n\n            for (auto &amp; audioData : ssInfo.AudioAfterPostSpeechUntilSilenceTrigger)\n            {\n                audioAfterPostSpeechUntilSilenceTrigger.insert(audioAfterPostSpeechUntilSilenceTrigger.end(), audioData.Samples, audioData.Samples + audioData.SampleCount);\n            }\n\n\n\n            onSpeechEndedListener(untouchedData.empty() ? nullptr : untouchedData.data(),\n                    (int)untouchedData.size(),\n                    audioAfterPostSpeechUntilSilenceTrigger.empty() ? nullptr : audioAfterPostSpeechUntilSilenceTrigger.data(),\n                    (int)audioAfterPostSpeechUntilSilenceTrigger.size());\n\n        });\n</code></pre>\n\n<p>After running the test program and getting meaningful array sizes on the native side, C# arrays UntouchedData and AudioAfterPostSpeechUntilSilenceTrigger  always seem to have size 1. </p>\n\n<p>Probably there is a detail I have missed. I can provide further detail if it is required. Thanks.</p>\n"}, {"tags": ["c++", "windows", "qt"], "comments": [{"owner": {"reputation": 7679, "user_id": 896012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/05779413dbb3915fa5b2f3ed82d66007?s=128&d=identicon&r=PG", "display_name": "Gupta", "link": "https://stackoverflow.com/users/896012/gupta"}, "edited": false, "score": 0, "creation_date": 1565184311, "post_id": 57395491, "comment_id": 101272684, "body": "Because calling .exec on QCoreApplication enters the main event loop and waits until exit() is called."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 3, "creation_date": 1565184391, "post_id": 57395491, "comment_id": 101272747, "body": "The documentation for <code>QCoreApplication::exec()</code> is self-explanatory about this  ....   &quot;We recommend that you connect clean-up code to the <code>aboutToQuit()</code> signal, instead of putting it in your application&#39;s <code>main()</code> function because on some platforms the <code>exec()</code> call may not return. For example, on Windows when the user logs off, the system terminates the process after Qt closes all top-level windows. Hence, there is no guarantee that the application will have time to exit its event loop and execute code at the end of the <code>main()</code> function after the <code>exec()</code> call.&quot;"}, {"owner": {"reputation": 497, "user_id": 4373753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uaz9A.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/4373753/greg"}, "edited": false, "score": 0, "creation_date": 1565184493, "post_id": 57395491, "comment_id": 101272816, "body": "Your class is instanciated on the stack and will be destructed once you get out of your scope. Use a pointer to allocate it on the heap and call the destructor with delete when app is about to quit : <a href=\"https://doc.qt.io/qt-5/qcoreapplication.html#aboutToQuit\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qcoreapplication.html#aboutToQuit</a>"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1565186673, "post_id": 57395491, "comment_id": 101274245, "body": "I don&#39;t have time to write an answer right now (so anybody, feel free to do so), but solution to your problem should be found behind these two links: <a href=\"https://doc.qt.io/qt-5/unix-signals.html\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/unix-signals.html</a> and <a href=\"https://stackoverflow.com/q/26658707/1717300\">stackoverflow.com/q/26658707/1717300</a> (note: not duplicate, doesn&#39;t cover how to do it in Qt)."}], "answers": [{"comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1565186274, "post_id": 57395664, "comment_id": 101273988, "body": "I did a quick test, and in that it seems <code>aboutToQuit</code> is not emitted, when I close the console window. Logging to file and flushing after every log line, the lines before <code>a.exec()</code> are written, but nothing after it, nor from <code>aboutToQuit</code> receiver lambda."}, {"owner": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1565186401, "post_id": 57395664, "comment_id": 101274073, "body": "Yep, I was a bit too quick to answer, I thought it would work but it&#39;s not. I&#39;m trying other approaches right now, but I don&#39;t think there&#39;s an easy way."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1565186729, "post_id": 57395664, "comment_id": 101274272, "body": "See my comment under the Q."}, {"owner": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1565187626, "post_id": 57395664, "comment_id": 101274848, "body": "@hyde yep, that actually works, I&#39;ve updated the answer."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1565189150, "post_id": 57395664, "comment_id": 101275764, "body": "Yeah, but Qt isn&#39;t &quot;async safe&quot; so you are not allowed to call Qt methods from signal handlers... So the links under the Q."}], "tags": [], "owner": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "is_accepted": false, "score": 1, "last_activity_date": 1565187605, "last_edit_date": 1565187605, "creation_date": 1565184594, "answer_id": 57395664, "question_id": 57395491, "link": "https://stackoverflow.com/questions/57395491/how-to-run-my-destructor-before-close-the-qt-console-application/57395664#57395664", "title": "How to run my destructor before close the Qt Console Application?", "body": "<p>You probably want to do something like this. I'm not sure if it works on Windows since I don't have it right now, but it work on Linux.</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;QCoreApplication&gt;\n#include &lt;QObject&gt;\n\nclass MyClass : public QObject\n{\n    Q_OBJECT\npublic:\n    MyClass()\n    {\n        qDebug() &lt;&lt; \"MyClass()\";\n    }\n    ~MyClass()\n    {\n        qDebug() &lt;&lt; \"~MyClass()\";\n    }\n};\n\nvoid SigInt_Handler(int)\n{\n    qDebug() &lt;&lt; \"Interrupt received\";\n    qApp-&gt;quit();\n}\n\nint main(int argc, char *argv[])\n{\n    QCoreApplication a(argc, argv);\n\n    MyClass my;\n\n    signal(SIGINT, &amp;SigInt_Handler);\n\n    int ret = a.exec();\n\n    return ret;\n}\n</code></pre>\n\n<p>Also your <code>MyClass</code> should extend <code>QObject</code> if you use the <code>Q_OBJECT</code> macro in it.</p>\n\n<p>When pressing <code>Ctrl+C</code> this will be printed:</p>\n\n<pre><code>Interrupt received\n~MyClass()\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4369536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fET55.jpg?s=128&g=1", "display_name": "Liu Guangxuan", "link": "https://stackoverflow.com/users/4369536/liu-guangxuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565187605, "creation_date": 1565184023, "question_id": 57395491, "link": "https://stackoverflow.com/questions/57395491/how-to-run-my-destructor-before-close-the-qt-console-application", "title": "How to run my destructor before close the Qt Console Application?", "body": "<p>I want to run my destructor before click the close button of Qt console application.I found this on stackoverflow,<a href=\"https://stackoverflow.com/questions/13465172/destructor-not-called-in-qt-console-scenario\">Destructor not called in Qt console scenario</a> .</p>\n\n<p>I have tried to get the return value ,and return the value after.but it is nothing to help.</p>\n\n<pre><code>\nclass MyClass\n{\n    Q_OBJECT\npublic:\n    MyClass()\n    {\n        qDebug() &lt;&lt; \"MyClass()\";\n    }\n    ~MyClass()\n    {\n        qDebug() &lt;&lt; \"~MyClass()\";\n    }\n};\n\nint main(int argc, char *argv[])\n{\n    QCoreApplication a(argc, argv);\n\n    MyClass my;\n\n    int ret = a.exec();\n\n    qDebug() &lt;&lt; \"this line will not run.\";\n\n    return ret;\n}\n</code></pre>\n\n<ol>\n<li><p>I want to know why it doesn't run my destructor.</p></li>\n<li><p>If I want to run it.how?</p></li>\n</ol>\n\n<p>I want it to output <code>MyClass()</code> and <code>this line will not run.</code> and <code>~MyClass()</code> when I click the close button.</p>\n"}, {"tags": ["c++", "opencv", "gpu", "video-capture"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 3, "creation_date": 1565183013, "post_id": 57395075, "comment_id": 101271848, "body": "What reason do you have to think that it would be a CPU thing?"}, {"owner": {"reputation": 326, "user_id": 11549805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/485b34152b0a5062449aae2af4b8e868?s=128&d=identicon&r=PG&f=1", "display_name": "TheBarrometer", "link": "https://stackoverflow.com/users/11549805/thebarrometer"}, "edited": false, "score": 1, "creation_date": 1565184469, "post_id": 57395075, "comment_id": 101272797, "body": "OpenCV&#39;s Video Capture class is built around several 3rd party backends, several of which use GPU acceleration for encoding/decoding."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1565185776, "post_id": 57395075, "comment_id": 101273661, "body": "Because a GPU (&quot;Graphics Processing Unit&quot;) is better at processing graphics than a CPU. And yes, most video sensor output needs a bunch of further processing to be human-interpretable."}, {"owner": {"reputation": 315, "user_id": 9287680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bv5xK.png?s=128&g=1", "display_name": "X. Sun", "link": "https://stackoverflow.com/users/9287680/x-sun"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1565224431, "post_id": 57395075, "comment_id": 101289038, "body": "@ThomasJager Because only &quot;3D&quot; block is used, while &quot;copy&quot;, &quot;encode&quot; and &quot;decode&quot; show no usage, which usually means nothing is copied to gpu memory and no decoding/encoding is performed. I wonder if anything can be processed by gpu without copying to gpu memory first."}, {"owner": {"reputation": 315, "user_id": 9287680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bv5xK.png?s=128&g=1", "display_name": "X. Sun", "link": "https://stackoverflow.com/users/9287680/x-sun"}, "reply_to_user": {"reputation": 326, "user_id": 11549805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/485b34152b0a5062449aae2af4b8e868?s=128&d=identicon&r=PG&f=1", "display_name": "TheBarrometer", "link": "https://stackoverflow.com/users/11549805/thebarrometer"}, "edited": false, "score": 0, "creation_date": 1565224530, "post_id": 57395075, "comment_id": 101289061, "body": "@TheBarrometer As shown in the screen shot &quot;encode&quot; and &quot;decode&quot; blocks show no usage, so I&#39;m not sure that&#39;s the case."}], "answers": [{"tags": [], "owner": {"reputation": 315, "user_id": 9287680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bv5xK.png?s=128&g=1", "display_name": "X. Sun", "link": "https://stackoverflow.com/users/9287680/x-sun"}, "is_accepted": true, "score": 1, "last_activity_date": 1565226501, "creation_date": 1565226501, "answer_id": 57403990, "question_id": 57395075, "link": "https://stackoverflow.com/questions/57395075/why-is-gpu-used-when-reading-image-from-webcam-using-videocapture/57403990#57403990", "title": "Why is gpu used when reading image from webcam using VideoCapture", "body": "<p>Answer my own question here. Thanks to all your help to make me realize I have a misunderstanding in video capture.</p>\n\n<p>The default backend for VideoCapture is cv::CAP_ANY which means auto-detected, and in my case cv::CAP_MSMF is used. After specifying the backend to cv::CAP_DSHOW there's no more GPU usage. The modified code is as follows:</p>\n\n<pre><code>#include &lt;opencv2/opencv.hpp&gt;\n\nusing namespace cv;\n\nint main()\n{\n    VideoCapture cap(0, CAP_DSHOW);// HERE\n    Mat img;\n    while (true)\n    {\n        cap.read(img);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 9287680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bv5xK.png?s=128&g=1", "display_name": "X. Sun", "link": "https://stackoverflow.com/users/9287680/x-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1139, "favorite_count": 0, "closed_date": 1566054147, "accepted_answer_id": 57403990, "answer_count": 1, "score": 0, "last_activity_date": 1565226501, "creation_date": 1565182732, "question_id": 57395075, "link": "https://stackoverflow.com/questions/57395075/why-is-gpu-used-when-reading-image-from-webcam-using-videocapture", "closed_reason": "Not suitable for this site", "title": "Why is gpu used when reading image from webcam using VideoCapture", "body": "<p>When I use cv::VideoCapture to read from web cam, my gpu shows 17% usage, which I don't know why. I always assume this is a pure cpu thing.</p>\n\n<p>My system is Win10 with opencv 4.0. I tried to compile with and without cuda, both ended the same.</p>\n\n<p>This is my gpu usage when idle:\n<img src=\"https://i.imgur.com/bP4tQGn.png\" alt=\"idle\"></p>\n\n<p>This is my gpu usage when reading from webcam:\n<img src=\"https://i.imgur.com/a6NIwRr.png\" alt=\"idle\"></p>\n\n<p>This is the code:</p>\n\n<pre><code>#include &lt;opencv2/opencv.hpp&gt;\n\nusing namespace cv;\n\nint main()\n{\n    VideoCapture cap(0);\n    Mat img;\n    while (true)\n    {\n        cap.read(img);\n    }\n}\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["c++", "visual-studio", "qt", "include"], "comments": [{"owner": {"reputation": 606, "user_id": 3496382, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b1d5358aca39b65581c1a1c2750dc2?s=128&d=identicon&r=PG&f=1", "display_name": "gan_", "link": "https://stackoverflow.com/users/3496382/gan"}, "edited": false, "score": 1, "creation_date": 1565182544, "post_id": 57394915, "comment_id": 101271513, "body": "The tutorial you linked is for Qt 4. With Qt 5 you&#39;ll need to add <a href=\"https://stackoverflow.com/questions/24669417/qt-5-3-qtwidgets-no-such-file-or-directory-include-qtwidgets\"><code>QT += widgets</code> to your .pro file</a>."}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1565183841, "post_id": 57394915, "comment_id": 101272365, "body": "Be careful, <code>#include &lt;QtWidget&gt;</code>, single, without s, not  QtWidgets."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1565184757, "post_id": 57394915, "comment_id": 101272997, "body": "<code>#include &lt;QtWidgets&gt;</code> is correct. (Just looked <a href=\"https://stackoverflow.com/a/57158965/7478597\">here</a> to confirm but have used it for sample codes many times before.) It works in Qt 5 for VS (with CMake project) as well as with Qt project files (if Qt widgets are enabled properly in both cases)."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "reply_to_user": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1565186572, "post_id": 57394915, "comment_id": 101274179, "body": "@S.M. No, <code>#include &lt;QtWidgets&gt;</code> is fine. There is a &#39;s&#39; because it includes the whole widgets module."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1565187288, "post_id": 57394915, "comment_id": 101274622, "body": "Why do you think your solution isn&#39;t correct? Qt project files are the Qt-ish way to provide some kind of portable build script. On Linux, the qmake tool produces a <code>Makefile</code> from it which can be used to build the executable with <code>make</code>. (With Qt VS Tools, I haven&#39;t any experience. I guess they provide a similar tool to prepare a VS project file out of a Qt project.) A subject of build scripts is the setup of appropriate include and library paths."}, {"owner": {"reputation": 290, "user_id": 6879283, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B7vsD.jpg?s=128&g=1", "display_name": "Leander", "link": "https://stackoverflow.com/users/6879283/leander"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1565187580, "post_id": 57394915, "comment_id": 101274822, "body": "@Scheff I thought that the settings could all be done in the GUI of VS, since it provides a UI for linking libraries and making builds. If you think this is the answer, you can post it as such an I can accept it."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1565187776, "post_id": 57394915, "comment_id": 101274945, "body": "It&#39;s surely possible to do all the settings manually by UI. However, this might become tedious. I can imagine that Qt VS Tools can configure as well necessary defines and custom build steps (e.g. for Qt MOC). I once maintained VS projects manually (in a text editor) until we introduced CMake. (I wouldn&#39;t return ever...) ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 290, "user_id": 6879283, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B7vsD.jpg?s=128&g=1", "display_name": "Leander", "link": "https://stackoverflow.com/users/6879283/leander"}, "edited": false, "score": 1, "creation_date": 1565269781, "post_id": 57403956, "comment_id": 101306797, "body": "Adding <code>$(QTDIR)&#47;include&#47;QtWidgets</code> seems to be the solution. Thanks a lot."}], "tags": [], "owner": {"reputation": 2002, "user_id": 2763000, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a5ea0af3a37d8989110a8fb4c656efb2?s=128&d=identicon&r=PG&f=1", "display_name": "goug", "link": "https://stackoverflow.com/users/2763000/goug"}, "is_accepted": true, "score": 2, "last_activity_date": 1565226100, "creation_date": 1565226100, "answer_id": 57403956, "question_id": 57394915, "link": "https://stackoverflow.com/questions/57394915/cant-include-qtwidgets/57403956#57403956", "title": "Can&#39;t include &lt;QtWidgets&gt;", "body": "<p>The \"QtWidgets\" include file is a file in the \"QtWidgets\" directory. Your include path probably has something like \"$(QTDIR)/include\", but not \"$(QTDIR)/include/QtWidgets\". That's why your example with \"QtWidgets/qpushbutton.h\" works, but not just \"QtWidgets\" on its own.</p>\n\n<p>Maybe it helps to look at the full path to the file you're trying to include (using my Qt 5.5.1 installation):</p>\n\n<pre><code>C:\\Qt\\Qt5.5.1\\5.5\\msvc2013_64\\include\\QtWidgets\\QtWidgets\n</code></pre>\n\n<p>So if you have this in your include path:</p>\n\n<pre><code>C:\\Qt\\Qt5.5.1\\5.5\\msvc2013_64\\include\n</code></pre>\n\n<p>That only gets you to the QtWidgets directory, but not to the QtWidgets file.</p>\n\n<p>You also needs this in your include path:</p>\n\n<pre><code>C:\\Qt\\Qt5.5.1\\5.5\\msvc2013_64\\include\\QtWidgets\n</code></pre>\n\n<p>Obviously, adjust this for your installed drive, Qt version, and MSVC version.</p>\n"}], "owner": {"reputation": 290, "user_id": 6879283, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B7vsD.jpg?s=128&g=1", "display_name": "Leander", "link": "https://stackoverflow.com/users/6879283/leander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1125, "favorite_count": 0, "accepted_answer_id": 57403956, "answer_count": 1, "score": -1, "last_activity_date": 1565226100, "creation_date": 1565182164, "last_edit_date": 1565186170, "question_id": 57394915, "link": "https://stackoverflow.com/questions/57394915/cant-include-qtwidgets", "title": "Can&#39;t include &lt;QtWidgets&gt;", "body": "<p>I'm trying to link Qt5 in Visual Studio 15 2017.</p>\n\n<p>I have added the paths and file references for additional (1) <em>include directories</em>, (2) <em>library directories</em> and (3) <em>dependencies</em> in the <em>Property Pages</em>.</p>\n\n<p>I can include header files by refering to their path like this</p>\n\n<pre><code>#include &lt;QtWidgets/qpushbutton.h&gt;\n</code></pre>\n\n<p>However, the <a href=\"https://github.com/bmpix/PolyVectorization/blob/master/src/mainwindow.cpp\" rel=\"nofollow noreferrer\">github project</a> I'm trying to build uses this line</p>\n\n<pre><code>#include &lt;QtWidgets&gt;\n</code></pre>\n\n<p>Visual Studio shows me an error on those lines</p>\n\n<pre><code>E1696   cannot open source file \"QtWidgets\" \n</code></pre>\n\n<p>When creating a solution from a <code>.pro</code> file using the <em>Qt VS Tools</em> in Visual Studio, I can include <code>&lt;QtWidgets&gt;</code>. But how can I include it in my existing project, which has not been created from a <code>.pro</code> file.</p>\n\n<hr>\n\n<p><strong>Solution</strong>\nPlacing a <em>MyProjectName.pro</em> file (with <code>QT += core gui widgets</code>) in the <em>MyProjectName</em> Folder and opening it with <em>Qt VS Tools > Open Qt Project File (.pro)</em> solves this problem. I can now include <code>&lt;QtWidgets&gt;</code>. But this doesn't seem like the correct way, given the VS gui.</p>\n"}, {"tags": ["c++", "exception", "inputstream"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1565181485, "post_id": 57394617, "comment_id": 101270814, "body": "IMHO, there is nothing exceptional about bad input so exceptions should not be used."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1565181563, "post_id": 57394617, "comment_id": 101270863, "body": "There&#39;s nothing exceptional here, and a non-exception implementation would actually be shorter and clearer."}, {"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 2, "creation_date": 1565181566, "post_id": 57394617, "comment_id": 101270866, "body": "Well, it&#39;s a design choice, and in those cases, the answer depends on several factors in the real context. Anyway, why do you expect failure from <code>!std::cin</code>?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 0, "creation_date": 1565181642, "post_id": 57394617, "comment_id": 101270913, "body": "@BiagioFesta <code>std::cin</code> evaluates to true if the stream is in a good state.  So <code>!std::cin</code> will be true when the stream is in a bad state"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1565181734, "post_id": 57394617, "comment_id": 101270962, "body": "Exceptions are very overused, and in cases such as this are mostly a goto that makes you feel good for not writing &quot;goto&quot;. You can rewrite that as a straightforward <code>if-else</code>."}, {"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565181760, "post_id": 57394617, "comment_id": 101270980, "body": "@NathanOliver yeah I know it, I am just curious to know why to expect failure in <code>std::cin</code>. I said so because I don&#39;t think it is a good way to implement a <i>&quot;input parser validator&quot;</i> if that what it meant to be here"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 1, "creation_date": 1565181883, "post_id": 57394617, "comment_id": 101271046, "body": "@Biagio It&#39;s not (directly) expecting failure on <code>std::cin</code>, it&#39;s expecting failure on the <code>&gt;&gt;</code> operation"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565181951, "post_id": 57394617, "comment_id": 101271088, "body": "FWIW, <a href=\"https://stackoverflow.com/a/10829091/4342498\">this</a> is how I would handle checking for bad numeric input."}, {"owner": {"reputation": 2310, "user_id": 9185253, "user_type": "registered", "profile_image": "https://graph.facebook.com/114451586026362/picture?type=large", "display_name": "Maestro", "link": "https://stackoverflow.com/users/9185253/maestro"}, "edited": false, "score": 0, "creation_date": 1565182050, "post_id": 57394617, "comment_id": 101271150, "body": "Thank you guys! But what if the error in input stream is other than invalid input like a system-level error? Doesn&#39;t this also need E.H?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1565182333, "post_id": 57394617, "comment_id": 101271358, "body": "If you are writing serious input code (which you are probably not doing if you are using operator &gt;&gt;) then you should be looking at the individual stream status bits, such as <code>badbit</code> and in that case you might throw an exception, but it would be caught at the highest level of your code. Catching exceptions immediately after they are thrown is almost always wrong."}, {"owner": {"reputation": 91, "user_id": 11733464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc9c2084dc130ac05dbb1a0b64ad085?s=128&d=identicon&r=PG&f=1", "display_name": "Sereysopheak Eap", "link": "https://stackoverflow.com/users/11733464/sereysopheak-eap"}, "edited": false, "score": 0, "creation_date": 1565196914, "post_id": 57394617, "comment_id": 101279779, "body": "Alright, it the choice of the design. To me personally, I like to use the exception handling approach. In real-world programming, you might have tons of code and exception handling will benefit you. You can use this approach to throw your meaning full exception as necessary and centralize the logic in one place to handle those exception to communicate the message clearly to the user. In practical you might need to create your custom exception as well. For example ObjectNotFoundException, IllegalStateException, BadRequestException, ...."}, {"owner": {"reputation": 2310, "user_id": 9185253, "user_type": "registered", "profile_image": "https://graph.facebook.com/114451586026362/picture?type=large", "display_name": "Maestro", "link": "https://stackoverflow.com/users/9185253/maestro"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565210473, "post_id": 57394617, "comment_id": 101285603, "body": "@NathanOliver So you mean in a real program I can use this: <code>while(!(std::cin &gt;&gt; x)){ std::cin.clear(); std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), &#39;\\n&#39;);} std::cout &lt;&lt; &quot;x: &quot; &lt;&lt; x &lt;&lt; std::endl;</code>?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1565210662, "post_id": 57394617, "comment_id": 101285669, "body": "@Maestro Yes.  Although that approach can potentially leave garbage in the buffer.  If you input <code>5a</code> for instance then <code>while(!std::cin &gt;&gt; x)</code> will store the <code>5</code> in <code>x</code>, <code>cin</code> will be good so the condition will be false and the loop wont execute.  That leaves <code>a</code> in the buffer and it will dirty the next input operation.  If you use <a href=\"https://stackoverflow.com/questions/10828937/how-to-make-cin-take-only-numbers/10829091#10829091\">this approach</a> that can&#39;t happen."}, {"owner": {"reputation": 2310, "user_id": 9185253, "user_type": "registered", "profile_image": "https://graph.facebook.com/114451586026362/picture?type=large", "display_name": "Maestro", "link": "https://stackoverflow.com/users/9185253/maestro"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1565210742, "post_id": 57394617, "comment_id": 101285700, "body": "@NathanOliver: Thank you very much!"}], "answers": [{"tags": [], "owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "is_accepted": true, "score": 3, "last_activity_date": 1565248938, "last_edit_date": 1565248938, "creation_date": 1565182993, "answer_id": 57395155, "question_id": 57394617, "link": "https://stackoverflow.com/questions/57394617/should-i-use-exception-handling-for-just-invalid-input/57395155#57395155", "title": "Should I use Exception handling for just invalid input?", "body": "<p><em>Snipped of your code showing the try/throw/catch in question:</em></p>\n\n<pre><code>    try {\n        if (!(std::cin &gt;&gt; val)) {               \n            throw std::runtime_error(\"bad input\");\n        }\n        std::cout &lt;&lt; val &lt;&lt; \" : \" &lt;&lt; val * val &lt;&lt; std::endl;\n    }\n    catch (std::exception&amp; e) {\n</code></pre>\n\n<p>For the provided example, you would not use a try/throw/catch in <em>real world code</em>. Usually, you would prefer the simplest code to read and understand and for this case it is much simpler to avoid exception handling alltogether and use if/else instead:</p>\n\n<pre><code>      if ((std::cin &gt;&gt; val)) {                  \n        std::cout &lt;&lt; val &lt;&lt; \" : \" &lt;&lt; val * val &lt;&lt; std::endl;\n      }\n      else {\n</code></pre>\n"}], "owner": {"reputation": 2310, "user_id": 9185253, "user_type": "registered", "profile_image": "https://graph.facebook.com/114451586026362/picture?type=large", "display_name": "Maestro", "link": "https://stackoverflow.com/users/9185253/maestro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1565183047, "accepted_answer_id": 57395155, "answer_count": 1, "score": -1, "last_activity_date": 1565248938, "creation_date": 1565181191, "question_id": 57394617, "link": "https://stackoverflow.com/questions/57394617/should-i-use-exception-handling-for-just-invalid-input", "closed_reason": "Opinion-based", "title": "Should I use Exception handling for just invalid input?", "body": "<p>I've this example:</p>\n\n<pre><code>int main() {\n\n    int val{};\n    bool stop = false;\n    char c;\n\n    while (!stop) {\n        std::cout &lt;&lt; \"val: \";\n        try {\n            if (!(std::cin &gt;&gt; val)) {               \n                throw std::runtime_error(\"bad input\");\n            }\n            std::cout &lt;&lt; val &lt;&lt; \" : \" &lt;&lt; val * val &lt;&lt; std::endl;\n        }\n        catch (std::exception&amp; e) {\n            std::cout &lt;&lt; e.what() &lt;&lt; std::endl;\n            std::cin.clear();\n            std::cin.ignore(numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\n            std::cout &lt;&lt; \"retry\\?\\n&gt;&gt;\" &lt;&lt; std::endl;\n            std::cin &gt;&gt; c;\n            if (c != 'y' &amp;&amp; c != 'Y')\n                stop = true;\n        }\n\n    }\n}\n</code></pre>\n\n<p>The code works fine but I want to know should I use this in a real world program? Because I've seen some alternatives: getting the input as a string then using conversion to integral types.</p>\n\n<ul>\n<li>My question: is Should I use exception handling for invalid input like characters where it should be integers.. or Just sue string and conversion?</li>\n</ul>\n"}, {"tags": ["c++", "c++11", "functor"], "answers": [{"tags": [], "owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "is_accepted": true, "score": 3, "last_activity_date": 1565181802, "creation_date": 1565181802, "answer_id": 57394796, "question_id": 57394535, "link": "https://stackoverflow.com/questions/57394535/convert-function-template-into-templated-functor/57394796#57394796", "title": "Convert function template into templated functor", "body": "<p>No, it is not possible.  A template name by itself can be used in very limited ways.  You have to wrap it in a class before passing it around.  In C++14, using a lambda to wrap the call to the function seems to be the simplest possible way.  Then you can use it in many ways:</p>\n\n<pre><code>auto wrapper = [](const auto&amp; x){ return plus_one(x); }\n\nstd::cout &lt;&lt; wrapper(42) &lt;&lt; \"\\n\";\nstd::cout &lt;&lt; std::invoke(wrapper, 42) &lt;&lt; \"\\n\";\nstd::cout &lt;&lt; std::bind(wrapper, 42)() &lt;&lt; \"\\n\";\n// etc.\n</code></pre>\n\n<p>In C++11, we are kinda screwed up.  We have to write the wrapper by ourselves:</p>\n\n<pre><code>struct Wrapper {\n    template &lt;typename T&gt;\n    auto operator()(const T&amp; x) const\n    {\n        return plus_one(x);\n    }\n};\n</code></pre>\n\n<p>then</p>\n\n<pre><code>Wrapper wrapper;\n// same usage\n</code></pre>\n"}], "owner": {"reputation": 532, "user_id": 3855417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DHFgn.png?s=128&g=1", "display_name": "nbenn", "link": "https://stackoverflow.com/users/3855417/nbenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 57394796, "answer_count": 1, "score": 4, "last_activity_date": 1565181802, "creation_date": 1565180888, "question_id": 57394535, "link": "https://stackoverflow.com/questions/57394535/convert-function-template-into-templated-functor", "title": "Convert function template into templated functor", "body": "<p>I'm wondering whether it might be possible to create function objects from function templates. The following <code>Functor</code> struct creates a function object from a function:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n\ntemplate &lt;typename F, F* f&gt;\nstruct Functor {\n  template &lt;typename... Ar&gt;\n  auto operator()(Ar&amp;&amp;... rg) -&gt; decltype(f(std::forward&lt;Ar&gt;(rg)...)) {\n    return f(std::forward&lt;Ar&gt;(rg)...);\n  }\n};\n\nint plus_one(int a) {\n  return a + 1;\n}\n\nint main () {\n\n  std::cout &lt;&lt; Functor&lt;decltype(plus_one), &amp;plus_one&gt;()(1) &lt;&lt; \"\\n\";\n\n  return 0;\n}\n</code></pre>\n\n<p>This creates a structure like</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct PlusOne {\n  int operator()(int a) {\n    return a + 1;\n  }\n}\n</code></pre>\n\n<p>Now, I'd like to work with a function template instead of a function:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename T&gt;\nT plus_one(T a) {\n  return a + 1;\n}\n</code></pre>\n\n<p>which I'm hoping to turn into something like</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct PlusOne {\n  template &lt;class T&gt;\n  T operator()(T a) {\n    return a + 1;\n  }\n};\n</code></pre>\n\n<p>Is this possible? One of the reasons I'm asking this is that I <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3559.pdf\" rel=\"nofollow noreferrer\">read</a>  generic lambda expressions in C++14 are being turned into functors similar to what I'm after:</p>\n\n<blockquote>\n  <p>For example, this generic lambda-expression containing statement:</p>\n\n<pre><code> auto L = [](const auto&amp; x, auto&amp; y){ return x + y; };\n</code></pre>\n  \n  <p>might result in the creation of a closure type, and object that behaves similar to the struct below:</p>\n\n<pre><code>struct {\n  template &lt;typename T, typename U&gt;\n  auto operator()(const T&amp; x, U&amp; y) const { return x + y; }\n} L;\n</code></pre>\n</blockquote>\n\n<p>So I was naively hoping some facilities for making possible what I'm after, might exist. I'm restricted to C++11 though.</p>\n"}, {"tags": ["c++", "ios", "iphone"], "comments": [{"owner": {"reputation": 796, "user_id": 1643973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/198787891419681bb0932f54a502a40c?s=128&d=identicon&r=PG", "display_name": "jjramsey", "link": "https://stackoverflow.com/users/1643973/jjramsey"}, "edited": false, "score": 1, "creation_date": 1565181009, "post_id": 57394524, "comment_id": 101270567, "body": "If you print out <code>testCharBack</code> (with, say,<code>std::cout</code>), do you also print <code>&quot;esting&quot;</code> instead of <code>&quot;testing&quot;</code>?"}, {"owner": {"reputation": 1076, "user_id": 7229378, "user_type": "registered", "profile_image": "https://graph.facebook.com/561259464075050/picture?type=large", "display_name": "Abu Ul Hassan", "link": "https://stackoverflow.com/users/7229378/abu-ul-hassan"}, "edited": false, "score": 0, "creation_date": 1565181379, "post_id": 57394524, "comment_id": 101270759, "body": "what you get after NSLogging testCharBack?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1565183290, "post_id": 57394524, "comment_id": 101272025, "body": "You&#39;re showing a debugger screen.  Does the actual program work?"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1565185445, "post_id": 57394524, "comment_id": 101273462, "body": "Looks like the program is at the line 77 breakpoint, and hasn&#39;t actually executed the code.  So the value that is seen in <code>testCharBack</code> is garbage (and just happens to garbagely point to <code>esting</code>)."}, {"owner": {"reputation": 171, "user_id": 623049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4634929588bd750f49bce4a381ce8100?s=128&d=identicon&r=PG", "display_name": "skipper3k", "link": "https://stackoverflow.com/users/623049/skipper3k"}, "reply_to_user": {"reputation": 1076, "user_id": 7229378, "user_type": "registered", "profile_image": "https://graph.facebook.com/561259464075050/picture?type=large", "display_name": "Abu Ul Hassan", "link": "https://stackoverflow.com/users/7229378/abu-ul-hassan"}, "edited": false, "score": 0, "creation_date": 1565186308, "post_id": 57394524, "comment_id": 101274011, "body": "@AbuUlHassan and @ jjramsey I updated the question with the log output. Because its easier to print NSLog I did just that. It strips the first character as well."}, {"owner": {"reputation": 171, "user_id": 623049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4634929588bd750f49bce4a381ce8100?s=128&d=identicon&r=PG", "display_name": "skipper3k", "link": "https://stackoverflow.com/users/623049/skipper3k"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1565186487, "post_id": 57394524, "comment_id": 101274117, "body": "@PaulMcKenzie I tried to gather the &quot;lowest common denominator&quot; of the problem I am having. The answer is no. The program does not work it crashes. The thing is that const char* are converted to std::string and back a few times until the last std::string gets a null char string and crashes. I checked the scope of the std::string and it is not released before it gets converted."}, {"owner": {"reputation": 171, "user_id": 623049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4634929588bd750f49bce4a381ce8100?s=128&d=identicon&r=PG", "display_name": "skipper3k", "link": "https://stackoverflow.com/users/623049/skipper3k"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1565186735, "post_id": 57394524, "comment_id": 101274277, "body": "@Eljay I was thinking this might be a debugger issue as well. But I think its not, even if you step over this line the assignement stays the same. Also the output of NSLog is incorrect."}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 623049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4634929588bd750f49bce4a381ce8100?s=128&d=identicon&r=PG", "display_name": "skipper3k", "link": "https://stackoverflow.com/users/623049/skipper3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1566230290, "creation_date": 1566230290, "answer_id": 57560236, "question_id": 57394524, "link": "https://stackoverflow.com/questions/57394524/ios-const-char-to-stdstring-and-back-missing-first-character/57560236#57560236", "title": "iOS const char* to std::string and back missing first character", "body": "<p>In my case it turned out to be the <code>__arm__</code> Preprocessor macro that made the app fail and crash.</p>\n"}], "owner": {"reputation": 171, "user_id": 623049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4634929588bd750f49bce4a381ce8100?s=128&d=identicon&r=PG", "display_name": "skipper3k", "link": "https://stackoverflow.com/users/623049/skipper3k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 57560236, "answer_count": 1, "score": 0, "last_activity_date": 1566230290, "creation_date": 1565180857, "last_edit_date": 1592644375, "question_id": 57394524, "link": "https://stackoverflow.com/questions/57394524/ios-const-char-to-stdstring-and-back-missing-first-character", "title": "iOS const char* to std::string and back missing first character", "body": "<p>I am getting a peculiar runtime error in my code on an iOS build with c++ code runing on an iphone in Xcode 10.3.</p>\n<p>Stopping this code in the debugger:</p>\n<pre><code>const char* testChar = &quot;testing&quot;;\nstd::string testingString = testChar;\nconst char* testCharBack = testChar.c_str();\n</code></pre>\n<p>const char* testCharBack prints</p>\n<blockquote>\n<p>&quot;esting&quot;</p>\n</blockquote>\n<p>instead of</p>\n<blockquote>\n<p>&quot;testing&quot;</p>\n</blockquote>\n<p><a href=\"https://i.stack.imgur.com/8RWFI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8RWFI.png\" alt=\"enter image description here\" /></a></p>\n<p>EDIT:\nNSLog output is missing the first character as well:</p>\n<blockquote>\n<p>NSLog( @&quot;testingCharBack=%s&quot;, testCharBack );</p>\n<p>2019-08-07 15:53:53.451173+0200 App[499:108370] testingCharBack=esting</p>\n</blockquote>\n<p>I am using the libc++ (LLVN C++ standard library with C++11 support) compiler and c++11 dialect.\nAny ideas what might be wrong with the build or build settings?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1565180324, "post_id": 57394242, "comment_id": 101270165, "body": "<code>NULL</code> isn&#39;t the same as <code>nullptr</code>, and I&#39;m not sure if <code>NULL == nullptr</code>."}, {"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1565181793, "post_id": 57394242, "comment_id": 101271000, "body": "While <code>NULL</code> would works in this case (assuming typical definition as 0), it should not be used anymore when it is clear that the type is a pointer for the same reason than one should not assign 0 to a pointer anymore."}, {"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 1, "creation_date": 1565182123, "post_id": 57394242, "comment_id": 101271210, "body": "By using a debugger, you should be able to solve a problem like that in less than a minute and it would help you learn from your mistake."}], "answers": [{"tags": [], "owner": {"reputation": 6021, "user_id": 206404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497437666710e8b13ee168bd7b62fcba?s=128&d=identicon&r=PG", "display_name": "Stephen Newell", "link": "https://stackoverflow.com/users/206404/stephen-newell"}, "is_accepted": false, "score": 9, "last_activity_date": 1565180457, "creation_date": 1565180457, "answer_id": 57394394, "question_id": 57394242, "link": "https://stackoverflow.com/questions/57394242/insertion-in-singly-linked-list-running-on-infinite-loop/57394394#57394394", "title": "Insertion in Singly Linked List running on infinite loop", "body": "<p>The first <code>Node</code> you add ends up pointing at itself.  Take a look at this chunk of code from <code>Insert</code></p>\n\n<pre><code>if (head == NULL){\n   head = p; //head becomes the first node\n}\n//if linked list is not empty\nif (head != NULL){\n    p-&gt;next = head;\n    head = p; //pointing head at the newly created node\n\n}\n</code></pre>\n\n<p>You'll point <code>head</code> at your new <code>Node</code>, then enter the next <code>if</code> since <code>head</code> isn't <code>NULL</code>.  If you replace the second <code>if</code> with an <code>else</code>, you should be fine.</p>\n"}, {"tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": false, "score": 6, "last_activity_date": 1565180566, "creation_date": 1565180566, "answer_id": 57394423, "question_id": 57394242, "link": "https://stackoverflow.com/questions/57394242/insertion-in-singly-linked-list-running-on-infinite-loop/57394423#57394423", "title": "Insertion in Singly Linked List running on infinite loop", "body": "<p>Look carefully at this code:</p>\n\n<pre><code>if (head == NULL){\n   head = p; //head becomes the first node\n}\n//if linked list is not empty\nif (head != NULL){\n    p-&gt;next = head;\n    head = p; //pointing head at the newly created node\n\n}\n</code></pre>\n\n<p>When <code>head</code> is <code>NULL</code> both branches of code get run resulting in your head node pointing to itself. The correct code would be:</p>\n\n<pre><code>if (head == nullptr){\n   head = p; //head becomes the first node\n}\n//if linked list is not empty\nelse{\n    p-&gt;next = head;\n    head = p; //pointing head at the newly created node\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1565181995, "post_id": 57394574, "comment_id": 101271123, "body": "Putting the exact opposite condition in the <code>else if</code> part usually show a lack of understanding of the language."}, {"owner": {"reputation": 21, "user_id": 11841551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Sh9uBlfziOc/AAAAAAAAAAI/AAAAAAAAA1g/E5oY2DTr7MU/photo.jpg?sz=128", "display_name": "User12", "link": "https://stackoverflow.com/users/11841551/user12"}, "edited": false, "score": 0, "creation_date": 1565187891, "post_id": 57394574, "comment_id": 101275012, "body": "That is quite demotivating. Your help is asked only for error correction, not for extra negative views."}], "tags": [], "owner": {"reputation": 327, "user_id": 3697826, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3fc557fdbe9a764a9049b4815499dc56?s=128&d=identicon&r=PG&f=1", "display_name": "MNada", "link": "https://stackoverflow.com/users/3697826/mnada"}, "is_accepted": false, "score": 1, "last_activity_date": 1565181028, "creation_date": 1565181028, "answer_id": 57394574, "question_id": 57394242, "link": "https://stackoverflow.com/questions/57394242/insertion-in-singly-linked-list-running-on-infinite-loop/57394574#57394574", "title": "Insertion in Singly Linked List running on infinite loop", "body": "<p>When you update the head pointer as you insert your first element, both if statements will be executed  and the head pointer will never be empty in the second if statement, so it should be if then else, like below</p>\n\n<pre><code>if (head == NULL){\n   head = p; //head becomes the first node\n}\n//if linked list is not empty\nelse if (head != NULL){\n   p-&gt;next = head;\n   head = p; //pointing head at the newly created node\n\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11841551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Sh9uBlfziOc/AAAAAAAAAAI/AAAAAAAAA1g/E5oY2DTr7MU/photo.jpg?sz=128", "display_name": "User12", "link": "https://stackoverflow.com/users/11841551/user12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1565181028, "creation_date": 1565179946, "last_edit_date": 1565180154, "question_id": 57394242, "link": "https://stackoverflow.com/questions/57394242/insertion-in-singly-linked-list-running-on-infinite-loop", "title": "Insertion in Singly Linked List running on infinite loop", "body": "<p>Linked List PrintNode function is running on an infinite loop.</p>\n\n<pre><code>class Node{\n    public:\n    int data;\n    Node* next;\n};\n\nNode * head; //first variable of inked list\nvoid Insert(int x){\n\n    //insertion at beginning\n    Node* p = new Node;\n    p-&gt;data = x;\n    p-&gt;next = NULL; //when list is empty\n\n    //two scenarios to insert node\n    //one when linked list is empty\n    if (head == NULL){\n       head = p; //head becomes the first node\n    }\n    //if linked list is not empty\n    if (head != NULL){\n        p-&gt;next = head;\n        head = p; //pointing head at the newly created node\n\n    }\n\n}\n\nvoid PrintNode(Node* head){\n\n    for ( Node * temp = head; temp != nullptr; temp = temp-&gt;next )\n    {\n        cout &lt;&lt; temp-&gt;data &lt;&lt; \"-&gt;\";\n    }\n\n}\n\n\nint main (){\n\n    head = NULL; //points nowhere\n    int n;int x;\n    cin &gt;&gt; n;\n\n    for(int i = 0 ; i &lt; n ;i ++){\n\n        cout &lt;&lt; \"Enter element\" &lt;&lt; endl;\n        cin &gt;&gt; x;\n        Insert(x);\n\n    }\n\n    PrintNode(head);\n}\n</code></pre>\n\n<p>I expect the output to be list printed as for example: 1->2->3-> but,\nrunning on an infinite loop.</p>\n"}, {"tags": ["c++", "cmake"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 9993249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4VJPy8TpnSE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1BBCvjxFdlUu9HdwqdscYPXY_8zg/mo/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/9993249/chris"}, "edited": false, "score": 0, "creation_date": 1565236320, "post_id": 57395411, "comment_id": 101291111, "body": "Never realised build flags could be inserted into it, cool! Although it downloads and builds and compile time right? Not ideal but should do the trick. I\u2019ll see how it goes."}, {"owner": {"reputation": 71, "user_id": 11715182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150da41f3724575ff662925c4d8f9af3?s=128&d=identicon&r=PG&f=1", "display_name": "Vinicius Botelho Souza", "link": "https://stackoverflow.com/users/11715182/vinicius-botelho-souza"}, "reply_to_user": {"reputation": 113, "user_id": 9993249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4VJPy8TpnSE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1BBCvjxFdlUu9HdwqdscYPXY_8zg/mo/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/9993249/chris"}, "edited": false, "score": 0, "creation_date": 1565279529, "post_id": 57395411, "comment_id": 101312779, "body": "@Chris yes, and it can be used much much more ways !"}, {"owner": {"reputation": 1726, "user_id": 1414496, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c75b36035fb412c9f2629a888bfb977e?s=128&d=identicon&r=PG", "display_name": "Joel Bodenmann", "link": "https://stackoverflow.com/users/1414496/joel-bodenmann"}, "edited": false, "score": 0, "creation_date": 1609946997, "post_id": 57395411, "comment_id": 115980327, "body": "Note that unlike <code>FetchContent_Declare()</code>, <code>ExternalProject_Add()</code> runs during the build stage, not the configuration stage."}], "tags": [], "owner": {"reputation": 71, "user_id": 11715182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150da41f3724575ff662925c4d8f9af3?s=128&d=identicon&r=PG&f=1", "display_name": "Vinicius Botelho Souza", "link": "https://stackoverflow.com/users/11715182/vinicius-botelho-souza"}, "is_accepted": false, "score": 1, "last_activity_date": 1565183817, "creation_date": 1565183817, "answer_id": 57395411, "question_id": 57394237, "link": "https://stackoverflow.com/questions/57394237/dealing-with-nested-cmake-projects-using-fetchcontent/57395411#57395411", "title": "Dealing with nested cmake projects using FetchContent_", "body": "<p>You are looking for <a href=\"https://cmake.org/cmake/help/latest/module/ExternalProject.html\" rel=\"nofollow noreferrer\">ExternalProject_add</a></p>\n\n<p>I often use this approach to build externals projects, it provides me automatic control over external projects that are inserted in my projects.</p>\n\n<p>You can include like this:</p>\n\n<pre><code>ExternalProject_add(cpprestsdkDownload    \n        GIT_REPOSITORY  https://github.com/microsoft/cpprestsdk   \n        GIT_TAG         master   \n        CMAKE_ARGS\n        -DWERROR:BOOL=\"0\"\n        -DBUILD_SAMPLES:BOOL=\"0\"\n        -DBUILD_TESTS:BOOL=\"0\" )\n</code></pre>\n\n<p>You can use your custom configure,build and install commands to ! Have Fun !</p>\n"}, {"tags": [], "owner": {"reputation": 359, "user_id": 1726669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7298abbcfe46a5d571df68bba1cff571?s=128&d=identicon&r=PG", "display_name": "Madwyn", "link": "https://stackoverflow.com/users/1726669/madwyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1595761133, "creation_date": 1595761133, "answer_id": 63099196, "question_id": 57394237, "link": "https://stackoverflow.com/questions/57394237/dealing-with-nested-cmake-projects-using-fetchcontent/63099196#63099196", "title": "Dealing with nested cmake projects using FetchContent_", "body": "<p>I use a subroutine to fetch the source code, then use <code>execute_process</code> to build and install the target.</p>\n<p>After this, even find_package can locate the library.</p>\n<p>Fetch subroutine:</p>\n<pre><code>cmake_minimum_required(VERSION 3.16)\n\n# suppress CMP0042\ncmake_policy(SET CMP0042 NEW)\nset(CMAKE_MACOSX_RPATH 1)\n\n# this must exist or cmake will complain about not presenting a project()\nproject(${PK_NAME}_download NONE)\n\ninclude(FetchContent)\n\nFetchContent_Declare(\n        ${PK_NAME}\n        GIT_REPOSITORY  &quot;${PK_GIT}&quot;\n        GIT_TAG         &quot;${PK_GIT_TAG}&quot;\n        PREFIX          &quot;${@PK_NAME@_ROOT}&quot;\n)\n\nif(NOT ${PK_NAME}_POPULATED)\n    FetchContent_MakeAvailable(${PK_NAME})\nendif()\n\n</code></pre>\n<p>Download, build and install:</p>\n<pre><code># copy the template to place\nconfigure_file(${CMAKE_CURRENT_LIST_DIR}/FetchLib.cmake ${${PK_NAME}_ROOT}/CMakeLists.txt)\n\n# download source code\nexecute_process(\n        COMMAND ${CMAKE_COMMAND} -G &quot;${CMAKE_GENERATOR}&quot; -DCMAKE_INSTALL_PREFIX:PATH=${${PK_NAME}_ROOT} ${SUB_PARAM}\n        .\n        RESULT_VARIABLE result\n        WORKING_DIRECTORY ${${PK_NAME}_ROOT}\n)\n\nif(result)\n    message(FATAL_ERROR &quot;CMake step for ${PK_NAME} failed: ${result}&quot;)\nendif()\n\nset(CMAKE_INSTALL_PREFIX &quot;${${PK_NAME}_ROOT}&quot;)\n\n# build\nexecute_process(\n        COMMAND ${CMAKE_COMMAND} --build .\n        RESULT_VARIABLE result\n        WORKING_DIRECTORY ${${PK_NAME}_ROOT}\n)\n\nif(result)\n    message(FATAL_ERROR &quot;Build step for ${PK_NAME} failed: ${result}&quot;)\nendif()\n\n# install\nexecute_process(\n        COMMAND ${CMAKE_COMMAND} --install .\n        RESULT_VARIABLE result\n        WORKING_DIRECTORY ${${PK_NAME}_ROOT}\n)\n\nif(result)\n    message(FATAL_ERROR &quot;Install step for ${PK_NAME} failed: ${result}&quot;)\nendif()\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 9993249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4VJPy8TpnSE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1BBCvjxFdlUu9HdwqdscYPXY_8zg/mo/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/9993249/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 813, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1595761133, "creation_date": 1565179933, "question_id": 57394237, "link": "https://stackoverflow.com/questions/57394237/dealing-with-nested-cmake-projects-using-fetchcontent", "title": "Dealing with nested cmake projects using FetchContent_", "body": "<p>I am looking to automate the compilation of a given c++ library (in this case, cpprestsdk). I am looking to build the library using cmake.\nLike many other projects, this has dependencies. Namely, it requires OpenSSL, Boost, ZLIB and websocketpp.</p>\n\n<p>I'm looking for a way in which I can provide a CMakeLists file that will fetch and build all of the prerequisites and allow cpprestsdk to build without necessarily having the libraries pre-installed on a computer.</p>\n\n<p>The way I am fetching cpprestsdk is as follows:</p>\n\n<pre><code>FetchContent_Declare(cpprestsdk\n                    GIT_REPOSITORY https://github.com/microsoft/cpprestsdk.git\n                    GIT_TAG        master)\nFetchContent_GetProperties(cpprestsdk)\nif(NOT cpprestsdk_POPULATED)\n    FetchContent_Populate(cpprestsdk)\n    add_subdirectory(${cpprestsdk_SOURCE_DIR} ${cpprestsdk_BINARY_DIR})\nendif()\n</code></pre>\n\n<p>Of course, since this does not populate it's own dependencies, it will not be able to build. Although websocketpp has an embedded release, it is only used if not found. For this reason, I will use it as an example.</p>\n\n<pre><code>FetchContent_Declare(websocketpp\n                    GIT_REPOSITORY https://github.com/zaphoyd/websocketpp.git\n                    GIT_TAG        master\n                    )\n\nFetchContent_GetProperties(websocketpp)\n\nif(NOT websocketpp_POPULATED)\n    FetchContent_Populate(websocketpp)\n    add_subdirectory(${cpprestsdk_SOURCE_DIR} ${cpprestsdk_BINARY_DIR})\nendif()\n</code></pre>\n\n<p>This will fetch websocketpp, but as it is only the configure stage, nothing will be built. For this reason, cpprestsdk will not be able to find the dependency and instead fallback to the embedded release.</p>\n\n<p>My question is therefore: Is there any way I can force a build after fetching a package? Or remove the library requirement during the configure stage? I think this may be possible using ExternalProject instead, however I'm not too sure how I would set that up either.</p>\n"}, {"tags": ["c++", "operator-overloading", "functor", "type-erasure"], "comments": [{"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 2, "creation_date": 1565180320, "post_id": 57394232, "comment_id": 101270160, "body": "You don&#39;t have return inside <code>operator PtrToFun()</code>, it is UB."}, {"owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1565180868, "post_id": 57394232, "comment_id": 101270480, "body": "@rafix07 thanks, I was misusing the conversion operator, if you make this comment an answer I&#39;d be pleased to accept it."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1565188165, "post_id": 57394232, "comment_id": 101275171, "body": "@Luca Suitable compiler settings would have issued a warning (or error) for this."}], "answers": [{"tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": true, "score": 1, "last_activity_date": 1565181297, "creation_date": 1565181297, "answer_id": 57394640, "question_id": 57394232, "link": "https://stackoverflow.com/questions/57394232/function-object-with-overloaded-type-conversion-operator-crashes/57394640#57394640", "title": "function object with overloaded type conversion operator crashes", "body": "<p>Your <code>Functor2</code> is just wrapper for pointer to function, so it should take some pointer and return it in conversion operator. Without <code>return</code>, you have UB because of calling function on garbage address.</p>\n\n<p>To make <code>Functor2</code> take any function with signature <code>void ()</code> you could write:</p>\n\n<pre><code>class Functor2\n{\nprivate:\n    typedef void(*PtrToFun)();\n    PtrToFun ptr;\npublic:\n    Functor2(PtrToFun p ) : ptr(p) {}\n\n    operator PtrToFun()\n    {\n        PRINTLN(\"in functor overloaded type conversion operator to function pointer\");\n        return ptr;\n    }\n};\n\nObject o3 = Functor2(&amp;FreeFunction);\no3();\n</code></pre>\n"}], "owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 57394640, "answer_count": 1, "score": 0, "last_activity_date": 1565181297, "creation_date": 1565179922, "last_edit_date": 1565180821, "question_id": 57394232, "link": "https://stackoverflow.com/questions/57394232/function-object-with-overloaded-type-conversion-operator-crashes", "title": "function object with overloaded type conversion operator crashes", "body": "<p>I'm implementing a type erasure class (I'm studying templates and static polymorphism), that can wrap any callable object (any object that supports the function call syntax).</p>\n\n<p>Reading C++ template complete guide and searching across the web, I came up with this implementation:</p>\n\n<pre><code>// erasure.hpp \n\nclass Object\n{\nfriend void swap(Object &amp;, Object&amp;);  // friend declaration\nprivate:\n    class Concept\n    {\n    public:\n        virtual ~Concept() = default;\n        virtual void Invoke() = 0;\n        virtual Concept *Clone() = 0;\n    protected:\n        Concept() = default;\n    };\n    template &lt;typename T&gt;\n    class Model : public Concept\n    {\n    public:\n        //Model(const T&amp;) : mObject(object) {}\n        //Model(T&amp;&amp;) : mObject(move(object)) {}\n        template &lt;typename U&gt;                          // forwarding constructor (forwarding (universal) reference)\n        Model(U &amp;&amp;object) : mObject(forward&lt;U&gt;(object)) {}    \n        void Invoke() override { mObject(); }\n        Model *Clone() override;\n    private:\n        T mObject;\n    };\npublic:\n    template &lt;typename T&gt;                              // forwarding constructor (forwarding (universal) reference)\n    Object(T &amp;&amp;object) : mConcept(new Model&lt;typename remove_reference&lt;T&gt;::type&gt;(forward&lt;T&gt;(object))) {}  \n    Object(const Object &amp;other) : mConcept(other.mConcept-&gt;Clone()) {}               // copy constructor\n    Object(Object &amp;other) : Object(static_cast&lt;const Object&amp;&gt;(other)) {}             // delegating constructor (inhibits forwarding constructor)\n    Object(Object &amp;&amp;other) : mConcept(other.mConcept) { other.mConcept = nullptr; }  // move constructor\n    ~Object() {delete mConcept; }                 // destructor\n    template &lt;typename T&gt;                         // forwarding assignment operator\n    Object &amp;operator=(T&amp;&amp;);\n    Object &amp;operator=(const Object&amp;);             // copy assignment operator\n    Object &amp;operator=(Object &amp;other) { return *this = static_cast&lt;const Object&amp;&gt;(other); }\n    //Object &amp;operator=(Object &amp;other) { return this-&gt;operator=(static_cast&lt;const Object&amp;&gt;(other)); }\n    Object &amp;operator=(Object&amp;&amp;);                  // move assignment operator\n    void operator()();\nprivate:\n    Concept *mConcept;\n};\n\ntemplate &lt;typename T&gt;\nObject::Model&lt;T&gt; *Object::Model&lt;T&gt;::Clone()\n{\n    return new Model(mObject);\n}\n\ntemplate &lt;typename T&gt;\nObject &amp;Object::operator=(T &amp;&amp;object)\n{\n    delete mConcept;  \n    mConcept = new Model&lt;remove_reference_t&lt;T&gt;&gt;(forward&lt;T&gt;(object));\n\n    return *this;\n}\n</code></pre>\n\n<p>this is pretty classic and straightforward, so I omit the cpp implementation file. It works fine when I construct type erased objects from free functions, functors that overload the function call operator and even lambdas:</p>\n\n<pre><code>#include \"erasure.hpp\"\n#include &lt;iostream&gt;\n\n#define PRINT(msg)       std::cout &lt;&lt; (msg)\n#define PRINTLN(msg)     PRINT(msg) &lt;&lt; std::endl;\n\nvoid FreeFunction()\n{\n    PRINTLN(\"in free function\");\n}\n\nclass Functor1\n{\npublic:\n    void operator()()\n    {\n        PRINTLN(\"in functor overloaded function call operator\");\n    }\n};\n\nclass Functor2\n{\nprivate:\n    typedef void(*PtrToFun)();\npublic:\n    operator PtrToFun()\n    {\n        PRINTLN(\"in functor overloaded type conversion operator to function pointer\");\n    }\n};\n\nint main(int argc, char **argv)\n{\n    Object o1 = &amp;FreeFunction;\n    Object o2 = Functor1();\n    Object o3 = Functor2();\n    Object o4 = []() -&gt; void { PRINTLN(\"in lambda\"); };\n\n    o1();\n    o2();\n    o4();\n    o3();  // error: program crashes\n\n    return 0;\n}\n</code></pre>\n\n<p>but when I use a functor (Functor2) that overloads a type conversion operator to function pointer, the program crashes AFTER printing the string inside the operator. It just freezes and crashes (stack overflow?).</p>\n\n<p>Why?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>after comment by  rafix07 I edited the code and now it works:</p>\n\n<pre><code>class Functor2\n{\nprivate:\n    typedef void(*PtrToFun)();\n    PtrToFun p = []() { PRINTLN(\"in functor overloaded type conversion operator to function pointer\"); };\npublic:\n    operator PtrToFun()\n    {\n        return p;\n    }\n};\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 0, "creation_date": 1565179865, "post_id": 57394129, "comment_id": 101269920, "body": "I suggest you reduce the shown code. It is a little bit verbose, most method definitions are not useful in the context of this problem"}, {"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 1, "creation_date": 1565180193, "post_id": 57394129, "comment_id": 101270083, "body": "Maybe you want to have a look at <a href=\"https://en.cppreference.com/w/cpp/utility/in_place\" rel=\"nofollow noreferrer\"><code>in_place</code></a> for variant construction?"}], "answers": [{"tags": [], "owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "is_accepted": true, "score": 3, "last_activity_date": 1565180391, "creation_date": 1565180391, "answer_id": 57394375, "question_id": 57394129, "link": "https://stackoverflow.com/questions/57394129/how-to-construct-an-stdvariant-type-object-whose-itself-templated-and-construc/57394375#57394375", "title": "How to Construct an std::variant type object whose itself Templated and constructor forwards arguments", "body": "<p><a href=\"https://en.cppreference.com/w/cpp/utility/variant/variant\" rel=\"nofollow noreferrer\"><code>std::variant</code></a> has a proper overload for <em>emplace constuction</em>.</p>\n\n<p>In particular:</p>\n\n<pre><code>template&lt; class T, class... Args &gt;\nconstexpr explicit variant(std::in_place_type_t&lt;T&gt;, Args&amp;&amp;... args);\n</code></pre>\n\n<p>So your code could be fixed with:</p>\n\n<pre><code>var_t(std::in_place_type&lt;Fum&lt;Ack&gt;&gt;, std::string(\"Hello, World!\"));\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 11304416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c72faadd6fe24121c6c37b354281e478?s=128&d=identicon&r=PG&f=1", "display_name": "Amjad", "link": "https://stackoverflow.com/users/11304416/amjad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57394375, "answer_count": 1, "score": 1, "last_activity_date": 1565180623, "creation_date": 1565179541, "last_edit_date": 1565180623, "question_id": 57394129, "link": "https://stackoverflow.com/questions/57394129/how-to-construct-an-stdvariant-type-object-whose-itself-templated-and-construc", "title": "How to Construct an std::variant type object whose itself Templated and constructor forwards arguments", "body": "<p>I have defined <code>var_t</code> to be of type <code>std::variant&lt; Fum&lt;Bazz&gt;, Fum&lt;Ack&gt; &gt;</code>. The templated class <code>Fum&lt;&gt;</code> should forward its constructor arguments to Bazz and Ack, so it can create them emplace. However, I get the following error:</p>\n\n<p><code>[g++ default #1] error: no matching conversion for functional-style cast</code></p>\n\n<h2>Bazz and Ack Definitions:</h2>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;variant&gt;\n#include &lt;string&gt;\n\n\n// Bazz\n// C'tor takes in float\n\nstruct Bazz {\n    float f;\n\n    Bazz(float)\n    {\n        std::cout &lt;&lt; \"Bazz Main\" &lt;&lt; std::endl;\n    }\n\n};\n\n// Ack\n// C'tor takes in std::string\n\nstruct Ack {\n    std::string str;\n\n    Ack(std::string strParam)\n        :str(strParam)\n    {\n        std::cout &lt;&lt; \"Ack Main\" &lt;&lt; std::endl;\n\n    }\n\n};\n</code></pre>\n\n<h2>Fum Definition:</h2>\n\n<pre><code>// Fum&lt;&gt;\n// Variadic C'Tor should forward args to value of type T\n\ntemplate&lt;typename T&gt;\nclass Fum {\npublic:\n    T value;\n\n    template&lt;typename ... Params&gt;\n    Fum&lt;T&gt;(Params&amp;&amp; ... argsForT)\n        :value(std::forward&lt;Params&gt;(argsForT)...)\n    {std::cout &lt;&lt; \"FUM C'TOR\" &lt;&lt; std::endl;}\n};\n</code></pre>\n\n<h2>var_t Definiton:</h2>\n\n<pre><code>typedef std::variant&lt; Fum&lt;Bazz&gt;, Fum&lt;Ack&gt; &gt; var_t;\n</code></pre>\n\n<h2>The Following Code Works:</h2>\n\n<pre><code>// Fum forwards string to Ack as expected and creates Ack emplace.\nint main() {\n    Fum&lt;Ack&gt;(std::string(\"Hello, World!\"));\n}\n\n// &gt;&gt;&gt;&gt; Ack Main C'Tor\n// &gt;&gt;&gt;&gt; Fum C'Tor\n</code></pre>\n\n<h2>The Following Does NOT Work:</h2>\n\n<pre><code>int main() {\n    var_t((std::string(\"Hello, World!\")));\n}\n\n\n// [g++ default #1] error: no matching conversion for functional- \n// style cast\n</code></pre>\n\n<p>I believe <code>Fum</code> templated C'Tor is causing ambiguity. Therefore, var_t does not know if it should construct <code>Fum&lt;Ack&gt;</code> or <code>Fum&lt;Bazz&gt;</code>. But I'm not sure. So how can I fix this?</p>\n"}, {"tags": ["c++", "vectorization", "matrix-multiplication"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1565179504, "post_id": 57393978, "comment_id": 101269727, "body": "According to <a href=\"https://gist.github.com/jboner/2841832\" rel=\"nofollow noreferrer\">latency numbers every programmer should know</a>, one access to main memory is 100 ns. Your budget has already been blown several times before you even computed <i>one</i> element of the final array. Where did you get this target from?"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1565179917, "post_id": 57393978, "comment_id": 101269946, "body": "A more useful comment, then: if you transpose the second matrix you&#39;re walking both arrays row-wise. This will significantly improve your memory cache hit rate and give the compiler an easier time in spotting the vectorization opportunity."}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1565180064, "post_id": 57393978, "comment_id": 101270024, "body": "In the paper &quot;The case for Learned Index Structures&quot; <a href=\"https://arxiv.org/pdf/1712.01208.pdf\" rel=\"nofollow noreferrer\">link</a> on page 10 you can see that they reach a multiplication and addition of matrices in less than 100ns."}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 3, "creation_date": 1565180373, "post_id": 57393978, "comment_id": 101270198, "body": "Where on that page does it state that? The table mentions the lookup time of a single value."}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1565180565, "post_id": 57393978, "comment_id": 101270295, "body": "Figure 4: Learned Index vs B-Tree, they say that the lookup time is in ns . Previously they mention that they extract the weights and the bias from a neural network in tensorflow and they perform multiplication of matrices in c++ in order to reach this result"}, {"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1565181334, "post_id": 57393978, "comment_id": 101270733, "body": "Do you really need <code>double</code>. In your code, your data is all integers (<code>i + j</code>). Changing that might has a massive effect on performance. Also, are you compiling in 32 or 64 bits?"}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1565181603, "post_id": 57393978, "comment_id": 101270896, "body": "Yes I need double, the general idea is that once I extract the weights from a neural network for an input lets say A=[1,1] I will multiply it with the weights and add the baises as they did. Since the weights are double I need double/float.  Also @Botje the lookup time is for one input which is multiplied by the weigths of the neural network which can be large matrices"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1565181869, "post_id": 57393978, "comment_id": 101271036, "body": "@AnaSmile Section 3.7.1 explains the table. The &quot;model(ns)&quot; column is the average time spent evaluating the neural network for a given key, and &quot;lookup(ns)&quot; is the average time to look up a value. They do not reveal the size of the network evaluated, but on the worst case it is two layers of 16 nodes each, so 2 times 16x16 matrix multiplication. That is quite a few orders of magnitude less than the 1000x1000 you are trying to do!"}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1565182298, "post_id": 57393978, "comment_id": 101271330, "body": "@Botje their actual size of the matrix is 32 nodes with two layers. But still they mention that the simplest model which is just a linear regression is executed in 30 ns, which I also cannot reach with the same code mentioned above.  Even when I have smaller matrices the execution time is much larger than 2000ns. They mention that they provide SIMD auto-vectorization, but the same does not imply for my code, therefore I need help in that sense. For  multiplying a matrix [1,32], [32,32] I need around 3000ns"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1565182532, "post_id": 57393978, "comment_id": 101271503, "body": "As I and other people have pointed out: transposing the second matrix should give a good speed boost. Make sure to use the right flags so the compiler vectorizes."}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "edited": false, "score": 0, "creation_date": 1565182614, "post_id": 57393978, "comment_id": 101271563, "body": "But wouldn&#39;t the transpose operation take more time?"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1565182660, "post_id": 57393978, "comment_id": 101271600, "body": "Yes, but you would only do it once, while you would evaluate the model millions of times."}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "edited": false, "score": 0, "creation_date": 1565182916, "post_id": 57393978, "comment_id": 101271789, "body": "Makes sense, thank you for the input and the discussion. :)"}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565186974, "post_id": 57393978, "comment_id": 101274424, "body": "Small benchmark with clang8.0 as an example: if you access mult, random_matrix and random_matrix1 row-wise, you get up to 30x better performance then if you access the 3 of them col-wise."}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565188215, "post_id": 57393978, "comment_id": 101275197, "body": "And with gcc9.1 on my machine: access of the three matrices col-wise: 3.6e7ns, access of the three matrices row-wise: 3.4e6ns (10 times faster)."}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "reply_to_user": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565250211, "post_id": 57393978, "comment_id": 101295791, "body": "@MFnx Could you maybe provide a pseudocode of the multiplication of the matrices with row-wise access"}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565250994, "post_id": 57393978, "comment_id": 101296158, "body": "@AnaSmile In your line mult[row][tmp] += random_matrix[row][col] * random_matrix1[col][tmp], all the matrices are accessed row-wise, except for matrix1. There you loose speed. Check on how an array double[ROW][COL] is constructed, and you&#39;ll understand why it goes faster to access them row-wise. Here is a small benchmark. <a href=\"http://quick-bench.com/n9YRvK1wuQluCENJ3GeJ-_upsMs\" rel=\"nofollow noreferrer\">quick-bench.com/n9YRvK1wuQluCENJ3GeJ-_upsMs</a>"}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "reply_to_user": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565253253, "post_id": 57393978, "comment_id": 101297291, "body": "@MFnx how should I access all of the row wise ? should I transpose the matrix as previously mentioned?"}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565253319, "post_id": 57393978, "comment_id": 101297339, "body": "@AnaSmile That would be an option. Or maybe construct it already transposed. Depends on your program. Check out Eigen, you&#39;ll love it."}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "reply_to_user": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565255939, "post_id": 57393978, "comment_id": 101298751, "body": "@MFnx Eigen is too slow for this computation. I am trying to vectorize the code, in order to reach around 200 ns for [32,32][32,32] multiplication"}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 2, "creation_date": 1565257616, "post_id": 57393978, "comment_id": 101299741, "body": "@AnaSmile With all due respect, if you manage to do it faster than Eigen, I&#39;ll hire you. If Eigen is slower than your implementation, than you are using Eigen wrong."}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "reply_to_user": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565608602, "post_id": 57393978, "comment_id": 101393610, "body": "@MFnx currently I am trying different methods for multiplying matrices [10,10] X [10,10] and here is the time I get: Matrices as one dimensional arrays method: 297 ns; Normal matrix multiplication: 578 ns; The above mentioned: 471ns; The same but transposed : 450 ns; Eigen: 4000 ns.  Could you maybe provide an example where Eigen performs better, maybe I am not using the right flags. Currently I use O3"}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565609570, "post_id": 57393978, "comment_id": 101394079, "body": "@AnaSmile I see you use arrays on the stack. With eigen, do you use matrices on the stack? Or do you use MatrixXd?"}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "reply_to_user": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565611058, "post_id": 57393978, "comment_id": 101394776, "body": "@MFnx I am using MatrixXf"}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565611194, "post_id": 57393978, "comment_id": 101394847, "body": "@AnaSmile That&#39;s a matrix allocated on the heap. Not the same."}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565611260, "post_id": 57393978, "comment_id": 101394875, "body": "Anyways, those matrices are a bit large to be on the stack ;). I&#39;ll see if I can get you an example of speed, later on today."}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "reply_to_user": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565611327, "post_id": 57393978, "comment_id": 101394905, "body": "MatrixXf mat= MatrixXf::Random(10,10); MatrixXf mat1= MatrixXf::Random(10,10); mat* mat1 @MFnx Could you maybe tell me how to modify it so I can reach the performance you are speaking about? Thank you"}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565611767, "post_id": 57393978, "comment_id": 101395111, "body": "This should be moved to a chat or you should post a new answer. We shouldn&#39;t be discussing this here."}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "reply_to_user": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1565613348, "post_id": 57393978, "comment_id": 101395919, "body": "@MFnx <a href=\"https://stackoverflow.com/questions/57461326/efficient-matrix-multiplication-in-c-ideally-with-vectorization\" title=\"efficient matrix multiplication in c ideally with vectorization\">stackoverflow.com/questions/57461326/&hellip;</a> just posted a new question so you can maybe provide the answer there"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "edited": false, "score": 0, "creation_date": 1565180676, "post_id": 57394341, "comment_id": 101270363, "body": "But if the code is vectorized, shouldn&#39;t this multiply-adds be minimized? Additionally I pointed to a paper in the comment of my question that claims to have reached this result."}, {"owner": {"reputation": 1350, "user_id": 1698678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c3dcda949d1adcc6db14345586b2b9?s=128&d=identicon&r=PG", "display_name": "PlinyTheElder", "link": "https://stackoverflow.com/users/1698678/plinytheelder"}, "reply_to_user": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "edited": false, "score": 0, "creation_date": 1565185210, "post_id": 57394341, "comment_id": 101273315, "body": "@AnaSmile: vectorization will speed things up by maybe 4-8x, as far as I understand. Still, no need to do try to do it yourself, this will be amateur hour compared to what these specialized libraries do (the routines in there are vectorized). Regarding that paper - I don&#39;t know what those guys do, but all practical algorithms for dense matrix multiplication are O(N^3). You&#39;ll need one billion operations for those matrix sizes. Maybe their matrix sizes are tiny, I don&#39;t know, or maybe they don&#39;t have dense matrices."}], "tags": [], "owner": {"reputation": 1350, "user_id": 1698678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c3dcda949d1adcc6db14345586b2b9?s=128&d=identicon&r=PG", "display_name": "PlinyTheElder", "link": "https://stackoverflow.com/users/1698678/plinytheelder"}, "is_accepted": false, "score": 3, "last_activity_date": 1565180282, "creation_date": 1565180282, "answer_id": 57394341, "question_id": 57393978, "link": "https://stackoverflow.com/questions/57393978/matrix-multiplication-with-vectorization-in-c-executes-for-a-long-time/57394341#57394341", "title": "Matrix multiplication with vectorization in c++ executes for a long time", "body": "<p>I'm afraid you'll never get to 100 ns total execution time with these matrix sizes, with vectorization or without. Matrix multiplication of two matrices 1000 x 1000 elements takes on the order of 1000 ^ 3 = 1,000,000,000 multiply-adds. That is one billion operations.</p>\n\n<p>Secondly, if performance matters so much to you, you should NOT write your own code for these low-level mathematical primitives. There are optimized C++ libraries that will perform these operations for you, such as Eigen or BLAS (Intel MKL is a package that implements BLAS).</p>\n\n<p>By using one of these packages, you not only get much better performance, but also avoid the potential pitfalls or bugs that you would likely have otherwise.</p>\n"}], "owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565180282, "creation_date": 1565179099, "question_id": 57393978, "link": "https://stackoverflow.com/questions/57393978/matrix-multiplication-with-vectorization-in-c-executes-for-a-long-time", "title": "Matrix multiplication with vectorization in c++ executes for a long time", "body": "<p>I have several matrices that I want to multiply in c++ with allowing vectorization. However the following code results in a large execution time  ~858146125 ns. How do I modify the code so I have vectorization of the matrix multiplication and reach around 100ns of execution time.\nI am using the flag O3.</p>\n\n<pre><code>   const int ROWS = 1000;\n    const int COLS = 1000;\n    const int ROWS1 = 1000;\n    const int COLS1 = 1000;\n    const int l = 1000;\n    double random_matrix[ROWS][COLS];\n    double random_matrix1[ROWS1][COLS1];\n\n    double mult[l][l];\n    int i;\n    int j;\n    /* generate number: */\n    for (i = 0; i &lt; ROWS; i++) {\n        for (j = 0; j &lt; COLS; j++)\n            random_matrix[i][j] = i + j;\n    }\n    for (i = 0; i &lt; ROWS1; i++) {\n        for (j = 0; j &lt; COLS1; j++)\n            random_matrix1[i][j] = i + j;\n    }\n\n    auto start = std::chrono::steady_clock::now();\n    for (size_t row = 0; row &lt; ROWS; ++row) {\n        for (size_t tmp = 0; tmp &lt; COLS1; ++tmp) {\n            mult[row][tmp] = random_matrix[row][0]*random_matrix1[0][tmp];\n            for (size_t col = 1; col &lt; COLS; ++col) {\n                mult[row][tmp] += random_matrix[row][col] * random_matrix1[col][tmp];\n            }\n        }\n    }\n\n    auto end = std::chrono::steady_clock::now();\n    std::cout &lt;&lt; \"Elapsed time in nanoseconds : \"\n              &lt;&lt; std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(end - start).count()\n              &lt;&lt; \" ns\" &lt;&lt; std::endl;\n\n    std::cout&lt;&lt;\"\\n\";\n    for (i=0;i&lt;ROWS;i++)\n    {\n        for (j=0;j&lt;COLS1;j++)\n            std::cout &lt;&lt; mult[i][j] &lt;&lt;std::endl; //display table\n        std::cout&lt;&lt;\"\\n\";\n    }\n\n\n</code></pre>\n"}, {"tags": ["c++", "operator-overloading", "operators"], "comments": [{"owner": {"reputation": 473, "user_id": 11502610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf986a3bd7cf5ca22ae39a8fbabfe0b?s=128&d=identicon&r=PG&f=1", "display_name": "DrosvarG", "link": "https://stackoverflow.com/users/11502610/drosvarg"}, "edited": false, "score": 0, "creation_date": 1565178941, "post_id": 57393920, "comment_id": 101269407, "body": "I tried to make this as clear and concise as I could but don&#39;t hesitate to ask for any missing info"}, {"owner": {"reputation": 2310, "user_id": 9185253, "user_type": "registered", "profile_image": "https://graph.facebook.com/114451586026362/picture?type=large", "display_name": "Maestro", "link": "https://stackoverflow.com/users/9185253/maestro"}, "edited": false, "score": 0, "creation_date": 1565179547, "post_id": 57393920, "comment_id": 101269749, "body": "I don&#39;t see any reason to do so."}], "answers": [{"comments": [{"owner": {"reputation": 473, "user_id": 11502610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf986a3bd7cf5ca22ae39a8fbabfe0b?s=128&d=identicon&r=PG&f=1", "display_name": "DrosvarG", "link": "https://stackoverflow.com/users/11502610/drosvarg"}, "edited": false, "score": 0, "creation_date": 1565179930, "post_id": 57394137, "comment_id": 101269952, "body": "Alright, I see. I started by writing the passing-by-value function and got misleaded by the error I got, so I just added the <code>const reference</code> one and assumed that I needed all of those I described. Thanks for the precisions on the utility of multiple overloads also"}], "tags": [], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "is_accepted": true, "score": 1, "last_activity_date": 1565189265, "last_edit_date": 1565189265, "creation_date": 1565179567, "answer_id": 57394137, "question_id": 57393920, "link": "https://stackoverflow.com/questions/57393920/should-i-have-to-implement-all-4-operator-overload-in-order-to-deal-with-all-con/57394137#57394137", "title": "Should I have to implement all 4 operator overload in order to deal with all const and non-const combinations?", "body": "<p>If you have a non-<code>const</code> <code>Foo</code> object, you can use it where <code>const Foo&amp;</code> object are expected, and you can call <code>const</code>-method on it, so you should only have one overload:</p>\n\n<pre><code>bool operator==(Foo const&amp; object) const {\n    return (x == object.x) &amp;&amp; (y == object.y) &amp;&amp; (value == object.value);\n}\n</code></pre>\n\n<p>You only needs to differentiate <code>const</code> and non-<code>const</code> overloads for specific cases where the behavior is different depending if the object is <code>const</code> or non-<code>const</code>, e.g., for <code>operator[]</code>:</p>\n\n<pre><code>// You want to return a reference on non-const object and a const-reference\n// on const object, so you need both overloads.\nX&amp; operator[](std::size_t);\nconst X&amp; operator[](std::size) const;\n</code></pre>\n\n<hr>\n\n<p>You usually want to have non-member functions for binary operators, with  <code>friend</code> if necessary. In your case, since all members are public, you can simply create a free function (outside the <code>struct</code>):</p>\n\n<pre><code>bool operator==(Foo const&amp; lhs, Foo const&amp; rhs) const {\n    return lhs.x == rhs.x &amp;&amp; lhs.y == rhs.y &amp;&amp; lhs.value == rhs.vallue;\n}\n</code></pre>\n\n<p>You can also drop that <code>inline</code> modifier which is kind of irrelevant nowadays, see, e.g., <a href=\"https://stackoverflow.com/questions/1759300/when-should-i-write-the-keyword-inline-for-a-function-method\">When should I write the keyword &#39;inline&#39; for a function/method?</a>.</p>\n\n<p>You can also check <a href=\"https://stackoverflow.com/questions/4421706/what-are-the-basic-rules-and-idioms-for-operator-overloading/4421708\">What are the basic rules and idioms for operator overloading?</a> for some idioms regarding operator overloading.</p>\n"}, {"tags": [], "owner": {"reputation": 2310, "user_id": 9185253, "user_type": "registered", "profile_image": "https://graph.facebook.com/114451586026362/picture?type=large", "display_name": "Maestro", "link": "https://stackoverflow.com/users/9185253/maestro"}, "is_accepted": false, "score": 1, "last_activity_date": 1565180105, "last_edit_date": 1565180105, "creation_date": 1565179653, "answer_id": 57394152, "question_id": 57393920, "link": "https://stackoverflow.com/questions/57393920/should-i-have-to-implement-all-4-operator-overload-in-order-to-deal-with-all-con/57394152#57394152", "title": "Should I have to implement all 4 operator overload in order to deal with all const and non-const combinations?", "body": "<p>There is no reason to do so!</p>\n\n<p>As long as it is just comparison then it is preferred always to use <code>const references</code>:</p>\n\n<pre><code>  inline bool operator==(const Foo &amp;object)const{\n        return (x == object.x) &amp;&amp; (y == object.y) &amp;&amp; (value == object.value);\n  }\n</code></pre>\n\n<ul>\n<li><p>The reason is you can pass the address or reference of <code>const</code> and <code>non-const</code> to a <code>const</code> member function but not the contrary.</p></li>\n<li><p>There are some cases when overloading depending on <code>constness</code> matters.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 473, "user_id": 11502610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf986a3bd7cf5ca22ae39a8fbabfe0b?s=128&d=identicon&r=PG&f=1", "display_name": "DrosvarG", "link": "https://stackoverflow.com/users/11502610/drosvarg"}, "edited": false, "score": 0, "creation_date": 1565180029, "post_id": 57394164, "comment_id": 101270008, "body": "Which c++ standard allow to do this ? Because I tried this too but it doesn&#39;t compile for me. I got a <code>too many parameters for binary operator &#39;operator==&#39;</code> error"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 473, "user_id": 11502610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf986a3bd7cf5ca22ae39a8fbabfe0b?s=128&d=identicon&r=PG&f=1", "display_name": "DrosvarG", "link": "https://stackoverflow.com/users/11502610/drosvarg"}, "edited": false, "score": 1, "creation_date": 1565180269, "post_id": 57394164, "comment_id": 101270132, "body": "C++ has always allowed (and encouraged) writting functions like this. As I said, you need to make it a non-member function."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "is_accepted": false, "score": 2, "last_activity_date": 1565180331, "last_edit_date": 1565180331, "creation_date": 1565179703, "answer_id": 57394164, "question_id": 57393920, "link": "https://stackoverflow.com/questions/57393920/should-i-have-to-implement-all-4-operator-overload-in-order-to-deal-with-all-con/57394164#57394164", "title": "Should I have to implement all 4 operator overload in order to deal with all const and non-const combinations?", "body": "<p>Operator==, like most binary operators, should normally be implemented as a single, non-member, free function:</p>\n\n<pre><code> inline bool operator==(const Foo &amp; a, const Foo &amp; b ) {\n       return a.x == b.x &amp;&amp; a.y == b.y &amp;&amp; a.value == b.value;\n }\n</code></pre>\n"}], "owner": {"reputation": 473, "user_id": 11502610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf986a3bd7cf5ca22ae39a8fbabfe0b?s=128&d=identicon&r=PG&f=1", "display_name": "DrosvarG", "link": "https://stackoverflow.com/users/11502610/drosvarg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 57394137, "answer_count": 3, "score": 1, "last_activity_date": 1565189265, "creation_date": 1565178932, "question_id": 57393920, "link": "https://stackoverflow.com/questions/57393920/should-i-have-to-implement-all-4-operator-overload-in-order-to-deal-with-all-con", "title": "Should I have to implement all 4 operator overload in order to deal with all const and non-const combinations?", "body": "<h2>General context</h2>\n\n<p>I have a self-made <code>struct</code> and I want to compare two instance of it. In order to do that I obviously overload the <code>operator==</code> so I will be able to do so. Now, this operator may be called with 0 to 2 <code>const</code> instances and 0 to 2 non-<code>const</code> instances. </p>\n\n<p>As I want my operator <code>==</code> to compare 2 const as it compare any possible combination of <code>const</code> and <code>non-const</code>, the best for me should be to write only one overload which can deal with all possible combination. But as far as I know, I didn't find any way to do so.</p>\n\n<h2>Question</h2>\n\n<p>Does that mean that if I need to consider all possible combination, I have to write all 4 possible overloads ? Is there anyway I can avoid to write 4 times the same function only with <code>const</code> keywords changing ?</p>\n\n<hr>\n\n<h2>Specific example</h2>\n\n<p>So here is the <code>struct</code>. It represents an object on a plan, and consists of its position and a value associated to it:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct Foo\n{\n    int x;\n    int y;\n    double value;\n};\n</code></pre>\n\n<p>Now let's say 2 <code>Foo</code> are equal if they have the same value and the same position. I have the following operator:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>inline bool operator==(Foo object) // Compare two non-const Foo\n{\n    return (x == object.x) &amp;&amp; (y == object.y) &amp;&amp; (value == object.value);\n}\n</code></pre>\n\n<p>But, eww, unlucky some <code>Foo</code> can be constants, meaning that my objects can't move on the plan and can't change their value. And now I need to check if two <code>const Foo</code> can be equals and if a non-<code>const Foo</code> can be equal to a <code>const Foo</code>. </p>\n\n<p>Is there anyway I can do that but still avoid to write those following functions which are almost the same as the first one ?</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>inline bool operator==(const Foo &amp;object) // Compare a non-const Foo with a const Foo\n{\n    return (x == object.x) &amp;&amp; (y == object.y) &amp;&amp; (value == object.value);\n}\n\ninline bool operator==(const Foo &amp;object) const // Compare two const Foo\n{\n    return (x == object.x) &amp;&amp; (y == object.y) &amp;&amp; (value == object.value);\n}\n\ninline bool operator==(Foo object) const // Compare a const Foo with a non-const Foo\n{\n    return (x == object.x) &amp;&amp; (y == object.y) &amp;&amp; (value == object.value);\n}\n</code></pre>\n\n<p>I don't have any requirements on c++ version. It can ever be c++17 or c++20.</p>\n"}, {"tags": ["c++", "function", "templates", "c++17", "template-specialization"], "comments": [{"owner": {"reputation": 1778, "user_id": 9063139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bze7O.png?s=128&g=1", "display_name": "Martin Morterol", "link": "https://stackoverflow.com/users/9063139/martin-morterol"}, "edited": false, "score": 0, "creation_date": 1565178821, "post_id": 57393715, "comment_id": 101269334, "body": "you should look at SFINAE"}], "answers": [{"comments": [{"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 0, "creation_date": 1565179376, "post_id": 57393900, "comment_id": 101269648, "body": "I don&#39;t think your example will compile. What will the <code>std::string</code> specialization match?"}, {"owner": {"reputation": 26196, "user_id": 1841194, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e65b668131c96399c25c6fae3fff8da5?s=128&d=identicon&r=PG&f=1", "display_name": "frogatto", "link": "https://stackoverflow.com/users/1841194/frogatto"}, "reply_to_user": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 0, "creation_date": 1565179567, "post_id": 57393900, "comment_id": 101269755, "body": "@BiagioFesta Sorry it&#39;s an overload not specialization."}, {"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 1, "creation_date": 1565179634, "post_id": 57393900, "comment_id": 101269804, "body": "Yeah, now it&#39;s fine! :)"}, {"owner": {"reputation": 1214, "user_id": 1182849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ee45693710cd55e207c6b1c77c43103?s=128&d=identicon&r=PG", "display_name": "grorel", "link": "https://stackoverflow.com/users/1182849/grorel"}, "edited": false, "score": 0, "creation_date": 1565180768, "post_id": 57393900, "comment_id": 101270409, "body": "Hi, thanks for your help. I tried your code in the ccp file, then in the header file. I got the same error in both case: <code>undefined reference to </code>void sqlite3_column_template&lt;int&gt;(sqlite3_stmt*, int, int&amp;)&#39;` and for others type as well (long long, const char*, double, unsigned int)"}, {"owner": {"reputation": 1214, "user_id": 1182849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ee45693710cd55e207c6b1c77c43103?s=128&d=identicon&r=PG", "display_name": "grorel", "link": "https://stackoverflow.com/users/1182849/grorel"}, "edited": false, "score": 0, "creation_date": 1565186986, "post_id": 57393900, "comment_id": 101274428, "body": "Your solution is working if the header file is called once. Else the function for std::string is seen defined multiple times : <code>multiple definition of sqlite3_column_template(sqlite3_stmt*, int, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;&amp;)</code>. I used some of @Jejo code to solve this problem"}, {"owner": {"reputation": 26196, "user_id": 1841194, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e65b668131c96399c25c6fae3fff8da5?s=128&d=identicon&r=PG&f=1", "display_name": "frogatto", "link": "https://stackoverflow.com/users/1841194/frogatto"}, "reply_to_user": {"reputation": 1214, "user_id": 1182849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ee45693710cd55e207c6b1c77c43103?s=128&d=identicon&r=PG", "display_name": "grorel", "link": "https://stackoverflow.com/users/1182849/grorel"}, "edited": false, "score": 0, "creation_date": 1565188751, "post_id": 57393900, "comment_id": 101275535, "body": "@grorel The code I&#39;ve written isn&#39;t a complete .cpp/.h file, so you should take care of includes and include guards."}], "tags": [], "owner": {"reputation": 26196, "user_id": 1841194, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e65b668131c96399c25c6fae3fff8da5?s=128&d=identicon&r=PG&f=1", "display_name": "frogatto", "link": "https://stackoverflow.com/users/1841194/frogatto"}, "is_accepted": true, "score": 3, "last_activity_date": 1565179398, "last_edit_date": 1565179398, "creation_date": 1565178856, "answer_id": 57393900, "question_id": 57393715, "link": "https://stackoverflow.com/questions/57393715/how-do-i-specialize-several-type-on-the-same-template-function/57393900#57393900", "title": "How do I specialize several type on the same template function?", "body": "<p>You can use <a href=\"https://en.cppreference.com/w/cpp/types/enable_if\" rel=\"nofollow noreferrer\"><code>std::enable_if</code></a> to conditionally remove functions from overload resolution based on type traits using <a href=\"https://en.wikipedia.org/wiki/Substitution_failure_is_not_an_error\" rel=\"nofollow noreferrer\">SFINAE</a>.</p>\n\n<ul>\n<li><a href=\"https://en.cppreference.com/w/cpp/types/is_integral\" rel=\"nofollow noreferrer\"><code>std::is_integral&lt;T&gt;</code></a> checks whether T is an integral type. </li>\n<li><a href=\"https://en.cppreference.com/w/cpp/types/is_floating_point\" rel=\"nofollow noreferrer\"><code>std::is_floating_point&lt;T&gt;</code></a> checks whether T is a floating-point type.</li>\n</ul>\n\n<p>Your code after  using enable_if:</p>\n\n<pre><code>template &lt;typename T&gt; \nstd::enable_if_t&lt;std::is_integral_v&lt;T&gt;&gt; sqlite3_column_template(sqlite3_stmt *stmt, int column, T&amp; value)\n{\n    value = sqlite3_column_int64(stmt, column);\n}\n\ntemplate &lt;typename T&gt; \nstd::enable_if_t&lt;std::is_floating_point_v&lt;T&gt;&gt; sqlite3_column_template(sqlite3_stmt *stmt, int column, T&amp; value)\n{\n    value = sqlite3_column_double(stmt, column);\n}\n\nvoid sqlite3_column_template(sqlite3_stmt *stmt, int column, std::string&amp; value)\n{\n    value = reinterpret_cast&lt;const char*&gt;(sqlite3_column_text(stmt, column));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1214, "user_id": 1182849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ee45693710cd55e207c6b1c77c43103?s=128&d=identicon&r=PG", "display_name": "grorel", "link": "https://stackoverflow.com/users/1182849/grorel"}, "edited": false, "score": 0, "creation_date": 1565181420, "post_id": 57394109, "comment_id": 101270781, "body": "Hi, thanks for your help. I tried your code in the ccp file, then in the header file. I got the same error in both case: <code>undefined reference to void sqlite3_column_template&lt;int&gt;(sqlite3_stmt*, int, int&amp;)&#39;</code> and for others type as well (long long, const char*, double, unsigned int)"}, {"owner": {"reputation": 1214, "user_id": 1182849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ee45693710cd55e207c6b1c77c43103?s=128&d=identicon&r=PG", "display_name": "grorel", "link": "https://stackoverflow.com/users/1182849/grorel"}, "edited": false, "score": 0, "creation_date": 1565182100, "post_id": 57394109, "comment_id": 101271196, "body": "Yes, no more template in the cpp file. I get the same error as in my first message :  undefined reference to <code>void sqlite3_column_template&lt;long long&gt;(sqlite3_stmt*, int, long long&amp;)</code>"}, {"owner": {"reputation": 1214, "user_id": 1182849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ee45693710cd55e207c6b1c77c43103?s=128&d=identicon&r=PG", "display_name": "grorel", "link": "https://stackoverflow.com/users/1182849/grorel"}, "edited": false, "score": 0, "creation_date": 1565186811, "post_id": 57394109, "comment_id": 101274321, "body": "OK, I had a problem with my toolchain &amp; source files... Everything compile fine now but the static_assert which lead to this error <code>error: static assertion failed: wrong type</code>. I&#39;ll use the solution posted in my post. thank you for your help"}], "tags": [], "owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "is_accepted": false, "score": 4, "last_activity_date": 1565180347, "last_edit_date": 1565180347, "creation_date": 1565179468, "answer_id": 57394109, "question_id": 57393715, "link": "https://stackoverflow.com/questions/57393715/how-do-i-specialize-several-type-on-the-same-template-function/57394109#57394109", "title": "How do I specialize several type on the same template function?", "body": "<p>If you have access to <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a>, you could combine the specializations to one single function with the help of <strong><em><a href=\"https://en.cppreference.com/w/cpp/language/if\" rel=\"nofollow noreferrer\">if constexpr</a></em></strong>.</p>\n\n<p>Where type traits:</p>\n\n<ul>\n<li><a href=\"https://en.cppreference.com/w/cpp/types/is_integral\" rel=\"nofollow noreferrer\"><code>std::is_integral</code></a>\nhas been used to check the type is an integer.</li>\n<li><a href=\"https://en.cppreference.com/w/cpp/types/is_floating_point\" rel=\"nofollow noreferrer\"><code>std::is_floating_point</code></a>\nhas been used to check the type is a floating-point.</li>\n<li><a href=\"https://en.cppreference.com/w/cpp/types/is_same\" rel=\"nofollow noreferrer\"><code>std::is_same_v&lt;T, U&gt;</code></a> has been used\nto check whether types(i.e. <code>T</code> and <code>U</code>) are same(used for checking\n<code>std::string</code>).</li>\n</ul>\n\n<p>The <code>sqlite3_column_template</code> can be written now:</p>\n\n<pre><code>#include &lt;type_traits&gt; // std::is_integral, std::is_floating_point, std::is_same\n\ntemplate &lt;typename T&gt;\nvoid sqlite3_column_template(sqlite3_stmt *stmt, int column, T&amp; value)\n{\n    if constexpr (std::is_integral_v&lt;T&gt;) \n    {\n        value = sqlite3_column_int64();\n        // do something more\n    }\n    else if constexpr (std::is_floating_point_v&lt;T&gt;) \n    {\n        value = sqlite3_column_double();\n        // do something more\n    }\n    else if constexpr (std::is_same_v&lt;T, std::string&gt;) \n    {\n        value = sqlite3_column_text();\n        // do something more\n    }\n    else\n        static_assert(false, \"wrong type\");\n}\n</code></pre>\n"}], "owner": {"reputation": 1214, "user_id": 1182849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ee45693710cd55e207c6b1c77c43103?s=128&d=identicon&r=PG", "display_name": "grorel", "link": "https://stackoverflow.com/users/1182849/grorel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 57393900, "answer_count": 2, "score": 2, "last_activity_date": 1565217864, "creation_date": 1565178326, "last_edit_date": 1565217864, "question_id": 57393715, "link": "https://stackoverflow.com/questions/57393715/how-do-i-specialize-several-type-on-the-same-template-function", "title": "How do I specialize several type on the same template function?", "body": "<p>I have a generic function to read columns from my database. Its prototype in the header file is :</p>\n\n<pre><code>template &lt;typename T&gt; void sqlite3_column_template(sqlite3_stmt *stmt, int column, T&amp; value);\n</code></pre>\n\n<p>The idea is to specialized this function to call these functions depending on the value type :</p>\n\n<pre><code>sqlite3_column_int64(...)\nsqlite3_column_double(...)\nsqlite3_column_text(...)\n</code></pre>\n\n<p>In my <code>cpp</code> file, I have written the specialization functions like this :</p>\n\n<pre><code>template &lt;&gt; void sqlite3_column_template(sqlite3_stmt *stmt, int column, int&amp; value)\n{\n    value = sqlite3_column_int64(stmt, column);\n}\n\ntemplate &lt;&gt; void sqlite3_column_template(sqlite3_stmt *stmt, int column, float&amp; value)\n{\n    value = sqlite3_column_double(stmt, column);\n}\n\ntemplate &lt;&gt; void sqlite3_column_template(sqlite3_stmt *stmt, int column, std::string&amp; value)\n{\n    value = reinterpret_cast&lt;const char*&gt;(sqlite3_column_text(stmt, column));\n}\n</code></pre>\n\n<p>The problem I have is that the value type when calling this function can be of the following :</p>\n\n<pre><code>uint32_t, int32_t, int64_t\nfloat, double\n</code></pre>\n\n<p>I don't know how to tell that all \"<em>integers</em>\" types must call the function<code>sqlite3_column_int64</code>. </p>\n\n<p>Same for <code>float</code> and <code>double</code> to call <code>sqlite3_column_double</code> function.</p>\n\n<p>How can I do it? Is it possible at all?</p>\n\n<hr>\n\n<h2>EDIT</h2>\n\n<p>The solution I use is as follow:</p>\n\n<pre><code>// the 3 functions in the header file\ntemplate &lt;typename T&gt; \nstd::enable_if_t&lt;std::is_integral_v&lt;T&gt;&gt; sqlite3_column_template(sqlite3_stmt *stmt, int column, T&amp; value)\n{\n    value = sqlite3_column_int64(stmt, column);\n}\n\ntemplate &lt;typename T&gt; \nstd::enable_if_t&lt;std::is_floating_point_v&lt;T&gt;&gt; sqlite3_column_template(sqlite3_stmt *stmt, int column, T&amp; value)\n{\n    value = sqlite3_column_double(stmt, column);\n}\n\ntemplate &lt;typename T&gt; \nstd::enable_if_t&lt;std::is_same_v&lt;T, std::string&gt;&gt; sqlite3_column_template(sqlite3_stmt *stmt, int column, T&amp; value)\n{\n    value = reinterpret_cast&lt;const char*&gt;(sqlite3_column_text(stmt, column));\n}\n</code></pre>\n"}, {"tags": ["c++", "algorithm", "c++11", "for-loop", "vector"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 10692258, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UB_sqH7EW9U/AAAAAAAAAAI/AAAAAAAAADI/LHtRZRerlKg/photo.jpg?sz=128", "display_name": "David Petriashvili", "link": "https://stackoverflow.com/users/10692258/david-petriashvili"}, "edited": false, "score": 0, "creation_date": 1565177570, "post_id": 57393393, "comment_id": 101268646, "body": "Thanks for the answer. I&#39;m a newbie, so i don&#39;t know what UB means. Could you tell me?"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1565177609, "post_id": 57393393, "comment_id": 101268672, "body": "UB is <i>undefined behaviour</i>. It&#39;s bad, your program could do anything."}, {"owner": {"reputation": 65, "user_id": 10692258, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UB_sqH7EW9U/AAAAAAAAAAI/AAAAAAAAADI/LHtRZRerlKg/photo.jpg?sz=128", "display_name": "David Petriashvili", "link": "https://stackoverflow.com/users/10692258/david-petriashvili"}, "edited": false, "score": 0, "creation_date": 1565177769, "post_id": 57393393, "comment_id": 101268765, "body": "Understood. Thanks!"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 3, "last_activity_date": 1565223347, "last_edit_date": 1565223347, "creation_date": 1565177333, "answer_id": 57393393, "question_id": 57393349, "link": "https://stackoverflow.com/questions/57393349/after-using-a-transform-to-fill-up-a-vector-the-new-c11-for-loop-doesnt-work/57393393#57393393", "title": "After using a transform to fill up a vector, the new c++11 for loop doesn&#39;t work", "body": "<p>This is UB (undefined behaviour), it does not fill anything:</p>\n\n<pre><code>transform(v.begin(), v.end(), v1.begin(), mult);\n</code></pre>\n\n<p>you want:</p>\n\n<pre><code>std::transform(v.begin(), v.end(), std::back_inserter(v1), mult);\n</code></pre>\n\n<p>As a general rule, operations on begin/end iterators do not change the size of the container.</p>\n\n<p>Your code just spewed data into an empty buffer, corrupting memory or worse.</p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 10692258, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UB_sqH7EW9U/AAAAAAAAAAI/AAAAAAAAADI/LHtRZRerlKg/photo.jpg?sz=128", "display_name": "David Petriashvili", "link": "https://stackoverflow.com/users/10692258/david-petriashvili"}, "edited": false, "score": 0, "creation_date": 1565177519, "post_id": 57393412, "comment_id": 101268616, "body": "Ah i see now what this is all about. Haven&#39;t learned this back_inserter thing yet. Which library is it in? Thanks for the answer. I didn&#39;t think that there needed to be space in the vector, thought it would just insert stuff."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 65, "user_id": 10692258, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UB_sqH7EW9U/AAAAAAAAAAI/AAAAAAAAADI/LHtRZRerlKg/photo.jpg?sz=128", "display_name": "David Petriashvili", "link": "https://stackoverflow.com/users/10692258/david-petriashvili"}, "edited": false, "score": 0, "creation_date": 1565177581, "post_id": 57393412, "comment_id": 101268655, "body": "@DavidPetriashvili it&#39;s in <code>&lt;iterator&gt;</code>"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 65, "user_id": 10692258, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UB_sqH7EW9U/AAAAAAAAAAI/AAAAAAAAADI/LHtRZRerlKg/photo.jpg?sz=128", "display_name": "David Petriashvili", "link": "https://stackoverflow.com/users/10692258/david-petriashvili"}, "edited": false, "score": 0, "creation_date": 1565177774, "post_id": 57393412, "comment_id": 101268771, "body": "@DavidPetriashvili In general it&#39;s not possible for an iterator to insert or delete from the container it&#39;s iterating over. Only specialized iterators like that returned from <code>back_inserter</code> can do that."}, {"owner": {"reputation": 65, "user_id": 10692258, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UB_sqH7EW9U/AAAAAAAAAAI/AAAAAAAAADI/LHtRZRerlKg/photo.jpg?sz=128", "display_name": "David Petriashvili", "link": "https://stackoverflow.com/users/10692258/david-petriashvili"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1565178098, "post_id": 57393412, "comment_id": 101268952, "body": "@john Yes i see, i actually tried doing front_inserter but the code went balls. What is wrong with doing the same thing but from front? (added the &lt;iterator&gt; lib)"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 65, "user_id": 10692258, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UB_sqH7EW9U/AAAAAAAAAAI/AAAAAAAAADI/LHtRZRerlKg/photo.jpg?sz=128", "display_name": "David Petriashvili", "link": "https://stackoverflow.com/users/10692258/david-petriashvili"}, "edited": false, "score": 0, "creation_date": 1565178146, "post_id": 57393412, "comment_id": 101268981, "body": "@DavidPetriashvili - Consult the documentation of the iterator and containers you use. <code>std::vector</code> doesn&#39;t support insertion at the front, for that you&#39;d need <code>std::deque</code>"}, {"owner": {"reputation": 65, "user_id": 10692258, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UB_sqH7EW9U/AAAAAAAAAAI/AAAAAAAAADI/LHtRZRerlKg/photo.jpg?sz=128", "display_name": "David Petriashvili", "link": "https://stackoverflow.com/users/10692258/david-petriashvili"}, "edited": false, "score": 0, "creation_date": 1565178305, "post_id": 57393412, "comment_id": 101269088, "body": "I haven&#39;t even been told to read any documentation ever. I&#39;ll search for it. Thanks"}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1565177378, "creation_date": 1565177378, "answer_id": 57393412, "question_id": 57393349, "link": "https://stackoverflow.com/questions/57393349/after-using-a-transform-to-fill-up-a-vector-the-new-c11-for-loop-doesnt-work/57393412#57393412", "title": "After using a transform to fill up a vector, the new c++11 for loop doesn&#39;t work", "body": "<p><code>transform</code> doesn't extend a range, it only writes to on an existing one that's assumed non-empty. <code>v1</code> is empty, so it cannot be made to store the result of the transformation. Your options are to either make sure <code>v1</code> holds enough elements for the algorithm to overwrite:</p>\n\n<pre><code>vector&lt;int&gt; v1(v.size());\n</code></pre>\n\n<p>or to use <a href=\"https://en.cppreference.com/w/cpp/iterator/back_inserter\" rel=\"nofollow noreferrer\"><code>std::back_inserter</code></a> to create an iterator which increases the size of <code>v1</code>:</p>\n\n<pre><code>transform(v.begin(), v.end(), back_inserter(v1), mult);\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 10692258, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UB_sqH7EW9U/AAAAAAAAAAI/AAAAAAAAADI/LHtRZRerlKg/photo.jpg?sz=128", "display_name": "David Petriashvili", "link": "https://stackoverflow.com/users/10692258/david-petriashvili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 57393412, "answer_count": 2, "score": 2, "last_activity_date": 1565223347, "creation_date": 1565177152, "question_id": 57393349, "link": "https://stackoverflow.com/questions/57393349/after-using-a-transform-to-fill-up-a-vector-the-new-c11-for-loop-doesnt-work", "title": "After using a transform to fill up a vector, the new c++11 for loop doesn&#39;t work", "body": "<p>I am currently learning STL, and am on a topic of mapping, filtering etc.\nI recently learned lots of new stuff such as the new c++11 for loop(with auto)\nI (kinda) don't understand the way things work, but i wanted to use the \"transform\" function to fill up another vector(mapping topic). But after i build the program and run it, it gives me an error which goes as:\n\"cannot seek value-initialized vector iterator\"</p>\n\n<p>I am not sure what that means or what error there is, could you guys help me understand the for loop concept and what im doing wrong here?</p>\n\n<p>p.s the operator of the \"transform\" in the end was done with a lambda thingy(which i still have to learn and have no idea about) in the tutorial, i tried to make a function and guessed that it would work.</p>\n\n<pre><code>int mult(int a) {\n    return a * 10;\n}\nint main() {\n    vector&lt;int&gt; v{ 1,2,3,4,5 };\n    vector&lt;int&gt; v1;\n    for (auto&amp; i : v) {\n        cout &lt;&lt; i &lt;&lt; endl;\n    }\n    if (v1.empty()) cout &lt;&lt; \"v1 is empty\" &lt;&lt; endl;\n    cout &lt;&lt; \"v1\" &lt;&lt; endl;\n    transform(v.begin(), v.end(), v1.begin(), mult);\n    for (auto &amp;i : v1) {\n        cout &lt;&lt; i &lt;&lt; endl;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "algorithm", "graph", "tree", "graph-algorithm"], "comments": [{"owner": {"reputation": 15376, "user_id": 588916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9737fb0439f70903f8948ad3963d9cc?s=128&d=identicon&r=PG", "display_name": "collapsar", "link": "https://stackoverflow.com/users/588916/collapsar"}, "edited": false, "score": 0, "creation_date": 1565177285, "post_id": 57392985, "comment_id": 101268472, "body": "A naive approach: Perform a DFS and keep a list of &#39;currently processed vertices&#39; as a stack. When first visiting a node, add it to the stack, after the last visit remove it. The operations are sound given the traversal order in a DFS. The stack elements are tuples <code>(value, count)</code> being initialised with <code>(value, 0)</code>. Upon the first visit of each vertex, iterate through the stack and increment the counts appropriately. Upon removal of  stack element, store its <code>count</code> with the current node. This runs in <code>O(n^2)</code> ( <code>O(d*n)</code> with <code>d</code> the depth of the tree )."}, {"owner": {"reputation": 11, "user_id": 11895332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8714959ffed9a8b45fb40c4f59e5e1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexx Vladisov", "link": "https://stackoverflow.com/users/11895332/alexx-vladisov"}, "reply_to_user": {"reputation": 15376, "user_id": 588916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9737fb0439f70903f8948ad3963d9cc?s=128&d=identicon&r=PG", "display_name": "collapsar", "link": "https://stackoverflow.com/users/588916/collapsar"}, "edited": false, "score": 0, "creation_date": 1565177438, "post_id": 57392985, "comment_id": 101268568, "body": "Well I need a more optimised solution and this solution is quite intuitive."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11895332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8714959ffed9a8b45fb40c4f59e5e1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexx Vladisov", "link": "https://stackoverflow.com/users/11895332/alexx-vladisov"}, "edited": false, "score": 1, "creation_date": 1565195163, "post_id": 57398406, "comment_id": 101278897, "body": "<code>for each child in root.children:        list_of_nodes childList = dfs( child )        thisList.addAll( childList )</code>  Here you are adding the list of subtree to the list of root which can result in quadratic complexity. @SomeDude"}, {"owner": {"reputation": 6812, "user_id": 1410303, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/UVBNS.png?s=128&g=1", "display_name": "SomeDude", "link": "https://stackoverflow.com/users/1410303/somedude"}, "reply_to_user": {"reputation": 11, "user_id": 11895332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8714959ffed9a8b45fb40c4f59e5e1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexx Vladisov", "link": "https://stackoverflow.com/users/11895332/alexx-vladisov"}, "edited": false, "score": 0, "creation_date": 1565198609, "post_id": 57398406, "comment_id": 101280563, "body": "@AlexxVladisov Yes it will add to complexity. A more efficient approach is to use a sorted map to store keys and do a post order. Added to my answer."}], "tags": [], "owner": {"reputation": 6812, "user_id": 1410303, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/UVBNS.png?s=128&g=1", "display_name": "SomeDude", "link": "https://stackoverflow.com/users/1410303/somedude"}, "is_accepted": false, "score": 0, "last_activity_date": 1565226072, "last_edit_date": 1565226072, "creation_date": 1565193930, "answer_id": 57398406, "question_id": 57392985, "link": "https://stackoverflow.com/questions/57392985/no-of-nodes-in-which-nodes-are-smaller-and-greater-than-the-certain-node/57398406#57398406", "title": "No of Nodes in which nodes are smaller and greater than the certain node", "body": "<p><strong>A little more efficient approach:</strong></p>\n\n<p>A more efficient approach is to do post order and using a Binary Search Tree type map ( probably in c++ the sorted map implementation should already use some sort of red black tree ) to store keys and their count.</p>\n\n<p>Do a post order traversal of the tree. \nAt each node after the traversal: </p>\n\n<p>a) for greater nodes :</p>\n\n<p>get the next highest value to the current node in the BST type map ( this should be done in <code>O( log n )</code> and count all values below it. ( this will save lot of time especially if tree is balanced ) but will be expensive if the tree is imbalanced.</p>\n\n<p>b) for lesser nodes:</p>\n\n<p>get the next smallest value to the current node in the BST type map ( this should be done in <code>O( log n )</code> and count all values above it.</p>\n\n<pre><code>//map - sorted map with keys and their count\n//greater_map - unordered map that contains node as key and count of nodes greater than key node.\n//lesser_map - unordered map that contains node as key and count of nodes lesser than key node.\n\npost_order( Node root ) \n   if ( root == null ) return;\n\n   for each child in root.children:\n       post_order( child )\n\n   int next_higher_key = find_next_higher_key( map, root_key )\n   greater_map.insert(root, count_all_values_greater_than_equal_to(next_higher_key, map) )\n\n   int next_smaller_key = find_next_smaller_key( map, root_key )\n   lesser_map.insert(root, count_all_values_lesser_than_equal_to(next_smaller_key, map) )\n\n   if ( !map[root_key] )\n      map.insert( root_key, 1 )\n   else\n      map.insert( root_key, map[root_key] + 1 )\n</code></pre>\n\n<p><strong>Less efficient approach:</strong></p>\n\n<p>Do a depth first search traversal of the tree once. At each node after you are done with the traversal, store the number of greater nodes and lesser nodes in two maps. Key will be the node at which you just finished your traversal and value will be number of nodes greater than the current node and number of nodes lesser than the current node respectively. From the map you could easily get number of nodes which are greater or smaller for any given node. </p>\n\n<p>Pseudo code:</p>\n\n<pre><code>\nlist_of_nodes dfs( Node root ) {\n   list_of_nodes thisList = new list_of_nodes;\n   if ( root == null ) return thisList;\n   thisList.push( root );\n\n   for each child in root.children:\n       list_of_nodes childList = dfs( child )\n       thisList.addAll( childList )\n\n   int greater = 0, lesser = 0\n   for each node in thisList:\n       if node_value &gt; root_value\n           greater++\n       else if node_value &lt; root_value\n           lesser++\n\n   greatermap.insert( root, greater )\n   lessermap.insert( root, lesser )\n\n   return thisList\n</code></pre>\n\n<p>To get the number of greater, lesser nodes for any given node, you can just access the map.</p>\n\n<pre><code>dfs( root_of_tree );\ngreater_num = greatermap[node]\nlesser_num = lessermap[node]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11895332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8714959ffed9a8b45fb40c4f59e5e1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexx Vladisov", "link": "https://stackoverflow.com/users/11895332/alexx-vladisov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1565226072, "creation_date": 1565175947, "last_edit_date": 1565198041, "question_id": 57392985, "link": "https://stackoverflow.com/questions/57392985/no-of-nodes-in-which-nodes-are-smaller-and-greater-than-the-certain-node", "title": "No of Nodes in which nodes are smaller and greater than the certain node", "body": "<p>Given a tree, count for each vertex number of nodes which are greater and number of nodes which are smaller than the vertex in its subtree.</p>\n\n<p>I can find the answer for a single vertex by doing a depth-first search (DFS) but doing it for every vertex will definitely take a lot of time.</p>\n\n<p>Can we get a faster solution for the problem?</p>\n"}, {"tags": ["c++", "c", "gcc", "compiler-optimization", "bit-fields"], "comments": [{"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1565175780, "post_id": 57392896, "comment_id": 101267608, "body": "Nothing prevents the <code>value</code> from changing even without reordering."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1565175855, "post_id": 57392896, "comment_id": 101267657, "body": "The short answer is: no there isn&#39;t."}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1565175865, "post_id": 57392896, "comment_id": 101267665, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1490092/c-c-force-bit-field-order-and-alignment\">C/C++: Force Bit Field Order and Alignment</a>"}, {"owner": {"reputation": 70, "user_id": 9209569, "user_type": "registered", "profile_image": "https://graph.facebook.com/1716064065122497/picture?type=large", "display_name": "Cactus&#39;as", "link": "https://stackoverflow.com/users/9209569/cactusas"}, "edited": false, "score": 1, "creation_date": 1565176008, "post_id": 57392896, "comment_id": 101267721, "body": "Yeah, it is not possible. But if you always use 32bit platforms with the same endianess, bit order should not change. I found a good article about bitfields <a href=\"http://jkz.wtf/bit-field-packing-in-gcc-and-clang\" rel=\"nofollow noreferrer\">jkz.wtf/bit-field-packing-in-gcc-and-clang</a>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 5, "creation_date": 1565176013, "post_id": 57392896, "comment_id": 101267727, "body": "If you need to force the exact order and arrangement of bits, bitfields are not the right tool for the job.  You can spend time tinkering, and you can try using various compiler extensions, but in the end you&#39;ll still be unsure and without guarantees, and it will be (in my opinion) way more trouble than it&#39;s worth. Instead, if you need to force the exact order and arrangement of bits, just bite the bullet and use <code>unsigned int</code> along with some explicit masking and shifting techniques.  Bitfields are enticing, but then, so is <a href=\"https://en.wikipedia.org/wiki/Fool&#39;s_gold\" rel=\"nofollow noreferrer\">pyrite</a>."}, {"owner": {"reputation": 1817, "user_id": 4030665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4030665/dan"}, "reply_to_user": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1565176178, "post_id": 57392896, "comment_id": 101267830, "body": "@DanM. That question doesn&#39;t speak about <code>union</code>, that is the specific case I&#39;m concerned about. Maybe that can be inferred from that question, but I would like a clear and direct answer for this particular case so I&#39;m sure that I&#39;m not deducing the wrong stuff."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1565176470, "post_id": 57392896, "comment_id": 101268000, "body": "Be aware that C and C++ differ in allowing type punning via unions: C does allow it, in C++ it is undefined behaviour!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1565178334, "post_id": 57392896, "comment_id": 101269103, "body": "Just don&#39;t use bitfields and all the head ache will go away. They are superfluous and dangerous, with no benefits."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 1, "creation_date": 1565178417, "post_id": 57392896, "comment_id": 101269140, "body": "@Dan The containing <code>union</code> does not have any effect on the order of the bitfields in the contained <code>struct</code>. The direction in which bitfields are allocated within their underlying storage units (<code>uint32_t</code> in your case) is implementation defined."}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1565280606, "post_id": 57392896, "comment_id": 101313328, "body": "Do you actually know a compiler that &quot;reorders&quot; the bitfields, even without pack/volatile/whatever?"}], "answers": [{"comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1565176454, "post_id": 57393071, "comment_id": 101267990, "body": "<code>can&#39;t declare a union as volatile</code> - what do you mean by that? A variable that has the type union can be volatile. A typedef can be an union and volatile. I think you will be surprised that you can include <code>volatile</code> and ex. <code>const</code> in a typedef, like <code>typedef union { int a; } volatile MyUnion;</code>."}, {"owner": {"reputation": 1817, "user_id": 4030665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4030665/dan"}, "edited": false, "score": 0, "creation_date": 1565177507, "post_id": 57393071, "comment_id": 101268607, "body": "Yes, you are right, a type declaration (in this case <code>union</code>) cannot be volatile of course. But I meant variables of type <code>MyUnion</code> (I wrote it wrong), not the <code>union</code> itself. Now it&#39;s fixed."}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1565177951, "post_id": 57393071, "comment_id": 101268881, "body": "Unions can be declared volatile. <code>typedef union foo { int x; float y; } Foo; typedef volatile Foo VolatileFoo;</code> is valid C code that defines <code>VolatileFoo</code> to be a type that is a volatile union. Furthermore, after these statements, <code>Foo Convert(VolatileFoo *x) { return x; }</code> yields a compiler message that types are incompatible, showing the compiler knows that <code>x</code> points to a volatile union, not just a union, thus demonstrating that <code>volatile</code> is a part of the type <code>VolatileFoo</code>."}], "tags": [], "owner": {"reputation": 1726, "user_id": 1414496, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c75b36035fb412c9f2629a888bfb977e?s=128&d=identicon&r=PG", "display_name": "Joel Bodenmann", "link": "https://stackoverflow.com/users/1414496/joel-bodenmann"}, "is_accepted": true, "score": 4, "last_activity_date": 1565176258, "creation_date": 1565176258, "answer_id": 57393071, "question_id": 57392896, "link": "https://stackoverflow.com/questions/57392896/prevent-gcc-from-reordering-bitfields-in-unions-of-structs/57393071#57393071", "title": "Prevent GCC from reordering bitfields in unions of structs", "body": "<p>I think the overall \"No\" answer has already been given in the comments. With this answer I'd like to address your question about <code>volatile</code>:</p>\n\n<blockquote>\n  <p>Would declaring <code>MyUnion</code> as <code>volatile</code> achieve this?</p>\n</blockquote>\n\n<p>The <code>volatile</code> keyword will not change anything in behavior that you're looking for here. Also, you can't declare a union as <code>volatile</code>. It's a keyword that's a qualifier for a variable declaration. It tells the compiler that the variable value can change at any time and that therefore the value should always be re-loaded (as in re-read from memory) instead of assuming the value based on previous statements that the compiler saw.\nThis is used for when a variable value can change by external factors such as when declaring variables that are linked to real, physical values such as registers in a microcontroller.</p>\n"}], "owner": {"reputation": 1817, "user_id": 4030665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4030665/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 57393071, "answer_count": 1, "score": 2, "last_activity_date": 1565177413, "creation_date": 1565175660, "last_edit_date": 1565177413, "question_id": 57392896, "link": "https://stackoverflow.com/questions/57392896/prevent-gcc-from-reordering-bitfields-in-unions-of-structs", "title": "Prevent GCC from reordering bitfields in unions of structs", "body": "<p>Having a piece of code like the following:</p>\n\n<pre><code>typedef union\n{\n    struct bits\n    {\n        uint32_t bit0 : 1;\n        uint32_t bit1 : 1;\n        uint32_t bit2 : 1;\n        ...\n        ...\n        uint32_t bit14 : 1;\n    }\n\n    uint32_t value;\n\n} MyUnion;\n</code></pre>\n\n<p>It's important to prevent the compiler from reordering the bitfields since, otherwise, the value of <code>value</code> will change depending on the platform and, possibly, even the size of the compiled binary.</p>\n\n<p><strong>Is there any way to tell the compiler \"do not re-order this fields\"?</strong></p>\n\n<p><strong>Would declaring variables of type <code>MyUnion</code> as <code>volatile</code> achieve this?</strong></p>\n\n<p>If the <code>union</code> is <code>packed</code> and <code>aligned(4)</code>, <strong>is it possible to assure that the bitfields won't be reordered, if you are 100% sure that you will be always working with 32 bits platforms, with the same endianness?</strong></p>\n\n<h2>EDIT</h2>\n\n<p>Can the above be done for only one specific compiler? That is, if being compatible across different compilers is not necessary.</p>\n"}, {"tags": ["c#", "python", "c++", "sockets", "thrift"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1565180818, "post_id": 57392770, "comment_id": 101270443, "body": "Why are you using AddressList[1] and not zero?  When you are on the same machine always make sure your server is listening on IP.Any and the client connects to the machine name (or IP). The refused 127.0.0.1 (loopback address) can occur for a number of different reasons.In general you get it when the client connection does not complete.The machine has a host file (in the c:\\windows folder) that can be configured differently so where code will work on some machines on other the hosts file is different and can fail.The Net library gives the refuse error when a client tries to connect to loopback"}, {"owner": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1565181223, "post_id": 57392770, "comment_id": 101270690, "body": "@jdweng I tried with the same result. AddressList[0] return IPv6 address"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 0, "creation_date": 1565610942, "post_id": 57395276, "comment_id": 101394717, "body": "Conclusion, In case of C# thrift client, socket should be initialized only outside of Thrift client. Thankfully, Thrift client interface enables that."}, {"owner": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 0, "creation_date": 1565701082, "post_id": 57395276, "comment_id": 101428154, "body": "the same client code stopped to work. Again, just client C# --&gt; server Python is not working. Looks like the something is missing during initialization. Is there a way to diagnose it?"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "reply_to_user": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 0, "creation_date": 1565702515, "post_id": 57395276, "comment_id": 101428921, "body": "You can use a sniffer like wireshark or fiddler to capture the TCP messages.  Pythone if you are getting an exception you can add break points and look at the python object.  I&#39;ve found useful info in the python object to help debug issues.  For example I found out that my path lengths for files were very large and when I move code from a network drive to c:\\ the  code worked.  You can also add into the python log files debug (net4log) messages to help determine issues or look at the existing log files."}, {"owner": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 0, "creation_date": 1565703805, "post_id": 57395276, "comment_id": 101429686, "body": "Just run Wireshark with filter &quot;loop and tcp.port == 9091&quot;  on working case (C## --&gt; C++) . I expect to see the capture cause it works. Nothing... Do I miss something?"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "reply_to_user": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 0, "creation_date": 1565705279, "post_id": 57395276, "comment_id": 101430620, "body": "I don&#39;t know if the Thrift is using more than one port.   A lot of protocols use multiple ports.  The initial port is a command port and additional ports are then used to transfer data.  It is considered more secure to transfer data on a different port than the command channel.  See following : <a href=\"https://thrift-tutorial.readthedocs.io/en/latest/intro.html\" rel=\"nofollow noreferrer\">thrift-tutorial.readthedocs.io/en/latest/intro.html</a>"}, {"owner": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 0, "creation_date": 1565706547, "post_id": 57395276, "comment_id": 101431471, "body": "In in my case. I debug all user space code in all languages include thrift libraries and know which port is used. I thought maybe &quot;loop and tcp.port == 9091&quot; is wrong expression."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "reply_to_user": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 0, "creation_date": 1565708157, "post_id": 57395276, "comment_id": 101432361, "body": "There must be a port 9091 listening since you are not getting a connection error.  You can get a list of all open ports from cmd.exe &gt;Netstat -a  The Transport Network Layer is TCP."}, {"owner": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 0, "creation_date": 1565708952, "post_id": 57395276, "comment_id": 101432859, "body": "@jdwend I see listening ports. It&#39;s there... Again, The same python server gets all connections well from Python and C++ clients"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "reply_to_user": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 0, "creation_date": 1565709409, "post_id": 57395276, "comment_id": 101433094, "body": "What is difference between c# and python?  Are any messages being sent?  does c# connect?"}, {"owner": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 0, "creation_date": 1565709570, "post_id": 57395276, "comment_id": 101433187, "body": "What do you mean &quot;difference between c# and python&quot;?   C# connects to C++ server"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "reply_to_user": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 0, "creation_date": 1565710695, "post_id": 57395276, "comment_id": 101433746, "body": "Ten working and non working.  The title of posting is Python.  So right now I&#39;m not sure how python gets involved.  Nor where the issue is occurring."}, {"owner": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 0, "creation_date": 1565794979, "post_id": 57395276, "comment_id": 101464338, "body": "The problem with a code above was that  <code>Dns.GetHostEntry(Dns.GetHostName());</code> returned list of host IP addresses while python server were listening to &quot;localhost&quot;. Instead, <code>IPAddress ipAddress = System.Net.IPAddress.Parse(&quot;127.0.0.1&quot;);</code> solved the problem of loopback connection."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "reply_to_user": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "edited": false, "score": 1, "creation_date": 1565796825, "post_id": 57395276, "comment_id": 101465384, "body": "I said the client and server cannot be using to same IP. It is better to use IPEndPoint localEP = new IPEndPoint(IPAddress.Any, port) for server. Will work under any condition.  The loopback sometimes is use by client while IP.Any is reserved on a windows machine for the Server.  Loopback was designed so you can test a connection from a remote machine (using ping)."}], "tags": [], "owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "is_accepted": true, "score": 1, "last_activity_date": 1565183420, "creation_date": 1565183420, "answer_id": 57395276, "question_id": 57392770, "link": "https://stackoverflow.com/questions/57392770/can-not-connect-thrift-c-client-to-python-server/57395276#57395276", "title": "Can not connect thrift c# client to python server", "body": "<p>You have too much duplicate code.  Try following :</p>\n\n<pre><code>            //client\n            IPHostEntry ipHostInfo = Dns.GetHostEntry(Dns.GetHostName());\n            IPAddress ipAddress = ipHostInfo.AddressList[1];\n            IPEndPoint remoteEP = new IPEndPoint(ipAddress, port);\n            TcpClient tcpClient = new TcpClient();\n            tcpClient.Connect(remoteEP);\n\n            //Server\n            IPEndPoint localEP = new IPEndPoint(IPAddress.Any, port);\n            TcpListener listener = new TcpListener(localEP);\n            listener.Start();\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 1439579, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055d5ac7ef73c6098485b2269600fdcf?s=128&d=identicon&r=PG", "display_name": "user1439579", "link": "https://stackoverflow.com/users/1439579/user1439579"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 57395276, "answer_count": 1, "score": 0, "last_activity_date": 1565183420, "creation_date": 1565175230, "last_edit_date": 1565176259, "question_id": 57392770, "link": "https://stackoverflow.com/questions/57392770/can-not-connect-thrift-c-client-to-python-server", "title": "Can not connect thrift c# client to python server", "body": "<p>I have Thrift client-server application C# client and Python server. All in the same machine-Windows7. Debugging into the Thrift code I saw the client's socket cannot connect to the server's local server. <br/>BTW, The same C# client connects to C+ server and python and c++ clients connect to the same python server. Just C#-->Python combination fails.</p>\n\n<p>The problem looks similar to <a href=\"https://stackoverflow.com/questions/42680413/connecting-python-socketserver-with-c-sharp-client\">Connecting Python SocketServer with C# Client</a>. I tried to modify the code following the answer in the link above but still, C# socket throws \"No connection could be made because the target machine actively refused it 127.0.0.1:9091\"<br/><br/></p>\n\n<p><br/> <em>Client(C#):</em><br/></p>\n\n<pre><code>   IPHostEntry ipHostInfo = Dns.GetHostEntry(Dns.GetHostName());\n   IPAddress ipAddress = ipHostInfo.AddressList[1];\n   IPEndPoint remoteEP = new IPEndPoint(ipAddress, port);\n   Socket client = new Socket(ipAddress.AddressFamily,SocketType.Stream, \n   ProtocolType.Tcp);\n   TcpClient tcpClient = new TcpClient(AddressFamily.InterNetwork);\n   tcpClient.Client = client;\n   tcpClient.Connect(ip, port);\n</code></pre>\n\n<p>Why <code>ipHostInfo.AddressList[1]</code>? This selection takes IPv4 adapter from \n   ipconfig. I tries other indices as well. <br/><br/> <em>Server(Python, Inside \n   to Thrift-sever library):</em><br/></p>\n\n<pre><code>res0 = socket.getaddrinfo(self.host,\n                                          self.port,\n                                          self._socket_family,\n                                          socket.SOCK_STREAM,\n                                          0,\n                                          socket.AI_PASSIVE | \n    socket.AI_ADDRCONFIG)\n    ...\n    self.handle = socket.socket(res[0], res[1])\n    self.handle.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n    if hasattr(self.handle, 'settimeout'):\n     self.handle.settimeout(None)\n    self.handle.bind(res[4])\n    self.handle.listen(self._backlog)\n    client, addr = self.handle.accept()\n</code></pre>\n\n<p><br/> It never exits from <code>accept</code> in case of C# client</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 3, "creation_date": 1565175005, "post_id": 57392663, "comment_id": 101267169, "body": "I have not understood the question.:)"}, {"owner": {"reputation": 1, "user_id": 10241647, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nmxSePaJ23w/AAAAAAAAAAI/AAAAAAAAB7k/QKm49-_5TcE/photo.jpg?sz=128", "display_name": "Auditya Prratapa", "link": "https://stackoverflow.com/users/10241647/auditya-prratapa"}, "reply_to_user": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1565175814, "post_id": 57392663, "comment_id": 101267632, "body": "Ok this is the question: Find the number of ways that a given integer, can be expressed as the sum of the powers of unique, natural numbers"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1565176470, "post_id": 57392663, "comment_id": 101267999, "body": "What is <b>your</b> question?"}, {"owner": {"reputation": 1, "user_id": 10241647, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nmxSePaJ23w/AAAAAAAAAAI/AAAAAAAAB7k/QKm49-_5TcE/photo.jpg?sz=128", "display_name": "Auditya Prratapa", "link": "https://stackoverflow.com/users/10241647/auditya-prratapa"}, "edited": false, "score": 0, "creation_date": 1565176623, "post_id": 57392663, "comment_id": 101268084, "body": "<a href=\"https://www.hackerrank.com/challenges/the-power-sum/problem\" rel=\"nofollow noreferrer\">hackerrank.com/challenges/the-power-sum/problem</a> this is the question link"}, {"owner": {"reputation": 1, "user_id": 10241647, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nmxSePaJ23w/AAAAAAAAAAI/AAAAAAAAB7k/QKm49-_5TcE/photo.jpg?sz=128", "display_name": "Auditya Prratapa", "link": "https://stackoverflow.com/users/10241647/auditya-prratapa"}, "edited": false, "score": 0, "creation_date": 1565176912, "post_id": 57392663, "comment_id": 101268252, "body": "My question was why we haven&#39;t used c++ inbuilt pow function to calculate power, but thanks it is clear now."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10241647, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nmxSePaJ23w/AAAAAAAAAAI/AAAAAAAAB7k/QKm49-_5TcE/photo.jpg?sz=128", "display_name": "Auditya Prratapa", "link": "https://stackoverflow.com/users/10241647/auditya-prratapa"}, "edited": false, "score": 0, "creation_date": 1565175647, "post_id": 57392708, "comment_id": 101267515, "body": "Thanks @Bathsheba as u have said its called exponentiation of squaring I have seen its documentation but it has a different formula other than my code like in my code line7 according to the documentation it should be  int temp = power(a**2, n / 2); similarly in the odd one there is some difference"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 1, "user_id": 10241647, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nmxSePaJ23w/AAAAAAAAAAI/AAAAAAAAB7k/QKm49-_5TcE/photo.jpg?sz=128", "display_name": "Auditya Prratapa", "link": "https://stackoverflow.com/users/10241647/auditya-prratapa"}, "edited": false, "score": 0, "creation_date": 1565175719, "post_id": 57392708, "comment_id": 101267564, "body": "It will be sufficiently equivalent. There are various ways of skinning the &quot;exponentation by squaring&quot; cat."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 1, "user_id": 10241647, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nmxSePaJ23w/AAAAAAAAAAI/AAAAAAAAB7k/QKm49-_5TcE/photo.jpg?sz=128", "display_name": "Auditya Prratapa", "link": "https://stackoverflow.com/users/10241647/auditya-prratapa"}, "edited": false, "score": 0, "creation_date": 1565176583, "post_id": 57392708, "comment_id": 101268058, "body": "@AudityaPrratapa The same algorithm can be coded in many different ways. &quot;It&#39;s not exactly the same&quot; doesn&#39;t mean &quot;it&#39;s wrong&quot;."}, {"owner": {"reputation": 1, "user_id": 10241647, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nmxSePaJ23w/AAAAAAAAAAI/AAAAAAAAB7k/QKm49-_5TcE/photo.jpg?sz=128", "display_name": "Auditya Prratapa", "link": "https://stackoverflow.com/users/10241647/auditya-prratapa"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1565176990, "post_id": 57392708, "comment_id": 101268294, "body": "Yes got it @MaxLanghof thanks"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1565175458, "last_edit_date": 1565175458, "creation_date": 1565175030, "answer_id": 57392708, "question_id": 57392663, "link": "https://stackoverflow.com/questions/57392663/why-doesnt-this-code-use-the-c-power-function-directly-can-someone-help-me-w/57392708#57392708", "title": "Why doesn&#39;t this code use the C++ power function directly? Can someone help me with the power function in this code?", "body": "<p>This function uses a technique called <em>exponentation by squaring</em>.</p>\n\n<p>It's a particularly efficient way of evaluating the power for integral type arguments. The standard C function uses floating point arguments, and the C standard doesn't require an exact result even if the floating point arguments represent whole numbers.</p>\n\n<p>In C++ though you can <em>probably</em> rely on one of the overloads of <code>std::pow</code> that takes integral type arguments, and cast the result, subject to your making the necessary size checks. <strong>But</strong> again even the C++ standard does <strong>not</strong> require that the best possible result is returned (cf. <code>std::sqrt</code> under IEEE754), although one could reasonably regard a <code>std::pow</code> function that does not return the correct result for integral arguments to be defective.</p>\n"}], "owner": {"reputation": 1, "user_id": 10241647, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nmxSePaJ23w/AAAAAAAAAAI/AAAAAAAAB7k/QKm49-_5TcE/photo.jpg?sz=128", "display_name": "Auditya Prratapa", "link": "https://stackoverflow.com/users/10241647/auditya-prratapa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1565177331, "answer_count": 1, "score": -9, "last_activity_date": 1565181944, "creation_date": 1565174907, "last_edit_date": 1565181944, "question_id": 57392663, "link": "https://stackoverflow.com/questions/57392663/why-doesnt-this-code-use-the-c-power-function-directly-can-someone-help-me-w", "closed_reason": "Needs details or clarity", "title": "Why doesn&#39;t this code use the C++ power function directly? Can someone help me with the power function in this code?", "body": "<p>This problem is to output a single integer, the number of possible combinations calculated:</p>\n\n<pre><code>int power(int a, int n)\n{\n  if (n == 0)\n    return 1;\n  // else\n  if (n % 2 == 0) {\n    int temp = power(a, n / 2);\n    return temp * temp;\n  }\n  // else\n  return a * power(a, n - 1);\n}\n</code></pre>\n"}, {"tags": ["c++", "set"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 2, "creation_date": 1565174514, "post_id": 57392512, "comment_id": 101266933, "body": "You only implemented the destructor as far as we can tell. Where is your implementation of copy constructor and copy assignment operator you mentioned?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1565174742, "post_id": 57392512, "comment_id": 101267038, "body": "<code>friend const Set operator +</code> -- This (and the <code>operator *</code>) will not work correctly until you implement working, non-buggy, copy constructor, assignment operator, and destructor.   You&#39;re returning a <code>Set</code> by value, thus the type must have correct copy semantics."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1565175077, "post_id": 57392512, "comment_id": 101267213, "body": "Also, why are you doing this: <code>s.~Set();</code>?  Do not call the destructor directly."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565175260, "post_id": 57392512, "comment_id": 101267319, "body": "And turn on more warnings. The compiler will give you a lot of hints for this code."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1565175276, "post_id": 57392512, "comment_id": 101267325, "body": "O.T.: <code>Set() { list = nullptr;}  &#47;&#47; constructs the empty Set</code> is construction with assignment of member <code>list</code>. Construction with member construction would be <code>Set(): list(nullptr) { }</code>. It&#39;s more idiomatic and that for a reason: For more complex member types, your style would result in member with default construction and assign while mine is member construction only."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1565175638, "post_id": 57392512, "comment_id": 101267510, "body": "O.T.: <code>bool Set::isEmpty() const { if (list == nullptr) return true; else return false; }</code> can be abbreviated to <code>bool Set::isEmpty() const { return list == nullptr; }</code>. The <code>operator==()</code> already returns a <code>bool</code> which you can return directly - no need for the extra <code>if</code>."}, {"owner": {"reputation": 17, "user_id": 10146700, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-K0bTvRdeqtQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7orq4jsMubrwFKwbf0iSFeQl0l8iQ/mo/photo.jpg?sz=128", "display_name": "Keric Ma", "link": "https://stackoverflow.com/users/10146700/keric-ma"}, "edited": false, "score": 0, "creation_date": 1565175967, "post_id": 57392512, "comment_id": 101267704, "body": "i have just implement the copy constructor and the assignment operator. Did I implement them correctly?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1565176215, "post_id": 57392512, "comment_id": 101267858, "body": "Your copy constructor should have signature <code>Set(const Set&amp;)</code>. The assignment as well <code>Set&amp; operator=(const Set&amp;)</code>. What you did will not be recognized as copy constructor..."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 1, "creation_date": 1565176499, "post_id": 57392512, "comment_id": 101268015, "body": "<code>Set(const vector&amp; a);</code> is not a copy constructor. It&#39;s just a regular constructor, which takes an argument. Perhaps you should revisit lesson about copy constructors and the Rule of Three?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1565176611, "post_id": 57392512, "comment_id": 101268075, "body": "<a href=\"http://coliru.stacked-crooked.com/a/7f601288d9d3dfa2\" rel=\"nofollow noreferrer\"><b>Live Demo on coliru</b></a>. As you can see, copying works although no proper copy constructor defined. That&#39;s because the compiler adds one but this is the one which won&#39;t work properly in your case (as well as mine)."}, {"owner": {"reputation": 2310, "user_id": 9185253, "user_type": "registered", "profile_image": "https://graph.facebook.com/114451586026362/picture?type=large", "display_name": "Maestro", "link": "https://stackoverflow.com/users/9185253/maestro"}, "edited": false, "score": 0, "creation_date": 1565177090, "post_id": 57392512, "comment_id": 101268360, "body": "Maybe in your cpy-ctor and assignment operator implementation you&#39;ve member-wise copy rather than deep-copy."}], "answers": [{"comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565177878, "post_id": 57393355, "comment_id": 101268839, "body": "You forgot to clear out the current values held by <code>this</code>. This just adds more values."}, {"owner": {"reputation": 360, "user_id": 11230708, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BrvtstToXLU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfAcSpGqNZXmWCJF-O_BCHTj5JbzQ/mo/photo.jpg?sz=128", "display_name": "Rajkumar Ananthu", "link": "https://stackoverflow.com/users/11230708/rajkumar-ananthu"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1565178697, "post_id": 57393355, "comment_id": 101269280, "body": "Yeah, good catch @Ted Lyngmo. We can add one more member function to clear all the elements in the set and deallocate the memory. And call that function here so that it&#39;ll not cause any other problem."}], "tags": [], "owner": {"reputation": 360, "user_id": 11230708, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BrvtstToXLU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfAcSpGqNZXmWCJF-O_BCHTj5JbzQ/mo/photo.jpg?sz=128", "display_name": "Rajkumar Ananthu", "link": "https://stackoverflow.com/users/11230708/rajkumar-ananthu"}, "is_accepted": false, "score": 0, "last_activity_date": 1565177177, "creation_date": 1565177177, "answer_id": 57393355, "question_id": 57392512, "link": "https://stackoverflow.com/questions/57392512/big-three-implementation-in-a-set-class/57393355#57393355", "title": "Big three implementation in a set class", "body": "<p>The issue here is with the assignment</p>\n\n<pre><code>Set a = s + t\n</code></pre>\n\n<p>In the class definition of Set there is no overloaded assignment \"=\" operator. You can define a member function like <code>Set&amp; operator=(const Set&amp; rhs_set);</code> and provide the respective definition so that the behavior can be defined. The function can be like this.</p>\n\n<pre><code>Set&amp; operator=(const Set &amp;a) {\n    Node* temp = a.list;\n    while (temp != nullptr) {\n        insert (temp-&gt;value);\n        temp = temp-&gt;next;\n\n    }\n    return *this;\n}\n</code></pre>\n\n<p>I have tried this with some little tweaks in your code.</p>\n\n<p>Hope this helps, Thanks</p>\n"}, {"tags": [], "owner": {"reputation": 2310, "user_id": 9185253, "user_type": "registered", "profile_image": "https://graph.facebook.com/114451586026362/picture?type=large", "display_name": "Maestro", "link": "https://stackoverflow.com/users/9185253/maestro"}, "is_accepted": false, "score": 1, "last_activity_date": 1565179190, "last_edit_date": 1565179190, "creation_date": 1565177531, "answer_id": 57393454, "question_id": 57392512, "link": "https://stackoverflow.com/questions/57392512/big-three-implementation-in-a-set-class/57393454#57393454", "title": "Big three implementation in a set class", "body": "<p>The problem is apparent: you are overloading the copy constructor while maybe you meant implementing copy-constructor and assignment operator:</p>\n\n<pre><code>Set(const vector&amp; a); // constructor that take a const reference to std::vector. not a copy constructor.\noperator = (const vector&amp; a); // should be Set(const Set&amp;);\n</code></pre>\n\n<p>so as long as you've not provided copy constructor and assignment operator then the compiler will synthesize them for you. So by default they do <code>a shallow copy</code> or <code>member-wise copy</code> not a <code>deep copy</code>. </p>\n\n<p>So in your example you are not acquiring rule of three.</p>\n\n<ul>\n<li><p>The interface may look like:</p>\n\n<pre><code>class Set{\n    public:\n        Set(); // default constructor\n        Set(const Set&amp;); // copy constructor\n        Set&amp; operator=(const Set&amp;); // assignemnt operator\n        ~Set();// destructor\n\n};\n</code></pre></li>\n<li><p>Also <code>std::vector</code> is a template class container thus you should specify the element type otherwise it is compile-time error.</p></li>\n<li><p>Also the assignment operator must return value so you cannot declare it without return type.</p></li>\n<li><p>What is the point in creating a local <code>Node</code> in copy constructor: </p>\n\n<pre><code>Set::Set(const Set&amp; a) {\n    Set s; // local\n    Node*temp = a.list;\n    while (a.list != nullptr) {\n        s.insert(temp-&gt;value);\n        temp = temp-&gt;next;\n    }\n    // s is destructed here\n}\n</code></pre></li>\n<li><p>You should not call the destructor explicitly because in main you do so:</p>\n\n<pre><code>    s.~Set();// call dtor explicitly\n</code></pre></li>\n</ul>\n\n<p>Because after <code>s</code> gets out of scope its <code>dtor</code> is called automatically thus calling destructor twice may cause an undefined behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1565178290, "creation_date": 1565178290, "answer_id": 57393698, "question_id": 57392512, "link": "https://stackoverflow.com/questions/57392512/big-three-implementation-in-a-set-class/57393698#57393698", "title": "Big three implementation in a set class", "body": "<p>I don't think this has been pointed out yet, but your copy constructor is wrong. In this code</p>\n\n<pre><code>Set::Set (const Set&amp; a){\n    Set s;\n    Node*temp = a.list;\n    while(a.list != nullptr){\n        s.insert(temp-&gt;value);\n        temp = temp-&gt;next;\n    }\n}\n</code></pre>\n\n<p>you are copying from <code>a</code> to <code>s</code>. Obviously that not what you should do, <code>s</code> is just some local variable that's going to get destroyed when the copy constructor exits. You should copy from <code>a</code> to <code>*this</code>. Like this</p>\n\n<pre><code>Set::Set(const Set&amp; a) {\n    Node* temp = a.list;\n    while (a.list != nullptr) {\n        insert(temp-&gt;value);\n        temp = temp-&gt;next;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10146700, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-K0bTvRdeqtQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7orq4jsMubrwFKwbf0iSFeQl0l8iQ/mo/photo.jpg?sz=128", "display_name": "Keric Ma", "link": "https://stackoverflow.com/users/10146700/keric-ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1565179612, "creation_date": 1565174385, "last_edit_date": 1565179612, "question_id": 57392512, "link": "https://stackoverflow.com/questions/57392512/big-three-implementation-in-a-set-class", "title": "Big three implementation in a set class", "body": "<p>I am a first year computer science student, and in my assignment i was asked to implement a set class with some basic functions. However it doesn't run properly when i tried to implement the Big three: destructor; copy constructor; copy assignment operator. hope someone can help.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nstruct Node {\n    int value;          \n    Node *next;      \n};\n\nclass Set {\npublic:\n    Set() { list = nullptr;}  // constructs the empty Set\n    bool isEmpty() const;     // returns true if the Set is empty, false otherwise         \n    int size() const;         // returns the number of elements in the Set\n    bool member(int x) const; // returns true if x is in the Set, false otherwise\n    void insert(int x);       // insert x into the Set in ascending order                                   \n    // (if x is already in the Set, insert does nothing)\n    void remove(int x);       // delete x from the Set                                    \n    // (if x is not in the Set, remove does nothing)          \n    // the Set, print out like this { 2 5 7 }         \n    // returns the union of a and b\n    friend ostream &amp; operator &lt;&lt;(ostream &amp;out, const Set&amp; a);\n    friend const Set operator +(const Set &amp; a, const Set &amp; b);          // returns the intersection of a and b          \n    friend const Set operator *(const Set &amp; a, const Set &amp; b);          // if we create Sets s = {2, 5, 7} and t = {3, 5}          \n    // then s + t = {2, 3, 5, 7} and s * t = { 5 }\n    Set(const Set &amp;a);\n    Set&amp; operator = (const Set &amp;a);     \n    ~Set();\nprivate:         \n    // The linked list is sorted in ascending order so that the Set          \n    // operations union and intersect can be done in linear time using merging.          \n    // The insert operation needs to insert x in order but if x is already there,          \n    // do not insert it. So the list is always sorted and never has duplicates.         \n    Node* list; \n};\nbool Set::isEmpty() const{\n    if(list == nullptr)\n        return true;\n    else\n        return false;\n}\n\nint Set::size() const{\n    Node* temp = list;\n    int x = 0;\n    while(temp != nullptr){\n        temp = temp-&gt;next;\n        x++;\n    }\n    return x;\n}\n\nbool Set::member(int x) const{\n    Node* temp = list;\n    if(temp == nullptr) return false;\n    while(temp != nullptr){\n        if(temp-&gt;value == x) return true;\n        temp = temp-&gt;next;\n    }\n    return false;\n}\n\nvoid Set::insert(int x){\n    Node* temp;\n    Node* previous; \n\n    //create new node\n    Node* newNode = new Node; \n    newNode -&gt; value = x;\n    newNode -&gt; next = nullptr;    \n    if(!member(x)){\n        //checking whether the node created is only node or not\n        if (list == nullptr) {       \n            list = newNode;\n        } \n        //If value is less than the value of first node\n        else if(x &lt; list-&gt;value) {\n            newNode -&gt; next = list;\n            list = newNode;\n        } \n        else {   \n            previous = list;\n            temp = list -&gt; next;\n\n\n            //Go to the position where node is to be inserted\n            while(temp != nullptr &amp;&amp; x &gt; temp -&gt; value) {\n                previous = temp;\n                temp = temp -&gt; next;\n            }\n            //Insert the node at particular position\n            if(temp == nullptr) {\n                previous -&gt; next = newNode;\n            } \n            else {\n                newNode -&gt; next = temp;\n                previous -&gt; next = newNode;\n            }\n        }\n    }\n}\n\nostream&amp; operator &lt;&lt; (ostream&amp;out, const Set&amp; a){\n    const Node* b = a.list;\n    out &lt;&lt; \"{ \";\n    while(b != nullptr){\n        out &lt;&lt; b-&gt;value &lt;&lt; \" \";\n        b = b-&gt;next;\n    }\n    out &lt;&lt; \"}\" &lt;&lt; endl;\n    return out;\n}\n\nvoid Set::remove(int x){\n    if(member(x)){\n        if(list == nullptr){\n            return;\n        }\n        else if(list-&gt;value == x){\n            Node* current = list;\n            list = list-&gt;next;\n            delete current;\n        }else{\n            Node* previous = list;\n            Node* current = list-&gt;next;\n            while(current != nullptr) {\n                if(current-&gt;value == x) {\n                    break;\n                }\n                else {\n                    previous = current;\n                    current = current-&gt;next;\n                }\n            }\n            previous-&gt;next = current-&gt;next;\n            delete current;\n        }\n    }\n}\n\nconst Set operator +(const Set &amp; a, const Set &amp; b){\n    Node* temp1 = a.list;\n    Node* temp2 = b.list;\n    if(a.list == nullptr) return b;\n    if(b.list == nullptr) return a;\n    Set c;\n    while(temp1 != nullptr &amp;&amp; temp2 != nullptr){\n        if(temp1-&gt;value == temp2-&gt;value){\n            c.insert(temp1-&gt;value);\n            temp1 = temp1-&gt;next;\n            temp2 = temp2-&gt;next;\n        }\n        else if(temp1-&gt;value &lt; temp2-&gt;value){\n            c.insert(temp1-&gt;value);\n            temp1 = temp1-&gt;next;\n        }\n        else{\n            c.insert(temp2-&gt;value);\n            temp2 = temp2-&gt;next;\n        }\n    }\n    while(temp1 != nullptr){\n        c.insert(temp1-&gt;value);\n        temp1 = temp1-&gt;next;\n    }\n    while(temp2 != nullptr){\n        c.insert(temp2-&gt;value);\n        temp2 = temp2-&gt;next;\n    }\n    return c;\n}\nSet::Set (const Set&amp; a){\n    Set s;\n    Node*temp = a.list;\n    while(a.list != nullptr){\n        s.insert(temp-&gt;value);\n        temp = temp-&gt;next;\n    }\n}\nSet&amp; Set::operator = (const Set&amp; a){\n    Set s;\n    Node*temp = a.list;\n    while(a.list != nullptr){\n        s.insert(temp-&gt;value);\n        temp = temp-&gt;next;\n    }\n    return* this;\n}\nSet::~Set(){\n    Node* curr = list;\n    while (list){\n        list = list-&gt;next;\n        delete curr;\n        curr = list;\n    }\n}\n\nconst Set operator *(const Set &amp; a, const Set &amp; b){\n    Node* temp1 = a.list;\n    Node* temp2 = b.list;\n    Set c;\n    if(a.list == nullptr) return c;\n    if(b.list == nullptr) return c;\n    while(temp1 != nullptr &amp;&amp; temp2 != nullptr){\n        if(temp1-&gt;value == temp2-&gt;value){\n            c.insert(temp1-&gt;value);\n            temp1 = temp1-&gt;next;\n            temp2 = temp2-&gt;next;\n        }\n        else if(temp1-&gt;value &lt; temp2-&gt;value){\n            temp1 = temp1-&gt;next;\n        }\n        else{\n            temp2 = temp2-&gt;next;\n        }\n    }\n\n    return c;\n}\n\n\nint main() {      \n    Set s, t;     \n    cout &lt;&lt; \"empty set: \" &lt;&lt; s &lt;&lt; \"\\n\";     \n    cout &lt;&lt; \"\\texpecting: { }\\n\";\n    cout &lt;&lt; \"|s|=\" &lt;&lt; s.size()&lt;&lt; \"\\n\";     \n    cout &lt;&lt; \"\\texpecting:|s|= 0\\n\";     \n    s.insert(3);s.insert(1);s.insert(9);s.insert(3);s.insert(7); s.insert(5);     \n    cout &lt;&lt; \"s = \" &lt;&lt; s &lt;&lt; \"\\n\";      \n    cout &lt;&lt; \"\\texpecting: s = { 1 3 5 7 9 }\\n\";     \n    if (!s.member(2))\n        cout &lt;&lt; \"2 is not in the set s as expected\\n\";     \n    else        \n        cout &lt;&lt; \"ERROR: 2 is in the set s\\n\";     \n    if (s.member(7))\n        cout &lt;&lt; \"7 is in the set s as expected\\n\";\n    else\n        cout &lt;&lt; \"ERROR: 7 is NOT in the set s\\n\";\n    cout &lt;&lt; \"|s|=\" &lt;&lt; s.size()&lt;&lt; \"\\n\";\n    cout &lt;&lt; \"\\texpecting:|s|= 5\\n\";\n\n    s.remove(7); s.remove(1); s.remove(9); s.remove(10);\n    cout &lt;&lt; \"\\nafter the removals: s = \" &lt;&lt; s &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"\\texpecting: s = { 3 5 }\\n\";\n    s.insert(1); s.insert(7); s.insert(3);\n    cout &lt;&lt; \"with insertions: s = \" &lt;&lt; s &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"\\texpecting: s = { 1 3 5 7 }\\n\";\n    t.insert(3); t.insert(5); t.insert(4);\n    cout &lt;&lt; \"with insertions: t = \"&lt;&lt; t &lt;&lt; \"\\n\";\n    Set a = s + t;\n    cout &lt;&lt; \"s union t = \" &lt;&lt; a &lt;&lt; \"\\n\";\n    s.remove(3); t.remove(4);\n    cout &lt;&lt; \"remove 3: s = \" &lt;&lt; s &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"remove 4: t = \" &lt;&lt; t &lt;&lt; \"\\n\";\n    s.insert(3); t.insert(4);\n    cout &lt;&lt; \"insert 3: s = \" &lt;&lt; s &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"insert 4: t = \" &lt;&lt; t &lt;&lt; \"\\n\";\n    Set b = s * t;\n    cout &lt;&lt; \"s intersect t = \" &lt;&lt; b &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"s = \" &lt;&lt; s &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"t = \" &lt;&lt; t &lt;&lt; \"\\n\";\n\n    s.~Set();\n    cout &lt;&lt; \"s = \" &lt;&lt; s &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"\\texpecting: s = { }\\n\";\n    return 0; \n\n}\n</code></pre>\n\n<p>I expect the output of {1 3 4 5 7} from</p>\n\n<pre><code>Set a = s + t;\ncout &lt;&lt; \"s union t = \" &lt;&lt; a &lt;&lt; \"\\n\";\n</code></pre>\n\n<p>However once i implement the destuctor, it gives one-set of three random number non-stop, as shown below</p>\n\n<p>s union t = { 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080 7107856 7106168 7078080</p>\n"}, {"tags": ["c++", "header-files"], "comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 6, "creation_date": 1565174358, "post_id": 57392464, "comment_id": 101266839, "body": "Please include your code in place, no links to code images. Also, your main() conclusion is very wrong, please start with a good C++ book."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1565174457, "post_id": 57392464, "comment_id": 101266898, "body": "Also include the exact error messages (by copy/pasting them). Don&#39;t put images directly in the question either. Put the actual code in the question by copy/pasting it and using the format <code>{}</code> button. Read this chapter <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1565174518, "post_id": 57392464, "comment_id": 101266934, "body": "My <i>guess</i> is that the location <i>on disk</i> of the other header files is not the same as the &quot;main.cpp&quot; file."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1565174550, "post_id": 57392464, "comment_id": 101266945, "body": "What you&#39;re showing is VS&#39;s &quot;filters&quot; view, which is its own imaginary file system and is not actually used for anything but display. Tick the &quot;Show All Files&quot; button in the Solution Explorer toolbar to see where the files <i>actually</i> are."}, {"owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "edited": false, "score": 1, "creation_date": 1565174560, "post_id": 57392464, "comment_id": 101266952, "body": "An <code>#include</code> puts the content of a file into another file. That is all it does. This is required when some definition is to be known, like a function declaration. You only need to include headers from which you use stuff. If this is news to you, please start with the basic tutorials before you do anything else. As for your question, the include folders need to be specified in the Makefile, or in some sort of project file from which the Makefile is created, like a Qt project file. Maybe state which IDE you are using there. A &quot;project&quot; is not an objective term here, from a technical pov."}], "answers": [{"tags": [], "owner": {"reputation": 574, "user_id": 8894112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/351ad98fc5792fc09c9b18cbdeef7fd6?s=128&d=identicon&r=PG&f=1", "display_name": "Victor Padureanu", "link": "https://stackoverflow.com/users/8894112/victor-padureanu"}, "is_accepted": false, "score": 0, "last_activity_date": 1565175220, "creation_date": 1565175220, "answer_id": 57392768, "question_id": 57392464, "link": "https://stackoverflow.com/questions/57392464/including-header-files-in-c/57392768#57392768", "title": "Including header files in C++", "body": "<p>There are multiple ways to solve this:</p>\n\n<p>1) Easiest: just put the fullpath from disk</p>\n\n<pre><code>#include \"C:\\... \"\n</code></pre>\n\n<p>2) Inside the properties of the project C/C++ -> General -> Additional Include Directories the full path to the folder containing the files</p>\n\n<p>2') You can use macros that specifies the project dir, solution dir ...</p>\n"}, {"comments": [{"owner": {"reputation": 70, "user_id": 9209569, "user_type": "registered", "profile_image": "https://graph.facebook.com/1716064065122497/picture?type=large", "display_name": "Cactus&#39;as", "link": "https://stackoverflow.com/users/9209569/cactusas"}, "edited": false, "score": 0, "creation_date": 1565176414, "post_id": 57392947, "comment_id": 101267969, "body": "I want to disagree with this a bit. When including header files <code>&lt;&gt;</code> symbols are usually used for third party libraries while <code>&quot; &quot;</code> are used for user written headers. I think this is just the best practice. At this situation <code>#include &quot;include&#47;my_header.hpp&quot;</code> should be used."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "reply_to_user": {"reputation": 70, "user_id": 9209569, "user_type": "registered", "profile_image": "https://graph.facebook.com/1716064065122497/picture?type=large", "display_name": "Cactus&#39;as", "link": "https://stackoverflow.com/users/9209569/cactusas"}, "edited": false, "score": 0, "creation_date": 1565176443, "post_id": 57392947, "comment_id": 101267986, "body": "@Cactus&#39;as You are right, my bad, a typo. In fact, <code>&quot; &quot;</code> are preferred because it searches in the user folder in priority in contrary to with <code>&lt; &gt;</code> that searches in system installed libraries folder at first."}], "tags": [], "owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "is_accepted": false, "score": 0, "last_activity_date": 1565176463, "last_edit_date": 1565176463, "creation_date": 1565175810, "answer_id": 57392947, "question_id": 57392464, "link": "https://stackoverflow.com/questions/57392464/including-header-files-in-c/57392947#57392947", "title": "Including header files in C++", "body": "<p>The <code>main()</code> function is not meant to <em>\"call all the header functions\"</em>.</p>\n\n<p>You don't have any error here (assuming your files are in the same folder which seems to be the case here).<br/>\nYou are using the Visual Studio Code's editor. It seems that your editor is misconfigured and could not find the files in its own file tree representation, that's all.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>If you have an include error at compilation, then this is that you missed to specify the paths correctly. For example, if you have the \"main.cpp\" alongside an \"include\" folder that contains your .hpp files, you will have to include the one you want this way:</p>\n\n<pre><code>#include \"include/my_header.hpp\"\n</code></pre>\n\n<p>Always give <strong>relative paths</strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 8006558, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hAfL6hSCWvo/AAAAAAAAAAI/AAAAAAAABAk/YmY3NSiqAfU/photo.jpg?sz=128", "display_name": "cobexer", "link": "https://stackoverflow.com/users/8006558/cobexer"}, "is_accepted": false, "score": 0, "last_activity_date": 1565176104, "creation_date": 1565176104, "answer_id": 57393029, "question_id": 57392464, "link": "https://stackoverflow.com/questions/57392464/including-header-files-in-c/57393029#57393029", "title": "Including header files in C++", "body": "<p>From your screenshot it looks like <code>getline_demo.hpp</code> can be fond by your IDE, check using your file explorer where the files are placed and move the others into the same folder.</p>\n\n<p>Never use absolute paths in your project/source files unless you want to cause problems for yourself and others in the future!</p>\n\n<p>Also remember that the views IDEs give you of your project may not correlate to the layout on the filesystem - which is the layout your compiler cares about!</p>\n\n<p>Special thanks go to Microsoft Visual Studio for the \"helpful\" filters it creates.</p>\n"}], "owner": {"reputation": 51, "user_id": 11841370, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qtJL6vYKh9o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcKLouYp5dpEVrc1eAKWAC97czpmw/photo.jpg?sz=128", "display_name": "Sarah Kay", "link": "https://stackoverflow.com/users/11841370/sarah-kay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1565176463, "creation_date": 1565174223, "last_edit_date": 1565175137, "question_id": 57392464, "link": "https://stackoverflow.com/questions/57392464/including-header-files-in-c", "title": "Including header files in C++", "body": "<p>I'm very new to C++ and I've just figured out that main() is meant to call all the header functions.</p>\n\n<p>I've made 5 header files, all .hpp, and placed them in the header folder of my project. As you can see they all have the same extension and location:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zt99i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zt99i.png\" alt=\"enter image description here\"></a></p>\n\n<p>But when I call the header files in my main.cpp file... only getline_demo.hpp can be found by the system:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0neG5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0neG5.png\" alt=\"enter image description here\"></a></p>\n\n<p>The error is \"cannot open filename.hpp\" for the others.</p>\n\n<p>What could be happening and how could I fix it?</p>\n"}, {"tags": ["c++", "language-lawyer"], "comments": [{"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 2, "creation_date": 1565177518, "post_id": 57392150, "comment_id": 101268615, "body": "This is partially explained at the end of <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0135r0.html\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0135r0.html</a> I think the sentence only applies to prvalue array, which are included in <i>&quot;rvalue of type array of N T&quot;</i>."}], "answers": [{"tags": [], "owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "is_accepted": true, "score": 2, "last_activity_date": 1565358398, "last_edit_date": 1565358398, "creation_date": 1565356843, "answer_id": 57430981, "question_id": 57392150, "link": "https://stackoverflow.com/questions/57392150/temporary-materialization-during-array-to-pointer-conversion/57430981#57430981", "title": "Temporary materialization during array-to-pointer conversion", "body": "<p>The temporary materialization conversion is applied to the array to be converted if it is a prvalue.  This is because a pointer can only point to something actually existent.  It is not applied to the resulting pointer value.  In your example, the array to be converted is an lvalue, so the conversion is not applied.</p>\n\n<p>In the following code, the array prvalue <code>Arr{0, 1}</code> is converted to <code>int*</code>.  The temporary materialization conversion is applied. </p>\n\n<pre><code>void f(int*) {}\nint main()\n{\n    using Arr = int [2];\n    f(Arr{0, 1});\n}\n</code></pre>\n\n<p>GCC doesn\u2019t seem to accept this code, but there is no problem with this code according to the standard.  See <a href=\"https://stackoverflow.com/q/55463861\">Why does passing a temporary object as an argument need std::move?</a></p>\n"}], "owner": {"reputation": 878, "user_id": 6209703, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fCEFLG7A_SE/AAAAAAAAAAI/AAAAAAAAAK4/dyc-zQvZ2DU/photo.jpg?sz=128", "display_name": "Jan Tu\u0161il", "link": "https://stackoverflow.com/users/6209703/jan-tu%c5%a1il"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 1, "accepted_answer_id": 57430981, "answer_count": 1, "score": 7, "last_activity_date": 1565358398, "creation_date": 1565173172, "question_id": 57392150, "link": "https://stackoverflow.com/questions/57392150/temporary-materialization-during-array-to-pointer-conversion", "title": "Temporary materialization during array-to-pointer conversion", "body": "<p>Since C++17 (more precisely, since <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0135r1.html\" rel=\"noreferrer\">p0135r1</a>), array-to-pointer conversion involves temporary materialization - <a href=\"http://eel.is/c++draft/conv.array\" rel=\"noreferrer\">conv.array</a>:</p>\n\n<blockquote>\n  <p>An lvalue or rvalue of type \u201carray of N T\u201d or \u201carray of unknown bound of T\u201d can be converted to a prvalue of type \u201cpointer to T\u201d.\n  <strong>The temporary materialization conversion ([conv.rval]) is applied.</strong>\n  The result is a pointer to the first element of the array.</p>\n</blockquote>\n\n<p>Why? Temporary materialization applies only to prvalues - <a href=\"http://eel.is/c++draft/conv.rval\" rel=\"noreferrer\">conv.rval</a>:</p>\n\n<blockquote>\n  <p>A prvalue of type T can be converted to an xvalue of type T.\n  This conversion initializes a temporary object ([class.temporary]) of type T \n  from the prvalue by evaluating the prvalue with the temporary object as its \n  result object, and produces an xvalue denoting the temporary object.\n  T shall be a complete type.</p>\n</blockquote>\n\n<p>So, in case of array-to-pointer conversion, to what is the temporary materialization applied? To the resulting pointer prvalue?</p>\n\n<p>Does temporary materialization occur in the following example?</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void foo(int *a) {}\nint main() {\n    int arr[4];\n    foo(arr);\n}\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1565173083, "post_id": 57392102, "comment_id": 101266131, "body": "Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a> and <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly don&#39;t forget how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 7210, "user_id": 1421332, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/39f3da5b153edf32201b9e9100dad01a?s=128&d=identicon&r=PG", "display_name": "Silicomancer", "link": "https://stackoverflow.com/users/1421332/silicomancer"}, "edited": false, "score": 1, "creation_date": 1565173441, "post_id": 57392102, "comment_id": 101266334, "body": "Which language? You wrote &quot;C&quot; but your tags say also C++ and C++CLI"}, {"owner": {"reputation": 25, "user_id": 5396042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af1dc3cd23f51eedd91bd116791e618?s=128&d=identicon&r=PG&f=1", "display_name": "archana", "link": "https://stackoverflow.com/users/5396042/archana"}, "edited": false, "score": 0, "creation_date": 1565173607, "post_id": 57392102, "comment_id": 101266427, "body": "Any of these 3 languages are okay, basically I need the answer."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1565174029, "post_id": 57392102, "comment_id": 101266656, "body": "What have you tried and what is your difficulty?"}, {"owner": {"reputation": 25, "user_id": 5396042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af1dc3cd23f51eedd91bd116791e618?s=128&d=identicon&r=PG&f=1", "display_name": "archana", "link": "https://stackoverflow.com/users/5396042/archana"}, "edited": false, "score": 0, "creation_date": 1565174469, "post_id": 57392102, "comment_id": 101266905, "body": "I need to call some python code in my c++/cli  program only if the system contains 64 bit version of python. So first I am supposed to check whether the python is of 64 bit or not.  If 64 bit then I need to embedded the python code."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1565175023, "post_id": 57392102, "comment_id": 101267180, "body": "<i>which</i> Python?"}, {"owner": {"reputation": 25, "user_id": 5396042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af1dc3cd23f51eedd91bd116791e618?s=128&d=identicon&r=PG&f=1", "display_name": "archana", "link": "https://stackoverflow.com/users/5396042/archana"}, "edited": false, "score": 0, "creation_date": 1565175242, "post_id": 57392102, "comment_id": 101267303, "body": "basically python 3, but problem is not with python. Instead how to know the python architecture using C/ C++ or c++/cli"}, {"owner": {"reputation": 722, "user_id": 6387948, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cbaNARBRWO4/AAAAAAAAAAI/AAAAAAAAAGM/lVLNlR9XqDE/photo.jpg?sz=128", "display_name": "Hans-Martin Mosner", "link": "https://stackoverflow.com/users/6387948/hans-martin-mosner"}, "edited": false, "score": 0, "creation_date": 1565177226, "post_id": 57392102, "comment_id": 101268436, "body": "There can be several versions of Python in different directories. You could have 32-bit and 64-bit versions of python2.x or python3.x."}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1565179721, "post_id": 57392102, "comment_id": 101269846, "body": "@archana You could try  <code>cmd = &quot;python3 -c \\&quot;import sys ; import platform; print (sys.version) ; print( platform.platform())\\&quot;;</code> . and then <code>fh = popen(cmd, &quot;r&quot;);</code>. Then you can read the required information from the <code>fh</code> file handle. Works on Linux, please note that the invocation syntax could be a bit different on a Windows system. Do not forget to call <code>pclose(fh);</code> when done."}, {"owner": {"reputation": 25, "user_id": 5396042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af1dc3cd23f51eedd91bd116791e618?s=128&d=identicon&r=PG&f=1", "display_name": "archana", "link": "https://stackoverflow.com/users/5396042/archana"}, "reply_to_user": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1565241309, "post_id": 57392102, "comment_id": 101292193, "body": "@jpmarinier Thanks for your suggestion. I could use system() instead of popen()"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5396042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af1dc3cd23f51eedd91bd116791e618?s=128&d=identicon&r=PG&f=1", "display_name": "archana", "link": "https://stackoverflow.com/users/5396042/archana"}, "edited": false, "score": 0, "creation_date": 1565241239, "post_id": 57394472, "comment_id": 101292170, "body": "Thank you so much. It worked. Only diff is instead of &quot;32bit&quot; I have to write as &#39;32bit&#39;"}], "tags": [], "owner": {"reputation": 774, "user_id": 746618, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2e08fae44d9362af3127657e9fbb4a79?s=128&d=identicon&r=PG", "display_name": "ilia", "link": "https://stackoverflow.com/users/746618/ilia"}, "is_accepted": true, "score": 2, "last_activity_date": 1565180707, "creation_date": 1565180707, "answer_id": 57394472, "question_id": 57392102, "link": "https://stackoverflow.com/questions/57392102/version-check-of-python/57394472#57394472", "title": "Version check of python", "body": "<pre><code>char *cmd = \"python -c \\\"import sys,platform ;exit(platform.architecture()[0]==\\\"32bit\\\")\\\"\"\nint ret = system(cmd);\n</code></pre>\n\n<p>ret will be 1 for 32 bit and 0 for 64</p>\n"}], "owner": {"reputation": 25, "user_id": 5396042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af1dc3cd23f51eedd91bd116791e618?s=128&d=identicon&r=PG&f=1", "display_name": "archana", "link": "https://stackoverflow.com/users/5396042/archana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "closed_date": 1565183164, "accepted_answer_id": 57394472, "answer_count": 1, "score": -4, "last_activity_date": 1565181654, "creation_date": 1565173003, "last_edit_date": 1565181654, "question_id": 57392102, "link": "https://stackoverflow.com/questions/57392102/version-check-of-python", "closed_reason": "Needs more focus", "title": "Version check of python", "body": "<p>I need to check if installed Python version is 32 bit or 64 bit using my C program running in Windows 10, not in my Python program. </p>\n\n<p>How can I check the Python architecture using C code?</p>\n"}, {"tags": ["c++", "matlab"], "comments": [{"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 2, "creation_date": 1565173314, "post_id": 57392001, "comment_id": 101266266, "body": "Your Matlab code is not correct. Your <code>fprintf</code> prints nothing because you did not specified the variable to print as parameter. Moreover, <code>i=i+2</code> without terminating with &#39;;&#39; will print the result of the operation. So, the C++ and the matlab code you provided are indeed <b>not the same</b>"}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 3, "creation_date": 1565173471, "post_id": 57392001, "comment_id": 101266346, "body": "Moreover, your condition <code>i&gt;=1</code> is always true in your case so you can remove it."}], "answers": [{"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 6, "last_activity_date": 1565599406, "last_edit_date": 1565599406, "creation_date": 1565173050, "answer_id": 57392117, "question_id": 57392001, "link": "https://stackoverflow.com/questions/57392001/difference-between-while-loops-in-matlab-and-c/57392117#57392117", "title": "Difference between while loops in matlab and c++", "body": "<p>Your matlab code is not right: </p>\n\n<ul>\n<li><code>fprintf(%i)</code> is printing nothing, cause you tell <code>fprintf</code> that you want to print an int (<code>%i</code>), but you gave nothing to print.</li>\n<li>and <code>i=i+2</code> display the result (which you don't want).</li>\n</ul>\n\n<p>The corrected matlab code should be:</p>\n\n<pre class=\"lang-matlab prettyprint-override\"><code>\ni=1;\nwhile i&gt;=1 &amp;&amp; i&lt;10\n    % display i\n    fprintf('%d', i)\n\n    % compute next i without displaying it (notice the `;`)\n    i=i+2;\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 360, "user_id": 11230708, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BrvtstToXLU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfAcSpGqNZXmWCJF-O_BCHTj5JbzQ/mo/photo.jpg?sz=128", "display_name": "Rajkumar Ananthu", "link": "https://stackoverflow.com/users/11230708/rajkumar-ananthu"}, "is_accepted": false, "score": 1, "last_activity_date": 1565173530, "creation_date": 1565173530, "answer_id": 57392257, "question_id": 57392001, "link": "https://stackoverflow.com/questions/57392001/difference-between-while-loops-in-matlab-and-c/57392257#57392257", "title": "Difference between while loops in matlab and c++", "body": "<p>The output you are telling is not by the fprintf statement. fprintf() prints arrays of characters to the screen. It is similar to the C language printf() function. And the output 3,5,7,9,11 are because of the missing semi-colon after the statement i=i+2.</p>\n\n<p>If you correct the code as </p>\n\n<pre><code>i=1;\nwhile i&gt;=1 &amp;&amp; i&lt;10\n     fprintf ('%d', i);\n     i = i + 2;\nend\n</code></pre>\n\n<p>This would work as you expected.\nHope this helps, Thanks</p>\n"}, {"comments": [{"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1565175393, "post_id": 57392483, "comment_id": 101267381, "body": "Why inverting the order of the printing statement and the operation ? I can be wrong but I don&#39;t think the OP wanted to print the result of the operation <code>i = i+2</code> (this is just the increment)."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1565182297, "post_id": 57392483, "comment_id": 101271329, "body": "@Fareanor - The question was asking why some matlab ocde produced different output than some C++ code.    There was no comment about which was the desired behaviour, so I focused on explaining the differences and on (one option) for getting the two samples producing the same output."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1565186248, "post_id": 57392483, "comment_id": 101273979, "body": "I see, good answer though :)"}], "tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 2, "last_activity_date": 1565174281, "creation_date": 1565174281, "answer_id": 57392483, "question_id": 57392001, "link": "https://stackoverflow.com/questions/57392001/difference-between-while-loops-in-matlab-and-c/57392483#57392483", "title": "Difference between while loops in matlab and c++", "body": "<p>You're just getting lucky with your matlab code</p>\n\n<blockquote>\n<pre><code>i=1;\nwhile i&gt;=1 &amp;&amp; i&lt;10\nfprintf('%i')\ni=i+2\nend\n</code></pre>\n</blockquote>\n\n<p>In the above, the <code>fprintf()</code> does nothing (since there is no argument corresponding to the <code>%i</code> format).  Then, since there is no semi-colon on the <code>i=i+2</code>, matlab outputs the new result of <code>i</code> on every loop iteration.</p>\n\n<p>If you remove the <code>fprintf()</code> the code will still produce the same output.</p>\n\n<p>To make the <code>fprintf()</code> actually do the output, change the code to</p>\n\n<pre><code>i=1;\nwhile i&gt;=1 &amp;&amp; i&lt;10\ni=i+2;\nfprintf('%i', i);\nend\n</code></pre>\n\n<p>Note that I have used semi-colons to stop matlab from printing results independently of the <code>fprintf()</code>.</p>\n\n<p>Your C++ code</p>\n\n<pre><code>int i=1;\n\nwhile (i&gt;=1  &amp;&amp; i&lt;10)\n{\n    cout &lt;&lt; i &lt;&lt;endl;\n    i=i+2;\n} \n</code></pre>\n\n<p>is printing the value of <code>i</code> and THEN adding two to it.</p>\n\n<p>To make it produce the same output as the (corrected) matlab above, swap the two statements in the loop</p>\n\n<pre><code>int i=1;\n\nwhile (i&gt;=1  &amp;&amp; i&lt;10)\n{\n    i = i+2;\n    cout &lt;&lt; i &lt;&lt;endl;\n} \n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11895040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e838c216578377cb3185ac8c63a0114e?s=128&d=identicon&r=PG&f=1", "display_name": "Kingda Ka", "link": "https://stackoverflow.com/users/11895040/kingda-ka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "closed_date": 1565689576, "answer_count": 3, "score": 1, "last_activity_date": 1565599406, "creation_date": 1565172675, "question_id": 57392001, "link": "https://stackoverflow.com/questions/57392001/difference-between-while-loops-in-matlab-and-c", "closed_reason": "Not suitable for this site", "title": "Difference between while loops in matlab and c++", "body": "<p>After playing around with Matlab for some time, I could not help but notice that while loops seem to be executed differently than in c++. For this bit of Matlab code, for example,</p>\n\n<pre><code>&gt;&gt; i=1;\n&gt;&gt; while i&gt;=1 &amp;&amp; i&lt;10\nfprintf('%i')\ni=i+2\nend\n</code></pre>\n\n<p>the computer insists on returning the string 3,5,7,9,11. On the other hand, the same program in c++ </p>\n\n<pre><code>int i=1;\n\nwhile (i&gt;=1  &amp;&amp; i&lt;10)\n{\n    cout &lt;&lt; i &lt;&lt;endl;\n    i=i+2;\n} \n</code></pre>\n\n<p>gives the string 1,3,5,7,9. Are the two languages indeed different in this respect or am I doing something wrong?</p>\n"}, {"tags": ["c++", "mingw", "mingw-w64"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1565172772, "post_id": 57391963, "comment_id": 101265971, "body": "It depends on your build-system. If you use <code>make</code> and makefiles then yes it&#39;s possible. And if you use an IDE then could have things like pre-build or post-build steps that can run arbitrary commands or scripts."}, {"owner": {"reputation": 345, "user_id": 9386485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0916b8319fdc74badc020ad2de9837c?s=128&d=identicon&r=PG&f=1", "display_name": "Xemuth", "link": "https://stackoverflow.com/users/9386485/xemuth"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1565175384, "post_id": 57391963, "comment_id": 101267377, "body": "Thank @Someprogrammerdude I will take a look at my IDE then."}], "owner": {"reputation": 345, "user_id": 9386485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0916b8319fdc74badc020ad2de9837c?s=128&d=identicon&r=PG&f=1", "display_name": "Xemuth", "link": "https://stackoverflow.com/users/9386485/xemuth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565172539, "creation_date": 1565172539, "question_id": 57391963, "link": "https://stackoverflow.com/questions/57391963/asking-to-mingw-to-copy-some-source-during-compilation", "title": "Asking to Mingw to copy some source during compilation", "body": "<p>I have some ressouces (png/sound...)  in a folder named \"datas\" itself stored in a folder contening my code cpp. I want to know if it is possible to ask Mingw during compilation to copy the \"datas\" folder to the output folder?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c++", "c", "embedded"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1565172641, "post_id": 57391899, "comment_id": 101265891, "body": "The big problem is a read-modify-write cycle of the variables. Like e.g. <code>x++</code> or <code>x += y</code>."}], "answers": [{"comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 3, "creation_date": 1565174568, "post_id": 57391951, "comment_id": 101266956, "body": "<i>32-bit variables are already been written atomically</i> - they are not"}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1565174622, "post_id": 57391951, "comment_id": 101266980, "body": "@VTT how so? at the assembly level they are."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1565174642, "post_id": 57391951, "comment_id": 101266989, "body": "@MichaelChourdakis never assume anything about the assembly."}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1565174704, "post_id": 57391951, "comment_id": 101267016, "body": "@AnttiHaapala When unless your compiler is severely weird, when it does x = 5, it writes it atomically, not bit by bit."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1565174746, "post_id": 57391951, "comment_id": 101267041, "body": "@MichaelChourdakis as I said never assume anything. The C standard says it is not fine so at some point it might not be fine."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1565174987, "post_id": 57391951, "comment_id": 101267156, "body": "Furthermore there are not many useful programs besides <code>&#47;bin&#47;true</code> or <code>&#47;bin&#47;false</code> that could just use constants everywhere ;)"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1565175017, "post_id": 57391951, "comment_id": 101267176, "body": "On x86 atomic operations, including simple atomic store have strict alignment requirements. So for example a single <code>mov</code> instruction is not guaranteed to be atomic. If value crosses cache line boundary then it is guaranteed to be not atomic."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1565178099, "post_id": 57391951, "comment_id": 101268955, "body": "@VTT but so does C on x86"}], "tags": [], "owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "is_accepted": false, "score": 2, "last_activity_date": 1565172514, "creation_date": 1565172514, "answer_id": 57391951, "question_id": 57391899, "link": "https://stackoverflow.com/questions/57391899/do-we-need-to-use-lock-for-multi-threaded-x32-system-for-just-reading-or-writing/57391951#57391951", "title": "Do we need to use lock for multi-threaded x32 system for just reading or writing into a uint32_t variable", "body": "<p>The usage of locks is not (only) to ensure atomicity, 32-bit variables are already been written atomically.</p>\n\n<p>Your problem is to protect simultaneous writing:</p>\n\n<pre><code>int x = 0;\nFunction 1: x++;\nFunction 2: x++;\n</code></pre>\n\n<p>If there is no synchronization, x might up end as 1 instead of 2 because function 2 might be reading <code>x = 0</code>, before function 1 modifies x. The worst thing in all this is that it might happen or not at random (or at your client's PC),  so debugging is difficult.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 3, "last_activity_date": 1565174895, "last_edit_date": 1565174895, "creation_date": 1565172751, "answer_id": 57392020, "question_id": 57391899, "link": "https://stackoverflow.com/questions/57391899/do-we-need-to-use-lock-for-multi-threaded-x32-system-for-just-reading-or-writing/57392020#57392020", "title": "Do we need to use lock for multi-threaded x32 system for just reading or writing into a uint32_t variable", "body": "<p>Yes, one needs to use locks or some other appropriate mechanism, like the atomics. </p>\n\n<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#5.1.2.4p4\" rel=\"nofollow noreferrer\">C11 5.1.2.4p4</a>:</p>\n\n<blockquote>\n  <ol start=\"4\">\n  <li>Two expression evaluations conflict if one of them modifies a memory location and the other one reads or modifies the same memory location. </li>\n  </ol>\n</blockquote>\n\n<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#5.1.2.4p25\" rel=\"nofollow noreferrer\">C11 5.1.2.4p25</a>:</p>\n\n<blockquote>\n  <ol start=\"25\">\n  <li>The execution of a program contains a data race if it contains two conflicting actions in different threads, at least one of which is not atomic, and neither happens before the other. Any such data race results in undefined behavior.</li>\n  </ol>\n</blockquote>\n\n<hr>\n\n<p>Additionally if you've got a variable that is not volatile-qualified then the C standard does not even require that the changes hit to the memory at all; unless you use some synchronization mechanism the data races could have much longer spans  in an optimized program than one would perhaps initially think could be possible - for example the writes can be totally out of order and so forth.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1565173914, "creation_date": 1565173914, "answer_id": 57392373, "question_id": 57391899, "link": "https://stackoverflow.com/questions/57391899/do-we-need-to-use-lock-for-multi-threaded-x32-system-for-just-reading-or-writing/57392373#57392373", "title": "Do we need to use lock for multi-threaded x32 system for just reading or writing into a uint32_t variable", "body": "<p>It is only atomic if you write the code in assembler and pick the appropriate instruction. When using a higher level language, you don't have any control over which instructions that will get picked. </p>\n\n<p>If you have some C code like <code>a = b;</code> then the machine code generated might be \"load b into register x\", \"store register x in the memory location of a\", which is more than one instruction. An interrupt or another thread executed between those two will mean data corruption if it uses the same variable. Suppose the other thread writes a different value to <code>a</code> - then that change will be lost when returning to the original thread.</p>\n\n<p>Therefore you must use some manner of protection mechanism, such as <code>_Atomic</code> qualifier, mutex or critical sections.</p>\n"}, {"tags": [], "owner": {"reputation": 2990, "user_id": 10803671, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mt-5s4Zqfyk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i_80atK5hWxwK60_Ren7qQV1TVuQ/mo/photo.jpg?sz=128", "display_name": "ALX23z", "link": "https://stackoverflow.com/users/10803671/alx23z"}, "is_accepted": false, "score": 0, "last_activity_date": 1565178044, "creation_date": 1565178044, "answer_id": 57393622, "question_id": 57391899, "link": "https://stackoverflow.com/questions/57391899/do-we-need-to-use-lock-for-multi-threaded-x32-system-for-just-reading-or-writing/57393622#57393622", "title": "Do we need to use lock for multi-threaded x32 system for just reading or writing into a uint32_t variable", "body": "<p>The issue is that variables aren't updated instantly.</p>\n\n<p>Each processor's core has its own private memory (L1 and L2 caches). So if you modify a variable, say <code>x++</code>, in two different threads on two different cores - then each core updates their own version of <code>x</code>.</p>\n\n<p>Atomic operations and mutexes ensure synchronization of these variables with the shared memory (RAM / L3 cache).</p>\n"}], "owner": {"reputation": 241, "user_id": 10876003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6164bfa4c1e3acf244f14a5c679854?s=128&d=identicon&r=PG&f=1", "display_name": "jack sparow", "link": "https://stackoverflow.com/users/10876003/jack-sparow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1565178044, "creation_date": 1565172367, "question_id": 57391899, "link": "https://stackoverflow.com/questions/57391899/do-we-need-to-use-lock-for-multi-threaded-x32-system-for-just-reading-or-writing", "title": "Do we need to use lock for multi-threaded x32 system for just reading or writing into a uint32_t variable", "body": "<p>I have a question:\nConsider a x32 System,\ntherefore for a uint32_t  variable does the system read and write to it atomically?\nMeaning, that the entire operation of read or write can be completed in one instruction cycle.\nIf this is the case then for a multi-threaded x32 system we wont have to use locks for just reading or writing into a uint32_t variable.\nPlease confirm my understanding.</p>\n"}, {"tags": ["c++", "performance", "chrono"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1565172550, "post_id": 57391885, "comment_id": 101265845, "body": "How many times do you run the programs? What is happening with your whole system when you run it? Is the OS or some other process doing something?"}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 4, "creation_date": 1565172711, "post_id": 57391885, "comment_id": 101265930, "body": "Presumably you are running an optimised build, as the values of <code>input</code> are never used in the first example the compiler optimises away all of your code"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 1, "creation_date": 1565174196, "post_id": 57391885, "comment_id": 101266738, "body": "What @AlanBirtles said is probably the case. Compare the assembly code between the two and see how the loop in the first case is completely removed: Change the <code>-O3</code> to <code>-O0</code> and see it pop back: <a href=\"https://godbolt.org/z/QtJhMJ\" rel=\"nofollow noreferrer\">godbolt.org/z/QtJhMJ</a>"}, {"owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "edited": false, "score": 0, "creation_date": 1565176657, "post_id": 57391885, "comment_id": 101268102, "body": "Thank you for the answer. Also, since I want to vectorize the code, I am using O3, therefore I want to keep the performance. How to make sure that the compiler always vectorizes my code, although I am using the matrix below afterwards? In the real scenario instead of the matrix iteration I have a matrix multiplication."}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1565186307, "post_id": 57391885, "comment_id": 101274009, "body": "You can&#39;t ensure the optimiser does anything. What is happening here isn&#39;t the compiler isn&#39;t optimising your code in the second case, it is. The issue you are having is the compiler is completely deleting your code in the first case because it doesn&#39;t have any noticable effect."}], "owner": {"reputation": 81, "user_id": 10928672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4joLPeSWuNQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcapWR37MctuOTs4z8szb_XXtK3EYA/mo/photo.jpg?sz=128", "display_name": "Ana Smile", "link": "https://stackoverflow.com/users/10928672/ana-smile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565172328, "creation_date": 1565172328, "question_id": 57391885, "link": "https://stackoverflow.com/questions/57391885/measuring-time-with-chrono-changes-after-printing", "title": "Measuring time with chrono changes after printing", "body": "<p>I want to measure the execution time of a program in ns in C++. For that purpose I am using the chrono library.</p>\n\n<pre><code>int main() {\n\n    const int ROWS = 200;\n    const int COLS = 200;\n    double input[ROWS][COLS];\n    int i,j;\n\n    auto start = std::chrono::steady_clock::now();\n    for (i = 0; i &lt; ROWS; i++) {\n        for (j = 0; j &lt; COLS; j++)\n            input[i][j] = i + j;\n    }\n\n    auto end = std::chrono::steady_clock::now();\n    auto res=std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(end - start).count();\n\n    std::cout &lt;&lt; \"Elapsed time in nanoseconds : \"\n              &lt;&lt; res\n              &lt;&lt; \" ns\" &lt;&lt; std::endl;\n\n    return 0;\n}\n\n</code></pre>\n\n<p>I measured the time and it executed in 90 ns . However when I add a printing afterwards the time changes.</p>\n\n<pre><code>int main() {\n\n    const int ROWS = 200;\n    const int COLS = 200;\n    double input[ROWS][COLS];\n    int i,j;\n\n    auto start = std::chrono::steady_clock::now();\n    for (i = 0; i &lt; ROWS; i++) {\n        for (j = 0; j &lt; COLS; j++)\n            input[i][j] = i + j;\n    }\n\n    auto end = std::chrono::steady_clock::now();\n    auto res=std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(end - start).count();\n    std::cout &lt;&lt; \"Elapsed time in nanoseconds : \"\n              &lt;&lt; res\n              &lt;&lt; \" ns\" &lt;&lt; std::endl;\n\n    for (i = 0; i &lt; ROWS; i++) {\n        for (j = 0; j &lt; COLS; j++)\n            std::cout&lt;&lt;input[i][j];\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The time changes to 89700 ns. What could be the problem. I only want to measure the execution time of the for.</p>\n"}, {"tags": ["c++", "class", "oop", "inheritance", "destructor"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11793394, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xEGR--XWr2I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWgRD7ikZ67JyWazaGwNmSPjm_9A/photo.jpg?sz=128", "display_name": "Mouad Kerdoud", "link": "https://stackoverflow.com/users/11793394/mouad-kerdoud"}, "edited": false, "score": 0, "creation_date": 1565186070, "post_id": 57391904, "comment_id": 101273868, "body": "I understand ! Would my compiler ever create a default Constructor if I already created one? Are default constructors ONLY created when I do not manually declare them?"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 13, "user_id": 11793394, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xEGR--XWr2I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWgRD7ikZ67JyWazaGwNmSPjm_9A/photo.jpg?sz=128", "display_name": "Mouad Kerdoud", "link": "https://stackoverflow.com/users/11793394/mouad-kerdoud"}, "edited": false, "score": 0, "creation_date": 1565187399, "post_id": 57391904, "comment_id": 101274698, "body": "See <a href=\"https://en.cppreference.com/w/cpp/language/default_constructor\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/default_constructor</a>: <i>If no user-declared constructors of any kind are provided for a class type (struct, class, or union), the compiler will always declare a default constructor as an inline public member of its class.</i>"}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1565172371, "last_edit_date": 1592644375, "creation_date": 1565172371, "answer_id": 57391904, "question_id": 57391852, "link": "https://stackoverflow.com/questions/57391852/do-children-classes-inherit-parents-destructors-if-not-done-manually/57391904#57391904", "title": "Do children classes inherit parent&#39;s Destructors if not done manually?", "body": "<p>The compiler always implements a destructor for your class, if you haven't declared one. The compiler also generates code that calls base class destructors.</p>\n<p>In other words, base class destructors are not inherited but get called from after your derived class destructor.</p>\n<p>See <a href=\"https://en.cppreference.com/w/cpp/language/destructor\" rel=\"nofollow noreferrer\">Destructor</a>:</p>\n<blockquote>\n<p><strong>Destruction sequence</strong></p>\n<p>For both user-defined or implicitly-defined destructors, after the body of the destructor is executed, the compiler calls the destructors for all non-static non-variant members of the class, in reverse order of declaration, then it calls the destructors of all direct non-virtual base classes in reverse order of construction (which in turn call the destructors of their members and their base classes, etc), and then, if this object is of most-derived class, it calls the destructors of all virtual bases.</p>\n<p>Even when the destructor is called directly (e.g. obj.~Foo();), the return statement in ~Foo() does not return control to the caller immediately: it calls all those member and base destructors first.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 450, "user_id": 7497038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b0OuY.jpg?s=128&g=1", "display_name": "Chandra Shekhar", "link": "https://stackoverflow.com/users/7497038/chandra-shekhar"}, "is_accepted": false, "score": 0, "last_activity_date": 1565201009, "creation_date": 1565201009, "answer_id": 57400009, "question_id": 57391852, "link": "https://stackoverflow.com/questions/57391852/do-children-classes-inherit-parents-destructors-if-not-done-manually/57400009#57400009", "title": "Do children classes inherit parent&#39;s Destructors if not done manually?", "body": "<p>The child class inherits the data members and member function of parent class but private members remain inaccesible in child class.Only Public member function and data members are accecible in child class.In Inheritance constructor or destructor is not inherited by child class but in the child class constructor and destructor there is an explicit call to base class constructor and destructor.\nwhenever we create an object of child class ,first constructoe of base class will be invoked then constructor of derived class is called.while if the object of child class is destroyed the destructor of child class will be invoked first and then destructor of parent class will be called.</p>\n"}], "owner": {"reputation": 13, "user_id": 11793394, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xEGR--XWr2I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWgRD7ikZ67JyWazaGwNmSPjm_9A/photo.jpg?sz=128", "display_name": "Mouad Kerdoud", "link": "https://stackoverflow.com/users/11793394/mouad-kerdoud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 57391904, "answer_count": 2, "score": 1, "last_activity_date": 1565201009, "creation_date": 1565172214, "question_id": 57391852, "link": "https://stackoverflow.com/questions/57391852/do-children-classes-inherit-parents-destructors-if-not-done-manually", "title": "Do children classes inherit parent&#39;s Destructors if not done manually?", "body": "<p>If given a parent class A that contains a defined Destructor, will B-it's child- execute it when creating a B object? even if I did not create manually nor inherit the A's Destructor in the B class?</p>\n\n<p>I expect that it will since I saw it in a video tutorial of c++ but do not understand why? Because the Constructor was manually inherited!</p>\n"}, {"tags": ["c++", "initialization", "language-lawyer", "constexpr", "constant-expression"], "comments": [{"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1565232104, "post_id": 57391772, "comment_id": 101290381, "body": "It seems a defect in the standard that the value category of a full-expression is not defined."}], "answers": [{"comments": [{"owner": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "edited": false, "score": 1, "creation_date": 1565172839, "post_id": 57391984, "comment_id": 101266011, "body": "That&#39;s wasn&#39;t the question - rather what is the &quot;initialization&quot;? Obviously it includes the conversions, but does it include the initializer? The full expression of an initializer is itself, and any other conversions that are applied, but it is not clear if &quot;initialization&quot; includes the initializer expression itself."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "reply_to_user": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "edited": false, "score": 0, "creation_date": 1565181152, "post_id": 57391984, "comment_id": 101270653, "body": "@KrystianS The full-<i>expression</i> is just the one in the initializer."}, {"owner": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1565207918, "post_id": 57391984, "comment_id": 101284604, "body": "@L.F. Ok, but in the example I showed in the question <code>a</code> isn&#39;t a constant expression"}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "reply_to_user": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "edited": false, "score": 0, "creation_date": 1565221675, "post_id": 57391984, "comment_id": 101288491, "body": "@KrystianS <code>a</code> is definitely a constant expression.  If a constexpr variable is not a constant expression, what can possibly be?"}, {"owner": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1565233615, "post_id": 57391984, "comment_id": 101290622, "body": "@L.F. It definitely is not, until the lvalue-to-rvalue conversion is applied."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "reply_to_user": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "edited": false, "score": 0, "creation_date": 1565233777, "post_id": 57391984, "comment_id": 101290657, "body": "@KrystianS OK, admittedly I wasn&#39;t trying to be a competent language lawyer in the previous comment.  My point is that you can expect that <code>constexpr int b = a;</code> is valid here, so double-check the standard."}, {"owner": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 1, "creation_date": 1565234044, "post_id": 57391984, "comment_id": 101290696, "body": "@L.F. I think the wording makes sense (however, initialization may be a typo for initializer) and what is the issue is how I am interpreting what a full expression is. Since conversions are considered part of a full expression, would that mean that the initializer is effectively &quot;nested&quot; inside of the conversion, so when the full-expression is evaluated, its result is the result of the enclosing conversion."}], "tags": [], "owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "is_accepted": false, "score": 1, "last_activity_date": 1565172610, "creation_date": 1565172610, "answer_id": 57391984, "question_id": 57391772, "link": "https://stackoverflow.com/questions/57391772/initialization-of-a-constexpr-variable/57391984#57391984", "title": "Initialization of a constexpr variable", "body": "<p>The word \"full-expression\" is a defined term. Notably (<a href=\"http://eel.is/c++draft/intro.execution#5.sentence-3\" rel=\"nofollow noreferrer\">[intro.execution]/5</a>)</p>\n\n<blockquote>\n  <p>Conversions applied to the result of an expression in order to satisfy the requirements of the language construct in which the expression appears are also considered to be part of the full-expression.</p>\n</blockquote>\n\n<p>So yes, since the requirement says \"<strong>the full-expression</strong> of the initialization shall be a constant expression\", it means only the full-expression (which includes the conversion), not anything else, is required to be a constant expression.</p>\n"}, {"comments": [{"owner": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "edited": false, "score": 0, "creation_date": 1565233842, "post_id": 57403901, "comment_id": 101290665, "body": "perhaps I am misinterpreting what a full-expression is, particularly when the wording says that conversions are &quot;part of the full-expression&quot;. A full expression is an expression, so if a conversion is part of that expression, does that mean that the inner expression is effectively &quot;nested&quot; inside the conversion, so when the full-expression is evaluated, it&#39;s the nested expression with that conversion applied being the result?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "edited": false, "score": 0, "creation_date": 1565234614, "post_id": 57403901, "comment_id": 101290812, "body": "@KrystianS I think the part about the &quot;full-expression of the initialization&quot; is saying that the initializer (after any conversions to it are applied) should be a constant expression"}, {"owner": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "edited": false, "score": 0, "creation_date": 1565235656, "post_id": 57403901, "comment_id": 101290985, "body": "Ok, so would a good definition for full-expression be &quot;a full-expression is the outermost expression or conversion that is evaluated when a statement is executed&quot;?"}, {"owner": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "edited": false, "score": 0, "creation_date": 1565236682, "post_id": 57403901, "comment_id": 101291171, "body": "Actually, no, it can&#39;t be, because a full-expression is not necessarily a single expression."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "edited": false, "score": 0, "creation_date": 1565241058, "post_id": 57403901, "comment_id": 101292115, "body": "The standard defines <i>full-expression</i>, you can consult that"}, {"owner": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "edited": false, "score": 0, "creation_date": 1565261631, "post_id": 57403901, "comment_id": 101301977, "body": "It does, but the intent is not clear. Obviously, it exists to define the order of execution, and the lifetime of temporaries, however the confusing thing is the way in which it is defined and use. It is stated that a full-expression &quot;includes&quot; conversions that are applied, but this is confusing because an expression is a singular thing. Addtionally, a full-expression can be made up of multiple disjoint expressions, such as the elements of an initializer, which is confusing since it is described as a singular expression."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 3, "last_activity_date": 1565225551, "creation_date": 1565225551, "answer_id": 57403901, "question_id": 57391772, "link": "https://stackoverflow.com/questions/57391772/initialization-of-a-constexpr-variable/57403901#57403901", "title": "Initialization of a constexpr variable", "body": "<p>In the link you quoted, see point 10:</p>\n\n<blockquote>\n  <p>A <em>constant expression</em> is either a glvalue core constant expression that refers to an entity that is a permitted result of a constant expression (as defined below), or a prvalue core constant expression whose value satisfies the following constraints:</p>\n</blockquote>\n\n<p>Your question focused on \"permitted result of a constant expression\" under the glvalue branch; however in your example it is the other branch \"prvalue core constant expression\" that applies.  This can apply because of [conv.lval]/1,</p>\n\n<blockquote>\n  <p>A glvalue of a non-function, non-array type T can be converted to a prvalue</p>\n</blockquote>\n\n<p>I agree it is a bit confusing that by \"prvalue core constant expression\" here they include the case of the result of lvalue-to-rvalue conversion on glvalues that meet the criteria; whereas in some other places in the standard \"prvalue\" excludes that case.</p>\n"}], "owner": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1565474838, "creation_date": 1565172048, "last_edit_date": 1565474838, "question_id": 57391772, "link": "https://stackoverflow.com/questions/57391772/initialization-of-a-constexpr-variable", "title": "Initialization of a constexpr variable", "body": "<p><a href=\"http://eel.is/c++draft/dcl.constexpr#10.sentence-3\" rel=\"nofollow noreferrer\">[dcl.constexpr] p10 sentence 3</a> says:</p>\n\n<blockquote>\n  <p>In any\u00a0constexpr\u00a0variable declaration, the full-expression of the initialization shall be a\u00a0<a href=\"http://eel.is/c++draft/expr.const#10\" rel=\"nofollow noreferrer\">constant expression</a></p>\n</blockquote>\n\n<p>However, in this declaration:</p>\n\n<pre><code>constexpr int a = 10;\nconstexpr int b = a;\n</code></pre>\n\n<p><code>a</code> is not a constant expression, as it is glvalue core constant expression, but not a <a href=\"http://eel.is/c++draft/expr.const#10.sentence-2\" rel=\"nofollow noreferrer\">permitted result of a constant expression</a> because it does not have static storage duration, and is not a temporary object. </p>\n\n<p>However, with the application of an lvalue-to-rvalue conversion, it will become a constant expression. So does that mean that the initializer does not need to be a constant expression, and only the final result after conversions has to be?</p>\n"}, {"tags": ["c++", "for-loop", "vector", "temporary-objects", "dangling-pointer"], "comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1565172316, "post_id": 57391729, "comment_id": 101265706, "body": "What does the debugger say?"}, {"owner": {"reputation": 35, "user_id": 11608229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2e48cea31f1a6d636a8f4561cb97d7?s=128&d=identicon&r=PG&f=1", "display_name": "jtotheakob", "link": "https://stackoverflow.com/users/11608229/jtotheakob"}, "reply_to_user": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1565173503, "post_id": 57391729, "comment_id": 101266362, "body": "Honestly, I don&#39;t know how to use the debugger properly. The build is succesful, but when the debug window opens, it stops right there..."}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 1, "creation_date": 1565173624, "post_id": 57391729, "comment_id": 101266437, "body": "Really then, do start learning it, it will pay off. Use Visual Studio."}, {"owner": {"reputation": 1536, "user_id": 283561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91bcdcd7ac6867149e0da7fee38f4050?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/283561/simon"}, "edited": false, "score": 0, "creation_date": 1565190364, "post_id": 57391729, "comment_id": 101276451, "body": "Why do you have two nested <code>for</code> loops? It would make sense to show more code."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11608229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2e48cea31f1a6d636a8f4561cb97d7?s=128&d=identicon&r=PG&f=1", "display_name": "jtotheakob", "link": "https://stackoverflow.com/users/11608229/jtotheakob"}, "edited": false, "score": 0, "creation_date": 1565173686, "post_id": 57391970, "comment_id": 101266462, "body": "Thanks for the hint. The error says now: <code>what(): vector::_M_range_check: __n (which is 10) &gt;= this-&gt;size() (which is 1)</code> Note: I use different elements as stated in my code example. The vector size should be large enough though. When I print the containers, all of them have the elements as expected!"}, {"owner": {"reputation": 1536, "user_id": 283561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91bcdcd7ac6867149e0da7fee38f4050?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/283561/simon"}, "reply_to_user": {"reputation": 35, "user_id": 11608229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2e48cea31f1a6d636a8f4561cb97d7?s=128&d=identicon&r=PG&f=1", "display_name": "jtotheakob", "link": "https://stackoverflow.com/users/11608229/jtotheakob"}, "edited": false, "score": 0, "creation_date": 1565190242, "post_id": 57391970, "comment_id": 101276379, "body": "The exception says you are accessing the vector at position 10, while the vector has only the size 1. The debugger should stop  right there, where the exception occurs (maybe you have to go back in the stack trace) and then you should see what values all your variables currently have."}, {"owner": {"reputation": 35, "user_id": 11608229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2e48cea31f1a6d636a8f4561cb97d7?s=128&d=identicon&r=PG&f=1", "display_name": "jtotheakob", "link": "https://stackoverflow.com/users/11608229/jtotheakob"}, "edited": false, "score": 0, "creation_date": 1565249789, "post_id": 57391970, "comment_id": 101295589, "body": "Ok, this is what I expected. Thanks for your explanation."}], "tags": [], "owner": {"reputation": 1536, "user_id": 283561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91bcdcd7ac6867149e0da7fee38f4050?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/283561/simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1565172560, "creation_date": 1565172560, "answer_id": 57391970, "question_id": 57391729, "link": "https://stackoverflow.com/questions/57391729/declaring-temporary-variables-from-vectorvectorstring-in-a-for-loop/57391970#57391970", "title": "Declaring temporary variables from vector&lt;vector&lt;string&gt;&gt; in a for-loop", "body": "<p>You don't check the real size of all of your temporary variables beforehand, but access them without any checks with <code>vecOfContainer1[0]</code> etc.</p>\n\n<p>You should use <code>vecOfContainer1.at(0)</code> which gives you at least an <code>std::out_of_range</code> exception which should provide you more details.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 11608229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2e48cea31f1a6d636a8f4561cb97d7?s=128&d=identicon&r=PG&f=1", "display_name": "jtotheakob", "link": "https://stackoverflow.com/users/11608229/jtotheakob"}, "is_accepted": false, "score": 0, "last_activity_date": 1565251923, "creation_date": 1565251923, "answer_id": 57408055, "question_id": 57391729, "link": "https://stackoverflow.com/questions/57391729/declaring-temporary-variables-from-vectorvectorstring-in-a-for-loop/57408055#57408055", "title": "Declaring temporary variables from vector&lt;vector&lt;string&gt;&gt; in a for-loop", "body": "<p>Alright... since my debugging-competence is lacking of existence, I'll post my complete code for everyone, who's interested:</p>\n\n<pre><code>#include &lt;cstdlib&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;boost/algorithm/string.hpp&gt;\n#include &lt;iterator&gt;\n\nusing namespace std;\n\n//Global variables\nstring line {};\nstring i {};                                            \nstring j {};                                           \n\n\n\n/*\n * CSV Reader class to open CSV file which is further parsed  \n * in vector containers\n */\nclass CSVReader\n{\n    string fileName, delimiter;\npublic:\n    CSVReader(string filename, string delm = \";\") :\n        fileName(filename), delimiter(delm)\n    {}\n    vector&lt;vector&lt;string&gt; &gt; getContainer1();                                            //Function to fetch unique objects from CSV file\n    vector&lt;vector&lt;string&gt; &gt; getContainer3();                                            //Fetch all corresponding lines to object_i,j\n};\n\nclass CSVXReader\n{\n    string fileName, delimiter;\npublic:\n    CSVXReader(string filename, string delm = \",\") :                                    //Notice comma delimiter for CSVX file, instead of semicolon for CSVReader\n        fileName(filename), delimiter(delm)\n    {}\n\n    vector&lt;vector&lt;string&gt; &gt; getContainer2();                                            //Fetch data from CSVX file\n};\n\n/*\n * Boolean function template to search for a string in vector and return \"true\"\n * Use it as: if(Contains(vector,item)){do...}  :if vector contains \"item\", do...\n */\ntemplate &lt;typename T&gt; \nconst bool Contains( vector&lt;T&gt;&amp; Vec, const T&amp; Element) \n{\n    if (std::find(Vec.begin(), Vec.end(), Element) != Vec.end())\n        return true;\n\n    return false;\n};\n\n/*\n * Parse through CSV file line by line \n * and return the data in vector of vector\n * of strings\n */\nvector&lt;vector&lt;string&gt; &gt; CSVReader::getContainer1()\n{\n    ifstream file(fileName);\n\n    vector&lt;vector&lt;string&gt; &gt; Container1;                                                 //Vector of vector contains all unique objects_i,j with constants \n\n    while (getline(file, line))                                                         //Iterate through each line and split the content using delimiter\n    {\n\n        vector&lt;string&gt; vecOfContainer1;                                                 //Vector contains a row from CSV file\n        boost::algorithm::split(vecOfContainer1, line, boost::is_any_of(delimiter));    //Vector content is delimited \n\n        i = vecOfContainer1.at(2);                                                      //Here: object No., e.g. 1_380\n        j = vecOfContainer1.at(3);                                                      //hotspot = 1,2,...,10   i.e. element j of object_i\n        int a = 0;                                                                      //Integer variable, used in following if-loop to validate whether 'object' &amp; 'hotspot'\n                                                                                    //appear for the first time or not \n\n        /*\n         * Creating a vector containing only necessary constants of the\n         * corresponding line to copy into 'Container1'\n         */\n        vector&lt;string&gt; constantsOfVec;\n        constantsOfVec = vecOfContainer1;                                      \n        constantsOfVec.erase(constantsOfVec.begin()+11,constantsOfVec.begin()+21);      //Deleting unnecessary elements of vecOfContainer1\n        constantsOfVec.erase(constantsOfVec.begin()+4,constantsOfVec.begin()+8);\n\n\n        /*\n         * Searching whether 'object' i &amp; 'hotspot' j exists in the whole 'Container1' already.\n         * If it exists, a=&gt;1, and at next if-function the current vector (i.e. line) is not added to 'Container1'\n         * else, a=&gt;0, and current vector is added! \n         */\n\n        for(vector&lt;string&gt; constantsOfVec : Container1)                                 //Browsing through all vectors of 'Container1'\n        {\n            if(Contains(constantsOfVec, i) &amp;&amp; Contains(constantsOfVec, j))              //Browsing through a vector (i.e. line) and searching for 'detail' i (e.g. 1_380) &amp; hotspot j\n            {\n                    a = 1;\n            }\n        }\n        if(a != 1)                                                                      //Line (or vector) is added to 'Container1' container if i&amp;j appear for the first time\n        {\n            Container1.push_back(constantsOfVec);\n        }\n    }\n    Container1.erase(Container1.begin());                                               //Deletes first line of CSV file, i.e. column header\n\n    file.close();\n    return Container1;    \n};\n\nvector&lt;vector&lt;string&gt; &gt; CSVReader::getContainer3()\n{\n    ifstream file(fileName);\n\n    vector&lt;vector&lt;string&gt; &gt; Container3;                                                 //Vector of vector contains all lines of object_i,j\n\n    while (getline(file, line))                                                         //Iterate through each line and split the content using delimiter\n    {      \n        vector&lt;string&gt; vecOfContainer1;                                                 //Vector contains a row from RAO file\n        boost::algorithm::split(vecOfContainer1, line, boost::is_any_of(delimiter));    //Vector content is delimited \n\n        /*\n         * Creating a vector containing only necessary elements of the\n         * corresponding line to copy into 'Container3' container\n         */\n        vector&lt;string&gt; parameterOfVec;\n        parameterOfVec = vecOfContainer1;                                      \n        parameterOfVec.erase(parameterOfVec.begin()+21,parameterOfVec.end());   \n        parameterOfVec.erase(parameterOfVec.begin()+8,parameterOfVec.begin()+12);\n        parameterOfVec.erase(parameterOfVec.begin()+4,parameterOfVec.begin()+7);\n        parameterOfVec.erase(parameterOfVec.begin(),parameterOfVec.begin()+2);\n\n        if(Contains(parameterOfVec, i) &amp;&amp; Contains(parameterOfVec, j))                  //Browsing through a vector (i.e. line) and searching for detail i and hotspot j of corresponding loop\n        {\n            Container3.push_back(parameterOfVec);\n        };   \n    };\n\n    file.close();\n    return Container3;\n};\n\nvector&lt;vector&lt;string&gt; &gt; CSVXReader::getContainer2()\n{\n    ifstream file(fileName);\n\n    vector&lt;vector&lt;string&gt; &gt; Container2;\n\n    while (getline(file, line))\n    {\n        vector&lt;string&gt; vecOfContainer2;\n        boost::algorithm::split(vecOfContainer2, line, boost::is_any_of(delimiter));\n\n        Container2.push_back(vecOfContainer2);\n\n    };\n\n    Container2.erase(Container2.begin());                                               //Deletes first line of CSVX file, i.e. column header\n\n    file.close();\n    return Container2;\n};\n\nint main(int argc, char** argv) \n{\n\n    CSVReader readerCSV(\"CSV_Example_.csv\");                                    //Creating an object of CSVReader to open CSV file\n    CSVXReader readerCSVX(\"CSVX_Example.csvx\");                                 //Creating an object of CSVXReader to open CSVX file\n\n    vector&lt;vector&lt;string&gt; &gt; Container1 = readerCSV.getContainer1();                     //Read data from CSV file and insert all unique objects (i,j) in 'Container1'\n    vector&lt;vector&lt;string&gt; &gt; Container2 = readerCSVX.getContainer2();\n\n\n////------------------------------FIRST LOOP FOR OBJECT i, HOTSPOT j---------------------------------------------------------------------////\n\n    for(vector&lt;string&gt; constantsOfVec : Container1)                                     //Iterating through 'Container1'\n    {           \n\n        i = constantsOfVec.at(2);                                                       //Declare Object No. and Hotspot of the current loop to be used \n        j = constantsOfVec.at(3);                                                       //in 'Container3' for inserting all vectors with exact same i&amp;j in while-loop\n\n        vector&lt;vector&lt;string&gt; &gt; Container3 = readerCSV.getContainer3();                         //Read data from CSV file and insert all lines with corresponding i&amp;j in 'Container3' container\n\n\n////------------------------------SECOND LOOP FOR TIME k---------------------------------------------------------------------------------////\n\n        for(vector&lt;string&gt; vecOfContainer2 : Container2)                                //Iterating through 'Container2', i.e. time k\n        {\n\n            string var1_str = vecOfContainer2.at(10);\n            string var2_str = vecOfContainer2.at(12);\n            string var3_str = vecOfContainer2.at(16);\n\n        //Converting strings of 'Container3' to floats with std::stof('string')\n            float var1 = stof(var1_str);                                      \n            float var2 = stof(var2_str);\n            float var3 = stof(var3_str);\n\n        //get parameterOfVec(var1,var2,var3)_ij for time k, i.e. find line in Container3 with closest parameters to current line of Container2\n\n        };\n\n\n    };   \n    return 0;\n}\n</code></pre>\n\n<p>I nested my loops, because I want to create my Container3 while I am looping through Container 1, say, <code>push_back</code> all lines of file1, which belong to object_i,j.\nIn the second loop, I am browsing through another file2 and have to find for each line of Container2 (file2) the corresponding line in Container3 (file1). This has to repeat for all objects_ij, i.e. all lines of Container1 (file1).\nThat's why I create Container2 in the beginning, in order to access it for each object_ij. And Container3 is a temporary container corresponding to each object_ij from my understanding.</p>\n\n<p>Hoping that you understood my loopception... looking forward for any advice. In the meantime I am trying to catch up with the debugger and will post more info asap. </p>\n\n<p>BR jtotheakob</p>\n"}], "owner": {"reputation": 35, "user_id": 11608229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2e48cea31f1a6d636a8f4561cb97d7?s=128&d=identicon&r=PG&f=1", "display_name": "jtotheakob", "link": "https://stackoverflow.com/users/11608229/jtotheakob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565336927, "creation_date": 1565171939, "last_edit_date": 1565336927, "question_id": 57391729, "link": "https://stackoverflow.com/questions/57391729/declaring-temporary-variables-from-vectorvectorstring-in-a-for-loop", "title": "Declaring temporary variables from vector&lt;vector&lt;string&gt;&gt; in a for-loop", "body": "<p>EDIT:Solved my problem. It was a silly mistake due to wrong delimiter of my CSVReader... my loops run as I hoped!\nThanks for your support! </p>\n\n<p>I am trying to declare temporary variables in a sequence of for-loops. To do that, I use a range-based loop for each \"vector container\" (i.e. <code>vector&lt;vector&lt;string&gt; &gt; containerXYZ</code>) and declare temporary variables within each for-loop.</p>\n\n<p>Here's part of my code to give you an idea of the for-loops:</p>\n\n<pre><code>#include &lt;cstdlib&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;boost/algorithm/string.hpp&gt;\n#include &lt;iterator&gt;\n\nusing namespace std;\n\n//Global variables\nstring i {};                                            \nstring j {};\n\nclass CSVReader\n{\n...\n  vector&lt;vector&lt;string&gt; &gt; getData1();\n  vector&lt;vector&lt;string&gt; &gt; getData2();\n  vector&lt;vector&lt;string&gt; &gt; getData3();\n}\n\nvector&lt;vector&lt;string&gt; &gt; CSVReader::getData1()\n{...};\nvector&lt;vector&lt;string&gt; &gt; CSVReader::getData2()\n{...};\nvector&lt;vector&lt;string&gt; &gt; CSVReader::getData3()\n{...};\n\nint main(int argc, char** argv)\n{\n  vector&lt;vector&lt;string&gt; &gt; Container1 = reader.getData1;  //reads data from file1\n  vector&lt;vector&lt;string&gt; &gt; Container2 = reader.getData2;  //reads data from file2\n\n  //-----FIRST LOOP....\n  for(vector&lt;string&gt; vecOfContainer1 : Container1)\n  {\n    i = vecOfContainer1[0];  //Declaring temporary variables used for container3 in my vector-function\n    j = vecOfContainer1[1];\n\n    vector&lt;vector&lt;string&gt; &gt; Container3 = reader.getData3();  //reads data from file1\n\n      //-----SECOND LOOP....\n      for(vector&lt;string&gt; vecOfContainer2 : Container2)\n      {\n        string var1_str = vecOfContainer2[2];  //Temporary variables which probably cause the error...\n        string var2_str = vecOfContainer2[3];\n\n        float var1 = stof(var1_str);\n        float var2 = stof(var2_str);\n\n        //Do calculations...\n\n      };\n    };\n    return 0;\n  }\n</code></pre>\n\n<p>My problem now is that the code is built correctly, but while running, it terminates before finishing my loops and giving a logical error in my output:</p>\n\n<pre><code>This application has requested the Runtime to terminate it in an unusual way.\n              Please contact the application's support team for more information.\nterminate called after throwing an instance of 'std::logic_error'\n  what(): basic_string::_M_construct null not valid\n\nRUN FAILED (exit value 3, total time: 3s)\n</code></pre>\n\n<p>After some research I assume that \"dangling reference\" is the keyword to my problem. However, since my declaration of variables worked well in my first loop, it doesn't in the second loop. Here's where I would like to ask for help!?</p>\n\n<p>Let me know if you require the whole code. I thought this would be sufficient for discussion though...</p>\n"}, {"tags": ["c++", "raytracing", "radiance"], "comments": [{"owner": {"reputation": 675, "user_id": 2094911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab143598424cc6e4ec05b797c12a531?s=128&d=identicon&r=PG", "display_name": "Matso", "link": "https://stackoverflow.com/users/2094911/matso"}, "edited": false, "score": 0, "creation_date": 1565695918, "post_id": 57391375, "comment_id": 101425525, "body": "Are You sure that the normals visualization is correct (or the normals of the spheres that is)?"}, {"owner": {"reputation": 675, "user_id": 2094911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab143598424cc6e4ec05b797c12a531?s=128&d=identicon&r=PG", "display_name": "Matso", "link": "https://stackoverflow.com/users/2094911/matso"}, "edited": false, "score": 0, "creation_date": 1565696030, "post_id": 57391375, "comment_id": 101425597, "body": "And why this line: <code>lightNormal = Vec3&lt;double&gt;(std::fabs(lightNormal.x()), std::fabs(lightNormal.y()), std::fabs(lightNormal.z()));</code> What is this suppose to do?"}, {"owner": {"reputation": 65, "user_id": 11038915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Tj6Zy2UscE/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNfSnrP4Z0SDvvMLTh-N_Yyt77JHg/mo/photo.jpg?sz=128", "display_name": "Benzait Sofiane", "link": "https://stackoverflow.com/users/11038915/benzait-sofiane"}, "reply_to_user": {"reputation": 675, "user_id": 2094911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab143598424cc6e4ec05b797c12a531?s=128&d=identicon&r=PG", "display_name": "Matso", "link": "https://stackoverflow.com/users/2094911/matso"}, "edited": false, "score": 0, "creation_date": 1565879392, "post_id": 57391375, "comment_id": 101490631, "body": "you are right, I fix my problem by just"}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 11038915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Tj6Zy2UscE/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNfSnrP4Z0SDvvMLTh-N_Yyt77JHg/mo/photo.jpg?sz=128", "display_name": "Benzait Sofiane", "link": "https://stackoverflow.com/users/11038915/benzait-sofiane"}, "is_accepted": true, "score": 1, "last_activity_date": 1565879544, "creation_date": 1565879544, "answer_id": 57511252, "question_id": 57391375, "link": "https://stackoverflow.com/questions/57391375/weird-direct-illumination-in-custom-problem/57511252#57511252", "title": "weird direct illumination in custom problem", "body": "<p>I fix my problem by remplace the :</p>\n\n<pre><code>lightNormal = Vec3&lt;double&gt;(std::fabs(lightNormal.x()), std::fabs(lightNormal.y()), std::fabs(lightNormal.z()));\n</code></pre>\n\n<p>by </p>\n\n<pre><code>lightNormal = Vec3&lt;double&gt;((lightNormal.x()+1)*0.5, (lightNormal.y()+1)*0.5, (lightNormal.z()+1)*0.5);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "is_accepted": false, "score": 0, "last_activity_date": 1565895057, "creation_date": 1565895057, "answer_id": 57514686, "question_id": 57391375, "link": "https://stackoverflow.com/questions/57391375/weird-direct-illumination-in-custom-problem/57514686#57514686", "title": "weird direct illumination in custom problem", "body": "<p>The main problem is here:</p>\n\n<pre><code>  Vec3&lt;double&gt; sphereNormal = ctx.getNormal();\n  sphereNormal   = Vec3&lt;double&gt;(std::fabs(sphereNormal.x()), std::fabs(sphereNormal.y()), std::fabs(sphereNormal.z())) ;\n  sphereNormal.normalize();\n</code></pre>\n\n<p>But the solution above doesn't seem quite right.  First of all, you shouldn't have to re-normalize the sphere normal.  The <code>fabs</code> calls are going to change some of the signs, but none of the magnitudes, so the extra normalize is just wasting time.</p>\n\n<p>But why the <code>fabs</code> calls.  My guess you added that because the sphere normals seemed to be pointing the wrong direction.  Thus, when you took the dot product, you were getting negative values on the light side.  You added fabs, which happened to turn <em>all</em> the sphere normals toward the light, even the ones on the dark side.  That's why you see the shading beginning, but then the light ramps back up instead of going completely dark.</p>\n\n<p>This also explains why your proposed solution appears to work.  You're biasing the normals toward where (I think) you've placed the light.</p>\n\n<p>If my theory is correct, then you need to flip the sphere normals so that they're pointing out rather than into the sphere.  A quick way to check is the subtract the center of the sphere from the intersection point, which should give you a vector pointing out, and you can then normalize that.  If that doesn't match the sphere normals you're currently computing (specifically, if the signs are all flipped), my theory would be confirmed.</p>\n\n<p>In that case, the solution is just to flip the sphere normal before computing the dot product.</p>\n\n<p>Finally, you're looping over the lights, but using only the contribution from the last light in the list.  (It's hard to tell exactly, because you've got some mismatched braces in the question.)</p>\n"}], "owner": {"reputation": 65, "user_id": 11038915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Tj6Zy2UscE/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNfSnrP4Z0SDvvMLTh-N_Yyt77JHg/mo/photo.jpg?sz=128", "display_name": "Benzait Sofiane", "link": "https://stackoverflow.com/users/11038915/benzait-sofiane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 57511252, "answer_count": 2, "score": 2, "last_activity_date": 1565895057, "creation_date": 1565170821, "question_id": 57391375, "link": "https://stackoverflow.com/questions/57391375/weird-direct-illumination-in-custom-problem", "title": "weird direct illumination in custom problem", "body": "<p>I am currently implementing a custom ray tracing renderer and I am stick with problem of direct illumination \nHere my result : </p>\n\n<p>normalOnLight\n<a href=\"https://i.stack.imgur.com/yVMxH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yVMxH.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>sphereNormal\n<a href=\"https://i.stack.imgur.com/LMBOd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LMBOd.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>max(normalOnLight.dot(sphereNormal), 0.0) \n<a href=\"https://i.stack.imgur.com/pPwTg.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pPwTg.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I do not understand the last result, i think the first and the second  are right but not the last (the dot..) \nthe light is a point light.</p>\n\n<pre><code>    const Vec4&lt;double&gt; LambertianSampler::radiance(const Ray&amp; ray, const Scene&amp; scene) const\n  {\n     Context ctx;\n     ctx.setCamtoWorld(scene.getCamera()-&gt;getLookAt());\n     Vec4&lt;double&gt; maxColor(1.0, 1.0, 1.0, 1.0);\n     Vec4&lt;double&gt; ambient(0.4, 0.4, 0.4, 1.0);\n\n     Vec4&lt;double&gt; finaleRadiance = ambient;\n     for(const auto &amp; light : scene.getLights())\n     {\n       for(const auto &amp; shape : scene.getShapes())\n       {\n          shape-&gt;intersect(ray, ctx);\n       }\n\n      if(ctx.intersectionFound())\n      {\n      Vec3&lt;double&gt; lightPosition = light-&gt;getPos();\n      Vec4&lt;double&gt; lightColor    = light-&gt;getRadiance();\n      Vec3&lt;double&gt; lightNormal   = ctx.getPoint() - lightPosition;\n      lightNormal = Vec3&lt;double&gt;(std::fabs(lightNormal.x()), std::fabs(lightNormal.y()), std::fabs(lightNormal.z()));\n      lightNormal.normalize();\n\n      Vec3&lt;double&gt; sphereNormal = ctx.getNormal();\n      sphereNormal   = Vec3&lt;double&gt;(std::fabs(sphereNormal.x()), std::fabs(sphereNormal.y()), std::fabs(sphereNormal.z())) ;\n      sphereNormal.normalize();\n\n      double dot     = lightNormal.dot(sphereNormal);\n      finaleRadiance = maxColor*std::max(0.0,dot);\n      finaleRadiance = Vec4&lt;double&gt;(finaleRadiance.x(), finaleRadiance.y(), finaleRadiance.z(), 1.0);\n\n      //finaleRadiance = Vec4&lt;double&gt;(sphereNormal.x(), sphereNormal.y(), sphereNormal.z(), 1.0);\n      //finaleRadiance = Vec4&lt;double&gt;(lightNormal.x(), lightNormal.y(), lightNormal.z(), 1.0);\n\n    }\n  }\n  return finaleRadiance;\n}\n</code></pre>\n\n<p>Do my dot result is right ? because i think my lightNormalOnSphere and sphereNormal are right i think ..</p>\n"}, {"tags": ["c++", "qt", "memory-leaks", "qt5", "valgrind"], "comments": [{"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 3, "creation_date": 1565174393, "post_id": 57391301, "comment_id": 101266854, "body": "For information, you don&#39;t have to explicitly destroy the widgets in your <code>app</code>&#39;s destructor. If the widgets are properly parented, Qt manages their destruction itself."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1565178711, "post_id": 57391301, "comment_id": 101269282, "body": "Looks like false positives at a glance.  Use a proper suppression file for valgrind."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1565178866, "post_id": 57391301, "comment_id": 101269361, "body": "Also, you don&#39;t have to use pointers at least for the question code, just put the widgets as member variables. They will be destructed before QObject destructor is reached, so they remove themselves and QObject doesn&#39;t try to delete them then. This is slightly more efficient (less heap allocation overhead)."}, {"owner": {"reputation": 2002, "user_id": 2763000, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a5ea0af3a37d8989110a8fb4c656efb2?s=128&d=identicon&r=PG&f=1", "display_name": "goug", "link": "https://stackoverflow.com/users/2763000/goug"}, "edited": false, "score": 0, "creation_date": 1565203207, "post_id": 57391301, "comment_id": 101282550, "body": "Valgrind has a setting to show details of the lost blocks. If you don&#39;t have that on, turn it on and see if it helps pinpoint the problem. If the memory loss is truly buried in a Qt class, that at least tells you it&#39;s not your problem to deal with."}, {"owner": {"reputation": 7319, "user_id": 2667360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKqx3.png?s=128&g=1", "display_name": "Benjamin T", "link": "https://stackoverflow.com/users/2667360/benjamin-t"}, "edited": false, "score": 0, "creation_date": 1565212300, "post_id": 57391301, "comment_id": 101286190, "body": "Also, Qt 5.7 is not maintained anymore. If the memory leak is a Qt bug, it might have been solved in one of the later versions."}, {"owner": {"reputation": 2660, "user_id": 8382929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feb63c4676da4621466f8c12e590b644?s=128&d=identicon&r=PG&f=1", "display_name": "Bayou", "link": "https://stackoverflow.com/users/8382929/bayou"}, "edited": false, "score": 0, "creation_date": 1565251470, "post_id": 57391301, "comment_id": 101296377, "body": "Qt 5.12.3 has this problem as well. If I add <code>--leak-check=full</code> to valgrind, it shows the blocks are lost due to some font mechanism in Qt."}, {"owner": {"reputation": 2126, "user_id": 3558278, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/bCVxE.jpg?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/3558278/deep"}, "edited": false, "score": 0, "creation_date": 1565635408, "post_id": 57391301, "comment_id": 101406483, "body": "Write new QWidget(this); new QPushButton(this); instead new QWidget(); new QPushButton(); and for all others."}], "owner": {"reputation": 2660, "user_id": 8382929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feb63c4676da4621466f8c12e590b644?s=128&d=identicon&r=PG&f=1", "display_name": "Bayou", "link": "https://stackoverflow.com/users/8382929/bayou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565170574, "creation_date": 1565170574, "question_id": 57391301, "link": "https://stackoverflow.com/questions/57391301/qstackedwidget-memory-leak-when-adding-qwidgets", "title": "QStackedWidget memory leak when adding QWidgets", "body": "<p>I'm learning Qt (5.7.1) and I have created a simple application with two buttons. If you press button A, the screen with button B becomes visible. The opposite happens when button B is pressed. </p>\n\n<p>When I test if I correctly destroyed every object, I came upon strange behaviour. Once a QWidget is added to a QStackedWidget, valgrind shows that I've definitely lost 4,480 bytes in 18 blocks, but I destroy every object that is created. </p>\n\n<p>The <a href=\"https://doc.qt.io/qt-5/qstackedwidget.html\" rel=\"nofollow noreferrer\">documentation for QStackedWidget</a> has a <code>removeWidget</code> method, but this doesn't solve the memory leaks.</p>\n\n<pre><code>==2265== HEAP SUMMARY:\n==2265==     in use at exit: 238,228 bytes in 4,113 blocks\n==2265==   total heap usage: 49,518 allocs, 45,405 frees, 5,951,803 bytes allocated\n==2265== \n==2265== LEAK SUMMARY:\n==2265==    definitely lost: 4,480 bytes in 18 blocks\n==2265==    indirectly lost: 1,377 bytes in 65 blocks\n==2265==      possibly lost: 0 bytes in 0 blocks\n==2265==    still reachable: 232,371 bytes in 4,030 blocks\n==2265==         suppressed: 0 bytes in 0 blocks\n</code></pre>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include &lt;QApplication&gt;\n#include &lt;app.h&gt;\n\nint main(int argc, char *argv[]) {\n        QApplication a(argc, argv);\n        app program;\n        program.show();\n        return a.exec();\n}\n</code></pre>\n\n<p><strong>app.h</strong></p>\n\n<pre><code>#ifndef TEST_APP\n#define TEST_APP\n\n#include &lt;QApplication&gt;\n#include &lt;QWidget&gt;\n#include &lt;QBoxLayout&gt;\n#include &lt;QStackedWidget&gt;\n#include &lt;QPushButton&gt;\n\nclass app : public QWidget {\n        Q_OBJECT\nprivate:\n        QHBoxLayout    *layout;\n        QStackedWidget *sites;\n\n        QWidget        *window_a;\n        QHBoxLayout    *layout_a;\n        QPushButton    *button_a;\n\n        QWidget        *window_b;\n        QHBoxLayout    *layout_b;\n        QPushButton    *button_b;\npublic:\n        app();\n        ~app();\n};\n\n#endif // TEST_APP\n</code></pre>\n\n<p><strong>app.cpp</strong></p>\n\n<pre><code>#include &lt;app.h&gt;\n\napp::app() : QWidget(0) {\n        QSize window_size(80, 80);\n        layout   = new QHBoxLayout(this);\n        sites    = new QStackedWidget();\n\n        window_a = new QWidget();\n        layout_a = new QHBoxLayout();\n        button_a = new QPushButton(\"Button A\", window_a);\n\n        window_b = new QWidget();\n        layout_b = new QHBoxLayout();\n        button_b = new QPushButton(\"Button B\", window_b);\n\n        sites-&gt;resize(window_size);\n        sites-&gt;setMaximumSize(window_size);\n        sites-&gt;setMinimumSize(window_size);\n        layout-&gt;addWidget(sites);\n\n        window_a-&gt;setLayout(layout_a);\n        layout_a-&gt;addWidget(button_a);\n        sites-&gt;addWidget(window_a);\n\n        window_b-&gt;setLayout(layout_b);\n        layout_b-&gt;addWidget(button_b);\n        sites-&gt;addWidget(window_b);\n\n        sites-&gt;setCurrentIndex(0);\n\n        connect(button_a, &amp;QPushButton::clicked, this, [this] { sites-&gt;setCurrentIndex(1); });\n        connect(button_b, &amp;QPushButton::clicked, this, [this] { sites-&gt;setCurrentIndex(0); });\n}\n\napp::~app() {\n        delete button_a;\n        delete button_b;\n        button_a = button_b = nullptr;\n\n        delete layout_a;\n        delete layout_b;\n        layout_a = layout_b = nullptr;\n\n        delete window_a;\n        delete window_b;\n\n        delete sites;\n        delete layout;\n}\n</code></pre>\n\n<p><strong>test.pro</strong></p>\n\n<pre><code>QT += core gui widgets\nCONFIG += c++14\nTARGET = test\nCONFIG += console\nCONFIG -= app_bundle\nQMAKE_CFLAGS += -g\nTEMPLATE = app\nSOURCES += main.cpp app.cpp\nHEADERS += app.h\nDEFINES += QT_DEPRECATED_WARNINGS\nFORMS +=\n</code></pre>\n"}, {"tags": ["c++", "c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 2, "creation_date": 1565170474, "post_id": 57391249, "comment_id": 101264709, "body": "Related:  <a href=\"https://stackoverflow.com/questions/55593936/c-multidimensional-array-in-existing-memory\">C++ Multidimensional array in existing memory</a>"}, {"owner": {"reputation": 97941, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1565172891, "post_id": 57391249, "comment_id": 101266038, "body": "Maybe pass the array through as <code>void*</code>? see <a href=\"https://ideone.com/zOeKcE\" rel=\"nofollow noreferrer\">ideone.com/zOeKcE</a>"}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1565178242, "post_id": 57391249, "comment_id": 101269042, "body": "Can&#39;t you use directly an <code>int **</code> instead of <code>int *</code> ? This way you will be able to use the <code>[][]</code> semantics. A simple <code>int *</code> cannot do it. If you really want to convert it, you will need to create an <code>int **</code> and copy the <code>int *</code> contents according to the matrix dimensions you need."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1565180295, "post_id": 57391249, "comment_id": 101270146, "body": "There is no such language as C/C++. You need to pick one. For a question anyway."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1565179038, "post_id": 57391811, "comment_id": 101269459, "body": "The strict aliasing rule says &quot;An object shall have its stored value accessed only by an lvalue expression that has one of the following types: ... - an aggregate or union type that includes one of the aforementioned types among its members&quot; So the array case is covered, an array being an aggregate type."}, {"owner": {"reputation": 88, "user_id": 8474352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a94e9ffcf6149c99c6efacf4970dac2c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/8474352/sergio"}, "edited": false, "score": 0, "creation_date": 1565268692, "post_id": 57391811, "comment_id": 101306072, "body": "And can I asume that a <code>int[m][n]</code> is guaranteed to have the same memory representation than an <code>int[m*n]</code>?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 88, "user_id": 8474352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a94e9ffcf6149c99c6efacf4970dac2c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/8474352/sergio"}, "edited": false, "score": 1, "creation_date": 1565269244, "post_id": 57391811, "comment_id": 101306427, "body": "@Sergio Yes. Arrays are unpadded. Check out <a href=\"https://stackoverflow.com/questions/1066681/can-c-arrays-contain-padding-in-between-elements\" title=\"can c arrays contain padding in between elements\">stackoverflow.com/questions/1066681/&hellip;</a>"}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1565172138, "creation_date": 1565172138, "answer_id": 57391811, "question_id": 57391249, "link": "https://stackoverflow.com/questions/57391249/convert-int-to-intn-in-c-c/57391811#57391811", "title": "Convert int* to int(*)[n] in C / C++", "body": "<p>I think that casting a pointer to an array pointer and subsequently using it ought not to be UB and that it technically isn't, as long as there's enough space where the pointer point. </p>\n\n<p>Pointer casts aren't UB provided you satisfy target alignment requirements. Pointer dereferences may be UB if they violate the strict aliasing rule. The caveat with array pointers, however, is that the strict aliasing rule only speaks about accesses through an lvalue of a given type and you can't ever use an lvalue of an array type for an access--you always end up accessing, presumably correctly typed, individual elements.</p>\n\n<p>In spite of that, I think explicit pointer arithmetic might be preferable in this case. It's most apparently UB-free, and it avoids pointer casts, which are very often dangerous and arguably should look jarring to most C/C++ programmers.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1565179412, "creation_date": 1565179412, "answer_id": 57394086, "question_id": 57391249, "link": "https://stackoverflow.com/questions/57391249/convert-int-to-intn-in-c-c/57394086#57394086", "title": "Convert int* to int(*)[n] in C / C++", "body": "<p><code>int (*mat)[5] = (int (*)[5])data;</code> is fine given that what's actually stored there is an <code>int[5]</code> array and nothing else. C is only concerned with the <em>effective type</em> of the object in memory.</p>\n\n<p>To do it without an explicit cast, you'd have to do some union hacking, which is only valid in C and not in C++:</p>\n\n<pre><code>typedef union\n{\n  int* ptr;\n  int(*arr)[5];\n}arr_t;\n\nint (*mat)[5] = (arr_t){ .ptr = data }.arr;\n</code></pre>\n\n<p>But that doesn't exactly improve readability so I wouldn't recommend it. Use a cast instead.</p>\n"}], "owner": {"reputation": 88, "user_id": 8474352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a94e9ffcf6149c99c6efacf4970dac2c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/8474352/sergio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1565179412, "creation_date": 1565170364, "last_edit_date": 1565171175, "question_id": 57391249, "link": "https://stackoverflow.com/questions/57391249/convert-int-to-intn-in-c-c", "title": "Convert int* to int(*)[n] in C / C++", "body": "<p>How can I convert a pointer to a \"pointer to array\"?\nAs an example, supose I have a pointer <code>int *data</code> to some memory block of 15 integers. I would like to do something like:</p>\n\n<pre><code>int (*mat)[5] = data;\n</code></pre>\n\n<p>so that I can now make:</p>\n\n<pre><code>for(int i = 0; i &lt; 3; i++){\n  for(int j = 0; j &lt; 5; j++){\n    mat[i][j] = // Something.\n  }\n}\n</code></pre>\n\n<p>However, I get a warning with gcc:</p>\n\n<pre><code>warning: initialization from incompatible pointer type [-Wincompatible-pointer-types]\n     int (*mat)[5] = data;\n</code></pre>\n\n<p>and an error with g++:</p>\n\n<pre><code>error: cannot convert \u2018int*\u2019 to \u2018int (*)[5]\u2019 in initialization\n     int (*mat)[5] = data;\n</code></pre>\n\n<p>If I add an explicit cast <code>int (*mat)[5] = (int (*)[5])data;</code> it compiles without warnings, but i don't know if this yields undefined behavior.</p>\n\n<p>What is the correct way to accomplish this? Can it be made without an explicit cast?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I know I can use the <code>int *</code> pointer like this:</p>\n\n<pre><code>data[5*i + j] = \\\\ Something.\n</code></pre>\n\n<p>but in my real situation I need to iterate the array through 3 dimensions,\nand the code inside the <code>[]</code> gets very long, thats why I want to use the\n<code>mat[i][j]</code> notation.</p>\n"}, {"tags": ["c++", "linux", "boost"], "answers": [{"comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1566643191, "post_id": 57417972, "comment_id": 101726775, "body": "Contrary to my claim, the async-signal-safety of boost backtace APIs are documented quite well, albeit in headers and other locations than the main doc page. Thanks for the links. There&#39;s no yes or no answer for async-signal-safety of Boost&#39;s backtrace APIs as it depends on the specific API - most of them are safe while others are not."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1566644055, "post_id": 57417972, "comment_id": 101726928, "body": "I think most of them are not, except for the <code>safe_</code>-family of functions which are documented to be"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 2, "last_activity_date": 1565285537, "last_edit_date": 1592644375, "creation_date": 1565285537, "answer_id": 57417972, "question_id": 57391179, "link": "https://stackoverflow.com/questions/57391179/is-boost-stacktrace-async-signal-safe/57417972#57417972", "title": "Is Boost stacktrace async signal safe?", "body": "<p><a href=\"https://www.boost.org/doc/libs/1_70_0/doc/html/stacktrace/getting_started.html#stacktrace.getting_started.handle_terminates_aborts_and_seg\" rel=\"nofollow noreferrer\">https://www.boost.org/doc/libs/1_70_0/doc/html/stacktrace/getting_started.html#stacktrace.getting_started.handle_terminates_aborts_and_seg</a> has:</p>\n<blockquote>\n<p><strong>Warning</strong>\nWriting a signal handler requires high attention! Only a few system calls allowed in signal handlers, so there's no cross platform way to print a stacktrace without a risk of deadlocking. The only way to deal with the problem - dump raw stacktrace into file/socket and parse it on program restart.</p>\n<p><strong>Warning</strong>\nNot all the platforms provide means for even getting stacktrace in async signal safe way. No stack trace will be saved on such platforms.</p>\n</blockquote>\n<p>Immediately followed by:</p>\n<pre><code>#include &lt;signal.h&gt; // ::signal, ::raise\n#include &lt;boost/stacktrace.hpp&gt;\n\nvoid my_signal_handler(int signum) {\n    ::signal(signum, SIG_DFL);\n    boost::stacktrace::safe_dump_to(&quot;./backtrace.dump&quot;);\n    ::raise(SIGABRT);\n}\n</code></pre>\n<p>It goes on with usage examples, and how to do start up checks</p>\n<p>Header synopis: <a href=\"https://www.boost.org/doc/libs/1_70_0/doc/html/stacktrace/reference.html#header.boost.stacktrace.safe_dump_to_hpp\" rel=\"nofollow noreferrer\">https://www.boost.org/doc/libs/1_70_0/doc/html/stacktrace/reference.html#header.boost.stacktrace.safe_dump_to_hpp</a></p>\n<pre><code>namespace boost {\n  namespace stacktrace {\n    std::size_t safe_dump_to(void *, std::size_t);\n    std::size_t safe_dump_to(std::size_t, void *, std::size_t);\n    std::size_t safe_dump_to(const char *);\n    std::size_t safe_dump_to(std::size_t, std::size_t, const char *);\n    std::size_t safe_dump_to(platform_specific_descriptor);\n    std::size_t safe_dump_to(std::size_t, std::size_t, \n                             platform_specific_descriptor);\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 9116566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wz1l6.jpg?s=128&g=1", "display_name": "Wahaj", "link": "https://stackoverflow.com/users/9116566/wahaj"}, "is_accepted": false, "score": 1, "last_activity_date": 1617952320, "last_edit_date": 1617952320, "creation_date": 1617880239, "answer_id": 67002771, "question_id": 57391179, "link": "https://stackoverflow.com/questions/57391179/is-boost-stacktrace-async-signal-safe/67002771#67002771", "title": "Is Boost stacktrace async signal safe?", "body": "<p><strong>Yes, it is</strong>.</p>\n<p>As, the function provided in boost library for dumping the backtrace is <code>boost::stacktrace::safe_dump_to</code>.</p>\n<p>And the <a href=\"https://www.boost.org/doc/libs/1_65_0/doc/html/boost/stacktrace/safe_dump_to_idp748512480.html\" rel=\"nofollow noreferrer\">documentation</a> of <code>safe_dump_to</code> clearly states <code>Async-Handler-Safety: Safe</code></p>\n"}], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 57417972, "answer_count": 2, "score": 3, "last_activity_date": 1617952320, "creation_date": 1565170171, "question_id": 57391179, "link": "https://stackoverflow.com/questions/57391179/is-boost-stacktrace-async-signal-safe", "title": "Is Boost stacktrace async signal safe?", "body": "<p>Boost has <a href=\"https://www.boost.org/doc/libs/1_65_1/doc/html/stacktrace.html\" rel=\"nofollow noreferrer\">boost::stacktrace::stacktrace()</a> that can be used to get backtraces. This is normally useful in non-signal handling contexts such as exceptions, errors, etc.</p>\n\n<p>But is it safe to be called from a signal handler? i.e., it doesn't do any async-signal-unsafe activities? The example does use it from a signal handler which might mean it is safe. But I can't find anything in its documentation about <a href=\"http://man7.org/linux/man-pages/man7/signal-safety.7.html\" rel=\"nofollow noreferrer\">async-signal-safety</a>.</p>\n"}, {"tags": ["c++", "class", "namespaces"], "comments": [{"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 3, "creation_date": 1565170363, "post_id": 57391143, "comment_id": 101264648, "body": "<code>class MySecondClass {};</code> should be <code>class MySecondClass;</code>"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 2, "creation_date": 1565170705, "post_id": 57391143, "comment_id": 101264843, "body": "In addition to Alan: <code>namespace MyNS { class MyClass; }</code> is an incomplete type aka a forward declaration. (This would fix your issue.) But with braces: <code>namespace MyNS { class MyClass { }; }</code> it becomes a complete type. Now, <code>class MyNS::MyClass { void print(); };</code> redefines the previous complete (class) type which is prohibited."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1565171145, "post_id": 57391143, "comment_id": 101265077, "body": "There seems to be a general mis-understanding. <code>MyClass.h</code> and <code>MyClass.cpp</code> let me think you want something like interface and implementation. So, the header should provide the class definition with full declaration <code>namespace MyNS { class MyClass { void print(); }; }</code> while <code>MyClass.cpp</code> provides the implementation: <code>void MyNS::MyClass::print() { std::cout &lt;&lt; &quot;anything&quot;; }</code> or <code>namespace MyNS { void MyClass::print() { std::cout &lt;&lt; &quot;anything&quot;; } }</code>."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1565171251, "post_id": 57391143, "comment_id": 101265127, "body": "If you instead intend to hide declaration details of <code>MyNS::MyClass</code> (what I could imagine alternatively) then have a look for the <a href=\"https://en.cppreference.com/w/cpp/language/pimpl\" rel=\"nofollow noreferrer\">PImpl idiom</a>."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 9722909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb4b6d9e96c4f5879973331baf24c7d?s=128&d=identicon&r=PG&f=1", "display_name": "deviloper", "link": "https://stackoverflow.com/users/9722909/deviloper"}, "edited": false, "score": 0, "creation_date": 1565184111, "post_id": 57391786, "comment_id": 101272549, "body": "One problem though. When I want to make a derived class, declare it in the header and define it in the cpp file, it gives me an error. <code>class or struct definition missing</code>"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 93, "user_id": 9722909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb4b6d9e96c4f5879973331baf24c7d?s=128&d=identicon&r=PG&f=1", "display_name": "deviloper", "link": "https://stackoverflow.com/users/9722909/deviloper"}, "edited": false, "score": 0, "creation_date": 1565193966, "post_id": 57391786, "comment_id": 101278322, "body": "@PhysicalExperience could you post the code with the derived class as a separate question, if you don\u2019t find similar questions related to namespace and derived classes ?"}], "tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": true, "score": 3, "last_activity_date": 1565173172, "last_edit_date": 1592644375, "creation_date": 1565172085, "answer_id": 57391786, "question_id": 57391143, "link": "https://stackoverflow.com/questions/57391143/c-class-type-redefinition/57391786#57391786", "title": "C++ - &#39;class&#39; type redefinition", "body": "<p>The problem is that in <code>MyClass.h</code> you define a class <code>MySecondClass</code> as an empty class.  When you the define your class  in MyClass.cpp you give a different definition, which contains some new members. This infringes the One Definition Rule (ODR).</p>\n<h2>Solution 1</h2>\n<p>remove <code>{}</code> in the header. This will tell the compiler that you declare that such a class exists but that it will be defined later. Your code would compile. Unfortunately if you\u2019d include the header in other cpp, these could make only a very very limited use of <code>MySecondClass</code>.</p>\n<h2>Solution 2</h2>\n<p>define in the header the class with all its members (but without providing the implementation of the member functions:the signature is sufficient). This would allow the class to be used in whichever cpp that\nwould include it:</p>\n<pre><code>// MyClass.h\n#pragma once\nnamespace MyNamespace {\n    class MySecondClass {\n    public:\n        void print(const char* msg);\n    };\n}\n</code></pre>\n<p>You\u2019d then define the members of the class in its cpp in the appropriate namespace:</p>\n<pre><code>// MyClass.cpp\n#include &lt;iostream&gt;\n#include &quot;MyClass.h&quot;\n\nusing namespace std;\n\nnamespace MyNamespace {\n    // member functions\n    void MySecondClass::print(const char* msg)\n    {\n        cout &lt;&lt; msg &lt;&lt; endl;\n    }\n}\n</code></pre>\n<p>Remark: the include sequence in the cpp should first include the standard library headers, then only your own headers. It makes no difference in your simple example, but  better get used the good practices immediately.</p>\n"}], "owner": {"reputation": 93, "user_id": 9722909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb4b6d9e96c4f5879973331baf24c7d?s=128&d=identicon&r=PG&f=1", "display_name": "deviloper", "link": "https://stackoverflow.com/users/9722909/deviloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 57391786, "answer_count": 1, "score": 1, "last_activity_date": 1565173172, "creation_date": 1565170062, "last_edit_date": 1565172398, "question_id": 57391143, "link": "https://stackoverflow.com/questions/57391143/c-class-type-redefinition", "title": "C++ - &#39;class&#39; type redefinition", "body": "<p>I made a smaller reproducible version of the code that gave me these errosr: <code>'MyNamespace::MySecondClass': 'class' type redefinition</code>, <code>'print': is not a member of 'MyNamespace::MySecondClass'</code>. Is there any way of working around this problem?</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// MyClass.h\n\n#pragma once\n\nnamespace MyNamespace {\n\n    class MySecondClass {};\n\n}\n\n// MyClass.cpp\n\n#include \"MyClass.h\"\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nclass MyNamespace::MySecondClass\n{\npublic:\n    void print(const char* msg)\n    {\n        cout &lt;&lt; msg &lt;&lt; endl;\n    }\n};\n</code></pre>\n"}]