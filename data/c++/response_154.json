[{"tags": ["c++", "visual-studio", "hash", "unordered-map", "overhead"], "comments": [{"owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 0, "creation_date": 1513813925, "post_id": 47915942, "comment_id": 82799979, "body": "How large do you expect the map to grow?"}, {"owner": {"reputation": 117, "user_id": 4286125, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9328597d455fe111d6355860d6bd27c8?s=128&d=identicon&r=PG&f=1", "display_name": "MoeKav", "link": "https://stackoverflow.com/users/4286125/moekav"}, "reply_to_user": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 0, "creation_date": 1513814074, "post_id": 47915942, "comment_id": 82800014, "body": "I have a limited set of possible keys (about 300) and the map does not grow more than 10 pairs"}, {"owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 0, "creation_date": 1513814190, "post_id": 47915942, "comment_id": 82800045, "body": "And how many times do you perform a lookup?"}, {"owner": {"reputation": 117, "user_id": 4286125, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9328597d455fe111d6355860d6bd27c8?s=128&d=identicon&r=PG&f=1", "display_name": "MoeKav", "link": "https://stackoverflow.com/users/4286125/moekav"}, "reply_to_user": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 0, "creation_date": 1513814253, "post_id": 47915942, "comment_id": 82800060, "body": "A lot. Like saying 300 times in each map..."}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1513819345, "post_id": 47915942, "comment_id": 82801278, "body": "There&#39;s not nearly enough information here for anyone to know where your performance problems are.  Profiling tools generally show you a call graph and how costly each call is though, so the only advice I can give you is to look through it and see where in your code you&#39;re doing more map operations than you need."}, {"owner": {"reputation": 117, "user_id": 4286125, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9328597d455fe111d6355860d6bd27c8?s=128&d=identicon&r=PG&f=1", "display_name": "MoeKav", "link": "https://stackoverflow.com/users/4286125/moekav"}, "edited": false, "score": 0, "creation_date": 1513819645, "post_id": 47915942, "comment_id": 82801333, "body": "What about using another data structure?"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1513820286, "post_id": 47915942, "comment_id": 82801476, "body": "Who knows.  My point is that there&#39;s not enough information in your question for anyone to tell you what your bottleneck is."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513820323, "post_id": 47915942, "comment_id": 82801487, "body": "@MoeKav Are you running a &quot;debug&quot; or unoptimized version of your program?  If so, then please run a release / optimized version.   It is practically a prerequisite when asking performance questions to post your build settings."}, {"owner": {"reputation": 117, "user_id": 4286125, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9328597d455fe111d6355860d6bd27c8?s=128&d=identicon&r=PG&f=1", "display_name": "MoeKav", "link": "https://stackoverflow.com/users/4286125/moekav"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513820680, "post_id": 47915942, "comment_id": 82801592, "body": "@PaulMcKenzie nope. Full optimization (-Ox)"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1513821312, "post_id": 47915942, "comment_id": 82801743, "body": "Since the top performance hit here is in the <code>[]</code> lookup with the map, show use the code where you&#39;re using that to access your map.  You seem to be adding lots of things into the map.  The hash function may also be helpful."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513822000, "post_id": 47915942, "comment_id": 82801882, "body": "@MoeKav -- <i>A lot. Like saying 300 times in each map..</i> -- Looking up a value in a hash table 300 times is not a lot, and I would say, it is practically nothing.  If you said 30,000 or 300,000 times, then that may make a difference."}, {"owner": {"reputation": 117, "user_id": 4286125, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9328597d455fe111d6355860d6bd27c8?s=128&d=identicon&r=PG&f=1", "display_name": "MoeKav", "link": "https://stackoverflow.com/users/4286125/moekav"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513822183, "post_id": 47915942, "comment_id": 82801929, "body": "@PaulMcKenzie yeah but the map is one of the arguments of a class I build 1milion times/sec. I mean one instance of that map is being accessed 300 times. But there are a LOT of maps I use and free the memory after my usage"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513822332, "post_id": 47915942, "comment_id": 82801949, "body": "@MoeKav -- Then you need to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  At least one where all that is required is to wrap a <code>for</code> loop around it to see how it performs."}, {"owner": {"reputation": 2361, "user_id": 7410358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b241c8238988d25da76f83adf9071201?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Langholtz", "link": "https://stackoverflow.com/users/7410358/louis-langholtz"}, "edited": false, "score": 0, "creation_date": 1513826495, "post_id": 47915942, "comment_id": 82802818, "body": "If the hash function you&#39;re using isn&#39;t returning good hashes or is taking a long time to return them, that&#39;d lower performance. Have you checked the uniformity of your hash function for the data you&#39;re using it for? Or looked into the time it takes to generate its values for the data? You can check the <code>load_factor</code> and see how high it is to get some insight. See also <a href=\"https://en.wikipedia.org/wiki/Hash_function#Hash_function_algorithms\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Hash_function#Hash_function_algorithms</a> . I suppose if what <code>s</code> is pointing to is say a longer string, that could also be problematic."}], "owner": {"reputation": 117, "user_id": 4286125, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9328597d455fe111d6355860d6bd27c8?s=128&d=identicon&r=PG&f=1", "display_name": "MoeKav", "link": "https://stackoverflow.com/users/4286125/moekav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513813760, "creation_date": 1513813760, "question_id": 47915942, "link": "https://stackoverflow.com/questions/47915942/unordered-map-overhead-with-string-as-key", "title": "unordered_map overhead with string as key", "body": "<p>I'm trying to improve the performance of a program. So I use the default profiling tools provided by Visual Studio.</p>\n\n<p>I have this declaration in my header file:</p>\n\n<pre><code>    unordered_map&lt;const char*, datad, hash_func, cmp&gt; arguments;\n</code></pre>\n\n<p>The hash function I use is BKDR hash algorithm and the datad is a simple union:</p>\n\n<pre><code>union datad\n{\n    long long d;\n    wchar_t* s;\n};\n</code></pre>\n\n<p>So after I analyze the performance, I see that we have a lot of CPU overhead on functions related to that unordered_map:\n<a href=\"https://i.stack.imgur.com/VvrSj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VvrSj.png\" alt=\"Click the image for a more clear view\"></a> </p>\n\n<p>What seems to be the problem? Can you suggest any improvements I can do to reduce the overhead of the map?</p>\n\n<p>p.s: My usage type is simply building the map, accessing the values by key and also iterating through them</p>\n"}, {"tags": ["c++", "string", "unicode", "utf"], "comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 5, "creation_date": 1513813001, "post_id": 47915811, "comment_id": 82799753, "body": "Why are you breaking them up into two strings? How much do you understand about programming? The compiler translates special sequences between quotes into Unicode characters (obviously at compile time). What are you really trying to accomplish?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1513813547, "post_id": 47915811, "comment_id": 82799888, "body": "&quot;<i>trying to find a way to display UTF-16 characters</i>&quot; - then use a UTF-16 string type, like <code>std::wstring</code> on Windows, or <code>std::u16string</code> in C++11 and later. And use an API that can display Unicode strings. What you are doing is not an even remotely correct way to handle Unicode strings in C++"}, {"owner": {"reputation": 35, "user_id": 7066848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QpqRW.png?s=128&g=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/7066848/aiden"}, "edited": false, "score": 0, "creation_date": 1513814085, "post_id": 47915811, "comment_id": 82800020, "body": "I was trying to create a function to return a character with code \\uXXXX by passing in XXXX. I just needed a way to parse \\u with XXXX to do this"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1513814343, "post_id": 47915811, "comment_id": 82800080, "body": "What encoding do you want it added in? <code>UTF8</code>?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1513814962, "post_id": 47915811, "comment_id": 82800230, "body": "<code>\\unnnn</code> (where <code>n</code> = <code>0-9A-F</code>) is a convention to add unicode code points to a string. The <i>format</i> those code points take depends on their <i>encoding</i>. What <i>encoding</i> do you want? <code>UTF-8</code>? <code>UTF-16</code>? <code>UTF-32</code>?"}, {"owner": {"reputation": 35, "user_id": 7066848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QpqRW.png?s=128&g=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/7066848/aiden"}, "edited": false, "score": 0, "creation_date": 1513816449, "post_id": 47915811, "comment_id": 82800620, "body": "Preferably UTF-16"}, {"owner": {"reputation": 41, "user_id": 11699519, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k615EKMBqdo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcKorgTudErmKOY1em2Gmb5dpyU1Q/photo.jpg?sz=128", "display_name": "Iro", "link": "https://stackoverflow.com/users/11699519/iro"}, "edited": false, "score": 0, "creation_date": 1561492207, "post_id": 47915811, "comment_id": 100079604, "body": "Maybe there is a solution: <a href=\"https://stackoverflow.com/questions/12015571/how-to-print-unicode-character-in-c/\" title=\"how to print unicode character in c\">stackoverflow.com/questions/12015571/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "is_accepted": false, "score": 2, "last_activity_date": 1513813311, "creation_date": 1513813311, "answer_id": 47915886, "question_id": 47915811, "link": "https://stackoverflow.com/questions/47915811/c-adding-u-to-string/47915886#47915886", "title": "c++ adding &quot;\\u&quot; to string", "body": "<p>You can't say <code>\"\\u\" + \"0000\"</code>, because the parsing of escape sequences happens early in the process, before the actual compilation begins. By the time the strings would be tacked together, escape sequences are already parsed and won't be again. And since <code>\\u</code> is not a valid escape sequence on its own, you get an error about it.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 9124890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128c56e8fd096085ddf3dac668724993?s=128&d=identicon&r=PG&f=1", "display_name": "user9124890", "link": "https://stackoverflow.com/users/9124890/user9124890"}, "is_accepted": true, "score": 1, "last_activity_date": 1513814465, "creation_date": 1513814465, "answer_id": 47916040, "question_id": 47915811, "link": "https://stackoverflow.com/questions/47915811/c-adding-u-to-string/47916040#47916040", "title": "c++ adding &quot;\\u&quot; to string", "body": "<p>What you're trying to do is not possible. C++ parsing is split into multiple phases. Per [lex.phases], escape sequences (in phase 5) are escaped <em>before</em> adjacent string literals are concatenated (phase 6). </p>\n"}, {"tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": false, "score": 0, "last_activity_date": 1513912403, "last_edit_date": 1513912403, "creation_date": 1513820118, "answer_id": 47916704, "question_id": 47915811, "link": "https://stackoverflow.com/questions/47915811/c-adding-u-to-string/47916704#47916704", "title": "c++ adding &quot;\\u&quot; to string", "body": "<p>You can't separate a <em>string literal</em> like that. The special sequence inside the quotes is a directive to the compiler to insert the relevant Unicode character at compile time so if you break it into two pieces it is no longer recognized as a directive.</p>\n\n<p>To <em>programatically</em> generate a <code>UTF-16</code> character based on its Unicode codepoint number you could use the Standard Library Unicode converson functions. Unfortunately there is no direct conversion between <code>UTF-32</code> (Unicode codepoints) and <code>UTF-16</code> so you have to go through <code>UTF-8</code> as an intermediate value:</p>\n\n<pre><code>// UTF-16 may contain either one or two char16_t characters so\n// we return a string to potentially contain both.\n///\nstd::u16string codepoint_to_utf16(char32_t cp)\n{\n    // convert UTF-32 (standard unicode codepoint) to UTF-8 intermediate value\n    char utf8[4];\n    char* end_of_utf8;\n\n    {\n        char32_t const* from = &amp;cp;\n\n        std::mbstate_t mbs;\n        std::codecvt_utf8&lt;char32_t&gt; ccv;\n\n        if(ccv.out(mbs, from, from + 1, from, utf8, utf8 + 4, end_of_utf8))\n            throw std::runtime_error(\"bad conversion\");\n    }\n\n    // Now convert the UTF-8 intermediate value to UTF-16\n\n    char16_t utf16[2];\n    char16_t* end_of_utf16;\n\n    {\n        char const* from = nullptr;\n\n        std::mbstate_t mbs;\n        std::codecvt_utf8_utf16&lt;char16_t&gt; ccv;\n\n        if(ccv.in(mbs, utf8, end_of_utf8, from, utf16, utf16 + 2, end_of_utf16))\n            throw std::runtime_error(\"bad conversion\");\n    }\n\n    return {utf16, end_of_utf16};\n}\n\nint main()\n{\n    std::u16string s; // can hold UTF-16\n\n    // iterate through some Greek codepoint values\n    for(char32_t u = 0x03b1; u &lt; 0x03c9; ++u)\n    {\n        // append the converted UTF-16 characters to our string\n        s += codepoint_to_utf16(u);\n    }\n\n    //  do whatever you want with s here...    \n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7066848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QpqRW.png?s=128&g=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/7066848/aiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2291, "favorite_count": 0, "accepted_answer_id": 47916040, "answer_count": 3, "score": -1, "last_activity_date": 1516554985, "creation_date": 1513812630, "last_edit_date": 1516554985, "question_id": 47915811, "link": "https://stackoverflow.com/questions/47915811/c-adding-u-to-string", "title": "c++ adding &quot;\\u&quot; to string", "body": "<p>Learning c++, trying to find a way to display UTF-16 characters by adding the 4 digits after the \"\\u\". But, for example, if I try to directly add 0000:</p>\n\n<pre><code>string temp = \"\\u\" + \"0000\";\n</code></pre>\n\n<p>I get the error: incorrectly formed universal character name. So is there a way to get these two to form one Unicode character? Also I realize that the end four numbers range from 0-F but for now I just want to focus on the 0-9 characters. </p>\n\n<p>How can I add\"\\u\" with a different string</p>\n\n<p>Edit: I was looking for the C++ equivalent of the JavaScript function:</p>\n\n<pre><code>String.fromCharCode()\n</code></pre>\n"}, {"tags": ["c++", "parallel-processing", "runtime-error", "mpi"], "answers": [{"tags": [], "owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "is_accepted": false, "score": 0, "last_activity_date": 1513816604, "last_edit_date": 1513816604, "creation_date": 1513815750, "answer_id": 47916184, "question_id": 47915778, "link": "https://stackoverflow.com/questions/47915778/mpi-group-excl-fatal-error-when-trying-to-exclude-process-rank-0-c/47916184#47916184", "title": "MPI_Group_excl fatal error when trying to exclude process rank 0. c++", "body": "<p>you did not use <code>MPI_Group_excl()</code> correctly.</p>\n\n<blockquote>\n  <p><strong>SYNTAX</strong></p>\n\n<pre><code>   int MPI_Group_excl(MPI_Group group, int n, const int ranks[],\n        MPI_Group *newgroup)\n</code></pre>\n  \n  <p><strong>INPUT PARAMETERS</strong></p>\n\n<pre><code>   n         Number of elements in array ranks (integer).\n\n   ranks     Array of integer ranks in group not to appear in newgroup.\n</code></pre>\n</blockquote>\n\n<p>since <code>ranks</code> is an array with one element, this is how you should update your call</p>\n\n<pre><code>MPI_Group_excl(orig_group, 1, ranks, &amp;new_group);\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9019331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0315f04a6645dacac4b097460f3c7122?s=128&d=identicon&r=PG&f=1", "display_name": "InDaTeez", "link": "https://stackoverflow.com/users/9019331/indateez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513816604, "creation_date": 1513812318, "last_edit_date": 1513815784, "question_id": 47915778, "link": "https://stackoverflow.com/questions/47915778/mpi-group-excl-fatal-error-when-trying-to-exclude-process-rank-0-c", "title": "MPI_Group_excl fatal error when trying to exclude process rank 0. c++", "body": "<p>Hello everyone i'm pretty new to coding in general and MPI.\n    I'm sure this must be a pretty silly mistake but i can't understand why this code:     </p>\n\n<pre><code>#include &lt;mpi.h&gt;\n\nint main(int arg, char** argvs) {\n    int rank, numOfProcess;\n    MPI_Init(&amp;arg, &amp;argvs);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;numOfProcess);\n\n    int ranks[1] = { 0 };\n    MPI_Group orig_group, new_group;\n    MPI_Comm new_comm;\n    MPI_Comm_group(MPI_COMM_WORLD, &amp;orig_group);\n    MPI_Group_excl(orig_group, numOfProcess - 1, ranks, &amp;new_group);\n    MPI_Comm_create(MPI_COMM_WORLD, new_group, &amp;new_comm);\n    MPI_Finalize();\n    return 0;\n}\n</code></pre>\n\n<p>gives me the following error:</p>\n\n<pre><code> $ mpiexec -n 3 Documents/Visual\\ Studio\\ 2015/Projects/MPImisc/Debug/MPImisc.exe\n\n job aborted:\n [ranks] message\n\n [0] fatal error\n Fatal error in MPI_Group_excl: Invalid rank, error stack:\n MPI_Group_excl(group=0x88000000, n=2, ranks=0x008FF800, \n new_group=0x008FF7E8) failed\n Invalid rank in rank array at index 1; value is -858993460 but must be in \n the range 0 to 2\n\n [1] fatal error\n Fatal error in MPI_Group_excl: Invalid rank, error stack:\n MPI_Group_excl(group=0x88000000, n=2, ranks=0x012FF860, \n new_group=0x012FF848) failed\n Invalid rank in rank array at index 1; value is -858993460 but must be in \n the range 0 to 2\n\n[2] fatal error\nFatal error in MPI_Group_excl: Invalid rank, error stack:\nMPI_Group_excl(group=0x88000000, n=2, ranks=0x012FFB10, \nnew_group=0x012FFAF8) failed\nInvalid rank in rank array at index 1; value is -858993460 but must be in \nthe range 0 to 2\n\n---- error analysis -----\n\n[0-2] on ASUSPC\nmpi has detected a fatal error and aborted Documents/Visual Studio \n2015/Projects/MPImisc/Debug/MPImisc.exe\n\n---- error analysis -----\n</code></pre>\n\n<p>Correct me if i'm wrong but the \"new_group\" that i'm creating should contain every process but the one with rank 0.\nWhy is it giving me this error? i specified in the array \"ranks\" that i want to remove the rank 0, i'm lost.</p>\n\n<p>thanks very much.</p>\n"}, {"tags": ["c++", "matrix"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1513812430, "post_id": 47915747, "comment_id": 82799604, "body": "You will be in for more pain by using pointers instead of <code>std::vector&lt;double&gt; d;</code>"}, {"owner": {"reputation": 1377, "user_id": 1445572, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/4VjxA.jpg?s=128&g=1", "display_name": "Guilherme Salom&#233;", "link": "https://stackoverflow.com/users/1445572/guilherme-salom%c3%a9"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513812526, "post_id": 47915747, "comment_id": 82799626, "body": "@PaulMcKenzie I&#39;m following a book on C++ and finance (by Schlogl), it might be outdated. Thanks for pointing that out!"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513812599, "post_id": 47915747, "comment_id": 82799652, "body": "Don&#39;t know if it&#39;s outdated or just using outdated teaching style.  What you have now is not adequate for a Matrix class if your intent is to start copying, returning, or passing <code>Matrix</code> objects around.  Read up on the rule of 3/5/0."}, {"owner": {"reputation": 1377, "user_id": 1445572, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/4VjxA.jpg?s=128&g=1", "display_name": "Guilherme Salom&#233;", "link": "https://stackoverflow.com/users/1445572/guilherme-salom%c3%a9"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513812682, "post_id": 47915747, "comment_id": 82799677, "body": "@PaulMcKenzie Good to know that! I will try to find some other source for that. If you have any recommendations please let me know! Thanks for your help! It also might be just an example of how to create a Class in c++."}], "answers": [{"tags": [], "owner": {"reputation": 942, "user_id": 2012809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IF0o7.png?s=128&g=1", "display_name": "Omni", "link": "https://stackoverflow.com/users/2012809/omni"}, "is_accepted": true, "score": 2, "last_activity_date": 1513812358, "creation_date": 1513812358, "answer_id": 47915781, "question_id": 47915747, "link": "https://stackoverflow.com/questions/47915747/simple-matrix-class-error-calling-private-constructor/47915781#47915781", "title": "Simple Matrix class, error: calling private constructor", "body": "<p>By default, the access to properties/methods of a class is private. Add a <code>public:</code> statement in your class:</p>\n\n<pre><code>class Matrix {\n    int r; // number of rows\n    int c; // number of columns\n    double* d; // array of doubles to hold matrix values\npublic:    \n    Matrix(int nrows, int ncols, double ini = 0.0);\n    ~Matrix();\n}\n</code></pre>\n"}], "owner": {"reputation": 1377, "user_id": 1445572, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/4VjxA.jpg?s=128&g=1", "display_name": "Guilherme Salom&#233;", "link": "https://stackoverflow.com/users/1445572/guilherme-salom%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 47915781, "answer_count": 1, "score": 0, "last_activity_date": 1513812358, "creation_date": 1513812147, "question_id": 47915747, "link": "https://stackoverflow.com/questions/47915747/simple-matrix-class-error-calling-private-constructor", "title": "Simple Matrix class, error: calling private constructor", "body": "<p>I am learning C++ and trying to construct a simple Matrix class. The basic case I have defines the Matrix class as:</p>\n\n<pre><code>class Matrix {\n    int r; // number of rows\n    int c; // number of columns\n    double* d; // array of doubles to hold matrix values\n    Matrix(int nrows, int ncols, double ini = 0.0);\n    ~Matrix();\n}\n</code></pre>\n\n<p>And the constructor/destructor are:</p>\n\n<pre><code>Matrix::Matrix(int nrows, int ncols, double ini) {\n    r = nrows;\n    c = ncols;\n    d = new double[nrows*ncols];\n    for (int i = 0; i &lt; nrows*ncols; i++) d[i] = ini;\n}\nMatrix::~Matrix() {\n    delete[] d;\n}\n</code></pre>\n\n<p><strong>Problem:</strong> when I instantiate the class Matrix by calling <code>Matrix my_matrix(2,3)</code>, I get the following errors: <code>error: calling a private constructor of class 'Matrix'</code>,<code>error: variable of type 'Matrix' has private destructor</code>.</p>\n\n<p><strong>Question:</strong> Why is this happening? How can I understand what is failing? Could someone point me towards the solution/reading materials to help me understand this problem. Thanks for helping!</p>\n"}, {"tags": ["c++", "sockets", "netbeans"], "comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1513812298, "post_id": 47915707, "comment_id": 82799569, "body": "If it compiles when you remove the header then why do you need it?"}, {"owner": {"reputation": 281, "user_id": 4359339, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9438768541c0882db7edab110ffb63a0?s=128&d=identicon&r=PG&f=1", "display_name": "Osagie Odigie", "link": "https://stackoverflow.com/users/4359339/osagie-odigie"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1513812460, "post_id": 47915707, "comment_id": 82799613, "body": "@Kelvin i need the SOCKET handle defined in the header. without which connection cannot be made. not forgetting that, this is just a test code"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1513812830, "post_id": 47915707, "comment_id": 82799715, "body": "Not sure if I&#39;d call it a duplicate but you might want to check <a href=\"https://stackoverflow.com/questions/5719727/cygwin-windows-socket-programming\">this</a> out"}, {"owner": {"reputation": 1121, "user_id": 4005852, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w5vp4.jpg?s=128&g=1", "display_name": "Cong Ma", "link": "https://stackoverflow.com/users/4005852/cong-ma"}, "edited": false, "score": 1, "creation_date": 1513812908, "post_id": 47915707, "comment_id": 82799733, "body": "You need to include winsock2.h before windows.h. See <a href=\"https://stackoverflow.com/questions/1372480/c-redefinition-header-files-winsock2-h\">C++ Redefinition Header Files (winsock2.h)</a>"}, {"owner": {"reputation": 281, "user_id": 4359339, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9438768541c0882db7edab110ffb63a0?s=128&d=identicon&r=PG&f=1", "display_name": "Osagie Odigie", "link": "https://stackoverflow.com/users/4359339/osagie-odigie"}, "reply_to_user": {"reputation": 1121, "user_id": 4005852, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w5vp4.jpg?s=128&g=1", "display_name": "Cong Ma", "link": "https://stackoverflow.com/users/4005852/cong-ma"}, "edited": false, "score": 0, "creation_date": 1513813392, "post_id": 47915707, "comment_id": 82799857, "body": "@Cong Ma, tried as you said, same error."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1513813711, "post_id": 47915707, "comment_id": 82799928, "body": "Why do you need <code>&lt;windows.h&gt;</code> there?"}, {"owner": {"reputation": 281, "user_id": 4359339, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9438768541c0882db7edab110ffb63a0?s=128&d=identicon&r=PG&f=1", "display_name": "Osagie Odigie", "link": "https://stackoverflow.com/users/4359339/osagie-odigie"}, "reply_to_user": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1513813968, "post_id": 47915707, "comment_id": 82799990, "body": "@Killzone Kid, actually plans to make some api calls that need &lt;windows.h&gt;. with or without it however, it still fails."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1513818787, "post_id": 47915707, "comment_id": 82801146, "body": "Cygwin seems to be the problem here, specifically its <code>winsock2.h</code> file. Try the one in the Windows SDK."}], "owner": {"reputation": 281, "user_id": 4359339, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9438768541c0882db7edab110ffb63a0?s=128&d=identicon&r=PG&f=1", "display_name": "Osagie Odigie", "link": "https://stackoverflow.com/users/4359339/osagie-odigie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 596, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513812328, "creation_date": 1513811874, "last_edit_date": 1513812328, "question_id": 47915707, "link": "https://stackoverflow.com/questions/47915707/socket-h-fails-to-compile-because-of-winsock2-h-inclusion", "title": "socket.h fails to compile because of &lt;winsock2.h&gt; inclusion", "body": "<p>i am using Netbeans 8.1 IDE with g++ compiler (cygwin) to \nbuild a custome Socket class whose implementation is well defined\nin socket.cpp, and declared in socket.h as shown below:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>//socket.h\r\n\r\n#ifndef SOCKET_H\r\n#define SOCKET_H\r\n  \r\n#include &lt;windows.h&gt;\r\n#include &lt;winsock2.h&gt;     /*Code builds successfully if this line is commented. errors otherwise*/\r\n\r\nclass Socket {\r\n    \r\npublic: \r\n    Socket(){std::cout &lt;&lt; \"Testing: Inside socket constructor ...\" &lt;&lt; endl;}\r\n    Socket(const Socket&amp;);\r\n    virtual ~Socket();\r\n    Socket&amp; operator=(Socket&amp;);\r\n    \r\n    void Close();\r\n\r\nprotected: \r\n\r\n    Socket(SOCKET s);   /*Windows socket handle, defined in &lt;winsock2.h&gt;*/\r\n     \r\n    SOCKET s_;\r\n\r\n    int* refCounter_;\r\n\r\nprivate:\r\n    static bool Start();\r\n    static void End();\r\n    static int nofSockets_;\r\n\r\n};\r\n\r\n#endif /* SOCKET_H */</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>now, i test-drove it like this:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>//main.cpp\r\n\r\n#include \"socket.h\"\r\n\r\nint main() {\r\n    Socket socket;\r\n    return 0;\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Above code built successfully when winsock2.h is removed, error otherwise.\nHonestly i am new to the netbeans IDE and i can't understand what am doing\nwrong. I Dont know what the IDE requires of me either. i need your help to\ndebugg this please. Thanks. Here's the error: </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>cd 'C:\\wamp\\www\\klandestine'\r\nC:\\cygwin64\\bin\\make.exe -f Makefile CONF=Debug clean\r\n\"/usr/bin/make\" -f nbproject/Makefile-Debug.mk QMAKE= SUBPROJECTS= .clean-conf\r\nmake[1]: Entering directory '/cygdrive/c/wamp/www/klandestine'\r\nrm -f -r build/Debug\r\nrm -f dist/Debug/Cygwin-Windows/klandestine.exe\r\nmake[1]: Leaving directory '/cygdrive/c/wamp/www/klandestine'\r\n\r\nCLEAN SUCCESSFUL (total time: 656ms)\r\ncd 'C:\\wamp\\www\\klandestine'\r\nC:\\cygwin64\\bin\\make.exe -f Makefile CONF=Debug\r\n\"/usr/bin/make\" -f nbproject/Makefile-Debug.mk QMAKE= SUBPROJECTS= .build-conf\r\nmake[1]: Entering directory '/cygdrive/c/wamp/www/klandestine'\r\n\"/usr/bin/make\"  -f nbproject/Makefile-Debug.mk dist/Debug/Cygwin-Windows/klandestine.exe\r\nmake[2]: Entering directory '/cygdrive/c/wamp/www/klandestine'\r\nmkdir -p build/Debug/Cygwin-Windows\r\nrm -f \"build/Debug/Cygwin-Windows/main.o.d\"\r\ng++    -c -g -MMD -MP -MF \"build/Debug/Cygwin-Windows/main.o.d\" -o build/Debug/Cygwin-Windows/main.o main.cpp\r\nIn file included from /usr/include/w32api/winsock2.h:56:0,\r\n                 from socket.h:12,\r\n                 from main.cpp:14:\r\n/usr/include/w32api/psdk_inc/_fd_types.h:100:2: warning: #warning \"fd_set and associated macros have been defined in sys/types.      This can cause runtime problems with W32 sockets\" [-Wcpp]\r\n #warning \"fd_set and associated macros have been defined in sys/types.  \\\r\n  ^\r\nIn file included from socket.h:12:0,\r\n                 from main.cpp:14:\r\n/usr/include/w32api/winsock2.h:995:123: error: conflicting declaration of C function 'int select(int, _types_fd_set*, _types_fd_set*, _types_fd_set*, PTIMEVAL)'\r\n   WINSOCK_API_LINKAGE int WSAAPI select(int nfds,fd_set *readfds,fd_set *writefds,fd_set *exceptfds,const PTIMEVAL timeout);\r\n                                                                                                                           ^\r\nIn file included from /usr/include/sys/types.h:68:0,\r\n                 from /usr/include/pthread.h:14,\r\n                 from /usr/lib/gcc/x86_64-pc-cygwin/5.3.0/include/c++/x86_64-pc-cygwin/bits/gthr-default.h:35,\r\n                 from /usr/lib/gcc/x86_64-pc-cygwin/5.3.0/include/c++/x86_64-pc-cygwin/bits/gthr.h:148,\r\n                 from /usr/lib/gcc/x86_64-pc-cygwin/5.3.0/include/c++/ext/atomicity.h:35,\r\n                 from /usr/lib/gcc/x86_64-pc-cygwin/5.3.0/include/c++/bits/ios_base.h:39,\r\n                 from /usr/lib/gcc/x86_64-pc-cygwin/5.3.0/include/c++/ios:42,\r\n                 from /usr/lib/gcc/x86_64-pc-cygwin/5.3.0/include/c++/ostream:38,\r\n                 from /usr/lib/gcc/x86_64-pc-cygwin/5.3.0/include/c++/iostream:39,\r\n                 from main.cpp:9:\r\n/usr/include/sys/select.h:73:5: note: previous declaration 'int select(int, _types_fd_set*, _types_fd_set*, _types_fd_set*, timeval*)'\r\n int select __P ((int __n, fd_set *__readfds, fd_set *__writefds,\r\n     ^\r\nmake[2]: *** [nbproject/Makefile-Debug.mk:69: build/Debug/Cygwin-Windows/main.o] Error 1\r\nmake[2]: Leaving directory '/cygdrive/c/wamp/www/klandestine'\r\nmake[1]: *** [nbproject/Makefile-Debug.mk:60: .build-conf] Error 2\r\nmake[1]: Leaving directory '/cygdrive/c/wamp/www/klandestine'\r\nmake: *** [nbproject/Makefile-impl.mk:40: .build-impl] Error 2\r\n\r\nBUILD FAILED (exit value 2, total time: 3s)</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["c++", "opengl", "glsl"], "comments": [{"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1513812608, "post_id": 47915665, "comment_id": 82799654, "body": "This is just a random guess: Could it be that it has something to do with uniform locations? If you only use t but not cosT, then the LightPos uniform might get optimized away. I could, for example, imaging a case where you override the SandSampler uniform when you try to set LightPos. Similar things could also happen with varyings (vertexNormal_worldSpace optimized away when cosT not used)."}, {"owner": {"reputation": 6020, "user_id": 4052193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6062c93ce987aa90ac59d06e758f03b6?s=128&d=identicon&r=PG&f=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/4052193/columbo"}, "edited": false, "score": 0, "creation_date": 1513814814, "post_id": 47915665, "comment_id": 82800186, "body": "Is your code perhaps assuming the location of TextureSampler is 0 and SandSampler is 1 because that&#39;s the order of declaration?"}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 1, "creation_date": 1513820881, "post_id": 47915665, "comment_id": 82801643, "body": "Edit in a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 59, "user_id": 4233298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e9fabfd80dbe1067acff55a31af2dc?s=128&d=identicon&r=PG&f=1", "display_name": "jcg", "link": "https://stackoverflow.com/users/4233298/jcg"}, "edited": false, "score": 0, "creation_date": 1513847183, "post_id": 47915665, "comment_id": 82810310, "body": "I don&#39;t think I could simplify this code any further since all of it is directly related to the problem I am having."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 4233298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e9fabfd80dbe1067acff55a31af2dc?s=128&d=identicon&r=PG&f=1", "display_name": "jcg", "link": "https://stackoverflow.com/users/4233298/jcg"}, "edited": false, "score": 0, "creation_date": 1513847052, "post_id": 47918834, "comment_id": 82810247, "body": "In this case, I do want component-wise multiplication, since my 1D texture is a gradient and my 2D texture is a grayscale texture, I am hoping for a textured effect over a gradient. Using <code>mix()</code> gives the expected result for <code>mix(t,t2,0.5)</code> but then multiplying this by <code>cosT</code> removes the component given by <code>t</code> again. <code>cosT</code> is definitely not 0, since I have limited it to <code>[0.3,1]</code>. Using a color picker on a screenshot shows that the pixels are completely black, even when both of my textures have been set to <i>completely white</i> so even in a worst case, I should get a dark gray."}], "tags": [], "owner": {"reputation": 3615, "user_id": 975724, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/o10HS.jpg?s=128&g=1", "display_name": "Nicholas Miller", "link": "https://stackoverflow.com/users/975724/nicholas-miller"}, "is_accepted": false, "score": 0, "last_activity_date": 1513836116, "creation_date": 1513836116, "answer_id": 47918834, "question_id": 47915665, "link": "https://stackoverflow.com/questions/47915665/glsl-computed-fragment-color-comes-out-black-despite-inputs-having-correct-value/47918834#47918834", "title": "GLSL Computed Fragment color comes out black despite inputs having correct values", "body": "<p>You say you've tested <code>cosT</code>, <code>t.rgb</code>, and <code>t2.rgb</code>. Well if these are indeed correct, we need to look at the last line:</p>\n\n<pre><code>color= cosT * t.rgb*t2.rgb;\n</code></pre>\n\n<p>The reason your color is black <em>must</em> be because the RGB values are being set to zero.<br/>\n<em><sub>Alternatively, it could be due to code that wasn't posted causing these fragments to fail <a href=\"https://www.khronos.org/opengl/wiki/Per-Sample_Processing\" rel=\"nofollow noreferrer\">per-sample operations &amp; tests</a>, or perhaps you're running into one of those wacky vendor-specific limitations for your fragment shader. But I'm going to trust that the problem is in the fragment shader...</sub></em></p>\n\n<p>Your first assignment for <code>cosT</code> is limiting its values between 0 and 1.  This is fine.</p>\n\n<p>My bets are that your issue lies with this multiplication:</p>\n\n<pre><code>t.rgb*t2.rgb;\n</code></pre>\n\n<p>According to <a href=\"http://learnwebgl.brown37.net/12_shader_language/glsl_mathematical_operations.html\" rel=\"nofollow noreferrer\">GLSL operators</a>, you're performing a component-wise vector multiplication, so:</p>\n\n<pre><code>t.rgb*t2.rgb = (t.r * t2.r, t.g * t2.g, t.b *t2.b)\n</code></pre>\n\n<p>Now, what would this do? Assuming your RGB colors fall in the range <code>[0..1]</code>, then you are always going to end up with a smaller value (e.g. <code>0.1 * 0.7 = 0.07</code>).</p>\n\n<p>Furthermore, if you multiply that smaller value by a another number, <code>cosT</code>, which will be between <code>[0..1]</code>, then the result is even closer to 0. If not already black, it will be close.\n<hr>\nWhen you say you need to blend your colors, my belief is that component-wise vector multiplication is <strong><em>NOT</em></strong> what you want.</p>\n\n<p>Instead consider using the <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/mix.xhtml\" rel=\"nofollow noreferrer\"><code>mix</code> function</a> or using a weighted average. This will interpolate your colors.</p>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 4233298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e9fabfd80dbe1067acff55a31af2dc?s=128&d=identicon&r=PG&f=1", "display_name": "jcg", "link": "https://stackoverflow.com/users/4233298/jcg"}, "is_accepted": true, "score": 0, "last_activity_date": 1513847796, "creation_date": 1513847796, "answer_id": 47921632, "question_id": 47915665, "link": "https://stackoverflow.com/questions/47915665/glsl-computed-fragment-color-comes-out-black-despite-inputs-having-correct-value/47921632#47921632", "title": "GLSL Computed Fragment color comes out black despite inputs having correct values", "body": "<p>I solved the problem myself, the issue was with my code for binding the textures rather than the shader itself, which somehow worked with one texture at a time but not with 2 textures. The code:</p>\n\n<pre><code>glActiveTexture(GL_TEXTURE0);\nglBindTexture(GL_TEXTURE_1D,TextureID);\nglUniform1i(TextureID,0);\n\nglActiveTexture(GL_TEXTURE1);\nglBindTexture(GL_TEXTURE_2D,SandTextureID);\nglUniform1i(SandTextureID,1);\n</code></pre>\n\n<p>By changing the value in <code>glBindTexture</code> :</p>\n\n<pre><code>glActiveTexture(GL_TEXTURE0);\nglBindTexture(GL_TEXTURE_1D,Texture);\nglUniform1i(TextureID,0);\n\nglActiveTexture(GL_TEXTURE1);\nglBindTexture(GL_TEXTURE_2D,SandTexture);\nglUniform1i(SandTextureID,1);\n</code></pre>\n\n<p>The code now works. I was passing the uniform location into the texture, rather than the texture location, which resulted in strange behaviour.</p>\n"}], "owner": {"reputation": 59, "user_id": 4233298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e9fabfd80dbe1067acff55a31af2dc?s=128&d=identicon&r=PG&f=1", "display_name": "jcg", "link": "https://stackoverflow.com/users/4233298/jcg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "accepted_answer_id": 47921632, "answer_count": 2, "score": 0, "last_activity_date": 1520876930, "creation_date": 1513811506, "last_edit_date": 1520876930, "question_id": 47915665, "link": "https://stackoverflow.com/questions/47915665/glsl-computed-fragment-color-comes-out-black-despite-inputs-having-correct-value", "title": "GLSL Computed Fragment color comes out black despite inputs having correct values", "body": "<p>My fragment shader is as follows:</p>\n\n<pre><code>#version 330 core\nout vec3 color;\nin float U;\nin vec2 UV;\nin vec4 vertexNormal_worldSpace;\nuniform sampler1D TextureSampler;\nuniform sampler2D SandSampler;\nuniform vec4 LightPos;\nvoid main()\n{\n    float cosT = 0.3+clamp(dot(normalize(vertexNormal_worldSpace.xyz),normalize(LightPos.xyz)),0.0,0.7);\n    vec3 t = texture(SandSampler,UV).rgb;\n    vec3 t2 = texture(TextureSampler,U).rgb;\n    color= cosT * t.rgb*t2.rgb;\n}\n</code></pre>\n\n<p>In this code, <code>TextureSampler</code> is a 256x1 texture, <code>SandSampler</code> is a 512x512 texture.</p>\n\n<p>I am expecting the resulting color to be a blend between the colors from <code>t</code> and <code>t2</code>, multiplied by the value of <code>cosT</code> (a value to calculate lighting). Instead, I get all black. I have tested <code>cosT</code>, <code>t.rgb</code> and <code>t2.rgb</code> to confirm they  contain the correct values and display independently as intended, and I have also checked that my UV coordinates are correct. I can combine <code>cosT</code> and <code>t2.rgb</code> to produce a correct result: <code>color= cosT * t2.rgb;</code> or I can simply have <code>color = t.rgb;</code> which also produces a correct result, however including <code>t.rgb</code> in any way results in an all black result.</p>\n\n<p>The code <code>color = vec3(cosT,t.g,0);</code> produces the correct value of <code>cosT</code> in the red component, however no green is visible whatsoever. The code <code>color = vec3(0,t.g,0);</code> then produces the correct green component of my texture.</p>\n"}, {"tags": ["c++", "error-handling", "return", "c++17"], "comments": [{"owner": {"reputation": 12139, "user_id": 2412846, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eBJip.gif?s=128&g=1", "display_name": "davidhigh", "link": "https://stackoverflow.com/users/2412846/davidhigh"}, "edited": false, "score": 1, "creation_date": 1513811696, "post_id": 47915481, "comment_id": 82799398, "body": "Have you heard of execptions?"}, {"owner": {"reputation": 1121, "user_id": 4005852, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w5vp4.jpg?s=128&g=1", "display_name": "Cong Ma", "link": "https://stackoverflow.com/users/4005852/cong-ma"}, "edited": false, "score": 2, "creation_date": 1513813121, "post_id": 47915481, "comment_id": 82799781, "body": "std::optional in C++17 or boost::optional"}, {"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1513813291, "post_id": 47915481, "comment_id": 82799819, "body": "The use of the <code>throw</code> keyword."}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 0, "creation_date": 1513813292, "post_id": 47915481, "comment_id": 82799820, "body": "This is exactly the kind of exceptional situation that exceptions are designed to handle. <a href=\"https://stackoverflow.com/questions/8480640/how-to-throw-a-c-exception\" title=\"how to throw a c exception\">stackoverflow.com/questions/8480640/how-to-throw-a-c-excepti&zwnj;&#8203;on</a>"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1513815115, "post_id": 47915481, "comment_id": 82800281, "body": "On way is exception handling. The other is returning a <code>Result</code> object, which could contain all information about the result. If everything went fine, it can contain the result, if failure, it can contain the reason. C++17 has <code>[[nodiscard]]</code>, so it is harder to forget to check a result."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1513815270, "post_id": 47915481, "comment_id": 82800322, "body": "<a href=\"https://isocpp.org/blog/2012/12/systematic-error-handling-in-c-andrei-alexandrescu\" rel=\"nofollow noreferrer\">isocpp.org/blog/2012/12/&hellip;</a>"}, {"owner": {"reputation": 2897, "user_id": 3392714, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/302ac6bfbe982dcd53aa123f9bde72eb?s=128&d=identicon&r=PG&f=1", "display_name": "dani", "link": "https://stackoverflow.com/users/3392714/dani"}, "edited": false, "score": 0, "creation_date": 1513853718, "post_id": 47915481, "comment_id": 82814395, "body": "I did considered exceptions but i think it&#39;s not really a good fit. I use exceptions as an way to prevent abnormal behaviour, failure in this case is not abnormal. It might be unlikely or occur seldom, but it&#39;s absolutely possible that a <code>Piece</code> does not fit and finding that out is part of the game."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 9124890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128c56e8fd096085ddf3dac668724993?s=128&d=identicon&r=PG&f=1", "display_name": "user9124890", "link": "https://stackoverflow.com/users/9124890/user9124890"}, "is_accepted": false, "score": 1, "last_activity_date": 1513815668, "creation_date": 1513815668, "answer_id": 47916179, "question_id": 47915481, "link": "https://stackoverflow.com/questions/47915481/what-should-a-function-return-that-can-fail/47916179#47916179", "title": "What should a function return that can fail?", "body": "<p>From what I can gather, it seems like neither exceptions or \"returning\" are appropriate for your situation. In your question you talk about \"returning a result\" but your particular code example/use case suggests that that the algorithm should not halt or be interrupted if a \"bad piece\" is used. Both exceptions and \"returning\" from a function will result in more complex control flow, and in some cases, more complex state handling depending on how you deal with exceptions.</p>\n\n<p>If you choose the exception route, I suggest modeling your \"reporting\" classes after <a href=\"http://en.cppreference.com/w/cpp/header/system_error\" rel=\"nofollow noreferrer\">system_error</a>. </p>\n\n<p>If you choose a non-control flow route, I suggest pushing an error code and other meta data about the piece (if the piece itself is too expensive to copy around) into another data structure where it can be consumed.</p>\n\n<p>What you choose to do depends on whether or not the bad piece requires immediate action. If it doesn't, exceptions are not the way to go since that implies it needs to be handled at some point. </p>\n"}], "owner": {"reputation": 2897, "user_id": 3392714, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/302ac6bfbe982dcd53aa123f9bde72eb?s=128&d=identicon&r=PG&f=1", "display_name": "dani", "link": "https://stackoverflow.com/users/3392714/dani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1513815668, "creation_date": 1513810234, "last_edit_date": 1513811603, "question_id": 47915481, "link": "https://stackoverflow.com/questions/47915481/what-should-a-function-return-that-can-fail", "title": "What should a function return that can fail?", "body": "<p>My question is a bit vague and that is at least partially intentional. I'm looking for early advice about interface design, future expansion and easy to test-interfaces and not too much about exact code. Although, if it's a solution/advice that applies especially to C++(17), then that's perfect. </p>\n\n<p>I've a simulation that solves a hard combinatorial problem. The simulation propagates step by step to a solution. But sometimes, a step is a dead end (or appears as such). For example, in the pseudo code below, the <code>while</code> loop propagates the simulation by feeding it with pieces. There there can be a case where a 'Piece' can not be used to propagate the simulation. E.g. it's to expensive, it's a piece that simply does not fit or the for what ever reason. Failure is a normal behaviour that can arise an no reason to abort.</p>\n\n<pre><code>while(!allNotHandledPieced.empty())\n{\n  auto nextPiece = allNotHandledPieces.back();\n  allNotHandledPieces.pop_back();\n  auto status = simulation.propagate(nextPiece);\n  if(status == 0)\n    next; // ok\n  else if (status == 1)\n    dropPieceDueToTooBadStatus();\n}\n</code></pre>\n\n<p>Actually, for the 'simulation' it doesn't matter why it failed. The state is still valid, there is no problem with using another piece, it can just continue. But later, I might see the need to know why the 'propagate' method failed. Then it might make sense to have a meaningful return value on failure.</p>\n\n<p>Is there a <strong>good way to return 'failure'</strong>? Is there a <strong>best practice</strong> for situations like this?</p>\n"}, {"tags": ["c++", "list", "boost", "boost-intrusive"], "answers": [{"comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 1, "creation_date": 1513821750, "post_id": 47916746, "comment_id": 82801822, "body": "Added demos with and without auto-unlink mode; also some stylistic tips"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1513821820, "post_id": 47916746, "comment_id": 82801845, "body": "Uhhh <i>facepalm</i>"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 2, "creation_date": 1513821887, "post_id": 47916746, "comment_id": 82801855, "body": "We&#39;ve all been there. In good news, your question code was excellent. Clean, to the point and self-contained. Keep on slaying :)"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1513828766, "post_id": 47916746, "comment_id": 82803362, "body": "Interesting construction of the <code>ostream_iterator</code>.  Can&#39;t upvote more than once lol but \ud83d\udc4d\ud83c\udffb"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 3, "last_activity_date": 1513821720, "last_edit_date": 1513821720, "creation_date": 1513820499, "answer_id": 47916746, "question_id": 47915472, "link": "https://stackoverflow.com/questions/47915472/how-to-erase-while-iterating-boostintrusivelist/47916746#47916746", "title": "How to erase while iterating boost::intrusive::list", "body": "<p>Your problem is that you have pushed temporaries into the list:</p>\n\n<pre><code>for (auto ele : vec) {\n    list.push_back(ele);\n}\n</code></pre>\n\n<p>You probably meant to write:</p>\n\n<pre><code>for (auto&amp; ele : vec) {\n    list.push_back(ele);\n}\n</code></pre>\n\n<p>This is <em>classic</em> confusion when starting to work with intrusive containers: nothing is by value like all the with all the standard library containers.</p>\n\n<p>To avoid situations like this, consider using the auto-unlinking hook mode.</p>\n\n<h2>Demo</h2>\n\n<p>Even safer than having to think about reference-qualifying the loop variable, is having no loop at all:</p>\n\n<pre><code>boost::intrusive::list&lt;X&gt; list(vec.begin(), vec.end());\n</code></pre>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/902c1de07755a8e7\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iterator&gt;\n#include &lt;vector&gt;\n#include &lt;boost/intrusive/list.hpp&gt;\n\nstruct X : public boost::intrusive::list_base_hook&lt;&gt; {\n    X(int a_in) : a{a_in} {}\n    int a;\n\n    friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, X const&amp; x) { return os &lt;&lt; \"{\" &lt;&lt; x.a &lt;&lt; \"}\"; }\n};\n\nint main() {\n    std::ostream_iterator&lt;X&gt; out(std::cout &lt;&lt; std::unitbuf, \" \");\n\n    std::vector&lt;X&gt; vec { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };\n    boost::intrusive::list&lt;X&gt; list(vec.begin(), vec.end());\n\n    std::cout &lt;&lt; \"before: \"; std::copy(list.begin(), list.end(), out);\n\n    list.remove_if([](X const&amp; x) { return 0 == (x.a % 2); });\n\n    std::cout &lt;&lt; \"\\nafter: \"; std::copy(list.begin(), list.end(), out);\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>before: {1} {2} {3} {4} {5} {6} {7} {8} {9} {10} \nafter: {1} {3} {5} {7} {9} \n</code></pre>\n\n<h2>With <code>auto_unlink</code>:</h2>\n\n<pre><code>struct X : public bi::list_base_hook&lt;bi::link_mode&lt;bi::auto_unlink&gt; &gt; {\n</code></pre>\n\n<blockquote>\n  <p><em>Note, you need to disable constant-time <code>size()</code> support for the <code>list&lt;&gt;</code></em> (see <a href=\"http://www.boost.org/doc/libs/1_66_0/doc/html/intrusive/auto_unlink_hooks.html#intrusive.auto_unlink_hooks.auto_unlink_and_constant_time\" rel=\"nofollow noreferrer\">reference</a>)</p>\n</blockquote>\n\n<p>With that in place, even adding</p>\n\n<pre><code>vec.erase(vec.begin()+4);\n</code></pre>\n\n<p>will correctly unlink the corresponding node from the intrusive list:</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/9d02f28356dcd89f\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iterator&gt;\n#include &lt;vector&gt;\n#include &lt;boost/intrusive/list.hpp&gt;\n\nnamespace bi = boost::intrusive;\n\nstruct X : public bi::list_base_hook&lt;bi::link_mode&lt;bi::auto_unlink&gt; &gt; {\n    X(int a_in) : a{a_in} {}\n    int a;\n\n    friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, X const&amp; x) { return os &lt;&lt; \"{\" &lt;&lt; x.a &lt;&lt; \"}\"; }\n};\n\nint main() {\n    std::ostream_iterator&lt;X&gt; out(std::cout &lt;&lt; std::unitbuf, \" \");\n\n    std::vector&lt;X&gt; vec { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };\n    bi::list&lt;X, bi::constant_time_size&lt;false&gt; &gt; list(vec.begin(), vec.end());\n\n    std::cout &lt;&lt; \"before: \"; std::copy(list.begin(), list.end(), out);\n\n    list.remove_if([](X const&amp; x) { return 0 == (x.a % 2); });\n\n    std::cout &lt;&lt; \"\\nafter: \"; std::copy(list.begin(), list.end(), out);\n\n    vec.erase(vec.begin()+4);\n    std::cout &lt;&lt; \"\\nauto-unlinked: \"; std::copy(list.begin(), list.end(), out);\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>before: {1} {2} {3} {4} {5} {6} {7} {8} {9} {10} \nafter: {1} {3} {5} {7} {9} \nauto-unlinked: {1} {3} {6} {8} {10} \n</code></pre>\n"}], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 1, "accepted_answer_id": 47916746, "answer_count": 1, "score": 2, "last_activity_date": 1513821720, "creation_date": 1513810195, "question_id": 47915472, "link": "https://stackoverflow.com/questions/47915472/how-to-erase-while-iterating-boostintrusivelist", "title": "How to erase while iterating boost::intrusive::list", "body": "<p>How can I erase elements from a <code>boost::intrusive::list</code> while iterating through it?  The following code fails with an assertion failure <a href=\"https://wandbox.org/permlink/nzFshFSsaIrvBiTa\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/nzFshFSsaIrvBiTa</a></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;boost/intrusive/list.hpp&gt;\n\nusing std::cout;\nusing std::endl;\n\nclass Integer : public boost::intrusive::list_base_hook&lt;&gt; {\npublic:\n    explicit Integer(int a_in) : a{a_in} {}\n    int a;\n};\n\nint main() {\n    auto vec = std::vector&lt;Integer&gt;{};\n    vec.push_back(Integer{1});\n    vec.push_back(Integer{2});\n    vec.push_back(Integer{3});\n    auto list = boost::intrusive::list&lt;Integer&gt;{};\n    for (auto ele : vec) {\n        list.push_back(ele);\n    }\n\n    for (auto it = list.begin(); it != list.end();) {\n        if (it-&gt;a == 2) {\n            it = list.erase(it);\n        } else {\n            ++it;\n        }\n    }\n\n    for (auto ele : list) {\n        cout &lt;&lt; ele.a &lt;&lt; endl;\n    }\n}\n</code></pre>\n"}, {"tags": ["java", "c++", "jar"], "comments": [{"owner": {"reputation": 9984, "user_id": 1361506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5527d6bb829d75befe914163f5e8cf60?s=128&d=identicon&r=PG", "display_name": "azurefrog", "link": "https://stackoverflow.com/users/1361506/azurefrog"}, "edited": false, "score": 2, "creation_date": 1513809142, "post_id": 47915284, "comment_id": 82798657, "body": "<code>int result = system(&quot;&#47;path&#47;to&#47;java -jar &#47;path&#47;to&#47;jarfile [args...]&quot;);</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1513813782, "creation_date": 1513813782, "answer_id": 47915950, "question_id": 47915284, "link": "https://stackoverflow.com/questions/47915284/trigger-java-jar-to-run-with-c-and-pass-a-string/47915950#47915950", "title": "Trigger Java JAR to run with C++ and pass a String", "body": "<p>You need to call the jar using this line: <code>system(\"java filename.jar [args]\");</code></p>\n\n<p>Also in the java file you have to do something like this:</p>\n\n<pre><code>String str = \"\";\nfor(int i = 0; i&lt;args.length;i++) str += args[i]; \nSystem.out.println(\"Got\" + str + \"from the C++ program\");\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 6515947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15a083dae19eb5514c1e16a43ee598b?s=128&d=identicon&r=PG", "display_name": "DeBukkIt", "link": "https://stackoverflow.com/users/6515947/debukkit"}, "is_accepted": false, "score": 0, "last_activity_date": 1513847155, "creation_date": 1513847155, "answer_id": 47921488, "question_id": 47915284, "link": "https://stackoverflow.com/questions/47915284/trigger-java-jar-to-run-with-c-and-pass-a-string/47921488#47921488", "title": "Trigger Java JAR to run with C++ and pass a String", "body": "<p>The answer by Jake Freeman was basically right. However, I have two little things that should be changed in the snippets of code:</p>\n\n<ol>\n<li>Do not call \"java\" if you are not sure that the environment variable\nof the same name actually points to the Java directory. Otherwise,\nuse the full path to your desired JRE java.exe. However, this will\nmake your program less flexible if you want it to be run by other\nusers, as they will not be able to customize the path (perhaps only\nvia a configuration file?).</li>\n<li><p>The proposed for-loop destroys any spaces that normally\nseparate the arguments in the command line. So here's a suggestion\nthat kepps the separating spaces and makes all arguments pass into a\nString:</p>\n\n<pre><code>public static void main(String[] args) {\n    String argumentString = \"\";\n    for(int i = 0; i &lt; args.length(); i++) {\n        argumentString += args[i] + \" \";\n    }\n    argumentString = argumentString.trim();\n\n    System.out.println(\"Got \" + argumentString + \" from the C++ program\");\n}\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 405, "user_id": 1299477, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40e1138483537ad709cf9081a77a4fcc?s=128&d=identicon&r=PG", "display_name": "Eri.", "link": "https://stackoverflow.com/users/1299477/eri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1513847155, "creation_date": 1513809003, "question_id": 47915284, "link": "https://stackoverflow.com/questions/47915284/trigger-java-jar-to-run-with-c-and-pass-a-string", "title": "Trigger Java JAR to run with C++ and pass a String", "body": "<p>Lets imagine I have the following two very simple code snippets in C++ and Java:</p>\n\n<p><strong>C++</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\nstring str = \"Hello Java from C++\";\ncout &lt;&lt; str &lt;&lt; endl;\n\nWhen reaching here, while running this C++ program, I would like to trigger the program to run my JAR and send str as a argument so the Java program can take it and set it as a String.\n\nreturn 0; \n}\n</code></pre>\n\n<p><strong>Java</strong></p>\n\n<pre><code>public class HelloWorld {\n\npublic static void main(String[] args) {\n    String str = argumentFromJAR; //take argument from the JAR and set it as a String\n    System.out.println(\"Got\" + str + \"from the C++ program\");\n}\n}\n</code></pre>\n\n<p>When executing the C++ program, I want it to run a JAR-file and pass it as String as an argument. The JAR is already created and somehow I want to get this String to end up in Java. </p>\n\n<p>I would be happy for your help! And oh, btw, I will run the C++ program with g++ on CentOS if that matters (Java is also installed and tested).</p>\n"}, {"tags": ["c++", "cuda"], "comments": [{"owner": {"reputation": 347, "user_id": 2636126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5561f643436ab19165d68130a5705df8?s=128&d=identicon&r=PG", "display_name": "merelyMark", "link": "https://stackoverflow.com/users/2636126/merelymark"}, "edited": false, "score": 0, "creation_date": 1513810118, "post_id": 47915127, "comment_id": 82798965, "body": "What do you expect the result to be?"}], "answers": [{"tags": [], "owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "is_accepted": true, "score": 1, "last_activity_date": 1513810939, "last_edit_date": 1513810939, "creation_date": 1513810300, "answer_id": 47915489, "question_id": 47915127, "link": "https://stackoverflow.com/questions/47915127/cuda-atomicadd-produce-wrong-result-even-after-the-result-param-is-initialized/47915489#47915489", "title": "CUDA atomicAdd produce wrong result even after the result param is initialized", "body": "<p>The error in your original code is here</p>\n\n<pre><code>cudaMemcpy(dev_str1, &amp;str1, 20 * sizeof(char), cudaMemcpyHostToDevice);\ncudaMemcpy(dev_str2, &amp;str2, 20 * sizeof(char), cudaMemcpyHostToDevice);\n</code></pre>\n\n<p>That is not the correct signature.  The correct signature is</p>\n\n<pre><code>cudaMemcpy(void * dst, const void * src, size_t count, enum cudaMemcpyKind kind)\n</code></pre>\n\n<p>and you are calling it with <code>const void ** src</code>.   Even after correcting it, this will copy a lot of garbage because your string only has three characters.  A more or less correct code would be</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n__global__\nvoid getHammingDistance(char *str1, char *str2, int *result)\n{\n    int idx = blockIdx.x*blockDim.x+threadIdx.x;\n\n    if (idx &lt; 3)\n    {\n        if (str1[idx] != str2[idx])\n        {\n            atomicAdd(result, 1);\n\n        }\n    }\n}\n\nint getDist()\n{\n\n    char *dev_str1, *dev_str2;\n    int *dev_result;\n    int blockSize = 1024;\n    int gridSize = (int) ceil((float) 4 / blockSize);\n    int result = 0;\n\n\n    char str1[] = \"AAA\";\n    char str2[] = \"ATG\";\n    int size = strlen(str1);\n\n\n    cudaMalloc(&amp;dev_str1, 3 * sizeof(char));\n    cudaMalloc(&amp;dev_str2, 3 * sizeof(char));\n    cudaMalloc(&amp;dev_result, sizeof(int));\n\n    cudaMemcpy(dev_str1, str1, 3 * sizeof(char), cudaMemcpyHostToDevice);\n    cudaMemcpy(dev_str2, str2, 3 * sizeof(char), cudaMemcpyHostToDevice);\n    cudaMemcpy(dev_result, &amp;result,  sizeof(int), cudaMemcpyHostToDevice);\n\n    getHammingDistance&lt;&lt;&lt;gridSize, blockSize&gt;&gt;&gt;(dev_str1, dev_str2, dev_result);\n    cudaDeviceSynchronize();\n    cudaMemcpy(&amp;result, dev_result, sizeof(int), cudaMemcpyDeviceToHost);\n\n    std::cout &lt;&lt; result &lt;&lt; \"\\n\";\n    cudaFree(dev_str1);\n    cudaFree(dev_str2);\n    cudaFree(dev_result);\n\n    return result;\n}\n\nint main() {\n    getDist();\n}\n</code></pre>\n\n<hr>\n\n<p>Better use Thrust.  Same speed, less code, less error-prone.</p>\n\n<pre><code>#include &lt;cassert&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\n#include &lt;thrust/device_vector.h&gt;\n#include &lt;thrust/inner_product.h&gt;\n\nstruct HammingDistance {\n    __host__ __device__ int operator()(char x, char y) const {\n        return (x != y) ? 1 : 0;\n    }\n};\n\nint getDist(std::string const &amp;str1, std::string const &amp;str2)\n{\n    assert(str1.size() == str2.size());\n\n    thrust::device_vector&lt;char&gt; str1_dev(str1.begin(), str1.end());\n    thrust::device_vector&lt;char&gt; str2_dev(str2.begin(), str2.end());\n\n    int init = 0;\n    return thrust::inner_product(str1_dev.begin(), str1_dev.end(), str2_dev.begin(),\n                                 init, thrust::plus&lt;int&gt;{}, HammingDistance{});\n}\n\nint main() {\n    std::string str1 = \"AAA\";\n    std::string str2 = \"ATG\";\n\n    std::cout &lt;&lt; getDist(str1, str2) &lt;&lt; \"\\n\";\n}\n</code></pre>\n"}], "owner": {"reputation": 1291, "user_id": 1034595, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e829485ce1fbae5005f66e482be10d82?s=128&d=identicon&r=PG", "display_name": "snnlankrdsm", "link": "https://stackoverflow.com/users/1034595/snnlankrdsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 47915489, "answer_count": 1, "score": 0, "last_activity_date": 1513810939, "creation_date": 1513808056, "question_id": 47915127, "link": "https://stackoverflow.com/questions/47915127/cuda-atomicadd-produce-wrong-result-even-after-the-result-param-is-initialized", "title": "CUDA atomicAdd produce wrong result even after the result param is initialized", "body": "<p>atomicAdd produces wrong result. I even initialize the <em>result</em> in device but still not working. Why is that?</p>\n\n<p>Here's the function I call:</p>\n\n<pre><code>__global__\nvoid getHammingDistance(char *str1, char *str2, int *result)\n{\n    int idx = blockIdx.x*blockDim.x+threadIdx.x;\n\n    if (idx &lt; 3)\n    {\n        if (str1[idx] != str2[idx])\n        {\n            atomicAdd(result, 1);\n\n        }\n    }\n}\n</code></pre>\n\n<p>But atomicAdd gives wrong result.</p>\n\n<pre><code>int getDist()\n{\n\n    int k = 9;\n    int min = INT_MAX;\n    char *dev_str1, *dev_str2;\n    int *dev_result;\n    int blockSize = 1024;\n    int gridSize = (int) ceil((float) 4 / blockSize);\n    int result = 0;\n\n\n    char *str1 = \"AAA\";\n    char *str2 = \"ATG\";\n\n\n    cudaMalloc((void**) &amp;dev_str1, sizeof(char)  *20);\n    cudaMalloc((void**) &amp;dev_str2, sizeof(char)  * 20);\n    cudaMalloc((void**) &amp;dev_result, sizeof(int) * 10);\n\n    cudaMemcpy(dev_str1, &amp;str1, 20 * sizeof(char), cudaMemcpyHostToDevice);\n    cudaMemcpy(dev_str2, &amp;str2, 20 * sizeof(char), cudaMemcpyHostToDevice);\n    cudaMemcpy(dev_result, &amp;result,  10 * sizeof(int), cudaMemcpyHostToDevice);\n\n    getHammingDistance&lt;&lt;&lt;gridSize, blockSize&gt;&gt;&gt;(dev_str1, dev_str2, dev_result);\n    cudaMemcpy(&amp;result, dev_result, 10 * sizeof(int), cudaMemcpyDeviceToHost);\n\n    cout &lt;&lt; result;\n    cudaFree(dev_str1);\n    cudaFree(dev_str2);\n    cudaFree(dev_result);\n\n\n    return result;\n} \n</code></pre>\n\n<p>Why is that? It supposed to work.</p>\n"}, {"tags": ["c++", "c++11", "gcc4.8"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1513808129, "post_id": 47915034, "comment_id": 82798311, "body": "what do you think <code>std::chrono::steady_clock::now()</code> represents? hint: subtracting 10 from that number will not change much"}, {"owner": {"reputation": 2916, "user_id": 3646096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUofm.jpg?s=128&g=1", "display_name": "M&#225;rio Feroldi", "link": "https://stackoverflow.com/users/3646096/m%c3%a1rio-feroldi"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513808422, "post_id": 47915034, "comment_id": 82798425, "body": "@Fureeish they&#39;re probably asking if something in the standard changed that affects the behavior of <code>sleep_until</code>."}, {"owner": {"reputation": 63, "user_id": 9124671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/236b63e737da5cc28d96649b56ffa2f9?s=128&d=identicon&r=PG&f=1", "display_name": "R. Taukulis", "link": "https://stackoverflow.com/users/9124671/r-taukulis"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513841139, "post_id": 47915034, "comment_id": 82807318, "body": "@Fureeish Question edited. It was unclear on what is the expected behavior."}], "answers": [{"tags": [], "owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "is_accepted": true, "score": 5, "last_activity_date": 1513808781, "creation_date": 1513808781, "answer_id": 47915242, "question_id": 47915034, "link": "https://stackoverflow.com/questions/47915034/c11-stdthis-threadsleep-until-hangs-when-compiled-with-gcc-4-8-5/47915242#47915242", "title": "C++11 std::this_thread::sleep_until() hangs when compiled with GCC 4.8.5", "body": "<p>This is a confirmed bug that was fixed in gcc 4.9.</p>\n\n<p><a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=58038\" rel=\"noreferrer\">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=58038</a></p>\n\n<blockquote>\n  <p>When using sleep_until() I get an bug with unsigned long scalar representations of a duration. If this duratoiin is in past, then you get an overflow in the length of the argument for sleep_for(). This causes an almost infinte sleep, instead of a fast return.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "is_accepted": false, "score": 4, "last_activity_date": 1513808817, "creation_date": 1513808817, "answer_id": 47915255, "question_id": 47915034, "link": "https://stackoverflow.com/questions/47915034/c11-stdthis-threadsleep-until-hangs-when-compiled-with-gcc-4-8-5/47915255#47915255", "title": "C++11 std::this_thread::sleep_until() hangs when compiled with GCC 4.8.5", "body": "<p>This case is considered by the Standard and according to it <code>sleep_until</code> should move on. Seems its a bug in GCC 4.8.5</p>\n\n<p><a href=\"https://timsong-cpp.github.io/cppwp/n4659/thread.req.timing\" rel=\"nofollow noreferrer\">[33.2.4  Timing specifications]</a></p>\n\n<blockquote>\n  <p>The member functions whose names end in _until take an argument that specifies a time point. \n  These functions produce absolute timeouts. Implementations should use the clock specified in \n  the time point to measure time for these functions. Given a clock time point argument Ct, the \n  clock time point of the return from timeout should be <code>Ct + Di + Dm</code> when the clock is not \n  adjusted during the timeout. If the clock is adjusted to the time Ca during the timeout, the \n  behavior should be as follows: </p>\n  \n  <ul>\n  <li>if Ca > Ct, <strong>the waiting function should wake as soon as possible</strong>, (...), since the timeout\n  is already satisfied. [ Note: This specification may result in the total duration of the wait decreasing when measured against a steady clock. \u2014 end note ]\n  \u2014 if <code>Ca &lt; Ct</code>, ...</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 63, "user_id": 9124671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/236b63e737da5cc28d96649b56ffa2f9?s=128&d=identicon&r=PG&f=1", "display_name": "R. Taukulis", "link": "https://stackoverflow.com/users/9124671/r-taukulis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 702, "favorite_count": 0, "accepted_answer_id": 47915242, "answer_count": 2, "score": 6, "last_activity_date": 1513835554, "creation_date": 1513807587, "last_edit_date": 1513835554, "question_id": 47915034, "link": "https://stackoverflow.com/questions/47915034/c11-stdthis-threadsleep-until-hangs-when-compiled-with-gcc-4-8-5", "title": "C++11 std::this_thread::sleep_until() hangs when compiled with GCC 4.8.5", "body": "<p>Consider the following program:</p>\n\n<pre><code>#include &lt;chrono&gt;\n#include &lt;thread&gt;\n\nint main() {\n    std::this_thread::sleep_until(std::chrono::steady_clock::now() - std::chrono::seconds(10));\n\n    return 0;\n}\n</code></pre>\n\n<p>When compiled with GCC 4.8.5, it will hang. When compiled with GCC 4.9 and above or clang3.4 and above, it returns immediately, </p>\n\n<p>Why would it hang? As I understand, GCC 4.8.5 fully supports C++11 standard.</p>\n"}, {"tags": ["c++", "c++11", "initializer-list"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 3, "creation_date": 1513807339, "post_id": 47914973, "comment_id": 82797982, "body": "<a href=\"http://en.cppreference.com/w/cpp/utility/initializer_list\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/utility/initializer_list</a>"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 2, "creation_date": 1513807527, "post_id": 47914973, "comment_id": 82798065, "body": "In the current standard. Here is the <a href=\"http://en.cppreference.com/w/cpp/links\" rel=\"nofollow noreferrer\">link</a> to downloadable drafts."}], "answers": [{"comments": [{"owner": {"reputation": 1070, "user_id": 6074306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd660b5800c023de3b30c914112f09c3?s=128&d=identicon&r=PG&f=1", "display_name": "n.caillou", "link": "https://stackoverflow.com/users/6074306/n-caillou"}, "edited": false, "score": 0, "creation_date": 1513809626, "post_id": 47915039, "comment_id": 82798802, "body": "Side question: since the constructor of <code>std::initializer_list</code> takes a <code>const T*</code>, how does the compiler manage the lifetime of the underlying <code>T[]</code> ? Is there code somewhere that explicits that were&#39;re not taking the address of a temporary, or is it handled directly by the compiler as a special case? (Like for a range-based for? I&#39;m not sure if this makes sense.)"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 1070, "user_id": 6074306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd660b5800c023de3b30c914112f09c3?s=128&d=identicon&r=PG&f=1", "display_name": "n.caillou", "link": "https://stackoverflow.com/users/6074306/n-caillou"}, "edited": false, "score": 1, "creation_date": 1513809951, "post_id": 47915039, "comment_id": 82798902, "body": "@n.caillou, The constructor does not take a <code>const T*</code> as input. The compiler processes the tokens at compile time and generates code to construct an object of type <code>std::initializer_list&lt;T&gt;</code> of the right size."}, {"owner": {"reputation": 1070, "user_id": 6074306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd660b5800c023de3b30c914112f09c3?s=128&d=identicon&r=PG&f=1", "display_name": "n.caillou", "link": "https://stackoverflow.com/users/6074306/n-caillou"}, "edited": false, "score": 0, "creation_date": 1513811625, "post_id": 47915039, "comment_id": 82799376, "body": "I guess this sort of answers the question\u2014compilers treat it as a special case\u2014but (and this is clearly implementation-dependent) at least for GCC this involves a private constructor <code>initializer_list(T* arr, size_t len)</code>. Also <code>std::initializer_list</code> seems copyable, but doing so does not copy the array. Anyway, given than an underlying array exists, its lifetime must be managed somehow."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 1070, "user_id": 6074306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd660b5800c023de3b30c914112f09c3?s=128&d=identicon&r=PG&f=1", "display_name": "n.caillou", "link": "https://stackoverflow.com/users/6074306/n-caillou"}, "edited": false, "score": 1, "creation_date": 1513812036, "post_id": 47915039, "comment_id": 82799491, "body": "@n.caillou, for better or worse, the standard does not dictate how an implementation chooses to construct an <code>intializer_list</code> given a list of tokens enclosed in <code>{}</code>. The standard does dictate that <i>Copying an <code>initializer list</code> does not copy the underlying elements.</i> See <a href=\"https://timsong-cpp.github.io/cppwp/n3337/support.initlist#2\" rel=\"nofollow noreferrer\">timsong-cpp.github.io/cppwp/n3337/support.initlist#2</a>."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 9, "last_activity_date": 1513809747, "last_edit_date": 1513809747, "creation_date": 1513807634, "answer_id": 47915039, "question_id": 47914973, "link": "https://stackoverflow.com/questions/47914973/what-does-a-c-compiler-do-with-this-initializer-list/47915039#47915039", "title": "What does a C++ compiler do with this initializer list?", "body": "<p>You are creating an instance of <code>std::initializer_list&lt;int&gt;</code>. See <a href=\"http://en.cppreference.com/w/cpp/utility/initializer_list\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/utility/initializer_list</a> for details.</p>\n\n<p>From that page:</p>\n\n<blockquote>\n  <p>An object of type <code>std::initializer_list&lt;T&gt;</code> is a lightweight proxy object that provides access to an array of objects of type <code>const T</code>.</p>\n</blockquote>\n\n<p>The output order is guaranteed. However, that's not because the compiler creates a <code>std::vector&lt;int&gt;</code>. It is guaranteed because there is an array of <code>int</code>s underneath the <code>initializer_list</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "is_accepted": true, "score": 6, "last_activity_date": 1513809648, "last_edit_date": 1513809648, "creation_date": 1513808338, "answer_id": 47915181, "question_id": 47914973, "link": "https://stackoverflow.com/questions/47914973/what-does-a-c-compiler-do-with-this-initializer-list/47915181#47915181", "title": "What does a C++ compiler do with this initializer list?", "body": "<p>Your <a href=\"http://en.cppreference.com/w/cpp/language/range-for\" rel=\"noreferrer\">range based loop</a> is using the <a href=\"http://en.cppreference.com/w/cpp/language/list_initialization\" rel=\"noreferrer\">braced-init-list</a> as a range expression which constructs a temporary object of type <a href=\"https://en.cppreference.com/w/cpp/utility/initializer_list\" rel=\"noreferrer\">std::initializer_list&lt;int&gt;</a>. The order is guaranteed because the 8.5.4.5. paragraph of the <a href=\"https://github.com/cplusplus/draft/blob/master/papers/n4140.pdf?raw=true\" rel=\"noreferrer\">n4140 draft / standard</a> states (emphasis mine):</p>\n\n<blockquote>\n  <p>An object of type std::initializer_list&lt;E&gt; is constructed from an\n  initializer list <strong>as if</strong> the implementation allocated a temporary\n  <strong>array of N elements</strong> of type const E, where N is the number of\n  elements in the initializer list.</p>\n</blockquote>\n"}], "owner": {"reputation": 17546, "user_id": 13022, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/fe131c1359157fb83187527255bb60cc?s=128&d=identicon&r=PG", "display_name": "St&#233;phane", "link": "https://stackoverflow.com/users/13022/st%c3%a9phane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 47915181, "answer_count": 2, "score": 4, "last_activity_date": 1513809747, "creation_date": 1513807285, "question_id": 47914973, "link": "https://stackoverflow.com/questions/47914973/what-does-a-c-compiler-do-with-this-initializer-list", "title": "What does a C++ compiler do with this initializer list?", "body": "<p>When using an initializer list such as this:</p>\n\n<pre><code>for (int i : {3, 1, 6, 4})\n{\n    std::cout &lt;&lt; \"i=\" &lt;&lt; i &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>The ouput is in the same order, 3, 1, 6, and finally 4.  So I know the compiler must be using something similar to <code>std::vector&lt;int&gt;</code> and not <code>std::set&lt;int&gt;</code>.</p>\n\n<p>Is this guaranteed?  Where can I find the docs that explain how the compiler must interpret <code>{3, 1, 6, 4}</code>.</p>\n"}, {"tags": ["c++", "inheritance", "constructor", "sizeof"], "comments": [{"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1513805655, "post_id": 47914612, "comment_id": 82797328, "body": "Does the same effect happen when using <code>class</code> or putting the <code>struct</code> into a namespace? I could imagine that there is an interaction with C compatibility."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513805965, "post_id": 47914612, "comment_id": 82797449, "body": "@Slava I can reproduce MinGW GCC 5.1.0"}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1513806061, "post_id": 47914612, "comment_id": 82797491, "body": "8 12 in VS2017 all the time"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513806066, "post_id": 47914612, "comment_id": 82797496, "body": "@NeilButterworth nevermind misunderstood when 8/12 when 8/8"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 4, "creation_date": 1513806095, "post_id": 47914612, "comment_id": 82797509, "body": "Maybe because it&#39;s no longer an aggregate?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1513806306, "post_id": 47914612, "comment_id": 82797575, "body": "What if you add a member function that&#39;s not a constructor"}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1513806579, "post_id": 47914612, "comment_id": 82797676, "body": "Compare the assembly output and see what&#39;s different."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1513806582, "post_id": 47914612, "comment_id": 82797678, "body": "@M.M At least for my compiler (see above) it makes no difference - we get 8/12 with or without it."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 1, "creation_date": 1513806627, "post_id": 47914612, "comment_id": 82797698, "body": "If you remove constructor but add <code>public:</code> you will see the same issue, at least with GCC. I think MSVC won&#39;t give you this. The things is that once structure starts using C++ features, its stop being a POD type."}, {"owner": {"reputation": 833, "user_id": 3812403, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/0963dc953188cca0374d4fa3436748ab?s=128&d=identicon&r=PG&f=1", "display_name": "ByteMe95", "link": "https://stackoverflow.com/users/3812403/byteme95"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1513806655, "post_id": 47914612, "comment_id": 82797711, "body": "@Fran&#231;oisAndrieux thats not relevant here"}, {"owner": {"reputation": 833, "user_id": 3812403, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/0963dc953188cca0374d4fa3436748ab?s=128&d=identicon&r=PG&f=1", "display_name": "ByteMe95", "link": "https://stackoverflow.com/users/3812403/byteme95"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1513806685, "post_id": 47914612, "comment_id": 82797720, "body": "@Ivan I think youre on the right track, looks like it might have to do with the object no longer being a &quot;POD&quot; after I add a constructor"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1513806702, "post_id": 47914612, "comment_id": 82797728, "body": "@Ivan I certainly don&#39;t see any such thing with GCC."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1513806749, "post_id": 47914612, "comment_id": 82797750, "body": "Also this program causes UB by using the wrong format specifiers"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1513806757, "post_id": 47914612, "comment_id": 82797755, "body": "@NeilButterworth With MSVC? It ignores such things, afaik it does not differentiante <code>class</code> and <code>struct</code> for example (except for default visibility). The thing is that for C++ there is a difference between a &quot;structure&quot; type and a &quot;class&quot; type. Although actual terminology is different, either POD type or aggregate type."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1513806914, "post_id": 47914612, "comment_id": 82797811, "body": "@Ivan As I said, with GCC - there is no reason private/public access should make any difference to the size of a class."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1513806968, "post_id": 47914612, "comment_id": 82797832, "body": "@NeilButterworth There is and you can check it here - <a href=\"https://godbolt.org/g/pg16sG\" rel=\"nofollow noreferrer\">godbolt.org/g/pg16sG</a> Try adding <code>private</code> and see how size changes."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1513807071, "post_id": 47914612, "comment_id": 82797873, "body": "@NeilButterworth You mean you can&#39;t think of a reason  . There&#39;s no obvious reason a user-provided constructor should change the size of a class either"}, {"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 1, "creation_date": 1513807078, "post_id": 47914612, "comment_id": 82797877, "body": "It stopped being standard-layout, and thus stopped being POD, as soon as you had both the parent and child with member variables."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1513807191, "post_id": 47914612, "comment_id": 82797921, "body": "@M.M I can think of several reasons (for example, as others pointed out, adding a constructor makes the struct not be a POD), but I admit I don&#39;t see why that should reduce the size of the object. Adding a public: specification to a struct does not, AFAIK, prevent it from being a POD."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1513807230, "post_id": 47914612, "comment_id": 82797938, "body": "@NeilButterworth Just think of <code>memset(foo, 0, sizeof(Foo)</code> and what it will do with C++ Foo-derived class."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1513807276, "post_id": 47914612, "comment_id": 82797960, "body": "@Ivan What does that have to do with having a public: specification?"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1513807337, "post_id": 47914612, "comment_id": 82797980, "body": "@NeilButterworth Once structure starts using C++ features it loses C compatibility. It is now forbidden to do some operations on that structure which allows compiler to reduce sturcture size. Compiler cannot do this with structures that look like they were defined in C language because of compatibility."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1513807566, "post_id": 47914612, "comment_id": 82798074, "body": "@Ivan Unless you can post some part of the C++ Standard that supports what you are asserting, I will simply have to disagree."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1513807568, "post_id": 47914612, "comment_id": 82798077, "body": "@cHao the issue could be whether <code>Foo</code> is POD or not (not Bar, which as you point out, was never POD). And that could be because <code>Foo</code> might be shared with C"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1513808121, "post_id": 47914612, "comment_id": 82798309, "body": "I suspect the answer is somewhere at <a href=\"https://itanium-cxx-abi.github.io/cxx-abi/abi.html#class-types\" rel=\"nofollow noreferrer\">itanium-cxx-abi.github.io/cxx-abi/abi.html#class-types</a> , which specifies the C++ ABI that gcc uses (gcc uses this ABI spec for other architectures besides Itanium)"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1513808339, "post_id": 47914612, "comment_id": 82798403, "body": "The answer is tail-padding. See this question <a href=\"https://stackoverflow.com/questions/24110347/when-extending-a-padded-struct-why-cant-extra-fields-be-placed-in-the-tail-pad\" title=\"when extending a padded struct why cant extra fields be placed in the tail pad\">stackoverflow.com/questions/24110347/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 6, "last_activity_date": 1513808937, "creation_date": 1513808937, "answer_id": 47915275, "question_id": 47914612, "link": "https://stackoverflow.com/questions/47914612/adding-a-default-constructor-to-a-base-class-changes-sizeof-a-derived-type/47915275#47915275", "title": "Adding a default constructor to a base class changes sizeof() a derived type", "body": "<p>GCC follows the Itanium ABI for C++, which prevents the tail-padding of a POD being used for storage of derived class data members.</p>\n\n<p>Adding a user-provided constructor means that <code>Foo</code> is no longer POD, so that restriction does not apply to <code>Bar</code>.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/24110347/when-extending-a-padded-struct-why-cant-extra-fields-be-placed-in-the-tail-pad\">See this question</a> for more detail on the ABI.</p>\n"}], "owner": {"reputation": 833, "user_id": 3812403, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/0963dc953188cca0374d4fa3436748ab?s=128&d=identicon&r=PG&f=1", "display_name": "ByteMe95", "link": "https://stackoverflow.com/users/3812403/byteme95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 1, "closed_date": 1513809543, "accepted_answer_id": 47915275, "answer_count": 1, "score": 9, "last_activity_date": 1513809251, "creation_date": 1513805342, "last_edit_date": 1513807103, "question_id": 47914612, "link": "https://stackoverflow.com/questions/47914612/adding-a-default-constructor-to-a-base-class-changes-sizeof-a-derived-type", "closed_reason": "Duplicate", "title": "Adding a default constructor to a base class changes sizeof() a derived type", "body": "<p>I tend to think I have a pretty good grasp of C++ internals and memory layouts, but this one has me baffled.  I have the following test code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct Foo\n{\n    //Foo() {}\n    int x;\n    char y;\n};\n\nstruct Bar : public Foo\n{\n    char z[3];\n};\n\nint main()\n{\n    printf( \"Foo: %u Bar: %u\\n\", (unsigned)sizeof( Foo ), (unsigned)sizeof( Bar ) );\n}\n</code></pre>\n\n<p>The output is reasonable:</p>\n\n<blockquote>\n  <p>Foo: 8 Bar: 12</p>\n</blockquote>\n\n<p>However, this is the very odd part, if I uncomment that simple default constructor on Foo(), the sizeof( Bar ) changes!  How can the addition of a ctor possibly change the memory layout of these classes?</p>\n\n<blockquote>\n  <p>Foo: 8 Bar: 8</p>\n</blockquote>\n\n<p>Compiled using gcc-7.2</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "edited": false, "score": 0, "creation_date": 1513805619, "post_id": 47914597, "comment_id": 82797316, "body": "I don&#39;t think I understand, do you have only 2 strings in class ? How is someone supposed to add new string to current class? I think you need an array or list. Then it is easy to print all of them, only iterate through array, list, and adding is solved."}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "reply_to_user": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "edited": false, "score": 0, "creation_date": 1513805749, "post_id": 47914597, "comment_id": 82797363, "body": "Imagine 50 strings, and they&#39;re actually functions. And developers add and remove them. And there&#39;s a monstrous macro that handles this monstrosity automatically."}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "reply_to_user": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "edited": false, "score": 0, "creation_date": 1513805764, "post_id": 47914597, "comment_id": 82797374, "body": "So it goes, such is life."}, {"owner": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "edited": false, "score": 1, "creation_date": 1513806035, "post_id": 47914597, "comment_id": 82797476, "body": "maybe take look here <a href=\"https://stackoverflow.com/questions/19059157/iterate-through-struct-and-class-members\" title=\"iterate through struct and class members\">stackoverflow.com/questions/19059157/&hellip;</a>"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1513806104, "post_id": 47914597, "comment_id": 82797512, "body": "strings are actually functions, what?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1513806183, "post_id": 47914597, "comment_id": 82797542, "body": "C++ doesn&#39;t have reflection at this level. There are solutions (custom string class, external code generator, ...), but your question is quite vague. Try creating MCVE, and explaining any constraints."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1513807193, "post_id": 47914597, "comment_id": 82797922, "body": "There are bigger and better fishes to fry in C++. Avoid macros. Prefer templates."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1513808869, "post_id": 47914597, "comment_id": 82798579, "body": "@Carbon Dynamic data should be in data structures like vectors or maps, not separate variables. Your design seems fundamentally flawed if you need to be able to iterate through all the strings."}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 0, "creation_date": 1513809888, "post_id": 47914597, "comment_id": 82798881, "body": "I do not disagree, it&#39;s hard weaning people from what they&#39;re used to."}], "answers": [{"tags": [], "owner": {"reputation": 939, "user_id": 6312818, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-exa9fGlNwbI/AAAAAAAAAAI/AAAAAAAAHQ8/CXKe0oTPiYc/photo.jpg?sz=128", "display_name": "Eyal Cinamon", "link": "https://stackoverflow.com/users/6312818/eyal-cinamon"}, "is_accepted": true, "score": 1, "last_activity_date": 1513806380, "creation_date": 1513806380, "answer_id": 47914801, "question_id": 47914597, "link": "https://stackoverflow.com/questions/47914597/reflection-in-c-print-all-the-defined-strings-in-a-class/47914801#47914801", "title": "Reflection in c++ - print all the defined strings in a class", "body": "<p>C++ does not have any reflection. If you want to do this with macros, you would also have to define your member variables using specially crafted macros. A simple idea would be each macro would add the member to am internal vector and your printEm would just iterate through this vector. It's not the most elegant solution but it's how various libraries work.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "accepted_answer_id": 47914801, "answer_count": 1, "score": 0, "last_activity_date": 1513806380, "creation_date": 1513805247, "question_id": 47914597, "link": "https://stackoverflow.com/questions/47914597/reflection-in-c-print-all-the-defined-strings-in-a-class", "title": "Reflection in c++ - print all the defined strings in a class", "body": "<p>Assume I have:</p>\n\n<pre><code>#include &lt;iostream&gt;\nclass Greeter\n{\npublic:\n    void printEm() {...}\nprivate:\n    std::string a = \"Hello!\";\n    std::string b = \"Hi!\";\n    int IAmNotAString = 0;\n};\n</code></pre>\n\n<p>What is the simplest way to get printEm to print all the defined strings in Greeter, and further, should someone define a new string, print that one too? Any boost library is fine - I have some experience with Fusion, but I don't know how it could automatically infer which members are strings.</p>\n"}, {"tags": ["c++", "oop", "unions"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1513804205, "post_id": 47914347, "comment_id": 82796685, "body": "<code>Player_Obj.Gun_Player;</code> not sure what you wanted to do in this line, however it&#39;s not the error."}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1513804713, "post_id": 47914347, "comment_id": 82796886, "body": "Since you use <code>class</code> with <code>public</code> members I think your types aren\u2019t trivial: I think changing them to become <code>struct</code>s without access specifiers should address your problem."}, {"owner": {"reputation": 35, "user_id": 9124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce520d8135aa77624e72577d092e034d?s=128&d=identicon&r=PG&f=1", "display_name": "A.Lugini", "link": "https://stackoverflow.com/users/9124497/a-lugini"}, "edited": false, "score": 0, "creation_date": 1513804922, "post_id": 47914347, "comment_id": 82796987, "body": "I did a big update."}], "answers": [{"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 1, "last_activity_date": 1513805713, "creation_date": 1513805713, "answer_id": 47914688, "question_id": 47914347, "link": "https://stackoverflow.com/questions/47914347/union-and-class/47914688#47914688", "title": "Union and Class", "body": "<p>To answer your <em>original</em> question, your <code>union</code> has non-trivial members (because of the initializers), but has no constructor. You need to tell the compiler which of the union's members you want to have initially, because the compiler must construct one or the other. That can be done for example by giving the <code>union</code> a constructor.</p>\n\n<p>And then you're mixing <code>.</code> and <code>-&gt;</code> operators.</p>\n\n<p>Here's a version that compiles (I don't dare call it \"fixed\" though):</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass m4a1 {\npublic:\n  int Damage = 12;\n  int Mag = 30;\n};\n\nclass ak47 {\npublic:\n  int Damage = 14;\n  int Mag = 24;\n};\n\nunion Gun_Union {\n  m4a1 M4A1_Union;\n  ak47 Ak47_Union;\n  Gun_Union() : Ak47_Union() {}   // &lt;=== the initial state is ak47\n};\n\nclass Player {\npublic:\n  union Gun_Union Gun_Player;\n  int Health = 200;\n};\n\ntemplate &lt;typename Type&gt;\nvoid Shot(Type* Player_Obj) {\n  Player_Obj-&gt;Gun_Player.Ak47_Union.Mag--;\n  Player_Obj-&gt;Health = Player_Obj-&gt;Health - Player_Obj-&gt;Gun_Player.Ak47_Union.Damage;\n}\nint main() {\n\n  Player Player_Obj;\n  Player_Obj.Gun_Player;\n  Shot &lt;Player&gt;(&amp;Player_Obj);\n  std::cout &lt;&lt; Player_Obj.Health;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "is_accepted": false, "score": 0, "last_activity_date": 1513815170, "last_edit_date": 1513815170, "creation_date": 1513814316, "answer_id": 47916021, "question_id": 47914347, "link": "https://stackoverflow.com/questions/47914347/union-and-class/47916021#47916021", "title": "Union and Class", "body": "<blockquote>\n  <p>I also ask if the command Player_Obj.Gun_Player = Ak47_Union is possible; Sorry for bad English.</p>\n</blockquote>\n\n<p>So what you're trying to do here is set the player's current weapon to an ak47. Here's the problem. Your union represents a class, not just a regular type. This is a problem for a few reasons.</p>\n\n<p>A class is useful because it provides a blueprint from which to create similar but ultimately different objects. Since all of your weapon classes have the same structure (damage and magsize), there's no reason to have separate classes for each weapon.</p>\n\n<p>Furthermore, a class here is tricky because in order for you to <em>use</em> a class, you must first either instantiate it or declare it's member functions static. The problem here comes from the fact that you're using a union to handle the player weapon. A union won't work because unions by definition <em>hold</em> things (one at a time), which is not a thing here because we want a static class.</p>\n\n<p>Now, you <em>could</em> instantiate your weapon classes and actually add them to the union, like so:</p>\n\n<pre><code>int main()\n{\n    Player Player_Obj;\n    Player_Obj.Gun_Player;\n\n    // Remember to pick better names for classes, not the metasynctactic\n    // b.s. I'm using\n    m4a1 m4a1_class_instance;\n    ak47 ak47_class_instance;\n\n    // Populate the union\n    union Gun_Union weapons;\n    weapons.Ak47_Union = ak47_class_instance;\n\n    // Finally, set player weapon\n    Player_Obj.Gun_player = weapons;\n\n    // &lt;Rest of program...&gt;\n</code></pre>\n\n<p>As I'm sure you can tell, this is clunky and doesn't really make sense. Why are we istantiating those classes? It doesn't really make sense. I think a redesign here would be great, especially because you wouldn't have to deal with the union, which was tripping you up with regards to setting the player's weapon. Here is a pretty basic one.</p>\n\n<pre><code>// Using constants for simplicity\n\n// Weapon Ids\nconst auto M4A1 = 1000;\nconst auto AK47 = 1001;\n\nconst auto FIRST_WEAPON_ID = M4A1;\nconst auto LAST_WEAPON_ID = AK47;\n\nclass Player {\n    int weapon_id;\n    int health;\n    int damage;\n    int magazine_capacity;\n    int magazine;\n\npublic:\n    void setWeapon(const int weapon_id) {\n        // Validate id first; you should somehow handle error,\n        // I'm just exiting the function here\n        if ((weapon_id &lt; FIRST_WEAPON_ID) || (weapon_id &gt; LAST_WEAPON_ID)) return;\n\n        switch (weapon_id) {\n            case M4A1: {\n                damage = 12;\n                magazine_capacity = 30;\n            } break;\n\n            case AK47: {\n                damage = 14;\n                magazine_capacity = 24;\n            } break;\n\n            default: // Error should have been handled in validation, but\n                     // it's best practice to guard your code everywhere\n                return;\n        }\n    }\n};\n</code></pre>\n\n<p>This wouldn't be the full class obviously, I only wrote one function just to show you how I would implement a more naive method, but the actually implementation details are up to you, I would really stress the design concepts, specifically the following:</p>\n\n<p><br />\n<strong>Accessing Class Members</strong></p>\n\n<p>You don't want to access class members directly, especially when you're talking about a pointer. The problem of 'who owns the data pointed to by the pointer' is a significant one, and it's why we now have shared and unique pointers. Regardless of which pointer you use though, you should have something like <code>&lt;return-type&gt; getValue() const</code>. That way your data is protected by a layer of indirection. Likewise, to set a value you can do something like <code>void setValue(const &lt;type&gt; value)</code> and now you can do validation or whatever in that function.</p>\n\n<p><br />\n<strong>Unions</strong></p>\n\n<p>First, I don't recommend using unions. In your particular case, using a union doesn't really make sense because you already have the pointer in the player class <em>(before you edited your question)</em>, which means a player can already only hold one. Having a union doesn't add anything at that point. Additionally, using unions isn't recommended, mostly because you lose some type-safety. If you do want something union-like, you might want to check out std::variant in the STL.</p>\n\n<p><br />\n<strong>Your Template Function</strong></p>\n\n<p>Generally speaking, template functions are for generic programming, where they can take in a type T and you don't have to worry about rewriting code unnecessarily. In your case, it shouldn't apply.</p>\n\n<p>You mentioned you were just doing this for practice, so I understand a clean design wasn't your goal, but I think it's never too early to start thinking about design principles.</p>\n"}], "owner": {"reputation": 35, "user_id": 9124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce520d8135aa77624e72577d092e034d?s=128&d=identicon&r=PG&f=1", "display_name": "A.Lugini", "link": "https://stackoverflow.com/users/9124497/a-lugini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1514995808, "creation_date": 1513804011, "last_edit_date": 1514995808, "question_id": 47914347, "link": "https://stackoverflow.com/questions/47914347/union-and-class", "title": "Union and Class", "body": "<p>I have a lot of free time ( there are also the Xmas holidays incoming! ) so, I tried to merge my two passions, video games and c++.\nIt is not a real video game project, was just some console script using classes.\nSo, here it comes the problem; </p>\n\n<pre><code>#include &lt;stdafx.h&gt;\n#include &lt;iostream&gt;\n\nclass m4a1 {\n    public:\n        int Damage = 12;\n        int Mag = 30;\n};\n\nclass ak47 {\n    public: \n        int Damage = 14;\n        int Mag = 24;\n};\n\nunion Gun_Union {\n    m4a1 M4A1_Union;\n    ak47 Ak47_Union;\n};\n\nclass Player {\n    public:\n        Gun_Union Gun_Player;\n        int Health = 200;\n};\n\ntemplate &lt;typename Type&gt; \nvoid Shot(Type* Player_Obj) {\n    Player_Obj-&gt;Gun_Player-&gt;AK47_Union-&gt;Mag--;\n    Player_Obj-&gt;Health = Player_Obj-&gt;Health - Player_Obj-&gt;Gun_Player-&gt;AK47_Union-&gt;Damage;\n}   \nint main() {\n\n    Player Player_Obj;\n    Player_Obj.Gun_Player;\n    Shot &lt;Player&gt; (&amp;Player_Obj);\n    std::cout &lt;&lt; Player_Obj.Health;\n}\n</code></pre>\n\n<p>At the line 35 it gives me the error \nPlayer::Player(void) trying to refer to an eliminate function.\nI discovered that changing Gun_Union with any other type in the class Player (line 25) it doesn't give me an error.</p>\n\n<p>I also ask if the command Player_Obj.Gun_Player = Ak47_Union is possible;\nSorry for bad English.</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1513804125, "post_id": 47914311, "comment_id": 82796656, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2551775/appending-a-vector-to-a-vector\">Appending a vector to a vector</a>"}, {"owner": {"reputation": 393, "user_id": 7700802, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ade1368521f15e2a728422f50ac96b88?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfy", "link": "https://stackoverflow.com/users/7700802/wolfy"}, "reply_to_user": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1513804217, "post_id": 47914311, "comment_id": 82796689, "body": "@KillzoneKid I do not think that post will help me in this case."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1513804332, "post_id": 47914311, "comment_id": 82796731, "body": "What do you mean by single column vector? A regular <code>std::vector&lt;int&gt;</code> or a vector of vectors like <code>std::vector&lt;std::vector&lt;int&gt;&gt;</code> ending up having only one row / column?"}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1513805149, "post_id": 47914311, "comment_id": 82797094, "body": "<code>&gt;&gt;I do not think that post will help me in this case</code> This is exactly what you wanted and what you accepted as the answer, while in your ticket you described something different"}], "answers": [{"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1513804681, "post_id": 47914393, "comment_id": 82796875, "body": "@KillzoneKid, I think the output is a vector of vectors where the inner vector consists of just one item."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1513804203, "creation_date": 1513804203, "answer_id": 47914393, "question_id": 47914311, "link": "https://stackoverflow.com/questions/47914311/how-to-take-a-vector-of-vectors-contents-into-a-single-column-vector/47914393#47914393", "title": "How to take a vector of vectors contents into a single column vector", "body": "<p>Like this:</p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt;&gt; a = {{1, 2}, {3, 4}};\nstd::vector&lt;std::vector&lt;int&gt;&gt; b;\nfor ( auto&amp; row : a )\n{\n   for ( auto item: row )\n   {\n      b.push_back(std::vector&lt;int&gt;{item});\n   }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1513804464, "post_id": 47914414, "comment_id": 82796784, "body": "I might be mistaken but I think the OP wants a <code>std::vector</code> for each item in <code>vec</code>. In other words, type of <code>b</code> is <code>std::vector&lt;std::vector&lt;int&gt;&gt;</code>."}, {"owner": {"reputation": 393, "user_id": 7700802, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ade1368521f15e2a728422f50ac96b88?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfy", "link": "https://stackoverflow.com/users/7700802/wolfy"}, "edited": false, "score": 0, "creation_date": 1513804729, "post_id": 47914414, "comment_id": 82796892, "body": "When I try to print your vector b, I do not get anything."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513804907, "post_id": 47914414, "comment_id": 82796981, "body": "What do you mean? How are you trying to print out that vector?"}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1513805322, "post_id": 47914414, "comment_id": 82797179, "body": "@RSahu You are right, this is not what he asked in the ticket. He asked for solution you provided. Hence I am upvoting yours."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 1, "creation_date": 1513805454, "post_id": 47914414, "comment_id": 82797245, "body": "@KillzoneKid, Only if we could always express in words what our mind thinks!!"}], "tags": [], "owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "is_accepted": false, "score": 1, "last_activity_date": 1513804478, "last_edit_date": 1513804478, "creation_date": 1513804324, "answer_id": 47914414, "question_id": 47914311, "link": "https://stackoverflow.com/questions/47914311/how-to-take-a-vector-of-vectors-contents-into-a-single-column-vector/47914414#47914414", "title": "How to take a vector of vectors contents into a single column vector", "body": "<p>You could <code>std::copy</code> every row using <code>std::back_inserter</code> like so:</p>\n\n<pre><code>int main()\n{\n    std::vector&lt;std::vector&lt;int&gt;&gt; v = {{1, 2, 3}, {2, 2, 3}};\n\n    std::vector&lt;int&gt; b;\n\n    for(auto&amp; vec : v){\n        std::copy(vec.begin(), vec.end(), std::back_inserter(b));\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 393, "user_id": 7700802, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ade1368521f15e2a728422f50ac96b88?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfy", "link": "https://stackoverflow.com/users/7700802/wolfy"}, "edited": false, "score": 0, "creation_date": 1513804687, "post_id": 47914459, "comment_id": 82796879, "body": "When I try to print v, I do not get anything for some reason."}], "tags": [], "owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "is_accepted": false, "score": 1, "last_activity_date": 1513805172, "last_edit_date": 1513805172, "creation_date": 1513804545, "answer_id": 47914459, "question_id": 47914311, "link": "https://stackoverflow.com/questions/47914311/how-to-take-a-vector-of-vectors-contents-into-a-single-column-vector/47914459#47914459", "title": "How to take a vector of vectors contents into a single column vector", "body": "<p>If you want to copy all the elements from a vector of vectors into a single vector then utilize the two loops:</p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt;&gt; vv = { { 1, 2, 3 },\n                                     { 4, 5, 6 },\n                                     { 7, 8, 9 } };\nstd::vector&lt;int&gt; v;\nfor (auto row : vv) {\n    for (auto el : row) {\n        v.push_back(el);\n    }\n}\n//print out the vector:\nfor (auto el : v) {\n    std::cout &lt;&lt; el &lt;&lt; ' ';\n}\n</code></pre>\n\n<p>or utilize the <a href=\"http://en.cppreference.com/w/cpp/algorithm/copy\" rel=\"nofollow noreferrer\">std::copy</a> function.</p>\n"}, {"comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513814718, "post_id": 47915860, "comment_id": 82800163, "body": "single note: if you are already using <code>std::cend(b)</code>, you should also use <code>std::cbegin(vec)</code> and <code>std::cend(vec)</code>"}, {"owner": {"reputation": 229, "user_id": 4691843, "user_type": "registered", "profile_image": "https://graph.facebook.com/669724423133099/picture?type=large", "display_name": "DNKpp", "link": "https://stackoverflow.com/users/4691843/dnkpp"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513815821, "post_id": 47915860, "comment_id": 82800467, "body": "@Fureeish You could. But then you are preventing the algorithm from moving the elements. But you are right, for this purpose the <code>std::cend&#47;std::cbegin</code> is the better choice."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513816002, "post_id": 47915860, "comment_id": 82800509, "body": "The elements won&#39;t ever be moved unless you use <code>std::move_iterator</code>, will they?"}], "tags": [], "owner": {"reputation": 229, "user_id": 4691843, "user_type": "registered", "profile_image": "https://graph.facebook.com/669724423133099/picture?type=large", "display_name": "DNKpp", "link": "https://stackoverflow.com/users/4691843/dnkpp"}, "is_accepted": true, "score": 1, "last_activity_date": 1513815855, "last_edit_date": 1513815855, "creation_date": 1513813154, "answer_id": 47915860, "question_id": 47914311, "link": "https://stackoverflow.com/questions/47914311/how-to-take-a-vector-of-vectors-contents-into-a-single-column-vector/47915860#47915860", "title": "How to take a vector of vectors contents into a single column vector", "body": "<p>Unfortunately I have to tell you, that every other answer, at least until now, is not as good as it seems.</p>\n\n<p>Let us step through the answers; in the end I tell you how to handle it properly.</p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt;&gt; v = {{1, 2, 3}, {2, 2, 3}};\nstd::vector&lt;int&gt; b;\nfor(auto&amp; vec : v){\n    std::copy(vec.begin(), vec.end(), std::back_inserter(b)); // performes single insertion at the end\n}\n</code></pre>\n\n<p><code>std::copy</code> is bad style for inserting into a <code>std::vector</code>. You insert it value by value at the end of the destination vector. This means potentially more reallocations and moves/copies as needed.</p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt;&gt; vv = { { 1, 2, 3 },\n                                     { 4, 5, 6 },\n                                     { 7, 8, 9 } };\nstd::vector&lt;int&gt; v;\nfor (auto row : vv) {\n    for (auto el : row) {\n        v.push_back(el);\n    }\n}\n</code></pre>\n\n<p>Same here. You resize it at every <code>push_back</code>, that is absolutely not necessary!</p>\n\n<p>I recommend you the use of <code>std::vector::insert</code>. It performs some internal resizes by its own.</p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt;&gt; v = {{1, 2, 3}, {2, 2, 3}};\nstd::vector&lt;int&gt; b;\nfor(auto&amp; vec : v){\n    b.insert(std::cend(b), std::cbegin(vec), std::cend(vec));\n}\n</code></pre>\n\n<p>This solution performs a resize before any insertion occurs. This will result in the best possible performance.</p>\n\n<p>Here some testcode. Try it by your own:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;chrono&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::vector&lt;int&gt; v(100'000'000, 5);\n    auto start = std::chrono::steady_clock::now();\n    std::vector&lt;int&gt; b;\n    b.insert(std::cend(b), std::cbegin(v), std::cend(v));\n    auto end = std::chrono::steady_clock::now();\n    std::cout &lt;&lt; \"insert durtion:\\t\" &lt;&lt; (end - start).count() &lt;&lt; std::endl;\n\n    b = std::vector&lt;int&gt;();\n\n    start = std::chrono::steady_clock::now();\n    std::copy(std::cbegin(v), std::cend(v), std::back_inserter(b));\n    end = std::chrono::steady_clock::now();\n    std::cout &lt;&lt; \"copy durtion:\\t\" &lt;&lt; (end - start).count() &lt;&lt; std::endl;\n\n    b = std::vector&lt;int&gt;();\n\n    start = std::chrono::steady_clock::now();\n    for (auto el : v)\n        b.push_back(el);\n    end = std::chrono::steady_clock::now();\n    std::cout &lt;&lt; \"copy durtion:\\t\" &lt;&lt; (end - start).count() &lt;&lt; std::endl;\n    std::cin.ignore();\n    return 0;\n}\n</code></pre>\n\n<p>This produces in x64 release in this output:</p>\n\n<pre><code>insert durtion:         132388657\ncopy durtion:           844505239\npush_back durtion:      866565409\n</code></pre>\n\n<p>In the end, you could of course <code>resize</code> the vector first and then start the copy, but I think that's the wrong way to deal with that, if in fact, the <code>std::vector</code> already offers us this solution.</p>\n"}], "owner": {"reputation": 393, "user_id": 7700802, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ade1368521f15e2a728422f50ac96b88?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfy", "link": "https://stackoverflow.com/users/7700802/wolfy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 47915860, "answer_count": 4, "score": 0, "last_activity_date": 1513815855, "creation_date": 1513803839, "question_id": 47914311, "link": "https://stackoverflow.com/questions/47914311/how-to-take-a-vector-of-vectors-contents-into-a-single-column-vector", "title": "How to take a vector of vectors contents into a single column vector", "body": "<p>I have a vector of vectors and I want to take the contents of it into a single column vector. i.e.,</p>\n\n<p>input: A = [[1 2] [3 4]]</p>\n\n<p>output: v = [[1][2][3][4]] (column vector)</p>\n\n<p>Is there a quick way of doing this in C++?</p>\n"}, {"tags": ["c#", "c++", ".net", "qt", "dll"], "comments": [{"owner": {"reputation": 129, "user_id": 3074236, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/C91Ao.jpg?s=128&g=1", "display_name": "MG SQL Muppet", "link": "https://stackoverflow.com/users/3074236/mg-sql-muppet"}, "reply_to_user": {"reputation": 7466, "user_id": 2146682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7120fc7548c43237662da906e3c84f43?s=128&d=identicon&r=PG", "display_name": "MrEricSir", "link": "https://stackoverflow.com/users/2146682/mrericsir"}, "edited": false, "score": 0, "creation_date": 1513807699, "post_id": 47914298, "comment_id": 82798137, "body": "Qt not QT then sorry"}, {"owner": {"reputation": 7482, "user_id": 313175, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/17983e85ea926e9e985c00d1a771f24a?s=128&d=identicon&r=PG", "display_name": "Alexander V", "link": "https://stackoverflow.com/users/313175/alexander-v"}, "edited": false, "score": 0, "creation_date": 1513810505, "post_id": 47914298, "comment_id": 82799073, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5834557/qt-creator-use-dll\">Qt-creator use dll</a>"}, {"owner": {"reputation": 7482, "user_id": 313175, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/17983e85ea926e9e985c00d1a771f24a?s=128&d=identicon&r=PG", "display_name": "Alexander V", "link": "https://stackoverflow.com/users/313175/alexander-v"}, "edited": false, "score": 2, "creation_date": 1513810672, "post_id": 47914298, "comment_id": 82799117, "body": "No problem to load and use any DLL with executable created with Qt except using .Net DLL sounds too tricky. That is not really about Qt then but using .Net code from native executable."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1513837790, "post_id": 47914298, "comment_id": 82805891, "body": "IMHO, it is simpler in the opposite direction: I remember that our team once provided a OpenGL view widget written in Qt which we provided as unmanaged code in a C# wrapper. This was embedded (by another company) in a C#/.net/anything application. I didn&#39;t myself the C# wrapping stuff and hence cannot provide details but at least I know it worked quite well finally."}], "owner": {"reputation": 129, "user_id": 3074236, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/C91Ao.jpg?s=128&g=1", "display_name": "MG SQL Muppet", "link": "https://stackoverflow.com/users/3074236/mg-sql-muppet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513807600, "creation_date": 1513803756, "last_edit_date": 1513807600, "question_id": 47914298, "link": "https://stackoverflow.com/questions/47914298/is-it-possible-to-run-a-windows-dll-in-qt", "title": "Is it possible to run a windows dll in Qt", "body": "<p>Can Qt link to a Microsoft dot net dll? </p>\n\n<p>I'm having some legacy software rebuilt using Qt - Cross platform application framework. The legacy system included a drawing viewer which was basically a picture box that handled a dot net dll. All of the methods and commands needed to display the drawing and extract data are contained in the dll.</p>\n\n<p>The way the DLL works is to ask the main application for the location of the drawing and a place to draw the graphics.  The problem is in the second of these two requests. This has to be a container which will support DOT NET graphics.</p>\n\n<p>Can this be done with Qt?</p>\n"}, {"tags": ["c++", "c++11", "pointers", "vector", "smart-pointers"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1513802982, "post_id": 47914132, "comment_id": 82796149, "body": "I&#39;m not entirely sure what you are asking. If you aren&#39;t sure which of <code>animalOwnerships</code> or <code>animals</code> will be destroyed first, perhaps you need shared ownership with <code>shared_ptr</code>? If they are being cleared at (nearly) the same time, it doesn&#39;t really matter in which order you clear them. It&#39;s fine to <code>clear</code> a vector of dangling pointers. Some people may appreciate the tidiness of clearing <code>animalOwnerships</code> first."}, {"owner": {"reputation": 643, "user_id": 1483948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f12de9d09fa231c155b8d528df46094e?s=128&d=identicon&r=PG", "display_name": "AnInquiringMind", "link": "https://stackoverflow.com/users/1483948/aninquiringmind"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1513803387, "post_id": 47914132, "comment_id": 82796315, "body": "@Fran&#231;oisAndrieux In general, <code>animals</code> is permanent. There is only a single scenario in which I will be &quot;resetting&quot; these <code>vectors</code>, and I have complete control over the order in which I do it. Given this, should I call <code>animalOwnerships.clear()</code> before <code>animals.clear()</code>? Does it really matter, if I&#39;m clearing them both consecutively? I am more curious about what is happening (in terms of pointers and memory) if I do call <code>animals.clear()</code> first."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1513803565, "post_id": 47914132, "comment_id": 82796404, "body": "When you clear <code>animals</code> you will destroy each <code>unique_ptr</code> it contains. This, in turn, <code>delete</code> each pointed <code>Animal</code> instance. At that point, <code>animalOwnerships</code> is unchanged, but it&#39;s pointers are all invalid (dangling). You can still destroy those pointers (not to be confused with giving them to <code>delete</code>) so it&#39;s not a problem to <code>clear</code> <code>animalOwnerships</code>."}, {"owner": {"reputation": 643, "user_id": 1483948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f12de9d09fa231c155b8d528df46094e?s=128&d=identicon&r=PG", "display_name": "AnInquiringMind", "link": "https://stackoverflow.com/users/1483948/aninquiringmind"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1513804054, "post_id": 47914132, "comment_id": 82796620, "body": "@Fran&#231;oisAndrieux Thank you for the explanation. Also, just to make sure I understand, it is okay to <code>clear</code> <code>animalOwnerships</code> first because the <code>Animal</code> objects/instances pointed to by the raw pointers in <code>animalOwnerships</code> are owned by <code>unique_ptr</code>s. If, instead, there were <i>no</i> <code>unique_ptr</code>s to those objects, and then I called <code>animalOwnerships.clear()</code>, then I would have a memory leak, as I would have then deleted the only pointers to the objects in memory. But, thanks to the <code>unique_ptr</code>s, I do not have to worry about that anymore. Is that correct?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1513804262, "post_id": 47914132, "comment_id": 82796703, "body": "Right. If you only had raw pointers, you would need to <code>delete</code> the <code>Animal</code> instances yourself before you clear the last vector."}, {"owner": {"reputation": 643, "user_id": 1483948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f12de9d09fa231c155b8d528df46094e?s=128&d=identicon&r=PG", "display_name": "AnInquiringMind", "link": "https://stackoverflow.com/users/1483948/aninquiringmind"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1513805172, "post_id": 47914132, "comment_id": 82797105, "body": "@Fran&#231;oisAndrieux Thanks! That was pretty much everything I was wondering. If you would like to write an answer regarding these points, I can go ahead and accept it; otherwise, thanks for the help!"}], "answers": [{"comments": [{"owner": {"reputation": 643, "user_id": 1483948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f12de9d09fa231c155b8d528df46094e?s=128&d=identicon&r=PG", "display_name": "AnInquiringMind", "link": "https://stackoverflow.com/users/1483948/aninquiringmind"}, "edited": false, "score": 0, "creation_date": 1513805535, "post_id": 47914598, "comment_id": 82797282, "body": "I felt like I was reading a fairy tale, what with the magic gems and all! But very clearly stated -- thank you!"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 2, "last_activity_date": 1513805249, "creation_date": 1513805249, "answer_id": 47914598, "question_id": 47914132, "link": "https://stackoverflow.com/questions/47914132/clearing-a-vector-of-raw-pointers-to-objects-owned-by-unique-pointers/47914598#47914598", "title": "Clearing a vector of raw pointers to objects owned by unique pointers", "body": "<p>Pointers are like pieces of paper with locations listed on them.</p>\n\n<p>A dangling pointer is an address to a house that doesn't exist.</p>\n\n<p>A memory leak occurs when the only record you have of the house is on a particular piece of paper, and you destroy it and lose track of the house.</p>\n\n<p>A dangling pointer is untidy and risky in that if anyone follows it bad things happen, but it is not an immediate bug.  Even a leak isn't an immediate bug.</p>\n\n<p>A unique ptr object is that same address -- same writing -- but written on a magic gem.  When the gem is destroyed, the house is destroyed too.</p>\n\n<p>This makes it difficult to leak the resource without leaking the unique ptr.  And because the owner of the resource is clear -- it is that unique ptr -- it makes that unique ptr less likely to dangle, as everyone should know only to clean up the resource (destroy the house) by destroying the unique ptr (shattering the gem).</p>\n\n<p>So clearing the people/animal vectors destroys the unique ptrs (the gems), which automatically destroys the houses (people and animals).</p>\n\n<p>The vector-of-vector-of-pointers remains, but is full of dangling pointers.  It then becomes a good idea to clear it.  But there is no immediate harm from it existing.  Clearing it before, or afterwards, has no impact on the lifetime of the the people or animals, because it is just a set of notes that say where animals are in a structured table.</p>\n"}], "owner": {"reputation": 643, "user_id": 1483948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f12de9d09fa231c155b8d528df46094e?s=128&d=identicon&r=PG", "display_name": "AnInquiringMind", "link": "https://stackoverflow.com/users/1483948/aninquiringmind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 47914598, "answer_count": 1, "score": 1, "last_activity_date": 1513814658, "creation_date": 1513802849, "last_edit_date": 1513814658, "question_id": 47914132, "link": "https://stackoverflow.com/questions/47914132/clearing-a-vector-of-raw-pointers-to-objects-owned-by-unique-pointers", "title": "Clearing a vector of raw pointers to objects owned by unique pointers", "body": "<p>I am wondering what the best way is to clear a <code>vector</code> of <code>vector</code>s of raw pointers that point to objects owned by <code>unique_ptr</code>s without any memory leaks.</p>\n\n<p>To make this more concrete, suppose that I have:</p>\n\n<pre><code>std::vector&lt;std::unique_ptr&lt;Person&gt;&gt; people;\nstd::vector&lt;std::unique_ptr&lt;Animal&gt;&gt; animals;\nstd::vector&lt;std::vector&lt;Animal*&gt;&gt; animalOwnerships;\n</code></pre>\n\n<p>I know I can use <code>people.clear()</code> and <code>animals.clear()</code>, which will delete the unique pointers to the class objects, which in turn will delete the class objects themselves (please correct me if I'm mistaken here).</p>\n\n<p>If I call these first, then does <code>animalOwnerships</code> consist of dangling pointers? Is it okay to call <code>animalOwnerships.clear()</code> at this point without needing to worry about any memory leaks, or should it be called first, before the other two?</p>\n\n<p>Also, do the individual <code>vectors</code> in <code>animalOwnerships</code> need to be cleared individually?</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1513815103, "post_id": 47913987, "comment_id": 82800278, "body": "Consider using <code>std::pair</code> instead. It even has <code>get()</code> methods for accessing elements by index or type at compile-time"}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1513802700, "creation_date": 1513802700, "answer_id": 47914103, "question_id": 47913987, "link": "https://stackoverflow.com/questions/47913987/iterating-over-fields-of-the-same-type/47914103#47914103", "title": "Iterating over fields of the same type", "body": "<p>If you worry about unrolling, you may replace:</p>\n\n<pre><code>Line l;\nLineOther lOther;\nfor (auto &amp;side: {Sides::LEFT, Sides::Right})\n{\n      auto &amp;d = GetBySide(side, l);\n      auto &amp;dOther = GetBySide(side, lOther);\n\n      // Do some stuff with the data\n}\n</code></pre>\n\n<p>by something like:</p>\n\n<pre><code>template &lt;Side side&gt;\nvoid foo(Line&amp; l, LineOther&amp; lOther) {\n      auto &amp;d = GetBySide(side, l);\n      auto &amp;dOther = GetBySide(side, lOther);\n\n      // Do some stuff with the data\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Line l;\nLineOther lOther;\nfoo&lt;Sides::LEFT&gt;(l, lOther);\nfoo&lt;Sides::Right&gt;(l, lOther);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": false, "score": 0, "last_activity_date": 1513802880, "creation_date": 1513802880, "answer_id": 47914145, "question_id": 47913987, "link": "https://stackoverflow.com/questions/47913987/iterating-over-fields-of-the-same-type/47914145#47914145", "title": "Iterating over fields of the same type", "body": "<p>\"I have quite a few classes that are structured this way\" it seems that you can leave only one of them. Or at least utilize inheritance or other technique to avoid duplication:</p>\n\n<pre><code>// Declare base class instead of copypasting fields.\nclass BaseLine\n{\npublic:\n    int Right{};\n    int Left{};\n};\n\nclass Line: public BaseLine\n{};\n\nclass LineOther: public BaseLine\n{};\n\nint main()\n{\n    Line l;\n    l.Right = 45; l.Left = 89;\n    LineOther lOther;\n    lOther.Right = 74; lOther.Left = 33;\n    // Use pointer to member to iterate over fields.\n    for(auto p_side: {&amp;BaseLine::Right, &amp;BaseLine::Left})\n    {\n       ::std::cout &lt;&lt; (l.*p_side) &lt;&lt; ::std::endl;\n       ::std::cout &lt;&lt; (lOther.*p_side) &lt;&lt; ::std::endl;\n    }   \n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/VCmhmLoGOJVWRivm\" rel=\"nofollow noreferrer\">Online compiler</a></p>\n"}], "owner": {"reputation": 2587, "user_id": 670446, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/opku1.png?s=128&g=1", "display_name": "bpeikes", "link": "https://stackoverflow.com/users/670446/bpeikes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513803138, "creation_date": 1513802087, "question_id": 47913987, "link": "https://stackoverflow.com/questions/47913987/iterating-over-fields-of-the-same-type", "title": "Iterating over fields of the same type", "body": "<p>Let say you have the following classes:</p>\n\n<pre><code>class Data\n{\npublic:\n    int a;\n    int b;\n};\n\nclass DataOther\n{\npublic:\n    int a;\n    int b;\n};\n\nclass Line\n{\npublic:\n    Data Right;\n    Data Left;\n};\n\nclass LineOther\n{\npublic:\n    DataOther Right;\n    DataOther Left;\n}\n</code></pre>\n\n<p>I have quite a few classes that are structured this way, and when I want to run code over both \"sides\" of the data I typically do something like this:</p>\n\n<pre><code>enum class Side { RIGHT, LEFT };\ntemplate&lt;typename T&gt;\nauto GetBySide(const Side &amp;side, T &amp;data) -&gt; decltype(data.Right) &amp; \n{ \n    return side == Side::Left ? data.Left : data.Right; \n}\n</code></pre>\n\n<p>And then in the code:</p>\n\n<pre><code>Line l;\nLineOther lOther;\nfor(auto &amp;side: {Sides::LEFT, Sides::Right})\n{\n      auto &amp;d = GetBySide(side, l);\n      auto &amp;dOther = GetBySide(side, lOther);\n\n      // Do some stuff with the data\n}\n</code></pre>\n\n<p>Now the down side of this, is that it's run-time so not much optimization can be done, though I suppose a compiler might unroll the loop.</p>\n\n<p>Any other ideas on how to structure the code?</p>\n"}, {"tags": ["c++", "member-function-pointers"], "comments": [{"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 3, "creation_date": 1513800806, "post_id": 47913681, "comment_id": 82795092, "body": "This cannot work as <code>XFunc</code> and <code>YFunc</code> are not known to the base class, i.e. cannot be called with a pointer to <code>Base</code>.  You&#39;d have to make them (pure) virtual in the base class."}, {"owner": {"reputation": 614, "user_id": 4681087, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/063629fc6f4cbc04c5767eb811d8dc5f?s=128&d=identicon&r=PG&f=1", "display_name": "Kys Plox", "link": "https://stackoverflow.com/users/4681087/kys-plox"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1513800960, "post_id": 47913681, "comment_id": 82795159, "body": "My idea is to let the user implement functions in a class that inherits a base class and then be able to pass these functions to my class which then stores them in an array and calls them on certain conditions that are specified."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1513801055, "post_id": 47913681, "comment_id": 82795204, "body": "Then you&#39;d need something like <code>std::vector&lt; std::variant&lt; std::function&lt;void(Base*)&gt;, std::function&lt;void(X*)&gt;, std::function&lt;void(Y*)&gt; &gt; &gt;</code>.  Maybe open a textbook and review how inheritance works."}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 1, "creation_date": 1513801364, "post_id": 47913681, "comment_id": 82795336, "body": "More importantly, the signature <code>void X::XFunc()</code> is incompatible with <code>void(T*)</code> (for arbitrary types <code>T</code>)."}, {"owner": {"reputation": 614, "user_id": 4681087, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/063629fc6f4cbc04c5767eb811d8dc5f?s=128&d=identicon&r=PG&f=1", "display_name": "Kys Plox", "link": "https://stackoverflow.com/users/4681087/kys-plox"}, "edited": false, "score": 0, "creation_date": 1513801603, "post_id": 47913681, "comment_id": 82795451, "body": "But the first push works so doesn&#39;t that mean it is convertable?"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1513801678, "post_id": 47913681, "comment_id": 82795487, "body": "This looks a bit like a XY-problem. Why do you need such array of member functions at all, in preference of simple virtual (or even static) polymorphism? As for your edit: Make your exact use case clearer please. How do you actually intend to use <code>std::vector&lt;std::function&lt;void(Base*)&gt;&gt; v;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 614, "user_id": 4681087, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/063629fc6f4cbc04c5767eb811d8dc5f?s=128&d=identicon&r=PG&f=1", "display_name": "Kys Plox", "link": "https://stackoverflow.com/users/4681087/kys-plox"}, "edited": false, "score": 0, "creation_date": 1513857214, "post_id": 47914094, "comment_id": 82816345, "body": "I got a <code>error C2440: &#39;&lt;function-style-cast&gt;&#39;: cannot convert from &#39;open_mem_fun&lt;void,X&gt;&#39; to &#39;std::function&lt;void (Base *)&gt;&#39;</code>"}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "reply_to_user": {"reputation": 614, "user_id": 4681087, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/063629fc6f4cbc04c5767eb811d8dc5f?s=128&d=identicon&r=PG&f=1", "display_name": "Kys Plox", "link": "https://stackoverflow.com/users/4681087/kys-plox"}, "edited": false, "score": 1, "creation_date": 1513857967, "post_id": 47914094, "comment_id": 82816752, "body": "@KysPlox: I typed the code on a phone and didn\u2019t have easy access to a compiler. I added a missing template declaration but still can\u2019t test easily. I\u2019m pretty sure the overall approach works although it may need some fixing of typos."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1513858412, "post_id": 47914094, "comment_id": 82817001, "body": "@DietmarK&#252;hl I tested it just now and it works fine :)"}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1513858581, "post_id": 47914094, "comment_id": 82817095, "body": "@Quentin: thank you for testing! Of course, I don\u2019t know if this class template is actually useful for anything: personally I can\u2019t imagine a use-case so far."}, {"owner": {"reputation": 614, "user_id": 4681087, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/063629fc6f4cbc04c5767eb811d8dc5f?s=128&d=identicon&r=PG&f=1", "display_name": "Kys Plox", "link": "https://stackoverflow.com/users/4681087/kys-plox"}, "edited": false, "score": 0, "creation_date": 1513860211, "post_id": 47914094, "comment_id": 82818049, "body": "Yep it works now, I was trying to fix it in a wrong way.. Thank you very much!"}], "tags": [], "owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "is_accepted": true, "score": 2, "last_activity_date": 1513857848, "last_edit_date": 1513857848, "creation_date": 1513802602, "answer_id": 47914094, "question_id": 47913681, "link": "https://stackoverflow.com/questions/47913681/array-of-generic-member-functions-of-base-class/47914094#47914094", "title": "Array of generic member functions of base class", "body": "<p>I think you\u2019d need something akin <code>std::mem_fn()</code> but with the added flexibility of converting the object pointer. That should be straight forward to create:</p>\n\n<pre><code>template &lt;typename R, typename X&gt;\nclass open_mem_fun {\n    R (X::*fn)();\npublic:\n    open_mem_fun(R (X::*fn)()): fn(fn) {}\n    template &lt;typename T&gt;\n    R operator()(T* p) const {\n        return (dynamic_cast&lt;X&amp;&gt;(*p).*fn)();\n    }\n};\ntemplate &lt;typename R, typename X&gt;\nopen_mem_fun&lt;R, X&gt; open_mem_fn(R (X::*fn)()) {\n    return open_mem_fun&lt;R, X&gt;(fn);\n}\n</code></pre>\n\n<p>The resulting objects should be callable via a suitable <code>std::function</code> object:</p>\n\n<pre><code>std::function&lt;void(Base*)&gt;(open_mem_fn(&amp;X::XFunc));\n</code></pre>\n"}], "owner": {"reputation": 614, "user_id": 4681087, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/063629fc6f4cbc04c5767eb811d8dc5f?s=128&d=identicon&r=PG&f=1", "display_name": "Kys Plox", "link": "https://stackoverflow.com/users/4681087/kys-plox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 47914094, "answer_count": 1, "score": -1, "last_activity_date": 1513857848, "creation_date": 1513800649, "last_edit_date": 1513801936, "question_id": 47913681, "link": "https://stackoverflow.com/questions/47913681/array-of-generic-member-functions-of-base-class", "title": "Array of generic member functions of base class", "body": "<p>I want to create an array of functions to member functions that have the same signature but are of different classes. (But they are inherited). I tried something like this and I understand why it doesn't work but how can I work around that and still be able to do this? I don't mind if for example the function doesnt exist on the object I pass (if it is of another class) since I have logic for that.</p>\n\n<pre><code>class Base \n{\npublic:\n    virtual void BaseFunc();\n};\n\nclass X : Base \n{\npublic:\n    void XFunc();\n};\n\nclass Y : Base\n{\npublic:\n    void YFunc();\n};\nint main()\n{\n    std::vector&lt;std::function&lt;void(Base*)&gt;&gt; v;\n    v.push_back(&amp;Base::BaseFunc); //OK\n    v.push_back(&amp;X::XFunc); //NOT OK\n    v.push_back(&amp;Y::YFunc); //NOT OK\n}\n</code></pre>\n\n<p>I also tried having a template class that has a pointer to a member function of that class and then I would call from that class, but I can't have an array of templated class without giving the template argument(even if the class is simple and size doesn't depend on template argument).\nI also tried having the array just of void pointers but I found out that it is impossible to cast member function pointer to a void pointer.(I may not be right so if it is possible let me know)</p>\n\n<p>Edit: To provide some background about my intent I'll paste my comment here: My idea is to let the user implement functions in a class that inherits a base class and then be able to pass these functions to my class which then stores them in an array and calls them on certain conditions that are specified.</p>\n\n<p>Edit 2: I need a solution that is in c++11 or c++14</p>\n"}, {"tags": ["c++", "class", "polymorphism", "overriding"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1513799375, "post_id": 47913386, "comment_id": 82794460, "body": "Does <code>Shape</code> need to do anything in particular when it&#39;s created?"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 4, "creation_date": 1513799396, "post_id": 47913386, "comment_id": 82794475, "body": "I would strongly recommend adding virtual destructor. <a href=\"https://stackoverflow.com/questions/461203/when-to-use-virtual-destructors\" title=\"when to use virtual destructors\">stackoverflow.com/questions/461203/&hellip;</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1513799424, "post_id": 47913386, "comment_id": 82794492, "body": "Yes, it&#39;s a good habit to use <code>override</code> when you intend to override a base&#39;s virtual member function."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1513799752, "post_id": 47913386, "comment_id": 82794617, "body": "Just note that <code>override</code> is new in C++11, so it you are using an older compiler, it won&#39;t compile."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1513799920, "post_id": 47913386, "comment_id": 82794685, "body": "Question 1 is probably a duplicate.  Question 2 is a different duplicate."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1513805819, "post_id": 47913386, "comment_id": 82797392, "body": "Distance between two points will be &quot;sqrt of sum of squares&quot; thingy.  An integer radius is unlikely, probably should be a double."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1513806863, "post_id": 47913386, "comment_id": 82797796, "body": "<code>virtual double getArea() const override ;</code> you could safely drop <code>virtual</code> and leave just <code>override</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1513800063, "post_id": 47913539, "comment_id": 82794754, "body": "A <code>virtual</code> destructor goes beyond that though. It&#39;s required for the base type if you are going to destroy derived objects using pointers to that base type."}], "tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 0, "last_activity_date": 1513799995, "creation_date": 1513799995, "answer_id": 47913539, "question_id": 47913386, "link": "https://stackoverflow.com/questions/47913386/using-cctor-dctor-and-override/47913539#47913539", "title": "using c&#39;ctor, d&#39;ctor and override", "body": "<p>As written none of these classes need either a copy constructor or a destructor. This is because all of the members are simple values that do not require anything more then a value copy or for the memory to simply be released.</p>\n\n<p>A dtor is needed when the class has resources (such as a file handle) that the compiler cannot know how to free.</p>\n"}, {"tags": [], "owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "is_accepted": false, "score": 1, "last_activity_date": 1513800934, "creation_date": 1513800934, "answer_id": 47913744, "question_id": 47913386, "link": "https://stackoverflow.com/questions/47913386/using-cctor-dctor-and-override/47913744#47913744", "title": "using c&#39;ctor, d&#39;ctor and override", "body": "<p>Your <code>Shape</code> class doesn\u2019t need a ctor but it is advisible to give it a <code>virtual</code> dtor:</p>\n\n<pre><code>class Shape {\npublic:\n    virtual ~Shape() = default;\n    // ...\n};\n</code></pre>\n\n<p>Without this <code>virtual</code> destructor it is undefined behavior to <code>delete</code> an object via a pointer to <code>Shape</code>: no concrete type can be of dynamic type <code>Shape</code> but <code>delete</code>ing an object through a pointer with a different static type is undefined behavior when the dtor isn\u2019t <code>virtual</code>.</p>\n\n<p>With respect to the use of <code>override</code> I recommend using it! While it probably doesn\u2019t matter in a simple example like the one you showed it will become relevant when the class hierarchy grows. Any successful software will grow and it will add <code>virtual</code> functions and code clarity helps maintenance. ... and I prefer to plan for success.</p>\n"}, {"tags": [], "owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "is_accepted": false, "score": 0, "last_activity_date": 1513812977, "last_edit_date": 1513812977, "creation_date": 1513805719, "answer_id": 47914690, "question_id": 47913386, "link": "https://stackoverflow.com/questions/47913386/using-cctor-dctor-and-override/47914690#47914690", "title": "using c&#39;ctor, d&#39;ctor and override", "body": "<blockquote>\n  <p>Should I add override to the overridden methods in Circle, like this?</p>\n</blockquote>\n\n<p>IMHO, the term adds value.</p>\n\n<hr>\n\n<blockquote>\n  <p>Suppose I write the following (in the main):</p>\n</blockquote>\n\n<pre><code>Point o(0, 0); \nPoint a(0, 1); \nPoint b(1, 0); \nShape* shapes[] = { new Circle(a, b), \n                    new Circle(o, a, b), \n                    new Circle(o, 1) };\n</code></pre>\n\n<p>With these lines, my compiler now reports 2 additional errors (with 2 notes) ... </p>\n\n<pre><code>error: no matching function for call to \u2018Circle::Circle(Point&amp;, Point&amp;)\u2019\nnote:   no known conversion for argument 2 from \u2018Point\u2019 to \u2018int\u2019\n</code></pre>\n\n<p>also</p>\n\n<pre><code>error: no matching function for call to \u2018Circle::Circle(Point&amp;,Point&amp;,Point&amp;)\u2019\nnote:   candidate expects 2 arguments, 3 provided\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>Does the last line influence the need to use (or not use)  c'tor and d'tor?</p>\n</blockquote>\n\n<p>I think not.  </p>\n\n<p>Even before this 'code addition' the compiler gives warnings about having virtual functions and accessible non-virtual d'tors.  These warnings might be fixed by declaring the (missing) dtors virtual, but ... well, here they simply point out that your code does not compile clean.  </p>\n\n<hr>\n\n<p>You should complete your [MCVE].  As is, you provide insufficient information for a 'careful pick' of what (ctors, dtors) you do or do not provide.</p>\n\n<p>I usually come at these issues in another way.  My personal coding 'standard'  includes the following 6 ideas that, when I am in doubt, or don't understand why, I simply add these lines to my classes, in a private section.</p>\n\n<pre><code>  //  coding standard: disallow when not used\n  T(void)                  = delete; // default ctor    (1)\n ~T(void)                  = delete; // default dtor    (2)\n  T(const T&amp;)              = delete; // copy ctor       (3)\n  T(const T&amp;&amp;)             = delete; // move ctor       (4)\n  T&amp; operator= (const T&amp;)  = delete; // copy assignment (5)\n  T&amp; operator= (const T&amp;&amp;) = delete; // move assignment (6)\n</code></pre>\n\n<p>By 'T', I mean for you to replace the 'T' with your class name. It is easy, so I usually add to each of my classes.  i.e. repeat the above 6 lines, in a private area of each class, with T replaced.</p>\n\n<p>Now, your compiler can complain about something specific. I have found it quick to learn how to fix the issues this shows, so I offer one example.  </p>\n\n<p>If you ever get a MCVE, try the following additions:</p>\n\n<pre><code>class Shape          //abstract class//\n{\npublic:\n    virtual double getArea() const=0;\n    virtual double getPerim() const=0;\n\nprivate:\n   // coding standard - disallow when not used\n   Shape(void)                      = delete; // default ctor    (1)\n  ~Shape(void)                      = delete; // default dtor    (2)\n   Shape(const Shape&amp;)              = delete; // copy ctor       (3)\n   Shape(const Shape&amp;&amp;)             = delete; // move ctor       (4)\n   Shape&amp; operator= (const Shape&amp;)  = delete; // copy assignment (5)\n   Shape&amp; operator= (const Shape&amp;&amp;) = delete; // move assignment (6)\n};\n</code></pre>\n\n<p>Since the Shape class has only the compiler injected default ctor, (and dtor) I think these deletes will trigger an error in the compiler.  </p>\n\n<p>The idea is simply that if 'other code' (such as standard containers, or algorithms, or the compiler) does things with Shape and uses one or adds one or more of these 6, the compiler will notice that they are deleted, and generate an error for you.  </p>\n\n<p>I have been surprised by the standard containers as they often use more of these 6 than I expect.  With the ctor deleted, I get a chance to decide if I want to write something specific to this effort, or if the compiler-provided-default might be ok ... it often is.  In which case I simply comment out one or more of the 6 delete lines, then compile again.  </p>\n\n<p>I resist commenting out these deletes.  Sometimes it happens that one of my errors will trigger a use for one of the 6.   Got to be watching for those, too.</p>\n\n<ul>\n<li>Summary </li>\n</ul>\n\n<p>These 6 lines (and there are other's you might choose to consider) will keep you informed of what methods the compiler is providing as a 'service'.  (Most of the time, I dislike implicit conversions, too.)</p>\n\n<p>So, instead of trying to understand why you might want or not want one these 6, this technique allows you find out what your program <strong>requires</strong>.  Using each line (i.e. disabling at least long enough to see where and what for), the compiler complaints show where that 'move ctor' or 'move assignment' is being used.  Very helpful when you know you didn't do it!</p>\n"}], "owner": {"reputation": 35, "user_id": 7401063, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1851aa073836635911a3b9cf6eeb5cc2?s=128&d=identicon&r=PG&f=1", "display_name": "TRUMPI", "link": "https://stackoverflow.com/users/7401063/trumpi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1513812977, "creation_date": 1513799290, "last_edit_date": 1513800972, "question_id": 47913386, "link": "https://stackoverflow.com/questions/47913386/using-cctor-dctor-and-override", "title": "using c&#39;ctor, d&#39;ctor and override", "body": "<p>Suppose I want to define a class named <code>Circle</code>, which has methods to calculate its area and perimeter. This class uses another class named <code>Point</code>.  Suppose also that this class inherits from an abstract class named <code>Shape</code>.</p>\n\n<p>So, I wrote the following code:</p>\n\n<p>circle.h</p>\n\n<pre><code>#ifndef Circle_h\n#define Circle_h\n#include \"Point.h\"\n#include \"Shape.h\"\n\nclass Circle : public Shape\n{\npublic:\n\n    Circle(const Point &amp;ceneter , int radius);\n    ~Circle();\n\n    virtual double getArea() const ;\n    virtual double getPerim() const ;\n\nprivate:\n    int radius;\n    Point center;\n};\n\n#endif \n</code></pre>\n\n<p>shape.h</p>\n\n<pre><code>#ifndef Shape_h\n#define Shape_h\n#include \"Point.h\"\n#include &lt;iostream&gt;\n\nclass Shape          //abstract class//\n{\npublic:\n\n    virtual double getArea() const=0;\n    virtual double getPerim() const=0;\n};\n\n#endif \n</code></pre>\n\n<p>point.h</p>\n\n<pre><code>#ifndef Point_h\n#define Point_h\n\nclass Point\n{\npublic:\n\n    Point(int x, int y);\n    ~Point();\n\n    int getX() const;\n    int getY() const;\n\n    void setX(int x);\n    void setY(int y);\n\nprivate:\n\n    int x, y;\n};\n\n#endif \n</code></pre>\n\n<p>I am not so sure about 2 things:</p>\n\n<ol>\n<li><p><strong>Should I add a c'tor and d'ctor to the <code>Shape</code> class?</strong> </p>\n\n<p>Cause as far as I understand it, since that class is abstract, there is no need in them.</p></li>\n<li><p><strong>Should I add <code>override</code> to the overridden methods in <code>Circle</code>, like this?</strong></p>\n\n<pre><code>virtual double getArea() const override ;\nvirtual double getPerim() const override ;\n</code></pre></li>\n<li><p>Suppose I write the following (in the main):</p>\n\n<pre><code>Point o(0, 0);\n\nPoint a(0, 1);\n\nPoint b(1, 0);\n\nShape *shapes[] = { new Circle(a, 2), new Circle(b,3), new Circle(o, 1 };\n</code></pre></li>\n</ol>\n\n<p><strong>How does the last line whould influence on the need to use (or not use) c'tor and d'tor?</strong></p>\n"}, {"tags": ["c++", "visual-studio", "gcc", "directory", "copy"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1513802656, "post_id": 47913379, "comment_id": 82796001, "body": "What are the times you see when using the native system commands to inspect the files?  And what type of file-system(s) are you using, different file-system record time with different accuracy?  For example the FAT based file-systems have a time granularity of 2 seconds."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1513804567, "post_id": 47913379, "comment_id": 82796823, "body": "@RichardCritten Unsurprisingly they both show the exact same time that is output. I don&#39;t know of any way to look at the date at a higher granularity than that. I don&#39;t really know any reason why there would need to be a higher granularity than that."}], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513799944, "creation_date": 1513799258, "last_edit_date": 1513799944, "question_id": 47913379, "link": "https://stackoverflow.com/questions/47913379/last-write-time-mismatch-on-copied-directories", "title": "last_write_time Mismatch on Copied Directories", "body": "<p>I'm uncertain whether this is a platform difference or an implementation difference. I'm hoping that someone can help me shed light on that. Given this code:</p>\n\n<pre><code>filesystem::path foo(\"foo\");\nfilesystem::path bar(\"bar\");\n\nfilesystem::create_directories(foo);\n\nfilesystem::copy(foo, bar);\n\nconst auto fooftime = filesystem::last_write_time(foo);\nconst auto barftime = filesystem::last_write_time(bar);\nconst auto foocftime = decltype(fooftime)::clock::to_time_t(fooftime);\nconst auto barcftime = decltype(barftime)::clock::to_time_t(barftime);\n\ncout &lt;&lt; '(' &lt;&lt; foocftime &lt;&lt; ')' &lt;&lt; asctime(localtime(&amp;foocftime)) &lt;&lt; '(' &lt;&lt; barcftime &lt;&lt; ')' &lt;&lt; asctime(localtime(&amp;barcftime)) &lt;&lt; (fooftime == barftime) &lt;&lt; endl;\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/9da89e4b76608d52\" rel=\"nofollow noreferrer\">gcc outputs</a>:</p>\n\n<blockquote>\n  <p>(1513798777)Wed Dec 20 19:39:37 2017<br>\n  (1513798777)Wed Dec 20 19:39:37 2017<br>\n  1</p>\n</blockquote>\n\n<p>But Visual Studio will output:</p>\n\n<blockquote>\n  <p>(1513798819)Wed Dec 20 14:40:19 2017<br>\n  (1513798819)Wed Dec 20 14:40:19 2017<br>\n  0</p>\n</blockquote>\n\n<p>This seems like <code>fooftime</code> and <code>barftime</code> are equal, but when I inspect the variables in the Visual Studio debugger they contain more precision than they're outputting, <em>and they differ in that extended precision</em>. Can someone help me understand where the breakdown here is?</p>\n\n<p><a href=\"https://i.stack.imgur.com/60hQQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/60hQQ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "packet-capture", "winpcap", "npcap"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1513799210, "post_id": 47913208, "comment_id": 82794385, "body": "Good luck hoping somebody will read all of this. Please get familiar with an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> concept"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513800014, "post_id": 47913208, "comment_id": 82794728, "body": "What is the actual value of <code>header-&gt;caplen</code>?  This line: <code>printf(&quot;\\n\\nRecieved Packet Size caplen: %zu&quot;, header-&gt;caplen)</code> is not convincing due to <code>printf</code> not being typesafe.  You should use a debugger to verify the actual value, or use <code>std::cout</code> which is typesafe."}, {"owner": {"reputation": 1, "user_id": 3397244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39680af8ce0a16b826543ff2b87a0882?s=128&d=identicon&r=PG&f=1", "display_name": "user3397244", "link": "https://stackoverflow.com/users/3397244/user3397244"}, "edited": false, "score": 0, "creation_date": 1513801326, "post_id": 47913208, "comment_id": 82795313, "body": "No need to read whole question .. first para explains everything.."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3397244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39680af8ce0a16b826543ff2b87a0882?s=128&d=identicon&r=PG&f=1", "display_name": "user3397244", "link": "https://stackoverflow.com/users/3397244/user3397244"}, "edited": false, "score": 0, "creation_date": 1513863204, "post_id": 47913459, "comment_id": 82819924, "body": "I used %u and still the values are very huge.. I tried using std::cout as well.. Even that shows the values are huge. An additonal info if that helps.. this code was built and tested on a linux machine and it worked good there.. it was 32 bit.. ported to windows 10 and it is having this random packet size problem. I think somehow it is how I am treating this values.. The reason is that when I write these packets to a pcap file and open, the file has perfect packets.. with good size packets, etc.."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1604597222, "post_id": 47913459, "comment_id": 114402012, "body": "Try %i, some if the printed values look like an unsigned interpretation of a negative value."}], "tags": [], "owner": {"reputation": 1161, "user_id": 1849769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd80cd843b2791a1312106d13d4fc10?s=128&d=identicon&r=PG", "display_name": "Pezo", "link": "https://stackoverflow.com/users/1849769/pezo"}, "is_accepted": false, "score": 0, "last_activity_date": 1513803023, "last_edit_date": 1513803023, "creation_date": 1513799665, "answer_id": 47913459, "question_id": 47913208, "link": "https://stackoverflow.com/questions/47913208/getting-a-huge-value-in-caplen-and-len-in-winpcap-packet-capture/47913459#47913459", "title": "Getting a huge value in caplen and len in winpcap packet capture", "body": "<p>A quick look at the libpcap source seems to suggest that <code>caplen</code> and <code>len</code> are of 32 bit unsigned type, but you're using <code>%zu</code> which is for <code>size_t</code> (which may be 64 bits).</p>\n\n<p>Try with <code>%u</code> and see if the output looks right then.</p>\n"}], "owner": {"reputation": 1, "user_id": 3397244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39680af8ce0a16b826543ff2b87a0882?s=128&d=identicon&r=PG&f=1", "display_name": "user3397244", "link": "https://stackoverflow.com/users/3397244/user3397244"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1604596580, "creation_date": 1513798533, "last_edit_date": 1604596580, "question_id": 47913208, "link": "https://stackoverflow.com/questions/47913208/getting-a-huge-value-in-caplen-and-len-in-winpcap-packet-capture", "title": "Getting a huge value in caplen and len in winpcap packet capture", "body": "<p>I am writing a packet capture program.\nI am using npcap and attaching the code and also the output when i run it..\nThe problem is that the caplen and the len values printed are very huge numbers.. and randonly small as 20 sometimes which is not possible.\nCode is simple exmaple code that comes with npcap.\nCan someone suggest that is going wrong here..?</p>\n\n<p>Surprisingly, the captured file when opened in wireshark has the exact packet count and the packets are also readable..\nSo not sur why the caplen and len are showing wrong numbers.</p>\n\n<pre><code>Code is : \n\n.#ifdef _MSC_VER\n/*\n * we do not want the warnings about the old deprecated and unsecure CRT functions\n * since these examples can be compiled under *nix as well\n */\n.#define _CRT_SECURE_NO_WARNINGS\n.#endif\n\n.#include \"pcap.h\"\n\n/* prototype of the packet handler */\nvoid packet_handler(u_char *param, const struct pcap_pkthdr *header, const u_char *pkt_data);\n\nint main(int argc, char **argv)\n{\n    pcap_if_t *alldevs;\n    pcap_if_t *d;\n    int inum;\n    int i=0;\n    pcap_t *adhandle;\n    char errbuf[PCAP_ERRBUF_SIZE];\n    pcap_dumper_t *dumpfile;\n\n\n    /* Check command line */\n    if(argc != 2)\n    {\n        printf(\"usage: %s filename\", argv[0]);\n        return -1;\n    }\n\n    /* Retrieve the device list on the local machine */\n    if (pcap_findalldevs(&amp;alldevs, errbuf) == -1)\n    {\n        fprintf(stderr,\"Error in pcap_findalldevs: %s\\n\", errbuf);\n        return 0;\n    }\n\n    /* Print the list */\n    for(d=alldevs; d; d=d-&gt;next)\n    {\n        printf(\"%d. %s\", ++i, d-&gt;name);\n        if (d-&gt;description)\n            printf(\" (%s)\\n\", d-&gt;description);\n        else\n            printf(\" (No description available)\\n\");\n    }\n\n    if(i==0)\n    {\n        printf(\"\\nNo interfaces found! Make sure WinPcap is installed.\\n\");\n        return -1;\n    }\n\n    printf(\"Enter the interface number (1-%d):\",i);\n    scanf(\"%d\", &amp;inum);\n\n    if(inum &lt; 1 || inum &gt; i)\n    {\n        printf(\"\\nInterface number out of range.\\n\");\n        /* Free the device list */\n        pcap_freealldevs(alldevs);\n        return -1;\n    }\n\n    /* Jump to the selected adapter */\n    for(d=alldevs, i=0; i&lt; inum-1 ;d=d-&gt;next, i++);\n\n\n    /* Open the adapter */\n    if ((adhandle= pcap_open_live(d-&gt;name,  // name of the device\n                             65536,         // portion of the packet to capture.\n                                            // 65536 grants that the whole packet will be captured on all the MACs.\n                             1,             // promiscuous mode (nonzero means promiscuous)\n                             1000,          // read timeout\n                             errbuf         // error buffer\n                             )) == NULL)\n    {\n        fprintf(stderr,\"\\nUnable to open the adapter. %s is not supported by WinPcap\\n\", d-&gt;name);\n        /* Free the device list */\n        pcap_freealldevs(alldevs);\n        return -1;\n    }\n\n    /* Open the dump file */\n    dumpfile = pcap_dump_open(adhandle, argv[1]);\n\n    if(dumpfile==NULL)\n    {\n        fprintf(stderr,\"\\nError opening output file\\n\");\n        return -1;\n    }\n\n    printf(\"\\nlistening on %s... Press Ctrl+C to stop...\\n\", d-&gt;description);\n\n    /* At this point, we no longer need the device list. Free it */\n    pcap_freealldevs(alldevs);\n\n    /* start the capture */\n    pcap_loop(adhandle, 0, packet_handler, (unsigned char *)dumpfile);\n\n    pcap_close(adhandle);\n    return 0;\n}\n\nint count = 0;\n/* Callback function invoked by libpcap for every incoming packet */\nvoid packet_handler(u_char *dumpfile, const struct pcap_pkthdr *header, const u_char *pkt_data)\n{\n\n    printf (\"\\nPacket count is %d\", count++);\n    /* save the packet on the dump file */\n    pcap_dump(dumpfile, header, pkt_data);\n\n    printf(\"\\n\\nRecieved Packet Size caplen: %zu\", header-&gt;caplen); /* Length of header */\n    printf(\"\\nRecieved Packet Size just len: %lu\\n\", header-&gt;len); /* Length of header */\n\n}\n\n\nOutput of the program : \n\n\nC:\\eclipse\\w1\\tn\\Debug&gt;tn pdump\n1. \\Device\\NPF_{3A8147EC-2368-4216-9603-7641E806F7CE} (Realtek PCIe GBE Family Controller)\n2. \\Device\\NPF_{E39C84EC-CB5D-4300-A5C1-C63EDE0B583C} (Microsoft)\n3. \\Device\\NPF_{2F63E116-DEB4-4FE4-9E27-85DCA9E68C5C} (VMware Virtual Ethernet Adapter)\n4. \\Device\\NPF_{996ACB8F-C0AC-4FF3-8E79-B0C849CC9CF1} (MS NDIS 6.0 LoopBack Driver)\n5. \\Device\\NPF_{619BA8D0-363E-4BCB-8739-4537D3FDAD87} (MS NDIS 6.0 LoopBack Driver)\n6. \\Device\\NPF_{E2FB8B54-0E25-498C-975A-32873AC52060} (VMware Virtual Ethernet Adapter)\n7. \\Device\\NPF_{9B17BD4E-E20D-43A3-A8C6-AC8C3C431182} (Microsoft)\nEnter the interface number (1-7):2\n\nlistening on Microsoft... Press Ctrl+C to stop...\n\nPacket count is 0\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 1\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 2\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 3\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 4\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 5\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 6\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 7\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 8\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 9\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 10\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 11\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 12\n\nRecieved Packet Size caplen: 1342177300\nRecieved Packet Size just len: 3632886444\n\nPacket count is 13\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 14\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 15\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 16\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 17\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 18\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 19\n\nRecieved Packet Size caplen: 1161363476\nRecieved Packet Size just len: 4294967295\n\nPacket count is 20\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 6160385\n\nPacket count is 21\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 22\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 23\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 24\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 25\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 1970834832\n\nPacket count is 26\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 27\n\nRecieved Packet Size caplen: 4278190100\nRecieved Packet Size just len: 4294967295\n\nPacket count is 28\n\nRecieved Packet Size caplen: 16711700\nRecieved Packet Size just len: 4294967295\n\nPacket count is 29\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 4294967295\n\nPacket count is 30\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 4294967295\n\nPacket count is 31\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 4294967295\n\nPacket count is 32\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 33\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 34\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 35\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 36\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 2136866817\n\nPacket count is 37\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 38\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 39\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 40\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 41\n\nRecieved Packet Size caplen: 872349716\nRecieved Packet Size just len: 3632886444\n\nPacket count is 42\n\nRecieved Packet Size caplen: 872349716\nRecieved Packet Size just len: 3632886444\n\nPacket count is 43\n\nRecieved Packet Size caplen: 4281532436\nRecieved Packet Size just len: 3632886444\n\nPacket count is 44\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 45\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 46\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 47\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 48\n\nRecieved Packet Size caplen: 4281532436\nRecieved Packet Size just len: 3632886444\n\nPacket count is 49\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 50\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 51\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 52\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 53\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 1970834832\n\nPacket count is 54\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 55\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 6160385\n\nPacket count is 56\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 1970834832\n\nPacket count is 57\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 58\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 2136866817\n\nPacket count is 59\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 2136866817\n\nPacket count is 60\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 2136866817\n\nPacket count is 61\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 2136866817\n\nPacket count is 62\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 63\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 64\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 65\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 66\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 67\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 68\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 69\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 70\n\nRecieved Packet Size caplen: 1929379860\nRecieved Packet Size just len: 3632886444\n\nPacket count is 71\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 72\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 73\n\nRecieved Packet Size caplen: 5111828\nRecieved Packet Size just len: 3632886444\n\nPacket count is 74\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 75\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 76\n\nRecieved Packet Size caplen: 5701652\nRecieved Packet Size just len: 3632886444\n\nPacket count is 77\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 78\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 79\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 80\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 81\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 82\n\nRecieved Packet Size caplen: 822083604\nRecieved Packet Size just len: 3632886444\n\nPacket count is 83\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 84\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 85\n\nRecieved Packet Size caplen: 1448083476\nRecieved Packet Size just len: 3632886444\n\nPacket count is 86\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 87\n\nRecieved Packet Size caplen: 1073741844\nRecieved Packet Size just len: 3632886444\n\nPacket count is 88\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 89\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 90\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 91\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 92\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 93\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 94\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 1970834832\n\nPacket count is 95\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 96\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 1970834832\n\nPacket count is 97\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 1970834832\n\nPacket count is 98\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 1970834832\n\nPacket count is 99\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 100\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 1970834832\n\nPacket count is 101\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 1970834832\n\nPacket count is 102\n\nRecieved Packet Size caplen: 872349716\nRecieved Packet Size just len: 1970834832\n\nPacket count is 103\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 104\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 1970834832\n\nPacket count is 105\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 106\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 107\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 1970834832\n\nPacket count is 108\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 109\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 3632886444\n\nPacket count is 110\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 1970834832\n\nPacket count is 111\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 112\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 113\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 1970834832\n\nPacket count is 114\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 3632886444\n\nPacket count is 115\n\nRecieved Packet Size caplen: 562102292\nRecieved Packet Size just len: 1970834832\n\nPacket count is 116\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 117\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 1970834832\n\nPacket count is 118\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 1970834832\n\nPacket count is 119\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 120\n\nRecieved Packet Size caplen: 4281532436\nRecieved Packet Size just len: 3632886444\n\nPacket count is 121\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 1970834832\n\nPacket count is 122\n\nRecieved Packet Size caplen: 872349716\nRecieved Packet Size just len: 3632886444\n\nPacket count is 123\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 124\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 125\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 1970834832\n\nPacket count is 126\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 1970834832\n\nPacket count is 127\n\nRecieved Packet Size caplen: 4281532436\nRecieved Packet Size just len: 3632886444\n\nPacket count is 128\n\nRecieved Packet Size caplen: 4294901780\nRecieved Packet Size just len: 1970834832\n\nPacket count is 129\n\nRecieved Packet Size caplen: 4281532436\nRecieved Packet Size just len: 3632886444\n\nPacket count is 130\n\nRecieved Packet Size caplen: 4281532436\nRecieved Packet Size just len: 3632886444\n\nPacket count is 131\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 132\n\nRecieved Packet Size caplen: 872349716\nRecieved Packet Size just len: 1970834832\n\nPacket count is 133\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 134\n\nRecieved Packet Size caplen: 4281532436\nRecieved Packet Size just len: 3632886444\n\nPacket count is 135\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 4294967295\n\nPacket count is 136\n\nRecieved Packet Size caplen: 872349716\nRecieved Packet Size just len: 4294967295\n\nPacket count is 137\n\nRecieved Packet Size caplen: 4281532436\nRecieved Packet Size just len: 3632886444\n\nPacket count is 138\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 4294967295\n\nPacket count is 139\n\nRecieved Packet Size caplen: 872349716\nRecieved Packet Size just len: 4294967295\n\nPacket count is 140\n\nRecieved Packet Size caplen: 4281532436\nRecieved Packet Size just len: 4294967295\n\nPacket count is 141\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 142\n\nRecieved Packet Size caplen: 872349716\nRecieved Packet Size just len: 4294967295\n\nPacket count is 143\n\nRecieved Packet Size caplen: 4281532436\nRecieved Packet Size just len: 4294967295\n\nPacket count is 144\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 4294967295\n\nPacket count is 145\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 146\n\nRecieved Packet Size caplen: 4281532436\nRecieved Packet Size just len: 4294967295\n\nPacket count is 147\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 4294967295\n\nPacket count is 148\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 3632886444\n\nPacket count is 149\n\nRecieved Packet Size caplen: 4281532436\nRecieved Packet Size just len: 4294967295\n\nPacket count is 150\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 4294967295\n\nPacket count is 151\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 4294967295\n\nPacket count is 152\n\nRecieved Packet Size caplen: 858980372\nRecieved Packet Size just len: 4294967295\n\nPacket count is 153\n\nRecieved Packet Size caplen: 872349716\nRecieved Packet Size just len: 4294967295\n\nPacket count is 154\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 155\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 156\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 157\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 158\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 159\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 160\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 161\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 162\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 163\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n\nPacket count is 164\n\nRecieved Packet Size caplen: 20\nRecieved Packet Size just len: 4294967295\n</code></pre>\n"}, {"tags": ["c++", "linux", "linker", "gdb"], "comments": [{"owner": {"reputation": 219, "user_id": 1156774, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ed0e1a73948b09357a332d5a96a4f4d1?s=128&d=identicon&r=PG", "display_name": "ifnull", "link": "https://stackoverflow.com/users/1156774/ifnull"}, "edited": false, "score": 1, "creation_date": 1513848856, "post_id": 47913199, "comment_id": 82811301, "body": "Update: it works if I replace <code>g++</code> with <code>clang++</code>. It seems that the problem is somehow related to <code>gcc</code>."}], "owner": {"reputation": 219, "user_id": 1156774, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ed0e1a73948b09357a332d5a96a4f4d1?s=128&d=identicon&r=PG", "display_name": "ifnull", "link": "https://stackoverflow.com/users/1156774/ifnull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 520, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1513798498, "creation_date": 1513798498, "question_id": 47913199, "link": "https://stackoverflow.com/questions/47913199/gdb-cannot-find-symbols-when-debug-symbols-are-split-into-dwo-dwarf-file", "title": "gdb cannot find symbols when debug symbols are split into dwo dwarf file", "body": "<p>I want to build a binary with <code>g++</code> and split debug info into a separate file. So-called <code>DebugFission</code>.</p>\n\n<p>Let's say you are in a folder. There is a file <code>src/main.cpp</code> with trivial content: <code>int main() {}</code></p>\n\n<p>I want to compile it using <code>-gsplit-dwarf</code>:</p>\n\n<pre><code>mkdir -p obj\n(cd obj &amp;&amp; g++ -c -g -gsplit-dwarf ../src/main.cpp -o main.o)\ng++ -Wl,--gdb-index -fuse-ld=gold  obj/*.o -o main\n</code></pre>\n\n<p>And I want to set a breakpoint in <code>main</code> function:</p>\n\n<pre><code>gdb main\n(gdb) b main\nBreakpoint 1 at 0x40058a: file ../src/main.cpp, line 2.\n(gdb) r\nBreakpoint 1, main () at ../src/main.cpp:2\n2       ../src/main.cpp: No such file or directory.\n</code></pre>\n\n<p>But <code>gdb</code> cannot find symbols. It tries to look for symbols relative to <code>obj</code> directory.</p>\n\n<p>Am I missing some arguments?</p>\n\n<p>I use the following versions: <code>gcc-4.9.3</code>, <code>binutils-2.26.1</code>, <code>gdb-7.11.1</code>.</p>\n\n<p><em>Some extra info</em>:</p>\n\n<pre><code>readelf -wi main\nContents of the .debug_info section:\n...\n&lt;20&gt;   DW_AT_GNU_dwo_name: (indirect string, offset: 0x0): main.dwo\n&lt;24&gt;   DW_AT_comp_dir    : (indirect string, offset: 0x9): /tmp/blah/obj\n&lt;2c&gt;   DW_AT_GNU_dwo_id  : 0xf4f335f2e5c313e0\n\nreadelf -wi obj/main.dwo\nContents of the .debug_info.dwo section:\n...\n&lt;c&gt;   DW_AT_producer    : (indexed string: 0x0): GNU C++ 4.9.3 -mtune=generic -march=x86-64 -g -gsplit-dwarf -fstack-protector-strong\n&lt;d&gt;   DW_AT_language    : 4 (C++)\n&lt;e&gt;   DW_AT_name        : (indexed string: 0x3): ../src/main.cpp\n&lt;f&gt;   DW_AT_comp_dir    : (indexed string: 0x1): /tmp/blah/obj\n&lt;10&gt;   DW_AT_GNU_dwo_id  : 0xf4f335f2e5c313e0\n...\n</code></pre>\n"}, {"tags": ["android", "c++"], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 9077863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5727514b2b054bf61d2c1e3b582d8dfa?s=128&d=identicon&r=PG&f=1", "display_name": "StrayPointer", "link": "https://stackoverflow.com/users/9077863/straypointer"}, "is_accepted": false, "score": 0, "last_activity_date": 1513799255, "creation_date": 1513799255, "answer_id": 47913376, "question_id": 47913133, "link": "https://stackoverflow.com/questions/47913133/python-error-launching-native-debug-session-in-android-studio/47913376#47913376", "title": "Python Error Launching Native Debug Session in Android Studio", "body": "<p>Have you tried to run without the PYTHONPATH environment variable? If you attach a phone your device maybe see if you can push an apk onto it. Or use a emulator. If that works then try again and include PYTHONPATH</p>\n"}], "owner": {"reputation": 1, "user_id": 8683872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0567c2ec9cfce29a70f6035d183cb914?s=128&d=identicon&r=PG&f=1", "display_name": "ewagsi_jr", "link": "https://stackoverflow.com/users/8683872/ewagsi-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513799255, "creation_date": 1513798204, "question_id": 47913133, "link": "https://stackoverflow.com/questions/47913133/python-error-launching-native-debug-session-in-android-studio", "title": "Python Error Launching Native Debug Session in Android Studio", "body": "<p>I have created an Android Project with C++ support with empty MainActivity.\nBefore making any changes I try to run it and get this error:</p>\n\n<blockquote>\n  <p>Connecting to com.ewa.myapplication Now Launching Native Debug Session<br>\n  File \"C:\\Python3\\Lib\\site.py\", line 177<br>\n      file=sys.stderr)<br>\n          ^ SyntaxError: invalid syntax</p>\n  \n  <p>Process finished with exit code 0</p>\n</blockquote>\n\n<p>Why is this error happening?</p>\n\n<p>Win10 dev environment<br>\nAndroid Studio 3.0.1<br>\nPYTHONPATH =  C:\\Python3;C:\\Python3\\Lib;C:\\Python3\\DLLs;C:\\Python3\\Lib\\lib-tk</p>\n"}, {"tags": ["c++", "boost-asio"], "comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 2, "creation_date": 1513822514, "post_id": 47913054, "comment_id": 82801993, "body": "<i>&quot;The usual approach to fixing this is to have a queue of outgoing buffers, instead of a single one, and send them in succession, e.g. <a href=\"https://stackoverflow.com/questions/7754695/boost-asio-async-write-how-to-not-interleaving-async-write-calls/7756894#7756894\">boost asio async_write : how to not interleaving async_write calls</a>?&quot;</i> (quoted from <a href=\"https://stackoverflow.com/a/46983984/85371\">this previously deleted answer</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 15204, "user_id": 453271, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/G7rcK.png?s=128&g=1", "display_name": "Andriy Tylychko", "link": "https://stackoverflow.com/users/453271/andriy-tylychko"}, "is_accepted": false, "score": 3, "last_activity_date": 1513799254, "creation_date": 1513799254, "answer_id": 47913375, "question_id": 47913054, "link": "https://stackoverflow.com/questions/47913054/boostasioasync-write-ensure-only-one-outstanding-call/47913375#47913375", "title": "boost::asio::async_write - ensure only one outstanding call", "body": "<p>Yes you need to wait for completion handler before calling <code>async_write</code> again. Are you sure you'll be blocked? Of course it depends on how fast you generate your data, but even if yes there's no way to send it faster than your network can handle it. If it's really an issue consider sending bigger chunks.</p>\n"}, {"comments": [{"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1513805667, "post_id": 47914384, "comment_id": 82797336, "body": "That&#39;s a lot of talk about fancy buffers and locking mechanisms around them :) What does it look like? I&#39;ve got no idea how to use asio::streambuf, or it I am allowed to modify it after posting a call, or if I need another seperate buffer of my own with locks around it and then grab things from it to put into the streambuf when I call send yet again from my handler.  Also, I have no idea what is meant by an input sequence and an output sequence. It contains a contiguous array of characters, no? What is the in vs the out?  Sure would be neat if they had any of this in their examples!"}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1513808857, "post_id": 47914384, "comment_id": 82798577, "body": "In the code you posted after edit, if I follow correctly, we are allocating new buffers every time send gets called after an async send gets posted. However, we are accumulating on the last buffer that was allocated until the aync send completes. It is most likely, also allocating internal space when the emplace_back is called (because that forwards arguments to constructor of const_buffer). I think I see how this is working, but isn&#39;t that expensive performance wise?"}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1513813033, "post_id": 47914384, "comment_id": 82799759, "body": "Almost got it all ready to test in my actual demo project. However, I am getting an error on the line &#39;buffers-&gt;emplace_back(data);&#39; that says, &quot;&#39;boost::asio::const_buffer::const_buffer(boost::asio::const&zwnj;&#8203;_buffer &amp;&amp;)&#39;: cannot convert argument 1 from &#39;const std::vector&lt;char,std::allocator&lt;char&gt;&gt;&#39; to &#39;const boost::asio::mutable_buffer &amp;&#39;&quot;"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 1, "creation_date": 1513858146, "post_id": 47914384, "comment_id": 82816851, "body": "The code is just to demonstrate the idea, is definitely not the most optimal. I&#39;ve just updated it to use a double buffer. The most efficient way though would be to use a circular buffer with an <a href=\"https://stackoverflow.com/questions/47366762/when-use-async-write-some-and-async-write\"><code>async_write_some</code></a> loop."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1513977199, "post_id": 47914384, "comment_id": 82864751, "body": "Unfortunately, after I implemented this and started testing it, I am still getting errors. I thought maybe it was unrelated, so I asked another question here: <a href=\"https://stackoverflow.com/questions/47944348/boostasio-double-buffering/47944638?noredirect=1#comment82859511_47944638\" title=\"boostasio double buffering\">stackoverflow.com/questions/47944348/boostasio-double-buffer&zwnj;&#8203;ing/&hellip;</a> and it seems that at least one person is indicating that the vector of buffers do not contain their own copy of the data, but instead that I must maintain the lifetime of the input vector&lt;char&gt; that was a parameter in Send. Now I am more confused. Are the asio buffers that are members not the storage?"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1514021560, "post_id": 47914384, "comment_id": 82872146, "body": "Yes the asio buffer is non-owning. But you should also avoid copying if at all possible. So I&#39;ve edited the answer to have the sender own the data, but do a move instead. So call it as <code>Send(std::move(data)); data.clear();</code>."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1514499128, "post_id": 47914384, "comment_id": 82999026, "body": "This latest listing does not work either. I appreciate the help and all, but can we please take the time to get an example that compiles and works, not only for my sake, but for the sake of others in the future?"}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1514569693, "post_id": 47914384, "comment_id": 83022432, "body": "Got it to work and posted in answer below for people looking in the future. Comment there is anything is incorrect."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1514926131, "post_id": 47914384, "comment_id": 83108768, "body": "&quot;<i>does not work</i>&quot; isn&#39;t a constructive feedback and SO isn&#39;t a code writing service. I think I&#39;ve provided more than sufficient information to answer the question. Nevertheless, the code I showed works. See the link to the <a href=\"https://stackoverflow.com/a/48043209/485343\">full example</a>."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1514931771, "post_id": 47914384, "comment_id": 83110913, "body": "&quot;does not work, because it will not compile&quot; is about as constructive as it gets. I gave you credit in my answer after waiting for several days after alerting you that it wasn&#39;t working. No, SO is not a code writing service, but answers should compile. Because SO is not a code writing service, I took what information I could gleam from your answer and created my own working example to assist others in the future who face the same roadblock that I faced. I thank you for your assistance."}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 3, "last_activity_date": 1514925151, "last_edit_date": 1514925151, "creation_date": 1513804179, "answer_id": 47914384, "question_id": 47913054, "link": "https://stackoverflow.com/questions/47913054/boostasioasync-write-ensure-only-one-outstanding-call/47914384#47914384", "title": "boost::asio::async_write - ensure only one outstanding call", "body": "<p>The <em>async</em> in <code>async_write()</code> refers to the fact that the function returns immediately while the writing happens in background. There should still be only one outstanding write at any given time.</p>\n\n<p>You need to use a <a href=\"http://www.boost.org/doc/libs/1_66_0/doc/html/boost_asio/overview/core/buffers.html\" rel=\"nofollow noreferrer\">buffer</a> if you have an asynchronous producer to set aside the new chunk of data until the currently active write completes, then issue a new async_write in the completion handler.</p>\n\n<p>That is, <code>Connection::Send</code> must only call <code>async_write</code> once to kick off the process, in subsequent calls it should instead buffer its data, which will be picked up in the completion handler of the currently executing <code>async_write</code>.</p>\n\n<p>For performance reasons you want to avoid copying the data into the buffer, and instead append the new chunk to a list of buffers and use the <a href=\"http://www.boost.org/doc/libs/1_66_0/doc/html/boost_asio/reference/async_write.html\" rel=\"nofollow noreferrer\">scatter-gather overload</a> of <code>async_write</code> that accepts a <code>ConstBufferSequence</code>. It is also possible to use one large <code>streambuf</code> as a buffer and append directly into it.</p>\n\n<p>Of course the buffer needs to be synchronized unless both <code>Connection::Send</code> and the <code>io_service</code> run in the same thread. An empty buffer can be reused as an indication that no <code>async_write</code> is in progress.</p>\n\n<p>Here's some code to illustrate what I mean:</p>\n\n<pre><code>struct Connection\n{\n    void Connection::Send(std::vector&lt;char&gt;&amp;&amp; data)\n    {\n        std::lock_guard&lt;std::mutex&gt; lock(buffer_mtx);\n        buffers[active_buffer ^ 1].push_back(std::move(data)); // move input data to the inactive buffer\n        doWrite();\n    }\n\nprivate:\n\n    void Connection::doWrite()\n    {\n        if (buffer_seq.empty()) { // empty buffer sequence == no writing in progress\n            active_buffer ^= 1; // switch buffers\n            for (const auto&amp; data : buffers[active_buffer]) {\n                buffer_seq.push_back(boost::asio::buffer(data));\n            }\n            boost::asio::async_write(m_socket, buffer_seq, [this] (const boost::system::error_code&amp; ec, size_t bytes_transferred) {\n                std::lock_guard&lt;std::mutex&gt; lock(buffer_mtx);\n                buffers[active_buffer].clear();\n                buffer_seq.clear();\n                if (!ec) {\n                    if (!buffers[active_buffer ^ 1].empty()) { // have more work\n                        doWrite();\n                    }\n                }\n            });\n        }\n    }\n\n    std::mutex buffer_mtx;\n    std::vector&lt;std::vector&lt;char&gt;&gt; buffers[2]; // a double buffer\n    std::vector&lt;boost::asio::const_buffer&gt; buffer_seq;\n    int active_buffer = 0;\n    . . .\n};\n</code></pre>\n\n<p>The complete working source can be found in <a href=\"https://stackoverflow.com/a/48043209/485343\">this answer</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "is_accepted": true, "score": 2, "last_activity_date": 1514569604, "creation_date": 1514569604, "answer_id": 48026383, "question_id": 47913054, "link": "https://stackoverflow.com/questions/47913054/boostasioasync-write-ensure-only-one-outstanding-call/48026383#48026383", "title": "boost::asio::async_write - ensure only one outstanding call", "body": "<p>Here is a complete, compilable, and tested, example, that I researched and got to work through trial and error after reading the answer and subsequent edits from RustyX.</p>\n\n<p><strong>Connection.h</strong></p>\n\n<pre><code>#pragma once\n\n#include &lt;boost/asio.hpp&gt;\n\n#include &lt;atomic&gt;\n#include &lt;condition_variable&gt;\n#include &lt;memory&gt;\n#include &lt;mutex&gt;\n\n//--------------------------------------------------------------------\nclass ConnectionManager;\n\n//--------------------------------------------------------------------\nclass Connection : public std::enable_shared_from_this&lt;Connection&gt;\n{\npublic:\n\n    typedef std::shared_ptr&lt;Connection&gt; SharedPtr;\n\n    // Ensure all instances are created as shared_ptr in order to fulfill requirements for shared_from_this\n    static Connection::SharedPtr Create(ConnectionManager * connectionManager, boost::asio::ip::tcp::socket &amp; socket);\n\n    //\n    static std::string ErrorCodeToString(const boost::system::error_code &amp; errorCode);\n\n    Connection(const Connection &amp;) = delete;\n    Connection(Connection &amp;&amp;) = delete;\n    Connection &amp; operator = (const Connection &amp;) = delete;\n    Connection &amp; operator = (Connection &amp;&amp;) = delete;\n    ~Connection();\n\n    // We have to defer the start until we are fully constructed because we share_from_this()\n    void Start();\n    void Stop();\n\n    void Send(const std::vector&lt;char&gt; &amp; data);\n\nprivate:\n\n    static size_t                                           m_nextClientId;\n\n    size_t                                                  m_clientId;\n    ConnectionManager *                                     m_owner;\n    boost::asio::ip::tcp::socket                            m_socket;\n    std::atomic&lt;bool&gt;                                       m_stopped;\n    boost::asio::streambuf                                  m_receiveBuffer;\n    mutable std::mutex                                      m_sendMutex;\n    std::vector&lt;char&gt;                                       m_sendBuffers[2];         // Double buffer\n    int                                                     m_activeSendBufferIndex;\n    bool                                                    m_sending;\n\n    std::vector&lt;char&gt;                                       m_allReadData;            // Strictly for test purposes\n\n    Connection(ConnectionManager * connectionManager, boost::asio::ip::tcp::socket socket);\n\n    void DoReceive();\n    void DoSend();\n};\n\n//--------------------------------------------------------------------\n</code></pre>\n\n<p><strong>Connection.cpp</strong></p>\n\n<pre><code>#include \"Connection.h\"\n#include \"ConnectionManager.h\"\n\n#include &lt;boost/bind.hpp&gt;\n\n#include &lt;algorithm&gt;\n#include &lt;cstdlib&gt;\n\n//--------------------------------------------------------------------\nsize_t Connection::m_nextClientId(0);\n\n//--------------------------------------------------------------------\nConnection::SharedPtr Connection::Create(ConnectionManager * connectionManager, boost::asio::ip::tcp::socket &amp; socket)\n{\n    return Connection::SharedPtr(new Connection(connectionManager, std::move(socket)));\n}\n\n//--------------------------------------------------------------------------------------------------\nstd::string Connection::ErrorCodeToString(const boost::system::error_code &amp; errorCode)\n{\n    std::ostringstream debugMsg;\n    debugMsg &lt;&lt; \" Error Category: \" &lt;&lt; errorCode.category().name() &lt;&lt; \". \"\n             &lt;&lt; \" Error Message: \"  &lt;&lt; errorCode.message() &lt;&lt; \". \";\n\n    // IMPORTANT - These comparisons only work if you dynamically link boost libraries\n    //             Because boost chose to implement boost::system::error_category::operator == by comparing addresses\n    //             The addresses are different in one library and the other when statically linking.\n    //\n    // We use make_error_code macro to make the correct category as well as error code value.\n    // Error code value is not unique and can be duplicated in more than one category.\n    if (errorCode == boost::asio::error::make_error_code(boost::asio::error::connection_refused))\n    {\n        debugMsg &lt;&lt; \" (Connection Refused)\";\n    }\n    else if (errorCode == boost::asio::error::make_error_code(boost::asio::error::eof))\n    {\n        debugMsg &lt;&lt; \" (Remote host has disconnected)\";\n    }\n    else\n    {\n        debugMsg &lt;&lt; \" (boost::system::error_code has not been mapped to a meaningful message)\";\n    }\n\n    return debugMsg.str();\n}\n\n//--------------------------------------------------------------------\nConnection::Connection(ConnectionManager * connectionManager, boost::asio::ip::tcp::socket socket)\n    :\n    m_clientId                          (m_nextClientId++)\n  , m_owner                             (connectionManager)\n  , m_socket                            (std::move(socket))\n  , m_stopped                           (false)\n  , m_receiveBuffer                     ()\n  , m_sendMutex                         ()\n  , m_sendBuffers                       ()\n  , m_activeSendBufferIndex             (0)\n  , m_sending                           (false)\n  , m_allReadData                       ()\n{\n    printf(\"Client connection with id %zd has been created.\", m_clientId);\n}\n\n//--------------------------------------------------------------------\nConnection::~Connection()\n{\n    // Boost uses RAII, so we don't have anything to do. Let thier destructors take care of business\n    printf(\"Client connection with id %zd has been destroyed.\", m_clientId);\n}\n\n//--------------------------------------------------------------------\nvoid Connection::Start()\n{\n    DoReceive();\n}\n\n//--------------------------------------------------------------------\nvoid Connection::Stop()\n{\n    // The entire connection class is only kept alive, because it is a shared pointer and always has a ref count\n    // as a consequence of the outstanding async receive call that gets posted every time we receive.\n    // Once we stop posting another receive in the receive handler and once our owner release any references to\n    // us, we will get destroyed.\n    m_stopped = true;\n    m_owner-&gt;OnConnectionClosed(shared_from_this());\n}\n\n//--------------------------------------------------------------------\nvoid Connection::Send(const std::vector&lt;char&gt; &amp; data)\n{\n    std::lock_guard&lt;std::mutex&gt; lock(m_sendMutex);\n\n    // Append to the inactive buffer\n    std::vector&lt;char&gt; &amp; inactiveBuffer = m_sendBuffers[m_activeSendBufferIndex ^ 1];\n    inactiveBuffer.insert(inactiveBuffer.end(), data.begin(), data.end());\n\n    //\n    DoSend();\n}\n\n//--------------------------------------------------------------------\nvoid Connection::DoSend()\n{\n    // Check if there is an async send in progress\n    // An empty active buffer indicates there is no outstanding send\n    if (m_sendBuffers[m_activeSendBufferIndex].empty())\n    {\n        m_activeSendBufferIndex ^= 1;\n\n        std::vector&lt;char&gt; &amp; activeBuffer = m_sendBuffers[m_activeSendBufferIndex];\n        auto self(shared_from_this());\n\n        boost::asio::async_write(m_socket, boost::asio::buffer(activeBuffer),\n            [self](const boost::system::error_code &amp; errorCode, size_t bytesTransferred)\n            {\n                std::lock_guard&lt;std::mutex&gt; lock(self-&gt;m_sendMutex);\n\n                self-&gt;m_sendBuffers[self-&gt;m_activeSendBufferIndex].clear();\n\n                if (errorCode)\n                {\n                    printf(\"An error occured while attemping to send data to client id %zd. %s\", self-&gt;m_clientId, ErrorCodeToString(errorCode).c_str());\n\n                    // An error occurred\n                    // We do not stop or close on sends, but instead let the receive error out and then close\n                    return;\n                }\n\n                // Check if there is more to send that has been queued up on the inactive buffer,\n                // while we were sending what was on the active buffer\n                if (!self-&gt;m_sendBuffers[self-&gt;m_activeSendBufferIndex ^ 1].empty())\n                {\n                    self-&gt;DoSend();\n                }\n            });\n    }\n}\n\n//--------------------------------------------------------------------\nvoid Connection::DoReceive()\n{\n    auto self(shared_from_this());\n\n    boost::asio::async_read_until(m_socket, m_receiveBuffer, '#',\n        [self](const boost::system::error_code &amp; errorCode, size_t bytesRead)\n        {\n            if (errorCode)\n            {\n                // Check if the other side hung up\n                if (errorCode == boost::asio::error::make_error_code(boost::asio::error::eof))\n                {\n                    // This is not really an error. The client is free to hang up whenever they like\n                    printf(\"Client %zd has disconnected.\", self-&gt;m_clientId);\n                }\n                else\n                {\n                    printf(\"An error occured while attemping to receive data from client id %zd. Error Code: %s\", self-&gt;m_clientId, ErrorCodeToString(errorCode).c_str());\n                }\n\n                // Notify our masters that we are ready to be destroyed\n                self-&gt;m_owner-&gt;OnConnectionClosed(self);\n\n                // An error occured\n                return;\n            }\n\n            // Grab the read data\n            std::istream stream(&amp;self-&gt;m_receiveBuffer);\n            std::string data;\n            std::getline(stream, data, '#');\n            data += \"#\";\n\n            printf(\"Received data from client %zd: %s\", self-&gt;m_clientId, data.c_str());\n\n            // Issue the next receive\n            if (!self-&gt;m_stopped)\n            {\n                self-&gt;DoReceive();\n            }\n        });\n}\n\n//--------------------------------------------------------------------\n</code></pre>\n\n<p><strong>ConnectionManager.h</strong></p>\n\n<pre><code>#pragma once\n\n#include \"Connection.h\"\n\n// Boost Includes\n#include &lt;boost/asio.hpp&gt;\n\n// Standard Includes\n#include &lt;thread&gt;\n#include &lt;vector&gt;\n\n//--------------------------------------------------------------------\nclass ConnectionManager\n{\npublic:\n\n    ConnectionManager(unsigned port, size_t numThreads);\n    ConnectionManager(const ConnectionManager &amp;) = delete;\n    ConnectionManager(ConnectionManager &amp;&amp;) = delete;\n    ConnectionManager &amp; operator = (const ConnectionManager &amp;) = delete;\n    ConnectionManager &amp; operator = (ConnectionManager &amp;&amp;) = delete;\n    ~ConnectionManager();\n\n    void Start();\n    void Stop();\n\n    void OnConnectionClosed(Connection::SharedPtr connection);\n\nprotected:\n\n    boost::asio::io_service            m_io_service;\n    boost::asio::ip::tcp::acceptor     m_acceptor;\n    boost::asio::ip::tcp::socket       m_listenSocket;\n    std::vector&lt;std::thread&gt;           m_threads;\n\n    mutable std::mutex                 m_connectionsMutex;\n    std::vector&lt;Connection::SharedPtr&gt; m_connections;\n\n    boost::asio::deadline_timer        m_timer;\n\n    void IoServiceThreadProc();\n\n    void DoAccept();\n    void DoTimer();\n};\n\n//--------------------------------------------------------------------\n</code></pre>\n\n<p><strong>ConnectionManager.cpp</strong></p>\n\n<pre><code>#include \"ConnectionManager.h\"\n\n#include &lt;boost/bind.hpp&gt;\n#include &lt;boost/date_time/posix_time/posix_time.hpp&gt;\n\n#include &lt;system_error&gt;\n#include &lt;cstdio&gt;\n\n//------------------------------------------------------------------------------\nConnectionManager::ConnectionManager(unsigned port, size_t numThreads)\n    :\n    m_io_service  ()\n  , m_acceptor    (m_io_service, boost::asio::ip::tcp::endpoint(boost::asio::ip::tcp::v4(), port))\n  , m_listenSocket(m_io_service)\n  , m_threads     (numThreads)\n  , m_timer       (m_io_service)\n{\n}\n\n//------------------------------------------------------------------------------\nConnectionManager::~ConnectionManager()\n{\n    Stop();\n}\n\n//------------------------------------------------------------------------------\nvoid ConnectionManager::Start()\n{\n    if (m_io_service.stopped())\n    {\n        m_io_service.reset();\n    }\n\n    DoAccept();\n\n    for (auto &amp; thread : m_threads)\n    {\n        if (!thread.joinable())\n        {\n            thread.swap(std::thread(&amp;ConnectionManager::IoServiceThreadProc, this));\n        }\n    }\n\n    DoTimer();\n}\n\n//------------------------------------------------------------------------------\nvoid ConnectionManager::Stop()\n{\n    {\n        std::lock_guard&lt;std::mutex&gt; lock(m_connectionsMutex);\n        m_connections.clear();\n    }\n\n    // TODO - Will the stopping of the io_service be enough to kill all the connections and ultimately have them get destroyed?\n    //        Because remember they have outstanding ref count to thier shared_ptr in the async handlers\n    m_io_service.stop();\n\n    for (auto &amp; thread : m_threads)\n    {\n        if (thread.joinable())\n        {\n            thread.join();\n        }\n    }\n}\n\n//------------------------------------------------------------------------------\nvoid ConnectionManager::IoServiceThreadProc()\n{\n    try\n    {\n        // Log that we are starting the io_service thread\n        {\n            printf(\"io_service socket thread starting.\");\n        }\n\n        // Run the asynchronous callbacks from the socket on this thread\n        // Until the io_service is stopped from another thread\n        m_io_service.run();\n    }\n    catch (std::system_error &amp; e)\n    {\n        printf(\"System error caught in io_service socket thread. Error Code: %d\", e.code().value());\n    }\n    catch (std::exception &amp; e)\n    {\n        printf(\"Standard exception caught in io_service socket thread. Exception: %s\", e.what());\n    }\n    catch (...)\n    {\n        printf(\"Unhandled exception caught in io_service socket thread.\");\n    }\n\n    {\n        printf(\"io_service socket thread exiting.\");\n    }\n}\n\n//------------------------------------------------------------------------------\nvoid ConnectionManager::DoAccept()\n{\n    m_acceptor.async_accept(m_listenSocket,\n        [this](const boost::system::error_code errorCode)\n        {\n            if (errorCode)\n            {\n                printf(\"An error occured while attemping to accept connections. Error Code: %s\", Connection::ErrorCodeToString(errorCode).c_str());\n                return;\n            }\n\n            // Create the connection from the connected socket\n            std::lock_guard&lt;std::mutex&gt; lock(m_connectionsMutex);\n            Connection::SharedPtr connection = Connection::Create(this, m_listenSocket);\n            m_connections.push_back(connection);\n            connection-&gt;Start();\n\n            DoAccept();\n        });\n}\n\n//------------------------------------------------------------------------------\nvoid ConnectionManager::OnConnectionClosed(Connection::SharedPtr connection)\n{\n    std::lock_guard&lt;std::mutex&gt; lock(m_connectionsMutex);\n\n    auto itConnection = std::find(m_connections.begin(), m_connections.end(), connection);\n    if (itConnection != m_connections.end())\n    {\n        m_connections.erase(itConnection);\n    }\n}\n\n//------------------------------------------------------------------------------\nvoid ConnectionManager::DoTimer()\n{\n    if (!m_io_service.stopped())\n    {\n        // Send messages every second\n        m_timer.expires_from_now(boost::posix_time::seconds(30));\n        m_timer.async_wait(\n            [this](const boost::system::error_code &amp; errorCode)\n            {\n                std::lock_guard&lt;std::mutex&gt; lock(m_connectionsMutex);\n                for (auto connection : m_connections)\n                {\n                    connection-&gt;Send(std::vector&lt;char&gt;{'b', 'e', 'e', 'p', '#'});\n                }\n\n                DoTimer();\n            });\n    }\n}\n</code></pre>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include \"ConnectionManager.h\"\n\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main()\n{\n    // Start up the server\n    ConnectionManager connectionManager(5000, 2);\n    connectionManager.Start();\n\n    // Pretend we are doing other things or just waiting for shutdown\n    std::this_thread::sleep_for(std::chrono::minutes(5));\n\n    // Stop the server\n    connectionManager.Stop();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 1177260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b6fa9b52318f4c4b9277ad5a2c09a4?s=128&d=identicon&r=PG", "display_name": "UFO", "link": "https://stackoverflow.com/users/1177260/ufo"}, "is_accepted": false, "score": -1, "last_activity_date": 1561015824, "last_edit_date": 1561015824, "creation_date": 1561015431, "answer_id": 56680981, "question_id": 47913054, "link": "https://stackoverflow.com/questions/47913054/boostasioasync-write-ensure-only-one-outstanding-call/56680981#56680981", "title": "boost::asio::async_write - ensure only one outstanding call", "body": "<p>Could we use 2 strands for this question by posting write(...) as an asynchronous operation to strand1 and handler(...) to strand2? \nYour advices on the code would be highly appreciated.</p>\n\n<pre><code>boost::asio::strand&lt;boost::asio::io_context::executor_type&gt; strand1, strand2;\nstd::vector&lt;char&gt; empty_vector(0);\n\nvoid Connection::Send(const std::vector&lt;char&gt; &amp; data)\n{\n    boost::asio::post(boost::asio::bind_executor(strand1, std::bind(&amp;Connection::write, this, true, data)));\n}\n\nvoid Connection::write(bool has_data, const std::vector&lt;char&gt; &amp; data)\n{\n     // Append to the inactive buffer\n    std::vector&lt;char&gt; &amp; inactiveBuffer = m_sendBuffers[m_activeSendBufferIndex ^ 1];\n\n    if (has_data)\n    {            \n        inactiveBuffer.insert(inactiveBuffer.end(), data.begin(), data.end());\n    }\n\n    //\n    if (!inactiveBuffer.empty() &amp;&amp; m_sendBuffers[m_activeSendBufferIndex].empty())\n    {\n        m_activeSendBufferIndex ^= 1;\n        std::vector&lt;char&gt; &amp; activeBuffer = m_sendBuffers[m_activeSendBufferIndex];\n        boost::asio::async_write(m_socket, boost::asio::buffer(activeBuffer), boost::asio::bind_executor(strand2, std::bind(&amp;Connection::handler, this, boost::asio::placeholders::error, boost::asio::placeholders::bytes_transferred)));\n    }\n} \n\nvoid Connection::handler(const boost::system::error_code &amp; errorCode, size_t bytesTransferred)\n{\n    self-&gt;m_sendBuffers[self-&gt;m_activeSendBufferIndex].clear();\n\n    if (errorCode)\n    {\n        printf(\"An error occured while attemping to send data to client id %zd. %s\", self-&gt;m_clientId, ErrorCodeToString(errorCode).c_str());\n\n        // An error occurred\n        // We do not stop or close on sends, but instead let the receive error out and then close\n        return;\n    }\n\n    boost::asio::post(boost::asio::bind_executor(strand1, std::bind(&amp;Connection::write, this, false, empty_vector)));\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3853, "favorite_count": 2, "accepted_answer_id": 48026383, "answer_count": 4, "score": 7, "last_activity_date": 1561015824, "creation_date": 1513797845, "question_id": 47913054, "link": "https://stackoverflow.com/questions/47913054/boostasioasync-write-ensure-only-one-outstanding-call", "title": "boost::asio::async_write - ensure only one outstanding call", "body": "<p>According to the documentation:</p>\n\n<p>\"The program must ensure that the stream performs no other write operations (such as async_write, the stream's async_write_some function, or any other composed operations that perform writes) until this operation completes.\"</p>\n\n<p>Does this mean, I cannot call boost::asio::async_write a second time until the handler for the first is called? How does one achieve this and still be asynchronous?</p>\n\n<p>If I have a method Send:</p>\n\n<pre><code>//--------------------------------------------------------------------\nvoid Connection::Send(const std::vector&lt;char&gt; &amp; data)\n{\n    auto callback = boost::bind(&amp;Connection::OnSend, this, boost::asio::placeholders::error, boost::asio::placeholders::bytes_transferred);\n    boost::asio::async_write(m_socket, boost::asio::buffer(data), callback);\n}\n</code></pre>\n\n<p>Do I have to change it to something like:</p>\n\n<pre><code>//--------------------------------------------------------------------\nvoid Connection::Send(const std::vector&lt;char&gt; &amp; data)\n{\n    // Issue a send\n    std::lock_guard&lt;std::mutex&gt; lock(m_numPostedSocketIOMutex);\n    ++m_numPostedSocketIO;\n\n    m_numPostedSocketIOConditionVariable.wait(lock, [this]() {return m_numPostedSocketIO == 0; });\n\n    auto callback = boost::bind(&amp;Connection::OnSend, this, boost::asio::placeholders::error, boost::asio::placeholders::bytes_transferred);\n    boost::asio::async_write(m_socket, boost::asio::buffer(data), callback);\n}\n</code></pre>\n\n<p>and if so, then aren't I blocking after the first call again?</p>\n"}, {"tags": ["c++", "visual-studio", "debugging", "stl", "visual-studio-2017"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 4, "creation_date": 1513797314, "post_id": 47912896, "comment_id": 82793503, "body": "Please include the error as text.  And try a clean followed by a full rebuild."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1513797713, "post_id": 47912896, "comment_id": 82793693, "body": "The error doesn&#39;t have anything to do with your code or that you use <code>std::multimap</code>. Read again what the message says."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1513797741, "post_id": 47912896, "comment_id": 82793704, "body": "Well, <code>for (myit = freq_rev.rbegin(), count = 0; count &lt; 10; myit++, count++)</code> is not correctr.  You never make sure <code>myit</code> is valid before you try and dereference it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6317336"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1513797786, "post_id": 47912896, "comment_id": 82793727, "body": "@RichardCritten I did."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6317336"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1513798027, "post_id": 47912896, "comment_id": 82793844, "body": "@user0042 What is it saying? I really did not understand."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1513799099, "post_id": 47912896, "comment_id": 82794339, "body": "@Jacob It says that it can&#39;t find an object file that was created during the build process. Since you have that <code>&#47;DEBUG:FASTLINK</code> project option set, you need that to start the program in the debugger."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1514283070, "post_id": 47912896, "comment_id": 82922799, "body": "Why the .obj file disappeared is hard to guess, it is not very healthy.  Just change the link option to get ahead.  Project &gt; Properties &gt; Linker &gt; Debugging &gt; &quot;Generate Debug Info&quot; = /DEBUG."}], "answers": [{"comments": [{"owner": {"reputation": 453, "user_id": 9223029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ba5d93605086ed6d347ff62771d128?s=128&d=identicon&r=PG&f=1", "display_name": "Lion King", "link": "https://stackoverflow.com/users/9223029/lion-king"}, "edited": false, "score": 2, "creation_date": 1547476669, "post_id": 47975873, "comment_id": 95195404, "body": "Please see the answer from @Chaohsiung-Huang . This is indeed a bug, that needs to be resolved by VS 2017 team."}, {"owner": {"reputation": 1157, "user_id": 6261163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927deeb08bce28096a053a9e33f1a713?s=128&d=identicon&r=PG&f=1", "display_name": "ROX", "link": "https://stackoverflow.com/users/6261163/rox"}, "edited": false, "score": 1, "creation_date": 1550837438, "post_id": 47975873, "comment_id": 96428261, "body": "This answer -from the comments here and below- appeared to be incorrect at the time of writing. It is now (for later versions of Visual Studio) definitely incorrect as the screenshot is now out of date (with the second highlighted setting removed) although the misleading error message still exists."}], "tags": [], "owner": {"reputation": 3390, "user_id": 6593307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97a33fcc6f030a3e168eb5ef1b756a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Weiwei", "link": "https://stackoverflow.com/users/6593307/weiwei"}, "is_accepted": false, "score": 5, "last_activity_date": 1514277004, "creation_date": 1514277004, "answer_id": 47975873, "question_id": 47912896, "link": "https://stackoverflow.com/questions/47912896/debugfastlink-what-is-this-error/47975873#47975873", "title": "DEBUG:FASTLINK - What is this error?", "body": "<p>The /DEBUG:FASTLINK is aimed at improving link times for the incremental developer loop inside Visual Studio and for medium to large size projects provides ~2x gains. More information about /DEBUG:FASTLINK, please refer to this blog:</p>\n\n<p><a href=\"https://blogs.msdn.microsoft.com/vcblog/2016/10/05/faster-c-build-cycle-in-vs-15-with-debugfastlink/\" rel=\"noreferrer\">https://blogs.msdn.microsoft.com/vcblog/2016/10/05/faster-c-build-cycle-in-vs-15-with-debugfastlink/</a></p>\n\n<p>According to the error message, please make sure your project could build successful without any errors. It could make sure all files could be generated successful.</p>\n\n<p>Then please check your project properties to make sure set <strong>Generate Debug Info as Generate Debug Information optimized for faster links (/DEBUG:FASTLINK)</strong> and set <strong>Generate Full Program Database File as Yes</strong>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/briu2.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/briu2.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 4994437, "user_type": "registered", "profile_image": "https://graph.facebook.com/1606143039664621/picture?type=large", "display_name": "Chaohsiung  Huang", "link": "https://stackoverflow.com/users/4994437/chaohsiung-huang"}, "is_accepted": false, "score": 5, "last_activity_date": 1613530809, "last_edit_date": 1613530809, "creation_date": 1546911038, "answer_id": 54084135, "question_id": 47912896, "link": "https://stackoverflow.com/questions/47912896/debugfastlink-what-is-this-error/54084135#54084135", "title": "DEBUG:FASTLINK - What is this error?", "body": "<p>I am using VS2017 and have met this issue recently. Alas I found the error report is wrong.  In my project properties, the value has nothing to do with the reported condition:</p>\n<p>&quot;Linker-&gt;Debugging-&gt;Generate Debug Info&quot; is <br>\n&quot;Generate Debug Information /DEBUG&quot;, not /DEBUG:FASTLINK</p>\n<p>And how to solve this? Make sure the fields follow have <strong>different values</strong> in project properties:</p>\n<p><strong>Linker-&gt;Debugging-&gt;Generate Program Database File</strong> <br>v.s. <br>\n<strong>C/C++&quot;-&gt;Output Files-&gt;Program Database File Name</strong></p>\n<p>In my case they are the same, thus the report misunderstood the situation.\nChange one of them, such as different file extension name or add an underline to a filename, etc.</p>\n<p>Good Luck!</p>\n"}, {"tags": [], "owner": {"reputation": 361, "user_id": 8589588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tWdkd.jpg?s=128&g=1", "display_name": "Nicolas Gong", "link": "https://stackoverflow.com/users/8589588/nicolas-gong"}, "is_accepted": false, "score": 2, "last_activity_date": 1568251428, "last_edit_date": 1568251428, "creation_date": 1568250670, "answer_id": 57898507, "question_id": 47912896, "link": "https://stackoverflow.com/questions/47912896/debugfastlink-what-is-this-error/57898507#57898507", "title": "DEBUG:FASTLINK - What is this error?", "body": "<p>/DEBUG:FASTLINK option is avaliable in visual studio 2017 and later. To avoid the error,you can change the option to /DEBUG:FULL. you can follow these steps:</p>\n\n<p>Open the project's <strong>Property Pages</strong> dialog box, find the <strong>Linker->Debugging->Generate Debug Info</strong>, then select the /DEBUG:FULL option.Hope it can help you!</p>\n\n<p>By the way, you can click <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/debug-generate-debug-info?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev15.query%3FappId%3DDev15IDEF1%26l%3DEN-US%26k%3Dk(VC.Project.VCLinkerTool.GenerateDebugInformation)%26rd%3Dtrue&amp;view=vs-2019\" rel=\"nofollow noreferrer\">here</a> to see the details of the option.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6317336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9252, "favorite_count": 2, "answer_count": 3, "score": 6, "last_activity_date": 1613530809, "creation_date": 1513797158, "last_edit_date": 1513799590, "question_id": 47912896, "link": "https://stackoverflow.com/questions/47912896/debugfastlink-what-is-this-error", "title": "DEBUG:FASTLINK - What is this error?", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;map&gt;\n#include &lt;iterator&gt;\n\nusing namespace std;\n\nint main() {\n    FILE *fPtr = fopen(\"english.txt\", \"r\");\n\n    if (fPtr == NULL) {\n        cout &lt;&lt; \"Could not open the file.\" &lt;&lt; endl;\n        system(\"pause\");\n        return 0;\n    }\n    char word[100];\n    map &lt;string, int&gt; freq;\n    while (!feof(fPtr)) {\n        fscanf(fPtr, \"%s\", word);\n        freq[word]++;\n    }\n    multimap &lt;int, string &gt; freq_rev;\n    map&lt;string, int&gt;::iterator it;\n    for (it = freq.begin(); it != freq.end(); it++)\n        freq_rev.insert(make_pair(it-&gt;second, it-&gt;first));\n\n    multimap &lt;int, string&gt;::reverse_iterator myit;\n    int count;\n    for (myit = freq_rev.rbegin(), count = 0; count &lt; 10; myit++, count++)\n        cout &lt;&lt; (*myit).second &lt;&lt; \" \" &lt;&lt; (*myit).first &lt;&lt; endl;\n    fclose(fPtr);\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>I am using Visual Studio 2017 for Data Structures course. Code above is supposed to look into the english.txt file which contains a lot of words, to detect frequency of these words, and print top 10 frequently used words. </p>\n\n<p>Before getting to errors in the code, VS 17 gives this <a href=\"https://i.stack.imgur.com/FbyBX.png\" rel=\"noreferrer\">error</a>:</p>\n\n<blockquote>\n  <p>Could not find c:/Users/username/documents/visual studio\n  2017/Projects/projectname/projectname/Debug/projectname.obj'.projectname.exe\n  was built with /DEBUG:FASTLINK which requires object files for\n  debugging.</p>\n  \n  <p>Subsequent failures will be logged to the Debug pane of the Output\n  window.</p>\n</blockquote>\n\n<p>I am not an experienced programmer, I googled but could not find something useful. What is this supposed to be, what should I do?</p>\n"}, {"tags": ["c++", "multithreading", "opencv", "multiprocessing", "c++17"], "comments": [{"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1513797656, "post_id": 47912722, "comment_id": 82793668, "body": "Since <code>forEach</code> runs the function (lambda in your case) on multiple threads in parallel (and one call per pixel), what&#39;s to guarantee that the increments of the two iterators are actually in order? (I&#39;d say nothing)"}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 3, "creation_date": 1513798122, "post_id": 47912722, "comment_id": 82793896, "body": "BTW, try to make the code you post with your questions a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, so that we can just copy it and try to compile locally without having to add anything or guess things. Right now, among other things, it&#39;s not evident what the datatype of <code>A</code> is."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1513802042, "post_id": 47912722, "comment_id": 82795690, "body": "I detect a distinct lack of synchronization."}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 1, "creation_date": 1513809807, "post_id": 47912722, "comment_id": 82798851, "body": "It&#39;s almost impossible to optimise multithreading without knowing the bigger picture. If you only show a small part of your application, you end up micro-optimising one aspect when actually there are much bigger gains to be made restructuring parts we cannot see. For example, if you are processing thousands of images, it may be better to assign one image to a thread so the cache stays hot rather than splitting each image across multiple threads and paying big penalties for synchronisation. Just my 2 pence (UK)."}, {"owner": {"reputation": 2028, "user_id": 3636909, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/da875264051dc76606a99aff3b8448a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ja_cpp", "link": "https://stackoverflow.com/users/3636909/ja-cpp"}, "reply_to_user": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513959470, "post_id": 47912722, "comment_id": 82858519, "body": "@MarkSetchell As I&#39;m working in a big project, I can&#39;t share all my code. I only need help where I think I&#39;m not good at or I can&#39;t do it. I&#39;m processing one image at once because it is an real time application. Thanks for pointing that out!"}], "answers": [{"comments": [{"owner": {"reputation": 2028, "user_id": 3636909, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/da875264051dc76606a99aff3b8448a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ja_cpp", "link": "https://stackoverflow.com/users/3636909/ja-cpp"}, "edited": false, "score": 0, "creation_date": 1513959533, "post_id": 47914114, "comment_id": 82858545, "body": "I got that issue with synchronization (y)  Thanks, your sample code helped me to solve my issues"}], "tags": [], "owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "is_accepted": true, "score": 1, "last_activity_date": 1513802770, "creation_date": 1513802770, "answer_id": 47914114, "question_id": 47912722, "link": "https://stackoverflow.com/questions/47912722/from-single-thread-to-multi-threading-image-processing/47914114#47914114", "title": "From single thread to multi threading image processing", "body": "<p>The main problem I see with your implementation using <code>cv::Mat::forEach</code> is that the order in which the shared iterators <code>it_src</code> and <code>it_IllumTrans</code> will be non-deterministic once the lambda is ran on more than one thread in parallel. You will end up with unpredictably jumbled mess.</p>\n\n<hr>\n\n<p>One way to deal with is would be to use the position parameter of the function called by <a href=\"https://docs.opencv.org/trunk/d3/d63/classcv_1_1Mat.html#a952ef1a85d70a510240cb645a90efc0d\" rel=\"nofollow noreferrer\"><code>cv::Mat::forEach</code></a>, and use this to get pointers (iterators would be an overkill here) to the correct locations in the two input <code>Mat</code>s.</p>\n\n<pre><code>cv::Mat3f variant_1(cv::Mat3b const&amp; source\n    , cv::Mat3f const&amp; illum_trans\n    , cv::Vec3f const&amp; offset)\n{\n    CV_Assert(!source.empty());\n    CV_Assert(!illum_trans.empty());\n    CV_Assert(source.size() == illum_trans.size());\n\n    cv::Mat3f result(source.size());\n\n    result.forEach([&amp;source, &amp;illum_trans, &amp;offset](cv::Vec3f &amp;pixel, const int p[]) {\n        cv::Vec3b const* it_src(source.ptr&lt;cv::Vec3b&gt;(p[0], p[1]));\n        cv::Vec3f const* it_trans(illum_trans.ptr&lt;cv::Vec3f&gt;(p[0], p[1]));\n\n        for (int32_t ch(0); ch &lt; 3; ++ch) {\n            pixel[ch] = offset[ch]\n                + (((*it_src)[ch] - offset[ch])\n                    / std::max((*it_trans)[ch], 0.1f));\n        }\n    });\n\n    return result;\n}\n</code></pre>\n\n<hr>\n\n<p>The second approach would be to use <a href=\"https://docs.opencv.org/trunk/d7/dff/tutorial_how_to_use_OpenCV_parallel_for_.html\" rel=\"nofollow noreferrer\"><code>parallel_for_</code></a>, and partition the image among the threads by rows. This means that we would only have to get the pointers once per row (we need to consider that the input images may not be continuous), and just increment them the rest of the time.</p>\n\n<pre><code>class ParallelVariant2\n    : public cv::ParallelLoopBody\n{\npublic:\n    ParallelVariant2(cv::Mat3b const&amp; source\n        , cv::Mat3f&amp; destination\n        , cv::Mat3f const&amp; illum_trans\n        , cv::Vec3f const&amp; offset)\n        : source_(source)\n        , destination_(destination)\n        , illum_trans_(illum_trans)\n        , offset_(offset)\n    {\n        CV_Assert(!source.empty());\n        CV_Assert(!illum_trans.empty());\n        CV_Assert(source.size() == illum_trans.size());\n\n        destination_.create(source.size());\n    }\n\n    virtual void operator()(const cv::Range&amp; range) const\n    {\n        for (int32_t row(range.start); row &lt; range.end; ++row) {\n            cv::Vec3b const* it_src(source_.ptr&lt;cv::Vec3b&gt;(row));\n            cv::Vec3f* it_dst(destination_.ptr&lt;cv::Vec3f&gt;(row));\n            cv::Vec3f const* it_trans(illum_trans_.ptr&lt;cv::Vec3f&gt;(row));\n\n            for (int32_t col(0); col &lt; source_.cols; ++col) {\n                for (int32_t ch(0); ch &lt; 3; ++ch) {\n                    (*it_dst)[ch] = offset_[ch]\n                        + (((*it_src)[ch] - offset_[ch])\n                            / std::max((*it_trans)[ch], 0.1f));\n                }\n                ++it_src; ++it_dst; ++it_trans;\n            }\n        }\n    }\n\nprivate:\n    cv::Mat3b const&amp; source_;\n    cv::Mat3f&amp; destination_;\n    cv::Mat3f const&amp; illum_trans_;\n    cv::Vec3f const&amp; offset_;\n};\n\ncv::Mat3f variant_2(cv::Mat3b const&amp; source\n    , cv::Mat3f const&amp; illum_trans\n    , cv::Vec3f const&amp; offset)\n{\n    cv::Mat3f result;\n    ParallelVariant2 impl(source, result, illum_trans, offset);\n    cv::parallel_for_(cv::Range(0, source.rows), impl);\n    return result;\n}\n</code></pre>\n\n<hr>\n\n<p>A short test program.</p>\n\n<pre><code>#include &lt;opencv2/opencv.hpp&gt;\n#include &lt;cstdint&gt;\n\n// paste implementations here\n\nint main()\n{\n    cv::Mat3b source(1024, 1024);\n    cv::randu(source, 0, 256);\n\n    cv::Mat3f illum_trans(1024, 1024);\n    cv::randu(illum_trans, 0, 1.0);\n\n    cv::Vec3f offset(0.1f, 0.2f, 0.3f);\n\n    cv::Mat3f result_1 = variant_1(source, illum_trans, offset);\n    cv::Mat3f result_2 = variant_2(source, illum_trans, offset);\n\n    std::cout &lt;&lt; std::equal(result_1.begin(), result_1.end(), result_2.begin()) &lt;&lt; \"\\n\";\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 2028, "user_id": 3636909, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/da875264051dc76606a99aff3b8448a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ja_cpp", "link": "https://stackoverflow.com/users/3636909/ja-cpp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 1, "accepted_answer_id": 47914114, "answer_count": 1, "score": 1, "last_activity_date": 1513802770, "creation_date": 1513796385, "question_id": 47912722, "link": "https://stackoverflow.com/questions/47912722/from-single-thread-to-multi-threading-image-processing", "title": "From single thread to multi threading image processing", "body": "<p>I'm transforming my code from a single thread to multi threading process, then I get to that part of the code where I'm struggling: </p>\n\n<p>where <code>src</code>, <code>imJ</code> and <code>IllumTrans</code> are just images of size <code>1288*728</code> and <code>A</code> is constant value</p>\n\n<pre><code>for(auto j=0;j&lt;rows;j++)\n  for(auto i=0;i&lt;cols;i++)\n     imJ.at&lt;float&gt;(j,i)= A+((src.at&lt;uchar&gt;(j,i)-A)/std::max(IllumTrans.at&lt;float&gt;(j,i), 0.1f));\n</code></pre>\n\n<p>I'm processing RGB images and what I was doing is running the same code (the above double for loop) for each channel which I thought could be nice if I run it in multi threading process.</p>\n\n<p>I started the multi threading version like so </p>\n\n<pre><code>cv::Mat imJ=cv::Mat::zeros(rows, cols, CV_32FC3);\ncv::MatConstIterator&lt;cv::Vec3b&gt; it_src = src.begin();\ncv::MatConstIterator&lt;cv::Vec3f&gt; it_IllumTrans = IllumTrans.begin();\nimJ.forEach&lt;cv::Vec3f&gt;\n(\n  [A, &amp;IllumTrans, rows, cols](cv::Vec3f &amp;pixel, const int* po) -&gt; void\n  {\n    pixel[0]= A+(((*it_src)[0]-A[0])/std::max((*it_IllumTrans)[0], 0.1f));\n    pixel[1]= A+(((*it_src)[0]-A[1])/std::max((*it_IllumTrans)[1], 0.1f));\n    pixel[2]= A+(((*it_src)[0]-A[2])/std::max((*it_IllumTrans)[2], 0.1f));\n    it_src++;\n    it_IllumTrans++;\n  }\n);\n</code></pre>\n\n<p>But I didn't succeed it, it said <code>'MatIterator\u2019 is not a member of \u2018cv\u2019</code>. </p>\n\n<p>What do you think about my new version, is it the right way to do it?</p>\n\n<p><strong>Compilation information:</strong></p>\n\n<pre><code>g++ -std=c++1z -Wall -Weffc++ -Ofast -march=native test4.cpp -o test4 -fopenmp `pkg-config --cflags --libs opencv`\n</code></pre>\n"}, {"tags": ["c++", "c++11", "address-operator"], "comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 2, "creation_date": 1513796525, "post_id": 47912719, "comment_id": 82793118, "body": "Accessing <code>lil_endian</code> through <code>arr</code> is undefined behavior. Also, what&#39;re you trying to do? <code>*&amp;x</code> for &quot;normal types&quot; is a noop"}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1513796778, "post_id": 47912719, "comment_id": 82793252, "body": "@Barry I don&#39;t know how to explain this but try to replace <code>*&amp;x</code> with <code>x</code> on that godbolt link above."}, {"owner": {"reputation": 1073, "user_id": 3763139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gkUYr.jpg?s=128&g=1", "display_name": "Sopel", "link": "https://stackoverflow.com/users/3763139/sopel"}, "edited": false, "score": 0, "creation_date": 1513796876, "post_id": 47912719, "comment_id": 82793298, "body": "&amp; and addressof are are not equal in general"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1513797342, "post_id": 47912719, "comment_id": 82793519, "body": "You find <code>std::addressof</code> <i>more</i> readable?"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 1, "creation_date": 1513797976, "post_id": 47912719, "comment_id": 82793817, "body": "@sandthorn Your godbolt link produces the exact same assembly using <code>lil_endian</code>, <code>*&amp;lil_endian</code>, or <code>*std::addressof(lil_endian)</code>."}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "reply_to_user": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1513798298, "post_id": 47912719, "comment_id": 82793993, "body": "@miles-budnek Thanks. Now I can compile those."}], "answers": [{"comments": [{"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 1, "creation_date": 1513796959, "post_id": 47912764, "comment_id": 82793336, "body": "Not totaly equivalent though with pathologic classes."}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 0, "creation_date": 1513797106, "post_id": 47912764, "comment_id": 82793406, "body": "I can not just replace <code>*std::addressof(lil_endian)</code> with <code>lil_endian</code> on the example code above. You can try for yourself on the godbolt link."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 5, "creation_date": 1513797148, "post_id": 47912764, "comment_id": 82793426, "body": "@sandthorn: that&#39;s a good thing, because what you have is <b>undefined behavior</b>."}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 0, "creation_date": 1513797382, "post_id": 47912764, "comment_id": 82793544, "body": "@vittorio-romeo You mean I can not write <code>reinterpret_cast&lt;const std::array&lt;char,8&gt; &amp;&gt;</code> without depending on undefined behavior?"}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 0, "creation_date": 1513797797, "post_id": 47912764, "comment_id": 82793737, "body": "@sandthorn: yes - <code>reinterpret_cast</code> cannot be valid of a well-formed <i>constant expression</i>."}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 0, "creation_date": 1513797987, "post_id": 47912764, "comment_id": 82793825, "body": "@vittorio-romeo Well, remove constexpr and change into <code>const auto&amp; arr = reinterpret_cast&lt;const std::array&lt;char,8&gt; &amp;&gt;(lil_endian);</code> doesn&#39;t compile either. [godbolt.org/g/ZgVKQu] (<a href=\"https://gcc.godbolt.org/g/ZgVKQu\" rel=\"nofollow noreferrer\">gcc.godbolt.org/g/ZgVKQu</a>)"}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 0, "creation_date": 1513798068, "post_id": 47912764, "comment_id": 82793864, "body": "@sandthorn: it does, you just misspelled <code>lil_endian</code>. You still have undefined behavior as you&#39;re breaking the strict aliasing rule."}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 0, "creation_date": 1513798216, "post_id": 47912764, "comment_id": 82793943, "body": "@vittorio-romeo Ah, okey. my bad. thanks. But where I can read more on &quot;strick aliasing rule&quot; ?"}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 0, "creation_date": 1513798733, "post_id": 47912764, "comment_id": 82794169, "body": "@vittorio-romeo One more thing, How do I force the compiler to report this as &#39;undefined behavior&#39; when compiling?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 1, "creation_date": 1513798897, "post_id": 47912764, "comment_id": 82794244, "body": "@sandthorn It is undefined behaviour with no diagnostic required, because detecting what is defined and not at runtime is (in the general case) Halt-hard."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 1, "creation_date": 1513798901, "post_id": 47912764, "comment_id": 82794245, "body": "@sandthorn: unfortunately, you cannot reliably do so."}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1513799339, "post_id": 47912764, "comment_id": 82794441, "body": "@Yakk Do you mean <code>const auto&amp; arr = reinterpret_cast&lt;const std::array&lt;char,8&gt; &amp;&gt;(lil_endian);</code> is considered as defined on compile time but undefined in runtime?"}], "tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 19, "last_activity_date": 1513796637, "last_edit_date": 1513796637, "creation_date": 1513796572, "answer_id": 47912764, "question_id": 47912719, "link": "https://stackoverflow.com/questions/47912719/if-stdaddressof-is-a-readable-version-of-what-is-a-readable-version-of/47912764#47912764", "title": "If std::addressof is a readable version of &amp;. What is a readable version of *&amp;?", "body": "<blockquote>\n  <p><code>* std::addressof(x)</code></p>\n  \n  <p>However, is there more readable version of this expression?</p>\n</blockquote>\n\n<p><code>x</code></p>\n"}, {"comments": [{"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1513799993, "post_id": 47912832, "comment_id": 82794720, "body": "@remy-lebeau This means that <code>std::addressof</code> is now preferred to <code>&amp;</code> when address is needed?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 1, "creation_date": 1513800405, "post_id": 47912832, "comment_id": 82794906, "body": "@sandthorn: Only when the object&#39;s type has an overridden <code>operator&amp;</code> that doesn&#39;t return the object&#39;s true address.  This is not uncommon in non-STL smart pointer classes, for instance."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1513847412, "post_id": 47912832, "comment_id": 82810442, "body": "@sandthron Many libraries use <code>addressof</code> indeed, even the STL (see also std::pointer_traits::pointer_to). I don&#39;t. I prefer to reject any library where <code>operator &amp;</code> is overloaded. If such a mistake (overloading this operator) has been done, you can expect a lot more mistake. To take decision, you need clear indicator: <code>operator &amp;</code> overloaded =&gt; library rejected."}], "tags": [], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "is_accepted": false, "score": 11, "last_activity_date": 1513799834, "last_edit_date": 1513799834, "creation_date": 1513796863, "answer_id": 47912832, "question_id": 47912719, "link": "https://stackoverflow.com/questions/47912719/if-stdaddressof-is-a-readable-version-of-what-is-a-readable-version-of/47912832#47912832", "title": "If std::addressof is a readable version of &amp;. What is a readable version of *&amp;?", "body": "<p>Vittorio Romeo give you the answer to the second question.</p>\n\n<p>The first supposition is wrong: \"Is <code>addressof</code> the readable version of <code>&amp;</code>\". <code>addressof</code> is used to get the address of an object even if its class type has an overloaded <code>operator &amp;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 0, "creation_date": 1513801415, "post_id": 47913610, "comment_id": 82795365, "body": "(1) constexpr : now I know that reinterpret is not allowed (2)  I&#39;m trying to make <code>arr</code> have the size of <code>lil_endian</code> that&#39;s all. However I wonder if <code>reinterpret_cast&lt;const char*&gt;</code> is &quot;legal&quot;. How about <code>auto&amp; arr = reinterpret_cast&lt;char (&amp;) [8]&gt;(lil_endian);</code> ? Are we also accessing char right?"}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 0, "creation_date": 1513802657, "post_id": 47913610, "comment_id": 82796003, "body": "Original question are now well answered by many. Perhaps I should make this &quot;strict alias&quot; topic as another question. Anyway, thanks you @rustyx for the function template."}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 1, "last_activity_date": 1513802149, "last_edit_date": 1513802149, "creation_date": 1513800298, "answer_id": 47913610, "question_id": 47912719, "link": "https://stackoverflow.com/questions/47912719/if-stdaddressof-is-a-readable-version-of-what-is-a-readable-version-of/47913610#47913610", "title": "If std::addressof is a readable version of &amp;. What is a readable version of *&amp;?", "body": "<p>It's unclear what you're trying to do and why you use <code>constexpr</code>.</p>\n\n<p>But there are a couple of issues with your code:</p>\n\n<ul>\n<li><p><code>reinterpret_cast</code> is <a href=\"http://eel.is/c++draft/expr.const#2.15\" rel=\"nofollow noreferrer\">not allowed</a> in a constant expression.</p></li>\n<li><p>aliasing <code>uint64_t</code> with a <code>std::array</code> is <a href=\"http://eel.is/c++draft/expr.prop#basic.lval-11\" rel=\"nofollow noreferrer\">not allowed</a>.</p></li>\n</ul>\n\n<p>You <em>can</em>, however, work around both of these by aliasing using a <code>const char*</code> in a non-<code>constexpr</code> context. So the following is legal:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nconstexpr uint64_t lil_endian = 0x65'6e'64'69'61'6e; \n\nint main()\n{\n    auto arr = reinterpret_cast&lt;const char*&gt;(&amp;lil_endian);\n    for (size_t i = 0; i &lt; sizeof(lil_endian); ++i) {\n        std::cout &lt;&lt; arr[i] &lt;&lt; \" : \" &lt;&lt; std::hex &lt;&lt; (unsigned int) arr[i] &lt;&lt; '\\n';\n    }\n\n}\n</code></pre>\n\n<p>Incidentally also the need for <code>*&amp;</code> disappears.</p>\n\n<p><a href=\"https://godbolt.org/g/aEmAsu\" rel=\"nofollow noreferrer\">DEMO</a></p>\n\n<p><strong>== EDIT ==</strong></p>\n\n<p>If you just need to get a hold of the <em>size</em> of the variable in a generic way, just use <code>sizeof</code> in a function template. For example:</p>\n\n<pre><code>#include &lt;cstdio&gt;\n#include &lt;cstdint&gt;\n\nconstexpr uint64_t lil_endian = 0x65'6e'64'69'61'6e; \nconstexpr uint32_t lil_endian32 = 0x65'6e'64'69;\n\ntemplate&lt;typename T&gt;\nvoid printIt(const T&amp; it)\n{\n    auto arr = reinterpret_cast&lt;const char*&gt;(&amp;it);\n    for (size_t i = 0; i &lt; sizeof(it); ++i) {\n        putchar(arr[i]);\n    }\n}\n\nint main()\n{\n    printIt(lil_endian);\n    printIt(lil_endian32);\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/g/uf7WWX\" rel=\"nofollow noreferrer\">DEMO</a></p>\n"}], "owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1513802149, "creation_date": 1513796377, "last_edit_date": 1513798428, "question_id": 47912719, "link": "https://stackoverflow.com/questions/47912719/if-stdaddressof-is-a-readable-version-of-what-is-a-readable-version-of", "title": "If std::addressof is a readable version of &amp;. What is a readable version of *&amp;?", "body": "<p><code>*&amp;x</code></p>\n\n<p>Using c++11, we can write as</p>\n\n<p><code>* std::addressof(x)</code></p>\n\n<p>However, is there more readable version of this expression?</p>\n\n<pre><code>constexpr uint64_t lil_endian = 0x65'6e'64'69'61'6e; \n    // a.k.a. Clockwise-Rotated Endian which allocates like\n    // char[8] = { n,a,i,d,n,e,\\0,\\0 }\n\nconstexpr auto&amp; arr = \n    reinterpret_cast&lt;const std::array&lt;char,8&gt; &amp;&gt;\n        (*std::addressof(lil_endian) );\n\nint main()\n{\n    const auto str = std::string(arr.crbegin()+2, arr.crend() );\n\n    std::cout &lt;&lt; str &lt;&lt; '\\n'\n              &lt;&lt; str.size() &lt;&lt; '\\n' &lt;&lt; '\\n';\n    for (const auto ch : str) {\n        std::cout &lt;&lt; ch &lt;&lt; \" : \" &lt;&lt; std::hex &lt;&lt; (unsigned int) ch &lt;&lt; '\\n';\n    }\n\n}\n\n\nendian\n6\n\ne : 65\nn : 6e\nd : 64\ni : 69\na : 61\nn : 6e\n</code></pre>\n\n<p><a href=\"https://gcc.godbolt.org/g/9StHsE\" rel=\"nofollow noreferrer\">godbolt.org/g/9StHsE</a></p>\n\n<p><a href=\"https://wandbox.org/permlink/ZzQ38IlDficO5UOi\" rel=\"nofollow noreferrer\">wandbox.org/permlink/ZzQ38IlDficO5UOi</a></p>\n"}, {"tags": ["c++", "opencv", "grouping"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1513796342, "post_id": 47912660, "comment_id": 82793017, "body": "Sure there is.  Did you try anything?  Sharing your attempt would be helpful."}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1513797304, "post_id": 47912660, "comment_id": 82793498, "body": "Do you want to minimize the number of groups or what is your goal?"}, {"owner": {"reputation": 17643, "user_id": 5087436, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyXHE.jpg?s=128&g=1", "display_name": "alkasm", "link": "https://stackoverflow.com/users/5087436/alkasm"}, "edited": false, "score": 1, "creation_date": 1513799091, "post_id": 47912660, "comment_id": 82794333, "body": "This general problem can be solved with connected components (from graph theory). You have pairs (edges) of points (vertices), where you only have an edge between Pi and Pj if they don&#39;t share the same label and are within the radius. The connected components of this graph are your groups. However there is ambiguity. Say P1 and P3 have the same label, and P2 is within the radius of both and has a different label. Since P1 and P3 can&#39;t be in the same group, then you can only have P1 and P2 in a group or P2 and P3 in a group. Which one should you choose? Or do you want both groups in this case?"}, {"owner": {"reputation": 31, "user_id": 4536887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d201c38813cb6657ce3b632d291a6c96?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/4536887/alex"}, "edited": false, "score": 0, "creation_date": 1513799182, "post_id": 47912660, "comment_id": 82794372, "body": "I have uploaded some images to clarify, hope now it is easier to understand."}, {"owner": {"reputation": 17643, "user_id": 5087436, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyXHE.jpg?s=128&g=1", "display_name": "alkasm", "link": "https://stackoverflow.com/users/5087436/alkasm"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 1, "creation_date": 1513799527, "post_id": 47912660, "comment_id": 82794529, "body": "You did mostly answer the question, but heed @NicoSchertler&#39;s question: you said &quot;you don&#39;t care which group&quot; you get in the case of this collision. But you can make an explicit rule here which might be better, for e.g. would you rather use the group that has more points in it? Or that gives you more groups at the end? Or that minimizes the number of groups? If it really doesn&#39;t matter then just do connected components as I mentioned above, and in this case you only create an edge if the next point is within the radius  and the label isn&#39;t present in the component."}, {"owner": {"reputation": 31, "user_id": 4536887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d201c38813cb6657ce3b632d291a6c96?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/4536887/alex"}, "edited": false, "score": 0, "creation_date": 1513844629, "post_id": 47912660, "comment_id": 82809028, "body": "Probably I will say that second solution will be more appropriate, so the number of points in a group will be something to maximize.The number of groups will be undetermined always, and I want to minimize it but taking into account both distance and label conditions. I think I will try connected components from graph theory and see what I get"}], "owner": {"reputation": 31, "user_id": 4536887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d201c38813cb6657ce3b632d291a6c96?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/4536887/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513841003, "creation_date": 1513796146, "last_edit_date": 1513841003, "question_id": 47912660, "link": "https://stackoverflow.com/questions/47912660/group-2d-points-in-a-neighbor-with-label-constraining", "title": "Group 2D points in a neighbor with label constraining", "body": "<p>I have a set of points in a 2D space. Each of these points is of a structure type that has the following fields:</p>\n\n<ul>\n<li>2D Coordinate <code>(x,y)</code></li>\n<li>Label (The label interval can go from 1 up to 4.)</li>\n</ul>\n\n<p>I want to group all the points that lay in the 2D space within a predefined radius <code>R</code> in pixels from a point. So if point P1 is near to point P2 they are grouped. If P2 is, in turn, near to P3... P1, P2, and P3 will be considered in the same group although P1 and P3 are not at the desired distance.</p>\n\n<p>However, and here comes the problem for me, two points that have the same label can't be in the same group.</p>\n\n<p>It is important to notice that it can occur that two points with the same label are not within the radius, however, there is another one in the middle of them that is at the correct distance for both of them.</p>\n\n<p>Is there any C++ method to this correctly and fast?</p>\n\n<p>EDIT: I upload some pictures to make understanding easier.</p>\n\n<p>The starting point for the algorithm will be something like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/oZzSH.png\" alt=\"First step\"></p>\n\n<p>Each color represents a different Label, points in green all have Label = 1, points in red Label = 2 ... So now, the following step will be group these points based on distance</p>\n\n<p><img src=\"https://i.stack.imgur.com/HixWQ.png\" alt=\"Distance grouping\"></p>\n\n<p>However, in the bottom group, there are two green points. This is the condition that must be fulfilled, not two points from the same label in the same group. This will lead to two different solutions which are the ones that I want. (I don't really care which one)</p>\n\n<p><img src=\"https://i.stack.imgur.com/5Dcfa.png\" alt=\"Solution 1\"> (Green point ungrouped its a group on its own)</p>\n\n<p><img src=\"https://i.stack.imgur.com/GQ7lj.png\" alt=\"Solution 2\"> (Red and green point are another group)</p>\n"}, {"tags": ["c++", "stl", "insert", "unordered-map", "unordered-set"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513795949, "post_id": 47912483, "comment_id": 82792833, "body": "Do we need all of this code to <a href=\"http://coliru.stacked-crooked.com/a/060011ef7027452b\" rel=\"nofollow noreferrer\">duplicate the issue</a>?"}, {"owner": {"reputation": 789, "user_id": 3000181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f06442d8e0c91c8d67d5bd950675ce?s=128&d=identicon&r=PG", "display_name": "Akshay Kalose", "link": "https://stackoverflow.com/users/3000181/akshay-kalose"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513796096, "post_id": 47912483, "comment_id": 82792897, "body": "@PaulMcKenzie I&#39;ll update the question, but that is essentially the problem."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1513796346, "post_id": 47912483, "comment_id": 82793022, "body": "<code>std::unordered_set::insert()</code> is a C++17 feature. For earlier versions, I think <code>std::unordered_set::emplace()</code> is the right function. Although my version of g++, g++ 5.4.0, still does not seem to support it."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1513796427, "post_id": 47912483, "comment_id": 82793067, "body": "@RSahu from <a href=\"http://en.cppreference.com/w/cpp/container/unordered_set/insert\" rel=\"nofollow noreferrer\">cppreference</a> it looks like only inserting nodes is from C++17. The <code>insert</code> he&#39;s trying to call should be there since C++11"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 0, "creation_date": 1513796597, "post_id": 47912483, "comment_id": 82793162, "body": "@scohe001, makes sense now. Sounds like the OP&#39;s problem is lack of support from the compiler."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1513796637, "post_id": 47912483, "comment_id": 82793179, "body": "@RSahu I&#39;m not sure...when I try on <a href=\"https://ideone.com/962vql\" rel=\"nofollow noreferrer\">ideone</a> it looks like it&#39;s choosing the wrong candidate..."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 0, "creation_date": 1513796822, "post_id": 47912483, "comment_id": 82793269, "body": "@scohe001, Your link to ideone points to use of g++ 6.3. That version supports more of the C++11 features than g++ 5.4. Note to OP: Please post your compiler version info."}, {"owner": {"reputation": 789, "user_id": 3000181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f06442d8e0c91c8d67d5bd950675ce?s=128&d=identicon&r=PG", "display_name": "Akshay Kalose", "link": "https://stackoverflow.com/users/3000181/akshay-kalose"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1513796916, "post_id": 47912483, "comment_id": 82793319, "body": "@RSahu Updated the post"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1513797932, "post_id": 47912483, "comment_id": 82793793, "body": "<code>std::unordered_set</code> requires a hash on the key item.  <a href=\"http://en.cppreference.com/w/cpp/container/unordered_set\" rel=\"nofollow noreferrer\">The default set of hash functions</a> probably will not fit for <code>unordered_map</code>.  So @AkshayKalose, you may have to provide a hash function."}, {"owner": {"reputation": 789, "user_id": 3000181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f06442d8e0c91c8d67d5bd950675ce?s=128&d=identicon&r=PG", "display_name": "Akshay Kalose", "link": "https://stackoverflow.com/users/3000181/akshay-kalose"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513798416, "post_id": 47912483, "comment_id": 82794035, "body": "@PaulMcKenzie Thanks! To avoid this problem, I changed my implementation to use <code>set&lt;vector&lt;int&gt;&gt;</code> with each vector being initialized with 256 values. This avoids hashing and also having to implement a &lt; function for the inside type."}], "owner": {"reputation": 789, "user_id": 3000181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f06442d8e0c91c8d67d5bd950675ce?s=128&d=identicon&r=PG", "display_name": "Akshay Kalose", "link": "https://stackoverflow.com/users/3000181/akshay-kalose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 712, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513796935, "creation_date": 1513795438, "last_edit_date": 1513796935, "question_id": 47912483, "link": "https://stackoverflow.com/questions/47912483/insert-an-unordered-map-into-an-unordered-set-in-c", "title": "Insert an Unordered Map Into an Unordered Set in C++", "body": "<p>Idea: I want a data structure to hold multiple key/pair values of character and character counts in a word. This way, with 5 character counts in a \"character counts set\" and given any word, I can quickly tell whether an anagram exists in the set by calculating the character count of the given word.</p>\n\n<p>Problem: I am getting an error while trying to insert an <code>unordered_map&lt;char, int&gt;</code> into a <code>unordered_set&lt;unordered_map&lt;char, int&gt;&gt;</code>.</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;unordered_map&gt;\n#include &lt;unordered_set&gt;\n\nint main()\n{\n  std::unordered_set&lt;std::unordered_map&lt;char, int&gt;&gt; used_char_counts;\n  std::unordered_map&lt;char, int&gt; char_counts;\n  used_char_counts.insert(char_counts);\n}\n</code></pre>\n\n<p>Error:\n<code>error: no matching function for call to 'std::unordered_set&lt;std::unordered_map&lt;char, int&gt; &gt;::insert(std::unordered_map&lt;char, int&gt;*)'</code></p>\n\n<p>Compiler Version:</p>\n\n<pre><code>Using built-in specs.\nCOLLECT_GCC=g++\nCOLLECT_LTO_WRAPPER=c:/mingw/bin/../libexec/gcc/mingw32/6.3.0/lto-wrapper.exe\nTarget: mingw32\nConfigured with: ../src/gcc-6.3.0/configure --build=x86_64-pc-linux-gnu --host=mingw32 --with-gmp=/mingw --with-mpfr=/mingw --with-mpc=/mingw --with-isl=/mingw --prefix=/mingw --disable-win32-registry --target=mingw32 --with-arch=i586 --enable-languages=c,c++,objc,obj-c++,fortran,ada --with-pkgversion='MinGW.org GCC-6.3.0-1' --enable-static --enable-shared --enable-threads --with-dwarf2 --disable-sjlj-exceptions --enable-version-specific-runtime-libs --with-libiconv-prefix=/mingw --with-libintl-prefix=/mingw --enable-libstdcxx-debug --with-tune=generic --enable-libgomp --disable-libvtv --enable-nls\nThread model: win32\ngcc version 6.3.0 (MinGW.org GCC-6.3.0-1)\n</code></pre>\n"}, {"tags": ["c++", "char", "character", "ascii", "single-quotes"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1513795483, "post_id": 47912444, "comment_id": 82792624, "body": "Multi-char literals are <i>implementation defined</i>. What probably happens is that <code>&#39;(xx)</code> is stored as an <code>int</code> (which is usually four bytes and therefore fits four one-byte characters) and the compiler simply truncates the upper bits and just assigns the low byte to the variable."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 1, "creation_date": 1513795608, "post_id": 47912444, "comment_id": 82792684, "body": "Nice dupe find."}], "owner": {"reputation": 951, "user_id": 4539906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0je96.jpg?s=128&g=1", "display_name": "Asad Shakeel", "link": "https://stackoverflow.com/users/4539906/asad-shakeel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1513795532, "answer_count": 0, "score": 0, "last_activity_date": 1513795215, "creation_date": 1513795215, "question_id": 47912444, "link": "https://stackoverflow.com/questions/47912444/values-assigned-to-char-in-c", "closed_reason": "Duplicate", "title": "Values assigned to char in c++", "body": "<p><code>char b = 'ABC DEF';</code> I know this is wrong but</p>\n\n<p><code>char a = '(xx)';</code> where xx is a two digit number, why is this not wrong?</p>\n\n<p>where <code>cout &lt;&lt; a;</code> prints <code>)</code> whatever the number is.</p>\n"}, {"tags": ["c++", "templates"], "answers": [{"tags": [], "owner": {"reputation": 628, "user_id": 6199585, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-IdPVJXFKZrI/AAAAAAAAAAI/AAAAAAAAApE/iIo85sk1fRM/photo.jpg?sz=128", "display_name": "Boris", "link": "https://stackoverflow.com/users/6199585/boris"}, "is_accepted": false, "score": 0, "last_activity_date": 1513797141, "creation_date": 1513797141, "answer_id": 47912893, "question_id": 47912377, "link": "https://stackoverflow.com/questions/47912377/c-wrapper-template-how-to-pass-it-as-a-template-parameter/47912893#47912893", "title": "C++ wrapper template: how to pass it as a template parameter?", "body": "<p>Just found the answer (it was indeed simple):<br>\nI needed to introduce two single-parameter templates</p>\n\n<pre><code>template&lt;typename T&gt; using StringDumbHandleWrapper  = StringHandleWrapper&lt;T, DumbPtrVec&gt;;\ntemplate&lt;typename T&gt; using StringSmartHandleWrapper = StringHandleWrapper&lt;T, SmartPtrVec&gt;;\n</code></pre>\n\n<p>and use the new names in <code>Storage</code> instantiation, e.g.</p>\n\n<pre><code>Storage&lt;int, StringDumbHandleWrapper&gt; s;\n</code></pre>\n\n<p>So much for the long question... :) </p>\n"}, {"comments": [{"owner": {"reputation": 628, "user_id": 6199585, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-IdPVJXFKZrI/AAAAAAAAAAI/AAAAAAAAApE/iIo85sk1fRM/photo.jpg?sz=128", "display_name": "Boris", "link": "https://stackoverflow.com/users/6199585/boris"}, "edited": false, "score": 0, "creation_date": 1513808660, "post_id": 47912956, "comment_id": 82798498, "body": "Thank you for your suggestion! Good to know."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1513797357, "creation_date": 1513797357, "answer_id": 47912956, "question_id": 47912377, "link": "https://stackoverflow.com/questions/47912377/c-wrapper-template-how-to-pass-it-as-a-template-parameter/47912956#47912956", "title": "C++ wrapper template: how to pass it as a template parameter?", "body": "<p>Create another level of template for partial argument application:</p>\n\n<pre><code>template &lt;template &lt;typename, template&lt;typename&gt; typename&gt; class W,\n          template &lt;typename&gt; typename S&gt;\nstruct Apply\n{\n    template &lt;typename T&gt; using type = W&lt;T, S&gt;;\n};\n</code></pre>\n\n<p>Then instantiate <code>Storage</code> like this:</p>\n\n<pre><code>Storage&lt;int, Apply&lt;StringHandleWrapper, SmartPtrVec&gt;::type&gt; s;\n</code></pre>\n"}], "owner": {"reputation": 628, "user_id": 6199585, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-IdPVJXFKZrI/AAAAAAAAAAI/AAAAAAAAApE/iIo85sk1fRM/photo.jpg?sz=128", "display_name": "Boris", "link": "https://stackoverflow.com/users/6199585/boris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513797357, "creation_date": 1513794894, "last_edit_date": 1513795375, "question_id": 47912377, "link": "https://stackoverflow.com/questions/47912377/c-wrapper-template-how-to-pass-it-as-a-template-parameter", "title": "C++ wrapper template: how to pass it as a template parameter?", "body": "<p>Question to C++ template gurus:<br>\nI have created two template \"policies\" (not sure if this is the right term), which implement storage of some value types in a vector of either dumb or smart pointers:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n#include &lt;memory&gt;\n#include &lt;string&gt;\n#include &lt;unordered_map&gt;\n#include &lt;vector&gt;\n\ntemplate &lt;typename T&gt;\nclass DumbPtrVec\n{\n  std::vector&lt;T*&gt; m_vec;\npublic:\n  using handle = size_t;\n\n  ~DumbPtrVec() {\n    std::for_each(begin(m_vec), end(m_vec), [](T* p){ delete p; });\n  }\n\n  handle AddElement(T* p) {\n    const handle index = m_vec.size();\n    m_vec.push_back(p);\n    return index;\n  }\n\n  T* GetElement(const handle&amp; i) {\n    T* p = (i &lt; m_vec.size())? m_vec[i] : nullptr;\n    return p;\n  }\n};\n\ntemplate &lt;typename T&gt;\nclass SmartPtrVec\n{\n  std::vector&lt;std::shared_ptr&lt;T&gt;&gt; m_vec;\npublic:\n  using handle = std::weak_ptr&lt;T&gt;;\n\n  handle AddElement(T* p) {\n    m_vec.emplace_back(p);\n    return m_vec.back(); // gets converted to weak_ptr\n  }\n\n  T* GetElement(const handle&amp; i) {\n    T* p = (i.expired())? nullptr : i.lock().get();\n    return p;\n  }\n};\n\ntemplate &lt;typename T, template&lt;typename&gt; typename STORAGE&gt;\nclass Storage\n{\n    STORAGE&lt;T&gt; m_values;\npublic:\n    using handle = typename STORAGE&lt;int&gt;::handle;\n\n    handle AddValue(T* v) { return m_values.AddElement(v); }\n    T* GetValue(handle h) { return m_values.GetElement(h); }\n};\n\nint main()\n{\n    constexpr int N = 13;\n\n    Storage&lt;int, DumbPtrVec&gt; d;\n    auto dh = d.AddValue(new int(N));\n    std::cout &lt;&lt; *d.GetValue(dh) &lt;&lt; \" == \" &lt;&lt; N &lt;&lt;std::endl;\n\n    Storage&lt;int, SmartPtrVec&gt; s;\n    auto sh = s.AddValue(new int(N));\n    std::cout &lt;&lt; *s.GetValue(sh) &lt;&lt; \" == \" &lt;&lt; N &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>Everything works fine, so far.<br>\nThen I added a template wrapper, that replaces the element \"handle\" with a unique string and keeps a look-up table for converting strings back to the handles. If this class is explicitly derived from either <code>DumbPtrVec</code> or <code>SmartPtrVec</code> class, everything works, e.g. for <code>SmartPtrVec</code>:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass StringHandleWrapper : SmartPtrVec&lt;T&gt;\n{\n    using super = typename SmartPtrVec&lt;T&gt;;\n    using Str2HandleMap = std::unordered_map&lt;std::string, typename super::handle&gt;;\n\n    Str2HandleMap m_Name2HandleMap;\n\npublic:\n    using handle = std::string;\n\n    handle AddElement(T* p) {\n        typename super::handle elem = super::AddElement(p);\n\n        static int counter = 0;  \n        std::string uuid = std::to_string(++counter);\n\n        m_Name2HandleMap[uuid] = elem;\n        return uuid;\n    }\n\n    T* GetElement(const handle&amp; uuid) {\n        auto it = m_Name2HandleMap.find(uuid);\n        return (it != m_Name2HandleMap.end())? super::GetElement(it-&gt;second) : nullptr;\n    }\n};\n</code></pre>\n\n<p>and successful invocation:</p>\n\n<pre><code>Storage&lt;int, StringHandleWrapper&gt; s;\nstd::string handle = s.AddValue(new int(N));    \n</code></pre>\n\n<p>But I can't figure out how to add a second template parameter, <code>STORAGE</code>, to <code>StringHandleWrapper</code>, so that it could wrap any of <code>DumbPtrVec</code> or <code>SmartPtrVec</code>...<br>\nIf I change <code>StringHandleWrapper</code> to:</p>\n\n<pre><code>template &lt;typename T, template&lt;typename&gt; typename STORAGE&gt;\nclass StringHandleWrapper : STORAGE&lt;T&gt;\n{\n    using super = typename STORAGE&lt;T&gt;;\n//... rest unchanged\n</code></pre>\n\n<p>then I can't figure out how to instantiate <code>Storage</code> class, as compiler complains about \"too few template arguments\":</p>\n\n<pre><code>Storage&lt;int, StringHandleWrapper&lt;SmartPtrVec&gt;&gt; s;\n</code></pre>\n\n<p>I hope I'm missing something simple...</p>\n\n<p>Thank you for taking your time to look through my long question!</p>\n"}, {"tags": ["c++", "templates", "casting", "type-conversion"], "comments": [{"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1513794114, "post_id": 47912115, "comment_id": 82791984, "body": "You could provide a default template arg of <code>float</code> and then <code>typedef Vec2&lt;&gt; Vec2</code>, you could also give <code>Vec2</code> a generic name to use with non default template types."}], "answers": [{"tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 2, "last_activity_date": 1513794310, "last_edit_date": 1513794310, "creation_date": 1513794011, "answer_id": 47912147, "question_id": 47912115, "link": "https://stackoverflow.com/questions/47912115/template-vs-type-casting/47912147#47912147", "title": "Template vs type casting", "body": "<blockquote>\n  <p>i'm not in need of float at all and I could use the same class but based on integer</p>\n</blockquote>\n\n<p>Yes, making <code>Vec2</code> a class template is appropriate here. This would allow you to parametrize the class on any numerical type, while avoiding duplication of your interface and logic.</p>\n\n<pre><code>template &lt;typename T&gt;\nclass Vec2\n{\npublic:\n    Vec2(T x, T y);\npublic:\n    bool operator==(Vec2&amp; rhs);\n    Vec2 operator+(Vec2&amp; rhs) const;\n    Vec2 operator*(T rhs) const;\n    Vec2 operator-(Vec2&amp; rhs) const;\n    Vec2&amp; operator+=(Vec2&amp; rhs);\n    Vec2&amp; operator-=(Vec2&amp; rhs);\n    Vec2&amp; operator*=(T rhs);\n    float LenghtSqrt() const;\n    float Lenght() const;\n    float Distance(const Vec2&amp; rhs) const;\n    Vec2 GetNormalized() const;\n    Vec2&amp; Normalize();\npublic:\n    T x, y;\n};\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 7897953, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p9LynmoeygE/AAAAAAAAAAI/AAAAAAAAAMY/OxVaxwR4O18/photo.jpg?sz=128", "display_name": "Will neeh", "link": "https://stackoverflow.com/users/7897953/will-neeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513794310, "creation_date": 1513793858, "question_id": 47912115, "link": "https://stackoverflow.com/questions/47912115/template-vs-type-casting", "title": "Template vs type casting", "body": "<p>I have this vector class based on float that I use to store the coorinates of my objects and when i need them as an int I would simply do type casting.\nBut sometimes i find myself in a situation where i'm not in need of float at all and I could use the same class but based on integer.\nSo should i use  a template on this class or should i let it be float based?</p>\n\n<pre><code>#pragma once\nclass Vec2\n{\npublic:\n    Vec2(float x, float y);\npublic:\n    bool operator==(Vec2&amp; rhs);\n    Vec2 operator+(Vec2&amp; rhs) const;\n    Vec2 operator*(float rhs) const;\n    Vec2 operator-(Vec2&amp; rhs) const;\n    Vec2&amp; operator+=(Vec2&amp; rhs);\n    Vec2&amp; operator-=(Vec2&amp; rhs);\n    Vec2&amp; operator*=(float rhs);\n    float LenghtSqrt() const;\n    float Lenght() const;\n    float Distance(const Vec2&amp; rhs) const;\n    Vec2 GetNormalized() const;\n    Vec2&amp; Normalize();\npublic:\n    float x, y;\n\n};\n</code></pre>\n"}, {"tags": ["c++", "c++11", "gcc", "centos", "c++14"], "comments": [{"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 1, "creation_date": 1513794356, "post_id": 47912089, "comment_id": 82792091, "body": "If it would be ABI problem, linker would complain, not compiler. And may be some other cryptic internal errors. This one looks fine."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1513794822, "post_id": 47912089, "comment_id": 82792324, "body": "What&#39;s your <code>g++ -v</code>? It&#39;s probably built to use the old ABI by default."}, {"owner": {"reputation": 6911, "user_id": 2970186, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Vo0Wc.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2970186/daniel"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1513796485, "post_id": 47912089, "comment_id": 82793095, "body": "@T.C. Added. I guess the problem is the <code>--with-default-libstdcxx-abi=gcc4-compatible</code> bit? Why would this be set on <code>gcc</code> 7?"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1513819564, "post_id": 47912089, "comment_id": 82801320, "body": "Because whoever maintains the yum package decided that defaulting to the old ABI is a good idea. If you want the new ABI, then either define the macro asking for it or build your own GCC."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 1, "creation_date": 1513819679, "post_id": 47912089, "comment_id": 82801343, "body": "@Incomputable libstdc++&#39;s old <code>std::string</code> implementation <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=81967\" rel=\"nofollow noreferrer\">doesn&#39;t meet some C++11 requirements</a>, including this one."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 3290204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124e2c51ec2f05a76d94e79fd466645e?s=128&d=identicon&r=PG", "display_name": "Jean-Mathieu Vermosen", "link": "https://stackoverflow.com/users/3290204/jean-mathieu-vermosen"}, "edited": false, "score": 0, "creation_date": 1570198351, "post_id": 58238078, "comment_id": 102848921, "body": "see <a href=\"https://stackoverflow.com/questions/49393888/how-can-i-use-the-new-c-11-abi-with-devtoolset-7-on-centos-rhel\" title=\"how can i use the new c 11 abi with devtoolset 7 on centos rhel\">stackoverflow.com/questions/49393888/&hellip;</a> for a related issue"}, {"owner": {"reputation": 4790, "user_id": 4491743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aXCqO.jpg?s=128&g=1", "display_name": "Knud Larsen", "link": "https://stackoverflow.com/users/4491743/knud-larsen"}, "edited": false, "score": 1, "creation_date": 1570535203, "post_id": 58238078, "comment_id": 102936287, "body": "Extra gcc/g++ 7.3, see <a href=\"https://stackoverflow.com/questions/47175706/how-to-install-gcc-4-9-2-on-rhel-7-4/47189915#47189915\" title=\"how to install gcc 4 9 2 on rhel 7 4\">stackoverflow.com/questions/47175706/&hellip;</a> .... ( The compiled code will depend on <code>libstdc++.so.6 -&gt; libstdc++.so.6.0.24</code> )."}], "tags": [], "owner": {"reputation": 87, "user_id": 3290204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124e2c51ec2f05a76d94e79fd466645e?s=128&d=identicon&r=PG", "display_name": "Jean-Mathieu Vermosen", "link": "https://stackoverflow.com/users/3290204/jean-mathieu-vermosen"}, "is_accepted": false, "score": 2, "last_activity_date": 1570198271, "creation_date": 1570198271, "answer_id": 58238078, "question_id": 47912089, "link": "https://stackoverflow.com/questions/47912089/why-is-the-wrong-gcc-7-2-libstdc-abi-being-selected-on-centos-7/58238078#58238078", "title": "Why is the wrong GCC 7.2 libstdc++ ABI being selected on CentOS 7?", "body": "<p>as stated <a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=1546704\" rel=\"nofollow noreferrer\">here</a>, it looks the version of gcc that ships with the devtoolset-7 silently ignores the _GLIBCXX_USE_CXX11_ABI flag under RHEL6 and 7. The behavior has been probably forwarded to centos.</p>\n"}], "owner": {"reputation": 6911, "user_id": 2970186, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Vo0Wc.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2970186/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1683, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1570198271, "creation_date": 1513793741, "last_edit_date": 1513813483, "question_id": 47912089, "link": "https://stackoverflow.com/questions/47912089/why-is-the-wrong-gcc-7-2-libstdc-abi-being-selected-on-centos-7", "title": "Why is the wrong GCC 7.2 libstdc++ ABI being selected on CentOS 7?", "body": "<p>I'm trying to compile a simple program with GCC 7.2.1 on CentOS 7. After finding <a href=\"https://centos.pkgs.org/7/centos-sclo-rh/devtoolset-7-gcc-c++-7.1.1-2.1.el7.x86_64.rpm.html\" rel=\"nofollow noreferrer\">this package</a>, I installed <code>g++</code> with the following command on a fresh Docker CentOS image:</p>\n\n<pre><code>$ yum install centos-release-scl-rh\n$ yum install devtoolset-7-gcc-c++\n$ ln -s /opt/rh/devtoolset-7/root/usr/bin/g++ /usr/local/bin/g++\n</code></pre>\n\n<p>Confirming the install:</p>\n\n<pre><code>$ g++ -v\nUsing built-in specs.\nCOLLECT_GCC=g++\nCOLLECT_LTO_WRAPPER=/opt/rh/devtoolset-7/root/usr/libexec/gcc/x86_64-redhat-linux/7/lto-wrapper\nTarget: x86_64-redhat-linux\nConfigured with: ../configure --enable-bootstrap --enable-languages=c,c++,fortran,lto --prefix=/opt/rh/devtoolset-7/root/usr --mandir=/opt/rh/devtoolset-7/root/usr/share/man --infodir=/opt/rh/devtoolset-7/root/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-shared --enable-threads=posix --enable-checking=release --enable-multilib --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-gcc-major-version-only --enable-plugin --with-linker-hash-style=gnu --enable-initfini-array --with-default-libstdcxx-abi=gcc4-compatible --with-isl=/builddir/build/BUILD/gcc-7.2.1-20170829/obj-x86_64-redhat-linux/isl-install --enable-libmpx --enable-gnu-indirect-function --with-tune=generic --with-arch_32=i686 --build=x86_64-redhat-linux\nThread model: posix\ngcc version 7.2.1 20170829 (Red Hat 7.2.1-1) (GCC) \n</code></pre>\n\n<p>Attempting to compile the program:</p>\n\n<pre><code>// main.cpp\n#include &lt;string&gt;\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::string foo {\"hello world10m\"};\n    foo.erase(std::find(std::cbegin(foo), std::cend(foo), '1'), std::cend(foo));\n    std::cout &lt;&lt; foo &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>using the command:</p>\n\n<pre><code>$ g++ -std=gnu++14 -o test main.cpp\n</code></pre>\n\n<p>gives the following compiler error:</p>\n\n<pre><code>main.cpp: In function 'int main()':\nmain.cpp:9:79: error: no matching function for call to 'std::basic_string&lt;char&gt;::erase(__gnu_cxx::__normal_iterator&lt;const char*, std::basic_string&lt;char&gt; &gt;, std::basic_string&lt;char&gt;::const_iterator)'\n     foo.erase(std::find(std::cbegin(foo), std::cend(foo), '1'), std::cend(foo));\n                                                                               ^\nIn file included from /opt/rh/devtoolset-7/root/usr/include/c++/7/string:52:0,\n                 from main.cpp:1:\n/opt/rh/devtoolset-7/root/usr/include/c++/7/bits/basic_string.h:4476:7: note: candidate: std::basic_string&lt;_CharT, _Traits, _Alloc&gt;&amp; std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::erase(std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::size_type, std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::size_type) [with _CharT = char; _Traits = std::char_traits&lt;char&gt;; _Alloc = std::allocator&lt;char&gt;; std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::size_type = long unsigned int]\n       erase(size_type __pos = 0, size_type __n = npos)\n       ^~~~~\n/opt/rh/devtoolset-7/root/usr/include/c++/7/bits/basic_string.h:4476:7: note:   no known conversion for argument 1 from '__gnu_cxx::__normal_iterator&lt;const char*, std::basic_string&lt;char&gt; &gt;' to 'std::basic_string&lt;char&gt;::size_type {aka long unsigned int}'\n/opt/rh/devtoolset-7/root/usr/include/c++/7/bits/basic_string.h:4492:7: note: candidate: std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::iterator std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::erase(std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::iterator) [with _CharT = char; _Traits = std::char_traits&lt;char&gt;; _Alloc = std::allocator&lt;char&gt;; std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::iterator = __gnu_cxx::__normal_iterator&lt;char*, std::basic_string&lt;char&gt; &gt;; typename _Alloc::rebind&lt;_CharT&gt;::other::pointer = char*]\n       erase(iterator __position)\n       ^~~~~\n/opt/rh/devtoolset-7/root/usr/include/c++/7/bits/basic_string.h:4492:7: note:   candidate expects 1 argument, 2 provided\n/opt/rh/devtoolset-7/root/usr/include/c++/7/bits/basic_string.h:4512:7: note: candidate: std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::iterator std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::erase(std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::iterator, std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::iterator) [with _CharT = char; _Traits = std::char_traits&lt;char&gt;; _Alloc = std::allocator&lt;char&gt;; std::basic_string&lt;_CharT, _Traits, _Alloc&gt;::iterator = __gnu_cxx::__normal_iterator&lt;char*, std::basic_string&lt;char&gt; &gt;; typename _Alloc::rebind&lt;_CharT&gt;::other::pointer = char*]\n       erase(iterator __first, iterator __last);\n       ^~~~~\n/opt/rh/devtoolset-7/root/usr/include/c++/7/bits/basic_string.h:4512:7: note:   no known conversion for argument 1 from '__gnu_cxx::__normal_iterator&lt;const char*, std::basic_string&lt;char&gt; &gt;' to 'std::basic_string&lt;char&gt;::iterator {aka __gnu_cxx::__normal_iterator&lt;char*, std::basic_string&lt;char&gt; &gt;}'\n</code></pre>\n\n<p>As far as I can tell, the wrong <a href=\"https://gcc.gnu.org/onlinedocs/libstdc++/manual/using_dual_abi.html\" rel=\"nofollow noreferrer\"><code>libstdc++</code> ABI</a> is being selected. This example compiles fine on Ubuntu 16. What's going on?</p>\n"}, {"tags": ["c++", "string", "comparison"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 6, "creation_date": 1513793758, "post_id": 47912067, "comment_id": 82791843, "body": "You are comparing <b>pointers</b>.  &quot;Does the address of this string happen to be greater than the address of this string?&quot;"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1513793779, "post_id": 47912067, "comment_id": 82791853, "body": "Comparing string literals compares pointers and will not account for the string&#39;s content."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1513797662, "post_id": 47912067, "comment_id": 82793671, "body": "Strings are not numbers. They are 0-terminated arrays of characters. A particular string might contain characters that can be interpreted as a number, but that&#39;s a separate step; such a string is not a number."}], "answers": [{"tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 8, "last_activity_date": 1513793779, "creation_date": 1513793779, "answer_id": 47912097, "question_id": 47912067, "link": "https://stackoverflow.com/questions/47912067/how-comparison-operator-for-strings-works-in-c-if-strings-are-numbers/47912097#47912097", "title": "How comparison operator for strings works in C++, if strings are numbers?", "body": "<p><code>\"3\"</code> is not a \"string\", it's a <code>const</code> array of <code>char</code>s. <code>const char</code> arrays can automatically decay to <code>const char*</code>. Pointers can be compared with <code>operator&lt;</code>. </p>\n\n<p>Comparison of pointers is just comparison between addresses. In this particular case, your comparisons lead to <strong>undefined behavior</strong> as the pointers are unrelated between each other (they're not pointing to objects that belong to the same array).</p>\n\n<hr>\n\n<p>If you really want to lexicographically compare C-style strings, use <code>std::strcmp</code>. Otherwise, you should use <code>std::string</code> and rely on <code>std::string::operator&lt;</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 12, "last_activity_date": 1513853900, "last_edit_date": 1513853900, "creation_date": 1513793840, "answer_id": 47912113, "question_id": 47912067, "link": "https://stackoverflow.com/questions/47912067/how-comparison-operator-for-strings-works-in-c-if-strings-are-numbers/47912113#47912113", "title": "How comparison operator for strings works in C++, if strings are numbers?", "body": "<p>The behaviour of your code is undefined.</p>\n\n<p>The <code>const char[]</code> literals you have entered decay to <code>const char*</code> pointers for the purpose of comparison.</p>\n\n<p>And the behaviour of the comparison operators on pointers  is only defined if the pointers are part of the same array; which yours are not.</p>\n\n<p>If you suffix the literals with an s, e.g.\n<code>\"3\"s</code> then C++14 onwards will treat that as a std::string and will perform a lexographic comparison.</p>\n"}], "owner": {"reputation": 1618, "user_id": 4507489, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/4915f939fee361e28d5cc134475e926c?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek kumar", "link": "https://stackoverflow.com/users/4507489/vivek-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 47912113, "answer_count": 2, "score": 6, "last_activity_date": 1513853900, "creation_date": 1513793662, "last_edit_date": 1513793740, "question_id": 47912067, "link": "https://stackoverflow.com/questions/47912067/how-comparison-operator-for-strings-works-in-c-if-strings-are-numbers", "title": "How comparison operator for strings works in C++, if strings are numbers?", "body": "<p>Please tell me how less than, greater than operator works for strings if strings are numbers and also have same number of digits. How exactly these operator work ?</p>\n\n<p>For e.g., for the below comparisons-</p>\n\n<pre><code>cout&lt;&lt;(\"3\" &gt; \"5\")&lt;&lt;endl;\ncout&lt;&lt;(\"31\" &gt; \"25\")&lt;&lt;endl;\ncout&lt;&lt;(\"35\" &gt; \"35\")&lt;&lt;endl;\ncout&lt;&lt;(\"38\" &gt; \"85\")&lt;&lt;endl;\ncout&lt;&lt;(\"53\" &gt; \"55\")&lt;&lt;endl;\ncout&lt;&lt;(\"36\" &gt; \"35\")&lt;&lt;endl;\ncout&lt;&lt;(\"53\" &gt; \"54\")&lt;&lt;endl;\n</code></pre>\n\n<p>Output I got from CodeBlocks is-</p>\n\n<pre><code>0\n0\n0\n0\n0\n0\n0\n</code></pre>\n"}, {"tags": ["c++", "mfc", "tooltip"], "comments": [{"owner": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "edited": false, "score": 0, "creation_date": 1513882375, "post_id": 47911883, "comment_id": 82830895, "body": "Since the window is disabled, you are not going to be able to use tooltips with it. However, you can use GetWindowRect(), translate to a client area rectangle on the dialog, and then add a tool for the space that the window occupies. Look at overrides for CToolTipCtrl::AddTool that take RECT arguments."}], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 3, "creation_date": 1513853015, "post_id": 47921878, "comment_id": 82813980, "body": "It would be extremely helpful if you explained, what the core issue is, and how this answer addresses it. Besides, I couldn&#39;t find a single MFC class that exposes a public <code>RelayEvent</code> member with the signature you are using. But then, it&#39;s also unclear, what <code>m_wndCtrl</code> is."}, {"owner": {"reputation": 327, "user_id": 2721136, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GmQUg.png?s=128&g=1", "display_name": "KungPhoo", "link": "https://stackoverflow.com/users/2721136/kungphoo"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1516179338, "post_id": 47921878, "comment_id": 83578603, "body": "Oh dear. The m_wndCtrl is a control derived from CButton or CEdit..., that has a CToolTipCtrl m_toolTip member and this implementation:   \t\t\t\t\tvoid ThisClass::RelayEvent(UINT message, WPARAM wParam, LPARAM lParam) \t\t\t\t\t{ \t\t\t\t\t\tif (m_tooltip.m_hWnd != NULL) \t\t\t\t\t\t{ \t\t\t\t\t\t\tMSG msg; \t\t\t\t\t\t\tmsg.hwnd= m_hWnd; msg.message= message; msg.wParam= wParam; msg.lParam= lParam; msg.time= 0; msg.pt.x= LOWORD (lParam); msg.pt.y= HIWORD (lParam); \t\t\t\t\t\t\tm_tooltip.RelayEvent(&amp;msg); \t\t\t\t\t\t} \t\t\t\t\t}"}], "tags": [], "owner": {"reputation": 327, "user_id": 2721136, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GmQUg.png?s=128&g=1", "display_name": "KungPhoo", "link": "https://stackoverflow.com/users/2721136/kungphoo"}, "is_accepted": false, "score": 0, "last_activity_date": 1513848666, "creation_date": 1513848666, "answer_id": 47921878, "question_id": 47911883, "link": "https://stackoverflow.com/questions/47911883/mfc-add-tooltip-for-disabled-radio-button/47921878#47921878", "title": "MFC Add Tooltip for disabled radio button", "body": "<pre><code>BOOL MyDialog::PreTranslateMessage(MSG* pMsg)\n{\n    // GF: Fix tooltips on disabled items.\n    m_wndCtrl.RelayEvent(pMsg-&gt;message, pMsg-&gt;wParam, pMsg-&gt;lParam);\n    m_wndCtrl.UpdateWindow();\n    return CDialog::PreTranslateMessage(pMsg);\n}\n</code></pre>\n\n<p>This works for me.</p>\n"}], "owner": {"reputation": 770, "user_id": 5342737, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/un6cX.png?s=128&g=1", "display_name": "Sergioet", "link": "https://stackoverflow.com/users/5342737/sergioet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 814, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513879220, "creation_date": 1513792888, "question_id": 47911883, "link": "https://stackoverflow.com/questions/47911883/mfc-add-tooltip-for-disabled-radio-button", "title": "MFC Add Tooltip for disabled radio button", "body": "<p>In MFC (old I know), I am trying to add a Tooltip that appears only when a radio button is disabled.</p>\n\n<p>I am able to show the tooltip with code such as:</p>\n\n<pre><code>m_ToolTip.Create(this);\nm_ToolTip.AddTool(GetDlgItem(IDC_RADIOBUTTON), \"Tooltip text\");\nm_ToolTip.Activate(TRUE);\n</code></pre>\n\n<p>But it does not work when my radio button is disabled, (apparently that is by design)</p>\n\n<p>After some research it appears that I need to override the </p>\n\n<pre><code>PreTranslateMessage()\n</code></pre>\n\n<p>function to get the ToolTip showing, perhaps tracking when the mouse enters into the control area, but I don't know how to do that.</p>\n\n<p>Any help much appreciated.</p>\n"}, {"tags": ["c++", "file", "mmap"], "comments": [{"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1513793265, "post_id": 47911865, "comment_id": 82791589, "body": "It is not C++. Update the tag."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 1, "creation_date": 1513793276, "post_id": 47911865, "comment_id": 82791596, "body": "<code>mmap</code>, like everything, has measurable overhead. But if you&#39;re storing the <i>results</i> of <code>read</code> in a buffer, that means you&#39;re probably not using it &quot;only once&quot;. Note also the <code>madvise</code> options which are occasionally (but not usually) useful."}, {"owner": {"reputation": 1628, "user_id": 1230621, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a752347505880eb6aca2316744e7f474?s=128&d=identicon&r=PG", "display_name": "StarShine", "link": "https://stackoverflow.com/users/1230621/starshine"}, "edited": false, "score": 0, "creation_date": 1513793282, "post_id": 47911865, "comment_id": 82791600, "body": "memory mapped files are great if you are going to have random access across the file. For example large chunk based files read faster if they are memory mapped. for simply reading it as a continuous stream, memory mapping it takes a lot of time and resources, and you&#39;re not taking any real advantage of it. Ofcourse, if you really have HUGE files, huge as in terrabytes, it&#39;s a different story."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 1, "creation_date": 1513793433, "post_id": 47911865, "comment_id": 82791673, "body": "@S.M. Seems like legal c++ to me. And it&#39;s definitively not c, since <code>new</code> is used."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1513793692, "post_id": 47911865, "comment_id": 82791805, "body": "Unless you&#39;re re-reading the data, in general <code>mmap()</code> is slow. If you&#39;re reading the data more than once, the extra overhead of <code>mmap()</code> can be worth it.  Read this from one Linus Torvalds:  <a href=\"http://lkml.iu.edu/hypermail/linux/kernel/0802.0/1496.html\" rel=\"nofollow noreferrer\">lkml.iu.edu/hypermail/linux/kernel/0802.0/1496.html</a>   One advantage of <code>mmap()</code> is code can be very simple."}], "owner": {"reputation": 8388, "user_id": 1130231, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gHygY.png?s=128&g=1", "display_name": "Martin Perry", "link": "https://stackoverflow.com/users/1130231/martin-perry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1031, "favorite_count": 0, "closed_date": 1513795738, "answer_count": 0, "score": 2, "last_activity_date": 1513793382, "creation_date": 1513792812, "last_edit_date": 1592644375, "question_id": 47911865, "link": "https://stackoverflow.com/questions/47911865/c-memory-mapped-files", "closed_reason": "Duplicate", "title": "C++ memory mapped files", "body": "<p>I want to use memory mapping files for data that I read only once. Currently I am using:</p>\n<pre><code>FILE * f = fopen(&quot;data.dat&quot;, &quot;rb&quot;);\n\nfseek(f, 0L, SEEK_END);\nsize_t fileSize = ftell(f);\nfseek(f, 0L, SEEK_SET);\n\nchar * buffer = new char[fileSize];\nfread(buffer, sizeof(char), fileSize, f);\nfclose(f);\n\n//operate with buffer\nfor (size_t i = 0; i &lt; fileSize; i++){ \n  //...\n}\n</code></pre>\n<p>I wanted to use mmap and operate directly on mapped buffer. However, I have found in Apple doc about <code>mmap</code> that there is:</p>\n<blockquote>\n<p>You should not use file mapping in the following situations:</p>\n<ul>\n<li>You want to read a file sequentially from start to finish only once.</li>\n</ul>\n</blockquote>\n<p>Why? If I use <code>fread</code> there is more &quot;logic&quot;, plus I am creating new array, that is also not for free.</p>\n"}, {"tags": ["c++", "hash", "md5", "checksum", "crc"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1513792283, "post_id": 47911680, "comment_id": 82791094, "body": "&quot;My question is Can I do chacksum to directory without looping all the files?&quot; it depends on what you mean by &quot;checksum of the directory&quot;"}, {"owner": {"reputation": 91, "user_id": 3815613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e02d0e8448f68c72234d4f3297e4d77?s=128&d=identicon&r=PG&f=1", "display_name": "LIOR", "link": "https://stackoverflow.com/users/3815613/lior"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513792548, "post_id": 47911680, "comment_id": 82791225, "body": "I want to read the directory in run time, and verify that the content is valid."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1513792738, "post_id": 47911680, "comment_id": 82791333, "body": "Do you need to validate content of each file? If yes then you will have to calculate checksum for each file."}, {"owner": {"reputation": 91, "user_id": 3815613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e02d0e8448f68c72234d4f3297e4d77?s=128&d=identicon&r=PG&f=1", "display_name": "LIOR", "link": "https://stackoverflow.com/users/3815613/lior"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513793798, "post_id": 47911680, "comment_id": 82791861, "body": "In general i need to validate every file, this is why I trying to understand if i can do it in directory level."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1513793961, "post_id": 47911680, "comment_id": 82791918, "body": "<b><i>Can I do checksum to directory without looping all the files?</i></b> No. You have to read each file. Calculate a checksum then store the checksum in some file and compare for subsequent executions."}, {"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "edited": false, "score": 0, "creation_date": 1513949832, "post_id": 47911680, "comment_id": 82854358, "body": "What kind of system are you on? Linux? Windows? macOS?"}, {"owner": {"reputation": 91, "user_id": 3815613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e02d0e8448f68c72234d4f3297e4d77?s=128&d=identicon&r=PG&f=1", "display_name": "LIOR", "link": "https://stackoverflow.com/users/3815613/lior"}, "edited": false, "score": 0, "creation_date": 1513949998, "post_id": 47911680, "comment_id": 82854452, "body": "I working on Linux"}], "answers": [{"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 2, "last_activity_date": 1513793329, "last_edit_date": 1513793329, "creation_date": 1513792544, "answer_id": 47911799, "question_id": 47911680, "link": "https://stackoverflow.com/questions/47911680/directory-checksum/47911799#47911799", "title": "Directory checksum", "body": "<p>One possible solution is to maintain a special (hidden) file in which you keep modification datetime and hash of each file and update it when files are changed. Then have hash of that file as hash of the directory. This will not prevent from calculating checksums for all files but reduce amount of work when files are changed. If you need to make a snapshot of a dir, then you do not have a choice but need to checksum every file in particular order.</p>\n\n<p>Note: you may consider to avoid crypto hashes unless you have strong requirement that they cannot be faked. Crypto hashes are rather slow and inefficient and that is on purpose.</p>\n"}, {"tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": false, "score": 0, "last_activity_date": 1513951315, "creation_date": 1513951315, "answer_id": 47942788, "question_id": 47911680, "link": "https://stackoverflow.com/questions/47911680/directory-checksum/47942788#47942788", "title": "Directory checksum", "body": "<p>I'm not certain of your application. md5 checksum is generally used in situations where accuracy is favored over speed (or to present an additional barrier to foul play.)</p>\n\n<p>In build systems where speed is king, file dating is generally used to evaluate directory equality. For example given the latest directory is: <code>filesystem::path foo</code> and the directory in question is: <code>filesystem::path bar</code> you could simply evaluate:</p>\n\n<pre><code>equal(filesystem::directory_iterator(foo), filesystem::directory_iterator(), filesystem::directory_iterator(bar), filesystem::directory_iterator(), [](const auto&amp; lhs, const auto&amp; rhs) { return filesystem::last_write_time(lhs) == filesystem::last_write_time(rhs); })\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/d3f99b2822d8b019\" rel=\"nofollow noreferrer\"><kbd>Live Example</kbd></a></p>\n\n<p>A few notes about this one-liner: </p>\n\n<ol>\n<li>This is not a recursive function, it's evaluating only the dates immediately within <code>foo</code> and <code>bar</code></li>\n<li>If you <em>are</em> working with directories, <a href=\"https://stackoverflow.com/q/47913379/2642059\">Visual Studio's implementation of <code>last_write_time</code> seems to have an issue with directories</a></li>\n<li>In a build system for example this has the tremendous advantage over an md5 checksum that I can change the <code>==</code> in the lambda to <code>&lt;</code> the one liner will still respond affirmatively if you have manually updated one of the files to a newer test version</li>\n</ol>\n"}], "owner": {"reputation": 91, "user_id": 3815613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e02d0e8448f68c72234d4f3297e4d77?s=128&d=identicon&r=PG&f=1", "display_name": "LIOR", "link": "https://stackoverflow.com/users/3815613/lior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1402, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513951315, "creation_date": 1513791981, "last_edit_date": 1513793223, "question_id": 47911680, "link": "https://stackoverflow.com/questions/47911680/directory-checksum", "title": "Directory checksum", "body": "<p>I have directory with 80 files, I want to check the checksum of the directory.</p>\n\n<p>I want to verify that the content of the directory is match to the latest version. </p>\n\n<p>I working with real time system so It need to be efficient.</p>\n\n<p>I found some file checksum function.</p>\n\n<p>My question is: Can I do checksum to directory without looping all the files? </p>\n"}, {"tags": ["c++", "matrix"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513791843, "post_id": 47911611, "comment_id": 82790831, "body": "<i>I specifically dont understand this lines:</i> -- Too broad.  What don&#39;t you understand?  The syntax?  The formula?  The <code>return</code> statement?  The <code>ternary operator</code>?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1513791882, "post_id": 47911611, "comment_id": 82790861, "body": "take a piece of paper, draw a U, L and a F matrix and enumerate the elements from 1 to N, then you can understand what that code does"}, {"owner": {"reputation": 15, "user_id": 9123798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fa91187d522933689ff14efc3cbe36?s=128&d=identicon&r=PG&f=1", "display_name": "alex403", "link": "https://stackoverflow.com/users/9123798/alex403"}, "edited": false, "score": 0, "creation_date": 1513791977, "post_id": 47911611, "comment_id": 82790920, "body": "I dont understand the formula (the terms between the [...])"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1513792083, "post_id": 47911611, "comment_id": 82790970, "body": "btw already C.F.Gauss knew how to get the result of <code>sum(k)</code> in a more efficient way :P"}, {"owner": {"reputation": 71, "user_id": 6823991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4abd90fb23e51653c5b8be0528d13ec?s=128&d=identicon&r=PG&f=1", "display_name": "jsn", "link": "https://stackoverflow.com/users/6823991/jsn"}, "edited": false, "score": 0, "creation_date": 1513792562, "post_id": 47911611, "comment_id": 82791238, "body": "did you understand how to get the matrix element back by typ? you have to be able to solve this problem on a paper first. Second step is the programming..."}], "answers": [{"tags": [], "owner": {"reputation": 8409, "user_id": 2001017, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/H0Z0x.jpg?s=128&g=1", "display_name": "Picaud Vincent", "link": "https://stackoverflow.com/users/2001017/picaud-vincent"}, "is_accepted": false, "score": 2, "last_activity_date": 1513792538, "last_edit_date": 1513792538, "creation_date": 1513792142, "answer_id": 47911713, "question_id": 47911611, "link": "https://stackoverflow.com/questions/47911611/save-matrix-column-wise-in-c/47911713#47911713", "title": "Save matrix column-wise in c++", "body": "<p>The lines </p>\n\n<pre><code>   if(typ == 'L') return (k&gt;j)?(0.0):(mat[k*n+j-sum(k)]);  \n        if(typ == 'U') return (j&gt;k)?(0.0):( mat[k*n+j-sum(n-1)+sum(n-(k+1))]);\n</code></pre>\n\n<p>sign the use of the <a href=\"http://www.netlib.org/lapack/lug/node123.html\" rel=\"nofollow noreferrer\">packed storage schem</a> to store your matrix.</p>\n\n<p>Also note that IMHO the overall code quality is quite low, for instance no need to compute <code>sum(k)</code> with a <em>for-loop</em>, its explicit expression is (k+1)*k/2, etc.</p>\n"}], "owner": {"reputation": 15, "user_id": 9123798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fa91187d522933689ff14efc3cbe36?s=128&d=identicon&r=PG&f=1", "display_name": "alex403", "link": "https://stackoverflow.com/users/9123798/alex403"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "closed_date": 1513794499, "answer_count": 1, "score": 0, "last_activity_date": 1513792538, "creation_date": 1513791690, "question_id": 47911611, "link": "https://stackoverflow.com/questions/47911611/save-matrix-column-wise-in-c", "closed_reason": "Needs details or clarity", "title": "Save matrix column-wise in c++", "body": "<p>I am trying to understand this code but I can't:\nThe n x n matrix is saved column wise. I distinguish between full (F), upper (U) and lower (L) matrix. \nn is the dimension of the matrix</p>\n\n<pre><code>int sum(int k){\nint s = 0;\nfor (int i = 1; i&lt;=k; i++)\n    s += i;\nreturn s;}\n\n\ndouble getentry(int j, int k){\n    j--;k--;\n\n    assert(typ == 'F' || typ == 'U' || typ == 'L');\n    assert(k&lt;n &amp;&amp; j&lt;n);\n\n    if(typ == 'F') return mat[k*n+j];\n    if(typ == 'L') return (k&gt;j)?(0.0):(mat[k*n+j-sum(k)]);  \n    if(typ == 'U') return (j&gt;k)?(0.0):( mat[k*n+j-sum(n-1)+sum(n-(k+1))]);\n}\n</code></pre>\n\n<p>I specifically dont understand this lines:</p>\n\n<pre><code>if(typ == 'L') return (k&gt;j)?(0.0):(mat[k*n+j-sum(k)]);  \n    if(typ == 'U') return (j&gt;k)?(0.0):( mat[k*n+j-sum(n-1)+sum(n-(k+1))]);\n</code></pre>\n\n<p>But I would appreciate it if you could explain this line as well:</p>\n\n<pre><code>if(typ == 'F') return mat[k*n+j];\n</code></pre>\n"}, {"tags": ["c++", "visual-studio-2015"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 2, "creation_date": 1513790032, "post_id": 47911154, "comment_id": 82789900, "body": "Place this include  #include &quot;Test.h&quot; after this #include &quot;stdafx.h&quot;"}, {"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 2, "creation_date": 1513790092, "post_id": 47911154, "comment_id": 82789949, "body": "Visual studio does not compile anything before <code>#include &quot;stdafx.h&quot;</code>, if using precompiled headers."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1513790239, "post_id": 47911154, "comment_id": 82790023, "body": "The problem is that VS defaults to using the &quot;precompiled headers&quot; feature of Visual C++, which makes the preprocessor behave in decidedly non-standard ways. One fix is as @VladfromMoscow notes, to let the precompiled header (here <code>&quot;stdafx.h&quot;</code>) be the first include in every implementation file. A better solution is to just <b>turn off precompiled headers</b> in the project settings. Right-click project \u2192 Properties \u2192 turn it off. There."}, {"owner": {"reputation": 864, "user_id": 3410340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/520663230/picture?type=large", "display_name": "Steve W", "link": "https://stackoverflow.com/users/3410340/steve-w"}, "edited": false, "score": 0, "creation_date": 1513790534, "post_id": 47911154, "comment_id": 82790166, "body": "Really? That was it... Well I did say it must be simple. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 361, "user_id": 8938102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c207b96c33460d9798c119aba223564?s=128&d=identicon&r=PG&f=1", "display_name": "Mixhab", "link": "https://stackoverflow.com/users/8938102/mixhab"}, "is_accepted": true, "score": 0, "last_activity_date": 1513791136, "last_edit_date": 1513791136, "creation_date": 1513790487, "answer_id": 47911323, "question_id": 47911154, "link": "https://stackoverflow.com/questions/47911154/using-a-c-class-in-visual-studio-undeclared-identifier-error/47911323#47911323", "title": "Using a C++ Class in Visual Studio - undeclared identifier error", "body": "<p>The problem is that <code>\"stdafx.h\"</code> is pre-compiled.\nVisual c++ will not compile anything before the <code>#include \"stdafx.h\"</code> in the source file, unless the compile option <code>/Yu'stdafx.h'</code> is unchecked (by default); it assumes all code in the source up to and including that line is already compiled.</p>\n\n<p>The solution is to move it to be the first <code>include</code>.</p>\n\n<p>You can read more about it in the wiki page of <a href=\"https://en.wikipedia.org/wiki/Precompiled_header\" rel=\"nofollow noreferrer\">Precompiled header</a>. </p>\n"}], "owner": {"reputation": 864, "user_id": 3410340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/520663230/picture?type=large", "display_name": "Steve W", "link": "https://stackoverflow.com/users/3410340/steve-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1549, "favorite_count": 0, "closed_date": 1513799747, "accepted_answer_id": 47911323, "answer_count": 1, "score": 2, "last_activity_date": 1513791136, "creation_date": 1513789891, "question_id": 47911154, "link": "https://stackoverflow.com/questions/47911154/using-a-c-class-in-visual-studio-undeclared-identifier-error", "closed_reason": "Duplicate", "title": "Using a C++ Class in Visual Studio - undeclared identifier error", "body": "<p>I expect this is incredibly simple but can't for the life of me figure out whats wrong. I'm new to C++ and I've created a C++ class in visual studio and am trying to use it in the main method of another file. I've stripped everything back to the bare minimum but still I can't get it to run. The first compile error I get is 'Test': undeclared identifier. If I remove 'Test test;' from App.cpp it all compiles fine.\nBelow is the code. Can anybody help?</p>\n\n<p>App.cpp:</p>\n\n<pre><code>#include \"Test.h\"\n#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;fstream&gt;\n\nusing namespace std;\n\nint main()\n{\n    Test test;\n    //cout &lt;&lt; test.getNumber() &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>Test.h:</p>\n\n<pre><code>#pragma once\nclass Test\n{\nprivate:\n    int number;\n\npublic:\n    int getNumber();\n    Test();\n    ~Test();\n};\n</code></pre>\n\n<p>Test.cpp:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"Test.h\"\n\n\nint Test::getNumber()\n{\n    return number;\n}\n\nTest::Test()\n{\n    this-&gt;number = 1;\n}\n\n\nTest::~Test()\n{\n}\n</code></pre>\n"}, {"tags": ["c++", "pointers", "unhandled-exception"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1513789963, "post_id": 47911098, "comment_id": 82789866, "body": "What exactly does readPPM return?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1513790021, "post_id": 47911098, "comment_id": 82789895, "body": "<code>outputImage = new Image(3264, 2448);</code> then <code>outputImage-&gt;pixels = new Image::Rgb[3264, 2448];</code> seems like a design flaw here. Why didn&#39;t the constructor for Image create the buffer?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1513790224, "post_id": 47911098, "comment_id": 82790016, "body": "<code>resize</code> and <code>push_back</code> is an unhealthy combination. Did you mean <code>reserve</code>?"}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1513791564, "post_id": 47911098, "comment_id": 82790711, "body": "<code>inputImages[0]</code> till <code>inputImages[13]</code> are empty, their <code>pixels</code> members are <code>nullptr</code>. You got it with <code>resize(13)</code> and then continued to push images into the vector starting from 14."}, {"owner": {"reputation": 31, "user_id": 5980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7395e06e2ed9c0d3c7b1a11e86510166?s=128&d=identicon&r=PG", "display_name": "newbie123", "link": "https://stackoverflow.com/users/5980490/newbie123"}, "reply_to_user": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1513792213, "post_id": 47911098, "comment_id": 82791054, "body": "I&#39;m not sure I understand @S.M. can you suggest a fix?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1513792245, "post_id": 47911098, "comment_id": 82791071, "body": "Your code is incomplete; in particular, it seems to be missing a <code>main()</code> function and at least one <code>#include</code>. Please <a href=\"https://stackoverflow.com/posts/47911098/edit\">edit</a> your code so it&#39;s a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your problem, then we can try to reproduce and solve it. You should also read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1513792378, "post_id": 47911098, "comment_id": 82791140, "body": "@newbie123 Remove the line <code>inputImages.resize(13);</code> or replace it with <code>inputImages.reserve(13);</code>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513792493, "post_id": 47911098, "comment_id": 82791193, "body": "@newbie123 -- <code>inputImages.resize(13);</code> -- Then your next <code>for</code> loop does this on the last iteration:  <code>inputImages[13] = readPPM...</code>.  This is an out-of-bounds access.  Anything else after that line becomes a moot point, since you&#39;ve already invoked undefined behavior.  Indices in C++ start at <code>0</code>, not <code>1</code>.  If you&#39;re trying to fake 1-based arrays, stop doing this.  Start your array indexing at 0."}, {"owner": {"reputation": 31, "user_id": 5980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7395e06e2ed9c0d3c7b1a11e86510166?s=128&d=identicon&r=PG", "display_name": "newbie123", "link": "https://stackoverflow.com/users/5980490/newbie123"}, "reply_to_user": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1513792565, "post_id": 47911098, "comment_id": 82791241, "body": "When I do that I get a Debug error: Expression: Vector subscript out of range @S.M."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1513792784, "post_id": 47911098, "comment_id": 82791361, "body": "@newbie123 -- <code>Vector subscript out of range</code>.  That is because you resized the vector to hold 13 items, and your very first <code>for</code> loop attempts to access inputImages[13], which is out-of-bounds.  Indices range from <code>0</code> to <code>n-1</code> where <code>n</code> is the number of entries.  Don&#39;t know how much simpler to state this."}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1513792796, "post_id": 47911098, "comment_id": 82791369, "body": "@newbie123 Try loop x from 0 till 13, not from 1 till 14. And iterate i from 0 till 13 too, not till 12."}, {"owner": {"reputation": 31, "user_id": 5980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7395e06e2ed9c0d3c7b1a11e86510166?s=128&d=identicon&r=PG", "display_name": "newbie123", "link": "https://stackoverflow.com/users/5980490/newbie123"}, "edited": false, "score": 0, "creation_date": 1513793287, "post_id": 47911098, "comment_id": 82791603, "body": "I have made the changes to iterators and removed inputImages.resize(13); and that now works without Vector subscript out of range. But I&#39;m still getting the Unhandled exception error."}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 1, "creation_date": 1513793600, "post_id": 47911098, "comment_id": 82791756, "body": "@newbie123 Do you not see the error here <code>new Image::Rgb[3264, 2448];</code>?"}, {"owner": {"reputation": 31, "user_id": 5980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7395e06e2ed9c0d3c7b1a11e86510166?s=128&d=identicon&r=PG", "display_name": "newbie123", "link": "https://stackoverflow.com/users/5980490/newbie123"}, "reply_to_user": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1513793652, "post_id": 47911098, "comment_id": 82791787, "body": "@S.M. No I&#39;m afraid"}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1513793703, "post_id": 47911098, "comment_id": 82791818, "body": "@newbie123 Try to replace the comma with the asterisk."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1513794023, "post_id": 47911098, "comment_id": 82791948, "body": "Please learn <a href=\"http://en.cppreference.com/w/cpp/language/raii\" rel=\"nofollow noreferrer\">RAII</a> you will save yourself much pain"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1513794219, "post_id": 47911098, "comment_id": 82792029, "body": "@newbie123 -- <code>new Image::Rgb[3264, 2448];</code> -- In your words or understanding, what does this do, or what is it supposed to do?   Have you seen any usage of <code>new []</code> in a book, tutorial, etc. looking like that line?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1513794340, "post_id": 47911098, "comment_id": 82792085, "body": "Why does the constructor for Image take rows and columns if it does not allocate the pixel buffer?"}, {"owner": {"reputation": 31, "user_id": 5980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7395e06e2ed9c0d3c7b1a11e86510166?s=128&d=identicon&r=PG", "display_name": "newbie123", "link": "https://stackoverflow.com/users/5980490/newbie123"}, "edited": false, "score": 0, "creation_date": 1513794428, "post_id": 47911098, "comment_id": 82792129, "body": "Hold up I think It will probably help If I copy in all the code"}, {"owner": {"reputation": 31, "user_id": 5980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7395e06e2ed9c0d3c7b1a11e86510166?s=128&d=identicon&r=PG", "display_name": "newbie123", "link": "https://stackoverflow.com/users/5980490/newbie123"}, "edited": false, "score": 0, "creation_date": 1513794942, "post_id": 47911098, "comment_id": 82792389, "body": "Edited OP to show everything"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1513795221, "post_id": 47911098, "comment_id": 82792502, "body": "@newbie123 Advice -- Your copy/assignment operator for <code>Image</code> fails miserably if 1)  self-assignment is done and 2) if <code>new</code> throws an exception.  Use the <code>copy &#47; swap</code> idiom instead."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1513800006, "post_id": 47911098, "comment_id": 82794722, "body": "In your loop you should be doing this:   <code>inputImages.push_back(readPPM(std::string(&quot;Images&#47;ImageStack&zwnj;&#8203;er_set1&#47;IMG_&quot; + std::to_string(x) + &quot;.ppm&quot;).c_str());</code>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1513800046, "post_id": 47911098, "comment_id": 82794743, "body": "Also delete this line it is both wrong and if it was correct it would leak memory unnecessarily since your constructor already allocates pixels: <code>outputImage-&gt;pixels = new Image::Rgb[3264, 2448];</code>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1513800154, "post_id": 47911098, "comment_id": 82794794, "body": "Also delete <code>inputImages.resize(13);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": false, "score": 0, "last_activity_date": 1513793477, "last_edit_date": 1513793477, "creation_date": 1513792260, "answer_id": 47911742, "question_id": 47911098, "link": "https://stackoverflow.com/questions/47911098/unhandled-exception-access-violation-writing-location/47911742#47911742", "title": "Unhandled exception Access violation writing location", "body": "<p>There's some level of bad here. But I believe at the core you meant to write:</p>\n\n<pre><code>inputImages[x] = Image(3264, 2448);\ninputImages[x].pixels = readPPM(std::string(\"Images/ImageStacker_set1/IMG_\" + std::to_string(x) + \".ppm\").c_str());\n</code></pre>\n\n<hr>\n\n<p>Stepping through your code:</p>\n\n<ul>\n<li><code>std::vector&lt;Image&gt; inputImages</code> - Leaves <code>inputImages</code> with a size of 0</li>\n<li><code>inputImages.resize(13);</code> - Leaves <code>inputImages</code> with a size of 13 default constructed <code>Image</code>s</li>\n<li><code>inputImages.push_back(Image(3264, 2448));</code> - Increments the size of <code>inputImages</code> by 1 by adding a default image onto the tail end, ultimately increasing the size of <code>inputImages</code> to 26</li>\n<li><code>inputImages[x] = readPPM(std::string(\"Images/ImageStacker_set1/IMG_\" + std::to_string(x) + \".ppm\").c_str());</code> - Modifies one of the default constructed <code>Image</code>s in <code>inputImages</code>' [1 - 12] then finally modifies the first <code>Image(3264, 2448)</code> in <code>inputImages</code></li>\n</ul>\n\n<p>This means that at a minimum you have 13 <code>Image(3264, 2448)</code> objects that are never accessed. The 1<sup>st</sup> element that is accessed by the code in question, <code>inputImage[0]</code> is a default constructed <code>Image</code>. And unless <code>readPPM</code> returns an <code>Image</code> with an allocated <code>pixels</code> field, there are no <code>Images</code> in <code>inputImages</code> [1 - 12] range which can support access to their <code>pixels</code> field.</p>\n"}], "owner": {"reputation": 31, "user_id": 5980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7395e06e2ed9c0d3c7b1a11e86510166?s=128&d=identicon&r=PG", "display_name": "newbie123", "link": "https://stackoverflow.com/users/5980490/newbie123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 396, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513794896, "creation_date": 1513789643, "last_edit_date": 1513794896, "question_id": 47911098, "link": "https://stackoverflow.com/questions/47911098/unhandled-exception-access-violation-writing-location", "title": "Unhandled exception Access violation writing location", "body": "<p>When I compile my program I get this unhandled exception that I don't understand or know how to fix.</p>\n\n<blockquote>\n  <p>Exception thrown at 0x00007FF6DFF937FE in My\n  Code.exe: 0xC0000005: Access violation writing location\n  0x000002E07396F000.</p>\n  \n  <p>If there is a handler for this exception, the program may be safely\n  continued.</p>\n</blockquote>\n\n<pre><code>//main.cpp\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;algorithm&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n#include \"Image.h\"\n\nImage readPPM(const char* file);\nvoid writePPM(const Image &amp;img, const char* file);\n\nint main()\n{\n\nstd::vector&lt;Image&gt; inputImages;\ninputImages.resize(13);\nImage *outputImage;\n\nfor (int x = 1; x &lt; 14; x++)\n{\n    inputImages.push_back(Image(3264, 2448));\n    inputImages[x] = readPPM(std::string(\"Images/ImageStacker_set1/IMG_\" + std::to_string(x) + \".ppm\").c_str());\n}\n\noutputImage = new Image(3264, 2448);\noutputImage-&gt;pixels = new Image::Rgb[3264, 2448];\n\nfor (int x = 0; x &lt; 3264 * 2448; x++) {\n    float sumR = 0.f;\n    float sumG = 0.f;\n    float sumB = 0.f;\n\n    for (int i = 0; i &lt; 12; i++) {\n        sumR += inputImages[i].pixels[x].r;\n        sumG += inputImages[i].pixels[x].g;\n        sumB += inputImages[i].pixels[x].b;\n    }\n\n    outputImage-&gt;pixels[x].r = sumR / 13;\n    outputImage-&gt;pixels[x].g = sumG / 13;\n    outputImage-&gt;pixels[x].b = sumB / 13;\n}\n\n\nwritePPM(*outputImage, \"testPPM.ppm\");\n\nreturn 0;\n}\n\nImage readPPM(const char *filename)\n{\n    //Remove this cout to prevent multiple outputs\n    std::cout &lt;&lt; \"Reading image ...\" &lt;&lt; std::endl;\n    std::ifstream ifs;\n    ifs.open(filename, std::ios::binary);\n    Image src;\n    try {\n        if (ifs.fail()) {\n            throw(\"Can't open the input file - is it named correctly/is it in the right directory?\");\n    }\n    std::string header;\n    int w, h, b;\n    ifs &gt;&gt; header;\n    if (strcmp(header.c_str(), \"P6\") != 0) throw(\"Can't read the input file - is it in binary format (Has P6 in the header)?\");\n    ifs &gt;&gt; w &gt;&gt; h &gt;&gt; b;\n    src.w = w;\n    src.h = h;\n    //std::cout &lt;&lt; w &lt;&lt; \" \" &lt;&lt; h &lt;&lt; std::endl;\n    src.pixels = new Image::Rgb[w * h]; // this is throw an exception if bad_alloc \n    ifs.ignore(256, '\\n'); // skip empty lines in necessary until we get to the binary data \n    unsigned char pix[3]; // read each pixel one by one and convert bytes to floats \n    for (int i = 0; i &lt; w * h; ++i) {\n        ifs.read(reinterpret_cast&lt;char *&gt;(pix), 3);\n        src.pixels[i].r = pix[0] / 255.f;\n        src.pixels[i].g = pix[1] / 255.f;\n        src.pixels[i].b = pix[2] / 255.f;\n    }\n    ifs.close();\n}\ncatch (const char *err) {\n    fprintf(stderr, \"%s\\n\", err);\n    ifs.close();\n}\n\n//Confirm image read\n//Delete this to prevent multiple lines output\nstd::cout &lt;&lt; \"Image read\" &lt;&lt; std::endl;\nreturn src;\n}\n\n//Write data out to a ppm file\n//Constructs the header as above\nvoid writePPM(const Image &amp;img, const char *filename)\n{\n//std::cout &lt;&lt; filename &lt;&lt; std::endl;\nstd::cout &lt;&lt; \"Writing image ...\" &lt;&lt; std::endl;\nif (img.w == 0 || img.h == 0) { fprintf(stderr, \"Can't save an empty image\\n\"); return; }\nstd::ofstream ofs;\ntry {\n    ofs.open(filename, std::ios::binary); // need to spec. binary mode for Windows users \n    if (ofs.fail()) throw(\"Can't open output file\");\n    ofs &lt;&lt; \"P6\\n\" &lt;&lt; img.w &lt;&lt; \" \" &lt;&lt; img.h &lt;&lt; \"\\n255\\n\";\n    //std::cout &lt;&lt; \"P6\\n\" &lt;&lt; img.w &lt;&lt; \" \" &lt;&lt; img.h &lt;&lt; \"\\n255\\n\";\n    unsigned char r, g, b;\n    // loop over each pixel in the image, clamp and convert to byte format\n    for (int i = 0; i &lt; img.w * img.h; ++i) {\n        r = static_cast&lt;unsigned char&gt;(std::min(1.f, img.pixels[i].r) * 255);\n        g = static_cast&lt;unsigned char&gt;(std::min(1.f, img.pixels[i].g) * 255);\n        b = static_cast&lt;unsigned char&gt;(std::min(1.f, img.pixels[i].b) * 255);\n        ofs &lt;&lt; r &lt;&lt; g &lt;&lt; b;\n    }\n    ofs.close();\n    //Confirm image write\n    std::cout &lt;&lt; \"Image written\" &lt;&lt; std::endl;\n}\ncatch (const char *err) {\n    fprintf(stderr, \"%s\\n\", err);\n    ofs.close();\n    }\n}\n</code></pre>\n\n<p>Image.h</p>\n\n<pre><code>#pragma once\n//*********************************************\n//Image class to hold and allow manipulation of images once read into the \ncode\n//from https://www.scratchapixel.com/\n//*********************************************\n#include &lt;cstdlib&gt; \n#include &lt;cstdio&gt;\n\nclass Image\n{\npublic:\n    // Rgb structure, i.e. a pixel \n    struct Rgb\n    {\n        Rgb() : r(0), g(0), b(0) {}\n        Rgb(float c) : r(c), g(c), b(c) {}\n        Rgb(float _r, float _g, float _b) : r(_r), g(_g), b(_b) {}\n        bool operator != (const Rgb &amp;c) const\n        {\n            return c.r != r || c.g != g || c.b != b;\n        }\n        Rgb&amp; operator *= (const Rgb &amp;rgb)\n        {\n            r *= rgb.r, g *= rgb.g, b *= rgb.b; return *this;\n        }\n        Rgb&amp; operator += (const Rgb &amp;rgb)\n        {\n            r += rgb.r, g += rgb.g, b += rgb.b; return *this;\n        }\n        friend float&amp; operator += (float &amp;f, const Rgb rgb)\n        {\n            f += (rgb.r + rgb.g + rgb.b) / 3.f; return f;\n        }\n        float r, g, b;\n    };\n\n     Image() : w(0), h(0), pixels(nullptr) { /* empty image */ }\n     Image(const unsigned int &amp;_w, const unsigned int &amp;_h, const Rgb &amp;c = \n kBlack) :\n        w(_w), h(_h), pixels(NULL)\n    {\n        pixels = new Rgb[w * h];\n        for (int i = 0; i &lt; w * h; ++i)\n            pixels[i] = c;\n    }\n    //copy constructor\n    Image(const Image &amp;im)\n    {\n        w = im.w;\n        h = im.h;\n        pixels = new Rgb[im.w * im.h];\n        for (int i = 0; i &lt; im.w * im.h; ++i)\n            pixels[i] = im.pixels[i];\n    }\n    //copy assignment operator\n    Image&amp; operator=(const Image&amp; other)\n    {\n        w = other.w;\n        h = other.h;\n        pixels = new Rgb[other.w * other.h];\n        for (int i = 0; i &lt; other.w * other.h; ++i)\n             pixels[i] = other.pixels[i];\n\n        return *this;\n\n    }\n    const Rgb&amp; operator [] (const unsigned int &amp;i) const\n    {\n        return pixels[i];\n    }\n    Rgb&amp; operator [] (const unsigned int &amp;i)\n    {\n        return pixels[i];\n    }\n    ~Image()\n    {\n        if (pixels != NULL) delete[] pixels;\n        //delete[] pixels;\n    }\n    //unsigned int w, h; // Image resolution \n    int w, h; // Image resolution\n    Rgb *pixels; // 1D array of pixels \n    static const Rgb kBlack, kWhite, kRed, kGreen, kBlue; // Preset colors \n};\n\nconst Image::Rgb Image::kBlack = Image::Rgb(0);\nconst Image::Rgb Image::kWhite = Image::Rgb(1);\nconst Image::Rgb Image::kRed = Image::Rgb(1, 0, 0);\nconst Image::Rgb Image::kGreen = Image::Rgb(0, 1, 0);\nconst Image::Rgb Image::kBlue = Image::Rgb(0, 0, 1);\n</code></pre>\n\n<p>Here's the code that appears to be causing the problem. When debugging it seems to be that there's something wrong with the pointers here:</p>\n\n<pre><code>outputImage-&gt;pixels[x].r = sumR / 13;\noutputImage-&gt;pixels[x].g = sumG / 13;\noutputImage-&gt;pixels[x].b = sumB / 13;\n</code></pre>\n\n<p>Sorry I can't really provide anything else to go on but I have never had an error like this before so I don't know where to start in fixing it.</p>\n"}, {"tags": ["c++", "arrays", "sorting", "heapsort"], "answers": [{"tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1513790224, "creation_date": 1513790224, "answer_id": 47911240, "question_id": 47911066, "link": "https://stackoverflow.com/questions/47911066/counting-number-of-copying-and-comparisons-in-heapsort-and-insertation-sort/47911240#47911240", "title": "Counting number of copying and comparisons in heapsort and insertation sort", "body": "<p>No</p>\n\n<blockquote>\n<pre><code>    if (l &lt; n &amp;&amp; arr[l] &gt; arr[largest])\n        largest = l;\n        ps+=1;\n</code></pre>\n</blockquote>\n\n<p>There are two problems here.  Assuming you are talking about double comparisons (rather than integer), the comparison may or may not occur. \n Secondly your indentation is deeply misleading.  (You <em>always</em> increment.) \n You need</p>\n\n<pre><code>    if (l &lt; n) {\n        ps++;  // About to compare\n        if (arr[l] &gt; arr[largest])\n            largest = l;\n    }\n</code></pre>\n\n<p>There are probably other errors, but it is impossible to tell because I can't read your language, so the printed text, comments, and names are meaningless.</p>\n\n<p>Given you are writing in C++, I would write a class with <code>operator &lt;()</code> and <code>operator =</code>, and a copy constructor, and instrument those.  That way you cannot <em>possibly</em> get it wrong.</p>\n"}], "owner": {"reputation": 9, "user_id": 9010095, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ba169646e1c174c4b3759f785501d017?s=128&d=identicon&r=PG&f=1", "display_name": "whaHa", "link": "https://stackoverflow.com/users/9010095/whaha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 773, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513790224, "creation_date": 1513789504, "last_edit_date": 1513789632, "question_id": 47911066, "link": "https://stackoverflow.com/questions/47911066/counting-number-of-copying-and-comparisons-in-heapsort-and-insertation-sort", "title": "Counting number of copying and comparisons in heapsort and insertation sort", "body": "<p>I want to count how many times does algorithm makes comparisons and how many times algorithm makes copying. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;random&gt;\n#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;time.h&gt;\n\n\nvoid generuoti(int _N, const char *_file);\nvoid nuskaityti(const char *_file);\nint ps = 0;\nint ks = 0;\nvoid heapify(double arr[], int n, int i)\n{\n    int largest = i;  // Initialize largest as root\n    int l = 2 * i + 1;  // left = 2*i + 1\n    int r = 2 * i + 2;  // right = 2*i + 2\n\n\n    // If left child is larger than root\n    if (l &lt; n &amp;&amp; arr[l] &gt; arr[largest])\n        largest = l;\n        ps+=1;\n\n    // If right child is larger than largest so far\n    if (r &lt; n &amp;&amp; arr[r] &gt; arr[largest])\n        largest = r;\n        ps += 1;\n    // If largest is not root\n    if (largest != i)\n    {\n        std::swap(arr[i], arr[largest]);\n        ps += 1;\n        ks += 1;\n        // Recursively heapify the affected sub-tree\n        heapify(arr, n, largest);\n    }\n}\n\n// pagr funkcija haep sortui\nvoid heapSort(double arr[], int n)\n{\n    // Build heap (rearrange array)\n    for (int i = n / 2 - 1; i &gt;= 0; i--)\n        heapify(arr, n, i);\n\n    // One by one extract an element from heap\n    for (int i = n - 1; i &gt;= 0; i--)\n    {\n        // Move current root to end\n        std::swap(arr[0], arr[i]);\n        ks+=1;\n\n        // call max heapify on the reduced heap\n        heapify(arr, i, 0);\n    }\n}\n\nvoid insertion_sort(double arr[], int n)\n{\n    int i, key, j;\n    for (i = 1; i &lt; n; i++)\n    {\n        key = arr[i];\n        j = i - 1;\n        ks+=1;\n\n        while (j &gt;= 0 &amp;&amp; arr[j] &gt; key)\n        {\n            arr[j + 1] = arr[j];\n            j = j - 1;\n            ks+=1;\n            ps+=1;\n        }\n        arr[j + 1] = key;\n            ks+=1;\n    }\n}\n\nusing namespace std;\n\ndouble *Data;\ndouble* A;\ndouble* B;\ndouble N;\n\n\n\nint main()\n{\n    srand(time(NULL));\n    cout &lt;&lt; \"Generuojame atsitktinius duomenis\" &lt;&lt; endl;\n    generuoti(20000, \"duom.txt\");\n    cout &lt;&lt; \"Nuskaitome duomenis\" &lt;&lt; endl;\n    nuskaityti(\"duom.txt\");\n    A = new double[(int)N];\n    B = new double[(int)N];//jeigu algoritmui reikia papildomo masyvo\n    for (int i = 0; i &lt; N; i++) {\n        A[i] = Data[i];\n    }\n\n    cout &lt;&lt; \"Pradine skaiciu seka:\" &lt;&lt; endl;\n    for (int i = 0; i &lt; N; i++)\n        cout &lt;&lt; A[i] &lt;&lt; \" \";\n    cout &lt;&lt; endl;\n    //\n\n\n    insertion_sort(A, N);\n    //heapSort(A, N);\n\n    //truksta veiksmu sk\n    cout &lt;&lt; \"Surusiuota skaiciu seka:\" &lt;&lt; endl;\n    for (int i = 0; i &lt; N; i++)\n        cout &lt;&lt; A[i] &lt;&lt; \" \";\n    cout &lt;&lt; endl;\n    cout &lt;&lt; \"Kopijavimu skaicius \" &lt;&lt; ks &lt;&lt; endl;\n    cout &lt;&lt; \"Palyginimu skaicius \" &lt;&lt; ps &lt;&lt; endl;\n    system(\"pause\");\n    return 0;\n}\n\nvoid generuoti(int _n, const char *_file) {\n    ofstream os(_file);\n    os &lt;&lt; _n &lt;&lt; endl;\n    for (int i = 0; i&lt;_n; i++)\n        os &lt;&lt; \" \" &lt;&lt; 500+ (double)(rand() % 3001) ;\n    os.close();\n}\n\nvoid nuskaityti(const char *_file) {\n    ifstream is(_file);\n    if (is.fail()) {\n        cout &lt;&lt; \"Failo nera\" &lt;&lt; endl;\n        exit(1);\n    }\n    is &gt;&gt; N;\n    Data = new double[(int)N];\n    for (int i = 0; i &lt; N; i++) {\n        is &gt;&gt; Data[i];\n    }\n}\n</code></pre>\n\n<p>This is my code,  and ps - is equal to a number of comparisons, and ks - is equal to number of copying. I want to ask if I counted all comparisons and all copying in the algorithms? Thanks for answers. </p>\n"}, {"tags": ["c++", "video", "libx264"], "comments": [{"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513789968, "post_id": 47911047, "comment_id": 82789871, "body": "What is <code>Camera</code> please? Are you using some other library?"}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513790107, "post_id": 47911047, "comment_id": 82789952, "body": "I am not sure what you are expecting - if you tell <code>libx264</code> to set a play rate of 25 fps and pass it 250 frames, you will get a 10 second long video, but if your camera takes 1/10 second to acquire each frame, it will take 25 seconds to acquire the necessary frames."}, {"owner": {"reputation": 293, "user_id": 7345868, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a3254b29a2a99f19e2de5b5ac404258c?s=128&d=identicon&r=PG&f=1", "display_name": "Iceman", "link": "https://stackoverflow.com/users/7345868/iceman"}, "reply_to_user": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513790217, "post_id": 47911047, "comment_id": 82790010, "body": "@MarkSetchell, <code>Camera</code> is my own wrapper on Windows native vfw32, but it does not matter, OpenCV gives same latency. You can see on screenshot, that the capture takes 1453 ms, and the video is 1 sec. I&#39;m expecting the same length of video as a capture takes"}, {"owner": {"reputation": 293, "user_id": 7345868, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a3254b29a2a99f19e2de5b5ac404258c?s=128&d=identicon&r=PG&f=1", "display_name": "Iceman", "link": "https://stackoverflow.com/users/7345868/iceman"}, "reply_to_user": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513790613, "post_id": 47911047, "comment_id": 82790214, "body": "@MarkSetchell, Also I&#39;m not sure about parameters I use - for example what is <code>X264_RC_CRF</code>, <code>f_rf_constant</code> (I took this parameters block somewhere on SO)?"}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 1, "creation_date": 1513794960, "post_id": 47911047, "comment_id": 82792396, "body": "If you want to capture 25 frames in 1 second, you can a) improve the lighting (brighter) so your exposures are shorter, or b) accumulate the 25 frames in RAM and write to disk later aftee capture, or c) multithread your code, or some mixture."}, {"owner": {"reputation": 293, "user_id": 7345868, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a3254b29a2a99f19e2de5b5ac404258c?s=128&d=identicon&r=PG&f=1", "display_name": "Iceman", "link": "https://stackoverflow.com/users/7345868/iceman"}, "reply_to_user": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513843795, "post_id": 47911047, "comment_id": 82808582, "body": "@MarkSetchell, option b is most suitable for my purposes. Thanks for advice"}], "owner": {"reputation": 293, "user_id": 7345868, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a3254b29a2a99f19e2de5b5ac404258c?s=128&d=identicon&r=PG&f=1", "display_name": "Iceman", "link": "https://stackoverflow.com/users/7345868/iceman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513789416, "creation_date": 1513789416, "question_id": 47911047, "link": "https://stackoverflow.com/questions/47911047/how-to-set-variable-fps-in-libx264-and-what-encoder-parameters-to-use", "title": "How to set variable FPS in libx264 and what encoder parameters to use?", "body": "<p>I'm trying to encode a webcam frames with libx264 in realtime, and face with one problem - the resulting video length is exactly what I set, but camera is delays somtimes and the real capture time is more than video length. As a result the picture in video changes to fast.<br>I think it is due to constant FPS in x264 settings, so I need to make it dynamic somehow. Is it possible? If I wrong about FPS, so what I need to do, to synchronize capturing and writing?</p>\n\n<p>Also I would like to know what are the optimal encoder parameters for streaming via internet and for recording to disk (the client is streaming from camera or screen, and the server is recording)?</p>\n\n<p>Here is console logs screenshot and my code:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include \"stringf.h\"\n#include \"Capture.h\"\n#include \"x264.h\"\n\nint main( int argc, char **argv ){\n    Camera instance;\n    if(!instance.Enable(0)){printf(\"Camera not available\\n\");return 1;}\n    // Initializing metrics and buffer of frame\n    unsigned int width, height, size = instance.GetMetrics(width, height);\n    unsigned char *data = (unsigned char *)malloc(size);\n    // Setting encoder (I'm not sure about all parameters)\n    x264_param_t param;\n    x264_param_default_preset(&amp;param, \"ultrafast\", \"zerolatency\");\n    param.i_threads = 1;\n    param.i_width = width;\n    param.i_height = height;\n    param.i_fps_num = 20;\n    param.i_fps_den = 1;\n    // Intra refres:\n    param.i_keyint_max = 8;\n    param.b_intra_refresh = 1;\n    // Rate control:\n    param.rc.i_rc_method = X264_RC_CRF;\n    param.rc.f_rf_constant = 25;\n    param.rc.f_rf_constant_max = 35;\n    // For streaming:\n    param.b_repeat_headers = 1;\n    param.b_annexb = 1;\n\n    x264_param_apply_profile(&amp;param, \"baseline\");\n    x264_t* encoder = x264_encoder_open(&amp;param);\n\n    int seconds, expected_time, operation_start, i_nals, frame_size, frames_count;\n    expected_time = 1000/param.i_fps_num;\n    operation_start = 0;\n    seconds = 1;\n    frames_count = param.i_fps_num * seconds;\n    int *Timings = new int[frames_count];\n\n    x264_picture_t pic_in, pic_out;\n    x264_nal_t* nals;\n    x264_picture_alloc(&amp;pic_in, X264_CSP_I420, param.i_width, param.i_height);\n    // Capture-Encode-Write loop\n    for(int i = 0; i &lt; frames_count; i++){\n        operation_start = GetTickCount();\n        size = instance.GrabBGR(&amp;data);\n        instance.BGRtoI420(data, &amp;pic_in.img.plane[0], &amp;pic_in.img.plane[1], &amp;pic_in.img.plane[2], param.i_width, param.i_height);\n        frame_size = x264_encoder_encode(encoder, &amp;nals, &amp;i_nals, &amp;pic_in, &amp;pic_out);\n        if( frame_size &gt; 0){\n            stringf::WriteBufferToFile(\"test.h264\",std::string(reinterpret_cast&lt;char*&gt;(nals-&gt;p_payload), frame_size),1);\n        }\n        Timings[i] = GetTickCount() - operation_start;\n    }\n    while( x264_encoder_delayed_frames( encoder ) ){ // Flush delayed frames\n        frame_size = x264_encoder_encode(encoder, &amp;nals, &amp;i_nals, NULL, &amp;pic_out);\n        if( frame_size &gt; 0 ){stringf::WriteBufferToFile(\"test.h264\",std::string(reinterpret_cast&lt;char*&gt;(nals-&gt;p_payload), frame_size),1);}\n    }\n    unsigned int total_time = 0;\n    printf(\"Expected operation time was %d ms per frame at %u FPS\\n\",expected_time, param.i_fps_num);\n    for(unsigned int i = 0; i &lt; frames_count; i++){\n        total_time += Timings[i];\n        printf(\"Frame %u takes %d ms\\n\",(i+1), Timings[i]);\n    }\n    printf(\"Record takes %u ms\\n\",total_time);\n    free(data);\n    x264_encoder_close( encoder );\n    x264_picture_clean( &amp;pic_in );\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/CdMuD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CdMuD.jpg\" alt=\"log_x264\"></a>\nThe capture takes 1453 ms and the output file plays exactly 1 sec.</p>\n\n<p>So, in general, the video length must be the same as a capture time, but not as encoder \"wants\".<br>How to do it?</p>\n"}, {"tags": ["c++", "binary", "integer"], "comments": [{"owner": {"reputation": 4569, "user_id": 1282773, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/GFxGD.jpg?s=128&g=1", "display_name": "ivaigult", "link": "https://stackoverflow.com/users/1282773/ivaigult"}, "edited": false, "score": 1, "creation_date": 1513792869, "post_id": 47910990, "comment_id": 82791404, "body": "You seem to forget to <code>os.flush()</code> after write operations."}], "answers": [{"comments": [{"owner": {"reputation": 50, "user_id": 6725548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fee5c3afe3b7b8dc09555255497c5538?s=128&d=identicon&r=PG&f=1", "display_name": "Retrogott", "link": "https://stackoverflow.com/users/6725548/retrogott"}, "edited": false, "score": 1, "creation_date": 1513796422, "post_id": 47912532, "comment_id": 82793061, "body": "Thanks for the Solution. and for the Comments. I thought that the Buffer will flushed always after the last use of the stream ... never mind"}], "tags": [], "owner": {"reputation": 8409, "user_id": 2001017, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/H0Z0x.jpg?s=128&g=1", "display_name": "Picaud Vincent", "link": "https://stackoverflow.com/users/2001017/picaud-vincent"}, "is_accepted": true, "score": 1, "last_activity_date": 1513798011, "last_edit_date": 1513798011, "creation_date": 1513795686, "answer_id": 47912532, "question_id": 47910990, "link": "https://stackoverflow.com/questions/47910990/save-class-with-integer-values-into-binary-file-with-stream-operator/47912532#47912532", "title": "Save Class with Integer Values into Binary File with Stream Operator &gt;&gt; / &lt;&lt;", "body": "<p>As noticed by @ivaigult you forgot to <a href=\"http://en.cppreference.com/w/cpp/io/manip/flush\" rel=\"nofollow noreferrer\">std::flush</a> your <code>ofstream</code>.\nTo complete my answer I have modified your code with some comments, that can be useful. IMHO the most important thing is to avoid to write things like:</p>\n\n<pre><code> os.write(reinterpret_cast&lt;const char *&gt;(&amp;time.hour),sizeof(int));\n</code></pre>\n\n<p>This is very dangerous because if you modify <code>time.hour</code> in your <code>Time</code> <strong>you have to remember</strong> to also modify <code>sizeof(int)</code> -> <code>sizeof(new type)</code>. If you forget that you typically get memory corruption bugs that are not funny to found afterward! With C++11 you can use <code>decltype(time.hour)</code>, this gives: like:</p>\n\n<pre><code>os.write(reinterpret_cast&lt;const char *&gt;(&amp;time.hour), sizeof(decltype(time.hour)));\n</code></pre>\n\n<p>Without further addo here is the modified working c++11 code with comments:</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n\nclass Time\n{\n public:\n  int hour;\n  int minute;\n  int second;\n\n  // *** would allow you to access protected members (if any)\n  //\n  friend std::ostream &amp;operator&lt;&lt;(std::ostream &amp;os, Time &amp;time);\n  friend std::istream &amp;operator&gt;&gt;(std::istream &amp;is, Time &amp;time);\n};\n\nstd::ostream &amp;operator&lt;&lt;(std::ostream &amp;os, Time &amp;time)\n{\n\n  // *** sizeof(in) -&gt; sizeof(decltype(time.hour)\n  // otherwise bug prone: if you modify the Time class, you have to remember to\n  //                      modify this function too!\n  os.write(reinterpret_cast&lt;const char *&gt;(&amp;time.hour), sizeof(decltype(time.hour)));\n  os.write(reinterpret_cast&lt;const char *&gt;(&amp;time.minute), sizeof(decltype(time.minute)));\n  os.write(reinterpret_cast&lt;const char *&gt;(&amp;time.second), sizeof(decltype(time.second)));\n  return os;\n}\n\nstd::istream &amp;operator&gt;&gt;(std::istream &amp;is, Time &amp;time)\n{\n\n  // *** ditto: bug prone\n  // + be consistent: if you use reinterpret_cast before, use it also here\n  // and not the C-style cast(char *)\n  is.read(reinterpret_cast&lt;char *&gt;(&amp;time.hour), sizeof(decltype(time.hour)));\n  is.read(reinterpret_cast&lt;char *&gt;(&amp;time.minute), sizeof(decltype(time.minute)));\n  is.read(reinterpret_cast&lt;char *&gt;(&amp;time.second), sizeof(decltype(time.second)));\n  return is;\n}\n\nint main()\n{\n  Time time;\n  time.hour = 24;\n  time.minute = 33;\n  time.second = 10;\n\n  // *** std::ios::binary is enough, std::ios::out is redundant with\n  //     std::_o_fstream\n  std::ofstream os(\"test.txt\", std::ios::binary);\n  os &lt;&lt; time;\n\n  // os.close(); or at least a flush\n  os.flush();\n\n  Time time2;\n  // *** ditto: std::ios::binary is enough\n  std::ifstream is(\"test.txt\", std::ios::binary);\n  is &gt;&gt; time2;\n  std::cout &lt;&lt; time2.hour &lt;&lt; \" \" &lt;&lt; time2.minute &lt;&lt; \" \" &lt;&lt; time2.second;\n}\n</code></pre>\n"}], "owner": {"reputation": 50, "user_id": 6725548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fee5c3afe3b7b8dc09555255497c5538?s=128&d=identicon&r=PG&f=1", "display_name": "Retrogott", "link": "https://stackoverflow.com/users/6725548/retrogott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 47912532, "answer_count": 1, "score": 3, "last_activity_date": 1513798011, "creation_date": 1513789216, "question_id": 47910990, "link": "https://stackoverflow.com/questions/47910990/save-class-with-integer-values-into-binary-file-with-stream-operator", "title": "Save Class with Integer Values into Binary File with Stream Operator &gt;&gt; / &lt;&lt;", "body": "<p>i have a probably pretty easy question.I saw already similiar question like this but all I tried doesn't work for my case. I'm trying to save a class with 3 different Integer Values into a binary file. I need to solve this about overloading the C++ stream Operator \"&lt;&lt;\"/ \">>\". So my actual Code seems to save the Integer Values as binary in my file but when i try to load them back from my binary file it just returns me a integer value that is not the same like the original value.<br>\nMy Class:</p>\n\n<pre><code>class Time{\npublic:\n    int hour;\n    int minute;\n    int second;\n\n};\n</code></pre>\n\n<p>My Method to Save the Single Values to the File. I tried this one with the reinterpret_cast and without for example :(char*) $time.hour</p>\n\n<pre><code>std::ostream&amp; operator&lt;&lt;(std::ostream &amp;os, Time &amp;time){\n\n    os.write(reinterpret_cast&lt;const char *&gt;(&amp;time.hour),sizeof(int));\n    os.write(reinterpret_cast&lt;const char *&gt;(&amp;time.minute),sizeof(int));\n    os.write(reinterpret_cast&lt;const char *&gt;(&amp;time.second),sizeof(int));\n    return os;\n}\n\nstd::istream&amp; operator &gt;&gt;(std::istream &amp;is,Time &amp;time){\n\n    is.read((char*)&amp;time.hour,sizeof(int));\n    is.read((char*)&amp;time.minute,sizeof(int));\n    is.read((char*)&amp;time.second,sizeof(int));\n    return is;\n}\n</code></pre>\n\n<p>My Code to test the function the result for this is 1878006928\n: </p>\n\n<pre><code>int main() {\n    Time time;\n    time.hour = 24;\n    time.minute = 33;\n    time.second = 10;\n    std::ofstream os(\"test.txt\", std::ios::binary | std::ios::out);\n    os &lt;&lt; time;\n    Time time2;\n    std::ifstream is(\"test.txt\",std::ios::binary | std::ios::in);\n    is &gt;&gt; time2;\n    std::cout &lt;&lt; time2.hour;\n\n}\n</code></pre>\n\n<p>Hope you can understand my problem.</p>\n"}, {"tags": ["c++", "language-lawyer", "c++17"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513789655, "post_id": 47910988, "comment_id": 82789709, "body": "An object can&#39;t be of class, pointer and array type simultaneously. No object can satisfy all the constraints. It must satisfy the appropriate one. An object of type <code>int</code> satisfies neither. So no, <code>ri</code> wouldn&#39;t apply."}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 0, "creation_date": 1513789723, "post_id": 47910988, "comment_id": 82789740, "body": "D&#39;oh. Thank you for making me aware that I misread <a href=\"http://eel.is/c++draft/expr.const#6.sentence-2\" rel=\"nofollow noreferrer\">&#91;expr.const&#93;/6</a>. It should read &quot;an object with static storage duration that is (either not a temporary object or is a temporary object whose value satisfies the above constraints)&quot;, not &quot;(an object with static storage duration that is either not a temporary object) or (is a temporary object whose value satisfies the above constraints)&quot;."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513793120, "post_id": 47910988, "comment_id": 82791525, "body": "@StoryTeller The constraint <code>P -&gt; Q</code> is satisfied by <code>!P</code>."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513793178, "post_id": 47910988, "comment_id": 82791551, "body": "@Barry - I&#39;m reading it more like <code>P1 || P2 || P3</code>. Where it just so happens all three are mutually exclusive."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513793293, "post_id": 47910988, "comment_id": 82791607, "body": "@StoryTeller They&#39;re not mutually exclusive."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513793362, "post_id": 47910988, "comment_id": 82791645, "body": "@Barry - The bullets are not mutually exclusive? How so? Only one can apply to any type, at most."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513793684, "post_id": 47910988, "comment_id": 82791801, "body": "@StoryTeller If the object is of class type, we check both <a href=\"http://eel.is/c++draft/expr.const#6.1\" rel=\"nofollow noreferrer\">non-static data members of reference type</a> and <a href=\"http://eel.is/c++draft/expr.const#6.3\" rel=\"nofollow noreferrer\">subobjects, recursively</a>"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513793940, "post_id": 47910988, "comment_id": 82791909, "body": "@Barry - Checking the members recursively doesn&#39;t mean we apply more than one bullet to the super-object itself. But w/e, that&#39;s beside the point. Even if, for the sake of argument, a type satisfies more then one bullet, the satisfaction of <i>at least</i> one is still required. That paragraph is an only-if relationship. Which seems to suffer from some natural language pitfalls."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 4, "creation_date": 1513794358, "post_id": 47910988, "comment_id": 82792092, "body": "The reference is initialized with the glvalue result of the temporary materialization conversion applied to the prvalue <code>0</code> adjusted to type <code>const int</code>. You can&#39;t ignore the conversions and consider only the syntactic form of the initializer."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513794381, "post_id": 47910988, "comment_id": 82792101, "body": "@StoryTeller What? We have to satisfy <b>all</b> the bullets, all &quot;the following constraints.&quot; There is no &quot;or&quot;, there is no &quot;at least one&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 9123744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88583e8799e5e23482aef86db7604da0?s=128&d=identicon&r=PG&f=1", "display_name": "user9123744", "link": "https://stackoverflow.com/users/9123744/user9123744"}, "is_accepted": false, "score": 1, "last_activity_date": 1513790767, "creation_date": 1513790767, "answer_id": 47911395, "question_id": 47910988, "link": "https://stackoverflow.com/questions/47910988/reference-initialization-and-constant-expressions/47911395#47911395", "title": "Reference initialization and constant expressions", "body": "<p>As you pointed out, 2.11 states that a <em>core constant expression</em> must not evaluate to:</p>\n\n<blockquote>\n  <ul>\n  <li><p>an id-expression that refers to a variable or data member of reference type unless the reference has a preceding initialization and\n  either</p>\n  \n  <ul>\n  <li>it is initialized with a constant expression or</li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<p>And further expr.const#6:</p>\n\n<blockquote>\n  <p>A constant expression is either a glvalue core constant expression\n  that refers to an entity that is a permitted result of a constant\n  expression (as defined below), or a prvalue core constant expression\n  whose value satisfies the following constraints: </p>\n  \n  <p>...</p>\n  \n  <p>An entity is a permitted result of a constant expression if it is an\n  object with static storage duration that is either not a temporary\n  object or is a temporary object whose value satisfies the above\n  constraints, or it is a function.</p>\n</blockquote>\n\n<p>From my reading of this, it means that the RHS of <code>const X&amp; r =</code> (substitute X for some type) must either be an object with static storage duration <strong>or</strong> a temporary object that meets the above criteria. Since an <code>int</code> does not fit either an object of class type, a pointer type or class/array type, it does not qualify.</p>\n"}, {"comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1513929567, "post_id": 47912705, "comment_id": 82844715, "body": "What does it mean for a temporary have static storage duration?"}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 5, "last_activity_date": 1513796296, "last_edit_date": 1592644375, "creation_date": 1513796296, "answer_id": 47912705, "question_id": 47910988, "link": "https://stackoverflow.com/questions/47910988/reference-initialization-and-constant-expressions/47912705#47912705", "title": "Reference initialization and constant expressions", "body": "<p>In this statement:</p>\n<pre><code>const int&amp; ri = 0;\n</code></pre>\n<p><code>0</code> is a prvalue, but <code>ri</code> isn't initialized from that prvalue. The prvalue first undergoes a <a href=\"http://eel.is/c++draft/dcl.init#ref-5.2.1\" rel=\"noreferrer\">temporary materialization conversion</a> and the reference is bound to the resulting glvalue. Since <code>ri</code> is bound to this materialized glvalue, and not directly to the prvalue like you (I) suspected, the relevant restrictions are not the prvalue core constant expression restrictions (which <code>0</code> does satisfy) but rather the <em>glvalue</em> core constant expression restrictions - that the entity be a <a href=\"http://eel.is/c++draft/expr.const#6\" rel=\"noreferrer\"><em>permitted result of a constant expression</em></a>. That restriction, spelled with slightly improved clarity, is:</p>\n<blockquote>\n<p>either an object with static storage duration that is:</p>\n<ul>\n<li>not a temporary object, or</li>\n<li>a temporary object whose value satisfies the above constraints,</li>\n</ul>\n<p>or it is a function.</p>\n</blockquote>\n<p>Our glvalue <em>is</em> a temporary object whose value satisfies &quot;the above constraints&quot; (&quot;above&quot; here referring to the prvalue core constant restrictions, which <code>int</code> trivially satisfies), but it does <em>not</em> have static storage duration.</p>\n<p>Not having static storage duration \u2192 the entity is not a permitted result of a constant expression \u2192 the glvalue expression not a constant expression \u2192  <code>ri</code> wasn't initialized with a constant expression \u2192 <code>ri</code> can't be used in a core constant expression \u2192 the declaration of <code>i</code> is ill-formed.</p>\n<p>The same argument holds for appropriate class types as well.</p>\n"}], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1513796296, "creation_date": 1513789205, "question_id": 47910988, "link": "https://stackoverflow.com/questions/47910988/reference-initialization-and-constant-expressions", "title": "Reference initialization and constant expressions", "body": "<p>As a followup to <a href=\"https://stackoverflow.com/q/47908885/2069064\">this question</a>, gcc and clang both consider this program ill-formed:</p>\n\n<pre><code>int main() {\n    const int&amp; ri = 0;\n    constexpr int i = ri;\n}\n</code></pre>\n\n<p>The error is about the value of <code>ri</code> being unusable in a constant expression. <code>0</code> is certainly a core constant expression, and as a prvalue core constant expression seems to satisfy <a href=\"http://eel.is/c++draft/expr.const#6\" rel=\"noreferrer\">these constraints</a> (trivially, since <code>int</code> isn't of class, pointer, or array type). So shouldn't <code>ri</code> satisfy <a href=\"http://eel.is/c++draft/expr.const#2.11\" rel=\"noreferrer\">this criteria</a>?</p>\n\n<p>The same is true if I use a prvalue literal of class type:</p>\n\n<pre><code>struct X { };\nint main() {\n    const X&amp; rx = X{};\n    constexpr X x = rx;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "vector"], "comments": [{"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1513787519, "post_id": 47910498, "comment_id": 82788563, "body": "Perhaps wrapping it in a custom class? Also look at this <a href=\"https://stackoverflow.com/questions/13816850/is-it-possible-to-develop-static-for-loop-in-c\" title=\"is it possible to develop static for loop in c\">stackoverflow.com/questions/13816850/&hellip;</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1513787647, "post_id": 47910498, "comment_id": 82788644, "body": "@JakeFreeman but this would make the code more cumbersome than the method used in <code>func1</code>."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 3, "creation_date": 1513787648, "post_id": 47910498, "comment_id": 82788646, "body": "Apart from the curiosity factor, is there anything to be gained by the second approach?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1513787728, "post_id": 47910498, "comment_id": 82788695, "body": "@RSahu not really, just code compactness and the locality of the vector which has no purpose outside the <code>for</code> loop. This is not real code, it&#39;s just a minimal example."}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1513787764, "post_id": 47910498, "comment_id": 82788714, "body": "Something like an <a href=\"https://stackoverflow.com/a/391782/1460794\">anonymous automatic static variable</a>?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1513787983, "post_id": 47910498, "comment_id": 82788825, "body": "@wally yes, somewhat"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1513789250, "post_id": 47910498, "comment_id": 82789502, "body": "@Scheff That would make a nice answer. I think you just need to enclose the lambda in brackets and then invoke the () operator."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1513789295, "post_id": 47910498, "comment_id": 82789523, "body": "Yes, I&#39;ve used lambdas like that before. (This is called an IIFE, immediately executed function expression, in Javascript <i>et al.</i>)"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513789333, "post_id": 47910498, "comment_id": 82789542, "body": "Tried to compile in ideone but it complained about missing <code>begin()</code>. I&#39;m not that experienced in lambdas to see how to change it or if it&#39;s not possible at all."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513789485, "post_id": 47910498, "comment_id": 82789623, "body": "@Scheff, yes it doesn&#39;t compile and as you mentioned in your (now deleted) comment: it <b>is</b> too scary for me, and far less readable than the method used in <code>func1</code>."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 3, "creation_date": 1513789878, "post_id": 47910498, "comment_id": 82789816, "body": "Note that using a <code>std::vector</code> here is counter-productive, because its whole purpose is runtime resizeability which is directly working against your desire to have a singleton/constant.  So I assume that is a placeholder for some user class where a <code>constexpr</code> version (<code>std::array</code> or <code>std::initializer_list</code>) is not readily available."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1513790292, "post_id": 47910498, "comment_id": 82790049, "body": "@BenVoigt I can&#39;t use <code>std::array</code>, because I don&#39;t know the size of the array, but you&#39;re right, a <code>std::initializer_list</code> is a better alternative here as the list will never grow or shrink, but the question remains the same."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1513792115, "post_id": 47910498, "comment_id": 82790989, "body": "@BenVoigt forgot to mention: the elements of the vector/initializer_list are <i>actually</i> <code>int</code>s."}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 1, "creation_date": 1513814652, "post_id": 47910498, "comment_id": 82800148, "body": "@MichaelWalz you can often use a call to <a href=\"http://en.cppreference.com/w/cpp/experimental/make_array\" rel=\"nofollow noreferrer\"><code>make_array</code></a> or a similar function if you don&#39;t want to bother with the size."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1513849652, "post_id": 47910498, "comment_id": 82811783, "body": "The comparison between the resulting assembly of Clang and GCC, with array or vector, is overwhelming."}], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1513788972, "post_id": 47910817, "comment_id": 82789363, "body": "Huh, I had no idea that <code>static</code> could be included here (never had any reason to try it). Does the <code>if</code> version gain anything over just opening a new block scope?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1513789048, "post_id": 47910817, "comment_id": 82789404, "body": "@underscore_d - Nothing. It&#39;s just a test of the grammar production. Demonstrating that an init statement of a static object is valid."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 13, "last_activity_date": 1513788575, "creation_date": 1513788575, "answer_id": 47910817, "question_id": 47910498, "link": "https://stackoverflow.com/questions/47910498/inline-static-declaration-of-object-with-initializer-list/47910817#47910817", "title": "&quot;Inline&quot; static declaration of object with initializer list", "body": "<p>This won't actually help you yet. But there's something you can do in C++2a. It is, however, based on something that exists already in C++14 and C++17.</p>\n\n<p>C++2a added an <code>init-statement</code> to the range based for loop. That's the new bit, the old bit is that it's the same <code>init-statement</code> as it is defined today. And the definition is as follow (<a href=\"https://timsong-cpp.github.io/cppwp/n4659/stmt.stmt#nt:init-statement\" rel=\"noreferrer\">[stmt.stmt]</a>):</p>\n\n<pre><code>init-statement:\n    expression-statement\n    simple-declaration\n</code></pre>\n\n<p>What I'm going for is that a <code>simple-declaration</code> may contain a <code>static</code> qualifier. Yup, it does what you'd expect. So in C++2a you may write:</p>\n\n<pre><code>for (static std::vector&lt;int&gt; vec {1, 2, 3, 4}; int v : vec) {\n   // Do things.\n}\n</code></pre>\n\n<p>And if you want to test compiler support for it today, here's a C++17 kludge:</p>\n\n<pre><code>if (static std::vector&lt;int&gt; vec {1, 2, 3, 4}; true) {\n    // init-statement in if was added in C++17\n  for(int v : vec)\n    FooBar(v);\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/g/BgQcCg\" rel=\"noreferrer\">And its disassembly</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 9123744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88583e8799e5e23482aef86db7604da0?s=128&d=identicon&r=PG&f=1", "display_name": "user9123744", "link": "https://stackoverflow.com/users/9123744/user9123744"}, "is_accepted": false, "score": 3, "last_activity_date": 1513788731, "creation_date": 1513788731, "answer_id": 47910858, "question_id": 47910498, "link": "https://stackoverflow.com/questions/47910498/inline-static-declaration-of-object-with-initializer-list/47910858#47910858", "title": "&quot;Inline&quot; static declaration of object with initializer list", "body": "<p>No, in current C++ (C++17) it is not possible. A range-based for is equivalent to the following pseudo-code:</p>\n\n<pre><code>{\n    auto &amp;&amp; __range = range_expression ;\n    auto __begin = begin_expr ;\n    auto __end = end_expr ;\n    for ( ; __begin != __end; ++__begin) {\n        range_declaration = *__begin;\n        loop_statement\n    }\n} \n</code></pre>\n\n<p>There is no <em>init-statement</em> here. The <em>range_expression</em> must either be initialized a priori or you must pass in a <em>braced-init-list</em> to be evaluated (like <code>std::vector&lt;int&gt;{1, 2, 3, 4}</code>). This will be changed in C++20.</p>\n"}, {"comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513789713, "post_id": 47911088, "comment_id": 82789735, "body": "Yepp. Compiles and runs: <a href=\"https://ideone.com/Yiiz6I\" rel=\"nofollow noreferrer\">ideone</a> but it&#39;s still looking scary. (I&#39;m impressed - didn&#39;t get the trick with <code>operator()</code>.)"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513790144, "post_id": 47911088, "comment_id": 82789972, "body": "Out of curiosity: Why does it work with <code>operator()</code> but does not even compile without?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 4, "creation_date": 1513790525, "post_id": 47911088, "comment_id": 82790161, "body": "@Scheff - With a function call, it invokes the lambda and gets the vector to iterate over. Without the call, it tries to iterate over the lambda object itself."}], "tags": [], "owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "is_accepted": false, "score": 9, "last_activity_date": 1513789593, "creation_date": 1513789593, "answer_id": 47911088, "question_id": 47910498, "link": "https://stackoverflow.com/questions/47910498/inline-static-declaration-of-object-with-initializer-list/47911088#47911088", "title": "&quot;Inline&quot; static declaration of object with initializer list", "body": "<p>Another option using a lambda (from the comments on the main question):</p>\n\n<pre><code>void func()\n{\n    for(auto &amp; v : ([]() -&gt; std::vector&lt;int&gt;&amp; { static std::vector&lt;int&gt; vec{1, 2, 3, 4}; return vec; })())\n        FooBar(v);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1513796876, "post_id": 47912088, "comment_id": 82793297, "body": "For the optimization in question to happen automatically, the compiler would have to recognize that the elements are never written even though the program takes a non-<code>const</code> lvalue reference to each.  Not out of the question, but certainly a harder problem than the version using <code>auto</code> or <code>const auto&amp;</code> instead of <code>auto&amp;</code>."}], "tags": [], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "is_accepted": false, "score": 2, "last_activity_date": 1513796277, "last_edit_date": 1513796277, "creation_date": 1513793739, "answer_id": 47912088, "question_id": 47910498, "link": "https://stackoverflow.com/questions/47910498/inline-static-declaration-of-object-with-initializer-list/47912088#47912088", "title": "&quot;Inline&quot; static declaration of object with initializer list", "body": "<p>Indeed, there is nothing in the C++ standard that disallow the optimization you are looking for. The heap memory that <code>std::vector&lt;int,std::allocator&gt;</code> allocates could indeed be replaced by static memory without changing your program behavior. But as shown by your link (even if one add aggressive optimization options) compilers do not perform the expected optimization.</p>\n\n<p>So you may choose to use a <code>std::array</code> instead of a <code>std::vector</code>, <code>std::array</code> are easyly \"understood\" by optimizer, <a href=\"https://godbolt.org/g/nzTxqM\" rel=\"nofollow noreferrer\">here</a> the assembly of:</p>\n\n<pre><code>void FooBar(int);\n\nvoid func2()\n{\n  for (auto &amp; v : std::array&lt;int,4&gt; {1, 2, 3, 4})\n    FooBar(v);\n}\n</code></pre>\n\n<p>As you see in the assembly, the array is stored inside static memory:</p>\n\n<pre><code>.LC0:\n    .long   1\n    .long   2\n    .long   3\n    .long   4\n</code></pre>\n\n<hr>\n\n<p>For fun, you can get as good assembly by using a custom allocator that use static memory, <a href=\"https://godbolt.org/g/fiZ34W\" rel=\"nofollow noreferrer\">here the assembly</a> of:</p>\n\n<pre><code>void FooBar(int i);\n\ntemplate&lt;class T&gt;\nclass static_alloc\n  {\n  static typename std::aligned_storage&lt;4*sizeof(T),alignof(T)&gt;::type buff;\n  static bool allocated;\n\npublic:\n\n  using value_type = T;\n\n  bool operator==(const static_alloc&amp;){\n    return true;\n  }\n  bool operator!=(const static_alloc&amp;){\n    return false;\n  }\n\n  T* allocate(std::size_t n)\n    {\n    if (allocated) throw std::bad_alloc{};\n    allocated=true;\n    return reinterpret_cast&lt;T*&gt;(&amp;buff);\n    }\n  void deallocate(T*,std::size_t)\n    {\n    allocated=false;\n    }\n  };\ntemplate&lt;class T&gt;\nbool static_alloc&lt;T&gt;::allocated=false;\ntemplate&lt;class T&gt;\nstd::aligned_storage_t&lt;4*sizeof(T),alignof(T)&gt; static_alloc&lt;T&gt;::buff;\n\n\nvoid func2()\n{\n   for (auto &amp; v : std::vector&lt;int,static_alloc&lt;int&gt;&gt;{1,2,3,4})\n      FooBar(v);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2392, "user_id": 3517622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2nYKV.gif?s=128&g=1", "display_name": "KevinZ", "link": "https://stackoverflow.com/users/3517622/kevinz"}, "is_accepted": false, "score": 3, "last_activity_date": 1514054826, "creation_date": 1514054826, "answer_id": 47955084, "question_id": 47910498, "link": "https://stackoverflow.com/questions/47910498/inline-static-declaration-of-object-with-initializer-list/47955084#47955084", "title": "&quot;Inline&quot; static declaration of object with initializer list", "body": "<p>You can do better than that: you can just have everything on the stack. If you compile the following on -O2 or higher, it essentially gets unrolled into 4 calls to <code>FooBar()</code>.</p>\n\n<p>Also, looking at disassembly with optimizations off isn't very meaningful.</p>\n\n<pre><code>void func3()\n{\n    constexpr int vs [] = { 1, 2, 3, 4 };\n    for ( int const v : vs )\n        FooBar(v);\n}\n</code></pre>\n"}], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1072, "favorite_count": 1, "answer_count": 5, "score": 15, "last_activity_date": 1514054826, "creation_date": 1513787314, "last_edit_date": 1513787750, "question_id": 47910498, "link": "https://stackoverflow.com/questions/47910498/inline-static-declaration-of-object-with-initializer-list", "title": "&quot;Inline&quot; static declaration of object with initializer list", "body": "<p>Sorry for the awkward title, but I couldn't find a better one.</p>\n\n<p>Consider this sample code (it has no purpose except illustrating the question):</p>\n\n<pre><code>#include &lt;vector&gt;\n\nvoid FooBar(int);\n\nvoid func1()\n{\n    static std::vector&lt;int&gt; vec {1, 2, 3, 4};\n\n    for (auto &amp; v : vec)\n      FooBar(v);\n}\n\nvoid func2()\n{\n    for (auto &amp; v : std::vector&lt;int&gt; {1, 2, 3, 4})\n      FooBar(v);\n}\n</code></pre>\n\n<p>The disassembly of this can be found <strong><a href=\"https://godbolt.org/g/pxC7fQ\" rel=\"noreferrer\">here</a></strong></p>\n\n<p>In <code>func1</code> the static <code>vec</code> vector is supposed to be constructed once and for all at startup. Actually the disassembly on godbolt mentioned above shows that the initialisation of the static <code>vec</code> is done only upon the first call of <code>func1</code> and not at startup, but that's not the point here.</p>\n\n<p>Now consider <code>func2</code>: here the vector is directly declared \"inline\" (not sure how this is actually called) inside the <code>for</code> statement, but of course that vector is constructed every time <code>func2</code> is called.</p>\n\n<p>Is there a way to declare that vector statically <em>and</em> inside the <code>for</code> statement, like <code>for (auto &amp; v : static std::vector&lt;int&gt; { 1, 2, 3, 4})</code> which is unfortunately not legal C++.</p>\n"}, {"tags": ["c++", "matrix", "gaussian", "independent-set", "gauss"], "comments": [{"owner": {"reputation": 27269, "user_id": 2320035, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83d5a6d76755c6a987dd59495698dcfe?s=128&d=identicon&r=PG", "display_name": "sascha", "link": "https://stackoverflow.com/users/2320035/sascha"}, "edited": false, "score": 0, "creation_date": 1513787715, "post_id": 47910423, "comment_id": 82788688, "body": "(Off-topic:) If this is for critical real-world usage, you probably should make use of <a href=\"https://bitbucket.org/malb/m4ri\" rel=\"nofollow noreferrer\">m4ri</a>."}, {"owner": {"reputation": 62, "user_id": 4768669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kh0NE.jpg?s=128&g=1", "display_name": "mitxael", "link": "https://stackoverflow.com/users/4768669/mitxael"}, "reply_to_user": {"reputation": 27269, "user_id": 2320035, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83d5a6d76755c6a987dd59495698dcfe?s=128&d=identicon&r=PG", "display_name": "sascha", "link": "https://stackoverflow.com/users/2320035/sascha"}, "edited": false, "score": 1, "creation_date": 1513788319, "post_id": 47910423, "comment_id": 82789015, "body": "Thank you for the link @Sascha, BUT this code is part of a thesis, where all functions must be developed by me, including this &quot;binary gaussian elimination&quot; which is a very very tiny part of the bigger picture."}], "owner": {"reputation": 62, "user_id": 4768669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kh0NE.jpg?s=128&g=1", "display_name": "mitxael", "link": "https://stackoverflow.com/users/4768669/mitxael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513787840, "creation_date": 1513787055, "last_edit_date": 1513787840, "question_id": 47910423, "link": "https://stackoverflow.com/questions/47910423/gauss-based-linear-independence-test-for-binary-vectors", "title": "Gauss-based Linear Independence Test for Binary vectors", "body": "<p>I programmed a version of <strong>Gaussian Elimination</strong> to verify <strong>linear independence</strong> of a set of <strong>Binary vectors</strong>. It inputs a matrix (mxn) to evaluate and return:</p>\n\n<ul>\n<li><strong>True</strong> (Linear Independent): No zero row was found. </li>\n<li><strong>False</strong> (Linear Dependent): If the last row is zero.</li>\n</ul>\n\n<p>It seems to work well always, or at least almost. I found that it doesn't work when the matrix has two <strong>duplicated</strong> vectors in the last row:</p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt;&gt; A = {\n    {1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0},\n    {0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1 },\n    {0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0 },\n    {0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0 },\n    {0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0},   // &lt;---- duplicated\n    {0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0},}; // &lt;---- duplicated\ngaussianElimination_binary(A);\n</code></pre>\n\n<p>The function says the matrix is \"Linear Independent\" because no zero row was found, and indeed there is any in the result. But <strong>debugging</strong> I found that at some point a row becomes <strong>zero</strong>, but then after some <strong>row operations</strong> it gets back to \"normal\".</p>\n\n<p>I double-checked the code and the only way to make it work was to return \"false\" also when a \"zero row\" is found <strong>before</strong> the end of the process, more precisely, during row operations:</p>\n\n<pre><code>// perform XOR in \"k-th\" row against \"row-th\" row\n    for (int k = 0; k &lt;= max_row; ++k) //k=col_pivot?\n    {\n        if ( (k != row)   )\n        {\n            int check_zero_row = 0; // &lt;---- APPLIED PATCH\n            for (std::size_t j = 0; j &lt;= max_col; j++) {\n                B[k][j] = B[k][j] ^ B[row][j];\n                check_zero_row = check_zero_row | B[k][j];\n            }\n            if (check_zero_row == 0 ) // &lt;---- APPLIED PATCH\n            {\n                return false;\n            }\n        }\n    }\n</code></pre>\n\n<p>I want to know if this is right, or if I'm just \"patching\" a bad code.</p>\n\n<p>Thank you!</p>\n\n<p>Here below the <a href=\"https://onlinegdb.com/SkBL0Z_GM\" rel=\"nofollow noreferrer\">full code</a>:</p>\n\n<pre><code>#include vector\nbool gaussianElimination_binary(std::vector&lt;std::vector&lt;int&gt;&gt; &amp;A) {\nstd::vector&lt;std::vector&lt;int&gt;&gt; B = A;\nstd::size_t max_col = B[0].size() - 1;      //cols\nstd::size_t max_row = B.size() -1 ;     //rows\nstd::size_t col_pivot = 0;\n\n//perform \"gaussian\" elimination\nfor (std::size_t row = 0; row &lt;= max_row; ++row) //for every column\n{\n    if (col_pivot &gt; max_col)\n        break;\n\n    // Search for first row having \"1\" in column \"lead\"\n    std::size_t i = row; //Start searching from row \"i\"=row\n    while (B[i][col_pivot] == 0)\n    {\n        ++i;\n        if (i &gt; max_row) // no \"1\" was found across rows\n        {\n            i = row;        // set \"i\" back to \"row\"\n            ++col_pivot;    // move to next column\n            if (col_pivot &gt; max_col) //if no more columns\n                break;\n        }\n    }\n\n    // swap \"i\" and \"row\" rows\n    if ((0 &lt;= i) &amp;&amp; (i &lt;= max_row) &amp;&amp; (0 &lt;= row) &amp;&amp; (row &lt;= max_row)) {\n        for (std::size_t col = 0; col &lt;= max_col; ++col) {\n            std::swap(B[i][col], B[row][col]);\n        }\n    }\n\n    // perform XOR in \"k-th\" row against \"row-th\" row\n    for (int k = 0; k &lt;= max_row; ++k) //k=col_pivot?\n    {\n        if ( (k != row)   )\n        {\n            int check_zero_row = 0;\n            for (std::size_t j = 0; j &lt;= max_col; j++) {\n                B[k][j] = B[k][j] ^ B[row][j];\n                check_zero_row = check_zero_row | B[k][j];\n            }\n            if (check_zero_row == 0 )\n            {\n                return false;\n            }\n        }\n    }\n}\n\nreturn true;\n}\n</code></pre>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1513802969, "post_id": 47910282, "comment_id": 82796144, "body": "I&#39;ve tried it and it works correctly."}, {"owner": {"reputation": 346, "user_id": 712219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68004bc60679e407194b76c7913e4737?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/712219/sammy"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1513881807, "post_id": 47910282, "comment_id": 82830554, "body": "@eyllanesc which version and platform did you try it on?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1513881866, "post_id": 47910282, "comment_id": 82830585, "body": "Linux, Qt 5.10."}, {"owner": {"reputation": 346, "user_id": 712219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68004bc60679e407194b76c7913e4737?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/712219/sammy"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1513882173, "post_id": 47910282, "comment_id": 82830769, "body": "OK, thanks. I am using windows 10. I have tried it with 5.9 but not with 5.10. I will try that next."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1513882257, "post_id": 47910282, "comment_id": 82830824, "body": "QtWebEngine has had several bugs in windows, I recommend checking if your problem is one of them, so in your case I would report it to Qt."}, {"owner": {"reputation": 346, "user_id": 712219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68004bc60679e407194b76c7913e4737?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/712219/sammy"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1513882521, "post_id": 47910282, "comment_id": 82830948, "body": "yeah, I will do that after testing with 5.10. It seems the issue appeared after QDockWidget improvements in 5.6. it works for other widgets though so it seems to be an issue when using QWebEngineview."}], "owner": {"reputation": 346, "user_id": 712219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68004bc60679e407194b76c7913e4737?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/712219/sammy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513786563, "creation_date": 1513786563, "question_id": 47910282, "link": "https://stackoverflow.com/questions/47910282/when-qdockwidget-with-qwebengineview-is-undocked-other-docked-widgets-dont-res", "title": "When QDockWidget with QWebEngineView is undocked, other docked widgets don&#39;t respond to user action", "body": "<p>I have multiple dockwidgets in my main window and everything works fine until I add a dockedwidget with QwebEngineView as the widget.</p>\n\n<p>When a dockwidget with QwebEngineView as a child is undocked, user inputs such as scroll bars in the other docked widgets are ignored. When the dockwidget with QWebEngineView is docked, it works fine. </p>\n\n<p>The code I am testing with is the example project in \n   ..\\Qt 5.6\\widgets\\mainwindows\\dockwidgets\nwith minor modification to add one more dockedwidget with QWebEngineView (see below).</p>\n\n<pre><code>///// added this in void MainWindow::createDockWindows()\n\nWebView* w_view = new WebView(nullptr);\ndock = new QDockWidget(tr(\"WebView\"), this);\ndock-&gt;setAllowedAreas(Qt::LeftDockWidgetArea | Qt::RightDockWidgetArea);\ndock-&gt;setWidget(w_view);\naddDockWidget(Qt::LeftDockWidgetArea, dock);\nviewMenu-&gt;addAction(dock-&gt;toggleViewAction());\n\n\n///  the widget with QWebEngineView\nclass WebView : public QWidget {\n     Q_OBJECT\n public:\n WebView(QWidget* parent = 0)\n    :QWidget(parent)\n{\n    setObjectName(\"WebView\");\n    m_webEngineView = new QWebEngineView(this);\n    m_webEngineView-&gt;load(QUrl(\"http://qt-project.org/\"));\n}\n\n    ~WebView() {}\nprivate:\n    QWebEngineView* m_webEngineView;\n};\n///////////////////////////\n</code></pre>\n\n<p>Any help?</p>\n"}, {"tags": ["c++", "class", "variables", "object"], "comments": [{"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1513786421, "post_id": 47910196, "comment_id": 82787942, "body": "What is the problem?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1513786491, "post_id": 47910196, "comment_id": 82787983, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (eg there is no <code>main</code> but just a class definition that by itself isnt doing anything), input, expected and actual output... btw if you add that you may shorten the text a bit. Code is better explained by code rather than words"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1513787209, "post_id": 47910196, "comment_id": 82788397, "body": "Show us the code where you construct the <code>find_number</code> object, as the problem is likely with how you&#39;re calling it and not in the code you&#39;ve shown."}, {"owner": {"reputation": 1, "user_id": 9086202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add6b4e988fbe7899ffba518c9796f20?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Schmelkus", "link": "https://stackoverflow.com/users/9086202/jens-schmelkus"}, "edited": false, "score": 0, "creation_date": 1513846765, "post_id": 47910196, "comment_id": 82810082, "body": "I just added the requested other code parts in reduced form."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 2, "creation_date": 1513851004, "post_id": 47910196, "comment_id": 82812662, "body": "<code>find_number MyNumber (Integer_array,Numbers_in_Integer_array);</code> in <code>MyClass::init()</code> (and <code>find_number MyNumber;</code> in the constructor) creates a <i>local</i> variable, it does not assign to the class member of the same name"}], "owner": {"reputation": 1, "user_id": 9086202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add6b4e988fbe7899ffba518c9796f20?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Schmelkus", "link": "https://stackoverflow.com/users/9086202/jens-schmelkus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513846678, "creation_date": 1513786217, "last_edit_date": 1513846678, "question_id": 47910196, "link": "https://stackoverflow.com/questions/47910196/variable-values-get-lost-when-switching-between-objects-in-a-class-included-in-a", "title": "Variable values get lost when switching between objects in a class included in a class", "body": "<p><strong>The Problem is that variables loose their values</strong>.\nThe variables <code>selectable_values_array</code> and <code>searched_array_size</code> contain the correct values while inside the initialisation of the <code>find_number::find_number</code>.\nBut when the <code>find_closest</code> object is called the variables are containing\nvalues like -28 and 4214247.\nAs a logical consequence the samplerate_return returns just garbage.</p>\n\n<p>So what am i missing here ?\nIs there a method of safely passing a variable/values inside a class ?</p>\n\n<p><strong>Edit:</strong> Added the reduced MyClass and main.</p>\n\n<pre><code>#include \"MyClass.h\"\n\nint main()\n{\n    int32_t samplerate_return = 0;\n    int32_t samplerate_request = 7;\n\n    MyClass ADC_1 ();\n\n    while(1) {\n      samplerate_return = ADC_1.select(samplerate_request);\n    }\n}\n</code></pre>\n\n<p>The first Class:</p>\n\n<pre><code>#ifndef MyClass_H\n#define MyClass_H\n\n    #include \"find_number.h\"\n\n    class MyClass\n    {\n    public:\n        MyClass();\n        int32_t select(int32_t the_searched_number);\n        int32_t the_selected_number;\n\n    private:\n        int32_t Integer_array[];\n        int32_t Numbers_in_Integer_array;\n        bool init();\n        find_number MyNumber;\n    };\n</code></pre>\n\n<p>And the <code>MyClass.cpp</code></p>\n\n<pre><code>#include \"MyClass.h\"\n\nMyClass::MyClass()\n{\n    init();\n    find_number MyNumber;\n}\n\nbool MyClass::init()\n{\n    int32_t Integer_array[] = {2,5,10};\n    Numbers_in_Integer_array =  (sizeof(Integer_array)/sizeof(*Integer_array));\n    find_number MyNumber (Integer_array,Numbers_in_Integer_array);\n    return 0;\n}\n\nint32_t MyClass::select(int32_t the_searched_number)\n{\n    the_selected_number = MyNumber.find_closest(the_searched_number);\n    return the_selected_number;\n}\n</code></pre>\n\n<p>This is the header file of the \"Find_Numbers\" class:</p>\n\n<pre><code>#ifndef find_number_h\n#define find_number_h\n\nclass find_number\n{\npublic:\n    //Constructor:\n    find_number(int32_t  *selectable_values,int32_t cells_in_array);\n    find_number(); // = default;\n    //Class Objects:\n    int32_t find_closest(int32_t target_value);\n\nprivate:\n    int32_t searched_array_size;\n    int32_t *selectable_values_array;\n };\n    #endif\n</code></pre>\n\n<p>And the corresponding <code>find_numbers.cpp</code></p>\n\n<pre><code>    #include \"find_number.h\"\n\n        find_number::find_number(int32_t *selectable_values, int32_t cells_in_array)\n        {\n            selectable_values_array = selectable_values;\n            searched_array_size = cells_in_array;\n        }\n\n        find_number::find_number() {};\n\n       int32_t find_number::find_closest(int32_t target_value)\n        {\n            int32_t difference = abs( target_value - *selectable_values_array);\n            int32_t closest_integer = selectable_values_array[0];\n            // calculating stuff\n            return closest_integer;\n        }\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 5535, "user_id": 1173638, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Mq0Io.gif?s=128&g=1", "display_name": "Adder", "link": "https://stackoverflow.com/users/1173638/adder"}, "edited": false, "score": 0, "creation_date": 1513784980, "post_id": 47909759, "comment_id": 82787025, "body": "<code>cout &lt;&lt; *(p-&gt;name+1) &lt;&lt; endl; </code> should do the trick and remove the <code>p = p +1</code>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1513784987, "post_id": 47909759, "comment_id": 82787029, "body": "<code>p</code> is a pointer to <code>list</code> not to <code>list::name</code>. Incrementing it would move <code>p</code> up to the next <code>list</code> in an array of <code>list</code> objects."}], "answers": [{"tags": [], "owner": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "is_accepted": false, "score": 2, "last_activity_date": 1513784952, "creation_date": 1513784952, "answer_id": 47909829, "question_id": 47909759, "link": "https://stackoverflow.com/questions/47909759/pointer-and-char-in-struct/47909829#47909829", "title": "Pointer and char in struct", "body": "<p>You can use <em>index</em> on <code>name</code> to access any character:</p>\n\n<p><code>p-&gt;name[1]</code> // gives 'a'</p>\n\n<p><code>p-&gt;name[2]</code> // gives 'r'</p>\n\n<p>Note that arrays begin with an index of 0. So <code>p-&gt;name[0]</code> would give <code>'c'</code>.</p>\n\n<p><code>p + 1</code> actually increments <code>p</code>, which is a pointer to <code>list</code>. This essentially moves to the next instance of <code>list</code>, which is not even initialized in your code.</p>\n"}, {"comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1513785527, "post_id": 47909835, "comment_id": 82787410, "body": "@MartinBonner You are right, that&#39;s yet another way to do it. Thank you!"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 6, "last_activity_date": 1513785510, "last_edit_date": 1513785510, "creation_date": 1513784958, "answer_id": 47909835, "question_id": 47909759, "link": "https://stackoverflow.com/questions/47909759/pointer-and-char-in-struct/47909835#47909835", "title": "Pointer and char in struct", "body": "<p>Incrementing <code>p</code> with <code>p++</code> or <code>p = p+1</code> moves you to the next instance of <code>struct list</code>, which is not what you want (and it's not even there).</p>\n\n<p>Instead, you want to move to the second letter of <code>name</code>, which can be done in several ways:</p>\n\n<ul>\n<li>Use index on the name - <code>cout &lt;&lt; p-&gt;name[1] &lt;&lt; endl;</code></li>\n<li>Make a pointer to <code>p-&gt;name</code> and increment it, i.e. <code>char *np = p-&gt;name; np++; cout &lt;&lt; *np</code></li>\n<li>Use pointer arithmetic instead of indexing, i.e. <code>cout &lt;&lt; *(p-&gt;name+1) &lt;&lt; endl;</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "is_accepted": false, "score": 2, "last_activity_date": 1513784970, "creation_date": 1513784970, "answer_id": 47909839, "question_id": 47909759, "link": "https://stackoverflow.com/questions/47909759/pointer-and-char-in-struct/47909839#47909839", "title": "Pointer and char in struct", "body": "<p>Use the array <a href=\"http://en.cppreference.com/w/cpp/language/operator_member_access#Built-in_subscript_operator\" rel=\"nofollow noreferrer\">subscript operator</a> with an index of <code>1</code>:</p>\n\n<pre><code>p-&gt;name[1];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1513785519, "creation_date": 1513785519, "answer_id": 47910000, "question_id": 47909759, "link": "https://stackoverflow.com/questions/47909759/pointer-and-char-in-struct/47910000#47910000", "title": "Pointer and char in struct", "body": "<p>If you want to output the second character using pointers without the subscript operator then you can just write</p>\n\n<pre><code>cout &lt;&lt; *( p-&gt;name + 1 ) &lt;&lt; endl;\n</code></pre>\n\n<p>It is the same as</p>\n\n<pre><code>cout &lt;&lt; p-&gt;name[1] &lt;&lt; endl;\n</code></pre>\n\n<p>Or you can introduce an intermediate pointer. For example</p>\n\n<pre><code>for ( const char *q = p-&gt;name; *q != '\\0'; ++q )\n{\n    cout &lt;&lt; *q;\n}\ncout &lt;&lt; endl;\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9123381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bad79b000a5d6a40b2c1d0c1287f14f4?s=128&d=identicon&r=PG&f=1", "display_name": "sajmon", "link": "https://stackoverflow.com/users/9123381/sajmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 47909835, "answer_count": 4, "score": 2, "last_activity_date": 1513790078, "creation_date": 1513784721, "last_edit_date": 1513790078, "question_id": 47909759, "link": "https://stackoverflow.com/questions/47909759/pointer-and-char-in-struct", "title": "Pointer and char in struct", "body": "<p>How to read the second letter in char with a pointer? I can read the whole message \"carp\" and first letter 'c' but I have no idea how to read second letter... Here is my example code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nint main()\n{\n    struct list {\n\n        char name[20];\n        int length;\n    };\n\n    list first ={\n        \"carp\",\n        6,\n    };\n\n    list *p = &amp;first;\n    cout &lt;&lt; p-&gt;name &lt;&lt; endl; // \"carp\"\n    cout &lt;&lt; *p-&gt;name &lt;&lt; endl; // \"c\"\n    p = p + 1;\n    cout &lt;&lt; *p-&gt;name &lt;&lt; endl; // Not working...How to read a?\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "boost", "graph"], "answers": [{"comments": [{"owner": {"reputation": 453, "user_id": 1845783, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ad4e9279ebb131f89b5e70cb40f2b203?s=128&d=identicon&r=PG", "display_name": "andy90", "link": "https://stackoverflow.com/users/1845783/andy90"}, "edited": false, "score": 0, "creation_date": 1513800580, "post_id": 47911251, "comment_id": 82794980, "body": "Works perfect! Thanks a lot."}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 2, "last_activity_date": 1513790244, "creation_date": 1513790244, "answer_id": 47911251, "question_id": 47909707, "link": "https://stackoverflow.com/questions/47909707/find-connected-components-using-boost-graph-library-with-the-vertex-and-edge-ty/47911251#47911251", "title": "Find connected components using Boost Graph library, with the vertex and edge type being boost::listS", "body": "<p>The <a href=\"http://www.boost.org/doc/libs/1_66_0/libs/graph/doc/connected_components.html\" rel=\"nofollow noreferrer\">docs say\u00b9</a> the component map needs to model a writable property map with key <code>vertex_descriptor</code> and storing the compoment id as value.</p>\n\n<p>You should probably use <code>make_assoc_property_map</code> with a map:</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/848687dbbe220cc8\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>std::map&lt;Cluster::vertex_descriptor, int&gt; subclusters;\nint nclusters = boost::connected_components(A, boost::make_assoc_property_map(subclusters)); // find the connected components\n\n\nfor (auto&amp; p : subclusters) {\n    std::cout &lt;&lt; \"Vertex \" &lt;&lt; boost::get(boost::vertex_index, A, p.first) &lt;&lt; \" is in cluster \" &lt;&lt; p.second &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>0 -- 1\n0 -- 2\n1 -- 2\nVertex 0 is in cluster 0\nVertex 1 is in cluster 0\nVertex 2 is in cluster 0\nVertex 3 is in cluster 1\n</code></pre>\n\n<h2>But I Want A Vector</h2>\n\n<p>If you insist, you can still use a vector BUT you'll have to provide the mapping from vertex-descriptor to an integral vertex id:</p>\n\n<pre><code>typedef boost::adjacency_list&lt;\n        boost::listS,\n        boost::listS,\n        boost::undirectedS,\n        boost::property&lt;boost::vertex_index_t, int&gt;\n    &gt; Cluster;\n</code></pre>\n\n<p>Now, you have to fill that property too:</p>\n\n<pre><code>Cluster A;\nadd_vertex(0, A);\nadd_vertex(1, A);\nadd_vertex(2, A);\nadd_vertex(3, A);\n</code></pre>\n\n<p>And then you have to use <code>make_iterator_property_map</code> instead, supplying a vertex index property-map for the indirection:</p>\n\n<pre><code>std::vector&lt;int&gt; subclusters(4);\nauto comp_map = make_iterator_property_map(subclusters.begin(), get(boost::vertex_index, A));\nint nclusters = connected_components(A, comp_map); // find the connected components\n</code></pre>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/c361373df13575d3\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/graph/adjacency_list.hpp&gt;\n#include &lt;boost/graph/connected_components.hpp&gt;\n#include &lt;iostream&gt;\n\ntypedef boost::adjacency_list&lt;\n        boost::listS,\n        boost::listS,\n        boost::undirectedS,\n        boost::property&lt;boost::vertex_index_t, int&gt;\n    &gt; Cluster;\n\nint main() {\n    Cluster A;\n    add_vertex(0, A);\n    add_vertex(1, A);\n    add_vertex(2, A);\n    add_vertex(3, A);\n\n    for (int i = 0; i &lt; 2; i++) {\n        for (int j = (i + 1); j &lt; 3; j++) {\n            std::cout &lt;&lt; i &lt;&lt; \" -- \" &lt;&lt; j &lt;&lt; \"\\n\";\n            add_edge(vertex(i, A), vertex(j, A), A);\n        }\n    } // add edge between 0-1, 0-2, 1-2.\n\n    // NOTE: 4, not \"num_vertices\", but enough to accomodate the highest value\n    // of the `vertex_index` property\n    std::vector&lt;int&gt; subclusters(4);\n    auto comp_map = make_iterator_property_map(subclusters.begin(), get(boost::vertex_index, A));\n    int nclusters = connected_components(A, comp_map); // find the connected components\n\n    for (size_t id = 0; id &lt; subclusters.size(); ++id) {\n        std::cout &lt;&lt; \"Vertex id \" &lt;&lt; id &lt;&lt; \" is in cluster \" &lt;&lt; subclusters.at(id) &lt;&lt; \"\\n\";\n    }\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>0 -- 1\n0 -- 2\n1 -- 2\nVertex id 0 is in cluster 0\nVertex id 1 is in cluster 0\nVertex id 2 is in cluster 0\nVertex id 3 is in cluster 1\n</code></pre>\n\n<hr>\n\n<p>\u00b9 <a href=\"https://i.stack.imgur.com/wCSsq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wCSsq.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 453, "user_id": 1845783, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ad4e9279ebb131f89b5e70cb40f2b203?s=128&d=identicon&r=PG", "display_name": "andy90", "link": "https://stackoverflow.com/users/1845783/andy90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 47911251, "answer_count": 1, "score": 1, "last_activity_date": 1513790244, "creation_date": 1513784516, "question_id": 47909707, "link": "https://stackoverflow.com/questions/47909707/find-connected-components-using-boost-graph-library-with-the-vertex-and-edge-ty", "title": "Find connected components using Boost Graph library, with the vertex and edge type being boost::listS", "body": "<p>I am trying to find connected components in an undirected graph. The graph is represented by <code>boost::adjacency_list</code>. For my application, the vertex and edge type have to be <code>boost::listS</code>. I tried the following code, which doesn't compile. However, if I change the vertex and edge type to <code>boost::vecS</code>, the code will just work fine. Any idea on how to fix the code?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;boost/graph/adjacency_list.hpp&gt;\n#include &lt;boost/graph/connected_components.hpp&gt;\ntypedef boost::adjacency_list&lt;boost::listS,boost::listS,boost::undirectedS&gt; Cluster;\nint main() {\n    using namespace boost;\n    Cluster A;\n    add_vertex(A);\n    add_vertex(A);\n    add_vertex(A);\n    add_vertex(A); // add 4 vertex to the graph\n\n    for (int i=0; i&lt;2; i++){\n        for (int j=(i+1); j&lt;3; j++){\n            std::cout&lt;&lt;i&lt;&lt;\"  \"&lt;&lt;j&lt;&lt;\"\\n\";\n            add_edge(vertex(i,A), vertex(j,A), A);\n        }\n    } // add edge between 0-1, 0-2, 1-2.\n\n    std::vector&lt;int&gt; subclusters(num_vertices(A));\n    int nclusters=boost::connected_components(A, &amp;subclusters[0]); // find the connected components\n}    \n</code></pre>\n"}, {"tags": ["c++", "eigen", "tensor"], "comments": [{"owner": {"reputation": 473, "user_id": 6196947, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c13bc95d3029bb07afb50604d5b5534d?s=128&d=identicon&r=PG&f=1", "display_name": "HermanTheGermanHesse", "link": "https://stackoverflow.com/users/6196947/hermanthegermanhesse"}, "edited": false, "score": 0, "creation_date": 1513785264, "post_id": 47909617, "comment_id": 82787234, "body": "Could you please clarify what the actuall question is? Is the question about why you have to add the compiler flags? If so I&#39;d sugest that you make it a bit clearer."}, {"owner": {"reputation": 31, "user_id": 9123356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a45baff9811b4ddad7557e659cefdebf?s=128&d=identicon&r=PG&f=1", "display_name": "Giuseppe", "link": "https://stackoverflow.com/users/9123356/giuseppe"}, "reply_to_user": {"reputation": 473, "user_id": 6196947, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c13bc95d3029bb07afb50604d5b5534d?s=128&d=identicon&r=PG&f=1", "display_name": "HermanTheGermanHesse", "link": "https://stackoverflow.com/users/6196947/hermanthegermanhesse"}, "edited": false, "score": 0, "creation_date": 1513786801, "post_id": 47909617, "comment_id": 82788151, "body": "Thanks first of all for your fast reply. I am sorry, I just notice my post was ambiguous and misleading, I corrected it now. It is not working for me even with the compiler flags that is what I intended to say! Any ideas what the issue might be? I have no clue if it is my own incompetence, the compiler, CodeBlocks or anything platform related."}, {"owner": {"reputation": 31, "user_id": 9123356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a45baff9811b4ddad7557e659cefdebf?s=128&d=identicon&r=PG&f=1", "display_name": "Giuseppe", "link": "https://stackoverflow.com/users/9123356/giuseppe"}, "edited": false, "score": 0, "creation_date": 1513789869, "post_id": 47909617, "comment_id": 82789809, "body": "Hey there, thanks for your answer as well. Sorry for having been imprecise again. I tried -std=c++0x, -std=c++1 and -std=c++1y separately. The error message you read above was for either of the first two cases, I added the error message for -std=c++1y (which is basically the same as for the aforementioned two plus some additional errors) as well now. The flags in CodeBlocks can simply be set by clicking on them (Compiler flags/general) so I simply did that. I got CodeBlocks 16.01 with GCC 4.9."}], "answers": [{"tags": [], "owner": {"reputation": 1668, "user_id": 486350, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/74a467e1eca5ec8af3624fbcd8ab8516?s=128&d=identicon&r=PG", "display_name": "tianyapiaozi", "link": "https://stackoverflow.com/users/486350/tianyapiaozi"}, "is_accepted": true, "score": 1, "last_activity_date": 1574834026, "creation_date": 1574834026, "answer_id": 59063858, "question_id": 47909617, "link": "https://stackoverflow.com/questions/47909617/problems-with-eigen-tensor-conflicting-declaration/59063858#59063858", "title": "Problems with Eigen Tensor: Conflicting declaration", "body": "<p>That's probably because your compiler doest not support <a href=\"https://en.wikipedia.org/wiki/C%2B%2B14#Variable_templates\" rel=\"nofollow noreferrer\">variable template</a>.\nVariable template is supported since gcc 5. </p>\n\n<p><a href=\"https://www.gnu.org/software/gcc/projects/cxx-status.html\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/gcc/projects/cxx-status.html</a></p>\n\n<p>You can either upgrade compiler or modify eigen source code.</p>\n"}], "owner": {"reputation": 31, "user_id": 9123356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a45baff9811b4ddad7557e659cefdebf?s=128&d=identicon&r=PG&f=1", "display_name": "Giuseppe", "link": "https://stackoverflow.com/users/9123356/giuseppe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "accepted_answer_id": 59063858, "answer_count": 1, "score": 2, "last_activity_date": 1574834026, "creation_date": 1513784242, "last_edit_date": 1513790086, "question_id": 47909617, "link": "https://stackoverflow.com/questions/47909617/problems-with-eigen-tensor-conflicting-declaration", "title": "Problems with Eigen Tensor: Conflicting declaration", "body": "<p>I just tried to test the Eigen Tensor module in CodeBlocks 16.01 with GCC 4.9. As suggested by <a href=\"http://eigen.tuxfamily.org/index.php?title=Tensor_support\" rel=\"nofollow noreferrer\">http://eigen.tuxfamily.org/index.php?title=Tensor_support</a> I added -std=c++0x, -std=c++11 or -std=c++1y as compiler flags but I can't make it work. Already </p>\n\n<pre><code>#include &lt;unsupported/Eigen/CXX11/Tensor&gt;\n</code></pre>\n\n<p>yields error message depending on the flags I use. In case of -std=c++0x or -std=c++11</p>\n\n<pre><code>||=== Build: Debug in Test (compiler: GNU GCC Compiler) ===|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\Tensor|52|error: conflicting declaration 'typedef long int int32_t'|\nC:\\Program Files (x86)\\CodeBlocks\\MinGW\\include\\stdint.h|31|note: previous declaration as 'typedef int int32_t'|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\Tensor|53|error: conflicting declaration 'typedef long unsigned int uint32_t'|\nC:\\Program Files (x86)\\CodeBlocks\\MinGW\\include\\stdint.h|32|note: previous declaration as 'typedef unsigned int uint32_t'|\n||=== Build failed: 2 error(s), 0 warning(s) (0 minute(s), 1 second(s)) ===|\n</code></pre>\n\n<p>and in the case of -std=c++1y I get additional error messages:</p>\n\n<pre><code>||=== Build: Debug in Test (compiler: GNU GCC Compiler) ===|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\util\\IntegralConstant.h|187|error: template declaration of 'const Eigen::internal::FixedInt&lt;N&gt; Eigen::fix'|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\util\\IndexedViewHelper.h|63|error: 'fix' was not declared in this scope|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\util\\IndexedViewHelper.h|63|error: expected primary-expression before ')' token|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\ArithmeticSequence.h|142|error: 'fix' was not declared in this scope|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\ArithmeticSequence.h|142|error: 'fix' was not declared in this scope|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\ArithmeticSequence.h|142|error: expected primary-expression before ')' token|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\ArithmeticSequence.h||In member function 'decltype (Eigen::seqN((((const Eigen::ArithmeticSequence&lt;FirstType, SizeType, IncrType&gt;*)this)-&gt;Eigen::ArithmeticSequence&lt;FirstType, SizeType, IncrType&gt;::m_first + ((((((const Eigen::ArithmeticSequence&lt;FirstType, SizeType, IncrType&gt;*)this)-&gt;Eigen::ArithmeticSequence&lt;FirstType, SizeType, IncrType&gt;::m_size + &lt;expression error&gt;) &lt; (-1)) &gt; &lt;expression error&gt;) * ((const Eigen::ArithmeticSequence&lt;FirstType, SizeType, IncrType&gt;*)this)-&gt;Eigen::ArithmeticSequence&lt;FirstType, SizeType, IncrType&gt;::|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\ArithmeticSequence.h|143|error: 'fix' was not declared in this scope|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\ArithmeticSequence.h|143|error: expected primary-expression before ')' token|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\ArithmeticSequence.h|207|error: 'fix' was not declared in this scope|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\ArithmeticSequence.h|207|error: 'fix' was not declared in this scope|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\ArithmeticSequence.h|207|error: expected primary-expression before ')' token|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\ArithmeticSequence.h||In function 'decltype (Eigen::seqN((typename Eigen::internal::cleanup_index_type&lt;FirstType&gt;::type)(f), (((((typename Eigen::internal::cleanup_index_type&lt;SizeType&gt;::type)(l) - (typename Eigen::internal::cleanup_index_type&lt;FirstType&gt;::type)(f)) + &lt;expression error&gt;) &lt; 1) &gt; &lt;expression error&gt;))) Eigen::seq(FirstType, LastType)':|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\ArithmeticSequence.h|211|error: 'fix' was not declared in this scope|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\..\\..\\..\\Eigen\\src\\Core\\ArithmeticSequence.h|211|error: expected primary-expression before ')' token|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\Tensor|52|error: conflicting declaration 'typedef long int int32_t'|\nC:\\Program Files (x86)\\CodeBlocks\\MinGW\\include\\stdint.h|31|note: previous declaration as 'typedef int int32_t'|\nC:\\Program Files (x86)\\CodeBlocks\\eigen-eigen-c2947c341c68\\unsupported\\Eigen\\CXX11\\Tensor|53|error: conflicting declaration 'typedef long unsigned int uint32_t'|\nC:\\Program Files (x86)\\CodeBlocks\\MinGW\\include\\stdint.h|32|note: previous declaration as 'typedef unsigned int uint32_t'|\n||=== Build failed: 15 error(s), 0 warning(s) (0 minute(s), 1 second(s)) ===|\n</code></pre>\n\n<p>Any ideas on what I did wrong or how to fix it?\nThanks in advance</p>\n"}, {"tags": ["c++", "algorithm", "floating-point"], "comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 2, "creation_date": 1513785584, "post_id": 47909541, "comment_id": 82787442, "body": "&quot;should give an idea of what I am doing&quot; - we strongly prefer the exact code, cleaned up, in the question itself. I can see why you&#39;re hesitant to add it to the question now - that&#39;s already very long. But that&#39;s because it&#39;s rather big on words. We trust you can implement addition, no need to tell us."}, {"owner": {"reputation": 580, "user_id": 1777995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd39683c1c5faa6458efd81104b401d?s=128&d=identicon&r=PG", "display_name": "Marco Giordano", "link": "https://stackoverflow.com/users/1777995/marco-giordano"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1513786322, "post_id": 47909541, "comment_id": 82787890, "body": "sure thing, I removed the code that was not directly related to the division from the gist."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1513787522, "post_id": 47909541, "comment_id": 82788567, "body": "Check how the C++ code is doing float operations for example with doubles the Intel FPU can use 80 bits (not 64) there maybe a similar extensions for float.  Also there are compiler flags to control the precision/accuracy of float and double operations.  Also this blog has lots of information on implementation errors/issues and edge cases: <a href=\"https://randomascii.wordpress.com/category/floating-point/\" rel=\"nofollow noreferrer\">randomascii.wordpress.com/category/floating-point</a>"}, {"owner": {"reputation": 580, "user_id": 1777995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd39683c1c5faa6458efd81104b401d?s=128&d=identicon&r=PG", "display_name": "Marco Giordano", "link": "https://stackoverflow.com/users/1777995/marco-giordano"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1513789080, "post_id": 47909541, "comment_id": 82789418, "body": "@RichardCritten thanks for the reply, I do know that blog post, I am slowly working my way through, in my specific case, I have computed extra 4 bits mantissa, that under the grs rounding scheme to even is the only bits I need. So even if I round up or down the extra bits of mantissa there is not carrying that would make the sticky bit to flip making the round to occur. That s where I am stuck at the moment, the extra bits of accuracy won&#39;t help me. Meanwhile, I will try to dig out useful information from that blog. If interested I can print out many more bits of accuracy from the mantissa."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1513793385, "post_id": 47909541, "comment_id": 82791655, "body": "www.jhauser.us/arithmetic/TestFloat.html as well as SoftFloat same author, source code for beating up on a floating point unit as well as a soft float library, so there may be something of interest there to show how he did it."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1513793587, "post_id": 47909541, "comment_id": 82791747, "body": "maybe you want to add/shift a couple of bits on the numerator before doing the fixed point divide, giving you a result that is 4 or so times too large, then you can examine/round before shifting those back off ( x/y = (4x/4y) = (4x/y)/4 ).  could leave many bits 5 or 8 or 16, ..."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 2, "creation_date": 1513800215, "post_id": 47909541, "comment_id": 82794823, "body": "What&#39;s the reason that you use bit-by-bit division? You could utilize integer division, so your code will be much faster. And use the remainder to decide rounding direction."}, {"owner": {"reputation": 580, "user_id": 1777995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd39683c1c5faa6458efd81104b401d?s=128&d=identicon&r=PG", "display_name": "Marco Giordano", "link": "https://stackoverflow.com/users/1777995/marco-giordano"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1513805739, "post_id": 47909541, "comment_id": 82797362, "body": "@old_timer interesting approach, that would make the sticky bit to some work, i will test it."}, {"owner": {"reputation": 580, "user_id": 1777995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd39683c1c5faa6458efd81104b401d?s=128&d=identicon&r=PG", "display_name": "Marco Giordano", "link": "https://stackoverflow.com/users/1777995/marco-giordano"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1513805805, "post_id": 47909541, "comment_id": 82797386, "body": "@geza right now the focus is not on performance but correctness, once the algorithm is solid I will see how to make it faster."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1513806716, "post_id": 47909541, "comment_id": 82797734, "body": "Hmm.. With integer division the code is simpler, faster, and surely solid (you just need to check out the remainder, as far as I know). It is better in every way... This code doesn&#39;t need long division, where bit-by-bit division is common (I could be wrong, of course, I&#39;ve never implemented SW floating point - but I currently don&#39;t see the point of bit-by-bit division)."}, {"owner": {"reputation": 580, "user_id": 1777995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd39683c1c5faa6458efd81104b401d?s=128&d=identicon&r=PG", "display_name": "Marco Giordano", "link": "https://stackoverflow.com/users/1777995/marco-giordano"}, "edited": false, "score": 0, "creation_date": 1513831994, "post_id": 47909541, "comment_id": 82804146, "body": "The point is simply learning, when I implemented multiplication, I started with the n^2 bit multiplication, then moved to just shift the whole number in and add. Ideally, at one point, I would like to get to the point where I don&#39;t use any hardware operation, but even addition is implemented in software. Utterly useless but a fun exercise. I will most likely implement as you say. To be honest I did not think of it and is a great idea. thank you for it"}], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 1777995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd39683c1c5faa6458efd81104b401d?s=128&d=identicon&r=PG", "display_name": "Marco Giordano", "link": "https://stackoverflow.com/users/1777995/marco-giordano"}, "edited": false, "score": 0, "creation_date": 1513832047, "post_id": 47911341, "comment_id": 82804161, "body": "Thank you for you reply, and thank you for the correction on mantissa vs significand, I did not know the &quot;legacy&quot; meaning of it. The solution you propose with &quot;any&quot; of the extra bit after the grs to influence the sticky makes so much sense!  I am gonna try and let you know. I wonder how many extra bits of precision are needed. Anyone know what modern CPU do in hardware in that regards?"}, {"owner": {"reputation": 580, "user_id": 1777995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd39683c1c5faa6458efd81104b401d?s=128&d=identicon&r=PG", "display_name": "Marco Giordano", "link": "https://stackoverflow.com/users/1777995/marco-giordano"}, "edited": false, "score": 0, "creation_date": 1513855600, "post_id": 47911341, "comment_id": 82815380, "body": "thank you, good sir, for the help, looks like your solution worked, right know it is crunchy division and all pass, it has done 86 millions one and counting. Thanks a lot"}, {"owner": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "reply_to_user": {"reputation": 580, "user_id": 1777995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd39683c1c5faa6458efd81104b401d?s=128&d=identicon&r=PG", "display_name": "Marco Giordano", "link": "https://stackoverflow.com/users/1777995/marco-giordano"}, "edited": false, "score": 1, "creation_date": 1513953894, "post_id": 47911341, "comment_id": 82856145, "body": "@MarcoGiordano You should not use any finite number of extra bits. &quot;any of the bits at or beyond that position in the exact mathematical result would be non-zero&quot; is exactly equivalent to &quot;the current remainder is non-zero&quot;."}, {"owner": {"reputation": 580, "user_id": 1777995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd39683c1c5faa6458efd81104b401d?s=128&d=identicon&r=PG", "display_name": "Marco Giordano", "link": "https://stackoverflow.com/users/1777995/marco-giordano"}, "reply_to_user": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 0, "creation_date": 1514020985, "post_id": 47911341, "comment_id": 82872035, "body": "@PatriciaShanahan interesting, so you are telling me if I get a reminder after computing the grs bits I just set the sticky bits?"}], "tags": [], "owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 7, "last_activity_date": 1513800942, "last_edit_date": 1513800942, "creation_date": 1513790566, "answer_id": 47911341, "question_id": 47909541, "link": "https://stackoverflow.com/questions/47909541/software-implementation-of-floating-point-division-issues-with-rounding/47911341#47911341", "title": "Software implementation of floating point division, issues with rounding", "body": "<p>The result you get from the division algorithm is inadequate. You show:</p>\n\n<pre><code> 010100111100100011110000 0100\n ------------------------ ----\n ^                        grs^\n |__ to be normalized        |____ extra bit\n</code></pre>\n\n<p>The mathematically exact quotient continues:</p>\n\n<pre><code> 010100111100100011110000 0100 110000111100100100011110\u2026\n</code></pre>\n\n<p>Thus, the residue at the point where you are rounding exceeds \u00bd ULP, so it should be rounded up. I did not study your code in detail, but it looks like you may have just calculated an extra bit or two of the significand<sup>1</sup>. You actually need to know that the residue is non-zero, not just whether its next bit or two is zero. The final sticky bit should be one if <strong>any</strong> of the bits at or beyond that position in the exact mathematical result would be non-zero.</p>\n\n<h3>Footnote</h3>\n\n<p><sup>1</sup> \u201cSignificand\u201d is the preferred term. \u201cMantissa\u201d is a legacy term for the fraction portion of a logarithm. The significand of a floating-point value is linear. A mantissa is logarithmic.</p>\n"}], "owner": {"reputation": 580, "user_id": 1777995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd39683c1c5faa6458efd81104b401d?s=128&d=identicon&r=PG", "display_name": "Marco Giordano", "link": "https://stackoverflow.com/users/1777995/marco-giordano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 47911341, "answer_count": 1, "score": 9, "last_activity_date": 1514494279, "creation_date": 1513784000, "last_edit_date": 1514494279, "question_id": 47909541, "link": "https://stackoverflow.com/questions/47909541/software-implementation-of-floating-point-division-issues-with-rounding", "title": "Software implementation of floating point division, issues with rounding", "body": "<p>As a learning project I am implementing floating point operations (add, sub, mul, div) in software using c++. The goal is to be more comfortable with the underlying details of floating point behavior. </p>\n\n<p>I am trying to match my processor operations to the exact bit, meaning IEEE 754 standard. So far it has been working great, add, sub and mult behave perfectly, I tested it on around 110 million random operations and got the same exact result to what the processor does in hardware. (Although did not take into account edge cases, overflow etc).</p>\n\n<p>After that, I started moving to the last operation, division. It works fine and achieves the wanted result, but from time to time, I get the last mantissa bit wrong, not rounded up. I am having a bit of hard time understanding why.\nThe main reference I have been using is the great talk from <strong>John Farrier</strong> (the time stamp is at the point where it shows how to round):</p>\n\n<p><a href=\"https://youtu.be/k12BJGSc2Nc?t=1153\" rel=\"nofollow noreferrer\">https://youtu.be/k12BJGSc2Nc?t=1153</a></p>\n\n<p>That rounding has been working really well for all operation but is giving me troubles for the division. \nLet me give you a specific example.\nI am trying to divide 645.68011474609375 by 493.20962524414063</p>\n\n<p>The final result I get is :</p>\n\n<p>mine :  0-01111111-0100111100100011110000<strong>0</strong></p>\n\n<p>c++_  :  0-01111111-0100111100100011110000<strong>1</strong></p>\n\n<p>As you can see everything matches except for the last bit. The way I am computing the division is based on this video:\n<a href=\"https://www.youtube.com/watch?v=fi8A4zz1d-s\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=fi8A4zz1d-s</a></p>\n\n<p>Following this, I compute 28 bits off accuracy 24 of mantissa ( hidden one + 23 mantissa) and the 3 bits for guard, round sticky plus an extra one for the possible shift.\nUsing the algorithm of the video, I can at maximum get a normalization shift of 1, that s why I have an extra bit at the end in case gets shifted in in the normalization, so will be available in the rounding. Now here is the result I get from the division algorithm:</p>\n\n<pre><code> 010100111100100011110000 0100\n ------------------------ ----\n ^                        grs^\n |__ to be normalized        |____ extra bit\n</code></pre>\n\n<p>As you can see I get a 0 in the 24th position, so I will need to shift on the left by one to get the correct normalization. \nThis mean I will get:</p>\n\n<pre><code>10100111100100011110000 100\n</code></pre>\n\n<p>Based on the video of John Farrier, in the case of <strong>100</strong> grs bits, I only normalize if the LSB of the mantissa is a 1. In my case is a zero, and that is why I do not round up my result.</p>\n\n<p>The reason why I am a bit lost is that I am sure my algorithm is computing the right mantissa, I have double checked it with online calculators, the rounding strategy works for all the other operations. Also, computing in this way, triggers the normalization, which yields, in the end, the correct exponent. </p>\n\n<p>Am I missing something ? a small detail somewhere? </p>\n\n<p>One thing that strikes me as odd is the sticky bits, in the addition and multiplication you get a different degree of shifting, which leads to higher chances of the sticky bits to trigger, in this case here, I shift only by one maximum which puts the sticky bits as to be not really sticky.</p>\n\n<p>I do hope I gave enough details to make my problem understood. Here you can find at the bottom my division implementation, is a bit filled with prints I am using for debugging but should give an idea of what I am doing, the code starts at line 374:</p>\n\n<p><a href=\"https://gist.github.com/giordi91/1388504fadcf94b3f6f42103dfd1f938\" rel=\"nofollow noreferrer\">https://gist.github.com/giordi91/1388504fadcf94b3f6f42103dfd1f938</a></p>\n\n<p>PS: meanwhile I am going through the \"everything scientist should know about floating point numbers\" in order to see if I missed something.</p>\n"}, {"tags": ["c++", "for-loop"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513783862, "post_id": 47909479, "comment_id": 82786263, "body": "use <code>+</code> instead of <code>&lt;&lt;</code>"}, {"owner": {"reputation": 31, "user_id": 5980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7395e06e2ed9c0d3c7b1a11e86510166?s=128&d=identicon&r=PG", "display_name": "newbie123", "link": "https://stackoverflow.com/users/5980490/newbie123"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513783922, "post_id": 47909479, "comment_id": 82786307, "body": "Like inputImages[x] = readPPM(&quot;Images/ImageStacker_set1/IMG_&quot; + x +&quot;.ppm&quot;); ?"}, {"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513783964, "post_id": 47909479, "comment_id": 82786330, "body": "That will error @Fureeish you need to use <code>to_string</code> look at my answer."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7395e06e2ed9c0d3c7b1a11e86510166?s=128&d=identicon&r=PG", "display_name": "newbie123", "link": "https://stackoverflow.com/users/5980490/newbie123"}, "edited": false, "score": 0, "creation_date": 1513784130, "post_id": 47909518, "comment_id": 82786435, "body": "When I do it like this inputImages[x] = readPPM(&quot;Images/ImageStacker_set1/IMG_&quot; + std::to_string( x ) + &quot;.ppm&quot;); I get the error: no suitable conversion function from &quot;std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt;&gt;&quot; to &quot;const char *&quot;"}, {"owner": {"reputation": 31, "user_id": 5980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7395e06e2ed9c0d3c7b1a11e86510166?s=128&d=identicon&r=PG", "display_name": "newbie123", "link": "https://stackoverflow.com/users/5980490/newbie123"}, "edited": false, "score": 0, "creation_date": 1513784337, "post_id": 47909518, "comment_id": 82786585, "body": "New error: expression must have integral or unscoped enum type ?"}, {"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "reply_to_user": {"reputation": 31, "user_id": 5980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7395e06e2ed9c0d3c7b1a11e86510166?s=128&d=identicon&r=PG", "display_name": "newbie123", "link": "https://stackoverflow.com/users/5980490/newbie123"}, "edited": false, "score": 0, "creation_date": 1513784608, "post_id": 47909518, "comment_id": 82786782, "body": "@newbie123 this should work I did not realize your method took a <code>const char *</code> till now."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1513800205, "post_id": 47909518, "comment_id": 82794816, "body": "You don&#39;t need to copy the final result of the concatenation to yet another temp <code>std::string</code>, as it is already a <code>std::string</code> due to one of the concatenations using <code>std::to_string()</code>. You can replace <code>string(</code> with just <code>(</code>, eg: <code>readPPM((&quot;Images&#47;ImageStacker_set1&#47;IMG_&quot; + to_string(x) + &quot;.ppm&quot;).c_str());</code>"}], "tags": [], "owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "is_accepted": true, "score": 3, "last_activity_date": 1513799939, "last_edit_date": 1513799939, "creation_date": 1513783937, "answer_id": 47909518, "question_id": 47909479, "link": "https://stackoverflow.com/questions/47909479/changing-a-filename-by-incrementing/47909518#47909518", "title": "Changing a filename by incrementing", "body": "<p>A very quick way to solve this:</p>\n\n<pre><code>inputImages[x] = readPPM(string(\"Images/ImageStacker_set1/IMG_\" + to_string( x ) + \".ppm\").c_str());\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7395e06e2ed9c0d3c7b1a11e86510166?s=128&d=identicon&r=PG", "display_name": "newbie123", "link": "https://stackoverflow.com/users/5980490/newbie123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 47909518, "answer_count": 1, "score": 2, "last_activity_date": 1513799939, "creation_date": 1513783829, "question_id": 47909479, "link": "https://stackoverflow.com/questions/47909479/changing-a-filename-by-incrementing", "title": "Changing a filename by incrementing", "body": "<p>So I have this for loop:</p>\n\n<pre><code>for (int x = 1; x &lt; 13; x++)\n{\n    inputImages.push_back(Image(3264, 2448));\n    inputImages[x] = readPPM(\"Images/ImageStacker_set1/IMG_1.ppm\");\n}\n</code></pre>\n\n<p>What i'm trying to do is to add the loop variable to the filename so it will  increment the filename where it says:</p>\n\n<pre><code>IMG_1.ppm\n</code></pre>\n\n<p>To replace the 1 with the variable x so each time it loops it will add a new file to the array.</p>\n\n<p>I tried something like this but it didn't work:</p>\n\n<pre><code>inputImages[x] = readPPM(\"Images/ImageStacker_set1/IMG_\"&lt;&lt; x &lt;&lt;\".ppm\");\n</code></pre>\n\n<p>Does anyone have a method for doing this?</p>\n"}, {"tags": ["c++", "make-shared"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513783686, "post_id": 47909350, "comment_id": 82786156, "body": "You can&#39;t use <code>shared_ptr</code> with arrays, <b>but</b> you can use <code>unique_ptr</code> to achieve so. Is <code>shared_ptr</code> a necessity? And is so <code>boost</code>? How about simply <code>auto c_ptr = std::make_unique&lt;char[]&gt;(50);</code>? To my knowledge the <code>shared_ptr</code> to plain arrays will be added in C++20"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1513783737, "post_id": 47909350, "comment_id": 82786182, "body": "Since C++17 shared pointers have the <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr/operator_at\" rel=\"nofollow noreferrer\"><code>operator[]</code></a>."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1513783810, "post_id": 47909350, "comment_id": 82786237, "body": "@Ron <code>auto ptr = std::make_shared&lt;char[]&gt;(50);</code> fails to compile with <code>-std=c++17</code> on my compiler"}, {"owner": {"reputation": 682, "user_id": 4840709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d67ac35e92ce156184d57b81fe2d644?s=128&d=identicon&r=PG", "display_name": "M.L.", "link": "https://stackoverflow.com/users/4840709/m-l"}, "edited": false, "score": 0, "creation_date": 1513783890, "post_id": 47909350, "comment_id": 82786280, "body": "Why char[] and not a std::vector&lt;char&gt; ?"}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 0, "creation_date": 1513784059, "post_id": 47909350, "comment_id": 82786384, "body": "What version of boost are you using? New versions support allocating an array using <code>boost::make_shared</code> (see <a href=\"http://www.boost.org/doc/libs/1_66_0/libs/smart_ptr/doc/html/smart_ptr.html#make_shared\" rel=\"nofollow noreferrer\">this</a>). <code>std::make_shared</code> will also gain this ability in C++20."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 1, "creation_date": 1513784117, "post_id": 47909350, "comment_id": 82786427, "body": "@Fureeish Using <code>make_shared</code> - no, using the constructor - yes. <a href=\"http://open-std.org/JTC1/SC22/WG21/docs/papers/2017/p0674r0.html\" rel=\"nofollow noreferrer\">Relevant reading</a>."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1513784233, "post_id": 47909350, "comment_id": 82786502, "body": "@Ron thank you for clarifying"}], "owner": {"reputation": 61, "user_id": 6067946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ebced6e60917053b1a36daffce10f5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Courtright", "link": "https://stackoverflow.com/users/6067946/joseph-courtright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513783444, "creation_date": 1513783444, "question_id": 47909350, "link": "https://stackoverflow.com/questions/47909350/error-when-attempting-to-use-make-shared-invalid-use-of-sizeof-to-incomplet", "title": "Error when attempting to use make_shared -- Invalid use of &#39;sizeof&#39; to incomplete type &#39;char[]&#39;", "body": "<p>I have been trying to dynamically allocate a shared pointer in C++.  However, I keep getting the errors</p>\n\n<pre><code>/usr/include/boost/make_shared.hpp:15:0: In installation of 'class boost::detail::sp_ms_deleter&lt;char []&gt;':\nIn file included from /usr/include/boost/make_shared.hpp:15:0,\n       from main.cpp:10:\n/usr.include/boost/smart_ptr/make_shared.hpp:140:64:    required from 'boost::shared_ptr&lt;X&gt; boost::make_shared(Args&amp;&amp; ... ) [with T = char []; Args = { char*} ]'\n/usr/include/smart_ptr/make_shared.hpp:41:48: error: invalid application of 'sizeof' to incomplete type 'char []'\n\nboost::shared_ptr&lt;char[]&gt; A = boost::make_shared&lt;char[]&gt;(50);\n</code></pre>\n\n<p>Using std::shared_ptr I get similar errors.</p>\n\n<p>I need a way to allocate a dynamic array without using the new keywords as these are project requirements, so another method of doing that could be a valid solution for me as well.</p>\n"}, {"tags": ["c++", "algorithm", "sorting", "heapsort"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 3, "creation_date": 1513783306, "post_id": 47909270, "comment_id": 82785911, "body": "&quot;<b>array size must have integral or enumeration type, not double</b>&quot; - well, you try to declare the size of an array as <code>[N]</code>, while <code>N</code> is a <code>double</code>. You can&#39;t have an array of a size <code>double</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1513783315, "post_id": 47909270, "comment_id": 82785917, "body": "the mistake is that you are using a <code>double</code> as array size when it should be of integral or enumeration type..."}], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 2139902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0050129417b8d5d74968630b13da64c?s=128&d=identicon&r=PG", "display_name": "Sean Burton", "link": "https://stackoverflow.com/users/2139902/sean-burton"}, "edited": false, "score": 0, "creation_date": 1513791657, "post_id": 47909426, "comment_id": 82790751, "body": "Or just change the type of N to int where it&#39;s declared, as it doesn&#39;t look like it makes much sense to be using a non-integral type to begin with."}], "tags": [], "owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1513783661, "creation_date": 1513783661, "answer_id": 47909426, "question_id": 47909270, "link": "https://stackoverflow.com/questions/47909270/heap-sort-and-insertion-sort/47909426#47909426", "title": "Heap sort and insertion sort", "body": "<p>A quick solution would be to replace anywhere you use the subscript(<code>[]</code>) operator do this instead: <code>A = new double[(int)N];</code></p>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 9, "user_id": 9010095, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ba169646e1c174c4b3759f785501d017?s=128&d=identicon&r=PG&f=1", "display_name": "whaHa", "link": "https://stackoverflow.com/users/9010095/whaha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513791067, "creation_date": 1513783207, "last_edit_date": 1513791067, "question_id": 47909270, "link": "https://stackoverflow.com/questions/47909270/heap-sort-and-insertion-sort", "title": "Heap sort and insertion sort", "body": "<p>I want to make a c++ program that runs two algorithms -  insertion and heap sort. But I keep getting an error that array size must have integral or enumeration type, not double. Where are my mistakes? I'm reading data from file. </p>\n\n<pre><code>#include \"stdafx.h\"\n\n#include &lt;stdio.h&gt;\n#include &lt;tchar.h&gt;\n#include &lt;random&gt;\n#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;time.h&gt;\n\nvoid generuoti(int _N, const char *_file);\nvoid nuskaityti(const char *_file);\n\nvoid sortInsertion(double A[], int N);\n\nvoid heapSort(double A[], int N);\nvoid heapify(double A[], int N, int i);\n\nusing namespace std;\n\ndouble *Data;\ndouble* A;\ndouble* B;\n\ndouble* A1;\ndouble* B1;\ndouble N;\n\nunsigned long int palyginimai1 = 0;\nunsigned long int priskyrimai1 = 0;\n\nunsigned long int palyginimai2 = 0;\nunsigned long int priskyrimai2 = 0;\n\nint main()\n{\n    srand(time(NULL));\n    cout &lt;&lt; \"generuojame atsitktinius duomenis ...\" &lt;&lt; endl;\n    generuoti(106000, \"duom.txt\");\n    cout &lt;&lt; \"nuskaitome duomenis ...\" &lt;&lt; endl;\n    nuskaityti(\"duom.txt\");\n    A = new double[N];\n    B = new double[N];\n\n    A1 = new double[N];\n    B1 = new double[N];\n    for (int i = 0; i &lt; N; i++) {\n        A[i] = Data[i];\n    }\n\n    //cout &lt;&lt; \"Heap array:\" &lt;&lt; endl;\n    for (int i = 0; i &lt; N; i++)\n        //cout &lt;&lt; A[i] &lt;&lt; \" \";\n    //cout &lt;&lt; endl;\n\n    //cout &lt;&lt; \"Insertion array: \" &lt;&lt; endl;\n    for (int i = 0; i &lt; N; i++)\n    {\n        B[i] = A[i];\n        //cout &lt;&lt; B[i] &lt;&lt; \" \";\n    }\n\n    for (int i = 0; i &lt; N; i++)\n    {\n        A1[i] = A[i];\n        B1[i] = B[i];\n    }\n    //cout &lt;&lt; endl;\n    int nUntil = 2000;\n    while (nUntil &lt;= 106000)\n    {\n        sortInsertion(B1, nUntil);\n        heapSort(A1, nUntil);\n        cout &lt;&lt; priskyrimai1 &lt;&lt; endl;\n        nUntil = nUntil * 2;\n\n        for (int i = 0; i &lt; N; i++)\n        {\n            A1[i] = A[i];\n            B1[i] = B[i];\n        }\n\n\n        //cout &lt;&lt; nUntil &lt;&lt; palyginimai2 &lt;&lt; \" \" &lt;&lt; priskyrimai2 &lt;&lt; endl;\n    }\n\n\n    /*cout &lt;&lt; \"Surusiuota skaiciu seka Heap:\" &lt;&lt; endl;\n    for (int i = 0; i &lt; N; i++)\n        cout &lt;&lt; A1[i] &lt;&lt; \" \";\n    cout &lt;&lt; endl;\n\n    cout &lt;&lt; \"Surusiuota skaiciu seka Insertion:\" &lt;&lt; endl;\n    for (int i = 0; i &lt; N; i++)\n        cout &lt;&lt; B1[i] &lt;&lt; \" \";\n    cout &lt;&lt; endl;*/\n\n\n\n\n    system(\"pause\");\n    return 0;\n}\n\nvoid generuoti(int _N, const char *_file) {\n    ofstream os(_file);\n    os &lt;&lt; _N &lt;&lt; endl;\n    for (int i = 0; i &lt; _N; i++)\n    {\n        os &lt;&lt; \" \" &lt;&lt; (double)(rand() % 1001) / (double)1000;\n    }\n    //os &lt;&lt; \" \" &lt;&lt; (double)13 &lt;&lt; \" \" &lt;&lt; (double)18 &lt;&lt; \" \" &lt;&lt; (double)25 &lt;&lt; \" \" &lt;&lt; (double)2 &lt;&lt; \" \" &lt;&lt; (double)6 &lt;&lt; \" \" &lt;&lt; (double)11 &lt;&lt; \" \" &lt;&lt; (double)16 &lt;&lt; \" \" &lt;&lt; (double)1 &lt;&lt; \" \" &lt;&lt; (double)6 &lt;&lt; \" \" &lt;&lt; (double)21 &lt;&lt; \" \" &lt;&lt; (double)17;\n    os.close();\n}\n\nvoid nuskaityti(const char *_file) {\n    ifstream is(_file);\n    if (is.fail()) {\n        cout &lt;&lt; \"failo nera\" &lt;&lt; endl;\n        exit(1);\n    }\n    is &gt;&gt; N;\n    Data = new double[N];\n    for (int i = 0; i &lt; N; i++) {\n        is &gt;&gt; Data[i];\n    }\n}\n\nvoid sortInsertion(double A[], int N) {\n    double temp;\n    int hole;\n\n    for (int i = 1; i &lt; N; i++)\n    {\n        palyginimai1++;\n        temp = A[i];\n        hole = i;\n        while (hole &gt; 0 &amp;&amp; A[hole - 1] &gt; temp)\n        {\n            palyginimai1++;\n            A[hole] = A[hole - 1];\n            priskyrimai1++;\n            hole--;\n\n        } \n        priskyrimai1++;\n        A[hole] = temp;\n    } \n}\n\nvoid heapify(double A[], int N, int i)\n{\n    int largest = i;\n    int l = 2 * i + 1;\n    int r = 2 * i + 2;\n    priskyrimai2 = priskyrimai2 + 3;\n\n    if (l &lt; N &amp;&amp; A[l] &gt; A[largest])\n    {\n        largest = l;\n        priskyrimai2++;\n    }\n\n    if (r &lt; N &amp;&amp; A[r] &gt; A[largest])\n    {\n        largest = r;\n        priskyrimai2++;\n    }\n\n\n    if (largest != i)\n    {\n        swap(A[i], A[largest]);\n        heapify(A, N, largest);\n        palyginimai2++;\n        priskyrimai2++;\n    }\n}\n\nvoid heapSort(double A[], int N)\n{\n    for (int i = N / 2 - 1; i &gt;= 0; i--)\n    {\n        heapify(A, N, i);\n        palyginimai2++;\n    }\n\n\n    for (int i = N - 1; i &gt;= 0; i--)\n    {\n        swap(A[0], A[i]);\n        priskyrimai2++;\n        heapify(A, i, 0);\n        palyginimai2++;\n    }\n}\n</code></pre>\n\n<p>Also, I'm counting palyginimai - comparisons, priskyrimai-assignments. </p>\n"}, {"tags": ["c++", "inheritance", "language-lawyer"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1513783140, "post_id": 47909196, "comment_id": 82785808, "body": "If you want to successfully cast from one type to another outside of those class&#39; scopes, you should use <code>public</code> inheritence, instead of <code>protected</code> one"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1513783527, "post_id": 47909196, "comment_id": 82786055, "body": "It is a valid question though it is not clear how existance of method <code>get()</code> prevents user code to mess with base."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513784890, "post_id": 47909196, "comment_id": 82786963, "body": "Do you pass <code>test()</code> by name? Otherwise I think there is no need for extern &quot;C&quot; and it can be a static method of <code>B</code>"}, {"owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1514888488, "post_id": 47909196, "comment_id": 83090553, "body": "@Slava the <code>extern &quot;C&quot;</code> also forces the compiler to use C calling conventions and disable name mangeling for the function. if this would not be the case, the call of the function would screw up the stack since the C-Code would have a different idea about how to transfer parameter to the called function."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1514900930, "post_id": 47909196, "comment_id": 83096805, "body": "That&#39;s why I asked if you pass <code>test()</code> by name. If not then name mangling does not matter. As for calling convention that&#39;s compiler specific, on gcc Inever had any problems passing C++ functions to C routines, like pthread."}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513783599, "post_id": 47909389, "comment_id": 82786105, "body": "I doubt you can use <code>dynamic_cast</code> with POD"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513783704, "post_id": 47909389, "comment_id": 82786166, "body": "@Slava Yep, I missed that. Thank you for comment."}, {"owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "edited": false, "score": 0, "creation_date": 1513783839, "post_id": 47909389, "comment_id": 82786250, "body": "using an A-Member disables me to retreive the B-Pointer in the callback."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513783918, "post_id": 47909389, "comment_id": 82786302, "body": "Though having those 2 methods just a convoluted way of making that inheritance public"}, {"owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "edited": false, "score": 0, "creation_date": 1513784171, "post_id": 47909389, "comment_id": 82786460, "body": "<code>reinterpret_cast</code> is also not wrong because it breaks the addresses because <code>B</code> also inherits from another class."}, {"owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513784384, "post_id": 47909389, "comment_id": 82786622, "body": "@Slava no, as stated, the <code>test</code> function is some callback, that gets called from C-Code and it retrieves the C++-Object and calls the appropriate member-function. From the rest of the C++ Code this C-Wrapping should be hidden and direct access to the C-Base class should be prohibited."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "edited": false, "score": 0, "creation_date": 1513784734, "post_id": 47909389, "comment_id": 82786866, "body": "@vlad_tepesch I did not mean <code>test()</code>, I mean with existance of <code>get()</code> and <code>cast_to_b()</code> it is pretty much the same as having public inheritance. Btw why not to make <code>test</code> a friend and eliminate those pesky functions?"}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": false, "score": 4, "last_activity_date": 1513783690, "last_edit_date": 1513783690, "creation_date": 1513783529, "answer_id": 47909389, "question_id": 47909196, "link": "https://stackoverflow.com/questions/47909196/downcast-why-a-is-an-inaccessible-base-of-b/47909389#47909389", "title": "Downcast: why: \u2018A\u2019 is an inaccessible base of \u2018B\u2019?", "body": "<p>If you use <code>protected</code> inheritance, only derived types can be aware of that inheritance. As far as <code>test</code> is concerned, there is no relation between <code>A</code> and <code>B</code>. Since a <code>static_cast</code> can't cast pointers between unrelated types, you would need to <code>reinterpret_cast</code> instead. Or you may be able to provide <code>B</code> with a static method to preform this conversion, since <code>B</code> is aware of the inheritance. For example :</p>\n\n<pre><code>// some C++ Wrapper class\nstruct B : protected A {\n    A* get() { return this; }\n    void print() { cout &lt;&lt; i &lt;&lt; endl; }\n    static B* cast_to_b(A* io_self) { return static_cast&lt;B*&gt;(io_self); }\n};\n\n\nextern \"C\" {\n// C callback that gives it this pointer\nvoid test(A* io_self) {\n    auto b2 = B::cast_to_b(io_self);\n    b2-&gt;print();\n}\n}\n</code></pre>\n\n<p>Be sure that the object referred to by <code>A* io_self</code> is actually a <code>B</code> and not just a <code>A</code> or it's undefined behavior.</p>\n\n<p>Are you sure <code>protected</code> is the right inheritance for you here? It seems like <code>private</code> inheritance might be clearer as there doesn't seem to be any intention of inheriting from <code>B</code>. You may also want to consider forgetting about inheritance and simply giving <code>B</code> a <code>A</code> member.</p>\n"}, {"tags": [], "owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "is_accepted": true, "score": 4, "last_activity_date": 1513785307, "last_edit_date": 1513785307, "creation_date": 1513783763, "answer_id": 47909452, "question_id": 47909196, "link": "https://stackoverflow.com/questions/47909196/downcast-why-a-is-an-inaccessible-base-of-b/47909452#47909452", "title": "Downcast: why: \u2018A\u2019 is an inaccessible base of \u2018B\u2019?", "body": "<p>From c++11 N3337 draft (a bit old but it's the one I have lying around) 5.2.9/11 (static_cast):</p>\n\n<blockquote>\n  <p>A prvalue of type \u201cpointer to cv1 B,\u201d where B is a class type, can be\n  converted to a prvalue of type \u201cpointer to cv2 D,\u201d where D is a class\n  derived (Clause 10) from B, if a valid standard conversion from\n  \u201cpointer to D\u201d to \u201cpointer to B\u201d exists (4.10), cv2 is the same\n  cv-qualification as, or greater cv-qualification than, cv1, and B is\n  neither a virtual base class of D nor a base class of a virtual base\n  class of D.</p>\n</blockquote>\n\n<p>In this case, since you use <code>protected</code> inheritance there is no valid standard conversion from <code>B</code> to <code>A</code> so your <code>static_cast</code> is illegal (g++ is correct to diagnose it).</p>\n\n<p>In this case since you're providing a c++ wrapper around a C API I think the simplest approach is to just stick with public inheritance and have a small amount of trust that your users won't abuse the C API directly <em>if they've already consciously chosen to use your C++ API</em></p>\n"}], "owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1460, "favorite_count": 2, "accepted_answer_id": 47909452, "answer_count": 2, "score": 5, "last_activity_date": 1513785307, "creation_date": 1513783024, "question_id": 47909196, "link": "https://stackoverflow.com/questions/47909196/downcast-why-a-is-an-inaccessible-base-of-b", "title": "Downcast: why: \u2018A\u2019 is an inaccessible base of \u2018B\u2019?", "body": "<p>Unlike other examples of this error message i already have a pointer to <code>A</code> and want to retrieve the actual child class.</p>\n\n<p>This kind of arrangement is part of some C++ wrapped C code there <code>A</code> is some POD C structure (whatswhy no dynamic cast)  and <code>test</code> is some callback in C that calls C++ functionality and to retrieve the correct object the cast should be used.\nBut to prevent C++ user code messing the C-Baseclass i would like to have the inheritance <code>protected</code>.</p>\n\n<p>MSVC does not complain about this but g++ does!?\nWhich one is correct from the standards point of view and why?</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\n// plain C structure\nstruct A{\n    int i;\n};\n\n// some C++ Wrapper class\nstruct B: protected A{\n  A* get() { return this; }\n  void print(){cout &lt;&lt; i &lt;&lt; endl;}\n};\n\n\n\nextern \"C\" {\n  // C callback that gives it this pointer\n  void test(A* io_self){\n     auto b2 = static_cast&lt;B*&gt;(io_self);\n     b2-&gt;print();\n  }\n}    \n\nint main()\n{\n   B b;\n   test(b.get());\n   return 0;\n}\n</code></pre>\n\n<p>gives:</p>\n\n<pre><code>$g++ -std=c++11 -o main *.cpp\nmain.cpp: In function \u2018void test(A*)\u2019:\nmain.cpp:21:43: error: \u2018A\u2019 is an inaccessible base of \u2018B\u2019\n          auto b2 = static_cast&lt;B*&gt;(io_self);\n                                           ^\n</code></pre>\n"}, {"tags": ["c++", "c", "python-3.x"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1513782887, "post_id": 47909072, "comment_id": 82785640, "body": "Which are you interested in?  C or C++?  These are different languages."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 1, "creation_date": 1513783223, "post_id": 47909072, "comment_id": 82785858, "body": "In C you have to read command output manually. Look for <code>popen()</code>"}, {"owner": {"reputation": 693, "user_id": 2139902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0050129417b8d5d74968630b13da64c?s=128&d=identicon&r=PG", "display_name": "Sean Burton", "link": "https://stackoverflow.com/users/2139902/sean-burton"}, "edited": false, "score": 0, "creation_date": 1513791880, "post_id": 47909072, "comment_id": 82790858, "body": "In C++ I would recommend looking at Boost::Process which has ways of doing this sort of thing."}], "answers": [{"tags": [], "owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "is_accepted": true, "score": 0, "last_activity_date": 1513784211, "last_edit_date": 1513784211, "creation_date": 1513783892, "answer_id": 47909499, "question_id": 47909072, "link": "https://stackoverflow.com/questions/47909072/is-there-any-function-or-method-like-subprocess-getoutput-in-c-or-c/47909499#47909499", "title": "Is there any function or method like subprocess.getoutput() in c or c++?", "body": "<p>A function <code>getsystemoutput()</code> could look like follows: </p>\n\n<pre><code>char *getsystemoutput( char *cmd )\n{\n    static char output[1024];\n\n    FILE *fp;\n\n    if( (fp = popen( cmd, \"r\" )) == NULL )\n        return \"\";\n\n    if( fgets( outout, sizeof output, fp ) == NULL )\n        strcpy( output, \"\" );\n\n    pclose( fp );\n    return output;\n}\n</code></pre>\n\n<p>This version returns an empty string in case of error and uses a static buffer for output, which makes it easy to use in a <code>printf()</code> but for general purpose I would suggest to return NULL on errors and pass <code>output</code> + it's size as arguments. You might also want to check for the result of <code>pclose()</code> to determine the exit status of the command called. And be aware that without a loop, it will only return the first line of output. </p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1513784390, "creation_date": 1513784390, "answer_id": 47909655, "question_id": 47909072, "link": "https://stackoverflow.com/questions/47909072/is-there-any-function-or-method-like-subprocess-getoutput-in-c-or-c/47909655#47909655", "title": "Is there any function or method like subprocess.getoutput() in c or c++?", "body": "<p>Standard C has no function to run an external process, collect its standard output and standard error, and return that as a string.  In fact, as a matter of policy, standard C does not provide functions that return dynamically-allocated memory, which such a function would need to do, other than its functions than have allocating memory as their express purpose.</p>\n\n<p>In a POSIX environment, you can rely on <code>popen()</code> to provide a <code>FILE *</code> by which you can read the standard output of a shell command:</p>\n\n<pre><code>FILE *file = popen(\"ip link | grep 'state UP' | cut -d : -f 2 | cut -d ' ' -f2\",\n                   \"r\"));\n\nif (file == NULL) {\n    // handle error\n}\n</code></pre>\n\n<p>You'll then have to handle reading the output yourself; perhaps via <code>fgets()</code>:</p>\n\n<pre><code>char buffer[LARGE_ENOUGH];\n\n// Read one line from the input (or part of one, if the buffer is too small)\nif (fgets(buffer, sizeof(buffer), file) == NULL) {\n    // handle error\n}\n// If a newline was read then it will be included\nbuffer[strcspn(buffer, \"\\n\")] = '\\0';\n</code></pre>\n\n<p>You can print the result:</p>\n\n<pre><code>printf(\"Active Device:%s\", buffer);\n</code></pre>\n\n<p>Remember that a file opened with <code>popen()</code> must be closed with <code>pclose()</code>:</p>\n\n<pre><code>if (pclose(file) != 0) {\n    // handle error\n}\n</code></pre>\n\n<p>Note, by the way, that if you want to capture the stderr as well as the standard output, as your Python version does, then your best bet is to accommodate that via I/O redirection in the command, such as:</p>\n\n<pre><code>FILE *file = popen(\n        \"{ ip link | grep 'state UP' | cut -d : -f 2 | cut -d ' ' -f2; } 2&gt;&amp;1\",\n        \"r\"));\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9123082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c741be6074cce563d08dd9bb07a8770?s=128&d=identicon&r=PG", "display_name": "Mubashshir", "link": "https://stackoverflow.com/users/9123082/mubashshir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 47909499, "answer_count": 2, "score": 2, "last_activity_date": 1513784390, "creation_date": 1513782611, "question_id": 47909072, "link": "https://stackoverflow.com/questions/47909072/is-there-any-function-or-method-like-subprocess-getoutput-in-c-or-c", "title": "Is there any function or method like subprocess.getoutput() in c or c++?", "body": "<p>Python:</p>\n\n<pre><code>print(\"Active Device:\"+subprocess.getoutput(\"ip link|grep \\\"state UP\\\"|cut -d : -f 2|cut -d \\' \\' -f2\"))\n</code></pre>\n\n<p>Can I get output like That\u2b06 in c by doing this?:\nC:</p>\n\n<pre><code>printf(\"Active Device:%s\",getsystemoutput(\"ip link|grep \\\"state UP\\\"|cut -d : -f 2|cut -d \\' \\' -f2\"));\n</code></pre>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 252, "user_id": 5364211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ixqyo.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5364211/tom"}, "edited": false, "score": 0, "creation_date": 1513782623, "post_id": 47909045, "comment_id": 82785439, "body": "By case do you mean uppercase/lowercase ?"}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513782627, "post_id": 47909045, "comment_id": 82785442, "body": "&quot;<i>how can I ignore the case</i>&quot; - you mean ignore letter cases?"}, {"owner": {"reputation": 51, "user_id": 9123240, "user_type": "registered", "profile_image": "https://graph.facebook.com/1526733524112418/picture?type=large", "display_name": "\u0130rem Nur Ar\u0131", "link": "https://stackoverflow.com/users/9123240/%c4%b0rem-nur-ar%c4%b1"}, "reply_to_user": {"reputation": 252, "user_id": 5364211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ixqyo.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5364211/tom"}, "edited": false, "score": 0, "creation_date": 1513783008, "post_id": 47909045, "comment_id": 82785714, "body": "@TCouch Sorry, yes!"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1513783192, "post_id": 47909045, "comment_id": 82785835, "body": "Transform both strings to lowercase or uppercase and compare."}], "answers": [{"tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": false, "score": 0, "last_activity_date": 1513783530, "creation_date": 1513783530, "answer_id": 47909390, "question_id": 47909045, "link": "https://stackoverflow.com/questions/47909045/compare-string-from-the-user/47909390#47909390", "title": "Compare string from the user", "body": "<p>The trick to non-cases sensitive comparison of two strings is to convert both of them either to lower or to upper case and then compare.</p>\n\n<p>Unfortunately stl does not provide a very convenient way for the case conversions. So, here are some possibilities: <a href=\"https://stackoverflow.com/a/313990/1143850\">https://stackoverflow.com/a/313990/1143850</a>. just copying from there:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;string&gt; \n\nstd::string data = \"Abc\"; \nstd::transform(data.begin(), data.end(), data.begin(), ::tolower);\n</code></pre>\n\n<p>so, in your case, </p>\n\n<pre><code> string lowerE = std::transform(e.begin(), e.end(), e.begin(), ::tolower);    \n ...\n while(std::transform(temp2-&gt;info.begin(), temp2-&gt;info.end(), temp2-&gt;info.begin(), ::tolower) != lowerE) ...\n</code></pre>\n\n<p>Of course, you can create a function to simplfy it  or use a different method of conversion there.</p>\n\n<p>and another possibility definitely is to create you own comparison function and compare char by char, using the <code>tolower</code> or <code>towlower</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 321, "user_id": 9115825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP6Dg.gif?s=128&g=1", "display_name": "PspSetProcessPpmPolicy", "link": "https://stackoverflow.com/users/9115825/pspsetprocessppmpolicy"}, "is_accepted": false, "score": 0, "last_activity_date": 1513784462, "creation_date": 1513784462, "answer_id": 47909680, "question_id": 47909045, "link": "https://stackoverflow.com/questions/47909045/compare-string-from-the-user/47909680#47909680", "title": "Compare string from the user", "body": "<p>You don't need to manually convert the case of the strings being converted. If you're dealing with strings, use <a href=\"http://www.cplusplus.com/reference/cstring/strcmp/\" rel=\"nofollow noreferrer\">strcmp</a>. For case insensitive checks, you can use <a href=\"https://docs.microsoft.com/en-gb/cpp/c-runtime-library/reference/stricmp-wcsicmp-mbsicmp-stricmp-l-wcsicmp-l-mbsicmp-l\" rel=\"nofollow noreferrer\">_strcmpi</a>. </p>\n\n<p>E.g.</p>\n\n<pre><code>if(!strcmp(String1, String2)) { .... }\n</code></pre>\n\n<p>If strcmp returns 0 (FALSE) then there was a match, with case sensitivity applied.</p>\n\n<p>For comparisons without case sensitivity, you use _strcmpi.</p>\n\n<p>E.g.</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\nBOOL StringMatch(\n    CONST CHAR *CmpString,\n    CONST CHAR *CmpString2\n)\n{\n    return (!_strcmpi(CmpString,\n        CmpString2)) ? TRUE : FALSE;\n}\n\nint main()\n{\n    if (StringMatch(\"hello\", \"HELLO\"))\n    {\n        cout &lt;&lt; \"Match without case sensitivity\\n\";\n    }\n\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>Since you're using std::string, you can use the .c_str().</p>\n\n<p>E.g.</p>\n\n<pre><code>string hellostring = \"hello\";\n\nif (StringMatch(hellostring.c_str(), \"HELLO\"))\n{\n    cout &lt;&lt; \"Match without case sensitivity\\n\";\n}\n</code></pre>\n\n<p>If you ever need to switch to Unicode encoding instead of Ascii, you have wcscmp and _wcs*/wcs*.</p>\n"}], "owner": {"reputation": 51, "user_id": 9123240, "user_type": "registered", "profile_image": "https://graph.facebook.com/1526733524112418/picture?type=large", "display_name": "\u0130rem Nur Ar\u0131", "link": "https://stackoverflow.com/users/9123240/%c4%b0rem-nur-ar%c4%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "closed_date": 1513800291, "answer_count": 2, "score": 0, "last_activity_date": 1513785612, "creation_date": 1513782518, "last_edit_date": 1513785612, "question_id": 47909045, "link": "https://stackoverflow.com/questions/47909045/compare-string-from-the-user", "closed_reason": "Duplicate", "title": "Compare string from the user", "body": "<p>I am trying to delete a node from the linked list. Node has a name that user enters. But I couldn't figure out how can I ignore the uppercase/lowercase in while loop. Here is my code.</p>\n\n<pre><code>void del(string e)\n{\n    temp=new node;\n    temp=head;\n    temp2=new node;\n    temp2=temp-&gt;next;\n    if(temp-&gt;info==e)\n    {\n        head=temp-&gt;next;\n        delete temp;\n    }\n    else\n    {\n        while(temp2-&gt;info!=e)\n        {\n            temp=temp-&gt;next;\n            temp2=temp2-&gt;next;\n        }\n        temp2=temp2-&gt;next;\n        temp-&gt;next=temp2;\n    }\n}\n</code></pre>\n\n<p>And I get the string by this </p>\n\n<pre><code>cout&lt;&lt;\"Enter the name to delete\"&lt;&lt;endl;\nws(cin);\ngetline(cin,e);\ndel(e);\n</code></pre>\n\n<p>So is there any way to ignore uppercase/lowercase in while loop and if statement?</p>\n"}, {"tags": ["c++", "oop", "visual-studio-2012", "copy-constructor"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1513782798, "post_id": 47909024, "comment_id": 82785575, "body": "Perhaps you should make your constructors <code>explicit</code> so no implicit conversions like this would be allowed?"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 8824815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87f9aab977239b95b42378011868573e?s=128&d=identicon&r=PG&f=1", "display_name": "A.Pet", "link": "https://stackoverflow.com/users/8824815/a-pet"}, "edited": false, "score": 0, "creation_date": 1513783926, "post_id": 47909185, "comment_id": 82786310, "body": "So basically, C++ will do a back flip to find a way to convert the argument to something the constructor (one of the constructors) will accept? Is there a limit on how much conversions it can do? This is some old code - one of the reasons I&#39;m messing with this is to get rid of memory leaks. I <i>wish</i> I could just rewrite it."}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "reply_to_user": {"reputation": 67, "user_id": 8824815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87f9aab977239b95b42378011868573e?s=128&d=identicon&r=PG&f=1", "display_name": "A.Pet", "link": "https://stackoverflow.com/users/8824815/a-pet"}, "edited": false, "score": 1, "creation_date": 1513784220, "post_id": 47909185, "comment_id": 82786489, "body": "It will allow exactly one user-defined conversion."}, {"owner": {"reputation": 33511, "user_id": 321013, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/256c9d534302a138d5d1fe3ed833e217?s=128&d=identicon&r=PG", "display_name": "Martin Ba", "link": "https://stackoverflow.com/users/321013/martin-ba"}, "reply_to_user": {"reputation": 67, "user_id": 8824815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87f9aab977239b95b42378011868573e?s=128&d=identicon&r=PG&f=1", "display_name": "A.Pet", "link": "https://stackoverflow.com/users/8824815/a-pet"}, "edited": false, "score": 0, "creation_date": 1513844397, "post_id": 47909185, "comment_id": 82808900, "body": "@A.Pet - Specifically, we have <code>foo()</code> return <code>Component*</code> -&gt; <code>ImplementA</code> -&gt; <code>ImplementB</code>. Since the &quot;conversion&quot; to <code>ImplementB</code> is explicit (the c&#39;tor is written down in the code), we have exactly one <i>implicit</i> conversion, although we really have <i>two</i> conversions. IFF the line read <code>return foo()</code> instead, you&#39;d have two implicit conversions and the code would fail to compile."}], "tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": true, "score": 5, "last_activity_date": 1513783001, "creation_date": 1513783001, "answer_id": 47909185, "question_id": 47909024, "link": "https://stackoverflow.com/questions/47909024/c-implicit-call-of-constructor-from-another-constructor/47909185#47909185", "title": "C++: Implicit call of constructor from another constructor", "body": "<p>This is what you get for having too many, confusing constructors. I also strongly suspect that you have memory leaks all over the place.</p>\n\n<p>Note that <code>ImplementA</code> has a constructor <code>ImplementA(Component&amp;)</code> and a constructor <code>ImplementA(Component*)</code>. But <code>ImplementB</code> has only <code>ImplementB(Component&amp;)</code>. This is confusing.</p>\n\n<p>So when you do <code>new ImplementB(foo())</code>, there's no constructor that accepts a <code>Component*</code> directly. The compiler goes looking for other options. Specifically, it goes looking for a way to convert the argument <code>Component*</code> to something that some constructor of <code>ImplementB</code> accepts.</p>\n\n<p>C++ has something called user-defined conversions. You can define <em>conversion operators</em> and <em>converting constructors</em> that define new implicit type conversions between types. Here's the thing: any constructor with a single parameter is a converting constructor, unless it is marked with <code>explicit</code>. (This is probably a design mistake in C++. But we're stuck with it.)</p>\n\n<p>Therefore, <code>ImplementA(Component*)</code> defines an implicit conversion from <code>Component*</code> to <code>ImplementA</code>. And there's the <code>ImplementB(const ImplementA&amp;)</code> constructor that would accept a <code>ImplementA</code> temporary just fine. So the compiler uses this constructor, uses the converting constructor to create the temporary, and the end result is the execution you're seeing.</p>\n\n<p>The solution is to make all these constructors <code>explicit</code>, and also to define fewer, less confusing constructors. And to use smart pointers to get rid of the memory leaks.</p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 8824815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87f9aab977239b95b42378011868573e?s=128&d=identicon&r=PG&f=1", "display_name": "A.Pet", "link": "https://stackoverflow.com/users/8824815/a-pet"}, "edited": false, "score": 0, "creation_date": 1513783963, "post_id": 47909222, "comment_id": 82786329, "body": "Only one? Is this set by standard or dependent on something?"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "reply_to_user": {"reputation": 67, "user_id": 8824815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87f9aab977239b95b42378011868573e?s=128&d=identicon&r=PG&f=1", "display_name": "A.Pet", "link": "https://stackoverflow.com/users/8824815/a-pet"}, "edited": false, "score": 0, "creation_date": 1513784253, "post_id": 47909222, "comment_id": 82786521, "body": "@A.Pet - Yes, the standard says at most one. The compiler should not try to find perhaps 20 steps to convert from one type to another. It would be both totally confusing for the programmer, and a lot of work for the compiler."}], "tags": [], "owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "is_accepted": false, "score": 1, "last_activity_date": 1513783074, "creation_date": 1513783074, "answer_id": 47909222, "question_id": 47909024, "link": "https://stackoverflow.com/questions/47909024/c-implicit-call-of-constructor-from-another-constructor/47909222#47909222", "title": "C++: Implicit call of constructor from another constructor", "body": "<pre><code>return new ImplementB(foo());\n</code></pre>\n\n<blockquote>\n  <p>When run, the line above executes foo(), then executes ImplementA(Component* input), and then ImplementB(const ImplementA&amp; impl) - which confuses me very much.</p>\n</blockquote>\n\n<p>The call to <code>foo</code> returns a <code>Component*</code>. When we check the constructors for <code>ImplementB</code> we find</p>\n\n<pre><code>ImplementB(Component&amp; input);\nImplementB(const ImplementA&amp; impl);\nImplementB(const ImplementB&amp; impl);\n</code></pre>\n\n<p>So none of these accepts a <code>Component*</code>.</p>\n\n<p>But \"luckily\" one of the options is an <code>ImplementA</code> which <em>can</em> be constructed from the pointer.</p>\n\n<p>And <em>one</em> \"user-defined conversion\" is allowed when passing a parameter.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1513783312, "creation_date": 1513783312, "answer_id": 47909301, "question_id": 47909024, "link": "https://stackoverflow.com/questions/47909024/c-implicit-call-of-constructor-from-another-constructor/47909301#47909301", "title": "C++: Implicit call of constructor from another constructor", "body": "<p><code>foo</code> returns a <code>Component*</code>. </p>\n\n<p><code>ImplementB</code> doesn't have a constructor that accepts a <code>Component*</code>. However it has a constructor that accepts a <code>const ImplementA&amp;</code>.</p>\n\n<p>Now <code>Component*</code> is <em>implicitly convertible</em> to <code>ImplementA</code> via the constructor of the latter that accepts a <code>Component*</code>. So it gets converted, and the resulting <code>ImplementA</code> temporary is passed by const reference to the appropriate constructor of <code>ImplementB</code>.</p>\n\n<p>If you value your sanity, you probably don't want <strong>any</strong> implicit conversions anywhere near your code. To stop implicit conversions of user-defined types, declare all single-argument constructors <code>explicit</code>.</p>\n"}], "owner": {"reputation": 67, "user_id": 8824815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87f9aab977239b95b42378011868573e?s=128&d=identicon&r=PG&f=1", "display_name": "A.Pet", "link": "https://stackoverflow.com/users/8824815/a-pet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 47909185, "answer_count": 3, "score": 2, "last_activity_date": 1513783312, "creation_date": 1513782466, "question_id": 47909024, "link": "https://stackoverflow.com/questions/47909024/c-implicit-call-of-constructor-from-another-constructor", "title": "C++: Implicit call of constructor from another constructor", "body": "<p>I'm having a hard time understanding implicit constructor calls in a project I'm working on.<br/> \nThere are two interfaces: InterfaceA and InterfaceB. <br/>\nThen, there are two implementation classes: ImplementA and ImplementB, which are derived from the respective interface. There is no mutual ancestor in any point - even though the interfaces and classes are very much alike.<br/>\nA third class, Component, can be used to initialize any of the Implement classes. <br/>\nSo we have something like this:</p>\n\n<pre><code>class InterfaceA \n{\npublic:\n    InterfaceA(){}\n    virtual ~InterfaceA(){}\n\n    // Some functions\n}\n\nclass InterfaceB \n{\npublic:\n    InterfaceB(){}\n    virtual ~InterfaceB(){}\n\n    // Some functions\n}\n\nclass ImplementA : public InterfaceA\n{\npublic:\n    ImplementA(Component&amp; input);\n    ImplementA(Component* input);\n    ImplementA(const ImplementA&amp; impl);\n    ImplementA(const ImplementB&amp; impl);\n    ImplementA();\n    ~ImplementA(void);\n\nprivate:\n    Component* m_component;\n    bool some_boolean;\n}\n\nclass ImplementB : public InterfaceB\n{\npublic:\n    ImplementB(Component&amp; input);\n    ImplementB(const ImplementA&amp; impl);\n    ImplementB(const ImplementB&amp; impl);\n    ImplementB();\n    ~ImplementB(void);\n\nprivate:\n    Component* m_component;\n}\n</code></pre>\n\n<p>Then, we have a function that returns a pointer to Component:</p>\n\n<pre><code>Component* foo()\n{\n    Component* result = new Component();\n    ...\n    return result;\n}\n</code></pre>\n\n<p>And finally, somewhere in the code, we have the following return:</p>\n\n<pre><code>return new ImplementB(foo());\n</code></pre>\n\n<p>When run, the line above executes foo(), then executes ImplementA(Component* input), and then ImplementB(const ImplementA&amp; impl) - which confuses me very much.<br/>\n1. Why does it even compile? Shouldn't the compiler complain that there is no valid constructor for this type of argument (which it does when I change something in the call in question). I'm using Visual Studio 2012, by the way.<br/>\n2. I know that when a constructor gets a pointer to an object as an argument, it first calls the copy constructor of the argument. So, if I ignore the fact that there's no fitting constructor - shouldn't it use the copy constructor of Component instead of ImplementA? ImplementA seems to have absolutely no connection to ImplementB (aside from them having a similar structure).<br/></p>\n\n<p>What am I missing? What could be causing this behavior in this situation?</p>\n"}, {"tags": ["c++", "c", "random", "segmentation-fault", "pi"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513782664, "post_id": 47909019, "comment_id": 82785472, "body": "My guess? Your recursion doesn&#39;t stop when you think it does. Have you tried using a debugger to catch the crash and see when and where it happens? Perhaps you should take some time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>?"}, {"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1513782753, "post_id": 47909019, "comment_id": 82785543, "body": "your gdc function is causing a stack overflow. which implies you are missing an exit condition"}, {"owner": {"reputation": 252, "user_id": 5364211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ixqyo.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5364211/tom"}, "edited": false, "score": 0, "creation_date": 1513782848, "post_id": 47909019, "comment_id": 82785607, "body": "I get &quot;3.000000&quot; every time when running your code"}, {"owner": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "edited": false, "score": 0, "creation_date": 1513782937, "post_id": 47909019, "comment_id": 82785663, "body": "replace double pi = 599994/coprime; by double pi = 599994.0/static_cast&lt;double&gt;(coprime); You may be losing some digits from integer division."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "edited": false, "score": 1, "creation_date": 1513783012, "post_id": 47909019, "comment_id": 82785715, "body": "@falopsy The cast should not be needed, as long as one of the operands is a <code>double</code>."}, {"owner": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513783254, "post_id": 47909019, "comment_id": 82785875, "body": "@Someprogrammerdude, no you will need the cast. it will do the integer division before casting. What do you think double p=94/10; will give you? 9.4 or 9.0? Anyway, it is always good to cast to show intent."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "edited": false, "score": 0, "creation_date": 1513783920, "post_id": 47909019, "comment_id": 82786305, "body": "@falopsy What do <i>you</i> think <code>double p = 94.0 &#47; 10;</code> will give?"}, {"owner": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "reply_to_user": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1513784058, "post_id": 47909019, "comment_id": 82786382, "body": "@OldProgrammer, I agree but I think the stack overflow is because the recursion of the gcd function is too deep. What you need to do is limit the value of the random number generated (currently the limit you are using is RAND_MAX = 32767 on my computer). Maybe look at &lt;random&gt;, contains classes that let you generate random numbers within a limit. You can limit to like 1000."}, {"owner": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "reply_to_user": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1513784143, "post_id": 47909019, "comment_id": 82786443, "body": "@Bob__, how is that relevant? In the op&#39;s code, both arguments on the RHS are integer."}, {"owner": {"reputation": 49, "user_id": 6801676, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-VQ9O-JXOY2A/AAAAAAAAAAI/AAAAAAAAADI/gk-JBYIYr70/photo.jpg?sz=128", "display_name": "Kumar Chetan", "link": "https://stackoverflow.com/users/6801676/kumar-chetan"}, "edited": false, "score": 0, "creation_date": 1513784456, "post_id": 47909019, "comment_id": 82786675, "body": "Thanks everyone. I&#39;m gonna try to do it without recursion."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1513790158, "post_id": 47909019, "comment_id": 82789985, "body": "You may consider the use of a couple of constants, like <code>const &#47;* long long *&#47; int N = 99999;</code> and <code>const double K = 6.0 * N;</code> to use in <code>double pi = K &#47; coprime;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 49, "user_id": 6801676, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-VQ9O-JXOY2A/AAAAAAAAAAI/AAAAAAAAADI/gk-JBYIYr70/photo.jpg?sz=128", "display_name": "Kumar Chetan", "link": "https://stackoverflow.com/users/6801676/kumar-chetan"}, "edited": false, "score": 0, "creation_date": 1513788738, "post_id": 47909740, "comment_id": 82789243, "body": "FWIW, a high-ish recursion depth of  39 was noted with <code>gcdu(774542945, 2027634402)</code>.  With OP&#39;s original code, the depth could be 1000&#39;s millions <code>gcd(1000000000,1)</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 49, "user_id": 6801676, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-VQ9O-JXOY2A/AAAAAAAAAAI/AAAAAAAAADI/gk-JBYIYr70/photo.jpg?sz=128", "display_name": "Kumar Chetan", "link": "https://stackoverflow.com/users/6801676/kumar-chetan"}, "edited": false, "score": 0, "creation_date": 1513797949, "post_id": 47909740, "comment_id": 82793806, "body": "<code>gcdu(1276900689, 2066068658)</code> recursed 41 times.  Hmmm, wonder what is the limit?"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1513784676, "creation_date": 1513784676, "answer_id": 47909740, "question_id": 47909019, "link": "https://stackoverflow.com/questions/47909019/pi-calculator-program-gives-different-output-each-time-its-run/47909740#47909740", "title": "Pi-calculator program gives different output each time it&#39;s run", "body": "<p>OP's <code>gcd()</code> recurses too deep and causes a <em>stack overflow</em>. <a href=\"https://stackoverflow.com/questions/47909019/pi-calculator-program-gives-different-output-each-time-its-run/47909740#comment82785543_47909019\">@OldProgrammer</a></p>\n\n<p>Consider a replacement recursive function that is more efficient</p>\n\n<p>Use FP math when doing the division</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n\nunsigned gcdu(unsigned a, unsigned b) {\n  return (b == 0) ? a : gcdu(b, a % b);\n}\n\nint main(void) {\n  srand(time(0));\n\n  int numberOne = rand();\n  int numberTwo = rand();\n  int coprime = 0;\n\n  for (int i = 0; i &lt; 99999; i++) {\n    numberOne = rand();\n    numberTwo = rand();\n    if (gcdu(numberOne, numberTwo) == 1) {\n      coprime++;\n    }\n  }\n\n  // double pi = 599994 / coprime;\n  double pi = 1.0*599994 / coprime;  //Insure FP division\n  pi = sqrt(pi);\n  printf(\"%f\\n\", pi);\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>3.142940\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6801676, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-VQ9O-JXOY2A/AAAAAAAAAAI/AAAAAAAAADI/gk-JBYIYr70/photo.jpg?sz=128", "display_name": "Kumar Chetan", "link": "https://stackoverflow.com/users/6801676/kumar-chetan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 47909740, "answer_count": 1, "score": 1, "last_activity_date": 1513784676, "creation_date": 1513782454, "question_id": 47909019, "link": "https://stackoverflow.com/questions/47909019/pi-calculator-program-gives-different-output-each-time-its-run", "title": "Pi-calculator program gives different output each time it&#39;s run", "body": "<p>This is a program to calculate the value of Pi using the fact that \"The probability of any two integers being co-prime is 6/&pi;<SUP>2</SUP>.\" This program compiled successfully but when I try to run it, it gives the error:</p>\n\n<pre><code>Segmentation fault (core dumped)\n</code></pre>\n\n<p>I tried to change the condition statement in for-loop to <em>i &lt; 9999</em>. By doing this, the program gives an output which varies(when run each time) between 3.000000, 3.162278 and Segmentation fault (core dumped).</p>\n\n<p>I want to calculate the value of &pi; only by using the property mentioned above. Please help.</p>\n\n<p>Also, help me choose a better function that generates random numbers and suggest me some code improvements. Thank you.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n\nint gcd(int a, int b)\n{\n    // Everything divides 0 \n    if (a == 0 || b == 0)\n       return 0;\n\n    // base case\n    if (a == b)\n        return a;\n\n    // a is greater\n    if (a &gt; b)\n        return gcd(a-b, b);\n    return gcd(a, b-a);\n}\n\nint main()\n{\n    srand(time(0));\n\n    int numberOne = rand();\n    int numberTwo = rand();\n    int coprime = 0;\n\n    for(int i = 0; i &lt; 99999; i++)\n    {\n        numberOne = rand();\n        numberTwo = rand();\n\n        if(gcd(numberOne, numberTwo) == 1)\n        {\n            coprime++;\n        }\n\n    }\n\n    // co-prime/99999 = 6 / pi^2\n    double pi = 599994/coprime;\n    pi = sqrt(pi);\n\n    printf(\"%f\\n\", pi);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "wpd"], "answers": [{"tags": [], "owner": {"reputation": 160, "user_id": 2869674, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002681476958/picture?type=large", "display_name": "Arthur  Bulakaiev", "link": "https://stackoverflow.com/users/2869674/arthur-bulakaiev"}, "is_accepted": true, "score": 1, "last_activity_date": 1516193529, "creation_date": 1516193529, "answer_id": 48301642, "question_id": 47908950, "link": "https://stackoverflow.com/questions/47908950/wpd-get-media-dimensions/48301642#48301642", "title": "WPD get media dimensions", "body": "<p>The error you got is: \nError code: (HRESULT) 0x80070490 (2147943568) - Element not found.</p>\n\n<p>The reason you got this error most probably is that actually phone apps developers usually just ignore some of properties.</p>\n\n<p>I have connected my phone to PC and checked some images with <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/portable/using-the-wpdinfo-tool\" rel=\"nofollow noreferrer\">WPD Information Tool</a> , and I get only such fields for .jpg screenshot:\n<a href=\"https://i.stack.imgur.com/MxG9m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MxG9m.png\" alt=\"enter image description here\"></a></p>\n\n<p>I think in most cases you need to read content of the picture to stream and check it's parameters directly. Maybe in some formats you can read only some \"header\" part and get WIDTH and HEIGHT from there.</p>\n"}], "owner": {"reputation": 67, "user_id": 3797009, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8c6c3d176d8f3e4f15d0b3ae3915d864?s=128&d=identicon&r=PG&f=1", "display_name": "RobRobRob", "link": "https://stackoverflow.com/users/3797009/robrobrob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 48301642, "answer_count": 1, "score": 0, "last_activity_date": 1516193529, "creation_date": 1513782289, "last_edit_date": 1513785063, "question_id": 47908950, "link": "https://stackoverflow.com/questions/47908950/wpd-get-media-dimensions", "title": "WPD get media dimensions", "body": "<p>I want to get the width and hight of a image file on a WPD via IPortableDeviceValues.</p>\n\n<p>According to the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd389031(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Windows Dev Center</a> every object whose type is WPD_CONTENT_TYPE_IMAGE (which they are) requires to provide WPD_MEDIA_WIDTH/WPD_MEDIA_HEIGHT but I always get a error.</p>\n\n<pre><code>HRESULT MyPortableDevice::getIntValue(IPortableDeviceProperties* properties, PCWSTR objectID, const PROPERTYKEY&amp; key, DWORD* value)\n{\n\nComPtr&lt;IPortableDeviceValues&gt;        objectProperties;\nComPtr&lt;IPortableDeviceKeyCollection&gt; propertiesToRead;\n\nHRESULT hr = CoCreateInstance(CLSID_PortableDeviceKeyCollection,\n                              nullptr,\n                              CLSCTX_INPROC_SERVER,\n                              IID_PPV_ARGS(&amp;propertiesToRead));\n\nif (SUCCEEDED(hr)) {\n    HRESULT tempHr = S_OK;\n    tempHr = propertiesToRead-&gt;Add(key);      \n}\n\nif (SUCCEEDED(hr)) {\n    hr = properties-&gt;GetValues(objectID,                \n                               propertiesToRead.Get(),  \n                               &amp;objectProperties); \n}   \n\nif (SUCCEEDED(hr)) {\n\n    ULONG intValue = 0;\n    hr = objectProperties-&gt;GetUnsignedIntegerValue(key, &amp;intValue);\n\n    if (SUCCEEDED(hr)) {          \n        value = &amp;intValue;\n        intValue = 0;\n    }            \n}\n\nreturn hr;\n</code></pre>\n\n<p>I always get a error value from</p>\n\n<pre><code>hr = objectProperties-&gt;GetUnsignedIntegerValue(key, &amp;intValue);\n</code></pre>\n\n<p>hr = 0x80070490 and I can't find this error code <a href=\"https://msdn.microsoft.com/en-us/library/cc704587.aspx\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Does anyone know what's wrong?</p>\n"}, {"tags": ["c++", "opencv"], "answers": [{"comments": [{"owner": {"reputation": 2544, "user_id": 3374593, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b52e8f3dbba2dd84cee919766d30125d?s=128&d=identicon&r=PG&f=1", "display_name": "L&#230;rne", "link": "https://stackoverflow.com/users/3374593/l%c3%a6rne"}, "edited": false, "score": 0, "creation_date": 1513863191, "post_id": 47924395, "comment_id": 82819916, "body": "Yes because <i>width</i> correspond to <i>cols</i> and nto <i>rows</i>, I forgot that <code>(width=a, height=b)</code> is <code>(rows=b,cols=a)</code>."}], "tags": [], "owner": {"reputation": 10288, "user_id": 1542806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89b0522a428d374844f2efcb8b342a2?s=128&d=identicon&r=PG", "display_name": "Andrey  Smorodov", "link": "https://stackoverflow.com/users/1542806/andrey-smorodov"}, "is_accepted": true, "score": 0, "last_activity_date": 1513857059, "creation_date": 1513857059, "answer_id": 47924395, "question_id": 47908897, "link": "https://stackoverflow.com/questions/47908897/opencvs-emd-l1-algorithm-computes-distances-that-are-zeroes/47924395#47924395", "title": "openCV&#39;s EMD-L1 algorithm computes distances that are zeroes", "body": "<p>Thats because your matrix size is 1 row and 64 cols and you need single col martix.</p>\n"}], "owner": {"reputation": 2544, "user_id": 3374593, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b52e8f3dbba2dd84cee919766d30125d?s=128&d=identicon&r=PG&f=1", "display_name": "L&#230;rne", "link": "https://stackoverflow.com/users/3374593/l%c3%a6rne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 47924395, "answer_count": 1, "score": 0, "last_activity_date": 1513857059, "creation_date": 1513782110, "question_id": 47908897, "link": "https://stackoverflow.com/questions/47908897/opencvs-emd-l1-algorithm-computes-distances-that-are-zeroes", "title": "openCV&#39;s EMD-L1 algorithm computes distances that are zeroes", "body": "<p>In the following code, I have two histograms, that for this simple example, I hard-coded in the source.  Each histogram have 128 bins, where the 64 firsts bins correspond to one histogram, and the 64 other correspond to another histogram.  However the resultant distance is <code>0</code>, even though there are clear differences in the latter 64 bins of the 128 bins of each vector.  I don't understand how it's possible why two different vectors have a null distance.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;opencv2/core.hpp&gt;\n#include &lt;opencv2/shape/emdL1.hpp&gt;\n\nusing Vec128f = cv::Vec&lt;float, 128&gt;;\n\nfloat sum_of_emd_dists(const Vec128f&amp; a, const Vec128f&amp; b)\n{\n    const cv::Mat a_color(cv::Size{64, 1}, CV_32FC1, (void*)(&amp;a.val[0]));\n    const cv::Mat a_label(cv::Size{64, 1}, CV_32FC1, (void*)(&amp;a.val[64]));\n    const cv::Mat b_color(cv::Size{64, 1}, CV_32FC1, (void*)(&amp;b.val[0]));\n    const cv::Mat b_label(cv::Size{64, 1}, CV_32FC1, (void*)(&amp;b.val[64]));\n    float dist = cv::EMDL1(a_color, b_color) + cv::EMDL1(a_label, b_label);\n    return dist;\n}\n\n\n\nint main()\n{\n    Vec128f a = {64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.265625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.734375, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};\n    Vec128f b = {64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.109375, 0, 0, 0, 0.109375, 0, 0, 0.09375, 0, 0, 0, 0, 0, 0, 0, 0, 0.0625, 0, 0, 0.09375, 0, 0, 0, 0.046875, 0.046875, 0, 0, 0, 0, 0, 0, 0, 0.078125, 0.140625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.09375, 0, 0, 0.0625, 0, 0, 0, 0.0625, 0, 0, 0, 0, 0, 0};\n    std::cerr &lt;&lt; \"dist = \" &lt;&lt; sum_of_emd_dists(a, b) &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>dist = 0\n</code></pre>\n\n<p>Thank you for any help explaining why theEMD-L1 distance is 0.</p>\n"}, {"tags": ["c++", "language-lawyer", "c++17"], "comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 1, "creation_date": 1513784160, "post_id": 47908885, "comment_id": 82786449, "body": "Clang agrees with GCC. But I think I agree with you, this is a defect in either the standard or the compilers. Also of note is that MSVC accepts the code."}], "answers": [{"comments": [{"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 2, "creation_date": 1513784552, "post_id": 47909612, "comment_id": 82786739, "body": "<code>b</code> is initialized with a glvalue, and <b><code>a</code> as a glvalue</b> is not a constant expression."}, {"owner": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "edited": false, "score": 0, "creation_date": 1513784776, "post_id": 47909612, "comment_id": 82786888, "body": "indeed, note that clang refuses to compile also &quot;constexpr int const&amp; b = a;&quot; saying &quot;reference to &#39;a&#39; is not a constant expression&quot;..."}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1513784852, "post_id": 47909612, "comment_id": 82786937, "body": "Maybe because <code>a</code> is a local variable, so the underlying pointer would change?"}, {"owner": {"reputation": 2256, "user_id": 5645940, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2449971e95f183f145fb903b00c56b22?s=128&d=identicon&r=PG&f=1", "display_name": "b1sub", "link": "https://stackoverflow.com/users/5645940/b1sub"}, "edited": false, "score": 0, "creation_date": 1513784984, "post_id": 47909612, "comment_id": 82787027, "body": "Would you guys pinpoint the specific bullet hindering <code>a</code> from being a constant expression? I don&#39;t think that there is one..."}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 1, "creation_date": 1513785049, "post_id": 47909612, "comment_id": 82787076, "body": "<a href=\"http://eel.is/c++draft/expr.const#6\" rel=\"nofollow noreferrer\">&#91;expr.const&#93;/6</a>: &quot;A <i>constant expression</i> is either a glvalue core constant expression that refers to an entity that is a permitted result of a constant expression (as defined below), or a prvalue core constant expression[...]. An entity is a <i>permitted result of a constant expression</i> if it is an object with static storage duration that is either not a temporary object or is a temporary object whose value satisfies the above constraints, or it is a function.&quot;"}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 0, "creation_date": 1513785087, "post_id": 47909612, "comment_id": 82787100, "body": "... <code>a</code> is not &quot;an object with static storage duration&quot; or &quot;a temporary object&quot; or &quot;a function&quot;."}, {"owner": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1513785294, "post_id": 47909612, "comment_id": 82787259, "body": "@SebastianRedl, yes, and the same reasoning seems to allow concluding that b is <i>not</i> initialized with a constant expression ... hence neutralizing Barry&#39;s quote ?"}, {"owner": {"reputation": 2256, "user_id": 5645940, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2449971e95f183f145fb903b00c56b22?s=128&d=identicon&r=PG&f=1", "display_name": "b1sub", "link": "https://stackoverflow.com/users/5645940/b1sub"}, "edited": false, "score": 0, "creation_date": 1513785501, "post_id": 47909612, "comment_id": 82787394, "body": "Can we suggest that a glvalue expression can also be considered as a prvalue expression, since the conversion is possible?"}, {"owner": {"reputation": 2256, "user_id": 5645940, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2449971e95f183f145fb903b00c56b22?s=128&d=identicon&r=PG&f=1", "display_name": "b1sub", "link": "https://stackoverflow.com/users/5645940/b1sub"}, "edited": false, "score": 0, "creation_date": 1513786337, "post_id": 47909612, "comment_id": 82787899, "body": "With the modification that you mentioned, clang 3.8.0 indeed accepts it... It&#39;s weird that gcc still rejects it. Which version did you use?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 0, "creation_date": 1513786437, "post_id": 47909612, "comment_id": 82787950, "body": "Well, saying that &quot;<code>a</code> is not a constant expression&quot; would be incorrect. <code>a</code> is a constant expression in prvalue contexts. You can use <code>a</code> to declare bit-field width, for example. But apparently the original comment made by @cpplearner is the right way to see it: it is not a constant expression <i>in glvalue contexts</i> specifically."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 2, "creation_date": 1513786826, "post_id": 47909612, "comment_id": 82788165, "body": "@AnT There, I disagree. Bit-field asks for an &quot;integral constant expression&quot; which is not a subset of &quot;constant expression&quot; but rather &quot;an expression of integral [...] type, implicitly converted to a prvalue, where the converted expression is a core constant expression.&quot; Different requirement."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 13, "last_activity_date": 1514213097, "last_edit_date": 1592644375, "creation_date": 1513784223, "answer_id": 47909612, "question_id": 47908885, "link": "https://stackoverflow.com/questions/47908885/why-is-this-expression-not-a-constant-expression/47909612#47909612", "title": "Why is this expression not a constant expression?", "body": "<p>One of the rules for core constant expressions is that we <a href=\"http://eel.is/c++draft/expr.const#2.11\" rel=\"noreferrer\">can't evaluate</a>:</p>\n<blockquote>\n<p>an <em>id-expression</em> that refers to a variable or data member of reference type unless the reference has a preceding initialization and either</p>\n<ul>\n<li>it is initialized with a constant expression or</li>\n<li>its lifetime began within the evaluation of e;</li>\n</ul>\n</blockquote>\n<p><code>b</code> is an <em>id-expression</em> that refers to a variable of reference type with preceding initialization. However, it is initialized from <code>a</code>. Is <code>a</code> a constant expression? From <a href=\"http://eel.is/c++draft/expr.const#6\" rel=\"noreferrer\">[expr.const]/6</a>:</p>\n<blockquote>\n<p>A <em>constant expression</em> is either a glvalue core constant expression that refers to an entity that is a permitted result of a constant expression (as defined below), or a prvalue core constant expression whose value satisfies the following constraints: [... ]</p>\n<p>An entity is a <em>permitted result of a constant expression</em> if it is an object with static storage duration that is either not a temporary object or is a temporary object whose value satisfies the above constraints, or it is a function.</p>\n</blockquote>\n<p><code>a</code> is a glvalue core constant expression (it doesn't hit any of the restrictions in expr.const/2), however it is <em>not</em> an object with static storage duration. Nor is it a function.</p>\n<p>Hence, <code>a</code> is not a constant expression. And <code>b</code>, as a result, isn't initialized from a constant expression and so can't be used in a core constant expression. And thus <code>c</code>'s initialization is ill-formed as not being a constant expression. Declare <code>a</code> as a <code>static constexpr int</code>, and both gcc and clang accept the program.</p>\n<p>C++, you magical beast.</p>\n"}], "owner": {"reputation": 2256, "user_id": 5645940, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2449971e95f183f145fb903b00c56b22?s=128&d=identicon&r=PG&f=1", "display_name": "b1sub", "link": "https://stackoverflow.com/users/5645940/b1sub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2130, "favorite_count": 0, "accepted_answer_id": 47909612, "answer_count": 1, "score": 13, "last_activity_date": 1514213097, "creation_date": 1513782072, "last_edit_date": 1513869516, "question_id": 47908885, "link": "https://stackoverflow.com/questions/47908885/why-is-this-expression-not-a-constant-expression", "title": "Why is this expression not a constant expression?", "body": "<p>The expression <code>b</code> in this code shall be a <em>core constant expression</em></p>\n\n<pre><code>int main()\n{\n    constexpr int a = 10;\n    const int &amp;b = a;\n    constexpr int c = b; // here\n    return 0;\n}\n</code></pre>\n\n<p>since the standard says (8.20, paragraph 2 [expr.const] in <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4700.pdf\" rel=\"nofollow noreferrer\">n4700</a>)</p>\n\n<blockquote>\n  <p>An expression <code>e</code> is a <em>core constant expression</em> unless the evaluation of\n  <code>e</code> would evaluate one of the following expressions:</p>\n  \n  <ul>\n  <li><p>...</p></li>\n  <li><p>an lvalue-to-rvalue conversion (7.1) unless it is applied to</p>\n  \n  <ul>\n  <li><p>...</p></li>\n  <li><p><strong>a non-volatile glvalue</strong> that refers to <strong>a non-volatile object defined with constexpr</strong>, or that refers to a non-mutable subobject of such an object, or</p></li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<p>First, the expression <code>b</code> in the above code is an lvalue (which is also a glvalue) since it's a reference, thereby being a variable (8.1.4.1, paragraph 1 \n[expr.prim.id.unqual]):</p>\n\n<blockquote>\n  <p>The expression is an lvalue if the entity is a function,\n  <strong>variable</strong>, or data member and a prvalue otherwise; it is a bit-field if the identifier designates a bit-field (11.5).</p>\n</blockquote>\n\n<p>Second, the object the variable <code>b</code> denotes is <code>a</code>, and it's declared with <code>constexpr</code>. However, gcc complains</p>\n\n<pre><code>./hello.cpp: In function \u2018int main()\u2019:\n./hello.cpp:6:20: error: the value of \u2018b\u2019 is not usable in a constant expression\n  constexpr int c = b;\n                    ^\n./hello.cpp:5:13: note: \u2018b\u2019 was not declared \u2018constexpr\u2019\n  const int &amp;b = a;\n</code></pre>\n\n<p>As far as I can tell, <strong>a reference is not an object,</strong> so the above bullet apparently suggests that <code>a</code> shall be declared with <code>constexpr</code>. Am I missing something? The reason why I don't agree with gcc is that gcc sees <code>b</code> as an object, thereby requiring it to be declared with <code>constexpr</code>. However, <code>b</code> is not an object!</p>\n"}, {"tags": ["c++", "algorithm", "c++11", "lambda"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 5, "creation_date": 1513782155, "post_id": 47908839, "comment_id": 82785117, "body": "I am pretty shure that \u201edoes not compile\u201c is not the error message."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 1, "creation_date": 1513782605, "post_id": 47908839, "comment_id": 82785431, "body": "why not use a lambda to do the <code>notl</code>, it&#39;s more clear (at least to me)."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 1, "creation_date": 1513782652, "post_id": 47908839, "comment_id": 82785464, "body": "@appleapple especially when  this code already using lambda where it is not necessary"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1513782720, "post_id": 47908839, "comment_id": 82785515, "body": "smallest change: <code>return find_if(sv.begin(), sv.end(), isSelected) == sv.end();</code>"}, {"owner": {"reputation": 69, "user_id": 8943353, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6e002b6b2f20134510cd5b438b6fdee2?s=128&d=identicon&r=PG&f=1", "display_name": "Sabetay Toros", "link": "https://stackoverflow.com/users/8943353/sabetay-toros"}, "edited": false, "score": 0, "creation_date": 1513784215, "post_id": 47908839, "comment_id": 82786484, "body": "@manni66 just copy and paste the snippet and compile it with your compiler. You will see a full of window error messages which are beyond of my understanding to interprate .  If you can give me a hint on how to interprate that error messages I&#39;ll appreciate very much."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1513801866, "post_id": 47908839, "comment_id": 82795600, "body": "@SabetayToros definitely not!"}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513782862, "post_id": 47908973, "comment_id": 82785618, "body": "You should explain why it does not work without wrapper - &quot;The unary predicate type must define a member type, argument_type, that is convertible to the predicate&#39;s parameter type.&quot;"}, {"owner": {"reputation": 69, "user_id": 8943353, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6e002b6b2f20134510cd5b438b6fdee2?s=128&d=identicon&r=PG&f=1", "display_name": "Sabetay Toros", "link": "https://stackoverflow.com/users/8943353/sabetay-toros"}, "edited": false, "score": 0, "creation_date": 1513785177, "post_id": 47908973, "comment_id": 82787173, "body": "In reality the vector is not sorted.  it is written like that for demo purpose."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 69, "user_id": 8943353, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6e002b6b2f20134510cd5b438b6fdee2?s=128&d=identicon&r=PG&f=1", "display_name": "Sabetay Toros", "link": "https://stackoverflow.com/users/8943353/sabetay-toros"}, "edited": false, "score": 0, "creation_date": 1513785300, "post_id": 47908973, "comment_id": 82787271, "body": "@SabetayToros In this case you can substitute the call of std::binary search for the expression std::find( .. ) != sv.end()"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1513820652, "post_id": 47908973, "comment_id": 82801582, "body": "You might want to mention C++17 <a href=\"http://en.cppreference.com/w/cpp/utility/functional/not_fn\" rel=\"nofollow noreferrer\"><code>std::not_fn()</code></a>, which is much improved."}, {"owner": {"reputation": 551, "user_id": 929315, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ccdab3169bc098eb65e36060344c3531?s=128&d=identicon&r=PG", "display_name": "Rotsiser Mho", "link": "https://stackoverflow.com/users/929315/rotsiser-mho"}, "edited": false, "score": 0, "creation_date": 1564074060, "post_id": 47908973, "comment_id": 100920500, "body": "<code>std::not1</code> and <code>std::not2</code> were <a href=\"https://en.cppreference.com/w/cpp/header/functional#Deprecated_in_C.2B.2B17_and_removed_in_C.2B.2B20\" rel=\"nofollow noreferrer\">deprecated in C++17 and removed in C++20</a>. <code>std::not_fn()</code> is definitely the one to use now."}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1513783950, "last_edit_date": 1513783950, "creation_date": 1513782351, "answer_id": 47908973, "question_id": 47908839, "link": "https://stackoverflow.com/questions/47908839/how-to-negate-a-lambda-function-result/47908973#47908973", "title": "How to negate a lambda function result", "body": "<p>One of approaches is to use the wrapper <code>std::function</code>. For example</p>\n\n<pre><code>auto even = [](int x) { return x % 2 == 0; };\n\nstd::cout &lt;&lt; std::not1(std::function&lt;bool(int)&gt;(even))(11) &lt;&lt; std::endl;\n</code></pre>\n\n<p>The function object adapter <code>not1</code> requires that the corresponding predicate used as argument had typedef names <code>argument_type</code> and <code>result_type</code> and the wrapper <code>std::function</code> provides them.</p>\n\n<p>In your case the equivalent call would look like this:</p>\n\n<pre><code>stable_partition(v.begin(), next(v.begin(), 8) , not1(function&lt;bool(int&amp;)&gt;(validSelection)));\n</code></pre>\n\n<p><a href=\"https://ideone.com/Epi94K\" rel=\"nofollow noreferrer\">Demo.</a></p>\n\n<p>Or if I have understood correctly what you are trying to do then the corresponding code can look as it is shown in the following demonstrative program</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;functional&gt;\n#include &lt;algorithm&gt;\n\nint main()\n{\n    std::vector&lt;int&gt; sv = { 3, 5, 10, 12 };\n    std::vector&lt;int&gt; v = { 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15 };\n\n    auto validSelection = [&amp;](int x)\n    {\n        return std::binary_search(sv.begin(), sv.end(), x);\n    };\n\n    std::stable_partition(v.begin(), v.end(), validSelection);\n\n    for (int x : v) std::cout &lt;&lt; x &lt;&lt; ' ';\n    std::cout &lt;&lt; std::endl;\n\n    std::stable_partition(v.begin(), v.end(), std::not1( std::function&lt;bool( int )&gt;( validSelection) ) );\n\n    for (int x : v) std::cout &lt;&lt; x &lt;&lt; ' ';\n    std::cout &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>In this case the output is</p>\n\n<pre><code>3 5 10 12 1 2 4 6 7 8 9 11 13 14 15\n1 2 4 6 7 8 9 11 13 14 15 3 5 10 12\n</code></pre>\n\n<p>Pay attention to using of the algorithm <code>std::binary_search</code> because the vector <code>sv</code> is sorted.</p>\n"}], "owner": {"reputation": 69, "user_id": 8943353, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6e002b6b2f20134510cd5b438b6fdee2?s=128&d=identicon&r=PG&f=1", "display_name": "Sabetay Toros", "link": "https://stackoverflow.com/users/8943353/sabetay-toros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513818361, "creation_date": 1513781913, "last_edit_date": 1513818361, "question_id": 47908839, "link": "https://stackoverflow.com/questions/47908839/how-to-negate-a-lambda-function-result", "title": "How to negate a lambda function result", "body": "<p>In the following there is a code snippet written in C++ which does not compile.\nThe reason is trying to reverse the result of a lambda function using not1(). I'll appreciate very much if someone could fix this code </p>\n\n<pre><code>#include &lt;iostream&gt;     // std::cout\nusing namespace std;\n#include &lt;functional&gt;   // std::not1\n#include &lt;algorithm&gt;    // std::count_if\n#include &lt;vector&gt;\n\nint main () {\n    vector&lt;int&gt; sv = {3, 5, 10,12 };\n    vector&lt;int&gt; v = { 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15 };\n    auto validSelection = [&amp;](auto&amp; e) {\n        auto isSelected = [&amp;] (auto&amp; sve) {\n            return e == sve;\n        };\n        return find_if(sv.begin(), sv.end(), isSelected) != sv.end();\n    };\n    stable_partition(v.begin(), next(v.begin(),8) , not1(validSelection));\n    for (int n : v) {\n        std::cout &lt;&lt; n &lt;&lt; ' ';\n    }\n    std::cout &lt;&lt; '\\n';\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["html", "c++", "visual-studio", "google-maps", "google-maps-api-3"], "comments": [{"owner": {"reputation": 147337, "user_id": 1210329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d432c94998d9fb0a28f6bf2af22cdf96?s=128&d=identicon&r=PG", "display_name": "geocodezip", "link": "https://stackoverflow.com/users/1210329/geocodezip"}, "edited": false, "score": 0, "creation_date": 1513784333, "post_id": 47908752, "comment_id": 82786578, "body": "works for me in IE11"}, {"owner": {"reputation": 27113, "user_id": 5140781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GkAfu.jpg?s=128&g=1", "display_name": "xomena", "link": "https://stackoverflow.com/users/5140781/xomena"}, "edited": false, "score": 0, "creation_date": 1513890267, "post_id": 47908752, "comment_id": 82834394, "body": "Did you check if your browser doesn&#39;t use compatibility mode? Maybe this answer can help you: <a href=\"https://stackoverflow.com/a/40526335/5140781\">stackoverflow.com/a/40526335/5140781</a>"}], "owner": {"reputation": 1, "user_id": 9123200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eefa9b7679077bd0c1b6fcbcff90b4a5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan Fernando", "link": "https://stackoverflow.com/users/9123200/juan-fernando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 654, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513782102, "creation_date": 1513781691, "question_id": 47908752, "link": "https://stackoverflow.com/questions/47908752/why-i-cant-open-google-maps-api-in-internet-explorer-though-it-works-on-chrome", "title": "why i can&#39;t open Google Maps API in Internet Explorer. Though it works on Chrome", "body": "<p>I started working on a Windows Forms Appplication that implements Google Maps API V3. The error message is \"You are using a browser that is not supported by the Google Maps JavaScript API. Consider changing your browser\" (i have IE V.11).</p>\n\n<p>To simplify the matter and rule out problems i only generate a html file with the next code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\r\n&lt;html&gt;\r\n&lt;head&gt;\r\n&lt;meta http-equiv=\"X - UA - Compatible\" content=\"IE = edge\"&gt;\r\n&lt;meta name=\"MonViz\" content=\"initial-scale=1.0, user-scalable=no\"&gt;\r\n&lt;meta charset=\"utf-8\"&gt;&lt;title&gt;Google Maps&lt;/title&gt;\r\n&lt;style&gt;\r\n#map{\r\nheight: 100%;\r\n}\r\n html, body {\r\nheight: 100%;\r\nmargin: 0;\r\npadding: 0;\r\n}\r\n&lt;/style&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;div id=\"map\"&gt;&lt;/div&gt;\r\n&lt;script&gt;\r\nfunction initialize () {\r\nvar map = new google.maps.Map(document.getElementById('map'), {\r\ncenter: {lat: -32.7859107, lng: -61.5975163},\r\nzoom: 15,\r\nmapTypeId: 'satellite'\r\n}); \r\nvar ArmstrongCoordenadas = [\r\n{lat: -32.773431, lng: -61.608963},\r\n{lat: -32.775921, lng: -61.594001},\r\n{lat: -32.787867, lng: -61.596914},\r\n{lat: -32.789050, lng: -61.590069},\r\n{lat: -32.794850, lng: -61.591453},\r\n{lat: -32.791174, lng: -61.612879},\r\n{lat: -32.773431, lng: -61.608963}\r\n];\r\nvar ArmstrongPath = new google.maps.Polyline({\r\npath: ArmstrongCoordenadas,\r\ngeodesic: true,\r\nstrokeColor: '#FF0000',\r\nstrokeOpacity: 1.0,\r\nstrokeWeight: 4\r\n});\r\nArmstrongPath.setMap(map);\r\n}; \r\n&lt;/script&gt; \r\n &lt;script async defer src= \"https://maps.googleapis.com/maps/api/js?key=AIzaSyC6r2ufoRhiunVrIVkVoOb5nzUjSwEbfkA&amp;callback=initialize \" &gt;\r\n&lt;/script&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Next i try opening this file with IE and it does not work. Then i try with Chrome and it works! </p>\n\n<p>What i am doing bad? </p>\n"}, {"tags": ["c++", "multithreading"], "comments": [{"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1513781892, "post_id": 47908692, "comment_id": 82784957, "body": "so you want read have higher priority(even the data may be outdated)?"}, {"owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "reply_to_user": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1513785715, "post_id": 47908692, "comment_id": 82787519, "body": "Yes regardless of the data being outdated I need the threads to be able to read. without causing any problems. And preferably without implementing locks on every read rather instead I wanted to see if the Write thread can just check if everybody is done reading and conduct a write."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1513786683, "post_id": 47908692, "comment_id": 82788080, "body": "&quot;I understand that I could theoretically put the same mtx.lock and mtx.unlock on every read&quot; - theoretically? Because just 2 paragraphs earlier you said &quot;I have thus far implemented mtx.lock and mtx.unlock in the read&quot;."}, {"owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "edited": false, "score": 0, "creation_date": 1513787274, "post_id": 47908692, "comment_id": 82788430, "body": "Apologies I meant Write, I edited the question."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "edited": false, "score": 0, "creation_date": 1513786442, "post_id": 47909346, "comment_id": 82787953, "body": "I know of this solution I am trying to see if anyone knows a work around for this so that the writing thread just checks if anyone is reading prior to calling its own locks. So that I can have locks in just one place and not implement them at every read as there are really a lot of points where the read happens and it is just convenient to add locks at all of these places."}], "tags": [], "owner": {"reputation": 682, "user_id": 4840709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d67ac35e92ce156184d57b81fe2d644?s=128&d=identicon&r=PG", "display_name": "M.L.", "link": "https://stackoverflow.com/users/4840709/m-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1513783441, "creation_date": 1513783441, "answer_id": 47909346, "question_id": 47908692, "link": "https://stackoverflow.com/questions/47908692/how-to-have-a-thread-wait-untill-all-others-have-finished-reading-in-order-to-wr/47909346#47909346", "title": "How to have a thread wait untill all others have finished reading in order to write", "body": "<p>\"Can I have the thread that is doing the Writing wait until everybody is done with reading and then call locks and do the writing?\"</p>\n\n<p>Solution you ask about looks opposite to what you trying to achieve as you have multiple reading places. Every time you read you would have to send message (lock).</p>\n\n<p>Generally it sounds very bad, but nevertheless:\nIf your write happens incidentally, you can send \"lock\" message to reading threads. Reading thread will receive a message / an event, when you do occasionally write. Reading threads would then lock for a moment and send a message (it's ok to write) back to writing thread. After write complete writing threads will inform reading threads it's ok to read.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Readers%E2%80%93writer_lock\" rel=\"nofollow noreferrer\">Check this wiki page</a></p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "edited": false, "score": 0, "creation_date": 1514389626, "post_id": 47910474, "comment_id": 82957866, "body": "Is there any chance that I could trouble you for an example. As I have been trying to integrate this without much success."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "edited": false, "score": 0, "creation_date": 1514551209, "post_id": 47910474, "comment_id": 83014645, "body": "@ChronicUser: added"}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 0, "last_activity_date": 1514551202, "last_edit_date": 1514551202, "creation_date": 1513787241, "answer_id": 47910474, "question_id": 47908692, "link": "https://stackoverflow.com/questions/47908692/how-to-have-a-thread-wait-untill-all-others-have-finished-reading-in-order-to-wr/47910474#47910474", "title": "How to have a thread wait untill all others have finished reading in order to write", "body": "<p>The easiest solution might be a <code>std::atomic&lt;std::unordered_map*&gt;</code>.</p>\n\n<p>Atomic variables can be updated while being read. You can't guarantee whether the readers get the old or the new pointer, but they'll get one of the two and not a random value. </p>\n\n<p>This is easy, but has one drawback - how do you know when it's safe to <code>delete</code> the old map that you've retired? </p>\n\n<p>There is an alternative - <code>std::shared_ptr&lt;std::unordered_map&gt;</code>. The readers, <em>when reading</em> will make a private copy of the global pointer. This ensures the version of the map they're using stays alive. The writer thread just calls <code>std::make_shared</code> when it has a new map, and assigns it to the global pointer. </p>\n\n<p><code>std::shared_ptr</code> is thread-safe <em>enough</em>. Reading it is thread-safe, and there are no conflicting writers (each reader thread overwrites its own copy.)</p>\n\n<p>Ex.</p>\n\n<pre><code>class Writer {\n  std::shared_ptr&lt;std::unordered_map&lt;Foo&gt;&gt; m_map;\n  void add(Foo f) {\n     auto copy = std::make_shared&lt;std::unordered_map&lt;Foo&gt;&gt;(m_map);\n     copy.insert(f);\n     m_map = foo; // thread-safe\n  }\npublic:\n  std::shared_ptr&lt;std::unordered_map&lt;Foo&gt;&gt; getMap() { return m_map; }\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 693, "user_id": 2139902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0050129417b8d5d74968630b13da64c?s=128&d=identicon&r=PG", "display_name": "Sean Burton", "link": "https://stackoverflow.com/users/2139902/sean-burton"}, "is_accepted": false, "score": 1, "last_activity_date": 1513789139, "last_edit_date": 1513789139, "creation_date": 1513787936, "answer_id": 47910659, "question_id": 47908692, "link": "https://stackoverflow.com/questions/47908692/how-to-have-a-thread-wait-untill-all-others-have-finished-reading-in-order-to-wr/47910659#47910659", "title": "How to have a thread wait untill all others have finished reading in order to write", "body": "<p>It sounds like what you want is basically a read/write lock. This allows either multiple readers or a single writer to have access at any one time, but not both.</p>\n\n<p>This can be achieved in C++17 by using <code>std::shared_mutex</code>, or (for older C++) by using <code>boost::shared_mutex</code>. The shared mutex allows two levels of access, either <em>shared</em> access, which your readers would request, or <em>exclusive</em> access which you would request when you want to write.</p>\n"}], "owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1514551202, "creation_date": 1513781545, "last_edit_date": 1513787250, "question_id": 47908692, "link": "https://stackoverflow.com/questions/47908692/how-to-have-a-thread-wait-untill-all-others-have-finished-reading-in-order-to-wr", "title": "How to have a thread wait untill all others have finished reading in order to write", "body": "<p>OS: Windows 10\nProgramming language: C++</p>\n\n<p>I wrote a program which originally was not intended to be multi threaded. Now I am in the process of splinting it on to multiple threads.</p>\n\n<p>At this  point it all revolves around one unordered_map, there is only one thread that is modifying the map and all others just read.</p>\n\n<p>So basically one write multiple reads.</p>\n\n<p>I have thus far implemented mtx.lock and mtx.unlock in the write and that works just fine noone can read while the write process is taking place.</p>\n\n<p>The problem comes into being when the WRITE takes place while someone is reading.</p>\n\n<p>I understand that I could theoretically put the same mtx.lock and mtx.unlock on every read and that should solve the problem. But this is something I am desperately trying to avoid as there are a lot of points where the data is read and I would have to implement a hundred or more locks which is really inconvenient for me as it would be for anyone probably.</p>\n\n<p>My question is:\nCan I have the thread that is doing the Writing wait until everybody is done with reading and  then call locks and do the writing. And of course how would one go about doing this.</p>\n"}, {"tags": ["c++", "templates", "pass-by-reference", "cppcheck"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1513781523, "post_id": 47908656, "comment_id": 82784692, "body": "Only function-local <code>const&amp;</code>s prolong the lifetime of a temporary - not reference members in objects. If you want your reference member to remain valid, then just make the referent live for as long as the reference does; it&#39;s that simple. But then, a reference there is probably not really what you want... &quot;should be passed&quot; means just that, not &#39;should be stored in some other object&#39;."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1513781552, "post_id": 47908656, "comment_id": 82784723, "body": "The recommendation is for your constructor argument, not for your class member. You are referencing a temporary that is destroyed by the time you use it."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1513781750, "post_id": 47908656, "comment_id": 82784858, "body": "@AlBundy Fran&#231;ois got the answer; I just rambled about something else and then edited to mention what Fran&#231;ois was saying."}], "answers": [{"tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": true, "score": 2, "last_activity_date": 1513782863, "creation_date": 1513782863, "answer_id": 47909146, "question_id": 47908656, "link": "https://stackoverflow.com/questions/47908656/changing-class-member-to-reference-causes-crash/47909146#47909146", "title": "Changing class member to reference causes crash", "body": "<p>The recommendation is for your constructor argument, not for your class member. </p>\n\n<p>By making your data member a reference you introduce an implicit requirement that the referred object must have a lifetime at least as long as the instance of <code>fooClass</code>. But you are making it refer to <code>_classObject</code>, which is a function argument taken by value, a local copy of the vector passed to the constructor. This local copy's lifetime is limited the to duration of the constructor, which is to say much shorter than the lifetime of the instance being constructed. Trying to access the referred object after this point is undefined behavior.</p>\n\n<p>According to the recommendation, your constructor should look like this :</p>\n\n<pre><code>fooClass(const std::vector&lt;std::pair&lt;const char *, T&gt;&gt; &amp; _classObject)\n</code></pre>\n\n<p>By making the argument take a <code>const</code> reference you should avoid the creation of an unnecessary copy of the vector. However, since <code>std::vector</code> supports move semantics, the gains in performance will likely not be as significant in this case. It would be more noticeable if the vector was fully copied.</p>\n\n<p>Since it seems like you want <code>fooClass</code> to take ownership of the contents of the given vector (or of a copy of it) it would be wise to also provide a Rvalue reference overload for your constructor. Otherwise, in cases like the example you provided, a copy of the data will be made when the reference is assigned to <code>classObject</code> which may not be necessary.</p>\n\n<p>A common solution to avoid having multiple overloads is to only provide one overload that takes the object by value and to then move that copy into the class' data member. It's less optimal in that an instance may be needlessly move constructed, but it avoids code duplication. Rather or not this approach is right for you is up to you.</p>\n\n<p>Finally, consider rather or not <code>classObject</code> should be <code>const</code>. Doing so prevents your class from being assignable and movable. But what are the benefits?</p>\n"}], "owner": {"reputation": 4592, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 47909146, "answer_count": 1, "score": 1, "last_activity_date": 1514206195, "creation_date": 1513781439, "last_edit_date": 1514206195, "question_id": 47908656, "link": "https://stackoverflow.com/questions/47908656/changing-class-member-to-reference-causes-crash", "title": "Changing class member to reference causes crash", "body": "<p>I have this MCVE:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string&gt;\n#include &lt;utility&gt;\n#include &lt;vector&gt;\n\nenum class someEnum { first, second, none, };\n\ntemplate&lt;typename T&gt; class fooClass\n{\npublic:\n    fooClass( std::vector&lt;std::pair&lt;const char *, T&gt;&gt; _classObject )\n                                         : classObject( _classObject )  {};\n    auto findMember( const std::string &amp; memberName, T defaultReturn ) const -&gt; T;\nprivate:\n    const std::vector&lt;std::pair&lt;const char *, T&gt;&gt; classObject;\n};\n\ntemplate&lt;typename T&gt; auto fooClass&lt;T&gt;::findMember( const std::string &amp; memberName,\n                                                   T defaultReturn\n                                                 ) const -&gt; T\n{\n    for ( auto const &amp; it : classObject ) {\n        if ( 0 == memberName.compare( it.first ) ) {\n            return it.second;\n        }\n    }\n    return defaultReturn;\n}\n\nint main() {\n    fooClass&lt;someEnum&gt; somePairs( {\n                { \"text1\", someEnum::first }, { \"text2\", someEnum::second }, }); \n    printf( \"Value=%d\\n\", somePairs.findMember( \"text2\", someEnum::none ) );\n}\n</code></pre>\n\n<p>I ran <a href=\"http://cppcheck.sourceforge.net/\" rel=\"nofollow noreferrer\">Cppcheck</a> and it told me this:</p>\n\n<blockquote>\n  <p>Summary: Function parameter '_classObject' should be passed by\n  reference. Message: Parameter '_classObject' is passed by value. It\n  could be passed as a (const) reference which is usually faster and\n  recommended in C++.</p>\n</blockquote>\n\n<p>for this line:</p>\n\n<pre><code>    fooClass( std::vector&lt;std::pair&lt;const char *, T&gt;&gt; _classObject )\n                                         : classObject( _classObject )  {};\n</code></pre>\n\n<p>Ok, I changed then the declaration of <code>classObject</code> like this:</p>\n\n<pre><code>                                                  | Added the &amp; operand\n                                                  V\n    const std::vector&lt;std::pair&lt;const char *, T&gt;&gt; &amp; classObject;\n</code></pre>\n\n<p><code>gcc</code> with the highest warning level accepts this change but when I run the program it crashes. The reason for the crash is that <code>it.first</code> is null.</p>\n\n<p>What do I have to change that a reference is used and the program works?</p>\n"}, {"tags": ["c++", "pass-by-reference"], "comments": [{"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1513781420, "post_id": 47908621, "comment_id": 82784614, "body": "you can try it. (by <i>call</i> <code>f</code> somewhere else)"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1513781671, "post_id": 47908621, "comment_id": 82784798, "body": "<i>&quot;Both seam to compile and work.&quot;</i> Show me. I don&#39;t believe for a second that any code can interchange <code>vector&lt;Foo&gt;</code> and <code>vector&lt;const Foo&amp;&gt;</code> in a function signature and still compile for the same call site... not that the latter is valid anyway since containers can&#39;t contain references."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1513781477, "creation_date": 1513781477, "answer_id": 47908669, "question_id": 47908621, "link": "https://stackoverflow.com/questions/47908621/passing-a-vector-by-const-reference-with-a-custom-type-in-c/47908669#47908669", "title": "Passing a vector by const reference with a custom type in C++", "body": "<p>You should pass <code>const std::vector&lt;Foo&gt;&amp;</code> as the type. This prevents a value copy of the vector from being taken when the function is called.</p>\n\n<p>Note that a <code>std::vector&lt;Foo&amp;&gt;</code> is not allowed by the current standards: a <code>std::vector</code> cannot contain reference types.</p>\n"}], "owner": {"reputation": 31, "user_id": 7767897, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6zgee90uKs0/AAAAAAAAAAI/AAAAAAAAAHg/wOAgFRwq1dU/photo.jpg?sz=128", "display_name": "Larz", "link": "https://stackoverflow.com/users/7767897/larz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1649, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1513781883, "creation_date": 1513781335, "last_edit_date": 1513781883, "question_id": 47908621, "link": "https://stackoverflow.com/questions/47908621/passing-a-vector-by-const-reference-with-a-custom-type-in-c", "title": "Passing a vector by const reference with a custom type in C++", "body": "<p>Say you have the custom type,</p>\n\n<pre><code>class Foo {}\n</code></pre>\n\n<p>Is the correct way to pass a vector of type Foo by const reference to a method like this,</p>\n\n<pre><code>void f(const std::vector&lt;const Foo&amp;&gt;&amp; bar);\n</code></pre>\n\n<p>or should I do,</p>\n\n<pre><code>void f(const std::vector&lt;Foo&gt;&amp; bar);\n</code></pre>\n\n<p>I'm more curious on which one I should prefer to use.</p>\n"}, {"tags": ["c++", "c++11", "producer-consumer", "unique-lock"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1513801350, "post_id": 47908552, "comment_id": 82795324, "body": "You don&#39;t need (1). You need (2) because otherwise <code>producer</code> holds the lock while sleeping, thereby starving <code>consumer</code>. Also, your program exhibits undefined behavior: it populates <code>g_queue</code> with pointers to local variables which may very well be destroyed by the time the pointer is retrieved and dereferenced."}, {"owner": {"reputation": 417, "user_id": 179012, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/e8ff5da2fab45417d3464ff16f2474b7?s=128&d=identicon&r=PG", "display_name": "cpp11dev", "link": "https://stackoverflow.com/users/179012/cpp11dev"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1513811809, "post_id": 47908552, "comment_id": 82799432, "body": "yes, I understand it now. Starving is the cause of the behavior I could see when I was running with removing (1) and (2) both. So I removed the sleep statement and could see context switch in the output. Also, I could understand the local variable issue and have rectified it in my code as well."}], "answers": [{"comments": [{"owner": {"reputation": 417, "user_id": 179012, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/e8ff5da2fab45417d3464ff16f2474b7?s=128&d=identicon&r=PG", "display_name": "cpp11dev", "link": "https://stackoverflow.com/users/179012/cpp11dev"}, "edited": false, "score": 0, "creation_date": 1513907279, "post_id": 47916222, "comment_id": 82839322, "body": "yes this was still a question. So for throttling we need 2 new CV to manage the queue buffer emptiness and fullness.At this point, when not yet starting to think about optimization, I can re-write the code above to use the throttle management. Let me try and come back here again. Thank you."}], "tags": [], "owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "is_accepted": false, "score": 0, "last_activity_date": 1513816098, "creation_date": 1513816098, "answer_id": 47916222, "question_id": 47908552, "link": "https://stackoverflow.com/questions/47908552/difficulty-with-unique-lock-in-simple-producer-consumer/47916222#47916222", "title": "Difficulty with unique_lock in simple Producer &amp; Consumer", "body": "<p>Not sure there's still a question here, but one solution for throttling is to have a maximum size the queue is allowed to grow to in the producer. When the queue reaches this size, the producer waits on a different condition variable. The consumer signals this second condition variable when the queue drops below a certain size. (The latter size perhaps being somewhat less than the maximum to give some hysteresis.) The predicate for the wait on this new condition variable is <code>g_queue.size() &gt;= max_size</code>.</p>\n"}], "owner": {"reputation": 417, "user_id": 179012, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/e8ff5da2fab45417d3464ff16f2474b7?s=128&d=identicon&r=PG", "display_name": "cpp11dev", "link": "https://stackoverflow.com/users/179012/cpp11dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513818073, "creation_date": 1513781096, "last_edit_date": 1513818073, "question_id": 47908552, "link": "https://stackoverflow.com/questions/47908552/difficulty-with-unique-lock-in-simple-producer-consumer", "title": "Difficulty with unique_lock in simple Producer &amp; Consumer", "body": "<p>I have written a very simple Producer/Consumer based out of C++11 notes and unable to figure out why the unique_lock() does not release the lock when goes out of scope.</p>\n\n<pre><code>struct Message{\nMessage(int x):data(x){cout&lt;&lt;\"+\";}\nint data;\n};\n\n\nqueue&lt;Message*&gt; g_queue;\ncondition_variable cv;\nmutex m;\n\nvoid consumer()\n{\n    do {\n        unique_lock&lt;mutex&gt; lck {m};\n        cv.wait(lck, [&amp;](){return !g_queue.empty();});\n        cout&lt;&lt;\"Notified...\";\n        auto&amp; obj = g_queue.front();\n        std::cout&lt;&lt;obj-&gt;data;\n        g_queue.pop();\n        cout&lt;&lt;\".\";\n        lck.unlock(); -----(1)\n    } while(1);\n\n}\n\nvoid producer() \n{\n    while(true){\n            unique_lock&lt;mutex&gt; lck {m};\n            Message msg{5};\n            cout&lt;&lt;\"Queue size:\"&lt;&lt;g_queue.size()&lt;&lt;'\\n';\n            g_queue.push(&amp;msg);\n            cv.notify_one();\n            lck.unlock(); -------(2)\n            cout&lt;&lt;\"-\"&lt;&lt;'\\n';\n            this_thread::sleep_for(std::chrono::milliseconds{2000});\n    }\n}\n</code></pre>\n\n<p>And use it as:-</p>\n\n<pre><code>    thread Q(&amp;consumer);\n    thread P(&amp;producer);\n    P.join();\n    Q.join();\n</code></pre>\n\n<p>The output is:-</p>\n\n<pre><code>+Queue size:0\n-Notified...\n5.+Queue size:0\n-Notified...5\n.+Queue size:0\n-Notified...5\n</code></pre>\n\n<p>So technically, yes, Producer needs to tell Consumer that I am ready and Consumer needs to let Producer know send more data. I am not clear on what to use, does condition variable does this or does unique_lock does this. </p>\n\n<p>Precisely, why I need (1) and (2) when the scope can release the locks</p>\n\n<p>==Edit==\nFollowing is the edited code, which works fine,</p>\n\n<pre><code>void consumer()\n{\n    do {\n        unique_lock&lt;mutex&gt; lck {m};\n        cv.wait(lck, [&amp;](){return !g_queue.empty();});\n        cout&lt;&lt;\"Notified...\";\n        auto&amp; obj = g_queue.front();\n        std::cout&lt;&lt;obj-&gt;data;\n        g_queue.pop();\n        cout&lt;&lt;\".\";\n    } while(1);\n\n}\n\nMessage msg{5};\nvoid producer() \n{\n    while(true){\n            unique_lock&lt;mutex&gt; lck {m};\n            cout&lt;&lt;\"Queue size:\"&lt;&lt;g_queue.size()&lt;&lt;'\\n';\n            g_queue.push(&amp;msg);\n            cv.notify_one();\n            cout&lt;&lt;\"-\"&lt;&lt;'\\n';\n    }\n}\n</code></pre>\n\n<p>Now, how do I introduce a little throttle if I want to in Producer or Consumer if sleep is risky ?</p>\n"}, {"tags": ["c++", "lambda", "scope", "shared-ptr"], "comments": [{"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1513781037, "post_id": 47908488, "comment_id": 82784316, "body": "What is <code>stuff</code>?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1513781590, "post_id": 47908488, "comment_id": 82784743, "body": "&quot;What happens is that as soon as it goes out of scope (return a), I can&#39;t access the object anymore.&quot; this is not true so it is unclear what problem you have. Provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 488, "user_id": 7384437, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/386e2d14621537e11c4790308b91dbd0?s=128&d=identicon&r=PG&f=1", "display_name": "lars", "link": "https://stackoverflow.com/users/7384437/lars"}, "edited": false, "score": 0, "creation_date": 1513781598, "post_id": 47908488, "comment_id": 82784746, "body": "Your example is confusing in many ways. Narrow it down to things that are relevant to your problem. You have &quot;args&quot; without type and no usage anywhere, &quot;method_name&quot; being a member function, but there&#39;s no class, &quot;input&quot; without type....  <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>  If not being able to compile is the problem &quot;return a;&quot;, narrow it down to the line that does not compile."}, {"owner": {"reputation": 27, "user_id": 8902951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1135d9ea96f3477787dd7837ef74a83?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Lopes", "link": "https://stackoverflow.com/users/8902951/rafael-lopes"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1513882510, "post_id": 47908488, "comment_id": 82830946, "body": "@JonathanMee Some irrelevant code for this scenario. could be just some log or nothing at all, so I decided to keep it out."}, {"owner": {"reputation": 27, "user_id": 8902951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1135d9ea96f3477787dd7837ef74a83?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Lopes", "link": "https://stackoverflow.com/users/8902951/rafael-lopes"}, "reply_to_user": {"reputation": 488, "user_id": 7384437, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/386e2d14621537e11c4790308b91dbd0?s=128&d=identicon&r=PG&f=1", "display_name": "lars", "link": "https://stackoverflow.com/users/7384437/lars"}, "edited": false, "score": 0, "creation_date": 1513882695, "post_id": 47908488, "comment_id": 82831025, "body": "@lars I understand. I actually spent too many hours on this and my brain is confused itself. I tried to get things that I thought to be unnecessary as abstract. The args are not important here, just to show that I am setting an exception if args is/are nullptrs.  everything compiles well, and there are no crashes. Check my edit, maybe it helps understanding better my problem."}], "answers": [{"tags": [], "owner": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "is_accepted": false, "score": 2, "last_activity_date": 1513782320, "last_edit_date": 1513782320, "creation_date": 1513781769, "answer_id": 47908780, "question_id": 47908488, "link": "https://stackoverflow.com/questions/47908488/shared-pointer-set-in-lambda-after-out-of-scope/47908780#47908780", "title": "Shared Pointer set in Lambda after out of scope", "body": "<p>Of course you can't access the object anymore, because it is <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr/~shared_ptr\" rel=\"nofollow noreferrer\">destroyed</a> when the <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow noreferrer\">shared pointer</a> leaves the scope of the <code>if(args)</code> block, where it is created. You'll need to have the object living outside the method, e. g. storing it as class member or (&lt;deity&gt; forbid!) in a global variable. </p>\n\n<p>Whether you need to wrap it in a shared pointer or not is unclear, you'll need to provide a MCVE together with a clearer description of <a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">what you want to achieve</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 8902951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1135d9ea96f3477787dd7837ef74a83?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Lopes", "link": "https://stackoverflow.com/users/8902951/rafael-lopes"}, "edited": false, "score": 0, "creation_date": 1513883529, "post_id": 47908796, "comment_id": 82831460, "body": "The method is async. I just provide the arguments for it and I received later a callback with what I need (this async Method is not implemented by me, neither I can change it). So I guess the bind would not work here. My problem is that I need to change a value of a shared_ptr in a lambda, but I am returning it before the lambda is executing. When I am trying to use the returned value in another class (I am testing it), even though the lambda executes and sets the value to the correct thing, it seems like it not update the pointer I am using in the second class."}], "tags": [], "owner": {"reputation": 2606, "user_id": 2807083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5243f429132252828f081c61979aa614?s=128&d=identicon&r=PG&f=1", "display_name": "user2807083", "link": "https://stackoverflow.com/users/2807083/user2807083"}, "is_accepted": false, "score": 1, "last_activity_date": 1513781811, "creation_date": 1513781811, "answer_id": 47908796, "question_id": 47908488, "link": "https://stackoverflow.com/questions/47908488/shared-pointer-set-in-lambda-after-out-of-scope/47908796#47908796", "title": "Shared Pointer set in Lambda after out of scope", "body": "<p>If your <code>callAsync</code> is really asynchronous, your lambda could start to execute when local variables <code>result</code> and <code>a</code> is alreay out of scope. You should pass needed variables as parameters, e.g. as binding with <code>std::bind</code>:</p>\n\n<pre><code>typedef shared_ptr&lt;Result&gt; ResultPtr;\nResultPtr method_name(args)\n{\n    if(args)\n    {\n        ResultPtr a = make_shared&lt;Result&gt;();\n        std::weak_ptr&lt;Result&gt; result(a);\n        stuff-&gt;callAsync(std::bind([this](std::weak_ptr&lt;Result&gt; result_param)\n        {\n            auto resultPtr = result_param.lock();\n            if(resultPtr)\n            {\n                resultPtr-&gt;setValue()\n                ...other stuff...\n            }\n        }, result));\n    }\n    else\n    {\n        a-&gt;setError();\n    }\n    return a;\n}\n</code></pre>\n\n<p>and yes, your example is confusing</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 8902951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1135d9ea96f3477787dd7837ef74a83?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Lopes", "link": "https://stackoverflow.com/users/8902951/rafael-lopes"}, "edited": false, "score": 0, "creation_date": 1513883103, "post_id": 47908851, "comment_id": 82831211, "body": "Yes I am aware of it now, but I was not sure if I was thinking correctly. The original code had shared_pointers passed to lambda. After your answer I decided to just keep the shared_ptr in my solution. However that way it still does not solve my problem. When I am using the returned value from that method, then the lambda receives the callback. But this value does not update the value I received in this other method that I am using for testing."}], "tags": [], "owner": {"reputation": 693, "user_id": 2139902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0050129417b8d5d74968630b13da64c?s=128&d=identicon&r=PG", "display_name": "Sean Burton", "link": "https://stackoverflow.com/users/2139902/sean-burton"}, "is_accepted": false, "score": 1, "last_activity_date": 1513783384, "last_edit_date": 1513783384, "creation_date": 1513781956, "answer_id": 47908851, "question_id": 47908488, "link": "https://stackoverflow.com/questions/47908488/shared-pointer-set-in-lambda-after-out-of-scope/47908851#47908851", "title": "Shared Pointer set in Lambda after out of scope", "body": "<p>If you need the lambda to guarantee that it keeps the object alive, why are you using a weak pointer to pass in, instead of a shared pointer? The purpose of a weak pointer is the behaviour you are seeing, where it does not itself keep the object alive.</p>\n\n<p>Because you are only capturing a weak pointer it does not keep the shared pointer alive when the only shared pointer goes out of scope, if it goes out of scope before you have locked the weak pointer. But you could just capture the shared pointer (by value, so a copy is taken) instead of using a weak pointer. Then the reference count will be incremented and the shared pointer inside the lambda will keep it alive, and it will only be deleted when both shared pointers have gone out of scope.</p>\n\n<p>Shared ownership like this is the reason for a shared pointer, you should only use a weak pointer if it is desirable that the object will no longer be accessible if the shared pointer reference count reaches zero.</p>\n"}], "owner": {"reputation": 27, "user_id": 8902951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1135d9ea96f3477787dd7837ef74a83?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Lopes", "link": "https://stackoverflow.com/users/8902951/rafael-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1513927961, "creation_date": 1513780869, "last_edit_date": 1513882883, "question_id": 47908488, "link": "https://stackoverflow.com/questions/47908488/shared-pointer-set-in-lambda-after-out-of-scope", "title": "Shared Pointer set in Lambda after out of scope", "body": "<p>I am having a problem with shared pointers, lambdas and scope.</p>\n\n<p>My situation is that I have a method which I call, so I can use later the returned value. Kind of normal until here. The problem comes when I have an async method inside this method, that I have to make a set of an exception to a shared_pointer. I am using a lambda function to process the callback from this async method. In this lambda I have to use my shared_pointer and set an exception on it (a method from its class) resultPtr->setException();</p>\n\n<p>I first used a shared_ptr, then a weak_ptr in the lambda (because I read in some places that the shared_ptr could lead to memory leaks). But until now I guess I really need to use a shared_ptr.</p>\n\n<p>I have to test if this exception is being set in a second .cpp, so I call the method and use the returned value. I put the thread waiting for about 500ms then I test if it has exceptions, but it does not. However, in very rare cases, it \"hasException\". I can see that the lambda is being called and that it sets the exception through my logs, however it seems like it does not change the value I returned first (like it is pointing to a different place).</p>\n\n<p>The inputs of the first method I mentioned are not important for my case, only that they are Pointers.</p>\n\n<p>In my case I have something like:</p>\n\n<pre><code>file1.cpp\ntypedef shared_ptr&lt;Result&gt; ResultPtr;\nResultPtr method_name(TypePtr args)\n{\n    if(args != nullptr)\n    {\n        ResultPtr result = make_shared&lt;Result&gt;();\n        stuff-&gt;callAsync([this, result](input)\n        {\n            if(result == nullptr)\n            {\n                result-&gt;setException();\n            }\n        });\n    }\n    else\n    {\n        result-&gt;setError();\n    }\n    return result;\n}\n\nfile2.cpp\nbool testingMethod()\n{\n    ResultPtr result = file1::methodName(TypePtr args)\n    std::this_thread::sleep_for(std::chrono::milliseconds(500));\n    test(result-&gt;hasException);\n}\n</code></pre>\n\n<p>For testing I am using another class where I call this method with certain inputs(not important here) and I need to compare the object value of resultPtr. What happens is that as soon as it goes out of scope (return a), I can't access the object anymore. After I call this method, I put the thread waiting for about 1 second, but it never changes the state (since it can't point to a destroyed object)</p>\n\n<p>Is there anyway to overcome this? Other suggestions?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1513781228, "post_id": 47908448, "comment_id": 82784458, "body": "It does <a href=\"http://coliru.stacked-crooked.com/a/1228538670b4e33e\" rel=\"nofollow noreferrer\">work</a>. You need nothing else."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1513781329, "post_id": 47908448, "comment_id": 82784546, "body": "Have you tried it? <a href=\"https://ideone.com/SOSjKI\" rel=\"nofollow noreferrer\">ideone.com/SOSjKI</a>"}, {"owner": {"reputation": 21, "user_id": 9123199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b97b9322ce50b33d2c462ccc34d58505?s=128&d=identicon&r=PG&f=1", "display_name": "user9123199", "link": "https://stackoverflow.com/users/9123199/user9123199"}, "edited": false, "score": 0, "creation_date": 1513781442, "post_id": 47908448, "comment_id": 82784631, "body": "It compiles. But the program crashes."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1513781526, "post_id": 47908448, "comment_id": 82784694, "body": "You&#39;re looking in the wrong place, if it doesn&#39;t crash when you exactly replace <code>func({1, 20, 1400, 1});</code> with <code>long long int a=20;  func({1, a, 1400, 1});</code> then that suggests your program has undefined behaviour."}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 2, "creation_date": 1513783322, "post_id": 47908448, "comment_id": 82785921, "body": "Instead of posting random snippets, please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. I&#39;m guessing you initialize the <code>dims</code> data member with the <code>dims</code> constructor parameter. That will not work because an <code>initializer_list</code> is not a container, change the <code>dims</code> member to a <code>vector</code> instead."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 4, "creation_date": 1513783384, "post_id": 47908448, "comment_id": 82785961, "body": "<code>initializer_list</code> is not meant to be a general-purpose container or persistent store of data. Why did you think it was? It&#39;s just an iterable view over a compiler-allocated array, for the purposes of initialising other types of object, in which the array only lasts as long as the original expression that first created the <code>initializer_list</code>. Copying the argument into your member just gets you a copy of the iterators to that underlying array, which then goes out of scope and gives you total UB."}], "answers": [{"tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": true, "score": 2, "last_activity_date": 1513783968, "creation_date": 1513783968, "answer_id": 47909528, "question_id": 47908448, "link": "https://stackoverflow.com/questions/47908448/stdinitializer-list-initialization-from-variable/47909528#47909528", "title": "std::initializer_list initialization from variable", "body": "<p><code>std::initializer_list</code> is not a <em>container</em>. It is a reference to a temporary array. It's a type whose <em>purpose</em> is to initialize another object (hence being called an <i>initializer</i>_list), and you should not use it for <em>anything</em> other than that.</p>\n\n<p>The temporary array the <code>initializer_list</code> references works like any other temporary in C++. In the case of </p>\n\n<pre><code>vector&lt;L&gt; input = {\n    {\"aaaaa\", {1, 20, 1400, 1}, input_data}};\n</code></pre>\n\n<p>The temporary array will be destroyed immediately after this statement is executed. So you will store a pointer to a destroyed array. And therefore, your program has UB.</p>\n\n<p>Now, why does your UB only lead to a crash if you use a variable?</p>\n\n<p>That's because \"temporary array\" means whatever the compiler wants it to mean. In the case of <code>{1, 20, 1400, 1}</code>, these are all literals. So the compiler can put that array in static storage in your binary rather than making it a stack array at runtime. This saves runtime stack space, so it could be considered a reasonable optimization.</p>\n\n<p>However, once you use a <em>variable</em> in the braced-init-list, that can't work (unless it's a <code>constexpr</code> variable). So the compiler is required to follow the temporary wording more strictly. Therefore, it creates a stack array, which is reclaimed after that code executes. So when you access it later... boom.</p>\n\n<p>Even so, <em>do not rely on this.</em> Your program has UB either way.</p>\n"}], "owner": {"reputation": 21, "user_id": 9123199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b97b9322ce50b33d2c462ccc34d58505?s=128&d=identicon&r=PG&f=1", "display_name": "user9123199", "link": "https://stackoverflow.com/users/9123199/user9123199"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1513799010, "accepted_answer_id": 47909528, "answer_count": 1, "score": -1, "last_activity_date": 1513783968, "creation_date": 1513780774, "last_edit_date": 1513783147, "question_id": 47908448, "link": "https://stackoverflow.com/questions/47908448/stdinitializer-list-initialization-from-variable", "closed_reason": "Not suitable for this site", "title": "std::initializer_list initialization from variable", "body": "<pre><code>class L {\n      public:\n        L(const std::string&amp; name, std::initializer_list&lt;long long int&gt; dims, float* data);\n        std::string name;\n        std::initializer_list&lt;long long int&gt; dims;\n        float* data;\n    };\n</code></pre>\n\n<p>I can do following</p>\n\n<pre><code>vector&lt;L&gt; input = {\n                {\"aaaaa\", {1, 20, 1400, 1}, input_data}};\n</code></pre>\n\n<p>But I can not do following (it compiles, but the running will crash)</p>\n\n<pre><code>long long int a =20;\nvector&lt;L&gt; input = {\n                {\"aaaaa\", {1, a, 1400, 1}, input_data}};\n</code></pre>\n"}, {"tags": ["c++", "key", "size", "inline", "multimap"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513781249, "post_id": 47908326, "comment_id": 82784482, "body": "Maybe std::multimap is not the best data structure for you. For example <code>std::map&lt;key,std::vector&lt;value&gt;&gt;</code> could work better."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1513781470, "post_id": 47908326, "comment_id": 82784657, "body": "what about <code>const auto keyCount = std::accumulate(...</code> that wraps the for loop?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513781490, "post_id": 47908326, "comment_id": 82784673, "body": "@Slava That suffers from the <code>vector</code> of <code>vector</code>s problem: <a href=\"https://stackoverflow.com/q/38244435/2642059\">stackoverflow.com/q/38244435/2642059</a> (Though this may still be my best option, I&#39;d still like an answer to the question.)"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1513781807, "post_id": 47908326, "comment_id": 82784900, "body": "@tobi303 I doubt <code>std::accumulate()</code> can jump over unique keys"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1513781853, "post_id": 47908326, "comment_id": 82784937, "body": "@tobi303 I was going to lash out that that would require me to step through all the elements in the <code>multimap</code> but as I think about it I&#39;m pretty sure <code>upper_bound</code> is doing just that. I suppose to your point we could probably do this using <code>count_if</code> or <code>for_each</code> as well :( I&#39;m assuming that&#39;s going to be as good of an answer as I&#39;m going to get, if you type up I&#39;ll accept."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513781901, "post_id": 47908326, "comment_id": 82784962, "body": "@Slava, I... don&#39;t think that <code>upper_bound</code> jumps keys does it?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1513781946, "post_id": 47908326, "comment_id": 82784990, "body": "@Slava Op, no, cancel that it does a binary search: <a href=\"http://en.cppreference.com/w/cpp/container/multimap/upper_bound#Complexity\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/multimap/&hellip;</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1513782163, "post_id": 47908326, "comment_id": 82785128, "body": "it was just a blind guess. If I find the time later I will write an answer, but atm my compile times are rather short :P"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 9124890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128c56e8fd096085ddf3dac668724993?s=128&d=identicon&r=PG&f=1", "display_name": "user9124890", "link": "https://stackoverflow.com/users/9124890/user9124890"}, "is_accepted": false, "score": 0, "last_activity_date": 1513816694, "creation_date": 1513816694, "answer_id": 47916293, "question_id": 47908326, "link": "https://stackoverflow.com/questions/47908326/is-there-a-way-to-find-the-number-of-keys-in-a-multimap-inline/47916293#47916293", "title": "Is There a way to Find the Number of Keys in a multimap Inline?", "body": "<p>No, there is no built-in in the standard to do this. Consider that your count function works because a multimap is internally sorted. Typical implementations such as libstdc++ use red-black trees for the internal representation. You would need to walk the tree in order to count all the (unique) keys. It's unavoidable.</p>\n"}, {"tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": true, "score": 0, "last_activity_date": 1513870193, "creation_date": 1513870193, "answer_id": 47928082, "question_id": 47908326, "link": "https://stackoverflow.com/questions/47908326/is-there-a-way-to-find-the-number-of-keys-in-a-multimap-inline/47928082#47928082", "title": "Is There a way to Find the Number of Keys in a multimap Inline?", "body": "<p>1<sup>st</sup>, <a href=\"http://en.cppreference.com/w/cpp/container/multimap\" rel=\"nofollow noreferrer\"><code>multimap</code></a> doesn't contain a key count naively. So your question then is about how to use something from the <a href=\"http://en.cppreference.com/w/cpp/algorithm\" rel=\"nofollow noreferrer\">algorithm library</a> to find the count. The 2 constraints you have placed that preclude everything in the library are:</p>\n\n<ol>\n<li>Must be used inline, so a count, not an iterator must be returned</li>\n<li>Must perform at least as well as <a href=\"http://en.cppreference.com/w/cpp/container/multimap/upper_bound\" rel=\"nofollow noreferrer\"><code>upper_bound</code></a> used in a lambda, which has time complexity: <em>O(log n)</em></li>\n</ol>\n\n<p><strong>1</strong> leaves us with: <code>count</code>, <code>count_if</code>, <code>for_each</code>, as well as most of the algorithms in the <a href=\"http://en.cppreference.com/w/cpp/header/numeric\" rel=\"nofollow noreferrer\">numeric library</a></p>\n\n<p><strong>2</strong> eliminates consideration of all of these as each of them has time complexity: <em>O(n)</em></p>\n\n<p>As such your <code>getKeyCount</code> is preferable to any other option that the standard supplies.</p>\n\n<hr>\n\n<p>Just a comment about another option that may be presented: the maintenance of <code>keyCount</code> whenever something is added or removed from <code>foo</code>, this may seem workable, but it requires a check before each insert if the inserted key exists, and a check after each removal if the removed key still exists. Aside from this, there is also the consideration of the danger of multi-threaded inoperability and the loss of code readability, where it's not clear that this <code>keyCount</code> must be maintained along with <code>foo</code>. Ultimately this a bad idea unless the key count is taken significantly more frequently than <code>foo</code> is updated.</p>\n"}, {"comments": [{"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1537463520, "post_id": 52429545, "comment_id": 91803731, "body": "This probably should have been a comment :( See also the problems presented in the second half of this answer: <a href=\"https://stackoverflow.com/a/47928082/2642059\">stackoverflow.com/a/47928082/2642059</a>"}], "tags": [], "owner": {"reputation": 285, "user_id": 3173716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bf0d3c03570f2190e3172e80869f8a?s=128&d=identicon&r=PG&f=1", "display_name": "sanjivgupta", "link": "https://stackoverflow.com/users/3173716/sanjivgupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1537461241, "creation_date": 1537461241, "answer_id": 52429545, "question_id": 47908326, "link": "https://stackoverflow.com/questions/47908326/is-there-a-way-to-find-the-number-of-keys-in-a-multimap-inline/52429545#52429545", "title": "Is There a way to Find the Number of Keys in a multimap Inline?", "body": "<p>If you only are creating multimap and inserting values in it, you can keep a companion map to record different types of keys. That size of that map will give you key count.</p>\n"}], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1057, "favorite_count": 1, "accepted_answer_id": 47928082, "answer_count": 3, "score": 3, "last_activity_date": 1537461241, "creation_date": 1513780411, "question_id": 47908326, "link": "https://stackoverflow.com/questions/47908326/is-there-a-way-to-find-the-number-of-keys-in-a-multimap-inline", "title": "Is There a way to Find the Number of Keys in a multimap Inline?", "body": "<p>A <code>multimap</code>'s <code>size</code> reports the number of values it contains. I'm interested in the number of keys it contains. For example, given <code>multimap&lt;int, double&gt; foo</code> I'd like to be able to do this:</p>\n\n<pre><code>const auto keyCount = ???\n</code></pre>\n\n<p>One way to get this is to use a <code>for</code>-loop on a zero initialized <code>keyCount</code>:</p>\n\n<pre><code>for(auto it = cbegin(foo); foo != cend(foo); it = foo.upper_bound(foo-&gt;first)) ++keyCount;\n</code></pre>\n\n<p>This however, does not let me perform the operation inline. So I can't initialize a <code>const auto keyCount</code>.</p>\n\n<p>A solution could be a lambda or function which wraps this <code>for</code>-loop such as:</p>\n\n<pre><code>template &lt;typename Key, typename Value&gt;\nsize_t getKeyCount(const multimap&lt;Key, Value&gt;&amp; arg) {\n    size_t result = 0U;\n\n    for(auto it = cbegin(foo); foo != cend(foo); it = foo.upper_bound(foo-&gt;first)) ++result;\n    return result;\n}\n</code></pre>\n\n<p>But I was hoping for something provided by the standard. Does such a thing exist?</p>\n"}, {"tags": ["c++", "boost", "dijkstra"], "comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1513785099, "post_id": 47908325, "comment_id": 82787114, "body": "You are probably writing outside the bounds of an array somewhere.  What&#39;s the declaration for <code>distMat</code>?"}, {"owner": {"reputation": 11, "user_id": 5145191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd62220aa0a3cdbc9c243f67b97e2ddc?s=128&d=identicon&r=PG&f=1", "display_name": "amina", "link": "https://stackoverflow.com/users/5145191/amina"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1513840597, "post_id": 47908325, "comment_id": 82807067, "body": "Thank you for your interest in this question. The declaration of distMap:m_DistMat = (int**) malloc(sizeof(int*)*m_dim); \tif (m_DistMat==NULL) return false;     for(int i=0;i&lt;m_dim;i++) \t{ \t\tm_DistMat[i] = (int*) malloc(sizeof(int)*m_dim); \t\tif (m_DistMat[i]==NULL) return false; \t}"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1513864251, "post_id": 47908325, "comment_id": 82820525, "body": "So... A random commenter is thanked for their interest, yet you seem to ignore my complete answer?"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1513875510, "post_id": 47908325, "comment_id": 82827503, "body": "@amina You should edit your question to include the <code>distMat</code> declaration.  Are you vertex numbers 0 based or 1 based?  Somewhere you have one ore more that are &gt;= <code>m_dim</code>."}], "answers": [{"comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1513866529, "post_id": 47910901, "comment_id": 82822040, "body": "So, with your archaic, error prone use of <code>malloc</code> and <code>free</code>, it&#39;s only ~20 lines of code more: <a href=\"http://coliru.stacked-crooked.com/a/f61d0a01e816de51\" rel=\"nofollow noreferrer\">live on coliru</a> and still works. I&#39;d certainly do the <code>vector</code> approach from my answer, since you&#39;re using C++"}, {"owner": {"reputation": 11, "user_id": 5145191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd62220aa0a3cdbc9c243f67b97e2ddc?s=128&d=identicon&r=PG&f=1", "display_name": "amina", "link": "https://stackoverflow.com/users/5145191/amina"}, "edited": false, "score": 0, "creation_date": 1514039835, "post_id": 47910901, "comment_id": 82875984, "body": "Sorry, really sorry. I did not want to ignore your answer. I tried to use vector to declare distMat but I got the same error. Thanks for your help."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 11, "user_id": 5145191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd62220aa0a3cdbc9c243f67b97e2ddc?s=128&d=identicon&r=PG&f=1", "display_name": "amina", "link": "https://stackoverflow.com/users/5145191/amina"}, "edited": false, "score": 0, "creation_date": 1514039889, "post_id": 47910901, "comment_id": 82875998, "body": "Post. A. Self. Contained. Example. You have no excuse <i>not to</i>, because you can start from the ones I posted."}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 0, "last_activity_date": 1513864340, "last_edit_date": 1513864340, "creation_date": 1513788894, "answer_id": 47910901, "question_id": 47908325, "link": "https://stackoverflow.com/questions/47908325/boost-dijkstra-code-causes-damaged-segment-memory/47910901#47910901", "title": "Boost Dijkstra code causes damaged segment memory?", "body": "<p>I'm with @1201ProgramAlarm: safely allocating memory for <code>distMat</code> shows that there's little real problem with the code:</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/ccf4c559dfd18c63\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/graph/adjacency_list.hpp&gt;\n#include &lt;boost/graph/dag_shortest_paths.hpp&gt;\n\nusing ConGraph = boost::adjacency_list&lt;boost::vecS, boost::vecS, boost::directedS,\n      boost::no_property, boost::property&lt;boost::edge_weight_t, int&gt; &gt;;\n\nusing c_vertex_iterator_t = ConGraph::vertex_iterator;\nusing c_vertex_t = ConGraph::vertex_descriptor;\n\ntemplate &lt;typename Matrix&gt;\nint foo(ConGraph&amp; cg, Matrix&amp; distMat) {\n    std::pair&lt;c_vertex_iterator_t, c_vertex_iterator_t&gt; vi;\n    std::pair&lt;c_vertex_iterator_t, c_vertex_iterator_t&gt; vj;\n\n    boost::property_map&lt;ConGraph,boost::edge_weight_t&gt;::type weightmap = get(boost::edge_weight, cg);\n\n    std::vector&lt;c_vertex_t&gt; p(num_vertices(cg));\n    std::vector&lt;int&gt; d(num_vertices(cg));\n\n    for (vi = vertices(cg); vi.first != vi.second; ++vi.first)\n    {\n        boost::dijkstra_shortest_paths(cg, *vi.first,\n                predecessor_map(boost::make_iterator_property_map(p.begin(), get(boost::vertex_index, cg))).\n                distance_map(boost::make_iterator_property_map(d.begin(), get(boost::vertex_index, cg))).\n                weight_map(weightmap)\n            );\n\n        for (vj = vertices(cg); vj.first != vj.second; ++vj.first) {\n            distMat[*vi.first][*vj.first] = d[*vj.first];\n        }\n    }\n\n    return boost::num_vertices(cg);\n}\n\n#include &lt;boost/graph/graph_utility.hpp&gt;\n#include &lt;boost/graph/random.hpp&gt;\n#include &lt;iomanip&gt;\n#include &lt;random&gt;\n\nint main() {\n    ConGraph g;\n\n    {\n        std::mt19937 rng { std::random_device{}() };\n        std::uniform_int_distribution&lt;int&gt; wdist(1,10);\n\n        generate_random_graph(g, 20, 40, rng);\n\n        auto weightmap = get(boost::edge_weight, g);\n        for (auto ed : boost::make_iterator_range(edges(g)))\n            put(weightmap, ed, wdist(rng));\n    }\n\n    print_graph(g);\n\n    std::vector&lt;std::vector&lt;int&gt; &gt; mat(num_vertices(g), std::vector&lt;int&gt;(num_vertices(g)));\n\n    std::cout &lt;&lt; \"foo(g, mat): \" &lt;&lt; foo(g, mat) &lt;&lt; \"\\n\";\n\n    for (auto&amp; row : mat) {\n        for (auto i : row) {\n            if (i == std::numeric_limits&lt;int&gt;::max())\n                std::cout &lt;&lt; \"## \";\n            else\n                std::cout &lt;&lt; std::setw(2) &lt;&lt; i &lt;&lt; \" \";\n        }\n        std::cout &lt;&lt; \"\\n\";\n    }\n}\n</code></pre>\n\n<p>Prints (e.g., random generated graphs):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>0 --&gt; 2 16 \n1 --&gt; 11 5 \n2 --&gt; 8 10 17 10 \n3 --&gt; 13 16 16 \n4 --&gt; \n5 --&gt; 16 \n6 --&gt; \n7 --&gt; 19 3 9 18 \n8 --&gt; 10 \n9 --&gt; 13 \n10 --&gt; 6 \n11 --&gt; 4 4 16 19 \n12 --&gt; 11 3 1 1 11 \n13 --&gt; 10 5 \n14 --&gt; 10 1 \n15 --&gt; 1 13 \n16 --&gt; 8 \n17 --&gt; 15 2 \n18 --&gt; 4 \n19 --&gt; 0 9 \nfoo(g, mat): 20\n 0 23  9 ## 27 29 20 ## 12 35 17 26 ## 26 ## 19  2 15 ## 31 \n13  0 22 ##  4  6 30 ## 21 12 27  3 ## 20 ## 32 11 28 ##  8 \n27 14  0 ## 18 20 11 ## 10 26  8 17 ## 17 ## 10 25  6 ## 22 \n## ## ##  0 ##  6 15 ## 16 ## 12 ## ##  2 ## ##  6 ## ## ## \n## ## ## ##  0 ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## \n## ## ## ## ##  0 24 ## 15 ## 21 ## ## ## ## ##  5 ## ## ## \n## ## ## ## ## ##  0 ## ## ## ## ## ## ## ## ## ## ## ## ## \n 8 31 17  8  5 14 23  0 20  2 20 34 ## 10 ## 27 10 23  1  3 \n## ## ## ## ## ##  9 ##  0 ##  6 ## ## ## ## ## ## ## ## ## \n## ## ## ## ## 12 21 ## 27  0 18 ## ##  8 ## ## 17 ## ## ## \n## ## ## ## ## ##  3 ## ## ##  0 ## ## ## ## ## ## ## ## ## \n10 33 19 ##  1 21 28 ## 19  9 25  0 ## 17 ## 29  9 25 ##  5 \n18  5 27  3  9  9 18 ## 19 17 15  8  0  5 ## 37  9 33 ## 13 \n## ## ## ## ##  4 13 ## 19 ## 10 ## ##  0 ## ##  9 ## ## ## \n21  8 30 ## 12 14  7 ## 29 20  4 11 ## 28  0 40 19 36 ## 16 \n17  4 26 ##  8 10 20 ## 25 16 17  7 ##  7 ##  0 15 32 ## 12 \n## ## ## ## ## ## 19 ## 10 ## 16 ## ## ## ## ##  0 ## ## ## \n21  8  3 ## 12 14 14 ## 13 20 11 11 ## 11 ##  4 19  0 ## 16 \n## ## ## ##  4 ## ## ## ## ## ## ## ## ## ## ## ## ##  0 ## \n 5 28 14 ## 32 16 25 ## 17  4 22 31 ## 12 ## 24  7 20 ##  0 \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5145191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd62220aa0a3cdbc9c243f67b97e2ddc?s=128&d=identicon&r=PG&f=1", "display_name": "amina", "link": "https://stackoverflow.com/users/5145191/amina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513864340, "creation_date": 1513780410, "question_id": 47908325, "link": "https://stackoverflow.com/questions/47908325/boost-dijkstra-code-causes-damaged-segment-memory", "title": "Boost Dijkstra code causes damaged segment memory?", "body": "<p>I'm trying to find the shortest paths in a graph using the boost dijkstra algorithm.</p>\n\n<pre><code>std::pair&lt;c_vertex_iterator_t, c_vertex_iterator_t&gt; vi;\nstd::pair&lt;c_vertex_iterator_t, c_vertex_iterator_t&gt; vj;\n\nboost::property_map&lt;ConGraph,boost::edge_weight_t&gt;::type weightmap = get(boost::edge_weight, cg);\nstd::vector&lt;c_vertex_t&gt; p(num_vertices(cg));\nstd::vector&lt;int&gt; d(num_vertices(cg));\nfor (vi = vertices(cg); vi.first != vi.second; ++vi.first)\n{\n    boost::dijkstra_shortest_paths(cg, *vi.first,\n           predecessor_map(boost::make_iterator_property_map(p.begin(), get(boost::vertex_index, cg))).\n           distance_map(boost::make_iterator_property_map(d.begin(), get(boost::vertex_index, cg))));\n    for (vj = vertices(cg); vj.first != vj.second; ++vj.first)\n    {\n        distMat[*vi.first][*vj.first]= d[*vj.first];\n    }\n}\n\nreturn boost::num_vertices(cg);\n</code></pre>\n\n<p>But I have a problem in this code; the application stop running at this line:</p>\n\n<pre><code>distance_map(boost::make_iterator_property_map(d.begin(), get(boost::vertex_index, cg))));\n</code></pre>\n\n<p>visual c++ detect a damaged memory segment error caused by this instruction</p>\n\n<pre><code>retval = HeapFree(_crtheap, 0, pBlock);\n</code></pre>\n\n<p>What should I do to fix the problem?</p>\n"}, {"tags": ["c++", "c++11", "asynchronous"], "answers": [{"tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 2, "last_activity_date": 1513783489, "creation_date": 1513783489, "answer_id": 47909374, "question_id": 47908271, "link": "https://stackoverflow.com/questions/47908271/stdpromise-external-code-async-cancellation/47909374#47909374", "title": "std::promise external code, async cancellation", "body": "<p>There is no portable way to end a thread before it wants to. </p>\n\n<p>Depending on your platform, there <em>may</em> be ways of ending a thread, which you will probably need to get <code>std::thread::native_handle</code> to utilise. This is highly likely to lead to undefined behaviour, so I don't recommend it.</p>\n"}, {"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1513962649, "creation_date": 1513962649, "answer_id": 47945058, "question_id": 47908271, "link": "https://stackoverflow.com/questions/47908271/stdpromise-external-code-async-cancellation/47945058#47945058", "title": "std::promise external code, async cancellation", "body": "<p>You can run that external synchronous code in another process and terminate that entire process. This way the interruption won't affect your process and cause undefined behaviour.</p>\n"}, {"tags": [], "owner": {"reputation": 4569, "user_id": 1282773, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/GFxGD.jpg?s=128&g=1", "display_name": "ivaigult", "link": "https://stackoverflow.com/users/1282773/ivaigult"}, "is_accepted": false, "score": 5, "last_activity_date": 1514447408, "last_edit_date": 1514447408, "creation_date": 1514287070, "answer_id": 47977820, "question_id": 47908271, "link": "https://stackoverflow.com/questions/47908271/stdpromise-external-code-async-cancellation/47977820#47977820", "title": "std::promise external code, async cancellation", "body": "<h2>Short answer:</h2>\n\n<p>Don't cancel/terminate thread execution unless it is mission critical. Use approach \"A\" instead.</p>\n\n<h2>Long answer:</h2>\n\n<p>As @Caleth noted, there is no standard nor cross platform way to do this. All you can do is to get a native handle to a thread and use platform specific function. But there are some important pit falls.</p>\n\n<h3>win32</h3>\n\n<p>You may terminate a thread with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686717(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>TerminateThread</code></a> function, but:</p>\n\n<ul>\n<li>stack variables <em>will not</em> be destructed</li>\n<li><code>thread_local</code> variables <em>will not</em> be destructed</li>\n<li>DLLs <em>will not</em> be notified</li>\n</ul>\n\n<p>MSDN says:</p>\n\n<blockquote>\n  <p>TerminateThread is a dangerous function that should only be used in\n  the most extreme cases.</p>\n</blockquote>\n\n<h3>pthread</h3>\n\n<p>Here situation is slightly better. You have a chance to free your resources when <a href=\"http://man7.org/linux/man-pages/man3/pthread_cancel.3.html\" rel=\"nofollow noreferrer\"><code>pthread_cancel</code></a> is got called, but:</p>\n\n<ul>\n<li>By default, target thread terminates on <a href=\"http://man7.org/linux/man-pages/man7/pthreads.7.html\" rel=\"nofollow noreferrer\">cancellation points</a>. It means that you cannot cancel a code that doesn't have any cancellation point. Basically, <code>for(;;);</code> won't be canceled <em>at all</em>.</li>\n<li>Once cancellation point is reached, implementation specific exception is thrown, so resources can be gracefully freed.</li>\n<li>Keep in mind, that this exception can be caught by <code>try</code>/<code>catch</code>, but it's required to be re-thrown.</li>\n<li>This behavior can be disabled by <code>pthread_setcanceltype(PTHREAD_CANCEL_ASYNCHRONOUS, nullptr);</code>. But in case cancellation point is not met, resources won't be freed (as for <em>win32</em>)</li>\n</ul>\n\n<h2>Example</h2>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include &lt;chrono&gt;\n\n#if defined(_WIN32)\n#include &lt;Windows.h&gt;\nvoid kill_thread(HANDLE thread) {\n    TerminateThread(thread, 0);\n}\n#else \n#include &lt;pthread.h&gt;\nvoid kill_thread(pthread_t thread) {\n    pthread_cancel(thread);\n}\n#endif\n\nclass my_class {\npublic:\n    my_class()  { std::cout &lt;&lt; \"my_class::my_class()\"  &lt;&lt; std::endl; }\n    ~my_class() { std::cout &lt;&lt; \"my_class::~my_class()\" &lt;&lt; std::endl; }\n};\n\nvoid cpu_intensive_func() {\n#if !defined(_WIN32)\n    pthread_setcanceltype(PTHREAD_CANCEL_ASYNCHRONOUS, nullptr);\n#endif\n    my_class cls;\n    for(;;) {}\n}\n\nvoid io_func() {\n    my_class cls;\n    int a;\n    std::cin &gt;&gt; a;\n}\n\nvoid io_func_with_try_catch() {\n    my_class cls;\n    try {\n        int a;\n        std::cin &gt;&gt; a;  \n    } catch(...) {\n        std::cout &lt;&lt; \"exception caught!\" &lt;&lt; std::endl;\n        throw;\n    }\n}\n\nvoid test_cancel(void (*thread_fn) (void)) {\n    std::thread t(thread_fn);\n    std::this_thread::sleep_for(std::chrono::seconds(1));\n    kill_thread(t.native_handle());    \n    t.join();\n    std::cout &lt;&lt; \"thread exited\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"--------------------\" &lt;&lt; std::endl;\n}\n\nint main() {\n    test_cancel(cpu_intensive_func);\n    test_cancel(io_func);\n    test_cancel(io_func_with_try_catch);\n    return 0;\n}\n</code></pre>\n\n<p>You may see that:</p>\n\n<ul>\n<li>The destructor is never called on windows.  </li>\n<li>Removing of <code>pthread_setcanceltype</code> leads to hang.  </li>\n<li>The internal <code>pthread</code> exception could be caught.</li>\n</ul>\n"}], "owner": {"reputation": 6147, "user_id": 948652, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/22ed67baa24e475226ef327a818e4ffd?s=128&d=identicon&r=PG", "display_name": "arynaq", "link": "https://stackoverflow.com/users/948652/arynaq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 4, "answer_count": 3, "score": 8, "last_activity_date": 1514447408, "creation_date": 1513780236, "question_id": 47908271, "link": "https://stackoverflow.com/questions/47908271/stdpromise-external-code-async-cancellation", "title": "std::promise external code, async cancellation", "body": "<p>Suppose you have some external synchronous code you cannot modify, and you require it to run async but also require it to be cancellable. If the external code is blocking then I have two options.</p>\n\n<p>A) Fool the user and let my async method return immediately on cancellation, well aware that the code is still running to completion somewhere.</p>\n\n<p>B) Cancel execution</p>\n\n<p>I would like to implement an interface for option B</p>\n\n<pre><code>namespace externallib {\nstd::uint64_t timeconsuming_operation()\n{\n    std::uint64_t count = 0;\n    for (auto i = 0; i &lt; 1E+10; ++i)\n    {\n        count++;\n    }\n    return count;\n}\n}\n\n\n\n\ntemplate &lt;typename R&gt;\nstruct async_operation\n{\n\n    struct CancelledOperationException\n    {\n        std::string what() const\n        {\n            return what_;\n        }\n    private:\n        std::string what_{ \"Operation was cancelled.\" };\n    };\n\n    template&lt;typename Callable&gt;\n    async_operation(Callable&amp;&amp; c)\n    {\n        t_ = std::thread([this, c]()\n        {\n            promise_.set_value(c());  // &lt;-- Does not care about cancel(), mostly because c() hasn't finished..\n        });\n    }\n\n\n    std::future&lt;R&gt; get()\n    {\n        return promise_.get_future();\n    }\n\n\n    void cancel()\n    {\n        promise_.set_exception(std::make_exception_ptr(CancelledOperationException()));\n    }\n\n    ~async_operation()\n    {\n        if (t_.joinable())\n            t_.join();\n    }\n\nprivate:\n    std::thread t_;\n    std::promise&lt;R&gt; promise_;\n};\n\nvoid foo()\n{\n    async_operation&lt;std::uint64_t&gt; op([]()\n    {\n        return externallib::timeconsuming_operation();\n    });\n\n    using namespace std::chrono_literals;\n    std::this_thread::sleep_for(5s);\n\n    op.cancel(); \n    op.get();\n}\n</code></pre>\n\n<p>In the code above I cannot wrap my head around the limitation of external code being blocking, how, if at all, is it possible to cancel execution early?</p>\n"}, {"tags": ["c++", "static"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 5, "creation_date": 1513780127, "post_id": 47908205, "comment_id": 82783674, "body": "I find &quot;static class&quot; to be an anti-pattern. You are using it to implement a namespace. Just use a namespace."}, {"owner": {"reputation": 1103, "user_id": 5108333, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/KrNTC.png?s=128&g=1", "display_name": "A. Vieira", "link": "https://stackoverflow.com/users/5108333/a-vieira"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513780401, "post_id": 47908205, "comment_id": 82783861, "body": "I see, that seems like good advice. But won&#39;t I still have the same linking/including issue?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513780849, "post_id": 47908205, "comment_id": 82784190, "body": "My comment is by no means an answer to your main query. It&#39;s &quot;on the side&quot; advice"}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "edited": false, "score": 1, "creation_date": 1513781000, "post_id": 47908205, "comment_id": 82784284, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/625799/resolve-build-errors-due-to-circular-dependency-amongst-classes\">Resolve build errors due to circular dependency amongst classes</a>"}, {"owner": {"reputation": 2254, "user_id": 4946821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R7FRn.jpg?s=128&g=1", "display_name": "KelvinS", "link": "https://stackoverflow.com/users/4946821/kelvins"}, "edited": false, "score": 0, "creation_date": 1513781842, "post_id": 47908205, "comment_id": 82784924, "body": "I would recommend to use <code>OnlyMaths</code> as a <code>namespace</code> and pass only the data to the <code>average</code> function, not the pointer, for example: <code>OnlyMaths::average(this-&gt;x, this-&gt;y);</code>"}, {"owner": {"reputation": 1103, "user_id": 5108333, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/KrNTC.png?s=128&g=1", "display_name": "A. Vieira", "link": "https://stackoverflow.com/users/5108333/a-vieira"}, "reply_to_user": {"reputation": 2254, "user_id": 4946821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R7FRn.jpg?s=128&g=1", "display_name": "KelvinS", "link": "https://stackoverflow.com/users/4946821/kelvins"}, "edited": false, "score": 0, "creation_date": 1513782331, "post_id": 47908205, "comment_id": 82785249, "body": "@KelvinS I see what you mean. Indeed I&#39;m going to turn <code>OnlyMaths</code> into a namespace only, but passing the arguments won&#39;t always be a solution in my general case."}], "answers": [{"comments": [{"owner": {"reputation": 1103, "user_id": 5108333, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/KrNTC.png?s=128&g=1", "display_name": "A. Vieira", "link": "https://stackoverflow.com/users/5108333/a-vieira"}, "edited": false, "score": 0, "creation_date": 1513785311, "post_id": 47909647, "comment_id": 82787278, "body": "Ah. So your solution is to include 2DData in the .cpp file. I see."}, {"owner": {"reputation": 693, "user_id": 2139902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0050129417b8d5d74968630b13da64c?s=128&d=identicon&r=PG", "display_name": "Sean Burton", "link": "https://stackoverflow.com/users/2139902/sean-burton"}, "edited": false, "score": 0, "creation_date": 1513788451, "post_id": 47909647, "comment_id": 82789087, "body": "Don&#39;t forget the forward declaration in the header as well. This says that there is some class named &#39;2DData&#39; but not how it is implemented. You can then define and call functions that pass around pointers or references to this class without needing to include the full definition until you actually try to access any members/functions of the class."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1513792535, "post_id": 47909647, "comment_id": 82791221, "body": "Might be good to point out that this relies on NOT using inline function definitions in the .h files. Functions are declared in the .h files but defined in .cpp files where all the declarations from both .h files are visible."}], "tags": [], "owner": {"reputation": 682, "user_id": 4840709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d67ac35e92ce156184d57b81fe2d644?s=128&d=identicon&r=PG", "display_name": "M.L.", "link": "https://stackoverflow.com/users/4840709/m-l"}, "is_accepted": true, "score": 2, "last_activity_date": 1513792340, "last_edit_date": 1513792340, "creation_date": 1513784333, "answer_id": 47909647, "question_id": 47908205, "link": "https://stackoverflow.com/questions/47908205/how-to-correctly-link-static-class/47909647#47909647", "title": "How to correctly link static class", "body": "<p>One solution is to include <code>2DData.h</code> in <code>OnlyMaths.cpp</code>:</p>\n\n<p>OnlyMaths.h :</p>\n\n<pre><code>class 2DData; // Declaration only.\nclass OnlyMaths{\npublic:\n  static double average(2DData* a); // Will call 2DData's functions\n  //... more static functions\nprivate:\n  OnlyMaths() {} // Non-instantiable class\n};\n</code></pre>\n\n<p>OnlyMaths.cpp :</p>\n\n<pre><code>#include &lt;OnlyMaths.h&gt;\n#include &lt;2DData.h&gt;\ndouble OnlyMaths::average(2DData* a)\n{\n    a-&gt;method();\n}\n</code></pre>\n\n<p>This way, <code>2DData</code>'s functions are available for any <code>OnlyMaths</code>'s functions and vice-versa, without circular dependencies.</p>\n"}], "owner": {"reputation": 1103, "user_id": 5108333, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/KrNTC.png?s=128&g=1", "display_name": "A. Vieira", "link": "https://stackoverflow.com/users/5108333/a-vieira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 47909647, "answer_count": 1, "score": 0, "last_activity_date": 1513799191, "creation_date": 1513780036, "last_edit_date": 1513799191, "question_id": 47908205, "link": "https://stackoverflow.com/questions/47908205/how-to-correctly-link-static-class", "title": "How to correctly link static class", "body": "<p>Suppose I have a class that only has static members:</p>\n\n<p><em>OnlyMaths.h</em>:</p>\n\n<pre><code>#include \"2DData.h\"\n\nclass OnlyMaths{\npublic:\n  static double average(2DData* a); // Will call 2DData's functions\n  //... more static functions\nprivate:\n  OnlyMaths() {} // Non-instantiable class\n};\n</code></pre>\n\n<p>And that 2DData is a class that uses OnlyMaths:</p>\n\n<p><em>2DData.h</em>:</p>\n\n<pre><code>#include \"OnlyMaths.h\"\n\nclass 2DData{\npublic:\n  2DData(double x, double y);\n  double average() {\n    return OnlyMaths::average(this); // Uses static function\n  }\n};\n</code></pre>\n\n<p>Both classes need to know each other (and their methods) in order to perform their functions, but, as I wrote it, there is a circular inclusion and it wont compile.</p>\n\n<p><strong>How do I make a \"static\" class like <code>OnlyMaths</code> know other classes it needs in it's functions and have it's static functions called anywhere?</strong> Surely there is a correct way of doing this.</p>\n\n<p>Note: Please assume that all *.h files are define protected with <code>#ifndef ...</code> as usual.</p>\n\n<p>EDIT:</p>\n\n<p>Some circular dependencies questions, like <a href=\"https://stackoverflow.com/questions/625799/resolve-build-errors-due-to-circular-dependency-amongst-classes\">this</a>, are given solutions that revolve around forward declaration. In this case this is not a possibility, as not only both classes need to know each other but also they need to know each other's functions.</p>\n\n<p>By the difficulty in finding a simple solution I'm starting to think that the way I'm going about the problem may not be right, so let me clarify my goal:</p>\n\n<p>The goal is to have a file <code>OnlyMaths.h</code> contain all the functions that do mathematics operations on all data types I have in my project. This functions can be called anywhere in the project, sometimes even inside the classes <code>OnlyMath</code>'s operates on.</p>\n"}, {"tags": ["c++", "cpplint"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1513780732, "post_id": 47908201, "comment_id": 82784103, "body": "Did you try reading the documentation at all? <a href=\"https://google.github.io/styleguide/cppguide.html#Static_and_Global_Variables\" rel=\"nofollow noreferrer\">google.github.io/styleguide/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1513780251, "post_id": 47908215, "comment_id": 82783749, "body": "Types with constructors can be global variables. They&#39;ll be dynamically initialized and all those good stuff. <code>std::string</code> can&#39;t be a <code>constexpr</code> variable, but the OP doesn&#39;t indicate this is the case."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1513780614, "post_id": 47908215, "comment_id": 82784007, "body": "<i>&quot;needs to be&quot;</i> in what sense? Presumably just an arbitrary judgment made by <code>cpplint</code>, not the language. Yes, objects at namespace scope are prone to the static initialisation order fiasco and probably inadvisable for other reasons too, but they&#39;re perfectly well-defined when used correctly."}, {"owner": {"reputation": 13842, "user_id": 759253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0136e90dfd678a82c1dbba77dcbfc28e?s=128&d=identicon&r=PG", "display_name": "Igor R.", "link": "https://stackoverflow.com/users/759253/igor-r"}, "edited": false, "score": 1, "creation_date": 1513780686, "post_id": 47908215, "comment_id": 82784055, "body": "What?! Instantiating classes having non-trivial ctors at namespace/global scope is perfectly legal! Maybe Cpplint just says it&#39;s against google coding conventions."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1513780716, "post_id": 47908215, "comment_id": 82784083, "body": "Just link and quote <a href=\"https://google.github.io/styleguide/cppguide.html#Static_and_Global_Variables\" rel=\"nofollow noreferrer\">google.github.io/styleguide/&hellip;</a> and be done with it, as the OP could have read that. :P"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1513780868, "post_id": 47908215, "comment_id": 82784201, "body": "On re-reading this answer was implying the <i>language</i> didn&#39;t allow it. I hope I make that clear now."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 7, "last_activity_date": 1513781151, "last_edit_date": 1592644375, "creation_date": 1513780068, "answer_id": 47908215, "question_id": 47908201, "link": "https://stackoverflow.com/questions/47908201/static-global-variable-not-permitted-in-c/47908215#47908215", "title": "static/global variable not permitted in C++", "body": "<h1>For the avoidance of doubt the language itself permits this.</h1>\n<p>Essentially though the static analyser you are using forbids this because <code>std::string</code> contains a <em>constructor</em> so the statement actually &quot;does something&quot;.</p>\n<p>Therefore it needs to be inside a function, not at global scope.</p>\n<p>On the other hand,</p>\n<pre><code>const char* VAR = &quot;HELLO_WORLD&quot;;\n</code></pre>\n<p>is emitted, since that's no more than an assignment of a read-only <code>const char[]</code> literal to an appropriate pointer.</p>\n"}], "owner": {"reputation": 592, "user_id": 4499832, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ba08e84649d6557c3f5a2eee47f01a4f?s=128&d=identicon&r=PG&f=1", "display_name": "klaus", "link": "https://stackoverflow.com/users/4499832/klaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2777, "favorite_count": 0, "accepted_answer_id": 47908215, "answer_count": 1, "score": 2, "last_activity_date": 1513781151, "creation_date": 1513780023, "last_edit_date": 1513780149, "question_id": 47908201, "link": "https://stackoverflow.com/questions/47908201/static-global-variable-not-permitted-in-c", "title": "static/global variable not permitted in C++", "body": "<p>I have defined a global variable in my C++ class as follows :</p>\n\n<pre><code>std::string VAR = \"HELLO_WORLD\";\n</code></pre>\n\n<p>But cpplint is telling me : </p>\n\n<blockquote>\n  <p>Static/global string variables are not permitted.  [runtime/string]\n  [4]</p>\n</blockquote>\n\n<p>Do you have an idea why ?</p>\n"}, {"tags": ["c++", "arrays", "vector", "erase"], "comments": [{"owner": {"reputation": 426, "user_id": 4846735, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/96ac16373146d51b20ea81fb4e9c11d1?s=128&d=identicon&r=PG&f=1", "display_name": "Morgan", "link": "https://stackoverflow.com/users/4846735/morgan"}, "edited": false, "score": 0, "creation_date": 1513781456, "post_id": 47908195, "comment_id": 82784644, "body": "You can can simplify your Gissning function don&#39;t you ?     for (unsigned i = random-1; i &lt; random; i++)     {         a = v[i][0];         b = v[i][1];         c = v[i][2];         d = v[i][3];          std::cout &lt;&lt; std::endl;         AntalTry++;     }"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 8063616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QG4m6.jpg?s=128&g=1", "display_name": "Allamo Olsson", "link": "https://stackoverflow.com/users/8063616/allamo-olsson"}, "edited": false, "score": 0, "creation_date": 1513781271, "post_id": 47908525, "comment_id": 82784498, "body": "So lets see if i understood it right... If i want to remove a computer guess from my vector i should use the second code... But i have an string with four numbers, i dont understand how i might use that code. That string is for sure in my vector too...  Also i get a problem since Losningar is not declared in a general scope... losningar is only declared in the function where i create the solutions"}, {"owner": {"reputation": 426, "user_id": 4846735, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/96ac16373146d51b20ea81fb4e9c11d1?s=128&d=identicon&r=PG&f=1", "display_name": "Morgan", "link": "https://stackoverflow.com/users/4846735/morgan"}, "edited": false, "score": 0, "creation_date": 1513781615, "post_id": 47908525, "comment_id": 82784757, "body": "What&#39;s important is the second line of the second code. You have to pass your computer guess to erase"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1513781949, "post_id": 47908525, "comment_id": 82784995, "body": "Whatever the name of the vector is, use that, I just guessed <code>Losningar</code>. The value <code>needle</code> is whatever you want to remove"}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": true, "score": 4, "last_activity_date": 1513780993, "creation_date": 1513780993, "answer_id": 47908525, "question_id": 47908195, "link": "https://stackoverflow.com/questions/47908195/problems-with-vectors-how-to-remove-the-arrays-in-my-vectors/47908525#47908525", "title": "Problems with vectors, how to remove the arrays in my vectors?", "body": "<p>You need to find the position of the element to erase. </p>\n\n<pre><code>std::array&lt;unsigned, 4&gt; needle{1, 2, 3, 4};\nauto it = std::find(Losningar.begin(), Losningar.end(), needle);\nif (it != Losningar.end()) { Losningar.erase(it); }\n</code></pre>\n\n<p>If you want to remove all the values that match, or you don't like checking against <code>end</code>, you can use <code>std::remove</code> and the two iterator overload of erase. This is known as the \"erase-remove\" idiom.</p>\n\n<pre><code>std::array&lt;unsigned, 4&gt; needle{1, 2, 3, 4};\nLosningar.erase(std::remove(Losningar.begin(), Losningar.end(), needle), Losningar.end());\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1513788617, "last_edit_date": 1513788617, "creation_date": 1513781613, "answer_id": 47908719, "question_id": 47908195, "link": "https://stackoverflow.com/questions/47908195/problems-with-vectors-how-to-remove-the-arrays-in-my-vectors/47908719#47908719", "title": "Problems with vectors, how to remove the arrays in my vectors?", "body": "<p>This is quite simple if you have ready other functions:</p>\n\n<pre><code>using TestNumber = std::array&lt;unsigned, 4&gt;;\n\nstruct TestResult {\n   int bulls;\n   int cows;\n}\n\n// function which is used to calculate bulls and cows for given secred and guess\nTestResult TestSecretGuess(const TestNumber&amp; secret,\n                           const TestNumber&amp; guess)\n{\n    // do it your self\n    \u2026 \u2026 \u2026\n    return  result;\n}\n\nvoid RemoveNotMatchingSolutions(const TestNumber&amp; guess, TestResult result)\n{\n    auto iter = \n    std::remove_if(possibleSolutions.begin(), \n                   possibleSolutions.end(),\n                   [&amp;guess, result](const TestNumber&amp; possibility)\n                   {\n                       return result == TestSecretGuess(possibility, guess);\n                   });\n     possibleSolutions.erase(iter, possibleSolutions.end());\n}\n</code></pre>\n\n<p>Disclaimer: it is possible to improve performance (you do not care about order of elements).</p>\n"}, {"tags": [], "owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "is_accepted": false, "score": 1, "last_activity_date": 1513781626, "creation_date": 1513781626, "answer_id": 47908724, "question_id": 47908195, "link": "https://stackoverflow.com/questions/47908195/problems-with-vectors-how-to-remove-the-arrays-in-my-vectors/47908724#47908724", "title": "Problems with vectors, how to remove the arrays in my vectors?", "body": "<p>To erase from a vector you just need to use erase and give it an iterator, like so:</p>\n\n<pre><code>std::vector&lt;std::array&lt;unsigned, 4&gt;&gt; vec;\nvec.push_back({1,2,3,4});\nvec.push_back({4,3,2,1});\n\nauto it = vec.begin(); //Get an iterator to first elements\nit++; //Increment iterator, it now points at second element\nit = vec.erase(it); // This erases the {4,3,2,1} array\n</code></pre>\n\n<p>After you erase the element, it is invalid because the element it was pointing to has been deleted. Ti continue to use the iterator you can take the return value from the erase function, a valid iterator to the next element after the one erased, in this the case end iterator.</p>\n\n<p>It is however not very efficient to remove elements in the middle of a vector, due to how it works internally. If it's not important in what order the different solution are stored, a small trick can simplify and make your code faster. Let's say we have this.</p>\n\n<pre><code>std::vector&lt;std::array&lt;unsigned, 4&gt;&gt; vec;\nvec.push_back({1,2,3,4});\nvec.push_back({4,3,2,1});\nvec.push_back({3,2,1,4});\n</code></pre>\n\n<p>To remove the middle one we then do</p>\n\n<pre><code>vec[1] = vec.back(); // Replace the value we want to delete\n// with the value in the last element of the vector.\nvec.pop_back(); //Remove the last element\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 8063616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QG4m6.jpg?s=128&g=1", "display_name": "Allamo Olsson", "link": "https://stackoverflow.com/users/8063616/allamo-olsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 47908525, "answer_count": 3, "score": 2, "last_activity_date": 1513788617, "creation_date": 1513780004, "last_edit_date": 1513781362, "question_id": 47908195, "link": "https://stackoverflow.com/questions/47908195/problems-with-vectors-how-to-remove-the-arrays-in-my-vectors", "title": "Problems with vectors, how to remove the arrays in my vectors?", "body": "<p>I have created a function that creates all the possible solutions for a game that I am creating... Maybe some of you know the bullcow game.</p>\n\n<p>First I created a function that creates a combination of numbers of max four integers and the combination can't have any repeating number in it... like...\n'1234' is a solution but not '1223' because the '2' is repeating in the number. In total there is 5040 numbers between '0123' and '9999' that haven't repeating numbers.</p>\n\n<p>Here is my function:</p>\n\n<pre><code>std::vector &lt;std::array&lt;unsigned, 4&gt;&gt; HittaAllaLosningar(){\n  std::vector &lt;std::array&lt;unsigned, 4&gt;&gt; Losningar;\n  for (unsigned i = 0; i &lt; 10; i++) {\n    for (unsigned j = 0; j &lt; 10; j++) {\n      for (unsigned k = 0; k &lt; 10; k++) {\n        for (unsigned l = 0; l &lt; 10; l++) {\n            if (i != j &amp;&amp; i != k &amp;&amp; i != l &amp;&amp; j != k &amp;&amp; j != l &amp;&amp; k != l) {\n                Losningar.push_back({i,j,k,l});\n            }\n        }\n      }\n    }\n  }\n  return Losningar;\n}\n</code></pre>\n\n<p>Now let's say I have the number '1234' and that is not the solution I am trying to find, I want to remove the solution '1234' from the array since that isn't a solution... how do I do that? have been trying to find for hours and can't find it. I have tried <code>vector.erase</code> but I get errors about <code>unsigned</code> and stuff... also its worth to mention the guesses are in strings.</p>\n\n<p>What I am trying to do is, to take a string that I get from my program and if it isn't a solution I want to remove it from the vector if it exists in the <code>vector</code>. </p>\n\n<p>Here is the code that creates the guess:</p>\n\n<pre><code>std::string Gissning(){\n  int random = RandomGen();\n  int a = 0;\n  int b = 0;\n  int c = 0;\n  int d = 0;\n\n    for (unsigned i = random-1; i &lt; random; i++) {\n      for (unsigned j = 0; j &lt; 4; j++) {\n         if (j == 0) {\n           a = v[i][j];\n         }\n         if (j == 1) {\n           b = v[i][j];\n         }\n         if (j == 2) {\n           c = v[i][j];\n         }\n         if (j == 3) {\n           d = v[i][j];\n         }\n      }\n      std::cout &lt;&lt; std::endl;\n      AntalTry++;\n    }\nstd::ostringstream test;\ntest &lt;&lt; a &lt;&lt; b &lt;&lt; c &lt;&lt; d;\nfunka = test.str();\n\nreturn funka;\n}\n</code></pre>\n\n<p>The <code>randomgen</code> function is just a function so I can get a random number and then I go in the loop so I can take the element of the vector and then I get the integers of the array.</p>\n\n<p>Thank you very much for taking your time to help me, I am very grateful!</p>\n"}, {"tags": ["c++", "gcc", "optimization", "g++"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 4, "creation_date": 1513779248, "post_id": 47907886, "comment_id": 82783094, "body": "Pointer to <code>A</code> can not be used anywhere outside this translation unit as you can&#39;t name it. How would you get the name of <code>A</code> in translation unit bar.cpp so you can use/declare it?  If you move the declaration of <code>A</code> into a header file then you would get <code>anon1::A</code> and <code>anon2::A</code> in respectively each translation unit, ie diffferent <code>A</code>s"}, {"owner": {"reputation": 26593, "user_id": 811335, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ca588e5bfb1ac0a5d8ec8acb422aa564?s=128&d=identicon&r=PG", "display_name": "A. K.", "link": "https://stackoverflow.com/users/811335/a-k"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1513810299, "post_id": 47907886, "comment_id": 82799019, "body": "But i can assign it to void*?"}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 0, "creation_date": 1513818550, "post_id": 47907886, "comment_id": 82801100, "body": "@A.K.: to assign the return value from <code>foo</code> to some <code>void *</code> you must first declare the way to call function <code>foo</code>. How will you declare <code>foo</code> in some other translation unit? Or will do you this assignment in <i>this</i> translation unit? In which case, where is the function in which you do this assignment?"}, {"owner": {"reputation": 26593, "user_id": 811335, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ca588e5bfb1ac0a5d8ec8acb422aa564?s=128&d=identicon&r=PG", "display_name": "A. K.", "link": "https://stackoverflow.com/users/811335/a-k"}, "edited": false, "score": 0, "creation_date": 1513830814, "post_id": 47907886, "comment_id": 82803827, "body": "<code>class A; extern A*foo();</code>"}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 1, "creation_date": 1513936577, "post_id": 47907886, "comment_id": 82847874, "body": "@A.K.: If you put those two declarations into <code>main.cpp</code>, they refer to a <i>different</i> <code>class A</code>. The <code>class A</code> you just named is <i>your</i> <code>class A</code> in the global namespace in <code>main.cpp</code>. The <code>class A</code> in <code>test.cpp</code> is in an anonymous namespace. So, I repeat, how do you intend to name the <code>class A</code> that&#39;s in <code>test.cpp</code>?"}, {"owner": {"reputation": 26593, "user_id": 811335, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ca588e5bfb1ac0a5d8ec8acb422aa564?s=128&d=identicon&r=PG", "display_name": "A. K.", "link": "https://stackoverflow.com/users/811335/a-k"}, "reply_to_user": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 1, "creation_date": 1513945464, "post_id": 47907886, "comment_id": 82852304, "body": "@torek I can give the anonymous namespace a name <code>namespace xyz</code> and refer to <code>class A</code> as <code>namespace xyz { class A; }</code> in another file. But then the methods are not optimized anymore. Thanks for the explanation."}], "owner": {"reputation": 26593, "user_id": 811335, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ca588e5bfb1ac0a5d8ec8acb422aa564?s=128&d=identicon&r=PG", "display_name": "A. K.", "link": "https://stackoverflow.com/users/811335/a-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1514388262, "creation_date": 1513778916, "last_edit_date": 1514388262, "question_id": 47907886, "link": "https://stackoverflow.com/questions/47907886/how-compiler-is-able-to-optimize-the-methods-of-class-in-internal-namespace", "title": "How compiler is able to optimize the methods of class in internal namespace", "body": "<p>I have the following code which gets completely optimized by the compiler (g++-7)</p>\n\n<pre><code>$cat test.cpp\n#include&lt;iostream&gt;\nnamespace {\nclass A {\npublic:\n  void method();\n  static void method1();\n};\n\nvoid A::method() {\n  std::cout &lt;&lt; \"method\";\n}\n\nvoid A::method1() {\n  std::cout &lt;&lt; \"method1\";\n}\n\n}\n\n__attribute__((noinline))\nA* foo() {\n  A *a = new A;\n  a-&gt;method();\n  return a;\n}\n</code></pre>\n\n<p>The assembly code does not have any functions. I'm confused because the function <code>foo</code> returns a pointer to <code>A</code> so compiler should know that <code>A</code> escapes this translation unit, or internal namespace disallows that?</p>\n\n<pre><code>g++-7 -O3 -S -o - test.cpp\nLECIE1:\nLSFDE1:\n    .set L$set$1,LEFDE1-LASFDE1\n    .long L$set$1\nLASFDE1:\n    .long   LASFDE1-EH_frame1\n    .quad   LFB2026-.\n    .set L$set$2,LFE2026-LFB2026\n    .quad L$set$2\n    .byte   0\n    .byte   0x4\n    .set L$set$3,LCFI0-LFB2026\n    .long L$set$3\n    .byte   0xe\n    .byte   0x10\n    .byte   0x4\n    .set L$set$4,LCFI1-LCFI0\n    .long L$set$4\n    .byte   0xe\n    .byte   0x8\n    .align 3\nLEFDE1:\n    .mod_init_func\n    .align 3\n    .quad   __GLOBAL__sub_I_test.cpp\n    .constructor\n    .destructor\n    .align 1\n    .subsections_via_symbols\n</code></pre>\n"}, {"tags": ["c++", "c++14", "auto", "decltype"], "comments": [{"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1513778423, "post_id": 47907661, "comment_id": 82782555, "body": "You can just have <code>auto</code> with no <code>-&gt; decltype</code>"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1513778536, "post_id": 47907661, "comment_id": 82782633, "body": "Or if you insist on <code>decltype</code> semantics, just <code>decltype(auto)</code>."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 2, "creation_date": 1513778626, "post_id": 47907661, "comment_id": 82782696, "body": "@JakeFreeman that would have value semantics"}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 1, "creation_date": 1513778657, "post_id": 47907661, "comment_id": 82782717, "body": "<code>decltype(auto) operator () ...</code> is also valid."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513791868, "post_id": 47907661, "comment_id": 82790852, "body": "BTW, you should know <code>i</code> is not a forwarding reference. So that&#39;s also something to consider."}], "answers": [{"comments": [{"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 1, "creation_date": 1513791542, "post_id": 47907892, "comment_id": 82790694, "body": "What about <code>-&gt; T&amp;&amp;</code>?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 0, "creation_date": 1513792012, "post_id": 47907892, "comment_id": 82790938, "body": "@cpplearner - Would also work for a forwarding reference (which the OP doesn&#39;t have), due to reference collapsing. You should post it as an answer (maybe even mention the OP not having a forwarding ref). I&#39;m too tired"}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 5, "last_activity_date": 1513779437, "last_edit_date": 1513779437, "creation_date": 1513778923, "answer_id": 47907892, "question_id": 47907661, "link": "https://stackoverflow.com/questions/47907661/c-decltypeauto-or-decltypestdforwardtvalue/47907892#47907892", "title": "c++ decltype(auto) or decltype(std::forward&lt;T&gt;(value))?", "body": "<blockquote>\n  <p>Or are they the same?</p>\n</blockquote>\n\n<p>Assuming you write it correctly:</p>\n\n<pre><code>constexpr decltype(auto) operator ()(T &amp;&amp; i)\n{\n    return std::forward&lt;T&gt;(i);\n}\n</code></pre>\n\n<p>They are the same. <a href=\"https://timsong-cpp.github.io/cppwp/n4659/dcl.type.auto.deduct\" rel=\"nofollow noreferrer\">[dcl.type.auto.deduct]</a>:</p>\n\n<blockquote>\n  <p>A type <code>T</code> containing a placeholder type, and a corresponding\n  initializer <code>e</code>, are determined as follows:</p>\n  \n  <ul>\n  <li>for a non-discarded return statement that occurs in a function declared with a return type that contains a placeholder type, <strong><code>T</code> is the\n  declared return type and <code>e</code> is the operand of the return statement</strong>. If\n  the return statement has no operand, then <code>e</code> is <code>void()</code>;</li>\n  </ul>\n  \n  <p>If the placeholder is the <code>decltype(auto)</code> type-specifier, <code>T</code> shall be\n  the placeholder alone. The type deduced for <code>T</code> is determined as\n  described in [dcl.type.simple], as though <code>e</code> had been the operand of\n  the <code>decltype</code></p>\n</blockquote>\n\n<p>The return type of the function is deduced from <code>return e;</code> as though by <code>decltype(e)</code>. So it would be the same as an explicit <code>decltype(std::forward&lt;T&gt;(i))</code>.</p>\n\n<blockquote>\n  <p>What is better</p>\n</blockquote>\n\n<p>In this case, I'll go with \"less is more\". <code>decltype(auto)</code> gives you what you are after with less verbosity.</p>\n"}], "owner": {"reputation": 7392, "user_id": 1555823, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2b69fc6d16ff23e3509b2f3602838acd?s=128&d=identicon&r=PG", "display_name": "vladon", "link": "https://stackoverflow.com/users/1555823/vladon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 1, "accepted_answer_id": 47907892, "answer_count": 1, "score": 5, "last_activity_date": 1513779437, "creation_date": 1513778218, "last_edit_date": 1513778466, "question_id": 47907661, "link": "https://stackoverflow.com/questions/47907661/c-decltypeauto-or-decltypestdforwardtvalue", "title": "c++ decltype(auto) or decltype(std::forward&lt;T&gt;(value))?", "body": "<p>For example, simple identity functor:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass identity\n{\npublic:\n    constexpr auto operator ()(T &amp;&amp; i) -&gt; decltype(std::forward&lt;T&gt;(i))\n    {\n        return std::forward&lt;T&gt;(i);\n    }\n};\n</code></pre>\n\n<p>What is better (C++14 and newer) for return value:</p>\n\n<ul>\n<li><code>-&gt; decltype(std::forward&lt;T&gt;(i))</code> or</li>\n<li><code>-&gt; decltype(auto)</code></li>\n</ul>\n\n<p>Or are they the same?</p>\n"}, {"tags": ["c++", "overloading"], "comments": [{"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1513778254, "post_id": 47907604, "comment_id": 82782436, "body": "Because an <code>int</code> can be implicitly casted to a <code>const int</code>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1513779246, "post_id": 47907604, "comment_id": 82783093, "body": "Please don&#39;t downvote just because a duplicate was found. This question is well written."}, {"owner": {"reputation": 307, "user_id": 6542975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f1170e1302b520b60bda22a0f1efc7?s=128&d=identicon&r=PG&f=1", "display_name": "idlmn89", "link": "https://stackoverflow.com/users/6542975/idlmn89"}, "reply_to_user": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1513779782, "post_id": 47907604, "comment_id": 82783450, "body": "@JakeFreeman: But isn&#39;t an implicit cast of <code>int</code> to <code>const int</code> a qualification conversion?"}], "owner": {"reputation": 307, "user_id": 6542975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f1170e1302b520b60bda22a0f1efc7?s=128&d=identicon&r=PG&f=1", "display_name": "idlmn89", "link": "https://stackoverflow.com/users/6542975/idlmn89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 2, "closed_date": 1513778336, "answer_count": 0, "score": 2, "last_activity_date": 1513778000, "creation_date": 1513778000, "question_id": 47907604, "link": "https://stackoverflow.com/questions/47907604/why-does-the-compiler-complain-for-ambiguity-in-overloaded-function", "closed_reason": "Duplicate", "title": "Why does the compiler complain for ambiguity in overloaded function?", "body": "<p>In the following example everything compiles correctly and the function \"void foo(int&amp;)\" is called. </p>\n\n<pre><code>void foo(const int&amp;) { /* implementation */ };\nvoid foo(int&amp;) { /* implementation */ };\n\nint main(int argc, char** argv)\n{\n    int i = 0;\n\n    foo(i);\n    return (0);\n}\n</code></pre>\n\n<p>It's my understanding that the second function is called because both functions are an exact match but only the first one is a identity conversion and that's why it is a better match than the second function which is a qualification conversion.</p>\n\n<pre><code>void foo(const int&amp;) { /* implementation */ };\nvoid foo(int) { /* implementation */ };\n\nint main(int argc, char** argv)\n{\n    int i = 0;\n\n    foo(i);\n    return (0);\n}\n</code></pre>\n\n<p>But why does the compiler complain for ambiguity in this example? As i take it, the compiler should call \"void foo(int)\" because both functions remain an exact match but the first function is a identity conversion and the second function also remains a qualification conversion.</p>\n"}, {"tags": ["python", "c++", "pipe", "stderr", "traceback"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1513778521, "post_id": 47907555, "comment_id": 82782619, "body": "reading stdout THEN stderr can lead to deadlocks. you have to read them in separate threads / find a non-blocking way to read them."}, {"owner": {"reputation": 43, "user_id": 5542816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cySAq.jpg?s=128&g=1", "display_name": "Kryx", "link": "https://stackoverflow.com/users/5542816/kryx"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1513778701, "post_id": 47907555, "comment_id": 82782740, "body": "Ok, I&#39;ll try that. But actually I have no deadlocks as the two &quot;while condition&quot; are invalidated. It&#39;s just like there is no output at all in this case"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 5542816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cySAq.jpg?s=128&g=1", "display_name": "Kryx", "link": "https://stackoverflow.com/users/5542816/kryx"}, "is_accepted": true, "score": 1, "last_activity_date": 1513784520, "creation_date": 1513784520, "answer_id": 47909711, "question_id": 47907555, "link": "https://stackoverflow.com/questions/47907555/retrieve-stderr-from-a-python-program-in-a-c-one/47909711#47909711", "title": "Retrieve stderr from a python program in a c++ one", "body": "<p>Ok, the problem is effectively solved with a part of the answer from @Jean-Fran\u00e7ois Fabre.</p>\n\n<p>I noticed that pstreams provide a way to read on pipe without blocking, so I reuse that code (found in the doc of the library):</p>\n\n<pre><code>const redi::pstreams::pmode mode = redi::pstreams::pstdout|redi::pstreams::pstderr;\nredi::ipstream child(cmd, mode);\nchar buf[1024];\nstd::streamsize n;\nbool finished[2] = { false, false };\nwhile (!finished[0] || !finished[1])\n{\n    if (!finished[0])\n    {\n        while ((n = child.err().readsome(buf, sizeof(buf))) &gt; 0) {\n            std::string ret(buf, n);\n            resErrors.append(QString::fromStdString(ret));\n        }\n        if (child.eof())\n        {\n            finished[0] = true;\n            if (!finished[1])\n                child.clear();\n        }\n    }\n\n    if (!finished[1])\n    {\n        while ((n = child.out().readsome(buf, sizeof(buf))) &gt; 0) {\n            std::string out(buf, n);\n            res.append(QString::fromStdString(out));\n        }\n        if (child.eof())\n        {\n            finished[1] = true;\n            if (!finished[0])\n                child.clear();\n        }\n    }\n}\nres = res.join(\"\").split(\"\\n\");\nresErrors = resErrors.join(\"\").split(\"\\n\");\nres.removeLast();\nresErrors.removeLast();\n</code></pre>\n\n<p>With this, I have all outputs in my QStringLists!</p>\n"}], "owner": {"reputation": 43, "user_id": 5542816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cySAq.jpg?s=128&g=1", "display_name": "Kryx", "link": "https://stackoverflow.com/users/5542816/kryx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 1, "accepted_answer_id": 47909711, "answer_count": 1, "score": 2, "last_activity_date": 1513784520, "creation_date": 1513777847, "last_edit_date": 1513778529, "question_id": 47907555, "link": "https://stackoverflow.com/questions/47907555/retrieve-stderr-from-a-python-program-in-a-c-one", "title": "Retrieve stderr from a python program in a c++ one", "body": "<p>I'm currently trying to launch a file written in python from my C++ program with the pstream library (<a href=\"http://pstreams.sourceforge.net/\" rel=\"nofollow noreferrer\">http://pstreams.sourceforge.net/</a>). My code look like this:</p>\n\n<pre><code>QStringList res;\nQStringList resErrors;\n\n// run a process and create a streambuf that reads its stdout and stderr\nredi::pstream proc(cmd, redi::pstreams::pstdout | redi::pstreams::pstderr);\n\nstd::string line;\n// read child's stdout\nwhile (std::getline(proc.out(), line))\n    res.append(QString::fromStdString(line));\n// read child's stderr\nwhile (std::getline(proc.err(), line))\n    resErrors.append(QString::fromStdString(line));\n</code></pre>\n\n<p>Usually I correctly receive out and err message from any command entered in the pstream constructor. But if I try to execute a python file that raise a traceback I don't have any output (in stdout or in stderr).</p>\n\n<p>For example, this python file:</p>\n\n<pre><code>#!/usr/bin/env python\n\ntest = 5 / 0\nprint \"test\"\n</code></pre>\n\n<p>will no print \"test\" in stdout and nothing in stderr. But if I execute it in a terminal, I correctly got:</p>\n\n<pre><code>Traceback (most recent call last):\n   File \"test.py\", line 3, in &lt;module&gt;\n       test = 5 / 0\n   ZeroDivisionError: integer division or modulo by zero\n</code></pre>\n\n<p>In both case I used the same command: \"python test.py\"</p>\n\n<p>I guess I need to tell to python to print its traceback to stderr? But why  it isn't done in a subprocess ? Or can it be a bug in the library?</p>\n\n<p>Another possibility that I have in mind is that I read the stdout and stderr too early and python hadn't the time to write in it. But I have tried to add a sleep function before read it, without any effect.</p>\n"}, {"tags": ["c++", "macos", "qt", "opengl"], "comments": [{"owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "reply_to_user": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1513778471, "post_id": 47907526, "comment_id": 82782582, "body": "In fact I&#39;m first trying to make it works with MacOS desktop OpenGL without success"}, {"owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "reply_to_user": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 1, "creation_date": 1513778576, "post_id": 47907526, "comment_id": 82782661, "body": "I just made the edit!"}, {"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1513778688, "post_id": 47907526, "comment_id": 82782735, "body": "Have you tried calling <code>setFormat</code> of your <code>QOpenGLWidget</code> instead of <code>QSurfaceFormat::setDefaultFormat</code> as described <a href=\"http://doc.qt.io/qt-5/qopenglwidget.html#details\" rel=\"nofollow noreferrer\">here (3rd code block)</a>"}, {"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1513778798, "post_id": 47907526, "comment_id": 82782795, "body": "I should also mention, that <code>KHR_debug</code> was added to core in 4.3, so it might not be supported by a 3.2 context. (And it might also not be possible to create a 3.2 debug context)."}, {"owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "reply_to_user": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1513779371, "post_id": 47907526, "comment_id": 82783163, "body": "Using <code>QOpenGLWidget::setFormat()</code> change something: I now have a 4.1 opengl context. Unfortunately the <code>GL_KHR_debug</code> extension is still unsupported..."}], "answers": [{"comments": [{"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "reply_to_user": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "edited": false, "score": 0, "creation_date": 1513779957, "post_id": 47908106, "comment_id": 82783562, "body": "Does your hardware support 4.3?"}, {"owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "edited": false, "score": 0, "creation_date": 1513779976, "post_id": 47908106, "comment_id": 82783578, "body": "How can I know that?"}, {"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "reply_to_user": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "edited": false, "score": 0, "creation_date": 1513780012, "post_id": 47908106, "comment_id": 82783610, "body": "Which graphics card do you have?"}, {"owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "edited": false, "score": 0, "creation_date": 1513780044, "post_id": 47908106, "comment_id": 82783624, "body": "Intel Iris 1536 Mo"}, {"owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "edited": false, "score": 0, "creation_date": 1513780289, "post_id": 47908106, "comment_id": 82783769, "body": "According to this page, my macbook support only OpenGL 4.1: <a href=\"https://support.apple.com/en-us/HT202823\" rel=\"nofollow noreferrer\">support.apple.com/en-us/HT202823</a>"}, {"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "reply_to_user": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "edited": false, "score": 1, "creation_date": 1513780634, "post_id": 47908106, "comment_id": 82784020, "body": "So then you have your answer: If the hardware only supports 4.1 then there is no way to get anything newer."}], "tags": [], "owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "is_accepted": true, "score": 1, "last_activity_date": 1513779705, "creation_date": 1513779705, "answer_id": 47908106, "question_id": 47907526, "link": "https://stackoverflow.com/questions/47907526/using-qopengldebuglogger-on-macos/47908106#47908106", "title": "Using QOpenGLDebugLogger on MacOS", "body": "<p>The correct way to request a specific OpenGL context version from the constructor of a <code>QOpenGLWidget</code> is to call the <code>QOpenGLWidget::setFormat(..)</code> method. Also note, that KHR_DEBUG was introduced in OpenGL 4.3 Core Profile, so it might be impossible to use this functionality before that. The correct setup code for a OpenGL 4.3 Debug context would be</p>\n\n<pre><code>QSurfaceFormat format;\nformat.setMajorVersion(4);\nformat.setMinorVersion(3);\nformat.setOption(QSurfaceFormat::DebugContext);\nformat.setProfile(QSurfaceFormat::CoreProfile);\nsetFormat(format);\n</code></pre>\n"}], "owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 47908106, "answer_count": 1, "score": 1, "last_activity_date": 1513779705, "creation_date": 1513777738, "last_edit_date": 1513778870, "question_id": 47907526, "link": "https://stackoverflow.com/questions/47907526/using-qopengldebuglogger-on-macos", "title": "Using QOpenGLDebugLogger on MacOS", "body": "<p>I would like to be able to use the <em>QOpenGLDebugLogger</em> feature on MacOS.</p>\n\n<p>I understood that I had to create a specific <em>QOpenGLContext</em> so here is my code in my custom <em>QOpenGLWidget</em> class constructor:</p>\n\n<pre><code>QSurfaceFormat format;\nformat.setMajorVersion(3);\nformat.setMinorVersion(2);\nformat.setOption(QSurfaceFormat::DebugContext);\nformat.setProfile(QSurfaceFormat::CoreProfile);\nQSurfaceFormat::setDefaultFormat(format);\n</code></pre>\n\n<p>Unfortunately, it has no effect on the current context created by my <em>QOpenGLWidget</em>. The following code in my <em>initializeGL()</em> overriden method outputs false:</p>\n\n<pre><code>qDebug() &lt;&lt; QOpenGLContext::currentContext()-&gt;hasExtension(QByteArrayLiteral(\"GL_KHR_debug\"));\n</code></pre>\n\n<p>I noticed that the <em>QOpenGLContext</em> version seems always to be <em>2.1</em>:</p>\n\n<pre><code>qDebug() &lt;&lt; QOpenGLContext::currentContext()-&gt;format().majorVersion() &lt;&lt; QOpenGLContext::currentContext()-&gt;format().minorVersion();\n</code></pre>\n\n<p>Any idea why settings the format in the constructor has no effect?</p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513777730, "post_id": 47907450, "comment_id": 82782093, "body": "<code>&amp;&amp; i != s.npos</code> - why? an <code>int</code> can never be any close to max value of <code>size_t</code>"}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1513777755, "post_id": 47907450, "comment_id": 82782115, "body": "<code>nextCharType(s);</code> would case compile error. you don&#39;t have such function."}, {"owner": {"reputation": 31, "user_id": 6486348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1069818166421596/picture?type=large", "display_name": "Henrik Viebrock", "link": "https://stackoverflow.com/users/6486348/henrik-viebrock"}, "edited": false, "score": 0, "creation_date": 1513777862, "post_id": 47907450, "comment_id": 82782188, "body": "nextCharType(s) would not crash because I have some alias functions which will provide the needed parameters and just do not return them. I will update my question"}, {"owner": {"reputation": 31, "user_id": 6486348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1069818166421596/picture?type=large", "display_name": "Henrik Viebrock", "link": "https://stackoverflow.com/users/6486348/henrik-viebrock"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513778037, "post_id": 47907450, "comment_id": 82782299, "body": "@Fureeish Previously I used std::site_t i in the for loop - while i debugged i changed it because of no real reason."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1513778341, "post_id": 47907450, "comment_id": 82782504, "body": "you need to provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. your code now obviously not compile."}, {"owner": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "edited": false, "score": 0, "creation_date": 1513778443, "post_id": 47907450, "comment_id": 82782568, "body": "how is  jsonOpeningBracket defined? and others ?"}, {"owner": {"reputation": 31, "user_id": 6486348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1069818166421596/picture?type=large", "display_name": "Henrik Viebrock", "link": "https://stackoverflow.com/users/6486348/henrik-viebrock"}, "reply_to_user": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1513778500, "post_id": 47907450, "comment_id": 82782608, "body": "@appleapple At the top of the code block I added the function which will make the example compile."}, {"owner": {"reputation": 31, "user_id": 6486348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1069818166421596/picture?type=large", "display_name": "Henrik Viebrock", "link": "https://stackoverflow.com/users/6486348/henrik-viebrock"}, "reply_to_user": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "edited": false, "score": 0, "creation_date": 1513778561, "post_id": 47907450, "comment_id": 82782648, "body": "@Angen They are const char arrayOpeningBracket = &#39;[&#39;; and so on. I will add them too."}, {"owner": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "edited": false, "score": 0, "creation_date": 1513778689, "post_id": 47907450, "comment_id": 82782736, "body": "you say isValidNumber(&quot; &quot;) works fine, have you tried isValidNumber(&#39; &#39;) ? &quot; &quot; and  &#39; &#39; are total different things"}, {"owner": {"reputation": 31, "user_id": 6486348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1069818166421596/picture?type=large", "display_name": "Henrik Viebrock", "link": "https://stackoverflow.com/users/6486348/henrik-viebrock"}, "edited": false, "score": 0, "creation_date": 1513778761, "post_id": 47907450, "comment_id": 82782778, "body": "I just tried with &quot; &quot; not with &#39; &#39;. Thanks for the hint. I will test them now with that."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1513778850, "post_id": 47907450, "comment_id": 82782817, "body": "@HenrikViebrock no, it would not. have you tried to compile it before post? you ask for unit test (logic) error when your code does not compile, I don&#39;t think you would get good answer."}, {"owner": {"reputation": 31, "user_id": 6486348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1069818166421596/picture?type=large", "display_name": "Henrik Viebrock", "link": "https://stackoverflow.com/users/6486348/henrik-viebrock"}, "reply_to_user": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "edited": false, "score": 0, "creation_date": 1513779378, "post_id": 47907450, "comment_id": 82783169, "body": "@Angen Your Hint is helpful. The test for isValidNumber(&#39; &#39;) failed. Now I have to find out why. Can you help me with that too?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1513780932, "post_id": 47907450, "comment_id": 82784243, "body": "There&#39;s an overload of <code>isValidNumber</code> that you&#39;re using but haven&#39;t posted."}, {"owner": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "edited": false, "score": 0, "creation_date": 1513781460, "post_id": 47907450, "comment_id": 82784646, "body": "probably you are passing char and expecting string as parameter, consider that s.at(i) returns only one character &#39;1&#39;, &#39;2&#39;, &#39;.&#39; and never &quot;1.0&quot; or something like that"}, {"owner": {"reputation": 31, "user_id": 6486348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1069818166421596/picture?type=large", "display_name": "Henrik Viebrock", "link": "https://stackoverflow.com/users/6486348/henrik-viebrock"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1513781503, "post_id": 47907450, "comment_id": 82784682, "body": "@molbdnilo Correct. I found an overload isValidNumber(double) in a file which should not be part of the project. I removed it and now I needed an alias function isValidNumber(char) which calls isValidNumber(string(&amp;c)) and now everything works just fine. Thanks!"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1513781747, "post_id": 47907450, "comment_id": 82784853, "body": "@HenrikViebrock <code>string(&amp;c)</code> is more than likely undefined. Just say <code>std::isdigit(c)</code>."}, {"owner": {"reputation": 31, "user_id": 6486348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1069818166421596/picture?type=large", "display_name": "Henrik Viebrock", "link": "https://stackoverflow.com/users/6486348/henrik-viebrock"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1513781829, "post_id": 47907450, "comment_id": 82784910, "body": "good Point @molbdnilo"}], "answers": [{"comments": [{"owner": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "edited": false, "score": 0, "creation_date": 1513778889, "post_id": 47907847, "comment_id": 82782838, "body": "bracket is on the next line, variables are defined elsewhere"}], "tags": [], "owner": {"reputation": 51, "user_id": 6712167, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CRnPmxYlYp4/AAAAAAAAAAI/AAAAAAAAAMU/YxKYC9EtX0U/photo.jpg?sz=128", "display_name": "Ranushka Lakmal Sankalpa", "link": "https://stackoverflow.com/users/6712167/ranushka-lakmal-sankalpa"}, "is_accepted": false, "score": -4, "last_activity_date": 1513778807, "creation_date": 1513778807, "answer_id": 47907847, "question_id": 47907450, "link": "https://stackoverflow.com/questions/47907450/unexpected-behaviour-by-searching-for-next-char/47907847#47907847", "title": "Unexpected behaviour by searching for next char", "body": "<ul>\n<li>'arrayOpeningBracket' was not declared in this scope !</li>\n<li>'quoteChar' was not declared in this scope !</li>\n<li>'jsonOpeningBracket' was not declared in this scope!</li>\n</ul>\n\n<p>there have many of variable not declared! so Firstly declared that</p>\n\n<p>\"else if(((c == '-' || c == '.') &amp;&amp; (i + 1 &lt;= s.length() &amp;&amp; isValidNumber(s.at(i + 1))))\" there have missing ')' one bracket !! </p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6486348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1069818166421596/picture?type=large", "display_name": "Henrik Viebrock", "link": "https://stackoverflow.com/users/6486348/henrik-viebrock"}, "is_accepted": false, "score": 0, "last_activity_date": 1513785266, "creation_date": 1513785266, "answer_id": 47909916, "question_id": 47907450, "link": "https://stackoverflow.com/questions/47907450/unexpected-behaviour-by-searching-for-next-char/47909916#47909916", "title": "Unexpected behaviour by searching for next char", "body": "<p>The solution was that there existed an overloaded function isValidNumber(double) which was called, instead of isValidNumber(string), when a char was given.\nAfter removing it a adding a new function:</p>\n\n<pre><code>bool isValidNumber(char c) {\n    return std::isdigit(c);\n}\n</code></pre>\n\n<p>the problem is solved.</p>\n"}], "owner": {"reputation": 31, "user_id": 6486348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1069818166421596/picture?type=large", "display_name": "Henrik Viebrock", "link": "https://stackoverflow.com/users/6486348/henrik-viebrock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1513785266, "creation_date": 1513777438, "last_edit_date": 1513780394, "question_id": 47907450, "link": "https://stackoverflow.com/questions/47907450/unexpected-behaviour-by-searching-for-next-char", "title": "Unexpected behaviour by searching for next char", "body": "<p>I have a function 'int nextCharType(string s)' which should return an int according to the \"type\" of the char.</p>\n\n<p>I will sort by a few self-defined types:</p>\n\n<ul>\n<li>Array (searching for '[')</li>\n<li>Json (searching for '{')</li>\n<li>Quotes (searching for '\"')</li>\n<li>Numbers (see isValidNumber) </li>\n</ul>\n\n<p>My functions are the following:</p>\n\n<pre><code>int nextCharType(const std::string&amp; s)\n{\n    char f;\n    bool e;\n    return nextCharType(s, f, e);\n}\n\nint nextCharType(const std::string&amp; s, char&amp; foundChar, bool&amp; error) \n{\n    const char errorChar = 0x01;\n    const char jsonOpeningBracket = '{';\n    const char arrayOpeningBracket = '[';\n    const char quoteChar = '\"';\n\n    foundChar = errorChar;\n    error = false;\n\n    if(s.length() == 0)\n    {\n        error = true;\n        return 0;\n    }\n\n    bool foundNumeric = false;\n\n    for(int i = 0; i &lt; s.length() &amp;&amp; i != s.npos; i++)\n    {\n        char c = s.at(i);\n        if(c == '\\\\')\n        {\n            i++;\n            continue;\n        }\n\n        if(c == arrayOpeningBracket || c == quoteChar || c == jsonOpeningBracket)\n        {\n            foundChar = c;\n            break;\n        }\n        else if(((c == '-' || c == '.') &amp;&amp; (i + 1 &lt;= s.length() &amp;&amp; isValidNumber(s.at(i + 1))))\n            || /*number*/ isValidNumber(c)) // check for sign and decimal char\n        {\n\n            foundChar = c;\n            foundNumeric = true;\n            break;\n        }\n    }\n\n    if(foundChar == errorChar)\n    {\n        error = true;\n        return 0;\n    }\n\n    if(foundNumeric)\n        return 4;\n\n    switch(foundChar)\n    {\n        case jsonOpeningBracket:\n            return 1;\n            break;\n        case arrayOpeningBracket:\n            return 2;\n            break;\n        case quoteChar:\n            return 3;\n            break;\n        default:\n            error = true;\n            return 0;\n            break;\n    }\n}\n\nbool isValidNumber(const string&amp; num)\n{\n    if(num.empty())\n        return false;\n    if(countChar(num, '.') &gt; 1) // countChar will simply count the given char in the string and return an int\n        return false;\n    if(countChar(num, '-') &gt; 1)\n        return false;\n\n    std::size_t pos = 0;\n    if(num.at(0) == '-')\n    {\n        pos = 1;\n    }\n\n    string internalNum = num;\n    if(internalNum.find_first_not_of(\"0123456789.\", pos) == internalNum.npos)\n        return true;\n    else\n        return false;\n}\n</code></pre>\n\n<p>Now my Problem:</p>\n\n<p>I have some unittests and one of them is failing and I do not know why.\nI call </p>\n\n<pre><code>string s = \"  dasdas  {\";\n// should return 1 for the curly bracket.\nint ret = nextCharType(s);\n// ret is 4 - numeric value.\n// foundChar is ' ' - a space.\n</code></pre>\n\n<p>What confuse me is that I test isValidNumber with some unit tests and if i test it, it works like expected.</p>\n\n<pre><code>bool valid = isValidNumber(\" \"); // space - not valid\n</code></pre>\n\n<p>Can anybody help?</p>\n"}, {"tags": ["c++", "multithreading", "concurrency", "tbb", "compare-and-swap"], "comments": [{"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 1, "creation_date": 1513777479, "post_id": 47907201, "comment_id": 82781927, "body": "Whats the actual issue you are seeing? (and also note that != for doubles is flaky when they&#39;ve got NaN values but thats probably not your issue)"}, {"owner": {"reputation": 485, "user_id": 1129574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772ed34b8c5ef8432bd7f766f82176ee?s=128&d=identicon&r=PG", "display_name": "paduraru2009", "link": "https://stackoverflow.com/users/1129574/paduraru2009"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1513789664, "post_id": 47907201, "comment_id": 82789712, "body": "I get random huge values sometimes. For me it looks like some bytes are modified concurently despite the atomicity."}, {"owner": {"reputation": 3388, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 0, "creation_date": 1513832160, "post_id": 47907201, "comment_id": 82804188, "body": "Perhaps there is a race on allocating or freeing the memory for the array?"}, {"owner": {"reputation": 11603, "user_id": 654891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/156c04def2a7958f8254305ecffc9822?s=128&d=identicon&r=PG", "display_name": "Alexey Kukanov", "link": "https://stackoverflow.com/users/654891/alexey-kukanov"}, "edited": false, "score": 0, "creation_date": 1514294208, "post_id": 47907201, "comment_id": 82926886, "body": "The problem is somewhere else, not in the given pieces of code. Please share a test that allows to reproduce the issue - see <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "owner": {"reputation": 485, "user_id": 1129574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772ed34b8c5ef8432bd7f766f82176ee?s=128&d=identicon&r=PG", "display_name": "paduraru2009", "link": "https://stackoverflow.com/users/1129574/paduraru2009"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513799385, "creation_date": 1513776694, "question_id": 47907201, "link": "https://stackoverflow.com/questions/47907201/atomic-variables-concurrent-compare-and-swap-vs-load", "title": "Atomic variables - concurrent compare and swap vs load", "body": "<p>I'm trying to implement a generic atomic array where threads can access concurrently indices to load / add values into. Currently, the data type of array items is double. </p>\n\n<p>I'm using Intel TBB library (although it has the same behavior with the STL library). The operations that are causing problems are the load and add in parallel. See below how they are implemented:</p>\n\n<pre><code>T operator[] (const unsigned int idx) const\n{        \n    return arr[idx].load();\n}    \n\nvoid add(const int idx, const valuetype_t delta) \n{\n    T current = 0;\n    do \n    {\n        current = arr[idx];\n    } while (arr[idx].compare_and_swap(current + delta, current) != current);\n}      \n</code></pre>\n\n<p>I tried to add a mutex between concurrent add and load operations in the client code and it works perfectly. But without using mutex the results are wrong and it seems like load and compare and swap don't work properly in parallel ?!</p>\n"}, {"tags": ["c++", "visual-studio"], "owner": {"reputation": 11, "user_id": 9122241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fc3bd53ddb7c1eea2fd8adc49ed6568?s=128&d=identicon&r=PG&f=1", "display_name": "R.Lukin", "link": "https://stackoverflow.com/users/9122241/r-lukin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513775204, "creation_date": 1513775204, "last_edit_date": 1592644375, "question_id": 47906784, "link": "https://stackoverflow.com/questions/47906784/visual-studio-still-creating-bsc-files", "title": "Visual Studio still creating .bsc files", "body": "<p>I need to disable creating .bsc files in my work project. But I really don't understand how to do it!! Before I begin Visual Studio was creating 200mb of .bsc files for my project. After disabling in</p>\n<ul>\n<li><p>Project properties</p>\n</li>\n<li><p>C/C++</p>\n</li>\n<li><p>Browse Information (Enable Browse Information: <strong>No</strong>)</p>\n<p>count of files and all size was decreased to 100mb.</p>\n</li>\n</ul>\n<p>Then I set Preserve SBR Files to <strong>No</strong>. And open all vcxproj files in notepad and replace all tags <code>&lt;BrowseInformation&gt;true&lt;/BrowseInformation&gt;</code> to <strong>false</strong>. After building there still some .bsc files with total size 50mb.\nHow I can defeat this files?!)</p>\n"}, {"tags": ["c++", "parameter-passing", "std-pair"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 3, "creation_date": 1513775282, "post_id": 47906702, "comment_id": 82780487, "body": "Something something list initialization, but I&#39;m a bit ashamed to even say it."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 5, "creation_date": 1513775444, "post_id": 47906702, "comment_id": 82780590, "body": "Any solution would be obscure fragile and difficult to understand intent: in a bit of glue code, just be explicit about order."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1513775743, "post_id": 47906702, "comment_id": 82780778, "body": "The obvious solution may also lead to problems later if someone, not privy to the difference and why that solution was used, decided to revert it and introduced UB back into the code. So then you can comment it. But that&#39;s an extra line, by which point, you might as well just trade it for the 2 extra lines needed to explicitly get the variables in the right order! (Perhaps there&#39;s some case where avoiding those favours optimisation, but the compiler can probably elide that, and anyway, worrying about it without profiling/figures is of course premature.)"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1513775790, "post_id": 47906702, "comment_id": 82780821, "body": "I could even imagine that the compiler would transform code that uses intermediate values into something that looks more or less like what you have there. Evaluation order is undefined, but that doesnt mean that the compiler cannot know in what order they are evaluated. Ergo dont worry about that little inefficiency at the cost of unreadable code"}, {"owner": {"reputation": 1202, "user_id": 673679, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ac5b75f2ba59f84ac69e71018275702b?s=128&d=identicon&r=PG", "display_name": "user673679", "link": "https://stackoverflow.com/users/673679/user673679"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1513777320, "post_id": 47906702, "comment_id": 82781828, "body": "@chris. What does that mean? Brace initialization doesn&#39;t change the order of evaluation, though I&#39;ve found another post that suggests this is a compiler bug: <a href=\"https://stackoverflow.com/questions/14060264/order-of-evaluation-of-elements-in-list-initialization\" title=\"order of evaluation of elements in list initialization\">stackoverflow.com/questions/14060264/&hellip;</a>"}, {"owner": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "edited": false, "score": 2, "creation_date": 1513778305, "post_id": 47906702, "comment_id": 82782471, "body": "@user673679 list-init does fix the evaluation order since c++11; everybody fear exploiting this fact (for the reason pointed out by Yakk) but, also in light of c++17 new ordering guarantees, sooner or later these will become idiomatic ... I wonder if it&#39;s still legit to consider such use &quot;obscure and fragile&quot;... dunnow"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1513779695, "post_id": 47906702, "comment_id": 82783388, "body": "@user673679, This is more current than C++11 or anything, but hopefully good enough: <a href=\"http://eel.is/c++draft/dcl.init.list#4\" rel=\"nofollow noreferrer\">eel.is/c++draft/dcl.init.list#4</a>. I certainly don&#39;t recommend it because it&#39;s unclear that the braces are there for this purpose specifically. I&#39;d consider an <code>eval_in_order{a, b, c}</code>, but there&#39;s no way to write such a thing where you could seamlessly use it in place of multiple arguments."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "edited": false, "score": 1, "creation_date": 1513779983, "post_id": 47906702, "comment_id": 82783585, "body": "@MassimilianoJanes, True, C++17 changed some things. I&#39;m hesitant to say that those kind of changes will ever be applied uniformly. We&#39;re in a bit of an awkward state now where some constructs have more guarantees than before, but some are left untouched. For example, given an <code>int a = 1;</code>, <code>std::cout &lt;&lt; a++ &lt;&lt; a++;</code> is well-defined and prints 12. <code>a++ &lt;&lt; a++</code> is also well-defined and evaluates to 4. <code>a++ * a++</code> is still undefined. For functions, <code>f(a++, a++)</code> is now well-defined, but the order of evaluation is still unspecified."}, {"owner": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1513781018, "post_id": 47906702, "comment_id": 82784299, "body": "@chris agreed; personally, I don&#39;t know what to think about this; the new rules are there in order to permit useful idioms (like continuations and other chainable things) so we (as users of the language) cannot just &#39;ignore&#39; them; sooner or later people should start to take them seriously and act consequently ... or not ?"}], "answers": [{"tags": [], "owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "is_accepted": true, "score": 2, "last_activity_date": 1513776133, "creation_date": 1513776133, "answer_id": 47907033, "question_id": 47906702, "link": "https://stackoverflow.com/questions/47906702/evaluating-arguments-in-order-when-constructing-stdpair/47907033#47907033", "title": "Evaluating arguments in order when constructing std::pair", "body": "<p>Order the operations explicitly.</p>\n\n<pre><code>std::pair&lt;T1, T2&gt; Read(DataStreamRead&amp; stream)\n{\n  T1 t1 = IO::Read&lt;T1&gt;(stream);\n  T2 t2 = IO::Read&lt;T2&gt;(stream);\n  return std::pair&lt;T1, T2&gt;(t1, t2);\n}\n</code></pre>\n"}], "owner": {"reputation": 1202, "user_id": 673679, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ac5b75f2ba59f84ac69e71018275702b?s=128&d=identicon&r=PG", "display_name": "user673679", "link": "https://stackoverflow.com/users/673679/user673679"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 47907033, "answer_count": 1, "score": -3, "last_activity_date": 1513776275, "creation_date": 1513774959, "last_edit_date": 1513776275, "question_id": 47906702, "link": "https://stackoverflow.com/questions/47906702/evaluating-arguments-in-order-when-constructing-stdpair", "title": "Evaluating arguments in order when constructing std::pair", "body": "<p>I'm trying to construct a pair, from two values read from a stream. These values need to be read in the correct order (T1, then T2), but I believe the order of argument evaluation is undefined in something like the following:</p>\n\n<pre><code>std::pair&lt;T1, T2&gt; Read(DataStreamRead&amp; stream)\n{\n    return std::pair&lt;T1, T2&gt;(IO::Read&lt;T1&gt;(stream), IO::Read&lt;T2&gt;(stream));\n}\n</code></pre>\n\n<p>(Using intermediate variables works fine, but is there another way?)</p>\n"}, {"tags": ["c++", "pointers", "memory-leaks"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2486888"}, "edited": false, "score": 4, "creation_date": 1513775127, "post_id": 47906700, "comment_id": 82780388, "body": "Distinguish the address of the pointer itself and the address of what the pointer points to. Besides, you&#39;ve learned the wrong thing."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1513776065, "post_id": 47906700, "comment_id": 82780995, "body": "Use std::string, not char arrays and str* functions."}], "answers": [{"tags": [], "owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "is_accepted": false, "score": 4, "last_activity_date": 1513775147, "creation_date": 1513775147, "answer_id": 47906771, "question_id": 47906700, "link": "https://stackoverflow.com/questions/47906700/memory-leak-pointer-to-literal/47906771#47906771", "title": "memory leak, pointer to literal", "body": "<p>Your <code>cout</code> instructions are printing the address of the variable called <code>testpointer</code>.  That's some location in the stack frame of the current function.  It has nothing to do with the value of <code>testpointer</code>, nor with the value pointed by <code>testpointer</code>.</p>\n\n<p>Also, either whoever told you that you should not let a pointer point to a literal was mad, or you did not understand what they said to you.  There is absolutely no problem with letting a pointer point to a literal.</p>\n"}, {"tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 4, "last_activity_date": 1513775995, "last_edit_date": 1513775995, "creation_date": 1513775172, "answer_id": 47906775, "question_id": 47906700, "link": "https://stackoverflow.com/questions/47906700/memory-leak-pointer-to-literal/47906775#47906775", "title": "memory leak, pointer to literal", "body": "<p><code>&amp;testpointer</code> is a pointer to the variable <code>testpointer</code>. It's where the variable itself is stored.</p>\n\n<p>If you want to print where <code>testpointer</code> is pointing, you print its <em>value</em> (as a <code>void*</code> since otherwise <code>operator&lt;&lt;</code> will print it as a string):</p>\n\n<pre><code>std::cout &lt;&lt; \"testpointer = \" &lt;&lt; static_cast&lt;void*&gt;(testpointer) &lt;&lt; '\\n';\n</code></pre>\n\n<hr>\n\n<p>Also note that on modern computers there's really no ROM. The executable image is loaded from the disk into the virtual memory (\"RAM\") and that includes data such as constant string literals (which are really arrays of constant characters).</p>\n\n<p>Also, you can have pointers to constant string literals, but they should really be pointers to <code>const char</code> since constant string literals are constant. The problem is with the <em>reassignment</em> of the variable. You would get the same problem with e.g.</p>\n\n<pre><code>unsigned maxlen = 20;\nchar* testpointer = new char[sizeof(char) * maxlen];\n// ... stuff happens...\ntestpointer = new char[some_other_size];\n</code></pre>\n\n<p>If there's no <code>delete[]</code> before the second <code>new[]</code>, then you have a memory leak.</p>\n\n<p>Finally a warning about your use of <a href=\"http://en.cppreference.com/w/cpp/string/byte/strncpy\" rel=\"nofollow noreferrer\"><code>std::strncpy</code></a>: It will <em>not</em> add the terminating <code>'\\0'</code> at the end. That's because your supplied size (the third argument) is smaller or equal to the length of the source string, in which case the function will not add the terminator. So don't attempt to print the contents of the \"string\" or use it as a \"string\".</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1513775959, "last_edit_date": 1513775959, "creation_date": 1513775205, "answer_id": 47906785, "question_id": 47906700, "link": "https://stackoverflow.com/questions/47906700/memory-leak-pointer-to-literal/47906785#47906785", "title": "memory leak, pointer to literal", "body": "<blockquote>\n  <p>I've learned not to let pointer point to literals because it causes memory leaks.</p>\n</blockquote>\n\n<p>Pointing to string literals does not cause memory leaks. It's fine to point to a string literal.</p>\n\n<p>Incidentally, your program does leak memory.</p>\n\n<hr>\n\n<blockquote>\n  <p>But when I assign a pointer to a literal</p>\n</blockquote>\n\n<p>Your program does not assign the pointer after initialization.</p>\n\n<blockquote>\n  <p>it still points to the same address than before:</p>\n</blockquote>\n\n<p>You don't stream the address that the pointer points at. You use addressof operator on the pointer variable, so you stream the address where the pointer is stored. This wouldn't change even if you did assign the pointer.</p>\n\n<hr>\n\n<blockquote>\n  <p>Shouldn't the address change when I let the pointer point to a literal?</p>\n</blockquote>\n\n<p>The address of the pointer variable wouldn't change. But the address it points to (i.e. the value of the pointer) would change. But you neither point to a string literal, nor do you observe the address that is pointed at.</p>\n"}, {"tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": false, "score": 1, "last_activity_date": 1513775612, "creation_date": 1513775612, "answer_id": 47906890, "question_id": 47906700, "link": "https://stackoverflow.com/questions/47906700/memory-leak-pointer-to-literal/47906890#47906890", "title": "memory leak, pointer to literal", "body": "<p>There's two misconceptions in your question.</p>\n\n<p><strong>One</strong>, you're printing the <em>address</em> of <code>testpointer</code> instead of its <em>value</em>, so it's obviously not changing. If you replace <code>&amp;testpointer</code> with <code>static_cast&lt;void*&gt;(testpointer)</code>, you will see the difference. Note that the cast is necessary, because <code>&lt;&lt;</code> is overloaded for <code>char*</code> to print the characters instead of the pointer itself.</p>\n\n<p><strong>Two</strong>,</p>\n\n<blockquote>\n  <p>not to let pointer point to literals because it causes memory leaks</p>\n</blockquote>\n\n<p>is simply not true. A leak happens if and only if you have some dynamically allocated memory and lose any reference to that memory; in other words, if you no longer have a pointer to that memory. In such case, you no longer have a way to deallocate that memory, and hence you <em>leak</em> it.</p>\n\n<p>This happens in your program by doing this sequence of operations:</p>\n\n<pre><code>char* testpointer = new char[sizeof(char) * maxlen];\ntestpointer = \"Merry Christmas\";\n</code></pre>\n\n<p>Either one of them is fine on its own<sup>(1)</sup>, but together, they cause a leak:</p>\n\n<ol>\n<li>First, you allocate memory</li>\n<li>Then, you forget its address (by pointing the pointer elsewhere).</li>\n</ol>\n\n<p>Note that a literal being involved is irrelevant. This would be exactly the same leak:</p>\n\n<pre><code>char* testpointer = new char[sizeof(char) * maxlen];\ntestpointer = nullptr;\n</code></pre>\n\n<p>As would this:</p>\n\n<pre><code>char* testpointer = new char[sizeof(char) * maxlen];\ntestpointer = new char[sizeof(char) * maxlen];\n</code></pre>\n\n<hr>\n\n<p><sup>(1)</sup> Except you're pointing a <code>char *</code> at a string literal, which is not allowed since C++11, because string literals are <code>const</code>. You'd need a <code>const char *</code> for that.</p>\n"}], "owner": {"reputation": 33, "user_id": 9107916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ba4a75a43c98fc2abdb8215163acfd1?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp_D", "link": "https://stackoverflow.com/users/9107916/philipp-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1513775995, "creation_date": 1513774941, "question_id": 47906700, "link": "https://stackoverflow.com/questions/47906700/memory-leak-pointer-to-literal", "title": "memory leak, pointer to literal", "body": "<p>I've learned not to let pointer point to literals because it causes memory leaks. But when I assign a pointer to a literal, it still points to the same address than before:</p>\n\n<pre><code>    unsigned maxlen = 20;\n    char* testpointer = new char[sizeof(char) * maxlen]; //Pointer points to RAM\n    cout &lt;&lt; \"&amp;testpointer = \" &lt;&lt; &amp;testpointer &lt;&lt; endl;\n\n    strncpy(testpointer, \"Happy Eastern\", 13);\n    cout &lt;&lt; \"&amp;testpointer = \" &lt;&lt; &amp;testpointer &lt;&lt; endl;\n\n    testpointer = \"Merry Christmas\"; // I know I shouldn't do this\n    cout &lt;&lt; \"&amp;testpointer = \" &lt;&lt; &amp;testpointer &lt;&lt; endl;\n</code></pre>\n\n<p>I still get the same memory address each time:</p>\n\n<pre><code>&amp;testpointer = 0x28fc60\n&amp;testpointer = 0x28fc60\n&amp;testpointer = 0x28fc60\n</code></pre>\n\n<p>Shouldn't the address change when I let the pointer point to a literal?\nI thought the memory which I allocated with new should be in RAM while the literal should be in ROM, which should have a different address. Am I wrong?</p>\n\n<p>Thank you, Philipp</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1513774895, "post_id": 47906654, "comment_id": 82780237, "body": "given your function&#39;s <code>ankit()</code> declaration, it returns an <code>int</code>, not a pointer to <code>int</code> or <code>int[]</code> (which btw is not possible). You try to <code>return x</code>, where <code>x</code> is a <code>int[]</code>. Why would you want to return that? Also - you did not declare any <code>x()</code> function, so why would you expect calling it to compile?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1513774907, "post_id": 47906654, "comment_id": 82780248, "body": "<code>int x[5]</code> is not the same as <code>int</code>. how do you expect this to work? (btw anyhow it doesnt work, you cannot return a c array, use a <code>std::vector</code> or <code>std::array</code> instead)"}, {"owner": {"reputation": 1628, "user_id": 1230621, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a752347505880eb6aca2316744e7f474?s=128&d=identicon&r=PG", "display_name": "StarShine", "link": "https://stackoverflow.com/users/1230621/starshine"}, "edited": false, "score": 2, "creation_date": 1513774931, "post_id": 47906654, "comment_id": 82780268, "body": "you declared x as an argument to the function power. you declared power as a variable in the main function, and you are calling a non existant x function in that main function. Read up about functions and scope first,"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2486888"}, "edited": false, "score": 1, "creation_date": 1513774972, "post_id": 47906654, "comment_id": 82780298, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3473438/return-array-in-a-function\">Return array in a function</a>"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1513774988, "post_id": 47906654, "comment_id": 82780312, "body": "Why do you think <code>main()</code> can use <code>x</code>? And why do you try to call it as a function? Is it a function or an array? Pick one. Overall, this is very bad code, that demonstrates a haphazard approach of writing code instead of thinking about it. Don&#39;t try to learn a language by trial and error, throwing random code at the wall then asking the internet when, of course, you get compiler errors. Start with a good book or tutorial, then you won&#39;t make such errors in the first place."}, {"owner": {"reputation": 1, "user_id": 8026294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0AQdUehUjL8/AAAAAAAAAAI/AAAAAAAAAL8/NEca6abFOVc/photo.jpg?sz=128", "display_name": "learner", "link": "https://stackoverflow.com/users/8026294/learner"}, "edited": false, "score": 0, "creation_date": 1513775205, "post_id": 47906654, "comment_id": 82780436, "body": "here&#39;s  the  actual code:-void passArray(int prime[5]) // prime is the actual array {     prime[0] = 11; // so changing it here will change the original argument!     prime[1] = 7;     prime[2] = 5;     prime[3] = 3;     prime[4] = 2; } i  was just trying to use int instead of void function."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1513775371, "post_id": 47906654, "comment_id": 82780538, "body": "Don&#39;t post essential info in comments. <a href=\"https://stackoverflow.com/posts/47906654/edit\">Edit</a> your post to include it."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1513775446, "post_id": 47906654, "comment_id": 82780592, "body": "Fixed-size arrays in C++ are normally defined with <code>std::array</code>. Legacy C style  arrays should not be used unless there is a specific need to avoid <code>std::array</code>."}, {"owner": {"reputation": 1, "user_id": 8026294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0AQdUehUjL8/AAAAAAAAAAI/AAAAAAAAAL8/NEca6abFOVc/photo.jpg?sz=128", "display_name": "learner", "link": "https://stackoverflow.com/users/8026294/learner"}, "edited": false, "score": 0, "creation_date": 1513775600, "post_id": 47906654, "comment_id": 82780681, "body": "Ok, Thanks you all for answering"}], "answers": [{"tags": [], "owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "is_accepted": false, "score": 2, "last_activity_date": 1513776090, "creation_date": 1513776090, "answer_id": 47907018, "question_id": 47906654, "link": "https://stackoverflow.com/questions/47906654/i-am-getting-errors-while-trying-to-return-an-array-in-c/47907018#47907018", "title": "I am getting errors while trying to return an array in C++", "body": "<p>First of all, the errors are pretty self explanatory.</p>\n\n<blockquote>\n  <p>invalid conversion from int* to int</p>\n</blockquote>\n\n<p>Your function is declared in such a way it is expected to return an <code>int</code>. Not an array of <code>int</code>s, just an <code>int</code>. Furthermore, you <strong>cannot</strong> return an array from a function. You <em>can</em>, however, return a pointer to the first element, which in your case is unnecessary.</p>\n\n<p><strong>Guessing</strong> that you want your function to simply set values in an array, you can achieve that by declaring the function as <code>void</code> returning:</p>\n\n<pre><code>void power(int x[5])\n{\n    x[0]=12;\n    x[1]=23;\n    x[2]=234;\n    x[3]=344;\n    x[4]=232;\n}\n</code></pre>\n\n<blockquote>\n  <p>x was not declared in this scope</p>\n</blockquote>\n\n<p>Well, given your main:</p>\n\n<pre><code>int main()\n{\n    int action[5]={1,2,3,,4,5};\n    std::cout&lt;&lt;x[0]&lt;&lt;std::endl;\n    //         ^\n    ...\n}\n</code></pre>\n\n<p>Here you attempt to use a variable <code>x</code>, which was never declared inside <code>main</code> or as global variable, thus the compiler has no idea what you are referring to. Simply aliasing an argument as <code>x</code> in some unrelated function won't make it visible to all the code. Your <strong>can't</strong> use it like this.</p>\n\n<blockquote>\n  <p>expected primary expression before',' token</p>\n</blockquote>\n\n<p>Take a close look at your <code>main</code> function and at <code>action</code> declaration. The part:</p>\n\n<pre><code>int action[5]={1,2,3,,4,5};\n//                  ^^\n</code></pre>\n\n<p>is illegal. Notice the <code>,,</code>. You either should put an integer inbetween them, or delete one of them.</p>\n\n<p>What you probably wanted to achieve, was to first declare the array, print out the first element, apply the <code>power()</code> function and print the first element again, hoping it to change. Given the declaration of <code>power()</code> that I have written, you could achieve it by doing it like so:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nvoid power(int x[5])\n{\n    x[0]=12;\n    x[1]=23;\n    x[2]=234;\n    x[3]=344;\n    x[4]=232;\n}\n\nint main()\n{\n    int x[5] = {1,2,3,4,5};\n\n    std::cout &lt;&lt; x[0] &lt;&lt; ' ';\n    power(x);\n    std::cout &lt;&lt; x[0] &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>That outputs: <strong><code>1 12</code></strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1513781523, "last_edit_date": 1513781523, "creation_date": 1513780536, "answer_id": 47908366, "question_id": 47906654, "link": "https://stackoverflow.com/questions/47906654/i-am-getting-errors-while-trying-to-return-an-array-in-c/47908366#47908366", "title": "I am getting errors while trying to return an array in C++", "body": "<p>The first error is a simple mis-declaration: The function receives a pointer and returns a pointer, so the return type is <code>int *</code>,  not simply <code>int</code>. By the way, I like it that the function returns the pointer because it allows for function nesting like in the code below (the result of a function call can be the direct argument for another).</p>\n\n<p>Note that the parameter <code>x</code> you declare is a pointer, despite appearances. One can declare a pointer parameter in two ways:</p>\n\n<p><code>f ( int *p );</code></p>\n\n<p>or</p>\n\n<p><code>f2( int p[] );</code></p>\n\n<p>The two are completely identical; it is impossible to pass arrays to functions. They always are \"adjusted\" to pointers to the first element.</p>\n\n<p>In fact, one could even write </p>\n\n<p><code>f2( int p[100] );</code></p>\n\n<p>which I demonstrate in the code below. The number is irrelevant and ignored. In particular, the compiler does not think there is an array, and it does no type or index checking of the actual arguments.</p>\n\n<p>Now the original function you present is unsafe; it's entirely up to the caller to provide an array with 5 elements.</p>\n\n<p>C++ has the possibility to pass references, and even true references to arrays. Arrays of different sizes have different types, even if the elements are of the same type. This makes normal functions taking references to arrays pretty useless (unless you have an application like a screen buffer where all arrays are of the same size, known at coding time).</p>\n\n<p>But C++ has also templates, which are a facility to construct functions at compile time from a provided pattern, depending on type and int parameters provided by the caller at compile time (but not necessarily at template coding time!). For functions these template parameters can be inferred by the compiler from the function arguments which makes template functions handy to use: The compiler creates the proper one almost magically. </p>\n\n<p>A function iterating over all elements of a fixed-size array is a prime candidate for a template. Check out the last function in the code below.</p>\n\n<pre><code>#include&lt;iostream&gt;\n\nusing namespace std; // for brevity in the example\n\n/** An unsafe function based on passing pointers\n    without element counts.\n*/\nint *power_5_elems(int x[100]) {\n  // This is somewhat scary.\n  // There is no way to check whether the array\n  // starting at x has indeed 5 elements. It's\n  // like writing assembler: All is up to the caller.\n\n  // Another thing: It would be nice to use a loop.\n  // We know there are 5 elements, right?\n  x[0] = x[0] * x[0];\n  x[1] = x[1] * x[1];\n  x[2] = x[2] * x[2];\n  x[3] = x[3] * x[3];\n  x[4] = x[4] * x[4];\n\n  return x;\n}\n\n// A reference to an int array with 5 elements.\n// Remember, a typedef is written like a variable declaration; the\n// type name takes the syntactic place of the variable.\n// To decipher it, solve the expression in the parentheses first:\n// \"I must first de-reference the variable\".\n// The next operator is the square brackets index operator:\n// \"I must index the result of the dereferencing\" (i.e. it is an array).\n// There are 5 indices (0..4).\n// The last information is: \"The resulting type is int.\"\n// Summed up: This is a reference to an array with 5 elements of type int.\ntypedef int(&amp;intArr5)[5];\n\n/** This is a nicer way to declare the function below. */\nintArr5 power_ref5Arr(intArr5 arrRef);\n\n/** A safe function with very limited usability.\n    It works only for int arrays with 5 elements.\n    This is the raw declaration of the same function.\n*/\nint (&amp;power_ref5Arr( int (&amp;x)[5] ))[5] {\n  // This is not scary at all.\n  // Only arrays with 5 ints can be supplied.\n  for (int i = 0; i &lt; 5; i++)\n  {\n    x[i] = x[i] * x[i];\n  }\n\n  return x;\n}\n\n/** A versatile function which squares arrays\n    of arbitrary length of any type that isn't on\n    a tree on the count of three. It's very similar to the\n    function above with 5 int elements.\n*/\ntemplate&lt;int N, typename T&gt;\nT(&amp;refPower( T (&amp;arr)[N] ))[N]\n{\n  // Note the use of the template parameter N\n  // in place of the \"5\" above.\n  for (int i = 0; i &lt; N; i++)\n  {\n    arr[i] = arr[i] * arr[i];\n  }\n  return arr;\n}\n\nint main() {\n  int x[5] = { 2,3,4,5,6 };\n\n  int *p = &amp;x[0]; // make clear: this is a pointer\n\n  power_5_elems(power_5_elems(power_5_elems(x)));\n  cout &lt;&lt; x[0] &lt;&lt; endl;\n\n  // The function actually expects a pointer!\n  // The pointer points to x.\n  power_5_elems(p);\n  cout &lt;&lt; x[0] &lt;&lt; endl;\n\n  int y[2] = { 2,3 };\n\n  refPower(refPower(refPower(y)));\n  cout &lt;&lt; y[0] &lt;&lt; endl;\n\n  double z[2] = { 0.2 , 0.3 };\n  refPower(refPower(refPower(z)));\n\n  cout &lt;&lt; z[0] &lt;&lt; endl;\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8026294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0AQdUehUjL8/AAAAAAAAAAI/AAAAAAAAAL8/NEca6abFOVc/photo.jpg?sz=128", "display_name": "learner", "link": "https://stackoverflow.com/users/8026294/learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": -6, "last_activity_date": 1513781523, "creation_date": 1513774775, "last_edit_date": 1513775303, "question_id": 47906654, "link": "https://stackoverflow.com/questions/47906654/i-am-getting-errors-while-trying-to-return-an-array-in-c", "title": "I am getting errors while trying to return an array in C++", "body": "<p>I am getting 3 errors:</p>\n\n<ol>\n<li>line 12:-invalid conversion from int* to int</li>\n<li>line 17:-x was not declared in this scope</li>\n<li>line 16:- expected primary expression before',' token   </li>\n</ol>\n\n<p>Please help me to fix this. Here is the code:</p>\n\n<pre><code>#include&lt;iostream&gt;\nint power(int x[5])\n{\n    x[0]=12;\n    x[1]=23;\n    x[2]=234;\n    x[3]=344;\n    x[4]=232;\n\n    return x;\n}\n\nint main()\n{\n    int action[5]={1,2,3,,4,5};\n    std::cout&lt;&lt;x[0]&lt;&lt;std::endl;\n    x();\n    std::cout&lt;&lt;x[0]&lt;&lt;std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>your help would be appreciated!</p>\n"}, {"tags": ["c++", "c++11", "ubuntu", "tensorflow"], "answers": [{"tags": [], "owner": {"reputation": 950, "user_id": 4355878, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d8eaf7432b176754d0ac0d9c2df9eecc?s=128&d=identicon&r=PG&f=1", "display_name": "j35t3r", "link": "https://stackoverflow.com/users/4355878/j35t3r"}, "is_accepted": true, "score": 3, "last_activity_date": 1513788052, "creation_date": 1513788052, "answer_id": 47910692, "question_id": 47906589, "link": "https://stackoverflow.com/questions/47906589/tensorflow-op-how-to-include-libtensorflow-framework-so/47910692#47910692", "title": "Tensorflow Op: how to include libtensorflow_framework.so?", "body": "<p>One answer, I have found: </p>\n\n<p>I have installed my python via anaconda2 and I always tried to find out TF_INC and TF_LIB when I activated my repository <code>source activate &lt;env&gt;</code>. and the could not found any <code>~/anaconda2/envs/tensorflow/lib/python2.7/site-packages/tensorflow\n</code> *.so files</p>\n\n<p>This time I went out every python environment with the shell command <code>source deactivate</code> and I typed the following command\n<code>python -c 'import tensorflow as tf; print(tf.sysconfig.get_lib())'</code></p>\n\n<p>Now, I got a different path: <code>~/anaconda2/lib/python2.7/site-packages/tensorflow</code>, where the lib <code>libtensorflow_framework.so</code> is located. </p>\n"}, {"tags": [], "owner": {"reputation": 196, "user_id": 10697450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MxIMVfTyjdc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gKwEbChM2OARuEOKduljogE44CHQ/mo/photo.jpg?sz=128", "display_name": "rigo", "link": "https://stackoverflow.com/users/10697450/rigo"}, "is_accepted": false, "score": 0, "last_activity_date": 1576530265, "creation_date": 1576530265, "answer_id": 59364273, "question_id": 47906589, "link": "https://stackoverflow.com/questions/47906589/tensorflow-op-how-to-include-libtensorflow-framework-so/59364273#59364273", "title": "Tensorflow Op: how to include libtensorflow_framework.so?", "body": "<p>tensorflow_framework is not used before Tensorflow 1.4.1 </p>\n\n<p>When you call python from the shell make sure you are calling the right one:  </p>\n\n<p>TF_LIB = $(shell python -c 'import tensorflow; print(tensorflow.sysconfig.get_lib())')</p>\n\n<p>or </p>\n\n<p>TF_LIB = $(shell python3 -c 'import tensorflow; print(tensorflow.sysconfig.get_lib())')</p>\n"}, {"tags": [], "owner": {"reputation": 524, "user_id": 1582350, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b7ac87a4e596261fd36a6b19388e3821?s=128&d=identicon&r=PG&f=1", "display_name": "Moiz Sajid", "link": "https://stackoverflow.com/users/1582350/moiz-sajid"}, "is_accepted": false, "score": 3, "last_activity_date": 1578746804, "creation_date": 1578746804, "answer_id": 59694515, "question_id": 47906589, "link": "https://stackoverflow.com/questions/47906589/tensorflow-op-how-to-include-libtensorflow-framework-so/59694515#59694515", "title": "Tensorflow Op: how to include libtensorflow_framework.so?", "body": "<p>In my case, the file <code>libtensorflow_framework.so.1</code> existed inside my <code>TF_LIB</code> directory instead of <code>libtensorflow_framework.so</code>. In order to solve this issue, I had to create a symbolic link as follows:</p>\n\n<pre><code>ln -s libtensorflow_framework.so.1 libtensorflow_framework.so\n</code></pre>\n\n<p>Source: <a href=\"https://stackoverflow.com/questions/56888781/tensorflow-notfounderror-libtensorflow-framework-so-cannot-open-shared-file-or\">Tensorflow NotFoundError: libtensorflow_framework.so: cannot open shared file or directory</a> </p>\n"}], "owner": {"reputation": 950, "user_id": 4355878, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d8eaf7432b176754d0ac0d9c2df9eecc?s=128&d=identicon&r=PG&f=1", "display_name": "j35t3r", "link": "https://stackoverflow.com/users/4355878/j35t3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8230, "favorite_count": 1, "accepted_answer_id": 47910692, "answer_count": 3, "score": 5, "last_activity_date": 1578746804, "creation_date": 1513774542, "last_edit_date": 1513780966, "question_id": 47906589, "link": "https://stackoverflow.com/questions/47906589/tensorflow-op-how-to-include-libtensorflow-framework-so", "title": "Tensorflow Op: how to include libtensorflow_framework.so?", "body": "<p>I followed the instructions of this tutorial:\n<a href=\"https://www.tensorflow.org/extend/adding_an_op#implement_the_gradient_in_python\" rel=\"noreferrer\">https://www.tensorflow.org/extend/adding_an_op#implement_the_gradient_in_python</a>.\nThere is this comment provided: <code>g++ -std=c++11 -shared zero_out.cc -o zero_out.so -fPIC -I$TF_INC -I$TF_INC/external/nsync/public -L$TF_LIB -ltensorflow_framework -O2</code></p>\n\n<p>But the linker cannot find <code>-ltensorflow_framework</code> (it should be a tensorflow_frameowork.so file!?)</p>\n\n<p>After some research, I found following links:</p>\n\n<ul>\n<li><a href=\"https://github.com/tensorflow/tensorflow/issues/1569\" rel=\"noreferrer\">https://github.com/tensorflow/tensorflow/issues/1569</a></li>\n<li><a href=\"https://github.com/eaplatanios/tensorflow_scala/issues/26\" rel=\"noreferrer\">https://github.com/eaplatanios/tensorflow_scala/issues/26</a> --> I downloaded the .jar and linked it via <code>-l/pathto/tensorflow_framework.so</code>, still the <code>fatal error: tensorflow/core/framework/op_kernel.h: No such file or directory</code> is not found.</li>\n<li><a href=\"https://github.com/tensorflow/tensorflow/issues/1270\" rel=\"noreferrer\">https://github.com/tensorflow/tensorflow/issues/1270</a>  last comment does not work and so does not help me. </li>\n</ul>\n\n<p>I tried to search for <code>sudo find /usr/. -name \"tensorflow_framework.so\"</code> recursively but I could not find anything. Tensorflow is installed for sure via anaconda and I also cloned and compiled the repository from source.</p>\n\n<p>How to find a way to include the <code>-ltensorflow_framework</code>?</p>\n"}, {"tags": ["javascript", "c++", "makefile"], "comments": [{"owner": {"reputation": 1077, "user_id": 2174271, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/f04f3022784248de423fe3e0373d8c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Gehlaut", "link": "https://stackoverflow.com/users/2174271/tarun-gehlaut"}, "edited": false, "score": 0, "creation_date": 1514404853, "post_id": 47906451, "comment_id": 82964207, "body": "No, you need to install make. Google how to do so. The first step i belive is not required. Get the portable sdk, run emsdk and follow its step to first fetch and then download the latest pre-built binaries(of the Sdk and not individual components)"}, {"owner": {"reputation": 1259, "user_id": 5989485, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/eDRVw.jpg?s=128&g=1", "display_name": "YAHsaves", "link": "https://stackoverflow.com/users/5989485/yahsaves"}, "reply_to_user": {"reputation": 1077, "user_id": 2174271, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/f04f3022784248de423fe3e0373d8c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Gehlaut", "link": "https://stackoverflow.com/users/2174271/tarun-gehlaut"}, "edited": false, "score": 0, "creation_date": 1514407159, "post_id": 47906451, "comment_id": 82965069, "body": "@Tarun Gehlaut yes you are correct, after several days of fighting with it I was able to get it to build successfully! I did it in a linux environment and after installing make and skipping the first command (as you suggested) everything worked perfectly."}, {"owner": {"reputation": 1077, "user_id": 2174271, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/f04f3022784248de423fe3e0373d8c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Gehlaut", "link": "https://stackoverflow.com/users/2174271/tarun-gehlaut"}, "edited": false, "score": 0, "creation_date": 1514407549, "post_id": 47906451, "comment_id": 82965213, "body": "Great. Keep going."}], "owner": {"reputation": 1259, "user_id": 5989485, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/eDRVw.jpg?s=128&g=1", "display_name": "YAHsaves", "link": "https://stackoverflow.com/users/5989485/yahsaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 330, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513774102, "creation_date": 1513774102, "question_id": 47906451, "link": "https://stackoverflow.com/questions/47906451/how-to-use-makefiles-when-compiling-with-emscripten", "title": "How to use makefiles when compiling with emscripten", "body": "<p>-</p>\n\n<p>I am trying to compile Fabrice Bellard's <a href=\"https://bellard.org/bpg/\" rel=\"nofollow noreferrer\">BPG image project</a> with emscripten to convert it to wasm.</p>\n\n<p>Mr. Bellard already has a per-compiled version setup to render 3 javascript files. He is using a Makefile to control the build settings.</p>\n\n<p>I'm very new to emscripten (and compiling c in general), so forgive me if this is a noob oversight, but I tried to run the commands given on the <a href=\"https://kripken.github.io/emscripten-site/docs/compiling/Building-Projects.html\" rel=\"nofollow noreferrer\">emscripten website</a> for make files however I get the errors listed below:</p>\n\n<p><strong>command</strong>: emconfigure configure</p>\n\n<p><strong>Error</strong>: root:Exception thrown when invoking Popen in configure with args:\"configure\"</p>\n\n<p><strong>command</strong>: emmake make</p>\n\n<p><strong>Error</strong>: make is not recognized as an internal or external command</p>\n\n<p>I don't understand what the first error means at all, and I couldn't find much googling. However the second error I understand what it means but I don't understand why I'm getting it. Isn't make built into emscripten? </p>\n\n<p>Thank you for any help toward this!</p>\n"}, {"tags": ["c++", "c++11", "gcc", "decltype", "member-functions"], "comments": [{"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1513776307, "post_id": 47906426, "comment_id": 82781156, "body": "Related: <a href=\"https://stackoverflow.com/q/38457112/2642059\">stackoverflow.com/q/38457112/2642059</a>"}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1513778676, "post_id": 47906426, "comment_id": 82782729, "body": "I wouldn&#39;t use MSVC12 as a paragon of standards conformance. Can you test again in the 15.5 compiler (VS2017.5)?"}, {"owner": {"reputation": 1751, "user_id": 3536140, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fcc1b905bfd7fe58a60cbf8bc991408a?s=128&d=identicon&r=PG&f=1", "display_name": "vdavid", "link": "https://stackoverflow.com/users/3536140/vdavid"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1513783044, "post_id": 47906426, "comment_id": 82785741, "body": "@Mgetz I agree MSVC12 is not ideal but currently that\u2019s the most recent version I can get my hands on, thus I cannot test with 15.5."}], "answers": [{"comments": [{"owner": {"reputation": 1751, "user_id": 3536140, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fcc1b905bfd7fe58a60cbf8bc991408a?s=128&d=identicon&r=PG&f=1", "display_name": "vdavid", "link": "https://stackoverflow.com/users/3536140/vdavid"}, "edited": false, "score": 0, "creation_date": 1513782911, "post_id": 47906670, "comment_id": 82785648, "body": "This works like a charm with gcc 6.3, clang 4.0 and MSVC12. Many thanks, @dvk. I still do not understand why clang and gcc reject non-static member functions but this is secondary since the solution fully solves my issue."}], "tags": [], "owner": {"reputation": 1320, "user_id": 1600612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab513043b9b486138701a4b2a98648c8?s=128&d=identicon&r=PG", "display_name": "dvk", "link": "https://stackoverflow.com/users/1600612/dvk"}, "is_accepted": true, "score": 3, "last_activity_date": 1513775146, "last_edit_date": 1513775146, "creation_date": 1513774843, "answer_id": 47906670, "question_id": 47906426, "link": "https://stackoverflow.com/questions/47906426/type-of-member-functions-arguments/47906670#47906670", "title": "Type of member functions arguments", "body": "<p>You need another template specialization for member functions, something like this:</p>\n\n<pre><code>template&lt;typename ClassType, typename Result, typename...Args&gt;\nstruct FunctionSignatureParser&lt;Result(ClassType::*)(Args...)&gt;\n{\n    using return_type = Result;\n    using args_tuple = std::tuple&lt;Args...&gt;;\n    template &lt;size_t i&gt; struct arg\n    {\n        typedef typename std::tuple_element&lt;i, args_tuple&gt;::type type;\n    };\n};\n</code></pre>\n\n<p>And it can be used like this:</p>\n\n<pre><code>    static_assert(std::is_same&lt;double, FunctionSignatureParser&lt;decltype(&amp;Temperature::add)&gt;::arg&lt;0&gt;::type&gt;::value, \"Method 'Temperature::add' does not use an argument of type 'double'\");\n</code></pre>\n\n<p>This works with gcc 7.2, haven't tested other compilers</p>\n"}], "owner": {"reputation": 1751, "user_id": 3536140, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fcc1b905bfd7fe58a60cbf8bc991408a?s=128&d=identicon&r=PG&f=1", "display_name": "vdavid", "link": "https://stackoverflow.com/users/3536140/vdavid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 1, "accepted_answer_id": 47906670, "answer_count": 1, "score": 3, "last_activity_date": 1513776459, "creation_date": 1513774008, "question_id": 47906426, "link": "https://stackoverflow.com/questions/47906426/type-of-member-functions-arguments", "title": "Type of member functions arguments", "body": "<p>Using C++11 I am trying to get the type of function arguments from a function name, granted the function signature is unambiguous. Ultimately, I am trying to check that an argument is exactly the type I want <em>before</em> I call a function.</p>\n\n<p>So far I can do it with non-member functions thanks to this solution: \n<a href=\"https://stackoverflow.com/questions/24948277/unpacking-arguments-of-a-functional-parameter-to-a-c-template-class#24948381\">Unpacking arguments of a functional parameter to a C++ template class</a></p>\n\n<p>I have slightly edited it to get the following class:</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct FunctionSignatureParser; // unimplemented primary template\ntemplate&lt;typename Result, typename...Args&gt;\nstruct FunctionSignatureParser&lt;Result(Args...)&gt;\n{\n    using return_type = Result;\n    using args_tuple = std::tuple&lt;Args...&gt;;\n    template &lt;size_t i&gt; struct arg\n    {\n        typedef typename std::tuple_element&lt;i, args_tuple&gt;::type type;\n    };\n};\n</code></pre>\n\n<p>For instance I can check the type of a function at compile-time:</p>\n\n<pre><code>short square(char x) { // 8-bit integer as input, 16-bit integer as output\n    return short(x)*short(x);\n}\nint main() {\n        char answer = 42;\n        static_assert(std::is_same&lt;char, FunctionSignatureParser&lt;decltype(square)&gt;::arg&lt;0&gt;::type&gt;::value, \"Function 'square' does not use an argument of type 'char'\");\n        static_assert(std::is_same&lt;short, FunctionSignatureParser&lt;decltype(square)&gt;::return_type&gt;::value, \"Function 'square' does not return a value of type 'short'\");\n        short sqrAnswer = square(answer);\n        std::cout &lt;&lt; \"The square of \" &lt;&lt; +answer &lt;&lt; \" is \" &lt;&lt; +sqrAnswer &lt;&lt; std::endl;\n        return 0;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/6JV52t\" rel=\"nofollow noreferrer\">>> Online code with gcc</a></p>\n\n<p>But when I want to check the type of member functions, some compilers are not happy with it:</p>\n\n<pre><code>struct Temperature\n{\n    double degrees;\n    Temperature add(double value);\n};\nint main() {\n    Temperature t{16};\n    double increment{8};\n    static_assert(std::is_same&lt;double, FunctionSignatureParser&lt;decltype(t.add)&gt;::arg&lt;0&gt;::type&gt;::value, \"Method 'Temperature::add' does not use an argument of type 'double'\");\n    std::cout &lt;&lt; t.degrees &lt;&lt; u8\" \\u00b0C + \" &lt;&lt; increment &lt;&lt; \" == \" &lt;&lt; t.add(increment).degrees &lt;&lt; u8\" \\u00b0C\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>Here is what gcc 6.3 has to say:</p>\n\n<blockquote>\n  <p>error: invalid use of non-static member function \u2018Temperature Temperature::add(double)\u2019</p>\n</blockquote>\n\n<p><a href=\"https://ideone.com/hUAT61\" rel=\"nofollow noreferrer\">>> Online code with gcc</a></p>\n\n<p>Here is what clang 4.0 has to say:</p>\n\n<blockquote>\n  <p>error: reference to non-static member function must be called</p>\n</blockquote>\n\n<p><a href=\"https://ideone.com/zjBJnC\" rel=\"nofollow noreferrer\">>> Online code with clang</a></p>\n\n<p>I have tried those options, to no avail:</p>\n\n<pre><code>decltype(Temperature::add)\ndecltype(std::declval&lt;Temperature&gt;().add)\n</code></pre>\n\n<p>What\u2019s the problem with non-static member functions inside a <code>decltype</code>? Since expressions inside a <code>decltype</code> are not evaluated, the <code>static</code> qualifier should not matter, right?</p>\n\n<p>For the record, MSVC12 succeeds in this situation. I cannot tell if the Microsoft compiler is right or wrong, though. (please let\u2019s not make this thread a compiler war)</p>\n\n<p>Also, if you have a solution to argument checking that does not involve the initial approach, I am open for it as well.</p>\n"}, {"tags": ["c++", "qml", "qtquick2"], "comments": [{"owner": {"reputation": 748, "user_id": 3392261, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/6fo6p.jpg?s=128&g=1", "display_name": "SourabhKus", "link": "https://stackoverflow.com/users/3392261/sourabhkus"}, "edited": false, "score": 0, "creation_date": 1513857959, "post_id": 47906247, "comment_id": 82816748, "body": "create your version as QString data type and have a look <a href=\"http://doc.qt.io/qt-5/qtqml-cppintegration-topic.html\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "reply_to_user": {"reputation": 748, "user_id": 3392261, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/6fo6p.jpg?s=128&g=1", "display_name": "SourabhKus", "link": "https://stackoverflow.com/users/3392261/sourabhkus"}, "edited": false, "score": 0, "creation_date": 1513861081, "post_id": 47906247, "comment_id": 82818622, "body": "I have no problem to integrate C++ and QML at all. <code>Version</code> is a complicated object and cannot be treated as a string. All I need is a implicit casting to QString, as, for example, QDateTime does."}], "owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513773467, "creation_date": 1513773467, "question_id": 47906247, "link": "https://stackoverflow.com/questions/47906247/printing-out-custom-object", "title": "Printing out custom object", "body": "<p>In my C++/QML application I use a lot of C++ classes exposed to QML through one proxy object. Actually that looks like in the example below:</p>\n\n<pre><code>class ProxyObject\n{\n    Q_GADGET\n    Q_PROPERTY(Version MyVersion READ GetMyVersion)\n\npublic:\n    ProxyObject();\n    Version GetMyVersion();\n}\n\nclass Version\n{\n    Q_GADGET\npublic:\n    Version();\n    QString toString() const;\n}\n</code></pre>\n\n<p>All of these classes of course, exposed to QML:</p>\n\n<pre><code>qmlRegisterSingletonType&lt;ProxyObject&gt;(\"com.MyApp\", 1, 0, \"ProxyObject\", example_qobject_singletontype_provider);\nqRegisterMetaType&lt;Version&gt;(\"Version\");\n</code></pre>\n\n<p>Now I want to use them in QML:</p>\n\n<pre><code>import QtQuick 2.9\nimport QtQuick.Controls 2.2\nimport com.MyApp 1.0\n\nApplicationWindow {\n    id: mainWindow\n    visible: true\n\n    Label {\n        text: ProxyObject.Version\n    }\n}\n</code></pre>\n\n<p>Running this code cause to console warning:</p>\n\n<blockquote>\n  <p>Unable to assign Version to QString</p>\n</blockquote>\n\n<p>That looks right in my opinion but how can I print out my object?\nI've added </p>\n\n<pre><code>QString toString() const;\n</code></pre>\n\n<p>to Version class but that doesn't help.</p>\n\n<p>For now I use workaround with property, I've added </p>\n\n<pre><code>Q_PROPERTY(QString ToString READ toString)\n</code></pre>\n\n<p>to the Version class and so use it in QML:</p>\n\n<pre><code>Label {\n        text: ProxyObject.Version.ToString\n    }\n</code></pre>\n\n<p>But that looks disgusting for me. As I see built-in object, like <code>QDateTime</code> could be printed out to console without problem. So how can I do the same and print out to console my custom object? </p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "edited": false, "score": 0, "creation_date": 1513773704, "post_id": 47906197, "comment_id": 82779410, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37105308/how-does-qfuzzycompare-work-in-qt\">How does qFuzzyCompare work in Qt</a>"}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1513773712, "post_id": 47906197, "comment_id": 82779417, "body": "multiply by <code>10^precision</code>, convert to <code>int</code> and then compare?"}, {"owner": {"reputation": 2254, "user_id": 4946821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R7FRn.jpg?s=128&g=1", "display_name": "KelvinS", "link": "https://stackoverflow.com/users/4946821/kelvins"}, "reply_to_user": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "edited": false, "score": 0, "creation_date": 1513773800, "post_id": 47906197, "comment_id": 82779482, "body": "@cse I don&#39;t think it is duplicate. The other question is not related to limit the decimal places."}, {"owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "edited": false, "score": 0, "creation_date": 1513774030, "post_id": 47906197, "comment_id": 82779629, "body": "@KelvinS In provided answer it is mentioned that: Internally <code>Qt</code> use ` (qAbs(p1 - p2) * 1000000000000. &lt;= qMin(qAbs(p1), qAbs(p2))); `. So your query should be should be solved."}], "answers": [{"comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 2, "creation_date": 1513774229, "post_id": 47906348, "comment_id": 82779752, "body": "@rafix07 Usual arithmetic conversion leads to integer promotion, so the result will be an <code>int</code>."}, {"owner": {"reputation": 1249, "user_id": 2039157, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3f1dfc43469c413590a20f77bf15e193?s=128&d=identicon&r=PG", "display_name": "denim", "link": "https://stackoverflow.com/users/2039157/denim"}, "edited": false, "score": 0, "creation_date": 1584957493, "post_id": 47906348, "comment_id": 107590687, "body": "This will return true (is equal) for e.g.: 5.12 and 5.11 compared to 2 decimal places. See my answer below for details."}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 13, "last_activity_date": 1513773772, "creation_date": 1513773772, "answer_id": 47906348, "question_id": 47906197, "link": "https://stackoverflow.com/questions/47906197/how-to-compare-double-values-limiting-the-decimal-places/47906348#47906348", "title": "How to compare double values limiting the decimal places?", "body": "<p>The usual way to compare two floating point values is to subtract them from each other, get the absolute value of the result, and compare it to an <em>epsilon</em> value.</p>\n\n<p>In your case it could be something like</p>\n\n<pre><code>bool compare(double value1, double value2, quint8 precision)\n{\n    return std::abs(value1 - value2) &lt; std::pow(10, -precision);\n}\n</code></pre>\n\n<p>For a precision of e.g. <code>6</code> then <code>std::pow(10, -precision)</code> should equal <code>0.000001</code> (this is the <em>epsilon</em>), and if the difference between the two values is smaller than that they are considered equal.</p>\n"}, {"tags": [], "owner": {"reputation": 1249, "user_id": 2039157, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3f1dfc43469c413590a20f77bf15e193?s=128&d=identicon&r=PG", "display_name": "denim", "link": "https://stackoverflow.com/users/2039157/denim"}, "is_accepted": false, "score": 0, "last_activity_date": 1584957431, "creation_date": 1584957431, "answer_id": 60811271, "question_id": 47906197, "link": "https://stackoverflow.com/questions/47906197/how-to-compare-double-values-limiting-the-decimal-places/60811271#60811271", "title": "How to compare double values limiting the decimal places?", "body": "<p>The accepted answer will return true (is equal) for e.g.: 5.12 and 5.11 compared to 2 decimal places:</p>\n\n<pre><code>double value1 = 5.12;\ndouble value2 = 5.11;\nbool result = compare2(value1, value2, 2); // result will be true\n</code></pre>\n\n<p>This is because 5.12 - 5.11 equals to 0.01 but will be represented as 0.009999999999999787 in the floating point number.</p>\n\n<p>I am using the following approach instead that works around this problem by doing an integer comparison:</p>\n\n<pre><code>bool compare(const double value1, const double value2, const int precision)\n{\n    int64_t magnitude = static_cast&lt;int64_t&gt;(std::pow(10, precision));\n    int64_t intValue1 = static_cast&lt;int64_t&gt;(value1 * magnitude);\n    int64_t intValue2 = static_cast&lt;int64_t&gt;(value2 * magnitude);\n    return intValue1 == intValue2;\n}\n</code></pre>\n"}], "owner": {"reputation": 2254, "user_id": 4946821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R7FRn.jpg?s=128&g=1", "display_name": "KelvinS", "link": "https://stackoverflow.com/users/4946821/kelvins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3043, "favorite_count": 1, "accepted_answer_id": 47906348, "answer_count": 2, "score": 2, "last_activity_date": 1584957431, "creation_date": 1513773285, "last_edit_date": 1513774336, "question_id": 47906197, "link": "https://stackoverflow.com/questions/47906197/how-to-compare-double-values-limiting-the-decimal-places", "title": "How to compare double values limiting the decimal places?", "body": "<p><strong>Qt</strong> provides the <code>qFuzzyCompare</code> function to compare <strong>doubles</strong>, for example:</p>\n\n<pre><code>bool compare(double value1, double value2)\n{\n    return qFuzzyCompare(value1, value2);\n}\n</code></pre>\n\n<p>If I try to compare the following values <code>387.109287103</code> and <code>387.109287101</code>, <code>qFuzzyCompare</code> will return <code>false</code>, what makes sense, since the values are not equal.</p>\n\n<p><strong>How can I limit the decimal places to compare two double values?</strong></p>\n\n<p>For example, limiting the decimal places to <code>6</code> the two values (<code>387.109287</code> and <code>387.109287</code>) will be equal.</p>\n\n<p>I have implemented the following function to do that:</p>\n\n<pre><code>bool compare(double value1, double value2, quint8 precision)\n{\n    value1 = QString::number(value1, 'f', precision).toDouble();\n    value2 = QString::number(value2, 'f', precision).toDouble();\n\n    return qFuzzyCompare(value1, value2);\n}\n</code></pre>\n\n<p>But I'm not sure if it is the best way to do that, since it convert the values to <code>QString</code> and then convert back to <code>double</code>.</p>\n\n<hr>\n\n<p>Here is the full example:</p>\n\n<pre><code>#include &lt;QDebug&gt;\n#include &lt;QtGlobal&gt;\n\nbool compare(double value1, double value2)\n{\n    return qFuzzyCompare(value1, value2);\n}\n\nbool compare(double value1, double value2, quint8 precision)\n{\n    value1 = QString::number(value1, 'f', precision).toDouble();\n    value2 = QString::number(value2, 'f', precision).toDouble();\n\n    return qFuzzyCompare(value1, value2);\n}\n\nint main()\n{\n    qDebug() &lt;&lt; compare(387.109287103, 387.109287101);    // False\n    qDebug() &lt;&lt; compare(387.109287103, 387.109287101, 6); // True\n    return 0;\n}\n</code></pre>\n\n<p><strong>Note</strong>: I'm using Qt 5.3.</p>\n"}, {"tags": ["c++", "winapi"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1513774032, "post_id": 47906066, "comment_id": 82779631, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3439589/how-to-show-text-an-d-icon-on-button-in-win-32-c\">how to show text an d icon on button in win 32 c++?</a>"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1513781078, "post_id": 47906066, "comment_id": 82784350, "body": "@MichaelWalz: Unfortunately, the answer to that duplicate question misses the most straightforward solution, and really doesn&#39;t contain much useful information itself. It&#39;s probably more helpful to have that other Q&amp;A link to this one as a duplicate."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1513782342, "post_id": 47906066, "comment_id": 82785254, "body": "@IInspectable you&#39;re right, cv retracted. And upvoted your answer."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1513793031, "post_id": 47906066, "comment_id": 82791487, "body": "@IInspectable Perhaps better would be to add the answer there, and close this as a dupe. The quality of the answers there isn&#39;t so important. What matters is if this is the same question. If so, it&#39;s a dupe. But it was too late. I closed the other as a dupe."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1513793535, "post_id": 47906066, "comment_id": 82791723, "body": "@David: I would have considered doing so, if the duplicate didn&#39;t have an accepted answer already, leading to a situation, where a visitor would have to scroll past the accepted answer to find a better one. That doesn&#39;t make finding a solution any easier."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1513793597, "post_id": 47906066, "comment_id": 82791752, "body": "@IInspectable That&#39;s not how dupes work here, as you surely know well"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1513794634, "post_id": 47906066, "comment_id": 82792234, "body": "@David: With duplicates, it really doesn&#39;t matter, whether an older question gets closed as a duplicate of a newer question, or the other way around. What&#39;s important is to have a link between duplicates. Regardless of how duplicates work, I opted for a strategy, that makes finding a solution to a problem (potentially) easier. This should always be the guiding principle."}], "answers": [{"comments": [{"owner": {"reputation": 632, "user_id": 5662819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1224af73a810b804366e3d73b5e4bffc?s=128&d=identicon&r=PG&f=1", "display_name": "DavitS", "link": "https://stackoverflow.com/users/5662819/davits"}, "edited": false, "score": 0, "creation_date": 1513774432, "post_id": 47906445, "comment_id": 82779913, "body": "I have tried this, I am deleting BS_BITMAP from my button styles, but in that case the icon is not shown, if if I send the BM_SETIMAGE message"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 632, "user_id": 5662819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1224af73a810b804366e3d73b5e4bffc?s=128&d=identicon&r=PG&f=1", "display_name": "DavitS", "link": "https://stackoverflow.com/users/5662819/davits"}, "edited": false, "score": 0, "creation_date": 1513775611, "post_id": 47906445, "comment_id": 82780689, "body": "@RandomUser: What OS are you targeting? Have you enabled Visual Styles? Do you specify the <code>BS_TEXT</code> style when creating the button?"}, {"owner": {"reputation": 632, "user_id": 5662819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1224af73a810b804366e3d73b5e4bffc?s=128&d=identicon&r=PG&f=1", "display_name": "DavitS", "link": "https://stackoverflow.com/users/5662819/davits"}, "edited": false, "score": 0, "creation_date": 1513776319, "post_id": 47906445, "comment_id": 82781166, "body": "I am on windows 10. I have posted the code. I have just used it. It doesn&#39;t help"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 632, "user_id": 5662819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1224af73a810b804366e3d73b5e4bffc?s=128&d=identicon&r=PG&f=1", "display_name": "DavitS", "link": "https://stackoverflow.com/users/5662819/davits"}, "edited": false, "score": 0, "creation_date": 1513778057, "post_id": 47906445, "comment_id": 82782312, "body": "@RandomUser: I verified this to work on Windows 10. You do have to enable visual styles, though, which should be the default for any application. Unless you want your UI to look like Windows 3."}, {"owner": {"reputation": 632, "user_id": 5662819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1224af73a810b804366e3d73b5e4bffc?s=128&d=identicon&r=PG&f=1", "display_name": "DavitS", "link": "https://stackoverflow.com/users/5662819/davits"}, "edited": false, "score": 0, "creation_date": 1513778281, "post_id": 47906445, "comment_id": 82782455, "body": "sorry, I didnt understand. Did it work for you? I mean, my visual effects are enabled, and it doesnt work for me."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 632, "user_id": 5662819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1224af73a810b804366e3d73b5e4bffc?s=128&d=identicon&r=PG&f=1", "display_name": "DavitS", "link": "https://stackoverflow.com/users/5662819/davits"}, "edited": false, "score": 0, "creation_date": 1513778332, "post_id": 47906445, "comment_id": 82782495, "body": "@RandomUser: Yes, it works for me. I can post the code I used as well."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1513782828, "post_id": 47906445, "comment_id": 82785594, "body": "I suggest to replace <code>LoadImageW</code> with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb775703(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>LoadIconWithScaleDown</code></a> (use <code>LoadImageW</code> as fallback if you need to target WinXP too) which provides much better scaling quality if the icon does not provide an image of the exact desired image size. At a minimum, use <code>GetSystemMetrics</code> instead of hardcoding icon size."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 2, "creation_date": 1513783712, "post_id": 47906445, "comment_id": 82786171, "body": "@zett42: This Q&amp;A is about producing a button that shows both text and an image. Image loading and image sizing is unrelated to the question or the answer. All that&#39;s needed is an arbitrary image of arbitrary size. That&#39;s what the code does. If you want to apply the solution, feel free to pick your preferred way to construct the image."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1513788460, "post_id": 47906445, "comment_id": 82789094, "body": "Why not improve the &quot;unrelated&quot; part of the code anyway? For someone who finds this question through search, the &quot;unrelated&quot; code may be even more important than the part that answers the original question. For loading an icon, <code>LoadImageW</code> vs. <code>LoadIconWithScaleDown</code> is not a matter of &quot;preference&quot;. The latter clearly provides better image quality in many cases. In the other cases it doesn&#39;t make matters worse."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1513791963, "post_id": 47906445, "comment_id": 82790910, "body": "@zett42: Why not improve it? Because it&#39;s not needed, and doing so only distracts from the code that <i>is</i> relevant. If you want to share information on how to properly load an icon, you can create a Q&amp;A to showcase the relative merits of different approaches. In this case, I <i>know</i> that no scaling is required, because the default application icon created by Visual Studio&#39;s New Project wizard contains the size I requested. So really, why make things more complicated?"}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1513806455, "post_id": 47906445, "comment_id": 82797631, "body": "In my opinion, one can make an answer <i>more useful</i> by adding knowledge along the way, where it fits. There needs to be a balance though. If one has to scroll through pages of &quot;support code&quot; to find the most relevant part, that&#39;s surely overdoing it. In this case I would replace a function with one that has a more readable name and even less parameters. Two additional calls to <code>GetSystemMetrics</code> and that&#39;s it. I would add a comment that this helps with DPI scaling and make sure that my answer text focuses on the most relevant code. I can accept that you have a different view. Cheers! :-)"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1513855035, "post_id": 47906445, "comment_id": 82815077, "body": "@zett42: In other words: Add 1 line of code declaring an <code>HICON</code> variable, 2 lines of code to retrieve system settings, and another line of code to load the image. That is: 4 lines of unrelated code, that <i>dominate</i> the relevant code by a factor of 2:1. Hardly an improvement. And that completely ignores, that I do not even want a dynamically sized icon. I want a statically sized icon in a statically sized button. Otherwise, someone with different settings may wind up with an icon so large, that it drives the text off the right edge of the button, making the solution appear to not work."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1513865933, "post_id": 47906445, "comment_id": 82821641, "body": "Someone with a high DPI scale factor may wind up with an icon so small, that it&#39;s barely even noticable, making the solution appear to not work."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1513867427, "post_id": 47906445, "comment_id": 82822711, "body": "@zett42: That&#39;s incorrect. As long as the application does not opt-in to DPI awareness, the system automatically scales the UI. As you can see from the screenshot I posted. The 32x32 icon was scaled to 56x56, due to a scale factor of 175%. At the lowest scale factor (100%), a 32x32 icon is still clearly visible on a 267 PPI screen. I would kindly ask you to keep this on-topic. Neither DPI awareness, nor scaling, nor image quality are aspects that need to be addressed in this Q&amp;A. You can always create a Q&amp;A yourself, if you find it important to share this information."}], "tags": [], "owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "is_accepted": true, "score": 8, "last_activity_date": 1513855167, "last_edit_date": 1513855167, "creation_date": 1513774088, "answer_id": 47906445, "question_id": 47906066, "link": "https://stackoverflow.com/questions/47906066/how-to-put-an-icon-on-a-text-button/47906445#47906445", "title": "How to put an icon on a text button?", "body": "<p>Instructions on how to get a button to display both an image and text are outlined in the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb775951.aspx\" rel=\"nofollow noreferrer\">Button Styles</a> reference<sup>1</sup>:</p>\n\n<blockquote>\n  <p>The appearance of text or an icon or both on a button control depends on the BS_ICON and BS_BITMAP styles, and whether the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb761822.aspx\" rel=\"nofollow noreferrer\">BM_SETIMAGE</a> message is sent. The possible results are as follows.\n  </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>BS_ICON or BS_BITMAP set? | BM_SETIMAGE called? | Result  \n--------------------------+---------------------+--------------------  \nYes                       | Yes                 | Show icon only.  \nNo                        | Yes                 | Show icon and text.  \nYes                       | No                  | Show text only.  \nNo                        | No                  | Show text only\n</code></pre>\n</blockquote>\n\n<p>In other words: Don't set the <code>BS_ICON</code> or <code>BS_BITMAP</code> style (but do set the <code>BS_TEXT</code> style), and send a <code>BM_SETIMAGE</code> message once the button has been created.</p>\n\n<p>To see this in action, create a standard Windows Desktop application in Visual Studio, and apply the following changes:</p>\n\n\n\n<ul>\n<li><p>Enable visual styles. This is easiest done by placing a <code>#pragma</code> linker directive into the only compilation unit:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#pragma comment(linker,\"\\\"/manifestdependency:type='win32' \\\nname='Microsoft.Windows.Common-Controls' version='6.0.0.0' \\\nprocessorArchitecture='*' publicKeyToken='6595b64144ccf1df' language='*'\\\"\")\n</code></pre></li>\n<li><p>Create the button in the main window's <code>WM_CREATE</code> handler:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>case WM_CREATE:\n    {\n        HWND btn{ ::CreateWindowExW(0x0, L\"BUTTON\", L\"Button text\",\n                                    WS_VISIBLE | WS_CHILD | BS_TEXT,\n                                    10, 10, 200, 50, hWnd, (HMENU)110,\n                                    nullptr, nullptr) };\n        HICON icon{ (HICON)::LoadImageW(::GetModuleHandle(nullptr),\n                                        MAKEINTRESOURCEW(107),\n                                        IMAGE_ICON, 32, 32, 0x0) };\n        ::SendMessageW(btn, BM_SETIMAGE, IMAGE_ICON, (LPARAM)icon);\n    }\n    break;\n</code></pre>\n\n<p>Make sure to adjust the numeric constants as needed. <code>110</code> is the button's control identifier, <code>107</code> is the resource ID of the wizard-generated application icon resource, and <code>32</code> are the width and height of the requested icon.</p></li>\n</ul>\n\n<p>This code produces the following output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Lvv93.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lvv93.png\" alt=\"Image button\"></a></p>\n\n<hr/>\n\n<p><sup>1</sup> <em>Note, that you have to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb773175.aspx\" rel=\"nofollow noreferrer\">enable visual styles</a> for this to work.</em></p>\n"}], "owner": {"reputation": 632, "user_id": 5662819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1224af73a810b804366e3d73b5e4bffc?s=128&d=identicon&r=PG&f=1", "display_name": "DavitS", "link": "https://stackoverflow.com/users/5662819/davits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 1, "accepted_answer_id": 47906445, "answer_count": 1, "score": 3, "last_activity_date": 1583836994, "creation_date": 1513772807, "question_id": 47906066, "link": "https://stackoverflow.com/questions/47906066/how-to-put-an-icon-on-a-text-button", "title": "How to put an icon on a text button?", "body": "<p>I want to have both an image icon and text on the same button, like here in Word for example. </p>\n\n<p><a href=\"https://i.stack.imgur.com/gdfSr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gdfSr.png\" alt=\"enter image description here\"></a></p>\n\n<p>I set an icon on a button, but the text disappears.</p>\n\n<pre><code>HANDLE hBmp = (HBITMAP)LoadImage(g_hDllInstance,\n    MAKEINTRESOURCE(IDB_BITMAP4),\n    IMAGE_BITMAP,\n    NULL,\n    NULL,\n    LR_DEFAULTCOLOR);\nHWND hwndButton = CreateWindowEx(\n    NULL,\n    _T(\"BUTTON\"),\n    _T(\"SOME TEXT\"),\n    BS_BITMAP | WS_VISIBLE | WS_CHILD,\n    point.x - 47,\n    point.y - 3,\n    36,\n    40,\n    hWnd,\n    (HMENU)200,\n    NULL,\n    NULL);\nSendMessage(\n    (HWND)hwndButton,\n    (UINT)BM_SETIMAGE,\n    (WPARAM)IMAGE_BITMAP,\n    (LPARAM)hBmp);\n</code></pre>\n\n<p>I have also tried to set the icon on a smaller subwindow on my button, but for some reason my subwindow is not visible.</p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 2527, "user_id": 3082472, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cfa0eac13a3a42b13990e08e74446fd3?s=128&d=identicon&r=PG&f=1", "display_name": "akraf", "link": "https://stackoverflow.com/users/3082472/akraf"}, "edited": false, "score": 1, "creation_date": 1513772123, "post_id": 47905792, "comment_id": 82778389, "body": "Welcome to Stack Overflow! Great that you gave a reproducible example! However, it is best practice to not link to images of console output but to include it as text. See <a href=\"http://idownvotedbecau.se/imageofcode\" rel=\"nofollow noreferrer\">idownvotedbecau.se/imageofcode</a>"}, {"owner": {"reputation": 25, "user_id": 9122542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3vxuKxUqABw/AAAAAAAAAAI/AAAAAAAAAEw/wUw66rjmJE8/photo.jpg?sz=128", "display_name": "andrE", "link": "https://stackoverflow.com/users/9122542/andre"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1513772241, "post_id": 47905792, "comment_id": 82778450, "body": "@Ron why am i getting random output for the first odd number when i print arr2"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1513772292, "post_id": 47905792, "comment_id": 82778485, "body": "<code>for (i = 1</code> array indexes start at 0."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513772302, "post_id": 47905792, "comment_id": 82778495, "body": "It&#39;s probably because you have an uninitialized element in between. Did you debugging?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1513772340, "post_id": 47905792, "comment_id": 82778510, "body": "OT: it\u2018s <code>int main</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1513772433, "post_id": 47905792, "comment_id": 82778572, "body": "You can use std::partition to do the job."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513772444, "post_id": 47905792, "comment_id": 82778579, "body": "In addition to @manni66: it&#39;s <code>int main()</code> and it should <code>return</code> something (usually <code>0</code> in case of success and anything else otherwise)."}, {"owner": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "edited": false, "score": 0, "creation_date": 1513772453, "post_id": 47905792, "comment_id": 82778588, "body": "Unless there is a requirement from my tutor/professor to use arrays i would use std::vector instead, specially if the number of elements is determined at runtime. That said, I would use a somewhat different  algorithm for creating the second vector. I would keep track of the first and last empty slot to be able to put the even numbers in front and the odd ones at the end."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 2, "creation_date": 1513772510, "post_id": 47905792, "comment_id": 82778619, "body": "@Scheff no, main is not required to return anything."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513772558, "post_id": 47905792, "comment_id": 82778645, "body": "@manni66 I know that for C but thought it&#39;s not true for C++. (Have no spec. at hand.)"}, {"owner": {"reputation": 25, "user_id": 9122542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3vxuKxUqABw/AAAAAAAAAAI/AAAAAAAAAEw/wUw66rjmJE8/photo.jpg?sz=128", "display_name": "andrE", "link": "https://stackoverflow.com/users/9122542/andre"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513772785, "post_id": 47905792, "comment_id": 82778804, "body": "@Scheff i changed it to int main() and return 0; but that doesn&#39;t seem to matter as my problem is when i print the array and the first odd number in arr2 is a random number"}, {"owner": {"reputation": 25, "user_id": 9122542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3vxuKxUqABw/AAAAAAAAAAI/AAAAAAAAAEw/wUw66rjmJE8/photo.jpg?sz=128", "display_name": "andrE", "link": "https://stackoverflow.com/users/9122542/andre"}, "edited": false, "score": 0, "creation_date": 1513773049, "post_id": 47905792, "comment_id": 82778983, "body": "@manni66 i am not allowed to use std::parition, i need a solution for this problem (still a beginner, don&#39;t even know how either)"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1513773052, "post_id": 47905792, "comment_id": 82778987, "body": "@Scheff C++ standard, section 9.6.3.2: &quot;Flowing off the end of a constructor, a destructor, or a function with a cv <code>void</code> return type is equivalent to a return with no operand. Otherwise, flowing off the end of a function <b>other than <code>main</code> (6.6.1)</b> results in undefined behavior.&quot;"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513773068, "post_id": 47905792, "comment_id": 82778997, "body": "The hint about <code>int main</code> was correct but marked as OT (off-topic) as not relevant for your problem. Did you notice my earlier comment &quot;It&#39;s probably because you have an uninitialized element in between. Did you debugging?&quot;? An out-of-bound access could also be the reason e.g. in <code>for (i = 1; i &lt;= temp2; i++)</code> (and watch the <code>o</code>)."}, {"owner": {"reputation": 25, "user_id": 9122542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3vxuKxUqABw/AAAAAAAAAAI/AAAAAAAAAEw/wUw66rjmJE8/photo.jpg?sz=128", "display_name": "andrE", "link": "https://stackoverflow.com/users/9122542/andre"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513773122, "post_id": 47905792, "comment_id": 82779033, "body": "@Scheff Yes it&#39;s a requirement to use arrays in this exercise"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513773181, "post_id": 47905792, "comment_id": 82779068, "body": "Sorry, where did I mention not to use arrays? I recommended to use a debugger (beside of arrays). ;-)"}, {"owner": {"reputation": 25, "user_id": 9122542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3vxuKxUqABw/AAAAAAAAAAI/AAAAAAAAAEw/wUw66rjmJE8/photo.jpg?sz=128", "display_name": "andrE", "link": "https://stackoverflow.com/users/9122542/andre"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513773485, "post_id": 47905792, "comment_id": 82779281, "body": "@Scheff oh my bad i tagged you instead of Johan, i saw that my    o was set at 1 instead of 0 but something is still wrong"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1513773787, "post_id": 47905792, "comment_id": 82779472, "body": "@andrE Did you try stepping through your code with a debugger, as already was suggested, to figure out what?"}, {"owner": {"reputation": 25, "user_id": 9122542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3vxuKxUqABw/AAAAAAAAAAI/AAAAAAAAAEw/wUw66rjmJE8/photo.jpg?sz=128", "display_name": "andrE", "link": "https://stackoverflow.com/users/9122542/andre"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513774437, "post_id": 47905792, "comment_id": 82779918, "body": "@Scheff in debugger it shows arr2[0] and arr2[1] are ok but arr2[2] is not getting any value and instead arr3[3] and arr2[4] are getting values"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513774625, "post_id": 47905792, "comment_id": 82780046, "body": "@andrE So watch the index variables. And be aware that you might access elements which are not initialized or even behind end of array. The latter is <a href=\"https://stackoverflow.com/a/4105123/1505939\">UB</a> but does not mean that process crashs ASAP. Be tough - fight this through in debugger. (I&#39;ve to do this all day...) Btw., my alternative solution (using only one array): <a href=\"https://ideone.com/yj8ljK\" rel=\"nofollow noreferrer\">ideone.com</a>"}, {"owner": {"reputation": 25, "user_id": 9122542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3vxuKxUqABw/AAAAAAAAAAI/AAAAAAAAAEw/wUw66rjmJE8/photo.jpg?sz=128", "display_name": "andrE", "link": "https://stackoverflow.com/users/9122542/andre"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513774629, "post_id": 47905792, "comment_id": 82780051, "body": "@Scheff fixed, temp=j+1 was the problem, should&#39;ve been only temp=j, thank you so much for the help"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513774694, "post_id": 47905792, "comment_id": 82780101, "body": "@Scheff: you are right: 3.6.1 [basic.start.main] says <i>If control reaches the end of main without encountering a return statement, the effect is that of executing <code>return 0;</code></i>"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1513774831, "post_id": 47905792, "comment_id": 82780193, "body": "@SergeBallesta OK. Actually manni66 was the one who knew - I was the one in doubt. Another one stated 6.6.1 but you said 3.6.1. Which one is correct?"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1513774989, "post_id": 47905792, "comment_id": 82780315, "body": "@Scheff: Algirdas Preid\u017eius used C++17 standard when I still use n4296 for C++14. Clauses have been renumbered between those versions."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9122542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3vxuKxUqABw/AAAAAAAAAAI/AAAAAAAAAEw/wUw66rjmJE8/photo.jpg?sz=128", "display_name": "andrE", "link": "https://stackoverflow.com/users/9122542/andre"}, "edited": false, "score": 0, "creation_date": 1513775080, "post_id": 47906593, "comment_id": 82780359, "body": "I would use this as well but i am restricted from using it ( as stupid as it sounds ) and it needs to be stored into a new array."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1513775861, "post_id": 47906593, "comment_id": 82780856, "body": "My even shorter approach for <code>sortingFunction()</code>: <code>bool sortingFunction(int left, int right) { return left % 2 &lt; right % 2; }</code> as requirement was &quot;where evens first odds last&quot;. So, even against even need not to be sorted nor odd against odd."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1513776557, "post_id": 47906593, "comment_id": 82781313, "body": "std::partition would be a better algorithm for that problem."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1513777625, "post_id": 47906593, "comment_id": 82782017, "body": "@manni66 for OP&#39;s copy requirement <a href=\"http://en.cppreference.com/w/cpp/algorithm/partition_copy\" rel=\"nofollow noreferrer\"><code>std::partition_copy</code></a>"}, {"owner": {"reputation": 1605, "user_id": 4179302, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-71QIq2eev8E/AAAAAAAAAAI/AAAAAAAAA0c/KCUZGf1P-7Y/photo.jpg?sz=128", "display_name": "apalomer", "link": "https://stackoverflow.com/users/4179302/apalomer"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513782470, "post_id": 47906593, "comment_id": 82785337, "body": "@Scheff you are completely right! I did not see it when programming my answer."}], "tags": [], "owner": {"reputation": 1605, "user_id": 4179302, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-71QIq2eev8E/AAAAAAAAAAI/AAAAAAAAA0c/KCUZGf1P-7Y/photo.jpg?sz=128", "display_name": "apalomer", "link": "https://stackoverflow.com/users/4179302/apalomer"}, "is_accepted": true, "score": 0, "last_activity_date": 1513775562, "last_edit_date": 1513775562, "creation_date": 1513774560, "answer_id": 47906593, "question_id": 47905792, "link": "https://stackoverflow.com/questions/47905792/from-array-of-evens-and-odds-make-new-array-where-evens-first-odds-last/47906593#47906593", "title": "From array of evens and odds make new array where evens first odds last", "body": "<p>I have not seen where your problem come from. However, there is a much easier way to do this using <a href=\"http://www.cplusplus.com/articles/NhA0RXSz/\" rel=\"nofollow noreferrer\"><code>std::sort</code></a>. Here is how I would do it:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\n\nbool sortingFunction(int left, int right)\n{\n    if (left % 2 == 0 &amp;&amp; right % 2 == 0 || left % 2 != 0 &amp;&amp; right % 2 != 0)\n        return left&lt;right;\n    else if (left % 2 != 0 &amp;&amp; right % 2 == 0)\n        return false;\n    else if (left % 2 == 0 &amp;&amp; right % 2 != 0)\n        return true;\n}\n\nint main()\n{\n    int no;\n    cout &lt;&lt; \"Size of Array: \";\n    cin &gt;&gt; no;\n    int arr[no];\n    cout &lt;&lt; \"Enter any \" &lt;&lt; no &lt;&lt; \" elements in Array: \";\n    for (int i = 0; i&lt;no;i++)\n    {\n        cin &gt;&gt; arr[i];\n    }\n\n    std::sort(arr,arr+no,sortingFunction);\n    for (int i = 0; i&lt; no; i++)\n        cout&lt;&lt;arr[i]&lt;&lt;\" \";\n    cout&lt;&lt;endl;\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4524028, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m9wGkqAxsAY/AAAAAAAAAAI/AAAAAAAAO4Y/grh8mwS5Vso/photo.jpg?sz=128", "display_name": "Naimesh Thakkar", "link": "https://stackoverflow.com/users/4524028/naimesh-thakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1513775900, "creation_date": 1513775900, "answer_id": 47906966, "question_id": 47905792, "link": "https://stackoverflow.com/questions/47905792/from-array-of-evens-and-odds-make-new-array-where-evens-first-odds-last/47906966#47906966", "title": "From array of evens and odds make new array where evens first odds last", "body": "<p>There are two errors</p>\n\n<p>instead of temp = j+1, you should write temp = j.</p>\n\n<p>As you increment j after adding value in arr2, j is already pointing at index after all even numbers.</p>\n\n<p>Second is in third loop you use o as index but it is initialized with 1, it should be initialize with 0.</p>\n\n<p>Your code should be like </p>\n\n<pre><code>void main()\n{\n  int arr[20], odd[20], arr2[20], i, j = 0, k = 0, no, temp, temp2, o = 0;\n  cout &lt;&lt; \"Size of Array: \";\n  cin &gt;&gt; no;\n  cout &lt;&lt; \"Enter any \" &lt;&lt; no &lt;&lt; \" elements in Array: \";\n  for (i = 0; i&lt;no; i++)\n  {\n    cin &gt;&gt; arr[i];\n  }\n  for (i = 0; i&lt;no; i++)\n  {\n    if (arr[i] % 2 == 0)\n    {\n      arr2[j] = arr[i];\n      j++;\n      temp = j;// +1;\n    }\n    else\n    {\n      odd[k] = arr[i];\n      k++;\n      temp2 = k;\n    }\n  }\n\n  cout &lt;&lt; endl;\n  cout &lt;&lt; \"New array:\" &lt;&lt; endl;\n\n  for (i = 1; i &lt;= temp2; i++)\n  {\n    arr2[temp] = odd[o];\n    temp++;\n    o++;\n  }\n\n  for (i = 0; i &lt; no; i++)\n  {\n    cout &lt;&lt; arr2[i] &lt;&lt; endl;\n  }\n  cin &gt;&gt; arr2[0];\n\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9122542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3vxuKxUqABw/AAAAAAAAAAI/AAAAAAAAAEw/wUw66rjmJE8/photo.jpg?sz=128", "display_name": "andrE", "link": "https://stackoverflow.com/users/9122542/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 1, "closed_date": 1513784622, "accepted_answer_id": 47906593, "answer_count": 2, "score": 0, "last_activity_date": 1513775900, "creation_date": 1513771851, "question_id": 47905792, "link": "https://stackoverflow.com/questions/47905792/from-array-of-evens-and-odds-make-new-array-where-evens-first-odds-last", "closed_reason": "Needs details or clarity", "title": "From array of evens and odds make new array where evens first odds last", "body": "<p>Ok, so when I am printing the final array (arr2), the first element that has been copied from odd[] to arr2[] is a random number instead of it being an odd number that was inserted in arr1[]. Here's a picture as an example <a href=\"https://i.gyazo.com/ca33781f03f2d27434b92f295d6cb815.png\" rel=\"nofollow noreferrer\">pic</a> .</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;conio.h&gt;\nusing namespace std;\n\nvoid main()\n{\n    int arr[20], odd[20],arr2[20], i, j = 0, k = 0, no,temp,temp2,o=1;\n    cout &lt;&lt; \"Size of Array: \";\n    cin &gt;&gt; no;\n    cout &lt;&lt; \"Enter any \" &lt;&lt; no &lt;&lt; \" elements in Array: \";\n    for (i = 0; i&lt;no;i++)\n    {\n        cin &gt;&gt; arr[i];\n    }\n    for (i = 0; i&lt;no;i++)\n    {\n        if (arr[i] % 2 == 0)\n        {\n            arr2[j] = arr[i];\n            j++;\n            temp = j+1;\n        }       \n        else\n        {\n            odd[k] = arr[i];\n            k++;\n            temp2 = k;\n        }\n    }\n\n    cout &lt;&lt; endl;\n    cout &lt;&lt; \"New array:\" &lt;&lt; endl;\n\n    for (i = 1; i &lt;= temp2; i++)\n    {\n        arr2[temp] = odd[o];\n        temp++;\n        o++;\n    }\n\n    for (i = 0;i &lt; no;i++)\n    {\n        cout &lt;&lt; arr2[i] &lt;&lt;endl;\n    }\n\n\n}\n</code></pre>\n"}, {"tags": ["c++", "for-loop", "prime-factoring"], "comments": [{"owner": {"reputation": 415, "user_id": 7305358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909955eb7835150dae7bfbfa4e587e23?s=128&d=identicon&r=PG&f=1", "display_name": "Zinki", "link": "https://stackoverflow.com/users/7305358/zinki"}, "edited": false, "score": 4, "creation_date": 1513771817, "post_id": 47905765, "comment_id": 82778185, "body": "can you clarify? You&#39;re saying this code takes forever to <i>compile</i>, but I suspect you mean it takes a long time to <i>execute</i>, right?   Also note that the inner for loop needs to, at most, loop until <code>sqrt(j)</code>, not all the way to <code>j</code>"}, {"owner": {"reputation": 1925, "user_id": 2865757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcfe7782349d59e50b1fa196f9c6669?s=128&d=identicon&r=PG&f=1", "display_name": "Zefick", "link": "https://stackoverflow.com/users/2865757/zefick"}, "edited": false, "score": 1, "creation_date": 1513771924, "post_id": 47905765, "comment_id": 82778260, "body": "You can not check numbers larger than 1414 (sqrt(2000000)) in the second loop. It will be much faster."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1513771960, "post_id": 47905765, "comment_id": 82778288, "body": "In case you are talking about <i>execution</i> time (opposed to compilation time), the answer for &quot;<i>What can I do to fix this?</i>&quot; Would be - picking a better prime detection algorithm. Iterating up until the actual number, is pretty much the worst algorithm there is."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 1925, "user_id": 2865757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcfe7782349d59e50b1fa196f9c6669?s=128&d=identicon&r=PG&f=1", "display_name": "Zefick", "link": "https://stackoverflow.com/users/2865757/zefick"}, "edited": false, "score": 1, "creation_date": 1513772011, "post_id": 47905765, "comment_id": 82778319, "body": "@Zefick Or, to be more precise, to not check the numbers larger than <code>sqrt (j)</code>, in his code."}, {"owner": {"reputation": 1968, "user_id": 846641, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/q1FW7.jpg?s=128&g=1", "display_name": "Philipp", "link": "https://stackoverflow.com/users/846641/philipp"}, "edited": false, "score": 1, "creation_date": 1513772084, "post_id": 47905765, "comment_id": 82778357, "body": "Also have a look at <a href=\"https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes\" rel=\"nofollow noreferrer\">Sieve of Eranthoses</a>"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 2, "creation_date": 1513772104, "post_id": 47905765, "comment_id": 82778375, "body": "@AlgirdasPreid\u017eius Or, even better, replace the <code>k &lt; j</code> condition with <code>k*k &lt; j</code>: Depending on the architecture, <code>sqrt()</code> may take a while to calculate."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513772470, "post_id": 47905765, "comment_id": 82778594, "body": "@cmaster Oh, never thought of it like that. Thank you fir pointing that out. You can learn something new, everyday, even about the simplest of things :)"}], "owner": {"reputation": 111, "user_id": 9122610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eOtsJ.jpg?s=128&g=1", "display_name": "Einstein the troll", "link": "https://stackoverflow.com/users/9122610/einstein-the-troll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513771743, "creation_date": 1513771743, "question_id": 47905765, "link": "https://stackoverflow.com/questions/47905765/c-query-regarding-for-loop-iterations", "title": "C++ query regarding for loop iterations", "body": "<pre><code>int sum = 2;\nlong long j;\nfor (j = 3; j &lt;= 2000000; j+=2){\n    bool stens = true;\n    for (int k = 2; k &lt; j; k++){\n        if (j%k == 0){\n            stens = false;\n            break;}\n        else stens = true;\n    }\n    if (stens){\n        sum += j;\n    }\n}\ncout &lt;&lt; sum &lt;&lt; endl;\ncout &lt;&lt; j &lt;&lt; endl;\n</code></pre>\n\n<p>The above is a piece of C++ code that finds the sum of all prime numbers up to 2 million. However, the program takes forever to compile- I'm assuming this is because it has to iterate too many times (checking for 1 million numbers, and also checking if each one is a prime number). What can I do to fix this? Please note that my coding knowledge is pretty limited- I only started programming a month ago.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "vector", "random"], "comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 2, "creation_date": 1513771781, "post_id": 47905743, "comment_id": 82778164, "body": "<code>std::shuffle</code> then iterate until you find one."}, {"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1513771913, "post_id": 47905743, "comment_id": 82778251, "body": "@iBug <code>std::shuffle</code> will not help the program just condense it."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 2, "creation_date": 1513771987, "post_id": 47905743, "comment_id": 82778304, "body": "@JakeFreeman It&#39;s also fine to create an index array then shuffle the indices."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513772078, "post_id": 47905743, "comment_id": 82778353, "body": "The random approach is good, especially if you can cache the indexes you have already tried so you don&#39;t try them again."}], "answers": [{"comments": [{"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1513772507, "post_id": 47905840, "comment_id": 82778616, "body": "This idea is not that efficient because you are storing 2x memory and it takes time to constantly make sure they are the same"}, {"owner": {"reputation": 186, "user_id": 3246781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8a4df657b8a4d5c9045aa2328276cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard", "link": "https://stackoverflow.com/users/3246781/gerard"}, "reply_to_user": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1513772585, "post_id": 47905840, "comment_id": 82778671, "body": "It takes constant time to maintain  using a hash table. About the memory, yes, it takes memory. but memory is free :D"}], "tags": [], "owner": {"reputation": 186, "user_id": 3246781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8a4df657b8a4d5c9045aa2328276cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard", "link": "https://stackoverflow.com/users/3246781/gerard"}, "is_accepted": true, "score": 6, "last_activity_date": 1513772012, "creation_date": 1513772012, "answer_id": 47905840, "question_id": 47905743, "link": "https://stackoverflow.com/questions/47905743/c-randomly-select-non-empty-element-of-stdvectorstdvector/47905840#47905840", "title": "C++ Randomly select non-empty element of std::vector&lt;std::vector&gt; &gt;", "body": "<p>Maintain an auxiliary vector with the index of the non empty elements and get a random element from there</p>\n"}, {"tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": false, "score": 0, "last_activity_date": 1513772155, "creation_date": 1513772155, "answer_id": 47905874, "question_id": 47905743, "link": "https://stackoverflow.com/questions/47905743/c-randomly-select-non-empty-element-of-stdvectorstdvector/47905874#47905874", "title": "C++ Randomly select non-empty element of std::vector&lt;std::vector&gt; &gt;", "body": "<p>You can first extract an index of what's non-empty, then select one:</p>\n\n<pre><code>std::vector&lt;int&gt; ind;\nfor (int i = 0; i &lt; foo.size(); i++){\n    if (! foo[i].empty()) {\n        ind.push_back(i);\n    }\n}\nint i = rand() % int.size();\nreturn int[i];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2887, "user_id": 2422450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c899826b7012b67268ee1899b40419?s=128&d=identicon&r=PG", "display_name": "Lanting", "link": "https://stackoverflow.com/users/2422450/lanting"}, "is_accepted": false, "score": 2, "last_activity_date": 1513772947, "creation_date": 1513772947, "answer_id": 47906104, "question_id": 47905743, "link": "https://stackoverflow.com/questions/47905743/c-randomly-select-non-empty-element-of-stdvectorstdvector/47906104#47906104", "title": "C++ Randomly select non-empty element of std::vector&lt;std::vector&gt; &gt;", "body": "<p>You could build an index of the nonempty elements:</p>\n\n<pre><code>std::vector&lt;std::vector&lt;double&gt; &gt; foo;\nstd::vector&lt;decltype (foo)::iterator&gt; nonempty;\nfor (auto it = foo.begin(); it != foo.end; ++it)\n{\n  if (! it-&gt;empty())\n  {\n    nonempty.push_back(it);\n  }\n}\nstd::random_device rd;\n// random-number engine used (Mersenne-Twister in this case) \nstd::mt19937 rng(rd());\n// create a guaranteed unbiased index (unlike using modulo on rand)\nstd::uniform_int_distribution&lt;size_t&gt; uni_idx_dist(0,nonempty.size() - 1); \n\nauto &amp;random_nonempty = *nonempty[uni_idx_dist(rng)];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4569, "user_id": 1282773, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/GFxGD.jpg?s=128&g=1", "display_name": "ivaigult", "link": "https://stackoverflow.com/users/1282773/ivaigult"}, "is_accepted": false, "score": 0, "last_activity_date": 1513777624, "creation_date": 1513777624, "answer_id": 47907504, "question_id": 47905743, "link": "https://stackoverflow.com/questions/47905743/c-randomly-select-non-empty-element-of-stdvectorstdvector/47907504#47907504", "title": "C++ Randomly select non-empty element of std::vector&lt;std::vector&gt; &gt;", "body": "<p>You could build a vector of references to non empty vectors.</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;functional&gt;\n#include &lt;iterator&gt;\n#include &lt;random&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nint main() {\n    using int_vec_t = std::vector&lt;int&gt;;\n    std::vector&lt;int_vec_t&gt; v = {\n        {0, 1, 2}, {}, {}, {3, 4, 5},\n        {}, {6, 7, 8}, {}, {}, {9}, {10, 11}\n    };\n\n    // You can't put reference direcly, so use reference_wrapper instead\n    std::vector&lt;std::reference_wrapper&lt;int_vec_t&gt; &gt; nonempty;\n    nonempty.reserve(v.size());\n    // \"copy\" non empty vectors. (Doesn't do copy, actually)\n    std::copy_if(v.begin(), v.end(), std::back_inserter(nonempty), [](const int_vec_t&amp; v) { return !v.empty();});\n    if (nonempty.empty())\n        return 0;\n    // pick an element\n    static std::random_device rd;\n    static std::mt19937 gen(rd());\n    std::uniform_int_distribution&lt;&gt; dis(0, nonempty.size() - 1);\n    const int_vec_t&amp; result = nonempty[dis(gen)];\n    // dump result\n    std::copy(result.begin(), result.end(), std::ostream_iterator&lt;int&gt;(std::cout, \", \"));\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": false, "score": 0, "last_activity_date": 1513779240, "creation_date": 1513779240, "answer_id": 47907972, "question_id": 47905743, "link": "https://stackoverflow.com/questions/47905743/c-randomly-select-non-empty-element-of-stdvectorstdvector/47907972#47907972", "title": "C++ Randomly select non-empty element of std::vector&lt;std::vector&gt; &gt;", "body": "<p>There are a couple problems here:</p>\n\n<ol>\n<li>The ordinal <code>vector</code> is sparsely populated</li>\n<li><a href=\"https://stackoverflow.com/q/38244435/2642059\">A <code>vector</code> of <code>vector</code>s is wateful</a></li>\n</ol>\n\n<p>To solve problem <strong>1</strong> I'd recomend the use of a <code>map&lt;size_t, vector&lt;double&gt;&gt; foo</code> this will allow you to use non-linear indices, but it won't require the population of the intervening empty <code>vector</code>s. Selection of a random populated element here just involves advancing the iterator to point to the appropriate element. For example <code>result</code> will be the const-iterator to a random key-value <code>pair</code> in <code>foo</code>:</p>\n\n<pre><code>const auto idx = foo.empty() ? 0U : std::mt19937{std::random_device{}()}() % size(foo);\nconst auto result = next(cbegin(foo), idx);\n</code></pre>\n\n<p>The solution to <strong>1</strong> and <strong>2</strong> would be a bit more elaborate, as I'd recommend doing away with <code>vector</code>s all together in favor of <code>multimap&lt;size_t, double&gt; foo</code> This contains all the benefits of the <code>map</code> solution, but the trade off is that the keys must be iterated using <code>upper_bound</code>. Additionally, because <code>multimap</code> does not store a key count, <code>size_t keyCount</code> would need to be maintained alongside the <code>multimap</code>. Or presuming it was a temporary initialized to <code>0U</code> it could be wastefully found at the time it is needed: <code>for(auto it = cbegin(foo); it != cend(foo); it = foo.upper_bound(it-&gt;first)) ++keyCount;</code> Using <code>keyCount</code> we can again find <code>result</code> which here will be an const-iterator to the first of the elements matching the random key:</p>\n\n<pre><code>int idx = keyCount == 0U ? 0 : std::mt19937{std::random_device{}()}() % keyCount;\nauto result = cbegin(foo);\n\nwhile(idx-- &gt; 0) result = foo.upper_bound(result-&gt;first);\n</code></pre>\n"}], "owner": {"reputation": 326, "user_id": 2536076, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7c9410b3c0b763c8605cd72cabeac43a?s=128&d=identicon&r=PG", "display_name": "Flo Ryan", "link": "https://stackoverflow.com/users/2536076/flo-ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 47905840, "answer_count": 5, "score": 1, "last_activity_date": 1513779240, "creation_date": 1513771655, "question_id": 47905743, "link": "https://stackoverflow.com/questions/47905743/c-randomly-select-non-empty-element-of-stdvectorstdvector", "title": "C++ Randomly select non-empty element of std::vector&lt;std::vector&gt; &gt;", "body": "<p>I am given a large vector that itself contains vectors of a specific data type e.g. <code>std::vector&lt;std::vector&lt;double&gt; &gt; foo</code>. I am trying to retrieve a random element foo[idx] from foo such that <code>foo[idx]</code> is non-empty or respectively <code>foo[idx].empty() == false</code>.</p>\n\n<p>My naive guess would be to select random elements from <code>foo</code> until my constraint <code>foo[idx].empty() == false</code> is fulfilled. </p>\n\n<p>However it is very likely the case that <code>foo</code> is very sparsely filled with non-empty vectors. Hence, my approach would quite likely be devastatingly slow.</p>\n\n<p>Are there better approaches or should i think of a completely different data structure? </p>\n"}, {"tags": ["c++", "constexpr", "overload-resolution"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1513771790, "post_id": 47905686, "comment_id": 82778174, "body": "Add a <code>template &lt;class = void&gt;</code> to the second overload and you&#39;ll get an error that&#39;s more insightful :)"}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1513771913, "post_id": 47905686, "comment_id": 82778253, "body": "Overload resolution prefers non-<code>template</code> functions. I don\u2019t recall the exact rule, though."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1513772638, "post_id": 47905686, "comment_id": 82778706, "body": "@DietmarK&#252;hl: but isn&#39;t the non-<code>template</code> function a worse candidate due to the required decay?"}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 1, "creation_date": 1513773239, "post_id": 47905686, "comment_id": 82779116, "body": "@VittorioRomeo: I just trawled through the standard and I think I unearthed what makes the function the better match (see my answer)."}], "answers": [{"comments": [{"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1513773257, "post_id": 47906163, "comment_id": 82779138, "body": "<i>&quot;An exact match and array to pointer conversion have the same rank&quot;</i> - that seems oddly specific. Why is that rule in place?"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1513773434, "post_id": 47906163, "comment_id": 82779251, "body": "16.3.3. is <code>The ## operator</code> in <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3690.pdf\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3690.pdf</a>"}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1513773522, "post_id": 47906163, "comment_id": 82779302, "body": "@VittorioRomeo: I\u2019m not Core person - you\u2019d need to ask one of these! Sadly, the standard doesn\u2019t have a rationale. My <i>guess</i> is that it was intentional to avoid template \u201cstealing\u201doverloads by chance but my guess is as good as anybody else\u2019s."}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1513773710, "post_id": 47906163, "comment_id": 82779416, "body": "@JVApen: the current official standard is C++17 and certainly not anything predating even C++14. I did provide stable references, too, for those who consider it opportune to match things against outdated documents."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1513773752, "post_id": 47906163, "comment_id": 82779452, "body": "Found it, is 13.3.3 in that draft."}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1513773909, "post_id": 47906163, "comment_id": 82779555, "body": "@JVApen: due to some ISO rules three chapters needed to be aded close to the front, i.e., the numbers are generally shifted by 3 between C++14 and C++17. Messes with everybody..."}], "tags": [], "owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "is_accepted": true, "score": 2, "last_activity_date": 1513773147, "creation_date": 1513773147, "answer_id": 47906163, "question_id": 47905686, "link": "https://stackoverflow.com/questions/47905686/overload-resolution-c-style-strings/47906163#47906163", "title": "Overload resolution C-style strings", "body": "<p>An exact match and array to pointer conversion have the same rank according to 16.3.3.1.1 [over.ics.scs]/Table 13. A matching non-<code>template</code> is preferred over a matching <code>template</code> according to 16.3.3 [over.best.match]. In summary, the non-template function taking a <code>char const*</code> is the better match.</p>\n\n<p>Making this function a <code>template</code>, e.g., by giving it a defaulted <code>template</code> parameter may solve the problem. It has a fair chance to make the two function ambiguous.</p>\n"}], "owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 47906163, "answer_count": 1, "score": 1, "last_activity_date": 1513773147, "creation_date": 1513771482, "question_id": 47905686, "link": "https://stackoverflow.com/questions/47905686/overload-resolution-c-style-strings", "title": "Overload resolution C-style strings", "body": "<p>Would it be possible to explain why the following code ain't working as expected? In this case, I would assume that both static_asserts would pass, though the one indicated with <code>Failed</code> doesn't seem to be taken.</p>\n\n<p>My understanding of overload resolution would be that the type most closely linked to the argument. As the top definition is a C-Style array, while the bottom definition is a decayed char*; I find it strange that the select overload gets used.</p>\n\n<p>Both MSVC as Clang seem to have the same behavior.</p>\n\n<pre><code>error: static_assert expression is not an integral constant expression\nnote: non-constexpr function 'getStrLen' cannot be used in a constant expression\n</code></pre>\n\n<p>The code:</p>\n\n<pre><code>template&lt;size_t N&gt;\nconstexpr auto getStrLen(const char(&amp;str)[N])\n    {\n    static_assert(N != 0, \"Every literal string should have a null terminator\");\n    return N - 1; // Remove \\0\n   }\nstatic_assert(getStrLen(\"\") == 0, \"Success\");\n\nauto getStrLen(const char *str)\n    {\n   return strlen(str);\n    }\n\nstatic_assert(getStrLen(\"\") == 0, \"Failed\");\n</code></pre>\n"}]