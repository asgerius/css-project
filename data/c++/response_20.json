[{"tags": ["c++", "winapi", "console", "stdio", "createprocess"], "comments": [{"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1432773064, "post_id": 30494945, "comment_id": 49068132, "body": "One workaround, if it turns out that the posted answers don&#39;t work: instead of launching <code>program.exe</code> launch <code>cmd.exe &#47;c program.exe &gt;CON &lt;CON</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2827, "user_id": 3931225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/46nwm.gif?s=128&g=1", "display_name": "KompjoeFriek", "link": "https://stackoverflow.com/users/3931225/kompjoefriek"}, "is_accepted": false, "score": 1, "last_activity_date": 1432772395, "creation_date": 1432772395, "answer_id": 30495232, "question_id": 30494945, "link": "https://stackoverflow.com/questions/30494945/createprocess-with-new-console-window-but-override-some-std-i-o-handles/30495232#30495232", "title": "CreateProcess with new console window, but override some std i/o handles", "body": "<p>If i interpreted <a href=\"https://support.microsoft.com/en-us/kb/190351\" rel=\"nofollow\">this documentation</a> correctly, you should use <code>GetStdHandle(STD_INPUT_HANDLE)</code> and <code>GetStdHandle(STD_OUTPUT_HANDLE)</code> for the other two handles.</p>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1432773157, "post_id": 30495247, "comment_id": 49068155, "body": "If you create a new console for the child, the child will use the input/output of that console by default. If the parent wants the child to inherit the parent&#39;s input, the parent has to redirect the child&#39;s input. The parent can detect if its own input was redirected and then pass that along to the child if desired. The child cannot decide that."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1432773732, "post_id": 30495247, "comment_id": 49068281, "body": "<code>GetStdHandle(STD_INPUT_HANDLE)</code> returns a handle to the calling process&#39;s current input. If the input has NOT been redirected, the handle will refer to <code>CONIN$</code> - the standard input of the current console. If a child process receives that handle for its input, it will read from the standard input of whichever console it happens to be running in. On the other hand, if the parent&#39;s input HAS been redirected, the handle will be an actual handle to a real file/pipe/etc which the child can inherit and read from.  Same goes for output (the default output handle referring to <code>CONOUT$</code>)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1432774180, "post_id": 30495247, "comment_id": 49068373, "body": "This is covered in more detail in the <code>Remarks</code> section of the  <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms683231.aspx\" rel=\"nofollow noreferrer\"><code>GetStdHandle()</code> documentation</a>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1432775918, "post_id": 30495247, "comment_id": 49068733, "body": "&quot;explicitly opening CONIN$ works <i>if and only if</i> your standard input is redirected&quot; - that is not true. I just did a test where a console process without redirected input was able to open <code>CONIN$</code> without error. And I canot find anything on MSDN that says being able to open <code>CONIN$</code> is conditional upon STDIN being redirected first."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1432776594, "post_id": 30495247, "comment_id": 49068877, "body": "I think you should add that bit from the Remarks section of GetStdHandle() to your answer as it more directly addresses the question."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1432790973, "post_id": 30495247, "comment_id": 49072580, "body": "Let&#39;s think about this. If the parent&#39;s STDIN is not redirected and you open the parent&#39;s <code>CONIN$</code> and pass it to the child, then you have two processes reading from the same input of the same console. How would that work if you use <code>CREATE_NEW_CONSOLE</code>? When the user types into the parent console, who gets the input? The parent? The child? Both? When using <code>CREATE_NEW_CONSOLE</code>, I think it makes sense that the child should only be able to use <code>CONIN$</code> of its own console, or redirected input from a file/pipe/etc."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1432871457, "post_id": 30495247, "comment_id": 49115932, "body": "Comments deleted.  See my answer; the observed behaviour is rather odd."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 5, "last_activity_date": 1432778833, "last_edit_date": 1432778833, "creation_date": 1432772483, "answer_id": 30495247, "question_id": 30494945, "link": "https://stackoverflow.com/questions/30494945/createprocess-with-new-console-window-but-override-some-std-i-o-handles/30495247#30495247", "title": "CreateProcess with new console window, but override some std i/o handles", "body": "<p>According to this MSDN Support article:</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/kb/190351\" rel=\"nofollow\">How to spawn console processes with redirected standard handles</a></p>\n\n<blockquote>\n  <p><strong>If the parent process only wishes to redirect one or two standard handles, specifying GetStdHandle() for the specific handles causes the child to create the standard handle as it normally would without redirection.</strong> For example, if the parent process only needs to redirect the standard output and error of the child process, then the hStdInput member of the STARTUPINFO structure is filled as follows: </p>\n\n<pre><code>hStdInput = GetStdHandle(STD_INPUT_HANDLE);\n</code></pre>\n</blockquote>\n\n<p>According to the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms683231.aspx\" rel=\"nofollow\"><code>GetStdHandle()</code> documentation</a>:</p>\n\n<blockquote>\n  <p>STD_INPUT_HANDLE<br>\n  (DWORD)-10<br> \n  The standard input device. <strong>Initially, this is the console input buffer, CONIN$</strong>.</p>\n  \n  <p>STD_OUTPUT_HANDLE<br>\n  (DWORD)-11<br>\n  The standard output device. <strong>Initially, this is the active console screen buffer, CONOUT$</strong>.</p>\n  \n  <p>STD_ERROR_HANDLE<br>\n  (DWORD)-12<br>\n  The standard error device. <strong>Initially, this is the active console screen buffer, CONOUT$</strong>.</p>\n  \n  <p>...</p>\n  \n  <p>The standard handles of a process may be redirected by a call to SetStdHandle, in which case GetStdHandle returns the redirected handle. If the standard handles have been redirected, you can specify the CONIN$ value in a call to the CreateFile function to get a handle to a console's input buffer. Similarly, you can specify the CONOUT$ value to get a handle to a console's active screen buffer.</p>\n  \n  <p><strong>Attach/detach behavior</strong></p>\n  \n  <p><strong>When attaching to a new console, standard handles are always replaced with console handles unless STARTF_USESTDHANDLES was specified during process creation.</strong></p>\n  \n  <p><strong>If the existing value of the standard handle is NULL, or the existing value of the standard handle looks like a console pseudohandle, the handle is replaced with a console handle.</strong></p>\n  \n  <p><strong>When a parent uses both CREATE_NEW_CONSOLE and STARTF_USESTDHANDLES to create a console process, standard handles will not be replaced unless the existing value of the standard handle is NULL or a console pseudohandle.</strong></p>\n</blockquote>\n\n<p>So, if the parent process's STDIN has NOT been redirected, <code>GetStdHandle(STD_INPUT_HANDLE)</code> will return either NULL or a pseudo-handle that refers to <code>CONIN$</code>. When that value is passed to the child process via <code>STARTUPINFO</code>, the child process will receive a console handle for the STDIN of whichever console it happens to be running in.  On the other hand, if the parent process's STDIN has been redirected, <code>GetStdHandle(STD_INPUT_HANDLE)</code> will return an actual handle to a real file/pipe/etc, which the child will inherit and access.</p>\n\n<p>The same applies to STDOUT and STDERR.</p>\n\n<p>So, if you want to redirect the child's STDIN/OUT/ERR handles, you have to set <code>hStdInput/Output/Error</code> to your own handles.  If you want the child to receive default handles, use <code>GetStdHandle()</code> and let <code>CreateProcess()</code> decide what kind of handles the child receives based on whether the parent is itself being redirected or not.</p>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1432875569, "post_id": 30520800, "comment_id": 49116956, "body": "On my Win7 machine, calling <code>CreateFile(&quot;CONOUT$&quot;, ...)</code> in a console process without redirected output does not return 7. As a test, I called <code>CreateFile()</code> twice and always got <code>0x00000017</code> and <code>0x0x0000001B</code>, respectively. <code>GetStdHandle(STD_OUTPUT_HANDLE)</code> returns <code>0x00000007</code> without redirection. That matches with Microsoft&#39;s recommendation in the <a href=\"https://support.microsoft.com/en-us/kb/190351\" rel=\"nofollow noreferrer\">&quot;How to spawn console processes with redirected standard handles&quot;</a> article, and with your comment that passing 7 with <code>STARTF_USESTDHANDLES</code> makes the child process use its own console&#39;s output."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 2, "creation_date": 1432895877, "post_id": 30520800, "comment_id": 49128134, "body": "Prior to Windows 8, console buffer handles are created by the console host process, conhost.exe (or csrss.exe prior to Win7), which maintains a per-process handle table. (The lower 2 bits are always set, which tags them for the base API to redirect calls to corresponding LPC-enabled functions such as <code>DuplicateConsoleHandle</code>.) Since it&#39;s a new console window, it should be safe to assume conhost.exe will initialize the handle table to 3 for the input buffer and 7 and 11 for the output and error."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 2, "creation_date": 1432895955, "post_id": 30520800, "comment_id": 49128168, "body": "Prior to Windows 8, opening the pseudo devices <code>CON</code>, <code>CONIN$</code>, and <code>CONOUT$</code> redirects to the undocumented function <code>OpenConsoleW</code>. This uses LPC to call <code>conhost!SrvOpenConsole</code> in the console host process, which calls <code>conhost!AllocateIoHandle</code> to allocate a new handle for a console buffer."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 2, "creation_date": 1432896126, "post_id": 30520800, "comment_id": 49128284, "body": "Windows 8 uses the console device, <code>\\Device\\ConDrv</code>. This provides virtual files such as <code>Connect</code>, <code>Input</code>, <code>Output</code>, and <code>ScreenBuffer</code>. Additionly the Win32 device namespace has symbolic links such as <code>\\Global??\\CONIN$</code> <code>=&gt;</code> <code>\\Device\\ConDrv\\CurrentIn</code>. Handles for console files are created by the object manager, like any other kernel objects. This allows the console API to be implemented in terms of the I/O system services <code>NtReadFile</code>, <code>NtWriteFile</code>, and <code>NtDeviceIoControlFile</code> instead of using LPC."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1432896997, "post_id": 30520800, "comment_id": 49128876, "body": "For creating a new console with partially redirected standard handles, it works to use the Win7-style handles 3, 7, and 11 in Windows 8. Actually, using any handle value with the lower 2 bits set (i.e. the old console handle tag) or <code>NULL</code> (as noted by the OP and in the docs) also works in Windows 8. Just to be clear though, console buffer handles in Windows 8 do not have the lower 2 bits set, and they&#39;re present in the process handle table. They get created by the object manager like any other handle, unlike in Windows 7 for which they&#39;re created by the console host process."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1432910267, "post_id": 30520800, "comment_id": 49138233, "body": "@Remy: yes, that matches my observations.  I think you&#39;ll find that if you close the standard output handle first, then opening CONOUT$ will return 7."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1432910499, "post_id": 30520800, "comment_id": 49138404, "body": "@eryksun: well, that explains why it all works so much better on Windows 8!  What a mess.  Oh, well, I guess it&#39;s not all <i>that</i> long until Windows 7 drops out of support ... :-)"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1432922668, "post_id": 30520800, "comment_id": 49146065, "body": "Here&#39;s another Windows 7 console gripe. The Windows 8 device driver allows writing any sized buffer to the console, whereas in Windows 7 the LPC-based implementation limits the buffer size to be no bigger than the largest block in the heap of shared memory (64K at best). LPC uses shared memory to pass large messages between processes. This system wasn&#39;t designed with I/O in mind. It was designed to efficiently communicate realtively small messages over LPC ports (not shared memory) to and from user-mode subsystems such as csrss.exe and lsass.exe."}, {"owner": {"reputation": 2325, "user_id": 7194773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rg9K2.png?s=128&g=1", "display_name": "Lewis Kelsey", "link": "https://stackoverflow.com/users/7194773/lewis-kelsey"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1616084854, "post_id": 30520800, "comment_id": 117898678, "body": "@ErykSun on my windows 7, redirection to a file only works if <code>cmd &#47;c</code> doesn&#39;t open a new conhost.exe, so using <code>cmd &#47;c consoleapp.exe &gt; out.txt</code> or <code>start &#47;b cmd &#47;c consoleapp.exe &gt; out.txt </code> works but <code>start cmd &#47;c consoleapp.exe &gt; out.txt</code> or <code>admin &#47;c consoleapp.exe &gt; out.txt</code> does not."}], "tags": [], "owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "is_accepted": false, "score": 2, "last_activity_date": 1432871370, "creation_date": 1432871370, "answer_id": 30520800, "question_id": 30494945, "link": "https://stackoverflow.com/questions/30494945/createprocess-with-new-console-window-but-override-some-std-i-o-handles/30520800#30520800", "title": "CreateProcess with new console window, but override some std i/o handles", "body": "<p>On Windows 7, at least, the <a href=\"https://support.microsoft.com/en-us/kb/190351\" rel=\"nofollow\">documentation here</a> (as quoted by the existing answers) is misleading.  The recommended approach only works if the parent process does not have redirected input.</p>\n\n<p>This is the actual behaviour, as observed on my machine:</p>\n\n<ul>\n<li><p>When a process opens a handle to CONOUT$ (for example) the returned handle always has the same numeric value (on my machine, the handle for CONOUT$ is always 7) unless that handle already exists.</p></li>\n<li><p>So if you are a console process, and you were not launched with redirected output, your standard output handle is 7.  If you open another handle to CONOUT$, it will have a different value.  If you close handle 7, and then open a handle to CONOUT$, you'll get 7 again.</p></li>\n<li><p>When a console process is launched, a handle to CONOUT$ with the magic value of 7 is usually present in the child process (regardless of redirection).  If you have used <code>STARTF_USESTDHANDLES</code>, then the child's standard output will go to the console if and only if you specify 7 as the standard output handle.  If you specify a handle to CONOUT$ that has any other value, it won't work.</p></li>\n<li><p>Sometimes when a console process is launched with standard output redirected, there is no handle to CONOUT$ present in the child process.  In particular, this happens when <code>cmd.exe</code> launches a console process with standard output redirected.  So far, I have been unable to figure out what combination of parameters to use with CreateProcess to make this happen.</p></li>\n<li><p>The behaviour of CONIN$ is analogous; on my machine, the magic value for CONIN$ is 3.  (I haven't investigated how standard error works.)</p></li>\n</ul>\n\n<p>The upshot is that I do not believe it is safe to make use of this behaviour unless you have complete control over the way the parent process was launched, because unless the standard handles already point to the console there is no reliable way of obtaining a handle to the console with the correct magic value.</p>\n\n<p>Instead, launch a proxy process with <code>CREATE_NEW_CONSOLE</code> and <em>without</em> <code>STARTF_USESTDHANDLES</code>.  From <em>that</em> process, since you know how it was launched, you know the standard handles will have the correct magic values, so it is safe to specify them as the handles for a child process.</p>\n"}], "owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4110, "favorite_count": 3, "accepted_answer_id": 30495247, "answer_count": 3, "score": 6, "last_activity_date": 1432871370, "creation_date": 1432770175, "question_id": 30494945, "link": "https://stackoverflow.com/questions/30494945/createprocess-with-new-console-window-but-override-some-std-i-o-handles", "title": "CreateProcess with new console window, but override some std i/o handles", "body": "<p>If you use CreateProcess with the flag CREATE_NEW_CONSOLE, the new process has its standard input, output, and error handles directed to the new console window.  If you want to override the I/O streams, you can do so by setting the handles in STARTUPINFO fields hStdOutput, hStdInput, and hStdError and setting the flag STARTF_USESTDHANDLES.</p>\n\n<p>But what if you want to override only one of the handles?  For example, I might want to redirect stderr to a file while leaving the stdout and stdin connected to the new console window.</p>\n\n<p>The STARTF_USESTDHANDLES flag tells CreateProcess to replace all of the handles instead of connecting them to the ones for the new console window.  So it seems we must provide all three handles.  Obviously I can set hStdError to the handle of the log file, but what values should be used for hStdInput and hStdOutput?</p>\n\n<p>I tried using NULL, which seems to work on Windows 8.1, but it doesn't work on Windows 7.</p>\n\n<p>I also thought about creating a console window first, and then calling CreateProcess with handles to the new console window's buffers (and omitting the CREATE_NEW_CONSOLE flag).  Unfortunately, the parent process is also a console application, and it seems a console application cannot create a second console window.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 1, "creation_date": 1432768839, "post_id": 30494733, "comment_id": 49067010, "body": "Please back this with a screenshot ... And show us what profile is made of"}, {"owner": {"reputation": 6874, "user_id": 1942027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc12ed2dd9e8cf4e2fe7c33e65c75210?s=128&d=identicon&r=PG&f=1", "display_name": "user1942027", "link": "https://stackoverflow.com/users/1942027/user1942027"}, "edited": false, "score": 1, "creation_date": 1432768998, "post_id": 30494733, "comment_id": 49067055, "body": "I&#39;d bet on it simply being random bytes at the end of <code>password</code> and <code>name</code> since you write all of their data, setting their first byte to <code>\\0</code> doesn&#39;t help here. It&#39;d probably go away if you completely zero it out."}, {"owner": {"reputation": 35, "user_id": 4933159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b76ef77ff9f6469b0b15ca64362d73?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4933159/bryan"}, "edited": false, "score": 0, "creation_date": 1432769015, "post_id": 30494733, "comment_id": 49067063, "body": "<a href=\"http://postimg.org/image/upqayryr3/\" rel=\"nofollow noreferrer\">postimg.org/image/upqayryr3</a>"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432769023, "post_id": 30494733, "comment_id": 49067065, "body": "Your program has undefined behaviour, since you are reading from uninitialized objects."}, {"owner": {"reputation": 35, "user_id": 4933159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b76ef77ff9f6469b0b15ca64362d73?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4933159/bryan"}, "reply_to_user": {"reputation": 6874, "user_id": 1942027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc12ed2dd9e8cf4e2fe7c33e65c75210?s=128&d=identicon&r=PG&f=1", "display_name": "user1942027", "link": "https://stackoverflow.com/users/1942027/user1942027"}, "edited": false, "score": 0, "creation_date": 1432769051, "post_id": 30494733, "comment_id": 49067072, "body": "@RaphaelMiedl, How can I fix this?"}, {"owner": {"reputation": 35, "user_id": 4933159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b76ef77ff9f6469b0b15ca64362d73?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4933159/bryan"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432769067, "post_id": 30494733, "comment_id": 49067076, "body": "@KerrekSB,  so what should I do to fix this?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1432769105, "post_id": 30494733, "comment_id": 49067088, "body": "@Bryan: Understand what <code>fwrite</code> does and use it with deliberation and purpose?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4933159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b76ef77ff9f6469b0b15ca64362d73?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4933159/bryan"}, "edited": false, "score": 0, "creation_date": 1432769542, "post_id": 30494793, "comment_id": 49067246, "body": "Your first part solved it for me, I&#39;ll accept your answer as soon as it lets me."}, {"owner": {"reputation": 35, "user_id": 4933159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b76ef77ff9f6469b0b15ca64362d73?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4933159/bryan"}, "edited": false, "score": 0, "creation_date": 1432769809, "post_id": 30494793, "comment_id": 49067330, "body": "One quick question, how can I put a &#39;#&#39; after the data[i].password."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 35, "user_id": 4933159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b76ef77ff9f6469b0b15ca64362d73?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4933159/bryan"}, "edited": false, "score": 0, "creation_date": 1432770454, "post_id": 30494793, "comment_id": 49067494, "body": "@Bryan Immediately after the last valid character or after the entire field?"}, {"owner": {"reputation": 35, "user_id": 4933159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b76ef77ff9f6469b0b15ca64362d73?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4933159/bryan"}, "edited": false, "score": 0, "creation_date": 1432771236, "post_id": 30494793, "comment_id": 49067694, "body": "At the end, should I just use another data[i].seperator? or is their an easier way?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 35, "user_id": 4933159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b76ef77ff9f6469b0b15ca64362d73?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4933159/bryan"}, "edited": false, "score": 0, "creation_date": 1432772454, "post_id": 30494793, "comment_id": 49067993, "body": "@Bryan What you have is much easier until formatting the data, like inserting a character after a field of uncertain length, comes into play, and then it loses usefulness really quickly. The better way can&#39;t be explained in a 500 character comment block. Read up on using fstream, do it right and you can have stuff that works just like cin and cout do when reading from the console."}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": true, "score": 3, "last_activity_date": 1432769140, "creation_date": 1432769140, "answer_id": 30494793, "question_id": 30494733, "link": "https://stackoverflow.com/questions/30494733/c-why-does-this-write-in-japanese/30494793#30494793", "title": "C++ Why Does this Write in Japanese?", "body": "<p><code>data[i].name[0] = 0;</code> sets the first element of what I presume to be a character array to 0. It does absolutely nothing with the rest of the character array. Whatever random crap was in the rest of the character array is still there.</p>\n\n<p><code>fwrite (data, sizeof(data), 1 , streaming);</code> will mindlessly write the everything inside the array of profile structures, including all of the random crap after the first element of the <code>name</code> and <code>password</code> arrays inside each profile. </p>\n\n<p>To completely clear the profiles, assuming there is nothing in profile that will respond badly to memset, try</p>\n\n<p><code>memset(data, 0, sizeof(data));</code></p>\n\n<p>Don't bother asking your doctor. Post your profile structure and we'll know for sure if memset is right for you.</p>\n"}], "owner": {"reputation": 35, "user_id": 4933159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b76ef77ff9f6469b0b15ca64362d73?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4933159/bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 30494793, "answer_count": 1, "score": -4, "last_activity_date": 1432769140, "creation_date": 1432768736, "question_id": 30494733, "link": "https://stackoverflow.com/questions/30494733/c-why-does-this-write-in-japanese", "title": "C++ Why Does this Write in Japanese?", "body": "<p>I have my code which writes data into a text file. My problem is for some odd reason, it writes in Japanese! Obviously I cannot read Japanese, but how can I write it into a regular text format. Pretend the data[i].name and password have a char [10] value. And they already write in the file, the problem is the language it writes in. </p>\n\n<pre><code>// variables\nFILE *streaming; \nconst int amount = 5;\nprofile data[5];\n\nif (!(streaming = fopen(\"Profiles.txt\",  \"r\" )))\n    {\n        for (int i = 0; i &lt; amount; i++)\n        {\n            data[i].name[0] = 0;\n            data[i].password[0] = 0;\n        }\n        streaming = fopen( \"Profiles.txt\", \"wb\" );\n        fwrite (data, sizeof(data), 1 , streaming); \n        fclose (streaming);\n    }\n</code></pre>\n"}, {"tags": ["c++", "operator-overloading", "overloading"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1432768490, "post_id": 30494679, "comment_id": 49066917, "body": "You need to spell your getter call like this: <code>const_cast&lt;const array&amp;&gt;(a)[0]</code> etc."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1432768532, "post_id": 30494679, "comment_id": 49066929, "body": "Did you mean to say &quot;The problem is that it is just using the <i>setter</i> version&quot; ?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1432768698, "post_id": 30494679, "comment_id": 49066974, "body": "Also it would be good if you can explain what you are trying to achieve; if you leave aside the <code>cout</code> lines then the code performs the addition correctly"}, {"owner": {"reputation": 13384, "user_id": 451600, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/qYIUW.jpg?s=128&g=1", "display_name": "Captain Giraffe", "link": "https://stackoverflow.com/users/451600/captain-giraffe"}, "edited": false, "score": 0, "creation_date": 1432768778, "post_id": 30494679, "comment_id": 49066997, "body": "IMO, OP is having some language difficulties in the last paragraph. He expects the const operator to be used, he finds the non-const being executed."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1432769973, "post_id": 30494679, "comment_id": 49067381, "body": "Forgive the C programmer here, but can the compiler even select the correct overloaded function based on a different return type? I&#39;ve been operating under the belief that the only thing that mattered were the function&#39;s parameters."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1432771244, "post_id": 30494679, "comment_id": 49067696, "body": "@user4581301 Not different return type, different <code>const</code> qualifier."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1432772254, "post_id": 30494679, "comment_id": 49067946, "body": "Thanks @Barry . Will do some reading and probably ask a question or two later."}], "answers": [{"tags": [], "owner": {"reputation": 13384, "user_id": 451600, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/qYIUW.jpg?s=128&g=1", "display_name": "Captain Giraffe", "link": "https://stackoverflow.com/users/451600/captain-giraffe"}, "is_accepted": false, "score": 0, "last_activity_date": 1432769168, "creation_date": 1432769168, "answer_id": 30494799, "question_id": 30494679, "link": "https://stackoverflow.com/questions/30494679/c-operator-overload-not-responding/30494799#30494799", "title": "C++ operator [] overload not responding", "body": "<p>In short</p>\n\n<pre><code>void f(const array&amp; b){\n     std::cout &lt;&lt; b[2] &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>b is required to be const.  All that is available is the const functions. </p>\n\n<p>In your example it is a \"read\" but <em>b</em> is not const so the non-const is called. It is using the \"setter\" as the getter.</p>\n"}, {"tags": [], "owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "is_accepted": true, "score": 1, "last_activity_date": 1432773586, "creation_date": 1432773586, "answer_id": 30495379, "question_id": 30494679, "link": "https://stackoverflow.com/questions/30494679/c-operator-overload-not-responding/30495379#30495379", "title": "C++ operator [] overload not responding", "body": "<p>Thinking of them as \"getter\" and \"setter\" variants is a mistake. The difference between the two is merely the cv-qualification of the function and the return type. They are both getters. More importantly, you are returning reference types.</p>\n\n<p>References tend to decay, in this case to a mutable int, therefore the compiler is more likely to accept a non-const function call.</p>\n\n<pre><code>a[0];\n</code></pre>\n\n<p>The default evaluation of this statement is an integer value, not a reference, so that you can for instance do:</p>\n\n<pre><code>if (a[0])\n</code></pre>\n\n<p>and this is predicate on the value at a[0] rather than the reference (evaluating the reference would always be true and not very helpful).</p>\n\n<p>Remember that when references are used in most statements they decay to the referred value.</p>\n\n<pre><code>int v = a[0]; // no error, even tho v's type is not int&amp;\nint&amp; vr = a[0]; // decays to the value a references\n                // then takes a reference of that\n</code></pre>\n\n<p>(Note: that the compiler may elide the implied set of operations to simply capture or imply the original reference in the second statement).</p>\n\n<p>So the code</p>\n\n<pre><code>a[2] = a[0] + a[1]\n</code></pre>\n\n<p>It starts by getting the values from a[0] and a[1], knowing that it wants to do math, so the easiest way for it to do this is:</p>\n\n<pre><code>int a1 = a.operator[](1);\nint a0 = a.operator[](0);\nint&amp; dest = a.operator[](2);\ndest = a0 + a1;\n</code></pre>\n\n<p>If you want const, you're going to need either a const/const-ref to an array or to specify that you want a const ref:</p>\n\n<pre><code>const int&amp; ar = a[0];\n\n#include &lt;iostream&gt;\n\nstruct array\n{\n    int i = 0;\n    array() {}\n    const int &amp;operator[](size_t) const { std::cout &lt;&lt; \"const int[]\\n\"; return i; }\n    int &amp;operator[](size_t) { std::cout &lt;&lt; \"int[]\\n\"; return i; }\n};\n\nint main()\n{\n    array a;\n    a[0];\n    int v1 = a[0];\n    const int v2 = a[0];\n    std::cout &lt;&lt; \"refs\\n\";\n    int&amp; v3 = a[0];\n    const int&amp; v4 = a[0];\n    std::cout &lt;&lt; \"const array\\n\";\n    const array b;\n    b[0];\n    int v5 = b[0];\n    const int v6 = b[0];\n    std::cout &lt;&lt; \"refs\\n\";\n    //int&amp; v7 = b[0]; // would produce a compile error\n    const int&amp; v8 = b[0];\n}\n</code></pre>\n\n<p>See <a href=\"http://ideone.com/7EYGYj\" rel=\"nofollow\">http://ideone.com/7EYGYj</a></p>\n"}], "owner": {"reputation": 199, "user_id": 3809991, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IT3Ph.jpg?s=128&g=1", "display_name": "tul1", "link": "https://stackoverflow.com/users/3809991/tul1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 30495379, "answer_count": 2, "score": 1, "last_activity_date": 1432773586, "creation_date": 1432768402, "question_id": 30494679, "link": "https://stackoverflow.com/questions/30494679/c-operator-overload-not-responding", "title": "C++ operator [] overload not responding", "body": "<p>I've created the class array and something is going weird.. the class is the following:</p>\n\n<pre><code>class array\n{\n    private:\n        int *a_;\n        size_t size_;\n    public:\n        array();\n        array(const size_t);\n        array(const arreglo &amp;);\n        ~array();\n        int const &amp;operator[](size_t)const;\n        int &amp;operator[](size_t);\n        array const &amp;operator=(const array&amp;);\n        bool empty()const;\n};\n</code></pre>\n\n<p>The overload's implementation of [] are:</p>\n\n<pre><code>int const &amp;array::operator[](size_t index)const\n{\n    std::cout &lt;&lt; \"getter\" &lt;&lt; std::endl; \n    return a_[index]; \n}\nint &amp; array::operator[](size_t index)\n{\n    std::cout &lt;&lt; \"setter\" &lt;&lt; std::endl; \n    return a_[index]; \n}\n</code></pre>\n\n<p>The way i'm testing the code is in this main:</p>\n\n<pre><code>int main()\n{\n    array a(7);\n    a[0] = 3;\n    a[1] = 6;\n    a[2] = a[0] + a[1];\n    array b = a;\n    std::cout &lt;&lt; b[2] &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>The problem is that the opertar [] is just using the getter version and prints through cout \"setter\" and never \"getter\".\nWhat is going wrong?</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 1, "creation_date": 1432793941, "post_id": 30494514, "comment_id": 49073880, "body": "The problem is probably in calling <code>QApplication::exit()</code> <b>before</b> the <code>QApplication::exec()</code> is called."}], "owner": {"reputation": 2343, "user_id": 4033050, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8617552b81048f6c4b67c9ec04f413b1?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/4033050/seb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "closed_date": 1435352498, "answer_count": 0, "score": 1, "last_activity_date": 1465607654, "creation_date": 1432767462, "last_edit_date": 1465607654, "question_id": 30494514, "link": "https://stackoverflow.com/questions/30494514/application-not-quit-when-sending-qapplicationexit-or-qapplicationquit", "closed_reason": "Duplicate", "title": "Application not quit when sending QApplication::exit or QApplication::quit", "body": "<p>I have wrote an app in Qt and C++.</p>\n\n<p>the <code>main</code> contain is calling a MainUi class and in case of issue during the Main UI init, the MainUi class is calling the <code>QApplication::exit()</code>. The Application seems close at first but the icon is still present in the dock which mean that the application is not really quit.</p>\n\n<p>Here is the code used by the class MainUI.</p>\n\n<pre><code>void MainUI::InitResult() {\n    if(error != ERROR_NONE) {\n        QApplication::processEvents();\n        Splashscreen-&gt;Ui_Splashscreen_failure();\n        Timer timer(4000);\n        Splashscreen-&gt;close();\n        emit error_init();\n    }\n    else\n    {\n        QApplication::processEvents();\n        Puls_Splashscreen-&gt;close();\n        QApplication::setOrganizationName(COMPANY_NAME);\n        QApplication::setApplicationName(PRODUCT_NAME);\n        InitUserInterface();\n    }\n}\n</code></pre>\n\n<p>the <em>main.cpp</em> is managing to instantiate the MainUI class but do not have any <code>close()</code>/<code>quit()</code> action</p>\n\n<pre><code>MainUI MyWindow(*DeviceFramework);\nQObject::connect(&amp;MyWindow, SIGNAL(error_init()),&amp;app, SLOT(quit()));\nMyWindow.InitApplication();\nreturn app.exec();\n</code></pre>\n\n<p><code>InitApplication</code> is enabling the management. At the end of the treatment the MainUI receive a signal and the slot <code>InitResult()</code> to treat the error. I have created another signal <code>init_error()</code> which is emitted by <code>InitResult()</code> to inform about an issue and ask to close the app.</p>\n\n<p>Any idea ?</p>\n"}, {"tags": ["c++", "arrays", "file", "ifstream", "cin"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432768320, "post_id": 30494482, "comment_id": 49066862, "body": "Your approach looks much to complicated for my taste. I&#39;d simply use a <a href=\"http://en.cppreference.com/w/cpp/io/basic_stringstream\" rel=\"nofollow noreferrer\"><code>std::stringstream</code></a> to generate the file names using the <code>operator&lt;&lt;()</code> functions (giving a separate line for each file path), and reading from that one afterwards, instead of using <code>std::cin</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4946735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c296c0e3887421bfa9886aa4f8846555?s=128&d=identicon&r=PG&f=1", "display_name": "Lukenukem93", "link": "https://stackoverflow.com/users/4946735/lukenukem93"}, "edited": false, "score": 0, "creation_date": 1432779948, "post_id": 30494567, "comment_id": 49069612, "body": "Thanks. I actually noticed that just after posting. <code>iFloor</code> always starts at 1 though so no issue has actually arisen from that."}], "tags": [], "owner": {"reputation": 2827, "user_id": 3931225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/46nwm.gif?s=128&g=1", "display_name": "KompjoeFriek", "link": "https://stackoverflow.com/users/3931225/kompjoefriek"}, "is_accepted": false, "score": 0, "last_activity_date": 1432767751, "creation_date": 1432767751, "answer_id": 30494567, "question_id": 30494482, "link": "https://stackoverflow.com/questions/30494482/ifstream-opens-files-named-by-cin-but-not-when-pulled-from-an-array-any-differe/30494567#30494567", "title": "ifstream opens files named by cin but not when pulled from an array. Any difference between cin and a regular string definition?", "body": "<p>It looks like you start filling <code>aFiles</code> from index <code>iFloor</code>, while you start reading <code>aFiles</code> from index <code>0</code>.</p>\n\n<p>How about changing <code>aFiles[i-1] = name;</code> to <code>aFiles[i-iFloor] = name;</code></p>\n"}, {"tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 0, "last_activity_date": 1432769170, "creation_date": 1432769170, "answer_id": 30494800, "question_id": 30494482, "link": "https://stackoverflow.com/questions/30494482/ifstream-opens-files-named-by-cin-but-not-when-pulled-from-an-array-any-differe/30494800#30494800", "title": "ifstream opens files named by cin but not when pulled from an array. Any difference between cin and a regular string definition?", "body": "<blockquote>\n  <p><em>\"TL;DR File names stored as strings in array (using new)\"</em></p>\n</blockquote>\n\n<p>Don't do this. Use a dynamic container like <code>std::vector&lt;std::string&gt;</code> instead.</p>\n\n<blockquote>\n  <p><em>\"- ifstream won't open them (perror returns \"No such file or directory\").\"</em></p>\n</blockquote>\n\n<p>Use the debugger to check what's actually passed to the </p>\n\n<pre><code>ifstream inputFile(sFullPath);\n</code></pre>\n\n<p>with <code>sFullPath</code>.</p>\n\n<blockquote>\n  <p><em>\"Swap out array variable with a call to the user to name the file (using cin) - ifstream opens the file. Why? How do I get the array to work?\"</em></p>\n</blockquote>\n\n<p>You cannot <em>replace</em> the behaviors of a stream getting values as you're trying with the array.</p>\n\n<p>The best way to make the input stream source transparent, is to simply use a <code>std::istream</code> reference, and don't care if it's <code>std::cin</code> or e.g. a <code>std::istringstream</code> reference.</p>\n\n<p>The <code>std::string</code> instance needed to initialize the mentioned <code>std::istringstream</code> can be build e.g. using a <code>std::ostringstream</code> and pass the <code>str()</code> property to the <code>std::istringstream</code> constructor.</p>\n"}], "owner": {"reputation": 1, "user_id": 4946735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c296c0e3887421bfa9886aa4f8846555?s=128&d=identicon&r=PG&f=1", "display_name": "Lukenukem93", "link": "https://stackoverflow.com/users/4946735/lukenukem93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432769170, "creation_date": 1432767273, "last_edit_date": 1432767371, "question_id": 30494482, "link": "https://stackoverflow.com/questions/30494482/ifstream-opens-files-named-by-cin-but-not-when-pulled-from-an-array-any-differe", "title": "ifstream opens files named by cin but not when pulled from an array. Any difference between cin and a regular string definition?", "body": "<p>TL;DR File names stored as strings in array (using new) - ifstream won't open them (perror returns \"No such file or directory\"). Swap out array variable with a call to the user to name the file (using cin) - ifstream opens the file. Why? How do I get the array to work?</p>\n\n<p><strong>Things to Know</strong></p>\n\n<ul>\n<li>All files exist in folders with naming scheme run20### where </li>\n<li>All files are named S20###.ABC where ### is the same from the parent directory and ABC can go from 001-999. These are all text files (there are no .txt extensions though) that CAN be opened by ifstream and getline.</li>\n</ul>\n\n<p>I'm writing a program that's going to pull information from up to 150 files. An early version I wrote had the user input the file name (using cin). ifstream took the stored name and opened the file successfully every time. Obviously, I don't want to type 150 file names in so the program stores all of the file names as strings in an array for the program to pull from. However, when it goes to open the file (in the correct path and with the correct file name and extension), the error I get from perror returns \"No such file or directory.\" If I just do a quick swap of the variables though so that the file name comes from cin, the file opens. Why would cin work and the array version not? Is there any way to get the array to work?</p>\n\n<p>I've also tried something similar where there is no array. Instead, in the for loop that would pull the files from the array, the file gets named each time.</p>\n\n<p>Here's the code (sorry about the headers, couldn't get it to format right):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;array&gt;\n#include &lt;string&gt;\n#include &lt;ctime&gt;\n#include &lt;cstring&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n\nusing namespace std;\n\nint main() {\n//--------------------------Initial setup----------------------------------\n    cout &lt;&lt; \"Please give the full name of the folder you would like to open in the /Users/lucas/HPS/TDCData directory\" &lt;&lt; endl &lt;&lt; endl;\n    string sFolderName;\n    cin &gt;&gt; sFolderName;\n\n    // Create path. I have mine here but you'll have to change it to something you'll \n    // use if you want to run the code\n    string sPathName = \"/Users/lucas/HPS/TDCData/\" + sFolderName;\n\n//----------------Create file name array------------------------------------    \n    // Get naming base from the folder name given\n    string sFileBase = \"S20\";\n    for (int i = 5; i &lt;= sFolderName.length(); i++){\n            sFileBase = sFileBase + sFolderName[i];\n    }\n\n    //Specify range since different directories have different numbers of files\n    cout &lt;&lt; \"Files must be named S20###.ABC\" &lt;&lt; endl;\n    cout &lt;&lt; \"Specify a range for ABC\" &lt;&lt; endl;\n    int iFloor;\n    int iCeiling;\n    cout &lt;&lt; \"Floor: \" &lt;&lt; endl;\n    cin &gt;&gt; iFloor;\n    cout &lt;&lt; \"Ceiling: \" &lt;&lt; endl;\n    cin &gt;&gt; iCeiling;\n\n    // Define an array to store names and then store them\n    string *aFiles;\n    int iFilesSize = iCeiling - iFloor + 1;\n    aFiles = new string [iFilesSize];\n    cout &lt;&lt; \"Array created\" &lt;&lt; endl;\n    for (int i = iFloor; i &lt;= iCeiling; i++){\n        string name = sFileBase;\n        if (i &lt; 10){\n            name = name + \".00\" + to_string(i);\n        }\n        else if (i &lt; 100) {\n            name = name + \".0\" + to_string(i);\n        }\n        else {\n            name = name + '.' + to_string(i);\n        }\n        aFiles[i-1] = name;\n    }\n\n//----------------Open each file in aFiles----------------------\n    for (int i = 0; i &lt; iFilesSize; i++){\n        // There are two important lines of code here. The first gets sFileName from\n        // aFiles. The second gets sFileName from user input using cin (this is commented out). \n        // Obviously, none of the last section of code is needed for the second line to work.\n        // The first line does not work for me. The second does.\n\n        string sFileName;\n\n        //First\n        sFileName = aFiles[i];\n\n        //Second\n        //cin &gt;&gt; sFileName\n\n        string sFullPath = sPathName + \"/\" + sFileName;\n        cout &lt;&lt; \"Searching ... \" &lt;&lt; sFullPath &lt;&lt; endl &lt;&lt; endl;\n\n        //Open file\n        ifstream inputFile(sFullPath);\n\n        //Check that the file opened\n        if (! inputFile.is_open()) {\n        cout &lt;&lt; \"Error reading\" &lt;&lt; sFullPath &lt;&lt; endl;\n            perror(\"Error is: \");\n            return 0;\n        }\n        else {\n            cout &lt;&lt; \"File opened successfully...\" &lt;&lt; aFiles[i] &lt;&lt; endl &lt;&lt; endl;\n        }\n    }\n    cout &lt;&lt; \"All files opened...\" &lt;&lt; endl &lt;&lt; endl;\n    return 0;\n\n}\n</code></pre>\n\n<p>Also <a href=\"http://1drv.ms/1cjR1Ui\" rel=\"nofollow\">here's</a> a link to a zip of one of the directories for any tests someone might want to run. Thanks for any and all help!</p>\n"}, {"tags": ["c++", "serialization", "boost", "structure"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432767653, "post_id": 30494467, "comment_id": 49066656, "body": "<a href=\"http://stackoverflow.com/questions/3133621/rule-of-thumb-size-of-boost-archive-in-relation-to-original-serialized-object\">This</a> and <a href=\"http://stackoverflow.com/questions/3015582/direct-boost-serialization-to-char-array\">this</a> Q&amp;A seem to give evidence that&#39;s it&#39;s not really possible to determine the size of a <code>boost::archive</code> before the serialization actually took place. But I&#39;m not a <code>boost</code> serialization expert at all."}], "answers": [{"tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 1, "last_activity_date": 1432802611, "last_edit_date": 1495542852, "creation_date": 1432802611, "answer_id": 30501450, "question_id": 30494467, "link": "https://stackoverflow.com/questions/30494467/boost-serialization-how-to-predict-the-size-of-the-serialized-result/30501450#30501450", "title": "Boost Serialization : How To Predict The Size Of The Serialized Result?", "body": "<p>In general it's impossible to predict. It depends (a lot) on the archive format. But with object tracking completely subgraphs might be elided, and with dynamic type information a lot of data could be added.</p>\n\n<p>If you can afford scratch buffers for serialized data, you can serialize to a buffer first, and then send the size (now that you know it) before sending the payload.</p>\n\n<p>There will be overhead for </p>\n\n<ul>\n<li>object tracking (serializing through pointers/references)</li>\n<li>dynamic polymorphism (serializing through (smart) pointer-to-base)</li>\n<li>versioning (unless you disable it for the types involved)</li>\n<li>archive header (unless disabled)</li>\n<li>code conversion (unless disabled)</li>\n</ul>\n\n<p>Here are some answers that give you more information about these tweak points:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/22459726/boost-c-serialization-overhead/22464553#22464553\">Boost C++ Serialization overhead</a></li>\n<li><a href=\"https://stackoverflow.com/questions/26556145/boost-serialization-binary-archive-giving-incorrect-output/26568212#26568212\">Boost Serialization Binary Archive giving incorrect output</a></li>\n<li><a href=\"https://stackoverflow.com/questions/27950322/boost-serialization-of-vectorchar/27950752#27950752\">Boost Serialization of vector&lt;char&gt;</a></li>\n<li>Tune things (boost::archive::no_codecvt, boost::archive::no_header, <a href=\"http://www.boost.org/doc/libs/1_57_0/libs/serialization/doc/traits.html#tracking\" rel=\"nofollow noreferrer\">disable tracking</a> etc.)</li>\n</ul>\n\n<p>If all your data is POD, it's easy to predict the size. </p>\n\n<h2>Out of the box</h2>\n\n<p>If you share IPC on the same machine, and you're already using circular buffers, consider putting the circular buffer into shared memory.</p>\n\n<p>I have lots of answers (search for <code>managed_shared_memory</code> or <code>managed_mapped_file</code>) with examples of this. </p>\n\n<p>A concrete example, focusing on a lock-free single-producer/single-consumer scenario is here: <a href=\"https://stackoverflow.com/questions/22207546/shared-memory-ipc-synchronization-lock-free/22209595?s=1|0.0000#22209595\">Shared-memory IPC synchronization (lock-free)</a></p>\n\n<p>Even if you choose to/need to stream messages (e.g. over the network) you can still employ e.g. <a href=\"http://www.boost.org/doc/libs/1_58_0/doc/html/interprocess/managed_memory_segments.html#interprocess.managed_memory_segments.managed_heap_memory_external_buffer\" rel=\"nofollow noreferrer\">Managed External Buffers</a>. Hereby you avoid the need to do <em>any</em> serialization even without requiring all data to be POD. (The trick is that internally, <code>offset_ptr&lt;&gt;</code> is used instead of raw pointers, making all references relative).</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1549214079, "post_id": 54505381, "comment_id": 95814489, "body": "But that gives you the size <i>after</i> serialisation. Unless you hold back the data for transport (as covered much more thoroughly by sehe four years ago) that is too late."}], "tags": [], "owner": {"reputation": 61, "user_id": 3184775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3ee6356ccfe51df1b3849ef48483ca4?s=128&d=identicon&r=PG&f=1", "display_name": "AshFTW", "link": "https://stackoverflow.com/users/3184775/ashftw"}, "is_accepted": false, "score": -1, "last_activity_date": 1549213791, "creation_date": 1549213791, "answer_id": 54505381, "question_id": 30494467, "link": "https://stackoverflow.com/questions/30494467/boost-serialization-how-to-predict-the-size-of-the-serialized-result/54505381#54505381", "title": "Boost Serialization : How To Predict The Size Of The Serialized Result?", "body": "<p>Create your own streaming class and override <code>xsputn</code> method.</p>\n\n<pre><code>class counter_streambuf : public std::streambuf {\npublic:\n    using std::streambuf::streambuf;\n\n    size_t size() const { return m_size; }\n\nprotected:\n    std::streamsize xsputn(const char_type* __s, std::streamsize __n) override \n    { this-&gt;m_size += __n; return __n; }\n\nprivate:\n    size_t m_size = 0;\n};\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>Header H(__Magic, SSP_T_REQUEST, 98, 72, 42, Date(), SSP_C_NONE);\ncounter_streambuf csb;\nboost::archive::binary_oarchive oa(csb, boost::archive::no_header);\noa &amp; H;\ncout&lt;&lt;\"Size: \"&lt;&lt;csb.size();\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 4946771, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OIRiiZlhKe0/AAAAAAAAAAI/AAAAAAAAAJU/5QDn_eLTrWw/photo.jpg?sz=128", "display_name": "Thibaud Auzou", "link": "https://stackoverflow.com/users/4946771/thibaud-auzou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1511, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1549213791, "creation_date": 1432767223, "question_id": 30494467, "link": "https://stackoverflow.com/questions/30494467/boost-serialization-how-to-predict-the-size-of-the-serialized-result", "title": "Boost Serialization : How To Predict The Size Of The Serialized Result?", "body": "<p>I use booost serialization that way :</p>\n\n<pre><code>Header H(__Magic, SSP_T_REQUEST, 98, 72, 42, Date(), SSP_C_NONE);\nHeader Z;\n\nstd::cout &lt;&lt; H &lt;&lt; std::endl;\nstd::cout &lt;&lt; std::endl;\n\nchar serial_str[4096];\n\nstd::memset(serial_str, 0, 4096);\n\nboost::iostreams::basic_array_sink&lt;char&gt; inserter(serial_str, 4096);\nboost::iostreams::stream&lt;boost::iostreams::basic_array_sink&lt;char&gt; &gt; s(inserter);\nboost::archive::binary_oarchive oa(s);\n\noa &amp; H;\ns.flush();\n\nstd::cout &lt;&lt; serial_str &lt;&lt; std::endl;\n\nboost::iostreams::basic_array_source&lt;char&gt; device(serial_str, 4096);\nboost::iostreams::stream&lt;boost::iostreams::basic_array_source&lt;char&gt; &gt; s2(device);\nboost::archive::binary_iarchive ia(s2);\n\nia &gt;&gt; Z;\n\nstd::cout &lt;&lt; Z &lt;&lt; std::endl;\n</code></pre>\n\n<p>And It works perfectly fine.</p>\n\n<p>Nevertheless, I need to send those packet on a socket. My problem is, how do I know on the other side how many bytes I need to read ? The size of the serialized result is not constant and btw is bigger than sizeof of my struct.</p>\n\n<p>How can I be sure that the data is complete on the other side ? I use circular buffer but with serialisation how to do ?</p>\n\n<p>Thx all</p>\n"}, {"tags": ["c++", "class", "variables", "attributes", "local"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1432767423, "post_id": 30494407, "comment_id": 49066587, "body": "This isn&#39;t an error, but it can be configured as a <i>warning</i>. <a href=\"https://stackoverflow.com/questions/911740/warning-about-hiding-member-variables\">See this question</a>."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1432771937, "post_id": 30494407, "comment_id": 49067863, "body": "So, when you tried it, what happened?"}], "answers": [{"tags": [], "owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "is_accepted": true, "score": 5, "last_activity_date": 1432767471, "last_edit_date": 1432767471, "creation_date": 1432767116, "answer_id": 30494450, "question_id": 30494407, "link": "https://stackoverflow.com/questions/30494407/declaring-a-local-variable-within-class-scope-with-same-name-as-a-class-attribut/30494450#30494450", "title": "Declaring a local variable within class scope with same name as a class attribute", "body": "<p>The local variable will shadow the member one (it has the more narrow scope). If you just write</p>\n\n<pre><code>Data = 4;\n</code></pre>\n\n<p>you will assign to the local variable <code>Data</code>. You can still access the member variable with</p>\n\n<pre><code>this-&gt;Data = 4;\n</code></pre>\n\n<p>This works basically just as</p>\n\n<pre><code>{\nint data = 4;\n    {\n    int data = 2;\n    data++; // affects only the inner one\n    }\n}\n</code></pre>\n\n<p>As for problems in the future: As long as you and everyone who will ever work with your code understands the rules and is aware that you did this on purpose there is no problem. If you do not intend to do such things on purpose, make your compiler warn about it.</p>\n\n<p>However, it would certainly be saver if you followed a naming scheme for member variables, e.g. append an underscore like</p>\n\n<pre><code>class A{\n    int Data_;\n\n    void MethodA();\n};\n</code></pre>\n"}], "owner": {"reputation": 823, "user_id": 4812238, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qFdQT.jpg?s=128&g=1", "display_name": "Ediac", "link": "https://stackoverflow.com/users/4812238/ediac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2448, "favorite_count": 1, "accepted_answer_id": 30494450, "answer_count": 1, "score": 1, "last_activity_date": 1432767471, "creation_date": 1432766889, "question_id": 30494407, "link": "https://stackoverflow.com/questions/30494407/declaring-a-local-variable-within-class-scope-with-same-name-as-a-class-attribut", "title": "Declaring a local variable within class scope with same name as a class attribute", "body": "<p>While observing another person's code, i realized that within class A's method he declared a local int with the same name as an attribute of class A. For example:</p>\n\n<p>//classA.h</p>\n\n<pre><code>class A{\n    int Data;\n\n    void MethodA();\n};\n</code></pre>\n\n<p>//classA.cpp</p>\n\n<pre><code>#include \"classA.h\"\n\nusing namespace std;\n\nvoid A::MethodA(){\n    int Data; //local variable has same name as class attribute\n\n    Data = 4;\n\n    //Rest of Code\n}\n</code></pre>\n\n<p>I found it weird that the compiler would accept it without returning an error. In the above case, would the 4 be assigned to the local Data or A::Data, and what problems could this cause in more complex situations?</p>\n"}, {"tags": ["c++", "boost"], "answers": [{"comments": [{"owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1432833341, "post_id": 30501035, "comment_id": 49101260, "body": "You didn&#39;t implement a <code>prev</code> function (my actual question), though your solution suggests using <code>Tree::reverse_iterator(tree.iterator_to(fp))</code>.  Both that and my <code>prev</code> function work, but I can&#39;t find support for either of them in the boost documentation.  In particular, the relevant <a href=\"http://www.boost.org/doc/libs/1_57_0/doc/html/boost/intrusive/rbtree.html\" rel=\"nofollow noreferrer\">documentation</a> states only that it is implementation-defined.  Does boost offer any &quot;normative&quot; description of iterator behavior?  Also, is there a guarantee that <code>rend()</code> is constant time, since in STL <code>rend().base()</code> must be log time?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1432834436, "post_id": 30501035, "comment_id": 49101914, "body": "The implicit conversion from reverse-iterator to base iterator is documented here e.g.: <a href=\"http://en.cppreference.com/w/cpp/iterator/reverse_iterator\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/iterator/reverse_iterator</a>. I agree it&#39;s a convention. But many things about many libraries are not documented in that sense. It makes sense that a library that promises standard-library compatible containers adheres to the iterator requirements and conventions from that standard-library."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1432834510, "post_id": 30501035, "comment_id": 49101966, "body": "I don&#39;t know about complexity guarantees of hand. That is probably answered elsewhere, and could otherwise be a nice question in it&#39;s own right"}, {"owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1432840272, "post_id": 30501035, "comment_id": 49105415, "body": "Now I&#39;m confused.  Is a <code>std::reverse_iterator&lt;boost::intrusive::rbtree&lt;foo&gt;::iterato&zwnj;&#8203;r&gt;</code> the same as a <code>boost::intrusive::rbtree&lt;foo&gt;::reverse_iterator</code>?  What basis is there for assuming those are the same types?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1432842830, "post_id": 30501035, "comment_id": 49106925, "body": "Nobody said that. Assuming that would be both unreasonable and unnecessary. I answered your question why such things would not be documented more explicitly"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 1, "last_activity_date": 1432801827, "last_edit_date": 1432801827, "creation_date": 1432801496, "answer_id": 30501035, "question_id": 30494398, "link": "https://stackoverflow.com/questions/30494398/constant-time-test-for-first-element-in-intrusive-rbtree/30501035#30501035", "title": "Constant time test for first element in intrusive rbtree", "body": "<p>You can get the reverse-iterator from <code>iterator_to</code>. </p>\n\n<blockquote>\n  <p>Also, note that <a href=\"http://www.boost.org/doc/libs/1_58_0/boost/intrusive/rbtree.hpp\" rel=\"nofollow noreferrer\">there is <code>rbtree&lt;&gt;::container_from_iterator(iterator it)</code></a> so you don't have to have a \"global\" state for your <code>prev</code> function.</p>\n</blockquote>\n\n<hr>\n\n<p>You can just create the corresponding reverse_iterator. You'll have to +1 the iterator to get the expected address:\n<img src=\"https://i.stack.imgur.com/Rf2l3.png\" alt=\"enter image description here\"></p>\n\n<p>So my take on this would be (<strong>bonus:</strong> without memory leaks):</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/f33c56e7884bc392\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/intrusive/set.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n\nusing namespace boost::intrusive;\n\nstruct foo : set_base_hook&lt;&gt; {\n    std::string name;\n    foo(char const* n) : name(n) {}\n\n    bool operator&lt;(const foo &amp;b) const { return name &lt; b.name; }\n};\n\nint main()\n{\n    std::vector&lt;foo&gt; v;\n    v.emplace_back(\"a\");\n    v.emplace_back(\"b\");\n    v.emplace_back(\"c\");\n\n    using Tree = rbtree&lt;foo&gt;;\n\n    Tree tree;\n    tree.insert_unique(v.begin(), v.end());\n\n    for (auto key : { \"a\", \"b\", \"c\", \"missing\" })\n    {\n        std::cout &lt;&lt; \"\\nusing key '\" &lt;&lt; key &lt;&lt; \"': \";\n        auto start = tree.iterator_to(*tree.find(key));\n\n        if (start != tree.end()) {\n            for (auto it = Tree::reverse_iterator(++start); it != tree.rend(); ++it)\n                std::cout &lt;&lt; it-&gt;name &lt;&lt; \" \";\n        }\n    }\n}\n</code></pre>\n\n<p>Which prints</p>\n\n<pre><code>using key 'a': a \nusing key 'b': b a \nusing key 'c': c b a \nusing key 'missing': \n</code></pre>\n"}], "owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432847151, "creation_date": 1432766833, "last_edit_date": 1432847151, "question_id": 30494398, "link": "https://stackoverflow.com/questions/30494398/constant-time-test-for-first-element-in-intrusive-rbtree", "title": "Constant time test for first element in intrusive rbtree", "body": "<p>How can I efficiently tell if an element is at the beginning of an intrusive set or rbtree?  I would like to define a simple function <code>prev</code> that returns a pointer to the previous item in a tree, or <code>nullptr</code> if there is no previous item.  An analogous <code>next</code> function is easy to write, using <code>iterator_to</code> and comparing to <code>end()</code>.  However, there is no equivalent <code>reverse_iterator_to</code> function that would allow me to compare to <code>rend()</code>.  Moreover, I specifically do not want to compare to <code>begin()</code>, because that's not constant time in a red-black tree.</p>\n\n<p>One thing that certainly seems to work is decrementing an iterator and comparing it to <code>end()</code>.  That works fine with the implementation, but I can find no support for this in the documentation.  What's the best way to implement <code>prev</code> in the following minimal working example?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;boost/intrusive/set.hpp&gt;\n\nusing namespace std;\nusing namespace boost::intrusive;\n\nstruct foo : set_base_hook&lt;&gt; {\n  string name;\n  foo(const char *n) : name(n) {}\n  friend bool operator&lt;(const foo &amp;a, const foo &amp;b) { return a.name &lt; b.name; }\n};\n\nrbtree&lt;foo&gt; tree;\n\nfoo *\nprev(foo *fp)\n{\n  auto fi = tree.iterator_to(*fp);\n  return --fi == tree.end() ? nullptr : &amp;*fi;\n}\n\nint\nmain()\n{\n  tree.insert_equal(*new foo{\"a\"});\n  tree.insert_equal(*new foo{\"b\"});\n  tree.insert_equal(*new foo{\"c\"});\n  for (foo *fp = &amp;*tree.find(\"c\"); fp; fp = prev(fp))\n    cout &lt;&lt; fp-&gt;name &lt;&lt; endl;\n}\n</code></pre>\n\n<p><strong>Update:</strong> Okay, so what I was missing, which is probably what sehe was getting at indirectly, is that in STL begin() is actually guaranteed to be constant-time.  So even though a generic red-black tree requires log(n) time to find the minimum element, an STL map doesn't--an STL std::map implementation is required to cache the first element.  And I think the point sehe is making is that even though boost is not documented, it is fair to assume that boost::intrusive containers behave sort of like STL containers.  Given that assumption, it is perfectly fine to say:</p>\n\n<pre><code>foo *\nprev(foo *fp)\n{\n  auto fi = tree.iterator_to(*fp);\n  return fi == tree.begin() ? nullptr : &amp;*--fi;\n}\n</code></pre>\n\n<p>As the comparison to tree.begin() shouldn't be too costly.</p>\n"}, {"tags": ["c++", "string", "strsafe"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432767050, "post_id": 30494368, "comment_id": 49066470, "body": "Try changing <i><code>std::string timezone(&quot;someTimeZOneName&quot;);</code></i> to <code>std::wstring timezone(&quot;someTimeZOneName&quot;);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3303, "user_id": 2339664, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/64b54fa6ca1be975a3ae0b683d0d8164?s=128&d=identicon&r=PG&f=1", "display_name": "Harry Boy", "link": "https://stackoverflow.com/users/2339664/harry-boy"}, "edited": false, "score": 0, "creation_date": 1432804468, "post_id": 30494456, "comment_id": 49080221, "body": "Apologies, I forgot to mention that I cannot change the tzKey string as it is used elsewhere.  I just need to convert the MyStruct.tzKey somehow to dtzRecorder.TimeZoneKeyName."}, {"owner": {"reputation": 14451, "user_id": 33499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c590aa4c56918b47c7ba5e39dba5d8?s=128&d=identicon&r=PG", "display_name": "wimh", "link": "https://stackoverflow.com/users/33499/wimh"}, "reply_to_user": {"reputation": 3303, "user_id": 2339664, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/64b54fa6ca1be975a3ae0b683d0d8164?s=128&d=identicon&r=PG&f=1", "display_name": "Harry Boy", "link": "https://stackoverflow.com/users/2339664/harry-boy"}, "edited": false, "score": 0, "creation_date": 1432819788, "post_id": 30494456, "comment_id": 49091529, "body": "You can use <a href=\"https://msdn.microsoft.com/en-us/library/dd319072%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">MultiByteToWideChar</a> to convert the string"}], "tags": [], "owner": {"reputation": 14451, "user_id": 33499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c590aa4c56918b47c7ba5e39dba5d8?s=128&d=identicon&r=PG", "display_name": "wimh", "link": "https://stackoverflow.com/users/33499/wimh"}, "is_accepted": false, "score": 2, "last_activity_date": 1432775396, "last_edit_date": 1432775396, "creation_date": 1432767154, "answer_id": 30494456, "question_id": 30494368, "link": "https://stackoverflow.com/questions/30494368/argument-of-type-char-is-incompatible-with-parameter-of-type-strsafe-lpcwst/30494456#30494456", "title": "argument of type &quot;char *&quot; is incompatible with parameter of type &quot;STRSAFE_LPCWSTR", "body": "<p>The basic problem is that <code>dtzRecorder.TimeZoneKeyName</code> is a <strong>wide</strong> string (<code>wchar_t[]</code>), but <code>tzKey</code> is a <strong>narrow</strong> string (<code>char[]</code>).</p>\n\n<p>The easiest way to solve it would be to use <code>wchar_t</code> for <code>tzKey</code>, too:</p>\n\n<pre><code>wchar_t tzKey[51];\n\nstd::wstring timezone(L\"someTimeZOneName\");\nwcsncpy_s(MyStruct.tzKey, timezone.c_str(), _TRUNCATE);\n\nStringCchCopy(dtzRecorder.TimeZoneKeyName, 128, MyStruct.tzKey); \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1432775460, "post_id": 30495488, "comment_id": 49068618, "body": "You can use <code>typedef std::basic_string&lt;_TCHAR&gt; TSTRING;</code> instead of using an <code>#ifdef</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1432775738, "post_id": 30495488, "comment_id": 49068690, "body": "The <code>C</code> in these typedefs means <code>const</code>. <code>LPSTR</code> is <code>char *</code>, <code>LPCSTR</code> is <code>const char *</code>, and <code>LPCWSTR</code> which OP has is <code>const wchar_t *</code>."}], "tags": [], "owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "is_accepted": false, "score": 1, "last_activity_date": 1442651881, "last_edit_date": 1442651881, "creation_date": 1432774401, "answer_id": 30495488, "question_id": 30494368, "link": "https://stackoverflow.com/questions/30494368/argument-of-type-char-is-incompatible-with-parameter-of-type-strsafe-lpcwst/30495488#30495488", "title": "argument of type &quot;char *&quot; is incompatible with parameter of type &quot;STRSAFE_LPCWSTR", "body": "<p><code>LPSTR</code> is Microsoft for \"Long Pointer to STRing\" or <code>char *</code>, <code>LPWSTR</code> is Microsoft for \"Long Pointer to Wide-c STring\" or <code>wchar_t *</code>. Additionally <code>LPCSTR</code> and <code>LPCWSTR</code> refer to const variants.</p>\n\n<p>The error you see comes from passing an <code>LPCSTR</code> (const character pointer) to a function expecting an <code>LPWSTR</code> (non-const unicode/wide character pointer).</p>\n\n<p>Wide string constants are denoted with an <code>L</code> prefix (<code>L\"wide\"</code>), generally have the type <code>wchar_t*</code> and require a variant of <code>std::string</code> called <code>std::wstring</code>.</p>\n\n<p>Which is the default for most Windows system calls is handled by a general project setting \"Character Set\", if it is \"Unicode\" then wide strings are required. Support for this is provided by <code>&lt;tchar.h&gt;</code> see <a href=\"https://msdn.microsoft.com/en-us/library/dybsewaf.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/dybsewaf.aspx</a></p>\n\n<pre><code>#include &lt;tchar.h&gt;\n\n// tchar doesn't help with std::string/std::wstring, so use this helper.\n#ifdef _UNICODE\n#define TSTRING std::wstring\n#else\n#define TSTRING std::string\n#endif\n\n// or as Matt points out\ntypedef std::basic_string&lt;_TCHAR&gt; TSTRING;\n\n// Usage\nTCHAR tzKey[51];  // will be char or wchar_t accordingly\nTSTRING timezone(_T(\"timezonename\")); // string or wstring accordingly\n_tscncpy_s(tzKey, timezone.c_str(), _TRUNCATE);\n</code></pre>\n\n<p>Alternatively you can just be explicit about using wides</p>\n\n<pre><code>wchar_t tzKey[51]; // note: this is not 51 bytes\nstd::wstring timezone(L\"timezonename\");\nwscncpy_s(tzKey, timezone.c_str(), _TRUNCATE);\n</code></pre>\n\n<p>As an aside, why not simply do this:</p>\n\n<pre><code>std::wstring timezone(L\"tzname\");\ntimezone.erase(50); // limit length\n</code></pre>\n\n<p>Why waste time copying the value when you could just insert a null-terminator at the limit?</p>\n"}], "owner": {"reputation": 3303, "user_id": 2339664, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/64b54fa6ca1be975a3ae0b683d0d8164?s=128&d=identicon&r=PG&f=1", "display_name": "Harry Boy", "link": "https://stackoverflow.com/users/2339664/harry-boy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4041, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1442651881, "creation_date": 1432766671, "question_id": 30494368, "link": "https://stackoverflow.com/questions/30494368/argument-of-type-char-is-incompatible-with-parameter-of-type-strsafe-lpcwst", "title": "argument of type &quot;char *&quot; is incompatible with parameter of type &quot;STRSAFE_LPCWSTR", "body": "<p>I have the following:</p>\n\n<pre><code>DYNAMIC_TIME_ZONE_INFORMATION dtzRecorder;\nGetDynamicTimeZoneInformation(&amp;dtzRecorder);\n</code></pre>\n\n<p>I normally do the following to copy a new name:</p>\n\n<pre><code>StringCchCopy(dtzRecorder.TimeZoneKeyName, 128, L\"GMT Standard Time\");\n</code></pre>\n\n<p>But now I need to do the following:</p>\n\n<pre><code>char tzKey[51];\n\nstd::string timezone(\"someTimeZOneName\");\nstrncpy_s(MyStruct.tzKey, timezone.c_str(), _TRUNCATE);\n\nStringCchCopy(dtzRecorder.TimeZoneKeyName, 128, MyStruct.tzKey); &lt;--Error\n</code></pre>\n\n<p>But I get the error:</p>\n\n<p><strong>argument of type \"char *\" is incompatible with parameter of type \"STRSAFE_LPCWSTR\"</strong>  </p>\n\n<p>How can I copy this to dtzRecorder.TimeZoneKeyName??</p>\n"}, {"tags": ["c++", "c", "algorithm", "time-complexity"], "comments": [{"owner": {"reputation": 796429, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 0, "creation_date": 1432766364, "post_id": 30494296, "comment_id": 49066263, "body": "Yes; that&#39;s a fixed cost."}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 8, "creation_date": 1432766420, "post_id": 30494296, "comment_id": 49066273, "body": "&quot;Better&quot; than what? The version without the busy-loop is also O(n)."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 3, "creation_date": 1432766689, "post_id": 30494296, "comment_id": 49066363, "body": "It&#39;s a better algorithm from a complexity standpoint, but one that has been very poorly implemented."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1432766810, "post_id": 30494296, "comment_id": 49066392, "body": "I&#39;m not sure what image you have of &quot;modern-day interviewers&quot; but I suspect that if you go into an interviewer thinking that the interviewers are irrational or idiotic, then you&#39;re less likely to have a good interview. But, then, why would you want to work for a company with interviewers like that?"}, {"owner": {"reputation": 351, "user_id": 4905335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ba66eb8a28b943066353287470184fc8?s=128&d=identicon&r=PG&f=1", "display_name": "user4905335", "link": "https://stackoverflow.com/users/4905335/user4905335"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1432767330, "post_id": 30494296, "comment_id": 49066558, "body": "@rici This isn&#39;t a carbon-copy of an interview question I&#39;ve had, but I&#39;ve had several incidences where I supposedly had an answer that was &quot;wrong&quot; because it wasn&#39;t the clever <code>O(n)</code> solution from the Crack the Coding Interview Book, even though the solution from the book actually requires a lot of patchwork to get all the corner cases, and a lot of operations within the loop. I come up with an &#39;O(n*log(n))` solutions that is 2 lines of readable code and covers all possibly cases, and it&#39;s considered wrong, somehow."}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 2, "creation_date": 1432767485, "post_id": 30494296, "comment_id": 49066601, "body": "I&#39;m voting to close this question as off-topic because it&#39;s basically just ranting about code screens."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 3, "creation_date": 1432767572, "post_id": 30494296, "comment_id": 49066627, "body": "Honestly, what kind of answers are you expecting to a question like this? You already know that it&#39;s technically O(n) with a large additive constant in the loop body, so what&#39;s the point of this question, besides obliquely ranting about some bad interview you had?"}, {"owner": {"reputation": 2582, "user_id": 156604, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uIrFK.png?s=128&g=1", "display_name": "neminem", "link": "https://stackoverflow.com/users/156604/neminem"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1432768279, "post_id": 30494296, "comment_id": 49066851, "body": "@MatteoItalia I think it&#39;s reasonable for him to be asking if he&#39;s missing anything? Which, yes, he was missing something, which is that O() isn&#39;t everything, it&#39;s just one measure."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 2582, "user_id": 156604, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uIrFK.png?s=128&g=1", "display_name": "neminem", "link": "https://stackoverflow.com/users/156604/neminem"}, "edited": false, "score": 0, "creation_date": 1432768429, "post_id": 30494296, "comment_id": 49066899, "body": "@neminem: to me it looks like he knows very well that it&#39;s just <i>one</i> measure, and, in facts, he is more or less implicitly saying that, by most other measures - such as readability, maintainability, elegance, maybe actual runtime in many cases - his code is better. It&#39;s understandable to feel frustrated by an interviewer who won&#39;t listen to a reasonable alternative to the solution he has printed in his book (I for one would appreciate a candidate that would show where one efficiency measure falls short, or where tradeoffs can be made), but, again, rants do not belong to SO."}], "answers": [{"tags": [], "owner": {"reputation": 2582, "user_id": 156604, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uIrFK.png?s=128&g=1", "display_name": "neminem", "link": "https://stackoverflow.com/users/156604/neminem"}, "is_accepted": false, "score": 5, "last_activity_date": 1432766674, "creation_date": 1432766674, "answer_id": 30494369, "question_id": 30494296, "link": "https://stackoverflow.com/questions/30494296/is-this-technically-an-on-algorithm/30494369#30494369", "title": "Is this technically an O(n) algorithm?", "body": "<p>Yes, it absolutely would be considered O(n) still. The first line is a constant (extremely large, but still constant) cost, so it doesn't affect the asymptotic complexity at all.</p>\n\n<p>That said, the algorithm would only be considered universally \"better\" than a more sane O(n log n) algorithm, etc., according to an interviewer that had no idea what they were talking about. Any real-world discussion of algorithmic complexity, especially in comparing multiple options, absolutely should include asymptotic complexity, but also the constants involved (both multiplicative - 2n vs. 1000000n - and additive - n vs. n + 100000000), as well as the context it will be run under (for instance: suppose you were running a googol items through your algorithm: now your algorithm <em>might</em> be the better option.) </p>\n\n<p>If I were asked this at an interview, that is what I would say, and most likely, what an interviewer would want to hear.</p>\n"}, {"comments": [{"owner": {"reputation": 2912, "user_id": 1274223, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/uGq26.jpg?s=128&g=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1274223/alejandro"}, "edited": false, "score": 1, "creation_date": 1432767573, "post_id": 30494461, "comment_id": 49066629, "body": "Excellent point made about the overflow!"}, {"owner": {"reputation": 2582, "user_id": 156604, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uIrFK.png?s=128&g=1", "display_name": "neminem", "link": "https://stackoverflow.com/users/156604/neminem"}, "edited": false, "score": 0, "creation_date": 1432768150, "post_id": 30494461, "comment_id": 49066812, "body": "Cute. I see a question of asymptotic complexity and I just assume a language-agnostic perfect theoretical language, even if it does look like c++. But yes, there is totally an overflow issue, even if I don&#39;t think that&#39;s what he was actually going for (you could probably make his question more in line with what he meant to ask by, say, splitting the loop into a couple loops, or just waiting on a timer or something.)"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 2582, "user_id": 156604, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uIrFK.png?s=128&g=1", "display_name": "neminem", "link": "https://stackoverflow.com/users/156604/neminem"}, "edited": false, "score": 0, "creation_date": 1432768413, "post_id": 30494461, "comment_id": 49066890, "body": "@neminem: The question IS tagged <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> and <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> (I checked, before posting)"}, {"owner": {"reputation": 2582, "user_id": 156604, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uIrFK.png?s=128&g=1", "display_name": "neminem", "link": "https://stackoverflow.com/users/156604/neminem"}, "edited": false, "score": 2, "creation_date": 1432768573, "post_id": 30494461, "comment_id": 49066940, "body": "@BenVoigt Yes, I agree with you (I upvoted you for being technically correct, and for cleverness). I just have a feeling it isn&#39;t what the question-asker actually meant by the question - but I could be wrong, lacking proof to the contrary in the form of the person coming back and specifying."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1432768816, "post_id": 30494461, "comment_id": 49067006, "body": "Even assuming <code>int</code> has enough precision to store such a value, that code <i>still</i> won&#39;t compile..."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1432769083, "post_id": 30494461, "comment_id": 49067083, "body": "@undefinedbehaviour: Are you referring to the missing <code>#include</code>s?  Clearly this is a snippet, not an entire compilation unit.  Or perhaps the fact that C doesn&#39;t have <code>std::cout</code>?"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1432769838, "post_id": 30494461, "comment_id": 49067345, "body": "@BenVoigt Analyse <code>for (; int * offend = arr + n; ++arr)</code>"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1432770319, "post_id": 30494461, "comment_id": 49067458, "body": "Surely not what was intended, but it is a legal infinite loop. Except for the lack of side effects. It is not optimization stable, but then nothing in this function is."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1432772966, "post_id": 30494461, "comment_id": 49068107, "body": "Since when did the expression <code>int * offend = array + n</code> result in a boolean value? <i>edit</i>: Hmmmmmm..."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1432792915, "post_id": 30494461, "comment_id": 49073430, "body": "While your analysis is strictly correct, I think that OP was reasoning at &quot;common algorithmic level&quot; and there is no overflow at that point."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1432792967, "post_id": 30494461, "comment_id": 49073451, "body": "@Jean-BaptisteYun&#232;s: Then he should have specified a different language (perhaps <a href=\"https://stackoverflow.com/questions/tagged/pseudocode\">pseudocode</a>)"}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": false, "score": 5, "last_activity_date": 1432767545, "last_edit_date": 1492087846, "creation_date": 1432767198, "answer_id": 30494461, "question_id": 30494296, "link": "https://stackoverflow.com/questions/30494296/is-this-technically-an-on-algorithm/30494461#30494461", "title": "Is this technically an O(n) algorithm?", "body": "<p><strong>No, it is not O(n).</strong></p>\n\n<p>If your compiler doesn't have an extended integral type with over 96 bits, it will be rejected as ill-formed.  If it does compile (128 bit integral types are not unheard of), the situation is potentially even worse...</p>\n\n<p>The behavior, and therefore the complexity, are both undefined, due to overflow of the signed integer variable <code>k</code>.  On many sane compilers, this code will never terminate, which makes it worse than an algorithm with O(n<sup>n</sup>!) complexity... in fact, it's also worse than the tower of powers seen in <a href=\"https://puzzling.stackexchange.com/q/13050/10031\">The Magic Money Machine</a>.</p>\n\n<p>If you see this code in an interview, it leads naturally into a discussion of the merits of correctness over performance.</p>\n"}], "owner": {"reputation": 351, "user_id": 4905335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ba66eb8a28b943066353287470184fc8?s=128&d=identicon&r=PG&f=1", "display_name": "user4905335", "link": "https://stackoverflow.com/users/4905335/user4905335"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "closed_date": 1432841942, "answer_count": 2, "score": 0, "last_activity_date": 1432823099, "creation_date": 1432766232, "last_edit_date": 1432823099, "question_id": 30494296, "link": "https://stackoverflow.com/questions/30494296/is-this-technically-an-on-algorithm", "closed_reason": "Needs details or clarity", "title": "Is this technically an O(n) algorithm?", "body": "<p>From my understanding of algorithms, the following is technically a linear solution.</p>\n\n<pre><code>int max ( int * arr, size_t n )\n{\n    for (int k = 0; k &lt; 100000000000000000000000000000; ++k)\n        std::cout &lt;&lt; rand(); // doesn't do anything useful   \n\n    int largest = *arr; \n\n    for (int * offend = arr + n; arr != offend; ++arr)\n        if (*arr &gt; largest)\n            largest = *arr;    \n\n    return largest;\n}\n</code></pre>\n\n<p>In fact, I can add as much garbage as I want to it, and as long as the number of operations <strong>grows</strong> linearly with respect to <code>n</code>, it's considered a \"better\" algorithm according to modern-day interviewers. Is that correct?</p>\n"}, {"tags": ["c++", "qt", "pointers", "qgraphicsscene", "qlist"], "answers": [{"tags": [], "owner": {"reputation": 28669, "user_id": 3049264, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MNMWc.jpg?s=128&g=1", "display_name": "Nejat", "link": "https://stackoverflow.com/users/3049264/nejat"}, "is_accepted": true, "score": 2, "last_activity_date": 1432789589, "creation_date": 1432789589, "answer_id": 30497642, "question_id": 30494275, "link": "https://stackoverflow.com/questions/30494275/cleaning-up-qlist-and-qgraphicsscene-to-avoid-memory-leaks/30497642#30497642", "title": "Cleaning up QList and QGraphicsScene to avoid memory leaks", "body": "<p><strong>1.</strong>\n<code>qDeleteAll</code> deletes items in a container using the C++ <code>delete</code> operator. It's also stated in the Qt documentation about <code>QGraphicsScene</code> destructor:</p>\n\n<blockquote>\n  <p>Removes and deletes all items from the scene object before destroying\n  the scene object</p>\n</blockquote>\n\n<p>So it's enough to call <code>qDeleteAll(s)</code>.</p>\n\n<p><strong>2.</strong>\nThere is no need to delete lists of basic or Qt types like <code>QList&lt;int&gt;</code> or <code>QList&lt;QImage&gt;</code> as they are deleted when the list is deleted.</p>\n\n<p><strong>3.</strong>\n<code>QGraphicsScene::clear()</code> removes and deletes all items from the scene. So calling <code>scene().clear();</code> is enough. It's equivalent to calling :</p>\n\n<pre><code>qDeletaAll( scene()-&gt;items() );\n</code></pre>\n\n<p><strong>4.</strong>\nSince a view does not take ownership of scene, you should delete the previously assigned scenes using <code>deleteLater()</code> :</p>\n\n<pre><code>for (int i = 0; i &lt; s.size(); ++i)\n{\n    view[i]-&gt;scene()-&gt;deleteLater();\n    view[i]-&gt;setScene(s.at(i)); // view is a QList&lt;QGraphicsView*&gt;\n}\n</code></pre>\n"}], "owner": {"reputation": 11175, "user_id": 1217150, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/6ryIf.png?s=128&g=1", "display_name": "Thalia", "link": "https://stackoverflow.com/users/1217150/thalia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1517, "favorite_count": 0, "accepted_answer_id": 30497642, "answer_count": 1, "score": 1, "last_activity_date": 1432840220, "creation_date": 1432766121, "last_edit_date": 1432840220, "question_id": 30494275, "link": "https://stackoverflow.com/questions/30494275/cleaning-up-qlist-and-qgraphicsscene-to-avoid-memory-leaks", "title": "Cleaning up QList and QGraphicsScene to avoid memory leaks", "body": "<p>I want to be thorough and clean up to avoid memory and object leaks.</p>\n\n<p>I had the misunderstanding that Qt cleans automatically objects that go out of scope, except pointers need to be deleted manually.</p>\n\n<p>In my code I have a number of <code>QList</code>... example:</p>\n\n<pre><code>void someFunction()\n{\n    QList&lt;int&gt; x = QList&lt;int&gt;() &lt;&lt; 0 &lt;&lt; 0 &lt;&lt; 0 &lt;&lt; 0;\n    QList&lt;QImage&gt; y; // filled in some way\n    QList&lt;QGraphicsScene*&gt; s;\n\n    s = otherFunction(x, y);\n}\n\nQList&lt;QGraphicsScene*&gt; otherFunction(QList&lt;int&gt;&amp; x, const QList&lt;QImage&gt;&amp; y)\n{\n    QList&lt;QGraphicsScene*&gt; s; \n    s.push_back(this-&gt;scene());  // a few times; of course there is some processing...\n    return s;\n}\n\nvoid thirdFunction()\n{\n    QList&lt;int&gt; x = QList&lt;int&gt;() &lt;&lt; 0 &lt;&lt; 0 &lt;&lt; 0 &lt;&lt; 0;\n    QList&lt;QImage&gt; y; // filled in some way\n    QList&lt;QGraphicsScene*&gt; s;\n\n    s = otherFunction(x, y);\n    for (int i = 0; i &lt; s.size(); ++i)\n    {\n        view[i]-&gt;setScene(s.at(i)); // view is a QList&lt;QGraphicsView*&gt;\n    }\n}\n</code></pre>\n\n<p>Called multiple times, I can see the memory increasing (seen from task manager).</p>\n\n<p>Obviously when items go out of scope, they are not being deleted... I immediately suspected the list of scene pointers. </p>\n\n<p>1) What is the best way to delete them ? Will </p>\n\n<pre><code>qDeleteAll(s);\n</code></pre>\n\n<p>in <code>someFunction()</code> be enough ? Will it delete the scene pointers, as well as all the <code>QGraphicItems</code> inside the scenes ? or do I need to iterate through the list of scenes, and delete all items ? Do I have to do this :</p>\n\n<pre><code>    for (int i = 0; i &lt; s.size(); ++i)\n    {\n        s.at(i).clear();\n    } // then\n    qDeleteAll(s);\n</code></pre>\n\n<p>2) Do I need to delete the lists of simple variables (<code>int</code>, <code>bool</code>) ?<br>\nWhat about lists of objects, like <code>QImage</code> ?</p>\n\n<p>3) I assumed that removing an item from the scene deletes its pointer. But now I read that, after removing an item from the scene, it needs to be deleted manually. So does</p>\n\n<pre><code>scene().clear();\n</code></pre>\n\n<p>delete the <code>QGraphicItem</code> pointers that have been added to the scene ? Or should the items be deleted as well using a <code>delete</code> call ?</p>\n\n<p><strong>4)</strong> In the <code>thirdFunction</code>, do I have a memory leak ? It seems like I do !!<br>\nI can't delete the scenes since I set them onto views... but what happens to the scenes that were assigned to the views already ?<br>\nHow do I clean that correctly ?</p>\n"}, {"tags": ["c++", "sql-server", "odbc", "32bit-64bit"], "answers": [{"comments": [{"owner": {"reputation": 23367, "user_id": 78162, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1497a61bc7f673e30f224a3df61a6742?s=128&d=identicon&r=PG", "display_name": "BlueMonkMN", "link": "https://stackoverflow.com/users/78162/bluemonkmn"}, "edited": false, "score": 0, "creation_date": 1433160301, "post_id": 30572927, "comment_id": 49216002, "body": "Why does SQL_IS_UINTEGER exist... for use in other contexts?"}, {"owner": {"reputation": 1530, "user_id": 2264956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a7410a06675e9d42a06e2e3a74c3dae?s=128&d=identicon&r=PG", "display_name": "erg", "link": "https://stackoverflow.com/users/2264956/erg"}, "reply_to_user": {"reputation": 23367, "user_id": 78162, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1497a61bc7f673e30f224a3df61a6742?s=128&d=identicon&r=PG", "display_name": "BlueMonkMN", "link": "https://stackoverflow.com/users/78162/bluemonkmn"}, "edited": false, "score": 0, "creation_date": 1433160356, "post_id": 30572927, "comment_id": 49216040, "body": "No idea, I havent been using SQL_IS_UINTEGER."}], "tags": [], "owner": {"reputation": 1530, "user_id": 2264956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a7410a06675e9d42a06e2e3a74c3dae?s=128&d=identicon&r=PG", "display_name": "erg", "link": "https://stackoverflow.com/users/2264956/erg"}, "is_accepted": true, "score": 0, "last_activity_date": 1433160288, "last_edit_date": 1433160288, "creation_date": 1433159960, "answer_id": 30572927, "question_id": 30494128, "link": "https://stackoverflow.com/questions/30494128/64-bit-sqlgetstmtattr-writes-8-bytes-to-value-buffer-when-returning-sqluinteger/30572927#30572927", "title": "64-bit SQLGetStmtAttr writes 8 bytes to value buffer when returning SQLUINTEGER", "body": "<p>Shouldn't you use a <code>SQLULEN</code> as Buffer (your <code>uiCursorType</code>)? In 64bit <code>SQLULEN</code>is defined to <code>INT64</code>, which would be the 8 byte you are observing.</p>\n\n<p>The Doc at Microsoft about <code>SQL_ATTR_CURSOR_TYPE</code> ( <a href=\"https://msdn.microsoft.com/en-us/library/ms712631%28v=vs.85%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms712631%28v=vs.85%29.aspx</a> ) says that the value is <code>SQLULEN</code>.</p>\n\n<blockquote>\n  <p>SQL_ATTR_CURSOR_TYPE (ODBC 2.0)<br>\n  An SQLULEN value that specifies the cursor type:</p>\n</blockquote>\n\n<p>Also <strong>note that the driver will most probably ignore the value of <code>BufferLength</code>,</strong> if the attribute is not a string or binary attribute ( <a href=\"https://msdn.microsoft.com/en-us/library/ms715438%28v=vs.85%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms715438%28v=vs.85%29.aspx</a> ):</p>\n\n<blockquote>\n  <p>If Attribute is an ODBC-defined attribute and *ValuePtr is an integer, BufferLength is ignored.</p>\n</blockquote>\n"}], "owner": {"reputation": 23367, "user_id": 78162, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1497a61bc7f673e30f224a3df61a6742?s=128&d=identicon&r=PG", "display_name": "BlueMonkMN", "link": "https://stackoverflow.com/users/78162/bluemonkmn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 30572927, "answer_count": 1, "score": 0, "last_activity_date": 1433160288, "creation_date": 1432765418, "question_id": 30494128, "link": "https://stackoverflow.com/questions/30494128/64-bit-sqlgetstmtattr-writes-8-bytes-to-value-buffer-when-returning-sqluinteger", "title": "64-bit SQLGetStmtAttr writes 8 bytes to value buffer when returning SQLUINTEGER", "body": "<p>I'm surprised by what I'm seeing in this block of code:</p>\n\n<pre><code>SQLUINTEGER uiCursorType;\nSQLINTEGER  iLength;\nSQLRETURN sSQLReturn;\nsSQLReturn = SQLGetStmtAttr( shStmtHandle, SQL_ATTR_CURSOR_TYPE, &amp;uiCursorType, SQL_IS_UINTEGER, &amp;iLength);\n</code></pre>\n\n<p>I was initially tipped off that a problem may exist here because when the containing function returns, the Visual Studio (remote) debugger tells me that there is stack corruption near the variable <code>uiCursorType</code>. Investigating further I find that it's likely correct about that. After the <code>SQLGetStmtAttr</code> function executes, the value in <code>uiCursorType</code> is <code>2</code> and the value in <code>iLength</code> is <code>8</code>. Checking the values of <code>sizeof(uiCursorType)</code> and <code>sizeof(SQLUINTEGER)</code> in the debugger, it reports <code>4</code> for both. But I'm led to believe from the value put into <code>iLength</code> that the function actually wrote 8 bytes. I don't see how the code could be any more clear about the value it's expecting back matching the variable buffer it has provided: <code>SQLUINTEGER</code> and <code>SQL_IS_UINTEGER</code> seem pretty well-matched. Is this function buggy on 64-bit platforms?</p>\n\n<p>Doing a Google search, I found some sort of patch at <a href=\"http://lists.freedesktop.org/archives/libreoffice/2012-January/024859.html\" rel=\"nofollow\">http://lists.freedesktop.org/archives/libreoffice/2012-January/024859.html</a> that appears to be related, but I don't know how to find more information about it. Is there more information about this problem and how to fix it available?</p>\n"}, {"tags": ["c++", "variables", "input", "format", "tab-delimited"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432765270, "post_id": 30494022, "comment_id": 49065847, "body": "You may be find some hints here: <a href=\"http://stackoverflow.com/questions/23047052/why-does-reading-a-struct-record-fields-from-stdistream-fail-and-how-can-i-fi\" title=\"why does reading a struct record fields from stdistream fail and how can i fi\">stackoverflow.com/questions/23047052/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 4946555, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6ee66251981471e141afeabbc4163f8?s=128&d=identicon&r=PG&f=1", "display_name": "penguin", "link": "https://stackoverflow.com/users/4946555/penguin"}, "edited": false, "score": 0, "creation_date": 1432918182, "post_id": 30494860, "comment_id": 49143513, "body": "Thanks, your answered worked great for another section with fewer variables. Because of the number of variables in this part though, I found this code after more searching: stringstream ss(FAImport);                          auto temp = ctype&lt;char&gt;::classic_table();             vector&lt;ctype&lt;char&gt;::mask&gt; bar(temp, temp + ctype&lt;char&gt;::table_size);                          bar[&#39; &#39;] ^= ctype_base::space;                          ss.imbue(locale(cin.getloc(), new ctype&lt;char&gt;(bar.data())));"}], "tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": true, "score": 1, "last_activity_date": 1432771135, "last_edit_date": 1432771135, "creation_date": 1432769628, "answer_id": 30494860, "question_id": 30494022, "link": "https://stackoverflow.com/questions/30494022/c-reading-tab-delimited-input-and-skipping-blank-fields/30494860#30494860", "title": "C++ Reading tab-delimited input and skipping blank fields", "body": "<p>You've solved the issue with spaces in the fields in an elegant manner.  Unfortunately, <code>operator&gt;&gt;</code> will skip consecutive tabs, as if they were one single separator. So,  good bye the empty fields ?  </p>\n\n<p>One easy way to do it is to use <code>getline()</code> to read individual string fields:  </p>\n\n<pre><code>getline (ss, coTitle, '\\t'); \ngetline (ss, altTitle, '\\t'); \ngetline (ss, description, '\\t');\n...\n</code></pre>\n\n<p>Another way is </p>\n"}], "owner": {"reputation": 103, "user_id": 4946555, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6ee66251981471e141afeabbc4163f8?s=128&d=identicon&r=PG&f=1", "display_name": "penguin", "link": "https://stackoverflow.com/users/4946555/penguin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1414, "favorite_count": 0, "accepted_answer_id": 30494860, "answer_count": 1, "score": 3, "last_activity_date": 1432771135, "creation_date": 1432764890, "question_id": 30494022, "link": "https://stackoverflow.com/questions/30494022/c-reading-tab-delimited-input-and-skipping-blank-fields", "title": "C++ Reading tab-delimited input and skipping blank fields", "body": "<p>I am making a program that will take a long string of tab-delimited metadata pasted into the console by the user and split them into their correct variables. I have completed the code to split the line up by tab, but there are empty fields that should be skipped in order to put the correct metadata into the correct string variable, which I can't get to work.</p>\n\n<p>Here is the code that I have so far:</p>\n\n<pre><code>string dummy;\nstring FAImport;\ncin.ignore(1000, '\\n');\ncout &lt;&lt; \"\\nPlease copy and paste the information from the finding aid and press Enter: \";\ngetline(cin, FAImport);\ncout &lt;&lt; FAImport;\n\nstringstream ss(FAImport);\n\nauto temp = ctype&lt;char&gt;::classic_table();\nvector&lt;ctype&lt;char&gt;::mask&gt; bar(temp, temp + ctype&lt;char&gt;::table_size);\n\nbar[' '] ^= ctype_base::space;\n\nss.imbue(locale(cin.getloc(), new ctype&lt;char&gt;(bar.data())));\n\nss &gt;&gt; coTitle &gt;&gt; altTitle &gt;&gt; description &gt;&gt; dateSpan &gt;&gt; edition &gt;&gt; publisher &gt;&gt; \nphysicalDescription &gt;&gt; scale &gt;&gt; extentField &gt;&gt; medium &gt;&gt; dimensions &gt;&gt; arrangement &gt;&gt; \ndegree &gt;&gt; contributing &gt;&gt; names &gt;&gt; topics &gt;&gt; geoPlaceNames &gt;&gt; genre &gt;&gt; occupations &gt;&gt; \nfunctions &gt;&gt; subject &gt;&gt; langIN &gt;&gt; audience &gt;&gt; condition &gt;&gt; generalNotes &gt;&gt; collection &gt;&gt; \nlinkToFindingAid &gt;&gt; source &gt;&gt; SIRSI &gt;&gt; callNumber;\n\ncheckFAImport(); //shows the values of each variable\ncout &lt;&lt; \"\\n\\nDone\";\n</code></pre>\n\n<p>With this code, I get this output after inputing the metadata:</p>\n\n<pre><code>coTitle = William Gates photograph with Emiliano Zapata\naltTitle = 1915\ndescription = 1915\ndatespan = Electronic version\nedition = 1 photograph : sepia ; 11 x 13 cm\npublisher = L. Tom Perry Special Collections, Harold B. Lee Library, Brigham Young University\nphysicalDescription = Photographs\nscale = William Gates papers\nextentField = http://findingaid.lib.byu.edu/viewItem/MSS%20279/Series%2011/Subseries%205/Item%20979/box%20128/folder%2012\nmedium = William Gates photograph with Emiliano Zapata; MSS 279; William Gates papers; L. Tom Perry Special Collections; 20th Century Western &amp; Mormon Manuscripts; 1130 Harold B. Lee Library; Brigham Young University; Provo, Utah 84602; http://sc.lib.byu.edu/\ndimensions = MSS 279 Series 11 Subseries 5 Item 979 box 128 folder 12\narrangement = \ndegree = \ncontributing = \nnames = \ntopics = \ngeoPlaceNames = \ngenre = \noccupations = \nfunctions = \nsubject = \nlangIN = \naudience = \ncondition = \ngeneralNotes = \ncollection = \nlinkToFindingAid =  \nsource = \nSIRSI = \ncallNumber = \n</code></pre>\n\n<p>In this example, fields like altTitle and description should be blank and skipped. Any help would be much appreciated.</p>\n"}, {"tags": ["c++", "opencv"], "answers": [{"comments": [{"owner": {"reputation": 3189, "user_id": 2397253, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/CLLjm.png?s=128&g=1", "display_name": "oarfish", "link": "https://stackoverflow.com/users/2397253/oarfish"}, "edited": false, "score": 0, "creation_date": 1435558951, "post_id": 30511750, "comment_id": 50232168, "body": "What did you use for EPSILON?"}], "tags": [], "owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "is_accepted": false, "score": 2, "last_activity_date": 1432835736, "last_edit_date": 1432835736, "creation_date": 1432829105, "answer_id": 30511750, "question_id": 30493928, "link": "https://stackoverflow.com/questions/30493928/opencv-triangulatepoints-strange-result/30511750#30511750", "title": "opencv triangulatePoints, strange result", "body": "<p>cancel that, i managed to do it by ignoring the cv::triangulate function and using this method here:</p>\n\n<p><a href=\"http://www.morethantechnical.com/2012/01/04/simple-triangulation-with-opencv-from-harley-zisserman-w-code/\" rel=\"nofollow\">http://www.morethantechnical.com/2012/01/04/simple-triangulation-with-opencv-from-harley-zisserman-w-code/</a></p>\n\n<p>with a small change to fix some code that was in wrong place...</p>\n\n<pre><code>Mat_&lt;double&gt; IterativeLinearLSTriangulation(Point3d u,    //homogenous image point (u,v,1)\n    Matx34d P,          //camera 1 matrix\n    Point3d u1,         //homogenous image point in 2nd camera\n    Matx34d P1          //camera 2 matrix\n    ) {\n\n    double wi = 1, wi1 = 1;\n    Mat_&lt;double&gt; X(4, 1);\n\n\n\n    for (int i = 0; i &lt; 10; i++) { //Hartley suggests 10 iterations at most\n        Mat_&lt;double&gt; X_ = LinearLSTriangulation(u, P, u1, P1);\n    X(0) = X_(0); X(1) = X_(1); X(2) = X_(2); X(3) = 1.0;\n        //recalculate weights\n        double p2x = Mat_&lt;double&gt;(Mat_&lt;double&gt;(P).row(2)*X)(0);\n        double p2x1 = Mat_&lt;double&gt;(Mat_&lt;double&gt;(P1).row(2)*X)(0);\n\n        //breaking point\n        if (fabsf(wi - p2x) &lt;= EPSILON &amp;&amp; fabsf(wi1 - p2x1) &lt;= EPSILON) break;\n\n        wi = p2x;\n        wi1 = p2x1;\n\n        //reweight equations and solve\n        Matx43d A((u.x*P(2, 0) - P(0, 0)) / wi, (u.x*P(2, 1) - P(0, 1)) / wi, (u.x*P(2, 2) - P(0, 2)) / wi,\n            (u.y*P(2, 0) - P(1, 0)) / wi, (u.y*P(2, 1) - P(1, 1)) / wi, (u.y*P(2, 2) - P(1, 2)) / wi,\n            (u1.x*P1(2, 0) - P1(0, 0)) / wi1, (u1.x*P1(2, 1) - P1(0, 1)) / wi1, (u1.x*P1(2, 2) - P1(0, 2)) / wi1,\n            (u1.y*P1(2, 0) - P1(1, 0)) / wi1, (u1.y*P1(2, 1) - P1(1, 1)) / wi1, (u1.y*P1(2, 2) - P1(1, 2)) / wi1\n            );\n        Mat_&lt;double&gt; B = (Mat_&lt;double&gt;(4, 1) &lt;&lt; -(u.x*P(2, 3) - P(0, 3)) / wi,\n            -(u.y*P(2, 3) - P(1, 3)) / wi,\n            -(u1.x*P1(2, 3) - P1(0, 3)) / wi1,\n            -(u1.y*P1(2, 3) - P1(1, 3)) / wi1\n            );\n\n        solve(A, B, X_, DECOMP_SVD);\n        X(0) = X_(0); X(1) = X_(1); X(2) = X_(2); X(3) = 1.0;\n    }\n\n    return X;\n}\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>Mat_&lt;double&gt; LinearLSTriangulation(Point3d u,       //homogenous image point (u,v,1)\n    Matx34d P,       //camera 1 matrix\n    Point3d u1,      //homogenous image point in 2nd camera\n    Matx34d P1       //camera 2 matrix\n    )\n{\n    //build matrix A for homogenous equation system Ax = 0\n    //assume X = (x,y,z,1), for Linear-LS method\n    //which turns it into a AX = B system, where A is 4x3, X is 3x1 and B is 4x1\n    Matx43d A(u.x*P(2, 0) - P(0, 0), u.x*P(2, 1) - P(0, 1), u.x*P(2, 2) - P(0, 2),\n        u.y*P(2, 0) - P(1, 0), u.y*P(2, 1) - P(1, 1), u.y*P(2, 2) - P(1, 2),\n        u1.x*P1(2, 0) - P1(0, 0), u1.x*P1(2, 1) - P1(0, 1), u1.x*P1(2, 2) - P1(0, 2),\n        u1.y*P1(2, 0) - P1(1, 0), u1.y*P1(2, 1) - P1(1, 1), u1.y*P1(2, 2) - P1(1, 2)\n        );\n    Mat_&lt;double&gt; B = (Mat_&lt;double&gt;(4, 1) &lt;&lt; -(u.x*P(2, 3) - P(0, 3)),\n        -(u.y*P(2, 3) - P(1, 3)),\n        -(u1.x*P1(2, 3) - P1(0, 3)),\n        -(u1.y*P1(2, 3) - P1(1, 3)));\n\n    Mat_&lt;double&gt; X;\n    solve(A, B, X, DECOMP_SVD);\n\n    return X;\n}\n</code></pre>\n"}], "owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1082, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1432835736, "creation_date": 1432764333, "question_id": 30493928, "link": "https://stackoverflow.com/questions/30493928/opencv-triangulatepoints-strange-result", "title": "opencv triangulatePoints, strange result", "body": "<p>I am using the triagulatePoints function in opencv. Finally I have it working, after much despair, but the results do not look right. I have read some other questions on this, but I still don't understand it!</p>\n\n<p>I am running:</p>\n\n<pre><code>cv::Mat Q,P1,P2,LP,RP,D1,D2,M1,M2;\n    char *CALIB_FILE = (char *)\"extrinsics.xml\";\n    FileStorage fs(CALIB_FILE, FileStorage::READ);\n    fs[\"Q\"] &gt;&gt; Q;\n    fs[\"P1\"] &gt;&gt; P1;\n    fs[\"P2\"] &gt;&gt; P2;\n\n\n    cv::Mat cam0pnts(1, 5, CV_64FC2);  //681 432 479    419 550 320 682 274 495 254\n    cv::Mat cam1pnts(1, 5, CV_64FC2); //800 466 587 451 657 352 791 311 592 283\n\n    cv::Mat points_3D(1, 5, CV_64FC4);   \n\n\n    cv::triangulatePoints(P1, P2, cam0pnts, cam1pnts, points_3D);\n</code></pre>\n\n<p>P1 and P2 are the calculated extrinsics from the stereo_calib function.</p>\n\n<p>There are 5 points, a rough square with a point in each corner and one in the middle.</p>\n\n<p>The resulting Matrix is:</p>\n\n<pre><code> [-0.6620691274599629, 0.6497615623177577, -0.6585234150236594, 0.6529909432980171, -0.6604373884239706;\n  -0.7091492226203088, 0.7208075295879011, -0.7119285643550911, 0.7174438199266364, -0.710244308941275;\n  0.242429054072024, -0.2413429417514131, 0.2439357048056051, -0.2426462227979475, 0.2436708320163396;\n  -6.52928664505207e-005, -4.348043360405063e-005, -5.515313727475824e-005, -6.149577656504346e-005, -5.668087253108842e-005]\n</code></pre>\n\n<p>Which, when plotted in 3d, gives two positions that look almost correct, if completely scaled wrong, then three duplicates of those two.</p>\n\n<p>Where am I going wrong here? DO I need to do something to the resulting matrix to get an xyz coordinate? Or have I implemented the function incorrectly?</p>\n"}, {"tags": ["python", "c++", "opencv", "python-3.x", "makefile"], "comments": [{"owner": {"reputation": 825, "user_id": 1092525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c9890baebf98867466c153628e4e8abe?s=128&d=identicon&r=PG", "display_name": "Snesticle", "link": "https://stackoverflow.com/users/1092525/snesticle"}, "edited": false, "score": 0, "creation_date": 1438269779, "post_id": 30493592, "comment_id": 51391513, "body": "Did you ever get this to work? I need to use the python 3 pyd for blender but can&#39;t get it to compile. I&#39;ve been trying for 2 days and can get it to complete ONLY if I tell it I don&#39;t want the python 3 module or if I compile in gnu-linux both of which defeat my purpose. They really need to either include the pyd in the download like they do for python 2.7 or fix the plethora of compiling issues."}], "owner": {"reputation": 83, "user_id": 3053341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sMfSM.jpg?s=128&g=1", "display_name": "Grant", "link": "https://stackoverflow.com/users/3053341/grant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1374, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1432762621, "creation_date": 1432762621, "question_id": 30493592, "link": "https://stackoverflow.com/questions/30493592/error-building-opencv-3-0-0-rc1-on-windows-7-64-bit-cannot-compile-link-cv2-p", "title": "Error building OpenCV 3.0.0 rc1 on Windows 7 (64-bit): Cannot compile/link cv2.pyd for Python 3.4", "body": "<p>I am going through some beginner computer vision lessons and I would like to use Python 3.4 instead of 2.7 for the lessons, and I have both versions installed on my computer in <code>C:/Python34</code> and <code>C:/Python27</code>, respectively. I'm able to <code>import cv2</code> into The most recent release of OpenCV, which the lessons require, does support using the cv2 module in Python 3but it has to be built from the source.</p>\n\n<p>To do this, I've used the cmake-gui to create the necessary make files in <code>c:/opencv</code>, and I initiate the build by executing <code>make -j4</code> in the <code>c:/opencv/build</code> directory cmake created. Note that I'm using the mingw32-make command, not visual studios. Both my <code>gcc</code> and <code>g++</code> compilers work fine; I'm using versions 5.1.0 of both. The full configuration of my generated makefiles is pasted below. I have made a few edits to overcome other compiler errors often encountered.</p>\n\n<p>At present, the build is almost successful (getting to \"100%\" before failing). The error occurs at the step <em>Linking CXX shared library ....\\lib\\cv2.pyd</em>, <code>cv2.pyd</code> being the python library I need to compile in order to import opencv. The full error that stops compilation is this:</p>\n\n<p><code>\nLinking CXX shared library ..\\..\\lib\\cv2.pyd\nmodules\\python3\\CMakeFiles\\opencv_python3.dir\\build.make:215: recipe for target 'lib/cv2.pyd' failed\nCMakeFiles\\Makefile2:7114: recipe for target 'modules/python3/CMakeFiles/opencv_python3.dir/all' failed\nmakefile:135: recipe for target 'all' failed\n</code></p>\n\n<p>I've taken a look at the lines specified in the makefiles, but can't see anything that would give me a clue what's going wrong with the linking. I also notice, in the cmake configuration below, that the Python (for build) parameter is set to the pyhon27 executable instead of python34, but haven't been able to find the right parameter to change this, and I'm not certain this is even related to the issue. If anyone has suggestions for how to fix this and make opencv build the pyd for Python 3.4, please chime in.</p>\n\n<h1>CMake configuration</h1>\n\n<blockquote>\n  <p>Detected version of GNU GCC: 51 (501)\n  CUDA compilation is disabled (due to only Visual Studio compiler supported on your platform).\n  Could NOT find Doxygen (missing:  DOXYGEN_EXECUTABLE) \n  To enable PlantUML support, set PLANTUML_JAR environment variable or pass -DPLANTUML_JAR= option to cmake\n  Found PythonInterp: C:/Python27/python.exe (found suitable version \"2.7.6\", minimum required is \"2.7\") \n  Found PythonLibs: C:/Python27/libs/libpython27.a (found suitable exact version \"2.7.6\") \n  Found PythonInterp: C:/Python34/python.exe (found suitable version \"3.4.2\", minimum required is \"3.4\") \n  Found PythonLibs: C:/Python34/libs/python34.lib (found suitable exact version \"3.4.2\") \n  VTK is not found. Please set -DVTK_DIR in CMake to VTK build directory, or to VTK install subdirectory with VTKConfig.cmake file\n   videoio: Removing WinRT API headers by default</p>\n  \n  <p>General configuration for OpenCV 3.0.0-dev =====================================\n   Version control:               3.0.0-rc1-240-g1df244b-dirty</p>\n  \n  <p>Platform:\n     Host:                        Windows 6.1 AMD64\n     CMake:                       3.2.2\n     CMake generator:             MinGW Makefiles\n     CMake build tool:            C:/MinGW/bin/make.exe\n     Configuration:               Release></p>\n  \n  <p>C/C++:\n     Built as dynamic libs?:      YES\n     C++ Compiler:                c:/MinGW/bin/g++.exe  (ver 5.1.0)\n     C++ flags (Release):         -fsigned-char -mstackrealign -W -Wall -Werror=return-type -Werror=address -Werror=sequence-point -Wformat -Werror=format-security -Wmissing-declarations -Wundef -Winit-self -Wpointer-arith -Wshadow -Wsign-promo -Wno-narrowing -Wno-delete-non-virtual-dtor -fdiagnostics-show-option -Wno-long-long -fomit-frame-pointer -msse -msse2 -ffunction-sections -fvisibility=hidden -fvisibility-inlines-hidden -O2 -DNDEBUG  -DNDEBUG\n     C++ flags (Debug):           -fsigned-char -mstackrealign -W -Wall -Werror=return-type -Werror=address -Werror=sequence-point -Wformat -Werror=format-security -Wmissing-declarations -Wundef -Winit-self -Wpointer-arith -Wshadow -Wsign-promo -Wno-narrowing -Wno-delete-non-virtual-dtor -fdiagnostics-show-option -Wno-long-long -fomit-frame-pointer -msse -msse2 -ffunction-sections -fvisibility=hidden -fvisibility-inlines-hidden -g  -O0 -DDEBUG -D_DEBUG\n     C Compiler:                  c:/MinGW/bin/gcc.exe\n     C flags (Release):           -fsigned-char -mstackrealign -W -Wall -Werror=return-type -Werror=address -Werror=sequence-point -Wformat -Werror=format-security -Wmissing-declarations -Wmissing-prototypes -Wstrict-prototypes -Wundef -Winit-self -Wpointer-arith -Wshadow -Wno-narrowing -fdiagnostics-show-option -Wno-long-long -fomit-frame-pointer -msse -msse2 -ffunction-sections -fvisibility=hidden -O2 -DNDEBUG  -DNDEBUG\n     C flags (Debug):             -fsigned-char -mstackrealign -W -Wall -Werror=return-type -Werror=address -Werror=sequence-point -Wformat -Werror=format-security -Wmissing-declarations -Wmissing-prototypes -Wstrict-prototypes -Wundef -Winit-self -Wpointer-arith -Wshadow -Wno-narrowing -fdiagnostics-show-option -Wno-long-long -fomit-frame-pointer -msse -msse2 -ffunction-sections -fvisibility=hidden -g  -O0 -DDEBUG -D_DEBUG\n     Linker flags (Release):<br>\n     Linker flags (Debug):<br>\n     Precompiled headers:         YES\n     Extra dependencies:          comctl32 gdi32 ole32 setupapi ws2_32 avifil32 avicap32 winmm msvfw32\n     3rdparty dependencies:       zlib libjpeg libwebp libpng libtiff libjasper IlmImf></p>\n  \n  <p>OpenCV modules:\n     To be built:                 hal core flann imgproc ml photo video imgcodecs shape videoio highgui objdetect superres ts features2d calib3d stitching videostab python3\n     Disabled:                    python2 world\n     Disabled by dependency:      -\n     Unavailable:                 androidcamera cudaarithm cudabgsegm cudacodec cudafeatures2d cudafilters cudaimgproc cudalegacy cudaobjdetect cudaoptflow cudastereo cudawarping cudev java viz</p>\n  \n  <p>Windows RT support:            NO</p>\n  \n  <p>GUI: \n     QT:                          NO\n     Win32 UI:                    YES\n     OpenGL support:              NO\n     VTK support:                 NO</p>\n  \n  <p>Media I/O: \n     ZLib:                        build (ver 1.2.8)\n     JPEG:                        build (ver 90)\n     WEBP:                        build (ver 0.3.1)\n     PNG:                         build (ver 1.5.12)\n     TIFF:                        build (ver 42 - 4.0.2)\n     JPEG 2000:                   build (ver 1.900.1)\n     OpenEXR:                     build (ver 1.7.1)\n     GDAL:                        NO</p>\n  \n  <p>Video I/O:\n     Video for Windows:           YES\n     DC1394 1.x:                  NO\n     DC1394 2.x:                  NO\n     FFMPEG:                      YES (prebuilt binaries)\n       codec:                     YES (ver 55.18.102)\n       format:                    YES (ver 55.12.100)\n       util:                      YES (ver 52.38.100)\n       swscale:                   YES (ver 2.3.100)\n       resample:                  NO\n       gentoo-style:              YES\n     OpenNI:                      NO\n     OpenNI PrimeSensor Modules:  NO\n     OpenNI2:                     NO\n     PvAPI:                       NO\n     GigEVisionSDK:               NO\n     DirectShow:                  YES\n     Media Foundation:            NO\n     XIMEA:                       NO\n     Intel PerC:                  NO</p>\n  \n  <p>Other third-party libraries:\n     Use IPP:                     NO\n     Use IPP Async:               NO\n     Use Eigen:                   NO\n     Use TBB:                     NO\n     Use OpenMP:                  NO\n     Use GCD                      NO\n     Use Concurrency              NO\n     Use C=:                      NO\n     Use Cuda:                    NO\n     Use OpenCL:                  YES</p>\n  \n  <p>OpenCL:\n     Version:                     dynamic\n     Include path:                C:/opencv/3rdparty/include/opencl/1.2\n     Use AMDFFT:                  NO\n     Use AMDBLAS:                 NO</p>\n  \n  <p>Python 2:\n     Interpreter:                 C:/Python27/python.exe (ver 2.7.6)</p>\n  \n  <p>Python 3:\n     Interpreter:                 C:/Python34/python.exe (ver 3.4.2)\n     Libraries:                   C:/Python34/libs/python34.lib (ver 3.4.2)\n     numpy:                       C:/Python34/lib/site-packages/numpy/core/include (ver 1.9.2)\n     packages path:               C:/Python34/Lib/site-packages</p>\n  \n  <p>Python (for build):            C:/Python27/python.exe</p>\n  \n  <p>Java:\n     ant:                         NO\n     JNI:                         C:/Program Files/Java/jdk1.7.0_03/include C:/Program Files/Java/jdk1.7.0_03/include/win32 C:/Program Files/Java/jdk1.7.0_03/include\n     Java wrappers:               NO\n     Java tests:                  NO</p>\n  \n  <p>Matlab:\n     mex:                         C:/Program Files (x86)/MATLAB/R2009a Student/bin/mex.bat\n     Compiler/generator:          Not working (bindings will not be generated)</p>\n  \n  <p>Documentation:\n     Doxygen:                     NO\n     PlantUML:                    NO</p>\n  \n  <p>Tests and samples:\n     Tests:                       YES\n     Performance tests:           YES\n     C/C++ Examples:              NO</p>\n  \n  <p>Install path:                  C:/opencv/build/install</p>\n  \n  <h2> cvconfig.h is in:              C:/opencv/build</h2>\n  \n  <p>Configuring done\n  Generating done</p>\n</blockquote>\n"}, {"tags": ["c++", "qt", "qhash"], "comments": [{"owner": {"reputation": 7482, "user_id": 313175, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/17983e85ea926e9e985c00d1a771f24a?s=128&d=identicon&r=PG", "display_name": "Alexander V", "link": "https://stackoverflow.com/users/313175/alexander-v"}, "edited": false, "score": 0, "creation_date": 1432762987, "post_id": 30493439, "comment_id": 49065052, "body": "panofish, not exactly clear on your task. Please provide what the search returns for A and please add C and what would it return for it?"}], "answers": [{"tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": false, "score": 1, "last_activity_date": 1432763274, "creation_date": 1432763274, "answer_id": 30493733, "question_id": 30493439, "link": "https://stackoverflow.com/questions/30493439/building-a-qhash-with-qstringlist-in-c/30493733#30493733", "title": "Building a QHash with QStringList in C++", "body": "<p>I think all you need to do to add a value to a QStringList in your QHash is:</p>\n\n<pre><code>QStringList &amp; mylist = myhash[key];  // will create and insert an empty QStringList if necessary\nmylist.append(value);\n</code></pre>\n"}], "owner": {"reputation": 6472, "user_id": 259538, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/8zSjE.png?s=128&g=1", "display_name": "panofish", "link": "https://stackoverflow.com/users/259538/panofish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432818762, "creation_date": 1432761967, "last_edit_date": 1432818762, "question_id": 30493439, "link": "https://stackoverflow.com/questions/30493439/building-a-qhash-with-qstringlist-in-c", "title": "Building a QHash with QStringList in C++", "body": "<p>In C++ I am trying to build a specialized QHash like this:</p>\n\n<pre><code>QHash&lt;QString, QStringList&gt; myhash;\n</code></pre>\n\n<p>Such that I can store this type of data:</p>\n\n<pre><code>QHash key    QStringList values\n----------   ------------------\nA            1\n             2\n             3\nB            5\n             6\n</code></pre>\n\n<p>I am having trouble with the C++ syntax to properly build the hash and how to retrieve the hash values.  For example, if given B, the I wish to loop and return 5,6.</p>\n\n<p>Here is my hacked attempt at the logic to append to the hash when a new key,value pair is to be added:</p>\n\n<pre><code>QHash&lt;QString, QStringList&gt; myhash;\n\nkey = \"A\";\nvalue = \"2\";\n\nif (myhash.contains(key) ) {\n    QStringList mylist = myhash.value(key);    \n    mylist.append(value);    \n} else {\n    QStringList mylist;\n    mylist.append(value);\n    myhash.insert( key, mylist);\n}\n</code></pre>\n\n<p>I'm unsure if this works, since I haven't been able to create the retrieve looping logic for the myhash.</p>\n\n<p>Can anyone help me build and retrieve the data from such a QHash?</p>\n"}, {"tags": ["c++", "email", "curl", "cron"], "answers": [{"comments": [{"owner": {"reputation": 3111, "user_id": 1356836, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dAzrF.png?s=128&g=1", "display_name": "Emil A.", "link": "https://stackoverflow.com/users/1356836/emil-a"}, "edited": false, "score": 0, "creation_date": 1432829596, "post_id": 30493677, "comment_id": 49099097, "body": "Thank you, this brings me a little bit closer to the answer. I&#39;ve updated my question after checking the logs, any ideas?"}], "tags": [], "owner": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1432762988, "creation_date": 1432762988, "answer_id": 30493677, "question_id": 30493399, "link": "https://stackoverflow.com/questions/30493399/sending-e-mails-with-curl-from-c/30493677#30493677", "title": "Sending e-mails with curl from C++", "body": "<ol>\n<li><p>switch on <a href=\"http://curl.haxx.se/libcurl/c/CURLOPT_VERBOSE.html\" rel=\"nofollow\">CURLOPT_VERBOSE</a> to 1L</p></li>\n<li><p>log the stderr for your failed attempts and study it after the failures</p></li>\n</ol>\n\n<p>No, the fact that cronjobs send their own mails is not a reason for this code to fail.</p>\n"}], "owner": {"reputation": 3111, "user_id": 1356836, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dAzrF.png?s=128&g=1", "display_name": "Emil A.", "link": "https://stackoverflow.com/users/1356836/emil-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432829877, "creation_date": 1432761792, "last_edit_date": 1432829877, "question_id": 30493399, "link": "https://stackoverflow.com/questions/30493399/sending-e-mails-with-curl-from-c", "title": "Sending e-mails with curl from C++", "body": "<p>I wrote a small piece of code that sends a notification e-mail, here's the function that is responsible for sending it:</p>\n\n<pre><code>int send_mail(const char* mail_path) {\n    CURL *curl;\n    CURLcode curl_code;\n    FILE *message;\n    message = fopen(mail_path, \"r\");\n    struct curl_slist *recipients = NULL;\n\n    curl = curl_easy_init();\n    if (curl) {\n        curl_easy_setopt(curl, CURLOPT_USERNAME, \"XXXX\");\n        curl_easy_setopt(curl, CURLOPT_PASSWORD, \"YYYY\");\n        curl_easy_setopt(curl, CURLOPT_URL, \"ZZZZ\");\n        recipients = curl_slist_append(recipients, \"XXXX\");\n        curl_easy_setopt(curl, CURLOPT_MAIL_RCPT, recipients);\n        curl_easy_setopt(curl, CURLOPT_MAIL_FROM, \"XXX\");\n        curl_easy_setopt(curl, CURLOPT_USE_SSL, CURLUSESSL_ALL);\n        curl_easy_setopt(curl, CURLOPT_READDATA, message);\n        curl_easy_setopt(curl, CURLOPT_UPLOAD, 1L);\n\n        curl_code = curl_easy_perform(curl);\n\n        curl_slist_free_all(recipients);\n        curl_easy_cleanup(curl);\n    }\n\n    return curl_code;\n}\n</code></pre>\n\n<p>It works fine when I'm using it from the command line. </p>\n\n<p>It doesn't send an e-mail though when the script is executed via a cron manager on a remote server which I use. I can send the email properly via the server's cli too.</p>\n\n<p>The code seems to stop working on the curl_easy_perform step, but I'm not sure why - what techniques can be useful to debug such kind of a problem?</p>\n\n<p>Cron jobs are creating emails on their own too - could that be the cause of the problem?</p>\n\n<p>Edit:</p>\n\n<p>I checked the logs and it seems that in case of the cron manager the IP address of the google's smtp service that I'm trying to connect to is different than in case of a script that is run directly from the command line. The logs from cron end after <code>354 Go ahead</code>. Other than that the logs are the same.</p>\n\n<p>cron:</p>\n\n<pre><code>* Rebuilt URL to: smtp://smtp.gmail.com:587/\n*   Trying 173.194.71.108...\n\n...\n\n&gt; DATA\n&lt; 354  Go ahead ra7sm645322lbb.27 - gsmtp\n---- stops here ----\n</code></pre>\n\n<p>command line:</p>\n\n<pre><code>* Rebuilt URL to: smtp://smtp.gmail.com:587/\n*   Trying 74.125.195.109...\n\n...\n\n&lt; 354  Go ahead ex5sm4631837wib.2 - gsmtp\n&lt; 250 2.0.0 OK 1432828708 ex5sm4631837wib.2 - gsmtp\n* Connection #0 to host smtp.gmail.com left intact\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1432761858, "post_id": 30493389, "comment_id": 49064515, "body": "Why don&#39;t you read up on what <code>delete</code> does?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1432762268, "post_id": 30493389, "comment_id": 49064712, "body": "Note that you aren&#39;t &quot;reusing an array&quot; either. <code>asd</code> is a pointer, not an array."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1432764141, "post_id": 30493389, "comment_id": 49065498, "body": "Instead of raw arrays and pointers, use <code>std::vector</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 2910144, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bfd46a7fdd37fbecff245eacdcfacbba?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Miguel Colanta", "link": "https://stackoverflow.com/users/2910144/carlos-miguel-colanta"}, "edited": false, "score": 0, "creation_date": 1432761930, "post_id": 30493426, "comment_id": 49064559, "body": "Thanks for the brief answer."}], "tags": [], "owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "is_accepted": true, "score": 11, "last_activity_date": 1432761936, "last_edit_date": 1432761936, "creation_date": 1432761903, "answer_id": 30493426, "question_id": 30493389, "link": "https://stackoverflow.com/questions/30493389/reusing-a-pointer-to-array-after-deletion/30493426#30493426", "title": "Reusing a pointer to array after deletion", "body": "<blockquote>\n  <p>Doesn't the delete operation on pointers deletes the allocated memory\n  being pointed to by the pointer?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>is alright to reuse pointers after performing delete it on?</p>\n</blockquote>\n\n<p>Yes, that's fine, as long as you set the pointer to the address of a different, valid object, which is what you are doing with your second invocation of <code>new[]</code>.</p>\n\n<p>Note that your question title \"Reusing an array after deletion\", is irrelevant to your question. You are not reusing an array that has been deleted, you are just reusing a pointer that used to point to an array which is now deleted.</p>\n"}], "owner": {"reputation": 2285, "user_id": 2910144, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bfd46a7fdd37fbecff245eacdcfacbba?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Miguel Colanta", "link": "https://stackoverflow.com/users/2910144/carlos-miguel-colanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 30493426, "answer_count": 1, "score": -2, "last_activity_date": 1432762224, "creation_date": 1432761764, "last_edit_date": 1432762224, "question_id": 30493389, "link": "https://stackoverflow.com/questions/30493389/reusing-a-pointer-to-array-after-deletion", "title": "Reusing a pointer to array after deletion", "body": "<p>This the code:</p>\n\n<pre><code>char * asd = new char[10];\ndelete [] asd;\n\nasd = new char[20];\n</code></pre>\n\n<p>Questions:</p>\n\n<ol>\n<li><p>Doesn't the delete operation on pointers deletes the allocated memory being pointed to by the pointer? </p></li>\n<li><p>is alright to reuse pointers after performing delete it on?</p></li>\n</ol>\n"}, {"tags": ["c++", "visual-c++", "for-loop", "struct"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1432761754, "post_id": 30493361, "comment_id": 49064465, "body": "I do not trust that cast to <code>LPCSTR</code> in the slightest."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1432761779, "post_id": 30493361, "comment_id": 49064480, "body": "You probably wanted to declare <code>vector&lt;lines&gt; sub;</code> outside of the <code>for()</code> loop."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 3, "creation_date": 1432761876, "post_id": 30493361, "comment_id": 49064527, "body": "you should post an <a href=\"http://stackoverflow.com/help/mcve\">mcve</a>"}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1432761923, "post_id": 30493361, "comment_id": 49064552, "body": "<code>lines</code> is a <code>struct</code> (data type). <code>lines[i]</code> makes no sense. Maybe you ment <code>sub[i]</code>"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1432765434, "post_id": 30493361, "comment_id": 49065908, "body": "WHY IS YOUR CODE SCREAMING AT ME"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1432771137, "post_id": 30493361, "comment_id": 49067670, "body": "Be aware that <b>LPCSTR is a pointer and does not allocate memory</b>.  This means that the variable that the pointer points to must not disappear or be overwritten until the code using the pointer is finished.  This includes any other threads."}], "answers": [{"tags": [], "owner": {"reputation": 1804, "user_id": 4313775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kpFpj.jpg?s=128&g=1", "display_name": "David van rijn", "link": "https://stackoverflow.com/users/4313775/david-van-rijn"}, "is_accepted": true, "score": 4, "last_activity_date": 1432765365, "last_edit_date": 1432765365, "creation_date": 1432764427, "answer_id": 30493946, "question_id": 30493361, "link": "https://stackoverflow.com/questions/30493361/adding-to-struct-from-a-loop-c/30493946#30493946", "title": "Adding to struct from a loop (c++)", "body": "<p>The problem here is that you are using the <code>[]</code> operator on a type. You declared lines as a <code>struct</code>. \n(It helps to keep to give your <code>typenames</code> a capital letter so you can differentiate them more easily.)\nI think you meant to call <code>sub[i].text</code>. </p>\n"}], "owner": {"reputation": 33, "user_id": 4928580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5701c5dde3e609b1148810abfd18853?s=128&d=identicon&r=PG&f=1", "display_name": "Quavo Os", "link": "https://stackoverflow.com/users/4928580/quavo-os"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 30493946, "answer_count": 1, "score": 0, "last_activity_date": 1432765365, "creation_date": 1432761676, "question_id": 30493361, "link": "https://stackoverflow.com/questions/30493361/adding-to-struct-from-a-loop-c", "title": "Adding to struct from a loop (c++)", "body": "<p>So I'm using the code below but am getting an error when trying to call the text from a line in the struct.</p>\n\n<pre><code>struct lines\n{\n    LPCSTR text;\n    int mInt;\n};\n\n\nfor (int n = 0; n &lt; lineCount - 1; ++n) {\n        vector&lt;lines&gt; sub;\n        lines lineData;\n        LPCSTR onlinePlayerName = (LPCSTR)PLAYER::GET_PLAYER_NAME((Player)(n));\n        int onlinePlayerPed = PLAYER::GET_PLAYER_PED(n);\n\n        //lines(n) = struct( onlinePlayerName, onlinePlayerPed );\n        sub.push_back(lines());\n        lineData.text = onlinePlayerName;\n        lineData.mInt = onlinePlayerPed;\n        //add struct to struct list\n        sub.push_back(lineData);\n    }\n</code></pre>\n\n<p>but when I try to call from lines with</p>\n\n<pre><code>lines[i].text\n</code></pre>\n\n<p>I get \"Error: Type name is not allowed\".</p>\n"}, {"tags": ["c++", "opencv", "g++", "ros", "catkin"], "comments": [{"owner": {"reputation": 1023, "user_id": 943472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfdb27fc2522dbe66a9a5554aad3a413?s=128&d=identicon&r=PG", "display_name": "alextoind", "link": "https://stackoverflow.com/users/943472/alextoind"}, "edited": false, "score": 0, "creation_date": 1432761673, "post_id": 30493228, "comment_id": 49064417, "body": "you should edit your post by adding the <code>CMakeList.txt</code> at least, but have a look <a href=\"http://stackoverflow.com/questions/26553659/linking-opencv-nonfree-components-sift-features-and-ocl-specifically\">here</a> first."}, {"owner": {"reputation": 723, "user_id": 2619133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f279329aad10b90b818e1140d50fac03?s=128&d=identicon&r=PG", "display_name": "oliverkn", "link": "https://stackoverflow.com/users/2619133/oliverkn"}, "reply_to_user": {"reputation": 1023, "user_id": 943472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfdb27fc2522dbe66a9a5554aad3a413?s=128&d=identicon&r=PG", "display_name": "alextoind", "link": "https://stackoverflow.com/users/943472/alextoind"}, "edited": false, "score": 0, "creation_date": 1432762157, "post_id": 30493228, "comment_id": 49064668, "body": "I&#180;v already read that post but that didn&#39;t helped me."}, {"owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "edited": false, "score": 0, "creation_date": 1432763586, "post_id": 30493228, "comment_id": 49065280, "body": "What does the compile line look like when you add VERBOSE=1 to your make execution?"}, {"owner": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 0, "creation_date": 1432788367, "post_id": 30493228, "comment_id": 49071685, "body": "i guess, you need opencv in the find_package() section"}], "answers": [{"tags": [], "owner": {"reputation": 27634, "user_id": 1576602, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/4d5132c0e702c0b50cac6aa7c56d191f?s=128&d=identicon&r=PG", "display_name": "Andrzej Pronobis", "link": "https://stackoverflow.com/users/1576602/andrzej-pronobis"}, "is_accepted": false, "score": 2, "last_activity_date": 1432799776, "creation_date": 1432799776, "answer_id": 30500473, "question_id": 30493228, "link": "https://stackoverflow.com/questions/30493228/undefined-reference-to-when-compiling-ros-node/30500473#30500473", "title": "undefined reference to ... when compiling ros node", "body": "<p>It seems that the <code>opencv_ocl</code> library is not being linked properly. Also, you can simplify your <code>CMakeLists.txt</code> file a lot by using <code>find_package</code> to get your OpenCV configuration. Try adding those lines to your <code>CMakeLists.txt</code> file:</p>\n\n<pre><code>find_package(OpenCV REQUIRED core ocl)\ninclude_directories(SYSTEM ${OpenCV_INCLUDE_DIRS})\ntarget_link_libraries(homography ${catkin_LIBRARIES} ${OpenCV_LIBRARIES} )\n</code></pre>\n\n<p>You need to specify which OpenCV libraries you want to include in the <code>find_package</code>. I listed only <code>core</code> and <code>ocl</code> since <code>ocl</code> seems to be what you need, but others might be needed as well.</p>\n"}], "owner": {"reputation": 723, "user_id": 2619133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f279329aad10b90b818e1140d50fac03?s=128&d=identicon&r=PG", "display_name": "oliverkn", "link": "https://stackoverflow.com/users/2619133/oliverkn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4857, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432799776, "creation_date": 1432761103, "last_edit_date": 1432762043, "question_id": 30493228, "link": "https://stackoverflow.com/questions/30493228/undefined-reference-to-when-compiling-ros-node", "title": "undefined reference to ... when compiling ros node", "body": "<p>I'm trying to write a ROS-Node which uses OpenCV nonfree components (SURF). I have trouble compiling the package using catkin_make:</p>\n\n<pre><code>//usr/local/lib/libopencv_nonfree.so: undefined reference to `cv::ocl::integral(cv::ocl::oclMat const&amp;, cv::ocl::oclMat&amp;)'\n</code></pre>\n\n<p>CMakeLists.txt</p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8.3)\nproject(homography_test)\n\n## Find catkin macros and libraries\n## is used, also find other catkin packages\nfind_package(catkin REQUIRED COMPONENTS\n  roscpp\n  rospy\n  std_msgs\n  sensor_msgs\n  cv_bridge\n  image_transport\n)\n\ncatkin_package(\n\n)\n\n###########\n## Build ##\n###########\n\n## Specify additional locations of header files\n## Your package locations should be listed before other locations\n# include_directories(include)\ninclude_directories(\n    ${catkin_INCLUDE_DIRS}\n    /usr/local/include\n    /usr/include\n    /usr/include/gstreamer-1.0\n    /usr/include/glib-2.0\n    /usr/lib/x86_64-linux-gnu/glib-2.0/include\n)\n\n## Declare a cpp executable\n#add_executable(display_image src/display_image_node.cpp)\nadd_executable(homography src/sample.cpp)\n\n## Add cmake target dependencies of the executable/library\n## as an example, message headers may need to be generated before nodes\n#add_dependencies(homography_test homography_test_generate_messages_cpp)\n\n## Specify libraries to link a library or executable target against\ntarget_link_libraries(\n    homography\n\n    ${catkin_LIBRARIES}\n\n    gstreamer-1.0\n    gobject-2.0\n    glib-2.0\n\n    opencv_nonfree\n    opencv_calib3d\n    opencv_contrib\n    opencv_core\n    opencv_features2d\n    opencv_flann\n    opencv_gpu\n    opencv_highgui\n    opencv_imgproc\n    opencv_legacy\n    opencv_ml\n    opencv_objdetect\n    opencv_ocl\n    opencv_photo\n    opencv_stitching\n    opencv_superres\n    opencv_ts\n    opencv_video\n    opencv_videostab\n    rt\n    pthread\n    m\n    dl\n)\n\nlink_directories(/usr/local/lib)\n</code></pre>\n\n<p>But if I manually compile the same code, but not as ROS-node, everything works.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 27, "creation_date": 1432761037, "post_id": 30493198, "comment_id": 49064130, "body": "That&#39;s how you become a <a href=\"http://c2.com/cgi/wiki?ThreeStarProgrammer\" rel=\"nofollow noreferrer\"><i>three star programmer</i></a>."}, {"owner": {"reputation": 426, "user_id": 4320207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc4bdecdb0bc1abfe07ac605134c66ea?s=128&d=identicon&r=PG&f=1", "display_name": "aGer", "link": "https://stackoverflow.com/users/4320207/ager"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1432761130, "post_id": 30493198, "comment_id": 49064175, "body": "I do not want to be &quot;three star programmer&quot; at all ;)"}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 1, "creation_date": 1432761242, "post_id": 30493198, "comment_id": 49064219, "body": "I&#39;m tempted to post &quot;when you don&#39;t understand the concept of abstraction.&quot; as an answer, but I guess for now I won&#39;t."}, {"owner": {"reputation": 14761, "user_id": 290072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/ITEsv.png?s=128&g=1", "display_name": "Almo", "link": "https://stackoverflow.com/users/290072/almo"}, "edited": false, "score": 0, "creation_date": 1432761287, "post_id": 30493198, "comment_id": 49064243, "body": "I&#39;d like to see example code of what a triple pointer is."}, {"owner": {"reputation": 6824, "user_id": 3202093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100004496564514/picture?type=large", "display_name": "sp2danny", "link": "https://stackoverflow.com/users/3202093/sp2danny"}, "edited": false, "score": 0, "creation_date": 1432761289, "post_id": 30493198, "comment_id": 49064245, "body": "<code>void MakeJagged( int*** arr, int width, int height );</code>"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 7, "creation_date": 1432761310, "post_id": 30493198, "comment_id": 49064256, "body": "When you want to write a function that modifies a <code>**</code>. In C, without reference, you need one more layer of pointer."}, {"owner": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1432761464, "post_id": 30493198, "comment_id": 49064333, "body": "A better question would be: <i>an example of why one should NOT use triple-pointers</i>..."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1432761589, "post_id": 30493198, "comment_id": 49064387, "body": "Maybe you should pick one language. I can&#39;t think of a situation where you&#39;d need a triple pointer in C++."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1432761693, "post_id": 30493198, "comment_id": 49064424, "body": "@fabio same list, really, bit with implementation and use cases added."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432762000, "post_id": 30493198, "comment_id": 49064596, "body": "@aGer <i>&quot;Edit: Especially i&#39;m looking for a source-code which uses triple-pointers.&quot;</i> THX for pointing out why this question is off-topic."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1432763294, "post_id": 30493198, "comment_id": 49065166, "body": "Asking for lists and suggestions is frowned upon. Pointers to pointers to pointers is pretty uncommon. Other than a three dimensional array, I&#39;ve only seen it used legitimately once or twice, and those probably could have been avoided. The rest look like this: <a href=\"http://stackoverflow.com/questions/30387128/why-put-dozens-of-before-function-pointer-or-function-that-return-a-function-p\" title=\"why put dozens of before function pointer or function that return a function p\">stackoverflow.com/questions/30387128/&hellip;</a>"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1432763642, "post_id": 30493198, "comment_id": 49065304, "body": "aGer: There&#39;s nothing particularly scary or magic about multiple indirection.  Triple indirection is relatively rare, but there are use cases for it (R&#39;s is one of the better ones).  Instead of saying &quot;I don&#39;t want to be a three star programmer&quot;, take the time to learn <i>why</i> such constructs may exist.  Sometimes you have to work with high-dimension data.  Sometimes you have multiple layers of indirection."}], "answers": [{"comments": [{"owner": {"reputation": 4666, "user_id": 981367, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ca05a550269a76bcdc899350338f5501?s=128&d=identicon&r=PG", "display_name": "VoidStar", "link": "https://stackoverflow.com/users/981367/voidstar"}, "edited": false, "score": 5, "creation_date": 1432761794, "post_id": 30493377, "comment_id": 49064489, "body": "That isn&#39;t a triple pointer. That&#39;s just a 3d array. You would only need triple pointers for a jagged 3d array."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 4666, "user_id": 981367, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ca05a550269a76bcdc899350338f5501?s=128&d=identicon&r=PG", "display_name": "VoidStar", "link": "https://stackoverflow.com/users/981367/voidstar"}, "edited": false, "score": 6, "creation_date": 1432761929, "post_id": 30493377, "comment_id": 49064558, "body": "@VoidStar: No, using a 3d array defeats the whole purpose and makes it equivalent to a flat array. The key word is <b>sparse</b>. I updated my answer to clarify."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 4666, "user_id": 981367, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ca05a550269a76bcdc899350338f5501?s=128&d=identicon&r=PG", "display_name": "VoidStar", "link": "https://stackoverflow.com/users/981367/voidstar"}, "edited": false, "score": 1, "creation_date": 1432762069, "post_id": 30493377, "comment_id": 49064632, "body": "If it were a 3d array, it would necessarily use a total of <code>68*128*128*sizeof ***proptable</code> bytes of storage, which is huge. In practice such multi-level tables fit in several kb."}, {"owner": {"reputation": 426, "user_id": 4320207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc4bdecdb0bc1abfe07ac605134c66ea?s=128&d=identicon&r=PG&f=1", "display_name": "aGer", "link": "https://stackoverflow.com/users/4320207/ager"}, "edited": false, "score": 1, "creation_date": 1432763421, "post_id": 30493377, "comment_id": 49065224, "body": "Thx for your example :)"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 4666, "user_id": 981367, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ca05a550269a76bcdc899350338f5501?s=128&d=identicon&r=PG", "display_name": "VoidStar", "link": "https://stackoverflow.com/users/981367/voidstar"}, "edited": false, "score": 0, "creation_date": 1432794036, "post_id": 30493377, "comment_id": 49073911, "body": "In fairness to @VoidStar, my answer was less clear when the first comment was posted."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": true, "score": 13, "last_activity_date": 1432762423, "last_edit_date": 1432762423, "creation_date": 1432761740, "answer_id": 30493377, "question_id": 30493198, "link": "https://stackoverflow.com/questions/30493198/example-why-someone-should-use-triple-pointers-in-c-c/30493377#30493377", "title": "Example why someone should use triple-pointers in C/C++?", "body": "<p>The best example that comes to mind is a sparse multi-level table. For instance one way to implement properties for Unicode characters might be:</p>\n\n<pre><code>prop_type ***proptable;\n...\nprop_type prop = proptable[c&gt;&gt;14][c&gt;&gt;7&amp;0x7f][c&amp;0x7f];\n</code></pre>\n\n<p>In this case <code>proptable</code> would need to have a triple-pointer type (and possibly quadruple pointer if the final resulting type is a pointer type). The reason for doing this as multiple levels rather than one flat table is that, at the first and second levels, multiple entries can point to the same subtable when the contents are all the same (e.g. huge CJK ranges).</p>\n\n<p>Here's another example of a multi-level table that I implemented; I can't say I'm terribly proud of the design but given the constraints the code has to satisfy, it's one of the least-bad implementation choices:</p>\n\n<p><a href=\"http://git.musl-libc.org/cgit/musl/tree/src/aio/aio.c?id=56fbaa3bbe73f12af2bfbbcf2adb196e6f9fe264\">http://git.musl-libc.org/cgit/musl/tree/src/aio/aio.c?id=56fbaa3bbe73f12af2bfbbcf2adb196e6f9fe264</a></p>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 4712451, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NAmKn.jpg?s=128&g=1", "display_name": "cip", "link": "https://stackoverflow.com/users/4712451/cip"}, "is_accepted": false, "score": 3, "last_activity_date": 1432762484, "creation_date": 1432762484, "answer_id": 30493559, "question_id": 30493198, "link": "https://stackoverflow.com/questions/30493198/example-why-someone-should-use-triple-pointers-in-c-c/30493559#30493559", "title": "Example why someone should use triple-pointers in C/C++?", "body": "<p>If you use a linked list you have to store the address of the first element of the list <code>( first pointer )</code> . </p>\n\n<p>If you need to change in that list you need another pointer <code>( two pointer)</code></p>\n\n<p>If you need to pass your list that you are changing in two pointers and change it in another function you need another pointer  <code>( three pointer )</code>...</p>\n\n<p>They are a lots of examples</p>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 3817801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b47535170303474bd46c5d44af9be04e?s=128&d=identicon&r=PG&f=1", "display_name": "Intrepid Traveller", "link": "https://stackoverflow.com/users/3817801/intrepid-traveller"}, "is_accepted": false, "score": 1, "last_activity_date": 1432763324, "creation_date": 1432763324, "answer_id": 30493745, "question_id": 30493198, "link": "https://stackoverflow.com/questions/30493198/example-why-someone-should-use-triple-pointers-in-c-c/30493745#30493745", "title": "Example why someone should use triple-pointers in C/C++?", "body": "<p>A very simple example is a pointer to an array of arrays of arrays.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1432797550, "post_id": 30493891, "comment_id": 49075792, "body": "Note that the for loop for freeing pointers and the array of pointers should be extracted into a separate function and used both in the clean-up path for error handling and in the calling function when finished with the array of strings.  You pass the number of initialized pointers (<code>i</code> in the error recovery code) and the pointers (variable <code>pointers</code> in the code) to the function."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 6, "last_activity_date": 1432765435, "last_edit_date": 1432765435, "creation_date": 1432764144, "answer_id": 30493891, "question_id": 30493198, "link": "https://stackoverflow.com/questions/30493198/example-why-someone-should-use-triple-pointers-in-c-c/30493891#30493891", "title": "Example why someone should use triple-pointers in C/C++?", "body": "<p>If you need to return an array of pointers to variable length strings via a function parameter:</p>\n\n<pre><code>int array_of_strings(int *num_strings, char ***string_data)\n{\n    int n = 32;\n    char **pointers = malloc(n * sizeof(*pointers));\n    if (pointers == 0)\n        return -1;  // Failure\n    char line[256];\n    int i;\n    for (i = 0; i &lt; n &amp;&amp; fgets(line, sizeof(line), stdin) != 0; i++)\n    {\n        size_t len = strlen(line);\n        if (line[len-1] == '\\n')\n            line[len-1] = '\\0';\n        pointers[i] = strdup(line);\n        if (pointers[i] == 0)\n        {\n            // Release already allocated resources\n            for (int j = 0; j &lt; i; j++)\n                free(pointers[j]);\n            free(pointers);\n            return -1;  // Failure\n        }\n    }\n    *num_strings = i;\n    *string_data = pointers;\n    return 0;  // Success\n}\n</code></pre>\n\n<p><sup><em>Compiled code.</em></sup></p>\n"}, {"tags": [], "owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "is_accepted": false, "score": 2, "last_activity_date": 1432776777, "creation_date": 1432776777, "answer_id": 30495790, "question_id": 30493198, "link": "https://stackoverflow.com/questions/30493198/example-why-someone-should-use-triple-pointers-in-c-c/30495790#30495790", "title": "Example why someone should use triple-pointers in C/C++?", "body": "<p>I've used triple pointers in C++:</p>\n\n<p>There is an interface written for a Java program: </p>\n\n<p><a href=\"https://github.com/BenLand100/SMART/blob/master/src/SMARTPlugin.h\" rel=\"nofollow\">https://github.com/BenLand100/SMART/blob/master/src/SMARTPlugin.h</a></p>\n\n<p>and it takes an array of strings.</p>\n\n<pre><code>typedef void (*_SMARTPluginInit)(SMARTInfo *ptr, bool *replace, int *buttonc, char ***buttonv, int **buttonid, _SMARTButtonPressed *buttonproc);\n</code></pre>\n\n<p>Then in my program I do:</p>\n\n<pre><code>char* btnTexts[2] = {\"Disable OpenGL_Enable OpenGL\", \"Enable Debug_Disable glDebug\"}; //array of C-style strings.\n\nvoid SMARTPluginInit(SMARTInfo* ptr, bool* ReplaceButtons, int* ButtonCount, char*** ButtonTexts, int** ButtonIDs, _SMARTButtonPressed* ButtonCallback)\n{\n    *ButtonText = btnTexts; //return an array of strings.\n}\n</code></pre>\n\n<p>but in C++, you can use a reference instead of pointer and it'd become:</p>\n\n<pre><code>void SMARTPluginInit(SMARTInfo* ptr, bool* ReplaceButtons, int* ButtonCount, char** &amp;ButtonTexts, int** ButtonIDs, _SMARTButtonPressed* ButtonCallback)\n{\n    ButtonText = btnTexts; //return an array of strings.\n}\n</code></pre>\n\n<p>Notice now that \"ButtonTexts\" is a reference to an array of C-style strings now.</p>\n\n<p>A <code>char***</code> can be a pointer to an array of C-style strings and that's one time that you'd use it.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7568681, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PhbuGU5oIlY/AAAAAAAAAAI/AAAAAAAABbI/2cC8UWFtEdc/photo.jpg?sz=128", "display_name": "Murtaza Chawala", "link": "https://stackoverflow.com/users/7568681/murtaza-chawala"}, "is_accepted": false, "score": -3, "last_activity_date": 1487161054, "creation_date": 1487161054, "answer_id": 42249197, "question_id": 30493198, "link": "https://stackoverflow.com/questions/30493198/example-why-someone-should-use-triple-pointers-in-c-c/42249197#42249197", "title": "Example why someone should use triple-pointers in C/C++?", "body": "<p>Triple pointer is a pointer variable that points to a pointer which in turn points to another pointer. The use of this complex programming technique is that usually in which companies process tons and tons of data at one time .A single pointer would point to a single block of data (suppose in a large file) using the triple pointer would result in 3 times faster processing as different blocks of data(in the same file) can be pointed by different pointer and thus data could be accessed/processed faster (unlike 1 pointer going through the whole file).</p>\n"}], "owner": {"reputation": 426, "user_id": 4320207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc4bdecdb0bc1abfe07ac605134c66ea?s=128&d=identicon&r=PG&f=1", "display_name": "aGer", "link": "https://stackoverflow.com/users/4320207/ager"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17826, "favorite_count": 7, "accepted_answer_id": 30493377, "answer_count": 6, "score": 14, "last_activity_date": 1487161054, "creation_date": 1432760979, "last_edit_date": 1432761529, "question_id": 30493198, "link": "https://stackoverflow.com/questions/30493198/example-why-someone-should-use-triple-pointers-in-c-c", "title": "Example why someone should use triple-pointers in C/C++?", "body": "<p>I'm searching for an example or explanation why someone should use <strong>OR</strong> not use triple-pointers in C/C++. Are there any source-code where triple-pointer arise?</p>\n\n<p>Thanks in advance.</p>\n\n<p><strong>Edit:</strong> Especially i'm looking for a source-code which uses triple-pointers. </p>\n"}, {"tags": ["c++", "c++11", "boost", "boost-range"], "comments": [{"owner": {"reputation": 25650, "user_id": 369872, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2b4534ace0008370742fe0c8bb942361?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/369872/david"}, "edited": false, "score": 0, "creation_date": 1432763203, "post_id": 30493177, "comment_id": 49065134, "body": "2) <code>boost::bind</code> is more efficient than <code>std::function</code>"}], "answers": [{"comments": [{"owner": {"reputation": 10089, "user_id": 294813, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33c092532e11d12bd14f4fbe564560fb?s=128&d=identicon&r=PG", "display_name": "petersohn", "link": "https://stackoverflow.com/users/294813/petersohn"}, "edited": false, "score": 0, "creation_date": 1432832704, "post_id": 30494333, "comment_id": 49100908, "body": "Thanks, reference wrapping the function works. Actually, I find it better to wrap a lambda in this case."}], "tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 4, "last_activity_date": 1432766827, "last_edit_date": 1432766827, "creation_date": 1432766459, "answer_id": 30494333, "question_id": 30493177, "link": "https://stackoverflow.com/questions/30493177/using-boost-adaptors-with-stdbind-expressions/30494333#30494333", "title": "Using Boost adaptors with std::bind expressions", "body": "<p>Here's the problem:</p>\n\n<ol>\n<li><p>The standard doesn't require <code>std::bind</code>'s return value to be copy assignable; only move constructible (and copy constructible if all bound objects are also copy constructible). For lambdas, their copy assignment operators are required to be deleted.</p></li>\n<li><p>The range adaptor actually uses <code>transform_iterator</code>, so the function object gets stored in the iterator.</p></li>\n<li><p>Iterators must be copy assignable, <code>min_element</code> tries to do that, and your program blows up.</p></li>\n</ol>\n\n<p>With the proliferation of lambdas in C++11, I'd call this a problem with the boost library, which was not designed with copy-constructible-but-not-copy-assignable function objects in mind. </p>\n\n<p>I'd actually suggest wrapping the resulting function object in a <code>reference_wrapper</code>:</p>\n\n<pre><code>int min = *boost::min_element(values | boost::adaptors::transformed(std::ref(fun)));\n</code></pre>\n\n<p>This also saves the cost of making extra copies of the functor whenever the iterator is copied.</p>\n\n<p>In the two options you listed, <code>boost::bind</code> should be more efficient because it doesn't have to do type erasure.</p>\n"}], "owner": {"reputation": 10089, "user_id": 294813, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33c092532e11d12bd14f4fbe564560fb?s=128&d=identicon&r=PG", "display_name": "petersohn", "link": "https://stackoverflow.com/users/294813/petersohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 30494333, "answer_count": 1, "score": 0, "last_activity_date": 1432766827, "creation_date": 1432760921, "question_id": 30493177, "link": "https://stackoverflow.com/questions/30493177/using-boost-adaptors-with-stdbind-expressions", "title": "Using Boost adaptors with std::bind expressions", "body": "<p>I have the following code:</p>\n\n<pre><code>#include &lt;boost/range/adaptor/transformed.hpp&gt;\n#include &lt;boost/range/algorithm.hpp&gt;\n\n#include &lt;iostream&gt;\n#include &lt;functional&gt;\n#include &lt;memory&gt;\n\nstruct A {\n    A() = default;\n    A(const A&amp;) = delete;\n    A&amp; operator=(const A&amp;) = delete;\n};\n\nstruct B {\n    B() = default;\n    B(const B&amp;) = delete;\n    B&amp; operator=(const B&amp;) = delete;\n\n    int foo(const A&amp;, int b)  {\n        return -b;\n    }\n};\n\nint main() {\n    A a;\n    auto b = std::make_shared&lt;B&gt;();\n    std::vector&lt;int&gt; values{1, 2, 3, 2};\n\n    using std::placeholders::_1;\n    auto fun = std::bind(&amp;B::foo, b.get(), std::ref(a), _1);\n    int min = *boost::min_element(values | boost::adaptors::transformed(fun));\n    std::cout &lt;&lt; min &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>When I try to compile it, clang gives the following error message (full output <a href=\"http://coliru.stacked-crooked.com/a/12cbb9d98b51c368\" rel=\"nofollow\">here</a>):</p>\n\n<pre><code>/usr/local/include/boost/optional/optional.hpp:674:80: error: object of type 'std::_Bind&lt;std::_Mem_fn&lt;int (Base::*)(const A &amp;, int)&gt; (Base *, std::reference_wrapper&lt;A&gt;, std::_Placeholder&lt;1&gt;)&gt;' cannot be assigned because its copy assignment operator is implicitly deleted\n</code></pre>\n\n<p>It seems that while the bind object has a copy constructor, its copy assignment operator is deleted. I get the same error if I try to use a lambda instead of <code>bind</code>.</p>\n\n<ol>\n<li><p>Is this a bug in the C++11 standard, the libstdc++ implementation, or the Boost adaptor implementation?</p></li>\n<li><p>What is the best workaround for this? I can wrap it into an <code>std::function</code>. It seems that <code>boost::bind</code> also works. Which is the more efficient, or does it really matter?</p></li>\n</ol>\n"}, {"tags": ["c++", "templates", "c++11", "language-lawyer"], "comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1432762836, "post_id": 30492993, "comment_id": 49064986, "body": "<a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_closed.html#109\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/cwg_closed.html#109</a>"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1432763137, "post_id": 30492993, "comment_id": 49065107, "body": "@T.C. &quot;can be written with <code>-&gt;template</code>&quot;?"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1432763786, "post_id": 30492993, "comment_id": 49065357, "body": "@Barry Note that the original example in that issue was for a member function template."}], "answers": [{"comments": [{"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1432761397, "post_id": 30493141, "comment_id": 49064294, "body": "Why cannot an <i>unqualified-id</i> be a class template? AFAIK, <code>Inner&lt;U&gt;</code> is an unqualified-id, and it is a class template."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1432761649, "post_id": 30493141, "comment_id": 49064408, "body": "@vsoftco Just by the grammar, there&#39;s no allowance for the <code>template</code> keyword anywhere. <code>using Base&lt;T&gt;::template Inner&lt;T&gt;</code> is explicitly disallowed as it&#39;s a <i>template-id</i>. You can do <code>using Base&lt;T&gt;::Inner;</code>, but that doesn&#39;t actually help you at all so I&#39;m not even entirely sure what it does."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 10, "last_activity_date": 1432760866, "last_edit_date": 1432760866, "creation_date": 1432760748, "answer_id": 30493141, "question_id": 30492993, "link": "https://stackoverflow.com/questions/30492993/making-a-private-inherited-inner-template-public-via-a-using-directive/30493141#30493141", "title": "Making a private inherited inner template public via a using directive", "body": "<p>Not possible. A <em>using-declaration</em> is, from [namespace.udecl]:</p>\n\n<blockquote>\n  <p><code>using</code> <code>typename</code><sub>opt</sub> <em>nested-name-specifier</em> <em>unqualified-id</em> ;</p>\n</blockquote>\n\n<p>But an <em>unqualified-id</em> can't be a class template. </p>\n\n<p>You could just make an alias instead:</p>\n\n<pre><code>template&lt;typename T&gt;\nclass Derived: private Base&lt;T&gt;\n{\npublic:\n    template &lt;typename U&gt;\n    using Inner = typename Base&lt;T&gt;::template Inner&lt;U&gt;;\n\n    Inner&lt;T&gt;* ptr;\n};\n</code></pre>\n"}], "owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 30493141, "answer_count": 1, "score": 6, "last_activity_date": 1432761068, "creation_date": 1432760240, "last_edit_date": 1432761068, "question_id": 30492993, "link": "https://stackoverflow.com/questions/30492993/making-a-private-inherited-inner-template-public-via-a-using-directive", "title": "Making a private inherited inner template public via a using directive", "body": "<p>I'm trying to use a <code>using</code> directive to bring in the <code>public</code> access declaration of a derived class some inner class template declared in the base. Code:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass Base\n{\npublic:    \n    template&lt;typename U&gt;\n    struct Inner;\n};\n\ntemplate&lt;typename T&gt;\nclass Derived: private Base&lt;T&gt;\n{\npublic:\n    using typename Base&lt;T&gt;::template Inner; // make it visible\n    Inner&lt;T&gt;* ptr; // no need for typename here, non-qualified name\n};\n\nint main() {}\n</code></pre>\n\n<p>Neither g++ nor clang++ compile this code, both complaining about</p>\n\n<blockquote>\n  <p>error: expected unqualified-id before 'template'</p>\n</blockquote>\n\n<p>As far as I know, <code>Inner</code> is a dependent template name, so one should use <code>::template</code> when qualifying its name, and also a <code>typename</code> before, since <code>Base&lt;T&gt;::Inner</code> is a dependent type. I've tried all possible combinations with/without <code>typename/template</code>, and none compile. Is there any way of using <code>Inner</code> in the <code>public</code> section of <code>Derived</code>? </p>\n"}, {"tags": ["c++", "c", "qt", "makefile", "qt-creator"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 2898243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/knuVM.png?s=128&g=1", "display_name": "Neldar", "link": "https://stackoverflow.com/users/2898243/neldar"}, "edited": false, "score": 0, "creation_date": 1432768573, "post_id": 30493746, "comment_id": 49066941, "body": "Thanks a lot, you put me in the right direction. I had a lot to change, the original makefile use g++ and gcc, so I had to use the right one with the right files, and I had to select the files to compile, the makefile does not compile them all. Now, I managed to make it works, thanks to you."}], "tags": [], "owner": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "is_accepted": false, "score": 0, "last_activity_date": 1432763328, "creation_date": 1432763328, "answer_id": 30493746, "question_id": 30492967, "link": "https://stackoverflow.com/questions/30492967/adding-makefile-options-into-qtcreator-project/30493746#30493746", "title": "Adding Makefile options into qtcreator project", "body": "<p>The relevant qmake variable is <code>INCLUDEPATH</code>.</p>\n\n<p>So, for the following from the original makefile:</p>\n\n<pre><code>CSINCLUDE = -I${CSDIR}/Include \nPINKINCLUDE = -I${PINKDIR} \nARGVINCLUDE = -I${ARGV} \nPWINCLUDE = -Iinclude\nINCL = ${CSINCLUDE} ${PINKINCLUDE} ${ARGVINCLUDE} ${PWINCLUDE}\n</code></pre>\n\n<p>would be something like this:</p>\n\n<pre><code>INCLUDEPATH += ${CSDIR}/Include \\\n               ${PINKDIR} \\\n               ${ARGV} \\\n               include\n</code></pre>\n\n<p>This is documented in the <a href=\"http://doc.qt.io/qt-5/qmake-manual.html\" rel=\"nofollow\">QMake manual</a> in the <a href=\"http://doc.qt.io/qt-5/qmake-variable-reference.html#includepath\" rel=\"nofollow\">reference pages</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 2898243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/knuVM.png?s=128&g=1", "display_name": "Neldar", "link": "https://stackoverflow.com/users/2898243/neldar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432763328, "creation_date": 1432760163, "last_edit_date": 1432760265, "question_id": 30492967, "link": "https://stackoverflow.com/questions/30492967/adding-makefile-options-into-qtcreator-project", "title": "Adding Makefile options into qtcreator project", "body": "<p>I have a project made in qtcreator. The project in itself isn't very important for the question. I would like to add a project called PowerWatershed, the sources are available here:\n<a href=\"http://powerwatershed.sourceforge.net/\" rel=\"nofollow\">PowerWatershed</a></p>\n\n<p>Unfortunately, adding all the files to the .pro file give me an error when compiling, when making the \"make\" command with the Makefile of the PowerWatershed project works.</p>\n\n<p>The makefile of the project is:</p>\n\n<pre><code># Camille Couprie \n# october 2009\n\nOBJDIR  = objects\nPINKDIR = PINK\nCSDIR   = CSparse\nARGV = argv\nPWSRC = src\nVPATH = ${PINKDIR}:${CSDIR}:${ARGV}\n\nCSINCLUDE = -I${CSDIR}/Include \nPINKINCLUDE = -I${PINKDIR} \nARGVINCLUDE = -I${ARGV} \nPWINCLUDE = -Iinclude\nINCL = ${CSINCLUDE} ${PINKINCLUDE} ${ARGVINCLUDE} ${PWINCLUDE}\n\nOBJ=    objects/larith.o \\\nobjects/ccsort.o \\\nobjects/cccodimage.o \\\nobjects/gageodesic.o \\\nobjects/mccodimage.o \\\nobjects/mcimage.o \\\nobjects/mcindic.o \\\nobjects/mclifo.o \\\nobjects/random_walker.o \\\nobjects/lMSF.o \\\nobjects/MSF_RW.o \\\nobjects/mcrbt.o \\\nobjects/union_find.o \\\nobjects/image_toolbox.o \\\nobjects/cs_lu.o \\\nobjects/cs_lusol.o \\\nobjects/cs_malloc.o \\\nobjects/cs_util.o \\\nobjects/cs_multiply.o \\\nobjects/cs_compress.o \\\nobjects/cs_lsolve.o \\\nobjects/cs_scatter.o \\\nobjects/cs_cumsum.o \\\nobjects/cs_sqr.o \\\nobjects/cs_ipvec.o \\\nobjects/cs_amd.o \\\nobjects/cs_permute.o \\\nobjects/cs_transpose.o \\\nobjects/cs_counts.o \\\nobjects/cs_add.o \\\nobjects/cs_etree.o \\\nobjects/cs_leaf.o \\\nobjects/cs_fkeep.o \\\nobjects/cs_tdfs.o \\\nobjects/cs_usolve.o \\\nobjects/cs_spsolve.o \\\nobjects/cs_post.o \\\nobjects/cs_reach.o \\\nobjects/cs_dfs.o \\\nobjects/argv.o  \n#   objects/cs_print.o \\\n#   objects/cs_norm.o \\\n#   \nFLAGS = -g -Wall # -pg \nCXX = g++ \nCC = gcc\n\nOPTIMISE=-O4\nWARNINGS=-Wall #-Werror\nDEBUG=-g\nCXXFLAGS= ${DEBUG} ${WARNINGS} ${OPTIMISE} -Wno-deprecated ${FLAGS}\nCFLAGS = ${DEBUG} ${WARNINGS} ${OPTIMISE} ${FLAGS}\n\nall:    ${CS} ${OBJ}\n${MAKE} powerwatsegm.exe \n\n# make with the Intel compiler, a very good complement to gcc/g++\n# much more efficient and with better diagnoses\nintel: \n${MAKE} CC=icc CXX=icpc all\n\ndebug:\n${MAKE} OPTIMISE='' all\n\n# remove the asserts and the debug information\nproduction:\n${MAKE} DEBUG='' FLAGS=\"-DNDEBUG\" all\n\nclean:\nrm -f *.exe; rm -f *~; rm -f $(OBJ);  #rm -f overlay*; rm -f mask*;  \n\npowerwatsegm.exe: ${PWSRC}/powerwatsegm.c  $(OBJ)\n$(CXX) $(CXXFLAGS) $(INCL) ${PWSRC}/powerwatsegm.c $(OBJ) -o     powerwatsegm.exe \n\n$(OBJDIR)/%.o:  ${PWSRC}/%.c \n$(CXX) $(CXXFLAGS) ${INCL} -c $&lt; -o $@ \n\n$(OBJDIR)/%.o:  ${CSDIR}/Source/%.c ${CSDIR}/Include/cs.h\n$(CC) $(CFLAGS) ${CSINCLUDE} -c $&lt; -o $@\n\n$(OBJDIR)/%.o:  ${PINKDIR}/%.c\n$(CXX) $(CXXFLAGS) ${PINKINCLUDE} -c $&lt; -o $@\n\n$(OBJDIR)/argv.o:   ${ARGV}/argv.c ${ARGV}/argv.h ${ARGV}/argv_loc.h\n$(CC) $(CCFLAGS) ${ARGVINCLUDE} -c $&lt; -o $@\n\n$(OBJDIR)/lMSF.o:   ${PWSRC}/lMSF.c ${PINKDIR}/mcimage.h     ${PINKDIR}/mccodimage.h  \n$(CXX) $(CFLAGS) ${PINKINCLUDE} ${PWINCLUDE} -c ${PWSRC}/lMSF.c -o $@\n</code></pre>\n\n<p>I would like to add th propoer option to my .pro file to make the compilation work. At the moment, my pro file looks like</p>\n\n<pre><code>QT       += core gui\n\ngreaterThan(QT_MAJOR_VERSION, 4): QT += widgets\n\nTARGET = Power\nTEMPLATE = app\n\n\nSOURCES += main.cpp\\\n        mainwindow.cpp \\\n    PW_1.0.1/argv/argv.c \\\n    PW_1.0.1/CSparse/Source/cs_add.c \\\n    PW_1.0.1/CSparse/Source/cs_amd.c \\\n    PW_1.0.1/CSparse/Source/cs_chol.c \\\n    PW_1.0.1/CSparse/Source/cs_cholsol.c \\\n    PW_1.0.1/CSparse/Source/cs_compress.c \\\n    PW_1.0.1/CSparse/Source/cs_counts.c \\\n    PW_1.0.1/CSparse/Source/cs_cumsum.c \\\n    PW_1.0.1/CSparse/Source/cs_dfs.c \\\n    PW_1.0.1/CSparse/Source/cs_etree.c \\\n    PW_1.0.1/CSparse/Source/cs_fkeep.c \\\n    PW_1.0.1/CSparse/Source/cs_ipvec.c \\\n    PW_1.0.1/CSparse/Source/cs_leaf.c \\\n    PW_1.0.1/CSparse/Source/cs_lsolve.c \\\n    PW_1.0.1/CSparse/Source/cs_lu.c \\\n    PW_1.0.1/CSparse/Source/cs_lusol.c \\\n    PW_1.0.1/CSparse/Source/cs_malloc.c \\\n    PW_1.0.1/CSparse/Source/cs_multiply.c \\\n    PW_1.0.1/CSparse/Source/cs_norm.c \\\n    PW_1.0.1/CSparse/Source/cs_permute.c \\\n    PW_1.0.1/CSparse/Source/cs_post.c \\\n    PW_1.0.1/CSparse/Source/cs_print.c \\\n    PW_1.0.1/CSparse/Source/cs_reach.c \\\n    PW_1.0.1/CSparse/Source/cs_scatter.c \\\n    PW_1.0.1/CSparse/Source/cs_spsolve.c \\\n    PW_1.0.1/CSparse/Source/cs_sqr.c \\\n    PW_1.0.1/CSparse/Source/cs_tdfs.c \\\n    PW_1.0.1/CSparse/Source/cs_transpose.c \\\n    PW_1.0.1/CSparse/Source/cs_usolve.c \\\n    PW_1.0.1/CSparse/Source/cs_util.c \\\n    PW_1.0.1/PINK/gageodesic.c \\\n    PW_1.0.1/PINK/larith.c \\\n    PW_1.0.1/PINK/lMSF.c \\\n    PW_1.0.1/PINK/mccodimage.c \\\n    PW_1.0.1/PINK/mcimage.c \\\n    PW_1.0.1/PINK/mcindic.c \\\n    PW_1.0.1/PINK/mclifo.c \\\n    PW_1.0.1/PINK/mcrbt.c \\\n    PW_1.0.1/src/cccodimage.c \\\n    PW_1.0.1/src/ccsort.c \\\n    PW_1.0.1/src/gageodesic.c \\\n    PW_1.0.1/src/image_toolbox.c \\\n    PW_1.0.1/src/lMSF.c \\\n    PW_1.0.1/src/MSF_RW.c \\\n    PW_1.0.1/src/powerwatsegm.c \\\n    PW_1.0.1/src/random_walker.c \\\n    PW_1.0.1/src/union_find.c\n\nHEADERS  += mainwindow.h \\\n    PW_1.0.1/argv/argv.h \\\n    PW_1.0.1/argv/argv_loc.h \\\n    PW_1.0.1/argv/compat.h \\\n    PW_1.0.1/argv/conf.h \\\n    PW_1.0.1/CSparse/Include/cs.h \\\n    PW_1.0.1/include/cccodimage.h \\\n    PW_1.0.1/include/ccsort.h \\\n    PW_1.0.1/include/gageodesic.h \\\n    PW_1.0.1/include/image_toolbox.h \\\n    PW_1.0.1/include/lMSF.h \\\n    PW_1.0.1/include/MSF_RW.h \\\n    PW_1.0.1/include/powerwatsegm.h \\\n    PW_1.0.1/include/random_walker.h \\\n    PW_1.0.1/include/union_find.h \\\n    PW_1.0.1/PINK/larith.h \\\n    PW_1.0.1/PINK/mccodimage.h \\\n    PW_1.0.1/PINK/mcimage.h \\\n    PW_1.0.1/PINK/mcindic.h \\\n    PW_1.0.1/PINK/mclifo.h \\\n    PW_1.0.1/PINK/mcrbt.h \\\n    PW_1.0.1/PINK/mcutil.h\n\nFORMS    += mainwindow.ui\n</code></pre>\n\n<p>And I have the error:</p>\n\n<pre><code>/home/iznogood/Documents/Power/PW_1.0.1/src/gageodesic.c:44: erreur : mccodimage.h: No such file or directory\n #include &lt;mccodimage.h&gt;\n                        ^\n</code></pre>\n\n<p>I think this is a matter of path, which are mentionned in the Makefile with:</p>\n\n<pre><code>OBJDIR  = objects\nPINKDIR = PINK\nCSDIR   = CSparse\nARGV = argv\nPWSRC = src\nVPATH = ${PINKDIR}:${CSDIR}:${ARGV}\n</code></pre>\n\n<p>But I can't manage to add them to the .pro file.</p>\n"}, {"tags": ["c++", "c++11", "constructor", "c++14", "unions"], "comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1432762277, "post_id": 30492927, "comment_id": 49064722, "body": "That default constructor is OK. You need to implement a destructor."}, {"owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "edited": false, "score": 0, "creation_date": 1432763001, "post_id": 30492927, "comment_id": 49065056, "body": "Did you mean to use braces instead of parens where your one instance is allocated?"}, {"owner": {"reputation": 4450, "user_id": 387023, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Jf9aL.jpg?s=128&g=1", "display_name": "j00hi", "link": "https://stackoverflow.com/users/387023/j00hi"}, "reply_to_user": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "edited": false, "score": 0, "creation_date": 1432888716, "post_id": 30492927, "comment_id": 49123427, "body": "@donjuedo Yes, i meant to use braces because I&#39;d like to stick to the uniform C++11 initialization syntax. Is there anything wrong with them?"}, {"owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "edited": false, "score": 0, "creation_date": 1432899839, "post_id": 30492927, "comment_id": 49130848, "body": "@j00hi  No, I don&#39;t think there is anything wrong with braces, not directly anyway.  Having run into a mysterious (subtle) type casting problem recently, I am wondering if there is more going on under the hood to get that 123 to become an object.  My suggestion would be to try parens anyway, to see if directly passing an int to a constructor you explicitly choose would sidestep the error."}], "answers": [{"comments": [{"owner": {"reputation": 33082, "user_id": 726300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWH6H.png?s=128&g=1", "display_name": "Luc Danton", "link": "https://stackoverflow.com/users/726300/luc-danton"}, "edited": false, "score": 3, "creation_date": 1432802492, "post_id": 30493617, "comment_id": 49078813, "body": "Tidbit: <code>new (&amp;as_dictionary) auto(other.as_dictionary)</code> and so on can get rid of some of the redundancy, and is more refactoring friendly."}, {"owner": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "edited": false, "score": 0, "creation_date": 1432865870, "post_id": 30493617, "comment_id": 49114807, "body": "Boost.Variant is quite outdated for the current state of c++."}, {"owner": {"reputation": 4450, "user_id": 387023, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Jf9aL.jpg?s=128&g=1", "display_name": "j00hi", "link": "https://stackoverflow.com/users/387023/j00hi"}, "reply_to_user": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "edited": false, "score": 0, "creation_date": 1432888844, "post_id": 30493617, "comment_id": 49123511, "body": "@Orient Why do you think, Boost.Varant is outdated? And what would be a good, modern alternative to it?"}, {"owner": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "reply_to_user": {"reputation": 4450, "user_id": 387023, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Jf9aL.jpg?s=128&g=1", "display_name": "j00hi", "link": "https://stackoverflow.com/users/387023/j00hi"}, "edited": false, "score": 0, "creation_date": 1432893216, "post_id": 30493617, "comment_id": 49126464, "body": "@j00hi apply_visitor (integral part of Boost.Variant) not allow us to distinct ref-qualified visitor&#39;s <code>operator ()</code> properly."}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "reply_to_user": {"reputation": 33082, "user_id": 726300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWH6H.png?s=128&g=1", "display_name": "Luc Danton", "link": "https://stackoverflow.com/users/726300/luc-danton"}, "edited": false, "score": 0, "creation_date": 1432902640, "post_id": 30493617, "comment_id": 49132791, "body": "@LucDanton Thanks, that is convenient. Reading your comment was a bit of wtf! moment though :) I remember reading a while back that <code>auto</code> can be used in a <code>new</code> expression, but had never used it, and that syntax does look somewhat odd."}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "reply_to_user": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "edited": false, "score": 0, "creation_date": 1432903393, "post_id": 30493617, "comment_id": 49133297, "body": "@Orient Is that really a must have feature? Sure, there might be cases where it&#39;s a little more DRY to have ref qualified <code>operator()</code> overloads in the same visitor, but those situations should be rare enough that you can just create a differently named visitor to handle the <code>&amp;&amp;</code> case (unless I&#39;m misunderstanding what you mean)."}, {"owner": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "edited": false, "score": 0, "creation_date": 1432910241, "post_id": 30493617, "comment_id": 49138221, "body": "@Praetorian Having the universal library, I expect to find such a feature. I use multivisitors for AST transformations. It is the very use case, when I need in full perfect forwarding support (especially, when I compute n-th partial derivative symbolically)."}, {"owner": {"reputation": 2091, "user_id": 7006673, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6993a5041a63d1922494d0dab74a048?s=128&d=identicon&r=PG&f=1", "display_name": "abraham_hilbert", "link": "https://stackoverflow.com/users/7006673/abraham-hilbert"}, "edited": false, "score": 0, "creation_date": 1481994854, "post_id": 30493617, "comment_id": 69601300, "body": "What does <code>new (&amp;as_string) auto(other.as_string);</code> do? I see that <code>auto(other.as_string)</code> constructs a new copy of <code>other.as_string</code> but what does the <code>(&amp;as_string)</code> causes in combination with the <code>new</code>?"}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "reply_to_user": {"reputation": 2091, "user_id": 7006673, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6993a5041a63d1922494d0dab74a048?s=128&d=identicon&r=PG&f=1", "display_name": "abraham_hilbert", "link": "https://stackoverflow.com/users/7006673/abraham-hilbert"}, "edited": false, "score": 2, "creation_date": 1482020957, "post_id": 30493617, "comment_id": 69608153, "body": "@abraham_hilbert It&#39;s <a href=\"https://isocpp.org/wiki/faq/dtors#placement-new\" rel=\"nofollow noreferrer\">placement new</a> syntax, you&#39;re passing the address where you want the object to be constructed."}], "tags": [], "owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "is_accepted": true, "score": 12, "last_activity_date": 1432902484, "last_edit_date": 1432902484, "creation_date": 1432762739, "answer_id": 30493617, "question_id": 30492927, "link": "https://stackoverflow.com/questions/30492927/constructor-and-copy-constructor-for-class-containing-union-with-non-trivial-mem/30493617#30493617", "title": "Constructor and copy-constructor for class containing union with non-trivial members", "body": "<p>Your union has data members of type <code>string</code>, <code>unique_ptr</code> and <code>map</code>, all of which have non-trivial default/copy/move constructors, copy/move assignment operators and destructors. Hence all of these are implicitly deleted for your union.</p>\n\n<p><em>\u00a79.5/2 [class.union]</em></p>\n\n<blockquote>\n  <p>... [ <em>Note</em>: If any non-static data member\n  of a union has a non-trivial default constructor (12.1), copy constructor (12.8), move constructor (12.8), copy assignment operator (12.8), move assignment operator (12.8), or destructor (12.4), the corresponding\n  member function of the union must be user-provided or it will be implicitly deleted (8.4.3) for the union. <em>\u2014end note</em> ]</p>\n</blockquote>\n\n<p>So you must manually implement these for your union. At a minimum, for you to be able to create an instance of <code>MyVariant</code>, the class needs to be constructible and destructible. So you need</p>\n\n<pre><code>MyVariant() : type_id{t_int}, as_int{0} {}\n~MyVariant()\n{\n  switch(type_id)\n  {\n      case t_int:\n      case t_double:\n        // trivially destructible, no need to do anything\n        break;\n      case t_string:\n        as_string.~basic_string();\n        break;\n      case t_ptr:\n        as_ptr.~unique_ptr();\n        break;\n      case t_dictionary:\n        as_dictionary.~map();\n        break;\n      case t_invalid:\n        // do nothing\n        break;\n      default:\n        throw std::runtime_error(\"unknown type\");\n  }\n}\n</code></pre>\n\n<p>Your copy constructor implementation looks valid, but what I'd do differently is instead of first default constructing the member, and then copying from the source object, just copy construct in the placement new call itself.</p>\n\n<pre><code>MyVariant(const MyVariant&amp; other)\n{\n  type_id = other.type_id;\n  switch (type_id) {\n      case t_invalid:\n          break;\n      case t_string:\n          new (&amp;as_string) auto(other.as_string);\n          break;\n      case t_int:\n          as_int = other.as_int;\n          break;\n      case t_double:\n          as_double = other.as_double;\n          break;\n      case t_ptr:\n          new (&amp;as_ptr) auto(std::make_unique&lt;int&gt;(*other.as_ptr));\n          break;\n      case t_dictionary:\n          new (&amp;as_dictionary) auto(other.as_dictionary);\n          break;\n  }\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/0f37480f56036e6e\" rel=\"noreferrer\">Live demo</a></p>\n\n<p>Note that if the <code>unique_ptr</code> member is active, and is storing a pointer to some derived class instance via a base class pointer, then your copy constructor implementation will only copy the base class part.</p>\n\n<p>Finally, unless you're doing this as a learning exercise, I'd strongly urge you to use <a href=\"http://www.boost.org/doc/libs/release/doc/html/boost/variant.html\" rel=\"noreferrer\">Boost.Variant</a> instead of rolling your own.</p>\n"}], "owner": {"reputation": 4450, "user_id": 387023, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Jf9aL.jpg?s=128&g=1", "display_name": "j00hi", "link": "https://stackoverflow.com/users/387023/j00hi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4741, "favorite_count": 4, "accepted_answer_id": 30493617, "answer_count": 1, "score": 15, "last_activity_date": 1432902484, "creation_date": 1432760025, "last_edit_date": 1432762293, "question_id": 30492927, "link": "https://stackoverflow.com/questions/30492927/constructor-and-copy-constructor-for-class-containing-union-with-non-trivial-mem", "title": "Constructor and copy-constructor for class containing union with non-trivial members", "body": "<p>I am trying to implement a custom variant type which uses a union to store data of various different types. In the field <code>type_id</code> I plan to store which type the data stored in the union is of. The union contains non-trivial members. Here is my current implementation:</p>\n\n<pre><code>struct MyVariant {\n  enum { t_invalid, t_string, t_int, t_double, t_ptr, t_dictionary } type_id;\n  union {\n    int                             as_int;\n    double                          as_double;\n    std::string                     as_string;\n    std::unique_ptr&lt;int&gt;            as_ptr;\n    std::map&lt;int, double&gt;           as_dictionary;\n  };\n};\n</code></pre>\n\n<p>I try to create an instance of <code>MyVariant</code> like follows:</p>\n\n<pre><code>MyVariant v;\n</code></pre>\n\n<p>I get the error message: <em>Call to implicitly-deleted default constructor of MyVariant</em>. So, I tried to implement the constructor manually like follows:</p>\n\n<pre><code>MyVariant() : type_id{t_int}, as_int{0} {}\n</code></pre>\n\n<p>That gives me a similar error message: <em>Attempt to use a deleted function</em>.\nNext, I tried to implement the following constructor:</p>\n\n<pre><code>MyVariant(int value) : type_id{t_int}, as_int{value} {}\n</code></pre>\n\n<p>and construct my instance like follows: </p>\n\n<pre><code>MyVariant v{123};\n</code></pre>\n\n<p>=> same error message: <em>Attempt to use a deleted function</em>.</p>\n\n<p>I've also started to implement a copy constructor, it looks like follows. However, of course this doesn't help with the compiler errors.</p>\n\n<pre><code>MyVariant::MyVariant(const MyVariant&amp; other)\n{\n    type_id = other.type_id;\n    switch (type_id) {\n        case t_invalid:\n            break;\n        case t_string:\n            new (&amp;as_string) std::string();\n            as_string = other.as_string;\n            break;\n        case t_int:\n            as_int = other.as_int;\n            break;\n        case t_double:\n            as_double = other.as_double;\n            break;\n        case t_ptr:\n            new (&amp;as_ptr) std::unique_ptr&lt;int&gt;(nullptr);\n            as_ptr = std::make_unique&lt;int&gt;(*other.as_ptr);\n            break;\n        case t_dictionary:\n            new (&amp;as_dictionary) std::map&lt;int, double&gt;();\n            // TODO: copy values from other\n            break;\n    }\n}\n</code></pre>\n\n<p>I am using Xcode and Apple LLVM 6.1 as compiler.</p>\n\n<p>The main question is: Why do I get the compiler errors which I'm getting and how do I have to modify my code to make it compile?</p>\n\n<p>The additional question is: Am I on the right way with my implementations for the constructor and copy constructor?</p>\n"}, {"tags": ["c++", "c++11", "metaprogramming", "variadic-templates"], "answers": [{"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1432763199, "post_id": 30493314, "comment_id": 49065133, "body": "I guess you could use a similar trick with <code>tuple_element</code> to be able to still keep the metafunction last."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1432763935, "post_id": 30493314, "comment_id": 49065421, "body": "@Barry Yes, it can be done. It&#39;s just less code having it first."}], "tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 4, "last_activity_date": 1433101931, "last_edit_date": 1433101931, "creation_date": 1432761469, "answer_id": 30493314, "question_id": 30492808, "link": "https://stackoverflow.com/questions/30492808/folding-over-arbitrarily-many-variadic-packs/30493314#30493314", "title": "Folding over arbitrarily many variadic packs", "body": "<p>With a slightly modified interface (taking the metafunction first, rather than last, and adding a couple members to <code>typelist</code> to get its size and the N-th member rather than using standalone metafunctions):</p>\n\n<pre><code>template &lt;typename... Ts&gt;\nstruct typelist {\n    template&lt;size_t N&gt;\n    using get = std::tuple_element_t&lt;N, std::tuple&lt;Ts...&gt;&gt;;\n    static constexpr size_t size = sizeof...(Ts);\n};\n\ntemplate&lt;class, class, class...&gt;\nstruct typelist_transform_helper;\n\ntemplate&lt;size_t... Ints, class F, class...Lists&gt;\nstruct typelist_transform_helper&lt;std::index_sequence&lt;Ints...&gt;, F, Lists...&gt;{\n    template &lt;class MF, size_t N, typename... Ls&gt;\n    using apply_to_Nth = meta_apply&lt;MF, typename Ls::template get&lt;N&gt;...&gt;;\n\n    using type = typelist&lt;apply_to_Nth&lt;F, Ints, Lists...&gt;...&gt;;\n};\n\ntemplate&lt;class F, class L1, class... Lists&gt;\nstruct typelist_transform : typelist_transform_helper&lt;std::make_index_sequence&lt;L1::size&gt;, F, L1, Lists...&gt; {\n    // static assert on size of all lists being equal if wanted\n};\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/931d8e75e299f445\" rel=\"nofollow\">Demo</a>.</p>\n\n<hr>\n\n<p>One problem with the above is that <code>tuple_element</code> usually requires <code>N</code> recursive template instantiations, making the total number of template instantiations quadratic in the length of the list. Given our use case (we access every single index), we can do better:</p>\n\n<pre><code>template&lt;class L&gt;\nstruct typelist_indexer {\n    template&lt;size_t N, class T&gt; struct helper_base { using type = T; };\n\n    template&lt;class S, class&gt; struct helper;\n    template&lt;size_t... Ns, class... Ts&gt; \n    struct helper&lt;std::index_sequence&lt;Ns...&gt;, typelist&lt;Ts...&gt;&gt; : helper_base&lt;Ns, Ts&gt;... {};\n\n    template&lt;size_t N, class T&gt;\n    static helper_base&lt;N, T&gt; do_get(helper_base&lt;N, T&gt;);\n\n    using helper_type = helper&lt;std::make_index_sequence&lt;L::size&gt;, L&gt;;\n\n    template&lt;size_t N&gt;\n    using get = typename decltype(do_get&lt;N&gt;(helper_type()))::type;\n};\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>template&lt;size_t... Ints, class F, class...Lists&gt;\nstruct typelist_transform_helper&lt;std::index_sequence&lt;Ints...&gt;, F, Lists...&gt;{\n    template &lt;class MF, size_t N, typename... Ls&gt;\n    using apply_to_Nth = meta_apply&lt;MF, typename typelist_indexer&lt;Ls&gt;::template get&lt;N&gt;...&gt;;\n\n    using type = typelist&lt;apply_to_Nth&lt;F, Ints, Lists...&gt;...&gt;;\n};\n</code></pre>\n\n<p>Now the number of template instantiations is linear in the size of the list, and in my tests this result in a significant compile time improvement. <a href=\"http://coliru.stacked-crooked.com/a/0c9a1758946a3484\" rel=\"nofollow\">Demo</a>.</p>\n"}], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 2, "accepted_answer_id": 30493314, "answer_count": 1, "score": 4, "last_activity_date": 1433101931, "creation_date": 1432759551, "question_id": 30492808, "link": "https://stackoverflow.com/questions/30492808/folding-over-arbitrarily-many-variadic-packs", "title": "Folding over arbitrarily many variadic packs", "body": "<p>I'm reading through Eric Niebler's <a href=\"http://ericniebler.com/2014/11/13/tiny-metaprogramming-library/\" rel=\"nofollow\">post</a> on his tiny metaprogramming library. In trying to implement the pieces that he omits / lists as challenges, I am left with the following implementation of <code>transform</code>:</p>\n\n<pre><code>template &lt;typename F, typename... As&gt;\nusing meta_apply = typename F::template apply&lt;As...&gt;;\n\ntemplate &lt;typename... &gt;\nstruct typelist_transform;\n\n// unary\ntemplate &lt;typename... T, typename F&gt;\nstruct typelist_transform&lt;typelist&lt;T...&gt;, F&gt; \n{\n    using type = typelist&lt;meta_apply&lt;F,T&gt;...&gt;;\n};\n\n// binary\ntemplate &lt;typename... T, typename... U, typename F&gt;\nstruct typelist_transform&lt;typelist&lt;T...&gt;, typelist&lt;U...&gt;, F&gt;\n{\n    using type = typelist&lt;meta_apply&lt;F,T,U&gt;...&gt;;\n};\n</code></pre>\n\n<p>This works, but seems very unsatisfactory to me - I need a partial specialization of <code>typelist_transform</code> for every number of \"arguments\" into <code>F</code>. Is there a better way to implement this metafunction?</p>\n"}, {"tags": ["c++", "exception", "gcc", "linker", "g++"], "comments": [{"owner": {"reputation": 4666, "user_id": 981367, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ca05a550269a76bcdc899350338f5501?s=128&d=identicon&r=PG", "display_name": "VoidStar", "link": "https://stackoverflow.com/users/981367/voidstar"}, "edited": false, "score": 3, "creation_date": 1432758770, "post_id": 30492489, "comment_id": 49062995, "body": "I&#39;m not familiar with that particular compiler, but it likely assumes C functions are nonthrowing. The fact that it called <code>std::terminate</code> implies it inferred a <code>noexcept</code>. Basically, make sure exceptions don&#39;t come out of the C functions."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 4666, "user_id": 981367, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ca05a550269a76bcdc899350338f5501?s=128&d=identicon&r=PG", "display_name": "VoidStar", "link": "https://stackoverflow.com/users/981367/voidstar"}, "edited": false, "score": 1, "creation_date": 1432758800, "post_id": 30492489, "comment_id": 49063017, "body": "Well, without extra libraries, it&#39;s working well: <a href=\"http://ideone.com/WSkn4O\" rel=\"nofollow noreferrer\">ideone.com/WSkn4O</a> So your code sample doesn&#39;t really <i>mimic</i> what&#39;s happening with using your library. @VoidStar brought a good point what may be wrong with this library."}, {"owner": {"reputation": 188, "user_id": 1023121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5117e2fa63976c3c189465dccbc88e?s=128&d=identicon&r=PG", "display_name": "tgnottingham", "link": "https://stackoverflow.com/users/1023121/tgnottingham"}, "reply_to_user": {"reputation": 4666, "user_id": 981367, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ca05a550269a76bcdc899350338f5501?s=128&d=identicon&r=PG", "display_name": "VoidStar", "link": "https://stackoverflow.com/users/981367/voidstar"}, "edited": false, "score": 0, "creation_date": 1432759743, "post_id": 30492489, "comment_id": 49063462, "body": "@VoidStar Does that apply in this case, since the exception should be both thrown and caught in main()? I&#39;m not exactly sure what you mean about C functions. This example was compiled with g++, which compiles both .cpp and .c files as if they are C++ code. (Note that the library uses both gcc and g++ however.)"}, {"owner": {"reputation": 4666, "user_id": 981367, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ca05a550269a76bcdc899350338f5501?s=128&d=identicon&r=PG", "display_name": "VoidStar", "link": "https://stackoverflow.com/users/981367/voidstar"}, "edited": false, "score": 1, "creation_date": 1432761139, "post_id": 30492489, "comment_id": 49064182, "body": "If you aren&#39;t actually running code from the linked lib it should make no difference... I assume a function in the lib is a C function and no exception can come out of (or through!!) any such function. Maybe there&#39;s something invisible happening...?  Also, can you look at the source for <code>#9  0x0000003ad80bcd22 in __cxa_throw () from &#47;usr&#47;lib64&#47;libstdc++.so.6</code>? It may give a hint as to why it thought invoking <code>std::terminate</code> was appropriate."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1432763214, "post_id": 30492489, "comment_id": 49065139, "body": "What you can&#39;t do is pass a callback to a C++ function to a C function and then have that callback throw an exception. If you want to make that work, you have to modify the C code (specifically, build it with <code>-fexceptions</code>)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1432764491, "post_id": 30492489, "comment_id": 49065604, "body": "Possibly the library has a C startup in it (it shouldn&#39;t) so you end up  not having C++ startup done. To debug this, you could use the original object files instead of the library and figure out which one triggers the problem."}], "answers": [{"tags": [], "owner": {"reputation": 188, "user_id": 1023121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5117e2fa63976c3c189465dccbc88e?s=128&d=identicon&r=PG", "display_name": "tgnottingham", "link": "https://stackoverflow.com/users/1023121/tgnottingham"}, "is_accepted": false, "score": 0, "last_activity_date": 1432769488, "creation_date": 1432769488, "answer_id": 30494842, "question_id": 30492489, "link": "https://stackoverflow.com/questions/30492489/cannot-catch-exceptions-when-linking-with-certain-libraries/30494842#30494842", "title": "Cannot catch exceptions when linking with certain libraries", "body": "<p>Thanks everyone. The problem turned out to be the presence of a C file in the library containing declarations/definitions for something like C++ language/library implementation functions. I'm not sure why this file was included, as removing it and recompiling the library did not cause any problems (at least is hasn't yet...). The example program was able to catch exceptions when linking with the recompiled library.</p>\n\n<p>If anyone would like to post why the presence of these declarations/definitions caused exceptions not to be caught, feel free, and I may accept your answer. I will try to find out why this file was included to begin with. Any suggestions would be appreciated.</p>\n\n<p>Here is the contents of the file:</p>\n\n<pre><code>int __gxx_personality_v0(void);\n\nint __gxx_personality_v0(void)\n{\n        return 1;\n}\n\nvoid __cxa_pure_virtual(void);\n\nvoid __cxa_pure_virtual(void)\n{\n}\n\nvoid _ZTVN10__cxxabiv117__class_type_infoE(void);\nvoid _ZTVN10__cxxabiv120__si_class_type_infoE(void);\nvoid _ZTVN10__cxxabiv121__vmi_class_type_infoE(void);\n\nvoid _ZTVN10__cxxabiv117__class_type_infoE(void) {}\nvoid _ZTVN10__cxxabiv120__si_class_type_infoE(void) {}\nvoid _ZTVN10__cxxabiv121__vmi_class_type_infoE(void) {}\n</code></pre>\n"}], "owner": {"reputation": 188, "user_id": 1023121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5117e2fa63976c3c189465dccbc88e?s=128&d=identicon&r=PG", "display_name": "tgnottingham", "link": "https://stackoverflow.com/users/1023121/tgnottingham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 972, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432769488, "creation_date": 1432758416, "last_edit_date": 1432763689, "question_id": 30492489, "link": "https://stackoverflow.com/questions/30492489/cannot-catch-exceptions-when-linking-with-certain-libraries", "title": "Cannot catch exceptions when linking with certain libraries", "body": "<p>I am unable to catch exceptions in my executable when linking with a certain static library. Instead, I get <code>terminate called after throwing an instance of 'int'</code>, <code>terminate called recursively</code>.</p>\n\n<p>The library contains C and assembly sources compiled with gcc, as well as C++ sources compiled with g++. I'm guessing that this mixture is part of the problem.</p>\n\n<p>Can anyone tell me exactly what the problem is? Let me know if I can provide any more info to home in on an explanation. Thanks.</p>\n\n<p>Here is a simple example program that fails to catch the exception when I link with the library. Note that I am not calling any functions from the library. The mere act of linking the library causes this to fail.</p>\n\n<p>baz.cpp:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main(int argc, char** argv)\n{\n    try {\n        throw 7;\n    } catch (int ex) {\n        cout &lt;&lt; \"int: \" &lt;&lt; ex &lt;&lt; endl;\n    } catch (...) {\n        cout &lt;&lt; \"...\" &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<p>Compiling / Linking:</p>\n\n<pre><code>g++ -o baz -ggdb baz.cpp -lxxx\n</code></pre>\n\n<p>Alternative compiling (mimicking how C++ sources in the library are compiled):</p>\n\n<pre><code>g++ -c -falign-functions=16 -D_REENTRANT -mtune=opteron -g -O2 -fPIC -Wall -Werror -Wpointer-arith -Wreturn-type -Wswitch -Wunused -Wundef -Wno-uninitialized -Wno-format -Wno-non-virtual-dtor -Wno-sign-compare -Wwrite-strings -DTRACE_SIMPLE -Wno-strict-aliasing -g -rdynamic -D_XOPEN_SOURCE=600 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64 -DXYZ_LITTLE_ENDIAN=1 -DXYZ_BIG_ENDIAN=0 -DXYZ=1 -DUMEM_TRACE=0 -DUSE_SYS_FLOAT -DINTEL_IPP_INLINE_MEMCHR=0 -DACCEL_TEST=1 -DXYZ -DUSE_XYZ_LIB -DACCEL_TEST=1 -o baz.o baz.cpp\n</code></pre>\n\n<p>The static library is created with <code>ar r</code> followed by <code>ranlib</code>.</p>\n\n<p>Running:</p>\n\n<pre><code>terminate called after throwing an instance of 'int'\nterminate called recursively\nAborted (core dumped)\n</code></pre>\n\n<p>Core backtrace:</p>\n\n<pre><code>#0  0x0000003ad4032625 in raise () from /lib64/libc.so.6\n#1  0x0000003ad4033e05 in abort () from /lib64/libc.so.6\n#2  0x0000003ad80be991 in __gnu_cxx::__verbose_terminate_handler() () from /usr/lib64/libstdc++.so.6\n#3  0x0000003ad80bcbd6 in ?? () from /usr/lib64/libstdc++.so.6\n#4  0x0000003ad80bcc03 in std::terminate() () from /usr/lib64/libstdc++.so.6\n#5  0x0000003ad80bcc86 in __cxa_rethrow () from /usr/lib64/libstdc++.so.6\n#6  0x0000003ad80bea32 in __gnu_cxx::__verbose_terminate_handler() () from /usr/lib64/libstdc++.so.6\n#7  0x0000003ad80bcbd6 in ?? () from /usr/lib64/libstdc++.so.6\n#8  0x0000003ad80bcc03 in std::terminate() () from /usr/lib64/libstdc++.so.6\n#9  0x0000003ad80bcd22 in __cxa_throw () from /usr/lib64/libstdc++.so.6\n#10 0x0000000000400a9b in main (argc=1, argv=0x7fffffff3888) at baz.cpp:8\n</code></pre>\n\n<p>GCC version:</p>\n\n<pre><code>gcc -v\nUsing built-in specs.\nTarget: x86_64-redhat-linux\nConfigured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-languages=c,c++,objc,obj-c++,java,fortran,ada --enable-java-awt=gtk --disable-dssi --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre --enable-libgcj-multifile --enable-java-maintainer-mode --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --disable-libjava-multilib --with-ppl --with-cloog --with-tune=generic --with-arch_32=i686 --build=x86_64-redhat-linux\nThread model: posix\ngcc version 4.4.7 20120313 (Red Hat 4.4.7-3) (GCC) \n</code></pre>\n"}, {"tags": ["c++", "constructor"], "comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 1, "creation_date": 1432758327, "post_id": 30492437, "comment_id": 49062801, "body": "it&#39;s called a &quot;destructor&quot;."}, {"owner": {"reputation": 3039, "user_id": 2851815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37MCt.png?s=128&g=1", "display_name": "\u043d\u0430\u0431\u0438\u044f\u0447\u043b\u044d\u0432\u044d\u043b\u0438", "link": "https://stackoverflow.com/users/2851815/%d0%bd%d0%b0%d0%b1%d0%b8%d1%8f%d1%87%d0%bb%d1%8d%d0%b2%d1%8d%d0%bb%d0%b8"}, "edited": false, "score": 2, "creation_date": 1432758483, "post_id": 30492437, "comment_id": 49062873, "body": "In <code>foo = creature(choice);</code>, you create an anonymous instance (<code>creature(choice)</code>), invoke <code>creature &amp; operator=(const creature &amp;)</code> on <code>foo</code>, and then destroy the anonymous instance. Also, it&#39;s &quot;destructor&quot;, BTW."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1432758514, "post_id": 30492437, "comment_id": 49062888, "body": "Your <code>count</code> variable doesn&#39;t reflect what is really going on.  You failed to add a copy constructor and assignment operator to count those instances.  Instead, you&#39;re decrementing count for object instances you didn&#39;t even track."}, {"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1432758569, "post_id": 30492437, "comment_id": 49062908, "body": "@TheParamagneticCroissant:  That is hardly worth pointing out.  Even without context, <code>deconstructor</code> perfectly describes what it is."}], "answers": [{"comments": [{"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 0, "creation_date": 1432758537, "post_id": 30492476, "comment_id": 49062896, "body": "isn&#39;t the original <code>creature</code> (<code>foo</code>) being destoyed?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 0, "creation_date": 1432758640, "post_id": 30492476, "comment_id": 49062937, "body": "@Amit It gets destroyed when <code>main()</code> exits, not during the statement shown."}, {"owner": {"reputation": 3039, "user_id": 2851815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37MCt.png?s=128&g=1", "display_name": "\u043d\u0430\u0431\u0438\u044f\u0447\u043b\u044d\u0432\u044d\u043b\u0438", "link": "https://stackoverflow.com/users/2851815/%d0%bd%d0%b0%d0%b1%d0%b8%d1%8f%d1%87%d0%bb%d1%8d%d0%b2%d1%8d%d0%bb%d0%b8"}, "reply_to_user": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 1, "creation_date": 1432758776, "post_id": 30492476, "comment_id": 49063001, "body": "@Amit No, it&#39;s pretty much equivalent to <code>creature __anon(choice); foo.operator=(__anon); __anon.~creature();</code>."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 97, "user_id": 4808718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a41fe9856e45c0632607a54d57647031?s=128&d=identicon&r=PG&f=1", "display_name": "Brogrammer93", "link": "https://stackoverflow.com/users/4808718/brogrammer93"}, "edited": false, "score": 1, "creation_date": 1432760081, "post_id": 30492476, "comment_id": 49063626, "body": "@Darraptor because <code>choice</code> wouldn&#39;t have a useful value."}, {"owner": {"reputation": 97, "user_id": 4808718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a41fe9856e45c0632607a54d57647031?s=128&d=identicon&r=PG&f=1", "display_name": "Brogrammer93", "link": "https://stackoverflow.com/users/4808718/brogrammer93"}, "edited": false, "score": 0, "creation_date": 1432760260, "post_id": 30492476, "comment_id": 49063715, "body": "@juanchopanza oh shoot ur right lol well thank you so much I get your explanation and got my code to almost work(I just need to add more stuff in but I can handle that)"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 97, "user_id": 4808718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a41fe9856e45c0632607a54d57647031?s=128&d=identicon&r=PG&f=1", "display_name": "Brogrammer93", "link": "https://stackoverflow.com/users/4808718/brogrammer93"}, "edited": false, "score": 0, "creation_date": 1432760539, "post_id": 30492476, "comment_id": 49063859, "body": "@Darraptor Also remember that your <code>count</code> variable is not correct.  You need to add the user-defined copy constructor and assignment operator, else your <code>getNumObjects</code> will return an unexpected value (it may return 0 instead of 1)."}, {"owner": {"reputation": 97, "user_id": 4808718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a41fe9856e45c0632607a54d57647031?s=128&d=identicon&r=PG&f=1", "display_name": "Brogrammer93", "link": "https://stackoverflow.com/users/4808718/brogrammer93"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1432763742, "post_id": 30492476, "comment_id": 49065347, "body": "@PaulMcKenzie why would I get an unexpected value from count though? I made sure count was declared correctly"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 97, "user_id": 4808718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a41fe9856e45c0632607a54d57647031?s=128&d=identicon&r=PG&f=1", "display_name": "Brogrammer93", "link": "https://stackoverflow.com/users/4808718/brogrammer93"}, "edited": false, "score": 0, "creation_date": 1432764420, "post_id": 30492476, "comment_id": 49065582, "body": "@Darraptor See my answer.  Objects are being created at times where you are not tracking the creation.  What will happen is that you are subtracting 1 from count from an object you didn&#39;t know existed, but its destructor was called anyway."}, {"owner": {"reputation": 97, "user_id": 4808718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a41fe9856e45c0632607a54d57647031?s=128&d=identicon&r=PG&f=1", "display_name": "Brogrammer93", "link": "https://stackoverflow.com/users/4808718/brogrammer93"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1432765037, "post_id": 30492476, "comment_id": 49065780, "body": "@PaulMcKenzie I&#39;m alittle confused when u said user defined copy and assignment? Like I know what they are but I don&#39;t get what u mean by user defined. Can you show me an example?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 97, "user_id": 4808718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a41fe9856e45c0632607a54d57647031?s=128&d=identicon&r=PG&f=1", "display_name": "Brogrammer93", "link": "https://stackoverflow.com/users/4808718/brogrammer93"}, "edited": false, "score": 0, "creation_date": 1432765181, "post_id": 30492476, "comment_id": 49065823, "body": "@Darraptor That line of code that does this <code>foo = creature(choice)</code>  It is doing a lot more than what you think.  It is creating temporary creature objects.  Without a user defined copy constructor and assignment operators to track the creation, your <code>count</code> will be off.  By <code>user-defined</code> I mean that you are overriding the compiler default versions (which is what was being invoked in your original code).  We don&#39;t want that -- we need to also track the count, so you have to provide replacement functions instead of the compiler version of these functions."}, {"owner": {"reputation": 97, "user_id": 4808718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a41fe9856e45c0632607a54d57647031?s=128&d=identicon&r=PG&f=1", "display_name": "Brogrammer93", "link": "https://stackoverflow.com/users/4808718/brogrammer93"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1432766084, "post_id": 30492476, "comment_id": 49066168, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/78958/discussion-between-darraptor-and-paulmckenzie\">continue this discussion in chat</a>."}, {"owner": {"reputation": 112, "user_id": 10517891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb00d9b05bdf91b3039ff34430419ac3?s=128&d=identicon&r=PG&f=1", "display_name": "Berdan Aky&#252;rek", "link": "https://stackoverflow.com/users/10517891/berdan-aky%c3%bcrek"}, "edited": false, "score": 0, "creation_date": 1615064494, "post_id": 30492476, "comment_id": 117578094, "body": "Perfect explanation. Thanks."}], "tags": [], "owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "is_accepted": false, "score": 10, "last_activity_date": 1432758994, "last_edit_date": 1432758994, "creation_date": 1432758386, "answer_id": 30492476, "question_id": 30492437, "link": "https://stackoverflow.com/questions/30492437/why-is-my-destructor-being-called-and-how-can-i-fix-it/30492476#30492476", "title": "Why is my destructor being called and how can I fix it", "body": "<p>When you do this</p>\n\n<pre><code>foo=creature(choice);\n</code></pre>\n\n<p>a temporary <code>creature</code> object is created on the RHS of the assignment. Its destructor is called once the statement is done, i.e. at end of the line.</p>\n\n<p>There isn't really anything to fix, but you can initialize <code>foo</code> after reading in <code>choice</code>, rather than default initializing and then assigning:</p>\n\n<pre><code>int choice;\n\ncout&lt;&lt;\"enter 1 2 or 3 to choose ur monster\"&lt;&lt;endl;\ncin&gt;&gt;choice;\n\ncreature foo(choice);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 4500584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Hk-7R_IuCIg/AAAAAAAAAAI/AAAAAAAAFD0/HGAzmEk0khg/photo.jpg?sz=128", "display_name": "Martin Drohmann", "link": "https://stackoverflow.com/users/4500584/martin-drohmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1432758874, "creation_date": 1432758874, "answer_id": 30492621, "question_id": 30492437, "link": "https://stackoverflow.com/questions/30492437/why-is-my-destructor-being-called-and-how-can-i-fix-it/30492621#30492621", "title": "Why is my destructor being called and how can I fix it", "body": "<p>As juanchopanza pointed out in his answer, the line</p>\n\n<pre><code>foo = creature(choice);\n</code></pre>\n\n<p>creates a temporary creature object before assigning it to foo. If you don't want this to happen, create it with</p>\n\n<pre><code>creature foo(choice);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "is_accepted": false, "score": 1, "last_activity_date": 1432820410, "last_edit_date": 1432820410, "creation_date": 1432764369, "answer_id": 30493933, "question_id": 30492437, "link": "https://stackoverflow.com/questions/30492437/why-is-my-destructor-being-called-and-how-can-i-fix-it/30493933#30493933", "title": "Why is my destructor being called and how can I fix it", "body": "<p>To add to the other answers, your question referred to \"fixing the destructor\".  There is nothing to fix, however there may be a bug in what you're trying to accomplish due to the destructor being invoked.</p>\n\n<p>What will happen with your current code is that temporary copies may be created without you tracking them.  When their destructor is called, you will decrement the <code>count</code> variable inadvertently, possibly giving you a negative value for <code>count</code>.</p>\n\n<p>If you want the object static <code>count</code> member variable to correctly reflect the number of objects created and destroyed, your class is missing a user defined copy constructor to track the number of instances.</p>\n\n<p>You need to add this function.</p>\n\n<pre><code>class creature{\npublic:\n    creature(const creature&amp; c) : \n         name(c.name), happy_level(c.happy_level) { ++count; }\n};\n</code></pre>\n\n<p>This function will be called when you make copies or assign.  </p>\n\n<p>Live Examples: </p>\n\n<p>(original code): <a href=\"http://coliru.stacked-crooked.com/a/ea9821e622aa4cdc\" rel=\"nofollow\">http://coliru.stacked-crooked.com/a/ea9821e622aa4cdc</a></p>\n\n<p>(changed code):  <a href=\"http://coliru.stacked-crooked.com/a/b774a896377bdf97\" rel=\"nofollow\">http://coliru.stacked-crooked.com/a/b774a896377bdf97</a></p>\n\n<p>The only difference is that the original code has the copy constructor commented out, while the changed code has the copy constructor intact.</p>\n\n<p>Note that in the original code, I wanted to know how many objects are created and destroyed, but I got back a result of -1 when the final object was destroyed.  This is not correct as obviously the result should yield 0, meaning all creatures are destroyed.</p>\n\n<p>The changed code shows the correct number, and that is because the object creation of the temporary creature was taken into account.  </p>\n"}], "owner": {"reputation": 97, "user_id": 4808718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a41fe9856e45c0632607a54d57647031?s=128&d=identicon&r=PG&f=1", "display_name": "Brogrammer93", "link": "https://stackoverflow.com/users/4808718/brogrammer93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1825, "favorite_count": 0, "closed_date": 1432771793, "answer_count": 3, "score": 4, "last_activity_date": 1606335510, "creation_date": 1432758198, "last_edit_date": 1606335510, "question_id": 30492437, "link": "https://stackoverflow.com/questions/30492437/why-is-my-destructor-being-called-and-how-can-i-fix-it", "closed_reason": "Duplicate", "title": "Why is my destructor being called and how can I fix it", "body": "<p>I have issues with my destructor in my c++ program.When I run the program and take the users input, it suddenly calls the destructor before the cout can even print inside the statement. Assume that the user input will be one because I designed this part of the code to only take in the input 1. I thought the destructor gets called when you leave the scope so I was thinking that the destructor should be called atleast after the cout in the if statement which I will comment below to make it easier for you guys to read. If someone can explain my mistake and correct it that would be great! In my headerfile I have</p>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nusing namespace std;\n\nclass creature{\npublic:\n    creature();//default constructor\n    creature(int a);\n    ~creature();//desconstructor \n    string getName();//accessor for the name\n    static int getNumObjects();\nprivate:\n    string name;\n    int happy_level;\n    static int count;\n};\n</code></pre>\n<p>In my implementation file I have</p>\n<pre><code>#include &quot;creature.h&quot;\n\nint creature::count=0;//initialize static member variable\n\ncreature::creature(){//default constructor\n    name=&quot;bob&quot;;\n    ++numberobject;\n    \n    cout&lt;&lt;&quot;The default constructor is being called&quot;&lt;&lt;endl;\n}\n\ncreature::creature(int a)\n{\n    if(a==1)\n    {\n        name=&quot;billybob&quot;;\n       \n    }\n    \n    \n    else if(a==2)\n    {\n        name=&quot;bobbilly&quot;;\n       \n    }\n    \n    else if(a==3)\n    {\n        name=&quot;bobbertyo&quot;;\n        happy_level=1;\n    }\n}\n\ncreature::~creature()\n{\n    cout&lt;&lt;&quot;The destructor is now being called&quot;&lt;&lt;endl;\n    cout&lt;&lt;creature::getName()&lt;&lt;&quot; is destroyed.&quot;&lt;&lt;endl;\n     --count;\n    cout&lt;&lt;&quot;Now you have a total number of &quot;&lt;&lt;creature::getNumObjects()&lt;&lt;&quot; creature&quot;&lt;&lt;endl;\n}\n</code></pre>\n<p>and in my main class I have</p>\n<pre><code>#include &quot;creature.h&quot;\n\nint main()\n{\n\n   creature foo;//this is where the default constructor gets called which is good\n   int choice;\n   \n   cout&lt;&lt;&quot;enter 1 2 or 3 to choose ur monster&quot;&lt;&lt;endl;\n   cin&gt;&gt;choice;\n\n   foo=creature(choice);\n\n   if(choice==1)\n    {\n        cout&lt;&lt;&quot;hi&quot;&lt;&lt;endl;//the destructor gets called before hi is printed out and I don't know why thats happening\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c++builder-6"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1432763543, "post_id": 30492418, "comment_id": 49065265, "body": "If you used a <i>modern</i> compiler, you could use <code>std::list</code> and not worry about creating and debugging your own linked list."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1432955249, "post_id": 30492418, "comment_id": 49156783, "body": "C++Builder 6 has <code>std::list</code>."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 0, "last_activity_date": 1432956045, "creation_date": 1432956045, "answer_id": 30541883, "question_id": 30492418, "link": "https://stackoverflow.com/questions/30492418/build-the-graphic-and-use-linked-list/30541883#30541883", "title": "Build the graphic and use linked list", "body": "<p>Your first loop is not linking the nodes together, so they all have a <code>next</code> value of <code>NULL</code>, thus your second loop runs only 1 iteration (for the <code>head</code> node).</p>\n\n<p>And you should also be using <code>new</code> instead of <code>malloc()</code>.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>K* head = 0;\nK* curr = 0;\nK* last = 0;\ndouble x = 1;\ndouble y;\ndouble a = LabeledEdit1 -&gt; Text.ToDouble();\ndouble S = LabeledEdit2 -&gt; Text.ToDouble();\nint i;\nfor (i = 0; i &lt; 500; ++i) {\n    y = exp(x*log(a));\n    curr = new K;\n    curr-&gt;x = x;\n    curr-&gt;y = y;\n    curr-&gt;next = NULL;\n    if (!head) head = curr;\n    if (last) last-&gt;next = curr;\n    last = curr;\n    x++;\n}\ncurr = head;\ni = 0;\nint l = 0, I = 0;\nwhile(curr){\n    x = curr-&gt;x;\n    StringGrid1-&gt;Cells[i][0] = x;\n    y = curr-&gt;y;\n    StringGrid1-&gt;Cells[i][1] = y;\n    Series1-&gt;AddXY( i , y ,\"\",clBlue);\n    curr = curr-&gt;next;\n    ++i;\n}\n</code></pre>\n\n<p>And do not forget to free the nodes when you are done using them:</p>\n\n<pre><code>curr = head;\nwhile(curr){\n    K *next = curr-&gt;next;\n    //...\n    delete curr;\n    curr = next;\n}\n</code></pre>\n\n<p>With that said, you should use the <code>std::list</code> class instead, let it handle the memory management for you:</p>\n\n<pre><code>#include &lt;list&gt;\n\nstruct K {\n    double x;\n    double y;\n};\n\nstd::list&lt;K&gt; myList;\n\ndouble x = 1;\ndouble y;\ndouble a = LabeledEdit1 -&gt; Text.ToDouble();\ndouble S = LabeledEdit2 -&gt; Text.ToDouble();\nint i;\nfor (i = 0; i &lt; 500; ++i) {\n    y = exp(x*log(a));\n    K curr;\n    curr.x = x;\n    curr.y = y;\n    myList.push_back(curr);\n    x++;\n}\ni = 0;\nint l = 0, I = 0;\nfor(std::list&lt;K&gt;::iterator iter = myList.begin(); iter != myList.end(); ++iter)\n{\n    x = iter-&gt;x;\n    StringGrid1-&gt;Cells[i][0] = x;\n    y = iter-&gt;y;\n    StringGrid1-&gt;Cells[i][1] = y;\n    Series1-&gt;AddXY( i , y ,\"\",clBlue);\n    ++i;\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4746427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-4Mm0w3ey_PA/AAAAAAAAAAI/AAAAAAAAADA/eehZ0dtZQ10/photo.jpg?sz=128", "display_name": "Farkid", "link": "https://stackoverflow.com/users/4746427/farkid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 30541883, "answer_count": 1, "score": -2, "last_activity_date": 1432956045, "creation_date": 1432758145, "question_id": 30492418, "link": "https://stackoverflow.com/questions/30492418/build-the-graphic-and-use-linked-list", "title": "Build the graphic and use linked list", "body": "<p>I should make 2 codes that building graphics. I already have 1. It is just building picture:</p>\n\n<pre><code>  double a = LabeledEdit1 -&gt; Text.ToDouble();\n  double S = LabeledEdit2 -&gt; Text.ToDouble();\n  Series1-&gt; Clear();\n  for( float i = -5; i &lt;= 5; i+=S ) {\n    float y = exp(i*log(a));\n    Series1-&gt;AddXY( i , y ,\"\",clBlue);\n  }\n</code></pre>\n\n<p>But 2nd task is much harder for me. I shoud make new struct</p>\n\n<pre><code>struct K {\n  double x;\n  double y;\n  struct K *next;\n};\n</code></pre>\n\n<p>and then make linked list. Then put points (x,y) to StringGrid and then build the grapfic. I made some pieces of code, but it doesnt work correctly. Need help.</p>\n\n<pre><code>  K* head = 0;\n  K* curr = 0;\n  K* vyv;\n  double x = 1;\n  double y;\n  double a = LabeledEdit1 -&gt; Text.ToDouble();\n  double S = LabeledEdit2 -&gt; Text.ToDouble();\n  int i=0;\n  for (i = 0; i &lt; 500; ++i) {\n    if (i==0) {\n      y = exp(x*log(a));\n      head = (K*) malloc(sizeof K);\n      head-&gt;x = x;\n      head-&gt;y = y;\n      head-&gt;next = NULL;\n    }\n    else {\n      y = exp(x*log(a));\n      curr = (K*) malloc(sizeof K);\n      curr-&gt;x = x;\n      curr-&gt;y = y;\n      curr-&gt;next = NULL;\n    }\n    x++;\n  }\n  vyv = head;\n  i = 0;\n  int l = 0, I = 0;\n  while(vyv){\n    x = vyv-&gt;x;\n    StringGrid1-&gt;Cells[i][0] = x;\n    y = vyv-&gt;y;\n    StringGrid1-&gt;Cells[i][1] = y;\n    Series1-&gt;AddXY( i , y ,\"\",clBlue);\n    vyv = vyv-&gt;next;\n    ++i;\n  }\n</code></pre>\n"}, {"tags": ["c++", "cmake", "header-files", "include-path"], "comments": [{"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 2, "creation_date": 1432758485, "post_id": 30492401, "comment_id": 49062875, "body": "you could do tricks with symbolic links, for example. Which compiler do you use ? Perhaps it will help to define which directories that compiler is to use and then change from #include &lt;qwt/qwt_plot to #include &quot;qwt_plot&quot;"}, {"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 0, "creation_date": 1432758599, "post_id": 30492401, "comment_id": 49062921, "body": "or you could do something rather ugly with the preprocessor, like shown there: <a href=\"http://stackoverflow.com/questions/3178946/using-define-to-include-another-file-in-c-c\" title=\"using define to include another file in c c\">stackoverflow.com/questions/3178946/&hellip;</a>"}, {"owner": {"reputation": 7113, "user_id": 653152, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/HoFfR.jpg?s=128&g=1", "display_name": "Martin Ueding", "link": "https://stackoverflow.com/users/653152/martin-ueding"}, "reply_to_user": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 0, "creation_date": 1432759084, "post_id": 30492401, "comment_id": 49063163, "body": "@Marged: Symbolic links would requite root access to the <code>&#47;usr&#47;include</code> directory, which I do not want to force them to give me for this. I use g++ on both distrubtions, 4.9 on Ubuntu and 4.8 on openSUSE. The macros do not look like an improvement compared to just <code>&lt;qwt_plot.h&gt;</code>."}, {"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 0, "creation_date": 1432759626, "post_id": 30492401, "comment_id": 49063415, "body": "The macros would allow you to specify the prefix to use in front of the header file. Also the symbolic links could be created in the directory you run cmake in: create a symbolic link named &quot;pointertoqwtinclude&quot; and have that one point to the /usr/include directory. Then simply #include &quot;pointertoqwtinclude/stuff.h&quot;"}, {"owner": {"reputation": 7113, "user_id": 653152, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/HoFfR.jpg?s=128&g=1", "display_name": "Martin Ueding", "link": "https://stackoverflow.com/users/653152/martin-ueding"}, "reply_to_user": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 0, "creation_date": 1432815596, "post_id": 30492401, "comment_id": 49088268, "body": "@Marged: The symlink trick would either require me to add the directory of the symlink (somewhere in <code>~</code>) to the <code>&lt;\u2026&gt;</code> search path or include those files with <code>&quot;\u2026&quot;</code>. Both seems like a hack to me :-/."}, {"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 0, "creation_date": 1432823710, "post_id": 30492401, "comment_id": 49094705, "body": "if a &quot;hack&quot; or &quot;creative solution&quot; which is pushing the borders is off limits I suggest you use the autoconf style solution below"}], "answers": [{"comments": [{"owner": {"reputation": 7113, "user_id": 653152, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/HoFfR.jpg?s=128&g=1", "display_name": "Martin Ueding", "link": "https://stackoverflow.com/users/653152/martin-ueding"}, "edited": false, "score": 0, "creation_date": 1432815483, "post_id": 30492959, "comment_id": 49088167, "body": "Thank you, I see where this is going. It will just lead to a proliferation of those macros in my sources files. Luckily this does not need to scale to a third distribution or even a different platform, but I do not really to put all those macros into my headers :-/."}, {"owner": {"reputation": 2876, "user_id": 4316023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc84e72c571a668dd413a18f92edecd7?s=128&d=identicon&r=PG", "display_name": "m4ktub", "link": "https://stackoverflow.com/users/4316023/m4ktub"}, "reply_to_user": {"reputation": 7113, "user_id": 653152, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/HoFfR.jpg?s=128&g=1", "display_name": "Martin Ueding", "link": "https://stackoverflow.com/users/653152/martin-ueding"}, "edited": false, "score": 0, "creation_date": 1432826347, "post_id": 30492959, "comment_id": 49096752, "body": "Yes, it&#39;s a mess. I nevertheless remember that CMake is part of a 3rd or 4th generation of tools trying to make that task easier. :)"}], "tags": [], "owner": {"reputation": 2876, "user_id": 4316023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc84e72c571a668dd413a18f92edecd7?s=128&d=identicon&r=PG", "display_name": "m4ktub", "link": "https://stackoverflow.com/users/4316023/m4ktub"}, "is_accepted": true, "score": 2, "last_activity_date": 1432760125, "creation_date": 1432760125, "answer_id": 30492959, "question_id": 30492401, "link": "https://stackoverflow.com/questions/30492401/including-headers-in-subfolders/30492959#30492959", "title": "Including headers in subfolders", "body": "<p>In CMake you can configure platform checks like you could for autoconf. The idea is that you include a <code>config.h</code> file that always exists but use tools to generate that file in each platform. You can check how <a href=\"http://www.cmake.org/Wiki/CMake:How_To_Write_Platform_Checks\" rel=\"nofollow\">here</a> but as a summary you can have a <code>config.h.in</code> file with the checks you want to make and use in your headers.</p>\n\n<pre><code>#cmakedefine HAVE_QWT_H\n#cmakedefine HAVE_QWT6_H\n</code></pre>\n\n<p>You then have CMake check if the headers are present and process that file into a final <code>config.h</code> file. In the <code>CMakeLists.txt</code> file you could have the following.</p>\n\n<pre><code>INCLUDE (CheckIncludeFiles)\n\nCHECK_INCLUDE_FILES (qwt/qwt_plot.h HAVE_QWT_H)\nCHECK_INCLUDE_FILES (qwt6/qwt_plot.h HAVE_QWT6_H)\nCONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/config.h.in ${CMAKE_CURRENT_BINARY_DIR}/config.h)\n</code></pre>\n\n<p>Finally, in your headers, you include the <code>config.h</code> and use the macros to conditionally include one header or another.</p>\n\n<pre><code>// always included\n#include \"config.h\"\n\n// conditionally include headers based one macros from config.h\n#ifdef HAVE_QWT_H\n#include &lt;qwt/qwt_plot.h&gt;\n#elseif HAVA_QWT6_H\n#include &lt;qwt6/qwt_plot.h&gt;\n#else\n#error QWT headers required and not present in supported locations\n#endif\n</code></pre>\n"}], "owner": {"reputation": 7113, "user_id": 653152, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/HoFfR.jpg?s=128&g=1", "display_name": "Martin Ueding", "link": "https://stackoverflow.com/users/653152/martin-ueding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2098, "favorite_count": 0, "accepted_answer_id": 30492959, "answer_count": 1, "score": 2, "last_activity_date": 1432760125, "creation_date": 1432758091, "question_id": 30492401, "link": "https://stackoverflow.com/questions/30492401/including-headers-in-subfolders", "title": "Including headers in subfolders", "body": "<p>I work on a C++ program which I develop on my personal Ubuntu 15.04 machine which eventually has to run on openSUSE 13.1 at work. To make it work on both systems I carefully chose the libraries and the versions to use.</p>\n\n<p>Now I have a problem with the includes. I want to use Qwt 6, which is available on both distributions. The location of the header files differs, though. On Debian they are at <code>/usr/include/qwt/qwt_*.h</code> but on openSUSE they are at <code>/usr/include/qwt6/qwt_*.h</code>. My code currently has <code>#include &lt;qwt/qwt_plot.h&gt;</code>. This does not work on openSUSE since I would have to insert that <code>6</code> there.</p>\n\n<p>The easiest solution that I currently see is just including either directory using CMake and then just writing <code>#include &lt;qwt_plot.h&gt;</code> in the source code. However, I think that this is not a really nice solution since those subdirectoryies of <code>/usr/include</code> are there to provide namespaces. Just adding all directories to the include path will mangle those together and might even lead to conflicts.</p>\n\n<p>Is there a nice way to solve this?</p>\n\n<p>In fairness: This is for a project I am paid to work on.</p>\n"}, {"tags": ["c++", "opengl", "textures", "glsl"], "comments": [{"owner": {"reputation": 2761, "user_id": 2329287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7e5c25b179f8b1396a39e89019a7791?s=128&d=identicon&r=PG", "display_name": "GuyRT", "link": "https://stackoverflow.com/users/2329287/guyrt"}, "edited": false, "score": 0, "creation_date": 1432821603, "post_id": 30492327, "comment_id": 49092924, "body": "You could draw the model vertices as points (so they are only processed once), then use <code>gl_VertexID</code> to calculate <code>gl_Position</code>."}, {"owner": {"reputation": 33, "user_id": 3852277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a387aef9fd13c538a337c6e00c51c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Antiiee", "link": "https://stackoverflow.com/users/3852277/antiiee"}, "reply_to_user": {"reputation": 2761, "user_id": 2329287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7e5c25b179f8b1396a39e89019a7791?s=128&d=identicon&r=PG", "display_name": "GuyRT", "link": "https://stackoverflow.com/users/2329287/guyrt"}, "edited": false, "score": 0, "creation_date": 1432830069, "post_id": 30492327, "comment_id": 49099403, "body": "Hm, could you please elaborate on that? At what stage in the pipeline should I do this and will this enable me to write the positions to an rgba texture? My problem is that I want to have both the fullscreen quad AND the model-space vertex data in the shader pipeline with the constraint of having one vertex array input. How does the <code>gl_VertexID</code> relate to the UV space in the output texture? @GuyRT"}, {"owner": {"reputation": 2761, "user_id": 2329287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7e5c25b179f8b1396a39e89019a7791?s=128&d=identicon&r=PG", "display_name": "GuyRT", "link": "https://stackoverflow.com/users/2329287/guyrt"}, "edited": false, "score": 0, "creation_date": 1432831882, "post_id": 30492327, "comment_id": 49100424, "body": "Using my idea, you wouldn&#39;t need to explicitly draw a quad, but the points generated from the vertex data would be drawn (in one draw call) into the texture. You&#39;d use <code>gl_VertexID</code> something like: <code>gl_Position.xy = vec2( mod(gl_VertexID, textureWidth), floor(gl_VertexID &#47; textureWidth) * vec2( 2.0 &#47; textureWidth, 2.0 &#47; textureHeight) - 1.0</code>. The second part maps to the -1 -&gt; 1 clip space range."}], "answers": [{"tags": [], "owner": {"reputation": 194, "user_id": 2579996, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8bbc86f92307a8b0cf77acf3a9ec83ca?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/2579996/mike"}, "is_accepted": true, "score": 1, "last_activity_date": 1432759919, "creation_date": 1432759919, "answer_id": 30492899, "question_id": 30492327, "link": "https://stackoverflow.com/questions/30492327/write-positions-to-texture-opengl-glsl/30492899#30492899", "title": "Write positions to texture OpenGL/GLSL", "body": "<p>Instead of generating the quad CPU side I would attach a geometry shader and create the quad there, that should free up the slot for your model-geometry to be passed in.  </p>\n\n<p><strong>Geometry shader:</strong></p>\n\n<pre><code>layout(points) in;\nlayout(triangle_strip, max_vertices = 4) out;\n\nout vec2 texcoord;\n\nvoid main() \n{\n    gl_Position = vec4( 1.0, 1.0, 0.5, 1.0 );\n    texcoord = vec2( 1.0, 1.0 );\n    EmitVertex();\n\n    gl_Position = vec4(-1.0, 1.0, 0.5, 1.0 );\n    texcoord = vec2( 0.0, 1.0 ); \n    EmitVertex();\n\n    gl_Position = vec4( 1.0,-1.0, 0.5, 1.0 );\n    texcoord = vec2( 1.0, 0.0 ); \n    EmitVertex();\n\n    gl_Position = vec4(-1.0,-1.0, 0.5, 1.0 );\n    texcoord = vec2( 0.0, 0.0 ); \n    EmitVertex();\n\n    EndPrimitive(); \n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 3852277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a387aef9fd13c538a337c6e00c51c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Antiiee", "link": "https://stackoverflow.com/users/3852277/antiiee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1062, "favorite_count": 0, "accepted_answer_id": 30492899, "answer_count": 1, "score": 1, "last_activity_date": 1432936383, "creation_date": 1432757790, "last_edit_date": 1432936383, "question_id": 30492327, "link": "https://stackoverflow.com/questions/30492327/write-positions-to-texture-opengl-glsl", "title": "Write positions to texture OpenGL/GLSL", "body": "<p>I want to write the model-space vertex positions of a 3D mesh to a texture in OGL. Currently in order to write to a texture I set it to a fullscreen quad and write to it using a separate pass (based on tutorial seen <a href=\"http://www.opengl-tutorial.org/intermediate-tutorials/tutorial-14-render-to-texture/\" rel=\"nofollow\">here</a>.)</p>\n\n<p><strong>The problem</strong> is that, from what I understand, I cannot pass more than one vertex list to the shader as the vertex shader can only be bound to one vertex list at a time, currently occupied by the screenspace quad.</p>\n\n<p><strong>Vertex Shader code:</strong></p>\n\n<pre><code>layout(location = 0) in vec4 in_position; \nout vec4 vs_position;\n\nvoid main() {\n    vs_position  = in_position;\n    gl_Position  = vec4(in_position.xy, 0.0, 1.0);\n}\n</code></pre>\n\n<p><strong>Fragment Shader code:</strong></p>\n\n<pre><code>in vec4 position; // coordinate in the screenspace quad\nout vec4 outColor;\n\nvoid main() {\n      vec2 uv = vec2(0.5, 0.5) * position.xy + vec2(0.5, 0.5);\n      outColor = ?? // Here I need my vertex position\n    }\n</code></pre>\n\n<p><strong>Possible solution (?):</strong> </p>\n\n<p>My idea was to introduce another shader pass before this to output the positions as r, g, b so that the position of the current texel can be retrieved from the texture (the only input format large enough to store many vertecies).</p>\n\n<p>Although not 100% accurate, this image might give you an idea of what I want to do:</p>\n\n<p><a href=\"http://i.stack.imgur.com/AInnx.png\" rel=\"nofollow\">Model space coordinate map</a></p>\n\n<p>Is there a way to encode the positions to the texture without using a fullscreen quad on the GPU? </p>\n\n<p>Please let me know if you want to see more code. </p>\n"}, {"tags": ["c++", "sapi"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1432757781, "post_id": 30492123, "comment_id": 49062530, "body": "Side note: you&#39;re reading words, not lines"}, {"owner": {"reputation": 1, "user_id": 4946362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713baacdc4d7abd19966ba680c0053fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Harry", "link": "https://stackoverflow.com/users/4946362/mike-harry"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1432758776, "post_id": 30492123, "comment_id": 49063000, "body": "Ok that helped. I was able to understand that, by removing the for loop, the output can be done via  <code>std::cout &lt;&lt; &quot;Enter lines of text to speak:\\n&quot;;</code>    <code>std::wstring text; std::wcin &gt;&gt; text;</code>    <code>hr = pVoice-&gt;Speak(text.c_str(), SPF_IS_XML, NULL)</code>  But making hr play twice at the same time in a way that I can add a delay, still eludes me."}, {"owner": {"reputation": 13278, "user_id": 175201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d30939d10bcf2e56b47c6a3d85c2e92b?s=128&d=identicon&r=PG", "display_name": "Eric Brown", "link": "https://stackoverflow.com/users/175201/eric-brown"}, "edited": false, "score": 0, "creation_date": 1432841062, "post_id": 30492123, "comment_id": 49105906, "body": "You&#39;ll do much better to apply the echo effect to the audio, not doing the synthesis twice.   For one thing, there&#39;s no guarantee that the two engines maintain the same synchronization."}, {"owner": {"reputation": 1, "user_id": 4946362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713baacdc4d7abd19966ba680c0053fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Harry", "link": "https://stackoverflow.com/users/4946362/mike-harry"}, "edited": false, "score": 0, "creation_date": 1433104733, "post_id": 30492123, "comment_id": 49196095, "body": "What should I look at for audio manipulation in C++? Using Visual Studios Express 2013."}, {"owner": {"reputation": 13278, "user_id": 175201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d30939d10bcf2e56b47c6a3d85c2e92b?s=128&d=identicon&r=PG", "display_name": "Eric Brown", "link": "https://stackoverflow.com/users/175201/eric-brown"}, "edited": false, "score": 0, "creation_date": 1434336304, "post_id": 30492123, "comment_id": 49717780, "body": "There are a lot of possibilities.  You can do it yourself - <a href=\"http://stackoverflow.com/questions/23745811/adding-echo-effect-to-a-wav-file\">this question</a> shows you how - or you can use a library (search for &#39;c++ signal processing library&#39; and you&#39;ll find dozens to hundreds that will do the trick."}], "owner": {"reputation": 1, "user_id": 4946362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713baacdc4d7abd19966ba680c0053fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Harry", "link": "https://stackoverflow.com/users/4946362/mike-harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1433106224, "creation_date": 1432757073, "last_edit_date": 1433106224, "question_id": 30492123, "link": "https://stackoverflow.com/questions/30492123/sapi-echo-from-delay", "title": "SAPI echo from delay", "body": "<pre><code> //All three include files needed for both versions//\n#include &lt;sapi.h&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\n//User inputs what is to be said//\nint main(int argc, char* argv[])\n{\n    ISpVoice * pVoice = NULL;\n\n    if (FAILED(::CoInitialize(NULL)))\n        return FALSE;\n\n    HRESULT hr = CoCreateInstance(CLSID_SpVoice, NULL, CLSCTX_ALL, IID_ISpVoice, (void **)&amp;pVoice);\n    if (SUCCEEDED(hr))\n    {\n        std::wstring input;\n        while (true)\n        {\n            std::cout &lt;&lt; \"Enter text:\\n\";\n            std::getline(std::wcin, input);\n\n            hr = pVoice-&gt;Speak(input.c_str(), 0, NULL);\n        }\n    }\n    pVoice-&gt;Release();\n    pVoice = NULL;\n    ::CoUninitialize();\n    return 0;\n}\n</code></pre>\n\n<p>The code is simple. It's microsofts explanation on how to use SAPI with a bit of editing to make the program speak what the user inputs, which I found on this site. </p>\n\n<p>My difficulty has been trying to get an echo effect with the output. From what I've learned, an echo effect is nothing more than playing the same audio at the same time with a minor delay of 10 - 60 milliseconds(respectfully). </p>\n\n<p>With this set up, I can not find a way to play the out at the same time and put a delay variable between the two. The delay part isn't hard, but it's the simultaneous output that I can't figure out.  </p>\n"}, {"tags": ["c++", "constructor", "copy"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 4, "creation_date": 1432756835, "post_id": 30492025, "comment_id": 49061983, "body": "See <a href=\"http://stackoverflow.com/questions/12953127/what-are-copy-elision-and-return-value-optimization\" title=\"what are copy elision and return value optimization\">stackoverflow.com/questions/12953127/&hellip;</a>"}, {"owner": {"reputation": 8382, "user_id": 398461, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ixu8F.jpg?s=128&g=1", "display_name": "wcochran", "link": "https://stackoverflow.com/users/398461/wcochran"}, "edited": false, "score": 0, "creation_date": 1432757162, "post_id": 30492025, "comment_id": 49062150, "body": "move constructor is used this case."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 8382, "user_id": 398461, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ixu8F.jpg?s=128&g=1", "display_name": "wcochran", "link": "https://stackoverflow.com/users/398461/wcochran"}, "edited": false, "score": 1, "creation_date": 1432757333, "post_id": 30492025, "comment_id": 49062252, "body": "@wcochran do you have any indication that he&#39;s even building this with c++11 support, and do you know that the compiler isn&#39;t doing stuff like NRVO?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 8382, "user_id": 398461, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ixu8F.jpg?s=128&g=1", "display_name": "wcochran", "link": "https://stackoverflow.com/users/398461/wcochran"}, "edited": false, "score": 0, "creation_date": 1432758202, "post_id": 30492025, "comment_id": 49062742, "body": "@wcochran The class has no move constructor."}, {"owner": {"reputation": 8382, "user_id": 398461, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ixu8F.jpg?s=128&g=1", "display_name": "wcochran", "link": "https://stackoverflow.com/users/398461/wcochran"}, "reply_to_user": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1432758337, "post_id": 30492025, "comment_id": 49062805, "body": "@AmiTavory yes you are correct -- I spoke too soon. The constructor is optimized away by NRVO (as stated in answer below)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 8382, "user_id": 398461, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ixu8F.jpg?s=128&g=1", "display_name": "wcochran", "link": "https://stackoverflow.com/users/398461/wcochran"}, "edited": false, "score": 0, "creation_date": 1432763161, "post_id": 30492025, "comment_id": 49065118, "body": "@wcochran move constructor is not implicitly generated if there was a user-defined copy constructor (this is to avoid breaking existing C++03 programs)"}], "answers": [{"comments": [{"owner": {"reputation": 567, "user_id": 3787809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a355d3f472cc7e89d22417be63f3b32a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxDevelop", "link": "https://stackoverflow.com/users/3787809/maxdevelop"}, "edited": false, "score": 0, "creation_date": 1432816019, "post_id": 30492261, "comment_id": 49088594, "body": "But when this criteria can happen?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 567, "user_id": 3787809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a355d3f472cc7e89d22417be63f3b32a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxDevelop", "link": "https://stackoverflow.com/users/3787809/maxdevelop"}, "edited": false, "score": 0, "creation_date": 1432816580, "post_id": 30492261, "comment_id": 49089072, "body": "@Saif  There is written about this in the quote."}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1432757896, "last_edit_date": 1432757896, "creation_date": 1432757542, "answer_id": 30492261, "question_id": 30492025, "link": "https://stackoverflow.com/questions/30492025/c-why-copy-ctor-not-called/30492261#30492261", "title": "C++ why copy c&#39;tor not called", "body": "<p>According to the C++ Standard (12.8 Copying and moving class objects)</p>\n\n<blockquote>\n  <p>31 When certain criteria are met, <strong>an implementation is allowed to omit\n  the copy/move construction of a class object</strong>, even if the constructor\n  selected for the copy/move operation and/or the destructor for the\n  object have side effects. In such cases, the implementation treats the\n  source and target of the omitted copy/move operation as simply two\n  different ways of referring to the same object, and the destruction of\n  that object occurs at the later of the times when the two objects\n  would have been destroyed without the optimization.124 This elision of\n  copy/move operations, called copy elision, is permitted in the\n  following circumstances (which may be combined to eliminate multiple\n  copies):</p>\n  \n  <p>\u2014 in a return statement in a function with a class return type, when\n  the expression is the name of a non-volatile automatic object (other\n  than a function or catch-clause parameter) with the same cvunqualified\n  type as the function return type, the copy/move operation can be\n  omitted by constructing the automatic object directly into the\n  function\u2019s return value</p>\n  \n  <p>\u2014 when a temporary class object that has not been bound to a reference\n  (12.2) would be copied/moved to a class object with the same\n  cv-unqualified type, the copy/move operation can be omitted by\n  constructing the temporary object directly into the target of the\n  omitted copy/move</p>\n</blockquote>\n\n<p>Take into account that in any case the copy constructor shall be available. For example if you will declare the copy constructor as private then the compiler will issue an error (if it is not a MS VS compiler:) )</p>\n"}], "owner": {"reputation": 567, "user_id": 3787809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a355d3f472cc7e89d22417be63f3b32a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxDevelop", "link": "https://stackoverflow.com/users/3787809/maxdevelop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 30492261, "answer_count": 1, "score": 2, "last_activity_date": 1432757896, "creation_date": 1432756751, "question_id": 30492025, "link": "https://stackoverflow.com/questions/30492025/c-why-copy-ctor-not-called", "title": "C++ why copy c&#39;tor not called", "body": "<p>Hey guys i have this code\n<strong>Animal.h:</strong></p>\n\n<pre><code>    /*\n * Animal.h\n *\n *  Created on: May 27, 2015\n *      Author: saif\n */\n\n#ifndef ANIMAL_H_\n#define ANIMAL_H_\n#include &lt;iostream&gt;\nusing namespace std;\nclass Animal {\n    int age;\npublic:\n    Animal();\n    Animal(const Animal &amp; rhs);\n    Animal addTo();\n    virtual ~Animal();\n};\n\n#endif /* ANIMAL_H_ */\n</code></pre>\n\n<p><strong>Animal.cpp:</strong></p>\n\n<pre><code>/*\n * Animal.cpp\n *\n *  Created on: May 27, 2015\n *      Author: saif\n */\n\n#include \"Animal.h\"\n\nAnimal::Animal()\n:age(0)\n{\n\n}\n\nAnimal::Animal(const Animal &amp; rhs)\n:age(rhs.age)\n{\n    cout &lt;&lt; \"copy constructor activated\" &lt;&lt; endl;\n}\nAnimal Animal::addTo()\n{\n    Animal ret;\n    ret.age = 5;\n    return ret;\n}\nAnimal::~Animal() {\n    cout &lt;&lt; \"NO not done, destructing..\"&lt;&lt; endl;\n}\n</code></pre>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n#include \"Animal.h\"\nint main() {\n    Animal a;\n    Animal b = a.addTo();\n    cout &lt;&lt; \"done\" &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>done\nNO not done, destructing..\nNO not done, destructing..\n</code></pre>\n\n<p><strong>Expected output:</strong></p>\n\n<pre><code>    copy constructor activated\n    done\n    NO not done, destructing..\n    NO not done, destructing.\n</code></pre>\n\n<p><strong>Or even:</strong></p>\n\n<pre><code>    copy constructor activated\n    copy constructor activated\n    done\n    NO not done, destructing..\n    NO not done, destructing.\n</code></pre>\n\n<p>Because I read from books and other resources that when we return function by value or give parameters to function by value it calls copy constructor because it makes a temporary copy, and also I have in main a situation (line 6) where copy constructor must be activated, but it didn't.. why?</p>\n"}, {"tags": ["c++", "templates", "generics"], "answers": [{"tags": [], "owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "is_accepted": true, "score": 6, "last_activity_date": 1432756238, "creation_date": 1432756238, "answer_id": 30491898, "question_id": 30491863, "link": "https://stackoverflow.com/questions/30491863/the-template-class-type-only-work-in-basic-type-not-work-in-class-type/30491898#30491898", "title": "The template class type only work in basic type not work in class type", "body": "<p><code>Student</code> is defined in the <code>MYLIB</code> namespace, just like class template <code>OrderedList</code>. So you need</p>\n\n<pre><code>MYLIB::OrderedList&lt;MYLIB::Student&gt;\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 4759536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94e2c665e95072122c9287dbc5421abd?s=128&d=identicon&r=PG&f=1", "display_name": "Roaid", "link": "https://stackoverflow.com/users/4759536/roaid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 30491898, "answer_count": 1, "score": 0, "last_activity_date": 1432757808, "creation_date": 1432756126, "last_edit_date": 1432757808, "question_id": 30491863, "link": "https://stackoverflow.com/questions/30491863/the-template-class-type-only-work-in-basic-type-not-work-in-class-type", "title": "The template class type only work in basic type not work in class type", "body": "<p>I wrote a template class but it just works for <code>int</code>, <code>double</code> and does not work for my own class. The code is as follows:</p>\n\n<pre><code>/*OrderedList.h*/\nnamespace MYLIB\n{\n    class Student\n    {\n    public:\n        display();\n\n    private:\n        char* snum;\n        char* name;\n        char* email;\n    };\n\n    template&lt;class T&gt;\n    class OrderedList\n    {\n    public:\n        OrderedList() :head(), tail(), size(0) {}\n        ~OrderedList(){}\n\n    private:\n        ......\n    };\n}\n\n/*main.cpp*/\n#include \"OrderedList.h\"\n\nint main()\n{\n    MYLIB::OrderedList&lt;int&gt; listi;\n    MYLIB::OrderedList&lt;double&gt; listd;\n    MYLIB::OrderedList&lt;Student&gt; lists;\n}\n</code></pre>\n\n<p>The error message I get is: <code>'Error: Student is not defined.'</code> Thank you for help.</p>\n"}, {"tags": ["c++", "qt", "url"], "comments": [{"owner": {"reputation": 7466, "user_id": 2146682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7120fc7548c43237662da906e3c84f43?s=128&d=identicon&r=PG", "display_name": "MrEricSir", "link": "https://stackoverflow.com/users/2146682/mrericsir"}, "edited": false, "score": 3, "creation_date": 1432756860, "post_id": 30491859, "comment_id": 49061997, "body": "The SSL errors aren&#39;t important here.  What is important is that you aren&#39;t waiting for the <code>downloaded()</code> signal to fire, so you&#39;re always going to get back an empty <code>QByteArray</code>."}, {"owner": {"reputation": 75, "user_id": 4170928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FDFr0.jpg?s=128&g=1", "display_name": "Daniel Dushistov", "link": "https://stackoverflow.com/users/4170928/daniel-dushistov"}, "reply_to_user": {"reputation": 7466, "user_id": 2146682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7120fc7548c43237662da906e3c84f43?s=128&d=identicon&r=PG", "display_name": "MrEricSir", "link": "https://stackoverflow.com/users/2146682/mrericsir"}, "edited": false, "score": 0, "creation_date": 1432759223, "post_id": 30491859, "comment_id": 49063232, "body": "Thank you for your answer! I added connect to signal and now program works fine."}], "owner": {"reputation": 75, "user_id": 4170928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FDFr0.jpg?s=128&g=1", "display_name": "Daniel Dushistov", "link": "https://stackoverflow.com/users/4170928/daniel-dushistov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1432756111, "creation_date": 1432756111, "question_id": 30491859, "link": "https://stackoverflow.com/questions/30491859/getting-always-empty-file-using-the-class-filedownloader-in-qt", "title": "Getting always empty file using the class FileDownloader in Qt", "body": "<p>I'm trying to download a file from URL using the class FileDownloader in Qt (here it's description: <a href=\"https://wiki.qt.io/Download_Data_from_URL\" rel=\"nofollow\">https://wiki.qt.io/Download_Data_from_URL</a> )</p>\n\n<p>Here's the code that I use to download and save file:</p>\n\n<pre><code>FileDownloader *m_pMyCtrl;\nQUrl myUrl(\"http://wiki.qt.io//skins/common/images/wiki.png\");\nm_pMyCtrl = new FileDownloader(myUrl, this);\n\nQFile file(\"myfile.png\");\nfile.open(QIODevice::WriteOnly);\nQDataStream out(&amp;file);\nout &lt;&lt; m_pMyCtrl-&gt;downloadedData();\n\nqDebug() &lt;&lt; m_pMyCtrl-&gt;downloadedData();\n</code></pre>\n\n<p>Then file \"myfile.png\" is appears, but it's always empty or contains four bytes (FFFFFFFF in hex). Application Output displays the following message:</p>\n\n<pre><code>qt.network.ssl: QSslSocket: can not resolve SSLv2_client_method\nqt.network.ssl: QSslSocket: can not resolve SSLv2_server_method\n</code></pre>\n\n<p>I don't know how to solve this problem. Any ideas?</p>\n\n<p>Thank you in advance for your help!</p>\n"}, {"tags": ["c++", "c", "gcc", "pthreads", "glib"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1432756520, "post_id": 30491839, "comment_id": 49061787, "body": "When you compile and link, do you specify whatever flag your platform requires for pthreads support? (Probably <code>-pthread</code>.)"}, {"owner": {"reputation": 2311, "user_id": 4566976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56346a6db33a8b54fe45d1516a8c82c8?s=128&d=identicon&r=PG&f=1", "display_name": "4566976", "link": "https://stackoverflow.com/users/4566976/4566976"}, "edited": false, "score": 0, "creation_date": 1432759888, "post_id": 30491839, "comment_id": 49063527, "body": "Which <code>glibc</code> version do you use?"}, {"owner": {"reputation": 2311, "user_id": 4566976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56346a6db33a8b54fe45d1516a8c82c8?s=128&d=identicon&r=PG&f=1", "display_name": "4566976", "link": "https://stackoverflow.com/users/4566976/4566976"}, "edited": false, "score": 0, "creation_date": 1432761697, "post_id": 30491839, "comment_id": 49064426, "body": "If you set a breakpoint in <code>pthread_cond_init</code>, does it stop at <code>pthread_cond_init@@GLIBC_2.3.2</code>? Or is there another GLIBC number?"}, {"owner": {"reputation": 7675, "user_id": 2923952, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/71908bd318301d831c4b9eb6ca1c13a2?s=128&d=identicon&r=PG&f=1", "display_name": "Siler", "link": "https://stackoverflow.com/users/2923952/siler"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1432762343, "post_id": 30491839, "comment_id": 49064758, "body": "@DavidSchwartz, yes I am compiling with <code>-pthread</code> and <code>-D _REENTRANT</code>"}, {"owner": {"reputation": 7675, "user_id": 2923952, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/71908bd318301d831c4b9eb6ca1c13a2?s=128&d=identicon&r=PG&f=1", "display_name": "Siler", "link": "https://stackoverflow.com/users/2923952/siler"}, "reply_to_user": {"reputation": 2311, "user_id": 4566976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56346a6db33a8b54fe45d1516a8c82c8?s=128&d=identicon&r=PG&f=1", "display_name": "4566976", "link": "https://stackoverflow.com/users/4566976/4566976"}, "edited": false, "score": 0, "creation_date": 1432762451, "post_id": 30491839, "comment_id": 49064814, "body": "@4566976, I&#39;m using glibc 2.5 - an very old version"}], "answers": [{"tags": [], "owner": {"reputation": 2311, "user_id": 4566976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56346a6db33a8b54fe45d1516a8c82c8?s=128&d=identicon&r=PG&f=1", "display_name": "4566976", "link": "https://stackoverflow.com/users/4566976/4566976"}, "is_accepted": false, "score": 0, "last_activity_date": 1432833494, "last_edit_date": 1432833494, "creation_date": 1432829138, "answer_id": 30511764, "question_id": 30491839, "link": "https://stackoverflow.com/questions/30491839/pthread-library-fails-when-called-from-static-constructor-code/30511764#30511764", "title": "pthread library fails when called from static constructor code", "body": "<p>In <code>glibc-2.5</code> there are two versions of <code>pthread_cond_init</code>. The old one, which is probably used, has a comment that</p>\n\n<blockquote>\n  <p>neither clocks other than CLOCK_REALTIME</p>\n</blockquote>\n\n<p>are supported, and <code>EINVAL</code> can be returned.</p>\n\n<p>In line <a href=\"https://github.com/djdeath/glib/blob/master/glib/gthread-posix.c\" rel=\"nofollow\">642</a> of <code>gthread-posix.c</code> there's the call</p>\n\n<pre><code>pthread_condattr_setclock (&amp;attr, CLOCK_MONOTONIC);\n</code></pre>\n\n<p>which probably causes the return of <code>EINVAL</code> from <code>pthread_cond_init</code>.</p>\n\n<p>If you can recompile your <code>glib</code> you could undefine <code>HAVE_PTHREAD_CONDATTR_SETCLOCK</code>.</p>\n\n<p>Otherwise I would update the <code>glibc</code> if possible.</p>\n"}], "owner": {"reputation": 7675, "user_id": 2923952, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/71908bd318301d831c4b9eb6ca1c13a2?s=128&d=identicon&r=PG&f=1", "display_name": "Siler", "link": "https://stackoverflow.com/users/2923952/siler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 980, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1432833494, "creation_date": 1432756029, "last_edit_date": 1432756456, "question_id": 30491839, "link": "https://stackoverflow.com/questions/30491839/pthread-library-fails-when-called-from-static-constructor-code", "title": "pthread library fails when called from static constructor code", "body": "<p>I have a C++ shared library object which incorporates the <a href=\"https://developer.gnome.org/glib/\" rel=\"nofollow\">GLib library</a>.</p>\n\n<p>When I create a minimal test program with an <strong>empty <code>main()</code></strong> function, and I link with the shared library, the program aborts immediately at runtime with the following GLib error message:</p>\n\n<pre><code>GLib (gthread-posix.c): Unexpected error from C library during 'pthread_cond_init': Invalid argument.  Aborting.\n</code></pre>\n\n<p>Since my main function is empty, the error must be happening in some pre-main initialization function somewhere.  So, using GDB I found that GLib has a static initialization constructor function (in <code>glib-init.c</code>) which it calls at runtime before <code>main()</code>.  Within that initialization function, it calls <code>pthread_cond_init</code>, which mysteriously fails.</p>\n\n<p>Here is the complete backtrace:</p>\n\n<pre><code>(gdb) run\nStarting program: ~/example\nwarning: no loadable sections found in added symbol-file system-supplied DSO at 0x2aaaaaaab000\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\nGLib (gthread-posix.c): Unexpected error from C library during 'pthread_cond_init': Invalid argument.  Aborting.\n\nProgram received signal SIGABRT, Aborted.\n0x0000003891830265 in raise () from /lib64/libc.so.6\n(gdb) bt\n#0  0x0000003891830265 in raise () from /lib64/libc.so.6\n#1  0x0000003891831d10 in abort () from /lib64/libc.so.6\n#2  0x00002aaaab9aed32 in g_thread_abort (status=22,\n    function=0x2aaaabcbdd2b \"pthread_cond_init\")\n    at ~/libs/glib/gthread-posix.c:75\n#3  0x00002aaaab9af349 in g_cond_impl_new ()\n    at ~/libs/glib/gthread-posix.c:656\n#4  0x00002aaaab9af39b in g_cond_get_impl (\n    cond=0x2aaaac15f690 &lt;g_once_cond&gt;)\n    at ~/libs/glib/gthread-posix.c:677\n#5  0x00002aaaab9af4b2 in g_cond_broadcast (\n    cond=0x2aaaac15f690 &lt;g_once_cond&gt;)\n    at ~/libs/glib/gthread-posix.c:792\n#6  0x00002aaaab9ab529 in g_once_init_leave (\n    location=0x2aaaac160510 &lt;g_define_type_id__volatile.11714&gt;,\n    result=6524000) at ~/libs/glib/gthread.c:682\n#7  0x00002aaaaba34a2f in g_value_array_get_type ()\n    at ~/libs/gobject/gboxed.c:132\n#8  0x00002aaaaba41b28 in _g_param_spec_types_init ()\n    at ~/libs/gobject/gparamspecs.c:1511\n#9  0x00002aaaaba30c72 in gobject_init_ctor ()\n    at ~/libs/gobject/gtype.c:4391\n#10 0x00002aaaabb2bc36 in __do_global_ctors_aux ()\n   from ./MYLIB.so\n#11 0x00002aaaaad368eb in _init () from ./MYLIB.so\n#12 0x00002aaab0180e60 in ?? ()\n#13 0x000000389140d4ab in call_init ()\n  from /lib64/ld-linux-x86-64.so.2\n#14 0x000000389140d5b5 in _dl_init_internal ()\n   from /lib64/ld-linux-x86-64.so.2\n#15 0x0000003891400aaa in _dl_start_user ()\n   from /lib64/ld-linux-x86-64.so.2\n#16 0x0000000000000001 in ?? ()\n#17 0x00007fffffffe6de in ?? ()\n#18 0x0000000000000000 in ?? ()\n</code></pre>\n\n<p>So, my first thought was perhaps the <code>.so</code> file isn't properly linked with the pthread library.  So, I used the <code>ldd</code> utility to check how it is linking to pthread:</p>\n\n<pre><code>$ ldd MYLIB.so\n        linux-vdso.so.1 =&gt;  (0x00007fff56ed1000)\n        libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00002b8a747bf000)\n        librt.so.1 =&gt; /lib64/librt.so.1 (0x00002b8a749db000)\n        libpng12.so.0 =&gt; /usr/lib64/libpng12.so.0 (0x00002b8a74be5000)\n        libfontconfig.so.1 =&gt; /usr/lib64/libfontconfig.so.1 (0x00002b8a74e09000)\n        libz.so.1 =&gt; /lib64/libz.so.1 (0x00002b8a7503d000)\n        libdl.so.2 =&gt; /lib64/libdl.so.2 (0x00002b8a75252000)\n        libstdc++.so.6 =&gt; /usr/lib64/libstdc++.so.6 (0x00002b8a75456000)\n        libm.so.6 =&gt; /lib64/libm.so.6 (0x00002b8a75756000)\n        libgcc_s.so.1 =&gt; /lib64/libgcc_s.so.1 (0x00002b8a759da000)\n        libc.so.6 =&gt; /lib64/libc.so.6 (0x00002b8a75be8000)\n        /lib64/ld-linux-x86-64.so.2 (0x0000003891400000)\n        libfreetype.so.6 =&gt; /usr/lib64/libfreetype.so.6 (0x00002b8a75f41000)\n        libexpat.so.0 =&gt; /lib64/libexpat.so.0 (0x00002b8a761c6000)\n</code></pre>\n\n<p>So, it is properly linked with libpthread via <code>/usr/lib64/pthread.so.0</code></p>\n\n<p>So then I looked at the GLib source code that is failing on <code>pthread_cond_init</code>.  It's very straightforward.  I removed some <code>#ifdef</code> statements for clarity:</p>\n\n<pre><code>  pthread_condattr_t attr;\n  pthread_cond_t *cond;\n  gint status;\n  pthread_condattr_init (&amp;attr);\n\n  cond = malloc (sizeof (pthread_cond_t));\n  if G_UNLIKELY (cond == NULL)\n    g_thread_abort (errno, \"malloc\");\n\n  if G_UNLIKELY ((status = pthread_cond_init (cond, &amp;attr)) != 0) &lt;--- this fails\n    g_thread_abort (status, \"pthread_cond_init\");\n</code></pre>\n\n<p>So nothing looks wrong there, and I doubt GLib would have any obvious error like this, considering it is used extensively throughout many major Linux codebases.</p>\n\n<p>So, at this point, I'm out of ideas.  What are some possible and/or likely causes for this problem?  Is it possible this could be a order-of-initialization issue, where the pthread lib needs to perform some static initialization before GLib can use it?  </p>\n"}, {"tags": ["c++", "malloc", "sizeof"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 1, "creation_date": 1432755872, "post_id": 30491701, "comment_id": 49061382, "body": "Instead of writing C code in C++, why not use C++? (in other words: prefer <code>new</code> over <code>malloc</code>, but use smart pointers, automatic storage, and container classes where possible). Also, <code>struct node { };</code> makes <code>node</code> a typename, so you don&#39;t need to repeat the <code>struct</code> when using the type."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1432757571, "post_id": 30491701, "comment_id": 49062394, "body": "<code>c++ | size of a node in linked list</code>  sizeof() is a compile time value, therefore your issue has absolutely nothing to do with <code>malloc</code> or linked lists."}], "answers": [{"comments": [{"owner": {"reputation": 2982, "user_id": 976766, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/812753feeddc1aa93f23b1e0d733b7b5?s=128&d=identicon&r=PG", "display_name": "g4ur4v", "link": "https://stackoverflow.com/users/976766/g4ur4v"}, "edited": false, "score": 0, "creation_date": 1432756078, "post_id": 30491757, "comment_id": 49061518, "body": "why is sizeof(head) is 4 bytes, why not something else ?"}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "reply_to_user": {"reputation": 2982, "user_id": 976766, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/812753feeddc1aa93f23b1e0d733b7b5?s=128&d=identicon&r=PG", "display_name": "g4ur4v", "link": "https://stackoverflow.com/users/976766/g4ur4v"}, "edited": false, "score": 0, "creation_date": 1432756138, "post_id": 30491757, "comment_id": 49061561, "body": "@g4ur4v: Because that how many bytes it takes to store the address of an object on your implementation."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 2982, "user_id": 976766, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/812753feeddc1aa93f23b1e0d733b7b5?s=128&d=identicon&r=PG", "display_name": "g4ur4v", "link": "https://stackoverflow.com/users/976766/g4ur4v"}, "edited": false, "score": 0, "creation_date": 1432757715, "post_id": 30491757, "comment_id": 49062480, "body": "@g4ur4v See here:  <a href=\"http://coliru.stacked-crooked.com/a/7c2bdc2772127d2f\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/7c2bdc2772127d2f</a>  The size <i>can</i> be &quot;something else&quot;, as Benjamin pointed out."}], "tags": [], "owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "is_accepted": true, "score": 4, "last_activity_date": 1432755820, "creation_date": 1432755820, "answer_id": 30491757, "question_id": 30491701, "link": "https://stackoverflow.com/questions/30491701/size-of-a-node-in-linked-list/30491757#30491757", "title": "size of a node in linked list", "body": "<p><code>head</code> is not a node, it is a pointer to a node. So <code>sizeof(head)</code> gives you the size of a pointer, which has no relation to the size of the thing it points at. <code>sizeof(*head)</code> would give you the size of a node.</p>\n"}, {"comments": [{"owner": {"reputation": 2982, "user_id": 976766, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/812753feeddc1aa93f23b1e0d733b7b5?s=128&d=identicon&r=PG", "display_name": "g4ur4v", "link": "https://stackoverflow.com/users/976766/g4ur4v"}, "edited": false, "score": 0, "creation_date": 1432756090, "post_id": 30491774, "comment_id": 49061525, "body": "why is sizeof(head) is 4 bytes, why not something else ?"}, {"owner": {"reputation": 2963, "user_id": 1855442, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61b99c64abe73180373944232b0c734f?s=128&d=identicon&r=PG", "display_name": "Pradheep", "link": "https://stackoverflow.com/users/1855442/pradheep"}, "reply_to_user": {"reputation": 2982, "user_id": 976766, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/812753feeddc1aa93f23b1e0d733b7b5?s=128&d=identicon&r=PG", "display_name": "g4ur4v", "link": "https://stackoverflow.com/users/976766/g4ur4v"}, "edited": false, "score": 0, "creation_date": 1432756127, "post_id": 30491774, "comment_id": 49061555, "body": "The size of pointer can be anything 4 bytes or 8 bytes depending on architecture."}], "tags": [], "owner": {"reputation": 2963, "user_id": 1855442, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61b99c64abe73180373944232b0c734f?s=128&d=identicon&r=PG", "display_name": "Pradheep", "link": "https://stackoverflow.com/users/1855442/pradheep"}, "is_accepted": false, "score": 0, "last_activity_date": 1432755854, "creation_date": 1432755854, "answer_id": 30491774, "question_id": 30491701, "link": "https://stackoverflow.com/questions/30491701/size-of-a-node-in-linked-list/30491774#30491774", "title": "size of a node in linked list", "body": "<p>The reason is as follows</p>\n\n<pre><code> cout&lt;&lt;sizeof(struct node) // returns the size of struct node 4 bytes for pointer and 4 bytes for int\n sizeof(head) // returns the size of pointer 4 bytes\n sizeof(int); // returns the size of integer 4 bytes\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18613, "user_id": 818182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89b420763192c3b763f4cffa789fe39f?s=128&d=identicon&r=PG", "display_name": "Austin Brunkhorst", "link": "https://stackoverflow.com/users/818182/austin-brunkhorst"}, "is_accepted": false, "score": 0, "last_activity_date": 1432755868, "creation_date": 1432755868, "answer_id": 30491783, "question_id": 30491701, "link": "https://stackoverflow.com/questions/30491701/size-of-a-node-in-linked-list/30491783#30491783", "title": "size of a node in linked list", "body": "<p><code>sizeof</code> evaluates the size of the <em>type</em> of the expression. In this case <code>head</code> is a pointer. On a 32 bit machine pointers are 4 bytes, coincidentally integers are also 4 bytes.</p>\n\n<p>To correctly get the size of <code>head</code> without the actual type name, <code>sizeof</code> is smart enough to figure it out if you de-reference the object.</p>\n\n<pre><code>// == sizeof(struct node)\nsizeof(*head)\n</code></pre>\n"}], "owner": {"reputation": 2982, "user_id": 976766, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/812753feeddc1aa93f23b1e0d733b7b5?s=128&d=identicon&r=PG", "display_name": "g4ur4v", "link": "https://stackoverflow.com/users/976766/g4ur4v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2206, "favorite_count": 0, "accepted_answer_id": 30491757, "answer_count": 3, "score": -1, "last_activity_date": 1432830887, "creation_date": 1432755671, "last_edit_date": 1432830887, "question_id": 30491701, "link": "https://stackoverflow.com/questions/30491701/size-of-a-node-in-linked-list", "title": "size of a node in linked list", "body": "<p><strong>Program:</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\nusing namespace std;\nstruct node \n{\n    int data;\n    struct node *next;\n};\n\nint main() \n{\n    struct node* head = NULL;\n    head = (struct node*)malloc(sizeof(struct node)); \n    cout&lt;&lt;sizeof(struct node)&lt;&lt;\"\\n\"&lt;&lt;sizeof(head)&lt;&lt;\"\\n\"&lt;&lt;sizeof(int);\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>8\n4\n4\n</code></pre>\n\n<ol>\n<li>Why is <code>sizeof(struct node)</code> different than <code>sizeof(head)</code> ?\nWouldn't have malloc allocated 8 bytes ? </li>\n<li>Since <code>sizeof(head)</code> is\nsame as <code>sizeof(int)</code> , where is <code>next</code> stored then ?</li>\n</ol>\n"}, {"tags": ["c++", "opencv", "ubuntu", "sift"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4627462, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/82cfcdd42bdf97573a8563c1cdb2e68c?s=128&d=identicon&r=PG&f=1", "display_name": "knowless", "link": "https://stackoverflow.com/users/4627462/knowless"}, "edited": false, "score": 0, "creation_date": 1432988477, "post_id": 30503305, "comment_id": 49164708, "body": "I dont know if I understand your code. Sry that I answer after 2 days, but I thought that I don&#39;t really understand how sift works and I want read first. But it doesn&#39;t helped.What do you mean with the parameter pointsInFirstAreaRight... The problem in your code is that I can not use some functions like .push_back. I want give the code in a fpga and how I understand, it doesn&#39;t like functions with libraries. So I need a very easy Code..."}, {"owner": {"reputation": 61, "user_id": 4414901, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U2QwVUNO3Mw/AAAAAAAAAAI/AAAAAAAAACY/blkTsEO-QMg/photo.jpg?sz=128", "display_name": "Isra-MiAn", "link": "https://stackoverflow.com/users/4414901/isra-mian"}, "reply_to_user": {"reputation": 13, "user_id": 4627462, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/82cfcdd42bdf97573a8563c1cdb2e68c?s=128&d=identicon&r=PG&f=1", "display_name": "knowless", "link": "https://stackoverflow.com/users/4627462/knowless"}, "edited": false, "score": 0, "creation_date": 1433002331, "post_id": 30503305, "comment_id": 49169001, "body": "The parameterpointsInFirstArea is because I thought that you want classifier the keypoints depending on their positions so this parameter is vector of keypoints to save the keypoints that are in (20 x 20) area."}, {"owner": {"reputation": 61, "user_id": 4414901, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U2QwVUNO3Mw/AAAAAAAAAAI/AAAAAAAAACY/blkTsEO-QMg/photo.jpg?sz=128", "display_name": "Isra-MiAn", "link": "https://stackoverflow.com/users/4414901/isra-mian"}, "reply_to_user": {"reputation": 13, "user_id": 4627462, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/82cfcdd42bdf97573a8563c1cdb2e68c?s=128&d=identicon&r=PG&f=1", "display_name": "knowless", "link": "https://stackoverflow.com/users/4627462/knowless"}, "edited": false, "score": 0, "creation_date": 1433003211, "post_id": 30503305, "comment_id": 49169305, "body": "About the push_back function for me it&#39;s works well, I don&#39;d know why you can use it. In this case this function copy the keypoints in a point 2f.                                See the sift code that I put in my anser."}], "tags": [], "owner": {"reputation": 61, "user_id": 4414901, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U2QwVUNO3Mw/AAAAAAAAAAI/AAAAAAAAACY/blkTsEO-QMg/photo.jpg?sz=128", "display_name": "Isra-MiAn", "link": "https://stackoverflow.com/users/4414901/isra-mian"}, "is_accepted": false, "score": 0, "last_activity_date": 1433003106, "last_edit_date": 1433003106, "creation_date": 1432807329, "answer_id": 30503305, "question_id": 30491693, "link": "https://stackoverflow.com/questions/30491693/c-opencv-sift-positiondetection/30503305#30503305", "title": "c++ Opencv sift Positiondetection", "body": "<p>If I undertand you well you would to find keypoints positions and classifier them. To know the keypoints position you need to do a bucle crossing the keypoints vectors and save the position in a matrix.</p>\n\n<p>Then when you can compare the position of this keypoints with a images areas (whatever you want) and classify them depending on the area in image they are.</p>\n\n<pre><code>Mat pointsInFirstAreaRight, pointInFirstAreaLeft;\n    for (int i = 0; i &lt; 2; i++){\n           for(vector&lt;DMatch&gt;::const_iterator it = keypoints[i].begin(); it!= keypoints[i].end(); ++it){\n                 // Get the position of keypoints\n                 float x = [it-&gt;queryIdx].pt.x;\n                 float y = [it-&gt;queryIdx].pt.y;\n\n                 //If the point detected are in the 20 first pixels   \n                 if ( (x &lt; 20) &amp;&amp; (y &gt; 20) )\n                 {\n                       //Classify this point in this area\n                       if ( i == 0)\n                       pointsInFirstAreaRight.push_back(Point2f(x, y));\n                       else if (i == 1)\n                       pointsInFistAreaLeft.push_back(Point2f(x, y));\n                  }\n          }\n     }\n</code></pre>\n\n<p>About the sift function, it works doing the detect and extractor at the same time. I use it in my code like this:</p>\n\n<pre><code>&gt;  SIFT sift;\n&gt;         \n&gt;         /* get keypoints on the images */\n&gt;         sift(imagenI, Mat(), keypoints[0], descriptors[0]);\n&gt;         sift(imagenD, Mat(), keypoints[1], descriptors[1]);\n</code></pre>\n\n<p>and then I detect keypoints a extrac the descriptors of points.</p>\n\n<p>Then I only have to do the matching.</p>\n\n<p>I hope to help you.</p>\n"}], "owner": {"reputation": 13, "user_id": 4627462, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/82cfcdd42bdf97573a8563c1cdb2e68c?s=128&d=identicon&r=PG&f=1", "display_name": "knowless", "link": "https://stackoverflow.com/users/4627462/knowless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 320, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433003106, "creation_date": 1432755657, "question_id": 30491693, "link": "https://stackoverflow.com/questions/30491693/c-opencv-sift-positiondetection", "title": "c++ Opencv sift Positiondetection", "body": "<p>I work with ubuntu and the Code is in C++ with opencv.\nI test a little bit to detect some parts of pictures. It works very well, but now I want to find the position in my big picture. Here is the code:</p>\n\n<pre><code>#include...\nusing namespace cv;\n\nint main(int argc, char** argv) {\n\n\n\nMat img = imread(\"/home/ubuntu/workspace2/sift/src/inputklein.jpg\",CV_LOAD_IMAGE_GRAYSCALE);\n\n\n while(1){\n             Mat img2 =imread(\"/home/ubuntu/workspace2/sift/src/input.jpeg\",CV_LOAD_IMAGE_GRAYSCALE);   //frame\n             //initialize SIFT\n             // Create smart pointer for SIFT feature detector.\n             SIFT sift;\n             vector&lt;KeyPoint&gt; key_points;\n             vector&lt;KeyPoint&gt; key_points2;\n\n             //-- Step 1: Detect the keypoints using SURF Detector\n             int minHessian = 100;\n             SurfFeatureDetector detector( minHessian );\n             detector.detect( img, key_points );\n             detector.detect( img2, key_points2 );\n\n             //-- Step 2: Calculate descriptors (feature vectors)\n             SurfDescriptorExtractor extractor;\n\n             Mat descriptors1;\n             Mat descriptors2;\n\n             extractor.compute( img, key_points, descriptors1 );\n             extractor.compute( img2, key_points2, descriptors2 );\n\n\n             //-- Step 3: Matching descriptor vectors using FLANN matcher\n              FlannBasedMatcher matcher;\n              std::vector&lt; DMatch &gt; matches;\n              matcher.match( descriptors1, descriptors2, matches );\n\n              double max_dist = 20; double min_dist = 10;\n\n\n              //-- Quick calculation of max and min distances between keypoints\n                for( int i = 0; i &lt; descriptors1.rows; i++ )\n                { double dist = matches[i].distance;\n                  if( dist &lt; min_dist ) min_dist = dist;\n                  if( dist &gt; max_dist ) max_dist = dist;\n                }\n\n               //std::cout&lt;&lt;\"Max dist :\"&lt;&lt; max_dist ;\n               //std::cout&lt;&lt;\"Min dist :\"&lt;&lt; min_dist ;\n\n               //-- Draw only \"good\" matches (i.e. whose distance is less than 2*min_dist,\n                //-- or a small arbitary value ( 0.02 ) in the event that min_dist is very\n                //-- small)\n                //-- PS.- radiusMatch can also be used here.\n                std::vector&lt; DMatch &gt; good_matches;\n\n                for( int i = 0; i &lt; descriptors1.rows; i++ )\n                { if( matches[i].distance &lt;= max(2*min_dist, 0.02) )\n                  { good_matches.push_back( matches[i]); }\n                }\n\n                //-- Draw only \"good\" matches\n                Mat img_matches;\n                drawMatches( img, key_points, img2, key_points2,\n                             good_matches, img_matches, Scalar::all(-1), Scalar::all(-1),\n                             vector&lt;char&gt;(), DrawMatchesFlags::NOT_DRAW_SINGLE_POINTS );\n\n\n              //std::cout&lt;&lt;key_points[1].pt.x&lt;&lt;\"\\n\";\n              //std::cout&lt;&lt;key_points2[1].pt.y&lt;&lt;\"\\n\";\n\n\n\n   //-- 3. Apply the classifier to the frame\n\n\n         cv::imshow( \"test\", img_matches ); //img_matches\n        waitKey(30);\n }\n\nreturn 0;\n}\n</code></pre>\n\n<p>Okay, but how can I get the position ore the place where the most keypoints are. Can someone give me a tip how I must understand it?\nI saw that I can use something like this:\n\"key_points[1].pt.x\" or with y, but do I not must check it to every x,y-place?\nnext would be:\ngood_matches[1].queryIdx but here is it the same question. How can I find where it is?</p>\n\n<ol start=\"2\">\n<li><p>A big question is for me, why is there only a loop over row?\nShould it not be over row and cols? In my destination it should works like in an array(x,y) and I check every position if it is the same...(have problems with no easy datatypes...)</p></li>\n<li><p>Where I can find/or how the place of the code of drawMatches (for example).\nNormal way I would try \"Open Declaration\" (using Eclipse,C++), but I only see the header and not the real function.\nI need the code and hope I can change all without opencv, or maybe that I can do the loops... and so I must understand how I can read and use the vector DMatch...</p></li>\n</ol>\n\n<p>Thx for your help.\nBest Regards,</p>\n"}, {"tags": ["c++", "function", "pointers"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1432755743, "post_id": 30491666, "comment_id": 49061311, "body": "The * applies to the thing which comes before it (Tower), not the name of the function. This function returns a <i>pointer to</i> a Tower. (Just as the second member of <code>struct Tower</code> is a <i>pointer to</i> a Tower.)"}, {"owner": {"reputation": 14673, "user_id": 296460, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FGDo8.jpg?s=128&g=1", "display_name": "shuttle87", "link": "https://stackoverflow.com/users/296460/shuttle87"}, "edited": false, "score": 1, "creation_date": 1432755762, "post_id": 30491666, "comment_id": 49061324, "body": "One returns a pointer and the other does not."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1432755906, "post_id": 30491666, "comment_id": 49061403, "body": "Related: <a href=\"http://stackoverflow.com/q/8610350/10077\">stackoverflow.com/q/8610350/10077</a>"}, {"owner": {"reputation": 33, "user_id": 4946284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9775156575cea728a43aa7eddc9e02f?s=128&d=identicon&r=PG&f=1", "display_name": "greeneyedguy", "link": "https://stackoverflow.com/users/4946284/greeneyedguy"}, "edited": false, "score": 0, "creation_date": 1432905942, "post_id": 30491666, "comment_id": 49135112, "body": "Thanks, makes sense."}, {"owner": {"reputation": 33, "user_id": 4946284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9775156575cea728a43aa7eddc9e02f?s=128&d=identicon&r=PG&f=1", "display_name": "greeneyedguy", "link": "https://stackoverflow.com/users/4946284/greeneyedguy"}, "edited": false, "score": 0, "creation_date": 1432919918, "post_id": 30491666, "comment_id": 49144534, "body": "Follow up question added"}], "answers": [{"tags": [], "owner": {"reputation": 603, "user_id": 4142717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ka9sc.jpg?s=128&g=1", "display_name": "sabreitweiser", "link": "https://stackoverflow.com/users/4142717/sabreitweiser"}, "is_accepted": false, "score": 1, "last_activity_date": 1432755759, "creation_date": 1432755759, "answer_id": 30491733, "question_id": 30491666, "link": "https://stackoverflow.com/questions/30491666/in-c-what-is-the-difference-between-functionarguments-and-functionargume/30491733#30491733", "title": "In C++ what is the difference between *function(arguments..) and function(arguments)", "body": "<p>It means that the function returns a pointer, rather than an object.</p>\n\n<p>For example</p>\n\n<pre><code>Tower createTower(string name, Tower *link);\n</code></pre>\n\n<p>returns a Tower object while</p>\n\n<pre><code>Tower *createTower(string name, Tower *link);\n</code></pre>\n\n<p>returns a pointer to a tower object.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4946284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9775156575cea728a43aa7eddc9e02f?s=128&d=identicon&r=PG&f=1", "display_name": "greeneyedguy", "link": "https://stackoverflow.com/users/4946284/greeneyedguy"}, "edited": false, "score": 0, "creation_date": 1432905672, "post_id": 30491741, "comment_id": 49134912, "body": "Thanks, this makes it more clear. I now understand that whenever I want to return a pointer to a struct, this makes sense. Also, is this a function pointer?"}, {"owner": {"reputation": 2550, "user_id": 4931993, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HIOGhudLQzQ/AAAAAAAAAAI/AAAAAAAAAG8/RhqG4yB0Ky0/photo.jpg?sz=128", "display_name": "Eric Appelt", "link": "https://stackoverflow.com/users/4931993/eric-appelt"}, "reply_to_user": {"reputation": 33, "user_id": 4946284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9775156575cea728a43aa7eddc9e02f?s=128&d=identicon&r=PG&f=1", "display_name": "greeneyedguy", "link": "https://stackoverflow.com/users/4946284/greeneyedguy"}, "edited": false, "score": 0, "creation_date": 1432906936, "post_id": 30491741, "comment_id": 49135815, "body": "A function pointer points to the memory address of an actual function, rather than some data type like an <code>int</code> or <code>struct</code>. For example, you could define <code>Tower* (*func_ptr) (string, Tower*)</code>. Then <code>func_ptr</code> can be set to the address of any function that takes a <code>string</code> and <code>Tower*</code> as arguments, and returns a <code>Tower*</code>. So you can set <code>func_ptr = &amp;createTower</code> Then you can call <code>func_ptr(name, link)</code> and the same code as <code>createTower</code> will be executed. You can use function pointers to swap out function code as needed based on changing conditions."}, {"owner": {"reputation": 33, "user_id": 4946284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9775156575cea728a43aa7eddc9e02f?s=128&d=identicon&r=PG&f=1", "display_name": "greeneyedguy", "link": "https://stackoverflow.com/users/4946284/greeneyedguy"}, "edited": false, "score": 0, "creation_date": 1432919706, "post_id": 30491741, "comment_id": 49144418, "body": "Edited question, extended to ask a follow up question."}], "tags": [], "owner": {"reputation": 2550, "user_id": 4931993, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HIOGhudLQzQ/AAAAAAAAAAI/AAAAAAAAAG8/RhqG4yB0Ky0/photo.jpg?sz=128", "display_name": "Eric Appelt", "link": "https://stackoverflow.com/users/4931993/eric-appelt"}, "is_accepted": true, "score": 0, "last_activity_date": 1432755776, "creation_date": 1432755776, "answer_id": 30491741, "question_id": 30491666, "link": "https://stackoverflow.com/questions/30491666/in-c-what-is-the-difference-between-functionarguments-and-functionargume/30491741#30491741", "title": "In C++ what is the difference between *function(arguments..) and function(arguments)", "body": "<p>The function <code>Tower *createTower(string name, Tower *link);</code> returns a pointer to a <code>Tower</code> object. The asterisk before the function name is just specifying that the return type is a pointer. </p>\n\n<p>You can also write the function definition this way which is equivalent but (in my opinion) more clear:</p>\n\n<pre><code>Tower* createTower(string name, Tower* link);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4946284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9775156575cea728a43aa7eddc9e02f?s=128&d=identicon&r=PG&f=1", "display_name": "greeneyedguy", "link": "https://stackoverflow.com/users/4946284/greeneyedguy"}, "edited": false, "score": 0, "creation_date": 1432905787, "post_id": 30494548, "comment_id": 49135002, "body": "Thanks, this does make it clear. Is there a good reference on smart pointers I can refer? Appreciate the help!"}], "tags": [], "owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "is_accepted": false, "score": 0, "last_activity_date": 1432767618, "creation_date": 1432767618, "answer_id": 30494548, "question_id": 30491666, "link": "https://stackoverflow.com/questions/30491666/in-c-what-is-the-difference-between-functionarguments-and-functionargume/30494548#30494548", "title": "In C++ what is the difference between *function(arguments..) and function(arguments)", "body": "<blockquote>\n  <p>which one should be used.</p>\n</blockquote>\n\n<p>Note that the first form:</p>\n\n<pre><code>Tower  createTower(...);\n</code></pre>\n\n<p>might be used as assignment (thus extending the instance's life), as in</p>\n\n<pre><code>...\nTower T1 = createTower(...);  \n...\n</code></pre>\n\n<p>or, you might use as an anonymous temporary</p>\n\n<pre><code> std::cout &lt;&lt; createTower(...) &lt;&lt; ...\n</code></pre>\n\n<hr>\n\n<p>If Tower is BIG, you might have motivation to keep the expensive instance around for more than just the print duration ... so maybe use the former and do</p>\n\n<pre><code>std::cout &lt;&lt; T1 &lt;&lt; ...\n</code></pre>\n\n<p>Else, if you are worried about stack space, and not so worried about remembering to not-leak-memory, then you have motivation to dynamically allocate the instance in the heap (this also supports a long-life-span)</p>\n\n<pre><code> Tower* T1 = createTower(...);  // BIG tower in heap\n\n std::cout &lt;&lt; *T1 &lt;&lt; ....\n\n // .... and some time later, you should remember to \n\n delete T1;\n</code></pre>\n\n<p>Others would recommend you use a smart pointer (and learn to use scope) to control when the delete should occur.</p>\n\n<hr>\n\n<p>Summary: </p>\n\n<p>stack vs heap vs size of instance</p>\n\n<p>life span using scope controls</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4946284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9775156575cea728a43aa7eddc9e02f?s=128&d=identicon&r=PG&f=1", "display_name": "greeneyedguy", "link": "https://stackoverflow.com/users/4946284/greeneyedguy"}, "edited": false, "score": 0, "creation_date": 1432907406, "post_id": 30498692, "comment_id": 49136177, "body": "From what I&#39;m learning, this would not be a function pointer. The function pointer equivalent should be - <code>Tower* (*createTower)(string name, Tower *link)</code> Correct me if I&#39;m wrong"}], "tags": [], "owner": {"reputation": 136, "user_id": 4936024, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/G9uc6.jpg?s=128&g=1", "display_name": "Kunal Saini", "link": "https://stackoverflow.com/users/4936024/kunal-saini"}, "is_accepted": false, "score": -1, "last_activity_date": 1432794190, "creation_date": 1432794190, "answer_id": 30498692, "question_id": 30491666, "link": "https://stackoverflow.com/questions/30491666/in-c-what-is-the-difference-between-functionarguments-and-functionargume/30498692#30498692", "title": "In C++ what is the difference between *function(arguments..) and function(arguments)", "body": "<p>Tower *createTower(string name, Tower *link);\nTHIS IS USED WHEN YOU ARE RETURNING A TOWER(MEANS A STRUCTURE) IN YOUR FUNCTION NAMED createTower(THIS IS A FUNCTION POINTER WHICH WILL RETURN A STRUCTURE)</p>\n"}], "owner": {"reputation": 33, "user_id": 4946284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9775156575cea728a43aa7eddc9e02f?s=128&d=identicon&r=PG&f=1", "display_name": "greeneyedguy", "link": "https://stackoverflow.com/users/4946284/greeneyedguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 30491741, "answer_count": 4, "score": 0, "last_activity_date": 1432919646, "creation_date": 1432755558, "last_edit_date": 1432919646, "question_id": 30491666, "link": "https://stackoverflow.com/questions/30491666/in-c-what-is-the-difference-between-functionarguments-and-functionargume", "title": "In C++ what is the difference between *function(arguments..) and function(arguments)", "body": "<p>I see functions of the type:</p>\n\n<pre><code>data_type *function_name(arguments...)\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>data_type function_name(arguments...)\n</code></pre>\n\n<p>I'm trying to learn when which one should be used. Why is this done in the example below? (This is from a textbook for a course.) When should I write functions like these?</p>\n\n<pre><code>struct Tower\n{\n    string name;\n    Tower *link;\n};\n\nTower *createTower(string name, Tower *link);\n</code></pre>\n\n<p>Further can someone clarify this?</p>\n\n<pre><code>Tower* createTower(string name, Tower *link)\n{\n    Tower* tp = new Tower;\n    tp-&gt;name = name;\n    tp-&gt;link = link;\n    return tp;\n}\n\nTower* createBeconsOfGondor(){\n    Tower *tp = createTower(\"Rohan\", NULL); // Points to nothing\n    tp = createTower(\"Halifiren\", tp); // Still returns pointer?\n}\n</code></pre>\n\n<p>In the second line of the createBeconsOfGondor() function, how is the return of that function still a pointer?</p>\n"}, {"tags": ["c++", "gcc", "header-files"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1432756059, "post_id": 30491589, "comment_id": 49061502, "body": "There is no need to edit that code if all you want to do is have the <code>#if</code> macro turned on or off.  That&#39;s one of the purposes of such macros -- conditional compilation."}], "answers": [{"tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 0, "last_activity_date": 1432755734, "creation_date": 1432755734, "answer_id": 30491724, "question_id": 30491589, "link": "https://stackoverflow.com/questions/30491589/is-it-ok-to-edit-gcc-header-files/30491724#30491724", "title": "Is it OK to Edit GCC Header Files?", "body": "<p>Yes, you can edit and change GCC header files.</p>\n\n<p>Be aware that when GCC upgrades, your changes may be lost.  You would have to merge your changes into the newer header files.  </p>\n\n<p>For this reason, common rule of thumb is not to modify compiler header files.  </p>\n\n<p><strong>Edit 1:</strong><br>\nAlso, if you share your code, you will need to have the clients make the same mods to the GCC header files that you did.  Some clients may not want their compiler header files changed.  Same rules apply when you have other people working on the same project.  </p>\n\n<p>Also, will your changes affect future projects?    Future projects may use the GCC header files also.</p>\n"}, {"comments": [{"owner": {"reputation": 79428, "user_id": 365496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1397eae94e7fe715f040459c988c40b1?s=128&d=identicon&r=PG", "display_name": "bames53", "link": "https://stackoverflow.com/users/365496/bames53"}, "edited": false, "score": 0, "creation_date": 1432757017, "post_id": 30491747, "comment_id": 49062084, "body": "@EinsteinJr. That&#39;s the wrong syntax for a <code>#define</code>. The correct syntax is without the <code>=</code>. However rather than writing a <code>#define</code> into your source code I would recommend you edit your makefile or whatever you&#39;re using to build. GCC should get a flag like: <code>-D_WIN32_WINNT=0x600</code>"}, {"owner": {"reputation": 115, "user_id": 4708081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/57GOc.jpg?s=128&g=1", "display_name": "NULL", "link": "https://stackoverflow.com/users/4708081/null"}, "edited": false, "score": 0, "creation_date": 1432757191, "post_id": 30491747, "comment_id": 49062173, "body": "Ok, and then add a comment in my source file so other people can compile it."}, {"owner": {"reputation": 79428, "user_id": 365496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1397eae94e7fe715f040459c988c40b1?s=128&d=identicon&r=PG", "display_name": "bames53", "link": "https://stackoverflow.com/users/365496/bames53"}, "reply_to_user": {"reputation": 115, "user_id": 4708081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/57GOc.jpg?s=128&g=1", "display_name": "NULL", "link": "https://stackoverflow.com/users/4708081/null"}, "edited": false, "score": 0, "creation_date": 1432762745, "post_id": 30491747, "comment_id": 49064943, "body": "@NULL Usually you&#39;ll distribute your build files along with the source, so the makefile itself would be the documentation."}], "tags": [], "owner": {"reputation": 79428, "user_id": 365496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1397eae94e7fe715f040459c988c40b1?s=128&d=identicon&r=PG", "display_name": "bames53", "link": "https://stackoverflow.com/users/365496/bames53"}, "is_accepted": true, "score": 5, "last_activity_date": 1432756180, "last_edit_date": 1432756180, "creation_date": 1432755791, "answer_id": 30491747, "question_id": 30491589, "link": "https://stackoverflow.com/questions/30491589/is-it-ok-to-edit-gcc-header-files/30491747#30491747", "title": "Is it OK to Edit GCC Header Files?", "body": "<p>Editing the headers will hurt because your code is no longer being built against an external library you simply depend on. Instead you have effectively made that external code part of your project, and now you have to manage it like other source code in your project. You should keep it in your version control system, for example.</p>\n\n<p>Yes, there is a better way: you can simply define <code>_WIN32_WINNT</code> as the Windows code expects it to be defined. Visual Studio projects define this macro by default, but you have to do that manually when building with gcc on Windows.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa383745%28v=vs.85%29.aspx#macros_for_conditional_declarations\" rel=\"nofollow\">This page</a> defines the values for each version of Windows.</p>\n"}, {"tags": [], "owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "is_accepted": false, "score": 0, "last_activity_date": 1432755863, "creation_date": 1432755863, "answer_id": 30491781, "question_id": 30491589, "link": "https://stackoverflow.com/questions/30491589/is-it-ok-to-edit-gcc-header-files/30491781#30491781", "title": "Is it OK to Edit GCC Header Files?", "body": "<p>You can modify them but it is usually a bad idea, because it will make you compilation difficult to repeat.</p>\n\n<p>In this particular case, the right solution is just to define <code>_WIN32_WINNT</code> as <code>0x0600</code> or higher. This macro is used to specify the Windows version you are targeting, and you clearly are targeting at least version 6, or you would not be able to use this value. The Windows SDK header files use this macro to conditially include declarations available in every version of Windows, so you cannot use a function/field/enum value from Windows 8 in a program intended to run in Windows 7, for example.</p>\n\n<p>So just add <code>-D_WIN32_WINNT=0x0600</code> to your compilation command and leave the header files alone...</p>\n"}], "owner": {"reputation": 115, "user_id": 4708081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/57GOc.jpg?s=128&g=1", "display_name": "NULL", "link": "https://stackoverflow.com/users/4708081/null"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 30491747, "answer_count": 3, "score": 1, "last_activity_date": 1432756180, "creation_date": 1432755305, "question_id": 30491589, "link": "https://stackoverflow.com/questions/30491589/is-it-ok-to-edit-gcc-header-files", "title": "Is it OK to Edit GCC Header Files?", "body": "<p>I was trying to compile some example code from MSDN with GCC on Windows 7 (please ignore the use of goto and the terrible formatting; it's not my code):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;windows.h&gt;\n\ntypedef struct _TOKEN_ELEVATION {\n    DWORD TokenIsElevated;\n} TOKEN_ELEVATION, *PTOKEN_ELEVATION;\n\nBOOL IsProcessElevated()\n{\nBOOL fIsElevated = FALSE;\nDWORD dwError = ERROR_SUCCESS;\nHANDLE hToken = NULL;\n\nif (!OpenProcessToken(GetCurrentProcess(), TOKEN_QUERY, &amp;hToken))\n{\n    dwError = GetLastError();\n    goto Cleanup;\n}\n\nTOKEN_ELEVATION elevation;\nDWORD dwSize;\nif (!GetTokenInformation(hToken, TokenElevation, &amp;elevation,\n    sizeof(elevation), &amp;dwSize))\n{\n    dwError = GetLastError();\n    goto Cleanup;\n}\nfIsElevated = elevation.TokenIsElevated;\n\nCleanup:\nif (hToken)\n{\n    CloseHandle(hToken);\n    hToken = NULL;\n}\nif (ERROR_SUCCESS != dwError)\n{\n    throw dwError;\n}\nreturn fIsElevated;\n}\n\nint main()\n{\ntry\n{\n    if (IsProcessElevated())\n        wprintf (L\"Process is elevated\\n\");\n    else\n        wprintf (L\"Process is not elevated\\n\");\n}\ncatch (DWORD dwError)\n{\n    wprintf(L\"IsProcessElevated failed w/err %lu\\n\", dwError);\n}\n}\n</code></pre>\n\n<p>I kept getting the error <code>TokenElevation was not declared in this scope</code>.  While trying to figure it out I saw that the TokenElevation member of the TOKEN_INFORMATION_CLASS struct was between two #ifdef tags:</p>\n\n<pre><code>typedef enum _TOKEN_INFORMATION_CLASS {\nTokenUser=1,\nTokenGroups,\nTokenPrivileges,\nTokenOwner,\nTokenPrimaryGroup,\nTokenDefaultDacl,\nTokenSource,\nTokenType,\nTokenImpersonationLevel,\nTokenStatistics,\nTokenRestrictedSids,\nTokenSessionId,\nTokenGroupsAndPrivileges,\nTokenSessionReference,\nTokenSandBoxInert,\nTokenAuditPolicy,\nTokenOrigin,\n//#if (_WIN32_WINNT &gt;= 0x0600)\nTokenElevationType,\nTokenLinkedToken,\nTokenElevation,\nTokenHasRestrictions,\nTokenAccessInformation,\nTokenVirtualizationAllowed,\nTokenVirtualizationEnabled,\nTokenIntegrityLevel,\nTokenUIAccess,\nTokenMandatoryPolicy,\nTokenLogonSid,\n//#endif\nMaxTokenInfoClass\n} TOKEN_INFORMATION_CLASS;\n</code></pre>\n\n<p>I commented these out and the code compiled without errors or warnings.  My question is really two questions.  Is their a better way to do this (define something in my code?) and, in the long run, will editing header files hurt me?</p>\n"}, {"tags": ["python", "c++", "swig"], "answers": [{"tags": [], "owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "is_accepted": true, "score": 3, "last_activity_date": 1432755944, "creation_date": 1432755944, "answer_id": 30491810, "question_id": 30491586, "link": "https://stackoverflow.com/questions/30491586/how-can-i-reuse-code-across-swig-typemaps/30491810#30491810", "title": "How can I reuse code across swig typemaps?", "body": "<p>You can pass code straight through to the generated .c file using <code>%{ %}</code>. The simplest way to re-use code inside a wrapper is therefore to just put it inside those, probably as a static function so that it doesn't clash with anything else in the same module. In your example this would work:</p>\n\n<pre><code>%{\n   #include \"structure_defs.h\"\n%}\n\n%{\nstatic PyObject* Cartesian2PyList(const schrodinger::Cartesian&amp; cartesian)\n{\n  PyObject *o;\n  o = PyList_New(3);\n  PyObject* item = PyFloat_FromDouble(cartesian.x);\n  PyList_SetItem(o, 0, item);\n  item = PyFloat_FromDouble(cartesian.y);\n  PyList_SetItem(o, 1, item);\n  item = PyFloat_FromDouble(cartesian.z);\n  PyList_SetItem(o, 2, item);\n  return o; \n}\n%}\n\n%typemap(out) schrodinger::Cartesian\n{\n  $result = Cartesian2PyList($1);\n}\n%typemap(out) std::vector&lt;schrodinger::Cartesian&gt;\n{\n  PyObject *o;\n  o = PyList_New($1.size());\n  for (uint i=0; i&lt;$1.size(); i++) {\n    PyObject *elem = Cartesian2PyList($1.at(i));\n    PyList_SetItem(o, i, elem);\n  }\n  $result = o;\n}\n\n%include \"cartesian.h\"\n</code></pre>\n\n<p>You could merge the two <code>%{ %}</code> blocks into a single block here if you so wished.</p>\n\n<p>I also removed the <code>%ignore</code> directive there because code inside <code>%{ %}</code> is just output into the generated module and not wrapped, so would be redundant. On the otherhand if you really did want to have it wrapped as well as defined in the generated code you could use <code>%inline %{ ... %}</code>, e.g.:</p>\n\n<pre><code>%inline %{\nstatic PyObject* Cartesian2PyList(const schrodinger::Cartesian&amp; cartesian)\n{\n    //...\n}\n%}\n</code></pre>\n\n<p>There are smarter things you can use if you're writing more generic SWIG code rather than just a single module, see <a href=\"http://www.swig.org/Doc2.0/Typemaps.html#Typemaps_fragments\" rel=\"nofollow\">fragments</a>, <a href=\"http://www.swig.org/Doc2.0/Preprocessor.html#Preprocessor_nn6\" rel=\"nofollow\"><code>%define</code></a> and <a href=\"http://www.swig.org/Doc2.0/Typemaps.html#Typemaps_special_macro_typemap\" rel=\"nofollow\"><code>$typemap</code></a>. In the simple case though just writing code for use inside the module only as shown above is sufficient.</p>\n"}], "owner": {"reputation": 10343, "user_id": 1309332, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2CtHJ.png?s=128&g=1", "display_name": "dbn", "link": "https://stackoverflow.com/users/1309332/dbn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 30491810, "answer_count": 1, "score": 3, "last_activity_date": 1432755944, "creation_date": 1432755299, "question_id": 30491586, "link": "https://stackoverflow.com/questions/30491586/how-can-i-reuse-code-across-swig-typemaps", "title": "How can I reuse code across swig typemaps?", "body": "<p>I have two swig typemaps with a bunch of duplicate code in them. I'd like to consolidate the code as follows:</p>\n\n<pre><code>%{\n   #include \"structure_defs.h\"\n%}\n\n%ignore Cartesian2PyList(const schrodinger::Cartesian&amp;);\nPyObject* Cartesian2PyList(const schrodinger::Cartesian&amp; cartesian)\n{\n  PyObject *o;\n  o = PyList_New(3);\n  PyObject* item = PyFloat_FromDouble(cartesian.x);\n  PyList_SetItem(o, 0, item);\n  item = PyFloat_FromDouble(cartesian.y);\n  PyList_SetItem(o, 1, item);\n  item = PyFloat_FromDouble(cartesian.z);\n  PyList_SetItem(o, 2, item);\n  return o; \n}\n\n%typemap(out) schrodinger::Cartesian\n{\n  $result = Cartesian2PyList($1);\n}\n%typemap(out) std::vector&lt;schrodinger::Cartesian&gt;\n{\n  PyObject *o;\n  o = PyList_New($1.size());\n  for (uint i=0; i&lt;$1.size(); i++) {\n    PyObject *elem = Cartesian2PyList($1.at(i));\n    PyList_SetItem(o, i, elem);\n  }\n  $result = o;\n}\n\n%include \"cartesian.h\"\n</code></pre>\n\n<p>However, this fails to compile, because the definition for Cartesian2PyList cannot be found at compile time. What is the best way to reuse code in multiple typemaps?</p>\n"}, {"tags": ["c++", "ibm-mq"], "comments": [{"owner": {"reputation": 13838, "user_id": 933250, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hIGQe.jpg?s=128&g=1", "display_name": "Shashi", "link": "https://stackoverflow.com/users/933250/shashi"}, "edited": false, "score": 0, "creation_date": 1432775703, "post_id": 30491538, "comment_id": 49068679, "body": "MessageId is a 24 byte long array. But your code is using just 1 byte, <code>MQBYTE msgID;</code> Did your code compile or is a typo while posting code here?   I am using MQ v8002 and code above works fine."}, {"owner": {"reputation": 101, "user_id": 1681012, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8dda2351585eb4efad672607beea66ed?s=128&d=identicon&r=PG", "display_name": "watangka", "link": "https://stackoverflow.com/users/1681012/watangka"}, "reply_to_user": {"reputation": 13838, "user_id": 933250, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hIGQe.jpg?s=128&g=1", "display_name": "Shashi", "link": "https://stackoverflow.com/users/933250/shashi"}, "edited": false, "score": 0, "creation_date": 1432786416, "post_id": 30491538, "comment_id": 49071126, "body": "yes, it compiles. but the result results on 0000000000000"}, {"owner": {"reputation": 101, "user_id": 1681012, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8dda2351585eb4efad672607beea66ed?s=128&d=identicon&r=PG", "display_name": "watangka", "link": "https://stackoverflow.com/users/1681012/watangka"}, "reply_to_user": {"reputation": 13838, "user_id": 933250, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hIGQe.jpg?s=128&g=1", "display_name": "Shashi", "link": "https://stackoverflow.com/users/933250/shashi"}, "edited": false, "score": 0, "creation_date": 1432787106, "post_id": 30491538, "comment_id": 49071314, "body": "yes, it compiles. but the result is series of 0s. How can I get and pass the msgId to corelid? I just want to correlate the request and reply to each other so that I can track them using msgId/correlId."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 1681012, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8dda2351585eb4efad672607beea66ed?s=128&d=identicon&r=PG", "display_name": "watangka", "link": "https://stackoverflow.com/users/1681012/watangka"}, "edited": false, "score": 0, "creation_date": 1432786722, "post_id": 30496900, "comment_id": 49071195, "body": "I will take a look at it and will let you know. I have a question regarding with this code snippet.  id = message.id( );                            // Assign.  variable id is an ImqBinary and message is an ImqMessage object, from what I know id is not a member of ImqMessage like messageId, correlationId, groupId and etc.  so how can message.id() passed it&#39;s value on id?  sorry I&#39;m just confused on how this works."}, {"owner": {"reputation": 101, "user_id": 1681012, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8dda2351585eb4efad672607beea66ed?s=128&d=identicon&r=PG", "display_name": "watangka", "link": "https://stackoverflow.com/users/1681012/watangka"}, "edited": false, "score": 1, "creation_date": 1433088057, "post_id": 30496900, "comment_id": 49190405, "body": "Hi Rob. Thanks for the idea. I tried response_msg.setCorrelationId(request_msg.correlationid( ) ); and it compiles but when I checked on the Queue. I has a result of 0s. However, I tried another approach and combined with your idea.  ImqBinary buffer;  I used the request_msg.copyOut(buffer,MQ_MSG_ID_LENGTH,0) then set the correlation id like this, response_msg.setCorrelationId(buffer,24) and it works like a charm"}], "tags": [], "owner": {"reputation": 30566, "user_id": 214668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vzaLu.jpg?s=128&g=1", "display_name": "T.Rob", "link": "https://stackoverflow.com/users/214668/t-rob"}, "is_accepted": false, "score": 4, "last_activity_date": 1432789882, "last_edit_date": 1432789882, "creation_date": 1432784994, "answer_id": 30496900, "question_id": 30491538, "link": "https://stackoverflow.com/questions/30491538/wmq-c-get-requests-message-id-and-set-it-correlation-id-for-reply/30496900#30496900", "title": "WMQ C++ Get request&#39;s message id and set it correlation id for reply", "body": "<p>The Infocenter page <a href=\"http://www-01.ibm.com/support/knowledgecenter/SSFKSJ_7.1.0/com.ibm.mq.doc/uc10520_.htm?lang=en\" rel=\"nofollow\"><em>Manipulating binary strings in C++</em></a> shows the data types involved as <code>ImqBinary</code> and <code>MQBYTE24</code>.  As Shashi notes in the comments, <code>MQBYTE</code> is a single byte and incapable of containing a 24-byte message ID.  The page linked above provides a reference example: </p>\n\n<pre><code>#include &lt;imqi.hpp&gt; // C++ classes\n\nImqMessage message ;\nImqBinary id, correlationId ;\nMQBYTE24 byteId ;\n\ncorrelationId.set( byteId, sizeof( byteId ) ); // Set.\nid = message.id( );                            // Assign.\nif ( correlationId == id ) {                   // Compare.\n  ...\n</code></pre>\n\n<p>One tool to diagnose issues like this is the very useful <a href=\"http://ibm.co/SupptPacMA0W\" rel=\"nofollow\">SupportPac MA0W</a> which is an API exit.  It can show you the exact contents of the structures passed to MQ before and after an API call.  Very often what is seen is that what is expected (in this case having copied the <code>MQMD.MsgID</code> to the <code>MQMD.CorrelID</code> is not what actually happened.  In this case, I believe a trace such as that provided by MA0W would reveal that the <code>msgID</code> was accurately passed from the app to MQ but consisted of only one character.</p>\n\n<p><strong>UPDATE</strong><br>\nOP asks:</p>\n\n<blockquote>\n  <p>Variable <code>id</code> is an <code>ImqBinary</code> and <code>message</code> is an <code>ImqMessage</code>\n  object, from what I know <code>id</code> is not a member of <code>ImqMessage</code> like\n  <code>messageId</code>, <code>correlationId</code>, <code>groupId</code> and etc. so how can\n  <code>message.id()</code> passed it's value on <code>id</code>?</p>\n</blockquote>\n\n<p>You are coorrect that <code>id</code> is a declared variable of type <code>ImqBinary</code> and not a member of the <code>ImqMessage</code> class.  Please see the Infocenter page for the <a href=\"http://www-01.ibm.com/support/knowledgecenter/SSFKSJ_7.1.0/com.ibm.mq.doc/uc10640_.htm?lang=en\" rel=\"nofollow\"><em>ImqBinary C++ class</em></a> which explains that:</p>\n\n<blockquote>\n  <p>This class encapsulates a binary byte array that can be used for\n  ImqMessage accounting token, correlation id, and message id values. It\n  allows easy assignment, copying, and comparison.</p>\n</blockquote>\n\n<p>The intent of the <code>ImqBinary</code> class is to provide a variable type to encapsulate a byte array with overloaded methods such that \"normal\" variable manipulations work as expected.  Rather than copying the byte array one byte at a time, it can be an <code>LVAL</code> or <code>RVAL</code> in an assignment.  Rather than comparing the array a byte at a time, you can just use comparison operators like <code>==</code>.</p>\n\n<p>So if your code were modified to use the example, it might look like this:</p>\n\n<pre><code>#include &lt;imqi.hpp&gt; // C++ classes\n\nImqMessage request_msg, response_msg ;\nImqBinary id ;\n\nid = request_msg.id( );\nresponse_msg.setCorrelationId(id);\n</code></pre>\n\n<p>That said, I'm not sure you even need an intermediate variable.  You might be able to assign the correlation ID using the output of the getter call for the message ID from the source message.  Something like....</p>\n\n<pre><code>response_msg.setCorrelationId( request_msg.id( ) );\n</code></pre>\n\n<p>...might do it.  I don't code C or C++ anymore so I probably got the syntax wrong or didn't do it as elegantly as it might be coded, but you should get the idea.</p>\n"}], "owner": {"reputation": 101, "user_id": 1681012, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8dda2351585eb4efad672607beea66ed?s=128&d=identicon&r=PG", "display_name": "watangka", "link": "https://stackoverflow.com/users/1681012/watangka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1432789882, "creation_date": 1432755149, "question_id": 30491538, "link": "https://stackoverflow.com/questions/30491538/wmq-c-get-requests-message-id-and-set-it-correlation-id-for-reply", "title": "WMQ C++ Get request&#39;s message id and set it correlation id for reply", "body": "<p>I have a problem on getting message id and set it on reply's correlation id. </p>\n\n<p>Here's the piece of code:</p>\n\n<pre><code>MQBYTE msgID;\n\nrequest_msg.messageId().copyOut(msgID, MQ_MSG_ID_LENGTH, 0);\nresponse_msg.setCorrelationId(msgID);\n</code></pre>\n\n<p>when I checked the correlation Id of the reply, the correlation id is 0.</p>\n\n<p>How can I copy/get the messageId of the request and put it on the correlation id of the reply?</p>\n\n<p>Thanks in advance. :)</p>\n"}, {"tags": ["c++", "xcode", "cocos2d-x"], "comments": [{"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1432754346, "post_id": 30491236, "comment_id": 49060468, "body": "1. If the images have text in them move it out and overlay the text in code, that reduces the number of assets and makes it easier to port to an additional language. 2. The language choice should be made at run-time based on the users selected languages choices, not at compile-time. Xcode supports run-time localization."}, {"owner": {"reputation": 46, "user_id": 3356999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KvTYE.jpg?s=128&g=1", "display_name": "Mojtaba", "link": "https://stackoverflow.com/users/3356999/mojtaba"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1432757604, "post_id": 30491236, "comment_id": 49062418, "body": "1- Actually the in game texts are mostly provided as Label objects inside the game. But there are some that could not be used via fonts for some reason. 2- Also, for localization at compile time, the thing is we are going to make a version for an alternative app store. That&#39;s why we need only one language."}], "owner": {"reputation": 46, "user_id": 3356999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KvTYE.jpg?s=128&g=1", "display_name": "Mojtaba", "link": "https://stackoverflow.com/users/3356999/mojtaba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1432754097, "creation_date": 1432754097, "question_id": 30491236, "link": "https://stackoverflow.com/questions/30491236/localization-and-unused-files-in-xcode", "title": "Localization and unused files in XCode", "body": "<p>I have an XCode project which is a game made with Cocos2dx game engine (C++) and native classes for Facebook etc. I recently started localizing it for a second language and I have two copies of a lot assets in two languages (Images etc.). The implementation in my code for switching between languages is perfectly fine using pre-processor directives and compiler doesn't even see (I assume) the assets in one language when it compiles the other.\nHowever, I was wondering if XCode is going to include all the assets and resources, even the ones that are not used into the final file that I upload to app store? Is there anyway to tell XCode not include them, which is as easy as one on/off switch?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 4, "creation_date": 1432754083, "post_id": 30491186, "comment_id": 49060322, "body": "If it is important that the enum be defined within the child class, then it is important that the parent not have one of those enums :("}, {"owner": {"reputation": 908, "user_id": 1220312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/85bfd271749bd0ba3d9b18d2437bc283?s=128&d=identicon&r=PG", "display_name": "lcjury", "link": "https://stackoverflow.com/users/1220312/lcjury"}, "edited": false, "score": 0, "creation_date": 1432754133, "post_id": 30491186, "comment_id": 49060349, "body": "You really going to have <code>enum Status</code> declared with different body?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1432754496, "post_id": 30491186, "comment_id": 49060536, "body": "<code>ClassA : public Base</code> and <code>ClassC : public Base</code>, where Base has no data members,  but types and constants, only."}], "answers": [{"comments": [{"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1432754303, "post_id": 30491227, "comment_id": 49060448, "body": "I suspected that that was going to end up being the answer. Thanks."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 7, "last_activity_date": 1432754061, "creation_date": 1432754061, "answer_id": 30491227, "question_id": 30491186, "link": "https://stackoverflow.com/questions/30491186/circular-includes-due-to-enum-within-a-class-in-c/30491227#30491227", "title": "Circular includes due to enum within a class in C++", "body": "<blockquote>\n  <p>In short: I want to use an enum that is defined in a subclass as the type of an instance variable in a parent class.</p>\n</blockquote>\n\n<p>You cannot do that. You'll need to come up with a different mechanism.</p>\n"}], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 30491227, "answer_count": 1, "score": 1, "last_activity_date": 1432755231, "creation_date": 1432753938, "last_edit_date": 1432755231, "question_id": 30491186, "link": "https://stackoverflow.com/questions/30491186/circular-includes-due-to-enum-within-a-class-in-c", "title": "Circular includes due to enum within a class in C++", "body": "<p>I have an interesting variant of the oft-repeated C++ circular include dilemma. In short: I want to use an enum that is defined in a subclass as the type of an instance variable in a parent class. Here's a minimal example:</p>\n\n<p><strong>a.h</strong></p>\n\n<pre><code>#ifndef A_H\n#define A_H\n\n#include \"c.h\"\n\nclass ClassA\n{\npublic:\n    ClassA() {};\n\n    void setStatus(ClassC::Status status) { a_status = status; }\n    void setA(int val) { a_var = val; }\n    int valueA() { return a_var; }\n    ClassC::Status status() { return a_status; }\n\nprivate:\n    int a_var;\n    ClassC::Status a_status;\n};\n\n#endif // A_H\n</code></pre>\n\n<p><strong>c.h</strong></p>\n\n<pre><code>#ifndef C_H\n#define C_H\n\n#include \"a.h\"\n\nclass ClassC : public ClassA\n{\npublic:\n    enum Status\n    {\n        Valid,\n        Invalid\n    };\n\n    ClassC(): ClassA() {};\n\n    void setC(int val) { c_var = val; }\n    int valueC() { return c_var; }\n\nprivate:\n    int c_var;\n};\n\n#endif // C_H\n</code></pre>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include \"a.h\"\n\nint main(int argc, const char *argv[])\n{\n    ClassA *obj = new ClassA();\n    return 0;\n}\n</code></pre>\n\n<p>I can't forward declare the enum in <code>a.h</code> because the name of  the enum has to be simple, and ClassC::Status isn't. It's important that the enum be within the namespace of the child class, because there are <em>lots</em> of such classes, and I need to isolate the names of the enum items from values in other enumcs. Any ideas?</p>\n"}, {"tags": ["android", "c++", "boost", "android-ndk"], "answers": [{"comments": [{"owner": {"reputation": 22959, "user_id": 6998684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqR2Z.jpg?s=128&g=1", "display_name": "IgorGanapolsky", "link": "https://stackoverflow.com/users/6998684/igorganapolsky"}, "edited": false, "score": 0, "creation_date": 1463062896, "post_id": 30492336, "comment_id": 61912070, "body": "No, there is no Boost library folder in <b>crystax-ndk-10.3.1</b>."}], "tags": [], "owner": {"reputation": 1229, "user_id": 1104932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70b2297158c1e1633fbba83293b44bc8?s=128&d=identicon&r=PG", "display_name": "Dmitry Moskalchuk", "link": "https://stackoverflow.com/users/1104932/dmitry-moskalchuk"}, "is_accepted": false, "score": 2, "last_activity_date": 1432757833, "creation_date": 1432757833, "answer_id": 30492336, "question_id": 30491158, "link": "https://stackoverflow.com/questions/30491158/compile-and-use-boost-for-android-ndk-r10e/30492336#30492336", "title": "Compile and use boost for Android NDK R10e", "body": "<p>The simplest way would be to use <a href=\"https://www.crystax.net/android/ndk\" rel=\"nofollow\">CrystaX NDK</a>, which contains already built and ready-to-use Boost libraries. And here are examples how to use Boost with CrystaX NDK: <a href=\"https://www.crystax.net/blog/2\" rel=\"nofollow\">1</a>, <a href=\"https://www.crystax.net/blog/3\" rel=\"nofollow\">2</a></p>\n"}, {"comments": [{"owner": {"reputation": 193, "user_id": 4946210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb6bd729bfed5f32f1720430f7be071b?s=128&d=identicon&r=PG&f=1", "display_name": "BSod", "link": "https://stackoverflow.com/users/4946210/bsod"}, "edited": false, "score": 0, "creation_date": 1432979695, "post_id": 30499704, "comment_id": 49162063, "body": "I ended up using a prebuilt Boost library I found. It works but I&#39;ll try to compile with your advice as well. Thanks! <a href=\"https://github.com/emileb/Boost-for-Android-Prebuilt\" rel=\"nofollow noreferrer\">github.com/emileb/Boost-for-Android-Prebuilt</a>"}, {"owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 3, "creation_date": 1446031765, "post_id": 30499704, "comment_id": 54571357, "body": "Can you be a little bit more precise about the operations to be done? I do not have a project-config.bjam file for example."}], "tags": [], "owner": {"reputation": 402, "user_id": 4296866, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/d4A0T.png?s=128&g=1", "display_name": "brainsandwich", "link": "https://stackoverflow.com/users/4296866/brainsandwich"}, "is_accepted": true, "score": 6, "last_activity_date": 1432797461, "creation_date": 1432797461, "answer_id": 30499704, "question_id": 30491158, "link": "https://stackoverflow.com/questions/30491158/compile-and-use-boost-for-android-ndk-r10e/30499704#30499704", "title": "Compile and use boost for Android NDK R10e", "body": "<p>We managed to compile it for NDKr10d. It should be the same for NDKr10e.\nThe project-config.bjam should point to the gcc compiler from the NDK. Ours looks like this :</p>\n\n<pre><code>import option ; \nusing gcc : arm : D:\\\\android\\\\ndk\\\\toolchains\\\\arm-linux-androideabi-4.9\\\\prebuilt\\\\windows-x86_64\\\\bin\\\\arm-linux-androideabi-g++.exe ; \noption.set keep-going : false ; \n</code></pre>\n\n<p>Then just compile with b2, telling paths to android includes :</p>\n\n<pre><code>b2 --reconfigure &lt;your options&gt;\n    toolset=gcc-arm\n    include=&lt;ndk folder&gt;\\sources\\cxx-stl\\gnu-libstdc++\\4.9\\include\n    include=&lt;ndk folder&gt;\\sources\\cxx-stl\\gnu-libstdc++\\4.9\\libs\\&lt;target platform&gt;\\include\n    include=&lt;ndk folder&gt;\\platforms\\&lt;android api version&gt;\\arch-arm\\usr\\include\n    install --libdir=stage\\lib\\&lt;target platform&gt;\n</code></pre>\n\n<p>We're about to move to ndkr10e. Could you tell if boost still works with it ? :)</p>\n"}, {"tags": [], "owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "is_accepted": false, "score": 0, "last_activity_date": 1446044890, "last_edit_date": 1495540446, "creation_date": 1446042030, "answer_id": 33393574, "question_id": 30491158, "link": "https://stackoverflow.com/questions/30491158/compile-and-use-boost-for-android-ndk-r10e/33393574#33393574", "title": "Compile and use boost for Android NDK R10e", "body": "<p>I only managed to build with <code>10d</code>. Cross compiling Linux->Android using <a href=\"https://github.com/MysticTreeGames/Boost-for-Android\" rel=\"nofollow noreferrer\">Boost for Android</a> worked straight away with that.</p>\n\n<p>To download a slightly outdated ndk, as not all ndk are immediately supported by <a href=\"https://github.com/MysticTreeGames/Boost-for-Android\" rel=\"nofollow noreferrer\">Boost for Android</a>, you can use this guide: <a href=\"https://stackoverflow.com/questions/6849981/where-do-i-find-old-versions-of-android-ndk\">Where do I find old versions of Android NDK?</a></p>\n\n<p>Note: I also wanted to specify the toolchain. I had to do it in 2 places:</p>\n\n<ol>\n<li><p>In build-android.sh, just after the line mentioned here above:</p>\n\n<p>TOOLCHAIN=${TOOLCHAIN:-arm-linux-androideabi-4.9}</p></li>\n<li><p>In the command line</p>\n\n<p>bash build-android.sh [ndk location] --toolchain=arm-linux-androideabi-4.9</p></li>\n</ol>\n\n<p>In fact, it worked better when I specified exactly which boost components I wanted with <code>--with-libraries=[comma separated list]</code>.</p>\n\n<p>If instead I would build everything, I would get:</p>\n\n<blockquote>\n  <p>...failed updating 38 targets...</p>\n  \n  <p>...skipped 6 targets...</p>\n  \n  <p>...updated 10568 targets...</p>\n  \n  <p>ERROR: Failed to build boost for android!</p>\n  \n  <p>Done!</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 1877530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a91dd809d807f36a5485182ed67f4324?s=128&d=identicon&r=PG", "display_name": "Matthew Moskewicz", "link": "https://stackoverflow.com/users/1877530/matthew-moskewicz"}, "is_accepted": false, "score": 1, "last_activity_date": 1457629836, "creation_date": 1457629836, "answer_id": 35922934, "question_id": 30491158, "link": "https://stackoverflow.com/questions/30491158/compile-and-use-boost-for-android-ndk-r10e/35922934#35922934", "title": "Compile and use boost for Android NDK R10e", "body": "<p>Following the boost directions, I was able to build boost 1.60 with NDKr10e on Ubuntu 12.04 (although I suspect very little depends on the host system). Here are my notes:</p>\n\n<p>get and unpack boost source tarball (i used 1.60): boost_1_60_0.tar.bz2</p>\n\n<pre><code>moskewcz@maaya:/scratch/moskewcz/android/src$ ll\ntotal 74M\ndrwx------ 10 moskewcz moskewcz 4.0K Mar  9 14:14 boost_1_60_0\n-rw-rw-r--  1 moskewcz moskewcz  74M Jan  5 11:15 boost_1_60_0.tar.bz2\n</code></pre>\n\n<p>follow boost instructions in getting started on unix \"Build Custom Binaries\" section</p>\n\n<p>use a fresh, empty root to install b2 i.e. /scratch/boost-build-root; use usr as prefix; again following the boost instructions:</p>\n\n<pre><code>moskewcz@maaya:/scratch/moskewcz/android/src/boost_1_60_0/tools/build$ ./bootstrap.sh\nmoskewcz@maaya:/scratch/moskewcz/android/src/boost_1_60_0/tools/build$ ./b2 install --prefix=/scratch/moskewcz/android/boost-build-root/usr\n</code></pre>\n\n<p>put b2 in path (again as per instructions)</p>\n\n<pre><code>export PATH=/scratch/moskewcz/android/boost-build-root/usr/bin:$PATH\n</code></pre>\n\n<p>in some jamfile (i had no ~/user-config.jam, so i created one and used that, maybe there's a better choice of jamfile to create/edit) add some jam-code (?) to define a gcc version (toolset) pointing to a g++ from a standalone toolchain. note that this is a toolchain created with the NDK in the normal fashion following its 'create a standalone toolchain' directions. i am NOT pointing to a g++ inside the NDK itself (that may or may not work, i dunno):</p>\n\n<pre><code>import option ; \nusing gcc : arm_linux_android_4.9 : /scratch/android-stc/bin/aarch64-linux-android-g++ ; \noption.set keep-going : false ;\n</code></pre>\n\n<p>go to boost project root and build, mostly as per directions. --build-dir may be optional? also added -j8 to do || build</p>\n\n<pre><code>moskewcz@maaya:/scratch/moskewcz/android/src/boost_1_60_0$ b2 -j8 --build-dir=bin.v2 toolset=gcc-arm_linux_android_4.9 stage\n</code></pre>\n\n<p>note that this tries to build both static and shared libs by default, but building shared libs fails due to android not having librt.so -- according to my research, people claim that under android (some of?) the functionality of librt.so is inside libc.so -- so it may be okay to simply remove -lrt from the linking steps in order to build shared libs for android. i did not attempt this. see:</p>\n\n<p><a href=\"https://code.google.com/p/android/issues/detail?id=5730\" rel=\"nofollow\">https://code.google.com/p/android/issues/detail?id=5730</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/27851974/building-boost-for-android-with-error-cannot-find-lrt\">Building Boost for Android with error &quot;cannot find -lrt&quot;</a></p>\n"}, {"tags": [], "owner": {"reputation": 571, "user_id": 3030992, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/VDihR.jpg?s=128&g=1", "display_name": "Declan", "link": "https://stackoverflow.com/users/3030992/declan"}, "is_accepted": false, "score": 0, "last_activity_date": 1499864518, "last_edit_date": 1499864518, "creation_date": 1499864133, "answer_id": 45058269, "question_id": 30491158, "link": "https://stackoverflow.com/questions/30491158/compile-and-use-boost-for-android-ndk-r10e/45058269#45058269", "title": "Compile and use boost for Android NDK R10e", "body": "<p>Here: <a href=\"http://silverglint.com/boost-for-android/\" rel=\"nofollow noreferrer\">http://silverglint.com/boost-for-android/</a> you can find a simple and painless new way to build a modern (eg 1.64.0) version of boost for android.\nWorks with clang and gcc.</p>\n\n<p>Also included is a sample app that shows you how to use the boost binaries thus built.</p>\n"}], "owner": {"reputation": 193, "user_id": 4946210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb6bd729bfed5f32f1720430f7be071b?s=128&d=identicon&r=PG&f=1", "display_name": "BSod", "link": "https://stackoverflow.com/users/4946210/bsod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12555, "favorite_count": 8, "accepted_answer_id": 30499704, "answer_count": 5, "score": 18, "last_activity_date": 1499864518, "creation_date": 1432753857, "question_id": 30491158, "link": "https://stackoverflow.com/questions/30491158/compile-and-use-boost-for-android-ndk-r10e", "title": "Compile and use boost for Android NDK R10e", "body": "<p>How do I compile and use Boost for the Android NDK? I've tried everything I've found online, from <a href=\"https://github.com/MysticTreeGames/Boost-for-Android\" rel=\"noreferrer\">Boost for Android</a> to compiling it myself with the bjam file. However, I do not succeed. When I try compiling it with bjam, I get the following error:</p>\n\n<pre><code>error: toolset gcc initialization:\n\nerror: version 'androidR10e' requested but 'g++-androidR10e' not found and version '4.2.1' of default 'g++' does not match\nerror: initialized from /path/to/android-ndk-r10e/sources/boost/tools/build/v2/user-config.jam:86\n</code></pre>\n\n<p>Has anyone successfully used Boost with Android NDK R10e?</p>\n\n<p>And when I can compile it, how should I do to use it in my Android app project?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432753197, "post_id": 30490938, "comment_id": 49059846, "body": "<code>object</code> and <code>object1</code> are seriously the best names you could come up with to make a clear and easy-to-follow example?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432753233, "post_id": 30490938, "comment_id": 49059864, "body": "And <code>fPtr</code> is also a terribly confusing name, since nothing about the type is in any way pointer-like."}], "answers": [{"tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": true, "score": 1, "last_activity_date": 1432770970, "last_edit_date": 1432770970, "creation_date": 1432753305, "answer_id": 30491001, "question_id": 30490938, "link": "https://stackoverflow.com/questions/30490938/error-while-calling-member-function-with-function-pointer/30491001#30491001", "title": "Error while calling Member function with function pointer", "body": "<p>Presumably you want to call something like:</p>\n\n<pre><code>object1.fun1([this](int n){object.fun(n);});\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>object1.fun1(std::bind(&amp;B::fun, &amp;object, std::placeholders::_1));\n</code></pre>\n"}], "owner": {"reputation": 2273, "user_id": 1737197, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8cf36a1db2987797cfe1be2cb75fa510?s=128&d=identicon&r=PG", "display_name": "debonair", "link": "https://stackoverflow.com/users/1737197/debonair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 30491001, "answer_count": 1, "score": -2, "last_activity_date": 1433239718, "creation_date": 1432753105, "question_id": 30490938, "link": "https://stackoverflow.com/questions/30490938/error-while-calling-member-function-with-function-pointer", "title": "Error while calling Member function with function pointer", "body": "<pre><code>Class B\n{\npublic:\n  void fun(int i){}\n};\ntypedef std::function&lt;void(int)&gt; fPtr;\nclass C\n{\npublic:\n  void fun1(fptr handle){}\n};\nclass A\n{\n\npublic:\n  B object;\n  C object1;\n  void temp()\n{\n object1.fun1(&amp;B::fun);\n}\n\n};\n</code></pre>\n\n<p>I am trying to call fun1() as given but it gives compiler error. whats the correct way of calling it?</p>\n"}, {"tags": ["c++", "qt", "qpainter", "qpixmap"], "comments": [{"owner": {"reputation": 17121, "user_id": 202919, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c98b750637d6114f5fd1893dbdfe1f39?s=128&d=identicon&r=PG", "display_name": "Venemo", "link": "https://stackoverflow.com/users/202919/venemo"}, "edited": false, "score": 0, "creation_date": 1432754310, "post_id": 30490879, "comment_id": 49060452, "body": "We&#39;d need to see more of your code to tell what exactly you&#39;re doing wrong."}, {"owner": {"reputation": 2559, "user_id": 4789375, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LRyDO.png?s=128&g=1", "display_name": "p.i.g.", "link": "https://stackoverflow.com/users/4789375/p-i-g"}, "edited": false, "score": 0, "creation_date": 1432757495, "post_id": 30490879, "comment_id": 49062344, "body": "Actually it works for me (Windows 8.1, Qt 5.4.1, VS 2013). So please describe the problem. By the way I think you don&#39;t need to store the <code>layout</code> and the <code>pixmap</code> as a member variable, or do you use it later as well ?"}, {"owner": {"reputation": 11, "user_id": 4946131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08899fcc46dba0d1a4ed30a2048f6a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Antoine LeBrun", "link": "https://stackoverflow.com/users/4946131/antoine-lebrun"}, "reply_to_user": {"reputation": 17121, "user_id": 202919, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c98b750637d6114f5fd1893dbdfe1f39?s=128&d=identicon&r=PG", "display_name": "Venemo", "link": "https://stackoverflow.com/users/202919/venemo"}, "edited": false, "score": 0, "creation_date": 1432764227, "post_id": 30490879, "comment_id": 49065517, "body": "@Venemo: All my drawing code works if i put it in paintEvent but it crashes when i try doing it with the pixmap. So the rest of the drawing code is not really relevant."}, {"owner": {"reputation": 11, "user_id": 4946131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08899fcc46dba0d1a4ed30a2048f6a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Antoine LeBrun", "link": "https://stackoverflow.com/users/4946131/antoine-lebrun"}, "reply_to_user": {"reputation": 2559, "user_id": 4789375, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LRyDO.png?s=128&g=1", "display_name": "p.i.g.", "link": "https://stackoverflow.com/users/4789375/p-i-g"}, "edited": false, "score": 0, "creation_date": 1432764442, "post_id": 30490879, "comment_id": 49065590, "body": "@vizhanyolajos With this code, the app will crash without compiler error message."}, {"owner": {"reputation": 11, "user_id": 4946131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08899fcc46dba0d1a4ed30a2048f6a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Antoine LeBrun", "link": "https://stackoverflow.com/users/4946131/antoine-lebrun"}, "reply_to_user": {"reputation": 2559, "user_id": 4789375, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LRyDO.png?s=128&g=1", "display_name": "p.i.g.", "link": "https://stackoverflow.com/users/4789375/p-i-g"}, "edited": false, "score": 0, "creation_date": 1432764454, "post_id": 30490879, "comment_id": 49065592, "body": "@vizhanyolajos And since the pixmap is used in a function and not directly in the constructor I figured it would be easier to make it a member variable rather than passing an argument to the function."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1432774261, "post_id": 30490879, "comment_id": 49068391, "body": "The posted code looks okay to me (although the call to this-&gt;setLayout() is unnecessary; it&#39;s enough to have specified (this) as an argument to the QVBoxLayout constructor).  The next thing you should do is determine which exact line the program crashes while executing.  You can do that with a debugger, or by sprinkling printf() or qDebug() statements around and seeing which ones print last before the crash."}, {"owner": {"reputation": 2559, "user_id": 4789375, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LRyDO.png?s=128&g=1", "display_name": "p.i.g.", "link": "https://stackoverflow.com/users/4789375/p-i-g"}, "edited": false, "score": 0, "creation_date": 1432798445, "post_id": 30490879, "comment_id": 49076331, "body": "@Antoine LeBrun: What I could tested was worked fine. But you didn&#39;t post your full code, so of course there can be bugs, but we won&#39;t be able to help you until you don&#39;t show us the buggy part of your code. As said, debug it where the problem is, or at least tell us the error message."}, {"owner": {"reputation": 614, "user_id": 4876536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36757ceb0bbec00338926fc2ab6cda58?s=128&d=identicon&r=PG&f=1", "display_name": "fassl", "link": "https://stackoverflow.com/users/4876536/fassl"}, "edited": false, "score": 0, "creation_date": 1432923685, "post_id": 30490879, "comment_id": 49146619, "body": "No crash info? Apart from that it could be that the paint device is not initialized correctly. Maybe need to call begin()?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4946131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08899fcc46dba0d1a4ed30a2048f6a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Antoine LeBrun", "link": "https://stackoverflow.com/users/4946131/antoine-lebrun"}, "edited": false, "score": 0, "creation_date": 1432764642, "post_id": 30492392, "comment_id": 49065651, "body": "Actually MyClass constructor has 2 other parameters (QStringList) after the QWidget* parent one."}], "tags": [], "owner": {"reputation": 3, "user_id": 4945974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d4ffb2667ebb42991dfdf9f707ff89?s=128&d=identicon&r=PG&f=1", "display_name": "stasinek", "link": "https://stackoverflow.com/users/4945974/stasinek"}, "is_accepted": false, "score": 0, "last_activity_date": 1432761672, "last_edit_date": 1432761672, "creation_date": 1432758062, "answer_id": 30492392, "question_id": 30490879, "link": "https://stackoverflow.com/questions/30490879/app-crash-when-using-qpainter-on-qpixmap/30492392#30492392", "title": "App crash when using QPainter on QPixmap", "body": "<p>Did you call the default base class constructor before Your class constructor ?</p>\n\n<pre><code>MyClass( QObject *parent )\n: QWidget( parent )\n{\n    // Your posted code.\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4946131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08899fcc46dba0d1a4ed30a2048f6a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Antoine LeBrun", "link": "https://stackoverflow.com/users/4946131/antoine-lebrun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 652, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1432761672, "creation_date": 1432752939, "last_edit_date": 1432760071, "question_id": 30490879, "link": "https://stackoverflow.com/questions/30490879/app-crash-when-using-qpainter-on-qpixmap", "title": "App crash when using QPainter on QPixmap", "body": "<p>I am trying to make a class that will make a dot graphic. The class inherits from QWidget. I want it to draw lines and dots on a QPixmap that will be displayed in a QLabel.</p>\n\n<p>The constructor of the class looks like this:</p>\n\n<pre><code>MyClass::MyClass()\n{\n    calcul_proprietes(); // Function that makes calculation of what to draw.\n    pix = new QPixmap(760,350);\n\n    dessiner_graphique(); // Function that does the drawing.\n\n    //Displaying the qpixmap\n    layout_principal = new QVBoxLayout(this);\n    label_pix = new QLabel(this);\n    label_pix-&gt;setPixmap(*pix);\n    layout_principal-&gt;addWidget(label_pix);\n    this-&gt;setLayout(layout_principal);\n}\n</code></pre>\n\n<p>And a short part of the function that does the drawing</p>\n\n<pre><code>void MyClass::dessiner_graphique()\n{\n    // ...\n    QPainter painter(pix);\n    QRect contour(x_depart,y_depart,largeur_grille,hauteur_grille);\n    painter.drawRect(contour);\n    // ...\n}\n</code></pre>\n\n<p>I don't want to use the paintEvent function because it gets called all the time and i only need my graphic to be painted once. What do i do wrong?</p>\n"}, {"tags": ["c++", "copy-constructor"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1432752724, "post_id": 30490777, "comment_id": 49059606, "body": "The proper way is to pass pass a reference to an object that can&#39;t be copied. And don&#39;t use the reference to make a copy of the object that can&#39;t be copied."}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 0, "last_activity_date": 1432753007, "creation_date": 1432753007, "answer_id": 30490896, "question_id": 30490777, "link": "https://stackoverflow.com/questions/30490777/taking-a-reference-to-an-object-with-a-private-copy-constructor/30490896#30490896", "title": "Taking a reference to an object with a private copy constructor", "body": "<p>Here's how you pass a reference:</p>\n\n<pre><code>void foo(int&amp; x)\n{}\n\nint main()\n{\n   int y = 42;\n   foo(y);\n}\n</code></pre>\n\n<p>Doesn't matter whether the underlying type is copyable or not, because you're not copying it.</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432842316, "post_id": 30496302, "comment_id": 49106629, "body": "That&#39;s not even valid initializer list syntax... Otherwise you&#39;re right though."}, {"owner": {"reputation": 6777, "user_id": 785494, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/53a1f0aba6f0489d49f5e6fc3df323fa?s=128&d=identicon&r=PG", "display_name": "SRobertJames", "link": "https://stackoverflow.com/users/785494/srobertjames"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432845205, "post_id": 30496302, "comment_id": 49108183, "body": "It&#39;s not an initializer list, it&#39;s a snippet from the ctor"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432855467, "post_id": 30496302, "comment_id": 49112267, "body": "Yes, it&#39;s the member initializer list and, as I said, it is syntactically invalid. Drop the <code>int</code>."}], "tags": [], "owner": {"reputation": 6777, "user_id": 785494, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/53a1f0aba6f0489d49f5e6fc3df323fa?s=128&d=identicon&r=PG", "display_name": "SRobertJames", "link": "https://stackoverflow.com/users/785494/srobertjames"}, "is_accepted": false, "score": 0, "last_activity_date": 1433042862, "last_edit_date": 1433042862, "creation_date": 1432780745, "answer_id": 30496302, "question_id": 30490777, "link": "https://stackoverflow.com/questions/30490777/taking-a-reference-to-an-object-with-a-private-copy-constructor/30496302#30496302", "title": "Taking a reference to an object with a private copy constructor", "body": "<p>After digging deeper, the problem wasn't the pass-by-reference, but rather that the initializer list did:</p>\n\n<pre><code> ... : mx(x) {};\n</code></pre>\n\n<p>I had thought that if <code>x</code> was passed by reference, then <code>mx(x)</code> would be a reference to x.  But it's not, it's a copy.</p>\n\n<p>I believe that the fix would have been to declare <code>mx</code> as a reference: <code>int&amp; mx</code>.</p>\n"}], "owner": {"reputation": 6777, "user_id": 785494, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/53a1f0aba6f0489d49f5e6fc3df323fa?s=128&d=identicon&r=PG", "display_name": "SRobertJames", "link": "https://stackoverflow.com/users/785494/srobertjames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": -6, "last_activity_date": 1433042862, "creation_date": 1432752581, "last_edit_date": 1432754541, "question_id": 30490777, "link": "https://stackoverflow.com/questions/30490777/taking-a-reference-to-an-object-with-a-private-copy-constructor", "title": "Taking a reference to an object with a private copy constructor", "body": "<p>I have a class T which uses Boost for threading and hence has members with private copy constructors.</p>\n\n<p>I'd would like to pass T by reference to another class.  However, when I try to do so, no matter how I try to do it, I can't get it right.  I can do this by passing a pointer, but not a reference.</p>\n\n<p><strong>What is the proper way to pass a reference to an object that can't be copied?</strong></p>\n\n<p>OR: If the answer is \"You can't do that by ref, only pointer\".  Can you please explain why that is so? Aren't refs merely pointers with gentler syntax?  (I'd like to know both why this distinction was made in the design, and, if at the compilation level, there really is any difference between pointer and references.)</p>\n\n<hr>\n\n<p><strong>UPDATE</strong>: Before dismissing this, please note:</p>\n\n<ol>\n<li><p>I am getting this from a class using Boost threads, where, pass by reference gave me private copy constructor errors deep within the class, but pass by pointer didn't</p></li>\n<li><p>My understanding is that it is 100% possible to make it possible to stop pass by reference</p></li>\n<li><p>and that Boost threads makes use of it</p></li>\n</ol>\n\n<p>If my assumptions are wrong, I will accept as correct answer any answer which clarifies where my mistake is.</p>\n"}, {"tags": ["c++", "nginx", "ipc", "fastcgi", "fastcgi++"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 2, "creation_date": 1432753197, "post_id": 30490771, "comment_id": 49059845, "body": "Your question is way too broad"}, {"owner": {"reputation": 1072, "user_id": 3142067, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6c37735a46b6d0b584ab1b9b56acd50c?s=128&d=identicon&r=PG&f=1", "display_name": "user3142067", "link": "https://stackoverflow.com/users/3142067/user3142067"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1432753885, "post_id": 30490771, "comment_id": 49060221, "body": "Thanks for the comment. Yes I&#39;m afraid you&#39;re right.... basically I&#39;m looking for input from someone who did something similar to what I&#39;m trying to do. Don&#39;t know how to be more specific"}, {"owner": {"reputation": 2389, "user_id": 2060502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd1fc204e0d848dd1c9720cd37610bf3?s=128&d=identicon&r=PG", "display_name": "Alexander Altshuler", "link": "https://stackoverflow.com/users/2060502/alexander-altshuler"}, "edited": false, "score": 0, "creation_date": 1432804883, "post_id": 30490771, "comment_id": 49080537, "body": "Do you need bidirectional async. communications or just request/response protocol from nginx to your C++ App?"}, {"owner": {"reputation": 1072, "user_id": 3142067, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6c37735a46b6d0b584ab1b9b56acd50c?s=128&d=identicon&r=PG&f=1", "display_name": "user3142067", "link": "https://stackoverflow.com/users/3142067/user3142067"}, "edited": false, "score": 0, "creation_date": 1435887873, "post_id": 30490771, "comment_id": 50398622, "body": "Ok for future readers: I created something similar to the multithreading c example application. The FCGX_Request is stored on a lockfree work queue (by the fcgi threads) and worker threads process them.  They put the finished http header/body (using the information in the envp struct in FCGX_Request, you can apply FCGX_GetParam) on the socket which is in the FCGX_request (out) and finally Finish the request"}], "owner": {"reputation": 1072, "user_id": 3142067, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6c37735a46b6d0b584ab1b9b56acd50c?s=128&d=identicon&r=PG&f=1", "display_name": "user3142067", "link": "https://stackoverflow.com/users/3142067/user3142067"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 739, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1432752565, "creation_date": 1432752565, "question_id": 30490771, "link": "https://stackoverflow.com/questions/30490771/ipc-between-fastcgi-c-nginx-and-c-application", "title": "IPC between FastCGI C++ / Nginx and C++ Application", "body": "<p>I'm trying to create a Gateway which offers a RESTful interface to send/receive messages to Devices which communicate over Bluetooth Low Energy (BLE). Basically it translates GATT to HTTP and vice versa.</p>\n\n<p>The basic architecture looks as follows:</p>\n\n<p>A BLE Dongle is connected to a Linux computer (f.e. Raspberry Pi) a C-Program opens a serial connection to the BLE Dongle to send/receive/process messages. It receives requests from a C++ Application over IPC using a TCP/IP Socket and also uses this socket to forward replies from BLE Devices (f.e. Sensors) to the C++ Application (which acts as a multithreaded server for each connected BLE Dongle).</p>\n\n<p>The C++ Application saves this information (f.e. discovered devices, connected devices and their data) and also implements an interface to control basic Bluetooth Low Energy functions like Discovery,Connect.. etc.</p>\n\n<p>A client can send HTTP Requests (GET/POST) to a Nginx Webserver which uses FastCGI. I would like to parse the requests in this FastCGI Application and then communicate with the C++ Application to execute the commands</p>\n\n<p>f.e. Client opens an URI xyz/discover sending a GET Request. The FastCGI Application parses this requests and calls the Discover function of the C++ Application to start a Bluetooth Low Energy discovery.</p>\n\n<p>My Question is how to best communicate between the C++ Application and the FastCGI C++ Application.</p>\n\n<p>My Ideas:</p>\n\n<ul>\n<li>The C++ App forks a new child which does exec fcgi-spawn (path to my fcgi app as an argument). Then create two pipes for full-duplex communication between parent and child</li>\n<li>Using named Pipes between both processes</li>\n<li>Is it a good idea to just integrate the FastCGI functionality in my C++ Application? The C++ App runs several Threads: one to accept new TCP connections in case a new Dongle is connected. It starts a Thread for each new Dongle. Could I just create another thread which is responsible for parsing FastCGI Requests?</li>\n</ul>\n\n<p>Since I never really worked with FastCGI and nginx I'm just learning as I go. So I would be grateful for some input. Thanks!</p>\n"}, {"tags": ["c++", "multithreading", "c++11", "atomic", "memory-barriers"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432753112, "post_id": 30490696, "comment_id": 49059805, "body": "There are no barriers in your code; why did you tag it with &quot;memory-barriers&quot;?"}, {"owner": {"reputation": 71, "user_id": 1054732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c509f322b37ab8cc6fa78e80342831d4?s=128&d=identicon&r=PG", "display_name": "Jeffrey Dalla Tezza", "link": "https://stackoverflow.com/users/1054732/jeffrey-dalla-tezza"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1432754884, "post_id": 30490696, "comment_id": 49060742, "body": "Because I thought the answer might be something like &quot;this isn&#39;t correct, you need to use a memory-barrier&quot;."}, {"owner": {"reputation": 12800, "user_id": 214796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d05177bba9d853a9c546c4a965085e99?s=128&d=identicon&r=PG", "display_name": "Collin Dauphinee", "link": "https://stackoverflow.com/users/214796/collin-dauphinee"}, "edited": false, "score": 1, "creation_date": 1432756142, "post_id": 30490696, "comment_id": 49061565, "body": "You might want to reword what you&#39;re asking. The people responding to this question are being disgustingly pedantic, and likely causing more harm than good for those who are curious about this."}, {"owner": {"reputation": 7736, "user_id": 875044, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/19f2cbd347ab25e98b5aa05ee5673453?s=128&d=identicon&r=PG", "display_name": "Kan Li", "link": "https://stackoverflow.com/users/875044/kan-li"}, "edited": false, "score": 0, "creation_date": 1432767693, "post_id": 30490696, "comment_id": 49066670, "body": "I think this is a really good question.  The answer from Christophe totally makes no sense before he added the part after &#39;Nevertheless&#39;.  The whole point for C++ memory model is to specify &quot;how regular, <i>non-atomic</i> memory accesses are to be ordered around an <i>atomic</i> operation.&quot; (<a href=\"http://en.cppreference.com/w/cpp/atomic/memory_order\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/atomic/memory_order</a>), and his answer totally missed this point and &quot;being disgustingly pedantic&quot; (by Collin Dauphinee above)."}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 12800, "user_id": 214796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d05177bba9d853a9c546c4a965085e99?s=128&d=identicon&r=PG", "display_name": "Collin Dauphinee", "link": "https://stackoverflow.com/users/214796/collin-dauphinee"}, "edited": false, "score": 0, "creation_date": 1432833270, "post_id": 30490696, "comment_id": 49101213, "body": "@CollinDauphinee disgustingly pedantic sounds like the expression of some frustration.  You&#39;re free to constructively propose a less pedantic answer."}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 7736, "user_id": 875044, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/19f2cbd347ab25e98b5aa05ee5673453?s=128&d=identicon&r=PG", "display_name": "Kan Li", "link": "https://stackoverflow.com/users/875044/kan-li"}, "edited": false, "score": 0, "creation_date": 1432834466, "post_id": 30490696, "comment_id": 49101933, "body": "@icando true that I missed it at the beginning, because I was too focused on the race condition.  So many people try hard to share nonatomic or volatile variables accross threads, that I feel like Don Quichotte about it.  Sorry for that.    Looking at the title of the question, I think however that it was worth mentionning, why d is correct only after the exit of the loop ."}], "answers": [{"comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432752933, "post_id": 30490855, "comment_id": 49059707, "body": "Thankfully, the standard never uses the word &quot;unsafe&quot; normatively. A better way to describe the OP&#39;s program would be &quot;incorrect&quot;, or &quot;broken&quot;."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1432753624, "post_id": 30490855, "comment_id": 49060078, "body": "Just because the evaluations &quot;conflict&quot; doesn&#39;t mean it&#39;s a data race (and hence UB). You need a better quote."}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432753642, "post_id": 30490855, "comment_id": 49060088, "body": "@KerrekSB sorry for my ambiguous style.  I wanted to highlight that it&#39;s unsafe, and refer to the standard.  I changed it to &quot;suggested&quot;.    Wouldn&#39;t it be unspecified or undefined rather than than broken ?"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1432754182, "post_id": 30490855, "comment_id": 49060375, "body": "@T.C. True.  I wanted to underline the cause of the issue and keep it short.  Do you think that extra details such as the definition of data race (pt.21) or the rules on visibility of side effects would help the OP  ?"}, {"owner": {"reputation": 71, "user_id": 1054732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c509f322b37ab8cc6fa78e80342831d4?s=128&d=identicon&r=PG", "display_name": "Jeffrey Dalla Tezza", "link": "https://stackoverflow.com/users/1054732/jeffrey-dalla-tezza"}, "edited": false, "score": 0, "creation_date": 1432754726, "post_id": 30490855, "comment_id": 49060655, "body": "Thanks.  Do you know if there is a way to get guarantees about the ordering by using atomic_thread_fence?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432755055, "post_id": 30490855, "comment_id": 49060846, "body": "&quot;undefined&quot; is the same as &quot;broken&quot;; in fact, it&#39;s slightly worse, since you won&#39;t notice it in testing and only after you shipped it to your contracting customer and are now being sued."}, {"owner": {"reputation": 71, "user_id": 1054732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c509f322b37ab8cc6fa78e80342831d4?s=128&d=identicon&r=PG", "display_name": "Jeffrey Dalla Tezza", "link": "https://stackoverflow.com/users/1054732/jeffrey-dalla-tezza"}, "edited": false, "score": 0, "creation_date": 1432755265, "post_id": 30490855, "comment_id": 49060978, "body": "I am confused by this requirement &quot;neither happens before the other&quot;.  The idea behind the read function was that if x and y are the same, then the last call to write must have happened before d was accessed in read.  If x and y are the same, I don&#39;t see how this meets the definition of a data race."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 1, "creation_date": 1432755454, "post_id": 30490855, "comment_id": 49061114, "body": "Why is it undefined behavior (which implies anything can happen) and no unspecified behavior (the order of red/write is unknown)? Note: referring to build in types."}, {"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 1, "creation_date": 1432756299, "post_id": 30490855, "comment_id": 49061658, "body": "@DieterL&#252;cking because 1.10/21 applies. b is red and written concurrently."}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 71, "user_id": 1054732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c509f322b37ab8cc6fa78e80342831d4?s=128&d=identicon&r=PG", "display_name": "Jeffrey Dalla Tezza", "link": "https://stackoverflow.com/users/1054732/jeffrey-dalla-tezza"}, "edited": false, "score": 0, "creation_date": 1432760743, "post_id": 30490855, "comment_id": 49063954, "body": "@JeffreyDallaTezza why don&#39;t you just make d an atomic ?"}, {"owner": {"reputation": 71, "user_id": 1054732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c509f322b37ab8cc6fa78e80342831d4?s=128&d=identicon&r=PG", "display_name": "Jeffrey Dalla Tezza", "link": "https://stackoverflow.com/users/1054732/jeffrey-dalla-tezza"}, "edited": false, "score": 0, "creation_date": 1432762589, "post_id": 30490855, "comment_id": 49064866, "body": "@Christophe It is just a simplified example. I want to be able to perform arbitrary operations on different addresses."}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 71, "user_id": 1054732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c509f322b37ab8cc6fa78e80342831d4?s=128&d=identicon&r=PG", "display_name": "Jeffrey Dalla Tezza", "link": "https://stackoverflow.com/users/1054732/jeffrey-dalla-tezza"}, "edited": false, "score": 2, "creation_date": 1432767626, "post_id": 30490855, "comment_id": 49066651, "body": "@JeffreyDallaTezza I&#39;ve made an important edit: I focused to much on the race conditions on d that I didn&#39;t pay attention that you were reading a and b in the reverse order - resume at &quot;Nevertheles&quot;."}], "tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 4, "last_activity_date": 1432767362, "last_edit_date": 1432767362, "creation_date": 1432752846, "answer_id": 30490855, "question_id": 30490696, "link": "https://stackoverflow.com/questions/30490696/c11-atomic-memory-order-with-non-atomic-variables/30490855#30490855", "title": "C++11 Atomic memory order with non-atomic variables", "body": "<p>Your object <code>d</code> is written and read by two threads and it's not atomic.  This is unsafe, as suggested in the C++ standard on multithreading: </p>\n\n<blockquote>\n  <p><strong>1.10/4</strong> Two expression evaluations conflict if one of them modifies a memory location and the other one accesses or modifies the same memory location.</p>\n  \n  <p><strong>1.10/21</strong> The execution of a program contains a data race if it contains two conflicting actions in different threads,at least one of\n  which is not atomic, and neither happens before the other. Any such\n  data race results in undefined behavior.</p>\n</blockquote>\n\n<p><strong>Important edit:</strong></p>\n\n<p>In your non-atomic case, you have no guarantees about the ordering between the reading and the writing. You don't even have guarantee that the reader will read a value that was written by the writer (this <a href=\"http://preshing.com/20130618/atomic-vs-non-atomic-operations/\" rel=\"nofollow\">short article explains the risk</a> for non-atomic variables).  </p>\n\n<p><strong><em>Nevertheless</em></strong>, your reader's loop finishes based on a test of the surrounding atomic variables, for which there are strong guarantees.  Assuming that <code>version</code> never repeats between writer different calls, and given the reverse order in which you aquire their value: </p>\n\n<ul>\n<li>the order of the <code>d</code> read compared to the <code>d</code> write can't be unfortunate if the two atomics are equal.  </li>\n<li>similarly, the read value can't be inconsistent if the two atomics are equal.</li>\n</ul>\n\n<p>This means that in case of an adverse race condition on your non-atomic, thanks to the loop, you'll end-up reading the last <code>value</code>.  </p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 1054732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c509f322b37ab8cc6fa78e80342831d4?s=128&d=identicon&r=PG", "display_name": "Jeffrey Dalla Tezza", "link": "https://stackoverflow.com/users/1054732/jeffrey-dalla-tezza"}, "edited": false, "score": 0, "creation_date": 1432819563, "post_id": 30491180, "comment_id": 49091372, "body": "If the reader sees the same version for a and b, am I not guaranteed to have read the value that was set with that version?  From my understanding, I have that guarantee unless it is possible for the effects of the line <code>d = value</code> to be visible before <code>a = version</code> in a call to write."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 71, "user_id": 1054732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c509f322b37ab8cc6fa78e80342831d4?s=128&d=identicon&r=PG", "display_name": "Jeffrey Dalla Tezza", "link": "https://stackoverflow.com/users/1054732/jeffrey-dalla-tezza"}, "edited": false, "score": 0, "creation_date": 1432863410, "post_id": 30491180, "comment_id": 49114274, "body": "@JeffreyDallaTezza The point here is that you cannot read <code>d</code> unless you know that the write has finished, and you do so by reading <code>b</code> and seeing that <code>version</code> has been stored in it. Your code reads from <code>d</code> unconditionally, which causes a data race and hence undefined behavior."}], "tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": false, "score": 4, "last_activity_date": 1432753922, "creation_date": 1432753922, "answer_id": 30491180, "question_id": 30490696, "link": "https://stackoverflow.com/questions/30490696/c11-atomic-memory-order-with-non-atomic-variables/30491180#30491180", "title": "C++11 Atomic memory order with non-atomic variables", "body": "<p>The rule is that, given a <code>write</code> thread that executes once, and nothing else that modifies <code>a</code>, <code>b</code> or <code>d</code>, </p>\n\n<ul>\n<li>You can read <code>a</code> and <code>b</code> from a different thread at any time, and</li>\n<li>if you read <code>b</code> and see <code>version</code> stored in it, then\n<ul>\n<li>You can read <code>d</code>; and</li>\n<li>What you read will be <code>value</code>.</li>\n</ul></li>\n</ul>\n\n<p>Note that whether the second part is true depends on the memory ordering; it is true with the default one (<code>memory_order_seq_cst</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": true, "score": 0, "last_activity_date": 1432939187, "creation_date": 1432939187, "answer_id": 30540127, "question_id": 30490696, "link": "https://stackoverflow.com/questions/30490696/c11-atomic-memory-order-with-non-atomic-variables/30540127#30540127", "title": "C++11 Atomic memory order with non-atomic variables", "body": "<blockquote>\n  <p>Is it guaranteed that the effects of <code>d = value;</code> will not be seen before effects of <code>a = version;</code>, and will be seen before the effects of <code>b = version;</code>?</p>\n</blockquote>\n\n<p>Yes, it is. This is because <em>sequensial consistency barrier</em> is implied when read or write <code>atomic&lt;&gt;</code> variable.</p>\n\n<p>Instead of storing <code>version</code> tag into <em>two</em> atomic variables before value's modification and after it, you can increment <em>single</em> atomic variable before and after modification:</p>\n\n<pre><code>atomic&lt;int&gt; a = {0};\ndouble d;\n\nvoid write(double value)\n{\n     a = a + 1; // 'a' become odd\n     d = value; //or other modification of protected value(s)\n     a = a + 1; // 'a' become even, but not equal to the one before modification\n}\n\ndouble read(void)\n{\n     int x;\n     double ret;\n     do\n     {\n         x = a;\n         ret = value; // or other action with protected value(s)\n     } while((x &amp; 2) || (x != a));\n     return ret;\n}\n</code></pre>\n\n<p>This is known as <em>seqlock</em> in the Linux kernel: <a href=\"http://en.wikipedia.org/wiki/Seqlock\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Seqlock</a></p>\n"}], "owner": {"reputation": 71, "user_id": 1054732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c509f322b37ab8cc6fa78e80342831d4?s=128&d=identicon&r=PG", "display_name": "Jeffrey Dalla Tezza", "link": "https://stackoverflow.com/users/1054732/jeffrey-dalla-tezza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 3, "accepted_answer_id": 30540127, "answer_count": 3, "score": 6, "last_activity_date": 1432939187, "creation_date": 1432752330, "question_id": 30490696, "link": "https://stackoverflow.com/questions/30490696/c11-atomic-memory-order-with-non-atomic-variables", "title": "C++11 Atomic memory order with non-atomic variables", "body": "<p>I am unsure about how the memory ordering guarantees of atomic variables in c++11 affect operations to other memory.</p>\n\n<p>Let's say I have one thread which periodically calls the write function to update a value, and another thread which calls read to get the current value.  Is it guaranteed that the effects of <code>d = value;</code> will not be seen before effects of <code>a = version;</code>, and will be seen before the effects of <code>b = version;</code>?</p>\n\n<pre><code>atomic&lt;int&gt; a {0};\natomic&lt;int&gt; b {0};\ndouble d;\n\nvoid write(int version, double value) {\n    a = version;\n    d = value;\n    b = version;\n}\n\ndouble read() {\n    int x,y;\n    double ret;\n    do {\n        x = b;\n        ret = d;\n        y = a;\n    } while (x != y);\n    return ret;\n}\n</code></pre>\n"}, {"tags": ["c++", "pointers", "cuda", "thrust"], "answers": [{"tags": [], "owner": {"reputation": 2963, "user_id": 1855442, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61b99c64abe73180373944232b0c734f?s=128&d=identicon&r=PG", "display_name": "Pradheep", "link": "https://stackoverflow.com/users/1855442/pradheep"}, "is_accepted": false, "score": 0, "last_activity_date": 1432752670, "creation_date": 1432752670, "answer_id": 30490800, "question_id": 30490680, "link": "https://stackoverflow.com/questions/30490680/do-i-need-to-free-device-ptr-returned-by-thrust/30490800#30490800", "title": "Do I need to free device_ptr returned by thrust?", "body": "<p>I dont think you need to free the memory returned by the <em>thrust::min_element</em></p>\n\n<p>Looking at the example code given at <a href=\"http://docs.thrust.googlecode.com/hg/group__extrema.html\" rel=\"nofollow\">http://docs.thrust.googlecode.com/hg/group__extrema.html</a></p>\n\n<pre><code>#include &lt;thrust/extrema.h&gt;\n...\nint data[6] = {1, 0, 2, 2, 1, 3};\nint *result = thrust::max_element(data, data + 6);\n</code></pre>\n\n<p>Seems that it returns an pointer to the array element and you need not delete it .</p>\n"}, {"tags": [], "owner": {"reputation": 2085, "user_id": 4371080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfb71c0f8f249373532fd27cc817c563?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Sarofeen", "link": "https://stackoverflow.com/users/4371080/christian-sarofeen"}, "is_accepted": true, "score": 1, "last_activity_date": 1432752730, "last_edit_date": 1592644375, "creation_date": 1432752730, "answer_id": 30490823, "question_id": 30490680, "link": "https://stackoverflow.com/questions/30490680/do-i-need-to-free-device-ptr-returned-by-thrust/30490823#30490823", "title": "Do I need to free device_ptr returned by thrust?", "body": "<p><a href=\"http://docs.thrust.googlecode.com/hg/group__extrema.html#ga90f5158cab04adeb3f1b8b5e4acdbbcc\" rel=\"nofollow noreferrer\">thrust::min_element</a> returns an iterator. You should not free it directly.</p>\n"}], "owner": {"reputation": 193, "user_id": 1375043, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/209b8bf35b3900f930f7a356314462ae?s=128&d=identicon&r=PG", "display_name": "Ra&#250;l Garc&#237;a", "link": "https://stackoverflow.com/users/1375043/ra%c3%bal-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 30490823, "answer_count": 2, "score": 1, "last_activity_date": 1432752730, "creation_date": 1432752266, "question_id": 30490680, "link": "https://stackoverflow.com/questions/30490680/do-i-need-to-free-device-ptr-returned-by-thrust", "title": "Do I need to free device_ptr returned by thrust?", "body": "<p>I have a function to get the minimum value of an array and it's executed within a loop.</p>\n\n<pre><code>thrust::device_ptr&lt;float&gt; min_ptr = thrust::min_element(populationFitness, populationFitness + POPULATION);\n</code></pre>\n\n<p>Do I have to free the returned device_ptr? I tried with <code>thrust::device_free(min_ptr)</code> but an exception is thrown.</p>\n"}, {"tags": ["c++", "class", "virtual", "sizeof"], "answers": [{"tags": [], "owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "is_accepted": true, "score": 3, "last_activity_date": 1432752714, "last_edit_date": 1432752714, "creation_date": 1432752406, "answer_id": 30490725, "question_id": 30490643, "link": "https://stackoverflow.com/questions/30490643/difference-sizeof-in-c-classes-with-virtual-parameter/30490725#30490725", "title": "Difference sizeof in C++ Classes with virtual parameter", "body": "<p>This happens because classes that have virtual functions are usually implemented by the compiler via a <a href=\"http://en.wikipedia.org/wiki/Virtual_method_table\" rel=\"nofollow\">virtual table</a>, see also <a href=\"http://www.learncpp.com/cpp-tutorial/125-the-virtual-table/\" rel=\"nofollow\">this explanation</a>. And to use such virtual table, they  store internally a pointer to the table. In your case, the size of <code>CoolClass</code> is given by the size of the <code>int</code> member (usually 4 bytes), plus the size of the pointer (usually 4 or 8 bytes, depending on the architecture: 32 bit vs 64 bit). You see 16 due to padding.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1432753066, "last_edit_date": 1432753066, "creation_date": 1432752573, "answer_id": 30490775, "question_id": 30490643, "link": "https://stackoverflow.com/questions/30490643/difference-sizeof-in-c-classes-with-virtual-parameter/30490775#30490775", "title": "Difference sizeof in C++ Classes with virtual parameter", "body": "<p>When you add a <code>virtual</code> member function, the compiler allocates space to hold a pointer to a virtual table. In your case, the size of a pointer looks to be 8. To keep the alignment of the objects at 8 bytes, the compiler adds 4 bytes of padding to the object, which total up to 16 bytes.</p>\n\n<p>Had the compiler not added the padding, <code>sizeof(CoolClass)</code> would have been 12.</p>\n\n<p>For the second class, the size is obvious.</p>\n"}], "owner": {"reputation": 47, "user_id": 4946108, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/dab9b5eac40600b641ad48adda773826?s=128&d=identicon&r=PG&f=1", "display_name": "difegui", "link": "https://stackoverflow.com/users/4946108/difegui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 30490725, "answer_count": 2, "score": 0, "last_activity_date": 1432753066, "creation_date": 1432752175, "last_edit_date": 1432752359, "question_id": 30490643, "link": "https://stackoverflow.com/questions/30490643/difference-sizeof-in-c-classes-with-virtual-parameter", "title": "Difference sizeof in C++ Classes with virtual parameter", "body": "<p>I have this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nclass CoolClass\n{\n   public:\n      virtual void set(int x){x_=x;};\n      virtual int get(){return x_;};\n\n   private:\n      int x_;\n};\n\nclass PlainOldClass\n{\n   public:\n      void set(int x){x_=x;};\n      int get(){return x_;};\n\n   private:\n      int x_;\n};\n\nint main ()\n{\n   printf(\"CoolClass:\\t %ld \\nPlainOldClass:\\t %ld \\n\",\n          sizeof(CoolClass),sizeof(PlainOldClass)); \n\n   return 0;\n}\n</code></pre>\n\n<p>And the output is:</p>\n\n<pre><code>CoolClass:   16 \nPlainOldClass:   4 \n</code></pre>\n\n<p>and I would like to know why this happen, I tried to find some information about virtual, but I dont understand it.</p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["c++", "ios", "ipad", "opencv", "objective-c++"], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 1660537, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f7b39cc19968a57a893909d0a91fae53?s=128&d=identicon&r=PG", "display_name": "Noxalus", "link": "https://stackoverflow.com/users/1660537/noxalus"}, "is_accepted": true, "score": 0, "last_activity_date": 1432817341, "creation_date": 1432817341, "answer_id": 30507062, "question_id": 30490630, "link": "https://stackoverflow.com/questions/30490630/cvcircle-function-draw-multiple-circles-with-a-single-call/30507062#30507062", "title": "cv:circle function draw multiple circles with a single call", "body": "<p>Thanks for your help, I finally figured out what happen, and it's my entire fault...</p>\n\n<p>When you create a new Mat you need to pass it the image's height as first argument, and not width. The circle is drawn properly if I switch the arguments.</p>\n"}], "owner": {"reputation": 65, "user_id": 1660537, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f7b39cc19968a57a893909d0a91fae53?s=128&d=identicon&r=PG", "display_name": "Noxalus", "link": "https://stackoverflow.com/users/1660537/noxalus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1000, "favorite_count": 0, "accepted_answer_id": 30507062, "answer_count": 1, "score": 0, "last_activity_date": 1432817341, "creation_date": 1432752144, "question_id": 30490630, "link": "https://stackoverflow.com/questions/30490630/cvcircle-function-draw-multiple-circles-with-a-single-call", "title": "cv:circle function draw multiple circles with a single call", "body": "<p>I'm new with OpenCV library, and I would like to use it to detect circles in a video stream captured from an iPad's back camera. I figured out how to do it and with OpenCV 2.4.2, it can be done in less than 10 lines of code. But it doesn't work for me, and I think I missed something because of some weird behaviours I obtain.</p>\n\n<p>The code is very simple and begins in the Objective-C callback triggers each time a new frame is captured by the camera. Here is what I do in this callback:</p>\n\n<pre><code>- (void)captureOutput:(AVCaptureOutput *)captureOutput\n       didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer\n       fromConnection:(AVCaptureConnection *)connection\n{\n    // Convert CMSampleBufferRef to CVImageBufferRef\n    CVImageBufferRef imageBuffer = CMSampleBufferGetImageBuffer(sampleBuffer);\n\n    // Lock pixel buffer\n    CVPixelBufferLockBaseAddress(imageBuffer, kCVPixelBufferLock_ReadOnly);\n\n    // Construct VideoFrame struct\n    uint8_t *baseAddress = (uint8_t*)CVPixelBufferGetBaseAddress(imageBuffer);\n    size_t width = CVPixelBufferGetWidth(imageBuffer);\n    size_t height = CVPixelBufferGetHeight(imageBuffer);\n    size_t stride = CVPixelBufferGetBytesPerRow(imageBuffer);\n\n    // Unlock pixel buffer\n    CVPixelBufferUnlockBaseAddress(imageBuffer, 0);\n\n    std::vector&lt;unsigned char&gt; data(baseAddress, baseAddress + (stride * height));\n\n    // Call C++ function with these arguments =&gt; (data, (int)width, (int)height)\n}\n</code></pre>\n\n<p>And here is the C++ function that process the image with OpenCV:</p>\n\n<pre><code>void proccessImage(std::vector&lt;unsigned char&gt;&amp; imageData, int width, int height)\n{\n    // Create cv::Mat from std::vector&lt;unsigned char&gt;\n    Mat src(width, height, CV_8UC4, const_cast&lt;unsigned char*&gt;(imageData.data()));\n    Mat final;\n\n    // Draw a circle at position (300, 200) with a radius of 30\n    cv::Point center(300, 200);\n    circle(src, center, 30.f, CV_RGB(0, 0, 255), 3, 8, 0);\n\n    // Convert the gray image to RGBA\n    cvtColor(src, final, CV_BGRA2RGBA);\n\n    // Reform the std::vector from cv::Mat data\n    std::vector&lt;unsigned char&gt; array;\n    array.assign((unsigned char*)final.datastart, (unsigned char*)final.dataend);\n\n    // Send final image data to GPU and draw it\n}\n</code></pre>\n\n<p>The image retrieve from iPad's back camera is in BGRA (32 bits) format.</p>\n\n<p>What I expected was an image from the iPad's back camera with a simple circle drawn at the position x = 300px, y = 200px and with a radius of 30px.</p>\n\n<p>And this is what I got: <a href=\"http://i.stack.imgur.com/bWfwa.jpg\" rel=\"nofollow\">http://i.stack.imgur.com/bWfwa.jpg</a></p>\n\n<p>Do you know what is wrong with my code?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "floating-point", "promotions"], "comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 1, "creation_date": 1432752345, "post_id": 30490592, "comment_id": 49059395, "body": "read through the comments and answers you&#39;ll see the Bjarne&#39;s book is in error."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1432752360, "post_id": 30490592, "comment_id": 49059408, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/17215484/floating-point-promotion-stroustrup-vs-compiler-who-is-right\">floating-point promotion : stroustrup vs compiler - who is right?</a>"}, {"owner": {"reputation": 2064, "user_id": 4750730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VxZkt.jpg?s=128&g=1", "display_name": "Wandering Fool", "link": "https://stackoverflow.com/users/4750730/wandering-fool"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1432753143, "post_id": 30490592, "comment_id": 49059818, "body": "@RichardHodges I&#39;ve read through the comments. Even if that small excerpt was taken out of the book, that does not tell me if floating point promotion was taken out of the language. I still have no idea of when floating point promotion can occur."}], "answers": [{"comments": [{"owner": {"reputation": 2064, "user_id": 4750730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VxZkt.jpg?s=128&g=1", "display_name": "Wandering Fool", "link": "https://stackoverflow.com/users/4750730/wandering-fool"}, "edited": false, "score": 0, "creation_date": 1432753745, "post_id": 30490746, "comment_id": 49060146, "body": "Are you talking about type conversion? I know that type conversion happens if you pass a float to a variadic function that has a double as it&#39;s parameter. I don&#39;t believe type conversion and floating point promotion are the same thing. If you meant something else, will you please elaborate?"}, {"owner": {"reputation": 2064, "user_id": 4750730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VxZkt.jpg?s=128&g=1", "display_name": "Wandering Fool", "link": "https://stackoverflow.com/users/4750730/wandering-fool"}, "edited": false, "score": 0, "creation_date": 1432754208, "post_id": 30490746, "comment_id": 49060393, "body": "Oh! You&#39;re talking about ellipses. Where the parameter could be any value and any number of values. So that&#39;s where floating point promotion can happen. Thank you!"}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 6, "last_activity_date": 1432753917, "last_edit_date": 1432753917, "creation_date": 1432752459, "answer_id": 30490746, "question_id": 30490592, "link": "https://stackoverflow.com/questions/30490592/no-really-when-does-floating-point-promotion-actually-happen/30490746#30490746", "title": "No really, when does floating point promotion actually happen?", "body": "<p>The primary (perhaps sole) time that floating point promotions are applied is when passing an argument to a variadic function (e.g., <code>printf</code>).</p>\n\n<p>In this case, the usual arithmetic conversions don't apply (they're for finding a common type between two operands in an expression).</p>\n\n<p>The relevant part of the standard is [expr.call]/7 (at least as of N4296):</p>\n\n<blockquote>\n  <p>When there is no parameter for a given argument, the argument is passed in such a way that the receiving function can obtain the value of the argument by invoking va_arg (18.10).\n  <br>[...]<br>\n  If the argument has integral or enumeration type that is subject to the integral promotions (4.5), or a floating point type that is subject to the floating point promotion (4.6), the value of the argument is converted to the promoted type before the call.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 2064, "user_id": 4750730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VxZkt.jpg?s=128&g=1", "display_name": "Wandering Fool", "link": "https://stackoverflow.com/users/4750730/wandering-fool"}, "edited": false, "score": 0, "creation_date": 1432754509, "post_id": 30490916, "comment_id": 49060541, "body": "Your answer is so detailed and has great examples. I completely get floating point promotion now. Thank you so much!"}, {"owner": {"reputation": 351, "user_id": 4726668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6867cc6c8f6f1c587918485eb5c573ec?s=128&d=identicon&r=PG&f=1", "display_name": "ZeZNiQ", "link": "https://stackoverflow.com/users/4726668/zezniq"}, "edited": false, "score": 0, "creation_date": 1580311472, "post_id": 30490916, "comment_id": 106057179, "body": "Isn&#39;t float to long double a &quot;promotion&quot; as opposed to &quot;conversion&quot;?"}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 15, "last_activity_date": 1432753057, "creation_date": 1432753057, "answer_id": 30490916, "question_id": 30490592, "link": "https://stackoverflow.com/questions/30490592/no-really-when-does-floating-point-promotion-actually-happen/30490916#30490916", "title": "No really, when does floating point promotion actually happen?", "body": "<p>There is such a thing as \"floating point promotion\" of <code>float</code> to <code>double</code> per [conv.fpprom].</p>\n\n<blockquote>\n  <p>A prvalue of type <code>float</code> can be converted to a prvalue of type <code>double</code>. The value is unchanged.</p>\n  \n  <p>This conversion is called <em>floating point promotion.</em></p>\n</blockquote>\n\n<p>The answers to the linked question are correct. This promotion should not occur automatically when adding two <code>float</code>s since the usual arithmetic conversions do not promote floating-point operands.</p>\n\n<p>Floating point promotion <em>does</em> occur when passing a <code>float</code> as an operand to an ellipsis, like in <code>printf</code>. That's why the <code>%f</code> format specifier prints either a <code>float</code> or a <code>double</code>: if you pass a <code>float</code>, the function actually receives a <code>double</code>, the result of promotion.</p>\n\n<p>The existence of the floating point promotion is also important in overload resolution, because integral <em>promotions</em> and floating point <em>promotions</em> have better implicit conversion rank than integral <em>conversions</em>, floating point <em>conversions</em>, and floating-integral <em>conversions</em>.</p>\n\n<p>Example 1:</p>\n\n<pre><code>void f(double);\nvoid f(long double);\nf(0.0f);\n</code></pre>\n\n<p>This calls <code>void f(double)</code> since the promotion to <code>double</code> is better than the conversion to <code>long double</code>. In contrast, consider this perhaps surprising example 2:</p>\n\n<pre><code>void f(long double);\nvoid f(int);\nf(0.0f);\n</code></pre>\n\n<p>This is ambiguous. The conversion from <code>float</code> to <code>long double</code> is no better than the conversion from <code>float</code> to <code>int</code> since they are both not promotions.</p>\n\n<p>Example 3:</p>\n\n<pre><code>struct S {\n    operator float();\n    operator int();\n};\ndouble d = S();\n</code></pre>\n\n<p>This calls <code>operator float</code> and then promotes the resulting <code>float</code> value to <code>double</code> to initialize <code>d</code>.</p>\n"}], "owner": {"reputation": 2064, "user_id": 4750730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VxZkt.jpg?s=128&g=1", "display_name": "Wandering Fool", "link": "https://stackoverflow.com/users/4750730/wandering-fool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 916, "favorite_count": 0, "accepted_answer_id": 30490916, "answer_count": 2, "score": 9, "last_activity_date": 1471496656, "creation_date": 1432752000, "last_edit_date": 1495541696, "question_id": 30490592, "link": "https://stackoverflow.com/questions/30490592/no-really-when-does-floating-point-promotion-actually-happen", "title": "No really, when does floating point promotion actually happen?", "body": "<p>From this other <a href=\"https://stackoverflow.com/questions/17215484/floating-point-promotion-stroustrup-vs-compiler-who-is-right\">QUESTION</a> they talk about how Bjarne Stroustrup said that just as integral data-types narrower than an <code>int</code>(e.g. <code>short</code>) are promoted to an <code>int</code>, <code>float</code>s are promoted to a <code>double</code>. However, unlike widening of integrals narrower than an <code>int</code>, <strong><em>floating point promotion</em></strong> does not happen in the same way, but instead, occurs elsewhere.</p>\n\n<p>I know that if you were to compute <code>float + double</code> the <code>float</code> would be converted to a <code>double</code> before the binary operator(<code>+</code>) is applied. However, this is not <strong><em>floating point promotion</em></strong> according to <a href=\"http://www.learncpp.com/cpp-tutorial/44-implicit-type-conversion-coercion/\" rel=\"nofollow noreferrer\">Learncpp.com</a>. This is <strong><em>usual arithmetic conversion</em></strong>.</p>\n\n<p>When does floating point promotion actually happen?</p>\n"}, {"tags": ["c++", "stl", "istream-iterator"], "answers": [{"comments": [{"owner": {"reputation": 2570, "user_id": 4685247, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/73c981959972f610c97df93e561ec907?s=128&d=identicon&r=PG", "display_name": "tofiffe", "link": "https://stackoverflow.com/users/4685247/tofiffe"}, "edited": false, "score": 0, "creation_date": 1432752746, "post_id": 30490720, "comment_id": 49059614, "body": "ok, so if I get it correctly the function will block if there are not enough bytes to read? Just curious, my stream will have a guaranteed number of bytes, so this is not a problem."}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "reply_to_user": {"reputation": 2570, "user_id": 4685247, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/73c981959972f610c97df93e561ec907?s=128&d=identicon&r=PG", "display_name": "tofiffe", "link": "https://stackoverflow.com/users/4685247/tofiffe"}, "edited": false, "score": 0, "creation_date": 1432752961, "post_id": 30490720, "comment_id": 49059723, "body": "@tofiffe: No, it won&#39;t block. It will just fill the remaining characters with junk. (actually, I believe it will just repeat the last successfully read character over and over, though I&#39;m not sure if that is guaranteed)."}, {"owner": {"reputation": 2570, "user_id": 4685247, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/73c981959972f610c97df93e561ec907?s=128&d=identicon&r=PG", "display_name": "tofiffe", "link": "https://stackoverflow.com/users/4685247/tofiffe"}, "edited": false, "score": 0, "creation_date": 1432753056, "post_id": 30490720, "comment_id": 49059779, "body": "nice, seems it&#39;s far more usefull than I expected :D"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1432759535, "post_id": 30490720, "comment_id": 49063379, "body": "Dereferencing an end-of-stream iterator is UB."}], "tags": [], "owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "is_accepted": true, "score": 3, "last_activity_date": 1432752744, "last_edit_date": 1432752744, "creation_date": 1432752387, "answer_id": 30490720, "question_id": 30490564, "link": "https://stackoverflow.com/questions/30490564/is-there-any-way-to-use-istreambuf-iterator-to-read-a-specific-length/30490720#30490720", "title": "Is there any way to use istreambuf_iterator to read a specific length?", "body": "<p>You can use <code>std::copy_n</code> instead of <code>std::copy</code>.</p>\n\n<pre><code>std::copy_n(ii, 5, vec.begin());\n</code></pre>\n\n<p>However, this is a bit unsafe since it will keep trying to read even if the stream is exhausted. If that is of concern to you, then you will either have to use a lower level construct like a basic for loop, or a library with more advanced range handling capabilities, like Eric Niebler's excellent <a href=\"https://github.com/ericniebler/range-v3\" rel=\"nofollow\">range library</a>.</p>\n"}], "owner": {"reputation": 2570, "user_id": 4685247, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/73c981959972f610c97df93e561ec907?s=128&d=identicon&r=PG", "display_name": "tofiffe", "link": "https://stackoverflow.com/users/4685247/tofiffe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 30490720, "answer_count": 1, "score": 2, "last_activity_date": 1432752744, "creation_date": 1432751923, "question_id": 30490564, "link": "https://stackoverflow.com/questions/30490564/is-there-any-way-to-use-istreambuf-iterator-to-read-a-specific-length", "title": "Is there any way to use istreambuf_iterator to read a specific length?", "body": "<p>I'm writing my files like this:</p>\n\n<pre><code>std::ofstream os; // declared somewhere earlier\nstd::vector&lt;char&gt; vec; // declared somewhere earlier\n\nstd::ostreambuf_iterator&lt;char&gt; oi(os);\nstd::copy(vec.begin(), vec.end(), oi);\n</code></pre>\n\n<p>So naturaly I was wondering if there was a similar way to read let's say 5 bytes using the <code>std::istream_iterator</code> or <code>std::istreambuf_iterator</code>, however since they don't support the <code>operator+</code> I can't seem to figure out how to accomplish this.</p>\n\n<p>For example I imagined a soludion close to this:</p>\n\n<pre><code>std::istream_iterator&lt;char&gt; ii(file);\nstd::copy(ii, ii + 5, vec.begin());\n</code></pre>\n\n<p>Is there any way to do this in C++14?</p>\n\n<p>PS: I want a solution using STL, so using <code>boost</code> is not an option.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1432751934, "post_id": 30490552, "comment_id": 49059161, "body": "Use std::array or vector."}, {"owner": {"reputation": 42285, "user_id": 2057919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec600dcd84770c5d835cd4c943514088?s=128&d=identicon&r=PG&f=1", "display_name": "elixenide", "link": "https://stackoverflow.com/users/2057919/elixenide"}, "edited": false, "score": 9, "creation_date": 1432751970, "post_id": 30490552, "comment_id": 49059175, "body": "<a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> != <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1432752109, "post_id": 30490552, "comment_id": 49059256, "body": "c-array are not assignable."}, {"owner": {"reputation": 1718, "user_id": 2065237, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tG7xt.png?s=128&g=1", "display_name": "Sildoreth", "link": "https://stackoverflow.com/users/2065237/sildoreth"}, "edited": false, "score": 1, "creation_date": 1432752145, "post_id": 30490552, "comment_id": 49059284, "body": "Do not create functions that allocate memory and return a pointer.  That is setting yourself up for a memory leak.  You should instead set up this function to take in a pointer to an already-allocated block of memory and populate the information there."}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "reply_to_user": {"reputation": 1718, "user_id": 2065237, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tG7xt.png?s=128&g=1", "display_name": "Sildoreth", "link": "https://stackoverflow.com/users/2065237/sildoreth"}, "edited": false, "score": 1, "creation_date": 1432752518, "post_id": 30490552, "comment_id": 49059486, "body": "@Sildoreth The <code>board</code> array is allocated on the stack and will be automatically destroyed when the function returns. The bad behavior here is that you&#39;ll be returning a pointer to that destroyed data."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 1718, "user_id": 2065237, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tG7xt.png?s=128&g=1", "display_name": "Sildoreth", "link": "https://stackoverflow.com/users/2065237/sildoreth"}, "edited": false, "score": 0, "creation_date": 1432755219, "post_id": 30490552, "comment_id": 49060947, "body": "@Sildoreth: Allocating memory and  returning a pointer to has the considerable advantage that the function can determine how big the array needs to be. Yes, it can leak memory if the caller doesn&#39;t release it -- so make sure the caller releases it.  Having the caller pass a pointer to an already allocated block <i>can</i> be a good solution, but only if the caller knows how big the array will need to be."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1432755234, "post_id": 30490552, "comment_id": 49060951, "body": "A C or C++ function cannot return an array."}], "answers": [{"tags": [], "owner": {"reputation": 1718, "user_id": 2065237, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tG7xt.png?s=128&g=1", "display_name": "Sildoreth", "link": "https://stackoverflow.com/users/2065237/sildoreth"}, "is_accepted": false, "score": 2, "last_activity_date": 1432818425, "last_edit_date": 1432818425, "creation_date": 1432752569, "answer_id": 30490773, "question_id": 30490552, "link": "https://stackoverflow.com/questions/30490552/static-short99-getrandomboard/30490773#30490773", "title": "static short[9][9] getRandomBoard();", "body": "<h2>Problem 1</h2>\n\n<p>First off, your declaration of the function needs to be changed.</p>\n\n<pre><code>static short[9][9] getRandomBoard()\n</code></pre>\n\n<p>It should be</p>\n\n<pre><code>static short** getRandomBoard()\n</code></pre>\n\n<h2>Problem 2</h2>\n\n<p>The stack level for <code>getRandomBoard</code> owns the variable named <code>board</code>.  When the stack level for your function disappears, so does the 2D array for the variable <code>board</code>.  This means that you are returning a pointer to a memory location that is no longer valid.</p>\n\n<p>The easy way to remember this and avoid problems in the future is that if you use <code>new</code>, then data is created on the <a href=\"https://en.wikipedia.org/wiki/Memory_management#HEAP\" rel=\"nofollow\">heap</a>; otherwise, it is created on the <a href=\"https://en.wikipedia.org/wiki/Call_stack\" rel=\"nofollow\">stack</a>.</p>\n\n<p>The bare minimum changes to make your example work would give you this:</p>\n\n<pre><code>static short** getRandomBoard() {\n  //Allocate 2D array on the heap, not on the stack\n  short** board = new short*[9];\n  //Create 2nd level of 2D array with arrays allocated on the heap\n  for(int i = 0; i &lt; 9; i++) {\n    board[i] = new short[9];\n  }\n  //Populate 2D array here\n  return board;\n}\n</code></pre>\n\n<p>That being said, it is bad practice (if you can avoid it) to have a function allocate memory and return a pointer to the allocated memory.  This tends to lead to <a href=\"https://en.wikipedia.org/wiki/Memory_leak\" rel=\"nofollow\">memory leaks</a>.  Instead, you should have your function take in the array as a parameter.</p>\n\n<pre><code>static void populateRandomBoard(short board[9][9]) {\n  //Populate board here\n}\n</code></pre>\n\n<p>And then use the function like this:</p>\n\n<pre><code>static int main() {\n  short board[9][9];\n  populateRandomBoard(board);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8382, "user_id": 398461, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ixu8F.jpg?s=128&g=1", "display_name": "wcochran", "link": "https://stackoverflow.com/users/398461/wcochran"}, "is_accepted": true, "score": 1, "last_activity_date": 1432756320, "last_edit_date": 1432756320, "creation_date": 1432754546, "answer_id": 30491362, "question_id": 30490552, "link": "https://stackoverflow.com/questions/30490552/static-short99-getrandomboard/30491362#30491362", "title": "static short[9][9] getRandomBoard();", "body": "<p>In your example <code>board</code> is an array allocated of off of the stack frame which goes away once the function is returned. If you wish to return a contiguous array allocated off of the heap do the following:</p>\n\n<pre><code>static short(* getRandomBoard())[9] {\n  short (*board)[9] = (short (*)[9]) malloc(9*9*sizeof(short));\n  ...\n  board[i][j] = 3;\n  ...\n  return board;\n}\n</code></pre>\n\n<p>Just remember to <code>free(board)</code> when done with the array to avoid a leak.</p>\n\n<p>Better yet, redefine your function to pass <code>board</code> as an argument (i.e., let the caller worry about allocation):</p>\n\n<pre><code>void getRandomBoard(short board[9][9]) {\n   ....\n}\n</code></pre>\n\n<p>This way <code>board</code> could be allocated off the stack (no need to free), the heap, or statically.</p>\n\n<p>It would be better to use <code>&lt;array&gt;</code> if you are using c++</p>\n\n<pre><code>array&lt;array&lt;short,9&gt;,9&gt; getRandomBoard() {\n   array&lt;array&lt;short,9&gt;,9&gt; board;\n   ...\n   board[i][j] = 3;\n   ...\n   return board;\n}\n</code></pre>\n\n<p>If you want to stick with C, the following link will tell you all the ways you can represent a 2D array in C:</p>\n\n<p><a href=\"http://ezekiel.vancouver.wsu.edu/~cs330/lectures/linear_algebra/matrix/matrix.pdf\" rel=\"nofollow\">http://ezekiel.vancouver.wsu.edu/~cs330/lectures/linear_algebra/matrix/matrix.pdf</a></p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1432929812, "creation_date": 1432929812, "answer_id": 30538154, "question_id": 30490552, "link": "https://stackoverflow.com/questions/30490552/static-short99-getrandomboard/30538154#30538154", "title": "static short[9][9] getRandomBoard();", "body": "<p>C-array are not assignable and can't be returned from function.</p>\n\n<p>The easier is to use a structure</p>\n\n<pre><code>struct Board\n{\n    short numbers[9][9];\n};\n\nBoard CreateRandomBoard()\n{\n    Board board;\n\n    // Fill board values\n    // board.numbers[i][j] = value;\n    // ...\n\n    return board;\n}\n</code></pre>\n\n<p>and you avoid memory management.</p>\n"}], "owner": {"reputation": 2079, "user_id": 1703871, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/pgOJ0.png?s=128&g=1", "display_name": "motis10", "link": "https://stackoverflow.com/users/1703871/motis10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 30491362, "answer_count": 3, "score": -5, "last_activity_date": 1432929812, "creation_date": 1432751880, "question_id": 30490552, "link": "https://stackoverflow.com/questions/30490552/static-short99-getrandomboard", "title": "static short[9][9] getRandomBoard();", "body": "<p>I tried to return short[9][9] for soduko game\nstatic short[9][9] getRandomBoard();</p>\n\n<pre><code>static short[9][9] getRandomBoard()\n{\n    short board[9][9];\n\n    bla bla bla.....................\n    bla bla bla.....................\n    bla bla bla.....................\n\n    return board;\n}\n</code></pre>\n\n<p>and i got an error:\nError excpected a ';'</p>\n"}, {"tags": ["c++", "linux"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1432751254, "post_id": 30490326, "comment_id": 49058772, "body": "exactly what does the number of users have to do with <code>uptime</code>?"}, {"owner": {"reputation": 3021, "user_id": 3987179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8cbf5c4a2f8523b57e9786f6933f34ad?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/3987179/jake"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1432751430, "post_id": 30490326, "comment_id": 49058900, "body": "@MarcB: I imagine he wants to reproduce something like this uptime command: <code>jake@w700-ubuntu:~$ uptime  14:29:46 up  5:59,  2 users,  load average: 0.16, 0.16, 0.24</code>"}, {"owner": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1432751438, "post_id": 30490326, "comment_id": 49058904, "body": "@MarcB: From the man page for &#39;uptime&#39;: <code>uptime gives a one line display of the following information. The current time, how long the system has been running, **how many users are currently logged on**, and the system load averages for the past 1, 5, and 15 minutes.</code>"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 4370262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afe21ef7e625a1ffd4ea9de013519092?s=128&d=identicon&r=PG&f=1", "display_name": "Tomsz Comasz", "link": "https://stackoverflow.com/users/4370262/tomsz-comasz"}, "edited": false, "score": 0, "creation_date": 1432808191, "post_id": 30490461, "comment_id": 49082855, "body": "I need to send that information from serverTCP to clientTCP. I want to  put that in string. Maybe there is a way to put system(&quot;uptime&quot;) result to string?"}, {"owner": {"reputation": 15255, "user_id": 3761628, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9414f7276059e8c1c63214430338ad7e?s=128&d=identicon&r=PG&f=1", "display_name": "eol", "link": "https://stackoverflow.com/users/3761628/eol"}, "reply_to_user": {"reputation": 119, "user_id": 4370262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afe21ef7e625a1ffd4ea9de013519092?s=128&d=identicon&r=PG&f=1", "display_name": "Tomsz Comasz", "link": "https://stackoverflow.com/users/4370262/tomsz-comasz"}, "edited": false, "score": 0, "creation_date": 1432847428, "post_id": 30490461, "comment_id": 49109323, "body": "yes, check out this link <a href=\"http://stackoverflow.com/questions/646241/c-run-a-system-command-and-get-output\" title=\"c run a system command and get output\">stackoverflow.com/questions/646241/&hellip;</a>"}], "tags": [], "owner": {"reputation": 15255, "user_id": 3761628, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9414f7276059e8c1c63214430338ad7e?s=128&d=identicon&r=PG&f=1", "display_name": "eol", "link": "https://stackoverflow.com/users/3761628/eol"}, "is_accepted": false, "score": 1, "last_activity_date": 1432752183, "last_edit_date": 1432752183, "creation_date": 1432751572, "answer_id": 30490461, "question_id": 30490326, "link": "https://stackoverflow.com/questions/30490326/retrieving-amount-of-logged-on-users-in-c-in-linux/30490461#30490461", "title": "Retrieving amount of logged on users in c++ in linux", "body": "<p>Well, if you just want to execute commands using C++, you could use:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main()\n{\n  //execute uptime command\n  system(\"uptime\");\n  //one way to \"count\" the currently logged users\n  system(\"users | wc -w\");\n  //or another way\n  system(\"who | wc -l\");\n  return 0;\n} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "reply_to_user": {"reputation": 119, "user_id": 4370262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afe21ef7e625a1ffd4ea9de013519092?s=128&d=identicon&r=PG&f=1", "display_name": "Tomsz Comasz", "link": "https://stackoverflow.com/users/4370262/tomsz-comasz"}, "edited": false, "score": 0, "creation_date": 1433449010, "post_id": 30490620, "comment_id": 49369720, "body": "As I said, read the <code>man</code> page for <code>utmp</code>.  It describes how to use that file."}, {"owner": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "reply_to_user": {"reputation": 119, "user_id": 4370262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afe21ef7e625a1ffd4ea9de013519092?s=128&d=identicon&r=PG&f=1", "display_name": "Tomsz Comasz", "link": "https://stackoverflow.com/users/4370262/tomsz-comasz"}, "edited": false, "score": 0, "creation_date": 1433786334, "post_id": 30490620, "comment_id": 49489390, "body": "<a href=\"http://linux.die.net/man/5/utmp\" rel=\"nofollow noreferrer\">Documentation can also be found on the Internet</a>.  I&#39;ve never actually used utmp, so I can&#39;t be much more specific."}], "tags": [], "owner": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "is_accepted": false, "score": 0, "last_activity_date": 1432752117, "creation_date": 1432752117, "answer_id": 30490620, "question_id": 30490326, "link": "https://stackoverflow.com/questions/30490326/retrieving-amount-of-logged-on-users-in-c-in-linux/30490620#30490620", "title": "Retrieving amount of logged on users in c++ in linux", "body": "<p>That information is stored in <code>/var/run/utmp</code>.  This is a binary file; see the <code>man</code> page for <code>utmp(5)</code> for details.</p>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 4370262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afe21ef7e625a1ffd4ea9de013519092?s=128&d=identicon&r=PG&f=1", "display_name": "Tomsz Comasz", "link": "https://stackoverflow.com/users/4370262/tomsz-comasz"}, "is_accepted": true, "score": 0, "last_activity_date": 1433930043, "creation_date": 1433930043, "answer_id": 30752961, "question_id": 30490326, "link": "https://stackoverflow.com/questions/30490326/retrieving-amount-of-logged-on-users-in-c-in-linux/30752961#30752961", "title": "Retrieving amount of logged on users in c++ in linux", "body": "<p>I got it!\nWrite in C file system(\"users | wc -w > text\"); and check text.txt file. Next load that information from txt file </p>\n"}], "owner": {"reputation": 119, "user_id": 4370262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afe21ef7e625a1ffd4ea9de013519092?s=128&d=identicon&r=PG&f=1", "display_name": "Tomsz Comasz", "link": "https://stackoverflow.com/users/4370262/tomsz-comasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 30752961, "answer_count": 3, "score": -1, "last_activity_date": 1433930043, "creation_date": 1432751092, "question_id": 30490326, "link": "https://stackoverflow.com/questions/30490326/retrieving-amount-of-logged-on-users-in-c-in-linux", "title": "Retrieving amount of logged on users in c++ in linux", "body": "<p>I have to create a program, that displays result of 'uptime'. how to get amount of logged on users in c++ in linux?</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432751707, "post_id": 30490163, "comment_id": 49059038, "body": "Why are you using antiquated and error-prone C-string facilities?"}, {"owner": {"reputation": 57, "user_id": 4946011, "user_type": "registered", "profile_image": "https://graph.facebook.com/845627608823732/picture?type=large", "display_name": "Diego Cuadros", "link": "https://stackoverflow.com/users/4946011/diego-cuadros"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432759564, "post_id": 30490163, "comment_id": 49063387, "body": "It&#39;s what I&#39;ve learned so far, I&#39;m very inexperienced. If you have any suggestions, I&#39;d appreciate it."}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1432751378, "creation_date": 1432751378, "answer_id": 30490404, "question_id": 30490163, "link": "https://stackoverflow.com/questions/30490163/why-doesnt-this-function-with-strpbrk-work/30490404#30490404", "title": "Why doesn&#39;t this function with strpbrk() work?", "body": "<p>You have a couple issues with your code.  First:</p>\n\n<pre><code>char * cX = new char[X.length()];\nstrcpy(cX, X.c_str());\n</code></pre>\n\n<p>Is incorrect as you are not accounting for the null terminator that you need in <code>cX</code>.  <code>length()</code> only returns the number of character in the string and does not count the null terminator.  To fix that all you need to do is:</p>\n\n<pre><code>char * cX = new char[X.length() + 1];\nstrcpy(cX, X.c_str());   //    ^^^^ add one to the size \n</code></pre>\n\n<p>The second issue you have is in:</p>\n\n<pre><code>while (delimiter != NULL)\n{\n    delimiter = strpbrk(delimiter+1, \"+-*/\");\n    cout &lt;&lt; \"OK\";      //makes it to this point then crashes\n    operators.push_back(*delimiter);   //this doesn't work\n}\n</code></pre>\n\n<p>You check if <code>delimiter</code> is not null and then you reassign it using <code>strpbrk()</code>.  If <code>strpbrk()</code> returns <code>NULL</code> then <code>operators.push_back(*delimiter)</code> is going to fail because you are dereferencing a null pointer.  You should be able to change your code to the following to get it to work:</p>\n\n<pre><code>//...\nchar * delimiter = strpbrk(cX,\"+*-/\");  // get operator\nwhile (delimiter != NULL) // keep looping while we have an operator\n{\n    operators.push_back(*delimiter);  // add the operator to the vector\n    delimiter = strpbrk(delimiter+1, \"+-*/\");  // find the next operator     \n}\n//...\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4946011, "user_type": "registered", "profile_image": "https://graph.facebook.com/845627608823732/picture?type=large", "display_name": "Diego Cuadros", "link": "https://stackoverflow.com/users/4946011/diego-cuadros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432770920, "creation_date": 1432750495, "last_edit_date": 1432770920, "question_id": 30490163, "link": "https://stackoverflow.com/questions/30490163/why-doesnt-this-function-with-strpbrk-work", "title": "Why doesn&#39;t this function with strpbrk() work?", "body": "<p>Why does my program crash when I try to put delimiter into vector::operators?I'm trying to make a working calculator and I need to find all the operators of the input string in order. All the necessary libraries were included, and the code worked when I was only using 2 numbers and 1 operator. Is the problem that I used the loop incorrectly? I also have a similar function to find the numbers that works and crashes in the same spots.</p>\n\n<pre><code>vector&lt;char&gt;operators;\n\nint main()\n{\n    string input;\n    cin &gt;&gt; input;\n    find_operators(input);\n}\n\nvoid find_operators(string X)\n{\n    char * cX = new char[X.length()];\n    strcpy(cX, X.c_str());\n    char * delimiter = strpbrk(cX,\"+*-/\");\n    operators.push_back(*delimiter);     //this worked\n    while (delimiter != NULL)\n    {\n        delimiter = strpbrk(delimiter+1, \"+-*/\");\n        cout &lt;&lt; \"OK\";      //makes it to this point then crashes\n        operators.push_back(*delimiter);   //this doesn't work\n    }\n    delete[] cX;\n}\n</code></pre>\n"}, {"tags": ["c++", "list", "class", "templates", "warnings"], "comments": [{"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 2, "creation_date": 1432750472, "post_id": 30490005, "comment_id": 49058307, "body": "if <code>temp</code> becomes null before <code>counter</code> equals <code>n</code> there is no return value. That is what the compiler is complaining about."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4805186, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1227b381fd03aa8188be5dbb4d21babc?s=128&d=identicon&r=PG&f=1", "display_name": "Hangoverflow", "link": "https://stackoverflow.com/users/4805186/hangoverflow"}, "edited": false, "score": 0, "creation_date": 1432752665, "post_id": 30490460, "comment_id": 49059576, "body": "No, if statement is correct because, if i have list: head -&gt; _ _ _ _ _ , size() = 4. and i  want add item just on the back of list i use (for example), add (size(),T item), because place number 5 is empty and this add will be just pushend."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 25, "user_id": 4805186, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1227b381fd03aa8188be5dbb4d21babc?s=128&d=identicon&r=PG&f=1", "display_name": "Hangoverflow", "link": "https://stackoverflow.com/users/4805186/hangoverflow"}, "edited": false, "score": 0, "creation_date": 1432753030, "post_id": 30490460, "comment_id": 49059762, "body": "@Hangoverflow, that doesn&#39;t sound the right way to implement the class. However, you sound like you have a handle on that."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1432751572, "creation_date": 1432751572, "answer_id": 30490460, "question_id": 30490005, "link": "https://stackoverflow.com/questions/30490005/return-value-in-template-class-in-funcion-cant-rid-of-warning-not-all-control/30490460#30490460", "title": "Return value in template class in funcion can&#39;t rid of &quot;warning not all control paths return a value&quot;", "body": "<p>A human reading your can conclude that, if your function has no bugs, the function will never go past the <code>while</code> statement. Hence, it might be OK to omit the <code>return</code> statement after the <code>while</code> statement. Your compiler is not able to deduce that. Hence, it expects a <code>return</code> statement after the <code>while</code> loop.</p>\n\n<p>You can use something like the following to pacify the compiler:</p>\n\n<pre><code>while (temp)\n{\n   if (counter == n)\n      return temp-&gt;data;\n   temp = temp-&gt;next;\n   counter ++;\n}\n\n// Code should never reach here.\n// These lines are here solely to pacify the compiler\nstatic T dummy{};\nreturn dummy;\n</code></pre>\n\n<p>BTW, the logic of the conditional in the <code>if</code> statement is incorrect. Instead of </p>\n\n<pre><code>if ( (n &lt; 0) || (n &gt; size()))\n</code></pre>\n\n<p>it should be</p>\n\n<pre><code>if ( (n &lt; 0) || (n &gt;= size()))\n</code></pre>\n\n<p>For <code>n</code> to be a valid 0-based index, it has to be less than the size of the list.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "is_accepted": false, "score": 1, "last_activity_date": 1432752841, "last_edit_date": 1432752841, "creation_date": 1432751930, "answer_id": 30490568, "question_id": 30490005, "link": "https://stackoverflow.com/questions/30490005/return-value-in-template-class-in-funcion-cant-rid-of-warning-not-all-control/30490568#30490568", "title": "Return value in template class in funcion can&#39;t rid of &quot;warning not all control paths return a value&quot;", "body": "<p><code>while(temp)</code> with <code>if (counter == n)</code>is redundant. Just <code>while(n--) { temp = temp-&gt;next;  } return temp-&gt;data</code> (You test the range at the beginning of the function)</p>\n"}, {"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 1, "last_activity_date": 1432752162, "creation_date": 1432752162, "answer_id": 30490636, "question_id": 30490005, "link": "https://stackoverflow.com/questions/30490005/return-value-in-template-class-in-funcion-cant-rid-of-warning-not-all-control/30490636#30490636", "title": "Return value in template class in funcion can&#39;t rid of &quot;warning not all control paths return a value&quot;", "body": "<p>Dieter has suggested a better way to structure your function which avoids this issue entirely.</p>\n\n<p>In cases where the algorithm is such that this is not possible, I'd put a <code>throw std::runtime_error(\"Unexpected code path!\")</code> at the bottom of the function. That way, you silence the warning <em>and</em> if there is something that you missed, it will be properly reported.</p>\n"}], "owner": {"reputation": 25, "user_id": 4805186, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1227b381fd03aa8188be5dbb4d21babc?s=128&d=identicon&r=PG&f=1", "display_name": "Hangoverflow", "link": "https://stackoverflow.com/users/4805186/hangoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1432769725, "answer_count": 3, "score": 0, "last_activity_date": 1432752841, "creation_date": 1432749988, "last_edit_date": 1432751194, "question_id": 30490005, "link": "https://stackoverflow.com/questions/30490005/return-value-in-template-class-in-funcion-cant-rid-of-warning-not-all-control", "closed_reason": "Duplicate", "title": "Return value in template class in funcion can&#39;t rid of &quot;warning not all control paths return a value&quot;", "body": "<p>i have problem with my code. I have tried everything what i know and i cant get rid of warning level 1. I have something like this:</p>\n\n<pre><code>template &lt;class T&gt;\nT&amp; aghSlist&lt;T&gt;::at(int n) const\n{\n   if ( (n &lt; 0) || (n &gt; size()))\n      throw aException(0, \"Index out of range\", __FILE__, __LINE__);\n\n   node * temp = head;\n   int counter = 0;\n\n   while (temp)\n   {\n      if (counter == n)\n         return temp-&gt;data; //here probably is the reason of warning\n      temp = temp-&gt;next;\n      counter ++;\n   }\n}\n</code></pre>\n\n<p>So </p>\n\n<p>param n - position in list;<br>\nsize () - return size of list,<br>\ncounter - param helpful to get to n position<br>\ntemp - pointer to moving forward in list<br>\nhead - beginning of the list  </p>\n\n<p>I 'm sure that all paths return a value, but i'm getting this warning. Is any possibility in c++ to return reference to NULL or in some other way resolve this problem?</p>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 4967, "user_id": 1935008, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3500ff2f9f622b0cc68319d62ede7244?s=128&d=identicon&r=PG", "display_name": "Ilya Kobelevskiy", "link": "https://stackoverflow.com/users/1935008/ilya-kobelevskiy"}, "edited": false, "score": 3, "creation_date": 1432749777, "post_id": 30489898, "comment_id": 49057938, "body": "What do you mean by &quot;not working&quot;? Include compiler/runtime error..."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1432749808, "post_id": 30489898, "comment_id": 49057968, "body": "If <code>param</code> <i>does</i> point to an <code>int**</code>, the conversion is fine. However it is hard to say without seeing more, and more importantly without fixing the syntax..."}, {"owner": {"reputation": 15, "user_id": 3261520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XkUIA.jpg?s=128&g=1", "display_name": "omercan", "link": "https://stackoverflow.com/users/3261520/omercan"}, "edited": false, "score": 0, "creation_date": 1432750124, "post_id": 30489898, "comment_id": 49058121, "body": "debugger says p is not accessable. The problem is the value of param is not assigned to p."}, {"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1432752371, "post_id": 30489898, "comment_id": 49059419, "body": "So initialize <code>p</code> to something meaningful."}], "answers": [{"tags": [], "owner": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "is_accepted": false, "score": 0, "last_activity_date": 1432753899, "creation_date": 1432753899, "answer_id": 30491170, "question_id": 30489898, "link": "https://stackoverflow.com/questions/30489898/void-conversion-to-int-in-mouse-callback-function-opencv-c/30491170#30491170", "title": "void* conversion to int*** in mouse callback function (OpenCV C++)", "body": "<p>my crystal ball tells me, that you're trying to get the 4 points nessecary for a perspective transform ;).</p>\n\n<pre><code>static void mouseEvent(int evt, int x, int y, int flags, void* param)\n{\n    vector&lt;Point2f&gt; *p = (vector&lt;Point2f&gt;*)param;\n\n    if (evt == CV_EVENT_LBUTTONDOWN &amp;&amp; p-&gt;size()&lt;4){\n        p-&gt;push_back(Point2f(x,y);\n    }\n}\n\nint main()\n{\n    ....\n\n    vector&lt;Point2f&gt; p;\n    namedWindow(\"rgb image\", CV_WINDOW_AUTOSIZE);\n    imshow( \"rgb image\", bgrImage );\n    setMouseCallback(\"rgb image\", mouseEvent, (void*)(&amp;p));\n\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1318, "user_id": 1066820, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8f5e235e2332b4054a95798a15f1bfd0?s=128&d=identicon&r=PG", "display_name": "EralpB", "link": "https://stackoverflow.com/users/1066820/eralpb"}, "is_accepted": false, "score": 0, "last_activity_date": 1432792592, "creation_date": 1432792592, "answer_id": 30498289, "question_id": 30489898, "link": "https://stackoverflow.com/questions/30489898/void-conversion-to-int-in-mouse-callback-function-opencv-c/30498289#30498289", "title": "void* conversion to int*** in mouse callback function (OpenCV C++)", "body": "<p>Can you try this?</p>\n\n<pre><code>int nth_count=0;\nstatic void mouseEvent(int evt, int x, int y, int flags, void* param)\n{\n    int*** address_of_p=(int***)param;\n\n    (*p)[nth_count]=new int[2];\n\n    if (evt == CV_EVENT_LBUTTONDOWN &amp;&amp; nth_count&lt;4){\n        (*p)[nth_count][0]=x;\n        (*p)[nth_count][1]=y;\n        nth_count++;\n    }\n}\n\nint main()\n{\n    int** p;\n    p = new int*[4];\n    namedWindow(\"rgb image\", CV_WINDOW_AUTOSIZE);\n    imshow( \"rgb image\", bgrImage );\n    setMouseCallback(\"rgb image\", mouseEvent, &amp;p);\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 3261520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XkUIA.jpg?s=128&g=1", "display_name": "omercan", "link": "https://stackoverflow.com/users/3261520/omercan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1432792592, "creation_date": 1432749644, "last_edit_date": 1432750067, "question_id": 30489898, "link": "https://stackoverflow.com/questions/30489898/void-conversion-to-int-in-mouse-callback-function-opencv-c", "title": "void* conversion to int*** in mouse callback function (OpenCV C++)", "body": "<p>I'm trying to save the coordinates of the 4 points that I click on the image in 4x2 matrix. To do this I'm using the following code.</p>\n\n<pre><code>static void mouseEvent(int evt, int x, int y, int flags, void* param)\n{\n    int*** p=(int***)param;\n\n\n    p*=new int*[4];\n    (*p)[0]=new int[2];\n    (*p)[1]=new int[2];\n    (*p)[2]=new int[2];\n    (*p)[3]=new int[2];\n\n    int i=0;\n    if (evt == CV_EVENT_LBUTTONDOWN &amp;&amp; i&lt;4){\n        (*p)[i][0]=x;\n        (*p)[i][1]=y;\n        i++;\n    }\n}\n\nint main()\n{\n    ....\n\n    int** p;\n    namedWindow(\"rgb image\", CV_WINDOW_AUTOSIZE);\n    imshow( \"rgb image\", bgrImage );\n    setMouseCallback(\"rgb image\", mouseEvent, &amp;p);\n\n    ...\n}\n</code></pre>\n\n<p>The problem I saw during debugging is that the line \"int*** p=(int***)param;\" is not working. I checked several sources and think it may be a 64-bit issue. I appreciate all your help.</p>\n"}, {"tags": ["c++", "multithreading", "mutex"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1432750652, "post_id": 30489891, "comment_id": 49058398, "body": "What <i>exactly</i> is this code supposed to be <i>doing</i> ? You never said <i>exactly</i> what the desired workflow is, nor why you&#39;re doing any of this in the first place. This immediately contains a race to latch the mutex (the thread and main). It is entirely possible the <code>Test </code> thread will acquire the mutex, perform the output, release the mutex and return before you ever even reach the subsequent  <code>MutPtr-&gt;lock();</code> in <code>FakeMain</code>. Further, if that <i>doesn&#39;t</i> happen, you lock the mutex <i>twice</i> in main, then try to join the thread, which will wait for a lock it can never acquire."}, {"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1432751105, "post_id": 30489891, "comment_id": 49058687, "body": "The desired out put should have the thread print one message. The message is then being changed by an external function, then a new thread is made to print this new message. I do notice the &quot;race&quot; to lock the mutex, this is where I think my program is error-ed. How can i fix this without adding a &quot;Sleep(50);&quot; statement?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1432753186, "post_id": 30489891, "comment_id": 49059839, "body": "Given the workflow in your question, there should never be a time when both threads are &quot;running&quot;. And since the resource you&#39;re trying to protect is never modified concurrently (again, with your workflow, that includes any thread(s) and even <code>main()</code>), I don&#39;t understand the reason for a mutex in <i>any</i> of this. Why can&#39;t you just do <a href=\"http://pastebin.com/cvqdALNy\" rel=\"nofollow noreferrer\">something like this</a> ?"}, {"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1432753543, "post_id": 30489891, "comment_id": 49060040, "body": "The mutex is for other data structures that is not in this code, I have a msg class in the real code that is passed and edited by both threads. I understand with this simple program mutexes, even threading, is unnecessary, was just representing what my real code does. The editing of a string is what was giving my real code errors so i tryed to represent it here. I have since figured out ( i think) my original problem, which was the new LPTSTR being made by the external function was going out of scope as FakeMain() returns."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432757453, "post_id": 30491259, "comment_id": 49062317, "body": "Wow thanks so much for your time.   If i understand correctly, your putting the messages into a FIFO type container. Then only modifying (popping from the FIFO) them when the mutex is unlocked. So the FIFO list never gets edited directly but only the message popped is getting edited. The mutex is not shared with the 2 threads but for the message handler only, the handler will say if the Get_MSG() can have a message or not. The threads will call Get_MSG() and will return when a message is available."}, {"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432757455, "post_id": 30491259, "comment_id": 49062323, "body": "The delete of the message is something i have looked over. If the message is a LPTSTR, would changing the LPTSTR essentially free the old string it originally pointed to?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432758844, "post_id": 30491259, "comment_id": 49063040, "body": "@ChrisEst Misinterpretation, but your interpretation sounds like a good way to run your task like a thread pool. I was concerned only with making certain that each thread got a guaranteed unique message that another thread can&#39;t overwrite. Let me see if I can clear that up."}, {"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432762041, "post_id": 30491259, "comment_id": 49064620, "body": "Thank you so very much for putting the time in to answer my question. Your code also explains some API question I had with threading too. This is a much cleaner way of doing it , I will implement this into my program. +1."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432762347, "post_id": 30491259, "comment_id": 49064761, "body": "@ChrisEst Not a problem. I&#39;ll be rewriting some old windows threading code now that I dug up how to do it better."}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": true, "score": 2, "last_activity_date": 1432762224, "last_edit_date": 1432762224, "creation_date": 1432754174, "answer_id": 30491259, "question_id": 30489891, "link": "https://stackoverflow.com/questions/30489891/mutex-not-correctly-used-continuation-of-past-questions/30491259#30491259", "title": "Mutex not correctly used? Continuation of past questions", "body": "<p>Don't use a mutex and don't share the memory. </p>\n\n<p>Brute force approach:</p>\n\n<p>All the sender needs to do is</p>\n\n<pre><code>Message msg = new Message(&lt;important information&gt;);\n// send msg\n</code></pre>\n\n<p>And in the receiving code,    </p>\n\n<pre><code>// use msg  \ndelete msg;\n</code></pre>\n\n<p>Very simple to write and use, but has a memory leak: if a message never gets serviced, it never gives back the RAM.  </p>\n\n<p>Better versions can get very complicated. Here is an outline for a simple one: </p>\n\n<pre><code>Create a pool of Messages\nAssign all messages to a FreeList\nCreate a mutex to protect FreeList\n</code></pre>\n\n<p>FreeList is a list of messages that are not currently being used. When a Message needs to be sent, the first Message is removed from FreeList and handed to the caller. The caller fills out Message with the information to be sent and then sends the Message.</p>\n\n<p>The receiver is responsible for returning the Message to FreeList .</p>\n\n<p>Add a few functions to manage FreeList</p>\n\n<pre><code>GetMsg &lt;changed to prevent collision with Windows GetMessage function&gt;\n    Message = NULL\n    acquire mutex\n    if FreeList not empty\n        remove Message from FreeList\n    release mutex\n    return message            \n\nReturnMsg\n    acquire mutex\n    Add Message to FreeList\n    release mutex\n</code></pre>\n\n<p>Sender is a bit more complicated</p>\n\n<pre><code>Message msg = GetMessage()\nIf msg not NULL\n    msg.set(&lt;important information&gt;);\n    std::thread temp(ThreadTest, msg);\n    temp.detatch\nelse\n    // log and handle &lt;- can be simple like abort or complicated like recover lost Messages\n</code></pre>\n\n<p>And receiver is still pretty simple</p>\n\n<pre><code>// use msg  \nReturnMessage(msg);\n</code></pre>\n\n<p>This has a cap on the memory leak and can make it easy to track which Messages never got returned (in pool, but not in FreeList) so you can attempt to track down which jobs got blocked or blown up. Fixing the lock or blow-up is another problem.</p>\n\n<p>OP had a good idea that I think I have about right. Here are the guts of a basic thread function. It hangs out in the background running until sent a terminate message. It blocks waiting for a message, consumes the message, and then puts it back in FreeList and blocks until another message arrives. </p>\n\n<pre><code>void threadfunc()\n{\n    MSG winmsg;\n    BOOL rval;\n\n    while (GetMessage(&amp;winmsg, (HWND__ *) -1, 0, 0) != -1)\n    {\n        Message * msg = (Message *)winmsg.wParam;\n        // do stuff with msg\n        ReturnMsg(msg);\n    }\n    // GetMessage failed. Find out why and try to recover or die gracefully\n}\n</code></pre>\n\n<p>It needs to be supported by something like</p>\n\n<pre><code>bool PostMsg(&lt;Important Information&gt;,\n             DWORD &amp; BackgroundThreadId)\n{\n    Message * msg = GetMsg();\n    if (msg != NULL)\n    {\n         msg.set(&lt;Important Information&gt;)\n        if (PostThreadMessage(BackgroundThreadId,\n                              WM_USER,\n                              (WPARAM) msg,\n                              0); != 0)\n        {\n            return true;\n        }\n        else\n        {\n            // failed. Find out why and try to recover or die gracefully\n            ReturnMsg(msg);\n            return false;\n        }\n    }\n    else\n    {\n        // out of free messages. Try to find out why\n    }\n}\n</code></pre>\n\n<p>PostMsg feeds Messages into the background thread's message queue. Messages come from the FreeList and only the FreeList needs mutex protection. More than one thread can be in use. <s>I don't think this can be done with std::thread since std::thread doesn't give access to the underlying thread handle</s> (Just checked, it can be done)  or the thread's message queue. It'as all based on Windows calls anyway, so forget about portability.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432757527, "post_id": 30492054, "comment_id": 49062367, "body": "You are correct! I will edit the code to fix this. Thank you."}], "tags": [], "owner": {"reputation": 3432, "user_id": 399436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0325de57bac5882c49e320af9851042?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/399436/mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1432756849, "creation_date": 1432756849, "answer_id": 30492054, "question_id": 30489891, "link": "https://stackoverflow.com/questions/30489891/mutex-not-correctly-used-continuation-of-past-questions/30492054#30492054", "title": "Mutex not correctly used? Continuation of past questions", "body": "<p>The lock call before the if statement does not have a matching unlock.\nAlso you have a potential deadlock if the main thread gets the mutex before the test thead. Also your last join is waiting on the wrong thread. As far as I can tell there is no reason to lock the mutex to do the join. Just do the join.</p>\n"}], "owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 30491259, "answer_count": 2, "score": 0, "last_activity_date": 1432762224, "creation_date": 1432749632, "last_edit_date": 1495542602, "question_id": 30489891, "link": "https://stackoverflow.com/questions/30489891/mutex-not-correctly-used-continuation-of-past-questions", "title": "Mutex not correctly used? Continuation of past questions", "body": "<p>I have a second question that is a continuation of this thread :  <a href=\"https://stackoverflow.com/questions/30487064/how-does-windows-pick-memory-for-threads\">How Does Windows Pick memory for threads?</a> </p>\n\n<pre><code>void ThreadTest(LPTSTR* Pointer, mutex* MutexPtr)\n{\n    MutexPtr-&gt;lock();   \n    wcout &lt;&lt; *Pointer &lt;&lt; endl;\n    MutexPtr-&gt;unlock();\n    return;\n}\nvoid FakeMain()\n{\n    mutex Mut;\n    mutex* MutPtr = &amp;Mut;\n    LPTSTR Image = L\"First String\";\n    LPTSTR* StrPointer = &amp;Image;\n    thread Test(ThreadTest, StrPointer, MutPtr);\n    MutPtr-&gt;lock();\n    if (true)\n    {\n\n        NewStringFunction(Image);\n        MutPtr-unlock() // Added with the comment of Mike\n        Test.join();        \n        LPTSTR* StrPointer = &amp;Image;        \n        thread Test(ThreadTest, StrPointer, MutPtr);                \n    }\n\n    MutPtr-&gt;lock();\n    Test.join();\n    MutPtr-&gt;unlock();\n    return;\n};\nvoid NewStringFunction(LPTSTR&amp; Image)\n{\n    LPTSTR TempString = L\"New String for new Thread\";\n    Image = TempString;\n    return;\n};\n</code></pre>\n\n<p>The Code above is emulates my code I am having issues with.\n The flow should be as follows:</p>\n\n<ul>\n<li>The FakeMain() initialized variables and sets a String;</li>\n<li>FakeMain then creates a thread for this string to be printed.</li>\n<li>New thread prints the string.</li>\n<li>The printing thread is destroyed and a new string is made by a separate external function.</li>\n<li>A new thread is made to print this new message</li>\n</ul>\n\n<p>I have an \"if\" statement because the real code has a thread being made inside an if statement, i wanted to make sure the memory allocation represented this.\nThe string is changed in a separate function because this is how the real code does this.\nI destroy the first thread because in the real code, the thread is displaying a window, which changes size, thus needs a new thread.</p>\n\n<p>From writing this code I feel my mutexs are not implemented correctly. This code is not giving string errors but I think the mutex is being over written by the thread (i think). Watching the memory as the program runs, the first thread instance may over write the mutex, I am not sure. The last mutex.lock() in the main thread is throwing an error. Am I using mutexes correctly? Is there a cleaner way I should be locking/stopping threads?</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1432758032, "post_id": 30489754, "comment_id": 49062646, "body": "Looks like your loop blocks the event loop. You don&#39;t show how these methods are getting called, so it&#39;s impossible to say how you should fix it."}], "answers": [{"comments": [{"owner": {"reputation": 17121, "user_id": 202919, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c98b750637d6114f5fd1893dbdfe1f39?s=128&d=identicon&r=PG", "display_name": "Venemo", "link": "https://stackoverflow.com/users/202919/venemo"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1432757979, "post_id": 30492309, "comment_id": 49062616, "body": "@hyde Yes, I said that in my answer."}, {"owner": {"reputation": 163, "user_id": 4640282, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/71449337d22d0e5ea4f603aef8c50e5b?s=128&d=identicon&r=PG&f=1", "display_name": "Natile", "link": "https://stackoverflow.com/users/4640282/natile"}, "edited": false, "score": 0, "creation_date": 1432758441, "post_id": 30492309, "comment_id": 49062852, "body": "so basically, i need to replace the while loop in : serial.waitForReadyRead() ? i also tried before the signsl option but no success. i had the same problem ..."}, {"owner": {"reputation": 163, "user_id": 4640282, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/71449337d22d0e5ea4f603aef8c50e5b?s=128&d=identicon&r=PG&f=1", "display_name": "Natile", "link": "https://stackoverflow.com/users/4640282/natile"}, "edited": false, "score": 0, "creation_date": 1432758687, "post_id": 30492309, "comment_id": 49062959, "body": "this is a gui program. i tried the signal &amp; slot mechanism but had the same problem. i send command to serial port but the code after the sending run before the slot executed. i updated the queue in the slot but couldnt get the values in the code comes after. what is the best practice for this use case?"}, {"owner": {"reputation": 17121, "user_id": 202919, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c98b750637d6114f5fd1893dbdfe1f39?s=128&d=identicon&r=PG", "display_name": "Venemo", "link": "https://stackoverflow.com/users/202919/venemo"}, "reply_to_user": {"reputation": 163, "user_id": 4640282, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/71449337d22d0e5ea4f603aef8c50e5b?s=128&d=identicon&r=PG&f=1", "display_name": "Natile", "link": "https://stackoverflow.com/users/4640282/natile"}, "edited": false, "score": 0, "creation_date": 1432759331, "post_id": 30492309, "comment_id": 49063284, "body": "@NatiLerner I added more details to my answer."}, {"owner": {"reputation": 163, "user_id": 4640282, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/71449337d22d0e5ea4f603aef8c50e5b?s=128&d=identicon&r=PG&f=1", "display_name": "Natile", "link": "https://stackoverflow.com/users/4640282/natile"}, "edited": false, "score": 0, "creation_date": 1432799825, "post_id": 30492309, "comment_id": 49077155, "body": "I posted another question , appreciate if you take a look   <a href=\"http://stackoverflow.com/questions/30500236/handling-recieved-messages-from-serial-port-in-qt\" title=\"handling recieved messages from serial port in qt\">stackoverflow.com/questions/30500236/&hellip;</a>"}], "tags": [], "owner": {"reputation": 17121, "user_id": 202919, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c98b750637d6114f5fd1893dbdfe1f39?s=128&d=identicon&r=PG", "display_name": "Venemo", "link": "https://stackoverflow.com/users/202919/venemo"}, "is_accepted": true, "score": 3, "last_activity_date": 1432759657, "last_edit_date": 1432759657, "creation_date": 1432757734, "answer_id": 30492309, "question_id": 30489754, "link": "https://stackoverflow.com/questions/30489754/wait-for-data-arrive-from-serial-port-in-qt/30492309#30492309", "title": "wait for data arrive from serial port in Qt", "body": "<p>The <a href=\"http://doc.qt.io/qt-5/qserialport.html\" rel=\"nofollow\"><code>QSerialPort</code></a> class inherits from <a href=\"http://doc.qt.io/qt-5/qiodevice.html\" rel=\"nofollow\"><code>QIODevice</code></a> which has <code>waitFor...</code> methods that may be what you're looking for. Take a look at <a href=\"http://doc.qt.io/qt-5/qiodevice.html\" rel=\"nofollow\">these docs</a>.</p>\n\n<p>If you want to handle the serial port asynchronously, use the <code>readyRead</code> signal and perform reading in a function that you connected to that signal. If you don't mind that the operation is blocking, the <code>waitForReadyRead</code> function is what you're looking for.</p>\n\n<h2>The good way</h2>\n\n<p>Here's the proper way to do it using <a href=\"http://doc.qt.io/qt-5/signalsandslots.html\" rel=\"nofollow\">Qt's signals and slots mechanism</a>. This <strong>will not block</strong> your GUI and lets your application respond to user actions even while you are waiting for the serial port.</p>\n\n<ol>\n<li>Connect a function to the <code>bytesWritten</code> signal<br>\nThe code you want to execute after you sent data through the serial port should be placed in this function.</li>\n<li>Connect a function to the <code>readyRead</code> signal\nThe code you want to execute after you read some data from the serial port should be placed in this function.</li>\n<li>Open the port</li>\n</ol>\n\n<h2>The bad way</h2>\n\n<p>In some cases you can do it like this, but it's <strong>blocking</strong>, meaning that your GUI will freeze while your app is waiting for the serial port. I don't recommend doing it like this.</p>\n\n<ol>\n<li>Open the port</li>\n<li>Send data</li>\n<li>Call <code>waitForBytesWritten</code></li>\n<li>Call <code>waitForReadyRead</code></li>\n</ol>\n\n<h2>Working example code</h2>\n\n<p>Qt has a <a href=\"http://doc.qt.io/qt-5/qtexamplesandtutorials.html\" rel=\"nofollow\">vast amount of working example code</a>. There are even <a href=\"http://doc.qt.io/qt-5/qtserialport-examples.html\" rel=\"nofollow\">examples about how to use <code>QSerialPort</code></a>, and they are well worth checking out. You might be most interested in the <a href=\"http://doc.qt.io/qt-5/qtserialport-cwriterasync-example.html\" rel=\"nofollow\">async writer example</a> and the <a href=\"http://doc.qt.io/qt-5/qtserialport-creaderasync-example.html\" rel=\"nofollow\">async reader example</a>.</p>\n"}], "owner": {"reputation": 163, "user_id": 4640282, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/71449337d22d0e5ea4f603aef8c50e5b?s=128&d=identicon&r=PG&f=1", "display_name": "Natile", "link": "https://stackoverflow.com/users/4640282/natile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4013, "favorite_count": 0, "accepted_answer_id": 30492309, "answer_count": 1, "score": 0, "last_activity_date": 1432759657, "creation_date": 1432749175, "last_edit_date": 1432757484, "question_id": 30489754, "link": "https://stackoverflow.com/questions/30489754/wait-for-data-arrive-from-serial-port-in-qt", "title": "wait for data arrive from serial port in Qt", "body": "<p>I use serial port connection in my qt application.\nMy problem- I cant get back the control (or the values comes from the comm port) after sending the command.</p>\n\n<p>I have a class named serial.cpp which responsible to serial port connection.\nThis class contains 2 queues. one for save bytes from the comm port and second for the decoded messages. the class has the functions below:</p>\n\n<pre><code>void Serial::sendCommand(QString s)\n{\n    QString sometext = s;\n    QByteArray ba = QByteArray::fromHex(sometext.toLatin1());\n    serial-&gt;write(ba);\n}\n\nvoid Serial::serialReceived()\n{\n    QByteArray ba ;\n    serialArray = serial-&gt;readAll();\n    for (int i=0; i&lt;sizeof(serialArray);i++)\n    {\n        queueBytes.enqueue(serialArray[i]);  // queue for saving the bytes\n    }\n\n    QVector&lt;int&gt; vect = queueBytes.toVector();\n\n    packetSize = 6;\n    if (vect.size() &gt;= packetSize)\n    { // the whole packet arrived\n        for (int i =0 ;i&lt;packetSize;i++)\n        {\n            item = queueBytes.dequeue();\n            ba.append(item);\n        }\n    }\n    if (ba.toHex() == \"12ee02010176\")\n        queueMsgs.enqueue(\"ACK\");\n\n    // ... and so on\n}\n</code></pre>\n\n<p>here is the call class:</p>\n\n<pre><code>void Engine::onNewMessageFromAppReceived(int msgId,QString args)\n{\n    serial-&gt;sendCommand(\"ee1203190209005569\");\n\n    while (serial-&gt;queueMsgs.size() == 0) // infinite loop-the queue is always empty\n    {\n        usleep(1);\n    }\n\n    QVector&lt;QString&gt; vect2 = serial-&gt;queueMsgs.toVector();\n    qDebug() &lt;&lt; vect2 &lt;&lt; \"get ack---\" ;\n}\n</code></pre>\n\n<p>please your help</p>\n"}, {"tags": ["c++", "conditional-operator"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1432749511, "post_id": 30489726, "comment_id": 49057781, "body": "(1) The poor <code>aPtr == 0</code> ends the lifetime of <code>a</code> at the first <code>;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 3, "last_activity_date": 1432749329, "creation_date": 1432749329, "answer_id": 30489798, "question_id": 30489726, "link": "https://stackoverflow.com/questions/30489726/most-important-const-with-conditional-expression/30489798#30489798", "title": "&quot;Most important const&quot; with conditional expression?", "body": "<p>To the first, yes <code>a</code> is guaranteed to refer to a valid <code>MyClass</code> object. This comes directly from [class.temporary]/4-5:</p>\n\n<blockquote>\n  <p>There are two contexts in which temporaries are destroyed at a different point than the end of the fullexpression. The first context is when a default constructor is called [...]</p>\n  \n  <p>The second context is when a reference is bound to a temporary. The temporary to which the reference is\n  bound or the temporary that is the complete object of a subobject to which the reference is bound <strong>persists\n  for the lifetime of the reference</strong> except:</p>\n  \n  <ul>\n  <li>A temporary bound to a reference member in a constructor\u2019s <em>ctor-initializer</em> [...]</li>\n  <li>A temporary bound to a reference parameter in a function call [...]</li>\n  <li>The lifetime of a temporary bound to the returned value in a function return statement [...]</li>\n  <li>A temporary bound to a reference in a <em>new-initializer</em> [...]</li>\n  </ul>\n</blockquote>\n\n<p>None of those exceptions apply. </p>\n\n<p>If <code>aPtr</code> is a valid pointer, then a copy is made because the type of <code>aPtr ? *aPtr : MyClass{}</code> is just <code>MyClass</code>. That temporary gets bound to <code>a</code>, and <em>its</em> lifetime also persists for the same reason. </p>\n"}, {"comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 2, "creation_date": 1432749728, "post_id": 30489806, "comment_id": 49057903, "body": "And the workaround: <code>static MyClass default; a = *(aptr ? aptr : &amp;default);</code>"}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1432749854, "post_id": 30489806, "comment_id": 49057985, "body": "@MarkRansom Ah, I like that. And if default construction/destruction are expensive, then it&#39;s potentially more efficient than the original approach would have been anyway."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1432750857, "post_id": 30489806, "comment_id": 49058529, "body": "... and the &#39;usual life-time extension&#39; ends at the semicolon."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 2, "creation_date": 1432751114, "post_id": 30489806, "comment_id": 49058694, "body": "@DieterL&#252;cking No it doesn&#39;t, see my answer."}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": true, "score": 6, "last_activity_date": 1432751296, "last_edit_date": 1432751296, "creation_date": 1432749347, "answer_id": 30489806, "question_id": 30489726, "link": "https://stackoverflow.com/questions/30489726/most-important-const-with-conditional-expression/30489806#30489806", "title": "&quot;Most important const&quot; with conditional expression?", "body": "<p>Your conditional expression is a prvalue (because one of its operands is). If the first alternative of the conditional operator is selected, it is converted to a temporary (which incurs a copy). That temporary is bound to the reference, and the usual life-time extension applies.</p>\n\n<p>The relevant standardese [expr.cond]:</p>\n\n<blockquote>\n  <p>If the operands have class type, the result is a prvalue temporary of the result type, which is copy-initialized from either the second operand or the third operand depending on the value of the first operand.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1432757455, "post_id": 30490256, "comment_id": 49062322, "body": "1) <code>MyClass()</code> is a prvalue. 2) &quot;Value category&quot; is one of lvalue, xvalue and prvalue."}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1432758666, "post_id": 30490256, "comment_id": 49062950, "body": "@T.C. if a prvalue can&#39;t be on the left site of an assignment, why does <a href=\"http://ideone.com/ebiMfJ\" rel=\"nofollow noreferrer\">this</a> compile successfully ?  i&#39;d just like to be sure because I&#39;m always hesitant about xvalues."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 2, "creation_date": 1432759581, "post_id": 30490256, "comment_id": 49063393, "body": "Who said that prvalues can&#39;t be on the lhs of an assignment? Only the built-in assignment operator requires a modifiable lvalue as its left operand."}], "tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 1, "last_activity_date": 1432760589, "last_edit_date": 1592644375, "creation_date": 1432750808, "answer_id": 30490256, "question_id": 30489726, "link": "https://stackoverflow.com/questions/30489726/most-important-const-with-conditional-expression/30490256#30490256", "title": "&quot;Most important const&quot; with conditional expression?", "body": "<p>About 1) See kerek's answer above</p>\n<p>About 2) The standard says about conditional operator:</p>\n<blockquote>\n<p><strong>5.16/4:</strong> If the second and third operands are glvalues of the <strong>same value category</strong> and have the <strong>same type</strong>, the result is of that type and value category (...).</p>\n<p><strong>5.16/5:</strong> Otherwise, the result is a prvalue. (...)</p>\n</blockquote>\n<p>According to the taxonomy of lvalues and rvalues in <strong>3.10/1</strong>, <code>*aPtr</code> is an lvalue ,  <code>MyClass()</code> is an prvalue .  Hence the result should be a prvalue so that the reference should refer to this temporary (potentially a copy constructed temp).</p>\n<p><strong>Edit:</strong> Here an <strong><a href=\"http://ideone.com/Fv5NZT\" rel=\"nofollow noreferrer\">online demo</a></strong>,  which shows that the const reference refers to a temporary and not to the original object pointed to by aPtr.</p>\n"}], "owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 30489806, "answer_count": 3, "score": 11, "last_activity_date": 1432767829, "creation_date": 1432749103, "last_edit_date": 1432767829, "question_id": 30489726, "link": "https://stackoverflow.com/questions/30489726/most-important-const-with-conditional-expression", "title": "&quot;Most important const&quot; with conditional expression?", "body": "<p>Consider the following code:</p>\n\n<pre><code>int foo(MyClass const* aPtr = 0) {\n    MyClass const&amp; a = aPtr ? *aPtr : MyClass(); // Either bind to *aPtr, or to a default-constructed MyClass\n    ...\n    return a.bar();\n}\n</code></pre>\n\n<p>The <a href=\"http://herbsutter.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/\">\"most important const\"</a> is, hopefully, being used here. The aim is to allow for a null <code>aPtr</code> to be passed in (BTW, yes, it must be a pointer argument), in which case a temporary <code>MyClass</code> object would be default-constructed, and its lifetime extended by a const reference binding to it. Whereas, if <code>aPtr</code> was not null, the reference would bind to its pointed-to object without any (expensive) copy construction happening.</p>\n\n<p>The questions two are:</p>\n\n<ol>\n<li>If <code>aPtr == 0</code>, is <code>a</code> guaranteed to refer to a valid <code>MyClass</code> object until the end of the function?</li>\n<li>If <code>aPtr != 0</code>, will <code>a</code> bind to it, rather than to some other <code>MyClass</code>?</li>\n</ol>\n\n<p>Based on testing, the answer to 1 is almost certainly \"yes\". #2 I'm not so sure about, though (copy elision and such)... it seems possible that the conditional expression would end up copy-constructing a temporary <code>MyClass</code> from <code>*aPtr</code>, and extending the life of <em>that</em> temporary.</p>\n"}, {"tags": ["c++", "command-line", "shellexecuteex"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1432753756, "post_id": 30489679, "comment_id": 49060157, "body": "So you want to gather data the executed program sent to its <code>stdout</code> and reap it for your own nefarious purposes. Is that about right? If so, I sincerely wish you the best of luck in <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682499%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">deciphering this article</a>. And pay close attention to the comments. There are <i>plenty</i> that are relevant."}, {"owner": {"reputation": 1641, "user_id": 1564566, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/48f2c3de6f1409bd67dd1feb1393e8be?s=128&d=identicon&r=PG", "display_name": "TruthOf42", "link": "https://stackoverflow.com/users/1564566/truthof42"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1432753891, "post_id": 30489679, "comment_id": 49060222, "body": "Yes? I don&#39;t want to stop it from doing that, I just want to see what it is? Is this like a huge security hole? If so, what are my alternatives?"}], "owner": {"reputation": 1641, "user_id": 1564566, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/48f2c3de6f1409bd67dd1feb1393e8be?s=128&d=identicon&r=PG", "display_name": "TruthOf42", "link": "https://stackoverflow.com/users/1564566/truthof42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1432748983, "creation_date": 1432748983, "question_id": 30489679, "link": "https://stackoverflow.com/questions/30489679/how-can-i-get-return-data-when-using-command-line-commands", "title": "How can I get return data when using command line commands?", "body": "<p>I inherited a c++ application that runs some commands using 'ShellExecuteEx', specifically using appcmd.exe. I would like to be able to run the command and then get the return data as I would see it if I ran it from the commandline.</p>\n\n<p>I don't necessarily want to use ShellExecuteEx, but if I don't use that I need to run something pretty simple, as I am not used to c++ programming. My background is more of C# and similar languages.</p>\n"}, {"tags": ["c++", "c++11", "vector"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 3, "creation_date": 1432748738, "post_id": 30489588, "comment_id": 49057358, "body": "Step 1: Indent your code sanely. Use the live preview to verify that the code is readable before you hit submit."}], "answers": [{"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432751870, "post_id": 30489853, "comment_id": 49059115, "body": "This is indeed the problem. Simple typo."}, {"owner": {"reputation": 1, "user_id": 4945923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5877cd97ac69e8ea741a2666db19767?s=128&d=identicon&r=PG&f=1", "display_name": "Magnys75", "link": "https://stackoverflow.com/users/4945923/magnys75"}, "edited": false, "score": 0, "creation_date": 1432767988, "post_id": 30489853, "comment_id": 49066764, "body": "I guess this is where I&#39;m stuck. The video we watched had that as the loop statement and it worked in the video...not sure what it &quot;should&quot; be. Any other help would be fantastic."}, {"owner": {"reputation": 146, "user_id": 4201978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b30a3bcc5855557108d9cf93c70476b?s=128&d=identicon&r=PG&f=1", "display_name": "rds504", "link": "https://stackoverflow.com/users/4201978/rds504"}, "edited": false, "score": 0, "creation_date": 1432794742, "post_id": 30489853, "comment_id": 49074273, "body": "It looks like you are trying to compare those values, but you are not. Have a look at <a href=\"http://en.wikipedia.org/wiki/Operators_in_C_and_C%2B%2B\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Operators_in_C_and_C%2B%2B</a>."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1432857220, "post_id": 30489853, "comment_id": 49112766, "body": "It should be <code>for (int i = 0; i &lt; studentVector.size(); i++)</code>.  If the video had <code>&lt;&lt;</code> instead of <code>&lt;</code> then the video is incorrect."}], "tags": [], "owner": {"reputation": 146, "user_id": 4201978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b30a3bcc5855557108d9cf93c70476b?s=128&d=identicon&r=PG&f=1", "display_name": "rds504", "link": "https://stackoverflow.com/users/4201978/rds504"}, "is_accepted": false, "score": 5, "last_activity_date": 1432749518, "creation_date": 1432749518, "answer_id": 30489853, "question_id": 30489588, "link": "https://stackoverflow.com/questions/30489588/trouble-dispaying-names-with-vector-coding/30489853#30489853", "title": "Trouble dispaying names with Vector coding", "body": "<p>In the <code>for</code> loop where you display the names, did you really mean <code>i &lt;&lt; studentVector.size()</code>?</p>\n"}], "owner": {"reputation": 1, "user_id": 4945923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5877cd97ac69e8ea741a2666db19767?s=128&d=identicon&r=PG&f=1", "display_name": "Magnys75", "link": "https://stackoverflow.com/users/4945923/magnys75"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1432757638, "creation_date": 1432748675, "last_edit_date": 1432757638, "question_id": 30489588, "link": "https://stackoverflow.com/questions/30489588/trouble-dispaying-names-with-vector-coding", "title": "Trouble dispaying names with Vector coding", "body": "<p>Good afternoon.....I am currently a student in a C++ course and we are writing code for Vectors. In an assignment we have to display 3 student names. When I add the names after the following code is run it only displays the number of vectors and not the names (as is required). Any assistance is appreciated.</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n\nusing std::cout;\nusing std::cin;\nusing namespace std;\n\nint main()\n{\n    bool running = true;\n    char choice;\n    vector &lt;string&gt; studentVector;\n    cout &lt;&lt; \"My Student Vector\" &lt;&lt; endl;\n    while (running == true)\n    {\n        cout &lt;&lt; \"Choose a Selection: [A]dd Student, [V]iew Student, [R]emove      Student, [E]xit\" &lt;&lt; endl;\n        cin &gt;&gt; choice;\n        cin.ignore();\n\n        if (choice == 'A' || choice == 'a')\n        {\n            cout &lt;&lt; \"Enter Student's Name: \";\n            string tempVar;\n            getline(cin, tempVar);\n\n            studentVector.push_back(tempVar);\n        }\n        else if (choice == 'V' || choice == 'v')\n        {\n            cout &lt;&lt; \"You have \" &lt;&lt; studentVector.size() &lt;&lt; \"Student(s).\" &lt;&lt; endl;\n            for (int i = 0; i &lt;&lt; studentVector.size(); i++)\n            {\n                cout &lt;&lt; i &lt;&lt; \". \" &lt;&lt; studentVector.at(i) &lt;&lt; endl;\n            }\n        }\n        else if (choice == 'R' || choice == 'r')\n        {\n            int pos;\n            cout &lt;&lt; \"Enter the vector position for the student in question: \";\n            cin &gt;&gt; pos;\n            cin.ignore();\n\n            studentVector.erase(studentVector.begin() + pos);\n        }\n        else if (choice == 'E' || choice == 'e')\n        {\n            running = false;\n        }\n        else\n        {\n            cout &lt;&lt; \"Invalid Selection\" &lt;&lt; endl;\n        }\n    }\n</code></pre>\n"}, {"tags": ["c++", "arrays", "class", "constructor"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1432748458, "post_id": 30489480, "comment_id": 49057192, "body": "... by using <code>std::vector</code>."}], "answers": [{"tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": true, "score": 0, "last_activity_date": 1432748657, "creation_date": 1432748657, "answer_id": 30489586, "question_id": 30489480, "link": "https://stackoverflow.com/questions/30489480/how-to-make-deep-copy/30489586#30489586", "title": "How to make deep copy?", "body": "<p>Here is one possible solution: </p>\n\n<pre><code>VehicleRegistry::VehicleRegistry(const VehicleRegistry&amp; vr){\n    vehicles = new Vehicle[4];\n    copy (vr.vehicles, vr.vehicles+4, vechicles); \n    numvehicles = vr.numvehicles ;\n    maxsize = vr.maxsize ;\n}\n</code></pre>\n\n<p>Don't forget that if you have a deep copy,  you'll need as well a deep assignment operator. </p>\n\n<p>To understand the details, have a look at a tutorial, for example <a href=\"http://www.learncpp.com/cpp-tutorial/912-shallow-vs-deep-copying/\" rel=\"nofollow\">this one</a>. </p>\n\n<p>This being said, a <code>vector&lt;Vehicles&gt;</code> could be much simpler to manage. </p>\n"}], "owner": {"reputation": 35, "user_id": 4942378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ebc38bef7a15a7f9cb91e604b78f534?s=128&d=identicon&r=PG&f=1", "display_name": "VitalPotion", "link": "https://stackoverflow.com/users/4942378/vitalpotion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 30489586, "answer_count": 1, "score": -5, "last_activity_date": 1432748657, "creation_date": 1432748289, "question_id": 30489480, "link": "https://stackoverflow.com/questions/30489480/how-to-make-deep-copy", "title": "How to make deep copy?", "body": "<pre><code>VehicleRegistry::VehicleRegistry(){\n    vehicles = new Vehicle[4];\n    numvehicles = 0;\n    maxsize = 0;\n}\n\nVehicleRegistry::VehicleRegistry(const VehicleRegistry&amp; vr){\n\n}\n</code></pre>\n\n<p>How to make deep copy of that dynamic array?</p>\n"}, {"tags": ["c++", "priority-queue"], "answers": [{"comments": [{"owner": {"reputation": 20193, "user_id": 1779113, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbd338a5ff4a8feb86507a4dacddc05b?s=128&d=identicon&r=PG", "display_name": "nburk", "link": "https://stackoverflow.com/users/1779113/nburk"}, "edited": false, "score": 0, "creation_date": 1432748781, "post_id": 30489451, "comment_id": 49057385, "body": "thanks! the hint with using curly braces solved it!!"}], "tags": [], "owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "is_accepted": true, "score": 2, "last_activity_date": 1432748862, "last_edit_date": 1432748862, "creation_date": 1432748194, "answer_id": 30489451, "question_id": 30489390, "link": "https://stackoverflow.com/questions/30489390/getting-error-reference-to-non-static-member-function-must-be-called-when-call/30489451#30489451", "title": "Getting error &quot;reference to non-static member function must be called&quot; when calling push on priority queue", "body": "<p>Your </p>\n\n<pre><code>PayloadIndexPQ \npayloadIndexPQ( PayloadIndexComparison(&amp;currentAccumulatedPayloadIndexWeights) );\n</code></pre>\n\n<p>defines a function, not an object, see <a href=\"http://en.wikipedia.org/wiki/Most_vexing_parse\" rel=\"nofollow\">the most vexing parse</a>. Use <code>{</code> <code>}</code> instead</p>\n\n<pre><code>PayloadIndexPQ \npayloadIndexPQ{ PayloadIndexComparison(&amp;currentAccumulatedPayloadIndexWeights) };\n</code></pre>\n\n<p>The fact is that </p>\n\n<pre><code>PayloadIndexComparison(&amp;currentAccumulatedPayloadIndexWeights)\n</code></pre>\n\n<p>is considered a (functional) cast of <code>&amp;currentAccumulatedPayloadIndexWeights</code>, so the end result is that of defining a function taking a reference to a <code>PayloadIndexComparison</code>. It is like declaring </p>\n\n<pre><code>int f(int(&amp;x)); // declares basically void f(int&amp; x); and not an integer\n</code></pre>\n\n<p>See the link for more details.</p>\n"}, {"comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1432748447, "post_id": 30489490, "comment_id": 49057186, "body": "This is in a NSDMI, so you can&#39;t use the <code>()</code> form anyway. Extra pair of parens won&#39;t work."}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1432748480, "post_id": 30489490, "comment_id": 49057208, "body": "@T.C. Right, I thought the code was in a function. Let me correct that."}, {"owner": {"reputation": 226874, "user_id": 1983854, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/eKpAk.png?s=128&g=1", "display_name": "fedorqui &#39;SO stop harming&#39;", "link": "https://stackoverflow.com/users/1983854/fedorqui-so-stop-harming"}, "edited": false, "score": 0, "creation_date": 1432820717, "post_id": 30489490, "comment_id": 49092218, "body": "Hey note there is some discussion in Meta regarding you removing some good posts of yours : ) <a href=\"http://meta.stackoverflow.com/q/295422/\">User deleted helpful answers because of <code>Down for non-existent maintenance.</code>?</a>"}], "tags": [], "owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "is_accepted": false, "score": 3, "last_activity_date": 1432748709, "last_edit_date": 1432748709, "creation_date": 1432748319, "answer_id": 30489490, "question_id": 30489390, "link": "https://stackoverflow.com/questions/30489390/getting-error-reference-to-non-static-member-function-must-be-called-when-call/30489490#30489490", "title": "Getting error &quot;reference to non-static member function must be called&quot; when calling push on priority queue", "body": "<p>This line:</p>\n\n<pre><code>PayloadIndexPQ payloadIndexPQ(PayloadIndexComparison(&amp;currentAccumulatedPayloadIndexWeights));\n</code></pre>\n\n<p>is interpreted as a function declaration. It is a function named <code>playloadIndexPQ</code> that takes a reference to a <code>PayloadIndexComparision</code> object named <code>currentAccumulatedPayloadIndexWeights</code>.</p>\n\n<p>I know, it's pretty weird. But since you're in the class definition you can't declare variables using an expression list <code>(...)</code> anyway. You can declare the variable and initialize it in the <em>ctor-initializer</em> of a default-constructor.</p>\n\n<pre><code>struct MappingTechnique {\n    MappingTechnique() : payloadIndexPQ(PayloadIndexComparison(&amp;currentAccumulatedPayloadIndexWeights))\n    { }\n    // ...\n};\n</code></pre>\n\n<p>In C++11 you have two extra options. You can have a brace-or-equal initializer so that the data member can be defined where it is declared:</p>\n\n<pre><code>PayloadIndexPQ payloadIndexPQ = PayloadIndexComparison(&amp;currentAccumulatedPayloadIndexWeights);\n// or PayloadIndexPQ payloadIndexPQ{ ... }\n</code></pre>\n"}], "owner": {"reputation": 20193, "user_id": 1779113, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbd338a5ff4a8feb86507a4dacddc05b?s=128&d=identicon&r=PG", "display_name": "nburk", "link": "https://stackoverflow.com/users/1779113/nburk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 30489451, "answer_count": 2, "score": 2, "last_activity_date": 1432748862, "creation_date": 1432747981, "question_id": 30489390, "link": "https://stackoverflow.com/questions/30489390/getting-error-reference-to-non-static-member-function-must-be-called-when-call", "title": "Getting error &quot;reference to non-static member function must be called&quot; when calling push on priority queue", "body": "<p>This might be an obvious issue but being a novice to C++ I'm not quite sure why this error occurs.</p>\n\n<p>I have the following setup, I use a <code>priority_queue</code> that I typedef like this:</p>\n\n<pre><code>typedef priority_queue&lt;int,vector&lt;int&gt;,PayloadIndexComparison&gt; PayloadIndexPQ; \n</code></pre>\n\n<p>Then, I have a class that is using this priority queue:</p>\n\n<pre><code>struct MappingTechnique {\n\n   vector&lt;double&gt; currentAccumulatedPayloadIndexWeights;\n   PayloadIndexPQ payloadIndexPQ(PayloadIndexComparison(&amp;currentAccumulatedPayloadIndexWeights));\n\n   MappingTechnique() {\n      for (int i = 0; i &lt; PAYLOAD_SIZE; i++) {\n         payloadIndexPQ.push(i); // this line gives an error\n      }\n   }\n}\n</code></pre>\n\n<p>This code however gives the following error:</p>\n\n<blockquote>\n  <p>error: <strong>reference to non-static member function must be called</strong><br>\n  <code>payloadIndexPQ.push(i);</code></p>\n</blockquote>\n\n<p>Does anybody know why this happens? I used the the same priority queue in code elsewhere and could call <code>push</code> without problems, so I suspect that it's due to the fact that I am calling this within the constructor... </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1432748154, "post_id": 30489381, "comment_id": 49057031, "body": "Please have a nice try and error session with the debugger (Also: do not forget to check the stream state)"}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1432748264, "post_id": 30489381, "comment_id": 49057108, "body": "Any method you use is going to use a loop, at some level. Maybe you&#39;re not using a loop in your own code, but the code you call into will be. What is your problem with loops?"}, {"owner": {"reputation": 18045, "user_id": 3320135, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5b91a6e8e17f4a5da0c1aecb6135a91?s=128&d=identicon&r=PG&f=1", "display_name": "Karnivaurus", "link": "https://stackoverflow.com/users/3320135/karnivaurus"}, "edited": false, "score": 0, "creation_date": 1432748393, "post_id": 30489381, "comment_id": 49057170, "body": "Well normally with binary code, I could just set an address to read from, and the number of bytes to read, and it will just read the file all in one. In this case, it would not seem very elegant to loop through and load each byte individually."}], "answers": [{"comments": [{"owner": {"reputation": 2249, "user_id": 5162426, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/87ad09f80bf6b32bbbbdbc4930475607?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/5162426/anonymous"}, "edited": false, "score": 0, "creation_date": 1528821940, "post_id": 30489535, "comment_id": 88649059, "body": "What if <code>v</code> needs to be initialized beyond the scope of the file being opened? How can you replace the last line to instead place the return of the iterator into an already created vector?"}, {"owner": {"reputation": 2249, "user_id": 5162426, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/87ad09f80bf6b32bbbbdbc4930475607?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/5162426/anonymous"}, "edited": false, "score": 0, "creation_date": 1528822418, "post_id": 30489535, "comment_id": 88649189, "body": "I&#39;m going to add an edit to address my question, but please change it to something more elegant if possible"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 2249, "user_id": 5162426, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/87ad09f80bf6b32bbbbdbc4930475607?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/5162426/anonymous"}, "edited": false, "score": 0, "creation_date": 1528837889, "post_id": 30489535, "comment_id": 88656597, "body": "@Anonymous: That&#39;s not hard: <code>std::vector&lt;int&gt; v; { std::ifstream f(&quot;data.txt&quot;); v.assign(std::istream_iterator&lt;int&gt;(f), {}); }</code>"}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": true, "score": 2, "last_activity_date": 1432748480, "creation_date": 1432748480, "answer_id": 30489535, "question_id": 30489381, "link": "https://stackoverflow.com/questions/30489381/reading-an-ascii-file-with-fstream/30489535#30489535", "title": "Reading an ASCII file with fstream", "body": "<p>No raw loops!</p>\n\n<p>Reading the entire file:</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iterator&gt;\n#include &lt;vector&gt;\n\nint main()\n{\n    std::ifstream f(\"data.txt\");\n    std::vector&lt;int&gt; v(std::istream_iterator&lt;int&gt;(f), {});\n</code></pre>\n\n<p>Skipping over the first three:</p>\n\n<pre><code>   v.erase(v.begin(), v.begin() + 3);\n</code></pre>\n"}], "owner": {"reputation": 18045, "user_id": 3320135, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5b91a6e8e17f4a5da0c1aecb6135a91?s=128&d=identicon&r=PG&f=1", "display_name": "Karnivaurus", "link": "https://stackoverflow.com/users/3320135/karnivaurus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1494, "favorite_count": 0, "accepted_answer_id": 30489535, "answer_count": 1, "score": 1, "last_activity_date": 1432748480, "creation_date": 1432747932, "question_id": 30489381, "link": "https://stackoverflow.com/questions/30489381/reading-an-ascii-file-with-fstream", "title": "Reading an ASCII file with fstream", "body": "<p>Have an ASCII text file with some integer numbers in it, each separated by a space, and sometimes the numbers go on to a new line. For example:</p>\n\n<pre><code>// my_file.txt\n23 45 973 49\n44 1032 33 99\n43 8 4 90824\n</code></pre>\n\n<p>I want to read 100 of these numbers into an array of \"ints\". Thus far, I have the following code:</p>\n\n<pre><code>int x[100];\nfstream file_in(\"my_file.txt\", ios::in);\nfor (int i = 0; i &lt; 100; i++)\n{\n    file_in &gt;&gt; x[i];\n}\n</code></pre>\n\n<p>However, I now want to do a couple of other things that I am not sure about.</p>\n\n<ol>\n<li><p>What if I want to just read the entire file in, without having to go through the loop? If this was binary data, I know that I can just write <code>file_in.read((char*)&amp;x[0], 100 * sizeof(int))</code>. But how can I do this with an ASCII file?</p></li>\n<li><p>What if I want to skip the first 3 numbers in the file, and start reading from the fourth? Again, if this was binary data, I could just use <code>file_in.seekg(3 * sizeof(char))</code>. But I don't know how to skip in an ASCII file.</p></li>\n</ol>\n"}, {"tags": ["c++", "static", "constants", "getter"], "answers": [{"comments": [{"owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "edited": false, "score": 2, "creation_date": 1432748733, "post_id": 30489435, "comment_id": 49057356, "body": "Just to mention that <i>if</i> the function would be <i>constexpr</i>, the second example would be fine"}], "tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": true, "score": 1, "last_activity_date": 1432748139, "creation_date": 1432748139, "answer_id": 30489435, "question_id": 30489361, "link": "https://stackoverflow.com/questions/30489361/using-const-getter-style-functions-in-place-of-static-data-members/30489435#30489435", "title": "Using const getter-style functions in place of static data members", "body": "<p>There is one thing which the static member gives you that the function does not: if the value is present in the class definition like you've shown, it can be used as a <em>constant expression</em> (such as an array bound or a template argument). In other words, this is legal:</p>\n\n<pre><code>std::array&lt;int, Class::maximum_hp_static_memer&gt; a;\n</code></pre>\n\n<p>while this is not:</p>\n\n<pre><code>std::array&lt;int, c.maximum_hp_function()&gt; a;\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 3841300, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5b896a4ed571b99e899f99e4e77ec484?s=128&d=identicon&r=PG&f=1", "display_name": "Bluejay", "link": "https://stackoverflow.com/users/3841300/bluejay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 30489435, "answer_count": 1, "score": 1, "last_activity_date": 1432748139, "creation_date": 1432747822, "question_id": 30489361, "link": "https://stackoverflow.com/questions/30489361/using-const-getter-style-functions-in-place-of-static-data-members", "title": "Using const getter-style functions in place of static data members", "body": "<p>A very simple thought that got me wondering: is there anything to be gained from using the following in a class:</p>\n\n<pre><code>static const int maximum_hp{10};\n</code></pre>\n\n<p>Rather than</p>\n\n<pre><code>int maximum_hp() const{return 10;};\n</code></pre>\n\n<p>...?</p>\n\n<p>As far as I can see, the first way makes it easier to override the value of maximum_hp if needed in child classes (by declaring it virtual, of course); static data members cannot be modified, however. For constant primitive types, it seems, to me, to be a better way to go about it.</p>\n"}, {"tags": ["c++", "file", "loops", "types", "text-files"], "comments": [{"owner": {"reputation": 2493, "user_id": 4866989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ea9d94abae12663ba3ad2564619081?s=128&d=identicon&r=PG&f=1", "display_name": "Tim3880", "link": "https://stackoverflow.com/users/4866989/tim3880"}, "edited": false, "score": 1, "creation_date": 1432748237, "post_id": 30489286, "comment_id": 49057083, "body": "For this kind of input, I would read the whole line as string then parse it to separated variables (structures)."}, {"owner": {"reputation": 1, "user_id": 3677752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5c9120cd2b408351432941d75010aeb?s=128&d=identicon&r=PG&f=1", "display_name": "user3677752", "link": "https://stackoverflow.com/users/3677752/user3677752"}, "reply_to_user": {"reputation": 2493, "user_id": 4866989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ea9d94abae12663ba3ad2564619081?s=128&d=identicon&r=PG&f=1", "display_name": "Tim3880", "link": "https://stackoverflow.com/users/4866989/tim3880"}, "edited": false, "score": 0, "creation_date": 1432748607, "post_id": 30489286, "comment_id": 49057280, "body": "Hi Tim, can you give an example of reading a line as string and putting it in different variables? I thought about doing something like this but I was not really sure how to do it, and don&#39;t know how to convert string to int. Thank You."}, {"owner": {"reputation": 2493, "user_id": 4866989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ea9d94abae12663ba3ad2564619081?s=128&d=identicon&r=PG&f=1", "display_name": "Tim3880", "link": "https://stackoverflow.com/users/4866989/tim3880"}, "edited": false, "score": 1, "creation_date": 1432748871, "post_id": 30489286, "comment_id": 49057443, "body": "Sorry i don&#39;t have an example  here. Use getline to read the line as string, and use boost::split to split the line into a vector of strings, scan each elements in the vector and convert them to proper type and destination."}], "answers": [{"tags": [], "owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "is_accepted": false, "score": 0, "last_activity_date": 1432757619, "creation_date": 1432757619, "answer_id": 30492284, "question_id": 30489286, "link": "https://stackoverflow.com/questions/30489286/loading-different-data-types-from-text-file/30492284#30492284", "title": "Loading different data types from text file", "body": "<p>It looks like you are clobbering data.  Your struct allocates only one model and one version, but the i index takes values of 0 and 1.  The second time these are meant to be read in, the address is overwriting your coin counts.</p>\n"}], "owner": {"reputation": 1, "user_id": 3677752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5c9120cd2b408351432941d75010aeb?s=128&d=identicon&r=PG&f=1", "display_name": "user3677752", "link": "https://stackoverflow.com/users/3677752/user3677752"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447861980, "creation_date": 1432747550, "last_edit_date": 1447861980, "question_id": 30489286, "link": "https://stackoverflow.com/questions/30489286/loading-different-data-types-from-text-file", "title": "Loading different data types from text file", "body": "<p>I'm new to StackExchange and C++, so apologies if I don't describe the problem well enough. I need some help with homework.\nI'm trying to find a way to load this file and store its data. The file has different data types so what I came up with so far was to use struct array to store all the values, using a triple nested for loop to save the data in the correct variable.</p>\n\n<p>Here is what the .dat file looks like, with \"comments\" to help describe what's going on.</p>\n\n<pre><code>100A 2     // model number, 2 different versions of that model\n\n0 0 0      // number of quarters, dimes, and nickels\n\n5          //number of items in the vending machine\n\n1A 1034  5 // Code combonation, ID Number, Quantity\n\n1B 1000 10\n\n1C 1100 10\n\n1D 1123 20\n\n1E 1222  5\n\n0 0 0      // number of quarter, dimes, nickels in 2nd model\n\n7          // number of items in the second version of that model\n\n1A 2180 20\n\n1B 1283 20\n\n1C 3629  5\n\n1D 3649  3\n\n1E 4051 15\n\n1F 4211  1\n\n1G 5318  5\n\n100B 3     // New model, with 3 different versions of itself.\n\n2 10 5     //everything repeats like model 100A\n\n7 \n</code></pre>\n\n<p>Here is the code I came up with</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nstruct VMdata\n {\n    ifstream inFile;\n    string model[1];\n    int version[1];\n    int q[5];\n    int d[5];\n    int n[5];\n    int size[5];\n    string id[30];\n    int code[30];\n    int num[30];\n    char dummy;\n};\n\nint main()\n{\n\n    VMdata New;\n\n    cout &lt;&lt; fixed &lt;&lt; setprecision(2) &lt;&lt; showpoint;\n\n    New.inFile.open(\"machines.dat\");\n\n\n\n    cout &lt;&lt; \"Model Data\" \n           &lt;&lt; endl   &lt;&lt; endl;      \n\n\n\n    int count1 = 0;\n    int count2= 0;\n    int count3 = 0;\n    for (int i = 0; i &lt; 2; i ++)\n    {\n        cout &lt;&lt; \"i :\" &lt;&lt; count1 &lt;&lt; endl;\n       New.inFile &gt;&gt; New.model[i] &gt;&gt; New.version[i]; // loads model number and number of versions i times\n       count1 = count1 + 1;\n       for (int j = 0; j &lt; New.version[count1 -1]; j ++)\n       {\n           cout &lt;&lt;\"j :\" &lt;&lt; count2 &lt;&lt; endl;\n       New.inFile &gt;&gt; New.q[count2] &gt;&gt; New.d[count2] &gt;&gt; New.n[count2]  &gt;&gt; New.size[count2]; // loads number of q, d, n, j times\n       count2 = count2 + 1;\n       for (int k = 0; k &lt; New.size[count2 - 1]; k++)\n        {\n            cout &lt;&lt; \"k :\" &lt;&lt; count3 &lt;&lt; endl;\n           New.inFile &gt;&gt; New.id[count3] &gt;&gt; New.code[count3] &gt;&gt; New.num[count3]; // loads id number, code number, and total number k times\n           count3 = count3 + 1;\n        }\n\n       }\n    }\n    New.inFile.close();\n\n     count1 = 0;\n    count2= 0;\n    count3 = 0;\n    cout &lt;&lt; endl;\n\n        for ( int i = 0; i &lt; 2; i ++)\n    {\n       cout &lt;&lt; New.model[i]  &lt;&lt; setw(12) &lt;&lt; New.version[i] &lt;&lt; endl &lt;&lt; endl;\n        count1 = count1 + 1;\n       for (int j = 0; j &lt; New.version[count1 -1]; j ++)\n       {\n       cout &lt;&lt; New.q[count2] &lt;&lt; setw(12) &lt;&lt; New.d[count2] &lt;&lt; setw(12) &lt;&lt; New.n[count2] &lt;&lt; endl &lt;&lt; setw(12) &lt;&lt; New.size[count2] &lt;&lt; endl;\n      count2 = count2 + 1;\n       for (int k = 0; k &lt; New.size[count2 - 1]; k++)\n        {\n           cout &lt;&lt; New.id[count3] &lt;&lt; setw(12) &lt;&lt; New.code[count3] &lt;&lt; setw(12) &lt;&lt; New.num[count3] &lt;&lt; endl &lt;&lt; endl;\n           count3 = count3 + 1;\n        }\n\n       }\n    }\n\n\n\n      return 0;\n}\n</code></pre>\n\n<p>Here is my test output.</p>\n\n<pre><code>100A           2\n\n3          15           0 // should be 0, 0, 0\n\n 5\n\n1A        1034           5\n\n1B        1000          10\n\n1C        1100          10\n\n1D        1123          20\n\n1E        1222           5\n\n0           0           0\n\n  7\n\n1A        2180          20\n\n1B        1283          20\n\n1C        3629           5\n\n1D        3649           3\n\n1E        4051          15\n\n1F        4211           1\n\n1G        5318           5\n\n\u2665       \u263b            3 // the heart and smile should be 100B lol\n\n2          10           5\n\n  7\n\n1A        2180          10\n\n1B        1283          10\n\n1C        3629           5\n\n1D        3649           3\n\n1E        4051          15\n\n1F        4211          10\n\n1G        3026           5\n\n5           6           3\n\n  6\n\n1A        6626           5\n\n1B        6155           5\n\n1C        5982          10\n\n1D        5573           3\n\n1E        5454          10\n\n1F        5336          50\n\n10          10          10\n\n 5\n\n1A        1034           5\n\n1B        1000           5\n\n1C        1100           5\n\n1D        1123           5\n\n1E        1210          12\n\nPress any key to continue . . .\n</code></pre>\n\n<p>As you can see, the number of quarters, dimes, and nickels is wrong for the first machine, and the model name is wrong for the 2nd model.\nIf anyone has any suggestions it would be much appreciated.</p>\n"}, {"tags": ["c++", "mysql"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1432747265, "post_id": 30489175, "comment_id": 49056553, "body": "do your fetching, cache into a data structure, then run your inserts separately after the fetching query has been closed?"}, {"owner": {"reputation": 345, "user_id": 4459834, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e509bcdd9dc4d01428d44f42ce222d51?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Paku", "link": "https://stackoverflow.com/users/4459834/paul-paku"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1432748034, "post_id": 30489175, "comment_id": 49056965, "body": "It&#39;s one of the solutions. But looking for something like storing the result set on kind of the stack, could be the mysql_store_result() do the trick but can not find any example on how to do it ..."}], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 4459834, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e509bcdd9dc4d01428d44f42ce222d51?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Paku", "link": "https://stackoverflow.com/users/4459834/paul-paku"}, "edited": false, "score": 0, "creation_date": 1432749458, "post_id": 30489673, "comment_id": 49057752, "body": "So it seems (from both answers) the only way is to build a temporary array/list/queue etc ..."}], "tags": [], "owner": {"reputation": 79883, "user_id": 205608, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/61eE0.png?s=128&g=1", "display_name": "O. Jones", "link": "https://stackoverflow.com/users/205608/o-jones"}, "is_accepted": true, "score": 1, "last_activity_date": 1432748977, "creation_date": 1432748977, "answer_id": 30489673, "question_id": 30489175, "link": "https://stackoverflow.com/questions/30489175/is-there-a-way-to-issue-next-like-insert-mysql-statment-inside-the-mysql-fetch/30489673#30489673", "title": "Is there a way to issue next (like INSERT) mysql statment inside the mysql_fetch_row() loop?", "body": "<p>You asked:</p>\n\n<blockquote>\n  <p>Should I create another connection? </p>\n</blockquote>\n\n<p>Yes, you can do this.</p>\n\n<blockquote>\n  <p>What about time/speed and resources then ?</p>\n</blockquote>\n\n<p>Not bad, as long as you don't close and reopen the second connection for every row.</p>\n\n<blockquote>\n  <p>Can I solve it (how??) with mysql_store_result() function ?</p>\n</blockquote>\n\n<p>You can loop over your first resultset and store all the results in an array in memory, then free it, then loop over the array doing your inserts.</p>\n\n<p>Have you considered that you could do this sort of thing instead?</p>\n\n<pre><code> INSERT INTO Table_B (x, y, z, a)\n SELECT x,y,z, x+y+z AS a\n   FROM table_a\n</code></pre>\n\n<p>If your required computations on the rows of table a can be represented in SQL you can do this in a single query.</p>\n"}], "owner": {"reputation": 345, "user_id": 4459834, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e509bcdd9dc4d01428d44f42ce222d51?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Paku", "link": "https://stackoverflow.com/users/4459834/paul-paku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 30489673, "answer_count": 1, "score": 0, "last_activity_date": 1432748977, "creation_date": 1432747164, "question_id": 30489175, "link": "https://stackoverflow.com/questions/30489175/is-there-a-way-to-issue-next-like-insert-mysql-statment-inside-the-mysql-fetch", "title": "Is there a way to issue next (like INSERT) mysql statment inside the mysql_fetch_row() loop?", "body": "<p>I have a problem as I would like to fill a table_B based on row(s) retrieved from table_A.</p>\n\n<pre><code>if (mysql_query(conn,\"Select X,Y,Z from table_A;\")) {\n        die_mysql_err();\n} \nelse \n{\n    res = mysql_use_result(conn);\n    while ((row = mysql_fetch_row(res)) != NULL) {\n\n             &gt;&gt; HERE I would like to INSERT some data into the table_B.\n    }\n    mysql_free_result(res);\n}\n</code></pre>\n\n<p>The error message is:</p>\n\n<pre><code> Commands out of sync; you can't run this command now\n</code></pre>\n\n<p>I understand the message but do not know what would be the best solution ..</p>\n\n<ul>\n<li>Should I create another connection? What about time/speed and resources then ?</li>\n<li>Can I solve it (how??) with mysql_store_result() function ?</li>\n</ul>\n\n<p>Both tables are in the same database.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 41100, "user_id": 1938163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/WV0Fi.png?s=128&g=1", "display_name": "Marco A.", "link": "https://stackoverflow.com/users/1938163/marco-a"}, "edited": false, "score": 1, "creation_date": 1432746879, "post_id": 30489052, "comment_id": 49056301, "body": "are you compiling this with C++11?"}, {"owner": {"reputation": 18613, "user_id": 818182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89b420763192c3b763f4cffa789fe39f?s=128&d=identicon&r=PG", "display_name": "Austin Brunkhorst", "link": "https://stackoverflow.com/users/818182/austin-brunkhorst"}, "edited": false, "score": 4, "creation_date": 1432746884, "post_id": 30489052, "comment_id": 49056306, "body": "Your last snippet is not correct. You cannot return a reference to a temporary object."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1432746925, "post_id": 30489052, "comment_id": 49056325, "body": "Search on here for &quot;NRVO&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 2, "creation_date": 1432746996, "post_id": 30489052, "comment_id": 49056372, "body": "Just copy by value. The returning will be optimized. Look up: Return value optimization (RVO), copy elision and move semantics."}, {"owner": {"reputation": 71857, "user_id": 47453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412dc332ab3593c636e5a5202cf98870?s=128&d=identicon&r=PG", "display_name": "Bill Lynch", "link": "https://stackoverflow.com/users/47453/bill-lynch"}, "edited": false, "score": 0, "creation_date": 1432747058, "post_id": 30489052, "comment_id": 49056413, "body": "For some additional information, see this duplicate as well: <a href=\"http://stackoverflow.com/questions/753312/returning-large-objects-in-functions\" title=\"returning large objects in functions\">stackoverflow.com/questions/753312/&hellip;</a>"}, {"owner": {"reputation": 41100, "user_id": 1938163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/WV0Fi.png?s=128&g=1", "display_name": "Marco A.", "link": "https://stackoverflow.com/users/1938163/marco-a"}, "reply_to_user": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "edited": false, "score": 0, "creation_date": 1432747118, "post_id": 30489052, "comment_id": 49056458, "body": "@merlin2011 the elements are created on the heap even if you didn&#39;t use &#39;new&#39; explicitly to instantiate the vector container"}, {"owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "reply_to_user": {"reputation": 41100, "user_id": 1938163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/WV0Fi.png?s=128&g=1", "display_name": "Marco A.", "link": "https://stackoverflow.com/users/1938163/marco-a"}, "edited": false, "score": 0, "creation_date": 1432747277, "post_id": 30489052, "comment_id": 49056559, "body": "@MarcoA., I thought he was referring to the container object itself. I think I misread the question."}], "owner": {"reputation": 18045, "user_id": 3320135, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5b91a6e8e17f4a5da0c1aecb6135a91?s=128&d=identicon&r=PG&f=1", "display_name": "Karnivaurus", "link": "https://stackoverflow.com/users/3320135/karnivaurus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 1, "closed_date": 1432747026, "answer_count": 0, "score": 0, "last_activity_date": 1432747151, "creation_date": 1432746764, "last_edit_date": 1432747151, "question_id": 30489052, "link": "https://stackoverflow.com/questions/30489052/return-a-large-stdvector-from-a-function", "closed_reason": "Duplicate", "title": "Return a large std::vector from a function", "body": "<p>In C++ 11, if I have a function that returns a <code>std::vector&lt;int&gt;</code> with a very large number of elements, does this return a deep or shallow copy of the vector which was originally created?</p>\n\n<p>E.g.</p>\n\n<pre><code>std::vector&lt;int&gt; GetVec()\n{\n    std::vector&lt;int&gt; bar(1000000);\n    // Fill in bar with numbers\n    return bar;\n};\n\nint main()\n{\n    std::vector&lt;int&gt; foo = GetVec();\n    return 0;\n}\n</code></pre>\n\n<p>Will <code>foo</code> be a deep copy of the entire contents of <code>bar</code>, or will it just be a reference to <code>bar</code>?</p>\n\n<p>My understanding is the C++ functions return copies, so in this case, how should I avoid having the make a costly copy of <code>bar</code> inside this function? I know that the elements of a <code>std::vector</code> are created on the heap, so I'm wondering if copying <code>bar</code> in the function creates a deep or shallow copy.</p>\n\n<p>One way would be to pass <code>foo</code> as an argument:</p>\n\n<pre><code>void GetVec(std::vector&lt;int&gt;&amp; bar)\n{\n    bar.resize(1000000);\n    // Fill in bar with numbers\n};\n</code></pre>\n\n<p>Another way would be to return by reference:</p>\n\n<pre><code>std::vector&lt;int&gt;&amp; GetVec()\n{\n    std::vector&lt;int&gt; bar(1000000);\n    // Fill in bar with numbers\n    return bar;\n};\n</code></pre>\n\n<p>But what's the best practice?</p>\n"}, {"tags": ["c++", "for-loop"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1432746661, "post_id": 30488995, "comment_id": 49056169, "body": "Paste the exact error message into your question."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1432746721, "post_id": 30488995, "comment_id": 49056202, "body": "Please clarify &quot;it doesn&#39;t work&quot;.  Provide, in your question, the expected result, the actual result and any relevant input data."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 2442423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0cad631c68a5898de9e90c6589933b73?s=128&d=identicon&r=PG", "display_name": "Richard Yang", "link": "https://stackoverflow.com/users/2442423/richard-yang"}, "edited": false, "score": 0, "creation_date": 1432746875, "post_id": 30489063, "comment_id": 49056297, "body": "Why does that occur exactly? I thought that the for loop contains everything within {}. Am I not able to nest for loops within eachother? What is a possible workaround"}, {"owner": {"reputation": 49, "user_id": 2442423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0cad631c68a5898de9e90c6589933b73?s=128&d=identicon&r=PG", "display_name": "Richard Yang", "link": "https://stackoverflow.com/users/2442423/richard-yang"}, "edited": false, "score": 0, "creation_date": 1432746924, "post_id": 30489063, "comment_id": 49056320, "body": "I feel like an idiot. All I did was forget the opening brace. Thanks!"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1432746958, "post_id": 30489063, "comment_id": 49056344, "body": "Good catch on the &#39;;&#39;.  I was fooled by the indentation."}, {"owner": {"reputation": 14673, "user_id": 296460, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FGDo8.jpg?s=128&g=1", "display_name": "shuttle87", "link": "https://stackoverflow.com/users/296460/shuttle87"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1432747000, "post_id": 30489063, "comment_id": 49056377, "body": "@ThomasMatthews I was too at first, which is exactly why many coding standards don&#39;t allow this type of for loop, it&#39;s hard to spot at a glance."}], "tags": [], "owner": {"reputation": 14673, "user_id": 296460, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FGDo8.jpg?s=128&g=1", "display_name": "shuttle87", "link": "https://stackoverflow.com/users/296460/shuttle87"}, "is_accepted": false, "score": 3, "last_activity_date": 1432746909, "last_edit_date": 1432746909, "creation_date": 1432746783, "answer_id": 30489063, "question_id": 30488995, "link": "https://stackoverflow.com/questions/30488995/name-lookup-of-a-changed-for-new-iso-for-scoping/30489063#30489063", "title": "name lookup of `a&#39; changed for new ISO `for&#39; scoping", "body": "<p>When you place a variable in a for loop it is defined only inside that for loop. So when you have:</p>\n\n<pre><code>for(int a = 0; a &lt; 500; a ++)\n    assets[a][0] = temp + temp2;\n</code></pre>\n\n<p>The for loop ends at the semicolon here and as such the variable <code>a</code> is now not in scope.</p>\n\n<p>What you need is your <code>for</code> loop to be enclosed with braces to avoid this. I'd suggest always using braces around for loops for this reason, my companies coding standards explicitly demand this to avoid running into the exact problem you encountered here.</p>\n"}, {"tags": [], "owner": {"reputation": 352, "user_id": 4828954, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/5d043df72ef86ef726ef5ead028bf6a3?s=128&d=identicon&r=PG&f=1", "display_name": "Ajv2324", "link": "https://stackoverflow.com/users/4828954/ajv2324"}, "is_accepted": true, "score": 2, "last_activity_date": 1432749237, "last_edit_date": 1432749237, "creation_date": 1432746922, "answer_id": 30489108, "question_id": 30488995, "link": "https://stackoverflow.com/questions/30488995/name-lookup-of-a-changed-for-new-iso-for-scoping/30489108#30489108", "title": "name lookup of `a&#39; changed for new ISO `for&#39; scoping", "body": "<p>I think you forgot the open brace (<code>{</code>) after the first <code>for</code> loop.</p>\n"}], "owner": {"reputation": 49, "user_id": 2442423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0cad631c68a5898de9e90c6589933b73?s=128&d=identicon&r=PG", "display_name": "Richard Yang", "link": "https://stackoverflow.com/users/2442423/richard-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "accepted_answer_id": 30489108, "answer_count": 2, "score": 1, "last_activity_date": 1432749237, "creation_date": 1432746577, "last_edit_date": 1432747112, "question_id": 30488995, "link": "https://stackoverflow.com/questions/30488995/name-lookup-of-a-changed-for-new-iso-for-scoping", "title": "name lookup of `a&#39; changed for new ISO `for&#39; scoping", "body": "<p>I am trying to troubleshoot this error I get in c++. I've looked at similar questions on StackOverflow, but I can't seem to find the error for my particular solution. I have no idea why it doesn't work, nested for loops work fine this way from my knowledge. Let me know if you have a solution.</p>\n\n<p>NOTE: This is just a code snippet. All variables are defined above. <strong>I get the error on line 7.</strong></p>\n\n<p>Here is the exact error message: </p>\n\n<pre><code>50 C:\\Users\\ryang\\Desktop\\check install\\Untitled1.cpp name lookup of `a' changed for new ISO `for' scoping\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>for(int a = 0; a &lt; 500; a ++)\n    assets[a][0] = temp + temp2;\n    for(int b = 1; b &lt; 6; b ++)\n    {\n          userAssets &gt;&gt; temp &gt;&gt; temp2;\n          if(temp == \"CorporateIT\")\n                  assets[a][b] = temp2;\n          else\n          {\n              numWorkstations[a] = b;\n              break;\n          }\n    }   \n}\n</code></pre>\n"}, {"tags": ["c++", "file", "binary"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1432746789, "post_id": 30488987, "comment_id": 49056242, "body": "Common failure: Not testing the stream state (or an unformatted input). Please get informed."}, {"owner": {"reputation": 348, "user_id": 4945792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ccc2ee99dab34679fb96f21c728bee?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Tkachenko", "link": "https://stackoverflow.com/users/4945792/bogdan-tkachenko"}, "edited": false, "score": 0, "creation_date": 1432747081, "post_id": 30488987, "comment_id": 49056433, "body": "i forgot add in cycle cout &lt;&lt; temp-&gt;town &lt;&lt; &quot;\\t&quot;; cout &lt;&lt; temp-&gt;code &lt;&lt; &quot;\\n&quot;;"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1432747176, "post_id": 30488987, "comment_id": 49056492, "body": "Not the actual issue but never use <code>!eof</code> to control a loop: <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 348, "user_id": 4945792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ccc2ee99dab34679fb96f21c728bee?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Tkachenko", "link": "https://stackoverflow.com/users/4945792/bogdan-tkachenko"}, "edited": false, "score": 0, "creation_date": 1432747697, "post_id": 30488987, "comment_id": 49056786, "body": "i guess that issue but when i add adittional logical function exmp while(!out.eof() &amp;&amp; x!=0) it works but when i work in program, when i use this function first time it crash program guess this issue is because my list is not declared"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1432749584, "post_id": 30488987, "comment_id": 49057831, "body": "@BogdanTkachenko ...or even <i>allocated</i>. Loading a linked list usually involves performing node allocations for the list <i>during</i> the load; not before."}], "owner": {"reputation": 348, "user_id": 4945792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ccc2ee99dab34679fb96f21c728bee?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Tkachenko", "link": "https://stackoverflow.com/users/4945792/bogdan-tkachenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1432747702, "creation_date": 1432746556, "last_edit_date": 1432747702, "question_id": 30488987, "link": "https://stackoverflow.com/questions/30488987/dynamic-list-reading-from-file-issues", "title": "dynamic list reading from file issues", "body": "<pre><code>struct list\n{\n    char town[30];\n    int code;\n    spisok *next,*head;\n};\n\nvoid reading(list *x)\n{\n    ifstream out(\"C:\\\\Users\\\\Tkachenko\\\\Desktop\\\\mp\\\\Lab_5\\\\file\",ios::binary);\n    if (out)\n    {\n        while(!out.eof())\n        {\n            out.read((char*)&amp;x-&gt;town,sizeof(x-&gt;town));\n            out.read((char*)&amp;x-&gt;code,sizeof(x-&gt;code));\n            x=x-&gt;next;\n        }\n        out.close();\n    }\n    else\n        cout &lt;&lt; \"\\n404 not found...\";\n}\n</code></pre>\n\n<p>I have issues with reading from a file. It writes additional lines that are repeats of previous lines. How can I fix that?</p>\n"}, {"tags": ["c++", "macos", "usb"], "comments": [{"owner": {"reputation": 190, "user_id": 2561930, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/285acceb9402e1e3e48944c9a343c56d?s=128&d=identicon&r=PG", "display_name": "Deqing", "link": "https://stackoverflow.com/users/2561930/deqing"}, "edited": false, "score": 0, "creation_date": 1435083681, "post_id": 30488811, "comment_id": 50047905, "body": "Have similar problem. I used USB4Java to do communication. pipe can not be opened until I print something with mac utility. Do you have any progress?"}, {"owner": {"reputation": 11, "user_id": 3554293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a6911d5e9f57ec98986a539921eca8?s=128&d=identicon&r=PG&f=1", "display_name": "user3554293", "link": "https://stackoverflow.com/users/3554293/user3554293"}, "reply_to_user": {"reputation": 190, "user_id": 2561930, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/285acceb9402e1e3e48944c9a343c56d?s=128&d=identicon&r=PG", "display_name": "Deqing", "link": "https://stackoverflow.com/users/2561930/deqing"}, "edited": false, "score": 0, "creation_date": 1435234609, "post_id": 30488811, "comment_id": 50121132, "body": "no, i was out of clues and looked for alternate options like building an interface on my own. Your observation may indicate that some kind of initialization is missing. I still don&#39;t know."}, {"owner": {"reputation": 190, "user_id": 2561930, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/285acceb9402e1e3e48944c9a343c56d?s=128&d=identicon&r=PG", "display_name": "Deqing", "link": "https://stackoverflow.com/users/2561930/deqing"}, "edited": false, "score": 0, "creation_date": 1435246933, "post_id": 30488811, "comment_id": 50131058, "body": "I haven&#39;t find a solution in USB. I gave up and use CUPS instead. Stock cups works well on Mavericks but Yosemite need usbtb. For me this is a solution for my thermal printer. Hope my repo helps. <a href=\"https://github.com/DeqingSun/XP-T58KC_On_Mac\" rel=\"nofollow noreferrer\">github.com/DeqingSun/XP-T58KC_On_Mac</a>"}], "owner": {"reputation": 11, "user_id": 3554293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a6911d5e9f57ec98986a539921eca8?s=128&d=identicon&r=PG&f=1", "display_name": "user3554293", "link": "https://stackoverflow.com/users/3554293/user3554293"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1432746011, "creation_date": 1432746011, "question_id": 30488811, "link": "https://stackoverflow.com/questions/30488811/sending-data-to-bulk-out-pipe-for-prolific-2305-always-immediately-stalls", "title": "sending data to bulk out pipe for prolific 2305 always immediately stalls", "body": "<p>i'm trying to connect an old printer with Centronics interface to my Mac running OS X via a USB-to-IEEE1284 adapter containing a Prolific 2305 IC. I closely follow the example at <a href=\"https://developer.apple.com/library/mac/documentation/DeviceDrivers/Conceptual/USBBook/USBDeviceInterfaces/USBDevInterfaces.html\" rel=\"nofollow\">Apple:USBDevInterfaces</a> using IOKit and CF \"classes\". I find the device, successfully select the only configuration, find the only interface, get printer status byte, open Bulk Out Pipe #1 all successfully, but when i write a single byte to the bulk out pipe it always returns with Pipe stalled error. (I actually have 2 printers and 2 interfaces for testing, the printers behave identically but i excluded one interface from testing because it even stalled on reading the printer status byte.)</p>\n\n<p>Q: Is there something more required to setup for a printing device than shown in the Apple example, e.g. for negotiating the port mode on the centronics interface?</p>\n\n<p>is there a better way for doing this? Unluckily there is no /dev/lp* created for the parallel port.</p>\n\n<p>Here are the most relevant parts from my source. In case more code is needed please ask or see <a href=\"http://k1.spdns.de/Develop/Projects/zxsp-osx/Source/Mac/UsbDevice.cpp\" rel=\"nofollow\">UsbDevice.cpp</a> (which contains some more superfluous stuff for my testing and understanding and the procedures below in reverse order.)</p>\n\n<p>Thanks for help.</p>\n\n<pre><code>void testProlific2305()\n{\n    // get device(s)\n\n    CFMutableDictionaryRef dict = newMatchingDictForService(service_USBDevice);\n    add(dict,key_VendorID,_prolific);\n    add(dict,key_ProductID,_ieee1284);\n\n    io_iterator_t iter = newIteratorForMatchingServices(dict);\n\n    // loop over all devices:\n\n    for(io_service_t device; (device = IOIteratorNext(iter)); IOObjectRelease(device))\n    {\n        cstr r = testProlific2305device(device);\n        if(r) LogLine(\"%s\",r);\n    }\n\n    IOObjectRelease(iter);\n}\n\ncstr testProlific2305device(io_service_t device)\n{\n    // note: general error codes in IOReturn.h\n    // usb error codes in USB.h line 360ff\n    IOReturn err;\n\n    // configure device to use configuration[0]:\n\n    MyIOUSBDeviceInterface** dev_if = newUSBDeviceInterfaceForDevice(device);\n    if(!dev_if) return \"dev_if = NULL\";\n\n    err = (*dev_if)-&gt;USBDeviceOpen(dev_if);\n    if(err) return usingstr(\"USBDeviceOpen: error 0x%08X\",(uint)err);\n\n    err = ConfigureDevice(dev_if, 0/*configuration_idx*/);\n    if(err) return usingstr(\"ConfigureDevice: error 0x%08X\",(uint)err);\n\n    // get interface(s):\n\n    IOUSBFindInterfaceRequest request;\n    request.bInterfaceClass    = kIOUSBFindInterfaceDontCare;\n    request.bInterfaceSubClass = kIOUSBFindInterfaceDontCare;\n    request.bInterfaceProtocol = kIOUSBFindInterfaceDontCare;\n    request.bAlternateSetting  = kIOUSBFindInterfaceDontCare;\n\n    io_iterator_t iterator;\n    err = (*dev_if)-&gt;CreateInterfaceIterator(dev_if, &amp;request, &amp;iterator);\n\n    // loop over all interfaces:\n\n    for(io_service_t interface; (interface = IOIteratorNext(iterator)); IOObjectRelease(interface))\n    {\n        MyIOUSBInterfaceInterface** if_if = newUSBDeviceInterfaceForInterface(interface);\n        if(!if_if) return \"if_if = NULL\";\n\n        cstr r = testProlific2305interface(dev_if,if_if);\n        if(r) LogLine(\"%s\",r);\n    }\n\n    err = (*dev_if)-&gt;USBDeviceClose(dev_if);\n    if(err) return usingstr(\"USBDeviceClose: error 0x%08X\",(uint)err);\n    //CFRelease(dev_if); dev_if=NULL;\n\n    return NULL;    // ok\n}\n\ncstr testProlific2305interface(MyIOUSBDeviceInterface** dev_if, MyIOUSBInterfaceInterface** if_if)\n{\n    IOReturn err;\n\n    //Get interface class and subclass:    should be 7, 1\n    uint8 interfaceClass, interfaceSubClass;\n    err = (*if_if)-&gt;GetInterfaceClass(if_if, &amp;interfaceClass);\n    err = (*if_if)-&gt;GetInterfaceSubClass(if_if, &amp;interfaceSubClass);\n    LogLine(\"Interface class %d, subclass %d\\n\", interfaceClass, interfaceSubClass);\n\n    // open interface:\n    err = (*if_if)-&gt;USBInterfaceOpen(if_if);\n    if(err) return usingstr(\"USBDeviceOpen returned error 0x%08X\", (uint)err);\n\n    // Get the number of endpoints associated with this interface\n    uint8 interfaceNumEndpoints;\n    err = (*if_if)-&gt;GetNumEndpoints(if_if, &amp;interfaceNumEndpoints);\n    if(err) return usingstr(\"GetNumEndpoints returned error 0x%08X\", (uint)err);\n    LogLine(\"interfaceNumEndpoints = %u\",interfaceNumEndpoints);\n\n    // Access each pipe in turn, starting with the pipe at index 1\n    // The pipe at index 0 is the default control pipe and should be\n    // accessed using (*usbDevice)-&gt;DeviceRequest() instead\n\n    for(int pipeRef = 1; pipeRef &lt;= interfaceNumEndpoints; pipeRef++)\n    {\n        cstr r = testProlific2305pipe(dev_if,if_if,pipeRef);\n        if(r) LogLine(\"%s\",r);\n    }\n\n    return NULL; // ok\n}\n\ncstr testProlific2305pipe(MyIOUSBDeviceInterface** dev_if, MyIOUSBInterfaceInterface** if_if, int pipe_idx)\n{\n    uint16    maxPacketSize;\n    uint8    direction, number, transferType, interval, status, interface_idx;\n    IOReturn err;\n\n    err = (*if_if)-&gt;GetPipeProperties(if_if,\n                                pipe_idx, &amp;direction,\n                                &amp;number, &amp;transferType,\n                                &amp;maxPacketSize, &amp;interval);\n    if(err) return usingstr(\"GetPipeProperties(%d) error: 0x%08X\", pipe_idx, err);\n\n    LogLine(\"Pipe %d: direction %s, transferType %s, maxPacketSize %d\",\n                                pipe_idx,\n                                usb_pipe_direction_str(direction),\n                                usp_pipe_transfertype_str(transferType),\n                                maxPacketSize);\n\n    err = (*if_if)-&gt;GetPipeStatus(if_if, pipe_idx);\n    if(err) return usingstr(\"GetPipeStatus error: 0x%08X\", (uint)err);\n\n    err = printerGetPortStatus(dev_if, interface_idx, &amp;status);\n    if(err) return usingstr(\"printerGetPortStatus error: 0x%08X\",(uint)err);\n    if(status!=0x18) LogLine(\"Printer status = 0x%02X\", status); // 0x18 = no error, selected, paper ok\n\n    cstr msg = \"0\";     // just 1 char\n    err = (*if_if)-&gt;WritePipe(if_if, pipe_idx, (void*)msg, strlen(msg)); \n\n// ****--&gt;  Here i always get error: 0xE00002ed device not responding\n\n    if(err)\n    {\n        LogLine(\"WritePipe: error 0x%08X\", (uint)err);\n\n        err = printerGetPortStatus(dev_if, 0/*interface*/, &amp;status);\n        if(err) LogLine(\"printerGetPortStatus error: 0x%08X\",(uint)err);\n        return \"bulk write to pipe failed\";\n    }\n    return NULL; // ok\n}\n\nIOReturn printerGetPortStatus(MyIOUSBDeviceInterface **dev, uint interface_idx, uint8* result)\n{\n    IOUSBDevRequest request;\n    request.bmRequestType = 0b10100001; \n    request.bRequest = 1;              \n    request.wValue = 0;\n    request.wIndex = interface_idx;\n    request.wLength = 1;\n    request.pData = result;\n\n    IOReturn err = (*dev)-&gt;DeviceRequest(dev, &amp;request);\n    XXXASSERT(err || request.wLenDone==1);\n    return err;\n}\n\nIOReturn ConfigureDevice(MyIOUSBDeviceInterface **dev, uint configuration_idx)\n{\n    uint8       num_configurations;\n    IOReturn    err;\n    IOUSBConfigurationDescriptorPtr configuration_descriptor;\n\n    // Get the number of configurations.\n    err = (*dev)-&gt;GetNumberOfConfigurations(dev, &amp;num_configurations);      XXXASSERT(!err);\n    if(configuration_idx &gt;= num_configurations) return error;\n\n    // Get the configuration descriptor\n    err = (*dev)-&gt;GetConfigurationDescriptorPtr(dev, configuration_idx, &amp;configuration_descriptor);\n    if(err) { LogLine(\"GetConfigurationDescriptorPtr: error = 0x%08X\", err); return err; }\n\n    // Set the device\u2019s configuration. The configuration value is found in\n    // the bConfigurationValue field of the configuration descriptor\n    err = (*dev)-&gt;SetConfiguration(dev, configuration_descriptor-&gt;bConfigurationValue);\n    if(err) { LogLine(\"SetConfiguration: error = 0x%08X\", err); return err; }\n\n    return ok;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1432746987, "post_id": 30488795, "comment_id": 49056365, "body": "Look at the generated code."}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 3, "creation_date": 1432747612, "post_id": 30488795, "comment_id": 49056753, "body": "You can probably use <code>sizeof(__FILE__) - 1</code>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 0, "creation_date": 1432748101, "post_id": 30489200, "comment_id": 49057002, "body": "At least one of the OP&#39;s listed compilers does calculate string lengths at compile time. It&#39;s not required, and I don&#39;t know about the other compilers, but it&#39;s a perfectly valid and sensible optimisation."}], "tags": [], "owner": {"reputation": 2289, "user_id": 2356414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff4a2241e2dcfc50615e4b7c709bd17?s=128&d=identicon&r=PG", "display_name": "KABoissonneault", "link": "https://stackoverflow.com/users/2356414/kaboissonneault"}, "is_accepted": false, "score": 0, "last_activity_date": 1432747241, "creation_date": 1432747241, "answer_id": 30489200, "question_id": 30488795, "link": "https://stackoverflow.com/questions/30488795/is-strlen-file-evaluated-at-compile-time/30489200#30489200", "title": "Is strlen(__FILE__) evaluated at compile time", "body": "<p>No, because strlen is not defined by the standard as a constexpr function</p>\n"}, {"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1432748630, "post_id": 30489408, "comment_id": 49057301, "body": "<code>sizeof(__FILE__) - 1</code> won&#39;t yield the same result as <code>strlen(__FILE__)</code> if <code>__FILE__</code> contains a null character. In practice, that will never happen."}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1432749009, "post_id": 30489408, "comment_id": 49057517, "body": "@KeithThompson Why would it not yield the same result if it has a null character?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1432749148, "post_id": 30489408, "comment_id": 49057595, "body": "@0x499602D2 Why would it? <code>strlen</code> stops at the first null character, <code>sizeof</code> does not."}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1432749310, "post_id": 30489408, "comment_id": 49057678, "body": "@hvd But that&#39;s why we do <code>- 1</code> to <code>sizeof</code>. It gives the same result <a href=\"http://coliru.stacked-crooked.com/a/caf8358d009d7c51\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "reply_to_user": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 1, "creation_date": 1432749645, "post_id": 30489408, "comment_id": 49057865, "body": "@0x499602D2: That&#39;s because <code>__FILE__</code>, in that particular implementation (and probably every implementation) does not have embedded null characters. If it did, the result would be different. For example: <a href=\"http://coliru.stacked-crooked.com/a/1f8828c55231a9e5\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/1f8828c55231a9e5</a>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1432750685, "post_id": 30489408, "comment_id": 49058418, "body": "@0x499602D2: For example, <code>sizeof &quot;foo\\0bar&quot; == 8</code>, but <code>strlen(&quot;foo\\0bar&quot;) == 3</code>. In practice, Unix-like systems explicitly forbid null characters in file names, and Windows is even more strict. (But I&#39;ve found that a source file name containing a newline breaks gcc&#39;s expansion of <code>__FILE__</code>.)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1432750756, "post_id": 30489408, "comment_id": 49058465, "body": "I suggest updating your answer to show the use of <code>sizeof __FILE__ - 1</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1432760285, "post_id": 30489408, "comment_id": 49063732, "body": "@KeithThompson &quot;In practice, Unix-like systems explicitly forbid null characters in file names&quot; -- but not in <code>#line</code> directives. Nevertheless, GCC, clang and Intel all make <code>__FILE__</code> a single byte (<code>&quot;&quot;</code>) after <code>#line 1 &quot;\\0&quot;</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1432762328, "post_id": 30489408, "comment_id": 49064751, "body": "@hvd: And you can make your error messages beep by using <code>#line __LINE__ &quot;\\a.c&quot;</code>. (To anyone else reading this: <i>never do this</i>.)"}], "tags": [], "owner": {"reputation": 41100, "user_id": 1938163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/WV0Fi.png?s=128&g=1", "display_name": "Marco A.", "link": "https://stackoverflow.com/users/1938163/marco-a"}, "is_accepted": true, "score": 8, "last_activity_date": 1432749751, "last_edit_date": 1432749751, "creation_date": 1432748034, "answer_id": 30489408, "question_id": 30488795, "link": "https://stackoverflow.com/questions/30488795/is-strlen-file-evaluated-at-compile-time/30489408#30489408", "title": "Is strlen(__FILE__) evaluated at compile time", "body": "<p>Clang and gcc are both able to compute this at compile-time thanks to <a href=\"http://en.wikipedia.org/wiki/Constant_folding\" rel=\"nofollow\">constant-folding</a> optimization passes, but this is nowhere enforced in the C++ standard.</p>\n\n<p>Using <code>sizeof</code> <a href=\"http://coliru.stacked-crooked.com/a/2a66adaef88d52d5\" rel=\"nofollow\">could ensure</a> that this is computed at compile-time.</p>\n"}], "owner": {"reputation": 1690, "user_id": 1151329, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ujvgB.png?s=128&g=1", "display_name": "Arno Duvenhage", "link": "https://stackoverflow.com/users/1151329/arno-duvenhage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 30489408, "answer_count": 2, "score": 3, "last_activity_date": 1432749751, "creation_date": 1432745938, "last_edit_date": 1432746748, "question_id": 30488795, "link": "https://stackoverflow.com/questions/30488795/is-strlen-file-evaluated-at-compile-time", "title": "Is strlen(__FILE__) evaluated at compile time", "body": "<p>Is <code>strlen(__FILE__)</code> evaluated at compile time -- assuming I'm using a recent compiler (GCC, Clang, MSVC)?</p>\n"}, {"tags": ["c++", "implicit-conversion", "type-conversion", "rank"], "comments": [{"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1432745970, "post_id": 30488777, "comment_id": 49055745, "body": "See 4.13/p1 ([conv.rank])."}, {"owner": {"reputation": 31438, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "reply_to_user": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1432746063, "post_id": 30488777, "comment_id": 49055812, "body": "@0x499602D2 Yup, that&#39;s what I was looking for."}, {"owner": {"reputation": 6420, "user_id": 480894, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5449cd50eb589e8be56164de5584057c?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/480894/roland"}, "edited": false, "score": 0, "creation_date": 1590675289, "post_id": 30488777, "comment_id": 109774538, "body": "In the C spec: 6.3.1.1 Boolean, characters, and integers"}], "answers": [{"tags": [], "owner": {"reputation": 151870, "user_id": 1501794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/VyUv5.jpg?s=128&g=1", "display_name": "Rahul Tripathi", "link": "https://stackoverflow.com/users/1501794/rahul-tripathi"}, "is_accepted": true, "score": 9, "last_activity_date": 1432746296, "creation_date": 1432746296, "answer_id": 30488911, "question_id": 30488777, "link": "https://stackoverflow.com/questions/30488777/what-does-rank-mean-in-relation-to-type-conversion/30488911#30488911", "title": "What does rank mean in relation to type conversion?", "body": "<p>The <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf\">4.13 section</a> says that</p>\n\n<blockquote>\n  <p>Every integer type has an integer conversion rank defined as follows:</p>\n  \n  <p>\u2014 No two signed integer types other than char and signed char (if char\n  is signed) shall have the same rank, even if they have the same\n  representation.</p>\n  \n  <p>\u2014 The rank of a signed integer type shall be greater than the rank of\n  any signed integer type with a smaller size.</p>\n  \n  <p>\u2014 The rank of long long int shall be greater than the rank of long\n  int, which shall be greater than the rank of int, which shall be\n  greater than the rank of short int, which shall be greater than the\n  rank of signed char.</p>\n  \n  <p>\u2014 The rank of any unsigned integer type shall equal the rank of the\n  corresponding signed integer type</p>\n  \n  <p>\u2014 The rank of any standard integer type shall be greater than the rank\n  of any extended integer type with the same size.</p>\n  \n  <p>\u2014 The rank of char shall equal the rank of signed char and unsigned\n  char.</p>\n  \n  <p>\u2014 The rank of bool shall be less than the rank of all other standard\n  integer types.</p>\n  \n  <p>\u2014 The ranks of char16_t, char32_t, and wchar_t shall equal the ranks\n  of their underlying types (3.9.1).</p>\n  \n  <p>\u2014 The rank of any extended signed integer type relative to another\n  extended signed integer type with the same size is\n  implementation-defined, but still subject to the other rules for\n  determining the integer conversion rank.</p>\n  \n  <p>\u2014 For all integer types T1, T2, and T3, if T1 has greater rank than T2\n  and T2 has greater rank than T3, then T1 shall have greater rank than\n  T3.</p>\n</blockquote>\n"}], "owner": {"reputation": 31438, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2368, "favorite_count": 1, "accepted_answer_id": 30488911, "answer_count": 1, "score": 9, "last_activity_date": 1432747542, "creation_date": 1432745877, "last_edit_date": 1432747542, "question_id": 30488777, "link": "https://stackoverflow.com/questions/30488777/what-does-rank-mean-in-relation-to-type-conversion", "title": "What does rank mean in relation to type conversion?", "body": "<p><strong>From C++11 standard (draft n3337) \u00a75/9:</strong></p>\n\n<blockquote>\n  <p>\u2014 If both operands have the same type, no further conversion is\n  needed.</p>\n  \n  <p>\u2014 Otherwise, if both operands have signed integer types or both have\n  unsigned integer types, the operand with the type of lesser integer\n  conversion <strong>rank</strong> shall be converted to the type of the operand with\n  greater <strong>rank</strong>.</p>\n  \n  <p>\u2014 Otherwise, if the operand that has unsigned integer type has <strong>rank</strong>\n  greater than or equal to the <strong>rank</strong> of the type of the other operand,\n  the operand with signed integer type shall be converted to the type of\n  the operand with unsigned integer type.</p>\n  \n  <p>\u2014 Otherwise, if the type of the operand with signed integer type can\n  represent all of the values of the type of the operand with unsigned\n  integer type, the operand with unsigned integer type shall be\n  converted to the type of the operand with signed integer type.</p>\n  \n  <p>\u2014 Otherwise, both operands shall be converted to the unsigned integer\n  type corresponding to the type of the operand with signed integer\n  type.</p>\n</blockquote>\n\n<p><strong>What does rank mean in this context?</strong><br>\nSurely it's not referring to <a href=\"http://en.cppreference.com/w/cpp/types/rank\" rel=\"noreferrer\">std::rank</a>,<br>\nas that has to do with the number of dimensions in an array...  </p>\n\n<p>In terms of integral types and floating point types, I think it refers to their potential sizes.    </p>\n\n<p>The C++ Standard guarantees that:  </p>\n\n<pre><code>1 == sizeof(char) &lt;= sizeof(short) &lt;= sizeof(int) &lt;= sizeof(long) &lt;=  sizeof(long long)  \n</code></pre>\n\n<p>am I right to assume then that the ranks are then:  </p>\n\n<p><kbd><code><strong>Rank</strong></code></kbd><kbd><code><strong>Type</strong>     </code></kbd><br/>\n<kbd><code>1   </code></kbd><kbd><code>char     </code></kbd><br>\n<kbd><code>2   </code></kbd><kbd><code>short    </code></kbd><br>\n<kbd><code>3   </code></kbd><kbd><code>int      </code></kbd><br>\n<kbd><code>4   </code></kbd><kbd><code>long     </code></kbd><br>\n<kbd><code>5   </code></kbd><kbd><code>long long</code></kbd><br>\n...  </p>\n\n<p>I haven't been able to find a <a href=\"http://en.cppreference.com/w/cpp/language/types\" rel=\"noreferrer\">list</a> anywhere describing the level of rank for each type.  </p>\n"}, {"tags": ["c++", "datetime", "utc", "epoch"], "comments": [{"owner": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "edited": false, "score": 0, "creation_date": 1432746238, "post_id": 30488748, "comment_id": 49055934, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/1223947/time-zone-conversion-c-api-on-linux-anyone\">Time zone conversion C API on Linux, anyone?</a>"}, {"owner": {"reputation": 3303, "user_id": 2339664, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/64b54fa6ca1be975a3ae0b683d0d8164?s=128&d=identicon&r=PG&f=1", "display_name": "Harry Boy", "link": "https://stackoverflow.com/users/2339664/harry-boy"}, "reply_to_user": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "edited": false, "score": 0, "creation_date": 1432746397, "post_id": 30488748, "comment_id": 49056013, "body": "Forgot to say I&#39;m on Windows."}, {"owner": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "edited": false, "score": 0, "creation_date": 1432746809, "post_id": 30488748, "comment_id": 49056256, "body": "this is standard c runtime should be applicable.  But if you want windows-specific, I seem to remember that Windows-specific APIs where not particularly helpful in that regard."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1432746952, "post_id": 30488748, "comment_id": 49056341, "body": "Are you asking how to render a human-readable date and time string in a known timezone? Or what?"}, {"owner": {"reputation": 3303, "user_id": 2339664, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/64b54fa6ca1be975a3ae0b683d0d8164?s=128&d=identicon&r=PG&f=1", "display_name": "Harry Boy", "link": "https://stackoverflow.com/users/2339664/harry-boy"}, "edited": false, "score": 0, "creation_date": 1432747506, "post_id": 30488748, "comment_id": 49056692, "body": "No I&#39;m not asking how to make it human readable. I need to know how to convert the original UTC time to take the timezone into consideration and get the time in that timezone."}, {"owner": {"reputation": 3303, "user_id": 2339664, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/64b54fa6ca1be975a3ae0b683d0d8164?s=128&d=identicon&r=PG&f=1", "display_name": "Harry Boy", "link": "https://stackoverflow.com/users/2339664/harry-boy"}, "edited": false, "score": 0, "creation_date": 1432747924, "post_id": 30488748, "comment_id": 49056902, "body": "So I start off with the epoc time of 1432743742 which represents 27/05/2015, 16:22:22 but I know that my timezone is GMT Standard Time so I need to get an output of 27/05/2015, 17:22:22 (Note the time is now 17 instead of 16)"}, {"owner": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "edited": false, "score": 0, "creation_date": 1432757178, "post_id": 30488748, "comment_id": 49062159, "body": "If the value is still a number - that should <i>always</i> be in UTC.  It&#39;s only when you get a human readable string that you would adjust it for time zone."}, {"owner": {"reputation": 3303, "user_id": 2339664, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/64b54fa6ca1be975a3ae0b683d0d8164?s=128&d=identicon&r=PG&f=1", "display_name": "Harry Boy", "link": "https://stackoverflow.com/users/2339664/harry-boy"}, "edited": false, "score": 0, "creation_date": 1432757686, "post_id": 30488748, "comment_id": 49062468, "body": "Trust me I need to convert the time to take the timezone into consideration."}], "owner": {"reputation": 3303, "user_id": 2339664, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/64b54fa6ca1be975a3ae0b683d0d8164?s=128&d=identicon&r=PG&f=1", "display_name": "Harry Boy", "link": "https://stackoverflow.com/users/2339664/harry-boy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 724, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1432746720, "creation_date": 1432745769, "last_edit_date": 1432746720, "question_id": 30488748, "link": "https://stackoverflow.com/questions/30488748/get-local-time-from-utc-time", "title": "Get local time from UTC time", "body": "<p>I have an epoc time <strong>1432743742</strong> that represents <strong>Wed, 27 May 2015 16:22:22</strong></p>\n\n<p>(See <a href=\"http://www.epochconverter.com/\" rel=\"nofollow\">http://www.epochconverter.com/</a>)</p>\n\n<p>This time is actually <strong>27/05/2015, 17:22:22 GMT+1:00 DST</strong></p>\n\n<p>In C++ how can I get the GMT+1:00 time when I know the epoc time and the time zone e.g. <strong>\"GMT Standard Time\"</strong> </p>\n"}, {"tags": ["c++", "c", "compilation", "linker", "g++"], "comments": [{"owner": {"reputation": 10223, "user_id": 592182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fu0me.jpg?s=128&g=1", "display_name": "forsvarir", "link": "https://stackoverflow.com/users/592182/forsvarir"}, "edited": false, "score": 1, "creation_date": 1432752777, "post_id": 30488702, "comment_id": 49059634, "body": "The error you are getting is coming from the linker step, not the compiler. It doesn&#39;t have anything to do with your includes. You have to tell the linker all of the object files that are required to make the target binary."}, {"owner": {"reputation": 778, "user_id": 761902, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/7atdk.jpg?s=128&g=1", "display_name": "ansonl", "link": "https://stackoverflow.com/users/761902/ansonl"}, "reply_to_user": {"reputation": 10223, "user_id": 592182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fu0me.jpg?s=128&g=1", "display_name": "forsvarir", "link": "https://stackoverflow.com/users/592182/forsvarir"}, "edited": false, "score": 0, "creation_date": 1432770465, "post_id": 30488702, "comment_id": 49067496, "body": "So is there a one liner command for g++ to accomplish this?"}, {"owner": {"reputation": 10223, "user_id": 592182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fu0me.jpg?s=128&g=1", "display_name": "forsvarir", "link": "https://stackoverflow.com/users/592182/forsvarir"}, "edited": false, "score": 0, "creation_date": 1432801659, "post_id": 30488702, "comment_id": 49078298, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/3202136/using-g-to-compile-multiple-cpp-and-h-files\">Using G++ to compile multiple .cpp and .h files</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10223, "user_id": 592182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fu0me.jpg?s=128&g=1", "display_name": "forsvarir", "link": "https://stackoverflow.com/users/592182/forsvarir"}, "is_accepted": true, "score": 2, "last_activity_date": 1432802809, "last_edit_date": 1495535213, "creation_date": 1432801635, "answer_id": 30501099, "question_id": 30488702, "link": "https://stackoverflow.com/questions/30488702/g-include-files-in-other-directories/30501099#30501099", "title": "g++ include files in other directories", "body": "<p>The error you are getting is coming from the linker step, not the compiler step.  It doesn't have anything to do with your includes. You need to tell the linker all the files required to make the target binary.  As has been said in <a href=\"https://stackoverflow.com/a/3202161/592182\">this answer</a>, which may be the question this was previously closed as a duplicate of, you just need to list all of the cpp files after main in the command line.  So for yours, the command line should be something like:</p>\n\n<pre><code>g++ -o configtest -Wall -I../inih/cpp main.cpp ../inih/cpp/INIReader.cpp ../inih/ini.c\n</code></pre>\n\n<p>Once you start compiling all of the files in one step, you may have to add an extra include instruction to find header files in different paths, so your command line might need to be:</p>\n\n<pre><code>g++ -o configtest -Wall -I../inih/cpp -I../inih main.cpp ../inih/cpp/INIReader.cpp ../inih/ini.c\n</code></pre>\n\n<p>But that depends how you're including your headers from your source files...</p>\n"}], "owner": {"reputation": 778, "user_id": 761902, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/7atdk.jpg?s=128&g=1", "display_name": "ansonl", "link": "https://stackoverflow.com/users/761902/ansonl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1498, "favorite_count": 0, "accepted_answer_id": 30501099, "answer_count": 1, "score": 1, "last_activity_date": 1432833838, "creation_date": 1432745643, "last_edit_date": 1432833838, "question_id": 30488702, "link": "https://stackoverflow.com/questions/30488702/g-include-files-in-other-directories", "title": "g++ include files in other directories", "body": "<p>I have a main.cpp file in a directory called test that has an </p>\n\n<pre><code>#include \"INIReader.h\"\n</code></pre>\n\n<p>The structure of the files is like below</p>\n\n<pre><code>---/test/main.cpp\n\n---/inih/ini.h\n         ini.c\n\n---/inih/cpp/INIReader.h\n             INIReader.cpp\n</code></pre>\n\n<p><em>INIReader.cpp</em> has these includes</p>\n\n<pre><code>#include \"../ini.h\"\n#include \"INIReader.h\"\n</code></pre>\n\n<p>I am trying to compile <em>main.cpp</em> in one line with </p>\n\n<pre><code>g++ -o test -Wall -I../inih/cpp main.cpp\n</code></pre>\n\n<p>but it is not working. Errors like </p>\n\n<pre><code>&gt; Undefined symbols for architecture x86_64: \n&gt;... REFERENCES TO stuff in INIReader ...\n&gt;ld: symbol(s) not found\n&gt; for architecture x86_64 clang: error: linker command failed with exit\n&gt; code 1 (use -v to see invocation)\n</code></pre>\n\n<p>show up. </p>\n\n<p>Right now I am compiling by running the commands and it will work. </p>\n\n<pre><code>&gt; g++ -c -Wall ../inih/cpp/INIReader.cpp \n&gt; g++ -c -Wall ../inih/ini.c \n&gt; g++ -c -Wall -I../inih/cpp main.cpp \n&gt; g++ -o configtest main.o INIReader.o ini.o\n</code></pre>\n\n<p>I thought that the g++ compiler will look for each #include in each of the default include directories and the passed <em>-I</em> directory and do not know why the above one liner does not work. Will g++ \"follow\" includes in all files like the <em>./ini.h</em>? I have not been able to find a good resource for learning this. \nHow can I combine these command into one line like the previous command? Thanks. </p>\n\n<p>Edit:</p>\n\n<p>I have looked at the \"duplicate\" question but not understand how it relates to my problem. I am trying to find a good resource for learning how to \"include\" correctly with g++ and know why my current one liner does not work.\nIt is not a problem in the code, as compiling and then linking one by one is successful!</p>\n\n<p><strong>Duplicate question was similar, but did not cover including files in other directories.</strong> </p>\n"}, {"tags": ["c++", "destructor", "undefined-behavior"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1432746251, "post_id": 30488692, "comment_id": 49055942, "body": "Side note: Calling <code>exit</code> is for programmers ending at a stake."}], "answers": [{"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "edited": false, "score": 0, "creation_date": 1432747106, "post_id": 30488841, "comment_id": 49056448, "body": "@meet No. Reread the condition for UB - you&#39;re not calling it <i>during destruction</i>."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 3, "last_activity_date": 1432746081, "creation_date": 1432746081, "answer_id": 30488841, "question_id": 30488692, "link": "https://stackoverflow.com/questions/30488692/destruction-of-static-storage-duration-objects-undefined-behavior/30488841#30488841", "title": "destruction of static storage duration objects &amp; undefined behavior", "body": "<blockquote>\n  <ol>\n  <li>when the automatic object t will be destroyed?</li>\n  </ol>\n</blockquote>\n\n<p>Never. The quote you cited reads \"... <strong>without</strong> destroying any objects with automatic storage duration ...\"</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Will it be safely destroyed by compiler?</li>\n  </ol>\n</blockquote>\n\n<p>No. The compiler's job is to produce the code for the machine to run, once you're at runtime the compiler isn't doing anything anymore.</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Why it is undefined behavior?</li>\n  </ol>\n</blockquote>\n\n<p>In your example, it's not undefined behavior - you're not calling <code>std::exit()</code> \"during the destruction of an object with static or thread storage duration.\" However, if you were, it would be sufficient to answer \"it's undefined behavior because the standard explicitly states it as such.\"</p>\n"}], "owner": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "accepted_answer_id": 30488841, "answer_count": 1, "score": 2, "last_activity_date": 1566114530, "creation_date": 1432745602, "last_edit_date": 1566114530, "question_id": 30488692, "link": "https://stackoverflow.com/questions/30488692/destruction-of-static-storage-duration-objects-undefined-behavior", "title": "destruction of static storage duration objects &amp; undefined behavior", "body": "<p>C++ standard section 3.6.1 says that</p>\n\n<blockquote>\n  <p>Calling the function <code>std::exit(int)</code> declared in <code>&lt;cstdlib&gt;</code> terminates\n  the program without leaving the current block and hence without\n  destroying any objects with automatic storage duration  If std::exit\n  is called to end a program during the destruction of an object with\n  static storage duration, the program has undefined behavior.</p>\n</blockquote>\n\n<p>So, consider following simple program</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\nclass test\n{\n    public:\n        test()\n        {\n            std::cout&lt;&lt;\"constructor\\n\";\n        }\n        ~test()\n        {\n            std::cout&lt;&lt;\"destructor\\n\";\n        }\n};\nint main()\n{\n    test t;\n    exit(0);\n}\n</code></pre>\n\n<p>The output of the above program should be obviously</p>\n\n<blockquote>\n  <p><em>constructor</em></p>\n</blockquote>\n\n<p>So, my question is:</p>\n\n<ol>\n<li><p>when the automatic object t will be destroyed?</p></li>\n<li><p>Will it be safely destroyed by compiler?</p></li>\n<li><p>Why it is undefined behavior?</p></li>\n</ol>\n\n<p>Now, consider slightly modified version of above program.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\nclass test\n{\n    public:\n        test()\n        {\n            std::cout&lt;&lt;\"constructor\\n\";\n        }\n        ~test()\n        {\n            std::cout&lt;&lt;\"destructor\\n\";\n        }\n};\nint main()\n{\n    static test t;\n    exit(0);\n}\n</code></pre>\n\n<p>Now, I got following output:</p>\n\n<blockquote>\n  <p>constructor</p>\n  \n  <p>destructor</p>\n</blockquote>\n\n<p>So, is it possible to see only constructor call as an output on some C++ implementations due to undefined behavior?</p>\n\n<p>Please correct me If I understood incorrectly something.</p>\n"}, {"tags": ["c++", "math", "floor", "ntl"], "comments": [{"owner": {"reputation": 2289, "user_id": 2356414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff4a2241e2dcfc50615e4b7c709bd17?s=128&d=identicon&r=PG", "display_name": "KABoissonneault", "link": "https://stackoverflow.com/users/2356414/kaboissonneault"}, "edited": false, "score": 0, "creation_date": 1432745695, "post_id": 30488643, "comment_id": 49055579, "body": "Looks like n * squrt(2) is returning a double instead of an NTL::ZZ Maybe your library has its own squrt function?"}, {"owner": {"reputation": 8178, "user_id": 2920343, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dbfe32738597d61775971cab5efebb67?s=128&d=identicon&r=PG&f=1", "display_name": "CompuChip", "link": "https://stackoverflow.com/users/2920343/compuchip"}, "edited": false, "score": 2, "creation_date": 1432745757, "post_id": 30488643, "comment_id": 49055612, "body": "I don&#39;t know the library, but if it is the one described at <a href=\"http://www.shoup.net/ntl/doc/tour-ex1.html\" rel=\"nofollow noreferrer\">shoup.net/ntl/doc/tour-ex1.html</a> apparently it has &quot;<code>SqrRoot</code>  -- integer part of square root&quot;. So you could try something like <code>SqrRoot(2*n*n)</code>, assuming n is positive (and <code>-SqrRoot(2*n*n)</code> otherwise)."}, {"owner": {"reputation": 901, "user_id": 4512451, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Dbzwe.jpg?s=128&g=1", "display_name": "CtheGood", "link": "https://stackoverflow.com/users/4512451/cthegood"}, "edited": false, "score": 0, "creation_date": 1432746056, "post_id": 30488643, "comment_id": 49055809, "body": "Thanks guys.  I have changed my algorithm to have <code>floor(SqrRoot(2*n*n))</code>. The <code>SqrRoot</code> now returns a ZZ, but still there is not <code>floor</code> function in the NTL library or C++ libraries that accepts a <code>ZZ</code>, which is the real problem listed above.  There is no matching call for a <code>floor:(NTL::ZZ)</code>.  Need more help."}, {"owner": {"reputation": 8178, "user_id": 2920343, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dbfe32738597d61775971cab5efebb67?s=128&d=identicon&r=PG&f=1", "display_name": "CompuChip", "link": "https://stackoverflow.com/users/2920343/compuchip"}, "edited": false, "score": 2, "creation_date": 1432746132, "post_id": 30488643, "comment_id": 49055862, "body": "Why do you need to apply floor? According to what I quoted, SqrRoot already returns the <i>integer part</i> of the square root."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "edited": false, "score": 0, "creation_date": 1432746152, "post_id": 30488643, "comment_id": 49055877, "body": ".. specifically, the header comments <code>x = floor(a^{1&#47;2}) (a &gt;= 0)</code>"}, {"owner": {"reputation": 901, "user_id": 4512451, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Dbzwe.jpg?s=128&g=1", "display_name": "CtheGood", "link": "https://stackoverflow.com/users/4512451/cthegood"}, "reply_to_user": {"reputation": 8178, "user_id": 2920343, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dbfe32738597d61775971cab5efebb67?s=128&d=identicon&r=PG&f=1", "display_name": "CompuChip", "link": "https://stackoverflow.com/users/2920343/compuchip"}, "edited": false, "score": 0, "creation_date": 1432746345, "post_id": 30488643, "comment_id": 49055990, "body": "Sorry @CompuChip, I missed where you talked about the integer part of the square root.  I looked that up and you are correct.  I&#39;m applying those changes right now.  Thanks - I&#39;ll report if it worked or not."}, {"owner": {"reputation": 901, "user_id": 4512451, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Dbzwe.jpg?s=128&g=1", "display_name": "CtheGood", "link": "https://stackoverflow.com/users/4512451/cthegood"}, "reply_to_user": {"reputation": 8178, "user_id": 2920343, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dbfe32738597d61775971cab5efebb67?s=128&d=identicon&r=PG&f=1", "display_name": "CompuChip", "link": "https://stackoverflow.com/users/2920343/compuchip"}, "edited": false, "score": 0, "creation_date": 1432780170, "post_id": 30488643, "comment_id": 49069669, "body": "@CompuChip your answer was most helpful.  I was able to get those changes in, and it worked like a charm.  Thanks for looking that up for me.  Wish I could give you more points then just an upped comment."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "edited": false, "score": 1, "creation_date": 1432746469, "post_id": 30488812, "comment_id": 49056061, "body": "Incidentally, even if you had arbitrary precision floating point available, the pure integer version is still probably the better way to do the calculation."}, {"owner": {"reputation": 901, "user_id": 4512451, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Dbzwe.jpg?s=128&g=1", "display_name": "CtheGood", "link": "https://stackoverflow.com/users/4512451/cthegood"}, "edited": false, "score": 0, "creation_date": 1432780125, "post_id": 30488812, "comment_id": 49069653, "body": "Thanks @Hurkyl for all your information.  The thing I really needed was just the last bit you mentioned.  This is for a class, and there are requirements for libraries to be used and how to set this up, so I was under the constraints I mentioned above.  What I really needed to know was the SqrRoot() NTL function returned an rounded off int, which was what I needed."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "is_accepted": false, "score": 4, "last_activity_date": 1432746537, "last_edit_date": 1432746537, "creation_date": 1432746014, "answer_id": 30488812, "question_id": 30488643, "link": "https://stackoverflow.com/questions/30488643/how-to-floor-a-number-using-the-ntl-library-c/30488812#30488812", "title": "How to floor a number using the NTL library (C++)", "body": "<p>Note that it doesn't really make sense to apply <code>floor</code> to an integral type (well, it does, it's just a no-op). What you should be really worried about is the fact that your code is apparently passing something of type <code>ZZ</code> into <code>floor</code>!</p>\n\n<p>That is, what can <code>n * sqrt(2)</code> possibly mean here?</p>\n\n<p>Also, before even writing that, I'd've checked the documentation to see if integer * floating point actually exists in the library -- usually for that to be useful at all, you need arbitrary precision floating types available.</p>\n\n<hr>\n\n<p>Checking through the headers, there is only one multiplication operator:</p>\n\n<pre><code>ZZ operator*(const ZZ&amp; a, const ZZ&amp; b);\n</code></pre>\n\n<p>and there is a conversion constructor:</p>\n\n<pre><code>explicit ZZ(long a);  // promotion constructor\n</code></pre>\n\n<p>I can't figure out how your code is even compiling. Maybe you're using a different version of the library than I'm looking at, and the conversion constructor is implicit, and your <code>double</code> is getting \"promoted\" to a <code>ZZ</code>. This is surely not what you want, since promoting <code>sqrt(2)</code> to a <code>ZZ</code> is simply going to give you the integer <code>1</code>.</p>\n\n<p>You either need to:</p>\n\n<ul>\n<li>look into whether or not NTL has arbitrary precision floating point capabilities</li>\n<li>switch to a library that does have arbitrary precision floating point capabilities</li>\n<li>convert your calculation to pure integer arithmetic</li>\n</ul>\n\n<p>That last one is fairly easy here: you want</p>\n\n<pre><code>return SqrRoot(sqr(n) * 2); // sqr(n) will be a bit more efficient than `n * n`\n</code></pre>\n"}], "owner": {"reputation": 901, "user_id": 4512451, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Dbzwe.jpg?s=128&g=1", "display_name": "CtheGood", "link": "https://stackoverflow.com/users/4512451/cthegood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432746537, "creation_date": 1432745421, "question_id": 30488643, "link": "https://stackoverflow.com/questions/30488643/how-to-floor-a-number-using-the-ntl-library-c", "title": "How to floor a number using the NTL library (C++)", "body": "<p>I am building a C++ program to verify a mathematical conjecture for up to 100 billion iterations.  In order to test such high numbers, I cannot use a <code>C++ int</code>, so I am using the <code>NTL</code> library, using the type <code>ZZ</code> as my number type.  </p>\n\n<p>My algorithm looks like this:</p>\n\n<pre><code>ZZ generateNthSeq(ZZ n)\n{\n    return floor(n*sqrt(2));\n}\n</code></pre>\n\n<p>I have the two libraries being imported:</p>\n\n<pre><code>#include &lt;cmath&gt;\n#include &lt;NTL/ZZ.h&gt;\n</code></pre>\n\n<p>But obviously this cannot compile because I get the error:</p>\n\n<pre><code>$ g++ deepness*.cpp\ndeepness.cpp: In function \u2018NTL::ZZ generateNthSeq(NTL::ZZ)\u2019:\ndeepness.cpp:41: error: no matching function for call to \u2018floor(NTL::ZZ)\u2019\n/usr/include/bits/mathcalls.h:185: note: candidates are: double floor(double)\n/usr/lib/gcc/x86_64-redhat-linux/4.4.7/../../../../include/c++/4.4.7/cmath:262: note:                 long double std::floor(long double)\n/usr/lib/gcc/x86_64-redhat-linux/4.4.7/../../../../include/c++/4.4.7/cmath:258: note:                 float std::floor(float)\n</code></pre>\n\n<p>Stating that the floor mathematical operation cannot accept a ZZ class type.  But I need the numbers to be pretty big.  How can I accomplish what I want to do, which is to floor the function, while using the NTL library?</p>\n"}, {"tags": ["c++", "windows", "excel", "vba", "dll"], "comments": [{"owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 1, "creation_date": 1432745640, "post_id": 30488628, "comment_id": 49055538, "body": "Try <code>Dim x As LongPtr</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "is_accepted": false, "score": 1, "last_activity_date": 1432810967, "creation_date": 1432810967, "answer_id": 30504746, "question_id": 30488628, "link": "https://stackoverflow.com/questions/30488628/vba-64-bit-excel-not-passing-pointers-to-dll-functions-c/30504746#30504746", "title": "VBA 64-bit Excel not passing pointers to DLL functions (C++)", "body": "<pre><code>Dim x As LongPtr\nDim z As Double\nz = test(x, CLng(1))\n</code></pre>\n\n<p><code>LongPtr</code> evaluates to <code>Long</code> in 32-Bit environments and to <code>LongLong</code> in 64-Bit environments so defining x as such should work.</p>\n\n<p>Addtionally, <code>CLng</code> will ensure 1 is evaluated as a <code>Long</code> type. If this is not added VBA will assume you mean <code>Integer</code></p>\n"}], "owner": {"reputation": 15, "user_id": 4945716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79ec37319bb1ba2166285d92a8d439fc?s=128&d=identicon&r=PG&f=1", "display_name": "Hamid", "link": "https://stackoverflow.com/users/4945716/hamid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1432810967, "creation_date": 1432745371, "last_edit_date": 1432745880, "question_id": 30488628, "link": "https://stackoverflow.com/questions/30488628/vba-64-bit-excel-not-passing-pointers-to-dll-functions-c", "title": "VBA 64-bit Excel not passing pointers to DLL functions (C++)", "body": "<p>I have VBA program running on Excel 64-bit calling some DLL functions (C++). The problem is (apparently) it can't pass pointers to C++ program. The program works with Excel 32-bit.The operating system is <strong>Windows 8</strong>. For  Windows 7 both 32-bit and 64-bit versions of Excel are working well. </p>\n\n<p>C++ :</p>\n\n<pre><code>double test(long* v, long i) \n {\n    if (v == NULL)\n        return -88;\n    else\n        return *((long*)v);\n }\n</code></pre>\n\n<p>VBA: </p>\n\n<pre><code>Private Declare PtrSafe Function hamid_test Lib \"...\\CVode.dll\" (ByVal v As LongPtr, ByVal i As Long) As Double\n\n Dim x As LongLong\n Dim z As Double\n z = test(x, 1)\n</code></pre>\n\n<p>It returns <code>-88</code>.</p>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 2, "creation_date": 1432745403, "post_id": 30488586, "comment_id": 49055386, "body": "<code>std::nth_element</code>, although it is modifying the sequence."}, {"owner": {"reputation": 908, "user_id": 1220312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/85bfd271749bd0ba3d9b18d2437bc283?s=128&d=identicon&r=PG", "display_name": "lcjury", "link": "https://stackoverflow.com/users/1220312/lcjury"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1432745492, "post_id": 30488586, "comment_id": 49055441, "body": "@dyp any difference to use <code>std::sort</code> ?"}, {"owner": {"reputation": 6299, "user_id": 143931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0f87a9f76e50c212510492dd5f2923f6?s=128&d=identicon&r=PG", "display_name": "fuenfundachtzig", "link": "https://stackoverflow.com/users/143931/fuenfundachtzig"}, "edited": false, "score": 0, "creation_date": 1432745498, "post_id": 30488586, "comment_id": 49055445, "body": "It must not modify the sequence."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 908, "user_id": 1220312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/85bfd271749bd0ba3d9b18d2437bc283?s=128&d=identicon&r=PG", "display_name": "lcjury", "link": "https://stackoverflow.com/users/1220312/lcjury"}, "edited": false, "score": 1, "creation_date": 1432745518, "post_id": 30488586, "comment_id": 49055462, "body": "@lcjury, <code>std::nth_element</code> is O(n) instead of O(n log n)."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1432745582, "post_id": 30488586, "comment_id": 49055504, "body": "@fuenfundachtzig, If you don&#39;t mind O(n) space, you can create a copy and keep linear time. Unfortunately, that does mean another potentially big allocation for the copy."}, {"owner": {"reputation": 11342, "user_id": 1144157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d05077a347e63679d43bfbdaf5e7b9ab?s=128&d=identicon&r=PG", "display_name": "Steephen", "link": "https://stackoverflow.com/users/1144157/steephen"}, "edited": false, "score": 0, "creation_date": 1432745669, "post_id": 30488586, "comment_id": 49055564, "body": "If you can create a copy use <code>std::max_element</code> twice after remove the first max_element only if there are no duplicates"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1432745721, "post_id": 30488586, "comment_id": 49055590, "body": "Are you really interested in the nth element, or specifically in the second largest element? To get the second largest element efficiently, you can use <code>std::accumulate</code> with a custom binary operator (and some inelegant error checking)."}, {"owner": {"reputation": 6299, "user_id": 143931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0f87a9f76e50c212510492dd5f2923f6?s=128&d=identicon&r=PG", "display_name": "fuenfundachtzig", "link": "https://stackoverflow.com/users/143931/fuenfundachtzig"}, "edited": false, "score": 0, "creation_date": 1432745871, "post_id": 30488586, "comment_id": 49055678, "body": "Indeed, at the moment I am mostly interested in the 2nd largest (I was assuming that most solutions would be general, so I asked for the general case). You seem to have a certain solution in mind, so you should probably make an answer out of that."}], "answers": [{"comments": [{"owner": {"reputation": 6299, "user_id": 143931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0f87a9f76e50c212510492dd5f2923f6?s=128&d=identicon&r=PG", "display_name": "fuenfundachtzig", "link": "https://stackoverflow.com/users/143931/fuenfundachtzig"}, "edited": false, "score": 0, "creation_date": 1432746882, "post_id": 30489020, "comment_id": 49056304, "body": "I updated the question, but your answer is still valid."}], "tags": [], "owner": {"reputation": 192274, "user_id": 36565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ccfec45e3fba785daf0e89a797c9216?s=128&d=identicon&r=PG", "display_name": "David Rodr&#237;guez - dribeas", "link": "https://stackoverflow.com/users/36565/david-rodr%c3%adguez-dribeas"}, "is_accepted": false, "score": 0, "last_activity_date": 1432746659, "creation_date": 1432746659, "answer_id": 30489020, "question_id": 30488586, "link": "https://stackoverflow.com/questions/30488586/stdmax-element-for-second-largest-element/30489020#30489020", "title": "std::max_element for second largest element?", "body": "<p>This is a trivial algorithm to implement in linear time. The naive approach would be to compare the first two values, and select them as the max and second largest values.  Then you need to iterate over the other elements comparing each new element with both of them and adjusting your current max and second largest values.  For most use cases that is probably more than enough.  If you really care about performance (as in you care <em>a lot</em>) you will need to think what values you want to compare to minimize the number of comparisons.</p>\n\n<p>Also note that <code>float</code> (floating point in general) have quirks... you might get funny values if your input contains NaN or infinite values.</p>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 2, "last_activity_date": 1432749597, "last_edit_date": 1432749597, "creation_date": 1432748551, "answer_id": 30489550, "question_id": 30488586, "link": "https://stackoverflow.com/questions/30488586/stdmax-element-for-second-largest-element/30489550#30489550", "title": "std::max_element for second largest element?", "body": "<p>If you are specifically interested in the second-largest element, you can do a simple scan of the array in which most elements require a single comparison:</p>\n\n<pre><code>float second_largest_element(std::vector&lt;float&gt; vec) {\n  float m2, m1;\n  /* Check to make sure that vec has at least 2 elements!! */\n  std::tie(m2, m1) = std::minmax(vec[0], vec[1]);\n  for (auto it = vec.begin() + 2, limit = vec.end();\n       it != limit;\n       ++it)\n    if (*it &gt; m2) std::tie(m2, m1) = std::minmax(*it, m1);\n  return m2;\n}\n</code></pre>\n\n<p>Getting the index of (or an iterator to) the second largest element is very similar, although <code>std::minmax</code> is less useful. Here's a very sloppy example:</p>\n\n<pre><code>template&lt;typename T&gt;\ntypename T::iterator second_largest(T&amp; container) {\n  using iterator = typename T::iterator;\n  iterator limit = container.end();\n  iterator it = container.begin();\n  if (it != limit) {\n    iterator first = it++;\n    if (it != limit) {\n      iterator second = it++;\n      if (*first &lt; *second) std::swap(first, second);\n      for (; it != limit; ++it) {\n        if (*second &lt; *it) {\n          if (*first &lt; *it) { second = first; first = it; }\n          else              { second = it; }\n        }\n      }\n      return second;\n    }\n    return first;\n  }\n  return it;\n}\n</code></pre>\n\n<p>You could also consider using <code>std::accumulate</code> to scan the array, although the explicit for loop is not complicated.</p>\n"}, {"comments": [{"owner": {"reputation": 6299, "user_id": 143931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0f87a9f76e50c212510492dd5f2923f6?s=128&d=identicon&r=PG", "display_name": "fuenfundachtzig", "link": "https://stackoverflow.com/users/143931/fuenfundachtzig"}, "edited": false, "score": 0, "creation_date": 1432816190, "post_id": 30492656, "comment_id": 49088731, "body": "But that wouldn&#39;t allow me to obtain the <i>position</i> of the nth element in the original vector, right?"}, {"owner": {"reputation": 11342, "user_id": 1144157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d05077a347e63679d43bfbdaf5e7b9ab?s=128&d=identicon&r=PG", "display_name": "Steephen", "link": "https://stackoverflow.com/users/1144157/steephen"}, "reply_to_user": {"reputation": 6299, "user_id": 143931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0f87a9f76e50c212510492dd5f2923f6?s=128&d=identicon&r=PG", "display_name": "fuenfundachtzig", "link": "https://stackoverflow.com/users/143931/fuenfundachtzig"}, "edited": false, "score": 0, "creation_date": 1432822296, "post_id": 30492656, "comment_id": 49093503, "body": "@fuenfundachtzig I edited the answer to get nth position from original <code>vector</code>"}, {"owner": {"reputation": 229, "user_id": 2583533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64aad1c6f5e1b72366b69497739ccdfb?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/2583533/paul"}, "edited": false, "score": 0, "creation_date": 1441055015, "post_id": 30492656, "comment_id": 52514870, "body": "I have one objection: nth_element doesn&#39;t return a value ( or anything at all really ) according to <a href=\"http://en.cppreference.com/w/cpp/algorithm/nth_element\" rel=\"nofollow noreferrer\">cppreference</a>, so you really need to copy the vector first."}, {"owner": {"reputation": 11342, "user_id": 1144157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d05077a347e63679d43bfbdaf5e7b9ab?s=128&d=identicon&r=PG", "display_name": "Steephen", "link": "https://stackoverflow.com/users/1144157/steephen"}, "reply_to_user": {"reputation": 229, "user_id": 2583533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64aad1c6f5e1b72366b69497739ccdfb?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/2583533/paul"}, "edited": false, "score": 0, "creation_date": 1441130437, "post_id": 30492656, "comment_id": 52550378, "body": "@Paul Your red flag is right and I corrected the answer. Thanks"}], "tags": [], "owner": {"reputation": 11342, "user_id": 1144157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d05077a347e63679d43bfbdaf5e7b9ab?s=128&d=identicon&r=PG", "display_name": "Steephen", "link": "https://stackoverflow.com/users/1144157/steephen"}, "is_accepted": false, "score": 1, "last_activity_date": 1441130400, "last_edit_date": 1441130400, "creation_date": 1432758963, "answer_id": 30492656, "question_id": 30488586, "link": "https://stackoverflow.com/questions/30488586/stdmax-element-for-second-largest-element/30492656#30492656", "title": "std::max_element for second largest element?", "body": "<p>As Dyp mentioned in comment, if you are fine to alter the order of elements within your <code>vector</code> you can use <code>std::nth_element</code> as follows. On top if you use <code>find</code> again over <code>vector</code> you will get original position of the nth element from <code>vector</code>. Since <code>nth_element</code> modifies the positions, you have to keep a local copy of it before doing <code>nth_element</code> operation over vector.</p>\n\n<p>2nd largest element:</p>\n\n<pre><code>std::vector&lt;float&gt; orig_vec=obj.pt;\n\nstd::nth_element(obj.pt().begin(), obj.pt().begin()+1, \n                  obj.pt().end(), std::greater&lt;float&gt;());\nfloat 2nd= *(obj.pt().begin()+1);\nauto it=std::find(orig_vec.begin(), orig_vec.end(), 2nd);\n</code></pre>\n\n<p>nth largest element:</p>\n\n<pre><code>  std::nth_element(obj.pt().begin(), obj.pt().begin()+n-1,\n    obj.pt().end(), std::greater&lt;float&gt;());\n  float nth= *(obj.pt().begin()+n-1);\n\n auto it=std::find(orig_vec.begin(), orig_vec.end(), nth)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10378994, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212532852900365/picture?type=large", "display_name": "Ondrej Ivan\u010d&#237;k", "link": "https://stackoverflow.com/users/10378994/ondrej-ivan%c4%8d%c3%adk"}, "edited": false, "score": 0, "creation_date": 1537257783, "post_id": 52381338, "comment_id": 91707765, "body": "One important thing: You will need to define predicate for <code>max_element()</code> for example <code>auto predicateRef = [](const auto&amp; lhcs, const auto&amp; rhcs) { return lhcs.getValue() &lt; rhcs.getValue(); }</code> and another one for <code>max()</code> <code>auto predicatePtr = [](const auto* lhcs, const auto* rhcs) { return lhcs-&gt;getValue() &lt; rhcs-&gt;getValue(); }</code>."}], "tags": [], "owner": {"reputation": 1, "user_id": 10378994, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212532852900365/picture?type=large", "display_name": "Ondrej Ivan\u010d&#237;k", "link": "https://stackoverflow.com/users/10378994/ondrej-ivan%c4%8d%c3%adk"}, "is_accepted": false, "score": 0, "last_activity_date": 1537256418, "creation_date": 1537256418, "answer_id": 52381338, "question_id": 30488586, "link": "https://stackoverflow.com/questions/30488586/stdmax-element-for-second-largest-element/52381338#52381338", "title": "std::max_element for second largest element?", "body": "<p>It took me a while to find a solution, because I worked with const vector (so I can't use nth_element) and copy would be just wasting (especially, when vector is holding a bigger structures). So I came with this:</p>\n\n<pre><code>// Find 1st max\nauto max1 = max_element(vec.begin(), vec.end());\nif (max1 != vec.end())\n    // Use max1\n\n// Find 2nd max. Split the vector into 2 parts, find max and merge results\nauto max2Beg = max_element(vec.begin(), max1);\nauto max2End = max_element(max1 + 1, vec.end());\nauto max2 = max2Beg == max1 ? max2End :\n            max2End == vec.end() ? max2Beg : max(max2Beg, max2End);\nif (max2 != max1 &amp;&amp; max2 != vec.end())\n    // Use max2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7238841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184eb1d6338bea31db81e50359a41654?s=128&d=identicon&r=PG&f=1", "display_name": "Arjuna", "link": "https://stackoverflow.com/users/7238841/arjuna"}, "is_accepted": false, "score": 2, "last_activity_date": 1554833538, "creation_date": 1554833538, "answer_id": 55598847, "question_id": 30488586, "link": "https://stackoverflow.com/questions/30488586/stdmax-element-for-second-largest-element/55598847#55598847", "title": "std::max_element for second largest element?", "body": "<p>max_element() method can be used to get second largest element by passing lambda function which compares the element with the previously found largest element and if it is equal to the largest element then it'll simply skip that element.</p>\n\n<pre><code>auto largest = max_element(vec.begin(), vec.end());\nauto secondLargest = max_element(vec.begin(), vec.end(),\n                                 [&amp;largest](unsigned long &amp;a, unsigned long &amp;b) {\n                                     return ((b != (*largest)) &amp;&amp; (a &lt; b));\n                                 });\n</code></pre>\n"}], "owner": {"reputation": 6299, "user_id": 143931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0f87a9f76e50c212510492dd5f2923f6?s=128&d=identicon&r=PG", "display_name": "fuenfundachtzig", "link": "https://stackoverflow.com/users/143931/fuenfundachtzig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2358, "favorite_count": 1, "answer_count": 5, "score": 2, "last_activity_date": 1554833538, "creation_date": 1432745278, "last_edit_date": 1432746820, "question_id": 30488586, "link": "https://stackoverflow.com/questions/30488586/stdmax-element-for-second-largest-element", "title": "std::max_element for second largest element?", "body": "<p>The STL provides <code>std::max_element</code> to find the largest element in an iterable, e.g. like this:</p>\n\n<pre><code>std::vector&lt;float&gt;::const_iterator max = \n  std::max_element(obj.pt()-&gt;begin(), obj.pt()-&gt;end());\nreturn std::distance(obj.pt()-&gt;begin(), max);\n</code></pre>\n\n<p>Is there also something to get an iterator for the n-th largest element? </p>\n\n<p>(Note that <code>max_element</code> returns an iterator and this is actually important: Rather than for the value itself, I am looking for the position of the n-th largest element within the iterable.)</p>\n"}, {"tags": ["c++", "x86", "64-bit", "xll", "xlw"], "comments": [{"owner": {"reputation": 4371, "user_id": 389828, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4225dbf0254a965b70e024c58c58750f?s=128&d=identicon&r=PG", "display_name": "Tim Barrass", "link": "https://stackoverflow.com/users/389828/tim-barrass"}, "edited": false, "score": 0, "creation_date": 1572510693, "post_id": 30488466, "comment_id": 103584591, "body": "This deserves at least one upvote I think :) I don&#39;t think it&#39;s purely xlw related though, you&#39;ll get this with any xll where your excel and xll build architecture doesn&#39;t match (similar example at <a href=\"https://stackoverflow.com/questions/28154364/making-an-xll-that-runs-under-32-and-64-bit-excel\" title=\"making an xll that runs under 32 and 64 bit excel\">stackoverflow.com/questions/28154364/&hellip;</a>)"}, {"owner": {"reputation": 4248, "user_id": 2333663, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1ea215872ccae10c90c25905859debe5?s=128&d=identicon&r=PG", "display_name": "Muflix", "link": "https://stackoverflow.com/users/2333663/muflix"}, "edited": false, "score": 0, "creation_date": 1578477928, "post_id": 30488466, "comment_id": 105448152, "body": "I have same error with Excel.DNA, after office 365 update to x64 it is not working and I dont know why :/ (addin is built to any cpu)"}], "answers": [{"comments": [{"owner": {"reputation": 4371, "user_id": 389828, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4225dbf0254a965b70e024c58c58750f?s=128&d=identicon&r=PG", "display_name": "Tim Barrass", "link": "https://stackoverflow.com/users/389828/tim-barrass"}, "edited": false, "score": 0, "creation_date": 1572510875, "post_id": 30565343, "comment_id": 103584669, "body": "If this worked, or you found a different solution, it might be worth posting \u2026 assuming you can remember it ;)"}], "tags": [], "owner": {"reputation": 542, "user_id": 743903, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/59201e648d222d0322c05dd952656400?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostSurely", "link": "https://stackoverflow.com/users/743903/almostsurely"}, "is_accepted": false, "score": 0, "last_activity_date": 1433130313, "creation_date": 1433130313, "answer_id": 30565343, "question_id": 30488466, "link": "https://stackoverflow.com/questions/30488466/xlw-compiled-xll-the-file-format-and-extension-dont-match/30565343#30565343", "title": "XLW - Compiled XLL &quot;The file format and extension don&#39;t match&quot;", "body": "<p>It turns out the <code>VS2013 x64</code> compiled <code>xll</code> works, since I appear to be using Excel 2013 x64. I think I need to clean up my <code>$PATH</code>, since <code>dependency-walker</code> shows a mixture of <code>32 bit</code> and <code>64 bit</code> <code>dll</code>s?</p>\n"}], "owner": {"reputation": 542, "user_id": 743903, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/59201e648d222d0322c05dd952656400?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostSurely", "link": "https://stackoverflow.com/users/743903/almostsurely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2802, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1572510840, "creation_date": 1432744947, "last_edit_date": 1572510840, "question_id": 30488466, "link": "https://stackoverflow.com/questions/30488466/xlw-compiled-xll-the-file-format-and-extension-dont-match", "title": "XLW - Compiled XLL &quot;The file format and extension don&#39;t match&quot;", "body": "<p>I'm using <code>XLW 5</code> to build an <code>Excel</code> <code>XLL</code> add in, and am experimenting with the <code>EchoShort</code> template example. I successfully compiled <code>Template.xll</code> using GNU <code>Make</code>, with <code>g++</code> version 4.9.2 (mingw-w64) under <code>cygwin</code>. However, when trying to open the <code>XLL</code>, <code>Excel 2013</code> reports the error:</p>\n\n<pre><code>The file format and extension of Template.xll don't match. The file could be corrupted, or unsafe. Unless you trust its source, don't open it. Would you like to open it anyway?\n</code></pre>\n\n<p>I proceed to open it, and it seems to be filled with unreadable characters. I tried adding the <code>xll</code> using the add-in manager under the developer tab, yet when I try to call <code>EchoShort</code> in a cell, I get a <code>#NAME</code> error.</p>\n\n<p>I'm new to <code>XLW</code> and this seems like an incredible package, if I can get it working. Any help is much appreciated.</p>\n\n<p>EDIT: Should have mentioned it's under <code>cygwin</code></p>\n\n<p>EDIT: Also tried with VS2013, and the same thing happened, so it's not <code>cygwin</code> nor <code>MinGW</code>. </p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432744367, "post_id": 30488259, "comment_id": 49054767, "body": "You cannot read &quot;only into a variable&quot;: <code>std::cin &gt;&gt; id(x)</code> works just as well for a suitable function <code>id</code>..."}, {"owner": {"reputation": 33, "user_id": 4945682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fce362a677c96794fe9874323e988b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Dahiya", "link": "https://stackoverflow.com/users/4945682/deepak-dahiya"}, "edited": false, "score": 0, "creation_date": 1432744404, "post_id": 30488259, "comment_id": 49054786, "body": "so can u suggest me where do i have to change my code ...sorry for being such a noob"}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 4, "creation_date": 1432744428, "post_id": 30488259, "comment_id": 49054799, "body": "@KerrekSB: Indeed, you can read into any <i>lvalue</i> expression that denotes a suitably typed variable. I&#39;ll stick to the abridged version to answer this question."}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "reply_to_user": {"reputation": 33, "user_id": 4945682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fce362a677c96794fe9874323e988b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Dahiya", "link": "https://stackoverflow.com/users/4945682/deepak-dahiya"}, "edited": false, "score": 0, "creation_date": 1432744492, "post_id": 30488259, "comment_id": 49054837, "body": "@DeepakDahiya: I already did. Change <code>&gt;&gt; sqr(x)</code> to <code>&gt;&gt; x</code>, and <code>&lt;&lt; sqr</code> to <code>&lt;&lt; sqr(x)</code>, as the answer says."}, {"owner": {"reputation": 33, "user_id": 4945682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fce362a677c96794fe9874323e988b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Dahiya", "link": "https://stackoverflow.com/users/4945682/deepak-dahiya"}, "edited": false, "score": 0, "creation_date": 1432744648, "post_id": 30488259, "comment_id": 49054936, "body": "thnxx bro it worked ...stuck with it for last one hour"}, {"owner": {"reputation": 151870, "user_id": 1501794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/VyUv5.jpg?s=128&g=1", "display_name": "Rahul Tripathi", "link": "https://stackoverflow.com/users/1501794/rahul-tripathi"}, "reply_to_user": {"reputation": 33, "user_id": 4945682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fce362a677c96794fe9874323e988b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Dahiya", "link": "https://stackoverflow.com/users/4945682/deepak-dahiya"}, "edited": false, "score": 0, "creation_date": 1432837043, "post_id": 30488259, "comment_id": 49103445, "body": "@DeepakDahiya:- If this answer helped you then you can accept the answer(A right tick mark turns green when clicked)"}, {"owner": {"reputation": 33, "user_id": 4945682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fce362a677c96794fe9874323e988b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Dahiya", "link": "https://stackoverflow.com/users/4945682/deepak-dahiya"}, "reply_to_user": {"reputation": 151870, "user_id": 1501794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/VyUv5.jpg?s=128&g=1", "display_name": "Rahul Tripathi", "link": "https://stackoverflow.com/users/1501794/rahul-tripathi"}, "edited": false, "score": 0, "creation_date": 1432837181, "post_id": 30488259, "comment_id": 49103538, "body": "@RahulTripathi where can i find that tick mark sir ?"}, {"owner": {"reputation": 33, "user_id": 4945682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fce362a677c96794fe9874323e988b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Dahiya", "link": "https://stackoverflow.com/users/4945682/deepak-dahiya"}, "reply_to_user": {"reputation": 151870, "user_id": 1501794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/VyUv5.jpg?s=128&g=1", "display_name": "Rahul Tripathi", "link": "https://stackoverflow.com/users/1501794/rahul-tripathi"}, "edited": false, "score": 0, "creation_date": 1432837285, "post_id": 30488259, "comment_id": 49103595, "body": "@RahulTripathi done sir .. thanks for the help"}, {"owner": {"reputation": 151870, "user_id": 1501794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/VyUv5.jpg?s=128&g=1", "display_name": "Rahul Tripathi", "link": "https://stackoverflow.com/users/1501794/rahul-tripathi"}, "reply_to_user": {"reputation": 33, "user_id": 4945682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fce362a677c96794fe9874323e988b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Dahiya", "link": "https://stackoverflow.com/users/4945682/deepak-dahiya"}, "edited": false, "score": 0, "creation_date": 1432837334, "post_id": 30488259, "comment_id": 49103626, "body": "@DeepakDahiya:- Perfect. Always do that when  the answer helps you as that would help other facing the same issue in future"}, {"owner": {"reputation": 33, "user_id": 4945682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fce362a677c96794fe9874323e988b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Dahiya", "link": "https://stackoverflow.com/users/4945682/deepak-dahiya"}, "reply_to_user": {"reputation": 151870, "user_id": 1501794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/VyUv5.jpg?s=128&g=1", "display_name": "Rahul Tripathi", "link": "https://stackoverflow.com/users/1501794/rahul-tripathi"}, "edited": false, "score": 0, "creation_date": 1432837404, "post_id": 30488259, "comment_id": 49103666, "body": "@RahulTripathi okay sir will keep that in mind"}, {"owner": {"reputation": 151870, "user_id": 1501794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/VyUv5.jpg?s=128&g=1", "display_name": "Rahul Tripathi", "link": "https://stackoverflow.com/users/1501794/rahul-tripathi"}, "reply_to_user": {"reputation": 33, "user_id": 4945682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fce362a677c96794fe9874323e988b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Dahiya", "link": "https://stackoverflow.com/users/4945682/deepak-dahiya"}, "edited": false, "score": 0, "creation_date": 1432837440, "post_id": 30488259, "comment_id": 49103691, "body": "@DeepakDahiya:- Hey dont call me Sir. I am just another guy. Happy coding!"}, {"owner": {"reputation": 33, "user_id": 4945682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fce362a677c96794fe9874323e988b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Dahiya", "link": "https://stackoverflow.com/users/4945682/deepak-dahiya"}, "reply_to_user": {"reputation": 151870, "user_id": 1501794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/VyUv5.jpg?s=128&g=1", "display_name": "Rahul Tripathi", "link": "https://stackoverflow.com/users/1501794/rahul-tripathi"}, "edited": false, "score": 0, "creation_date": 1432837695, "post_id": 30488259, "comment_id": 49103844, "body": "@RahulTripathi if u will go through some of the comments u will notice few of them got angry with me for being too casual and calling everyone bro thats why i started using sir"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 33, "user_id": 4945682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fce362a677c96794fe9874323e988b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Dahiya", "link": "https://stackoverflow.com/users/4945682/deepak-dahiya"}, "edited": false, "score": 0, "creation_date": 1432866390, "post_id": 30488259, "comment_id": 49114914, "body": "@DeepakDahiya: It&#39;s not an &quot;either&quot;/&quot;or&quot; situation. :P &quot;Bro&quot; is extremely casual/chummy (and, at least in my country, a little insulting) and &quot;sir&quot; is a cultural thing: outside of India it sort of reads weirdly, but that&#39;s no reason not to use it. So I think the two conversations are unrelated. Also, I never got &quot;angry&quot;! Cheers."}], "tags": [], "owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "is_accepted": true, "score": 3, "last_activity_date": 1432744324, "creation_date": 1432744324, "answer_id": 30488259, "question_id": 30488217, "link": "https://stackoverflow.com/questions/30488217/i-am-getting-an-error-regarding-stdistream-and-int-x/30488259#30488259", "title": "I am getting an error regarding std::istream and int x", "body": "<p>You can only read into a variable:</p>\n\n<pre><code>std::cin &gt;&gt; x;\n</code></pre>\n\n<p>but you can output the value of any (suitably typed) expression:</p>\n\n<pre><code>std::cout &lt;&lt; sqr(x);\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4945682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fce362a677c96794fe9874323e988b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Dahiya", "link": "https://stackoverflow.com/users/4945682/deepak-dahiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "closed_date": 1433732005, "accepted_answer_id": 30488259, "answer_count": 1, "score": -12, "last_activity_date": 1433256170, "creation_date": 1432744184, "last_edit_date": 1433256170, "question_id": 30488217, "link": "https://stackoverflow.com/questions/30488217/i-am-getting-an-error-regarding-stdistream-and-int-x", "closed_reason": "Not suitable for this site", "title": "I am getting an error regarding std::istream and int x", "body": "<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt; \n\nint sqr ( int x ) //sqr means square of x \n{\n\n    return x * x ;\n}\n\nint _tmain(int argc, _TCHAR* argv[])\n{\n\n    std::cout &lt;&lt; \"enter ur number\";\n    int x ;\n    std::cin &gt;&gt;   sqr (x) ;\n    std::cout &lt;&lt; \"square of ur number is : \" &lt;&lt; sqr  ;\n        return 0 ;\n}\n</code></pre>\n\n<p>I just started with C++ 2 days back and while trying doing some problems I am now stuck. Please tell me what's the problem, and make the answer understandable because I'm new to the language and might not understand certain terms.</p>\n"}, {"tags": ["c++", "inheritance", "virtual-functions"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 3, "creation_date": 1432744294, "post_id": 30488193, "comment_id": 49054729, "body": "There is no virtual inheritance in your code!"}, {"owner": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "edited": false, "score": 0, "creation_date": 1432744323, "post_id": 30488193, "comment_id": 49054743, "body": "<code>I understand everything except the line p-&gt;f();</code> except there are 3 lines <code>p-&gt;f();</code>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432744328, "post_id": 30488193, "comment_id": 49054751, "body": "<code>p = (Class1*) &amp;object2;</code> Is essentially the same as <code>p = reinterpret_cast&lt;Class1*&gt; &amp;object2;</code>. So what else do you expect?"}, {"owner": {"reputation": 1217, "user_id": 3947332, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K0qp4.png?s=128&g=1", "display_name": "Dominic Farolino", "link": "https://stackoverflow.com/users/3947332/dominic-farolino"}, "reply_to_user": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "edited": false, "score": 0, "creation_date": 1432744386, "post_id": 30488193, "comment_id": 49054776, "body": "@UmNyobe sorry, specified it"}, {"owner": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "edited": false, "score": 2, "creation_date": 1432744518, "post_id": 30488193, "comment_id": 49054857, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/332030/when-should-static-cast-dynamic-cast-const-cast-and-reinterpret-cast-be-used\">When should static_cast, dynamic_cast, const_cast and reinterpret_cast be used?</a>"}, {"owner": {"reputation": 4967, "user_id": 868856, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wXvX2.png?s=128&g=1", "display_name": "Fredrick Gauss", "link": "https://stackoverflow.com/users/868856/fredrick-gauss"}, "edited": false, "score": 1, "creation_date": 1432744603, "post_id": 30488193, "comment_id": 49054904, "body": "where is the parent child relationship statements like <code>class Class2:public Class1</code> ?"}, {"owner": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "edited": false, "score": 0, "creation_date": 1432744616, "post_id": 30488193, "comment_id": 49054918, "body": "You need to understand that C style cast of address means <b><i>I am a grown man, I know better than anyone, even you compiler. It is going to be fine.</i></b>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1432744705, "post_id": 30488193, "comment_id": 49054970, "body": "@DomFarolino Remove all of those casts.  Recompile the code.  What error(s) do you get?  If you do get them, understand the errors.  All you&#39;re doing is overriding the legitimate compiler errors by using C-style casts.  So now you have a nutso program, so don&#39;t be shocked that behaves weird."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432745086, "post_id": 30488193, "comment_id": 49055172, "body": "Which book and page please"}, {"owner": {"reputation": 1217, "user_id": 3947332, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K0qp4.png?s=128&g=1", "display_name": "Dominic Farolino", "link": "https://stackoverflow.com/users/3947332/dominic-farolino"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1432745315, "post_id": 30488193, "comment_id": 49055321, "body": "@PaulMcKenzie @UmNyobe ok so the C style cast is forcing the conversion I assume, because when I just try and do something like this: <code>Class3 *c3 = new Class3(); Class1 *c1 = c3;</code> typical upcasting, it does not work, I assume because the types are totally unrelated and have no inheritance between them, and when I use C-style casting, it just forces it no matter what, and then continues doing the actions explained in Mark Ransom&#39;s answer below..is this correct?"}, {"owner": {"reputation": 1217, "user_id": 3947332, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K0qp4.png?s=128&g=1", "display_name": "Dominic Farolino", "link": "https://stackoverflow.com/users/3947332/dominic-farolino"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432745374, "post_id": 30488193, "comment_id": 49055362, "body": "@LightnessRacesinOrbit Data Structures and Algorithms in C++ by Adam Drozdek p.22 I copied the code from it"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432746292, "post_id": 30488193, "comment_id": 49055970, "body": "@DomFarolino: Looks like a (glaring) error in the book. It&#39;s worth noting that&#39;s it been an error since <i>at least</i> <a href=\"http://iit.qau.edu.pk/books/Data%20Structure%20And%20Algorithms%20In%20C++%202nd%20ed%20-%20Adam%20Drozdek.pdf\" rel=\"nofollow noreferrer\">the 2nd edition in 1995</a>, and is still there in <a href=\"http://www.amazon.co.uk/Data-Structures-Algorithms-Adam-Drozdek/dp/1133608426\" rel=\"nofollow noreferrer\">the 4th edition from 2012</a>!!! Oh dear."}, {"owner": {"reputation": 1217, "user_id": 3947332, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K0qp4.png?s=128&g=1", "display_name": "Dominic Farolino", "link": "https://stackoverflow.com/users/3947332/dominic-farolino"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432746839, "post_id": 30488193, "comment_id": 49056275, "body": "@LightnessRacesInOrbit I don&#39;t want to totally discount the book because of that but I would like to know what you would recommend as far as a good DSA book goes"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432747045, "post_id": 30488193, "comment_id": 49056403, "body": "@Dom: Well there&#39;s <a href=\"http://stackoverflow.com/q/388242/560648\">this list</a>; it is not DSA-focused, but that may not be a bad thing."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432767933, "post_id": 30488193, "comment_id": 49066742, "body": "@LightnessRacesinOrbit maybe the book is trying to say something about object layout with that example. Even though it invokes undefined behavior, the output is probably consistent enough across platforms to be useful in making a point. Unfortunately I don&#39;t have the book so I don&#39;t know the context around the code."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1432790568, "post_id": 30488193, "comment_id": 49072411, "body": "@MarkRansom: Given that it&#39;s a chapter trying to teach polymorphism, my view is that the intention is obviously inheritance."}], "answers": [{"comments": [{"owner": {"reputation": 1217, "user_id": 3947332, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K0qp4.png?s=128&g=1", "display_name": "Dominic Farolino", "link": "https://stackoverflow.com/users/3947332/dominic-farolino"}, "edited": false, "score": 0, "creation_date": 1432745183, "post_id": 30488449, "comment_id": 49055236, "body": "Thank you, it was apparent to me that it was calling the first virtual function of Class3 no matter what it was called and that confused the hell out of me. Lastly, is it the cast type that is partly at fault for this, because if I try and declare <code>Class3 *c3 = new Class3(); Class1 *c1 = c3;</code> it does not let me do this, is this because there is no inheritance (i.e. not related types?)"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 1217, "user_id": 3947332, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K0qp4.png?s=128&g=1", "display_name": "Dominic Farolino", "link": "https://stackoverflow.com/users/3947332/dominic-farolino"}, "edited": false, "score": 0, "creation_date": 1432745400, "post_id": 30488449, "comment_id": 49055384, "body": "@DomFarolino exactly, it won&#39;t let you do the assignment without casting because they&#39;re unrelated types. The explicit casts overrides the compiler&#39;s objections but opens you up to undefined behavior."}], "tags": [], "owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "is_accepted": true, "score": 5, "last_activity_date": 1432744909, "creation_date": 1432744909, "answer_id": 30488449, "question_id": 30488193, "link": "https://stackoverflow.com/questions/30488193/c-virtual-functions-acting-weird/30488449#30488449", "title": "C++ Virtual Functions Acting Weird", "body": "<p>This example is <em>bad</em>, you are casting unrelated types to each other. This results in undefined behavior.</p>\n\n<p>The code is taking advantage of the supposed similarities in layout between the different object types. The vtable will be in the same location in each object, and the virtual functions will be found by index, not name. So a call to the first virtual function of <code>Class1</code> generates a call through the table, resulting in a call to the first virtual function of <code>Class3</code>. Remember though that this is an accident and is not guaranteed by any properties of C++.</p>\n"}, {"comments": [{"owner": {"reputation": 1217, "user_id": 3947332, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K0qp4.png?s=128&g=1", "display_name": "Dominic Farolino", "link": "https://stackoverflow.com/users/3947332/dominic-farolino"}, "edited": false, "score": 0, "creation_date": 1432745509, "post_id": 30488459, "comment_id": 49055452, "body": "I understand, I did not fully understand the difference in cast types before posting this question. I just figured what the book showed me was similar to regular upcasting like <code>Right* right = bottom;</code> found here(<a href=\"http://www.phpcompiler.org/articles/virtualinheritance.html\" rel=\"nofollow noreferrer\">phpcompiler.org/articles/virtualinheritance.html</a>) however clearly it is a much more dangerous form of casting, thank you"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 5, "last_activity_date": 1432744925, "creation_date": 1432744925, "answer_id": 30488459, "question_id": 30488193, "link": "https://stackoverflow.com/questions/30488193/c-virtual-functions-acting-weird/30488459#30488459", "title": "C++ Virtual Functions Acting Weird", "body": "<blockquote>\n  <p>I just cannot figure out why it even lets us call <code>p-&gt;f()</code> when <code>Class3</code> does not inherit from <code>Class1</code>.</p>\n</blockquote>\n\n<p>This is really what you're asking. The question has nothing to do with virtual inheritance, or virtual functions. Everything in your question apart from the above text is completely irrelevant.</p>\n\n<p>This question is really why are you not prevented from doing the following at compile-time:</p>\n\n<pre><code>struct Foo\n{\n   void foo() {}\n};\n\nstruct Bar\n{\n   void bar() {}\n};\n\nint main()\n{\n   Foo f;\n   ((Bar*)&amp;f)-&gt;bar();\n}\n</code></pre>\n\n<p>The answer is that this is what C-style casts <em>do</em>: they allow you to override the type system. It's up to you to get that right and not to lie to the compiler, as you're doing at the moment. By doing so, your program has <em>undefined behaviour</em> and that's that.</p>\n"}, {"comments": [{"owner": {"reputation": 1217, "user_id": 3947332, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K0qp4.png?s=128&g=1", "display_name": "Dominic Farolino", "link": "https://stackoverflow.com/users/3947332/dominic-farolino"}, "edited": false, "score": 0, "creation_date": 1432745691, "post_id": 30488646, "comment_id": 49055576, "body": "ok that makes sense, this is what it seemed to me that the example should be, basic polymorphism and inheritance however me unknowingly using C-style casts for a horrible purpose and being perplexed at the <i>funny</i> behavior I was getting is what happened when I read this example which I see as fairly poor now"}], "tags": [], "owner": {"reputation": 11187, "user_id": 1147772, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OAgfw.jpg?s=128&g=1", "display_name": "Drax", "link": "https://stackoverflow.com/users/1147772/drax"}, "is_accepted": false, "score": 2, "last_activity_date": 1432745442, "creation_date": 1432745442, "answer_id": 30488646, "question_id": 30488193, "link": "https://stackoverflow.com/questions/30488193/c-virtual-functions-acting-weird/30488646#30488646", "title": "C++ Virtual Functions Acting Weird", "body": "<p>You or the author of the book probably just forgot the parent/child inheritance relationship to make this sample code worth something else than undefined behaviour :)</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nclass Class1 {\npublic:\n  virtual void f() {\n    cout &lt;&lt; \"Function f() in Class1\\n\";\n  }\n\n  void g() {\n    cout &lt;&lt; \"Function g() in Class1\\n\";\n  }\n};\n\nclass Class2 : public Class1 {\npublic:\n  virtual void f() {\n    cout &lt;&lt; \"Function f() in Class2\\n\";\n  }\n\n  void g() {\n    cout &lt;&lt; \"Function g() in Class2\\n\";\n  }\n};\n\nclass Class3 : public Class1 {\npublic:\n  virtual void h() {\n    cout &lt;&lt; \"Function h() in Class3\\n\";\n  }\n};\n\nint main() {\n  Class1 object1, *p;\n  Class2 object2;\n  Class3 object3;\n\n  p = &amp;object1;\n  p-&gt;f();\n  p-&gt;g();\n\n  p = (Class1*) &amp;object2;\n  p-&gt;f();\n  p-&gt;g();\n\n  p = (Class1*) &amp;object3;\n  p-&gt;f();\n  p-&gt;g();\n  // p-&gt;h(); // h() is not a member of Class1;\n  return 0;\n}\n</code></pre>\n\n<p>Which prints:</p>\n\n<pre><code>Function f() in Class1\nFunction g() in Class1\nFunction f() in Class2\nFunction g() in Class1\nFunction f() in Class1\nFunction g() in Class1\n</code></pre>\n\n<p>Which is a decent basic polymorphism example.</p>\n"}], "owner": {"reputation": 1217, "user_id": 3947332, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K0qp4.png?s=128&g=1", "display_name": "Dominic Farolino", "link": "https://stackoverflow.com/users/3947332/dominic-farolino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 30488449, "answer_count": 3, "score": 0, "last_activity_date": 1432745442, "creation_date": 1432744114, "last_edit_date": 1432744356, "question_id": 30488193, "link": "https://stackoverflow.com/questions/30488193/c-virtual-functions-acting-weird", "title": "C++ Virtual Functions Acting Weird", "body": "<p>I am trying to understand virtual functions as well as virtual inheritance. For the most part, I think I successfully grasp it and its relation to polymorphism, I have been reading how the vptr works with derived objects and what not, however the example below is throwing me off, it is one I found in an Algorithms and Data Structures in C++ book:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nclass Class1 {\npublic:\n    virtual void f() {\n        cout &lt;&lt; \"Function f() in Class1\\n\";\n    }\n\n    void g() {\n        cout &lt;&lt; \"Function g() in Class1\\n\";\n    }\n};\n\nclass Class2 {\npublic:\n    virtual void f() {\n        cout &lt;&lt; \"Function f() in Class2\\n\";\n    }\n\n    void g() {\n        cout &lt;&lt; \"Function g() in Class2\\n\";\n    }\n};\n\nclass Class3 {\npublic:\n    virtual void h() {\n        cout &lt;&lt; \"Function h() in Class3\\n\";\n    }\n};\n\nint main() {\n    Class1 object1, *p;\n    Class2 object2;\n    Class3 object3;\n\n    p = &amp;object1;\n    p-&gt;f();\n    p-&gt;g();\n\n    p = (Class1*) &amp;object2;\n    p-&gt;f();\n    p-&gt;g();\n\n    p = (Class1*) &amp;object3;\n    p-&gt;f(); // possibly abnormal program termination;\n    p-&gt;g();\n    // p-&gt;h(); // h() is not a member of Class1;\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Function f() in Class1\nFunction g() in Class1\nFunction f() in Class2\nFunction g() in Class1\nFunction h() in Class3\nFunction g() in Class1\n</code></pre>\n\n<p>I understand everything except the last <code>p-&gt;f();</code>. As a preface, I get that we cannot directly call <code>h()</code> from <code>p</code> because of the casting into a <code>Class1</code> type, but shouldn't the <code>Class3</code> vptr point only to the virtual function <code>h()</code> in its vtable, and if so, then shouldn't it look for <code>f()</code> in <code>Class3's</code> vtable and not find it? Why does it think that <code>Class1::f()</code> is <code>Class3::h()</code>, its not like <code>Class3</code> is inherited from <code>Class1</code>...and for the record, if we rewrite <code>Class3</code> to be:</p>\n\n<pre><code>class Class3 : public Class1 { // publicly inherit from Class1 is only difference\n    public:\n    virtual void h() {\n        cout &lt;&lt; \"Function h() in Class3\\n\";\n    }\n};\n</code></pre>\n\n<p>and upcast into a <code>Class1</code> pointer, and then call <code>p-&gt;f()</code> it gives us <code>Class1::f()</code> as expected, I just cannot figure out why it even lets us call <code>p-&gt;f()</code> when <code>Class3</code> does not inherit from <code>Class1</code>.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432745114, "post_id": 30488188, "comment_id": 49055185, "body": "<i>&quot;by the looks of things the program simply runs straight over it without looking at it&quot;</i> I don&#39;t understand why students keep jumping to this conclusion."}, {"owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432745167, "post_id": 30488188, "comment_id": 49055224, "body": "@LightnessRacesinOrbit I&#39;m wondering how his program &quot;ran fine&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 0, "creation_date": 1432744649, "post_id": 30488265, "comment_id": 49054938, "body": "Additionally, you are not returning a value from your array function, which should return a float, and you are taking an argument of an int array type into your array function, when the array you supply it with in your function call is of a float type. (<code>float array(int arr[], int size)</code> -&gt; <code>void array (float arr[], int size)</code>)"}], "tags": [], "owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "is_accepted": true, "score": 2, "last_activity_date": 1432744850, "last_edit_date": 1432744850, "creation_date": 1432744340, "answer_id": 30488265, "question_id": 30488188, "link": "https://stackoverflow.com/questions/30488188/using-a-function-and-an-array-to-get-the-maximum-and-minimum-value/30488265#30488265", "title": "Using a function and an array to get the maximum and minimum value", "body": "<p>You are calling your function wrong: </p>\n\n<pre><code>array[GPA, i];\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>array(GPA, i);\n</code></pre>\n\n<p>Your code shouldn't have even compiled, since I don't see an <code>array</code> variable.</p>\n\n<p>There are also a few other things wrong with your code.  <code>array</code> is probably a bad name for your function - meaningful function names are good practice, and <code>std::array</code>'s existence can cause problems.  <code>size</code> in your <code>array</code> function is unused, and as @jaggedSpire pointed out.  Your <code>array</code> function should probably be</p>\n\n<pre><code>void array(float arr[], int size)\n</code></pre>\n\n<p>assumming you start using <code>size</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 4479459, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e5e35e88927c718114615261e8d2fd7c?s=128&d=identicon&r=PG&f=1", "display_name": "frendall", "link": "https://stackoverflow.com/users/4479459/frendall"}, "is_accepted": false, "score": 0, "last_activity_date": 1432745197, "creation_date": 1432745197, "answer_id": 30488554, "question_id": 30488188, "link": "https://stackoverflow.com/questions/30488188/using-a-function-and-an-array-to-get-the-maximum-and-minimum-value/30488554#30488554", "title": "Using a function and an array to get the maximum and minimum value", "body": "<p>Hi I am quite new to programming but I think your function call array[GPA,i]\nshould be array(GPA,i); and move it further down to just above return.\nits my first attempt at answering a question hope it helps.</p>\n"}], "owner": {"reputation": 3, "user_id": 4945652, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205137837698017/picture?type=large", "display_name": "Alex Farrell", "link": "https://stackoverflow.com/users/4945652/alex-farrell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1336, "favorite_count": 0, "accepted_answer_id": 30488265, "answer_count": 2, "score": 0, "last_activity_date": 1432745197, "creation_date": 1432744109, "last_edit_date": 1432744501, "question_id": 30488188, "link": "https://stackoverflow.com/questions/30488188/using-a-function-and-an-array-to-get-the-maximum-and-minimum-value", "title": "Using a function and an array to get the maximum and minimum value", "body": "<p>I am having some trouble getting my program to find the maximum and minimum values for a set of students GPA's. I can do this easily without using a function but when I include the function my program still runs fine but it does not calculate the maximum and minimum GPA's. I have debugged it as well and by the looks of things the program simply runs straight over it without looking at it. Your help would be greatly appreciated. This is what my code currently looks like: </p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nfloat array(int arr[], int size)\n{\n    float max = 0;\n    float min = 4;\n    int i;\n\n    for (i = 0; i &lt;= 2; i++)\n    {\n        if (arr[i] &gt; max)\n            max = arr[i];\n\n        if (arr[i] &lt; min)\n            min = arr[i];\n    }\n    cout &lt;&lt; \"Maximum GPA: \" &lt;&lt; max;\n    cout &lt;&lt; \"Minimum GPA: \" &lt;&lt; min;\n\n}\nint main(int argc, char** argv)\n{\n    int ID[3];\n    float GPA[3];\n    int i;\n\n    for (i = 0; i &lt;= 2; i++)\n    {\n        cout &lt;&lt; \"Please enter student ID and GPA: \" &lt;&lt; endl;\n        cin &gt;&gt; ID[i] &gt;&gt; GPA[i];\n        array[GPA, i];\n    }\n    for (i = 0; i &lt;= 2; i++)\n    {\n        cout &lt;&lt; endl &lt;&lt; \"Student ID: \" &lt;&lt; ID[i] &lt;&lt; endl &lt;&lt; \"Student GPA: \" &lt;&lt; GPA[i] &lt;&lt; endl;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "operator-overloading", "copy-constructor"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432743858, "post_id": 30488080, "comment_id": 49054433, "body": "Why do you mark &quot;copy constructor&quot; with code formatting? Weird."}, {"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432744031, "post_id": 30488080, "comment_id": 49054564, "body": "I was trying to watch how those functions are getting called."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432744211, "post_id": 30488080, "comment_id": 49054679, "body": "No, I mean, in the body of your question. I&#39;ll correct it."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 181910, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/212aa26b2f5caaa80d56307ccb7f0176?s=128&d=identicon&r=PG", "display_name": "jaklucky", "link": "https://stackoverflow.com/users/181910/jaklucky"}, "edited": false, "score": 0, "creation_date": 1432744074, "post_id": 30488127, "comment_id": 49054584, "body": "Compiler can call move on line three for optimization."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 153, "user_id": 181910, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/212aa26b2f5caaa80d56307ccb7f0176?s=128&d=identicon&r=PG", "display_name": "jaklucky", "link": "https://stackoverflow.com/users/181910/jaklucky"}, "edited": false, "score": 0, "creation_date": 1432744134, "post_id": 30488127, "comment_id": 49054629, "body": "@jaklucky: The OP&#39;s type has no move constructor (<code>[C++11: 12.8&#47;9]</code>)."}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1432744204, "post_id": 30488127, "comment_id": 49054675, "body": "And if it did, it&#39;s not an optional optimization. If it doesn&#39;t elide, the compiler <i>must</i> call the move constructor instead of the copy constructor where it is applicable."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432744301, "post_id": 30488127, "comment_id": 49054734, "body": "... making it not really an &quot;optimisation&quot; at all."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 3, "last_activity_date": 1432743919, "creation_date": 1432743919, "answer_id": 30488127, "question_id": 30488080, "link": "https://stackoverflow.com/questions/30488080/understanding-copy-constructor-in-c/30488127#30488127", "title": "Understanding copy constructor in C++", "body": "<p>The compiler is optimising out the copy constructor call here, because the standard explicitly allows that copy to be \"elided\". What would be the point in such a copy, really?</p>\n\n<p>You're absolutely right though, in that it's an <em>opportunity</em> for invocation of the copy constructor, and the compiler <em>could</em> do it. In fact, the standard does require that invoking the copy constructor be valid here.</p>\n"}], "owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "closed_date": 1432743998, "accepted_answer_id": 30488127, "answer_count": 1, "score": 1, "last_activity_date": 1432744266, "creation_date": 1432743799, "last_edit_date": 1432744266, "question_id": 30488080, "link": "https://stackoverflow.com/questions/30488080/understanding-copy-constructor-in-c", "closed_reason": "Duplicate", "title": "Understanding copy constructor in C++", "body": "<p>I am trying to understand the concept of copy constructors in C++. I have written the following program:</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nclass Box{\n    private:\n        int d;\n    public:\n        Box(int i){\n            cout &lt;&lt; \"Constructor\" &lt;&lt; endl;\n            d = i;\n        }\n        Box(const Box &amp;old){\n            cout &lt;&lt; \"Copy Constructor\" &lt;&lt; endl;\n            d = old.d;\n        }\n        int getd(){\n            return d;\n        }\n        ~Box(){\n            cout &lt;&lt; \"Destructor\" &lt;&lt; endl;\n        }\n        Box operator+(const Box&amp; op){\n            Box c(15);\n            c.d = d + op.d;\n            return c;\n        }\n};\n\nint main(){\n    Box a(10);\n    Box b = a;\n    Box c = a+b;\n    cout &lt;&lt; c.getd() &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>The output of this program is as follows:</p>\n\n<pre><code>Constructor\nCopy Constructor\nConstructor\n20\nDestructor\nDestructor\nDestructor\n</code></pre>\n\n<p>I don't understand why the copy constructor isn't getting called for the third line in the <code>main</code> function. I think that there should be a call to the copy constructor as <code>operator+</code> function returns by value.</p>\n"}, {"tags": ["c++", "constants"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1432743589, "post_id": 30487884, "comment_id": 49054267, "body": "There&#39;s nothing <i>wrong</i> with doing that, but it&#39;s very likely not to be intended. So this is a question of how much you want to help the programmer avoid silly mistakes."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1432743769, "post_id": 30487884, "comment_id": 49054378, "body": "@Kerrek y u write answer in comments"}], "answers": [{"comments": [{"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "edited": false, "score": 0, "creation_date": 1432743604, "post_id": 30487981, "comment_id": 49054274, "body": "So it&#39;s not an lvalue. Why  could it appear at the left hand side of the = operator ever?"}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "reply_to_user": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "edited": false, "score": 2, "creation_date": 1432743656, "post_id": 30487981, "comment_id": 49054309, "body": "@St.Antario: Because, for class types like this, <code>operator=()</code> is a member function, and you can call member functions on <i>rvalues</i>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "edited": false, "score": 0, "creation_date": 1432743822, "post_id": 30487981, "comment_id": 49054406, "body": "@St.Antario: The restriction to have lvalues on the LHS of <code>=</code> applies to the built-in <code>=</code> operations (i.e. not <code>operator=</code> calls in user-defined types), not to literally any utterance of the symbol."}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "edited": false, "score": 0, "creation_date": 1432743968, "post_id": 30487981, "comment_id": 49054522, "body": "<a href=\"http://coliru.stacked-crooked.com/a/7d10a8c5cf66d504\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/7d10a8c5cf66d504</a> Couldn&#39;t you explain what compiler&#39;s trying to say by that message. <b>error: passing &#39;const Rational&#39; as &#39;this&#39; argument discards qualifiers</b> I was confused by discarding qualifiers..."}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "reply_to_user": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "edited": false, "score": 0, "creation_date": 1432744096, "post_id": 30487981, "comment_id": 49054605, "body": "@St.Antario: It means the assignment is trying to call the non-<code>const</code> member function <code>operator=()</code> on a <code>const</code> object - doing so would discard the <code>const</code> qualifier, which isn&#39;t allowed. The <code>const</code> prevents the assignment, which is why Meyers suggested it (long before move semantics made it a bad idea)."}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "edited": false, "score": 0, "creation_date": 1432789468, "post_id": 30487981, "comment_id": 49072019, "body": "@MikeSeymour I&#39;ve read about operators in the 13.5.3 chapter of the current standard and it&#39;s not quite clear how making const of the return value affects the move semantic. Couldn&#39;t you give a little explanation or point me out to the paragraph in the standard?"}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "reply_to_user": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "edited": false, "score": 0, "creation_date": 1432805215, "post_id": 30487981, "comment_id": 49080743, "body": "@St.Antario Moving from an object might change it, and you can&#39;t change a constant. Therefore you can&#39;t move from a constant, only copy it."}], "tags": [], "owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "is_accepted": true, "score": 7, "last_activity_date": 1432743496, "creation_date": 1432743496, "answer_id": 30487981, "question_id": 30487884, "link": "https://stackoverflow.com/questions/30487884/understanding-const-operator/30487981#30487981", "title": "Understanding const operator", "body": "<p>The result of <code>a*b</code> is a temporary value, which will disappear at the end of the statement. Assigning to it would be weird, since you wouldn't be able to do anything with it after the assignment.</p>\n\n<p>However, the fact that it's weird doesn't necessarily justify adding more weirdness to prevent it. In modern C++, it's a bad idea to return a <code>const</code> object like this since it inhibits move semantics.</p>\n"}, {"tags": [], "owner": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "is_accepted": false, "score": 2, "last_activity_date": 1432743544, "creation_date": 1432743544, "answer_id": 30487999, "question_id": 30487884, "link": "https://stackoverflow.com/questions/30487884/understanding-const-operator/30487999#30487999", "title": "Understanding const operator", "body": "<p>What is wrong or weird is that the operator= is invoked on a object which will be destructed at the end of the statement (ie at <code>;</code>).</p>\n"}], "owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 30487981, "answer_count": 2, "score": 1, "last_activity_date": 1432743544, "creation_date": 1432743243, "question_id": 30487884, "link": "https://stackoverflow.com/questions/30487884/understanding-const-operator", "title": "Understanding const operator", "body": "<p>I'm reading Scott Meyers' book and come across the following example:</p>\n\n<pre><code>class Rational { ... };\nconst Rational operator*(const Rational&amp; lhs, const Rational&amp; rhs);\n\nRational a, b, c;\n...\n(a * b) = c; // invoke operator= on the\n// result of a*b!\n</code></pre>\n\n<p>He said that it was really wierd thing, but I didn't see why. What's wrong with the invokation of the <code>operator=</code> on the result of <code>a*b</code>?</p>\n"}, {"tags": ["c++", "templates", "c++11", "ostream"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 2, "creation_date": 1432743554, "post_id": 30487846, "comment_id": 49054241, "body": "You might be able to solve this with SFINAE and type traits, but I really think you could save yourself a lot of delicate coding by just using dynamic polymorphism here and making <code>Stringifiable</code> an abstract base class. Life&#39;s too short to be finding compile-time solutions for everything."}, {"owner": {"reputation": 4368, "user_id": 2352158, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/91cd5bff136b9c7608cf986ca729e19a?s=128&d=identicon&r=PG", "display_name": "coincoin", "link": "https://stackoverflow.com/users/2352158/coincoin"}, "edited": false, "score": 0, "creation_date": 1432743949, "post_id": 30487846, "comment_id": 49054507, "body": "Thank you Ike for your proposition. So every stringifiable classes has to be derived from <code>Stringifiable</code> ? It seems like I would need to write quite some codes which would not be really different from the &quot;classical&quot; way. I woud like to avoid that. I also may have misunderstood your point."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1432744590, "post_id": 30487846, "comment_id": 49054898, "body": "The answers in the duplicate check for <code>to_string(T{})</code>, you need to check for <code>T{}.to_str()</code>, but basically same idea."}], "owner": {"reputation": 4368, "user_id": 2352158, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/91cd5bff136b9c7608cf986ca729e19a?s=128&d=identicon&r=PG", "display_name": "coincoin", "link": "https://stackoverflow.com/users/2352158/coincoin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1432744559, "answer_count": 0, "score": 3, "last_activity_date": 1432743131, "creation_date": 1432743131, "question_id": 30487846, "link": "https://stackoverflow.com/questions/30487846/generic-operator-ostream-c-for-stringifiable-class", "closed_reason": "Duplicate", "title": "Generic operator&lt;&lt; ostream C++ for stringifiable class", "body": "<p>Is it possible to have a templated generic <code>&lt;&lt;ostream</code> operator which would work for any class which owns a <code>to_string()</code> method ?\nFor instance the following code : </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstruct A {\n    int a;\n    std::string to_str() const { return std::to_string(a); }\n};\n\nstruct B {\n    std::string b;\n    std::string to_str() const { return b; }\n};\n\ntemplate&lt;class Stringifiable&gt;\nstd::ostream&amp; operator&lt;&lt; (std::ostream&amp; os, const Stringifiable&amp; s) {\n    os &lt;&lt; s.to_str();\n    return os;\n}\n\nint main() {\n    A a{3};\n    B b{\"hello\"};\n    std::cout &lt;&lt; a &lt;&lt; b &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>does not compile. Errors given are of the type :</p>\n\n<pre><code>prog.cpp: In instantiation of 'std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const Stringifiable&amp;) [with Stringifiable = A; std::ostream = std::basic_ostream&lt;char&gt;]':\nprog.cpp:23:15:   required from here\nprog.cpp:16:5: error: ambiguous overload for 'operator&lt;&lt;' (operand types are 'std::ostream {aka std::basic_ostream&lt;char&gt;}' and 'std::string {aka std::basic_string&lt;char&gt;}')\n  os &lt;&lt; s.to_str();\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 4, "creation_date": 1432743053, "post_id": 30487800, "comment_id": 49053918, "body": "Why would it return <code>char</code>? it returns the difference between the strings."}, {"owner": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1432743120, "post_id": 30487800, "comment_id": 49053959, "body": "Yes but doesn&#39;t it stop upon seeing the first non-matching character? Then the result must be fitting into a char. Is that wrong?"}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 0, "creation_date": 1432743128, "post_id": 30487800, "comment_id": 49053968, "body": "What if the difference is 255?"}, {"owner": {"reputation": 503, "user_id": 1280961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mtA9d.jpg?s=128&g=1", "display_name": "wonko realtime", "link": "https://stackoverflow.com/users/1280961/wonko-realtime"}, "edited": false, "score": 1, "creation_date": 1432743343, "post_id": 30487800, "comment_id": 49054101, "body": "see <a href=\"http://stackoverflow.com/questions/163254/on-32-bit-cpus-is-an-integer-type-more-efficient-than-a-short-type\" title=\"on 32 bit cpus is an integer type more efficient than a short type\">stackoverflow.com/questions/163254/&hellip;</a>"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 6, "creation_date": 1432743435, "post_id": 30487800, "comment_id": 49054158, "body": "The difference between two 8-bit chars will be between -255 and 255, and that range doesn&#39;t fit in a char."}, {"owner": {"reputation": 503, "user_id": 1280961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mtA9d.jpg?s=128&g=1", "display_name": "wonko realtime", "link": "https://stackoverflow.com/users/1280961/wonko-realtime"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1432744144, "post_id": 30487800, "comment_id": 49054637, "body": "@interjay only the sign is the same (which probably was formulated this way in the hope that it would make explanation easier) but not more. strcmp only defines three results, where one is strictly lower than zero (and most of the times -1 maybe, but might change all the time afaik), one is exactly zero and the last one always higher than zero. See <a href=\"http://www.cplusplus.com/reference/cstring/strcmp/\" rel=\"nofollow noreferrer\">here</a> for an alternative description."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "reply_to_user": {"reputation": 503, "user_id": 1280961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mtA9d.jpg?s=128&g=1", "display_name": "wonko realtime", "link": "https://stackoverflow.com/users/1280961/wonko-realtime"}, "edited": false, "score": 4, "creation_date": 1432744253, "post_id": 30487800, "comment_id": 49054699, "body": "@wonkorealtime I know that. I was only pointing out that the OP is wrong in assuming that the difference between two chars can be stored in a char."}, {"owner": {"reputation": 1419, "user_id": 3126790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lzjzz.jpg?s=128&g=1", "display_name": "Filip Veli\u010dkovi\u0107", "link": "https://stackoverflow.com/users/3126790/filip-veli%c4%8dkovi%c4%87"}, "edited": false, "score": 0, "creation_date": 1432779906, "post_id": 30487800, "comment_id": 49069601, "body": "Really weird question that I have ever seen... strcmp() is to supposed to return only -1, 0, 1... which looks pretty convenient to almost all the developers and it&#39;s the OP of this function. Seeing the first non-matching character won&#39;t even return each string&#39;s precedence. What&#39;s the use?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1433126893, "post_id": 30487800, "comment_id": 49201040, "body": "&quot;Since chars are being compared, their difference fits into a char in all cases&quot; - this is not true for signed chars. For example the difference between <code>127</code> and <code>-2</code> is <code>129</code> which doesn&#39;t fit into a signed char.   Nor can the return value be <code>unsigned char</code> because they can&#39;t be negative."}], "answers": [{"comments": [{"owner": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 0, "creation_date": 1432744865, "post_id": 30487879, "comment_id": 49055044, "body": "On the requirement to represent negative values: I guess that the function might have returned, say, 0 for negative, 1 for equal and 2 for greater, since as far as I understand, the function does not give any guarantees about the return value will represent the difference between first pair of non-matching characters. If that&#39;s the case, the function might have returned char right? So I wonder if could there be a more fundamental reason?"}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "reply_to_user": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 0, "creation_date": 1432745067, "post_id": 30487879, "comment_id": 49055165, "body": "@Utku: Yes, it could have encoded the result in a different way and not required a signed type. But it would probably have returned <code>int</code> anyway, since that&#39;s the natural size for a function return value. And the encoding would probably be less efficient than the obvious implementation of <code>if (c1 != c2) return c1 - c2;</code>"}, {"owner": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "reply_to_user": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 0, "creation_date": 1432745242, "post_id": 30487879, "comment_id": 49055279, "body": "@Utku In mathematical terms <code>a &lt; b implies strcmp(a,b) &lt; 0</code> is more sound than <code>a &lt; b implies strcmp(a,b) = 1</code>"}, {"owner": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "reply_to_user": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "edited": false, "score": 0, "creation_date": 1432745410, "post_id": 30487879, "comment_id": 49055392, "body": "@UmNyobe Of course, but I speculated that it might have been done in the purpose of saving memory, unless there is another reason not to."}, {"owner": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 0, "creation_date": 1432746081, "post_id": 30487879, "comment_id": 49055825, "body": "@MikeSeymour But why using a &quot;natural size&quot; for return values is so important? Could you point out a resource on the importance of using natural size for function return values?"}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 0, "creation_date": 1432747897, "post_id": 30487879, "comment_id": 49056886, "body": "@uktu It&#39;s not particularly important, just the natural thing to do given a type whose size has been chosen to be efficient to pass around."}, {"owner": {"reputation": 4269, "user_id": 567326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ecb18cd54a1e3a9b76ffdd59d412a?s=128&d=identicon&r=PG", "display_name": "rskar", "link": "https://stackoverflow.com/users/567326/rskar"}, "edited": false, "score": 8, "creation_date": 1432748257, "post_id": 30487879, "comment_id": 49057102, "body": "A &quot;natural size&quot; <code>int</code> is a consequence of CPU design (see <a href=\"http://stackoverflow.com/questions/2331751/does-the-size-of-an-int-depend-on-the-compiler-and-or-processor\" title=\"does the size of an int depend on the compiler and or processor\">stackoverflow.com/questions/2331751/&hellip;</a>). One aspect of CPU design consideration generally respected by compiler writers is &quot;word alignment&quot; (see <a href=\"http://stackoverflow.com/questions/381244/purpose-of-memory-alignment\" title=\"purpose of memory alignment\">stackoverflow.com/questions/381244/purpose-of-memory-alignme&zwnj;&#8203;nt</a>). This consideration of &quot;word alignment&quot; would then guide the implementation of &quot;stack frames&quot; (see <a href=\"http://stackoverflow.com/questions/10057443/explain-the-concept-of-a-stack-frame-in-a-nutshell\" title=\"explain the concept of a stack frame in a nutshell\">stackoverflow.com/questions/10057443/&hellip;</a>)."}, {"owner": {"reputation": 4269, "user_id": 567326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ecb18cd54a1e3a9b76ffdd59d412a?s=128&d=identicon&r=PG", "display_name": "rskar", "link": "https://stackoverflow.com/users/567326/rskar"}, "edited": false, "score": 1, "creation_date": 1432748265, "post_id": 30487879, "comment_id": 49057109, "body": "Hence, for the sake of CPU efficiency and reliable compilation (not to mention skirting any chance of an unintended promotion or non-promotion, per platform implementation or compiler settings), the library writer(s) explicitly made the result returned into an <code>int</code>. That would be my guess, anyway."}], "tags": [], "owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "is_accepted": false, "score": 28, "last_activity_date": 1432743225, "creation_date": 1432743225, "answer_id": 30487879, "question_id": 30487800, "link": "https://stackoverflow.com/questions/30487800/why-strcmp-returns-int-but-not-char/30487879#30487879", "title": "Why strcmp returns int but not char?", "body": "<p><code>char</code> may or may not be signed. <code>strcmp</code> must return a signed type, so that it can be negative if the difference is negative.</p>\n\n<p>More generally, <code>int</code> is preferred for passing and returning simple numerical values, since it's defined as the \"natural\" size for such values and, on some platforms, is more efficient to deal with than smaller types.</p>\n"}, {"comments": [{"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1432743760, "post_id": 30487906, "comment_id": 49054371, "body": "@interjay: That may be for <code>getchar</code>, but for <code>isalpha</code> is useless. It looks like they said: &quot;look, we can accept EOF here and type <code>isalpha(getchar())</code>&quot;."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1432744582, "post_id": 30487906, "comment_id": 49054892, "body": "It&#39;s actually worse than useless, because it makes passing a <code>char</code> to <code>isalpha</code> wrong (you need to cast it to <code>unsigned char</code> first)."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1432748054, "post_id": 30487906, "comment_id": 49056979, "body": "@interjay: You only need to cast it if it is a char-as-char. If you have a proper char-as-integer, then it is fine: &#39;char x=getchar(); isalpha(x);` wrong! <code>int x=getchar(); isalpha(x);&quot; ok! Curiously, </code>isalpha(&#39;&#241;&#39;)` is ok in C but undefined in C++!"}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 0, "creation_date": 1432752269, "post_id": 30487906, "comment_id": 49059355, "body": "@rodrigo I don&#39;t think that&#39;s true - <code>&#39;&#241;&#39;</code> is an int in C, yes, but it will still have the same negative value."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 0, "creation_date": 1432752460, "post_id": 30487906, "comment_id": 49059454, "body": "@Random832: Hmmm, I&#39;ve just checked and you are right. Now I wonder why using GCC and Latin-1 encoding,<code>&#39;&#241;&#39;</code> is <code>-15</code> and not <code>241</code>."}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 0, "creation_date": 1432752464, "post_id": 30487906, "comment_id": 49059456, "body": "Also, for isalpha, it originally had isascii as a prerequisite (i.e. you needed to check <code>isascii(x) &amp;&amp; isalpha(x)</code>), in the pre-ANSI days."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 0, "creation_date": 1433127906, "post_id": 30487906, "comment_id": 49201195, "body": "@Random832: rodrigo was right the first time. <code>getchar()</code> returns either the negative value <code>EOF</code> (typically <code>-1</code>) <b>or</b> the next input character *as an <code>unsigned char</code> converted to an <code>int</code>. So assuming Latin-1, <code>getchar()</code> will return 241 for <code>&#39;&#241;&#39;</code>. Storing that value in a plain <code>char (if plain </code>char` is signed) will convert the <code>241</code> to <code>(char)-15</code>."}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1433128065, "post_id": 30487906, "comment_id": 49201224, "body": "@KeithThompson However, his allusion to it being different in C++ made it clear he was talking about using the <i>character literal</i> <code>&#39;&#241;&#39;</code> (which is a char in C++, but an int [but still with the value of a plain char] in C), not a char variable as a result of getchar or whatever."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1433145206, "post_id": 30487906, "comment_id": 49207050, "body": "@KeithThompson: Rangom832 is right. I was mistaken about the value of the character literal. Now I don&#39;t understand why <code>getchar()</code> reading a latin-1 <code>&#39;&#241;&#39;</code> returns <code>(int)241</code> but the literal <code>&#39;&#241;&#39;</code> is <code>(int)-15</code>. It is madness!"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1433170695, "post_id": 30487906, "comment_id": 49223599, "body": "@rodrigo: In C, a character constant is of type <code>int</code>; the value is that of the corresponding <code>char</code> value. If plain <code>char</code> is signed, certain character constants can be negative. In C++, the value of <code>&#39;&#241;&#39;</code> is also negative (again assuming plain <code>char</code> is signed); the difference is that its type is <code>char</code>."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1433176699, "post_id": 30487906, "comment_id": 49227499, "body": "@KeithThompson: Yeah, I know that now. And <code>getchar()</code> is defined as reading &quot;<i>the next byte as an <b>unsigned char</b> converted to an int</i>&quot; so everything is perfectly defined. I just find surprising that I have to write <code>(unsigned char)&#39;&#241;&#39;</code> to get the proper value of a character."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1433178857, "post_id": 30487906, "comment_id": 49228737, "body": "@rodrigo: That&#39;s assuming you&#39;re using Latin-1. With my setup, for example, I&#39;m not even sure how to enter a Latin-1 <code>&#39;&#241;&#39;</code> character in a text file; if I type or copy-and-paste it, I get a UTF-8 2-byte sequence."}], "tags": [], "owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "is_accepted": false, "score": 3, "last_activity_date": 1432743303, "creation_date": 1432743303, "answer_id": 30487906, "question_id": 30487800, "link": "https://stackoverflow.com/questions/30487800/why-strcmp-returns-int-but-not-char/30487906#30487906", "title": "Why strcmp returns int but not char?", "body": "<p>AFAIK, the standard C library doesn't have a single function that takes or returns values of type <code>char</code>. It has arguments and return types of type <code>char*</code> or <code>const char*</code> but not plain <code>char</code>.</p>\n\n<p>Look for example at <code>int isalpha(int c);</code> for a more shocking instance.</p>\n\n<p>I don't know why, but I can guess. Maybe it is due to the ABI. In any ABI I know, any argument or return value of type <code>char</code> is internally promoted to <code>int</code> anyway, so there is no point in doing it. It acutally will make the code <em>less</em> efficient, as you will need to do the truncating each time the function is used.</p>\n"}, {"comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1432765474, "post_id": 30488010, "comment_id": 49065921, "body": "... Why do you have a PDP-11 available to test stuff on?"}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1432766002, "post_id": 30488010, "comment_id": 49066123, "body": "@immibis It&#39;s emulated, of course. And V7 does handle it properly; but my point stands that it costs extra instructions to convert it, and still more to make sure out-of-range values are handled correctly, and that there&#39;s no real benefit to returning a char."}], "tags": [], "owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "is_accepted": true, "score": 11, "last_activity_date": 1432750512, "last_edit_date": 1432750512, "creation_date": 1432743581, "answer_id": 30488010, "question_id": 30487800, "link": "https://stackoverflow.com/questions/30487800/why-strcmp-returns-int-but-not-char/30488010#30488010", "title": "Why strcmp returns int but not char?", "body": "<p>Of course, despite the overflow possibility others have mentioned, it only <em>needs</em> to be able to return e.g. -1, 0, or 1 - which easily fit in a signed char. The real historical reason for this is that in the original version of C in the 1970s, functions <em>couldn't</em> return a char, and any attempt to do so resulted in returning an int.</p>\n\n<p>In these early compilers, int was also the default type (many situations, including function return values as seen in main below, allowed you to declare something as int without actually using the int keyword), so it made sense to define any function that didn't specifically need to return a different type as returning an int.</p>\n\n<p>Even now, a char return simply sign-extends the value into the int return register (r0 on pdp11, eax on x86), anyway. Treating it as a char would not have any performance benefit, whereas allowing it to be the actual difference rather than forcing it to be -1 or 1 did have a small performance benefit. And axiac's answer also makes the good point that it would have had to be promoted back to an int anyway, for the comparison operator. The reason for these promotions is also historical, incidentally, it was so that the compiler did not have to implement separate operators for every possible combination of char and int, especially since the comparison instructions on many processors only works with an int anyway.</p>\n\n<hr>\n\n<p>Proof: If I make a test program on Unix V6 for PDP-11, the char type is silently ignored and an integer value outside the range is returned:</p>\n\n<pre><code>char foo() {\n    return 257;\n}\n\nmain() {\n    printf(\"%d\\n\", foo());\n    return 0;\n}\n\n# cc foo.c\n# a.out\n257\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 0, "creation_date": 1432745286, "post_id": 30488433, "comment_id": 49055309, "body": "So, the reason is the fact that arithmetic operators always operate on int, and any other type that is an operand of an arithmetic operator is <i>always</i> implicitly converted to int?"}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "reply_to_user": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 0, "creation_date": 1432752157, "post_id": 30488433, "comment_id": 49059295, "body": "@Utku Not <i>always</i> per se, only when it&#39;s char or short."}], "tags": [], "owner": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "is_accepted": false, "score": 3, "last_activity_date": 1432745478, "last_edit_date": 1495542139, "creation_date": 1432744857, "answer_id": 30488433, "question_id": 30487800, "link": "https://stackoverflow.com/questions/30487800/why-strcmp-returns-int-but-not-char/30488433#30488433", "title": "Why strcmp returns int but not char?", "body": "<p>One possible reason why <code>strcmp()</code> promotes the values it returns to <code>int</code> is to spare a processor instruction in the calling code.</p>\n\n<p>Usually (always?) the value returned by <code>strcmp()</code> is used with a <a href=\"http://en.cppreference.com/w/c/language/operator_comparison\" rel=\"nofollow noreferrer\">comparison operator</a>.</p>\n\n<p>Let's see what happens with the operands of comparison operators.</p>\n\n<blockquote>\n  <p><strong>Usual arithmetic conversions</strong></p>\n  \n  <p>The arguments of the following arithmetic operators undergo implicit conversions for the purpose of obtaining the common real type, which is the type in which the calculation is performed:</p>\n  \n  <ul>\n  <li>binary arithmetic <code>*</code>, <code>/</code>, <code>%</code>, <code>+</code>, <code>-</code></li>\n  <li>relational operators <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code> </li>\n  <li>binary bitwise arithmetic <code>&amp;</code>, <code>^</code>, <code>|</code></li>\n  <li>the conditional operator <code>?:</code></li>\n  </ul>\n  \n  <p>...</p>\n  \n  <p>4) Otherwise, both operands are integers. In that case,</p>\n  \n  <p>First of all, both operands undergo integer promotions.<br>\n  ...</p>\n</blockquote>\n\n<p><em>(source: <a href=\"http://en.cppreference.com/w/c/language/conversion#Usual_arithmetic_conversions\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/language/conversion#Usual_arithmetic_conversions</a>)</em></p>\n\n<blockquote>\n  <p><strong>Integer promotions</strong></p>\n  \n  <p>Integer promotion is the implicit conversion of a value of any integer type with rank less or equal to rank of int or of a bit field of type _Bool, int, signed int, unsigned int, to the value of type <code>int</code> or <code>unsigned int</code>.</p>\n</blockquote>\n\n<p><em>(source: <a href=\"http://en.cppreference.com/w/c/language/conversion#Integer_promotions\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/language/conversion#Integer_promotions</a>)</em></p>\n\n<h3>Back to <code>strcmp()</code></h3>\n\n<p>As you can see from the quotes above, a possible <code>char</code> value returned by <code>strcmp()</code> is promoted to <code>int</code> anyway.</p>\n\n<h3>Why did the creators of C chose to return an <code>int</code>?</h3>\n\n<p>For a very simple reason: because the promotion is going to happen anyway and because (at least) one processor instruction is needed to perform the promotion, its more convenient to add that instruction to the code of <code>strcmp()</code> (i.e. in a single place) than everywhere the <code>strcmp()</code> function is called.</p>\n\n<p>Back in the 70s both the memory and the CPU were very valuable resources. An optimization that now seems insignificant (a couple of bytes of memory saved here and there, maybe in several dozen places in the code) had much more importance back then.</p>\n\n<h3>Update:</h3>\n\n<p>On a second thought, I think the historical reasons provided by <a href=\"https://stackoverflow.com/a/30488010/4265352\">this answer</a> and <a href=\"https://stackoverflow.com/a/30487879/4265352\">this answer</a> are more accurate than mine.</p>\n"}], "owner": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1172, "favorite_count": 1, "accepted_answer_id": 30488010, "answer_count": 4, "score": 14, "last_activity_date": 1433124929, "creation_date": 1432743001, "question_id": 30487800, "link": "https://stackoverflow.com/questions/30487800/why-strcmp-returns-int-but-not-char", "title": "Why strcmp returns int but not char?", "body": "<p>As far as I know, the only difference between variable types such as <code>char</code>, <code>int</code> etc. is the amount of memory they occupy. I guess that they have no role in regulating what the variable they are holding represents. If that's true, in <a href=\"http://www.gnu.org/software/libc/manual/html_node/String_002fArray-Comparison.html\" rel=\"noreferrer\">here</a>, I have seen the following for <code>strcmp</code>:</p>\n\n<blockquote>\n  <p>The strcmp function compares the string s1 against s2, returning a\n  value that has the same sign as the difference between the first\n  differing pair of characters (interpreted as unsigned char objects,\n  then promoted to int).</p>\n</blockquote>\n\n<p>I want to ask why is the result promoted to <code>int</code>? Since <code>char</code>s are being compared, their difference fits into a <code>char</code> in all cases. So isn't promoting the result to <code>int</code> simply appending bunch of 0's at the end of the result? So, why is this done?</p>\n"}, {"tags": ["c++", "multiple-inheritance", "dynamic-cast"], "comments": [{"owner": {"reputation": 70803, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 2, "creation_date": 1432743643, "post_id": 30487799, "comment_id": 49054298, "body": "Why not post an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>?  You were so close.  You just needed to include <code>iostream</code> and <code>vector</code> at the top of this file.  It will make it easier for others to reproduce your problem and work on it."}, {"owner": {"reputation": 8889, "user_id": 4538344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746edd669e07914179feb9f6957a06e3?s=128&d=identicon&r=PG", "display_name": "StenSoft", "link": "https://stackoverflow.com/users/4538344/stensoft"}, "edited": false, "score": 1, "creation_date": 1432743896, "post_id": 30487799, "comment_id": 49054461, "body": "Why don&#39;t you make it polymorphic by defining virtual destructor in <code>BaseA</code>?"}, {"owner": {"reputation": 70803, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1432743934, "post_id": 30487799, "comment_id": 49054495, "body": "Another good thing to do is to include the exact error message you are getting from the compiler, which is &quot;error: cannot dynamic_cast &#39;Aptr&#39; (of type &#39;class BaseA*&#39;) to type &#39;class BaseB*&#39; (source type is not polymorphic)&quot;.  By performing an internet search for the key words in that error message, you can find other people who have had the exact same problem as you and solved it by making BaseA be polymorphic: <a href=\"http://stackoverflow.com/questions/15114093/c11-source-type-is-not-polymorphic\" title=\"c11 source type is not polymorphic\">stackoverflow.com/questions/15114093/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3796, "user_id": 4859885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HcTm.jpg?s=128&g=1", "display_name": "Brian Rodriguez", "link": "https://stackoverflow.com/users/4859885/brian-rodriguez"}, "edited": false, "score": 0, "creation_date": 1432745774, "post_id": 30488125, "comment_id": 49055623, "body": "So simple! :) thank you"}], "tags": [], "owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "is_accepted": true, "score": 4, "last_activity_date": 1432743953, "last_edit_date": 1432743953, "creation_date": 1432743916, "answer_id": 30488125, "question_id": 30487799, "link": "https://stackoverflow.com/questions/30487799/c-check-if-most-derived-class-of-a-base-reference-has-another-base/30488125#30488125", "title": "c++ Check if most derived class of a base reference has another base", "body": "<p>Make <code>BaseA</code> polymorphic. The simplest way to do this is to give it a virtual destructor. </p>\n\n<pre><code>class BaseA\n{\npublic:\n    virtual ~BaseA() {}\n};\n</code></pre>\n\n<p>You'll need one anyway, if you want to fix the memory leaks in your example.</p>\n"}], "owner": {"reputation": 3796, "user_id": 4859885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HcTm.jpg?s=128&g=1", "display_name": "Brian Rodriguez", "link": "https://stackoverflow.com/users/4859885/brian-rodriguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1432769833, "accepted_answer_id": 30488125, "answer_count": 1, "score": 0, "last_activity_date": 1432743953, "creation_date": 1432742999, "last_edit_date": 1432743859, "question_id": 30487799, "link": "https://stackoverflow.com/questions/30487799/c-check-if-most-derived-class-of-a-base-reference-has-another-base", "closed_reason": "Duplicate", "title": "c++ Check if most derived class of a base reference has another base", "body": "<p>Here is some sample code of the behavior I'd like to see:</p>\n\n<pre><code>// Example program\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;type_traits&gt;\n#include &lt;vector&gt;\n\nclass BaseA\n{\npublic:\n    BaseA() { };\n};\n\nclass BaseB\n{\npublic:\n    BaseB() { };\n};\n\nclass Derived1 : public BaseA\n{\npublic:\n    Derived1() : BaseA() { };\n};\n\nclass Derived2 : public BaseA, public BaseB\n{\npublic:\n    Derived2() : BaseA(), BaseB() { };\n};\n\nint main()\n{\n    std::vector&lt;BaseA *&gt; collection_of_As{\n        new Derived1{}, new Derived1{}, new Derived2{},\n        new Derived2{}, new Derived1{}, new Derived2{}\n        };\n\n    for (BaseA * Aptr: collection_of_As) {\n        BaseB * Bptr = dynamic_cast&lt;BaseB *&gt;(Aptr);\n\n        std::cout &lt;&lt; std::boolalpha &lt;&lt; (Bptr != std::nullptr) &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>But it won't compile since BaseA isn't polymorphic, even though it's most derived class can be. I understand why this doesn't work, but I still need this behavior. Is there someway I can get this compiling &amp; working?</p>\n"}, {"tags": ["c++", "function", "for-loop", "indexing", "struct"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1432742895, "post_id": 30487711, "comment_id": 49053818, "body": "Not really with different types, no. You can create an <code>operator[]</code> or <code>operator()</code> for your class, but that would be abuse for this use case. Just write a <code>Fruits readFruit();</code> function once and be done with it."}, {"owner": {"reputation": 13636, "user_id": 3191557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffa6013ed93cfff5ef56f1ddf63956b1?s=128&d=identicon&r=PG&f=1", "display_name": "dhke", "link": "https://stackoverflow.com/users/3191557/dhke"}, "edited": false, "score": 1, "creation_date": 1432742980, "post_id": 30487711, "comment_id": 49053864, "body": "The names of the struct&#39;s fields are a compile time construct in C++. They are no longer available in the compiled program (other than in debugging info). So no, your problem --unfortunately-- cannot be solved like this."}, {"owner": {"reputation": 33, "user_id": 4930045, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1115720695111230/picture?type=large", "display_name": "Caroline Schuster", "link": "https://stackoverflow.com/users/4930045/caroline-schuster"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1432743753, "post_id": 30487711, "comment_id": 49054369, "body": "@BaummitAugen the function may be sth I can try. the rest is beyond my horizon at current time :("}, {"owner": {"reputation": 33, "user_id": 4930045, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1115720695111230/picture?type=large", "display_name": "Caroline Schuster", "link": "https://stackoverflow.com/users/4930045/caroline-schuster"}, "reply_to_user": {"reputation": 13636, "user_id": 3191557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffa6013ed93cfff5ef56f1ddf63956b1?s=128&d=identicon&r=PG&f=1", "display_name": "dhke", "link": "https://stackoverflow.com/users/3191557/dhke"}, "edited": false, "score": 0, "creation_date": 1432743881, "post_id": 30487711, "comment_id": 49054452, "body": "@dhke - ty anyway! I thought that must be a problem others already walked over too. but I couldn&#39;t find anything. guess now I know why :/"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1432743908, "post_id": 30487711, "comment_id": 49054471, "body": "@CarolineSchuster The function is the best (i.e. most readable/maintainable) solution anyway. I just mentioned the operator stuff because I was afraid someone was going to suggest that. Very poor idea IMO."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4930045, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1115720695111230/picture?type=large", "display_name": "Caroline Schuster", "link": "https://stackoverflow.com/users/4930045/caroline-schuster"}, "edited": false, "score": 0, "creation_date": 1432744740, "post_id": 30487840, "comment_id": 49054986, "body": "I see what you are saying. I hope my question wasn&#39;t too silly. I have no problem with typing the code, I just thought to you use an initialization loop for readability sake. I thought no real programmer would write all the stuff out and there must be a way to shorten this. but when this is ok and nobody would laugh about the length, then I am totally fine :)"}, {"owner": {"reputation": 908, "user_id": 1220312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/85bfd271749bd0ba3d9b18d2437bc283?s=128&d=identicon&r=PG", "display_name": "lcjury", "link": "https://stackoverflow.com/users/1220312/lcjury"}, "reply_to_user": {"reputation": 33, "user_id": 4930045, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1115720695111230/picture?type=large", "display_name": "Caroline Schuster", "link": "https://stackoverflow.com/users/4930045/caroline-schuster"}, "edited": false, "score": 1, "creation_date": 1432745134, "post_id": 30487840, "comment_id": 49055201, "body": "@CarolineSchuster don&#39;t worry, isn&#39;t silly, what you want would be really nice, but C/C++ are typed languages and that have some pro/cons :)"}, {"owner": {"reputation": 33, "user_id": 4930045, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1115720695111230/picture?type=large", "display_name": "Caroline Schuster", "link": "https://stackoverflow.com/users/4930045/caroline-schuster"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432747032, "post_id": 30487840, "comment_id": 49056393, "body": "@LightnessRacesinOrbit - don&#39;t understand the joke :("}], "tags": [], "owner": {"reputation": 908, "user_id": 1220312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/85bfd271749bd0ba3d9b18d2437bc283?s=128&d=identicon&r=PG", "display_name": "lcjury", "link": "https://stackoverflow.com/users/1220312/lcjury"}, "is_accepted": false, "score": 2, "last_activity_date": 1432746674, "last_edit_date": 1432746674, "creation_date": 1432743127, "answer_id": 30487840, "question_id": 30487711, "link": "https://stackoverflow.com/questions/30487711/c-indexing-structs/30487840#30487840", "title": "C++ Indexing structs", "body": "<p>you can't.</p>\n\n<p>Arrays access works on the following way.</p>\n\n<pre><code>int A[4];\nA[0] = 5;\nA[1] = 7;\nA[3] = 8;\n</code></pre>\n\n<p>You know a int (in some archytectures) use 4 bytes. So, the first element of <code>A</code> is in the address <code>A</code>, the next element of A is in the address <code>A+4</code> what is equal to say <code>A+sizeof(int)</code></p>\n\n<p>When you do the first assignment <code>A[0]</code> the code is really something like <code>A+sizeof(int)*0</code>, in the next <code>A[1]</code> is something like <code>A+sizeof(int)*1</code> If you see, any adjacent space of the array sums 4 bytes ( or sizeof(int) ) and goes on. If you see, you know that A have integers inside of it and you know the pattern to access each element the general pattern in a for loop would be <code>A+sizeof(int)*j</code> in your struct you don't know what is inside, you can't do <code>A+sizeof(X)*j</code> becouse X isn't fixed, so, if you want to do that you must implement it yourself, but It would be a pain becouse you have mixed datatypes. </p>\n\n<p>If your struct is fixed, the strings for the user should also be fixed, then why you try to print them from a loop?, The vector need to allocate and that use spaces and gpu, I think is better if you just print each option and then read the user input.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4930045, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1115720695111230/picture?type=large", "display_name": "Caroline Schuster", "link": "https://stackoverflow.com/users/4930045/caroline-schuster"}, "edited": false, "score": 0, "creation_date": 1432747887, "post_id": 30489170, "comment_id": 49056879, "body": "wow.. you mean &quot;But not without overkilling <b>me</b>.&quot; .. lol. that works? I nearly understand the half. <i>boost</i>, <i>std::ref</i>, <i>mutable</i> - things I haven&#39;t heard of yet. will need some days to understand your code :( - but for now, ty!"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 33, "user_id": 4930045, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1115720695111230/picture?type=large", "display_name": "Caroline Schuster", "link": "https://stackoverflow.com/users/4930045/caroline-schuster"}, "edited": false, "score": 1, "creation_date": 1432748410, "post_id": 30489170, "comment_id": 49057174, "body": "@CarolineSchuster when you want to kill a fly, of a flyswatter and a shotgun, <a href=\"http://www.boost.org/\" rel=\"nofollow noreferrer\">Boost</a> is often the orbital strike. But it <i>does</i> work :p"}], "tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": false, "score": 2, "last_activity_date": 1432747752, "last_edit_date": 1432747752, "creation_date": 1432747147, "answer_id": 30489170, "question_id": 30487711, "link": "https://stackoverflow.com/questions/30487711/c-indexing-structs/30489170#30489170", "title": "C++ Indexing structs", "body": "<p>You can.</p>\n\n<p>But not without overkilling it.</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\n#include &lt;boost/fusion/include/adapt_struct.hpp&gt;\n#include &lt;boost/fusion/include/for_each.hpp&gt;\n\nstruct Fruit {\n    std::string name;\n    int weight, diameter, price;\n    std::string colour, smell, taste;\n};\n\nBOOST_FUSION_ADAPT_STRUCT(\n    Fruit,\n    (std::string, name)\n    (int, weight)\n    (int, diameter)\n    (int, price)\n    (std::string, colour)\n    (std::string, smell)\n    (std::string, taste)\n)\n\nstd::array&lt;char const *const, 7&gt; questions = {\n    \"Name ?\",\n    \"Weight ?\",\n    \"Diameter ?\",\n    \"Price ?\",\n    \"Colour ?\",\n    \"Smell ?\",\n    \"Taste ?\"\n};\n\nint main() {\n    Fruit apple;\n\n    auto input = [i = std::size_t{0u}](auto &amp;field) mutable {\n        do {\n        std::cout &lt;&lt; questions[i] &lt;&lt; ' ';\n        } while(!(std::cin &gt;&gt; field));\n        ++i;\n    };\n    boost::fusion::for_each(apple, std::ref(input));\n\n    std::cout &lt;&lt; \"----------\\n\";\n\n    auto output = [i = std::size_t{0u}](auto const &amp;field) mutable {\n        std::cout &lt;&lt; questions[i] &lt;&lt; ' ' &lt;&lt; field &lt;&lt; '\\n';\n        ++i;\n    };\n    boost::fusion::for_each(apple, std::ref(output));\n}\n</code></pre>\n\n<p>I just learned that <code>boost::fusion::for_each</code> can't accept a mutable functor, hence the weird and a bit dangerous use of <code>std::ref()</code>... It's a shame, really.</p>\n\n<p>Output :</p>\n\n<pre><code>Name ? Apple\nWeight ? 150\nDiameter ? 8\nPrice ? 1\nColour ? red\nSmell ? good    \nTaste ? sweet\n----------\nName ? Apple\nWeight ? 150\nDiameter ? 8\nPrice ? 1\nColour ? red\nSmell ? good\nTaste ? sweet\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4930045, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1115720695111230/picture?type=large", "display_name": "Caroline Schuster", "link": "https://stackoverflow.com/users/4930045/caroline-schuster"}, "edited": false, "score": 0, "creation_date": 1432803559, "post_id": 30499084, "comment_id": 49079529, "body": "thank you! seems well comprehensible. do you think my question would be easier without the <i>strings</i>? if the struct only contained <i>ints</i>?"}, {"owner": {"reputation": 7077, "user_id": 159361, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ffe3e3839d22efe2c0cbcb0c70743feb?s=128&d=identicon&r=PG", "display_name": "Ricibob", "link": "https://stackoverflow.com/users/159361/ricibob"}, "reply_to_user": {"reputation": 33, "user_id": 4930045, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1115720695111230/picture?type=large", "display_name": "Caroline Schuster", "link": "https://stackoverflow.com/users/4930045/caroline-schuster"}, "edited": false, "score": 1, "creation_date": 1432805299, "post_id": 30499084, "comment_id": 49080796, "body": "You could replace each string with an enum E.g enum Color { Blue, Red ... } and then store enum value in single int ValueProperty array.  Your get accessor functions could convert the enum to string i.e you could keep string Name() - but now it would have to do enum to string conversion.  You could then work with a single loop.  Up to you which choice is preferable."}, {"owner": {"reputation": 7077, "user_id": 159361, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ffe3e3839d22efe2c0cbcb0c70743feb?s=128&d=identicon&r=PG", "display_name": "Ricibob", "link": "https://stackoverflow.com/users/159361/ricibob"}, "reply_to_user": {"reputation": 33, "user_id": 4930045, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1115720695111230/picture?type=large", "display_name": "Caroline Schuster", "link": "https://stackoverflow.com/users/4930045/caroline-schuster"}, "edited": false, "score": 1, "creation_date": 1432805483, "post_id": 30499084, "comment_id": 49080910, "body": "Your user input for the question &quot;What color&quot; is going to be a string.  I guess the real question is to what extent do you want to parse, validate and coerse this to a fix value (E.g Blue) or allow free text (E.g Lightish green).  For the former do as suggested in above comment for the later do as per original answer."}, {"owner": {"reputation": 908, "user_id": 1220312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/85bfd271749bd0ba3d9b18d2437bc283?s=128&d=identicon&r=PG", "display_name": "lcjury", "link": "https://stackoverflow.com/users/1220312/lcjury"}, "edited": false, "score": 0, "creation_date": 1432918337, "post_id": 30499084, "comment_id": 49143602, "body": "But, If you&#39;re going to do something like this, and using C++, we could use maps?"}], "tags": [], "owner": {"reputation": 7077, "user_id": 159361, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ffe3e3839d22efe2c0cbcb0c70743feb?s=128&d=identicon&r=PG", "display_name": "Ricibob", "link": "https://stackoverflow.com/users/159361/ricibob"}, "is_accepted": false, "score": 1, "last_activity_date": 1432796360, "last_edit_date": 1432796360, "creation_date": 1432795569, "answer_id": 30499084, "question_id": 30487711, "link": "https://stackoverflow.com/questions/30487711/c-indexing-structs/30499084#30499084", "title": "C++ Indexing structs", "body": "<pre><code>enum FruitValueProperty { weight=0, diameter, prize, lastValueProperty };\nenum FruitStringProperty { name=0, colour, smell, taste, lastStringProperty };\n\nstruct Fruit {\n    int ValueProperty[3];\n    string StringProperty[4];\n\n    int Weight() { return ValueProperty[weight]; }\n    int Diameter() { return ValueProperty[diameter]; }\n    int Prize() { return ValueProperty[prize]; }\n\n    string Name() { return StringProperty[name]; }\n    string Colour() { return StringProperty[colour]; }\n    string Smell() { return StringProperty[smell]; }\n    string Taste () { return StringProperty[taste ]; }\n};\n\nFruit fruit;\nvector&lt;string&gt; questions {\"Fruit weight?\", ... \"Fruit name?\", ... };\n\nfor (int i=0; i&lt;lastValueProperty; i++) {\n    cout &lt;&lt; questions[j];\n    cin &gt;&gt; fruit.ValueProperty[i];\n}\n\nfor (int j=0; i&lt;lastStringProperty; i++) {\n    cout &lt;&lt; questions[lastValueProperty+j];\n    cin &gt;&gt; fruit.StringProperty[j];\n}\n\nint dim = fruit.Diameter();\nstring sm = fruit.Smell();\n</code></pre>\n\n<p>If you used enums for the string properties (limiting the scope of what the values could be i.e an enum for names, enum for colors etc) then you could get your result by condensing the two loops down to one.<br>\nAlternatively you could have set property for the int values that takes a string and parses it to int and go that route but I honestly thing the above is the simplest and <strong>clearest</strong> means to <strong><em>almost</em></strong> achieve what you want.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4930045, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1115720695111230/picture?type=large", "display_name": "Caroline Schuster", "link": "https://stackoverflow.com/users/4930045/caroline-schuster"}, "edited": false, "score": 0, "creation_date": 1432924003, "post_id": 30519834, "comment_id": 49146796, "body": "oh dear, definitively overkill :o .. I didn&#39;t think it would be that difficult. even though I have 20 member variables in the struct that I&#39;m going to ask, it might be better just to type all the <code>cin&gt;&gt;</code> per hand. I was afraid it is sth that a real programmer would laugh at me, but seems fine here."}], "tags": [], "owner": {"reputation": 697, "user_id": 1773790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/237808c980b68a0b3b9fd09296f0aed5?s=128&d=identicon&r=PG", "display_name": "David Woo", "link": "https://stackoverflow.com/users/1773790/david-woo"}, "is_accepted": false, "score": 1, "last_activity_date": 1432864020, "creation_date": 1432864020, "answer_id": 30519834, "question_id": 30487711, "link": "https://stackoverflow.com/questions/30487711/c-indexing-structs/30519834#30519834", "title": "C++ Indexing structs", "body": "<p>This is my take on the matter using just vanilla c++ and evil macros and casts. Still definitely overkill though.</p>\n\n<p>The basic plan is to provide an  operator[] to return a variant-type proxy class which in turn handles the io streams.</p>\n\n<p>This interface allows you the ability to expose the class members as you choose and in the order you want.</p>\n\n<p>In order not to repeat myself and to avoid having the burden of keeping things in sync I declare the fields I want in a separate header and include the header twice but changing the macro between includes. If I now add a new field or remove one then I only have to change one place.</p>\n\n<p><strong>fruit_fields.h</strong></p>\n\n<pre><code>//NO Header Guards desired since we want to include multiple times\n\nDECLARE_FIELD(std::string,  Fruit, name)\nDECLARE_FIELD(int,          Fruit, weight)\nDECLARE_FIELD(int,          Fruit, diameter)\nDECLARE_FIELD(int,          Fruit, prize)\nDECLARE_FIELD(std::string,  Fruit, colour)\nDECLARE_FIELD(std::string,  Fruit, smell)\nDECLARE_FIELD(std::string,  Fruit, taste)\n</code></pre>\n\n<p><strong>Utility Classes</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;assert.h&gt;\n#include &lt;vector&gt;\n#include &lt;array&gt;\n#include &lt;typeinfo&gt;\n\n\n//TypeId info\nnamespace FieldType\n{\n    static const size_t String = typeid(std::string).hash_code();\n    static const size_t Integer = typeid(int).hash_code();\n};\n\n\n/*\nField Proxy is a simple variant class\nIf you want to support more field types then more code is needed\n*/\nclass FieldProxy\n{\n\npublic:\n    FieldProxy(int* value)\n        : m_typeHash( typeid(int).hash_code() )\n        , m_intValue(value)\n    {}\n\n    FieldProxy(std::string* value)\n        : m_typeHash(typeid(std::string).hash_code())\n        , m_stringValue(value)\n    {}\n\n    operator int() const\n    {\n        assert(m_typeHash == typeid(int).hash_code());\n        return *m_intValue;\n    }\n\n    operator std::string() const\n    {\n        assert(m_typeHash == typeid(std::string).hash_code());\n        return *m_stringValue;\n    }\n\n    friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const FieldProxy&amp; field);\n    friend std::istream&amp; operator&gt;&gt;(std::istream&amp; os, FieldProxy&amp; field);\n\n\nprivate:\n    size_t m_typeHash;\n    union\n    {\n        int* m_intValue;\n        std::string* m_stringValue;\n    };\n\n};\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const FieldProxy&amp; field)\n{\n    if (field.m_typeHash == FieldType::Integer)\n    {\n        os &lt;&lt; *(field.m_intValue);\n    }\n    else if (field.m_typeHash == FieldType::String)\n    {\n        os &lt;&lt; *(field.m_stringValue);\n    }\n\n    return os;\n}\n\nstd::istream&amp; operator&gt;&gt;(std::istream&amp; is, FieldProxy&amp; field)\n{\n\n    if (field.m_typeHash == FieldType::Integer)\n    {\n        is &gt;&gt; *(field.m_intValue);\n    }\n    else if (field.m_typeHash == FieldType::String)\n    {\n        is &gt;&gt; *(field.m_stringValue);\n    }       \n\n    return is;\n}\n\n//data to obtain pointer to given field\nstruct FieldInfo\n{\n    size_t fieldType;\n    size_t offset;\n};\n</code></pre>\n\n<p><strong>Fruit Class</strong></p>\n\n<pre><code>//The struct we actually care about\nstruct Fruit\n{\npublic:\n\n    static size_t getNumberFields() \n    {\n        return m_numberFields;\n    }\n\n    FieldProxy operator[](size_t index);\n\nprivate:\n//First include just declares the class members as you might expect\n// string name;\n// int    weight; etc\n\n#define DECLARE_FIELD(t, c, f) t f;\n#include \"fruit_fields.h\"\n#undef DECLARE_FIELD\n\n\n    static FieldInfo m_fields[];\n    static const size_t m_numberFields;\n\n};\n\n//Work out where the fields are positioned in the class\nFieldInfo Fruit::m_fields[] =\n{\n   //second time around - define the macro to generate the data\n   //needed to build the FieldProxy\n\n#define DECLARE_FIELD( t, c, f) {typeid(t).hash_code(), offsetof(c,f)},\n#include \"fruit_fields.h\"\n#undef DECLARE_FIELD\n};\n\n//calculate how many fields there are\nconst size_t Fruit::m_numberFields = sizeof(Fruit::m_fields) / sizeof(Fruit::m_fields[0]);\n\n//Index to a FieldInfo object and use it to create a FieldProxy variant\nFieldProxy Fruit::operator[](size_t index)\n{\n    assert(index &lt; m_numberFields);\n\n    auto&amp; fieldInfo = m_fields[index];\n\n    if (fieldInfo.fieldType == FieldType::Integer)\n    {\n        return FieldProxy(reinterpret_cast&lt;int*&gt; (reinterpret_cast&lt;char*&gt;(this) + fieldInfo.offset));\n    }\n    else if (fieldInfo.fieldType == FieldType::String)\n    {\n        return FieldProxy(reinterpret_cast&lt;std::string*&gt; (reinterpret_cast&lt;char*&gt;(this) + fieldInfo.offset));\n    }\n    else\n    {\n        assert(false);\n        return FieldProxy((int*)nullptr);\n    }\n}\n</code></pre>\n\n<p><strong>Main</strong><br>\nYou can now index in to the fruit class quite simply:</p>\n\n<pre><code>int main() \n{\n    Fruit apple;\n\n    std::array&lt;std::string, 7&gt; questions = {\n        \"Name ?\",\n        \"Weight ?\",\n        \"Diameter ?\",\n        \"Price ?\",\n        \"Colour ?\",\n        \"Smell ?\",\n        \"Taste ?\"\n    };\n\n    assert(questions.size() == Fruit::getNumberFields());\n\n    for (size_t index = 0; index &lt; Fruit::getNumberFields(); ++index)\n    {\n        bool succeeded = false;\n        do {\n            std::cout &lt;&lt; questions[index] &lt;&lt; ' ';\n            if (!(std::cin &gt;&gt; apple[index]))\n            {\n                std::cin.clear();\n                std::cin.ignore(std::numeric_limits&lt;int&gt;::max(), '\\n');\n            }\n            else\n            {\n                succeeded = true;\n            }\n        } while (!succeeded);\n    }\n\n    std::cout &lt;&lt; \"----------\" &lt;&lt; std::endl;\n\n    for (size_t index = 0; index &lt; Fruit::getNumberFields(); ++index)\n    {\n        std::cout &lt;&lt; questions[index] &lt;&lt; ' ' &lt;&lt; apple[index] &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13164783, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC9I_gkdu_LmGDSbiX0CPKyoDfEswIwmHD91kl2=k-s128", "display_name": "Michael Grauer", "link": "https://stackoverflow.com/users/13164783/michael-grauer"}, "is_accepted": false, "score": 0, "last_activity_date": 1585644873, "creation_date": 1585644873, "answer_id": 60946731, "question_id": 30487711, "link": "https://stackoverflow.com/questions/30487711/c-indexing-structs/60946731#60946731", "title": "C++ Indexing structs", "body": "<p>OK it is long since the thread was started.</p>\n\n<p>For indexing a Struct with values of same type I have written this code:</p>\n\n<pre><code>struct DataValues\n{\n    int Value1;\n    int Value2;\n    int Value3;\n    int Value4;\n    int Value5;\n    int Value6;\n    int Value7;\n    int Value8;\n\n    // the operator\n    // return the reference to make it settable.\n    int&amp; operator[](int n) \n    {\n        // the idea, get the pointer of the first element\n        // and treat it as an array\n        return (&amp;Value1)[n];\n    }\n};\n</code></pre>\n\n<p>usage:</p>\n\n<pre><code>int main()\n{\n    DataValues values;\n\n    values.Value4 = 6;\n    values[1] = 3;\n    values[0] = sizeof(DataValues);\n\n    return 0;\n}\n</code></pre>\n\n<p>The downside is that you have to check the input parameter to avoid accessing memory which  does not belong to the struct.</p>\n\n<p>Chears</p>\n"}], "owner": {"reputation": 33, "user_id": 4930045, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1115720695111230/picture?type=large", "display_name": "Caroline Schuster", "link": "https://stackoverflow.com/users/4930045/caroline-schuster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3122, "favorite_count": 1, "answer_count": 5, "score": 2, "last_activity_date": 1585644873, "creation_date": 1432742760, "last_edit_date": 1432742997, "question_id": 30487711, "link": "https://stackoverflow.com/questions/30487711/c-indexing-structs", "title": "C++ Indexing structs", "body": "<p>I'm wondering if there is a way to index structs in order to run through the member variables in a for-loop. I'm asking repeatingly for stuff and get input via <code>cin&gt;&gt;</code>:</p>\n\n<pre><code>struct Fruits {\n   string name;\n   int weight, diameter, prize;\n   string colour, smell, taste;\n}apple;\n\ncout &lt;&lt; \"Apple Name?\"; cin &gt;&gt; apple.name;\ncout &lt;&lt; \"Apple weight?\"; cin &gt;&gt; apple.weight;\n.\n.\n</code></pre>\n\n<p>you get the idea. I want sth like</p>\n\n<pre><code>    vector&lt;string&gt; questions {\"Apple Name?\", \"Apple weight?\", ... };\n    for (int j = 0; j &lt; \"StructureSize of Fruits\"; j++)\n    {\n    cout &lt;&lt; questions[j]; cin &gt;&gt; apple.j; //apple.j is the key point I want to know\n    }\n</code></pre>\n\n<p>thank you very much!</p>\n"}, {"tags": ["c++", "windows", "winapi", "windows-10"], "comments": [{"owner": {"reputation": 1358, "user_id": 4114591, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aIySb.jpg?s=128&g=1", "display_name": "Michael Z.", "link": "https://stackoverflow.com/users/4114591/michael-z"}, "edited": false, "score": 0, "creation_date": 1491800077, "post_id": 30487556, "comment_id": 73695089, "body": "<a href=\"https://github.com/mzomparelli/zVirtualDesktop\" rel=\"nofollow noreferrer\">github.com/mzomparelli/zVirtualDesktop</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1358, "user_id": 4114591, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aIySb.jpg?s=128&g=1", "display_name": "Michael Z.", "link": "https://stackoverflow.com/users/4114591/michael-z"}, "edited": false, "score": 0, "creation_date": 1491623656, "post_id": 32268671, "comment_id": 73647528, "body": "Here&#39;s an app I built from Grabacr07&#39;s API wrapper.....<a href=\"https://github.com/mzomparelli/zVirtualDesktop\" rel=\"nofollow noreferrer\">github.com/mzomparelli/zVirtualDesktop</a>"}], "tags": [], "owner": {"reputation": 8219, "user_id": 388994, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ty0JU.png?s=128&g=1", "display_name": "blade", "link": "https://stackoverflow.com/users/388994/blade"}, "is_accepted": false, "score": 3, "last_activity_date": 1441889193, "last_edit_date": 1441889193, "creation_date": 1440757096, "answer_id": 32268671, "question_id": 30487556, "link": "https://stackoverflow.com/questions/30487556/detecting-active-virtual-desktop-on-windows-10-task-view-virtual-desktop-swi/32268671#32268671", "title": "Detecting active virtual desktop on Windows 10 - Task View - virtual desktop switcher", "body": "<p>There is an interface that should provide most of the functionality you need: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/mt186440%28v=vs.85%29.aspx\" rel=\"nofollow\">IVirtualDesktopManager interface</a></p>\n\n<p>It has the following methods:</p>\n\n<ul>\n<li>GetWindowDesktopId</li>\n<li>IsWindowOnCurrentVirtualDesktop</li>\n<li>MoveWindowToDesktop</li>\n</ul>\n\n<p>In case that wasn't enough, there are even more unofficial APIs documented on this Russian website <a href=\"http://www.cyberforum.ru/blogs/105416/blog3671.html\" rel=\"nofollow\">http://www.cyberforum.ru/blogs/105416/blog3671.html</a></p>\n\n<p>Edit: here's a C# wrapper library for all the COM interfaces: <a href=\"https://github.com/Grabacr07/VirtualDesktop\" rel=\"nofollow\">https://github.com/Grabacr07/VirtualDesktop</a></p>\n"}], "owner": {"reputation": 241, "user_id": 2383407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1ab4f3074c0e16c51adb9896b184a17?s=128&d=identicon&r=PG&f=1", "display_name": "LetItRock", "link": "https://stackoverflow.com/users/2383407/letitrock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2745, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1533308486, "creation_date": 1432742340, "last_edit_date": 1434365948, "question_id": 30487556, "link": "https://stackoverflow.com/questions/30487556/detecting-active-virtual-desktop-on-windows-10-task-view-virtual-desktop-swi", "title": "Detecting active virtual desktop on Windows 10 - Task View - virtual desktop switcher", "body": "<p>Windows 10 provide for users switching between virtual desktops using Task View.  </p>\n\n<p>For developing purpose, I need to:</p>\n\n<ul>\n<li>detect which virtual desktop is active</li>\n<li>get virtual desktop parameters (handle, class, position, styles)</li>\n<li>get list of applications from this virtual desktop</li>\n<li>move application from one virtual desktop to another</li>\n</ul>\n\n<p>How can I do that? Is there any API?\n<br>Thank you for your help!</p>\n"}, {"tags": ["c++", "c++11", "variadic-templates"], "comments": [{"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "edited": false, "score": 1, "creation_date": 1432742251, "post_id": 30487378, "comment_id": 49053402, "body": "Yeah. Take pairs of a type and a value as a type list."}, {"owner": {"reputation": 12139, "user_id": 2412846, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eBJip.gif?s=128&g=1", "display_name": "davidhigh", "link": "https://stackoverflow.com/users/2412846/davidhigh"}, "edited": false, "score": 0, "creation_date": 1432742628, "post_id": 30487378, "comment_id": 49053641, "body": "and in general (when your pattern is non-repeating), the common way to transfer non-type arguments is by putting them inside a class. Examples include <code>std::true_type</code>, <code>std::integral_constant</code>, and so on."}], "answers": [{"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 2, "last_activity_date": 1432742938, "last_edit_date": 1432742938, "creation_date": 1432742277, "answer_id": 30487534, "question_id": 30487378, "link": "https://stackoverflow.com/questions/30487378/variadic-template-parameter-packs-with-alternating-types/30487534#30487534", "title": "Variadic Template Parameter Packs with Alternating Types", "body": "<p>Sure, just write your own pair:</p>\n\n<pre><code>template &lt;typename T, size_t U&gt;\nstruct foo_pair { };\n</code></pre>\n\n<p>And have a pack of those:</p>\n\n<pre><code>template&lt;typename T, size_t U, typename... Pairs&gt;\nclass foo&lt;foo_pair&lt;T, U&gt;, Pairs...&gt; {\n    ...\n};\n</code></pre>\n\n<p>Which would be instantiated like:</p>\n\n<pre><code>foo&lt;foo_pair&lt;int, 4&gt;, foo_pair&lt;char, 17&gt;, ...&gt; f;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1432743477, "post_id": 30487600, "comment_id": 49054182, "body": "A problem with <code>tuple</code> this way is that it is a large, complex class, in order for instances to be optimal at run time.  Using it as nothing more than a way to pack together types can cause the compiler to get creaky, needlessly."}], "tags": [], "owner": {"reputation": 1054, "user_id": 3798126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13368663e8f57baf2a5ed5ced426eb88?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Fairservice", "link": "https://stackoverflow.com/users/3798126/brian-fairservice"}, "is_accepted": false, "score": 0, "last_activity_date": 1432743166, "last_edit_date": 1432743166, "creation_date": 1432742448, "answer_id": 30487600, "question_id": 30487378, "link": "https://stackoverflow.com/questions/30487378/variadic-template-parameter-packs-with-alternating-types/30487600#30487600", "title": "Variadic Template Parameter Packs with Alternating Types", "body": "<p>You can pass <code>Args</code> to <code>foo</code> as an <code>std::tuple</code>.  Use <code>std::integral_constant</code> for <code>U</code> instead of passing an integral constant as a template parameter to the <code>std::tuple</code>.  Then the <code>Args</code> parameters pack contains all the pairs of types and sizes.  </p>\n\n<p>For example, when instantiating foo you would do so with a type like this:</p>\n\n<pre><code>Foo&lt;std::tuple&lt;int, std::integral_constant&lt;size_t, 5&gt; &gt;,\n    std::tuple&lt;char, std::integral_constant&lt;size_t, 3&gt; &gt; &gt;\n</code></pre>\n\n<p>When implementing <code>foo</code>, you should pass your parameter pack to another <code>std::tuple</code> and use <code>std::tuple_element</code> to select the Nth element of the tuple.</p>\n\n<p>This is just one possible approach, you may find it easier to implement <code>foo</code> if you use type lists.</p>\n"}, {"comments": [{"owner": {"reputation": 183, "user_id": 3417150, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d5e0216aa38bfb911a0b17063459dfd?s=128&d=identicon&r=PG&f=1", "display_name": "armstrhu", "link": "https://stackoverflow.com/users/3417150/armstrhu"}, "edited": false, "score": 0, "creation_date": 1432743765, "post_id": 30487744, "comment_id": 49054373, "body": "This seems like the best option so far.  One question, what would be the pitfall of storing the template parameter for use during runtime?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 183, "user_id": 3417150, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d5e0216aa38bfb911a0b17063459dfd?s=128&d=identicon&r=PG&f=1", "display_name": "armstrhu", "link": "https://stackoverflow.com/users/3417150/armstrhu"}, "edited": false, "score": 0, "creation_date": 1432743948, "post_id": 30487744, "comment_id": 49054506, "body": "@armstrhu you can access them at runtime without storing them.  <code>enum {my_U=U};</code> lets you access the compile-time value of <code>U</code> from the type <code>foo&lt;?&gt;</code> relatively easily.  The reason why it is a bad sign is that if you have a value that varies at run time, why not pass it in as a run time value, instead of encoding it in the type?"}, {"owner": {"reputation": 183, "user_id": 3417150, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d5e0216aa38bfb911a0b17063459dfd?s=128&d=identicon&r=PG&f=1", "display_name": "armstrhu", "link": "https://stackoverflow.com/users/3417150/armstrhu"}, "edited": false, "score": 0, "creation_date": 1432744573, "post_id": 30487744, "comment_id": 49054886, "body": "ahh, yeah good point.  So you are correct, for my application I don&#39;t actually need to store the value of U, just access it.  I guess in my little example above I didn&#39;t fully think that through.  Basically, I am building a variadic template over a set of std::array&#39;s and I was trying to figure out how one could pass the array type and length.  So really, my T* is actually an std::array&lt;T,U&gt;* and there would be no size_t U variable.  Your solution should solve my problem regardless.  Thanks"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 4, "last_activity_date": 1432742832, "creation_date": 1432742832, "answer_id": 30487744, "question_id": 30487378, "link": "https://stackoverflow.com/questions/30487378/variadic-template-parameter-packs-with-alternating-types/30487744#30487744", "title": "Variadic Template Parameter Packs with Alternating Types", "body": "<p>Values as template parameters are second class citizens, in my experience.</p>\n\n<p>Upgrade them to first class with an alias:</p>\n\n<pre><code>template&lt;std::size_t n&gt;\nusing size = std::integral_constant&lt;std::size_t, n&gt;;\n</code></pre>\n\n<p>then pattern match:</p>\n\n<pre><code>template&lt;class...&gt;\nstruct foo;\ntemplate&lt;&gt;\nstruct foo&lt;&gt; {\n  // empty\n};\ntemplate&lt;class T, size_t U, typename... Args&gt;\nstruct foo&lt;T, size&lt;U&gt;, Args...&gt; {\n  foo() : my_T(nullptr), my_U(U) {}\n\nprivate:\n  T* my_T;\n  size_t my_U;\n  foo&lt;Args...&gt; my_next_foo;\n};\n</code></pre>\n\n<p>and bob is your uncle.</p>\n\n<p>Note, however, that taking <code>U</code> as a template parameter, then storing it as a run time value, is highly questionable.</p>\n\n<p>Users of <code>foo</code> must do:</p>\n\n<pre><code>foo&lt; Chicken, size&lt;3&gt;, Dog, size&lt;17&gt; &gt;\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>foo&lt; Chicken, 3, Dog, 17 &gt;\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "is_accepted": false, "score": 0, "last_activity_date": 1432743375, "creation_date": 1432743375, "answer_id": 30487933, "question_id": 30487378, "link": "https://stackoverflow.com/questions/30487378/variadic-template-parameter-packs-with-alternating-types/30487933#30487933", "title": "Variadic Template Parameter Packs with Alternating Types", "body": "<p>You might create a class representing the data container <code>T* my_T</code> with <code>size_t my_U</code>. Having that, you can implement your template:</p>\n\n<pre><code>#include &lt;array&gt;\n\nusing std::size_t;\n\ntemplate&lt;typename... Args&gt;\nstruct foo;\n\ntemplate&lt;typename T, size_t N&gt;\nstruct foo&lt;std::array&lt;T, N&gt;&gt;\n{\n    std::array&lt;T, N&gt; array;\n};\n\ntemplate&lt;typename T, size_t N, typename... Args&gt;\nstruct foo&lt;std::array&lt;T, N&gt;, Args...&gt;\n{\n    std::array&lt;T, N&gt; array;\n    foo&lt;Args...&gt; next_array;\n};\n\nint main() {\n    foo&lt;std::array&lt;char, 1&gt;, std::array&lt;short, 2&gt;, std::array&lt;int, 4&gt;&gt; foos;\n}\n</code></pre>\n\n<p>Note: I am using std::array as an replacement for the data container.</p>\n"}], "owner": {"reputation": 183, "user_id": 3417150, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d5e0216aa38bfb911a0b17063459dfd?s=128&d=identicon&r=PG&f=1", "display_name": "armstrhu", "link": "https://stackoverflow.com/users/3417150/armstrhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2042, "favorite_count": 0, "accepted_answer_id": 30487744, "answer_count": 4, "score": 2, "last_activity_date": 1432744018, "creation_date": 1432741890, "last_edit_date": 1432743952, "question_id": 30487378, "link": "https://stackoverflow.com/questions/30487378/variadic-template-parameter-packs-with-alternating-types", "title": "Variadic Template Parameter Packs with Alternating Types", "body": "<p>I was wondering if it is possible to capture an alternating parameter pattern using a parameter pack.  For example,</p>\n\n<pre><code>template&lt;typename T, size_t U, typename... Args&gt;\nclass foo&lt;T, U, Args...&gt;\n{\n   public:\n     foo() : my_T(nullptr), my_U(U) {}\n\n   private:\n     T* my_T;\n     size_t my_U;\n     foo&lt;Args...&gt; my_next_foo;\n}\n</code></pre>\n\n<p>So this doesn't work since Args is a parameter pack of only types.  Is there a way to modify this so that the typename T, size_t U pattern can be properly captured in a variadic template?  Thanks</p>\n"}, {"tags": ["c++", "timer"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432746127, "post_id": 30487364, "comment_id": 49055859, "body": "Your code is invalid because you have missing <code>};</code>. Would be obvious if you&#39;d used proper indentation."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4945423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddc5e200272b43fee2340b257a30c08?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEhr", "link": "https://stackoverflow.com/users/4945423/johanehr"}, "edited": false, "score": 0, "creation_date": 1432743558, "post_id": 30487626, "comment_id": 49054245, "body": "Im trying to display the clock ticks but i think im doing something wrong, could you give me an example of how it should look."}, {"owner": {"reputation": 4683, "user_id": 2978901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f4c47814ee6a385d2cf6447d75ac1d9?s=128&d=identicon&r=PG&f=1", "display_name": "Pandrei", "link": "https://stackoverflow.com/users/2978901/pandrei"}, "reply_to_user": {"reputation": 1, "user_id": 4945423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddc5e200272b43fee2340b257a30c08?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEhr", "link": "https://stackoverflow.com/users/4945423/johanehr"}, "edited": false, "score": 0, "creation_date": 1432801038, "post_id": 30487626, "comment_id": 49077934, "body": "@JohanEhr unsigned long t = (clock() - startTime) should display the clock ticks. I recommend trying a simpler scenario, without the complex if statements just to see it works. And then add all the logic you want on top. BUT Lightness Races in Orbit did make a valid point. You probably should consider using gettimeofday()."}], "tags": [], "owner": {"reputation": 4683, "user_id": 2978901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f4c47814ee6a385d2cf6447d75ac1d9?s=128&d=identicon&r=PG&f=1", "display_name": "Pandrei", "link": "https://stackoverflow.com/users/2978901/pandrei"}, "is_accepted": false, "score": 0, "last_activity_date": 1432742534, "creation_date": 1432742534, "answer_id": 30487626, "question_id": 30487364, "link": "https://stackoverflow.com/questions/30487364/user-timer-bugs-out-after-first-use-and-returns-zero-no-matter-how-long-i-wait/30487626#30487626", "title": "User timer bugs out after first use and returns zero no matter how long I wait", "body": "<p>the problem might be with your elapsedTime() function:</p>\n\n<pre><code>unsigned long elapsedTime() { \n    unsigned long t = (clock() - startTime) / CLOCKS_PER_SEC;\n    return t;\n}\n</code></pre>\n\n<p>in case you are counting less than <code>CLOCKS_PER_SEC</code> ticks - which is very probable - the division will return 0 because the operands are integer types. </p>\n\n<p>Try displaying the clock ticks first and worry about converting the time to seconds after that.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4945423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddc5e200272b43fee2340b257a30c08?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEhr", "link": "https://stackoverflow.com/users/4945423/johanehr"}, "edited": false, "score": 0, "creation_date": 1432745827, "post_id": 30488658, "comment_id": 49055656, "body": "I havent worked with gettimeofday() yet. Would it be hard to implement or would i simply replace all &quot;clock()&quot; with gettimeofday()?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 1, "user_id": 4945423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddc5e200272b43fee2340b257a30c08?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEhr", "link": "https://stackoverflow.com/users/4945423/johanehr"}, "edited": false, "score": 0, "creation_date": 1432745866, "post_id": 30488658, "comment_id": 49055673, "body": "@JohanEhr: I&#39;ve added an example. In general, to find out how to use a function, read its documentation (I provided links) and Google for examples."}, {"owner": {"reputation": 1, "user_id": 4945423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddc5e200272b43fee2340b257a30c08?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEhr", "link": "https://stackoverflow.com/users/4945423/johanehr"}, "edited": false, "score": 0, "creation_date": 1432747712, "post_id": 30488658, "comment_id": 49056798, "body": "Cant even get your example to work, I get use of undeclared identifier &quot;gettimeofday&quot; im coding on a mac if that makes any difference"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 1, "user_id": 4945423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddc5e200272b43fee2340b257a30c08?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEhr", "link": "https://stackoverflow.com/users/4945423/johanehr"}, "edited": false, "score": 0, "creation_date": 1432748638, "post_id": 30488658, "comment_id": 49057308, "body": "@JohanEhr: You forgot to copy the <code>#include</code> statement. <a href=\"https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man2/gettimeofday.2.html\" rel=\"nofollow noreferrer\">The function exists on OSX too</a>."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 0, "last_activity_date": 1432746192, "last_edit_date": 1432746192, "creation_date": 1432745481, "answer_id": 30488658, "question_id": 30487364, "link": "https://stackoverflow.com/questions/30487364/user-timer-bugs-out-after-first-use-and-returns-zero-no-matter-how-long-i-wait/30488658#30488658", "title": "User timer bugs out after first use and returns zero no matter how long I wait", "body": "<p><code>clock()</code> tells you the number of CPU ticks used by the process, but your process doesn't take up any CPU time whilst it's blocked on input! So <a href=\"http://kera.name/articles/2011/03/tomalaks-tuesday-tip-11-sleep-your-way-to-success/\" rel=\"nofollow\">it's useless for this kind of problem</a>.</p>\n\n<p>You should use a different function instead, one which gives you <em>wall time</em> (i.e. absolute passage of real-world time), especially if you want milliseconds-resolution. Consider <a href=\"http://linux.die.net/man/2/gettimeofday\" rel=\"nofollow\"><code>gettimeofday()</code></a>.</p>\n\n<pre><code>#include &lt;sys/time.h&gt;\n\nclass timer\n{ \nprivate:\n    double startTime;\n\n    /**\n     * This function wraps the call to `gettimeofday()`,\n     * so that you may simply use it instead of `clock()`.\n     *\n     * You will still have to remove your `CLOCKS_PER_SEC`\n     * logic and switch from `unsigned long` to `double`,\n     * though.\n     */\n    double getTime()\n    {\n       timeval tv;\n       gettimeofday(&amp;tv, 0);\n       return tv.tv_sec + tv.tv_usec/1e9;\n    }\n\npublic:\n    void start()\n    {\n        startTime = getTime(); \n    }\n\n    double elapsedTime()\n    { \n        return getTime() - startTime;\n    }\n\n    bool isTimeout(double seconds) {\n        return seconds &gt;= elapsedTime();\n    }\n};\n</code></pre>\n\n<h3>(<a href=\"http://coliru.stacked-crooked.com/a/a65e7eaf72d5765a\" rel=\"nofollow\">live demo of class in action</a>)</h3>\n\n<p>In a real-world application, I would actually use <a href=\"http://linux.die.net/man/2/clock_gettime\" rel=\"nofollow\"><code>clock_gettime</code></a> with <code>CLOCK_MONOTONIC</code>, to avoid the effect of local time jumps. That may be too much in this simple learning case, though.</p>\n"}], "owner": {"reputation": 1, "user_id": 4945423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddc5e200272b43fee2340b257a30c08?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEhr", "link": "https://stackoverflow.com/users/4945423/johanehr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432746192, "creation_date": 1432741867, "question_id": 30487364, "link": "https://stackoverflow.com/questions/30487364/user-timer-bugs-out-after-first-use-and-returns-zero-no-matter-how-long-i-wait", "title": "User timer bugs out after first use and returns zero no matter how long I wait", "body": "<p>Im trying to create a game that tests the reaction speed of the user and for the first part of the game I use a timer to randomize when the user should press. After that I want to time how long time it takes for the user to press but no matter how long i wait to press it always returns \"you have pressed 1 after 0 seconds\" with 1 being the key i pressed. How do make it so it times the user preferable also in ms instead of seconds. \nIm really new to C++ and trying to self learn with the help of books but im really stuck. Any help?</p>\n\n<pre><code>#include &lt;iostream\n#include &lt;time.h&gt;\n\nusing namespace std;\n\n\nclass timer { \nprivate:\n    unsigned long startTime; \npublic:\n    void start() {\n        startTime = clock(); \n}\n\nunsigned long elapsedTime() { \n    unsigned long t = (clock() - startTime) / CLOCKS_PER_SEC;\n    return t;\n}\n\nbool isTimeout(unsigned long seconds) {\n    return seconds &gt;= elapsedTime();\n}\n\n\n\n\nint main() {\n    srand(time(NULL)); \n    int keyPressed = (0);\n    unsigned long secondsBeforeStart = (rand() % 11);\n    timer tBefore;\n    timer tAfter;\n    bool waitingInput = false;\n    bool gameIsFinished = false;\n\n    tBefore.start();\n    cout &lt;&lt; \"timer started . . .\" &lt;&lt; endl;\n    while(true)\n    {\n        if(tBefore.elapsedTime() &gt;= secondsBeforeStart &amp;&amp; !waitingInput &amp;&amp; !gameIsFinished) //waiting the game to draw \"Tryck nu!\"\n    {\n            waitingInput = true;\n            cout &lt;&lt; \"Tryck nu!\" &lt;&lt; endl;\n            tAfter.start();\n    }\n        if(waitingInput &amp;&amp; !gameIsFinished) // if \"Tryck nu\" has appeared =&gt; waiting the player to press a key\n    {\n            // cout &lt;&lt; \"DEBUG : tAfter == \" &lt;&lt; tAfter.elapsedTime(); &lt;&lt; endl;\n            cin &gt;&gt; keyPressed;\n            if( keyPressed != 0) // if player press the key\n            {\n            cout &lt;&lt; \"you have pressed \" &lt;&lt; keyPressed &lt;&lt; \" after \" &lt;&lt; tAfter.elapsedTime() &lt;&lt; \" seconds\" &lt;&lt; endl;\n            gameIsFinished = true;\n        }\n    }\n        if(gameIsFinished)\n    {\n            cout &lt;&lt; \"Well done, you can push a button to restart the game\" &lt;&lt; endl;\n            cin &gt;&gt; keyPressed;\n            if( keyPressed != 0) // if player press the key\n        {\n                cout &lt;&lt; \"Restarting\" &lt;&lt; endl;\n                waitingInput = false;\n                gameIsFinished = false;\n                secondsBeforeStart = (rand() % 11);\n                tBefore.start();\n                cout &lt;&lt; \"timer started . . .\" &lt;&lt; endl;\n        }\n    }\n}\n\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432741783, "post_id": 30487283, "comment_id": 49053065, "body": "That can&#39;t possibly be an example from the book, since it&#39;s not even valid C++."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432741856, "post_id": 30487283, "comment_id": 49053111, "body": "@KerrekSB const char aside, in what why is this not even valid?"}, {"owner": {"reputation": 2522, "user_id": 366786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a8dfb0564cb2ddb606775f27a208af4?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/366786/gareth"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432741922, "post_id": 30487283, "comment_id": 49053157, "body": "@KerrekSB this is indeed valid."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1432742020, "post_id": 30487283, "comment_id": 49053227, "body": "@Borgleader, I assume the invalid conversion from <code>const char[N]</code> to <code>char *</code> is what he means."}, {"owner": {"reputation": 2550, "user_id": 4931993, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HIOGhudLQzQ/AAAAAAAAAAI/AAAAAAAAAG8/RhqG4yB0Ky0/photo.jpg?sz=128", "display_name": "Eric Appelt", "link": "https://stackoverflow.com/users/4931993/eric-appelt"}, "edited": false, "score": 0, "creation_date": 1432742022, "post_id": 30487283, "comment_id": 49053231, "body": "It is valid, although it generates a warning, -Wc++11-compat-deprecated-writable-strings."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 2, "creation_date": 1432742039, "post_id": 30487283, "comment_id": 49053247, "body": "It&#39;s valid in C++03, not in C++11"}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "reply_to_user": {"reputation": 2550, "user_id": 4931993, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HIOGhudLQzQ/AAAAAAAAAAI/AAAAAAAAAG8/RhqG4yB0Ky0/photo.jpg?sz=128", "display_name": "Eric Appelt", "link": "https://stackoverflow.com/users/4931993/eric-appelt"}, "edited": false, "score": 2, "creation_date": 1432742075, "post_id": 30487283, "comment_id": 49053273, "body": "@EricAppelt: It&#39;s invalid in C++11 or later. You get a warning rather than an error since you&#39;re compiling it as an obsolete dialect."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1432742222, "post_id": 30487283, "comment_id": 49053381, "body": "<i>&quot;Shouldn&#39;t it be crashed?&quot;</i> <b>NO!</b> Breaking the rules of C and C++ does NOT mean you get a crash. You <b>might</b> get a crash, if you&#39;re lucky. But it might not crash and appear to work correctly (for now), or it might not crash and do something strange. It is a huge misunderstanding to think that if you do something wrong it will crash, and the corollary that if your program doesn&#39;t crash it is correct is also a huge misunderstanding."}, {"owner": {"reputation": 2550, "user_id": 4931993, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HIOGhudLQzQ/AAAAAAAAAAI/AAAAAAAAAG8/RhqG4yB0Ky0/photo.jpg?sz=128", "display_name": "Eric Appelt", "link": "https://stackoverflow.com/users/4931993/eric-appelt"}, "reply_to_user": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 1, "creation_date": 1432742227, "post_id": 30487283, "comment_id": 49053386, "body": "@MikeSeymour well I was going to reply that Stroustrup&#39;s book predates C++11x so it is valid in context, but the 4th edition is advertised as being &quot;Extensively rewritten to present the C++11 language&quot;, so you are right."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1432743321, "post_id": 30487283, "comment_id": 49054090, "body": "I don&#39;t think the example is taken verbatim from the book, because Stroustrup would write <code>char* p</code> not <code>char *p</code>. Anyway, the answer to the question in on page 176 where it explains string literals."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1432743485, "post_id": 30487283, "comment_id": 49054187, "body": "@JonathanWakely: Right, and the question explicitly says &quot;4th edition&quot;, so it refers to C++11..."}], "answers": [{"tags": [], "owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "is_accepted": false, "score": 6, "last_activity_date": 1432741827, "creation_date": 1432741827, "answer_id": 30487349, "question_id": 30487283, "link": "https://stackoverflow.com/questions/30487283/will-the-value-of-the-memory-location-following-an-array-always-be-a-0/30487349#30487349", "title": "Will the value of the memory location following an array always be a 0?", "body": "<blockquote>\n  <p>Will the value of the memory location following an array always be a 0?</p>\n</blockquote>\n\n<p>No. Accessing that memory gives undefined behaviour; it might not be accessible, and any value you get from it is garbage.</p>\n\n<p>However, a string literal like <code>\"asdf\"</code> denotes an array which has a zero-valued character at the end, as well as the characters specified by the literal; which is why this example, and C-style string-wrangling in general, works with string literals.</p>\n\n<p>Note that, in modern C++, you'd need <code>const char *</code> rather than <code>char *</code>, since a string literal denotes a constant array.</p>\n"}, {"comments": [{"owner": {"reputation": 179, "user_id": 1990353, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/72b7ffc684848b5c9e8ccdf55f79e0c4?s=128&d=identicon&r=PG", "display_name": "Neo", "link": "https://stackoverflow.com/users/1990353/neo"}, "edited": false, "score": 0, "creation_date": 1432794829, "post_id": 30487361, "comment_id": 49074315, "body": "If the array is zero terminated, while finding the end of array, dereferencing this zero should be giving segmentation fault right? Why it is not?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 179, "user_id": 1990353, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/72b7ffc684848b5c9e8ccdf55f79e0c4?s=128&d=identicon&r=PG", "display_name": "Neo", "link": "https://stackoverflow.com/users/1990353/neo"}, "edited": false, "score": 0, "creation_date": 1432801105, "post_id": 30487361, "comment_id": 49077970, "body": "@Neo The 0 is still part of the array. The literal <code>&quot;Hi&quot;</code> is something like <code>const char[] = {&#39;H&#39;,&#39;i&#39;,&#39;\\0&#39;}</code>. You do not go out of bounds."}], "tags": [], "owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "is_accepted": true, "score": 2, "last_activity_date": 1432742006, "last_edit_date": 1432742006, "creation_date": 1432741858, "answer_id": 30487361, "question_id": 30487283, "link": "https://stackoverflow.com/questions/30487283/will-the-value-of-the-memory-location-following-an-array-always-be-a-0/30487361#30487361", "title": "Will the value of the memory location following an array always be a 0?", "body": "<p>Not in general, but in this specific case: Yes.</p>\n\n<pre><code>char *p = \"asdf\";\n</code></pre>\n\n<p>creates a <code>char*</code> to the string-literal \"asdf\", which is zero terminated. So the above code is safe.</p>\n\n<p>This is different to e.g.</p>\n\n<pre><code>int arr[] = {1,2,3,4};\nint *p = arr;\nfor (; *p != 0; ++p)\n    cout &lt;&lt; \"int: \" &lt;&lt; *p &lt;&lt; endl;\n</code></pre>\n\n<p>This does indeed invoke undefined behavior.</p>\n\n<p>Btw, the conversion from string literals to <code>char*</code> is deprecated because attempting to change a string literal is also undefined behavior. You should use a <code>const char*</code> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": false, "score": 2, "last_activity_date": 1432742334, "last_edit_date": 1432742334, "creation_date": 1432742022, "answer_id": 30487440, "question_id": 30487283, "link": "https://stackoverflow.com/questions/30487283/will-the-value-of-the-memory-location-following-an-array-always-be-a-0/30487440#30487440", "title": "Will the value of the memory location following an array always be a 0?", "body": "<p>p is a pointer to a C style string. The compiler automatically adds an extra character and sets it to 0, null.</p>\n\n<p>The null is used because it does not naturally occur in a string, and thus can be used as a sentinel value so you'll know when you reach the end of the string.</p>\n\n<p>This is about the only case where this extra null happens, but compilers often perform little tricks like this to make life easier when performing common and mundane tasks. Call it syntactic sugar, a little helper that the compiler does for you to make life easier. Another example would be automatically generated trivial constructors and destructors.</p>\n"}], "owner": {"reputation": 179, "user_id": 1990353, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/72b7ffc684848b5c9e8ccdf55f79e0c4?s=128&d=identicon&r=PG", "display_name": "Neo", "link": "https://stackoverflow.com/users/1990353/neo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 30487361, "answer_count": 3, "score": 0, "last_activity_date": 1432742334, "creation_date": 1432741665, "question_id": 30487283, "link": "https://stackoverflow.com/questions/30487283/will-the-value-of-the-memory-location-following-an-array-always-be-a-0", "title": "Will the value of the memory location following an array always be a 0?", "body": "<p>I've seen an example from Bjarne Stroustrup's 4th edition as follows:</p>\n\n<pre><code>char *p = \"asdf\";\nfor (; *p != 0; ++p)\n    cout &lt;&lt; \"char: \" &lt;&lt; *p &lt;&lt; endl;\n</code></pre>\n\n<p>To verify the end of the array, he's dereferencing the location first\nand then, comparing with a zero. It worked.\nI don't understand how it did.</p>\n\n<ol>\n<li>What if the memory location following 'f' is other than zero (a garbage value). It should move even after the end of array.</li>\n<li>Dereferencing a memory location, that is not constructed. Shouldn't it be crashed? Is it the null sequence character (\\0) playing the part?</li>\n</ol>\n"}, {"tags": ["c++", "multithreading", "memory", "heap"], "comments": [{"owner": {"reputation": 908, "user_id": 1220312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/85bfd271749bd0ba3d9b18d2437bc283?s=128&d=identicon&r=PG", "display_name": "lcjury", "link": "https://stackoverflow.com/users/1220312/lcjury"}, "edited": false, "score": 0, "creation_date": 1432741367, "post_id": 30487064, "comment_id": 49052763, "body": "if you think your old question is too complicated don&#39;t make us read it, please formulate a complete new question here"}, {"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "reply_to_user": {"reputation": 908, "user_id": 1220312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/85bfd271749bd0ba3d9b18d2437bc283?s=128&d=identicon&r=PG", "display_name": "lcjury", "link": "https://stackoverflow.com/users/1220312/lcjury"}, "edited": false, "score": 0, "creation_date": 1432742376, "post_id": 30487064, "comment_id": 49053474, "body": "I do not feel it is complicated, it has been flagged by mods. I have linked it for reference only. My question is appended by a &quot;?&quot; for easy reading."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432741748, "post_id": 30487174, "comment_id": 49053034, "body": "Thank you for clarification. Do you know of a call to allocate memory for a particular thread? My issue is the child thread is being created over data made by the parent thread."}, {"owner": {"reputation": 3014, "user_id": 4560470, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b9512cafbd363be4b552bddb31d3f23?s=128&d=identicon&r=PG&f=1", "display_name": "Arcyno", "link": "https://stackoverflow.com/users/4560470/arcyno"}, "edited": false, "score": 0, "creation_date": 1432741865, "post_id": 30487174, "comment_id": 49053119, "body": "That should not be possible. How are you checking that the data is overwritten ?"}, {"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432742170, "post_id": 30487174, "comment_id": 49053344, "body": "I have a LPTSTR point to a string in memory , I have created a watch for this Pointer. As i step through my code, the strings value ( At the address the pointer points to) changes from L&quot;Features_30_34_40.bmp&quot; to a bunch of unicode characters. I used the memory window of Visual studio and the new thread is being created over the strings data. You can see in memory the string and then you can see it get changed."}, {"owner": {"reputation": 3014, "user_id": 4560470, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b9512cafbd363be4b552bddb31d3f23?s=128&d=identicon&r=PG&f=1", "display_name": "Arcyno", "link": "https://stackoverflow.com/users/4560470/arcyno"}, "edited": false, "score": 0, "creation_date": 1432742518, "post_id": 30487174, "comment_id": 49053570, "body": "It seems strange.. and quite hard to solve without some code ! Can you try to cut your code up to 10 lines that can reproduce the error ?"}, {"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432742627, "post_id": 30487174, "comment_id": 49053639, "body": "in sudo the code looks like:  <code>Make a thread;      Pass a message to parent thread;     Kill thread; Mainthread takes message and makes a string;     Make a new thread and pass this new string; </code> I will take some time to write a short program that represents this in c++"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432743004, "post_id": 30487174, "comment_id": 49053882, "body": "That shared pool also makes threading easier at the same time. You don&#39;t have to use interprocess communication to pass information between threads. @ChrisEst most of the problem with the earlier question was you dropped a large ball of code. You need to post the minimal compilable code that triggers your error. What you posted was neither minimal or compilable. There is nothing brutally obvious, so amount of fill-in-the-blanks guesswork that needed to go into formulating an answer made trying to answer the question pretty much impossible."}, {"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1432743502, "post_id": 30487174, "comment_id": 49054202, "body": "@user4581301 Thank you for your clarifying where my last post went wrong. Today I will try to reproduce this problem with shorter code.   Is there any answer to &quot; Can I tell where a thread should be made in memory?&quot;"}, {"owner": {"reputation": 3014, "user_id": 4560470, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b9512cafbd363be4b552bddb31d3f23?s=128&d=identicon&r=PG&f=1", "display_name": "Arcyno", "link": "https://stackoverflow.com/users/4560470/arcyno"}, "edited": false, "score": 0, "creation_date": 1432743951, "post_id": 30487174, "comment_id": 49054510, "body": "I don&#39;t think so, and it should not be necessary. Your system should be able to do it proprely without overwriting the important variables."}, {"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432747983, "post_id": 30487174, "comment_id": 49056939, "body": "I have edited the main post to include some code. After writing this code it may be my mutexes causing the issue."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432748899, "post_id": 30487174, "comment_id": 49057464, "body": "@ChrisEst Each thread has it&#39;s own stack, defaults to 1 MB on Windows as I recall, and so long as you stay within that pool, you&#39;re fine. But you are actively sharing data, your message structure, between multiple threads. Not a good idea and mutex can only protect you from two or more threads accessing a variable at the same time within guarded regions. It cannot protect you from one thread entering a guarded region and changing a value to a value not expected by another thread or any access from outside a guarded region. Also, don&#39;t change the question. Ask a new one."}, {"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432749272, "post_id": 30487174, "comment_id": 49057659, "body": "Ok thats good to know. 1MB will not be enough for the thread as some images it will open will be around 100MB. What would be the name of the tool that I can implement to stop a thread from over flowing into a guarded region if a mutex can not do this?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432757023, "post_id": 30487174, "comment_id": 49062086, "body": "@ChrisEst, if you have data that&#39;s going to require massive amounts of storage, odds are they are going to be dynamically allocated, and if they aren&#39;t it&#39;ll be pretty easy to force them. As for the mutex, it is an agreement. It&#39;s like asking for permission to walk across your neighbour&#39;s lawn and waiting until you get it. No one forces you to ask, and someone who doesn&#39;t ask has no way to know that the lawn is a restricted area. If everyone but one user acquires the mutex before accessing a variable, that one user can still ruin things for everyone."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432757252, "post_id": 30487174, "comment_id": 49062206, "body": "@ChrisEst the next problem is it only protects against multiple accesses at the same time. Thread B can acquire the mutex, change the value, and release the value before thread A can, and if B has changed the value that A was expecting to get, sucks to be A."}, {"owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "edited": false, "score": 0, "creation_date": 1432757995, "post_id": 30487174, "comment_id": 49062627, "body": "That&#39;s a good way to put it. In my separate thread one user suggested that i have a message handler. i.e. a gate for the lawn.  The handler will only have the mutex and release information if its available. So if a thread asks the handler it will be blocked until a message is released, taking away the protection job from the thread and having a separate system to do it."}], "tags": [], "owner": {"reputation": 1187, "user_id": 651740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e49d25a5b1991c87d2a194c220de1b00?s=128&d=identicon&r=PG", "display_name": "Marc Johnston", "link": "https://stackoverflow.com/users/651740/marc-johnston"}, "is_accepted": true, "score": 0, "last_activity_date": 1432741370, "creation_date": 1432741370, "answer_id": 30487174, "question_id": 30487064, "link": "https://stackoverflow.com/questions/30487064/how-does-windows-pick-memory-for-threads/30487174#30487174", "title": "How Does Windows Pick memory for threads?", "body": "<p>No ... the thread shares memory with the main thread and all other threads started by the app.  That is what makes multi-threading more difficult.  You have to be careful when multiple threads access the same memory.  </p>\n\n<p>Threads all share the same resources but only the main thread can interact with the GUI.</p>\n"}], "owner": {"reputation": 17, "user_id": 4942444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f65f3732752fe2ee9decb07ede184c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Est", "link": "https://stackoverflow.com/users/4942444/chris-est"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 30487174, "answer_count": 1, "score": 0, "last_activity_date": 1432752588, "creation_date": 1432741071, "last_edit_date": 1495541665, "question_id": 30487064, "link": "https://stackoverflow.com/questions/30487064/how-does-windows-pick-memory-for-threads", "title": "How Does Windows Pick memory for threads?", "body": "<p>My previous post,<strong>(Edit: Now solved)</strong>\n<a href=\"https://stackoverflow.com/questions/30470978/new-thread-corrupting-string-data-c\">https://stackoverflow.com/questions/30470978/new-thread-corrupting-string-data-c</a> \nwas too complicated it seems. So this is a more general post to answer my questions.</p>\n\n<p>If a thread is created inside a If, For, while, case, ect. Is the thread's heap a sub set of the memory allocated for the control statement? If so is there a way to choose where in memory the new thread is created? Thank you.\n(Windows 7, Visual Studio 2013, C++ )</p>\n\n<p>Another question I have: \n <a href=\"https://stackoverflow.com/questions/30489891/mutex-not-correctly-used-continuation-of-past-questions\">Mutex not correctly used? Continuation of past questions</a></p>\n"}, {"tags": ["c++", "opencv"], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 4414901, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U2QwVUNO3Mw/AAAAAAAAAAI/AAAAAAAAACY/blkTsEO-QMg/photo.jpg?sz=128", "display_name": "Isra-MiAn", "link": "https://stackoverflow.com/users/4414901/isra-mian"}, "is_accepted": false, "score": 0, "last_activity_date": 1432978676, "creation_date": 1432978676, "answer_id": 30544557, "question_id": 30487029, "link": "https://stackoverflow.com/questions/30487029/how-to-use-mask-in-drawmatches-function-c/30544557#30544557", "title": "How to use mask in drawMatches function c++", "body": "<p>Finally I decided to change the way i will operate. I'm trying to cut the originals images and keep only the necessary information. I mean I get out the information of the photo that it doesn't mind for my application and only keep the information that I'm goint to use. </p>\n\n<p>My idea is to use the epipolar lines of both cameras to determine the interest area that I have, I will calculate where is the epipolar lines in both images and then y cut the images and only keep the information where the epipolar lines are.</p>\n\n<p>Doing it I obtain two new images and my idea is to pass the news images to the matcher method to see if I can obtain more successful matching.\nImage before cut off:\n<img src=\"https://i.stack.imgur.com/CfmHl.jpg\" alt=\"enter image description here\"></p>\n\n<p>Image later cut off:</p>\n\n<p><img src=\"https://i.stack.imgur.com/xXW2n.jpg\" alt=\"enter image description here\"></p>\n\n<p>However I have a problem with the computation time. My code requiresa high computacional cost and sometimes the program fails. The error says \"Segmentation fault:11\".\n\"Bus error 10\" appears if I quit the waitKey() line.\n My code to copy the main image content in the second one is there:</p>\n\n<pre><code>&gt;     for (int i=0; i&lt;RightEpipolarLines.rows; i++) {\n&gt;         float m = -RightEpipolarLines(i, 0)/RightEpipolarLines(i, 1);\n&gt;         float n = -RightEpipolarLines(i, 2)/RightEpipolarLines(i, 1);\n&gt;         for (int x = 0; x &lt; 480; x++) {\n&gt;             float y_prima = m*x + n;\n&gt;             int y = int (y_prima);\n&gt;             (cut_image[0].at&lt;float&gt;(y, x)) = capture[0].at&lt;float&gt;(y, x);\n&gt;         }\n&gt;         \n&gt;     }\n&gt;     waitKey();\n&gt;     for (int i = 0; i&lt;LeftEpipolarLines.rows; i++) {\n&gt;         float m = LeftEpipolarLines(i, 0)/LeftEpipolarLines(i, 1);\n&gt;         float n = -LeftEpipolarLines(i, 2)/LeftEpipolarLines(i, 1);\n&gt;         for (int x = 0; x &lt; 480; x++) {\n&gt;             float y_prima = m*x + n;\n&gt;             int y = int (y_prima);\n&gt;             (cut_image[1].at&lt;float&gt;(y, x)) = capture[1].at&lt;float&gt;(y, x);\n&gt;         }\n&gt;     }\n&gt;     waitKey();\n</code></pre>\n\n<p>Does someone know how to pass the information between real capture and cut_image  more efficiently? I only would like to pass the pixels information that are near the epipolar lines.</p>\n"}], "owner": {"reputation": 61, "user_id": 4414901, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U2QwVUNO3Mw/AAAAAAAAAAI/AAAAAAAAACY/blkTsEO-QMg/photo.jpg?sz=128", "display_name": "Isra-MiAn", "link": "https://stackoverflow.com/users/4414901/isra-mian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 476, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432978676, "creation_date": 1432740972, "question_id": 30487029, "link": "https://stackoverflow.com/questions/30487029/how-to-use-mask-in-drawmatches-function-c", "title": "How to use mask in drawMatches function c++", "body": "<p>I\u00b4m doing a program with opencv and a stereo camera. I want to know what detected point in firs camera below with what detected point in second camera. The think is I have some detectors, extractors and matches methods,  and following the example in opencv I have a algorithm to filter the matches and only draw good matches but in my case the  min_dist parameter depends on my trackBar position.</p>\n\n<p>This is the code of the opencv example:<a href=\"http://docs.opencv.org/doc/tutorials/features2d/feature_flann_matcher/feature_flann_matcher.html#feature-flann-matcher\" rel=\"nofollow\">http://docs.opencv.org/doc/tutorials/features2d/feature_flann_matcher/feature_flann_matcher.html#feature-flann-matcher</a></p>\n\n<p>And there are the changes that I did to move the minimum distance between matches.</p>\n\n<pre><code>//TrackBar position\ndist_track = getTrackbarPos(nombreTrackbar, BUTTON_WINDOW);\n        cout &lt;&lt;\"Posicion de la barra: \" &lt;&lt; dist_track &lt;&lt; endl;\n        good_matches.clear();\n\n        //Obtain good_matches\n        for( int i = 0; i &lt; descriptors[0].rows; i++ )\n        { if( matches[i].distance &lt;= coef*dist_track)  \n        { good_matches.push_back( matches[i]);}\n        }\n</code></pre>\n\n<p>The main think is that when I put the trackBar at the begining I have correct matches but when the trackbar is put in the end, the matches that I found aren\u00b4t correct. In this case I found a lot of matches but many of them are wrong.</p>\n\n<p>Now I\u00b4m trying to do correctly the images. I want to use a mask in drawmatches function to force that the second-camera-points detected has to be near to the epipolar line. Can someone ask me something about it? \nDo someone knows how to use the mask parameter to force that the founded matcher need to be in the epipolar line?</p>\n\n<p>Or how to create the mask parameter?</p>\n\n<p>Thanks friends! </p>\n"}, {"tags": ["c++", "inheritance", "polymorphism"], "comments": [{"owner": {"reputation": 1890, "user_id": 3883676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d826230c9cbfdb8c41214765aa2cc32b?s=128&d=identicon&r=PG&f=1", "display_name": "Othman Benchekroun", "link": "https://stackoverflow.com/users/3883676/othman-benchekroun"}, "edited": false, "score": 4, "creation_date": 1432740649, "post_id": 30486774, "comment_id": 49052237, "body": "Why not define the Enum outside <code>Person</code> ?"}, {"owner": {"reputation": 14958, "user_id": 678093, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/667853b27b3d9f422d6d13924ee4994a?s=128&d=identicon&r=PG", "display_name": "m.s.", "link": "https://stackoverflow.com/users/678093/m-s"}, "edited": false, "score": 2, "creation_date": 1432740652, "post_id": 30486774, "comment_id": 49052241, "body": "<code>class Male</code> is not inheriting from <code>class Person</code>"}, {"owner": {"reputation": 9631, "user_id": 258009, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1ccdf76b2fb6a2c5e3c64e686b092ff0?s=128&d=identicon&r=PG", "display_name": "Component 10", "link": "https://stackoverflow.com/users/258009/component-10"}, "edited": false, "score": 0, "creation_date": 1432740679, "post_id": 30486774, "comment_id": 49052272, "body": "IMHO having the enum within the person class adds nothing and is contextually wrong because it describes something which is non-specific to a Person or a derivative of person. Put it outside the class and your problem goes away."}, {"owner": {"reputation": 616, "user_id": 3450424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc32232a3b80076c7cb91f8adfe07ef?s=128&d=identicon&r=PG&f=1", "display_name": "foobar", "link": "https://stackoverflow.com/users/3450424/foobar"}, "edited": false, "score": 1, "creation_date": 1432740918, "post_id": 30486774, "comment_id": 49052462, "body": "Your example code has nothing to do with polymorphism. Also in your code <code>Male</code> doesn&#39;t inherit from <code>Person</code>. Otherwise it would have to call the <code>Person(std::string, int)</code> constructor. Then <code>std::string _name</code> can be <code>private</code> instead of <code>protected</code> and will be maintained through the parent class instead of through <code>Male</code> itself. In the <code>Person(std::string, int)</code> constructor you should expect your enum type instead of a plain <code>int</code>. The prefered way in C++ is to use an <code>enum class</code> and not an anonymous <code>enum</code>. Just define the <code>enum class</code> outside <code>Person</code> but within the same <code>namespace</code>."}, {"owner": {"reputation": 3567, "user_id": 4019871, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7db9ac6bdc0a996dd01da64b3660f8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Mas Bagol", "link": "https://stackoverflow.com/users/4019871/mas-bagol"}, "edited": false, "score": 0, "creation_date": 1432741151, "post_id": 30486774, "comment_id": 49052615, "body": "sorry,  i mean <code>class Male : public person</code>. Typo ... edited"}, {"owner": {"reputation": 616, "user_id": 3450424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc32232a3b80076c7cb91f8adfe07ef?s=128&d=identicon&r=PG&f=1", "display_name": "foobar", "link": "https://stackoverflow.com/users/3450424/foobar"}, "edited": false, "score": 1, "creation_date": 1432741187, "post_id": 30486774, "comment_id": 49052638, "body": "Also when inheriting <code>Male</code> from Person it doesn&#39;t make any sense to have that <code>enum</code> as the gender is defined by the inheriting classes and <code>Person</code> should most likely be abstract then. Could it be that you&#39;re trying to implement a factory?"}, {"owner": {"reputation": 3567, "user_id": 4019871, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7db9ac6bdc0a996dd01da64b3660f8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Mas Bagol", "link": "https://stackoverflow.com/users/4019871/mas-bagol"}, "reply_to_user": {"reputation": 616, "user_id": 3450424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc32232a3b80076c7cb91f8adfe07ef?s=128&d=identicon&r=PG&f=1", "display_name": "foobar", "link": "https://stackoverflow.com/users/3450424/foobar"}, "edited": false, "score": 0, "creation_date": 1432741479, "post_id": 30486774, "comment_id": 49052828, "body": "@foobar The main purpose of <code>Person</code> class existence is to be inherited, so there will be very rare or even no <code>Person</code> object in my code. I didn&#39;t make it an abstract class because, in case I need a standalone <code>Person</code> object."}, {"owner": {"reputation": 658, "user_id": 4161244, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/80ba8dd588e2b3d9cd382b33b7759615?s=128&d=identicon&r=PG&f=1", "display_name": "Brahim", "link": "https://stackoverflow.com/users/4161244/brahim"}, "edited": false, "score": 0, "creation_date": 1432741491, "post_id": 30486774, "comment_id": 49052838, "body": "Why don&#39;t you use a factory design pattern"}, {"owner": {"reputation": 3567, "user_id": 4019871, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7db9ac6bdc0a996dd01da64b3660f8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Mas Bagol", "link": "https://stackoverflow.com/users/4019871/mas-bagol"}, "reply_to_user": {"reputation": 658, "user_id": 4161244, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/80ba8dd588e2b3d9cd382b33b7759615?s=128&d=identicon&r=PG&f=1", "display_name": "Brahim", "link": "https://stackoverflow.com/users/4161244/brahim"}, "edited": false, "score": 0, "creation_date": 1432741527, "post_id": 30486774, "comment_id": 49052864, "body": "@Brahim What is that? Sorry, I am too slow :)"}, {"owner": {"reputation": 658, "user_id": 4161244, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/80ba8dd588e2b3d9cd382b33b7759615?s=128&d=identicon&r=PG&f=1", "display_name": "Brahim", "link": "https://stackoverflow.com/users/4161244/brahim"}, "edited": false, "score": 0, "creation_date": 1432741620, "post_id": 30486774, "comment_id": 49052947, "body": "It is an object oriented pattern. The idea is to create a Factory class that is responsible for the creation of the persons. check this <a href=\"http://en.wikipedia.org/wiki/Factory_method_pattern\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Factory_method_pattern</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3567, "user_id": 4019871, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7db9ac6bdc0a996dd01da64b3660f8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Mas Bagol", "link": "https://stackoverflow.com/users/4019871/mas-bagol"}, "edited": false, "score": 0, "creation_date": 1432741709, "post_id": 30487135, "comment_id": 49053018, "body": "Doesn&#39;t that mean <code>Male</code> class cannot has public functions at all?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1432741745, "post_id": 30487135, "comment_id": 49053032, "body": "Now you can&#39;t do <code>Person* p = new Male(&quot;Joe&quot;);</code>, that isn&#39;t really good."}], "tags": [], "owner": {"reputation": 12139, "user_id": 2412846, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eBJip.gif?s=128&g=1", "display_name": "davidhigh", "link": "https://stackoverflow.com/users/2412846/davidhigh"}, "is_accepted": false, "score": 1, "last_activity_date": 1432741292, "creation_date": 1432741292, "answer_id": 30487135, "question_id": 30486774, "link": "https://stackoverflow.com/questions/30486774/c-prevent-inherit-specific-public-member-of-base-class/30487135#30487135", "title": "C++ prevent inherit specific public member of base class", "body": "<p>The comments in the OP suggest a rethinking of your design, and probably that is the best alternative.</p>\n\n<p>Still, if you want to keep up with what you wrote in the answer, one possibility is to derive <code>protected</code>ly from your base class</p>\n\n<pre><code>class Person {\n    public:\n        enum { MALE, FEMALE, BOTH };\n        Person(std::string name, int gender)\n            : _name(name)\n        {\n            switch (gender) { /* processing here */ }\n        }\n    protected:\n        std::string _name;\n};\n\nclass Male : protected Person\n{          //^^^^^^^^^\n\n    public:\n        Male(std::string name)\n            : Person(name, 0) { }\n\n        void foo() { FEMALE; }  // still ok, a public field derived protected'ly is accessible\n};\n\nint main()\n{\n    Male male(\"Joe\");\n    male.MALE;     //error, cannot call the enum from outside the class\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 616, "user_id": 3450424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc32232a3b80076c7cb91f8adfe07ef?s=128&d=identicon&r=PG&f=1", "display_name": "foobar", "link": "https://stackoverflow.com/users/3450424/foobar"}, "edited": false, "score": 0, "creation_date": 1432741954, "post_id": 30487330, "comment_id": 49053184, "body": "He wants the users of <code>Person</code> to have access to the <code>enum</code>, but not derived classes. So the problem is actually the other way round."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 616, "user_id": 3450424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc32232a3b80076c7cb91f8adfe07ef?s=128&d=identicon&r=PG&f=1", "display_name": "foobar", "link": "https://stackoverflow.com/users/3450424/foobar"}, "edited": false, "score": 0, "creation_date": 1432742087, "post_id": 30487330, "comment_id": 49053283, "body": "@foobar: For that use case, I would instead define helper derived classes for each <code>enum</code>."}, {"owner": {"reputation": 616, "user_id": 3450424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc32232a3b80076c7cb91f8adfe07ef?s=128&d=identicon&r=PG&f=1", "display_name": "foobar", "link": "https://stackoverflow.com/users/3450424/foobar"}, "edited": false, "score": 0, "creation_date": 1432743523, "post_id": 30487330, "comment_id": 49054219, "body": "Then please adjust the answer to satisfy the question."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 616, "user_id": 3450424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc32232a3b80076c7cb91f8adfe07ef?s=128&d=identicon&r=PG&f=1", "display_name": "foobar", "link": "https://stackoverflow.com/users/3450424/foobar"}, "edited": false, "score": 0, "creation_date": 1432745058, "post_id": 30487330, "comment_id": 49055161, "body": "@foobar: Hmm... that wasn&#39;t really the intent of the answer, but I have extended it with why this way will work."}, {"owner": {"reputation": 2677, "user_id": 3370480, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/U8ayS.jpg?s=128&g=1", "display_name": "Flovdis", "link": "https://stackoverflow.com/users/3370480/flovdis"}, "edited": false, "score": 0, "creation_date": 1432801262, "post_id": 30487330, "comment_id": 49078054, "body": "In the question the author states: &quot;..., but make it available for public from the base class.&quot; If you set it to protected, this is not the case anymore."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 2677, "user_id": 3370480, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/U8ayS.jpg?s=128&g=1", "display_name": "Flovdis", "link": "https://stackoverflow.com/users/3370480/flovdis"}, "edited": false, "score": 0, "creation_date": 1432822117, "post_id": 30487330, "comment_id": 49093355, "body": "@Flovdis: Sometimes the answer is: Don&#39;t try to do that. In this case, it isn&#39;t that great of a burden, since it is possible to create a derived <code>Person</code> that exposes the <code>enum</code> values."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 2, "last_activity_date": 1432745672, "last_edit_date": 1432745672, "creation_date": 1432741797, "answer_id": 30487330, "question_id": 30486774, "link": "https://stackoverflow.com/questions/30486774/c-prevent-inherit-specific-public-member-of-base-class/30487330#30487330", "title": "C++ prevent inherit specific public member of base class", "body": "<p>If you insist on keeping the <code>enum</code> within the base class, you can place the <code>enum</code> in a protected section.</p>\n\n<pre><code>class Person {\n    protected:\n        enum Gender { MALE, FEMALE, BOTH };\n        Person(std::string name, Gender gender)\n            : _name(name)\n        {\n            switch (gender) { /* processing here */ }\n        }\n        std::string _name;\n    public:\n        virtual ~Person () {}\n        //...\n};\n</code></pre>\n\n<p>A class that derives from <code>Person</code> publicly will still have access to the <code>enum</code> values, but users of the derived class will not.</p>\n\n<pre><code>class Male : public Person {\n    public:\n        Male (std::string name) : Person(name, MALE) {}\n        //...\n};\n</code></pre>\n\n<p>Thus, a <code>Male</code> can use <code>MALE</code>, but users of <code>Male</code> will not see <code>Male::MALE</code>, <code>Male::FEMALE</code>, nor <code>Male::BOTH</code>, which was one of your original issues. As to your questions, you don't really want to deny the derived class access, since you want the derived class to be able to specify the <code>Gender</code>. And you should not really allow any direct users of <code>Person</code>. Instead, a user of <code>Person</code> picks one of the correct derived classes, which will then establish <code>Gender</code> properly.</p>\n\n<pre><code>class Female : public Person {\n    public:\n        Female (std::string name) : Person(name, FEMALE) {}\n        //...\n};\n\nclass Transgender : public Person {\n    public:\n        Transgender (std::string name) : Person(name, BOTH) {}\n        //...\n};\n\nstd::shared_ptr&lt;Person&gt; p = std::make_shared&lt;Female&gt;(\"Beth\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6701, "user_id": 3591273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e9f02f036080c8be4e2abfcf753be75?s=128&d=identicon&r=PG", "display_name": "Nikos M.", "link": "https://stackoverflow.com/users/3591273/nikos-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1432817854, "last_edit_date": 1432817854, "creation_date": 1432742116, "answer_id": 30487486, "question_id": 30486774, "link": "https://stackoverflow.com/questions/30486774/c-prevent-inherit-specific-public-member-of-base-class/30487486#30487486", "title": "C++ prevent inherit specific public member of base class", "body": "<p>the problem seems to be a literate one, there is no problem with the code per se, but in viewing the code as a language reflecting common notions.</p>\n\n<p>In this sense i would suggest the following answer:</p>\n\n<p>have a factory (or factory method) where the enum is public only in that factory. In other words create a new factory <code>Human</code> and have all base and derived classes using <code>Human</code> enums. Then the base class can still be <code>Person</code> but <code>Person</code> does not have any enum <code>MALE</code>/<code>FEMALE</code>/etc.. only the <code>Human</code> factory does, and it is not a base class that is subclassed. This would result in code which can be read literaly like this:</p>\n\n<pre><code>Person person(\"The Name\", Human::MALE);\n</code></pre>\n\n<p>You can also use <code>Gender</code> factory (instead of <code>Human</code>) like this (to be even more literate and separate the inter-dependencies):</p>\n\n<pre><code>Person person(\"The Name\", Gender::MALE);\n</code></pre>\n\n<p>Note that a <strong>base class includes the lowest common denominator that all derived classes must share</strong>. So since the derived classes <code>Male</code> <code>Female</code> etc are not supposed to share the <code>gender enum</code> then it should not be part of the base class, but a class or construct in itself which is then used by <code>Person</code> classes and its derivatives.</p>\n"}, {"tags": [], "owner": {"reputation": 2677, "user_id": 3370480, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/U8ayS.jpg?s=128&g=1", "display_name": "Flovdis", "link": "https://stackoverflow.com/users/3370480/flovdis"}, "is_accepted": false, "score": -1, "last_activity_date": 1432743009, "last_edit_date": 1432743009, "creation_date": 1432742551, "answer_id": 30487638, "question_id": 30486774, "link": "https://stackoverflow.com/questions/30486774/c-prevent-inherit-specific-public-member-of-base-class/30487638#30487638", "title": "C++ prevent inherit specific public member of base class", "body": "<p>Simple make the <code>Person</code> class abstract using a protected constructor:</p>\n\n<pre><code>class Person {\npublic:\n    enum Gender {\n        MALE,\n        FEMALE,\n        BOTH\n    };\n\nprotected:\n    // Protected constructor can only be called from subclasses.\n    Person(std::string name, Gender gender)\n        : _name(name)\n    {\n        switch (gender) { /* processing here */ }\n    }\n\nprotected:\n    std::string _name;\n};\n\nclass Male : public Person {\n    public:\n        Male(std::string name)\n            : Person(name, MALE)\n        {\n        }\n};\n</code></pre>\n\n<p>If the gender is anyway independent from the Person class, just move it out of the class:</p>\n\n<pre><code>enum Gender {\n    GenderMale,\n    GenderFemale,\n    GenderBoth\n};\n\nclass Person //...\nclass Male // ...\n</code></pre>\n\n<p>You can also encapsulate the Gender into a own class:</p>\n\n<pre><code>class Gender {\npublic:\n    enum Type { Male, Female, Both };\n    Gender(Type type); \n    Gender(const Gender &amp;copy);\n    Gender&amp; operator=(Gender &amp;assign);\npublic:\n    bool operator==(const Gender &amp;other) const;\n    // etc.\npublic:\n    std::string toString() const;\n};\n</code></pre>\n"}], "owner": {"reputation": 3567, "user_id": 4019871, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7db9ac6bdc0a996dd01da64b3660f8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Mas Bagol", "link": "https://stackoverflow.com/users/4019871/mas-bagol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "accepted_answer_id": 30487330, "answer_count": 4, "score": 2, "last_activity_date": 1432817854, "creation_date": 1432740361, "last_edit_date": 1432741177, "question_id": 30486774, "link": "https://stackoverflow.com/questions/30486774/c-prevent-inherit-specific-public-member-of-base-class", "title": "C++ prevent inherit specific public member of base class", "body": "<p>How can I prevent a public member to be inherited by it's derived class? Like, if I have this:</p>\n\n<pre><code>class Person {\n    public:\n        enum { MALE, FEMALE, BOTH };\n        Person(std::string name, int gender)\n            : _name(name)\n        {\n            switch (gender) { /* processing here */ }\n        }\n    protected:\n        std::string _name;\n};\n\nclass Male : public Person {\n    public:\n        Male(std::string name)\n            : _name(name, 0) { }\n};\n</code></pre>\n\n<p>The reason I want to do this is, I want to be able to instantiate a person class with something like:</p>\n\n<pre><code>Person person(\"The Name\", Person::MALE);\n</code></pre>\n\n<p>But, because the <code>enum</code> is public this is also available:</p>\n\n<pre><code>Male::MALE\nMale::FEMALE\nMale::BOTH\n</code></pre>\n\n<p>which doesn't make any sense anymore. How can I prevent the derived class to be able to access those enum values, but make it available for public from the base class?</p>\n"}]