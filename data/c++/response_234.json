[{"tags": ["c++", "graph"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562198002, "post_id": 56879070, "comment_id": 100306799, "body": "<a href=\"https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-i-e-while-stream-eof-cons\"><code>while (!f.eof())</code> is evil.</a> Consider using <code>while(f &gt;&gt; num1 &gt;&gt; num2 &gt;&gt; line2;)</code> instead. It won&#39;t enter the loop if any of the inputs fail for any reason."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562198225, "post_id": 56879070, "comment_id": 100306832, "body": "<a href=\"https://stackoverflow.com/questions/1887097/why-arent-variable-length-arrays-part-of-the-c-standard\">Fear the VLA.</a> They are non-portable and potential stack-killers."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562198338, "post_id": 56879070, "comment_id": 100306846, "body": "<code>string findShortestPath(int start, int end)</code> promices to return a <code>string</code>, but it doesn&#39;t look like it does. While a compiler will allow this, usually with a warning, the code it generates is questionable. I recommend replacing the return type with <code>void</code> or rethinking the function."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562198531, "post_id": 56879070, "comment_id": 100306877, "body": "Speaking of warnings, a good compiler will tell you almost exactly what is wrong: <i>warning: variable &#39;data&#39; set but not used</i>. Don&#39;t ignore the warnings. they are the first line of defense against logic errors. If you research and resolve them when the compiler alerts you to them, you generally save a lot of time debugging."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11639298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfaa6d9deb8c4257f250e765a6787fbb?s=128&d=identicon&r=PG&f=1", "display_name": "zman1", "link": "https://stackoverflow.com/users/11639298/zman1"}, "edited": false, "score": 0, "creation_date": 1562200425, "post_id": 56879145, "comment_id": 100307168, "body": "how could I call the data into findShortestPath?"}, {"owner": {"reputation": 93, "user_id": 10602996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc2861a9c39404c2a7718baf8bb3a6e?s=128&d=identicon&r=PG&f=1", "display_name": "linjoehan", "link": "https://stackoverflow.com/users/10602996/linjoehan"}, "reply_to_user": {"reputation": 1, "user_id": 11639298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfaa6d9deb8c4257f250e765a6787fbb?s=128&d=identicon&r=PG&f=1", "display_name": "zman1", "link": "https://stackoverflow.com/users/11639298/zman1"}, "edited": false, "score": 0, "creation_date": 1562202667, "post_id": 56879145, "comment_id": 100307507, "body": "you could make data a global variable (declare it outside any functions or main) and remove the declarations in both functions."}], "tags": [], "owner": {"reputation": 93, "user_id": 10602996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc2861a9c39404c2a7718baf8bb3a6e?s=128&d=identicon&r=PG&f=1", "display_name": "linjoehan", "link": "https://stackoverflow.com/users/10602996/linjoehan"}, "is_accepted": false, "score": 0, "last_activity_date": 1562198724, "last_edit_date": 1562198724, "creation_date": 1562197758, "answer_id": 56879145, "question_id": 56879070, "link": "https://stackoverflow.com/questions/56879070/shortest-path-given-beginning-and-end-of-a-weighted-graph/56879145#56879145", "title": "Shortest path given beginning and end of a weighted graph", "body": "<p>In your <code>findShortestPath</code> function <code>data[numVertices][numVertices]</code> is not the same as the <code>data</code> variable in your <code>createGraph</code> function.</p>\n\n<p>Look at this <a href=\"https://www.geeksforgeeks.org/scope-of-variables-in-c/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/scope-of-variables-in-c/</a> or try finding other sources on scope of variables.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11639298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfaa6d9deb8c4257f250e765a6787fbb?s=128&d=identicon&r=PG&f=1", "display_name": "zman1", "link": "https://stackoverflow.com/users/11639298/zman1"}, "edited": false, "score": 0, "creation_date": 1562204709, "post_id": 56879583, "comment_id": 100307826, "body": "It is an assignment and I am not allowed to change the findShortestPath function parameters. Trying to find another way."}, {"owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "reply_to_user": {"reputation": 1, "user_id": 11639298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfaa6d9deb8c4257f250e765a6787fbb?s=128&d=identicon&r=PG&f=1", "display_name": "zman1", "link": "https://stackoverflow.com/users/11639298/zman1"}, "edited": false, "score": 0, "creation_date": 1562204955, "post_id": 56879583, "comment_id": 100307863, "body": "@zman1 Use global variables then. Move your <code>int data[50][50]</code> to global scope."}], "tags": [], "owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "is_accepted": false, "score": 0, "last_activity_date": 1562203355, "creation_date": 1562203355, "answer_id": 56879583, "question_id": 56879070, "link": "https://stackoverflow.com/questions/56879070/shortest-path-given-beginning-and-end-of-a-weighted-graph/56879583#56879583", "title": "Shortest path given beginning and end of a weighted graph", "body": "<p>In your function <code>findShortestPath</code> you have declared a local array called <code>data</code>, which is supposed to store the adjacency matrix data. However, you have never written any data into it! Consider passing the matrix as a function argument. Your function signature should look something like this:  </p>\n\n<pre><code>findShortestPath(int** data, int numVertices, int start, int end)\n</code></pre>\n\n<p>Also, avoid using VLA as it is not part of the standard. Consider creating a two dimensional array on the heap using <code>new</code>. (and don't forget to do <code>delete[]</code> after you are done!)</p>\n\n<p>Or you can use <code>std::vector&lt;std::vector&lt;int&gt;&gt;</code>, if you don't want to manage your array's lifetime manually.</p>\n"}], "owner": {"reputation": 1, "user_id": 11639298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfaa6d9deb8c4257f250e765a6787fbb?s=128&d=identicon&r=PG&f=1", "display_name": "zman1", "link": "https://stackoverflow.com/users/11639298/zman1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1562203355, "creation_date": 1562196969, "last_edit_date": 1562197858, "question_id": 56879070, "link": "https://stackoverflow.com/questions/56879070/shortest-path-given-beginning-and-end-of-a-weighted-graph", "title": "Shortest path given beginning and end of a weighted graph", "body": "<p>I have to read in a file to create a weighted graph. The shortest path must be found using input from the file. File will be structured as first line = numVertices and every line below that has 3 numbers given as : 0 1 2  where 0 is start of an edge, 1 is the end of the edge, and 2 is the weight. I've tried implementing an adjacency matrix when creating my graph but have had no luck. Any suggestions would be greatly appreciated.</p>\n\n<p>Have tried restructuring the way I read in my file and have also tried adjusting my findShortestPath function.</p>\n\n<pre><code>void createGraph(string file_name) //Function to create a graph based on a file, whose name is file_name.\n{\n    ifstream f(file_name);\n    if (f.fail())\n    {\n        return;\n    }\n    string line;\n    getline(f, line);\n    int num = stoi(line);\n    numVertices = num;\n\n    int data[50][50];\n\n    string line2;\n    int num1 = 0, num2 = 0, num3 = 0;\n\n    while (!f.eof())\n    {\n        f &gt;&gt; num1;\n        f &gt;&gt; num2;\n        f &gt;&gt; line2;\n        num3 = stoi(line2);\n        data[num1][num2] = num3;\n\n    }\n\n}\n//////////////////shortest path function\n\nstring findShortestPath(int start, int end)\n{\n    int data[numVertices][numVertices];\n    int dist[numVertices];\n    bool sptSet[numVertices];\n    int parent[numVertices];\n\n    for (int i = 0; i &lt; numVertices; i++)\n    {\n        parent[0] = -1;\n        dist[i] = INT_MAX;\n        sptSet[i] = false;\n    }\n\n    dist[start] = 0;\n\n    for (int count = 0; count &lt; numVertices - 1; count++)\n    {\n        int u = minDistance(dist, sptSet);\n        sptSet[u] = true;\n        if (sptSet[u] == end)\n            break;\n\n        for (int v = 0; v &lt; numVertices; v++)\n            if (!sptSet[v] &amp;&amp; data[u][v] &amp;&amp; dist[u] + data[u][v] &lt; dist[v])\n            {\n                parent[numVertices] = end;\n                dist[v] = dist[u] + data[u][v];\n            }\n    }\n    printSolution(parent);\n</code></pre>\n\n<p>Output is not outputting shortest path and is printing random numbers.</p>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 4, "creation_date": 1562195616, "post_id": 56878932, "comment_id": 100306364, "body": "Why do you think you want to do this?"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 1, "creation_date": 1562195646, "post_id": 56878932, "comment_id": 100306374, "body": "You cannot. Taking the address of a local and dereferencing it outside the scope where it&#39;s defined is UB."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1562196106, "post_id": 56878932, "comment_id": 100306475, "body": "See <a href=\"https://stackoverflow.com/questions/4570366/how-to-access-a-local-variable-from-a-different-function-using-pointers\">this question</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562196835, "post_id": 56878932, "comment_id": 100306614, "body": "Originally, this question was tagged with both C (<a href=\"https://stackoverflow.com/questions/tagged/c\">c</a>) and C++ (<a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a>).  Then the C++ tag was removed, even though the question references &#39;class member variable&#39; which is a non-concept in a C program.  The answers, not unreasonably, use <code>new</code> and other bits of C++ (<code>unique_ptr</code>, <code>shared_ptr</code>, etc.).  It is probably better tagged C++ than C, therefore \u2014 even if the sample code is better C code than C++."}, {"owner": {"reputation": 9, "user_id": 11735998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEPtF.jpg?s=128&g=1", "display_name": "Condensation", "link": "https://stackoverflow.com/users/11735998/condensation"}, "edited": false, "score": 0, "creation_date": 1562197123, "post_id": 56878932, "comment_id": 100306664, "body": "what are <code>unique_ptr</code>/<code>shared_ptr </code>?"}, {"owner": {"reputation": 590, "user_id": 4260902, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/100000665496061/picture?type=large", "display_name": "Michael Choi", "link": "https://stackoverflow.com/users/4260902/michael-choi"}, "edited": false, "score": 0, "creation_date": 1562197433, "post_id": 56878932, "comment_id": 100306714, "body": "@AlexB <code>unique_ptr</code> / <code>shared_ptr</code> are memory-managing pointers. If you are familiar with constructors with destructors, they automatically delete allocated data when the memory is no longer used. It is quite a big topic so I would try looking through tutorials to see if can be something that might help."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1562199640, "post_id": 56878932, "comment_id": 100307047, "body": "<a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">Prefer a highly recommended book</a> to tutorials found by web searches. The Internet is littered with bad tutorials, some so bad that you&#39;ll become a worse programmer from reading them. Until you know the language well enough to tell good advice from bad, you&#39;ll be at the mercy of charlatans and blathering morons. If you are still interested in tutorials, seek out the acknowledged domain experts and use their tutorials or tutorials they recommend. Do not recommend tutorials unless you have a good one in mind."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 1, "creation_date": 1562203560, "post_id": 56878932, "comment_id": 100307643, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4570366/how-to-access-a-local-variable-from-a-different-function-using-pointers\">How to access a local variable from a different function using pointers?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11735998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEPtF.jpg?s=128&g=1", "display_name": "Condensation", "link": "https://stackoverflow.com/users/11735998/condensation"}, "edited": false, "score": 0, "creation_date": 1562196633, "post_id": 56878946, "comment_id": 100306580, "body": "I tried having the function also return <code>a</code>, but leave the returned variable unused. Will this fix the issue?"}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "reply_to_user": {"reputation": 9, "user_id": 11735998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEPtF.jpg?s=128&g=1", "display_name": "Condensation", "link": "https://stackoverflow.com/users/11735998/condensation"}, "edited": false, "score": 0, "creation_date": 1562197155, "post_id": 56878946, "comment_id": 100306671, "body": "Smart pointers. They will auto destruct when not anymore needed. Never do new/delete again."}, {"owner": {"reputation": 590, "user_id": 4260902, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/100000665496061/picture?type=large", "display_name": "Michael Choi", "link": "https://stackoverflow.com/users/4260902/michael-choi"}, "edited": false, "score": 0, "creation_date": 1562198715, "post_id": 56878946, "comment_id": 100306901, "body": "@MichaelChourdakis Of course binding a global pointer to a static variable is bad. Still, the question explicitly asks how to persist the pointer data after the function executes. Just because the premise of a question is &#39;bad&#39; does not make accurate answers to that question bad."}], "tags": [], "owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "is_accepted": false, "score": 0, "last_activity_date": 1562197296, "last_edit_date": 1562197296, "creation_date": 1562195630, "answer_id": 56878946, "question_id": 56878932, "link": "https://stackoverflow.com/questions/56878932/how-do-i-prevent-a-function-from-freeing-memory-of-a-local-variable/56878946#56878946", "title": "How do I prevent a function from freeing memory of a local variable?", "body": "<p>That <strong>is</strong> the point of using automatic storage variables, to vanish when they go out of scope.\nPointing to them after they are destroyed is undefined behaviour. UB may return you a correct value, a wrong value, or crash your app, or whatever.</p>\n\n<p>If you want to keep it, do not make it local. Use (and return) a <code>unique_ptr</code>/<code>shared_ptr</code> (although I do not see why you want to do that in your code anyway).</p>\n\n<p>All the answers suggesting a static variable are bad. While it will work temporarily, it is bound to create lots of other problems if you make it a habit.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 11735998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEPtF.jpg?s=128&g=1", "display_name": "Condensation", "link": "https://stackoverflow.com/users/11735998/condensation"}, "edited": false, "score": 0, "creation_date": 1562196357, "post_id": 56878990, "comment_id": 100306520, "body": "If I make <code>a</code> static within a function of a c++ class, will it be a global variable, a member variable, or will it only be accessible within that function?"}, {"owner": {"reputation": 590, "user_id": 4260902, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/100000665496061/picture?type=large", "display_name": "Michael Choi", "link": "https://stackoverflow.com/users/4260902/michael-choi"}, "reply_to_user": {"reputation": 9, "user_id": 11735998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEPtF.jpg?s=128&g=1", "display_name": "Condensation", "link": "https://stackoverflow.com/users/11735998/condensation"}, "edited": false, "score": 0, "creation_date": 1562196418, "post_id": 56878990, "comment_id": 100306532, "body": "@AlexB You can treat it like a global variable that is only accessible within that function."}, {"owner": {"reputation": 9, "user_id": 11735998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEPtF.jpg?s=128&g=1", "display_name": "Condensation", "link": "https://stackoverflow.com/users/11735998/condensation"}, "edited": false, "score": 0, "creation_date": 1562196454, "post_id": 56878990, "comment_id": 100306542, "body": "And if I call the function again in the future but store <code>&amp;a</code> into a different pointer, will that ruin my original pointer?"}, {"owner": {"reputation": 590, "user_id": 4260902, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/100000665496061/picture?type=large", "display_name": "Michael Choi", "link": "https://stackoverflow.com/users/4260902/michael-choi"}, "reply_to_user": {"reputation": 9, "user_id": 11735998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEPtF.jpg?s=128&g=1", "display_name": "Condensation", "link": "https://stackoverflow.com/users/11735998/condensation"}, "edited": false, "score": 0, "creation_date": 1562197254, "post_id": 56878990, "comment_id": 100306688, "body": "@AlexB It will not. It simply means you have multiple points where you can change your data."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562200034, "post_id": 56878990, "comment_id": 100307109, "body": "Note that <a href=\"https://en.cppreference.com/w/cpp/language/storage_duration#Linkage\" rel=\"nofollow noreferrer\"><code>static</code> outside of a function</a> means something very different from <a href=\"https://en.cppreference.com/w/cpp/language/storage_duration#Static_local_variables\" rel=\"nofollow noreferrer\"><code>static</code> inside a function</a>. And both are different from the meaning of <a href=\"https://en.cppreference.com/w/cpp/language/static\" rel=\"nofollow noreferrer\"><code>static</code> inside a class</a>."}], "tags": [], "owner": {"reputation": 590, "user_id": 4260902, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/100000665496061/picture?type=large", "display_name": "Michael Choi", "link": "https://stackoverflow.com/users/4260902/michael-choi"}, "is_accepted": false, "score": 1, "last_activity_date": 1562195975, "creation_date": 1562195975, "answer_id": 56878990, "question_id": 56878932, "link": "https://stackoverflow.com/questions/56878932/how-do-i-prevent-a-function-from-freeing-memory-of-a-local-variable/56878990#56878990", "title": "How do I prevent a function from freeing memory of a local variable?", "body": "<p>If you want the variable inside <code>foo</code> to persist after the function call, then you must make <code>a</code> a static variable. C++ is a stack-based machine: that means the lifetime of a variable is restricted to it's scope. In your example <code>a</code> is restricted to the scope of <code>foo</code>. If you make your variable static, then it will extend the lifetime of your variable to the top-level scope, but will limit your access to <code>a</code> within your function.</p>\n\n<p>I feel like what you are trying to do is very code smelly, but here is what you requested:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstatic int* p;\n\nvoid foo(){\n    static int a = 5; // a will only be initialized to 5 once (see magic statics)\n    p = &amp;a;\n}\n\nint main(){\n    foo();\n\n    //some delay\n\n    printf(\"*p = %d\\n\", *p);\n}\n</code></pre>\n\n<p>In this example you are guaranteed that <code>a</code> will be initialized upon your first call and will not be reused or deleted until the end of your program.</p>\n"}, {"comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1562197207, "post_id": 56879004, "comment_id": 100306681, "body": "And what <i>is</i> viable and more clever in your opinion?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 9, "user_id": 11735998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEPtF.jpg?s=128&g=1", "display_name": "Condensation", "link": "https://stackoverflow.com/users/11735998/condensation"}, "edited": false, "score": 0, "creation_date": 1562199122, "post_id": 56879004, "comment_id": 100306966, "body": "@AlexB don&#39;t get too clever. You won&#39;t be able to debug it. Let the compiler get clever, then test it&#39;s cleverness with a profiler. If it is found wanting, get a little more clever with the worst parts."}], "tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": false, "score": 4, "last_activity_date": 1562196164, "creation_date": 1562196164, "answer_id": 56879004, "question_id": 56878932, "link": "https://stackoverflow.com/questions/56878932/how-do-i-prevent-a-function-from-freeing-memory-of-a-local-variable/56879004#56879004", "title": "How do I prevent a function from freeing memory of a local variable?", "body": "<h2>Solution 1 - dynamic memory allocation with new and delete</h2>\n\n<p>If you want a memory location to be accessible after a function exits, you should allocate it dynamically using <code>new</code>:</p>\n\n<pre><code>int* foo() {\n    int* p = new int(5); // Get pointer to int with value of 5\n    return p; \n}\n</code></pre>\n\n<p>Because that pointer was allocated with <code>new</code>, it'll stick around until you call <code>delete</code> on it:</p>\n\n<pre><code>int main() {\n    int* myPtr = foo(); \n\n    // Do stuff with myPtr\n\n    delete myPtr; // Free it, now that it's no longer needed.\n}\n</code></pre>\n\n<h3>Potential issues</h3>\n\n<p>When people talk about having to do manual memory management in C++, this is usually what they mean. Figuring out when to call <code>delete</code> on an object can be tricky, and it's easy to mess things up. </p>\n\n<h2>Solution 2 - variable <code>a</code> exists even after the function exits, and it's the same <code>a</code> every time the function is called</h2>\n\n<p>If we mark <code>a</code> as static, then it'll have the same memory address every time the function is called, and it won't be deallocated:</p>\n\n<pre><code>int* p;\nvoid foo() {\n    static int a = 5;\n\n    p = a;\n}\n\nint main() {\n    foo(); \n\n    // stuff...\n\n    std::cout &lt;&lt; *p &lt;&lt; '\\n'; // Prints 5, unless you modified *p\n}\n</code></pre>\n\n<h2>But why?</h2>\n\n<p>Oftentimes, when giving a good answer, it's helpful to understand why the person asking wants to do something. You don't provide any information about why you want to do this, so I don't know what (specifically) to propose. </p>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 11731622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MjD0MIY49Rw/AAAAAAAAAAI/AAAAAAAAABA/L1KB-3R83Zk/photo.jpg?sz=128", "display_name": "Alan Barrett II", "link": "https://stackoverflow.com/users/11731622/alan-barrett-ii"}, "is_accepted": false, "score": -1, "last_activity_date": 1562198922, "last_edit_date": 1562198922, "creation_date": 1562196515, "answer_id": 56879034, "question_id": 56878932, "link": "https://stackoverflow.com/questions/56878932/how-do-i-prevent-a-function-from-freeing-memory-of-a-local-variable/56879034#56879034", "title": "How do I prevent a function from freeing memory of a local variable?", "body": "<p>Use a static variable, and it will solve your issue of it being 5.\nThe memory on the other hand will not be saved due to the fact that it's a local variable. </p>\n"}], "owner": {"reputation": 9, "user_id": 11735998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEPtF.jpg?s=128&g=1", "display_name": "Condensation", "link": "https://stackoverflow.com/users/11735998/condensation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 4, "score": -3, "last_activity_date": 1562198922, "creation_date": 1562195468, "last_edit_date": 1562196881, "question_id": 56878932, "link": "https://stackoverflow.com/questions/56878932/how-do-i-prevent-a-function-from-freeing-memory-of-a-local-variable", "title": "How do I prevent a function from freeing memory of a local variable?", "body": "<p>I am trying to save a local variable from a function by storing it's address. However, it appears that the compiler is automatically freeing the memory of that variable, even after I store it's address into a pointer variable.</p>\n\n<p>I am in a situation (not exactly like the code below) where I must have a class's member variable store the address of a variable declared in a function.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstatic int* p;\n\nvoid foo(){\n    int a = 5;\n    p = &amp;a;\n}\n\nint main(){\n    foo();\n\n    //some delay\n\n    printf(\"*p = %d\\n\",*p);\n}\n</code></pre>\n\n<p>Ideally, <code>*p</code> should be 5, but it ends up being a number that isn't 5, and it's different much of the times I rerun the script. I believe that the memory allocated to <code>a</code> in <code>foo</code> is being freed automatically. How can I make sure <code>*p</code> is 5 despite any delay?</p>\n"}, {"tags": ["c++", "fingerprint"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562254029, "post_id": 56878819, "comment_id": 100328633, "body": "Do you not need <code>fp_dscv_dev_get_driver (struct fp_dscv_dev *dev);</code> or <code>fp_dscv_dev_get_devtype (struct fp_dscv_dev *dev);</code>? Have you looked at <code>fp_dev_get_nr_enroll_stages (struct fp_dev *dev);</code> to determine the number of times you must enroll the device to complete a scan? The <a href=\"https://fprint.freedesktop.org/libfprint-stable/libfprint-Devices-operations.html\" rel=\"nofollow noreferrer\">Devices operations</a> is fairly clear that may require enrolling more than once."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8005288, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202794360057156/picture?type=large", "display_name": "German Eduardo Salazar Aranda", "link": "https://stackoverflow.com/users/8005288/german-eduardo-salazar-aranda"}, "edited": false, "score": 0, "creation_date": 1562249054, "post_id": 56880239, "comment_id": 100326134, "body": "I provided more info about the initialization of the finger print and the device"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1562210596, "creation_date": 1562210596, "answer_id": 56880239, "question_id": 56878819, "link": "https://stackoverflow.com/questions/56878819/using-fp-identify-finger-from-libfprint-giving-segmentation-fault/56880239#56880239", "title": "using fp_identify_finger from libfprint giving segmentation fault", "body": "<p>Your is either related <code>fpdev</code> and <code>edlg_enroll_data</code> remain <code>NULL</code> pointers unless they are initialized in code you have not shown. Presuming they are initialized, your <code>fp_identify_finger</code> function has a declaration of:</p>\n\n<blockquote>\n<pre><code>int\nfp_identify_finger (struct fp_dev *dev,\n                    struct fp_print_data **print_gallery,\n                    size_t *match_offset);\n</code></pre>\n</blockquote>\n\n<p>The parameters are defined as:</p>\n\n<blockquote>\n<pre><code>dev             the device to perform the scan.\n\nprint_gallery   NULL-terminated array of pointers to the prints to \n                identify against. Each one must have been previously \n                enrolled with a device compatible to the device \n                selected to perform the scan.\n\nmatch_offset    output location to store the array index of the matched \n                gallery print (if any was found). Only valid if \n                FP_VERIFY_MATCH was returned.\n</code></pre>\n</blockquote>\n\n<p>If either <code>dev</code> (your <code>fp_dev</code>) or <code>print_gallery[0]</code> (your <code>gallery[0]</code>) are not properly initialized <em>and</em> validated, that could very easily lead to a SegFault.</p>\n\n<p>Further, Gtk+2 is a C API, meant to be compiled with a C compiler, not C++. You are further encouraged to use <a href=\"https://developer.gnome.org/glib/stable/glib-Memory-Allocation.html#g-malloc\" rel=\"nofollow noreferrer\"><code>g_malloc ()</code></a> or <a href=\"https://developer.gnome.org/glib/stable/glib-Memory-Slices.html#g-slice-new\" rel=\"nofollow noreferrer\"><code>g_slice_new()</code></a> when allocating within Gtk+ programs, as checking the return of the allocation is unnecessary as the program terminates on an allocation failure.</p>\n\n<p>In your case you never even check whether the call to <code>malloc</code> succeeds before making use of the storage (that may not have been allocated at all -- in that case a SegFault is likely as well) There is no need to cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\">Do I cast the result of malloc?</a></p>\n\n<p>Without <a href=\"http://stackoverflow.com/help/mcve\">A Minimal, Complete, and Verifiable Example (MCVE)</a> that is the best ideas I can provide on where the likely source of your SegFault resides. If you are failing to validate the initializations for <code>fpdev</code> and <code>edlg_enroll_data</code>, the same way you failed to validate whether the allocation of the pointers for <code>gallery</code> succeeded, it is very likely you have a failure in one of those areas.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8005288, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202794360057156/picture?type=large", "display_name": "German Eduardo Salazar Aranda", "link": "https://stackoverflow.com/users/8005288/german-eduardo-salazar-aranda"}, "is_accepted": false, "score": 0, "last_activity_date": 1562336347, "creation_date": 1562336347, "answer_id": 56904841, "question_id": 56878819, "link": "https://stackoverflow.com/questions/56878819/using-fp-identify-finger-from-libfprint-giving-segmentation-fault/56904841#56904841", "title": "using fp_identify_finger from libfprint giving segmentation fault", "body": "<p>Ok solved it, I was missing an &amp; when passing the parameter to store the position of the found finger print like this:</p>\n\n<p><code>return fp_identify_finger(fpdev, gallery, &amp;size);</code></p>\n\n<p>and that solved it.</p>\n"}], "owner": {"reputation": 11, "user_id": 8005288, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202794360057156/picture?type=large", "display_name": "German Eduardo Salazar Aranda", "link": "https://stackoverflow.com/users/8005288/german-eduardo-salazar-aranda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562336347, "creation_date": 1562194460, "last_edit_date": 1562249006, "question_id": 56878819, "link": "https://stackoverflow.com/questions/56878819/using-fp-identify-finger-from-libfprint-giving-segmentation-fault", "title": "using fp_identify_finger from libfprint giving segmentation fault", "body": "<p>I'm trying to use this function on my code to perform a search among all my others saved prints in order to know if an employee did check his entrance or exit, but still getting the segmentation fault every time I call this function and the program closes, it ask me to put my finger and once it finished scanning it crashes. I'm doing all this in a gtk+-2.0 C++ program.</p>\n\n<p>And this is the page of the API I'm trying to use <a href=\"https://fprint.freedesktop.org/libfprint-stable/\" rel=\"nofollow noreferrer\">https://fprint.freedesktop.org/libfprint-stable/</a></p>\n\n<p>I've already tried calling this function from C</p>\n\n<p>this is the part of the code where I try to identify the finger print of the edlg_enroll_data after runing an enroll process and the device in fpdev already enabled</p>\n\n<p>this is how I declared my variables</p>\n\n<pre><code>struct fp_dev *fpdev = NULL;\nstatic struct fp_print_data *edlg_enroll_data = NULL;\n</code></pre>\n\n<p>this is how I initialized the device </p>\n\n<pre><code>static gboolean enable_device()\n{\n    struct fp_dscv_dev **discovered_devs;\n    discovered_devs = fp_discover_devs();\n\n    if (!discovered_devs)\n        return FALSE;\n\n    g_assert(discovered_devs);\n\n    if (discovered_devs[0]){\n         fpdev = fp_dev_open(discovered_devs[0]);\n         fp_dscv_devs_free(discovered_devs);\n         return TRUE;\n    }\n    return FALSE;\n} \n</code></pre>\n\n<p>and this is how I initialize the edlg_enroll_data</p>\n\n<pre><code>static void edlg_run_enroll_stage()\n{\n    int r;\n    int passed = 0;\n    struct fp_img *img = NULL;\n    gchar *tmp;\n\n    while (gtk_events_pending())\n        gtk_main_iteration();\n\n    r = fp_enroll_finger_img(fpdev, &amp;edlg_enroll_data, &amp;img);\n    if (r &lt; 0) {\n        return;\n    }\n</code></pre>\n\n<p>the same device and the same fp_print_data are working correctly in other functions</p>\n\n<pre><code>struct fp_print_data **gallery;\ngallery = (fp_print_data**)malloc(sizeof(*gallery) * (2));\ngallery[0]=edlg_enroll_data;\ngallery[1]=NULL;\nsize_t *size = 0;\nreturn fp_identify_finger(fpdev, gallery, size);\nand can't get past that identify function\n</code></pre>\n\n<p>I expected the function to return an Int (1 for example) and saving the position of the finger print that matched in the gallery I provided. The only thing I think it could be is the way I initialize the gallery.</p>\n"}, {"tags": ["c++", "visual-studio", "gdi+"], "comments": [{"owner": {"reputation": 90101, "user_id": 2509, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79ed928ca8b1ab9a637720bf0fb20732?s=128&d=identicon&r=PG&f=1", "display_name": "dmckee --- ex-moderator kitten", "link": "https://stackoverflow.com/users/2509/dmckee-ex-moderator-kitten"}, "edited": false, "score": 0, "creation_date": 1562194331, "post_id": 56878784, "comment_id": 100306106, "body": "These are sometimes called &quot;scoping braces&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11276837, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vYPRu6rZ2QM/AAAAAAAAAAI/AAAAAAAAOhI/rH5ckSn6x94/photo.jpg?sz=128", "display_name": "KAoTI", "link": "https://stackoverflow.com/users/11276837/kaoti"}, "edited": false, "score": 0, "creation_date": 1562194420, "post_id": 56878793, "comment_id": 100306123, "body": "You mean that if i declare some variables in a block inside a void, when the block finish it will get destroyed?"}, {"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "reply_to_user": {"reputation": 37, "user_id": 11276837, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vYPRu6rZ2QM/AAAAAAAAAAI/AAAAAAAAOhI/rH5ckSn6x94/photo.jpg?sz=128", "display_name": "KAoTI", "link": "https://stackoverflow.com/users/11276837/kaoti"}, "edited": false, "score": 0, "creation_date": 1562194450, "post_id": 56878793, "comment_id": 100306127, "body": "@KAoTI Yes, that is. Although I am not sure what you mean by &quot;inside a void&quot;. The function return type has nothing to do with it. You can create nested scopes as much as you want."}, {"owner": {"reputation": 37, "user_id": 11276837, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vYPRu6rZ2QM/AAAAAAAAAAI/AAAAAAAAOhI/rH5ckSn6x94/photo.jpg?sz=128", "display_name": "KAoTI", "link": "https://stackoverflow.com/users/11276837/kaoti"}, "edited": false, "score": 0, "creation_date": 1562194678, "post_id": 56878793, "comment_id": 100306168, "body": "Yeah, sorry by &quot;inside a void&quot;  i refer to a whatever function!"}], "tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": true, "score": 5, "last_activity_date": 1562194205, "creation_date": 1562194205, "answer_id": 56878793, "question_id": 56878784, "link": "https://stackoverflow.com/questions/56878784/why-do-i-need-this-curly-braces-here-can-anybody-explain-me-why-does-this-happe/56878793#56878793", "title": "Why do i need this curly braces here? Can anybody explain me why does this happens?", "body": "<p>You have a variable <code>Gdiplus::Bitmap bitmap</code> declared within the curly braces.  It will be destroyed at the closing <code>}</code>.  Without the curly braces, it won't be destroyed until <em>after</em> <code>GdiplusShutdown</code> is called.</p>\n"}], "owner": {"reputation": 37, "user_id": 11276837, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vYPRu6rZ2QM/AAAAAAAAAAI/AAAAAAAAOhI/rH5ckSn6x94/photo.jpg?sz=128", "display_name": "KAoTI", "link": "https://stackoverflow.com/users/11276837/kaoti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 56878793, "answer_count": 1, "score": 1, "last_activity_date": 1562211600, "creation_date": 1562194078, "last_edit_date": 1562211600, "question_id": 56878784, "link": "https://stackoverflow.com/questions/56878784/why-do-i-need-this-curly-braces-here-can-anybody-explain-me-why-does-this-happe", "title": "Why do i need this curly braces here? Can anybody explain me why does this happens?", "body": "<p>I'm making a code to make a screenshot and save it in a JPEG file type. I found this piece of code but I don't understand why it gives me an error when I remove curly braces after \n<code>GdiplusStartup(&amp;gdiplusToken, &amp;gdiplusStartupInput, NULL);</code>.</p>\n\n<p>Full code: </p>\n\n<pre><code>void gdiscreen()\n{\n    using namespace Gdiplus;\n    GdiplusStartupInput gdiplusStartupInput;\n    ULONG_PTR gdiplusToken;\n    GdiplusStartup(&amp;gdiplusToken, &amp;gdiplusStartupInput, NULL);\n    {\n        HDC scrdc, memdc;\n        HBITMAP membit;\n        scrdc = ::GetDC(0);\n        int Height = GetSystemMetrics(SM_CYSCREEN);\n        int Width = GetSystemMetrics(SM_CXSCREEN);\n        memdc = CreateCompatibleDC(scrdc);\n        membit = CreateCompatibleBitmap(scrdc, Width, Height);\n        HBITMAP hOldBitmap = (HBITMAP)SelectObject(memdc, membit);\n        BitBlt(memdc, 0, 0, Width, Height, scrdc, 0, 0, SRCCOPY);\n        Gdiplus::Bitmap bitmap(membit, NULL);\n        CLSID clsid;\n        GetEncoderClsid(L\"image/jpeg\", &amp;clsid);\n        bitmap.Save(L\"screen.jpeg\", &amp;clsid);\n        SelectObject(memdc, hOldBitmap);\n        DeleteObject(memdc);\n        DeleteObject(membit);\n        ::ReleaseDC(0, scrdc);\n    }\n    GdiplusShutdown(gdiplusToken);\n}\n</code></pre>\n\n<p>Can somebody explain to me why I need the curly braces? </p>\n\n<p>And when I remove the curly braces it gives me the following error: </p>\n\n<pre><code>Exception produced in 0x661AF6B8 (GdiPlus.dll) in DebugScreenShotModule.exe: 0xC0000005: Access violation when reading location 0x029E12AC.\n</code></pre>\n"}, {"tags": ["c++", "c++11", "templates", "boost", "bind"], "comments": [{"owner": {"reputation": 480, "user_id": 3693539, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Jb8O2.jpg?s=128&g=1", "display_name": "solarflare", "link": "https://stackoverflow.com/users/3693539/solarflare"}, "edited": false, "score": 0, "creation_date": 1562193647, "post_id": 56878617, "comment_id": 100305958, "body": "I&#39;m not an expert at boost bind (only used it a few times) but why is your template a reference? (in boost::bind(&amp;ValidOperation::CheckDoubleBound&lt;T&gt; )"}, {"owner": {"reputation": 57, "user_id": 5229038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6298cfcaf7b85dd8b9200151ebbfe61?s=128&d=identicon&r=PG&f=1", "display_name": "arunabh sharma", "link": "https://stackoverflow.com/users/5229038/arunabh-sharma"}, "reply_to_user": {"reputation": 480, "user_id": 3693539, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Jb8O2.jpg?s=128&g=1", "display_name": "solarflare", "link": "https://stackoverflow.com/users/3693539/solarflare"}, "edited": false, "score": 0, "creation_date": 1562195772, "post_id": 56878617, "comment_id": 100306398, "body": "<a href=\"https://www.boost.org/doc/libs/1_52_0/libs/phoenix/doc/html/phoenix/modules/bind/binding_member_functions.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_52_0/libs/phoenix/doc/html/phoenix/modu&zwnj;&#8203;les/&hellip;</a>"}, {"owner": {"reputation": 467, "user_id": 9216696, "user_type": "registered", "profile_image": "https://graph.facebook.com/1983536371871178/picture?type=large", "display_name": "Alex Hodges", "link": "https://stackoverflow.com/users/9216696/alex-hodges"}, "edited": false, "score": 0, "creation_date": 1562197132, "post_id": 56878617, "comment_id": 100306667, "body": "Are these variables: <code>boost::cref(variable_instance), upper_bound_value, lower_bound_value</code> all the same type?"}, {"owner": {"reputation": 57, "user_id": 5229038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6298cfcaf7b85dd8b9200151ebbfe61?s=128&d=identicon&r=PG&f=1", "display_name": "arunabh sharma", "link": "https://stackoverflow.com/users/5229038/arunabh-sharma"}, "edited": false, "score": 0, "creation_date": 1562203615, "post_id": 56878617, "comment_id": 100307653, "body": "Yes, the three variables are of the same type."}, {"owner": {"reputation": 57, "user_id": 5229038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6298cfcaf7b85dd8b9200151ebbfe61?s=128&d=identicon&r=PG&f=1", "display_name": "arunabh sharma", "link": "https://stackoverflow.com/users/5229038/arunabh-sharma"}, "edited": false, "score": 0, "creation_date": 1562203703, "post_id": 56878617, "comment_id": 100307665, "body": "I&#39;m not invoking the function here just creating it for later invocation."}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 5229038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6298cfcaf7b85dd8b9200151ebbfe61?s=128&d=identicon&r=PG&f=1", "display_name": "arunabh sharma", "link": "https://stackoverflow.com/users/5229038/arunabh-sharma"}, "is_accepted": true, "score": 1, "last_activity_date": 1562341415, "creation_date": 1562341415, "answer_id": 56906015, "question_id": 56878617, "link": "https://stackoverflow.com/questions/56878617/template-argument-deduction-substitution-failed-when-boostbinding-a-templated/56906015#56906015", "title": "template argument deduction/substitution failed, when boost::binding a templated function", "body": "<p>Someone pointed me to the answer, it's that boost::bind can take 9 arguments at max and I have ten including the class pointer.</p>\n\n<p><a href=\"https://www.boost.org/doc/libs/1_66_0/libs/bind/doc/html/bind.html#bind.implementation.number_of_arguments\" rel=\"nofollow noreferrer\">https://www.boost.org/doc/libs/1_66_0/libs/bind/doc/html/bind.html#bind.implementation.number_of_arguments</a></p>\n"}], "owner": {"reputation": 57, "user_id": 5229038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6298cfcaf7b85dd8b9200151ebbfe61?s=128&d=identicon&r=PG&f=1", "display_name": "arunabh sharma", "link": "https://stackoverflow.com/users/5229038/arunabh-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "accepted_answer_id": 56906015, "answer_count": 1, "score": 0, "last_activity_date": 1562341415, "creation_date": 1562192620, "last_edit_date": 1562212069, "question_id": 56878617, "link": "https://stackoverflow.com/questions/56878617/template-argument-deduction-substitution-failed-when-boostbinding-a-templated", "title": "template argument deduction/substitution failed, when boost::binding a templated function", "body": "<p>I'm trying to boost bind a particular function for use later, the following code is what throws a compile error the first function is the one I'm trying to bind to generate a boost function, the second statement is the actual bind statement, the third statement is the function inside which this bind statement is written and finally there are the errors:</p>\n\n<pre><code>template &lt;typename T&gt;\nvoid ValidOperation::CheckDoubleBound(\n    diagnostic_updater::DiagnosticStatusWrapper&amp; stat,\n    const std::string&amp; name,\n    const T&amp; variable_instance,\n    T upper_bound_value,\n    T lower_bound_value,\n    const SeverityLevel severity,\n    const std::string&amp; message_success,\n    const std::string&amp; message_lower_fail,\n    const std::string&amp; message_upper_fail)\n</code></pre>\n\n<p>and the bind looks like this</p>\n\n<pre><code>    auto func = boost::bind(&amp;ValidOperation::CheckDoubleBound&lt;T&gt;,\n                            this,\n                            _1,\n                            name,\n                            boost::cref(variable_instance),\n                            upper_bound_value,\n                            lower_bound_value,\n                            severity,\n                            message_success,\n                            message_upper_fail,\n                            message_lower_fail);\n</code></pre>\n\n<p>inside this function</p>\n\n<pre><code>template &lt;typename T&gt;\nvoid ValidOperation::AddDoubleBoundConstraint(\n    const std::string&amp; name,\n    const T&amp; variable_instance,\n    const T upper_bound_value,\n    const T lower_bound_value,\n    const SeverityLevel severity,\n    const std::string&amp; message_success,\n    const std::string&amp; message_lower_fail,\n    const std::string&amp; message_upper_fail)\n</code></pre>\n\n<pre><code>In instantiation of \u2018void triton::ValidOperation::AddDoubleBoundConstraint(const string&amp;, const T&amp;, T, T, triton::SeverityLevel, const string&amp;, const string&amp;, const string&amp;) [with T = double; std::__cxx11::string = std::__cxx11::basic_string&lt;char&gt;]\u2019:\n/home/test/src/ValidOperation.cpp:188:42:   required from here\n/home/test/src/ValidOperation.cpp:150:28: error: no matching function for call to \u2018bind(&lt;unresolved overloaded function type&gt;, triton::ValidOperation*, const boost::arg&lt;1&gt;&amp;, const string&amp;, const boost::reference_wrapper&lt;const double&gt;, const double&amp;, const double&amp;, const triton::SeverityLevel&amp;, const string&amp;, const string&amp;, const string&amp;)\u2019\n     auto func = boost::bind(&amp;ValidOperation::CheckDoubleBound&lt;T&gt;,\n                 ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n                             this,\n                             ~~~~~\n                             _1,\n                             ~~~\n                             name,\n                             ~~~~~\n                             boost::cref(variable_instance),\n                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n                             upper_bound_value,\n                             ~~~~~~~~~~~~~~~~~~\n                             lower_bound_value,\n                             ~~~~~~~~~~~~~~~~~~\n                             severity,\n                             ~~~~~~~~~\n                             message_success,\n                             ~~~~~~~~~~~~~~~~\n                             message_upper_fail,\n                             ~~~~~~~~~~~~~~~~~~~\n                             message_lower_fail);\n                             ~~~~~~~~~~~~~~~~~~~\nIn file included from /usr/include/boost/bind.hpp:22:0,\n                 from /opt/ros/melodic/include/ros/publisher.h:35,\n                 from /opt/ros/melodic/include/ros/node_handle.h:32,\n                 from /opt/ros/melodic/include/diagnostic_updater/diagnostic_updater.h:42,\n                 from /home/test/include/triton/ValidOperation.h:23,\n                 from /home/test/src/ValidOperation.cpp:17:\n/usr/include/boost/bind/bind.hpp:1875:5: note: candidate: template&lt;class R, class F&gt; boost::_bi::bind_t&lt;R, F, boost::_bi::list0&gt; boost::bind(F)\n     BOOST_BIND(F f)\n     ^\n/usr/include/boost/bind/bind.hpp:1875:5: note:   template argument deduction/substitution failed:\n/home/src/ValidOperation.cpp:150:28: note:   candidate expects 1 argument, 11 provided\n     auto func = boost::bind(&amp;ValidOperation::CheckDoubleBound&lt;T&gt;,\n                 ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n                             this,\n                             ~~~~~\n                             _1,\n                             ~~~\n                             name,\n                             ~~~~~\n                             boost::cref(variable_instance),\n                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n                             upper_bound_value,\n                             ~~~~~~~~~~~~~~~~~~\n                             lower_bound_value,\n                             ~~~~~~~~~~~~~~~~~~\n                             severity,\n                             ~~~~~~~~~\n                             message_success,\n                             ~~~~~~~~~~~~~~~~\n                             message_upper_fail,\n                             ~~~~~~~~~~~~~~~~~~~\n                             message_lower_fail);\n</code></pre>\n\n<p>I'm using C++14 and gcc 7.4.0.</p>\n\n<p>Edit:\nThis worked</p>\n\n<pre><code>auto func = [this,\n                 name,\n                 variable_instance,\n                 upper_bound_value,\n                 lower_bound_value,\n                 severity,\n                 message_success,\n                 message_lower_fail,\n                 message_upper_fail](\n                    diagnostic_updater::DiagnosticStatusWrapper&amp; stat) {\n        this-&gt;CheckDoubleBound&lt;T&gt;(stat,\n                                  name,\n                                  variable_instance,\n                                  upper_bound_value,\n                                  lower_bound_value,\n                                  severity,\n                                  message_success,\n                                  message_lower_fail,\n                                  message_upper_fail);\n    };\n</code></pre>\n\n<p>If someone could explain why this works and not the former? Thanks!</p>\n"}, {"tags": ["c++", "r", "dependencies", "rcpp"], "comments": [{"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 1, "creation_date": 1562232954, "post_id": 56878616, "comment_id": 100317207, "body": "Is this a followup question to <a href=\"https://stackoverflow.com/a/54168141/8416610\">my previous answer</a>? In that case it might make sense if you tell us what you are trying to achieve. The question about <code>paste</code> is basic R, while the second question is quite vague."}, {"owner": {"reputation": 1393, "user_id": 1267833, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9fe1935d074ce793c65971b3ef42b09f?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/1267833/taylor"}, "reply_to_user": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1562247648, "post_id": 56878616, "comment_id": 100325401, "body": "@RalfStubner It is indeed! (thank you for your help). My ultimate goal is to help c++-averse statisticians use a <a href=\"https://github.com/tbrown122387/pf\" rel=\"nofollow noreferrer\">c++ library I wrote</a>. I get paste, it was the <a href=\"https://stackoverflow.com/questions/6562403/i-dont-understand-wl-rpath-wl\">commas</a> that was throwing me."}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1562250287, "post_id": 56878616, "comment_id": 100326760, "body": "Ok. Now I understand which commas you mean. I have not looked closely at your library, but would it be necessary for the user to write C++ code or can all the functionality of the library exposed as R functions? In the latter case you would not need a Rcpp plugin. Just include the library in the R package and use Rcpp to interface between R and the library."}, {"owner": {"reputation": 1393, "user_id": 1267833, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9fe1935d074ce793c65971b3ef42b09f?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/1267833/taylor"}, "reply_to_user": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1562252908, "post_id": 56878616, "comment_id": 100328099, "body": "@RalfStubner unfortunately they would need to write a c++ header for every model/filter pair (something like <a href=\"https://github.com/tbrown122387/pf/blob/master/examples/svol_bs.h\" rel=\"nofollow noreferrer\">this</a>  Compilation needs to be re-done every time you change the model or inherit from a different filter."}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1562253659, "post_id": 56878616, "comment_id": 100328453, "body": "Can you make the library header-only like RcppEigen or RcppAramdillo? That would simplify things a lot."}], "answers": [{"tags": [], "owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "is_accepted": true, "score": 2, "last_activity_date": 1562199383, "creation_date": 1562199383, "answer_id": 56879291, "question_id": 56878616, "link": "https://stackoverflow.com/questions/56878616/understanding-rcpp-plugins/56879291#56879291", "title": "Understanding Rcpp plugins", "body": "<p>The <code>paste()</code> is a vanilla use of base R's <code>paste()</code> -- it creates a <em>single</em> string containing <em>all</em> the link instructions being passed to <code>libs</code>.</p>\n\n<p>For <code>include.before</code> we do not need that as only one header is passed. </p>\n\n<p>I would recommend you study the code <em>along with its use</em> as well as the <em>actual plugin for RcppGSL</em> which is defined <a href=\"https://github.com/eddelbuettel/rcppgsl/blob/b444404a0fa564bcb8b9472ea7aab7c493b346dc/R/inline.R#L47-59\" rel=\"nofollow noreferrer\">here</a> and see how they are used in packages such as <em>e.g.</em> <code>RcppZiggurat</code>.  And by used I mean see what the instructions expand to when the client packages compiles and links.  </p>\n\n<p>It looks crazy complicated but hey it has worked for about a decade already :)</p>\n"}], "owner": {"reputation": 1393, "user_id": 1267833, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9fe1935d074ce793c65971b3ef42b09f?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/1267833/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 56879291, "answer_count": 1, "score": 0, "last_activity_date": 1562199383, "creation_date": 1562192618, "question_id": 56878616, "link": "https://stackoverflow.com/questions/56878616/understanding-rcpp-plugins", "title": "Understanding Rcpp plugins", "body": "<p>I'm looking over the demo provided in <a href=\"http://dirk.eddelbuettel.com/code/rcpp/Rcpp-FAQ.pdf\" rel=\"nofollow noreferrer\">3.6 of the Rcpp-FAQ</a>, and I'm trying to understanding how this plugin is being created. The standalone example provided is</p>\n\n<pre><code>gslrng &lt;-\n'int seed = Rcpp::as&lt;int&gt;(par) ;\ngsl_rng_env_setup();\ngsl_rng *r = gsl_rng_alloc (gsl_rng_default);\ngsl_rng_set (r, (unsigned long) seed);\ndouble v = gsl_rng_get (r);\ngsl_rng_free(r);return Rcpp::wrap(v);'\n\nplug &lt;- Rcpp:::Rcpp.plugin.maker(\n  include.before = \"#include &lt;gsl/gsl_rng.h&gt;\",\n  libs = paste(\"-L/usr/local/lib/R/site-library/Rcpp/lib -lRcpp\",\n               \"-Wl,-rpath,/usr/local/lib/R/site-library/Rcpp/lib\",\n               \"-L/usr/lib -lgsl -lgslcblas -lm\"))\nregisterPlugin(\"gslDemo\", plug )\nfun &lt;- cxxfunction(signature(par=\"numeric\"), gslrng, plugin=\"gslDemo\")\nfun(0)\n</code></pre>\n\n<p>Specifically, why is that call to <code>paste()</code> being comma-separated like that? Should <strong>all</strong> dependencies (header file directories, linker directories, and name of library files) be handled via plugins? </p>\n"}, {"tags": ["c++", "struct", "language-lawyer", "strict-aliasing"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1562199910, "post_id": 56878519, "comment_id": 100307091, "body": "The first bullet point never made much sense anyway (in either language) so I&#39;m glad to see it gone!"}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1562200390, "post_id": 56878519, "comment_id": 100307160, "body": "@M.M could you explain the &quot;in either language&quot; claim?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1562200555, "post_id": 56878519, "comment_id": 100307187, "body": "@LanguageLawyer in C or C++"}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1562200589, "post_id": 56878519, "comment_id": 100307195, "body": "@M.M I mean why it does not make sense in C"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 2, "creation_date": 1562201071, "post_id": 56878519, "comment_id": 100307271, "body": "@LanguageLawyer say you have <code>struct S { int a; float b; };</code> and <code>float *c = malloc(100);</code> and int and float are the same size and no padding; then <code>c[0] = c[1] = 0; S s = *(S *)c;</code> is not an aliasing violation according to that text, because the <code>float</code> <code>c[0]</code> is accessed by an aggregate type that has a <code>float</code> as its member  (never mind the fact that the offset of the member doesn&#39;t correspond to the memory being accessed)"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1562627258, "post_id": 56878519, "comment_id": 100426959, "body": "@M.M: If one assumes that a compiler that can see that an lvalue is derived from another will treat an access to the former (for purposes of N1570 6.5p7) as though made using the latter, then an access <code>myUnion.member1</code> would <i>be</i> an access to <code>myUnion</code>, which would be a struct union which contains <code>myUnion.member2</code>, and thus such an access would be allowed to modify the stored value of the latter."}], "answers": [{"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1562193597, "post_id": 56878686, "comment_id": 100305947, "body": "What would the rule say in circumstances where storage received from <code>malloc</code> is written using one PODS and read with another that has the same layout?"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 3, "creation_date": 1562194047, "post_id": 56878686, "comment_id": 100306049, "body": "I agree with this answer, but I think an unwritten assumption in the question is that <code>A.B</code> &quot;accesses&quot; <code>A</code> (and so <code>P-&gt;B</code> &quot;accesses&quot; <code>*P</code>). I don&#39;t see anything in the Standard that clearly states that&#39;s not so, but the fact that <code>A.B</code> on its own does not imply modification or lvalue-to-rvalue of anything supports it."}, {"owner": {"reputation": 3183, "user_id": 3025453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecaade2979d70e6fa61d1f8bca6f27e1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Karcher", "link": "https://stackoverflow.com/users/3025453/michael-karcher"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1562194766, "post_id": 56878686, "comment_id": 100306187, "body": "@supercat This rule still is OK with it. If the two types are layout-compatible, the individual members are layout-compatible. If they are layout-compatible, accessing members from one POD type through a pointer to a different POD type is covered by an earlier bullet in the &quot;aliasing clause&quot;."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1562200196, "post_id": 56878686, "comment_id": 100307136, "body": "@MichaelKarcher: From what I can tell, neither gcc nor clang supports such usage.  What&#39;s needed to make the C rule work is recognition that an access via pointer which is visibly derived from an lvalue should be considered as an access to that lvalue, but gcc doesn&#39;t support that usage either."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1578293369, "post_id": 56878686, "comment_id": 105379121, "body": "What if <code>Foo</code> is <code>struct Foo { char c; float x; };</code>? Can&#39;t we say that in <code>float z = reinterpret_cast&lt;Foo*&gt;(&amp;y)-&gt;x;</code> we access <code>y</code>  through an lvalue of type <code>float</code> and so this is fine, too?"}, {"owner": {"reputation": 3183, "user_id": 3025453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecaade2979d70e6fa61d1f8bca6f27e1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Karcher", "link": "https://stackoverflow.com/users/3025453/michael-karcher"}, "edited": false, "score": 0, "creation_date": 1578294959, "post_id": 56878686, "comment_id": 105379660, "body": "No, it&#39;s not fine. There is no float object at <code>reinterpret_cast&lt;Foo*&gt;(&amp;y)-&gt;x</code>, so this access is undefined behaviour. But it&#39;s not the rule discussed in this question that forbids it."}], "tags": [], "owner": {"reputation": 3183, "user_id": 3025453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecaade2979d70e6fa61d1f8bca6f27e1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Karcher", "link": "https://stackoverflow.com/users/3025453/michael-karcher"}, "is_accepted": true, "score": 5, "last_activity_date": 1562193178, "creation_date": 1562193178, "answer_id": 56878686, "question_id": 56878519, "link": "https://stackoverflow.com/questions/56878519/what-happened-to-the-aggregate-or-union-type-that-includes-one-of-the-aforement/56878686#56878686", "title": "What happened to the &quot;aggregate or union type that includes one of the aforementioned types&quot; strict aliasing rule?", "body": "<p>The lvalue you use to access the stored value of <code>y</code> is not <code>*reinterpret_cast&lt;Foo*&gt;(&amp;y)</code>, of type <code>Foo</code>, but it is <code>reinterpret_cast&lt;Foo*&gt;(&amp;y)-&gt;x</code>, which has the type <code>float</code>. Accessing a <code>float</code> using an lvalue of type <code>float</code> is fine. In C++, you can not \"access the value of a union or struct\" (as whole), you can only access individual members. The rationale you quoted points to a difference between C and C++:</p>\n\n<pre><code>  struct X { int a, b; };\n  struct X v1 = {1, 2}, v2;\n  v2 = v1;\n</code></pre>\n\n<p>In C, the standard says that the assignment loads the value of <code>v1</code> (as whole) to assign it to <code>v2</code>. Here the values of the objects <code>v1.a</code> and <code>v2.b</code> (both have types <code>int</code>) are accessed using an lvalue of type <code>struct X</code> (which is <em>not</em> <code>int</code>).</p>\n\n<p>In C++, the standard says that the assignment calls the compiler generated assignment operator which is equivalent to</p>\n\n<pre><code>struct X {\n   ...\n   struct X&amp; operator=(const struct X&amp;other)\n   {\n       a = other.a;\n       b = other.b;\n   }\n};\n</code></pre>\n\n<p>In this case, <em>calling</em> the assignment operator does not access any value, because the RHS is passed by reference. And executing the assignment operator accesses the two <code>int</code> fields separately (which is fine, even without the aggregate rule), so this is again not accessing a value through an lvalue of type <code>struct X</code>.</p>\n"}], "owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 2, "accepted_answer_id": 56878686, "answer_count": 1, "score": 3, "last_activity_date": 1562430827, "creation_date": 1562191938, "last_edit_date": 1562430827, "question_id": 56878519, "link": "https://stackoverflow.com/questions/56878519/what-happened-to-the-aggregate-or-union-type-that-includes-one-of-the-aforement", "title": "What happened to the &quot;aggregate or union type that includes one of the aforementioned types&quot; strict aliasing rule?", "body": "<p>Previously, in basic.lval, there was this bullet point:</p>\n\n<blockquote>\n  <p>an aggregate or union type that includes one of the aforementioned types among its elements or non-static data members (including, recursively, an element or non-static data member of a subaggregate or contained union),</p>\n</blockquote>\n\n<p>In the current <a href=\"http://eel.is/c++draft/basic.lval#11\" rel=\"nofollow noreferrer\">draft</a>, it is gone.</p>\n\n<p>There is some background information at WG21's site: <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1359r0.html#2051\" rel=\"nofollow noreferrer\">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1359r0.html#2051</a>:</p>\n\n<blockquote>\n  <p>The aliasing rules of 7.2.1 [basic.lval] paragraph 10 were adapted from C with additions for C++. However, a number of the points either do not apply or are subsumed by other points. For example, the provision for aggregate and union types is needed in C for struct assignment, which in C++ is done via constructors and assignment operators in C++, not by accessing the complete object.</p>\n</blockquote>\n\n<p>Can anyone explain to me, what this means? What has this strict aliasing rule to do with struct assignment in C?</p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/language/reinterpret_cast\" rel=\"nofollow noreferrer\">cppreference</a> says about this rule:</p>\n\n<blockquote>\n  <p>These bullets describe situations that cannot arise in C++</p>\n</blockquote>\n\n<p>I don't understand, why it is true. For example,</p>\n\n<pre><code>struct Foo {\n    float x;\n};\n\nfloat y;\nfloat z = reinterpret_cast&lt;Foo*&gt;(&amp;y)-&gt;x;\n</code></pre>\n\n<p>The last line seems to do what the bullet point describes. It accesses <code>y</code> (a <code>float</code>) through an aggregate, which includes a <code>float</code> (member <code>x</code>).</p>\n\n<p>Can anyone shed some light on this?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1562192110, "post_id": 56878508, "comment_id": 100305630, "body": "Q: Are you getting an error message, and/or stack traceback?  Q: Does the error say &quot;Stack overflow&quot; (or similar)? Q: &quot;While there are few non-recursive approaches suggesting that recursive approaches hit stack overflow problem, I want to know if that&#39;s the case is there any way to solve it&quot;?  A: Have you considered trying one of those few non-recursive approaches?  Or checking for a compiler switch to increase stack size?  -1 for not including exact error message, or specifying compiler/compiler version."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1562192357, "post_id": 56878508, "comment_id": 100305684, "body": "PS: If you&#39;re using GCC, you can use something like <code>gcc -Wl,--stack,4194304 -o program program.c</code>.  Look here: <a href=\"https://stackoverflow.com/questions/2275550/\">stackoverflow.com/questions/2275550</a>"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 1, "creation_date": 1562193569, "post_id": 56878508, "comment_id": 100305936, "body": "While you can rewrite <code>DFSUtil</code> to reduce the stack pressure a bit (at the very least <code>visited</code> and <code>count</code> can be combined into one parameter by using a struct), or provide compiler or linker options to increase the stack size, eventually you&#39;ll find situations where you run out of stack space.  Rewriting to use looping, instead of recursion, should be way more scalable."}, {"owner": {"reputation": 4400, "user_id": 681444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf4662e1bc928723d74099d0b51df24?s=128&d=identicon&r=PG&f=1", "display_name": "racraman", "link": "https://stackoverflow.com/users/681444/racraman"}, "edited": false, "score": 0, "creation_date": 1562193861, "post_id": 56878508, "comment_id": 100306009, "body": "Probably not an issue, but also worth validating in addEdge that values are in range 0..(V-1)"}, {"owner": {"reputation": 351, "user_id": 7698766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F289S.jpg?s=128&g=1", "display_name": "Shubham Yadav", "link": "https://stackoverflow.com/users/7698766/shubham-yadav"}, "reply_to_user": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1562219477, "post_id": 56878508, "comment_id": 100310655, "body": "@paulsm4. Answer to your question: There are no messages before termination, it just terminates in-between the execution. I&#39;m unaware of the exact problem being caused in the program, and therefore put a question here to get some suggestions about what&#39;s going wrong. Have also included a screenshot of the output screen. As said, while searching for possible solutions I came across some non-recursive approaches, but I wanted to know what&#39;s going on wrong in this program so didn&#39;t try those approaches. Please do consider removing the -1."}, {"owner": {"reputation": 351, "user_id": 7698766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F289S.jpg?s=128&g=1", "display_name": "Shubham Yadav", "link": "https://stackoverflow.com/users/7698766/shubham-yadav"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1562219663, "post_id": 56878508, "comment_id": 100310719, "body": "@1201ProgramAlarm so you too suggest that for such programs, non-recursive approaches are better ?"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 2, "creation_date": 1562252210, "post_id": 56878508, "comment_id": 100327742, "body": "If the recursion depth is too large, you&#39;ll need to change to non-recursive approaches.  Space available for the stack is usually much less than heap space, so avoiding recursion can allow for a much larger problem space.  I try to avoid it whenever possible."}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1562256610, "post_id": 56878508, "comment_id": 100329696, "body": "Your programme stops after which time? I tried to execute it on my PC, it has been running for 35mn now, not finished"}, {"owner": {"reputation": 351, "user_id": 7698766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F289S.jpg?s=128&g=1", "display_name": "Shubham Yadav", "link": "https://stackoverflow.com/users/7698766/shubham-yadav"}, "reply_to_user": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1562261515, "post_id": 56878508, "comment_id": 100331242, "body": "@Damien in my PC it hardly runs for 10secs and terminates"}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1562261773, "post_id": 56878508, "comment_id": 100331306, "body": "The programme finally terminated here after a rather long time. Large amount of data was printed. Cannot know if the result is correct of course. I did not modify your code"}, {"owner": {"reputation": 351, "user_id": 7698766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F289S.jpg?s=128&g=1", "display_name": "Shubham Yadav", "link": "https://stackoverflow.com/users/7698766/shubham-yadav"}, "reply_to_user": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1562261854, "post_id": 56878508, "comment_id": 100331333, "body": "@Damien how did it even run on your machine ? is there an option to increase the stack size while compiling ?"}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1562262181, "post_id": 56878508, "comment_id": 100331420, "body": "I did not use any specific option, except -03 and -std=c++17. I use gcc 6.3.0. In a comment above, paulsm4 mentioned some options that you may try but that I did not use"}, {"owner": {"reputation": 351, "user_id": 7698766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F289S.jpg?s=128&g=1", "display_name": "Shubham Yadav", "link": "https://stackoverflow.com/users/7698766/shubham-yadav"}, "reply_to_user": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1562263104, "post_id": 56878508, "comment_id": 100331702, "body": "@Damien yeah it ran after changing the stack size to 16MiB, the large data that was printed was actually for debugging which I created for small graph. Thanks for taking out the time to run it for so long. I have changed the code so it doesn&#39;t print that again. Any suggestions to improve the running time ?"}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "reply_to_user": {"reputation": 351, "user_id": 7698766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F289S.jpg?s=128&g=1", "display_name": "Shubham Yadav", "link": "https://stackoverflow.com/users/7698766/shubham-yadav"}, "edited": false, "score": 0, "creation_date": 1562263554, "post_id": 56878508, "comment_id": 100331830, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/196010/discussion-between-damien-and-shubham-yadav\">continue this discussion in chat</a>."}], "owner": {"reputation": 351, "user_id": 7698766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F289S.jpg?s=128&g=1", "display_name": "Shubham Yadav", "link": "https://stackoverflow.com/users/7698766/shubham-yadav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562263220, "creation_date": 1562191828, "last_edit_date": 1562263220, "question_id": 56878508, "link": "https://stackoverflow.com/questions/56878508/kosarajus-scc-recursive-program-terminates-automatically-while-executing-on-lar", "title": "Kosaraju&#39;s SCC recursive program terminates automatically while executing on large inputs", "body": "<p>I am trying to implement <strong>Kosaraju's Strongly connected components algorithm</strong>  using <strong>recursive approach in C++</strong>. While the <strong>program runs fine on small graphs</strong> but terminates in-between execution while running node-ranking step of the algorithm on large graphs having <strong>875714 nodes</strong>.</p>\n\n<p><strong>The function that causes the problem is : Graph::fillOrder(int v, bool visited[], stack &amp;Stack)</strong></p>\n\n<p>File link : File link: <a href=\"https://drive.google.com/file/d/1aL19d6FCTT9vW70jBGyH-r7MpOOQ7gyz/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/1aL19d6FCTT9vW70jBGyH-r7MpOOQ7gyz/view?usp=sharing</a></p>\n\n<p>I went through the net to search for a possible solution to it but couldn't find one. While there are few non-recursive approaches suggesting that recursive approaches hit stack overflow problem, I want to know if that's the case is there any way to solve it ?</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;list&gt;\n#include&lt;stack&gt;\n#include&lt;fstream&gt;\n\nusing namespace std;\n\nclass Graph{\n    int V;\n    list&lt;int&gt; *adj;\n\n    void fillOrder(int v, bool visited[], stack&lt;int&gt; &amp;stack);\n    void DFSUtil(int v, bool visited[], int &amp;count);\n\npublic:\n    Graph(int V);\n    void addEdge(int v, int w);\n    void printSCCs();\n    Graph getTranspose();\n};\n\nGraph::Graph(int V){\n    this-&gt;V = V;\n    adj = new list&lt;int&gt;[V];\n}\n\nvoid Graph::DFSUtil(int v, bool visited[], int &amp;count){\n    visited[v] = true;\n    count++;\n    list&lt;int&gt;::iterator it;\n    for(it = adj[v].begin(); it!=adj[v].end(); it++){\n        if(!visited[*it])\n            DFSUtil(*it, visited, count);\n    }\n}\n\nGraph Graph::getTranspose(){\n    Graph g(V);\n    for(int v=0; v&lt;V; v++){\n        list&lt;int&gt;::iterator it;\n        for(it=adj[v].begin(); it!=adj[v].end(); it++){\n            g.adj[*it].push_back(v);\n        }\n    }\n    return g;\n}\n\n//add edge to graph\nvoid Graph::addEdge(int v, int w){\n    adj[v].push_back(w);\n}\n\n//node ranking function\nvoid Graph::fillOrder(int v, bool visited[], stack&lt;int&gt; &amp;Stack){\n    visited[v] = true;\n\n    list&lt;int&gt; :: iterator it;\n    for(it=adj[v].begin(); it!=adj[v].end(); it++){\n        if(!visited[*it])\n            fillOrder(*it, visited, Stack);\n    }\n\n    Stack.push(v);\n}\n\n//print SCCs\nvoid Graph::printSCCs(){\n    stack&lt;int&gt; Stack;\n\n    //keeping track of nodes visited\n    bool *visited = new bool[V];\n    for(int i=0; i&lt;V; i++){\n        visited[i]=false;\n    }\n\n    //node ranking\n    for(int i=0; i&lt;V; i++){\n        cout&lt;&lt;i&lt;&lt;\" \";\n        if(visited[i]==false){\n            fillOrder(i, visited, Stack);\n        }\n    }\n\n    //computing transpose of the graph\n    Graph gr = getTranspose();\n\n    //reseting visited values for every node to false\n    for(int i=0; i&lt;V; i++){\n        visited[i]=false;\n    }\n    int max_count=0;\n    while(Stack.empty()==false){\n        int v = Stack.top();\n        Stack.pop();\n\n        if(visited[v]==false){\n            int count=0;\n            gr.DFSUtil(v, visited, count);\n            if(count&gt;max_count){\n                max_count = count;\n                cout&lt;&lt;\"\\nMax count: \"&lt;&lt;max_count;\n            }\n        }\n    }\n}\n\nint main() \n{       \n    Graph g(875714);\n\n    ifstream file;\n    file.open(\"SCC.txt\");\n    int s, e;\n    while(file&gt;&gt;s&gt;&gt;e){\n        //eleminating self loops\n        if(s==e)\n            continue;\n        else\n            g.addEdge((s-1), (e-1)); //for files containing nodes from 1\n    }\n    cout &lt;&lt; \"Following are strongly connected components in \"\n            \"given graph \\n\"; \n    g.printSCCs();\n\n    return 0; \n} \n</code></pre>\n\n<p>Expected result: print size of each strongly connected component in the graph</p>\n\n<p>Actual result: Termination while execution without completing the entire program</p>\n\n<p><a href=\"https://i.stack.imgur.com/F7FuH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F7FuH.png\" alt=\"No error message before termination\"></a></p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1562191741, "post_id": 56878494, "comment_id": 100305574, "body": "Sorry for the word jumble of the title; not entirely sure of all the terminology being used here so I did my best."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1562192025, "post_id": 56878494, "comment_id": 100305619, "body": "Are you looking for <code>template &lt;auto MemberPointer, std::size_t Len&gt;</code>? (This requires C++17.)"}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1562192288, "post_id": 56878494, "comment_id": 100305672, "body": "@HolyBlackCat Hello again :) I was trying to avoid it, but if that&#39;s the only way then I can accept that. However, I&#39;d still like to enforce that the map type has a <code>std::string</code> key. Is that done via specialization?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1562192557, "post_id": 56878494, "comment_id": 100305712, "body": "Yup, you can either specialize the template, or use a <code>static_assert</code> (if you figure out how to write the condition properly)."}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1562192607, "post_id": 56878494, "comment_id": 100305724, "body": "Alright, fair enough. Can you post an answer so I can give you those sweet, sweet fake internet points?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1562192793, "post_id": 56878494, "comment_id": 100305760, "body": "I&#39;m too sleepy to write one, so I&#39;ll leave this to you. :P"}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1562193131, "post_id": 56878494, "comment_id": 100305835, "body": "@HolyBlackCat Actually, can&#39;t figure out the specialization either. I feel useless this evening lol. Edited the question with what I tried, but it won&#39;t compile."}], "answers": [{"tags": [], "owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "is_accepted": false, "score": 0, "last_activity_date": 1562194626, "last_edit_date": 1562194626, "creation_date": 1562193538, "answer_id": 56878734, "question_id": 56878494, "link": "https://stackoverflow.com/questions/56878494/can-templated-field-reference-template-parameters-be-passed-as-the-first-templat/56878734#56878734", "title": "Can templated field reference template parameters be passed as the first template parameter?", "body": "\n\n<p>For a pre-C++17 solution you can put the member pointer into an <code>std::integral_constant</code>. To make sure the key type of your map is a <code>std::string</code>, use type deduction to get the member type from the pointer and compare its key type with <code>std::string</code>:</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>template&lt;class T, class C&gt;\nT get_member_type(T C::*);\n\ntemplate&lt;class Base&gt;\nstruct foo{\n  template&lt;class I, std::size_t Len&gt;\n  constexpr const foo&lt;Base&gt; s(I, char const (&amp;section_name)[Len]) const {\n    using M=decltype(get_member_type(I::value));\n    static_assert(std::is_same&lt;typename M::key_type, std::string&gt;{});\n    return *this;\n  }\n};\n\n#define CONST(e) std::integral_constant&lt;decltype(e), e&gt;\n\nstruct my_struct {\n  std::map&lt;std::string, int&gt; section;\n  constexpr static auto bar = foo&lt;my_struct&gt;().s(CONST(&amp;my_struct::section){}, \"hi\");\n};\n</code></pre>\n\n<p>The error you get in your edit is due to the fact that you cannot partially specialize function templates. Fortunately you can extend the code in my answer above so that you can overload based on the key type with tag dispatching:</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>template&lt;class Base&gt;\nstruct foo{\n  template&lt;class M&gt;\n  using get_key_type = typename M::key_type;\n  template&lt;class I&gt;\n  using get_member_type = decltype(::get_member_type(I::value));\n\n  template&lt;class I, std::size_t Len&gt;\n  constexpr auto s(I, char const (&amp;section_name)[Len]) const {\n    return s(I{}, section_name, \n      std::is_same&lt;get_key_type&lt;get_member_type&lt;I&gt;&gt;, std::string&gt;{}\n    );\n  }\nprivate:\n  template&lt;class I, std::size_t Len&gt;\n  constexpr const auto s(I, char const (&amp;section_name)[Len], std::false_type) const {\n    return *this;\n  }\n\n  template&lt;class I, std::size_t Len&gt;\n  constexpr const auto s(I, char const (&amp;section_name)[Len], std::true_type) const {\n    return *this;\n  }\n};\n</code></pre>\n"}], "owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562194626, "creation_date": 1562191698, "last_edit_date": 1562193088, "question_id": 56878494, "link": "https://stackoverflow.com/questions/56878494/can-templated-field-reference-template-parameters-be-passed-as-the-first-templat", "title": "Can templated field reference template parameters be passed as the first template parameter?", "body": "<p>I have the following method in a <code>template &lt;class Base&gt; class foo {}</code>:</p>\n\n<pre><code>template &lt;\n    typename V,\n    template &lt;class, class&gt; class Map,\n    Map&lt;std::string, V&gt; Base::*Field,\n    std::size_t Len\n&gt;\nconstexpr const foo&lt;Base&gt; s(char const (&amp;section_name)[Len]) const {\n    #pragma unused(section_name)\n    return *this;\n}\n</code></pre>\n\n<p>My goal is to be able to call it simply with:</p>\n\n<pre><code>struct my_struct {\n    std::map&lt;std::string, int&gt; section;\n    constexpr auto bar = foo&lt;my_struct&gt;()\n        .s&lt;&amp;my_struct::section&gt;(\"hi\");\n};\n</code></pre>\n\n<p>Is this possible, perhaps via specialization? I can't wrap my head around how to get this to even compile, as currently I can't pass the pointer-to-member since the templated Map type comes first in the declaration, which gives the me the following on clang:</p>\n\n<blockquote>\n  <p>note: candidate template ignored: invalid explicitly-specified argument for template parameter 'Map'</p>\n</blockquote>\n\n<p>And I can't seem to get the magical incantations of specialization to work, either:</p>\n\n<pre><code>template &lt;auto FieldType, std::size_t Len&gt;\nconstexpr const foo&lt;Base&gt; s(char const (&amp;section_name)[Len]) const;\n\ntemplate &lt;\n    template &lt;class, class&gt; class Map,\n    typename SecType,\n    Map&lt;std::string, SecType&gt; Base::*Field,\n    std::size_t Len\n&gt;\nconstexpr const foo&lt;Base&gt; s&lt;Field, Len&gt;(char const (&amp;section_name)[Len]) const {\n\n}\n</code></pre>\n\n<p>which gives</p>\n\n<blockquote>\n  <p>error: function template partial specialization is not allowed</p>\n</blockquote>\n\n<p>Is what I'm after even possible? Worth mentioning c++14 and onward is OK.</p>\n"}, {"tags": ["c++", "arduino", "menu", "macros"], "comments": [{"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562194561, "post_id": 56878476, "comment_id": 100306147, "body": "<a href=\"https://en.cppreference.com/w/cpp/language/identifiers\" rel=\"nofollow noreferrer\">Identifiers with a double underscore anywhere are reserved.</a> Using such an identifier gives your code undefined behavior. (I don&#39;t see this as the cause of your problem, but might as well eliminate the possibility, right?)"}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562195550, "post_id": 56878476, "comment_id": 100306349, "body": "See also <a href=\"https://stackoverflow.com/questions/44276528/using-nested-macro-with-different-number-of-arguments-in-c/44287415#44287415\">Using nested macro with different number of arguments in C++</a> for another duplicate."}], "owner": {"reputation": 29, "user_id": 3721066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/859b8bdedeaf4373693509236eeca5e8?s=128&d=identicon&r=PG&f=1", "display_name": "Antyos", "link": "https://stackoverflow.com/users/3721066/antyos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1562612128, "answer_count": 0, "score": 0, "last_activity_date": 1562191568, "creation_date": 1562191568, "question_id": 56878476, "link": "https://stackoverflow.com/questions/56878476/evaluation-order-of-define-within-define-macro", "closed_reason": "Duplicate", "title": "Evaluation Order of #define within #define Macro", "body": "<p>I am working on a menu system for an Arduino project with <code>#define</code> macros (inspired by the Marlin firmware on my 3D printer) I am attempting to generalize each menu item with the macro <code>#define MENU_ITEM_EDIT()</code>. The full code is really long, so I am leaving out chunks of code of compactness. However, you can find the full code here: <a href=\"https://pastebin.com/h24itG9y\" rel=\"nofollow noreferrer\">https://pastebin.com/h24itG9y</a></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void draw_row(int row, char* value) { /* Stuff here*/ } // Draws row\nchar* uiToStr(int x) { /* Stuff here*/ } // Converts unsigned int to a string\n\n#define disp_array(display, value)  display[value]\n#define disp_func(display, value)   display(value)\n#define disp_char(display, value)   display\n\n#define MENU_ITEM_EDIT(min, max, rate, display, displayType, width, label, value) \\\n    // A bunch of stuff\n    draw_row(rowNum, disp_ ## displayType(display, value)); \\\n    // More stuff\n</code></pre>\n\n<p>Using the code macro would look like:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// Values\nconst char item1[] = \"Item 1\", item2[] = \"Item 2\", item3[] = \"Item 3\";\nconst char* const itemList[] = {item1, item2, item3};\nint currentItem = 0;\nuint8_t item1Val = 10;\n\nvoid menu1() \n{\n   START_MENU(); \n       MENU_ITEM_EDIT(0, 3, 1, itemList, array, 6, \"Item:\", currentItem);\n       MENU_ITEM_EDIT(0, 255, 1, uiToStr, func, 3, \"Item 1 Value:\", item1Val);\n   END_MENU();\n}\n</code></pre>\n\n<p>Which displays as:</p>\n\n<pre><code>Item:     Item 1\nItem 1 Value: 10     \n</code></pre>\n\n<p>For convenience in the declarations of my menus, I am trying to use common menu types, such as an <code>uint8_t</code> that ranges from 0 to 255. Then, in the menu, I would use <code>__u255_t</code> instead of the first 6 arguments.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#define __u255_t 0, 255, 1, uiToStr, func, 3\n\nvoid menu2()\n{\n    int item2Val = 10;\n\n    START_MENU(); \n        MENU_ITEM_EDIT(__u255_t, \"Item 2 Value\", item2Val);\n    END_MENU();\n}\n</code></pre>\n\n<p>Previously, I had it set up such that every time I wanted a different type of menu, even if I would only use it once, I had to define a type for it and how it should evaluate in the macro. This way, I can use 1 argument instead of 6 for commonly recurring types in rows. However, I still want the ability to use the 6 argument option when I have a row that has a unique set of arguments, such as a different range or list of display strings.</p>\n\n<p>However, in this example, the program won't compile because it places <code>__u255_t</code> into <code>min</code> in the <code>MENU_ITEM_EDIT()</code> macro, rather than expanding <code>__u255_t</code> into its 6 values and placing them into the first 6 arguments of <code>MENU_ITEM_EDIT()</code>. The macro evaluates as:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>MENU_ITEM_EDIT(__u255_t, \"Item 2 Value\", item2Val);\n// Evaluates as:\nMENU_ITEM_EDIT( (0, 255, 1, uiToStr, func, 3), \"Item 2 Value\", item2val, , , , , );\n</code></pre>\n\n<p>Note: I put an extra set of parentheses to make it more clear to understand.</p>\n\n<p>But I want:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>MENU_ITEM_EDIT(__u255_t, \"Item 2 Value\", item2Val);\n// Evaluates as:\nMENU_ITEM_EDIT(0, 255, 1, uiToStr, func, 3, \"Item 2 Value\", item2Val);\n</code></pre>\n\n<p>I thought about using a <code>struct</code>, however I'm not sure that I can because depending on the row, the <code>value</code> string in <code>draw_row()</code> could be a function or an array. Does anyone have any advice on how to solve this problem?</p>\n\n<p>Also, please let me know if I need to add any more code to make my problem more clear.</p>\n"}, {"tags": ["c++", "ms-media-foundation"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11736332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jJ935.jpg?s=128&g=1", "display_name": "Victor Reis", "link": "https://stackoverflow.com/users/11736332/victor-reis"}, "edited": false, "score": 0, "creation_date": 1562369161, "post_id": 56885084, "comment_id": 100364611, "body": "Thank you for answering me. but I was a bit confused. How would I use IMFStreamSink :: ProcessSample then? This process only works with Video, for audio, I need SinkWriter to process. I would have to access the low-level APIs to render the audio then in this case CoreAudio? But what would SAR do then? Or am I wrong here, and should I create a media source, be it custom or not, and use high-level api, MediaSession, as it appears in the Media Foundation framework?"}, {"owner": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "reply_to_user": {"reputation": 13, "user_id": 11736332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jJ935.jpg?s=128&g=1", "display_name": "Victor Reis", "link": "https://stackoverflow.com/users/11736332/victor-reis"}, "edited": false, "score": 0, "creation_date": 1562402525, "post_id": 56885084, "comment_id": 100368458, "body": "There can be only one user of <code>ProcessSample</code>, which in your case Sink Writer is. You cannot work with the media/stream sink concurrently with another higher level consumer. If you are not okay with this, you have to stop using Sink Writer: manage the media sink your self handling entirely its operation, and in this case a part of your work will be related to sample processing, you will customizing it in the desired way. If Sink Writer owns the media sink you can&#39;t interfere."}], "tags": [], "owner": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "is_accepted": true, "score": 0, "last_activity_date": 1562234089, "last_edit_date": 1562234089, "creation_date": 1562233352, "answer_id": 56885084, "question_id": 56878280, "link": "https://stackoverflow.com/questions/56878280/imfsinkwriterbeginwriting-does-not-initialize-because-the-imfmediaeventgenerat/56885084#56885084", "title": "IMFSinkWriter::BeginWriting does not initialize because the IMFMediaEventGenerator has pending events", "body": "<p>You are not supposed to call <code>IMFMediaEventGenerator</code> methods in this case.</p>\n\n<p>By using Sink Writer API you delegate management and exclusive control of Media Foundation primitive (SAR) to the Sink Writer instance. It is the subscriber for the events and there can be only one.</p>\n\n<p>That is, if you want to process <code>MEStreamSinkRequestSample</code> yourself, you cannot use Sink Writer API.</p>\n\n<p>There are similar questions on MSDN forums, e.g.</p>\n\n<ul>\n<li><a href=\"https://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/d0040b54-83e0-434b-9284-2706953aedc0/why-imfmediaeventgeneratorgetevent-always-returns-mfemultiplesubscribers?forum=mediafoundationdevelopment\" rel=\"nofollow noreferrer\">Why IMFMediaEventGenerator::GetEvent() always returns MF_E_MULTIPLE_SUBSCRIBERS?</a></li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 11736332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jJ935.jpg?s=128&g=1", "display_name": "Victor Reis", "link": "https://stackoverflow.com/users/11736332/victor-reis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 56885084, "answer_count": 1, "score": 0, "last_activity_date": 1562234089, "creation_date": 1562190176, "last_edit_date": 1562190444, "question_id": 56878280, "link": "https://stackoverflow.com/questions/56878280/imfsinkwriterbeginwriting-does-not-initialize-because-the-imfmediaeventgenerat", "title": "IMFSinkWriter::BeginWriting does not initialize because the IMFMediaEventGenerator has pending events", "body": "<p>I am trying to use the IMFSinkWriter to render audio samples(IMFSample), but I have problems when calling the <code>IMFSinkWriter::BeginWriting</code> method because it returns the code: <code>MF_E_MULTIPLE_SUBSCRIBERS</code>. This occurs because I am calling the <code>IMFStreamSink::BeginGetEvent(Callback, null)</code>.</p>\n\n<p>I tried calling the method (BeginWriting) without first calling (BeginGetEvent), surprise, the method works correctly and I can process audio samples successfully. </p>\n\n<p>The problem is that I can not make calls to (BeginGetEvent) after the SinkWriter has been created.</p>\n\n<p>The code that you use to create the SAR (Stream Audio Render):</p>\n\n<pre><code>HRESULT Hr = E_FAIL;\nIMFMediaSink *pAudioRender = NULL;\nIMFStreamSink *pStreamSink = NULL;\nIMFMediaTypeHandler *pMediaHandler = NULL;\nIMFPresentationClock *pPresentClock = NULL;\nIMFPresentationTimeSource* pTimeSource = NULL;\nIMFSinkWriter *pSinkWriter = NULL;\n\nHr = MFCreateAudioRenderer(NULL, &amp;pAudioRender);\n</code></pre>\n\n<p>I create the IMFPresenetationClock for Collector:</p>\n\n<pre><code>Hr = MFCreateSystemTimeSource(&amp;pTimeSource);\nHr = MFCreatePresentationClock(&amp;pPresentClock);\npPresentClock -&gt;SetTimeSource(pTimeSource);\nIMFMediaSink-&gt;SetPresentationClock(pPresentClock );\n</code></pre>\n\n<p>This part I configure the Stream Sink:</p>\n\n<pre><code>pAudioRender-&gt;GetStreamSinkByIndex(0, &amp;pStreamSink);\npStreamSink-&gt;GetMediaTypeHandler(&amp;pMediaHandler);\npMediaHandler-&gt;SetCurrentMediaType(DecodePCM);\n</code></pre>\n\n<p>If I call BeginGetEvent here, SinkWriter will not be created. If I call after creating SinkWriter, I get success, but I can not use BeginGetEvent again because it will return me: MF_E_MULTIPLE_SUBSCRIBERS.</p>\n\n<p>I used this code to create the SinkWriter, the creation happens well, but on the third line, I get an error code if I call (BeginGetEvent) in IMFStreamSink.</p>\n\n<pre><code>Hr = MFCreateSinkWriterFromMediaSink(pAudioRender, NULL, &amp;pSinkWriter);\npSinkWriter-&gt;SetInputMediaType(DecodePCM);\npSinkWriter-&gt;BeginWriting(); //HR -&gt; MF_E_MULTIPLE_SUBSCRIBERS\n</code></pre>\n\n<p>I want to use the <code>IMFMediaEventGenerator</code> of the <code>IMFStreamSink</code> interface to receive the events (MEStreamSinkRequestSample) to call the <code>IMFSourceReader::ReadSample</code> method.</p>\n\n<p>For me to receive these events, I need to understand why <code>IMFSinkWriter::BeginWriting</code>, gets the event generator from <code>IMFStreamSink</code>.</p>\n"}, {"tags": ["c++", "qt", "emscripten"], "comments": [{"owner": {"reputation": 3796, "user_id": 4661625, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c3cd0caf54e0766c83f04f51f881303b?s=128&d=identicon&r=PG&f=1", "display_name": "Bumsik Kim", "link": "https://stackoverflow.com/users/4661625/bumsik-kim"}, "edited": false, "score": 1, "creation_date": 1562193283, "post_id": 56878180, "comment_id": 100305875, "body": "What&#39;s your build command? Please post it including your all emcc compile flags."}, {"owner": {"reputation": 176, "user_id": 8902646, "user_type": "registered", "profile_image": "https://graph.facebook.com/1733368446697423/picture?type=large", "display_name": "Krzysztof Sommerfeld", "link": "https://stackoverflow.com/users/8902646/krzysztof-sommerfeld"}, "reply_to_user": {"reputation": 3796, "user_id": 4661625, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c3cd0caf54e0766c83f04f51f881303b?s=128&d=identicon&r=PG&f=1", "display_name": "Bumsik Kim", "link": "https://stackoverflow.com/users/4661625/bumsik-kim"}, "edited": false, "score": 0, "creation_date": 1562237438, "post_id": 56878180, "comment_id": 100319718, "body": "post edited I didnt use manual build command, just qmake and then make"}, {"owner": {"reputation": 7319, "user_id": 2667360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKqx3.png?s=128&g=1", "display_name": "Benjamin T", "link": "https://stackoverflow.com/users/2667360/benjamin-t"}, "edited": false, "score": 0, "creation_date": 1562584011, "post_id": 56878180, "comment_id": 100407656, "body": "What does <code>QImageReader::supportedImageFormats()</code> return? Did you try with <code>QT += svg</code> in your .pro file?"}, {"owner": {"reputation": 176, "user_id": 8902646, "user_type": "registered", "profile_image": "https://graph.facebook.com/1733368446697423/picture?type=large", "display_name": "Krzysztof Sommerfeld", "link": "https://stackoverflow.com/users/8902646/krzysztof-sommerfeld"}, "edited": false, "score": 0, "creation_date": 1562585570, "post_id": 56878180, "comment_id": 100408416, "body": "I didnt but it doesnt work only with emscripten so I thought it is problem with emscripten option/qt emscripten build. Anyway I will try to add it and will back with results."}, {"owner": {"reputation": 5904, "user_id": 455304, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/160d117143a58baa428415e4aa55ae95?s=128&d=identicon&r=PG", "display_name": "j_kubik", "link": "https://stackoverflow.com/users/455304/j-kubik"}, "reply_to_user": {"reputation": 7319, "user_id": 2667360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKqx3.png?s=128&g=1", "display_name": "Benjamin T", "link": "https://stackoverflow.com/users/2667360/benjamin-t"}, "edited": false, "score": 0, "creation_date": 1563057187, "post_id": 56878180, "comment_id": 100576616, "body": "@BenjaminT The <code>QT += svg</code> will link-in the <code>libQt5Svg.a</code> which is a set of additional components that are used to handle the SVG format explicitly: <a href=\"https://doc.qt.io/qt-5/qtsvg-module.html\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qtsvg-module.html</a> . What OP actually needs is much simpler <code>qsvg</code> image format plugin which is enough to simply load and display a SVG image using standard, format-agnostic Qt API. Linking against the <code>libQt5Svg.a</code> will probably pull the respective plugin as a hard dependency (I may be wrong here) so using it may help indirectly, but it may bloat the final executable unnecessarily if the linker doesn&#39;t skip it as unused."}], "answers": [{"comments": [{"owner": {"reputation": 176, "user_id": 8902646, "user_type": "registered", "profile_image": "https://graph.facebook.com/1733368446697423/picture?type=large", "display_name": "Krzysztof Sommerfeld", "link": "https://stackoverflow.com/users/8902646/krzysztof-sommerfeld"}, "edited": false, "score": 0, "creation_date": 1563724151, "post_id": 57023219, "comment_id": 100785431, "body": "it&#39;s working! I just back from holidays. Thank you for help!"}], "tags": [], "owner": {"reputation": 5904, "user_id": 455304, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/160d117143a58baa428415e4aa55ae95?s=128&d=identicon&r=PG", "display_name": "j_kubik", "link": "https://stackoverflow.com/users/455304/j-kubik"}, "is_accepted": true, "score": 3, "last_activity_date": 1563056377, "creation_date": 1563056377, "answer_id": 57023219, "question_id": 56878180, "link": "https://stackoverflow.com/questions/56878180/emsripten-compiled-qt-application-does-not-show-images/57023219#57023219", "title": "Emsripten compiled qt application does not show images", "body": "<p>I presume that by \"when I am not using emscripten\" means the regular, dynamically-loaded Qt. Image format plugins included in such installations are dynamic libraries and can be loaded on demand by Qt - this is the mechanism used to load the svg format plugin if it is required.</p>\n\n<p>The emscripten Qt builds are currently only static libraries - these must be linked together in advance as they cannot be dynamically loaded when required. In order to make qmake aware which plugins you will need, add</p>\n\n<pre><code>QTPLUGIN += qsvg\n</code></pre>\n\n<p>to your project file. You will probably want to make it wasm-specific to\navoid interference on other platforms:</p>\n\n<pre><code>wasm {\n    QTPLUGIN += qsvg\n}\n</code></pre>\n"}], "owner": {"reputation": 176, "user_id": 8902646, "user_type": "registered", "profile_image": "https://graph.facebook.com/1733368446697423/picture?type=large", "display_name": "Krzysztof Sommerfeld", "link": "https://stackoverflow.com/users/8902646/krzysztof-sommerfeld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 57023219, "answer_count": 1, "score": 5, "last_activity_date": 1563056377, "creation_date": 1562189450, "last_edit_date": 1562237367, "question_id": 56878180, "link": "https://stackoverflow.com/questions/56878180/emsripten-compiled-qt-application-does-not-show-images", "title": "Emsripten compiled qt application does not show images", "body": "<p>I have some Qt chess application. Everything works fine when i build it using VS compiler or gcc but I have problem with web assembly version using emscripten. When i run html with emrun everything is ok but images just does not show up.</p>\n\n<p>My emscripten version is emcc (Emscripten gcc/clang-like replacement) 1.38.30 (commit d33f7a29002a2463a7956cd53a559b97a52f9560).</p>\n\n<p>My qmake version: QMake version 3.1</p>\n\n<p>My Qt version: Using Qt version 5.13.0</p>\n\n<p>I am using official Qt binaries from online linux installer for wasm.</p>\n\n<p>I am using emrun --no_browser .html command to set up server on localhost.</p>\n\n<p>I tried different kinds of paths specification.\nI ended up with this code example, works ok but not with web assembly version.\nThis is code to load an example image.</p>\n\n<pre><code>...\nQDir::setSearchPaths(\"qrc\", QStringList(\":/\"));\nreturn QIcon(QUrl(\"qrc:///Images/king_white.svg\").toString());\n</code></pre>\n\n<p>this is my .qrc file:</p>\n\n<pre><code>&lt;!DOCTYPE RCC&gt;&lt;RCC version=\"1.0\"&gt;\n&lt;qresource&gt;\n    &lt;file&gt;Images/king_black.svg&lt;/file&gt;\n    ...\n&lt;/qresource&gt;\n&lt;/RCC&gt;\n</code></pre>\n\n<p>in .pro file I also have:</p>\n\n<pre><code>RESOURCES = resources.qrc\n</code></pre>\n\n<p>It works okay when I am not using emscripten.\nThanks for help.</p>\n\n<p>EDIT:\nBuild options (from Makefile generated by qmake)</p>\n\n<pre><code>CC            = emcc\nCXX           = em++\nDEFINES       = -DQT_NO_DEBUG -DQT_WIDGETS_LIB -DQT_GUI_LIB -DQT_CORE_LIB\nCFLAGS        = -pipe -O3 -s ALLOW_MEMORY_GROWTH=1 -Wall -W $(DEFINES)\nCXXFLAGS      = -pipe -O3 -std=gnu++1y -s ALLOW_MEMORY_GROWTH=1 -Wall -W $(DEFINES)\nINCPATH       = -I. -I../../Qt513/5.13.0/wasm_32/include -I../../Qt513/5.13.0/wasm_32/include/QtWidgets -I../../Qt513/5.13.0/wasm_32/include/QtGui -I../../Qt513/5.13.0/wasm_32/include/QtCore -I. -I/home/somas/.emscripten_ports/openssl/include -I../../Qt513/5.13.0/wasm_32/mkspecs/wasm-emscripten\nQMAKE         = /home/somas/Qt513/5.13.0/wasm_32/bin/qmake\nDEL_FILE      = rm -f\nCHK_DIR_EXISTS= test -d\nMKDIR         = mkdir -p\nCOPY          = cp -f\nCOPY_FILE     = cp -f\nCOPY_DIR      = cp -f -R\nINSTALL_FILE  = install -m 644 -p\nINSTALL_PROGRAM = install -m 755 -p\nINSTALL_DIR   = cp -f -R\nQINSTALL      = /home/somas/Qt513/5.13.0/wasm_32/bin/qmake -install qinstall\nQINSTALL_PROGRAM = /home/somas/Qt513/5.13.0/wasm_32/bin/qmake -install qinstall -exe\nDEL_FILE      = rm -f\nSYMLINK       = ln -f -s\nDEL_DIR       = rmdir\nMOVE          = mv -f\nTAR           = tar -cf\nCOMPRESS      = gzip -9f\nDISTNAME      = ChessNewGeneration.js1.0.0\nDISTDIR = /home/somas/ChessNewGeneration/ChessNewGeneration/.tmp/ChessNewGeneration.js1.0.0\nLINK          = em++\nLFLAGS        = -s WASM=1 -s FULL_ES2=1 -s USE_WEBGL2=1 -s NO_EXIT_RUNTIME=0 -s ERROR_ON_UNDEFINED_SYMBOLS=1 --bind -s \"BINARYEN_TRAP_MODE='clamp'\" -O3 -s ALLOW_MEMORY_GROWTH=1\nLIBS          = $(SUBLIBS) /home/somas/Qt513/5.13.0/wasm_32/plugins/platforms/libqwasm.a /home/somas/Qt513/5.13.0/wasm_32/lib/libQt5EventDispatcherSupport.a /home/somas/Qt513/5.13.0/wasm_32/lib/libQt5FontDatabaseSupport.a /home/somas/Qt513/5.13.0/wasm_32/lib/libqtfreetype.a /home/somas/Qt513/5.13.0/wasm_32/lib/libQt5EglSupport.a /home/somas/Qt513/5.13.0/wasm_32/plugins/imageformats/libqgif.a /home/somas/Qt513/5.13.0/wasm_32/plugins/imageformats/libqicns.a /home/somas/Qt513/5.13.0/wasm_32/plugins/imageformats/libqico.a /home/somas/Qt513/5.13.0/wasm_32/plugins/imageformats/libqjpeg.a /home/somas/Qt513/5.13.0/wasm_32/plugins/imageformats/libqtga.a /home/somas/Qt513/5.13.0/wasm_32/plugins/imageformats/libqtiff.a /home/somas/Qt513/5.13.0/wasm_32/plugins/imageformats/libqwbmp.a /home/somas/Qt513/5.13.0/wasm_32/plugins/imageformats/libqwebp.a /home/somas/Qt513/5.13.0/wasm_32/lib/libQt5Widgets.a /home/somas/Qt513/5.13.0/wasm_32/lib/libQt5Gui.a /home/somas/Qt513/5.13.0/wasm_32/lib/libqtlibpng.a /home/somas/Qt513/5.13.0/wasm_32/lib/libqtharfbuzz.a /home/somas/Qt513/5.13.0/wasm_32/lib/libQt5Core.a /home/somas/Qt513/5.13.0/wasm_32/lib/libqtpcre2.a   \nAR            = emar cqs\nRANLIB        = \nSED           = sed\nSTRIP         = \n</code></pre>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562189477, "post_id": 56878085, "comment_id": 100304943, "body": "<code>include_directories(..)</code> may do what you want."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 2, "creation_date": 1562189652, "post_id": 56878085, "comment_id": 100305005, "body": "<b><i>this unusual header structure</i></b> I think this is a quite common header structure."}, {"owner": {"reputation": 43, "user_id": 10304630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc9126960fa3551e0ae290f3ae050bc?s=128&d=identicon&r=PG&f=1", "display_name": "e-eight", "link": "https://stackoverflow.com/users/10304630/e-eight"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562190259, "post_id": 56878085, "comment_id": 100305160, "body": "@drescherjm I am used to not including the directory name in <code>#include</code> statements if the header files are in the same directory as the source file, so this is unusual to me. In which <code>CMakeLists.txt</code> should I add <code>include_directories(..)</code>?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1562195814, "post_id": 56878085, "comment_id": 100306405, "body": "I would add inside <code>lib&#47;CMakeLists.txt</code> a <code>add_library(lib INTERFACE)</code> with <code>target_include_directoires(lib INTERFACE .)</code> and link with that library. But you could just <code>target_include_directories(moduleA PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}&#47;..)</code>."}, {"owner": {"reputation": 43, "user_id": 10304630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc9126960fa3551e0ae290f3ae050bc?s=128&d=identicon&r=PG&f=1", "display_name": "e-eight", "link": "https://stackoverflow.com/users/10304630/e-eight"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1562197028, "post_id": 56878085, "comment_id": 100306647, "body": "@KamilCuk Tried the second option, and it worked. Could you please explain what is the difference between the two options?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1562228595, "post_id": 56878085, "comment_id": 100314691, "body": "One adds a new interface library and the other adds include directory to moduleA library. Cmake is quite verbose, when you start reading function just as they are spelled. In the first I need link moduleA and moduleB with the interface library."}], "owner": {"reputation": 43, "user_id": 10304630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc9126960fa3551e0ae290f3ae050bc?s=128&d=identicon&r=PG&f=1", "display_name": "e-eight", "link": "https://stackoverflow.com/users/10304630/e-eight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1562191926, "creation_date": 1562188852, "last_edit_date": 1562191926, "question_id": 56878085, "link": "https://stackoverflow.com/questions/56878085/how-to-write-my-cmakelists-txt-for-this-unusual-header-structure", "title": "How to write my CMakeLists.txt for this unusual header structure?", "body": "<p>I am trying to write a <code>CMakeLists.txt</code> for my project in C++, that depends on a few third party libraries. One of the libraries follows an unusual pattern (to me) when including header files as described below.</p>\n\n<p>My code is structured as:</p>\n\n<pre><code>project/\n  - CMakeLists.txt\n  - src/\n    - main.cpp\n  - lib/\n    - CMakeLists.txt\n    - moduleA/\n        -CMakeLists.txt\n        - fooA.cpp\n        - fooA.h\n        - barA.cpp\n        - barA.h\n    - moduleB/\n        - CMakeLists.txt\n        - fooB.cpp\n        - fooB.h\n</code></pre>\n\n<p><code>moduleA</code> depends on <code>moduleB</code>, and in addition <code>fooA</code> also depends on <code>barA</code>. The issue is with the <code>include</code> statements of <code>fooA.cpp</code> and <code>barA.cpp</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// fooA.cpp\n#include \"moduleA/fooA.h\"\n#include \"moduleA/barA.h\"\n...\n</code></pre>\n\n<p>Likewise for <code>barA.cpp</code>. When I run <code>make</code> after <code>cmake</code> it complains that it cannot find <code>moduleA/fooA.h</code> while compiling <code>fooA.cpp</code>. I am not sure how to include the files in <code>moduleA</code>, or in which <code>CMakeLists.txt</code> should I include those. <code>moduleB</code> compiles properly. I cannot change the code of the libraries, but I can add <code>cmake</code> files. </p>\n\n<p>My <code>CMakeLists.txt</code> in <code>lib</code> and <code>CMakeLists.txt</code> in <code>moduleA</code> are as follows.</p>\n\n<pre><code># lib/CMakeLists.txt\ncmake_minimum_required(VERSION 3.1...3.14)\nproject(mylibs VERSION 1.0.0 LANGUAGES CXX)\nadd_subdirectory(moduleA)\nadd_subdirectory(moduleB)\n</code></pre>\n\n<pre><code>#moduleA/CMakeLists.txt\ncmake_minimum_required(VERSION 3.1...3.14)\nproject(moduleA VERSION 1.0.0 LANGUAGES CXX)\nset (SOURCES fooA.cpp barA.cpp)\nset (HEADERS fooA.h barA.h)\nadd_library(moduleA STATIC ${SOURCES} ${HEADERS})\ntarget_link_libraries(moduleA PUBLIC moduleB)\n</code></pre>\n\n<p>The error is essentially the compiler not finding <code>moduleA</code> headers, when compiling <code>moduleA</code> source code, because the <code>moduleA</code> source files include headers in the same directory in an unusual (to me) way, <code>#include \"moduleA/header\"</code>.</p>\n"}, {"tags": ["c++", "null", "stream"], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562189235, "post_id": 56878106, "comment_id": 100304857, "body": "You should also open the file in <code>binary</code> mode when writing raw data to it."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562189617, "post_id": 56878106, "comment_id": 100304985, "body": "@RemyLebeau I totally see why that would be a logical assumption, but I&#39;m struggling to actually find sources saying that it won&#39;t work without opening in binary mode. Would you please provide a standard section regarding this very case or some other, reliable source?"}], "tags": [], "owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "is_accepted": true, "score": 2, "last_activity_date": 1562189249, "last_edit_date": 1562189249, "creation_date": 1562188974, "answer_id": 56878106, "question_id": 56878047, "link": "https://stackoverflow.com/questions/56878047/write-a-character-array-with-null-values-into-a-file-stream/56878106#56878106", "title": "Write a character array with null values into a file stream", "body": "<p>Instead of:</p>\n\n<pre><code>stream &lt;&lt; charArray &lt;&lt; endl;\n</code></pre>\n\n<p>use:</p>\n\n<pre><code>stream.write(charArray, sizeof(charArray));\nstream.write(\"\\n\", 1);  // this is the newline part of std::endl\nstream.flush();         // this is the flush part of std::endl\n</code></pre>\n\n<p>The first one assumes that you are sending a <em>null-terminated</em> string (because you're passing a <code>char*</code> - see the end of the answer why). That's why when the code encounters the very first <code>char</code> with value <code>0</code>, which is <code>'\\0'</code> (the null-terminator), it stops.</p>\n\n<p>On the other hand, the second approach uses an unformatted output write, which will not care about the values inside <code>charArray</code> - it will take it (as a pointer to its first element) and write <code>sizeof(charArray)</code> <strong>bytes</strong> starting from that pointer to the <code>stream</code>. This is safe since it's guaranteed that <code>sizeof(char) == 1</code>, thus <code>sizeof(charArray)</code> will yield <code>256</code>.</p>\n\n<p>What you need to consider is <em>array decaying</em>. It will work in this case (the <code>sizeof</code> thing), but it will not work if you simply pass a decayed pointer to the array's first element. Read more here: <a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\">what's array decaying?</a></p>\n"}], "owner": {"reputation": 217, "user_id": 11736511, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-27G799iJzrk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcjZQdcyVcWinAIPxvLU9056wuUyw/photo.jpg?sz=128", "display_name": "B0RDERS", "link": "https://stackoverflow.com/users/11736511/b0rders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 56878106, "answer_count": 1, "score": 0, "last_activity_date": 1562189249, "creation_date": 1562188654, "question_id": 56878047, "link": "https://stackoverflow.com/questions/56878047/write-a-character-array-with-null-values-into-a-file-stream", "title": "Write a character array with null values into a file stream", "body": "<p>I am new to c++ and am still figuring out file streams. I am trying to put a character array into a file that I will be viewing with a hex editor.</p>\n\n<p>I have done different strings, but whenever I put in a null byte, the file ends.</p>\n\n<pre><code>ofstream stream;\nchar charArray[256];\nfor (int i = 0; i &lt;= 255; i++)charArray[i] = i;\nstream.open(\"C:\\\\testfile.myimg\");\nif (!stream.is_open()) exit(1);\nstream &lt;&lt; charArray &lt;&lt; endl;\nreturn 0;\n</code></pre>\n\n<p>I want to output bytes with ascending values, but if I start with the null byte, then c++ thinks the character array ends before it starts</p>\n"}, {"tags": ["c++", "c", "return", "conditional-operator", "bitwise-not"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1562187972, "post_id": 56877854, "comment_id": 100304392, "body": "<code>return x &gt; base ? 3 * (x - base) : (base - x);</code> seems simpler (ans is shorter)."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 5, "creation_date": 1562187985, "post_id": 56877854, "comment_id": 100304397, "body": "When you have 50 such a returns in your program and something will not work and you will need to debug it - you will understand why it is better to write several lines more and not doing those pseudo &quot;smart&quot; things"}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 3, "creation_date": 1562188035, "post_id": 56877854, "comment_id": 100304420, "body": "I&#39;d complain if a co-worker showed this to me.  You understand it today, but a year from now it will be way harder to understand than it should be.  I don&#39;t consider it maintainable.  Let the compiler do the optimization.  That said, please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> to see what it says about questions asking for opinions."}, {"owner": {"reputation": 1802, "user_id": 3421618, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/TQAL7.jpg?s=128&g=1", "display_name": "ProXicT", "link": "https://stackoverflow.com/users/3421618/proxict"}, "edited": false, "score": 0, "creation_date": 1562188262, "post_id": 56877854, "comment_id": 100304476, "body": "Seems like you&#39;re trying to find the most complicated way to do the job. <code>&quot;I&#39;d like to use it&quot;</code> - Is there any real reason to why you want to use this construct?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1562188291, "post_id": 56877854, "comment_id": 100304483, "body": "Why obfuscate <code>-result</code> as <code>~result + 1</code> (which is only equivalent if the implementation uses two&#39;s complement)? A straightforward translation of your specification gives <code>return result &gt; 0 ? 3 * result : -result</code>."}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1562188399, "post_id": 56877854, "comment_id": 100304524, "body": "Oops, what to ask isn&#39;t linked from how to ask for some reason, see this - <a href=\"https://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a>"}, {"owner": {"reputation": 1, "user_id": 11638766, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lwx-aLobVMA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reINMSNIfAhL7f_wOOapIWFv7Qz2Q/mo/photo.jpg?sz=128", "display_name": "Alan Jurisich", "link": "https://stackoverflow.com/users/11638766/alan-jurisich"}, "edited": false, "score": 0, "creation_date": 1562188420, "post_id": 56877854, "comment_id": 100304535, "body": "Mostly just new to using the operator.  Like a person learning a new word, you want to use it.  But it got me to thinking.  Just because it works and I feel neat for implementing it, does that make it right?  Judging by the responses so far, I would say it&#39;s more than JUST opinion, it really would be a no no/dick move."}, {"owner": {"reputation": 1, "user_id": 11638766, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lwx-aLobVMA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reINMSNIfAhL7f_wOOapIWFv7Qz2Q/mo/photo.jpg?sz=128", "display_name": "Alan Jurisich", "link": "https://stackoverflow.com/users/11638766/alan-jurisich"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1562189821, "post_id": 56877854, "comment_id": 100305057, "body": "@molbdnilo, honestly? Because until this post is didn&#39;t know I could use the - operator that way."}], "answers": [{"tags": [], "owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 3, "last_activity_date": 1562188439, "creation_date": 1562188439, "answer_id": 56878014, "question_id": 56877854, "link": "https://stackoverflow.com/questions/56877854/nesting-conditional-operators-in-a-return-statement/56878014#56878014", "title": "Nesting conditional operators in a return statement", "body": "<ol>\n<li><p>There is nothing wrong about nesting conditionals in a <code>return</code> statement, <em>per se</em>.</p></li>\n<li><p><code>~result + 1</code> is bad. You are attempting to negate <code>result</code>. The proper way to do this is simply <code>-result</code>. <code>~result + 1</code> relies on two\u2019s complement representation, which is ubiquitous, but this expression is weirder and unnecessary.</p></li>\n<li><p>You do not need <code>(result &lt; 0 ? ~result + 1 : result)</code>. This expression is evaluated only if <code>x &gt; base</code> is false, in which case <code>result</code> must be less than or equal to zero, and you want to return <code>-result</code>, as that handles both the less than zero case (return <code>-result</code>) and the equal to zero case (return <code>0</code>, which is the same as <code>-result</code> when <code>result</code> is zero).</p></li>\n</ol>\n\n<p>So the <code>return</code> statement can be written:</p>\n\n<pre><code>return x &gt; base ? 3*result : -result;\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>return result &gt; 0 ? 3*result : -result;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11638766, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lwx-aLobVMA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reINMSNIfAhL7f_wOOapIWFv7Qz2Q/mo/photo.jpg?sz=128", "display_name": "Alan Jurisich", "link": "https://stackoverflow.com/users/11638766/alan-jurisich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56878014, "answer_count": 1, "score": -3, "last_activity_date": 1562190983, "creation_date": 1562187623, "last_edit_date": 1562190983, "question_id": 56877854, "link": "https://stackoverflow.com/questions/56877854/nesting-conditional-operators-in-a-return-statement", "title": "Nesting conditional operators in a return statement", "body": "<p>So I setup a code that finds the magnitude (absolute value) of the difference between the user's input and 51.  If the user's input is greater than 51 the result is tripled.  Not complicated.  In an effort to minimize the code itself I came up with this.</p>\n\n<pre><code>// Compare and determine the correct output based on program's \n// paramters:\n//\n// - find absolute value of input - 51\n// - if input &gt; 51 then multiply result by 3\n//-----------------------------------------------------------\n\nint calcDiff(int x) {\n      const int base = 51;\n      int result     = x - base;    \n      return x &gt; base ? 3*result : (result &lt; 0 ? ~result + 1 : result);\n }\n</code></pre>\n\n<p>So the question is:</p>\n\n<p>Is this appropriate? I know it works but i'm more curious whether it's bad practice and can some how bite me in the rear in a big way some day.  Is this just opinion or is it a big no no like using <code>scanf</code> or <code>gets</code>?  Is there an emoji for beating a dead horse? Because i'd like to use it.</p>\n"}, {"tags": ["c++", "vector", "unique-ptr"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1562187583, "post_id": 56877820, "comment_id": 100304268, "body": "The <code>std::move</code> calls here don&#39;t change anything. <code>make_unique&lt;int&gt;(30)</code> is a prvalue, so it already binds to an rvalue reference."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1562187738, "post_id": 56877820, "comment_id": 100304313, "body": "tl;dr - you can&#39;t do that. <code>std::initializer_list</code> constructors copy the arguments, which is impossible regarding <code>std::unique_ptr</code>. The answer below the question you linked mentiones that. Voting to close as a duplicate for that very question"}], "owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "closed_date": 1562187997, "answer_count": 0, "score": 1, "last_activity_date": 1562187412, "creation_date": 1562187412, "question_id": 56877820, "link": "https://stackoverflow.com/questions/56877820/initializing-of-vector-of-unique-ptr-failed-from-initializer-list", "closed_reason": "Duplicate", "title": "Initializing of vector of unique_ptr failed from initializer list", "body": "<p>I saw this <a href=\"https://stackoverflow.com/questions/9618268/initializing-container-of-unique-ptrs-from-initializer-list-fails-with-gcc-4-7\">question</a> but it doesn't really resolve my Problem.</p>\n\n<p>Following is my class and I want to initialize the unique_ptr vector from initializer list:</p>\n\n<pre><code>class MyClass\n{\npublic:\n    vector&lt;unique_ptr&lt;int&gt;&gt; vec2;\n    MyClass();\n};\n\nMyClass::MyClass()  :\nvec2{\n    move(make_unique&lt;int&gt;(30)), // Doesn't work\n    move(make_unique&lt;int&gt;(20))} // Doesn't work\n{\n\n    unique_ptr&lt;int&gt; myPtr= make_unique&lt;int&gt;(30);  // this works\n    unique_ptr&lt;int&gt; myPtr2= make_unique&lt;int&gt;(20); // this works\n\n    vec2.push_back(move(myPtr));  // this works\n    vec2.push_back(move(myPtr2)); // this works\n} \n</code></pre>\n\n<p>Following is the error:</p>\n\n<pre><code>error: use of deleted function \u2018std::unique_ptr&lt;_Tp, _Dp&gt;::unique_ptr(const std::unique_ptr&lt;_Tp, _Dp&gt;&amp;) [with _Tp = int; _Dp = std::default_delete&lt;int&gt;]\u2019\n { ::new(static_cast&lt;void*&gt;(__p)) _T1(std::forward&lt;_Args&gt;(__args)...); }\n   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nIn file included from /usr/include/c++/7/memory:80:0,\n             from test.cpp:3:\n/usr/include/c++/7/bits/unique_ptr.h:388:7: note: declared here\n   unique_ptr(const unique_ptr&amp;) = delete;\n</code></pre>\n\n<p>What I know is that when calling <code>move</code> the move constructor will be called, I mean <code>unique_ptr(const unique_ptr&amp;&amp;)</code> instead of <code>unique_ptr(const unique_ptr&amp;)</code> so why in the error message is saying <code>unique_ptr(const unique_ptr&amp;) = delete;</code></p>\n"}, {"tags": ["c++", "language-lawyer", "strict-aliasing"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1562186804, "post_id": 56877648, "comment_id": 100303965, "body": "What are you quoting that makes the first code block legal?  AFAIK it is as illegal as the second code block.  There could be padding at the end of the struct that throws off the alignment."}, {"owner": {"reputation": 6199, "user_id": 909393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74484afdfed3208ac5b1103b1fb1e8b4?s=128&d=identicon&r=PG", "display_name": "andrean", "link": "https://stackoverflow.com/users/909393/andrean"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562187118, "post_id": 56877648, "comment_id": 100304072, "body": "I based the first example on the explanation from this answer: <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule/51228315#51228315\" title=\"what is the strict aliasing rule\">stackoverflow.com/questions/98650/&hellip;</a> , although now that you mention, perhaps I misunderstood even that."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562187499, "post_id": 56877648, "comment_id": 100304242, "body": "hmm.  I&#39;m not sure what it is trying to convey there."}, {"owner": {"reputation": 6199, "user_id": 909393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74484afdfed3208ac5b1103b1fb1e8b4?s=128&d=identicon&r=PG", "display_name": "andrean", "link": "https://stackoverflow.com/users/909393/andrean"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562187937, "post_id": 56877648, "comment_id": 100304379, "body": "I believe the example from the linked answer attempts to prove that the compiler cannot assume that the two function parameters (<code>foo&amp;</code>, <code>int&amp;</code>) are not aliasing each other, that is, <code>foo</code> is a supposedly legal alias to an <code>int</code>?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562187980, "post_id": 56877648, "comment_id": 100304394, "body": "@andrean I don&#39;t see which part of the linked answer you would have based this code on. Can you point out which passage you believe is relevant to this question?"}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1562188086, "post_id": 56877648, "comment_id": 100304430, "body": "Before doing <code>reinterpret_cast&lt;foo*&gt;(&amp;values)</code> for <code>float values[9];</code>, read <a href=\"https://timsong-cpp.github.io/cppwp/n4659/basic.compound#def:pointer-interconvertible\" rel=\"nofollow noreferrer\">timsong-cpp.github.io/cppwp/n4659/&hellip;</a>"}, {"owner": {"reputation": 6199, "user_id": 909393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74484afdfed3208ac5b1103b1fb1e8b4?s=128&d=identicon&r=PG", "display_name": "andrean", "link": "https://stackoverflow.com/users/909393/andrean"}, "edited": false, "score": 0, "creation_date": 1562188105, "post_id": 56877648, "comment_id": 100304436, "body": "My example is not actually there, I derived it, based on what I thought was proved in that answer (under the explanation of paragraph 11.6)"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1562189356, "post_id": 56877648, "comment_id": 100304886, "body": "I wonder what happened to this sentence in the current draft (it&#39;s missing): <a href=\"http://eel.is/c++draft/basic.lval#11\" rel=\"nofollow noreferrer\">eel.is/c++draft/basic.lval#11</a>"}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1562189483, "post_id": 56877648, "comment_id": 100304945, "body": "@geza see <a href=\"http://wg21.link/p1359#2051\" rel=\"nofollow noreferrer\">wg21.link/p1359#2051</a>"}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 4, "creation_date": 1562189646, "post_id": 56877648, "comment_id": 100305002, "body": "Yeah, OP, the rule you are referring to was never applicable in C++, see <a href=\"http://wg21.link/p1359#2051\" rel=\"nofollow noreferrer\">wg21.link/p1359#2051</a>"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1562191995, "post_id": 56877648, "comment_id": 100305616, "body": "@LanguageLawyer: thanks. This issue 2051 made me to ask this: <a href=\"https://stackoverflow.com/questions/56878519/what-happened-to-the-aggregate-or-union-type-that-includes-one-of-the-aforement\" title=\"what happened to the aggregate or union type that includes one of the aforement\">stackoverflow.com/questions/56878519/&hellip;</a>"}, {"owner": {"reputation": 6199, "user_id": 909393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74484afdfed3208ac5b1103b1fb1e8b4?s=128&d=identicon&r=PG", "display_name": "andrean", "link": "https://stackoverflow.com/users/909393/andrean"}, "edited": false, "score": 0, "creation_date": 1562236862, "post_id": 56877648, "comment_id": 100319435, "body": "Thanks everyone, I guess that does clear things up, neither options are legal C++"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 1, "creation_date": 1562292118, "post_id": 56877648, "comment_id": 100337416, "body": "@LanguageLawyer It took the enlightened and expert ppl in the committee how many years to notice that one of the most well known, most quoted, most discussed rule had inapplicable clauses? And they used to tell ppl that they understood what the rules meant. Tells a lot of the clarity and common understanding of C++."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1562600572, "post_id": 56877648, "comment_id": 100417041, "body": "@curiousguy: The members of the Committee did not think it should matter if a general category of actions that was classed as Undefined Behavior included some which should obviously be processed in ways described elsewhere in the Standard, because the Standard is not intended to forbid capriciously-defined implementations from behaving in needlessly-useless fashion.  If parts of the Standard or an implementation&#39;s documentation describe the behavior of some action but another part says it&#39;s UB, the action need not be processed usefully on implementation whose customers don&#39;t need it to be,..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1562600605, "post_id": 56877648, "comment_id": 100417057, "body": "...but should be processed usefully by quality implementations whose customers do need it to be, regardless of whether the Standard mandates such behavior or not."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1567930474, "post_id": 56877648, "comment_id": 102108450, "body": "Undefined behavior is undefined behavior, not implementation-defined behavior.  The sanity check doesn&#39;t change that."}], "owner": {"reputation": 6199, "user_id": 909393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74484afdfed3208ac5b1103b1fb1e8b4?s=128&d=identicon&r=PG", "display_name": "andrean", "link": "https://stackoverflow.com/users/909393/andrean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "closed_date": 1573738283, "answer_count": 0, "score": 12, "last_activity_date": 1562186465, "creation_date": 1562186465, "question_id": 56877648, "link": "https://stackoverflow.com/questions/56877648/is-this-a-violation-of-strict-aliasing-rules", "closed_reason": "Duplicate", "title": "Is this a violation of strict aliasing rules?", "body": "<p>According to the standard \u2014 <em>an aggregate or union type that includes one of the aforementioned types among its elements or nonstatic data members (including, recursively, an element or non-static data member of a subaggregate or contained union)</em>, this is allowed:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct foo {\n  float x;\n};\n\nvoid bar(foo*);\n\nfloat values[9];\nbar(reinterpret_cast&lt;foo*&gt;(&amp;values));\n</code></pre>\n\n<p>However, I am not sure whether the following example also honors this rule:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct foo {\n  float x;\n  float y;\n  float z;\n};\n\nvoid bar(foo*);\n\nfloat values[9];\nassert((sizeof(values) / sizeof(float)) % 3 == 0);  // sanity check\nbar(reinterpret_cast&lt;foo*&gt;(&amp;values));\n</code></pre>\n"}, {"tags": ["c++", "qt", "localization"], "answers": [{"tags": [], "owner": {"reputation": 8601, "user_id": 1485885, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tdPE1.jpg?s=128&g=1", "display_name": "cbuchart", "link": "https://stackoverflow.com/users/1485885/cbuchart"}, "is_accepted": true, "score": 0, "last_activity_date": 1562229358, "creation_date": 1562229358, "answer_id": 56883797, "question_id": 56877567, "link": "https://stackoverflow.com/questions/56877567/how-to-map-the-correct-language-in-qt-multiple-language-supports/56883797#56883797", "title": "How to map the correct language in Qt multiple language supports?", "body": "<p>Effectively, <code>lupdate</code> parses the name file to get the language. It uses a similar method to the one by <a href=\"https://doc.qt.io/qt-5/qlocale.html#QLocale-1\" rel=\"nofollow noreferrer\"><code>QLocale</code></a>.</p>\n\n<p>Once you have the locale, you can use methods like <a href=\"https://doc.qt.io/qt-5/qlocale.html#nativeLanguageName\" rel=\"nofollow noreferrer\"><code>QLocale::nativeLanguageName</code></a> to get the language name (in this case the language name in that language).</p>\n\n<p>Just for completeness, <code>QTranslator</code> also uses such filename suffixes to find the correct .qm file to load for current locale. More info <a href=\"https://doc.qt.io/qt-5/qtranslator.html#load\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>For additional information, a good start point is the own <a href=\"https://wiki.qt.io/How_to_create_a_multi_language_application\" rel=\"nofollow noreferrer\">Qt's wiki page about multi-language applications</a>.</p>\n"}], "owner": {"reputation": 63, "user_id": 11364103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bu87Sb6nbO8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdX5Ol0CGay5URzcfPsOLk4PyKGtw/mo/photo.jpg?sz=128", "display_name": "Steven Cao", "link": "https://stackoverflow.com/users/11364103/steven-cao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 56883797, "answer_count": 1, "score": 2, "last_activity_date": 1562229595, "creation_date": 1562185998, "last_edit_date": 1562229595, "question_id": 56877567, "link": "https://stackoverflow.com/questions/56877567/how-to-map-the-correct-language-in-qt-multiple-language-supports", "title": "How to map the correct language in Qt multiple language supports?", "body": "<p>I need to add multiple languages to our Qt-based products. I did some googles and got some ideas. But, I could not find one answer: How does the '.ts' file know which language is for?</p>\n\n<p>For examples, in the sample project: i18n.</p>\n\n<p>I deleted the original 'i18n_zh.ts' file and used 'lupdate' to create a new 'i18n_zh.ts' file. I then looked at the contents of the new file. It has this line:</p>\n\n<pre><code>TS version=\"2.1\" language=\"zh_CN\"\n</code></pre>\n\n<p>I then used 'linguist' tool to open the new 'i18n_zh.ts' file and found out Qt knew it was Chinese translation.</p>\n\n<p>How did Qt know it is Chinese? Where is the mapping table? Does '_zh' in the file name hint anything?</p>\n\n<p>Some contents in the new 'i18n_zh.ts' file:</p>\n\n<pre><code>?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE TS&gt;\n&lt;TS version=\"2.1\" language=\"zh_CN\"&gt;\n&lt;context&gt;\n&lt;name&gt;MainWindow&lt;/name&gt;\n&lt;message&gt;\n    &lt;location filename=\"../languagechooser.cpp\" line=\"176\"/&gt;\n    &lt;location filename=\"../mainwindow.cpp\" line=\"85\"/&gt;\n    &lt;source&gt;English&lt;/source&gt;\n    &lt;translation type=\"unfinished\"&gt;&lt;/translation&gt;\n&lt;/message&gt;\n</code></pre>\n"}, {"tags": ["c++", "c", "windows", "winapi", "systems-programming"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1562188386, "post_id": 56877563, "comment_id": 100304515, "body": "<i>ObjectBasicInformation</i> - look in <code>PUBLIC_OBJECT_BASIC_INFORMATION.GrantedAccess</code>"}, {"owner": {"reputation": 134, "user_id": 4229811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/231fd96d971fcd71c3ea3cd141070aef?s=128&d=identicon&r=PG&f=1", "display_name": "Melina Golez", "link": "https://stackoverflow.com/users/4229811/melina-golez"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1562191123, "post_id": 56877563, "comment_id": 100305403, "body": "I check this but the value of .GrantedAccess is different than what we see in Process Explorer or Process Hacker"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1562193474, "post_id": 56877563, "comment_id": 100305915, "body": "and so what ? what value view you and what Process Explorer ? faster of all you make mistake somewhere. really <i>PUBLIC_OBJECT_BASIC_INFORMATION.GrantedAccess</i> containing correct infformation always"}], "owner": {"reputation": 134, "user_id": 4229811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/231fd96d971fcd71c3ea3cd141070aef?s=128&d=identicon&r=PG&f=1", "display_name": "Melina Golez", "link": "https://stackoverflow.com/users/4229811/melina-golez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1562189101, "answer_count": 0, "score": 0, "last_activity_date": 1562185983, "creation_date": 1562185983, "question_id": 56877563, "link": "https://stackoverflow.com/questions/56877563/getting-granted-access-to-a-handle", "closed_reason": "Duplicate", "title": "Getting granted access to a handle", "body": "<p>A client creates or opens a file, I'm injecting into the client and getting a handle of the file.\nFrom the handle can I get \"desired access\" the client provided to \"CreateFile\" function when calling CreateFile or OpenFile functions?</p>\n\n<p>I want to open another file with exactly same access?</p>\n\n<p>I tried <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntqueryobject\" rel=\"nofollow noreferrer\">NtQueryObject</a> but could not find a class which returns handle access values</p>\n"}, {"tags": ["c++", "pointers", "unique-ptr"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 6, "creation_date": 1562185578, "post_id": 56877465, "comment_id": 100303456, "body": "You can&#39;t do <code>.reset</code> on a <i>raw pointer</i>. It&#39;s not undefined behavior, it&#39;s a compile error."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1562185683, "post_id": 56877465, "comment_id": 100303490, "body": "Nonsense aside, I think the answer depends on <i>who (if anytone) owns</i> <code>other_ptr</code>. Currently your claiming ownership of it with <code>reset(other_ptr)</code>, so it had better not be owned anywhere else."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 2, "creation_date": 1562185781, "post_id": 56877465, "comment_id": 100303534, "body": "@std_name Heres: <code>int* other ... other.reset( ...</code>"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 3, "creation_date": 1562185899, "post_id": 56877465, "comment_id": 100303591, "body": "@std: Your example code produces: <code>..\\main.cpp:7:12: error: request for member &#39;reset&#39; in &#39;other&#39;, which is of non-class type &#39;int*&#39;</code>"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1562185900, "post_id": 56877465, "comment_id": 100303593, "body": "I think you very much misunderstand <code>unique_ptr</code>. When you pass <code>node</code> by value to <code>some_function</code>, it will be destroyed and the contained pointer will be deleted inside that function. <code>node_ptr-&gt;next</code> is completely superfluous and can be replaced with <code>node-&gt;next</code>. Also, <code>some_function</code> is declared to return `Node* but there is no return statement."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1562186016, "post_id": 56877465, "comment_id": 100303643, "body": "how is <code>int</code> not the same type as <code>int</code> ? I dont understand what is the difference between the two examples"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1562186374, "post_id": 56877465, "comment_id": 100303801, "body": "Regarding the edited question, the line <code>node_ptr-&gt;next.reset(other_ptr)</code> is fine <i>as long as</i> A) <code>other_ptr</code> was allocated using <code>new</code> and B) <code>other_ptr</code> will not be <code>delete</code>d anywhere else (whether manually or by another smart pointer). But there are some weird features of your code that are still very distracting."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1562188816, "post_id": 56877465, "comment_id": 100304717, "body": "@MFnx Actually it would need to be <code>some_function(std::move(some_unique_pointer), ...)</code> or <code>some_function(create_unique_pointer(), ...)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8710029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2d90ca283ffd2d2dc5bdebce5bd072?s=128&d=identicon&r=PG", "display_name": "std_name", "link": "https://stackoverflow.com/users/8710029/std-name"}, "edited": false, "score": 0, "creation_date": 1562186927, "post_id": 56877649, "comment_id": 100304010, "body": "Thank for the answer"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1562186931, "last_edit_date": 1562186931, "creation_date": 1562186473, "answer_id": 56877649, "question_id": 56877465, "link": "https://stackoverflow.com/questions/56877465/is-it-undefined-behavior-to-change-the-pointer-which-is-pointed-by-unique-ptr/56877649#56877649", "title": "Is it undefined behavior to change the pointer which is pointed by unique_ptr?", "body": "<p>With following preconditions, the behaviour of <code>some_function</code> is well defined:</p>\n\n<ul>\n<li><code>other_ptr</code> must have been allocated using <code>new</code>, and still be valid (not deleted).</li>\n<li>Ownership of <code>other_ptr</code> must have been transferred<sup>1</sup> to the function i.e. nothing else owns it.</li>\n<li><code>node</code> must not be null.</li>\n</ul>\n\n<p>However, <code>node</code>, like all arguments, is local to the function. When the function ends, <code>node</code> is destroyed. Consequently, the pointer it manages is deleted. Thus it seems <em>pointless</em> to modify the pointed object, which is what the function does.</p>\n\n<p><sup>1</sup> It is a bad idea to transfer ownership using a bare pointer. You should instead use unique pointer to transfer ownership.</p>\n\n<hr>\n\n<p>P.S. With the <code>next</code> and <code>previous</code> pointers, <code>Node</code> looks a lot like a doubly linked list. It cannot be a list however, because the previous node and the next node cannot possibly both have unique ownership of the current node.</p>\n\n<p>P.P.S. <code>Node* node_ptr = node.get(); node_ptr-&gt;next.reset...</code> can be simplified into <code>node-&gt;next.reset</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 8710029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2d90ca283ffd2d2dc5bdebce5bd072?s=128&d=identicon&r=PG", "display_name": "std_name", "link": "https://stackoverflow.com/users/8710029/std-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 56877649, "answer_count": 1, "score": -5, "last_activity_date": 1562194581, "creation_date": 1562185437, "last_edit_date": 1562194581, "question_id": 56877465, "link": "https://stackoverflow.com/questions/56877465/is-it-undefined-behavior-to-change-the-pointer-which-is-pointed-by-unique-ptr", "title": "Is it undefined behavior to change the pointer which is pointed by unique_ptr?", "body": "<p>Performing reset() on the unique_ptr's raw pointer that was gotten via get() is undefined behavior, it's like:</p>\n\n<pre><code>   std::unique_ptr&lt;int&gt; thing(new int(8));\n   int* other = thing.get();\n   other.reset(new int(15));\n</code></pre>\n\n<p>But what if the raw pointer of unique_ptr can point to the object of the same type? For example given the following code</p>\n\n<pre><code>class Node {\n    public:\n        std::unique_ptr&lt;Node&gt; previous;\n        std::unique_ptr&lt;Node&gt; next;\n        int data;        \n        Node(int d) : previous(nullptr),\n                      next(nullptr),   \n                      data(d) {}\n};\n\nvoid some_function(std::unique_ptr&lt;Node&gt; node, Node* other_ptr) {\n    Node* node_ptr = node.get();\n    node_ptr-&gt;next.reset(other_ptr); // ***           \n    \u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026.\n    \u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026.\n   // Some code. Please don't focus on the secondary things.\n   // The main question whether it allowed to perform reset from line ****)\n}\n</code></pre>\n\n<p>Is this undefined behavior too? If yes why.</p>\n\n<p>the link of the code: <a href=\"https://ideone.com/e.js/pawlyc!\" rel=\"nofollow noreferrer\">Code</a></p>\n"}, {"tags": ["c++", "matlab", "eigen", "mex"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11736292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bcc1bdd53d1f815baefa0239a8b96d?s=128&d=identicon&r=PG&f=1", "display_name": "theprof", "link": "https://stackoverflow.com/users/11736292/theprof"}, "edited": false, "score": 0, "creation_date": 1562643028, "post_id": 56877768, "comment_id": 100429565, "body": "Thanks for the explanation!  This code seems to provide the same results as Matlab&#39;s pinv function, which is what I needed."}], "tags": [], "owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "is_accepted": true, "score": 3, "last_activity_date": 1562187092, "creation_date": 1562187092, "answer_id": 56877768, "question_id": 56877397, "link": "https://stackoverflow.com/questions/56877397/mex-file-implementing-eigen-library-pseudo-inverse-function-crashes/56877768#56877768", "title": "MEX-file implementing Eigen library pseudo-inverse function crashes", "body": "<p>When constructing the <code>Eigen::JacobiSVD</code> object, you fail to request that matrices U and V should be computed. By default, these are not computed. Obviously, accessing these matrices if they are not computed will cause a segmentation violation.</p>\n\n<p>See <a href=\"https://eigen.tuxfamily.org/dox/classEigen_1_1JacobiSVD.html#abfd1dd454a6e3edec7feecd97c818a78\" rel=\"nofollow noreferrer\">the documentation to the constructor</a>. A second input argument must specify either <code>ComputeFullU | ComputeFullV</code>, or <code>ComputeThinU | ComputeThinV</code>. The thin ones are preferable when computing the pseudo-inverse, as the rest of the matrices are not needed.</p>\n\n<hr>\n\n<p>I would not derive from the <code>JacobiSVD</code> class just to add a method. Instead, I would simply write a free function. This is both easier, and allows you to use only the documented portions of the Eigen API.</p>\n\n<p>I wrote the following MEX-file, which works as intended (using code I already had for this computation). It does the same, but in a slightly different way that avoids writing an explicit loop. Not sure this way of writing it is very clear, but it works.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// Compile with:\n//    mex -v test.cpp -I/usr/local/include/eigen3\n\n#include \"mex.h\"\n#include &lt;Eigen/Dense&gt;\n#include &lt;Eigen/SVD&gt;\n#include &lt;cstdlib&gt;\n#include &lt;cmath&gt;\n#include &lt;iostream&gt;\n\nEigen::MatrixXf PseudoInverse(Eigen::MatrixXf matrix) {\n   Eigen::JacobiSVD&lt; Eigen::MatrixXf &gt; svd( matrix, Eigen::ComputeThinU | Eigen::ComputeThinV );\n   float tolerance = 1.0e-6f * float(std::max(matrix.rows(), matrix.cols())) * svd.singularValues().array().abs()(0);\n   return svd.matrixV()\n         * (svd.singularValues().array().abs() &gt; tolerance).select(svd.singularValues().array().inverse(), 0).matrix().asDiagonal()\n         * svd.matrixU().adjoint();\n}\n\nvoid mexFunction( int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[])\n{\n    Eigen::MatrixXf X = Eigen::MatrixXf::Random(5, 5);\n    Eigen::MatrixXf Y = PseudoInverse(X);\n    std::cout &lt;&lt; Y &lt;&lt; '\\n';\n    std::cout &lt;&lt; \"hi\\n\";\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11736292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bcc1bdd53d1f815baefa0239a8b96d?s=128&d=identicon&r=PG&f=1", "display_name": "theprof", "link": "https://stackoverflow.com/users/11736292/theprof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 56877768, "answer_count": 1, "score": 2, "last_activity_date": 1562187092, "creation_date": 1562185144, "last_edit_date": 1562185909, "question_id": 56877397, "link": "https://stackoverflow.com/questions/56877397/mex-file-implementing-eigen-library-pseudo-inverse-function-crashes", "title": "MEX-file implementing Eigen library pseudo-inverse function crashes", "body": "<p>I am trying to implement an Eigen library pseudo-inverse function in a Matlab MEX-file.  It compiles successfully but crashes when I run it.</p>\n\n<p>I am trying to follow <a href=\"http://eigen.tuxfamily.org/index.php?title=FAQ#Is_there_a_method_to_compute_the_.28Moore-Penrose.29_pseudo_inverse_.3F\" rel=\"nofollow noreferrer\">the FAQ on how to implement a pseudo-inverse function using the Eigen library</a>.</p>\n\n<p>The FAQ suggests adding it as a method to the <code>JacobiSVD</code> class but since you can't do that in C++ I'm adding it to a child class.  It compiles successfully but then crashes without an error message.  It successfully outputs \"hi\" without crashing if I comment out the line with the <code>.pinv</code> call so that's where the problem is arising.  To run, I just compile it (as <code>test.cpp</code>) and then type <code>test</code> at the command line.  I am using Matlab R2019a under MacOS 10.14.5 and Eigen 3.3.7.  In my full code I also get lots of weird error messages regarding the <code>pinv</code> code but before I can troubleshoot I need this simple test case to work.  This is all at the far limits of my understanding of C++.  Any help appreciated.</p>\n\n<pre><code>#include \"mex.h\"\n#include &lt;Eigen/Dense&gt;\n#include &lt;Eigen/SVD&gt;\n#include &lt;cstdlib&gt;\n#include &lt;cmath&gt;\n#include &lt;iostream&gt;\n\nusing namespace Eigen;\nusing namespace std;\n\n//https://stackoverflow.com/questions/18804402/add-a-method-to-existing-c-class-in-other-file\nclass JacobiSVDext : public JacobiSVD&lt;MatrixXf&gt; {\n    typedef SVDBase&lt;JacobiSVD&lt;MatrixXf&gt;&gt; Base;\n    public:\n    using JacobiSVD::JacobiSVD; //inherit constructors //https://stackoverflow.com/questions/347358/inheriting-constructors\n    MatrixXf pinv() //http://eigen.tuxfamily.org/index.php?title=FAQ\n    {\n        eigen_assert(m_isInitialized &amp;&amp; \"SVD is not initialized.\");\n        double  pinvtoler=1.e-6; // choose your tolerance wisely!\n        JacobiSVDext::SingularValuesType singularValues_inv=m_singularValues;\n        for ( long i=0; i&lt;m_workMatrix.cols(); ++i) {\n            if ( m_singularValues(i) &gt; pinvtoler )\n                singularValues_inv(i)=1.0/m_singularValues(i);\n            else singularValues_inv(i)=0;\n        }\n        return m_matrixV*singularValues_inv.asDiagonal()*m_matrixU.transpose();\n    };\n};\n\n/* The gateway function */\nvoid mexFunction( int nlhs, mxArray *plhs[],\n             int nrhs, const mxArray *prhs[])\n{\n    MatrixXf X = MatrixXf::Random(5, 5);\n    JacobiSVDext svd(X);\n    MatrixXf Y=svd.pinv();\n    cout &lt;&lt; Y &lt;&lt; endl;\n    cout &lt;&lt; \"hi\" &lt;&lt; endl;\n}\n</code></pre>\n\n<p>The expected result is to output the pseudo-inverse of the random matrix and also \"hi\".  Instead it crashes without an error message.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 4, "creation_date": 1562185187, "post_id": 56877373, "comment_id": 100303292, "body": "Please extract a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates what you want to do without anyone having to guess. As a new user, also take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1562186687, "post_id": 56877373, "comment_id": 100303914, "body": "Edit your own question, not my answer. I will edit my answer once you provided a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. If you can also provide an example of the error on <a href=\"https://godbolt.org\" rel=\"nofollow noreferrer\">godbolt.org</a> that would be wonderful."}, {"owner": {"reputation": 1, "user_id": 5007417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1230495cffdcdacfe1f981f92dd94dc?s=128&d=identicon&r=PG&f=1", "display_name": "Josheir", "link": "https://stackoverflow.com/users/5007417/josheir"}, "edited": false, "score": 0, "creation_date": 1562452420, "post_id": 56877373, "comment_id": 100378872, "body": "Well, the behavior desired was for a push to work which has been offered and did work.  However, any other problems were appreciated by those that are better."}, {"owner": {"reputation": 1, "user_id": 5007417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1230495cffdcdacfe1f981f92dd94dc?s=128&d=identicon&r=PG&f=1", "display_name": "Josheir", "link": "https://stackoverflow.com/users/5007417/josheir"}, "edited": false, "score": 0, "creation_date": 1562452825, "post_id": 56877373, "comment_id": 100378933, "body": "How should this be stated, related problems?"}, {"owner": {"reputation": 1, "user_id": 5007417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1230495cffdcdacfe1f981f92dd94dc?s=128&d=identicon&r=PG&f=1", "display_name": "Josheir", "link": "https://stackoverflow.com/users/5007417/josheir"}, "edited": false, "score": 0, "creation_date": 1562453015, "post_id": 56877373, "comment_id": 100378953, "body": "The problem was the push, but this may have only been one symptom."}, {"owner": {"reputation": 1, "user_id": 5007417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1230495cffdcdacfe1f981f92dd94dc?s=128&d=identicon&r=PG&f=1", "display_name": "Josheir", "link": "https://stackoverflow.com/users/5007417/josheir"}, "edited": false, "score": 0, "creation_date": 1562453109, "post_id": 56877373, "comment_id": 100378966, "body": "Oh, it needed to be in the question, all this, and it would be ok?"}], "answers": [{"tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": false, "score": 3, "last_activity_date": 1562185531, "creation_date": 1562185531, "answer_id": 56877486, "question_id": 56877373, "link": "https://stackoverflow.com/questions/56877373/why-am-i-getting-an-exception-with-a-push-involved-with-a-shared-pointer/56877486#56877486", "title": "Why am I getting an exception with a push involved with a shared pointer?", "body": "<p>This line:</p>\n\n<pre><code>auto alltransactions(atrans);\n</code></pre>\n\n<p>Declares a new variable named <code>alltransactions</code>, which has the same name as your member.</p>\n\n<p>Your constructor should use member init list to ensure your member are initialized correctly:</p>\n\n<pre><code>struct my_class {\n    my_class(std::shared_ptr&lt;std::vector&lt;cl_order&gt;&gt; atrans) : transactions(atrans) {}\n\n    std::shared_ptr&lt;std::vector&lt;cl_order&gt;&gt; transactions;\n};\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5007417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1230495cffdcdacfe1f981f92dd94dc?s=128&d=identicon&r=PG&f=1", "display_name": "Josheir", "link": "https://stackoverflow.com/users/5007417/josheir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1562242234, "answer_count": 1, "score": -2, "last_activity_date": 1569964216, "creation_date": 1562185023, "last_edit_date": 1569964216, "question_id": 56877373, "link": "https://stackoverflow.com/questions/56877373/why-am-i-getting-an-exception-with-a-push-involved-with-a-shared-pointer", "closed_reason": "Not suitable for this site", "title": "Why am I getting an exception with a push involved with a shared pointer?", "body": "<p>How do I pass a smart pointer into this class so that it may be pushed into.</p>\n"}, {"tags": ["c++", "loops"], "comments": [{"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 1, "creation_date": 1562185084, "post_id": 56877336, "comment_id": 100303245, "body": "Did you check the assembly output of the compiler? Try it there: <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">godbolt.org</a>"}, {"owner": {"reputation": 17902, "user_id": 116273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cc60634738ece15d1de4738110c76aa8?s=128&d=identicon&r=PG", "display_name": "erenon", "link": "https://stackoverflow.com/users/116273/erenon"}, "edited": false, "score": 1, "creation_date": 1562185091, "post_id": 56877336, "comment_id": 100303247, "body": "Using gcc.godbolt.org, you can easily verify, that there are no difference in terms of generated code."}, {"owner": {"reputation": 5673, "user_id": 2376156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2s2R4.jpg?s=128&g=1", "display_name": "edtheprogrammerguy", "link": "https://stackoverflow.com/users/2376156/edtheprogrammerguy"}, "edited": false, "score": 0, "creation_date": 1562185105, "post_id": 56877336, "comment_id": 100303252, "body": "I suspect it&#39;s just a matter of style, and not of trying to make the most efficient loop.  It would depend on the compiler and in my opinion would not be worth the time trying to save a few assembly instructions in such cases."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1562185109, "post_id": 56877336, "comment_id": 100303257, "body": "the answer to such questions is always the same. What is faster? Measure. Why? Look at the compiler output"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1562185333, "post_id": 56877336, "comment_id": 100303359, "body": "None of those are infinite loops (unless <code>frame()</code> always returns a true value). And the phrase &quot;normal loop&quot; in your title is at best ambiguous."}], "answers": [{"comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1562185326, "post_id": 56877401, "comment_id": 100303354, "body": "I agree with your points. <code>while (frame()) {}</code> is probably clearer than just the semi-colon though."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 4, "last_activity_date": 1562185153, "creation_date": 1562185153, "answer_id": 56877401, "question_id": 56877336, "link": "https://stackoverflow.com/questions/56877336/what-is-better-for-performance-infinitive-loop-with-if-or-normal-loop/56877401#56877401", "title": "What is better for performance? Infinitive loop with if or normal loop?", "body": "<p>This is horses for courses.</p>\n\n<p>Any good optimising compiler will generate the same code in these circumstances.</p>\n\n<p>Old-fashioned folk rely heavily on <code>for(;;)</code> as most mainsteam compilers don't generate a warning for that when warnings are set \"normally\". In my opinion at least <code>while(frame());</code> is a little clearer although some folk don't like empty loop bodies, and the loop body of the first way is not empty.</p>\n"}, {"comments": [{"owner": {"reputation": 308, "user_id": 3697860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac0d1700324a376dfdd3b7d41afce3f?s=128&d=identicon&r=PG", "display_name": "rm1948", "link": "https://stackoverflow.com/users/3697860/rm1948"}, "edited": false, "score": 0, "creation_date": 1562186963, "post_id": 56877522, "comment_id": 100304021, "body": "The long time convention going back to early C was to use for(;;) as an infinite loop. Never saw a reason why, it just was the way to do one."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 308, "user_id": 3697860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac0d1700324a376dfdd3b7d41afce3f?s=128&d=identicon&r=PG", "display_name": "rm1948", "link": "https://stackoverflow.com/users/3697860/rm1948"}, "edited": false, "score": 0, "creation_date": 1562187529, "post_id": 56877522, "comment_id": 100304253, "body": "@rm1948 i see. Note that the question was why make the loop Infinite in the first place."}, {"owner": {"reputation": 308, "user_id": 3697860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac0d1700324a376dfdd3b7d41afce3f?s=128&d=identicon&r=PG", "display_name": "rm1948", "link": "https://stackoverflow.com/users/3697860/rm1948"}, "edited": false, "score": 0, "creation_date": 1562201900, "post_id": 56877522, "comment_id": 100307393, "body": "Note I didn&#39;t provide an answer to the OP but just added a comment to another answer."}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 2, "last_activity_date": 1562185704, "creation_date": 1562185704, "answer_id": 56877522, "question_id": 56877336, "link": "https://stackoverflow.com/questions/56877336/what-is-better-for-performance-infinitive-loop-with-if-or-normal-loop/56877522#56877522", "title": "What is better for performance? Infinitive loop with if or normal loop?", "body": "<p>From <a href=\"https://en.cppreference.com/w/cpp/language/for\" rel=\"nofollow noreferrer\">cppreference on for loops</a>:</p>\n\n<blockquote>\n  <p>The above syntax [a for loop] produces code <strong>equivalent</strong> to:</p>\n\n<pre><code>{\n\n    init_statement\n    while ( condition ) {\n\n        statement\n        iteration_expression ;\n\n    } \n\n}\n</code></pre>\n</blockquote>\n\n<p>Compilers do not read cppreference, but they also do know that each for loop can be written as a while loop and vice-versa.</p>\n\n<p>The reason you see it often is probably a matter of convention. And we can only guess why it was choosen. Let me speculate...</p>\n\n<p>Consider this loop:</p>\n\n<pre><code>for (int i=0;i &lt; N; ++i);\n{\n    // do something\n}\n</code></pre>\n\n<p>Can you spot the mistake? Good compiler warn about it, but in my opinion the potential for such mistakes or to confuse a loop without body with such mistake is reason enough to avoid loops without body when it is possible for no cost.</p>\n\n<blockquote>\n  <p>is it possible that with for(;;) or while (true) the compiler can\n  optimize more because the condition is always true?!</p>\n</blockquote>\n\n<p>No, effectively the condition is the same in all three versions. </p>\n"}], "owner": {"reputation": 23, "user_id": 11736343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f65a522ac4377a90c4f4e39e7d96c862?s=128&d=identicon&r=PG&f=1", "display_name": "Noellor", "link": "https://stackoverflow.com/users/11736343/noellor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1562239928, "accepted_answer_id": 56877401, "answer_count": 2, "score": 1, "last_activity_date": 1562185704, "creation_date": 1562184884, "question_id": 56877336, "link": "https://stackoverflow.com/questions/56877336/what-is-better-for-performance-infinitive-loop-with-if-or-normal-loop", "closed_reason": "Opinion-based", "title": "What is better for performance? Infinitive loop with if or normal loop?", "body": "<p>i often see game engines doing:</p>\n\n<pre><code>for(;;) if(!frame()) break;\n\n</code></pre>\n\n<p>Why arent they just writing: </p>\n\n<pre><code>while(frame());\n\n</code></pre>\n\n<p>or if they want to use for:</p>\n\n<pre><code>for(;frame(););\n\n</code></pre>\n\n<p>is it possible that with for(;;) or while (true) the compiler can optimize more because the condition is always true?!</p>\n"}, {"tags": ["c++", "arrays", "pointers"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562185782, "post_id": 56877335, "comment_id": 100303535, "body": "If this is <code>c++</code> changing <code>void calculateField(diffData* diffDataTot){</code> to <code>void calculateField(diffData*&amp; diffDataTot){</code> should allow the pointer to be changed in the caller. This is the difference between passing the pointer by value and by reference."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10095444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bf6941f509063d4f4425af28a0fb2b?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen", "link": "https://stackoverflow.com/users/10095444/stephen"}, "edited": false, "score": 0, "creation_date": 1562191610, "post_id": 56877516, "comment_id": 100305540, "body": "Amazing thanks, this is exactly what I needed.  The code that I am using is definitely c++, but since I hand wrote it to simplify what I am trying to do maybe I changed some syntax"}], "tags": [], "owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "is_accepted": false, "score": 3, "last_activity_date": 1562188953, "last_edit_date": 1562188953, "creation_date": 1562185687, "answer_id": 56877516, "question_id": 56877335, "link": "https://stackoverflow.com/questions/56877335/resizing-an-array-by-pointer/56877516#56877516", "title": "Resizing an array by pointer", "body": "<p>You need to pass the address of your pointer (pointer on pointer).</p>\n\n<pre><code>void\nresizing_func(int **elements,\n              int *elem_count)\n{\n  //---- get rid of additional indirection ----\n  int *p=*elements;\n  int count=*elem_count;\n  //---- work with local variables ----\n  // ...\n  int new_count=2*count; // whatever is needed for the problem\n  p=realloc(p, new_count*sizeof(int));\n  // ...\n  //---- make changes visible in calling context ----\n  *elements=p;\n  *elem_count=new_count;\n}\n\nvoid\ntesting_func(void)\n{\n  int count=100;\n  int *elements=malloc(count*sizeof(int));\n  // populate elements\n  resizing_func(&amp;elements, &amp;count);\n  // use updated elements and count\n}\n</code></pre>\n\n<p>Depending on the problem, <code>realloc()</code> can be replaced by:</p>\n\n<ul>\n<li>allocate a second buffer,</li>\n<li>work with first and second buffer,</li>\n<li>free the first buffer and continue with the second,</li>\n</ul>\n\n<p>as in the OP's question.<br>\n(by the way, notice that <code>free(filler)</code> will free what was intended to be kept in <code>diffDataTot</code>)</p>\n\n<p>note: as the question is tagged <code>c++</code>, it would have probably been better to use a <code>std::vector</code> and pass it by (non-const) reference; but the provided source code looks like <code>c</code>.</p>\n"}], "owner": {"reputation": 39, "user_id": 10095444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bf6941f509063d4f4425af28a0fb2b?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen", "link": "https://stackoverflow.com/users/10095444/stephen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1562189471, "creation_date": 1562184871, "last_edit_date": 1562189471, "question_id": 56877335, "link": "https://stackoverflow.com/questions/56877335/resizing-an-array-by-pointer", "title": "Resizing an array by pointer", "body": "<p>I am resizing an array inside of a method, but since I am using a pointer, the memory address is now incorrect.  The <code>diffDataTot</code> pointer is initially created in <code>main()</code>, and then passed into the <code>calculateField()</code> method.  The <code>calculateField()</code> method contains new information that needs to be added to <code>diffDataTot</code>, and some old information needs to be removed.  I indicated this using the <code>resize()</code> method call.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void calculateField(diffData* diffDataTot){\n    diffData* filler = (diffData*)malloc(newSize * sizeof(diffData));\n    filler = resize(newSize, diffDataTot);\n    free(diffDataTot);\n    diffDataTot = filler;\n    free(filler);\n}\n\nint main{\n    diffData* diffDataTot = (diffData*)malloc(sizeof(diffData));\n    calculateField(diffDataTot);\n}\n</code></pre>\n\n<p>I had to abbreviate this since it is from a full scale simulation that is thousands of lines.  However, the issue is that <code>diffDataTot</code> contains the correct information locally inside of the <code>calculateField()</code> method.  But the pointer points to a different address in memory than in <code>main()</code>.  I could try without using a pointer, but I would like to avoid copying the entire array every time <code>calculateField()</code> is called since it is quite large.</p>\n\n<p>Is there any way for me to pass back the memory of the first element in the array from the <code>calculateField()</code> method?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562184889, "post_id": 56877322, "comment_id": 100303188, "body": "You can&#39;t have a circular include path where multiple headers include each other."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562185005, "post_id": 56877322, "comment_id": 100303221, "body": "<code>Player.h</code> does not need to include <code>Property.h</code> at all. A forward declaration of <code>Property</code> would be enough. Same goes for <code>Property.h</code> it does not need to include <code>Player.h</code>"}, {"owner": {"reputation": 1, "user_id": 8883086, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159645048360360/picture?type=large", "display_name": "Simon Larivi&#232;re", "link": "https://stackoverflow.com/users/8883086/simon-larivi%c3%a8re"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562186464, "post_id": 56877322, "comment_id": 100303823, "body": "Thanks a lot for the help @drescherjm! I didn&#39;t know forward declarations could be sufficient to use class objects defined in other header files. In that case, when would it be necessary to use an <code>#include</code>? Only in the main? If you know of any reading on the subject, I would be interested to know about it."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562187777, "post_id": 56877322, "comment_id": 100304326, "body": "<b><i>Only in the main?</i></b> No that is not correct. It&#39;s more complicated than that. With that said in a header I try to only include what is needed and keep the header dependencies to a minimum for this problem and also for build times. When your project has 5 thousand source files it takes much longer to build (can be tens of minutes) if there are many unnecessary header dependencies. My other advice is to study the linked duplicate. There is a lot of good information in that Q&amp;A."}, {"owner": {"reputation": 1, "user_id": 8883086, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159645048360360/picture?type=large", "display_name": "Simon Larivi&#232;re", "link": "https://stackoverflow.com/users/8883086/simon-larivi%c3%a8re"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562860456, "post_id": 56877322, "comment_id": 100520609, "body": "Did you intend to put a link on &#39;Q&amp;A&#39;? If not, would you tell me where I can find it? Thank you!"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562861785, "post_id": 56877322, "comment_id": 100521267, "body": "I was talking about this one: <a href=\"https://stackoverflow.com/questions/625799/resolve-build-errors-due-to-circular-dependency-amongst-classes\" title=\"resolve build errors due to circular dependency amongst classes\">stackoverflow.com/questions/625799/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 8883086, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159645048360360/picture?type=large", "display_name": "Simon Larivi&#232;re", "link": "https://stackoverflow.com/users/8883086/simon-larivi%c3%a8re"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1562185384, "answer_count": 0, "score": 0, "last_activity_date": 1562184817, "creation_date": 1562184817, "question_id": 56877322, "link": "https://stackoverflow.com/questions/56877322/why-do-i-get-undeclared-identifier-error-it-seems-like-include-is-not-workin", "closed_reason": "Duplicate", "title": "Why do I get &#39;undeclared identifier&#39; error? It seems like #include is not working properly", "body": "<p>I am trying to make a little Monopoly game to practice my C++ skills, but I am getting errors such as 'undeclared identifiers' and many others that seem to indicate that my #includes are not working properly. I am working with Visual Studio 2017.</p>\n\n<p>I have removed all unnecessary code, it's now pretty simple but I still cannot find where the problem is.</p>\n\n<p>There are five small files.</p>\n\n<p>main.cpp</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"Player.h\"\n#include \"Property.h\"\n\nint main() {\n    return 0;\n}\n</code></pre>\n\n<p>Player.h</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#pragma once\n#ifndef PLAYER_H\n#define PLAYER_H\n\n#include &lt;vector&gt;\n#include \"Property.h\"\n\nusing namespace std;\n\nclass Player {\npublic:\n    vector&lt;Property*&gt; getProperties();  // line 12\n\nprivate:\n    vector&lt;Property*&gt; properties_;      // line 15\n};\n\n#endif\n</code></pre>\n\n<p>Property.h</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#pragma once\n#ifndef PROPERTY_H\n#define PROPERTY_H\n\n\n#include \"Player.h\"\n\nusing namespace std;\n\nclass Property {        // line 12\npublic:\n    Player* getOwner(); // line 14\nprotected:\n    Player* owner_;\n};\n\n#endif\n</code></pre>\n\n<p>Player.cpp</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"Player.h\"\n\nvector&lt;Property*&gt; Player::getProperties()\n{\n    return properties_;\n}\n</code></pre>\n\n<p>Property.cpp</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"Property.h\"\n\nPlayer * Property::getOwner()\n{\n    return owner_;\n}\n</code></pre>\n\n<p>Here are the errors I get when compiling. I only kept the description, file and line to make it more readable.</p>\n\n<pre><code>Description                             File        Line    \n'Property': undeclared identifier       player.h    12  \n'Property': undeclared identifier       player.h    15  \nmissing type specifier - int assumed    property.h  12  \nmissing type specifier - int assumed    property.h  14  \nmissing type specifier - int assumed    property.h  12  \nmissing type specifier - int assumed    property.h  14  \nsyntax : '&gt;'                            player.h    12  \nsyntax : '&gt;'                            player.h    15  \nsyntax : missing ';' before '*'         property.h  12  \nsyntax : missing ';' before '*'         property.h  14  \nsyntax : missing ';' before '*'         property.h  12  \nsyntax : missing ';' before '*'         property.h  14  \nunexpected token(s) preceding ';'       property.h  12  \nunexpected token(s) preceding ';'       property.h  14  \nunexpected token(s) preceding ';'       property.h  12  \nunexpected token(s) preceding ';'       property.h  14\n</code></pre>\n\n<p>Thank you in advance for any help!</p>\n"}, {"tags": ["c++", "linux", "ncurses", "unreal-engine4"], "comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562185118, "post_id": 56877249, "comment_id": 100303261, "body": "You are on Windows, right? This might help: <a href=\"https://stackoverflow.com/questions/15222466/display-wchar-t-using-ncurses\">Display wchar_t using ncurses</a>"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 3057833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/838da23ff766139fc7aad7ea3074e3f1?s=128&d=identicon&r=PG", "display_name": "Scienziatogm", "link": "https://stackoverflow.com/users/3057833/scienziatogm"}, "edited": false, "score": 0, "creation_date": 1562186337, "post_id": 56877449, "comment_id": 100303779, "body": "Thank you for the answer! Anyway I made a mistake: TCHAR is a char16_t, so I&#39;m getting this compile error when using addwstr: error : cannot initialize a parameter of type &#39;const char *&#39; with an lvalue of type &#39;const TCHAR&#39; (aka &#39;const char16_t&#39;)"}, {"owner": {"reputation": 43, "user_id": 3057833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/838da23ff766139fc7aad7ea3074e3f1?s=128&d=identicon&r=PG", "display_name": "Scienziatogm", "link": "https://stackoverflow.com/users/3057833/scienziatogm"}, "edited": false, "score": 0, "creation_date": 1562187879, "post_id": 56877449, "comment_id": 100304362, "body": "Solved replacing the code with this:  <code>if (!m_sInput.IsEmpty()) \t\t{ \t\t\taddstr(TCHAR_TO_ANSI(*m_sInput)); \t\t\trefresh(); \t\t}</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 43, "user_id": 3057833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/838da23ff766139fc7aad7ea3074e3f1?s=128&d=identicon&r=PG", "display_name": "Scienziatogm", "link": "https://stackoverflow.com/users/3057833/scienziatogm"}, "edited": false, "score": 0, "creation_date": 1562190837, "post_id": 56877449, "comment_id": 100305324, "body": "@Scienziatogm <code>TCHAR</code> is whatever size you tell the compiler to make it. It is intended to make porting code from old DOS-based OSes to Windows NT-based based OSes. A 20-something year old solution to a problem from 20-something years ago. These days it&#39;s usually best if you avoid using <code>TCHAR</code> to prevent interesting surprises like this one."}, {"owner": {"reputation": 19618, "user_id": 860585, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/YagL1.jpg?s=128&g=1", "display_name": "Rotem", "link": "https://stackoverflow.com/users/860585/rotem"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1562207113, "post_id": 56877449, "comment_id": 100308179, "body": "@user4581301 <code>TCHAR</code> is defined by Unreal Engine to support a wide range of platforms, and from what I can see in practice it is always defined as <code>wchar_t</code>."}, {"owner": {"reputation": 43, "user_id": 3057833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/838da23ff766139fc7aad7ea3074e3f1?s=128&d=identicon&r=PG", "display_name": "Scienziatogm", "link": "https://stackoverflow.com/users/3057833/scienziatogm"}, "reply_to_user": {"reputation": 19618, "user_id": 860585, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/YagL1.jpg?s=128&g=1", "display_name": "Rotem", "link": "https://stackoverflow.com/users/860585/rotem"}, "edited": false, "score": 0, "creation_date": 1562244641, "post_id": 56877449, "comment_id": 100323656, "body": "@Rotem Yes, but in this case, it is defined as a const char16_t"}], "tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": true, "score": 3, "last_activity_date": 1562185382, "creation_date": 1562185382, "answer_id": 56877449, "question_id": 56877249, "link": "https://stackoverflow.com/questions/56877249/getting-an-unexpected-character-with-addch/56877449#56877449", "title": "Getting an unexpected character with addch", "body": "<p><a href=\"https://invisible-island.net/ncurses/man/curs_addch.3x.html\" rel=\"nofollow noreferrer\"><strong><code>addch</code></strong></a> expects a <strong><code>chtype</code></strong> parameter, which contains an 8-bit character (and if you happen to pass it a <code>NUL</code>, it will show that as <strong><code>^@</code></strong>).</p>\n\n<p><code>wchar_t</code> holds more than an 8-bit character.  Use <a href=\"https://invisible-island.net/ncurses/man/curs_addwstr.3x.html\" rel=\"nofollow noreferrer\"><code>addwstr</code></a> for <em>that</em>.</p>\n"}], "owner": {"reputation": 43, "user_id": 3057833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/838da23ff766139fc7aad7ea3074e3f1?s=128&d=identicon&r=PG", "display_name": "Scienziatogm", "link": "https://stackoverflow.com/users/3057833/scienziatogm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 56877449, "answer_count": 1, "score": 1, "last_activity_date": 1562186995, "creation_date": 1562184421, "last_edit_date": 1562186995, "question_id": 56877249, "link": "https://stackoverflow.com/questions/56877249/getting-an-unexpected-character-with-addch", "title": "Getting an unexpected character with addch", "body": "<p>I'm using ncurses with <code>noecho()</code>, and I'm trying to print a string from a <code>TCHAR</code> (or <code>char16_t</code>) array with <code>addch()</code> function.</p>\n\n<p>I've tried casting my <code>TCHAR</code> to an int, but with the same result.</p>\n\n<p>This is the code I'm using:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>coords hCursorPosition( GetCursorPosition() );\n        if ( hCursorPosition.X == 0 ) return;\n        coords nCursorPosition(hCursorPosition.Y, 0);\n        SetCursorPosition(nCursorPosition);\n        clrtoeol();\n        if (!m_sInput.IsEmpty())\n        {\n            for (auto CharIt(m_sInput.CreateConstIterator()); CharIt; CharIt++)\n            {\n                const TCHAR Char = *CharIt;\n                int intChar = static_cast&lt;int&gt;(Char);\n                addch(intChar);\n                refresh();\n            }\n        }\n</code></pre>\n\n<p><code>m_sInput</code> is an <code>FString</code> (a type used in Unreal Engine 4), I've checked the <code>FString</code> length and it's correct, while the result isn't what I expect.</p>\n\n<p>For example if <code>m_sInput</code> is \"test\", my output will be \"test^@\"</p>\n"}, {"tags": ["c++", "mysql", "casting", "connector"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1562183360, "post_id": 56877015, "comment_id": 100302628, "body": "The errors are from <b>not</b> casting. A cast is something you write in your source code to tell the compiler to do a conversion. The change seems to be that the <b>implicit conversion</b> that the code relied on is no longer implicit."}, {"owner": {"reputation": 23, "user_id": 4537661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01caa0803110f1c221025ba614907b40?s=128&d=identicon&r=PG&f=1", "display_name": "almogh52", "link": "https://stackoverflow.com/users/4537661/almogh52"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1562183568, "post_id": 56877015, "comment_id": 100302710, "body": "@PeteBecker Correct, but as I see in the code of the MySQL Connector, they have implemented the operator std::string so is there any reason this won&#39;t work?"}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562196014, "post_id": 56877015, "comment_id": 100306454, "body": "You declared the variable <code>res</code> but never used it. You used the variable <code>row</code> but never declared it. Were these supposed to be the same variable?"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 4537661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01caa0803110f1c221025ba614907b40?s=128&d=identicon&r=PG&f=1", "display_name": "almogh52", "link": "https://stackoverflow.com/users/4537661/almogh52"}, "is_accepted": true, "score": 1, "last_activity_date": 1562185544, "creation_date": 1562185544, "answer_id": 56877488, "question_id": 56877015, "link": "https://stackoverflow.com/questions/56877015/implicit-conversion-stopped-working-after-updating-mysql-connector/56877488#56877488", "title": "Implicit Conversion stopped working after updating MySQL Connector", "body": "<p>Well apparently, MySQL has made that the std::string and bool implicit conversion are now explicit conversion, so that was the source of my problem.</p>\n"}], "owner": {"reputation": 23, "user_id": 4537661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01caa0803110f1c221025ba614907b40?s=128&d=identicon&r=PG&f=1", "display_name": "almogh52", "link": "https://stackoverflow.com/users/4537661/almogh52"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56877488, "answer_count": 1, "score": 1, "last_activity_date": 1562185544, "creation_date": 1562183199, "last_edit_date": 1562184603, "question_id": 56877015, "link": "https://stackoverflow.com/questions/56877015/implicit-conversion-stopped-working-after-updating-mysql-connector", "title": "Implicit Conversion stopped working after updating MySQL Connector", "body": "<p>I recently upgraded my MySQL Connector C++ to v8.0.16 which lead to problem occurring during the compile of my project. </p>\n\n<p>All the errors are from casting the \"mysql::abi2::r0::Value\" to different types. \nFor example, I have this code inside one of my functions: </p>\n\n<pre><code>std::string s; \nsql::Row res; \n\n... Fetching from database ... \n\ns = row[0]; // Here is the error \n</code></pre>\n\n<p>The error I'm having is: </p>\n\n<blockquote>\n  <p>no suitable user-defined conversion from \"mysqlx::abi2::r0::Value\" to\n  \"std::string\" exists</p>\n</blockquote>\n\n<p>But if I use casting it works: </p>\n\n<pre><code>s = (std::string)row[0]; // No error here \n</code></pre>\n\n<p>In the previous version of MySQL Connector C++ I didn't have this problem. </p>\n\n<p>I have checked and the mysqlx::abi2::r0::Value class of the MySQL Connector does implement the operator std::string which allows for implicit conversion so is there any reason that my code won't work?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1562204390, "post_id": 56876807, "comment_id": 100307780, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/195966/discussion-on-question-by-user11736087-looping-over-set-inside-map-in-cpp\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1562184103, "post_id": 56877168, "comment_id": 100302939, "body": "taking into account that you arent sober nice answer :P"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1562184179, "post_id": 56877168, "comment_id": 100302958, "body": "@formerlyknownas_463035818 God, yes, wouldn&#39;t have managed it without the compiler checking my work."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1562184398, "post_id": 56877168, "comment_id": 100303038, "body": "seriously, its a nice example for why the &quot;almost&quot; should not be left out in &quot;almost always auto&quot;. its nice when the types are obvious, but in the worst case <code>auto</code> can hurt readability"}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 3, "last_activity_date": 1562184138, "last_edit_date": 1562184138, "creation_date": 1562183984, "answer_id": 56877168, "question_id": 56876807, "link": "https://stackoverflow.com/questions/56876807/looping-over-set-inside-map-in-cpp/56877168#56877168", "title": "looping over set inside map in cpp", "body": "<p>So here's some code that iterates through each set (and prints out all the integers).</p>\n\n<pre><code>vector&lt;vector&lt;int&gt;&gt; verticalTraversal() {\n\n    map&lt;int, map&lt;int, set&lt;int&gt;&gt;&gt; mep;\n\n    solve(root, 0, 0, mep);\n    vector&lt;vector&lt;int&gt;&gt; result;\n    for (map&lt;int, map&lt;int, set&lt;int&gt;&gt;&gt;::iterator i = mep.begin(); i != mep.end(); ++i) {\n        for (map&lt;int, set&lt;int&gt;&gt;::iterator j = i-&gt;second.begin(); j != i-&gt;second.end(); ++j) {\n            for (set&lt;int&gt;::iterator k = j-&gt;second.begin(); k != j-&gt;second.end(); ++k) {\n                cout &lt;&lt; *k &lt;&lt; '\\n';\n            }\n        }\n    }\n    return result;\n}\n</code></pre>\n\n<p>First thing you should notice is that there are three loops not two, since you have a set inside a map inside a map you have three levels to iterate though (not two as in your code).</p>\n\n<p>Second thing is I removed all <code>auto</code> and all range based loops and been completely explicit about the types involved. Hopefully that makes the code easier to understand.</p>\n\n<p>Once you've understood it you can put the auto back in if you like, or even replace the loops with range based loops.</p>\n"}, {"tags": [], "owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1562264644, "last_edit_date": 1562264644, "creation_date": 1562185585, "answer_id": 56877496, "question_id": 56876807, "link": "https://stackoverflow.com/questions/56876807/looping-over-set-inside-map-in-cpp/56877496#56877496", "title": "looping over set inside map in cpp", "body": "<p>The best thing to do is to write a small program, and then get an idea/experiment with the smaller program to understand the basic concepts.  </p>\n\n<p>Here is an example:</p>\n\n<pre><code>#include &lt;map&gt;\n#include &lt;set&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::map&lt;int, std::map&lt;int, std::set&lt;int&gt;&gt;&gt; mep;\n    mep.insert({0, {{0, {0,1,2,3}}}});   // populate the map\n    mep.insert({1, {{1, {1,2,3,4,5}}}}); // populate the map\n    // traverse each set in the mep map\n    for (auto p : mep) \n    {\n        std::map&lt;int, std::set&lt;int&gt;&gt; s = p.second;\n        for (auto ity = s.begin(); ity != s.end(); ity++) \n        {    \n           std::set&lt;int&gt;&amp; theSet = ity-&gt;second;\n           for (auto&amp; setV : theSet )\n               std::cout &lt;&lt; setV &lt;&lt; \" \";\n           std::cout &lt;&lt; \"\\n\";\n        }\n     }\n  }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0 1 2 3 \n1 2 3 4 5 \n</code></pre>\n\n<p>Also note that you really should be using references to the data within the map instead of copying them by value.  Things like this:</p>\n\n<p><code>for (auto p : mep)</code> \nand\n<code>std::map&lt;int, std::set&lt;int&gt;&gt; s = p.second;</code></p>\n\n<p>incurs a copy.  Rather, you should do this:</p>\n\n<p><code>for (auto&amp; p : mep)</code>\n...\n<code>std::map&lt;int, std::set&lt;int&gt;&gt;&amp; s = p.second;</code></p>\n"}], "owner": {"reputation": 13, "user_id": 11736087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b393259bcf3df040754dcfea3c24774?s=128&d=identicon&r=PG&f=1", "display_name": "user11736087", "link": "https://stackoverflow.com/users/11736087/user11736087"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56877496, "answer_count": 2, "score": -3, "last_activity_date": 1562264644, "creation_date": 1562182141, "last_edit_date": 1562183210, "question_id": 56876807, "link": "https://stackoverflow.com/questions/56876807/looping-over-set-inside-map-in-cpp", "title": "looping over set inside map in cpp", "body": "<p>I am getting error in for loop ,compiler saying that 's' must have a pointer type (in <code>s-&gt;second.begin()</code>).I just want to iterate over set below.</p>\n\n<pre><code>vector&lt;vector&lt;int&gt;&gt; verticalTraversal(TreeNode* root) {\n\n    map&lt;int, map&lt;int, set&lt;int&gt;&gt;&gt; mep;\n\n    solve(root, 0, 0, mep);\n    vector&lt;vector&lt;int&gt;&gt; result;\n    for (auto p : mep) {\n        vector&lt;int&gt; temp;\n        map&lt;int,set&lt;int&gt;&gt; s = p.second;\n        for (auto ity = s-&gt;second.begin(); ity != s-&gt;second.end(); ity++) {    \n //getting error here in s-&gt;second.begin()\n\n\n        }\n\n        //reverse(temp.begin(), temp.end());\n        result.push_back(temp);\n    }\n    return result;\n}\n</code></pre>\n"}, {"tags": ["c++", "build", "visual-studio-code", "mingw", "mingw-w64"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1562181319, "post_id": 56876627, "comment_id": 100301864, "body": "Welcome to Stack Overflow. Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly please learn how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us, inside the question itself to make it self-contained."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562181388, "post_id": 56876627, "comment_id": 100301889, "body": "I think that means <code>fileName.cpp</code> does not exist or is in a different folder."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1562181563, "post_id": 56876627, "comment_id": 100301967, "body": "And remember that while Windows filesystems themselves by default aren&#39;t case-sensitive, Unix-like tools and environments could still be."}, {"owner": {"reputation": 11, "user_id": 11122621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--Mb8ikbRg5o/AAAAAAAAAAI/AAAAAAAAFmg/xLxr4XsQJDw/photo.jpg?sz=128", "display_name": "C0DEWzard", "link": "https://stackoverflow.com/users/11122621/c0dewzard"}, "edited": false, "score": 0, "creation_date": 1562182157, "post_id": 56876627, "comment_id": 100302177, "body": "Is fileName.cpp supposed to be in the C:\\MinGW\\bin folder? Or do I have to add the path to my file in the c_cpp_properties.json file?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562182373, "post_id": 56876627, "comment_id": 100302270, "body": "<b><i>Is fileName.cpp supposed to be in the C:\\MinGW\\bin folder?</i></b> No."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562182522, "post_id": 56876627, "comment_id": 100302324, "body": "You may want to consult the official documentation: <a href=\"https://code.visualstudio.com/docs/cpp/config-mingw\" rel=\"nofollow noreferrer\">code.visualstudio.com/docs/cpp/config-mingw</a>"}, {"owner": {"reputation": 11, "user_id": 11122621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--Mb8ikbRg5o/AAAAAAAAAAI/AAAAAAAAFmg/xLxr4XsQJDw/photo.jpg?sz=128", "display_name": "C0DEWzard", "link": "https://stackoverflow.com/users/11122621/c0dewzard"}, "edited": false, "score": 0, "creation_date": 1562183464, "post_id": 56876627, "comment_id": 100302666, "body": "Thanks, I&#39;ll take a look at it."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562196528, "post_id": 56876627, "comment_id": 100306559, "body": "The question would be more useful to others if it mentioned why you think the compiler should be able to locate this &quot;fileName.cpp&quot;. (Given that name, it&#39;s easy to assume that some sort of substitution failed -- i.e. a replacement of &quot;fileName&quot; with the actual file name failed -- but an earlier comment suggests that &quot;fileName.cpp&quot; is in fact the name of a file that is supposed to be compiled.)"}, {"owner": {"reputation": 11, "user_id": 11122621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--Mb8ikbRg5o/AAAAAAAAAAI/AAAAAAAAFmg/xLxr4XsQJDw/photo.jpg?sz=128", "display_name": "C0DEWzard", "link": "https://stackoverflow.com/users/11122621/c0dewzard"}, "edited": false, "score": 0, "creation_date": 1562213456, "post_id": 56876627, "comment_id": 100309185, "body": "fileName was just a placeholder name I used for the sake of the comment. Would it be more useful in the future to post the actual filename? I will update my question and answer because I was facing two errors. The one mentioned in the question happened because I was following the advice of an answer to a question about the original error. The problem solved in my answer below was for the original error. Let me clear them both up."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562261887, "post_id": 56876627, "comment_id": 100331342, "body": "@C0DEWzard It would be more useful in the future to explicitly state in the question that &quot;fileName&quot; is intentionally being used as a placeholder name. Or choose a name more commonly used as a placeholder, such as &quot;foo&quot;, &quot;bar&quot;, or &quot;baz&quot;. Or use the original file name if that does not distract from the question. Up to you."}, {"owner": {"reputation": 11, "user_id": 11122621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--Mb8ikbRg5o/AAAAAAAAAAI/AAAAAAAAFmg/xLxr4XsQJDw/photo.jpg?sz=128", "display_name": "C0DEWzard", "link": "https://stackoverflow.com/users/11122621/c0dewzard"}, "reply_to_user": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562454082, "post_id": 56876627, "comment_id": 100379072, "body": "@JaMiT Duly noted. Thank you for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11122621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--Mb8ikbRg5o/AAAAAAAAAAI/AAAAAAAAFmg/xLxr4XsQJDw/photo.jpg?sz=128", "display_name": "C0DEWzard", "link": "https://stackoverflow.com/users/11122621/c0dewzard"}, "reply_to_user": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562213206, "post_id": 56878091, "comment_id": 100309156, "body": "Adding the file path to the git bash shell solved the error.  I only changed to the 64bit compiler as that was used in the VS Code Docs. It also says in the Docs to add the file path to whatever shell you use (it recommends bash though). Thanks for the tips!"}], "tags": [], "owner": {"reputation": 11, "user_id": 11122621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--Mb8ikbRg5o/AAAAAAAAAAI/AAAAAAAAFmg/xLxr4XsQJDw/photo.jpg?sz=128", "display_name": "C0DEWzard", "link": "https://stackoverflow.com/users/11122621/c0dewzard"}, "is_accepted": true, "score": 1, "last_activity_date": 1562217236, "last_edit_date": 1562217236, "creation_date": 1562188901, "answer_id": 56878091, "question_id": 56876627, "link": "https://stackoverflow.com/questions/56876627/i-have-a-build-error-with-mingw-and-vs-code-g-not-recognized-as-a-cmdlet/56878091#56878091", "title": "I have a build error with MinGW and VS Code &quot;g++ not recognized as a cmdlet...&quot;", "body": "<p>OK, I finally figured it out. What worked for me was adding the file path to the git bash shell (C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Git) to the System Environment Variables in the Control Panel (how to do that <a href=\"https://www.architectryan.com/2018/03/17/add-to-the-path-on-windows-10/\" rel=\"nofollow noreferrer\">here</a>). Make sure you also have the file path to the MinGW bin folder added to the Environment Variables as well (32bit installer: C:\\MinGW\\bin) (64bit installer: C:/mingw-w64/x86_64-8.1.0-win32-seh-rt_v6-rev0/mingw64/bin) Then, restart VS Code and build (Ctrl+Shift+B) again.</p>\n\n<p>Here's my final code for the .json files:</p>\n\n<p>c_cpp_properties.json:</p>\n\n<pre><code>    \"configurations\": [\n        {\n            \"name\": \"Win32\",\n            \"includePath\": [\n                \"${workspaceFolder}/**\"\n            ],\n            \"defines\": [\n                \"_DEBUG\",\n                \"UNICODE\",\n                \"_UNICODE\"\n            ],\n            \"windowsSdkVersion\": \"10.0.17763.0\",\n            \"compilerPath\": \"C:/mingw-w64/x86_64-8.1.0-win32-seh-rt_v6-rev0/mingw64/bin/g++.exe\",\n            \"cStandard\": \"c11\",\n            \"cppStandard\": \"c++17\",\n            \"intelliSenseMode\": \"gcc-x64\",\n            \"browse\": {\n                \"path\": [\n                    \"${workspaceFolder}\"\n                ],\n                \"limitSymbolsToIncludedHeaders\": true,\n                \"databaseFilename\": \"\"\n            }\n        }\n    ],\n    \"version\": 4\n}\n</code></pre>\n\n<p>tasks.json: </p>\n\n<pre><code>{\n    \"version\": \"2.0.0\",\n    \"tasks\": [\n        {\n            \"label\": \"build calculator adventure\",\n            \"type\": \"shell\",\n            \"command\": \"g++\",\n            \"args\": [\n                \"-g\",\n                \"-o\",\n                \"Calculator-Adventure\",\n                \"Calculator Adventure.cpp\"\n            ],\n            \"group\": {\n                \"kind\": \"build\",\n                \"isDefault\": true\n            }\n        }\n    ]\n}\n</code></pre>\n\n<p>For more information, check out <a href=\"https://code.visualstudio.com/docs/cpp/config-mingw\" rel=\"nofollow noreferrer\">this page</a>. It is a really detailed step-by-step guide for using the MinGW compiler for C++ in VS Code (read it carefully). If you have any other trouble, take a look at <a href=\"https://www.youtube.com/watch?v=DIw02CaEusY\" rel=\"nofollow noreferrer\">this tutorial</a> (same tutorial linked in the question). Hope this helps!</p>\n\n<p>Note: in the docs page I linked, they use the 64bit version of MinGW. It should still work with the 32bit version though. Thanks, to @drescherjm for posting the VS Code Docs!</p>\n"}], "owner": {"reputation": 11, "user_id": 11122621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--Mb8ikbRg5o/AAAAAAAAAAI/AAAAAAAAFmg/xLxr4XsQJDw/photo.jpg?sz=128", "display_name": "C0DEWzard", "link": "https://stackoverflow.com/users/11122621/c0dewzard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 56878091, "answer_count": 1, "score": -1, "last_activity_date": 1562257917, "creation_date": 1562181170, "last_edit_date": 1562257917, "question_id": 56876627, "link": "https://stackoverflow.com/questions/56876627/i-have-a-build-error-with-mingw-and-vs-code-g-not-recognized-as-a-cmdlet", "title": "I have a build error with MinGW and VS Code &quot;g++ not recognized as a cmdlet...&quot;", "body": "<p>I am trying to set up build and run a c++ file in VS Code 2019. I am having build errors after editing the tasks.json file. The environment variable is set to g++ as it should be. So far, I have been following <a href=\"https://youtu.be/DIw02CaEusY\" rel=\"nofollow noreferrer\">this tutorial</a>.</p>\n\n<p>I attempted changing \"command\" to\"C:\\MinGW\\bin\\g++.exe\" as recommended in a question thread on GitHub. However, because my c++ file is not in this file path, the program was not able to find it when I built the code. This is what the \"command\" portion of the tasks.json file should look like:</p>\n\n<pre><code>\"label\": \"build calculator adventure\",\n            \"type\": \"shell\",\n            \"command\": \"g++\",\n            \"args\": [\n                \"-g\",\n                \"-o\",\n                \"Calculator-Adventure\",\n                \"Calculator Adventure.cpp\"\n            ],\n            \"group\": {\n                \"kind\": \"build\",\n                \"isDefault\": true\n            }\n        }\n</code></pre>\n\n<p>The <code>\"Calculator-Adventure\"</code> part is my filename. The expected output is for the code to build and create a .exe file for my code, as stated in the tutorial and said in the VS Code Docs.</p>\n\n<p>However, it currently outputs the following into the terminal:</p>\n\n<pre><code>&gt; Executing task: \u202a\u202ag++ -g Calculator Adventure.cpp -o Calculator-Adventure &lt;\n\ng++ : The term 'g++' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.\n\nThe terminal process terminated with exit code: 1\"\n</code></pre>\n"}, {"tags": ["c++", "c++17", "inline-variable"], "answers": [{"comments": [{"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 0, "creation_date": 1562224117, "post_id": 56876740, "comment_id": 100312442, "body": "There was also the static function variable approach: <code>inline std::mutex &amp;getMtx() { static std::mutex mtx; return mtx; }</code>."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 3, "last_activity_date": 1562181703, "last_edit_date": 1592644375, "creation_date": 1562181703, "answer_id": 56876740, "question_id": 56876624, "link": "https://stackoverflow.com/questions/56876624/inline-stdmutex-in-header-file/56876740#56876740", "title": "Inline std::mutex in header file", "body": "<p>In C++17 and above it is okay and proper to declare <code>mtx</code> as <code>inline</code>.  This allows you to have the same variable defined in all the translation units it is in.</p>\n<blockquote>\n<p>Should it be initialized explicitly? As in:</p>\n<pre><code>inline std::mutex mtx = {};\n</code></pre>\n</blockquote>\n<p>That is not needed.  <code>std::mutex</code> is default constructable so <code>inline std::mutex mtx;</code> is all you need.</p>\n<hr />\n<p>Before we had inline variables what you would have to do is have a header file with</p>\n<pre><code>extern std::mutex mtx;\n</code></pre>\n<p>in it and then in a single cpp file have</p>\n<pre><code>std::mutex mtx;\n</code></pre>\n<p>in it to actually provide a single definition.</p>\n"}, {"comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1562185616, "post_id": 56876757, "comment_id": 100303471, "body": "Doesn&#39;t <code>Because the meaning of the keyword inline for functions came to mean &quot;multiple definitions are permitted&quot; rather than &quot;inlining is preferred&quot;, that meaning was extended to variables.</code> conflict with what you say?"}, {"owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1562185878, "post_id": 56876757, "comment_id": 100303584, "body": "@ JVApen I don&#39;t think so, because, in order to prevent undefined behaviour, those multiple definitions have to be exactly the same (one-definition-rule)."}], "tags": [], "owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "is_accepted": true, "score": 2, "last_activity_date": 1562181810, "creation_date": 1562181810, "answer_id": 56876757, "question_id": 56876624, "link": "https://stackoverflow.com/questions/56876624/inline-stdmutex-in-header-file/56876757#56876757", "title": "Inline std::mutex in header file", "body": "<p>In the documentation on <code>inline</code> keyword applied to a variable (C++17)\n(<a href=\"https://en.cppreference.com/w/cpp/language/inline\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/inline</a>)\nit is stated that</p>\n\n<pre><code>2) It has the same address in every translation unit.\n</code></pre>\n\n<p>and</p>\n\n<pre><code>If an inline function or variable (since C++17) with external linkage is defined differently in different translation units, the behavior is undefined. \n</code></pre>\n\n<p>I understand from these sentences that the mutex will actually be unique and correctly initialised (if the only header suggested is used)</p>\n"}], "owner": {"reputation": 654, "user_id": 4743711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l0qvK.png?s=128&g=1", "display_name": "Loreto", "link": "https://stackoverflow.com/users/4743711/loreto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 56876757, "answer_count": 2, "score": 3, "last_activity_date": 1562182180, "creation_date": 1562181156, "last_edit_date": 1562182180, "question_id": 56876624, "link": "https://stackoverflow.com/questions/56876624/inline-stdmutex-in-header-file", "title": "Inline std::mutex in header file", "body": "<p>I am using a global <code>std::mutex</code> in different cpp files. </p>\n\n<p>Is it okay to declare it in a header file as <code>inline</code>?</p>\n\n<pre><code>inline std::mutex mtx;\n</code></pre>\n\n<p>Is <code>mtx</code> constructed this way? </p>\n\n<p>Should it be initialized explicitly? As in:</p>\n\n<pre><code>inline std::mutex mtx = {};\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1562181049, "post_id": 56876572, "comment_id": 100301745, "body": "Maybe a duplicate? It&#39;s for C, not for C++, though: <a href=\"https://stackoverflow.com/q/3602827/1896169\">stackoverflow.com/q/3602827/1896169</a>"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 1, "creation_date": 1562181051, "post_id": 56876572, "comment_id": 100301748, "body": "&quot;the program still being executed when n/k is not an integer&quot; but <code>n&#47;k</code> is <b>always</b> an integer when <code>n</code> and <code>k</code> are both integers."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1562181095, "post_id": 56876572, "comment_id": 100301768, "body": "As for why <code>n&#47;k</code> is an integer, <a href=\"https://softwareengineering.stackexchange.com/q/307993/184655\">softwareengineering.stackexchange.com/q/307993/184655</a> helps to explain"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1562181134, "post_id": 56876572, "comment_id": 100301786, "body": "Also note that C++ doesn&#39;t really have <a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">variable-length arrays</a>. Some compilers add it as a non-standard and non-portable extension."}, {"owner": {"reputation": 41213, "user_id": 215568, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05685e6c3945f4bd23bf1f967861aeb?s=128&d=identicon&r=PG", "display_name": "Donnie", "link": "https://stackoverflow.com/users/215568/donnie"}, "edited": false, "score": 1, "creation_date": 1562181144, "post_id": 56876572, "comment_id": 100301790, "body": "See <a href=\"https://stackoverflow.com/questions/7571326/why-does-dividing-two-int-not-yield-the-right-value-when-assigned-to-double\" title=\"why does dividing two int not yield the right value when assigned to double\">stackoverflow.com/questions/7571326/&hellip;</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562181922, "post_id": 56876572, "comment_id": 100302088, "body": "This doesn&#39;t compile for me because <code>k</code>, <code>n</code> and <code>m</code> aren&#39;t constant expressions. If I fix that, it still doesn&#39;t compile because zero sized arrays aren&#39;t allowed. Edit : Consider the -pedantic flag."}, {"owner": {"reputation": 491, "user_id": 11730679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dd7e6b280596f17d2599e867e98eb2d?s=128&d=identicon&r=PG", "display_name": "user185887", "link": "https://stackoverflow.com/users/11730679/user185887"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1562182030, "post_id": 56876572, "comment_id": 100302129, "body": "@Justin I&#39;m okay with the fact that n/k is an integer (0 in this case). But then our program should not run. Instead it should give an error. Why does it execute?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1562182093, "post_id": 56876572, "comment_id": 100302150, "body": "@user185887 See the answer below. The behavior is undefined. It can do anything, include running to completion as you expect. But the same code may behave differently on a different platform, different compiler, with different flags or just at a different time of day. Edit : In the original code, you are using variable length arrays, which follows GCC&#39;s own rules because it&#39;s not something the language offers, it&#39;s an extension. If you replace the size with 0 you now have a constant expression, it&#39;s no longer a VLA and GCC may be forced to play by the language&#39;s rules."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562182251, "post_id": 56876572, "comment_id": 100302216, "body": "Follow up : I wasn&#39;t able to reproduce, GCC doesn&#39;t complain if you specify the constant <code>0</code> to the arrays&#39; size unless I add the -pedantic flag. But then it complains for both codes."}], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 11730679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dd7e6b280596f17d2599e867e98eb2d?s=128&d=identicon&r=PG", "display_name": "user185887", "link": "https://stackoverflow.com/users/11730679/user185887"}, "edited": false, "score": 0, "creation_date": 1562181146, "post_id": 56876597, "comment_id": 100301791, "body": "but that integer value is 0 (correct me if I am wrong)"}, {"owner": {"reputation": 491, "user_id": 11730679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dd7e6b280596f17d2599e867e98eb2d?s=128&d=identicon&r=PG", "display_name": "user185887", "link": "https://stackoverflow.com/users/11730679/user185887"}, "edited": false, "score": 0, "creation_date": 1562181884, "post_id": 56876597, "comment_id": 100302077, "body": "&quot;it is seemingly correct&quot;-- could you please elaborate what that means or how is that even possible?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 491, "user_id": 11730679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dd7e6b280596f17d2599e867e98eb2d?s=128&d=identicon&r=PG", "display_name": "user185887", "link": "https://stackoverflow.com/users/11730679/user185887"}, "edited": false, "score": 0, "creation_date": 1562182085, "post_id": 56876597, "comment_id": 100302147, "body": "@user185887, when a program has undefined behavior, you never know what its behavior is going to be. Unfortunately, sane behavior also falls under the category of undefined behavior. Such a program might work under one set of compiler, compiler options and fail inexplicably under a different compiler or a different set of compiler options."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 491, "user_id": 11730679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dd7e6b280596f17d2599e867e98eb2d?s=128&d=identicon&r=PG", "display_name": "user185887", "link": "https://stackoverflow.com/users/11730679/user185887"}, "edited": false, "score": 0, "creation_date": 1562182363, "post_id": 56876597, "comment_id": 100302264, "body": "@user185887 You may be interested in reading about <a href=\"https://en.cppreference.com/w/cpp/language/ub\" rel=\"nofollow noreferrer\">Undefined Behavior</a>. It&#39;s an extremely important concept for working with C++."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1563151560, "post_id": 56876597, "comment_id": 100593238, "body": "Doesn&#39;t &quot;shall&quot; translate to &quot;ill-formed&quot; instead of &quot;undefined behavior&quot;?"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1562181472, "last_edit_date": 1562181472, "creation_date": 1562181064, "answer_id": 56876597, "question_id": 56876572, "link": "https://stackoverflow.com/questions/56876572/can-size-of-an-array-be-a-2-9-or-3-9/56876597#56876597", "title": "can size of an array be a 2/9 or 3/9?", "body": "<blockquote>\n  <p>As much as I know, the code should not work in case we write n/k and m/k. But it is. Why?</p>\n</blockquote>\n\n<p>Because <code>n/k</code> and <code>m/k</code> use integer division, which results in integer values.</p>\n\n<p>As to the size of the array, the <a href=\"https://timsong-cpp.github.io/cppwp/n3337/dcl.array#1\" rel=\"nofollow noreferrer\">standard requires that</a>:</p>\n\n<blockquote>\n  <p>it shall be an integral constant expression and its value shall be greater than zero. </p>\n</blockquote>\n\n<p>When <code>n/k</code> or <code>m/k</code> is zero, the behavior is not defined by the standard. If your program seems to work, it's just that -- it is seemingly correct. In theory, it is subject to undefined behavior.</p>\n"}], "owner": {"reputation": 491, "user_id": 11730679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dd7e6b280596f17d2599e867e98eb2d?s=128&d=identicon&r=PG", "display_name": "user185887", "link": "https://stackoverflow.com/users/11730679/user185887"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 56876597, "answer_count": 1, "score": -3, "last_activity_date": 1562182112, "creation_date": 1562180983, "last_edit_date": 1562181768, "question_id": 56876572, "link": "https://stackoverflow.com/questions/56876572/can-size-of-an-array-be-a-2-9-or-3-9", "title": "can size of an array be a 2/9 or 3/9?", "body": "<p>In the following code, it works with the size of array (As written while defining the arrays <strong>arr</strong> and <strong>brr</strong> ) k/n (or k/m) as well as n/k (or m/k). I'm a beginner in C++ and according to my knowledge, size of an array must be an integer greater than zero. But here this statement goes wrong.</p>\n\n<p>I've tried changing the length of an array to 0 due to the logic that  n/k is not an integer and since c++ converts it to 0, writing 0 in place of n/k should be equivalent. But it isn't.</p>\n\n<p>Also, when I run the code by asking the user for values of k,n,m instead of defining it in the source code itself, the code runs only when I write\n - n/k and m/k\n - k/n and m/k</p>\n\n<p>And it shows the error \"program.exe  has stopped working. Windows is checking for a solution to the problem.\" when I have k/m irrespective that I have n/k or k/n.</p>\n\n<p>I have tried using the debugger too (I'm using Codeblocks) but it did not give me any idea to why is the program still being executed when n/k is not an integer.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\n\n\n\nint main()\n{   int k=9;\n    int n=2;\n    int m=3;\n\n    int arr[n/k];\n    int brr[m/k];\n\n\n    for(int i=0;i&lt;k/n;i++)\n    {int x= n*(i+1);\n    arr[i]=x;\n\n    }\n\n    for(int j=0; j&lt;k/m; j++)\n    {\n        int y= m*(j+1);\n        brr[j]=y;\n    }\n\n    cout &lt;&lt; \"\\n\";\n\n    for(int i=0;i&lt;k/n;i++)\n    {\n        cout&lt;&lt; arr[i] &lt;&lt;\"\\n\";\n    }\n\n    cout &lt;&lt; \"\\n\";\n\n    for(int j=0; j&lt;k/m; j++)\n    {\n        cout&lt;&lt; brr[j] &lt;&lt;\"\\n\";\n    }\n    return 0;\n}\n</code></pre>\n\n<p>As much as I know, the code should not work in case we write n/k and m/k.\nBut it is. Why?</p>\n\n<p>Note- this code was written to solve <a href=\"https://www.geeksforgeeks.org/count-common-elements-in-two-arrays-containing-multiples-of-n-and-m/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/count-common-elements-in-two-arrays-containing-multiples-of-n-and-m/</a> \n(though I have not completed writing the code to solve the problem fully)</p>\n\n<p>Edit- As many comments have pointed out and given links to answers that explain why n/k is an integer (by integer division), I would like to clarify that the question is not that why n/k is rounded to an integer. The questions are</p>\n\n<ol>\n<li><p>Why are n/k and k/n given same value in integer division (they aren't the same obviously but as the program works fine for both of them, they seem to be equivalent. Why is it so?)</p>\n\n<ol start=\"2\">\n<li>Yes n/k is integer division. So the answer should be 0 (because 2/9 would be truncated to 0). But when we replace n/k by 0, the code doesn't work.</li>\n</ol></li>\n</ol>\n"}, {"tags": ["c++", "process", "sdl"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562179891, "post_id": 56876290, "comment_id": 100301240, "body": "I would start by testing it on another computer."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1562180214, "post_id": 56876290, "comment_id": 100301390, "body": "Try running a profiler"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562181016, "post_id": 56876290, "comment_id": 100301731, "body": "Is this a Release / optimized build?"}], "owner": {"reputation": 11, "user_id": 11735938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a90yR.jpg?s=128&g=1", "display_name": "xuku", "link": "https://stackoverflow.com/users/11735938/xuku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "closed_date": 1562182429, "answer_count": 0, "score": 1, "last_activity_date": 1562179586, "creation_date": 1562179586, "question_id": 56876290, "link": "https://stackoverflow.com/questions/56876290/why-do-my-c-sdl-programs-receive-60ms-of-lag-every-3000ms", "closed_reason": "Duplicate", "title": "Why do my C++ (SDL) programs receive 60ms of lag every 3000ms?", "body": "<p>My simple C++ application (which uses SDL) lags by ~60ms every ~3000ms. Using VSYNC at 144hz, the lag occurs exactly every 425 frames (~3000ms). At 144hz, my frame time should be approximately ~7ms every frame. Every 425th frame (or ~3000ms), my frame time is ~60ms.</p>\n\n<p>I first noticed the lag just my moving a square around the screen using keyboard input - I could feel a stutter/jump every few seconds. When I began to output my deltaTime with a timestamp/frame count to the console, I noticed that the lag was very consistent (~60ms) and occurred very consistently (~3000ms, or every 425 frames at 144hz with VSYNC).</p>\n\n<p>I have tried disabling VSYNC, running my application in fullscreen, in windowed mode, etc. Without VSYNC, the frame time for each lag is variable, but the time of ~3000ms remains the same. I have tried running other applications on my computer (video games) to see if the lag was noticeable there and it was not.</p>\n\n<p>I have tried uninstalling my antivirus, but the lag is still there. I have tried closing down other Apps using Task Manager with no change. I have tried closing down a few Background Processes but I am not really sure what I should be closing, and I have not tried closing down any Windows Processes using Task Manager because I wasn't sure what might cause instability.</p>\n\n<p>I am using the following code to track my deltaTime in the console. I am implementing this code within the main loop (while !quit) of Lazy Foo's (<a href=\"https://lazyfoo.net/tutorials/SDL/\" rel=\"nofollow noreferrer\">https://lazyfoo.net/tutorials/SDL/</a>) tutorial #8. I added keyboard movement and VSYNC, but I do not think this is making a difference because I also tried the following deltaTime tracking code within his tutorial #2 and the lag time was the same (~60ms every ~3000ms).</p>\n\n<p>Note: I am only outputting deltaTime information if the deltaTime for that frame is over 10ms just to keep a clean console output. Before I did this it looked like most of my other deltaTimes were around 7ms.</p>\n\n<pre><code>// Initialize tracking variables at the top of the file\nUint64 NOW = SDL_GetPerformanceCounter();\nUint64 LAST = 0;\ndouble deltaTime = 0;\nint frameCounter = 0;\nint lastDeltaSpikeFrame = 0;\ndouble timeCounter = 0;\ndouble lastDeltaSpikeTime = 0;\n\n// Use them in the application loop\nwhile( !quit )\n{\n    LAST = NOW;\n    NOW = SDL_GetPerformanceCounter();\n    deltaTime = (double)((NOW - LAST) * 1000 / (double)SDL_GetPerformanceFrequency());\n\n    frameCounter++;\n    timeCounter += deltaTime;\n\n    if (deltaTime &gt; 10)\n    {\n        int frameChangeSinceLastSpike = frameCounter - lastDeltaSpikeFrame;\n\n        double timeChangeSinceLastSpike = timeCounter - lastDeltaSpikeTime;\n\n        printf(\"deltaTime = %f\\ntimeCounter = %f\\ntimeChangeSinceLastSpike = %f\\nframeCounter = %i\\nframeChangeSinceLastSpike = %i\\n\\n\\n\", deltaTime, timeCounter, timeChangeSinceLastSpike, frameCounter, frameChangeSinceLastSpike);\n\n        lastDeltaSpikeFrame = frameCounter;\n        lastDeltaSpikeTime = timeCounter;\n\n// Rest of the application code...\n</code></pre>\n\n<p>Here is the console output (past the 2nd frame, lag timing of ~60ms every ~3000ms becomes consistent):</p>\n\n<pre><code>deltaTime = 308.039800\ntimeCounter = 308.039800\ntimeChangeSinceLastSpike = 308.039800\nframeCounter = 1\nframeChangeSinceLastSpike = 1\n\n\ndeltaTime = 66.737300\ntimeCounter = 374.777100\ntimeChangeSinceLastSpike = 66.737300\nframeCounter = 2\nframeChangeSinceLastSpike = 1\n\n\ndeltaTime = 60.252300\ntimeCounter = 3369.369500\ntimeChangeSinceLastSpike = 2994.592400\nframeCounter = 426\nframeChangeSinceLastSpike = 424\n\n\ndeltaTime = 59.695400\ntimeCounter = 6368.786900\ntimeChangeSinceLastSpike = 2999.417400\nframeCounter = 851\nframeChangeSinceLastSpike = 425\n\n\ndeltaTime = 59.917200\ntimeCounter = 9369.138700\ntimeChangeSinceLastSpike = 3000.351800\nframeCounter = 1276\nframeChangeSinceLastSpike = 425\n\n\ndeltaTime = 60.112800\ntimeCounter = 12369.418100\ntimeChangeSinceLastSpike = 3000.279400\nframeCounter = 1701\nframeChangeSinceLastSpike = 425\n</code></pre>\n\n<p>... the lag time (60ms) occurs every ~3000 ms and exactly 425 frames beyond this point.</p>\n"}, {"tags": ["c#", "c++"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1562178922, "post_id": 56876091, "comment_id": 100300784, "body": "That&#39;s C++ not C, please don&#39;t add tags that aren&#39;t applicable."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562180629, "post_id": 56876091, "comment_id": 100301583, "body": "<code>CreateParserObject();</code> -- What is this function?  Is this C++ or C#?  Second, why are you passing the address of the object as the first argument?  Why aren&#39;t you just passing what was returned by <code>CreateParserObject</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11732987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a956e3b530d3426d2e4fb3077eef5a2e?s=128&d=identicon&r=PG&f=1", "display_name": "maazasif1995", "link": "https://stackoverflow.com/users/11732987/maazasif1995"}, "edited": false, "score": 0, "creation_date": 1562181986, "post_id": 56876650, "comment_id": 100302116, "body": "still the same error. access violation at some memory address"}, {"owner": {"reputation": 30138, "user_id": 71141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e1f5d1bd28627ad2f5a9b47ef63a2dc8?s=128&d=identicon&r=PG", "display_name": "Etienne de Martel", "link": "https://stackoverflow.com/users/71141/etienne-de-martel"}, "reply_to_user": {"reputation": 29, "user_id": 11732987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a956e3b530d3426d2e4fb3077eef5a2e?s=128&d=identicon&r=PG&f=1", "display_name": "maazasif1995", "link": "https://stackoverflow.com/users/11732987/maazasif1995"}, "edited": false, "score": 0, "creation_date": 1562182057, "post_id": 56876650, "comment_id": 100302135, "body": "Where is that happening? In the code, I mean. You have a debugger, right?"}, {"owner": {"reputation": 29, "user_id": 11732987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a956e3b530d3426d2e4fb3077eef5a2e?s=128&d=identicon&r=PG&f=1", "display_name": "maazasif1995", "link": "https://stackoverflow.com/users/11732987/maazasif1995"}, "edited": false, "score": 0, "creation_date": 1562182243, "post_id": 56876650, "comment_id": 100302212, "body": "i don&#39;t know if i can debug the code in the dll from visual studio. The error occurs when the function is called @ int result = ConvertSql(parserObj, inputStr, inputStr.Length, out output, out out_size, out lines);"}, {"owner": {"reputation": 30138, "user_id": 71141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e1f5d1bd28627ad2f5a9b47ef63a2dc8?s=128&d=identicon&r=PG", "display_name": "Etienne de Martel", "link": "https://stackoverflow.com/users/71141/etienne-de-martel"}, "reply_to_user": {"reputation": 29, "user_id": 11732987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a956e3b530d3426d2e4fb3077eef5a2e?s=128&d=identicon&r=PG&f=1", "display_name": "maazasif1995", "link": "https://stackoverflow.com/users/11732987/maazasif1995"}, "edited": false, "score": 0, "creation_date": 1562182434, "post_id": 56876650, "comment_id": 100302297, "body": "See <a href=\"https://stackoverflow.com/a/12517093/71141\">this answer</a> for more information, but if you have the DLL&#39;s debug symbols (the .pdb file), you should be able to if you enable unmanaged debugging."}, {"owner": {"reputation": 29, "user_id": 11732987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a956e3b530d3426d2e4fb3077eef5a2e?s=128&d=identicon&r=PG&f=1", "display_name": "maazasif1995", "link": "https://stackoverflow.com/users/11732987/maazasif1995"}, "edited": false, "score": 0, "creation_date": 1562240809, "post_id": 56876650, "comment_id": 100321447, "body": "dont have the pdb file. If the c# side of the process is all good, could it be that the dll im trying to use is either faulty or corrupt?"}, {"owner": {"reputation": 30138, "user_id": 71141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e1f5d1bd28627ad2f5a9b47ef63a2dc8?s=128&d=identicon&r=PG", "display_name": "Etienne de Martel", "link": "https://stackoverflow.com/users/71141/etienne-de-martel"}, "reply_to_user": {"reputation": 29, "user_id": 11732987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a956e3b530d3426d2e4fb3077eef5a2e?s=128&d=identicon&r=PG&f=1", "display_name": "maazasif1995", "link": "https://stackoverflow.com/users/11732987/maazasif1995"}, "edited": false, "score": 0, "creation_date": 1562249253, "post_id": 56876650, "comment_id": 100326229, "body": "The crash occurs in the unmanaged function when it tries to access a memory location. Which means, either we&#39;re not passing it the right parameters, or there&#39;s a bug in it. It would probably help to have the function&#39;s source, at least."}, {"owner": {"reputation": 29, "user_id": 11732987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a956e3b530d3426d2e4fb3077eef5a2e?s=128&d=identicon&r=PG&f=1", "display_name": "maazasif1995", "link": "https://stackoverflow.com/users/11732987/maazasif1995"}, "edited": false, "score": 0, "creation_date": 1562303516, "post_id": 56876650, "comment_id": 100339436, "body": "changed the size type to int and it started working."}, {"owner": {"reputation": 30138, "user_id": 71141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e1f5d1bd28627ad2f5a9b47ef63a2dc8?s=128&d=identicon&r=PG", "display_name": "Etienne de Martel", "link": "https://stackoverflow.com/users/71141/etienne-de-martel"}, "reply_to_user": {"reputation": 29, "user_id": 11732987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a956e3b530d3426d2e4fb3077eef5a2e?s=128&d=identicon&r=PG&f=1", "display_name": "maazasif1995", "link": "https://stackoverflow.com/users/11732987/maazasif1995"}, "edited": false, "score": 0, "creation_date": 1562333775, "post_id": 56876650, "comment_id": 100352960, "body": "That&#39;s weird, because it&#39;s an int64_t in the target function."}], "tags": [], "owner": {"reputation": 30138, "user_id": 71141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e1f5d1bd28627ad2f5a9b47ef63a2dc8?s=128&d=identicon&r=PG", "display_name": "Etienne de Martel", "link": "https://stackoverflow.com/users/71141/etienne-de-martel"}, "is_accepted": true, "score": 2, "last_activity_date": 1562181850, "last_edit_date": 1562181850, "creation_date": 1562181269, "answer_id": 56876650, "question_id": 56876091, "link": "https://stackoverflow.com/questions/56876091/access-violation-reading-location-when-passing-pointers-to-function-in-dll-writt/56876650#56876650", "title": "access violation reading location when passing pointers to function in DLL written in c", "body": "<p>In .NET, calling an unmanaged method through P/invoke (which is what happens when you call an <code>extern</code> method) involves various type conversions on the parameters, which is known as \"marshalling\" and is done automatically by a part of the runtime known as the \"marshaller\".</p>\n\n<p>In general, it's a terrible idea to marshal pointers. Instead, use the CLR marshaller's ability to convert certain types to pointers for you by changing the signature of your P/invoked method:</p>\n\n<pre><code>// split on multiple lines for readability\n[DllImport(\"PATHTODLLFOLDER\\\\sqlparser.dll\", EntryPoint = \"ConvertSql\", CallingConvention = CallingConvention.Cdecl)]\npublic static extern int ConvertSql(\n    IntPtr parser, \n    [MarshalAs(UnmanagedType.LPStr)] string input,\n    long size, \n    out IntPtr output, // see explanation below\n    out long out_size, \n    out long lines);\n</code></pre>\n\n<p>A few things about the above. First, I took the liberty of using the C# type aliases (string, long), because that's more idiomatic C#, but it doesn't change the behavior. Also, since there are no pointers anymore, no need for <code>unsafe</code>.</p>\n\n<p>First, I declared <code>parser</code> as an <code>IntPtr</code> because those get converted to <code>void*</code> automatically if needed and that's what's already returned by <code>CreateParserObject()</code> anyway.</p>\n\n<p>Second, out parameters can be converted to pointers to uninitialized objects, so by marking both <code>out_size</code> and <code>lines</code> as <code>out</code>, you fix that other problem.</p>\n\n<p>The <code>input</code> is a string, which has a specific format in .NET. Since your function takes a <code>const char*</code>, you need to tell the marshaller how to convert the characters. That's where the <code>MarshalAs</code> attribute comes in: it's when the default conversion doesn't work for you. <code>UnmanagedType.LPStr</code> means <code>char*</code> in this case, so the string gets converted. The runtime will manage the memory for you.</p>\n\n<p>But here we hit a big snag in the road: the output. When marshalling things, there's always questions about lifetime, or, specifically: who releases the memory? The fact that <code>output</code> is a <code>char**</code> implies that the parser allocates a block of memory and then returns it through that, which means the caller has to release it. From the get go, that reeks of bad C++ design because the caller doesn't know how the memory was allocated. Was it with <code>malloc</code>? <code>new[]</code>? Platform specific APIs like <code>LocalAlloc</code>? Is it a pointer to a block of static memory? Usually these APIs come with documentation telling precisely what to do with the pointer once you're done with it. Good C++ APIs return smart pointers, or ask that the caller pass a block of previously allocated memory that they can then play with.</p>\n\n<p>But, this is the thing you're playing with, so here's how to make it work. First, you'd think that you could declare <code>output</code> as <code>[MarshalAs(UnmanagedType.LPStr)] out string</code>: the marshaller will copy the characters into a managed string and return it... but then the native string's (on the C++ side) memory will leak because the runtime doesn't know how the string was allocated, so it prefers to not do anything about it. Also, this assumes the string is null-terminated, which might not always be the case.</p>\n\n<p>So, another option would be to instead declare <code>output</code> as <code>out IntPtr</code>. Then you can use <code>Marshal.PtrToStringAnsi</code> to convert your pointer into a string, and then release it... but you'll need to know how it was allocated first.</p>\n\n<p>Putting it all together:</p>\n\n<pre><code>var parserObj = CreateParserObject();\n\nvar output = IntPtr.Zero;\ntry\n{\n    long lines;\n    long out_size;\n    int result = ConvertSql(parserObj, inputStr, inputStr.Length, out output, out out_size, out lines);\n\n    var outputStr = Marshal.PtrToStringAnsi(output, (int)out_size);\n    // do what you want with outputStr here\n}\nfinally\n{\n    if (output != IntPtr.Zero)\n    {\n        // release output here\n    }\n}\n</code></pre>\n\n<p>Oh, also, one final thought: whatever is returned by <code>CreateParserObject()</code> will probably have to be freed at one point. You're probably going to need another function for it, probably like:</p>\n\n<pre><code>[DllImport(/* ... */)]\npublic static extern void DestroyParserObject(IntPtr parserObject);\n</code></pre>\n\n<p>It might even already exist in your DLL.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 29, "user_id": 11732987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a956e3b530d3426d2e4fb3077eef5a2e?s=128&d=identicon&r=PG&f=1", "display_name": "maazasif1995", "link": "https://stackoverflow.com/users/11732987/maazasif1995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 56876650, "answer_count": 1, "score": -1, "last_activity_date": 1562181850, "creation_date": 1562178701, "last_edit_date": 1562179434, "question_id": 56876091, "link": "https://stackoverflow.com/questions/56876091/access-violation-reading-location-when-passing-pointers-to-function-in-dll-writt", "title": "access violation reading location when passing pointers to function in DLL written in c", "body": "<p>I am trying to call a function that converts sql queries between dialects. I am using an open-source project's DLL to use the functions for conversion in a C# university project. The problem i am facing is that i am getting a access violation reading location.</p>\n\n<p>I've read some posts here on stack overflow which suggest that there might be a bad pointer somewhere, but i cannot find where. My pointers are not corrupt </p>\n\n<p>The function for the conversion is this :</p>\n\n<pre><code>       int ConvertSql(void *parser, const char *input, int64_t size, const char \n       **output, int64_t *out_size, int64_t *lines)\n        {\n            if(parser == NULL)\n                return -1;\n\n            SqlParser *sql_parser = (SqlParser*)parser;\n\n            // Run conversion\n            sql_parser-&gt;Convert(input, size, output, out_size, lines);\n\n            return 0;\n        }\n</code></pre>\n\n<p>I am calling the function in C# </p>\n\n<pre><code>                        char *parentInput;\n                        fixed(char *input = &amp;inputStr.ToCharArray()[0])\n                        {\n                            parentInput = input;\n                        }\n\n                        char** output = null;\n                        Int64 out_size = 0;\n                        Int64 lines = 0;\n                        Int64 size = inputStr.Length;\n                        Console.WriteLine(new IntPtr(&amp;out_size)+\"  \"+ new IntPtr(&amp;lines)+\"  \"+new IntPtr(&amp;parserObj)+\"   \"+new IntPtr(output));\n                        int result = ConvertSql(&amp;parserObj, intputStr, size, output, &amp;out_size, &amp;lines);\n</code></pre>\n\n<p>i get my parser object from this code which works without errors:</p>\n\n<pre><code>IntPtr parserObj = CreateParserObject();\n</code></pre>\n\n<p>the dllimport for the funtions are using this code:</p>\n\n<pre><code>[DllImport(dllName: \"PATHTODLLFOLDER\\\\sqlparser.dll\", EntryPoint = \"CreateParserObject\", CallingConvention = CallingConvention.Cdecl)]\npublic static extern IntPtr CreateParserObject();\n</code></pre>\n\n<pre><code>[DllImport(dllName: \"PATHTODLLFOLDER\\\\sqlparser.dll\", EntryPoint = \"ConvertSql\", CallingConvention = CallingConvention.Cdecl)]\npublic unsafe static extern int ConvertSql(void *parser, String input, Int64 size, char **output, Int64 *out_size, Int64 *lines);\n</code></pre>\n"}, {"tags": ["c++", "vector", "destructor"], "comments": [{"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1562178140, "post_id": 56875942, "comment_id": 100300443, "body": "<a href=\"http://www.cplusplus.com/reference/vector/vector/shrink_to_fit/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/vector/vector/shrink_to_fit</a>"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 5, "creation_date": 1562178162, "post_id": 56875942, "comment_id": 100300453, "body": "You have <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">nasal demons</a>."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 5, "creation_date": 1562178205, "post_id": 56875942, "comment_id": 100300474, "body": "&quot;My drivers license was revoked, but I can still get in a car and drive it.  Why?&quot;"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1562178262, "post_id": 56875942, "comment_id": 100300506, "body": "As hinted by Fred, you just invoke undefined behaviour. If you turn on diagnostic mode for your standard library, it would tell you that you are accessing a vector out of bounds."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1562178269, "post_id": 56875942, "comment_id": 100300508, "body": "This doesn&#39;t address the question, but <code>writeMat</code> should take its argument as a <code>const&amp;</code>, not a plain <code>&amp;</code>. That way it&#39;s clearer that <code>writeMat</code> doesn&#39;t modify the argument."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1562178440, "post_id": 56875942, "comment_id": 100300584, "body": "&quot;I would expect that...&quot;  Why would you expect that?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1562178482, "post_id": 56875942, "comment_id": 100300597, "body": "<i>&quot;I would expect that calling b[0].size() after calling b.clear() would result in a core dump&quot;</i> Accessing an element out of bounds is Undefined Behavior. It&#39;s not required to crash, anything can happen. For example, an <code>std::vector</code> doesn&#39;t release it&#39;s memory when <code>clear</code>ed and an implementation could just set it&#39;s size member to zero and destructs it&#39;s elements will not touch the pointer to the data. Since <code>operator[]</code> isn&#39;t required to check bounds, your operation may just be reading from memory your process has access to but that doesn&#39;t contain any object."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1562178588, "post_id": 56875942, "comment_id": 100300644, "body": "<i>I would expect that calling b[0].size() after calling b.clear() would result in a core dump</i> -- &quot;I would expect that getting in a car and driving without a valid license would have a policeman show up and stop me immediately&quot;.  I like these analogies."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1562179706, "post_id": 56875942, "comment_id": 100301136, "body": "@PaulMcKenzie Another option is you drive through the woods, and won&#39;t meet a p&#39;lice officer lurking at the highway."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1562179821, "post_id": 56875942, "comment_id": 100301199, "body": "BTW, your program when run under Visual Studio will show a &quot;debug assertion&quot; dialog when run under the debug runtime and stops right there when you access the vector.  On the other hand, when run under the non-debug / release runtime, the program gives the impression of running &quot;ok&quot;.  That is an example of undefined behavior right there."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1562180260, "post_id": 56875942, "comment_id": 100301413, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6  -- Yes, sometimes it&#39;s simpler to get the point of &quot;undefined behavior&quot; across by coming up with real life scenarios."}, {"owner": {"reputation": 201, "user_id": 2980771, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6c854ca2d19cf0fd4ba29c59a8ae877b?s=128&d=identicon&r=PG&f=1", "display_name": "gleedadswell", "link": "https://stackoverflow.com/users/2980771/gleedadswell"}, "edited": false, "score": 0, "creation_date": 1562268238, "post_id": 56875942, "comment_id": 100333144, "body": "OK, but none of these answers really address the question that I posed.  Perhaps the question was buried at the end of too much other stuff.  I understand that this is undefined behaviour.  I understand that I am accessing an array out of bounds.  The latter is why I would expect a core dump.  But my question was, more or less, &quot;Why doesn&#39;t the destructor get called on vectors that are the elements of this vector of vectors?&quot;  I&#39;ll edit the question and put that right up front."}, {"owner": {"reputation": 5258, "user_id": 1722025, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aS04m.jpg?s=128&g=1", "display_name": "asimes", "link": "https://stackoverflow.com/users/1722025/asimes"}, "edited": false, "score": 0, "creation_date": 1562271817, "post_id": 56875942, "comment_id": 100334049, "body": "@gleedadswell, The correct answer is that this is undefined behavior but let&#39;s ignore that for a second. The vector is more or less a wrapper around some elements and you can think of the elements as just some bytes in memory somewhere. When the vector is cleared there is no requirement to alter that memory, the size just has to report 0. If nothing else changes that memory, you interpret the memory to still be a valid element, and you use a method of that element then it might behave as if it were still valid"}, {"owner": {"reputation": 201, "user_id": 2980771, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6c854ca2d19cf0fd4ba29c59a8ae877b?s=128&d=identicon&r=PG&f=1", "display_name": "gleedadswell", "link": "https://stackoverflow.com/users/2980771/gleedadswell"}, "edited": false, "score": 0, "creation_date": 1562357900, "post_id": 56875942, "comment_id": 100362118, "body": "Edited to clarify the question.  I do not feel it is a duplicate and have explained why.  I understand that the vector is a wrapper around some elements.  But my question is about why the destructors are not called when the elements are themselves vectors.  Or are they?  Am I misunderstanding what the effect of the destructors being called would be?  Nobody has yet addressed my main question which is about why the destructors are not called.  They would be called if the elements of the vectors were &quot;ordinary objects&quot;.  Why are they not called when the elements are vectors?"}], "owner": {"reputation": 201, "user_id": 2980771, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6c854ca2d19cf0fd4ba29c59a8ae877b?s=128&d=identicon&r=PG&f=1", "display_name": "gleedadswell", "link": "https://stackoverflow.com/users/2980771/gleedadswell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "closed_date": 1562178351, "answer_count": 0, "score": 0, "last_activity_date": 1562357558, "creation_date": 1562177960, "last_edit_date": 1562357558, "question_id": 56875942, "link": "https://stackoverflow.com/questions/56875942/c-clearing-a-vector-of-vectors-seems-to-leave-the-vector-elements-in-place", "closed_reason": "Duplicate", "title": "c++: clearing a vector of vectors seems to leave the vector elements in place", "body": "<p>This got marked as a duplicate because it was claimed that it is already answered <a href=\"https://stackoverflow.com/questions/1930459/c-delete-it-deletes-my-objects-but-i-can-still-access-the-data\">here</a>.  I don't feel that my question is answered at all there since that post doesn't deal with vectors or similar containers at all.  None of the comments on my question answer it either.  So, on the theory that I buried my question too deep I'll put it right up front before my example.  </p>\n\n<p>When we invoke .clear() on a vector it calls the destructor on each element of the vector.  The \"well known\" exception is when it is a vector of pointers.  My example below suggests that when we .clear() a vector of vectors the destructor apparently doesn't get called on the vectors that are its elements, since I can still access them afterwards.  Why?  In what way is a vector \"kind of like\" a pointer so that the destructor does not get called on it?</p>\n\n<p>To be clear about a few things: </p>\n\n<ul>\n<li><p>I know a vector is not a pointer.  But I'm rather unclear about what\nthe \"guts\" of a vector really look like, which is probably why I\ndon't understand this.   </p></li>\n<li><p>Also, I know this is undefined behaviour. \nMy question is, why is it undefined?  I would have hoped that this\nwould have led to explicit errors, not undefined behaviour.  I\ngenerally hope that when I do something stupid the programming\nlanguage should kick me in the butt.  Here C++ is failing to punish\nme for doing something very dumb, and I'm curious about why.  (Yes, I\nknow the makers of the C++ standard can't predict every foolish thing\na programmer like me might do, and it is our responsibility to not be\nfoolish.  But the continued accessibility of these vectors after a\n<code>.clear()</code> is pretty counterintuitive.)</p></li>\n</ul>\n\n<p>It came up because of unexpected behaviour in a very long program and I traced the problem to this.  I fixed it, but am still puzzled by why that program failed subtly rather than spectacularly.</p>\n\n<p>OK, here's the original question:</p>\n\n<hr>\n\n<p>There are a couple of other questions here related to this such as <a href=\"https://stackoverflow.com/questions/43026653/clear-vector-of-vectors-effectively-c\">this one</a> and <a href=\"https://stackoverflow.com/questions/12529654/why-clear-used-on-vector-of-vectors-doesnt-clear-the-values-of-those-vectors\">this one</a> but I don't think they quite address the issue I'm wondering about.  My understanding is that calling clear on a vector calls the destructor on each element of the vector (but see below for an exception to this).  So, with a vector of vectors I would have assumed that the destructor would be called on each vector within the vector of vectors.  That appears to be incorrect.  I know several ways to write my code to deal with it.  But I'm still a bit puzzled by the behaviour.  This code shows the behaviour:</p>\n\n<pre><code>using namespace std;\n\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\n\nvoid writeMat(vector&lt;vector&lt;double&gt;&gt; &amp;vec);\n\nint main()\n{\n  vector&lt;vector&lt;double&gt;&gt; b;\n\n  writeMat(b);\n\n  // Trying to get b[0].size() here results in a core dump, as expected.\n\n  vector&lt;double&gt; btry1 = {1.0, 2.0};\n  vector&lt;double&gt; btry2 = {3.0, 4.0};\n\n  b.push_back(btry1);\n  b.push_back(btry2);\n\n  cout &lt;&lt; \"Added some stuff to the vector.\" &lt;&lt; endl;\n  writeMat(b);\n\n  b.clear();\n  cout &lt;&lt; \"Cleared the vector.  Now it is: \" &lt;&lt; endl;\n  writeMat(b);\n\n  cout &lt;&lt; \"But final check...  b.size() = \" &lt;&lt; b.size() &lt;&lt; \" and b[0].size() = \" &lt;&lt; b[0].size() &lt;&lt; endl;\n\n  return 0;\n}\n\n\nvoid writeMat(vector&lt;vector&lt;double&gt;&gt; &amp;vec)\n{\n  cout &lt;&lt; \"vec.size() = \" &lt;&lt; vec.size() &lt;&lt; endl;\n  for (int i = 0; i &lt; vec.size(); i++)\n    {\n      cout &lt;&lt; \"vec[\" &lt;&lt; i &lt;&lt; \"].size() = \" &lt;&lt; (vec[0]).size() &lt;&lt; endl;\n    }\n\n  cout &lt;&lt; \"vec is: \" &lt;&lt; endl &lt;&lt; \"--------------------\" &lt;&lt; endl;\n  for (int i = 0; i &lt; vec.size(); i++)\n    {\n      for (int j = 0; j &lt; vec[i].size(); j++)\n    {\n      cout &lt;&lt; vec[i][j] &lt;&lt; \"  \";\n    }\n      cout &lt;&lt; endl;\n    }\n  cout &lt;&lt; \"--------------------\" &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Generates output:</p>\n\n<pre><code>vec.size() = 0\nvec is: \n--------------------\n--------------------\nAdded some stuff to the vector.\nvec.size() = 2\nvec[0].size() = 2\nvec[1].size() = 2\nvec is: \n--------------------\n1  2  \n3  4  \n--------------------\nCleared the vector.  Now it is: \nvec.size() = 0\nvec is: \n--------------------\n--------------------\nBut final check...  b.size() = 0 and b[0].size() = 2\n</code></pre>\n\n<p>I would expect that calling <code>b[0].size()</code> after calling <code>b.clear()</code> would result in a core dump just like it would if I called it before any elements had been added to b.  But instead it returns the value 2, which suggests that although <code>b.size()</code> is now zero, <code>b[0]</code> is still hanging around in memory.  Indeed, modifying the above code I find that after <code>b.clear()</code>, it will still report, for example, that <code>b[0][1]</code> is 2.</p>\n\n<p>I see <a href=\"https://stackoverflow.com/questions/12068950/c-destructors-with-vectors-pointers\">here</a> that for a vector like <code>vector&lt;MyClass&gt;</code>, the destructor gets called on each element of the vector when <code>clear()</code> is called but for a vector of pointers like <code>vector&lt;MyClass*&gt;</code> it does not.  So I guess a vector is \"more similar\" to a pointer in some way than it is to an object.  It has never been very clear to me what containers like vector are in relation to more primitive types.  I think of a vector as as an old style array (not std::array, an old array like we would have used in C, 20 years ago...) with a rather thin wrapper of methods to make it friendlier.  But that can't be quite right because passing a pointer to a vector has a very different effect from passing a pointer to an array.</p>\n\n<p>So, I guess my question is roughly this: A vector is not a pointer.  But when clearing a vector of vectors the behaviour seems to be similar to clearing a vector of pointers.  So what is the similarity that causes this behaviour?  I realize that this is likely to get into the nitty gritty of what the block of memory set aside for a vector will look like as opposed to what the block of memory set aside for an array would look like.</p>\n\n<p>It occurs to me that this <em>might</em> be specific to the implementation of C++.  I'm using g++ in a Linux OS.</p>\n"}, {"tags": ["javascript", "c++", "websocket", "poco-libraries"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562190062, "post_id": 56875920, "comment_id": 100305103, "body": "I see your server <i>preparing</i> a response, but where is it actually being <i>sent</i> back to the client? Chrome is very clear in saying that no response is being received."}, {"owner": {"reputation": 113, "user_id": 10598247, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0eyBjNxK1Uo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBzmk-C3WfTzBcSVt4MFJljKiIh9A/mo/photo.jpg?sz=128", "display_name": "Joseph Summerhays", "link": "https://stackoverflow.com/users/10598247/joseph-summerhays"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562195789, "post_id": 56875920, "comment_id": 100306402, "body": "@RemyLebeau Well that&#39;s the funny part. The error says no response was received, but the network tab shows a 101 response from the server. The response comes from the <a href=\"https://pocoproject.org/docs/Poco.Net.WebSocket.html\" rel=\"nofollow noreferrer\">WebSocket Constructor</a>.  It &quot;completes the handshake by sending a proper 101 response.&quot;"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562197911, "post_id": 56875920, "comment_id": 100306789, "body": "But the screenshot you provided does not show any response headers. So it is difficult for people here to validate what you are seeing."}, {"owner": {"reputation": 113, "user_id": 10598247, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0eyBjNxK1Uo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBzmk-C3WfTzBcSVt4MFJljKiIh9A/mo/photo.jpg?sz=128", "display_name": "Joseph Summerhays", "link": "https://stackoverflow.com/users/10598247/joseph-summerhays"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562249189, "post_id": 56875920, "comment_id": 100326203, "body": "You are indeed correct. Let me add another screen shot. Thanks!"}], "owner": {"reputation": 113, "user_id": 10598247, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0eyBjNxK1Uo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBzmk-C3WfTzBcSVt4MFJljKiIh9A/mo/photo.jpg?sz=128", "display_name": "Joseph Summerhays", "link": "https://stackoverflow.com/users/10598247/joseph-summerhays"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 940, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562249617, "creation_date": 1562177859, "last_edit_date": 1562249617, "question_id": 56875920, "link": "https://stackoverflow.com/questions/56875920/why-does-firefox-say-it-can-t-establish-a-connection-to-the-server-at-ws-loca", "title": "Why does Firefox say it &quot;can\u2019t establish a connection to the server at ws://localhost:3000/&quot; after successful return upgrade request?", "body": "<p>I wrote a program in c++ to upgrade an HTTP session to a WebSocket. The server correctly receives the upgrade request, and responds with 101 switching protocols. Firefox receives the 101 response, but in the console claims it couldn't connect. Here's the full output in Firefox.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Az4uH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Az4uH.png\" alt=\"Firefox can\u2019t establish a connection to the server at ws://localhost:3000/.\"></a></p>\n\n<p>The interesting thing is, in the network tab you can see the 101 response come in so it did establish an HTTP connection, the server got it, accepted it, tried to upgrade, and sent an upgrade response, but it's at that point that firefox doesn't upgrade to a WebSocket and prints the error.<a href=\"https://i.stack.imgur.com/wWQSc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wWQSc.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried in Google Chrome as well. Similar error, but a bit more detail. <code>WebSocket connection to 'ws://localhost:3000/' failed: Error during WebSocket handshake: Sent non-empty 'Sec-WebSocket-Protocol' header but no response was received</code></p>\n\n<p>My code c++ hangs on the while loop, no errors thrown, which I think means it thinks the connection is still working?</p>\n\n<p>I did notice it's sending Sec-Websocket-Protocol, even though I only asked for <code>ws</code>, not <code>wss</code>. Do chrome and firefox disallow non secure websockets? Or am I missing something in my code?</p>\n\n<p>C++:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#define PORT (unsigned short) 3000\n#define MAX_BUF 2048\n\nint main()\n{\n    Poco::Net::ServerSocket x(PORT);\n    Poco::Timespan timeout(25000000);\n    if (x.poll(timeout, 1)) {\n        Poco::Net::StreamSocket ss = x.acceptConnection();\n        Poco::AutoPtr&lt;Poco::Net::HTTPServerParams&gt; params = new Poco::Net::HTTPServerParams();\n        Poco::Net::HTTPServerSession sess(ss,params);\n        Poco::Net::HTTPServerResponseImpl res(sess);\n        Poco::Net::HTTPServerRequestImpl req(res, sess, params);\n        if (req.getMethod()==\"GET\" &amp;&amp; req.get(\"Upgrade\")==\"websocket\") {\n            Poco::Net::WebSocket webSock(req,res);\n            while (!webSock.available());\n            char buf[MAX_BUF];\n            memset(buf,0,MAX_BUF);\n            int flags = 0;\n            webSock.sendFrame(\"Hello, World!\\n\",15);\n            webSock.receiveFrame(buf,MAX_BUF,flags);\n            printf(\"received %s\\n\",buf);\n        }\n    }\n    else {\n        printf(\"Timeout!\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Javascript:</p>\n\n<pre><code>$(document).ready(function() {\n    webSoc = new WebSocket(\"ws://localhost:3000\");\n    webSoc.onopen = function (event) {\n        $(\"#c\").click(function () {\n            console.log(\"Sending 'Hello, World!'\");\n            webSoc.send(\"Hello, World!\\n\");\n        });\n    }\n});\n</code></pre>\n\n<p>I've tried <code>new WebSocket(\"ws://localhost:3000\")</code> with and without the <code>echo-protocol</code> parameter, because I read it in an answer to a question I didn't understand, which I can't find now. </p>\n"}, {"tags": ["python", "c++", "json", "enums", "maps"], "comments": [{"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1562177804, "post_id": 56875729, "comment_id": 100300313, "body": "Why do you need to generate C++ code from python?  It seems like it would make more sense to either do all of your processing in python or use one of the many available JSON libraries for C++ and do all of your processing there."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 11673103, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T0bgE5EUZjY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1xBML98s-ZBNvp5vCa8FHp2gY3A/mo/photo.jpg?sz=128", "display_name": "Mikan", "link": "https://stackoverflow.com/users/11673103/mikan"}, "edited": false, "score": 0, "creation_date": 1562178597, "post_id": 56875952, "comment_id": 100300649, "body": "Hi I cannot have any outside-server dependency. (So cannot use rapid json). Even if I transforme JSON file into simpler format, don&#39;t I still need to create some find of data structure, such as a map, to get key-value pairs?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 79, "user_id": 11673103, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T0bgE5EUZjY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1xBML98s-ZBNvp5vCa8FHp2gY3A/mo/photo.jpg?sz=128", "display_name": "Mikan", "link": "https://stackoverflow.com/users/11673103/mikan"}, "edited": false, "score": 0, "creation_date": 1562180257, "post_id": 56875952, "comment_id": 100301411, "body": "&quot;<i>I cannot have any outside-server dependency</i>&quot; - @Anaguone Downloading rapidjson or nlohmann/json doesn&#39;t add such a dependency. You download it once and can then cut the internet cable if you&#39;d like."}, {"owner": {"reputation": 79, "user_id": 11673103, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T0bgE5EUZjY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1xBML98s-ZBNvp5vCa8FHp2gY3A/mo/photo.jpg?sz=128", "display_name": "Mikan", "link": "https://stackoverflow.com/users/11673103/mikan"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562181539, "post_id": 56875952, "comment_id": 100301955, "body": "@TedLyngmo, By above line, I meant I cannot download anything into the server I am working in."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562182440, "post_id": 56875952, "comment_id": 100302300, "body": "Why? It&#39;s only text files. If the person who put that restriction in place is willing to rethink, you&#39;d solve this in no-time. What libraries are already installed on the server you are talking about? You may already have a JSON lib pre-installed. If not, do as Antonio suggested and transform the json data into a simple file format that you can then create a parser for in C++."}, {"owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "reply_to_user": {"reputation": 79, "user_id": 11673103, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T0bgE5EUZjY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1xBML98s-ZBNvp5vCa8FHp2gY3A/mo/photo.jpg?sz=128", "display_name": "Mikan", "link": "https://stackoverflow.com/users/11673103/mikan"}, "edited": false, "score": 0, "creation_date": 1562190795, "post_id": 56875952, "comment_id": 100305311, "body": "@Mikan I updated the post to give an example of how one might write or read maps to and from a very simple file format."}], "tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": false, "score": 1, "last_activity_date": 1562191421, "last_edit_date": 1562191421, "creation_date": 1562178013, "answer_id": 56875952, "question_id": 56875729, "link": "https://stackoverflow.com/questions/56875729/how-to-efficiently-create-and-compile-large-map-in-c/56875952#56875952", "title": "How to efficiently create and compile large map in c++", "body": "<p>You should definitely NOT be auto-generating C++ code that hard-codes a map like that. There are libraries to read json files directly into C++ (see <a href=\"http://rapidjson.org/\" rel=\"nofollow noreferrer\">rapid json</a> for example), and these should be used instead. The code will compile much faster, and the amount of time it takes to read in 20,000 files should be on the order of a few milliseconds (instead of the >5 minutes it's taking to compile). </p>\n\n<p>If you want to avoid adding a dependency on a json parser in your C++ code, I recommend transforming the JSON file into a simpler format that's easier to read with C++. </p>\n\n<h2>A very very simple format to read and write maps from files</h2>\n\n<p>Let's take a simple map:</p>\n\n<pre><code>map&lt;string, map&lt;string, string&gt;&gt; test_map {\n    {\"Hello\", {\n        {\"A\", \"B\"}, \n        {\"C\", \"D\"}}},\n    {\"World\", {\n        {\"Blarg\", \"glug glug glug\"}, \n        {\"idek what to put here\", \"felt cute might delete later\"}}}}; \n</code></pre>\n\n<p>We're going to write it to a file using a very simple format. Strings will be written as <code>&lt;string length&gt; &lt;string text&gt;</code>, and maps will be written as <code>&lt;map length&gt; &lt;map key-value pairs&gt;</code>. So, for example, <code>\"Hello world\"</code> would be written as <code>11 Hello world</code>. For the above map, the corresponding file is</p>\n\n<pre><code>2 5 Hello2 1 A1 B1 C1 D5 World2 5 Blarg14 glug glug glug21 idek what to put here28 felt cute might delete later\n</code></pre>\n\n<p>You have the 2, which means that the top level map has 2 elements. This is followed by a 5, which means that the first key has 5 characters in it. This is followed by the keys and values of the first map, etc. </p>\n\n<h3>Writing maps to a file in this format</h3>\n\n<p>Because the format is so simple, this is also very simple to do. </p>\n\n<pre><code>namespace output {\n    using std::map; \n    using std::string; \n    void write(FILE* file, string const&amp; str) {\n        // Write the length of the string, followed by a space\n        fprintf(file, \"%lu \", str.size());\n\n        // Write the string itself\n        fwrite(str.data(), 1, str.size(), file);  \n    }\n\n    template&lt;class Key, class Value&gt;\n    void write(FILE* file, map&lt;Key, Value&gt; const&amp; m) {\n        // Write the length of the map, followed by a space\n        fprintf(file, \"%lu \", m.size()); \n\n        for(auto&amp; entry : m) {\n            // Write the key\n            write(file, entry.first);\n\n            // Write the value\n            write(file, entry.second); \n        }\n    }\n}\n</code></pre>\n\n<h3>Reading maps from a file</h3>\n\n<p>This is also very simple to do. To read a string, for example, we read the length, and then we read all the characters. </p>\n\n<pre><code>namespace input {\n    using std::map;\n    using std::string; \n\n    void read(FILE* file, size_t&amp; length) {\n        int result = fscanf(file, \"%lu \", &amp;length);\n        if(result &lt; 0) throw std::logic_error(\"Couldn't read from file\"); \n    }\n\n    void read(FILE* file, string&amp; str) {\n\n        size_t length;      // Read the length\n        read(file, length); \n\n        str.resize(length); \n        size_t n_read = fread(&amp;str[0], 1, length, file); // Read the characters\n\n        if(n_read != length) { // Handle errors\n            throw std::logic_error(\"Unable to read entirety of string from file\"); \n        }\n    }\n\n    template&lt;class Key, class Value&gt;\n    void read(FILE* file, map&lt;Key, Value&gt;&amp; text) {\n        size_t length;      // Read the length of the map\n        read(file, length); \n        text.clear(); \n\n        for(size_t i = 0; i &lt; length; i++) {\n            Key key;\n            read(file, key);        // Read the key\n            read(file, text[key]);  // Read the value\n        }\n    }\n}\n</code></pre>\n\n<h3>Using this code</h3>\n\n<p>To write a map:</p>\n\n<pre><code>void write_map(string file, map&lt;string, map&lt;string, string&gt;&gt; test_map) {\n    auto output_file = fopen(file.c_str(), \"w\"); \n    output::write(output_file, test_map); \n    fclose(output_file); \n}\n</code></pre>\n\n<p>To read a map:</p>\n\n<pre><code>map&lt;string, map&lt;string, string&gt;&gt; read_map(string file) {\n    auto input_file = fopen(file.c_str(), \"r\"); \n    map&lt;string, map&lt;string, string&gt;&gt; m;\n    input::read(file, m); \n    fclose(input_file); \n    return m; \n}\n</code></pre>\n\n<h3>Testing this code</h3>\n\n<p><a href=\"https://godbolt.org/z/U7-q4Y\" rel=\"nofollow noreferrer\"><strong>You can see a live demonstration here</strong></a> </p>\n\n<p>This main function will write a test map to a file, then read it back into a different map, then compare the two. </p>\n\n<pre><code>int main() {\n    using std::map; \n    using std::string; \n    map&lt;string, map&lt;string, string&gt;&gt; test_map {\n        {\"Hello\", {{\"A\", \"B\"}, {\"C\", \"D\"}}},\n        {\"World\", {{\"Blarg\", \"glug glug glug\"}, {\"idek what to put here\", \"felt cute might delete later\"}}}\n    }; \n\n    {\n        auto output_file = fopen(\"example.txt\", \"w\"); \n        output::write(output_file, test_map); \n        fclose(output_file); \n    }\n    map&lt;string, map&lt;string, string&gt;&gt; map_from_file; \n    {\n        auto input_file = fopen(\"example.txt\", \"r\");\n        try {\n            input::read(input_file, map_from_file); \n        } catch(std::logic_error&amp; err) {\n            std::cerr &lt;&lt; \"Reading example.txt failed: \" &lt;&lt; err.what() &lt;&lt; '\\n'; \n        }\n        fclose(input_file);  \n    }\n\n    std::cout &lt;&lt; std::boolalpha &lt;&lt; \"Maps equivilant? \" &lt;&lt; (test_map == map_from_file) &lt;&lt; '\\n'; \n\n\n    for(auto pair : map_from_file) {\n        std::cout &lt;&lt; '\"' &lt;&lt; pair.first &lt;&lt; \"\\\" -&gt; {\\n\"; \n        for(auto kv : pair.second) {\n            std::cout &lt;&lt; \"  \\\"\" &lt;&lt; kv.first &lt;&lt; \"\\\" -&gt; \\\"\" &lt;&lt; kv.second &lt;&lt; '\"' &lt;&lt; \"\\n\"; \n        }\n        std::cout &lt;&lt; \"}\\n\"; \n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 11673103, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T0bgE5EUZjY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1xBML98s-ZBNvp5vCa8FHp2gY3A/mo/photo.jpg?sz=128", "display_name": "Mikan", "link": "https://stackoverflow.com/users/11673103/mikan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562613431, "creation_date": 1562176996, "last_edit_date": 1562613431, "question_id": 56875729, "link": "https://stackoverflow.com/questions/56875729/how-to-efficiently-create-and-compile-large-map-in-c", "title": "How to efficiently create and compile large map in c++", "body": "<p>Currently, I have multiple json files and a python code which reads one of the json file, main.json, and creates a full c++ code based off of the json file. Within the main() of that c++, I need to convert a number output to a string using numberToString.json. I cannot find a way to successfully compile the c++ code in time (&lt;1 minute)</p>\n\n<p>I created a nested map \"std::map&lt; std::string, std::map&lt; std::string, std::string>> enumMap\" in c++ file and populated with all the values from numberToString.json (~20,000 values), but the code does not compile in time (I shut it down after ~5 minutes. CMAKE uses gcc 4.8.5 to compile.)</p>\n\n<p>Example code:</p>\n\n<pre><code>main.json\n    {\"example\" : {\n       \"FRUIT\" : \"ex_fruit\"\n    }, \n    ...\n    }}\n</code></pre>\n\n<pre><code>numberToString.json\n    {\"FRUIT\" : {\n       \"1\" : \"fresh\",\n       ...,\n       \"10\" : \"not fresh\"\n    },\n    ...\n    }}\n</code></pre>\n\n<pre><code>someHeader.h\n    typedef struct FRUIT\n    {\n       int     val;\n    };\n\n    typedef struct Example\n    {\n       FRUIT   ex_fruit;\n    };\n</code></pre>\n\n<pre><code>python.py\n    def someFunc(typename) \n    //input is struct name in string ex.\"Example\"\n       \"already implemented\"\n       return memberVariables\n       //returns member variable accessors\n\n    print \"#include \\\"someHeader.h\\\"\"\n    print \"int main() {\"\n    print \"   Example ex = {1};\"\n    print \"   printf(%s, %s);\" %(\"%s\", someFunc(\"Example\")\n    print \"return 0;\"\n    print \"}\"\n</code></pre>\n\n<pre><code>pythonOutput.cxx\n    #include \"someHeader.h\"\n    int main() {\n       Example ex = {1};\n       printf(%s, ***ex.ex_fruit.val***);\n       return 0;\n    }\n</code></pre>\n\n<p>So on pythonOutput.cxx, I need <strong><em>ex.ex_fruit.val</em></strong>, which is 1, to come out as <strong><em>\"fresh\"</em></strong> by using numberToString.json.</p>\n\n<p>I am using python 2.7 </p>\n"}, {"tags": ["c++", "c++11", "variadic-templates"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1562176745, "post_id": 56875637, "comment_id": 100299852, "body": "Because without a primary template we cannot write a specialization"}, {"owner": {"reputation": 2145, "user_id": 1557062, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/1UPQG.jpg?s=128&g=1", "display_name": "sigy", "link": "https://stackoverflow.com/users/1557062/sigy"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1562176848, "post_id": 56875637, "comment_id": 100299901, "body": "But why do we need the specialization in the first place?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1562176849, "post_id": 56875637, "comment_id": 100299903, "body": "If you try to do it without the specialization, you&#39;ll get a good sense of why it is needed."}], "answers": [{"comments": [{"owner": {"reputation": 2145, "user_id": 1557062, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/1UPQG.jpg?s=128&g=1", "display_name": "sigy", "link": "https://stackoverflow.com/users/1557062/sigy"}, "edited": false, "score": 0, "creation_date": 1562178151, "post_id": 56875807, "comment_id": 100300447, "body": "I think my problem in understanding this is: why can the compiler instantiate the specialization if the primary template is present but not if it is missing? I mean it still <i>expects a template-template parameter and some types</i> and we are still giving it a single type."}, {"owner": {"reputation": 2145, "user_id": 1557062, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/1UPQG.jpg?s=128&g=1", "display_name": "sigy", "link": "https://stackoverflow.com/users/1557062/sigy"}, "edited": false, "score": 0, "creation_date": 1562178420, "post_id": 56875807, "comment_id": 100300575, "body": "OK, I think I got it now. The primary template tells the compiler that this template accepts just a single type and the specialization can than &quot;define&quot; certain &quot;requirements&quot; on that type to get instantiated."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 2145, "user_id": 1557062, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/1UPQG.jpg?s=128&g=1", "display_name": "sigy", "link": "https://stackoverflow.com/users/1557062/sigy"}, "edited": false, "score": 0, "creation_date": 1562179873, "post_id": 56875807, "comment_id": 100301229, "body": "@sigy: Right! With a class there&#39;s just no way to go from a template template type plus types into a single type with just a primary template. If we were writing a function, we could do that, though <a href=\"https://godbolt.org/z/z5RqvP\" rel=\"nofollow noreferrer\">for example</a>"}], "tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": false, "score": 1, "last_activity_date": 1562177823, "last_edit_date": 1562177823, "creation_date": 1562177363, "answer_id": 56875807, "question_id": 56875637, "link": "https://stackoverflow.com/questions/56875637/why-do-we-need-a-template-specialization-for-a-template-template-parameter/56875807#56875807", "title": "Why do we need a template specialization for a template-template parameter", "body": "<p>The short answer is that without the primary template we cannot write a specialization.</p>\n\n<p>The longer answer is: how would you extract <code>Types...</code> from the instantiation of a templated type without a specialization? You cannot.</p>\n\n<p>Here's an attempt:</p>\n\n<pre><code>template &lt;template &lt;class...&gt; class type_list, class... Types&gt;\nstruct type_list_length\n{\n    static constexpr std::size_t value = sizeof...(Types);\n};\n</code></pre>\n\n<p>We can do this:</p>\n\n<pre><code>type_list_length&lt;type_list, int, double, float&gt;::value\n</code></pre>\n\n<p>But not this:</p>\n\n<pre><code>using MyListType = type_list&lt;int, double, float&gt;;\ntype_list_length&lt;MyListType&gt;::value;\n</code></pre>\n\n<p>Because our template expects a template-template parameter and some types, so we're forced to accept just a single type to match <code>MyListType</code>:</p>\n\n<pre><code>template &lt;class T&gt;\nstruct type_list_length\n{\n    static constexpr std::size_t value = // ????;\n};\n</code></pre>\n\n<p>But now we're faced with another issue. How do we assign <code>value</code>? We need some way to extract the template arguments for <code>MyListType</code>, or at least the count.</p>\n\n<p>We need a way to match a single type <strong>and</strong> the arguments it is templated on. Hence, we need match just a single type AND its template parameters.</p>\n\n<pre><code>template &lt;class TypeList&gt;\nstruct type_list_length; \n\ntemplate &lt;template &lt;class...&gt; class type_list, class... Types&gt;\nstruct type_list_length&lt;TypeList&lt;Types...&gt;&gt;\n{\n    static constexpr std::size_t value = sizeof...(Types);\n};\n</code></pre>\n\n<p>The first (incomplete) type is our primary template. It allows us to start matching a single type, like <code>MyListType</code>.</p>\n\n<p>The second (complete) type is our specialization. it allows us to match a single type AND if it's a templated type, match the types used as template parameters for it.</p>\n\n<p>By leaving the first type incomplete, we demonstrate our intention to ONLY allow the specialization to be valid.</p>\n"}, {"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 1, "last_activity_date": 1562178057, "creation_date": 1562178057, "answer_id": 56875957, "question_id": 56875637, "link": "https://stackoverflow.com/questions/56875637/why-do-we-need-a-template-specialization-for-a-template-template-parameter/56875957#56875957", "title": "Why do we need a template specialization for a template-template parameter", "body": "<blockquote>\n  <p>But why do we need the specialization in the first place?</p>\n</blockquote>\n\n<p>Because you use the <code>class</code> as follows</p>\n\n<pre><code>std::cout &lt;&lt; type_list_length&lt;type_list&lt;int, long, long long&gt;&gt;::value;\n// ...........................^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ &lt;- template argument\n</code></pre>\n\n<p>or also</p>\n\n<pre><code>std::cout &lt;&lt; type_list_length&lt;std::tuple&lt;int, long, long long&gt;&gt;::value;\n// ...........................^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ &lt;- template argumen\n</code></pre>\n\n<p>or in a similar way.</p>\n\n<p>Observe the template argument: in both cases is a <strong>type</strong>; <code>type_list&lt;int, long, long long&gt;</code> in first case, <code>std::tuple&lt;int, long, long long&gt;</code>.</p>\n\n<p>So you can't declare <code>type_list_length</code> as receiving a template-template type </p>\n\n<pre><code>template &lt;template &lt;class...&gt; class type_list, class... Types&gt;\nstruct type_list_length // &lt;--- doesn't work\n{\n    static constexpr std::size_t value = sizeof...(Types);\n};\n</code></pre>\n\n<p>because you should call it passing a template-template parameter followed by a variadic list of templates; I mean... you should use it as follows</p>\n\n<pre><code>std::cout &lt;&lt; type_list_length&lt;type_list, int, long, long long&gt;::value;\nstd::cout &lt;&lt; type_list_length&lt;std::tuple, int, long, long long&gt;::value;\n</code></pre>\n\n<p>but, this way, you loose the power of the class: extract and count the template parameter of the type parameter.</p>\n\n<p>So you need first declare <code>type_list_length</code> as receiving a type</p>\n\n<pre><code>template &lt;typename&gt; // no template parameter name needed here (not used)\nstruct type_list_length; \n</code></pre>\n\n<p>and then declare and define a specialization in case the received type is a template-template with arguments</p>\n\n<pre><code>template &lt;template &lt;typename...&gt; class type_list, typename... Types&gt;\nstruct type_list_length&lt;TypeList&lt;Types...&gt;&gt;\n{ // ...................^^^^^^^^^^^^^^^^^^   the parameter is a type\n    static constexpr std::size_t value = sizeof...(Types);\n};\n</code></pre>\n"}], "owner": {"reputation": 2145, "user_id": 1557062, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/1UPQG.jpg?s=128&g=1", "display_name": "sigy", "link": "https://stackoverflow.com/users/1557062/sigy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56875957, "answer_count": 2, "score": 1, "last_activity_date": 1562178057, "creation_date": 1562176607, "last_edit_date": 1562176716, "question_id": 56875637, "link": "https://stackoverflow.com/questions/56875637/why-do-we-need-a-template-specialization-for-a-template-template-parameter", "title": "Why do we need a template specialization for a template-template parameter", "body": "<p>Take as an example this code to determine the length of a type list:</p>\n\n<pre><code>template &lt;class... Types&gt;\nclass type_list {};\n\ntemplate &lt;class TypeList&gt;\nstruct type_list_length;  // &lt;---\n\ntemplate &lt;template &lt;class...&gt; class type_list, class... Types&gt;\nstruct type_list_length&lt;TypeList&lt;Types...&gt;&gt;\n{\n    static constexpr std::size_t value = sizeof...(Types);\n};\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/LRVHVL\" rel=\"nofollow noreferrer\">Godbolt</a></p>\n\n<p>Why do we need the marked declaration? I tried to compile the code without it in several compilers but are always getting errors.</p>\n"}, {"tags": ["c++", "multithreading", "parallel-processing", "tbb"], "comments": [{"owner": {"reputation": 467, "user_id": 9216696, "user_type": "registered", "profile_image": "https://graph.facebook.com/1983536371871178/picture?type=large", "display_name": "Alex Hodges", "link": "https://stackoverflow.com/users/9216696/alex-hodges"}, "edited": false, "score": 2, "creation_date": 1562182944, "post_id": 56875635, "comment_id": 100302486, "body": "If you need guaranteed sequential execution, don&#39;t use threads."}, {"owner": {"reputation": 83, "user_id": 9683118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b068795538aad96a02f4b1143dde7f62?s=128&d=identicon&r=PG&f=1", "display_name": "blackgeorge-boom", "link": "https://stackoverflow.com/users/9683118/blackgeorge-boom"}, "reply_to_user": {"reputation": 467, "user_id": 9216696, "user_type": "registered", "profile_image": "https://graph.facebook.com/1983536371871178/picture?type=large", "display_name": "Alex Hodges", "link": "https://stackoverflow.com/users/9216696/alex-hodges"}, "edited": false, "score": 0, "creation_date": 1562189630, "post_id": 56875635, "comment_id": 100304994, "body": "I don&#39;t want guaranteed sequential execution, I want to compute <i>in parallel</i> the first N elements of the array (in any order), then the second batch of N elements (in any order) etc. N is the number of threads."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 9683118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b068795538aad96a02f4b1143dde7f62?s=128&d=identicon&r=PG&f=1", "display_name": "blackgeorge-boom", "link": "https://stackoverflow.com/users/9683118/blackgeorge-boom"}, "edited": false, "score": 0, "creation_date": 1562429758, "post_id": 56900931, "comment_id": 100374267, "body": "I wanted to compute a memoization table, where having computed the first elements will save you time for the last. That&#39;s why I wanted monotonic behavior. Also, pipelines and flow graphs are definitely worth a try :)"}, {"owner": {"reputation": 517, "user_id": 2509467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/217d0f4c3e155e6b1723d7617f4bb6f2?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/2509467/alex"}, "reply_to_user": {"reputation": 83, "user_id": 9683118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b068795538aad96a02f4b1143dde7f62?s=128&d=identicon&r=PG&f=1", "display_name": "blackgeorge-boom", "link": "https://stackoverflow.com/users/9683118/blackgeorge-boom"}, "edited": false, "score": 0, "creation_date": 1562667612, "post_id": 56900931, "comment_id": 100439441, "body": "It looks like that you can use <code>concurrent_hash_map</code> or <code>concurrent_unordered_map</code> to implement memorization. Why the order is important?"}], "tags": [], "owner": {"reputation": 517, "user_id": 2509467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/217d0f4c3e155e6b1723d7617f4bb6f2?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/2509467/alex"}, "is_accepted": true, "score": 1, "last_activity_date": 1562322463, "last_edit_date": 1562322463, "creation_date": 1562321192, "answer_id": 56900931, "question_id": 56875635, "link": "https://stackoverflow.com/questions/56875635/non-recursive-split-iteration-of-array-with-tbbparalllel-for/56900931#56900931", "title": "Non-recursive split iteration of array with tbb::paralllel_for", "body": "<p>Consider using an external atomic, e.g. ( <code>// !!!</code> marks changed lines)</p>\n\n<pre><code>#include &lt;mutex&gt;\n#include &lt;iostream&gt;\n#include &lt;thread&gt;\n\n#include &lt;tbb/parallel_for.h&gt;\n#include &lt;tbb/task_scheduler_init.h&gt;\n\n#include &lt;atomic&gt;                                 // !!!\n\nstd::mutex cout_mutex;\n\nint main()\n{\n    auto N = 8;\n\n    tbb::task_scheduler_init init(4);\n\n    std::atomic&lt;int&gt; monotonic_begin{0};           // !!!\n\n    tbb::parallel_for(tbb::blocked_range&lt;int&gt;(0, N),\n        [&amp;](const tbb::blocked_range&lt;int&gt;&amp; r)\n        {\n            int s = static_cast&lt;int&gt;(r.size());    // !!!\n            int b = monotonic_begin.fetch_add(s);  // !!!\n            int e = b + s;                         // !!!\n            for (int j = b; j &lt; e; ++j) {          // !!!       \n                // Compute A[j]\n                std::this_thread::sleep_for(std::chrono::seconds(1));\n                cout_mutex.lock();\n                std::cout &lt;&lt; std::this_thread::get_id() &lt;&lt; \", \" &lt;&lt; j &lt;&lt; std::endl;\n                cout_mutex.unlock();\n            }\n        }\n    );\n}\n</code></pre>\n\n<p>The approach gives:</p>\n\n<pre><code>15084, 0\n15040, 3\n12400, 2\n11308, 1\n15084, 4\n15040, 5\n12400, 6\n11308, 7\n</code></pre>\n\n<p>Why it is important to have monotonic behavior? You may want to consider <code>parallel_pipeline</code> or flow graph to specify calculation dependencies.</p>\n"}], "owner": {"reputation": 83, "user_id": 9683118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b068795538aad96a02f4b1143dde7f62?s=128&d=identicon&r=PG&f=1", "display_name": "blackgeorge-boom", "link": "https://stackoverflow.com/users/9683118/blackgeorge-boom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 56900931, "answer_count": 1, "score": 2, "last_activity_date": 1562322463, "creation_date": 1562176593, "last_edit_date": 1562190885, "question_id": 56875635, "link": "https://stackoverflow.com/questions/56875635/non-recursive-split-iteration-of-array-with-tbbparalllel-for", "title": "Non-recursive split iteration of array with tbb::paralllel_for", "body": "<p>I'm trying to perform a computation over a one-dimensional array <code>A[]</code> using Intel's TBBs. The problem is that, by default, an algorithm like <code>tbb::parallel_for</code> would cut the array in half recursively, sending each chunk to the task pool for the threads to steal.</p>\n\n<p>However, I want all threads to \"scan\" the array in a linear way. For example, using 4 threads have them compute, in parallel, first <code>A[0], A[1], A[2]</code> and <code>A[3]</code> in any order. And then, compute the set <code>A[4], A[5], A[6]</code> and <code>A[7]</code>, in any order. </p>\n\n<p>Right now, <code>parallel_for</code>, after a couple of recursive splits would compute first <code>A[0], A[2], A[4]</code> and <code>A[6]</code> respectively. And then, <code>A[1], A[3], A[5]</code> and <code>A[7]</code> (or something similar). </p>\n\n<p>I'm using C++14 and Intel's <a href=\"https://software.intel.com/en-us/tbb-documentation\" rel=\"nofollow noreferrer\">Threading Building Blocks</a>. Algorithms like <code>parallel_reduce</code> or <code>parallel_scan</code> operate in a similar fashion, regarding the splitting of the iteration space, so they haven't been much of a help.</p>\n\n<p>My guess is that I have do define my own iteration space object, but I can't figure out how exactly. The <a href=\"https://software.intel.com/en-us/node/506065\" rel=\"nofollow noreferrer\">docs</a> give this definition:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class R {\n    // True if range is empty\n    bool empty() const;\n    // True if range can be split into non-empty subranges\n    bool is_divisible() const;\n    // Splits r into subranges r and *this\n    R( R&amp; r, split );\n    // Splits r into subranges r and *this in proportion p\n    R( R&amp; r, proportional_split p );\n    // Allows usage of proportional splitting constructor\n    static const bool is_splittable_in_proportion = true;\n    ...\n};\n</code></pre>\n\n<p>It all boils down to this code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;mutex&gt;\n#include &lt;iostream&gt;\n#include &lt;thread&gt;\n\n#include &lt;tbb/parallel_for.h&gt;\n#include &lt;tbb/task_scheduler_init.h&gt;\n\nstd::mutex cout_mutex;\n\nint main()\n{\n    auto N = 8;\n\n    tbb::task_scheduler_init init(4);\n\n    tbb::parallel_for(tbb::blocked_range&lt;int&gt;(0, N),\n        [&amp;](const tbb::blocked_range&lt;int&gt;&amp; r)\n        {\n            for (int j = r.begin(); j &lt; r.end(); ++j) {\n                // Compute A[j]\n                std::this_thread::sleep_for(std::chrono::seconds(1));\n                cout_mutex.lock();\n                std::cout &lt;&lt; std::this_thread::get_id()&lt;&lt; \", \" &lt;&lt; j &lt;&lt; std::endl;\n                cout_mutex.unlock();\n            }\n        }\n    );\n}\n</code></pre>\n\n<p>The above code gives:</p>\n\n<pre><code>140455557347136, 0\n140455526110976, 4\n140455521912576, 2\n140455530309376, 6\n140455526110976, 5\n140455557347136, 1\n140455521912576, 3\n140455530309376, 7\n</code></pre>\n\n<p>but I wanted something like:</p>\n\n<pre><code>140455557347136, 0\n140455526110976, 1\n140455521912576, 2\n140455530309376, 3\n140455526110976, 5\n140455557347136, 4\n140455521912576, 6\n140455530309376, 7\n</code></pre>\n\n<p>Any suggestions on the iteration object or is there a better solution?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1562175608, "post_id": 56875427, "comment_id": 100299363, "body": "Did you find anything like you want <a href=\"https://en.cppreference.com/w/cpp/algorithm\" rel=\"nofollow noreferrer\">here</a>? If not, then there&#39;s probably no such thing."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1562175739, "post_id": 56875427, "comment_id": 100299415, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6, I did, but sometimes I don&#39;t see that certain combinations of algorithms might produce what I am looking for."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1562176657, "post_id": 56875427, "comment_id": 100299817, "body": "It will be hard to combine algorithms from the standard library to do such things because these algorithms mostly care about iterators, not indices... What  you want is basically <a href=\"https://en.cppreference.com/w/cpp/algorithm/set_intersection\" rel=\"nofollow noreferrer\"><code>set_intersection</code></a> with indices in the first range instead of value, but you won&#39;t find such thing."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1562176928, "post_id": 56875427, "comment_id": 100299951, "body": "@Holt, would be even useful if it generated a list of iterators that I could generate indices from, but it doesn&#39;t look like it does that either."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1562178440, "post_id": 56875427, "comment_id": 100300585, "body": "Feels like if I could have a transformation attached to the back_inserter, I could generate what I need."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1562181828, "post_id": 56875427, "comment_id": 100302056, "body": "@Adrian There are possibilities, e.g. you could create a vector containing all indices and then do intersections using it with a custom comparator, but that&#39;s not pretty imo, or you could replace the back inserter with a custom iterator that compute indices but you&#39;d have to create such iterator and I am not sure the standard guarantees from which set the value is given, so it may not work at all... IMO the best way is your solution, maybe with some cleaning as proposed in some answers."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562196790, "post_id": 56875427, "comment_id": 100306605, "body": "You should write out what your algorithm (in a human language, preferably English on this site) and not rely on people being able to parse your code."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "reply_to_user": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562250010, "post_id": 56875427, "comment_id": 100326628, "body": "Hey @JaMiT. Sorry, thought that the title just about covered the algorithm."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562262156, "post_id": 56875427, "comment_id": 100331411, "body": "@Adrian Speaking of which, there is some good advice in How to Ask you may want to consider. Your title is rather long to get the attention of a busy colleague. (A more succinct title might be &quot;How to find the indices of matching elements of sorted containers?&quot; Drop the trivial details.) Also, the body of your question fails to repeat the information in the title, much less expand upon it. (No, the title is not part of the body of your question. Copy and paste if you must. Make it easier for others, since you are the only one who truly cares if this particular question gets answered.)"}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562262331, "post_id": 56875427, "comment_id": 100331464, "body": "@Adrian Also, the title gives the goal of the algorithm, not the algorithm itself. Calling that an algorithm would be comparable to calling &quot;sort the elements of an array&quot; an algorithm. Something that cannot distinguish bubble sort from quick sort is too broad to be considered an algorithm."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "reply_to_user": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562273576, "post_id": 56875427, "comment_id": 100334467, "body": "Thanks @JaMiT, I&#39;ve implemented your suggestions.  Unfortunately, sometimes I just can&#39;t get the right words and to wait till I do would take too long."}], "answers": [{"comments": [{"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 2, "creation_date": 1562176439, "post_id": 56875563, "comment_id": 100299712, "body": "But that doesn&#39;t match against a list of elements.  That only matches against one."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1562177883, "post_id": 56875563, "comment_id": 100300346, "body": "Though you can, you would have an O(n*m) algorithm.  I&#39;m looking for better than that.  The one I provided is O(min(n, m))."}], "tags": [], "owner": {"reputation": 2741, "user_id": 2036161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ba65c6994b3945d68ea848b7d8a27253?s=128&d=identicon&r=PG", "display_name": "ventsyv", "link": "https://stackoverflow.com/users/2036161/ventsyv"}, "is_accepted": false, "score": -1, "last_activity_date": 1562177582, "last_edit_date": 1562177582, "creation_date": 1562176258, "answer_id": 56875563, "question_id": 56875427, "link": "https://stackoverflow.com/questions/56875427/how-to-find-the-indices-of-matching-elements-of-sorted-containers/56875563#56875563", "title": "How to find the indices of matching elements of sorted containers?", "body": "<p>You can use std::find and std::distance to find the index of the match, then put it in the container.</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n\nint main ()\n{\n   std::vector&lt;int&gt; v = {1,2,3,4,5,6,7};\n   std::vector&lt;int&gt; matchIndexes;\n   std::vector&lt;int&gt;::iterator match = std::find(v.begin(), v.end(), 5);\n   int index = std::distance(v.begin(), match);\n   matchIndexes.push_back(index);\n\n   return 0;\n}\n</code></pre>\n\n<p>To match multiple elements, you can use std::search in similar fashion.</p>\n"}, {"tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": false, "score": 0, "last_activity_date": 1562177276, "creation_date": 1562177276, "answer_id": 56875786, "question_id": 56875427, "link": "https://stackoverflow.com/questions/56875427/how-to-find-the-indices-of-matching-elements-of-sorted-containers/56875786#56875786", "title": "How to find the indices of matching elements of sorted containers?", "body": "<p>We can use <code>find_if</code> to simplify the implementation of the function:</p>\n\n<pre><code>template&lt;class SourceIt, class SelectIt, class IndexIt&gt;\nvoid get_indicies(SourceIt begin, SourceIt end, SelectIt sbegin, SelectIt send, IndexIt dest) {\n    auto scan = begin; \n\n    for(; sbegin != send; ++sbegin) {\n        auto&amp;&amp; key = *sbegin; \n        scan = std::find_if(scan, end, [&amp;](auto&amp;&amp; obj) { return obj &gt;= key; }); \n        if(scan == end) break;\n        for(; scan != end &amp;&amp; *scan == key; ++scan) {\n            *dest = std::distance(begin, scan); \n            ++dest; \n        }\n    }\n}\n</code></pre>\n\n<p>This doesn't make it that much shorter, but the code looks a little cleaner now. You're scanning until you find something as big as or equal to the key, and then you copy indicies to the destination as long as the source matches key. </p>\n"}, {"comments": [{"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1562177729, "post_id": 56875826, "comment_id": 100300263, "body": "Yeah, this was mentioned by @Holt, but it doesn&#39;t give the indices of the elements, or the iterator of each element.  Maybe if std::back_inserter was able to return the pointers of the elements, I could use that."}], "tags": [], "owner": {"reputation": 7744, "user_id": 9666018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2959ed405ad18cbca6aa3efe01bc7d?s=128&d=identicon&r=PG&f=1", "display_name": "Armin Montigny", "link": "https://stackoverflow.com/users/9666018/armin-montigny"}, "is_accepted": false, "score": 0, "last_activity_date": 1562180449, "last_edit_date": 1562180449, "creation_date": 1562177452, "answer_id": 56875826, "question_id": 56875427, "link": "https://stackoverflow.com/questions/56875427/how-to-find-the-indices-of-matching-elements-of-sorted-containers/56875826#56875826", "title": "How to find the indices of matching elements of sorted containers?", "body": "<p>maybe I misunderstodd the question. But there is a function in the algorithm library.</p>\n\n<p><code>std::set_intersection</code></p>\n\n<p>This does, what you want in one function. See:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;iterator&gt;\n\nint main()\n{\n    // Input values\n    std::vector&lt;int&gt; items{ 1,3,6,8,13,17 };\n    std::vector&lt;int&gt; subitems{ 3,6,17 };\n\n    // Result\n    std::vector&lt;int&gt; result;\n\n    // Do the work. One liner\n    std::set_intersection(items.begin(),items.end(), subitems.begin(),subitems.end(),std::back_inserter(result));\n\n    // Debug output: Show result\n    std::copy(result.begin(), result.end(), std::ostream_iterator&lt;int&gt;(std::cout, \" \"));\n    return 0;\n}\n\n</code></pre>\n\n<p>If I misunderstood, then please tell me and I will find another solution.</p>\n\n<p>EDIT:</p>\n\n<p>I indeed misunderstood. You wanted the indices. Then maybe like this?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;iterator&gt;\nusing Iter = std::vector&lt;int&gt;::iterator;\n\nint main()\n{\n    // Input values\n    std::vector&lt;int&gt; items{ 1,3,6,8,13,17 };\n    std::vector&lt;int&gt; subitems{ 3,6,17 };\n\n    // Result\n    std::vector&lt;int&gt; indices{};\n    Iter it;\n\n    // Do the work.\n    std::for_each(subitems.begin(), subitems.end(), [&amp;](int i) {it = find(items.begin(), items.end(), i); if (it != items.end()) indices.push_back(std::distance(items.begin(),it));});\n\n    // Debug output: Show result\n    std::copy(indices.begin(), indices.end(), std::ostream_iterator&lt;int&gt;(std::cout, \" \"));\n    return 0;\n}\n</code></pre>\n\n<p>Unfortunately a very long \"one-liner\". </p>\n\n<p>I need to think more . . .</p>\n"}, {"tags": [], "owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1562259174, "last_edit_date": 1562259174, "creation_date": 1562181017, "answer_id": 56876585, "question_id": 56875427, "link": "https://stackoverflow.com/questions/56875427/how-to-find-the-indices-of-matching-elements-of-sorted-containers/56876585#56876585", "title": "How to find the indices of matching elements of sorted containers?", "body": "<p>By using <code>std::set_intersection</code>, defining an <code>assignment_iterator</code> class and a <code>assignment</code> helper, this is possible:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iterator&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;vector&gt;\n\ntemplate &lt;typename Transform&gt;\nclass assignment_iterator\n{\n    Transform transform;\n\npublic:\n    using iterator_category = std::output_iterator_tag;\n    using value_type        = void;\n    using difference_type   = void;\n    using pointer           = void;\n    using reference         = void;\n\n    assignment_iterator(Transform transform)\n        : transform(transform)\n    {}\n\n    // For some reason VC++ is assigning the iterator inside of std::copy().\n    // Not needed for other compilers.\n    #ifdef _MSC_VER\n    assignment_iterator&amp; operator=(assignment_iterator const&amp; copy)\n    {\n        transform.~Transform();\n        new (&amp;transform) Transform(copy.transform);\n        return *this;\n    }\n    #endif\n\n    template &lt;typename T&gt;\n    constexpr assignment_iterator&amp; operator=(T&amp; value) {\n        transform(value);\n        return *this;\n    }\n\n    constexpr assignment_iterator&amp; operator* (   ) { return *this; }\n    constexpr assignment_iterator&amp; operator++(   ) { return *this; }\n    constexpr assignment_iterator&amp; operator++(int) { return *this; }\n};\n\ntemplate &lt;typename Transform&gt;\nassignment_iterator&lt;Transform&gt; assignment(Transform&amp;&amp; transform)\n{\n    return { std::forward&lt;Transform&gt;(transform) };\n}\n\nint main()\n{\n    int items[] = { 1, 3, 6, 8, 13, 17 };\n    int subitems[] = { 3, 6, 17 };\n    std::vector&lt;int&gt; indices;\n    std::set_intersection(std::begin(items), std::end(items)\n        , std::begin(subitems), std::end(subitems)\n        , assignment([&amp;items, &amp;indices](int&amp; item) {\n            return indices.push_back(&amp;item - &amp;*std::begin(items));\n        })\n    );\n\n    std::copy(indices.begin(), indices.end()\n        , assignment([&amp;indices](int&amp; index) {\n            std::cout &lt;&lt; index;\n            if (&amp;index != &amp;std::end(indices)[-1])\n              std::cout &lt;&lt;  \", \";\n        })\n    );\n    return 0;\n}\n</code></pre>\n\n<p><kbd><a href=\"https://godbolt.org/z/9GJxrv\" rel=\"nofollow noreferrer\">Demo</a></kbd></p>\n\n<p>It's more code, but maybe <code>assignment</code> is a more generic means to do other operations, that currently require a specific implementations like <code>back_inserter</code> and <code>ostream_iterator</code>, and thus be less code in the long run (e.g. like the other use above with <code>std::copy</code>)?</p>\n\n<p>This should work properly all the time based on the documentation <a href=\"https://en.cppreference.com/w/cpp/algorithm/set_intersection\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<blockquote>\n  <p>elements will be copied from the first range to the destination range.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1562185683, "post_id": 56877166, "comment_id": 100303491, "body": "Your <code>predicate</code> uses a loop, which would be better replaced with a <code>std::find</code>. But in any case, this results in an O(n*m) algorithm, which I am trying to avoid."}, {"owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "reply_to_user": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1562186111, "post_id": 56877166, "comment_id": 100303686, "body": "@Adrian the big O wasn&#39;t part of the question. A better predicate would do the job though."}], "tags": [], "owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "is_accepted": false, "score": 0, "last_activity_date": 1562184433, "last_edit_date": 1562184433, "creation_date": 1562183980, "answer_id": 56877166, "question_id": 56875427, "link": "https://stackoverflow.com/questions/56875427/how-to-find-the-indices-of-matching-elements-of-sorted-containers/56877166#56877166", "title": "How to find the indices of matching elements of sorted containers?", "body": "<p>The answer is yes but it will come with <code>C++20</code>:</p>\n\n<p>you can use <a href=\"https://github.com/ericniebler/range-v3\" rel=\"nofollow noreferrer\">ranges</a> for this purpose:</p>\n\n<p>first make a <code>view</code> with some predicate you like:</p>\n\n<pre><code>auto result = items | ranges::view::filter(predicate);\n</code></pre>\n\n<p>then take the <code>iterator</code> to the original array from <code>base</code>, for example <code>result.begin().base()</code> will give you the iterator to the <code>begin</code> of <code>result</code> in the original array.</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;iterator&gt;\n#include &lt;range/v3/view/filter.hpp&gt;\n#include &lt;range/v3/view/transform.hpp&gt;\n\nint main()\n{\n\n   std::vector&lt;int&gt; items = { 1, 3, 6, 8, 13, 17 };\n   std::vector&lt;int&gt; subitems = { 3, 6, 17 };\n   auto predicate = [&amp;](int&amp; n){\n       for(auto&amp; s : subitems)\n        if(n == s)\n            return true;\n        return false; \n        };\n   auto result = items | ranges::view::filter(predicate);\n\n   for (auto&amp; n : result)\n   {\n      std::cout &lt;&lt; n &lt;&lt; '\\n';\n   }\n   for(auto it = result.begin(); it != result.end(); ++it )\n    std::cout &lt;&lt; it.base() - items.begin() &lt;&lt; ' ';\n\n}\n</code></pre>\n\n<p>see the <a href=\"https://godbolt.org/z/Dc9L2F\" rel=\"nofollow noreferrer\">godbolt</a></p>\n"}], "owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 1, "answer_count": 5, "score": 0, "last_activity_date": 1562273503, "creation_date": 1562175503, "last_edit_date": 1562273503, "question_id": 56875427, "link": "https://stackoverflow.com/questions/56875427/how-to-find-the-indices-of-matching-elements-of-sorted-containers", "title": "How to find the indices of matching elements of sorted containers?", "body": "<p>I'm trying to get the indices of one container where the elements match.  Both containers are sorted in ascending order.  Is there an algorithm or combo of algorithms that would place the indices of matching elements of sorted containers into another container?</p>\n\n<p>I've coded an algorithm already, but was wondering if this has been coded before in the stl in some way that I didn't think of?</p>\n\n<p>I would like the algorithm to have a running complexity comparable to the one I suggested, which I belive is O(min(m, n)).</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iterator&gt;\n#include &lt;iostream&gt;\n\ntemplate &lt;typename It, typename Index_it&gt;\nvoid get_indices(It selected_it, It selected_it_end, It subitems_it, It subitems_it_end, Index_it indices_it)\n{\n    auto reference_it = selected_it;\n    while (selected_it != selected_it_end &amp;&amp; subitems_it != subitems_it_end) {\n        if (*selected_it == *subitems_it) {\n            *indices_it++ = std::distance(reference_it, selected_it);\n            ++selected_it;\n            ++subitems_it;\n        }\n        else if (*selected_it &lt; *subitems_it) {\n            ++selected_it;\n        }\n        else {\n            ++subitems_it;\n        }\n    }\n}\n\nint main()\n{\n    int items[] = { 1, 3, 6, 8, 13, 17 };\n    int subitems[] = { 3, 6, 17 };\n    int indices[std::size(subitems)] = {0};\n    auto selected_it = std::begin(items), it = std::begin(subitems);\n    auto indices_it = std::begin(indices);\n    get_indices(std::begin(items), std::end(items)\n        , std::begin(subitems), std::end(subitems)\n        , std::begin(indices));\n    for (auto i : indices) {\n        std::cout &lt;&lt; i &lt;&lt; \", \";\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "data-structures"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1562175448, "post_id": 56875253, "comment_id": 100299305, "body": "What does this code do?:) What is its purpose?"}, {"owner": {"reputation": 11, "user_id": 10742036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac94e845ae92b2ff2f00f918a85f301b?s=128&d=identicon&r=PG&f=1", "display_name": "StrawHat04", "link": "https://stackoverflow.com/users/10742036/strawhat04"}, "reply_to_user": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1562208802, "post_id": 56875253, "comment_id": 100308440, "body": "It finds number of pairs possible whose sum is a given value(here x)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10742036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac94e845ae92b2ff2f00f918a85f301b?s=128&d=identicon&r=PG&f=1", "display_name": "StrawHat04", "link": "https://stackoverflow.com/users/10742036/strawhat04"}, "edited": false, "score": 0, "creation_date": 1562210399, "post_id": 56875317, "comment_id": 100308691, "body": "Also at first we are not inserting the key we are trying to find the diff of sum and arr[i] then how are we comparing it when there is nothing to compare in map until we insert?"}, {"owner": {"reputation": 11, "user_id": 10742036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac94e845ae92b2ff2f00f918a85f301b?s=128&d=identicon&r=PG&f=1", "display_name": "StrawHat04", "link": "https://stackoverflow.com/users/10742036/strawhat04"}, "edited": false, "score": 0, "creation_date": 1562289705, "post_id": 56875317, "comment_id": 100337082, "body": "If possible can you explain it a bit more easily or with example? I m new to map"}], "tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": false, "score": 1, "last_activity_date": 1562174977, "creation_date": 1562174977, "answer_id": 56875317, "question_id": 56875253, "link": "https://stackoverflow.com/questions/56875253/pair-within-an-unsorted-array-for-a-given-sum/56875317#56875317", "title": "Pair within an unsorted Array for a given Sum", "body": "<p>The map counts the number of times each element occurs in the unsorted array. By default, if you write</p>\n\n<pre><code>umap[key]\n</code></pre>\n\n<p>and <code>key</code> is not in <code>umap</code>, it inserts <code>key</code> into <code>umap</code> with a default value of <code>0</code>. It then returns a reference to the location where the key was stored in the map.</p>\n\n<p>This means that for a new key given by <code>arr[i]</code>, the key is inserted into the map when you call <code>umap[arr[i]]</code>, and then that value is incremented so that the map registers a count of <code>1</code> for that key. </p>\n"}], "owner": {"reputation": 11, "user_id": 10742036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac94e845ae92b2ff2f00f918a85f301b?s=128&d=identicon&r=PG&f=1", "display_name": "StrawHat04", "link": "https://stackoverflow.com/users/10742036/strawhat04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562180357, "creation_date": 1562174667, "last_edit_date": 1562180357, "question_id": 56875253, "link": "https://stackoverflow.com/questions/56875253/pair-within-an-unsorted-array-for-a-given-sum", "title": "Pair within an unsorted Array for a given Sum", "body": "<p>Here it is using the <code>unordered_map</code> for the hashtable concept but I am not sure how it is doing so without even inserting item into the key value pair of <code>undered_map</code>.</p>\n\n<p>This is the code for finding the pairs within an unsorted array.\nHere it is using hashtable concept for everyother element.</p>\n\n<pre><code>void findPair(int arr[],int n,int x)\n{\n    unordered_map&lt;int,int&gt; umap;\n    for(int i=0;i&lt;n;i++)\n    {\n        int temp=x-arr[i];\n        if(umap.find(temp)!=umap.end())\n        {\n            int count=umap[temp];\n            for(int j=0;j&lt;count;j++)\n                cout&lt;&lt;arr[i]&lt;&lt;\" \"&lt;&lt;temp&lt;&lt;\"\\n\";\n        }\n        umap[arr[i]]++;\n    }\n}\n</code></pre>\n\n<p>Can you please give me some insight how it is inserting and why it is incrementing the count of that value?</p>\n"}, {"tags": ["c++", "qt", "logging", "qml"], "comments": [{"owner": {"reputation": 1345, "user_id": 1157147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dc55cf134872f2e92d248e83eaeda72f?s=128&d=identicon&r=PG", "display_name": "ByteNudger", "link": "https://stackoverflow.com/users/1157147/bytenudger"}, "edited": false, "score": 0, "creation_date": 1562175655, "post_id": 56875199, "comment_id": 100299383, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4780507/create-utf-8-file-in-qt\">Create UTF-8 file in Qt</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1246, "user_id": 167664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HuCUB.jpg?s=128&g=1", "display_name": "Georgy Pashkov", "link": "https://stackoverflow.com/users/167664/georgy-pashkov"}, "is_accepted": true, "score": 0, "last_activity_date": 1562188325, "creation_date": 1562188325, "answer_id": 56877988, "question_id": 56875199, "link": "https://stackoverflow.com/questions/56875199/external-log-file-as-utf8-and-with-r-n/56877988#56877988", "title": "external log file as UTF8 and with \\r\\n", "body": "<p>Both can be achieved by configuring your text stream:</p>\n\n<ol>\n<li>End-of-line terminators will be translated into <code>\"\\r\\n\"</code> on Windows when the stream is opened as text: <code>QTextStream ts(&amp;outFile, QIODevice::Text);</code></li>\n<li>Set the codec to write UTF-8: <code>ts.setCodec(\"UTF-8\");</code></li>\n</ol>\n\n<p>Documentation of <code>QTexStream</code> is quite good: <a href=\"https://doc.qt.io/qt-5/qtextstream.html\" rel=\"nofollow noreferrer\">https://doc.qt.io/qt-5/qtextstream.html</a></p>\n"}], "owner": {"reputation": 264, "user_id": 1092050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21720ab846efd2a51390cd066d3fce48?s=128&d=identicon&r=PG", "display_name": "Jiri Zaloudek", "link": "https://stackoverflow.com/users/1092050/jiri-zaloudek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 56877988, "answer_count": 1, "score": 1, "last_activity_date": 1582641730, "creation_date": 1562174406, "last_edit_date": 1582641730, "question_id": 56875199, "link": "https://stackoverflow.com/questions/56875199/external-log-file-as-utf8-and-with-r-n", "title": "external log file as UTF8 and with \\r\\n", "body": "<p>I have this code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    void myMessageHandler(QtMsgType type, const QMessageLogContext &amp;, const QString &amp; msg)\n    {\n        QTime time = QTime::currentTime();\n        QString formattedTime = time.toString(\"hh:mm:ss\");\n        QByteArray formattedTimeMsg = formattedTime.toLocal8Bit();\n\n        QString txt;\n        switch (type) {\n        case QtDebugMsg:\n            txt = QString(\"%1: Debug: %2\").arg(formattedTime, msg);\n            break;\n        case QtWarningMsg:\n            txt = QString(\"%1: Warning: %2\").arg(formattedTime, msg);\n        break;\n        case QtCriticalMsg:\n            txt = QString(\"%1: Critical: %2\").arg(formattedTime, msg);\n        break;\n        case QtFatalMsg:\n            txt = QString(\"%1: Fatal: %2\").arg(formattedTime, msg);\n        break;\n        }\n        QFile outFile(\"debug.log\");\n        outFile.open(QIODevice::WriteOnly | QIODevice::Append);\n        QTextStream ts(&amp;outFile);\n        ts &lt;&lt; txt &lt;&lt; endl;\n    }\n</code></pre>\n\n<p>which works very well as saving all console logs into the external file debug.log.\nHowever I don't know how to set it to format the file as UTF8 because some of my local special characters cant be read properly when open the file.\nAnd also how do I make new line after each record? It's all in one line \ndepends on what application I open the log file - notepad won't show me new lines, notepad++ does, wordpad also don't...)</p>\n\n<p>Thank you very much for your help guys!</p>\n"}, {"tags": ["c++", "operator-keyword"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 1, "creation_date": 1562174169, "post_id": 56875101, "comment_id": 100298726, "body": "Why would you want to overload an operator you seem to know nothing about?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1562174246, "post_id": 56875101, "comment_id": 100298753, "body": "You could say that <code>-&gt;</code> is a nullary operator. Although, it does have the implicit object argument so if you count that, then it is unary. The arity of a member function depends on your point of view."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562174387, "post_id": 56875101, "comment_id": 100298816, "body": "Unary and binary operators, per the standard, can be implemented as non-member functions with one or two parameters respectively. <code>operator-&gt;</code> must be a non-<code>static</code> member and can&#39;t be a non-member function. So I&#39;m not sure it qualifies as either."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562174521, "post_id": 56875101, "comment_id": 100298871, "body": "You should limit your posts to a <a href=\"https://meta.stackexchange.com/questions/222735/can-i-ask-only-one-question-per-post\">single question</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11712295"}, "edited": false, "score": 0, "creation_date": 1562174740, "post_id": 56875101, "comment_id": 100298973, "body": "#Scott Hunter - I post the question to know about.  If I already knew about it,  I would not do so.  I know that -&gt; is a operator that is used with class Or structure type.  I thought that may be a binary operator.  But i read a book where it was overloaded as unary operator,  that&#39;s why I post it here.  I google d but unable to find a suitable ans"}, {"owner": {"reputation": 350, "user_id": 9723461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8fd01cd442e062d643682e3ac4d3b10?s=128&d=identicon&r=PG&f=1", "display_name": "MPops", "link": "https://stackoverflow.com/users/9723461/mpops"}, "edited": false, "score": 0, "creation_date": 1562174965, "post_id": 56875101, "comment_id": 100299075, "body": "Really seems like a binary operator to me, but yeah I wasn&#39;t able to find an exact answer on google either.  It&#39;s an operator that takes 2 arguments: an object, and an offset (the object member). I don&#39;t see any better way of explaining it."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1562174979, "post_id": 56875101, "comment_id": 100299082, "body": "From a layman&#39;s point of view, it feels like a binary operator -- you need something on the LHS and you need something on the RHS. I am not sure how it is from a language lawyer&#39;s point of view."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1562175036, "post_id": 56875101, "comment_id": 100299111, "body": "@S.M.TusharIbneSalam Unfortunately some other user removed the duplicate I&#39;ve given you. You&#39;ll find your answer at <a href=\"https://stackoverflow.com/questions/4421706/what-are-the-basic-rules-and-idioms-for-operator-overloading\">What are the basic rules and idioms for operator overloading?</a> and see it doesn&#39;t fall in either category of <i>binary</i> or <i>unary</i> operators."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11712295"}, "edited": false, "score": 1, "creation_date": 1562175328, "post_id": 56875101, "comment_id": 100299244, "body": "#MPops- i also thought like you,  that -&gt; is a binary operator as you described.  But I got surprised when I saw that it is overloaded as it is a unary operator .  And that&#39;s why I wanted to knew what kind of operator -&gt; is .  If -&gt; would binary operator then I want to eagerly know why it was overloaded as unary operator.  Or it is work as both unary and binary operator like unary - and binary -"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1562175435, "post_id": 56875101, "comment_id": 100299298, "body": "@S.M.TusharIbneSalam BTW use <code>@&lt;name&gt;</code> to ping back anyone from comments here, not <code>#</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11712295"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1562176240, "post_id": 56875101, "comment_id": 100299615, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 Ok, actually this is my first post,  i am getting into it,  and I read your reference site. There -&gt; is told infix binary operator.  I didn&#39;t know what infix binary mean. But I googled and read it in &quot;qoura&quot; but I could not understand what is it,  and other things that were told in your given site,  something about recursive call that also was mystery to me"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11712295"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1562176339, "post_id": 56875101, "comment_id": 100299665, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 should I delete the post,  if you people think that is not a good question"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1562176357, "post_id": 56875101, "comment_id": 100299673, "body": "@S.M.TusharIbneSalam You may want to <a href=\"https://stackoverflow.com/posts/56875101/edit\">edit</a> your question and elaborate what exactly you don&#39;t understand."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1562177368, "post_id": 56875101, "comment_id": 100300135, "body": "@S.M.TusharIbneSalam &quot;Infix&quot; just means the operator is written between two operands, e.g. <code>a + b</code> (as opposed to weird notations like <code>+ a b</code> and <code>a b +</code>)."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1562177429, "post_id": 56875101, "comment_id": 100300162, "body": "The C++ precedence table refers to first and second argument, making it binary. <a href=\"https://en.cppreference.com/w/cpp/language/operator_member_access#Built-in_member_access_operators\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 5507797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhPM3.jpg?s=128&g=1", "display_name": "cff", "link": "https://stackoverflow.com/users/5507797/cff"}, "is_accepted": true, "score": 2, "last_activity_date": 1562181930, "creation_date": 1562181930, "answer_id": 56876773, "question_id": 56875101, "link": "https://stackoverflow.com/questions/56875101/in-c-why-is-called-binary-infix-pointer-member-access-operator/56876773#56876773", "title": "In c++ why -&gt; is called binary infix pointer member access operator?", "body": "<p>Straight from wikipedia (<a href=\"https://en.wikipedia.org/wiki/Infix_notation\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Infix_notation</a>):</p>\n\n<blockquote>\n  <p>Infix notation ... is characterized by the placement of operators between operands</p>\n</blockquote>\n\n<p>Again from wikipedia (<a href=\"https://en.wikipedia.org/wiki/Binary_operation\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Binary_operation</a>):</p>\n\n<blockquote>\n  <p>... a binary operation ... is a calculation that combines two elements (called operands) to produce another element.</p>\n</blockquote>\n\n<p>In c++ an expression in the [simplified] form <code>expr -&gt; id-expr</code> is called a <code>member access operator expression</code>. The built-in version provides access to a data member or member function of the class pointed-to by the pointer operand.</p>\n\n<p>Since it takes two expressions to form a <code>member access operator expression</code> we might say that it is binary, and since the symbol denoting the operator is placed between the two expressions we might say that it is infix.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11712295"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 1, "accepted_answer_id": 56876773, "answer_count": 1, "score": -3, "last_activity_date": 1562181930, "creation_date": 1562173967, "last_edit_date": 1562177273, "question_id": 56875101, "link": "https://stackoverflow.com/questions/56875101/in-c-why-is-called-binary-infix-pointer-member-access-operator", "title": "In c++ why -&gt; is called binary infix pointer member access operator?", "body": "<p>I heard -> is a binary infix pointer member access operator. Now can you explain why does it call so . And what the phrase binary infix mean in this field. </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1591, "user_id": 420446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406a84b65837087fd511c333fa2a389e?s=128&d=identicon&r=PG", "display_name": "willll", "link": "https://stackoverflow.com/users/420446/willll"}, "edited": false, "score": 1, "creation_date": 1562172435, "post_id": 56874729, "comment_id": 100297905, "body": "duplicate ? <a href=\"https://stackoverflow.com/a/24675249/420446\">stackoverflow.com/a/24675249/420446</a>"}, {"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "edited": false, "score": 0, "creation_date": 1562172676, "post_id": 56874729, "comment_id": 100298025, "body": "<code>iostream</code> uses ASCII encoding for characters. There is no pound symbol in ASCII, so you&#39;ll need to look into other options for <a href=\"https://stackoverflow.com/questions/12015571/how-to-print-unicode-character-in-c\">unicode encoding</a>"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562174901, "post_id": 56874729, "comment_id": 100299049, "body": "Nathan, on what platform are you working? Is your source code file saved as an UTF8 file? Does changing the pound sign to any of these strings help?: <code>&quot;\\u00A3&quot;</code> (unicode) , <code>&quot;\\x0C2\\xA3&quot;</code> (UTF8), <code>L&quot;\\x00A3&quot;</code> (UTF16) or <code>L&quot;\\xA300&quot;</code> (UTF16LE)."}, {"owner": {"reputation": 1, "user_id": 11723901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r6sSPAvolEE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmxcEJ9uqlM24rb1jASkz4WuAM-g/photo.jpg?sz=128", "display_name": "Nathan Davidson", "link": "https://stackoverflow.com/users/11723901/nathan-davidson"}, "edited": false, "score": 0, "creation_date": 1562182150, "post_id": 56874729, "comment_id": 100302175, "body": "thanks for the help i see cause it using ASCII encoding meaning no pound symbol option. if i was to use unicode or UTF8 would any include statements need to be added"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562185664, "post_id": 56874729, "comment_id": 100303483, "body": "@NathanDavidson The stream will output the <code>char</code>s you give it. How the combination of chars is rendered is depending on the environment your program is executed in, Did you try the different combinations I gave you?"}, {"owner": {"reputation": 1, "user_id": 11723901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r6sSPAvolEE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmxcEJ9uqlM24rb1jASkz4WuAM-g/photo.jpg?sz=128", "display_name": "Nathan Davidson", "link": "https://stackoverflow.com/users/11723901/nathan-davidson"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562239961, "post_id": 56874729, "comment_id": 100321047, "body": "@TedLyngmo i tried the different combinations UTF8 had an extra T in front of the u&#39; instead of a pound sign and UTF16 caused and error message for the include &lt;iostream&gt; line"}], "owner": {"reputation": 1, "user_id": 11723901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r6sSPAvolEE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmxcEJ9uqlM24rb1jASkz4WuAM-g/photo.jpg?sz=128", "display_name": "Nathan Davidson", "link": "https://stackoverflow.com/users/11723901/nathan-davidson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "closed_date": 1562172711, "answer_count": 0, "score": 0, "last_activity_date": 1562172362, "creation_date": 1562172258, "last_edit_date": 1562172362, "question_id": 56874729, "link": "https://stackoverflow.com/questions/56874729/c-pound-sign-not-displaying-correctly", "closed_reason": "Duplicate", "title": "c++ pound sign not displaying correctly", "body": "<p>so i made a very simple program which allows the user to choose some items and adds the total up in a basket and displays it to the user.</p>\n\n<p>but anywhere in the program where i use a (\u00a3) sign it shows as u' for some reason confused as to why this is happening.</p>\n\n<p>ive tried using (\u00a3) throughout the program still get same result</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;limits&gt;\n\nusing namespace std;\n\nint main() {\n    int choice;\n    int itemsWant;\n    int itemsNum = 0;\n    double basket = 0;\n    cout &lt;&lt; \"Welcome to the small store please browse our shopping list below.\"\n         &lt;&lt; endl;\n    cout &lt;&lt; \" 1 - Bread = \u00a31\" &lt;&lt; endl;\n    cout &lt;&lt; \" 2 - Eggs = \u00a31.25\" &lt;&lt; endl;\n    cout &lt;&lt; \" 3 - Milk = \u00a30.75\" &lt;&lt; endl;\n    cout &lt;&lt; \" 4 - Water = \u00a30.50\" &lt;&lt; endl;\n    cout &lt;&lt; \" 5 - Juice = \u00a31\" &lt;&lt; endl;\n    cout &lt;&lt; \" 6 - Fizzy Pop = \u00a31.50\" &lt;&lt; endl;\n    cout &lt;&lt; \" 7 - Crisps = \u00a31\" &lt;&lt; endl;\n    cout &lt;&lt; \" 8 - Sandwich = \u00a32\" &lt;&lt; endl;\n    cout &lt;&lt; \" 9 - Pizza = \u00a32\" &lt;&lt; endl;\n    cout &lt;&lt; \" 10 - Cake = \u00a33\" &lt;&lt; endl;\n    cout &lt;&lt; \"How many items would you like to purchase from the list? \";\n    while(!(cin &gt;&gt; itemsWant)) {\n        cout &lt;&lt; \"INVALID CHOICE: enter a number: \";\n        cin.clear();\n        cin.ignore(numeric_limits&lt;streamsize&gt;::max(), '\\n');\n    }\n    do {\n        cout &lt;&lt; \" Please make your choice(1-10): \";\n        while(!(cin &gt;&gt; choice)) {\n            cout &lt;&lt; \"INVALID CHOICE: enter a item from the list using the \"\n                    \"corresponding number: \";\n            cin.clear();\n            cin.ignore(numeric_limits&lt;streamsize&gt;::max(), '\\n');\n        }\n\n        if(choice &gt;= 1 &amp;&amp; choice &lt;= 10) {\n            switch(choice) {\n            case 1:\n                cout &lt;&lt; \"Thanks Bread has been added to your basket\" &lt;&lt; endl;\n                itemsNum++;\n                basket += 1;\n                break;\n            case 2:\n                cout &lt;&lt; \"Thanks Eggs has been added to your basket\" &lt;&lt; endl;\n                itemsNum++;\n                basket += 1.25;\n                break;\n            case 3:\n                cout &lt;&lt; \"Thanks Milk has been added to your basket\" &lt;&lt; endl;\n                itemsNum++;\n                basket += 0.75;\n                break;\n            case 4:\n                cout &lt;&lt; \"Thanks Water has been added to your basket\" &lt;&lt; endl;\n                itemsNum++;\n                basket += 0.50;\n                break;\n            case 5:\n                cout &lt;&lt; \"Thanks Juice has been added to your basket\" &lt;&lt; endl;\n                itemsNum++;\n                basket += 1;\n                break;\n            case 6:\n                cout &lt;&lt; \"Thanks Fizzy Pop has been added to your basket\" &lt;&lt; endl;\n                itemsNum++;\n                basket += 1;\n                break;\n            case 7:\n                cout &lt;&lt; \"Thanks Crisps has been added to your basket\" &lt;&lt; endl;\n                itemsNum++;\n                basket += 1;\n                break;\n            case 8:\n                cout &lt;&lt; \"Thanks Sandwich has been added to your basket\" &lt;&lt; endl;\n                itemsNum++;\n                basket += 2;\n                break;\n            case 9:\n                cout &lt;&lt; \"Thanks Pizza has been added to your basket\" &lt;&lt; endl;\n                itemsNum++;\n                basket += 2;\n                break;\n            case 10:\n                cout &lt;&lt; \"Thanks Cake has been added to your basket\" &lt;&lt; endl;\n                itemsNum++;\n                basket += 3;\n                break;\n            }\n        }\n    } while(itemsNum &lt; itemsWant);\n    if(choice &gt; 10) {\n        cout &lt;&lt; \"Invalid Choice! \" &lt;&lt; endl;\n    }\n\n    cout &lt;&lt; \"\\n\\nYou Purchased \" &lt;&lt; itemsNum &lt;&lt; \" Items.\" &lt;&lt; endl;\n    cout &lt;&lt; \"The Final Total is: \u00a3\" &lt;&lt; basket &lt;&lt; endl;\n    ;\n    cout &lt;&lt; \"Thanks for shopping at the small store please come again.\";\n\n    return 0;\n}\n</code></pre>\n\n<p>i expect the output to be \u00a3 but instead i get u'</p>\n"}, {"tags": ["c++", "templates", "constructor", "polymorphism", "abstract-class"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1562172438, "post_id": 56874665, "comment_id": 100297908, "body": "Related: <a href=\"https://stackoverflow.com/questions/13787901/ensure-derived-class-constructor-must-call-specific-base-class-method\" title=\"ensure derived class constructor must call specific base class method\">stackoverflow.com/questions/13787901/&hellip;</a>"}, {"owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "edited": false, "score": 0, "creation_date": 1562172517, "post_id": 56874665, "comment_id": 100297942, "body": "If you try using a function template and that type doesn&#39;t have a specific function or constructor, that will result in a compile-time error, not a runtime error. Also, if you want to be notified of things at compiletime, you should use the static_assert construct, which will prevent compilation if there&#39;s an error:  static_assert(test(), &quot;Message&quot;)"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1562172552, "post_id": 56874665, "comment_id": 100297957, "body": "You may add those constructor signatures (<code>protected</code>) to your abstract base class, thus the derived classes at least need to provide one of them."}, {"owner": {"reputation": 23, "user_id": 10182015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e889494397b73f2c50a345cdb2b8e0?s=128&d=identicon&r=PG&f=1", "display_name": "RBoston", "link": "https://stackoverflow.com/users/10182015/rboston"}, "edited": false, "score": 0, "creation_date": 1562172684, "post_id": 56874665, "comment_id": 100298028, "body": "Thanks, I saw that (and many others) in my searches before asking.  I don&#39;t have a problem with calling a parent method from a child class, I have an issue with needing a way to create compile errors if a child class doesn&#39;t have a specific constructor signature."}, {"owner": {"reputation": 23, "user_id": 10182015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e889494397b73f2c50a345cdb2b8e0?s=128&d=identicon&r=PG&f=1", "display_name": "RBoston", "link": "https://stackoverflow.com/users/10182015/rboston"}, "edited": false, "score": 0, "creation_date": 1562172798, "post_id": 56874665, "comment_id": 100298087, "body": "Thanks J. Antonio.  I tried using <code>static_assert()</code>, but there&#39;s some other issue with the g++ compiler.  I thought function templates only made the functions at run time when needed?  What would even be the test to pass to <code>static_asser()</code>?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1562178550, "post_id": 56874665, "comment_id": 100300626, "body": "Re: &quot;apparently that isn&#39;t a language feature due to vtable issues&quot; -- that&#39;s not the reason. It would certainly be possible to implement something that allowed you to declare a constructor as virtual, but it&#39;s not at all clear what that would mean. A virtual function is dispatched according to the type of the object that it&#39;s being called on. A constructor creates a new object; until the constructor has finished running the object doesn&#39;t exist."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1562197257, "post_id": 56874665, "comment_id": 100306689, "body": "<i>&quot;This will create run-time errors&quot;</i> -- could you describe the runtime errors you see when you try this? :innocent:"}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 0, "last_activity_date": 1562173539, "last_edit_date": 1562173539, "creation_date": 1562173121, "answer_id": 56874914, "question_id": 56874665, "link": "https://stackoverflow.com/questions/56874665/ensure-at-compile-time-that-all-classes-derived-from-abstract-base-class-impleme/56874914#56874914", "title": "Ensure at compile time that all classes derived from abstract base class implement specific constructor signature", "body": "<blockquote>\n  <p>This will create run-time errors if I call mode_maker with ModeC, when the function template for ModeC is created.</p>\n</blockquote>\n\n<p>No it won't.  Templates are checked at compile time.</p>\n\n<p>Template functions generate functions at compile time. Template classes generate classes at compile time.</p>\n\n<p>You may be confused by generics in Java/C#, which where inspired by and serve some of the purposes of templates, and are far more runtime based.</p>\n\n<p>C++'s equivalent of Generics is type erasure classes like std function.  This uses templates to create the glue code that Java/C# language does for you when you interact with Generics, roughly.  I would consider doing this (creating type eraser helper types, as opposed to just using std function) to be an advanced use of C++.  There are some uses of Generics in Java/C# that require this in C++; most uses.of Generics, however, can be emulated in C++ by bog standard template code.</p>\n"}], "owner": {"reputation": 23, "user_id": 10182015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e889494397b73f2c50a345cdb2b8e0?s=128&d=identicon&r=PG&f=1", "display_name": "RBoston", "link": "https://stackoverflow.com/users/10182015/rboston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562173539, "creation_date": 1562171933, "last_edit_date": 1562172948, "question_id": 56874665, "link": "https://stackoverflow.com/questions/56874665/ensure-at-compile-time-that-all-classes-derived-from-abstract-base-class-impleme", "title": "Ensure at compile time that all classes derived from abstract base class implement specific constructor signature", "body": "<p>I have an abstract base class, and multiple objects that might inherit from it.  For instance</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    class Mode {\n        public:\n        int n,l,m;\n        double omega;\n        virtual int doSomething() =0;\n        virtual ~Mode(){};\n    }\n\n    class ModeA : Mode {\n        ModeA(int N, int L, int M);\n        ModeA(double W, int L, int M);\n        virtual ~ModeA();\n        int doSomething();\n    }\n\n    class ModeB : Mode {\n        ModeB(int N, int L, int M);\n        ModeB(double W, int l, int M);\n        virtual ~ModeB();\n        int doSomething();\n    }    \n</code></pre>\n\n<p>The two child classes, <code>ModeA</code> and <code>ModeB</code> have constructors with parameters <code>(int, int, int)</code> and <code>(double, int, int)</code>.  Later, I have a piece of code that expects as <code>Mode</code> object, which looks like</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    template &lt;class MODE&gt; int mode_finder(MODE** mode_list, int num_mode, int N, int L, int M){\n        assert((std::is_base_of&lt;Mode,MODE&gt;::value));\n        for(int i=0; i&lt;num_mode; i++){\n            mode_list[i] = new MODE(N,L,M);\n             ... some more code here ...\n        }\n    }\n</code></pre>\n\n<p>(this isn't simply a function to initialize a list of modes, the <code>...some more code here...</code> part is about 300 lines long and includes checking values against a list and deleting and recreating if they don't match -- a lot of stuff has been left out of this simple working example)</p>\n\n<p>If I'm using <code>ModeA</code> and <code>ModeB</code>, then this is fine, because they have the right kind of constructors.</p>\n\n<p>My problem is that I (or whoever inherits this code) might eventually make a new type and forget to put in constructors of this form, such as</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    class ModeC : Mode {\n        ModeC(int X);\n        virtual ~modeC();\n        int doSomething();\n    }\n</code></pre>\n\n<p>This will create run-time errors if I call <code>mode_maker</code> with <code>ModeC</code>, when the function template for <code>ModeC</code> is created.</p>\n\n<p>I want for every object to inherit from <code>Mode</code> to implement constructors with two signatures: a <code>(int, int, int)</code> and <code>(double, int, int)</code> form.  If not, I want to throw a compile-time error.</p>\n\n<p>I assumed pure virtual constructors would do the trick, something like:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    virtual Mode(int, int, int) =0;\n    virtual Mode(double, int, int) =0;\n</code></pre>\n\n<p>but apparently that isn't a language feature due to vtable issues.  I don't really need entries on the vtable for anything, I just need the child classes to be forced to make constructors of this type.</p>\n\n<p>How can I do the thing I'm trying to do?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "call", "call-graph"], "comments": [{"owner": {"reputation": 11, "user_id": 11360626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47fa431b70f0243ebfdda4057035f2e3?s=128&d=identicon&r=PG&f=1", "display_name": "jj1", "link": "https://stackoverflow.com/users/11360626/jj1"}, "edited": false, "score": 0, "creation_date": 1562172227, "post_id": 56874648, "comment_id": 100297808, "body": "essentially I want to translate edges into X -&gt; Y -&gt; Z -&gt; A"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1562189384, "post_id": 56874648, "comment_id": 100304905, "body": "Your commands don&#39;t seem to match with what the answers say to do."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1562628489, "post_id": 56874648, "comment_id": 100427174, "body": "<i>&quot;I&#39;m looking for the nodes to have specific names and not just &quot;Node&quot;.&quot;</i> Well, the output file contains a name for each node. Parsing the output and getting the names doesn&#39;t seem too hard."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1562630150, "post_id": 56874648, "comment_id": 100427480, "body": "This does not seem to be a programming question. If you wish to transform text format of the dot output into different text, you need to write a program that does it. If the program doesn&#39;t do what you want, you can ask questions about that."}], "owner": {"reputation": 11, "user_id": 11360626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47fa431b70f0243ebfdda4057035f2e3?s=128&d=identicon&r=PG&f=1", "display_name": "jj1", "link": "https://stackoverflow.com/users/11360626/jj1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564013821, "creation_date": 1562171826, "last_edit_date": 1564013821, "question_id": 56874648, "link": "https://stackoverflow.com/questions/56874648/parse-call-graph", "title": "Parse Call Graph", "body": "<p>I tried this example problem:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5373714/how-to-generate-a-calling-graph-for-c-code?noredirect=1&amp;lq=1\">How to Generate a calling graph for C++ code</a></p>\n\n<p>Input using C++:</p>\n\n<pre><code>static void D() { }\nstatic void Y() { D(); }\nstatic void X() { Y(); }\nstatic void C() { D(); X(); }\nstatic void B() { C(); }\nstatic void S() { D(); }\nstatic void P() { S(); }\nstatic void O() { P(); }\nstatic void N() { O(); }\nstatic void M() { N(); }\nstatic void G() { M(); }\nstatic void A() { B(); G(); }\n\nint main() {\n  A();\n}\n</code></pre>\n\n<p>Terminal Command to receive output:</p>\n\n<blockquote>\n<pre><code>$ clang++ -Xclang -analyze -Xclang -analyzer-checker=debug.ViewCallGraph main1.cpp\n</code></pre>\n</blockquote>\n\n<p>I'm looking for a way to explicitly state the function names/calls in the output. </p>\n\n<p>After trying the solution for the link above (I tried the solution with the 8 answers), I received the following output:</p>\n\n<pre><code>digraph unnamed {\n\n     Node0x7fb2086013b0 [shape=record,label=\"{\\&lt; root \\&gt;}\"];\n     Node0x7fb2086013b0 -&gt; Node0x7fb2086013f0;\n     Node0x7fb2086013b0 -&gt; Node0x7fb208601430;\n     Node0x7fb2086013b0 -&gt; Node0x7fb208601470;\n     Node0x7fb2086013b0 -&gt; Node0x7fb2086014b0;\n     Node0x7fb2086013b0 -&gt; Node0x7fb2086014f0;\n     Node0x7fb2086013b0 -&gt; Node0x7fb208601530;\n     Node0x7fb2086013b0 -&gt; Node0x7fb2086015d0;\n     Node0x7fb2086013b0 -&gt; Node0x7fb208601610;\n     Node0x7fb2086013b0 -&gt; Node0x7fb208601650;\n     Node0x7fb2086013b0 -&gt; Node0x7fb208601690;\n     Node0x7fb2086013b0 -&gt; Node0x7fb2086016d0;\n     Node0x7fb2086013b0 -&gt; Node0x7fb208601710;\n     Node0x7fb2086013b0 -&gt; Node0x7fb208601810;\n     Node0x7fb208601470 [shape=record,label=\"{X}\"];\n     Node0x7fb208601470 -&gt; Node0x7fb208601430;\n     Node0x7fb2086014f0 [shape=record,label=\"{B}\"];\n     Node0x7fb2086014f0 -&gt; Node0x7fb2086014b0;\n     Node0x7fb208601650 [shape=record,label=\"{N}\"];\n     Node0x7fb208601650 -&gt; Node0x7fb208601610;\n     Node0x7fb208601430 [shape=record,label=\"{Y}\"];\n     Node0x7fb208601430 -&gt; Node0x7fb2086013f0;\n     Node0x7fb2086015d0 [shape=record,label=\"{P}\"];\n     Node0x7fb2086015d0 -&gt; Node0x7fb208601530;\n     Node0x7fb208601710 [shape=record,label=\"{A}\"];\n     Node0x7fb208601710 -&gt; Node0x7fb2086014f0;\n     Node0x7fb208601710 -&gt; Node0x7fb2086016d0;\n     Node0x7fb208601690 [shape=record,label=\"{M}\"];\n     Node0x7fb208601690 -&gt; Node0x7fb208601650;\n     Node0x7fb2086014b0 [shape=record,label=\"{C}\"];\n     Node0x7fb2086014b0 -&gt; Node0x7fb2086013f0;\n     Node0x7fb2086014b0 -&gt; Node0x7fb208601470;\n     Node0x7fb2086016d0 [shape=record,label=\"{G}\"];\n     Node0x7fb2086016d0 -&gt; Node0x7fb208601690;\n     Node0x7fb208601530 [shape=record,label=\"{S}\"];\n     Node0x7fb208601530 -&gt; Node0x7fb2086013f0;\n     Node0x7fb2086013f0 [shape=record,label=\"{D}\"];\n     Node0x7fb208601610 [shape=record,label=\"{O}\"];\n     Node0x7fb208601610 -&gt; Node0x7fb2086015d0;\n     Node0x7fb208601810 [shape=record,label=\"{main}\"];\n     Node0x7fb208601810 -&gt; Node0x7fb208601710;\n}\n</code></pre>\n\n<p>I'm looking for the nodes to have specific names and not just \"Node\". </p>\n\n<p>What's a good way to start parsing nodes and edges for specific names. I'm looking for something like: X->Y->Z etc. </p>\n"}, {"tags": ["c++", "string-view", "cpp-core-guidelines", "guideline-support-library", "string-span"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562171504, "post_id": 56874532, "comment_id": 100297464, "body": "Any reason you aren&#39;t just using <code>std::strings</code> and calling <code>c_str()</code> at the call site, or provide a wrapper for the C function that takes <code>std::string</code>&#39;s and forwards the <code>c_str()</code> inside?"}, {"owner": {"reputation": 8973, "user_id": 713961, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/30e8520a25cb0fa4a91acca77059244d?s=128&d=identicon&r=PG", "display_name": "Matt Kline", "link": "https://stackoverflow.com/users/713961/matt-kline"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562171828, "post_id": 56874532, "comment_id": 100297611, "body": "That&#39;s what I&#39;m doing currently, but the entire purpose of <code>string_span</code> and friends is to avoid copies when all you need is a non-owning view into a string. See <a href=\"http://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#Rstr-view\" rel=\"nofollow noreferrer\">isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#Rstr-vi&zwnj;&#8203;ew</a> and the related Core Guidelines advice on string handling."}], "answers": [{"tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 0, "last_activity_date": 1562181593, "creation_date": 1562181593, "answer_id": 56876715, "question_id": 56874532, "link": "https://stackoverflow.com/questions/56874532/using-gslzstring-view-with-c-apis/56876715#56876715", "title": "Using gsl::zstring_view with C APIs", "body": "<p>It's \"cumbersome\" in part because it's intended to be.</p>\n\n<p>This:</p>\n\n<pre><code>zstring_span&lt;&gt; to_zspan(std::string&amp; s) { return ensure_z(s); }\n</code></pre>\n\n<p>Is <em>not</em> a safe operation. Why? Because while it is true that <code>s</code> is NUL terminated, it is entirely possible that the actual <code>s</code> contains internal NUL characters. That's a legitimate thing you can do with <code>std::string</code>, but <code>zstring_span</code> and whomever takes it can't handle that. They'll truncate the string.</p>\n\n<p>By contrast, <code>string_span/view</code> conversions are safe from this perspective. Consumers of such strings take a sized string and thus can handle embedded NULs.</p>\n\n<p>Because the <code>zstring_span</code> conversion is unsafe, there should be some <em>explicit</em> notation that something potentially unsafe is being done. <code>ensure_z</code> represents that explicit notation.</p>\n\n<p>Another problem is that C++ has no mechanism to tell the difference between a literal string argument and any old <code>const char*</code> or <code>const char[]</code> parameter. Since a bare <code>const char*</code> may or may not be a string literal, you have to assume that it isn't and therefore use a more verbose conversion.</p>\n\n<p>Also, C++ string literals can contain embedded NUL characters, so the above reasoning applies.</p>\n\n<p>The <code>const</code> issue seems like a code bug, and you should probably file it as such.</p>\n"}, {"tags": [], "owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "is_accepted": false, "score": 1, "last_activity_date": 1582886722, "last_edit_date": 1582886722, "creation_date": 1582884835, "answer_id": 60449553, "question_id": 56874532, "link": "https://stackoverflow.com/questions/56874532/using-gslzstring-view-with-c-apis/60449553#60449553", "title": "Using gsl::zstring_view with C APIs", "body": "<blockquote>\n  <ol>\n  <li>it also seems odd that a literal (which is guaranteed to be null-terminated) isn't implicitly convertible to a <code>zstring_span</code></li>\n  </ol>\n</blockquote>\n\n<p>A string literal is of type <code>const char[...]</code>. There is no information in the type that this <code>const char</code> array is a null terminated string. Here is some other code with the same types, but without null termination where <code>ensure_z</code> will fail fast.</p>\n\n<pre><code>const char foo_arr[4]{ 'o', 'd', 'd', '-' };\nensure_z(foo_arr);\n</code></pre>\n\n<p>Both <code>\"foo\"</code> and <code>foo_arr</code> are of type <code>const char[4]</code>, but only the string literal is null terminated while <code>foo_arr</code> is not.</p>\n\n<p>Please note that your combination of <code>ensure_z</code> and <code>czstring_span&lt;&gt;</code> compiles, but it does not work. <code>ensure_z</code> returns only the string without the terminating null byte. When you pass that to the <code>czstring_span&lt;&gt;</code> constructor, then the constructor will fail searching for the null byte (which was cut off by <code>ensure_z</code>).</p>\n\n<p>You need to convert the string literal to a span and pass that to the constructor:</p>\n\n<pre><code>czstring_span&lt;&gt; foo = ensure_span(\"odd\");\n</code></pre>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>There's a similar oddity with <code>std::string</code>, which is implicitly convertible to <code>string_span</code>, but not <code>zstring_span</code></li>\n  </ol>\n</blockquote>\n\n<p>Good point. There is a constructor for <code>string_span</code> that takes a <code>std::string</code>, but for <code>zstring_span</code> there is only a constructor taking the internal implementation type, a <code>span&lt;char&gt;</code>. For <code>span</code> there is a constructor taking a \"container\" having <code>.data()</code> and <code>.size()</code> - which <code>std::string</code> implements.  Even worse: the following code compiles but will not work:</p>\n\n<pre><code>zstring_span&lt;&gt; to_zspan(std::string&amp; s) { return zstring_span&lt;&gt;{s}; }\n</code></pre>\n\n<p>You should consider filing an issue in the GSL repo to get the classes aligned. I am not sure if the implicit conversions are a good idea, so I prefer how it is done in <code>zstring_span</code> over how <code>string_span</code> does it.</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>There seems to be some const-correctness issues.</li>\n  </ol>\n</blockquote>\n\n<p>Also here my first idea of <code>czstring_span&lt;&gt; to_czspan(const std::string&amp; s) { return czstring_span&lt;&gt;{s}; }</code> compiles but does not work. Another solution would be a new function <code>ensure_cz</code> that returns a <code>span&lt;const char, ...&gt;</code>. You should consider filing an issue.</p>\n\n<blockquote>\n  <ol start=\"4\">\n  <li><code>assume_z()</code></li>\n  </ol>\n</blockquote>\n\n<p>The existance of <code>empty()</code> and the code in <code>as_string_span()</code> suggest that the class was meant to be able to handle empty string spans. In that case <code>as_string_span</code> would always return the string without terminating null byte, <code>ensure_z</code> would return the string with terminating null byte, failing if empty, and <code>assume_z</code> would assume that <code>!empty()</code> and return the string with terminating null byte.</p>\n\n<p>But the one and only constructor is taking a non-empty span of characters, so <code>empty()</code> can never be <code>true</code>. I just created a <a href=\"https://github.com/microsoft/GSL/pull/850\" rel=\"nofollow noreferrer\">PR</a> to address these inconsistencies. Please consider filing an issue if you think that more should be changed.</p>\n\n<blockquote>\n  <p>If <code>zstring_span</code> is designed \"to convert zero-terminated spans to legacy strings\", why does its use here seem so cumbersome? Am I misusing it? Is there something I'm overlooking?</p>\n</blockquote>\n\n<p>In pure C++ code I prefer <code>std::string_view</code>, <code>zstring_span</code> is only for C interop, that limits its use. And of course you must know the guidelines and the guideline support library. Given that I bet that <code>zstring_span</code> is rarely been used and that you are one of the very few people taking a deep look into it.</p>\n"}], "owner": {"reputation": 8973, "user_id": 713961, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/30e8520a25cb0fa4a91acca77059244d?s=128&d=identicon&r=PG", "display_name": "Matt Kline", "link": "https://stackoverflow.com/users/713961/matt-kline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1582886722, "creation_date": 1562171342, "last_edit_date": 1562172834, "question_id": 56874532, "link": "https://stackoverflow.com/questions/56874532/using-gslzstring-view-with-c-apis", "title": "Using gsl::zstring_view with C APIs", "body": "<p>I'm trying to use modern string-handling approaches (like <a href=\"https://en.cppreference.com/w/cpp/string/basic_string_view\" rel=\"nofollow noreferrer\"><code>std::string_view</code></a> or <a href=\"https://github.com/microsoft/GSL/blob/66809c6852a0250243db893ab5460bfdace063c4/include/gsl/string_span\" rel=\"nofollow noreferrer\">GSL's <code>string_span</code></a>) to interact with a C API (DBus) that takes strings as null-terminated <code>const char*</code>s, e.g.</p>\n\n<pre><code>DBusMessage* dbus_message_new_method_call(\n    const char* destination,\n    const char* path,\n    const char* iface,\n    const char* method \n    )\n</code></pre>\n\n<p><code>string_view</code> and <code>string_span</code> don't guarantee that their contents are null-terminated - since spans are <code>(char* start, ptrdiff_t length)</code> pairs, that's largely the point. But GSL also provides a <code>zstring_view</code>, which <em>is</em> guaranteed to be null-terminated. The <a href=\"https://github.com/microsoft/GSL/blob/66809c6852a0250243db893ab5460bfdace063c4/include/gsl/string_span#L389-L390\" rel=\"nofollow noreferrer\">comments</a> around <code>zstring_span</code> suggest that it's designed exactly for working with legacy and C APIs, but I ran into several sticking points as soon as I started using it:</p>\n\n<ol>\n<li><p>Representing a string literal as a <code>string_span</code> is trivial:</p>\n\n<pre><code>cstring_span&lt;&gt; bar = \"easy peasy\";\n</code></pre>\n\n<p>but representing one as a <code>zstring_span</code> requires you to wrap the literal in a helper function:</p>\n\n<pre><code>czstring_span&lt;&gt; foo = ensure_z(\"odd\");\n</code></pre>\n\n<p>This makes declarations noisier, and it also seems odd that a literal (which is guaranteed to be null-terminated) isn't implicitly convertible to a <code>zstring_span</code>. <code>ensure_z()</code> also isn't <code>constexpr</code>, unlike constructors and conversions for <code>string_span</code>.</p></li>\n<li><p>There's a similar oddity with <code>std::string</code>, which is implicitly convertible to <code>string_span</code>, but not <code>zstring_span</code>, even though <code>std::string::data()</code> has been guaranteed to return a null-terminated sequence since C++11. Again, you have to call <code>ensure_z()</code>:</p>\n\n<pre><code>zstring_span&lt;&gt; to_zspan(std::string&amp; s) { return ensure_z(s); }\n</code></pre></li>\n<li><p>There seems to be some const-correctness issues. The above works, but</p>\n\n<pre><code>czstring_span&lt;&gt; to_czspan(const std::string&amp; s) { return ensure_z(s); }\n</code></pre>\n\n<p>fails to compile, with errors about being unable to convert from <code>span&lt;char, ...&gt;</code> to <code>span&lt;const char, ...&gt;</code></p></li>\n<li><p>This is a smaller point than the others, but the member function that returns a <code>char*</code> (which you would feed to a C API like DBus) is called <code>assume_z()</code>. What's being <em>assumed</em> when the constructor of <code>zstring_span</code> <a href=\"https://github.com/microsoft/GSL/blob/66809c6852a0250243db893ab5460bfdace063c4/include/gsl/string_span#L406-L410\" rel=\"nofollow noreferrer\">expects a null-terminated range</a>?</p></li>\n</ol>\n\n<p>If <code>zstring_span</code> is designed \"to convert zero-terminated spans to legacy strings\", why does its use here seem so cumbersome? Am I misusing it? Is there something I'm overlooking?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1562171285, "post_id": 56874484, "comment_id": 100297357, "body": "What about using an <i>interface</i> in 1st place? To add extensions you might want to add more interfaces."}, {"owner": {"reputation": 4581, "user_id": 682466, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f59c63feba66c8eae54b0edc2b01bd8?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/682466/taylor"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1562171361, "post_id": 56874484, "comment_id": 100297396, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 <code>Base</code> is an interface. What do you mean?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1562171418, "post_id": 56874484, "comment_id": 100297419, "body": "ATM we can see only <code>struct Base { ... stuff ... };</code>??"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1562171512, "post_id": 56874484, "comment_id": 100297465, "body": "@Taylor <code>hasColor</code> should be an interface too."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1562171557, "post_id": 56874484, "comment_id": 100297492, "body": "the google style guide is targeted at the google code base. Wouldnt be the first time I see one of their suggestions that doesnt apply elsewhere. Dont follow them blindly"}, {"owner": {"reputation": 4581, "user_id": 682466, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f59c63feba66c8eae54b0edc2b01bd8?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/682466/taylor"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1562171580, "post_id": 56874484, "comment_id": 100297508, "body": "@formerlyknownas_463035818 Who said I&#39;m following anything blindly?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1562171614, "post_id": 56874484, "comment_id": 100297525, "body": "I see no reason not to use <code>dynamic_cast</code> and the only thing you mention is that style guide."}, {"owner": {"reputation": 4581, "user_id": 682466, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f59c63feba66c8eae54b0edc2b01bd8?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/682466/taylor"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1562171922, "post_id": 56874484, "comment_id": 100297660, "body": "@MartinBonner <code>HasColor</code> is an interface. Notice the pure virtuals."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1562172024, "post_id": 56874484, "comment_id": 100297699, "body": "You can avoid doing it explicitly by moving it into the base, hidden behind a function template that does the cast. I don\u2019t think you can get rid of it completely without essentially implementing your own RTTI system."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1562172327, "post_id": 56874484, "comment_id": 100297856, "body": "i second molbdnilo, what you want is: Infer the type at runtime. This is rtti, so you either use it or end up building your own."}], "answers": [{"comments": [{"owner": {"reputation": 4581, "user_id": 682466, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f59c63feba66c8eae54b0edc2b01bd8?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/682466/taylor"}, "edited": false, "score": 0, "creation_date": 1562171813, "post_id": 56874614, "comment_id": 100297604, "body": "Do you consider the visitor pattern RTTI?"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1562172166, "last_edit_date": 1562172166, "creation_date": 1562171679, "answer_id": 56874614, "question_id": 56874484, "link": "https://stackoverflow.com/questions/56874484/avoiding-dynamic-cast-without-increasing-coupling/56874614#56874614", "title": "avoiding dynamic_cast without increasing coupling", "body": "<p>If you have a collection of all kinds of things, some that are <code>HasColor</code> and others that aren't, then you must rely on <code>dynamic_cast</code> or similar RTTI in order to use the objects as <code>HasColor</code> or you must invert the dependency using visitor pattern, which introduces the coupling that is your problem.</p>\n\n<p>A solution that does not require the use of <code>dynamic_cast</code> or other RTTI is to use a collection of only <code>HasColor</code> instances.</p>\n"}], "owner": {"reputation": 4581, "user_id": 682466, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f59c63feba66c8eae54b0edc2b01bd8?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/682466/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562172389, "creation_date": 1562171146, "last_edit_date": 1562172389, "question_id": 56874484, "link": "https://stackoverflow.com/questions/56874484/avoiding-dynamic-cast-without-increasing-coupling", "title": "avoiding dynamic_cast without increasing coupling", "body": "<p>Suppose I want to avoid <code>dynamic_cast</code> in the following code:</p>\n\n<pre><code>struct Base { ... stuff ... };\nstruct HasColor {\n  virtual Color getColor() const = 0;\n  virtual void setColor(Color) = 0;\n};\nstruct Foo : public Base, public HasColor {\n  ... implements HasColor methods\n};\n\n...\n\nvector&lt;Base*&gt; collection;\n...\nfor(auto element : collection) {\n   if(auto hasColor = dynamic_cast&lt;HasColor*&gt;(element)) {\n      hasColor-&gt;SetColor(myColor);\n   }\n}\n</code></pre>\n\n<p>One solution is to add a method to downcast:</p>\n\n<pre><code>struct Base {\n  HasColor* toHasColor() { return nullptr; }\n};\nstruct Foo : public Base, public HasColor {\n  ...\n  HasColor* toHasColor() { return this; }\n};\n</code></pre>\n\n<p>But this means that <code>Base</code> needs to know about every <code>Has</code> interface, increasing coupling.</p>\n\n<p>Let's try the visitor pattern:</p>\n\n<pre><code>struct BaseVisitor {\n   void visitHasColor(HasColor&amp; hasColor) = 0\n};\nstruct Base {\n   virtual void visit(BaseVisitor&amp; visitor) = 0;\n};\n</code></pre>\n\n<p>But we are left with the same issue: each <code>Has</code> class needs to be added to <code>BaseVisitor</code>, causing more coupling and more recompilation (this being C++, each modification to <code>Base</code> means waiting a few minutes).</p>\n\n<p>This gets worse if I want to support plugins. A plugin cannot modify <code>Base</code> or <code>BaseVisitor</code>, so then plugins can't add additional <code>Has</code> classes. (I realize that typical C++ RTTI may not work well between libraries, however I've seen one custom RTTI system that does, and apparently the one in Qt does.)</p>\n\n<p><strong>Can I avoid RTTI/<code>dynamic_cast</code> while keeping my code extensible?</strong></p>\n\n<p><a href=\"https://stackoverflow.com/questions/580270/avoiding-dynamic-cast-rtti\">This question</a> seems similar. In my case, I'm open to other ways to represent my data in the first place.</p>\n\n<p>(It is recommended to avoid <code>dynamic_cast</code> in C++ style guides such as <a href=\"https://google.github.io/styleguide/cppguide.html#Run-Time_Type_Information__RTTI_\" rel=\"nofollow noreferrer\">this one</a>.)</p>\n"}, {"tags": ["c++", "rendering", "sdl", "sdl-2"], "comments": [{"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1562175383, "post_id": 56874311, "comment_id": 100299280, "body": "Write pixels directly to SDL_Surface (that is quite close to what doom did) or use 3D rendering API to have GPU draw at lest quads, not lines. SDL_Renderer is not a 3D renderer. GPU is extremely fast if you do things in intended way, but your rendering method is suited much better for CPU."}], "owner": {"reputation": 11, "user_id": 5759953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869151ad450dfb8303a308452480dc9a?s=128&d=identicon&r=PG&f=1", "display_name": "tho.hil", "link": "https://stackoverflow.com/users/5759953/tho-hil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562178123, "creation_date": 1562170471, "last_edit_date": 1562178123, "question_id": 56874311, "link": "https://stackoverflow.com/questions/56874311/poor-performance-with-doom-style-3d-engine-in-sdl", "title": "Poor performance with Doom-style 3D engine in SDL?", "body": "<p>I am trying to make a doom style 3d rendering engine using SDL2, however, i am running into a bit of performance problems. i am running it on my laptop that uses a AMD Radeon R7 M260X but i am barely able to keep the program running at a stable 60fps, and the program hovers around 40% GPU usage. the window i am rendering to is 1067/600.</p>\n\n<p>for right now the camera uses a fixed camera angle</p>\n\n<pre><code>void drawWall(XY p1, XY p2, XY p3, XY p4, float dis1, float dis2)\n{\n\n    float dx1 = 0;\n    float dx2 = 0;\n    float dDis = 0;\n    float y1 = p1.Y;\n    float y2 = p3.Y;\n    float dis = dis1;\n    int xLen = p2.X - p1.X;\n\n    if (p2.X - p1.X != 0) \n        dx1 = (p2.Y - p1.Y) / (p2.X - p1.X);\n    if (p4.X - p3.X != 0) \n        dx2 = (p4.Y - p3.Y) / (p4.X - p3.X);\n    if (dis2 - dis1 != 0)\n        dDis = (dis2 - dis1) / (p2.X - p1.X);\n    float du = 0;\n    if (p1.X &lt; 0)\n    {\n        int d1 = - p1.X;\n        du = d1;\n        p1.X = 0;\n        y1 += dx1*d1;\n        y2 += dx2*d1;\n        dis += dDis*d1;\n    }\n\n\n\n    float o =  100*(1/(dis));\n\n    for (int x1 = p1.X; x1 &lt;= p2.X &amp;&amp; x1 &lt; SCREEN_WIDTH; x1++, y1 += dx1, y2 += dx2, dis += dDis, du++)\n    {\n        SDL_Rect r1 = { (du / (xLen+1))*gField4.getWidth(), 0, 1,  gField4.getHeight()};\n        SDL_Rect r2 = {x1, y2, 1, y1-y2};\n        //float shade = 252 - dis;\n        //gField4.setColorMod(shade, shade, shade);\n        gField4.render(0, 0, &amp;r1, &amp;r2);\n    }\n\n\n}\n\n\nvoid drawFloor(XY Camera, float height)\n{\n\n    float fowHalf = M_PI / 4;\n    float farP = height;\n    float nearP = 0;\n    XY far1 = {Camera.X +  cosf(-M_PI/2 - fowHalf)*farP, Camera.Y + sinf(-M_PI / 2 - fowHalf)*farP };\n    XY near1 = { Camera.X + cosf(-M_PI / 2 - fowHalf)*nearP, Camera.Y + sinf(-M_PI / 2 - fowHalf)*nearP };\n    XY far2 = { Camera.X + cosf(-M_PI / 2 + fowHalf)*farP, Camera.Y + sinf(-M_PI / 2 + fowHalf)*farP };\n    XY near2 = { Camera.X + cosf(-M_PI / 2 + fowHalf)*nearP, Camera.Y + sinf(-M_PI / 2 + fowHalf)*nearP };\n\n    for (int i = 1; i &lt; SCREEN_HEIGHT/2; i++)\n    {\n        float sampleDept = (float)i / ((float)SCREEN_HEIGHT / 2.0f);\n\n        XY start = {(far1.X - near1.X)/sampleDept + near1.X, (far1.Y - near1.Y)/sampleDept + near1.Y };\n        XY end = { (far2.X - near2.X)/sampleDept + near2.X, (far2.Y - near2.Y)/sampleDept + near2.Y };\n        SDL_Rect r1 = {start.X*gField3.getWidth(),start.Y*gField3.getHeight(),  end.X*gField3.getWidth()- start.X*gField3.getWidth() , 1 };\n        SDL_Rect r2 = {0, i+ SCREEN_HEIGHT / 2, SCREEN_WIDTH, 1 };\n        if (r1.x &lt; 0)\n        {\n            float d = -(float)r1.x / (float)r1.w;\n            r2.x = SCREEN_WIDTH*d;\n            r2.w = SCREEN_WIDTH - SCREEN_WIDTH*d;\n        }\n        if (r1.x+ r1.w &gt; gField3.getWidth())\n        {\n            float d = ((float)r1.x + (float)r1.w - (float)gField3.getWidth())/ (float)r1.w;\n            r2.w = r2.w - r2.w*d;\n        }\n\n        gField3.render(0, 0, &amp;r1, &amp;r2);\n    }\n\n}\n\nvoid drawWalls(XY Camera, double height)\n{\n    for (Wall wall  : walls)\n    {\n        XY xy1 = wall.xy1;\n        XY xy2 = wall.xy2;\n        if (wall.xy1.X &lt; wall.xy2.X)\n        {\n            xy2 = wall.xy1;\n            xy1 = wall.xy2;\n        }\n\n        XY l1 = { xy1.X - Camera.X, xy1.Y - Camera.Y };\n        XY l2 = { xy2.X - Camera.X, xy2.Y - Camera.Y };\n\n\n\n        double Zdis1 = l1.Y;\n        double Xdis1 = l1.X;\n        double Zdis2 = l2.Y;\n        double Xdis2 = l2.X;\n\n\n        XY point1 = { -Xdis1 * (SCREEN_WIDTH / 2) / Zdis1, 10*SCREEN_WIDTH / Zdis1 };\n        XY point2 = { -Xdis2 * (SCREEN_WIDTH / 2) / Zdis2, 10*SCREEN_WIDTH / Zdis2 };\n        XY p1 = { SCREEN_WIDTH / 2 + point1.X, SCREEN_HEIGHT / 2 - (wall.h1 - height)*point1.Y };\n        XY p2 = { SCREEN_WIDTH / 2 + point2.X, SCREEN_HEIGHT / 2 - (wall.h1 - height)*point2.Y };\n        XY p3 = { SCREEN_WIDTH / 2 + point1.X, SCREEN_HEIGHT / 2 - (wall.h2 - height)*point1.Y };\n        XY p4 = { SCREEN_WIDTH / 2 + point2.X, SCREEN_HEIGHT / 2 - (wall.h2 - height)*point2.Y };\n\n\n        if (!((p1.X &lt; 0 &amp;&amp; p2.X &lt; 0) || (p1.X &gt; SCREEN_WIDTH &amp;&amp; p2.X &gt; SCREEN_WIDTH)))\n        {\n            drawWall( p1, p2, p3, p4, l1.Y, l2.Y);\n        }\n    }\n}\n</code></pre>\n\n<p>the .render() method for the gfields Render a clip of a texture Using SDL_RenderCopyEx()</p>\n\n<p>i have tried commenting out the gfields.render() method calls, which makes the GPU usage go down to like 40%, so my guess is that its because i am calling SDL_RenderCopyEx() a couple 1000 times per frame which is causing the performance problem. \nBut i don't really know what i can do to fix it, since i have to render every line of the wall and floor seperatly, does anyone know how i can boost the performance here?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1562170690, "post_id": 56874271, "comment_id": 100297058, "body": "Using single-character names for variables other than loop counters is bad practice and makes for unreadable code. What are <code>s</code> and <code>e</code>? (I assume that they&#39;re start and end (+1) indices, but that&#39;s just from context)"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1562171281, "post_id": 56874271, "comment_id": 100297354, "body": "<code>b[0]</code> invokes undefined behaviour.  There is no element zero."}, {"owner": {"reputation": 69, "user_id": 11724731, "user_type": "registered", "profile_image": "https://graph.facebook.com/1086771154850612/picture?type=large", "display_name": "Bharath Karukola", "link": "https://stackoverflow.com/users/11724731/bharath-karukola"}, "edited": false, "score": 0, "creation_date": 1562176724, "post_id": 56874271, "comment_id": 100299840, "body": "Then what is the right way to declare vector b?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562179699, "post_id": 56874271, "comment_id": 100301134, "body": "@BharathKarukola There&#39;s nothing wrong with your declaration of <code>b</code>, but <code>b</code> is empty so you shouldn&#39;t try to access elements in it. See my updated answer for some of the many possible fixes."}], "answers": [{"comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1562171423, "post_id": 56874390, "comment_id": 100297423, "body": "Why are people upvoting this answer?  The question is a bad question, should be (and soon will be) closed, and should not be answered."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1562172233, "post_id": 56874390, "comment_id": 100297815, "body": "@MartinBonner Perhaps ... but even if a question <i>is</i> bad (which I personally don&#39;t think one is) the answer may still be useful. It may be hard to search for help for a new guy in cases like this and I don&#39;t think suggesting to use a debugger would help either."}], "tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": true, "score": 7, "last_activity_date": 1562179602, "last_edit_date": 1562179602, "creation_date": 1562170794, "answer_id": 56874390, "question_id": 56874271, "link": "https://stackoverflow.com/questions/56874271/reverse-function-defined-by-me-is-not-printing-the-result/56874390#56874390", "title": "Reverse function defined by me is not printing the result", "body": "<p>Your push <code>b[0].push_back(0);</code> is \"illegal\". <code>b</code> doesn't have element 0. Anything after that has <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behaviour</a> due to <a href=\"https://en.cppreference.com/w/cpp/language/ub#Access_out_of_bounds\" rel=\"nofollow noreferrer\">access out of bounds</a>.</p>\n\n<p>You can fix it by creating <code>b</code> containing 2 default constructed <code>vector&lt;int&gt;</code>s</p>\n\n<pre><code>vector&lt;vector&lt;int&gt;&gt; b(2);\n</code></pre>\n\n<p>or by adding a default constructed <code>vector&lt;int&gt;</code> as you go:</p>\n\n<pre><code>vector&lt;vector&lt;int&gt;&gt; b;\nb.emplace_back();\nb.back().push_back(0);\nb.back().push_back(2);\nb.emplace_back();\nb.back().push_back(0);\nb.back().push_back(3);\n</code></pre>\n\n<p>or by preparing a temporary <code>vector&lt;int&gt;</code> that you then move into <code>b</code>.</p>\n\n<pre><code>vector&lt;vector&lt;int&gt;&gt; b;\nvector&lt;int&gt; tmp;\ntmp.push_back(0);\ntmp.push_back(2);\nb.emplace_back(std::move(tmp));\ntmp.clear();\ntmp.push_back(0);\ntmp.push_back(3);\nb.emplace_back(std::move(tmp));\ntmp.clear();\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 11724731, "user_type": "registered", "profile_image": "https://graph.facebook.com/1086771154850612/picture?type=large", "display_name": "Bharath Karukola", "link": "https://stackoverflow.com/users/11724731/bharath-karukola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56874390, "answer_count": 1, "score": -2, "last_activity_date": 1562179602, "creation_date": 1562170327, "last_edit_date": 1562170614, "question_id": 56874271, "link": "https://stackoverflow.com/questions/56874271/reverse-function-defined-by-me-is-not-printing-the-result", "title": "Reverse function defined by me is not printing the result", "body": "<p>In int main() function if I use declare vector b is not printing the result. If I erase the vector b then the expected result is printed. Why the presence of vector b is obstructing the printing of reverse function?</p>\n\n<p>I erase the vector b then the expected result is printed. The presence of vector b is obstructing the printing of reverse function</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nint reverse(vector&lt;int&gt; a, int s, int e) {\n    while(s &lt; e) {\n        int temp = a[s];\n        a[s] = a[e - 1];\n        a[e - 1] = temp;\n        s++;\n        e--;\n    }\n    for(int i = 0; i &lt; a.size(); i++) {\n        cout &lt;&lt; a[i] &lt;&lt; \" \";\n    }\n}\n\nint main() {\n    vector&lt;int&gt; a;\n\n    a.push_back(1);\n    a.push_back(3);\n    a.push_back(5);\n    a.push_back(7);\n    a.push_back(9);\n\n    vector&lt;vector&lt;int&gt;&gt; b;\n    b[0].push_back(0);\n    b[0].push_back(2);\n    b[1].push_back(0);\n    b[1].push_back(3);\n\n    reverse(a, 0, 5);\n}\n</code></pre>\n\n<p>Expected result: <code>9 7 5 3 1</code><br>\nNo error message but the expected result is not printed.</p>\n"}, {"tags": ["c++", "visual-studio", "static-linking", "dynamic-linking"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1562170556, "post_id": 56874129, "comment_id": 100296993, "body": "You will need to create 2 new configurations (for total of 4).  And set the runtime library and debug/release options in each one. So you will end up with 4 builds in total /MTd, /MT, /MDd, /MD, etc."}, {"owner": {"reputation": 163, "user_id": 10077673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fff83398af8ae0fec59673b135b31d?s=128&d=identicon&r=PG&f=1", "display_name": "froz", "link": "https://stackoverflow.com/users/10077673/froz"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1562170723, "post_id": 56874129, "comment_id": 100297079, "body": "How can I do this?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1562171114, "post_id": 56874129, "comment_id": 100297268, "body": "<code>Build &gt; Configuration Manager ...</code> Open the Active solution configurations dropdown and click <code>&lt;New..&gt;</code> fill in the configuration details."}, {"owner": {"reputation": 163, "user_id": 10077673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fff83398af8ae0fec59673b135b31d?s=128&d=identicon&r=PG&f=1", "display_name": "froz", "link": "https://stackoverflow.com/users/10077673/froz"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1562171355, "post_id": 56874129, "comment_id": 100297395, "body": "But at then end, I want only one .exe in release. What you propose is to make two different builds. My goal is, in one executable to have some libraries that are dynamically linked and other that are statically linked?"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 2, "creation_date": 1562171455, "post_id": 56874129, "comment_id": 100297435, "body": "Why are you trying to link with both the static and dynamic runtime libraries?  You need to choose one or the other."}, {"owner": {"reputation": 163, "user_id": 10077673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fff83398af8ae0fec59673b135b31d?s=128&d=identicon&r=PG&f=1", "display_name": "froz", "link": "https://stackoverflow.com/users/10077673/froz"}, "edited": false, "score": 0, "creation_date": 1562171513, "post_id": 56874129, "comment_id": 100297466, "body": "Because I have some libraries that can only be linked dynamically, for legal reasons and other that I have to link statically"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1562171593, "post_id": 56874129, "comment_id": 100297516, "body": "You can&#39;t mix both in the same build, as you will get multiple instances of the runtime support library."}, {"owner": {"reputation": 163, "user_id": 10077673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fff83398af8ae0fec59673b135b31d?s=128&d=identicon&r=PG&f=1", "display_name": "froz", "link": "https://stackoverflow.com/users/10077673/froz"}, "edited": false, "score": 0, "creation_date": 1562171674, "post_id": 56874129, "comment_id": 100297544, "body": "Arf... Is it specific to visual studio? In QT creator, it is possible"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1562171746, "post_id": 56874129, "comment_id": 100297575, "body": "It is undefined behavior to mix and match runtimes on windows. Your program may appear to work but end up crashing or randomly giving you the wrong result."}], "owner": {"reputation": 163, "user_id": 10077673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fff83398af8ae0fec59673b135b31d?s=128&d=identicon&r=PG&f=1", "display_name": "froz", "link": "https://stackoverflow.com/users/10077673/froz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562169808, "creation_date": 1562169808, "question_id": 56874129, "link": "https://stackoverflow.com/questions/56874129/linking-static-and-dynamic-libraries-in-same-visual-studio-project", "title": "Linking static and dynamic libraries in same visual studio project", "body": "<p>I am trying to link static and dynamic libraries in the same project in visual studio 2019. The thing is:</p>\n\n<ul>\n<li>In <strong>project properties -> C/C++ -> Code Generation</strong>, when I select MT for Runtime library, my dynamic library creates a <em>problem mismatch detected for runtimeLibrary: value MD_DynamicRelease doesn't match value MT_StaticRelease.</em></li>\n<li>In <strong>project properties -> C/C++ -> Code Generation</strong>, when I select MD for Runtime library, my static library creates the same problem</li>\n</ul>\n\n<p>I have read other posts like <a href=\"https://stackoverflow.com/questions/1009098/linking-with-both-static-and-dynamic-libraries-in-msvc\">Linking with both static and dynamic libraries in MSVC</a> but there is no explanation on how to link both statically and dynamically in the project.\nCould you please explain me how I can proceed?</p>\n"}, {"tags": ["c#", "c++", "swig"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 0, "creation_date": 1562170167, "post_id": 56874025, "comment_id": 100296826, "body": "I don&#39;t know swig, but IntelliSense in Visual Studio, or Visual Studio&#39;s object browser (right-click on the type name, select &quot;Go to definition&quot; from the context menu) should be able to tell you which methods/fields/properties/indexers are provided by that swig-generated <code>SWIGTYPE_p_std__vectorT_unsigned_char_t</code> and <code>MapStringString</code> types. I hope it shouldn&#39;t be too difficult once you actually see/know the methods/fields/properties/indexers  provided by those types..."}, {"owner": {"reputation": 1179, "user_id": 429775, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51d83af17b3272f2a1b34cf56880413b?s=128&d=identicon&r=PG", "display_name": "Andrey Rubliov", "link": "https://stackoverflow.com/users/429775/andrey-rubliov"}, "edited": false, "score": 0, "creation_date": 1562170497, "post_id": 56874025, "comment_id": 100296961, "body": "Thanks! SWIGTYPE_p_std__vectorT_unsigned_char_t in Visual Studio shows to me 4 methods: Equals, GetHashCode, GetType, ToString - none of them looks suitable to extract elements of the array."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 0, "creation_date": 1562170552, "post_id": 56874025, "comment_id": 100296989, "body": "Is <code>SWIGTYPE_p_std__vectorT_unsigned_char_t</code> perhaps deriving from a base class that might offer more helpful members?"}, {"owner": {"reputation": 1179, "user_id": 429775, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51d83af17b3272f2a1b34cf56880413b?s=128&d=identicon&r=PG", "display_name": "Andrey Rubliov", "link": "https://stackoverflow.com/users/429775/andrey-rubliov"}, "edited": false, "score": 0, "creation_date": 1562174940, "post_id": 56874025, "comment_id": 100299062, "body": "No, it is not deriving from any class. It is actually a generated class. Everywhere in the internet Swig help shows how to generate classes, but nowhere how to use them."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 0, "creation_date": 1562175311, "post_id": 56874025, "comment_id": 100299237, "body": "Well, unless somebody can help you with swig (as i said, i don&#39;t know swig; i don&#39;t even know if and how swig would be capable of marshalling complex C++ types, which would be quite the feat). (1/2)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 0, "creation_date": 1562175373, "post_id": 56874025, "comment_id": 100299272, "body": "(2/2) If nobody else can help, i would suggest you either change your C++ function signature to only use C data types (no C++ stuff, the function not being a C++ class member, either), or if that is not really suitable, write a C++/CLI assembly. In C++/CLI, you can mix C++ and managed .NET data types, allowing you to relatively comfortably write managed classes with methods that can convert between native C++ data types and managed data types. Basically, your C++/CLI assembly would use/interface with the C++ code, whereas your C# program would use this C++/CLI assembly like any normal assembly"}, {"owner": {"reputation": 2528, "user_id": 4658169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b351ed2ce7ddde5ab5ac9bd96200a62d?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouslyRecurringThoughts", "link": "https://stackoverflow.com/users/4658169/curiouslyrecurringthoughts"}, "edited": false, "score": 0, "creation_date": 1562175613, "post_id": 56874025, "comment_id": 100299366, "body": "Maybe useful: <a href=\"https://stackoverflow.com/q/15147026\">stackoverflow.com/q/15147026</a> they discuss vector of string in that article, but maybe could be useful to you"}], "answers": [{"comments": [{"owner": {"reputation": 1179, "user_id": 429775, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51d83af17b3272f2a1b34cf56880413b?s=128&d=identicon&r=PG", "display_name": "Andrey Rubliov", "link": "https://stackoverflow.com/users/429775/andrey-rubliov"}, "edited": false, "score": 0, "creation_date": 1562262896, "post_id": 56881393, "comment_id": 100331637, "body": "Thank you! I was mislead that swig generated SWIGTYPE_p_std__vectorT_unsigned_char_t by default and that type does not have any functionality. Now I realized that I should have added %template(VectorUChar) std::vector&lt;unsigned char&gt;; and that would generate a much better type instead of the default one and that type would have all required functionality."}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "reply_to_user": {"reputation": 1179, "user_id": 429775, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51d83af17b3272f2a1b34cf56880413b?s=128&d=identicon&r=PG", "display_name": "Andrey Rubliov", "link": "https://stackoverflow.com/users/429775/andrey-rubliov"}, "edited": false, "score": 0, "creation_date": 1562263880, "post_id": 56881393, "comment_id": 100331946, "body": "No worries - normally if you see types like SWIGTYPE_ it&#39;s a sign that something hasn&#39;t been wrapped well automatically and worth investigating why."}, {"owner": {"reputation": 111, "user_id": 10460111, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cZYyiRRst0w/AAAAAAAAAAI/AAAAAAAAANQ/WOKXaIuupUw/photo.jpg?sz=128", "display_name": "Hari Sankar v m", "link": "https://stackoverflow.com/users/10460111/hari-sankar-v-m"}, "edited": false, "score": 0, "creation_date": 1578651911, "post_id": 56881393, "comment_id": 105516876, "body": "@Flexo, Thank you. The above information helped me also. But I was trying to wrap C++ list to C# with this method and it failed. Can you please give help me in this situation? I am blocked here(trying to wrap List)."}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1578657566, "post_id": 56881393, "comment_id": 105519602, "body": "If it&#39;s a list then you&#39;ll need std_list.i instead then"}], "tags": [], "owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "is_accepted": false, "score": 1, "last_activity_date": 1562219512, "creation_date": 1562219512, "answer_id": 56881393, "question_id": 56874025, "link": "https://stackoverflow.com/questions/56874025/swig-pass-stdvectorunsigned-char-to-c-function-generated-from-c/56881393#56881393", "title": "Swig: pass std::vector&lt;unsigned char&gt; to c# function generated from c++", "body": "<p>You can get started quickly with something like this in your SWIG interface:</p>\n\n<pre><code>%include &lt;std_vector.i&gt;\n%template(VectorUChar) std::vector&lt;unsigned char&gt;;\n</code></pre>\n\n<p>That should give you a real type that you can work with from within C# that's a proxy to a C++ std::vector. (It'd work for your <code>bar()</code> function for example, but hardly be seamless at the point of call).</p>\n\n<p>Since you've actually got a <code>Byte[]</code> already you could probably put together a typemap that transparently constructs a vector from a pointer + length if that's more useful.</p>\n"}], "owner": {"reputation": 1179, "user_id": 429775, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51d83af17b3272f2a1b34cf56880413b?s=128&d=identicon&r=PG", "display_name": "Andrey Rubliov", "link": "https://stackoverflow.com/users/429775/andrey-rubliov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562219512, "creation_date": 1562169468, "question_id": 56874025, "link": "https://stackoverflow.com/questions/56874025/swig-pass-stdvectorunsigned-char-to-c-function-generated-from-c", "title": "Swig: pass std::vector&lt;unsigned char&gt; to c# function generated from c++", "body": "<p>I have a C++ function:</p>\n\n<pre><code>std::map&lt;std::string, std::string&gt; foo(const std::vector&lt;unsigned char&gt;&amp; v);\n</code></pre>\n\n<p>Swig generates the following C# function:</p>\n\n<pre><code>MapStringString foo(SWIGTYPE_p_std__vectorT_unsigned_char_t v);\n</code></pre>\n\n<p>I want to call it inside C# function which receives byte[] and returns IDictionary, i.e.:</p>\n\n<pre><code>IDictionary&lt;string, string&gt; bar(byte[] b)\n{\n  SWIGTYPE_p_std__vectorT_unsigned_char_t b1;\n\n  // initialize b1 from b\n\n  MapStringString m = foo(b1);\n\n  IDictionary&lt;string, string&gt; result;\n\n  // Populate result from MapStringString\n\n  return result;\n}\n</code></pre>\n\n<p>How do I initialize b1 from b (i.e. SWIGTYPE_p_std__vectorT_unsigned_char_t from byte[]) and how to populate IDictionary from MapStringString?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1562168913, "post_id": 56873832, "comment_id": 100296178, "body": "Your indentation is very inconsistent and may be misleading. Edit : I&#39;ve cleaned it up for you."}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 3, "creation_date": 1562169098, "post_id": 56873832, "comment_id": 100296265, "body": "You search through the list with <code>if (i == wantedNum) wantedNum = i;</code> This doesn&#39;t change any state since you&#39;re setting wantedNum to the value you&#39;ve just checked that it already is, so there&#39;s nothing you can look at afterwards to determine if you did find the number or not. Make a boolean variable for &#39;did I find the number&#39; initialized to false, set that to true in your loop if you did find the number, and then test that boolean in your if-else condition to decide what to output."}, {"owner": {"reputation": 1, "user_id": 11721368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4b8414ef96b420288bfb6cfcf2b0a6?s=128&d=identicon&r=PG&f=1", "display_name": "Khalid_Zouzal", "link": "https://stackoverflow.com/users/11721368/khalid-zouzal"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562169308, "post_id": 56873832, "comment_id": 100296367, "body": "@Fran&#231;oisAndrieux Thank you. I had ahard time pasting the code here, and properly format it."}, {"owner": {"reputation": 1, "user_id": 11721368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4b8414ef96b420288bfb6cfcf2b0a6?s=128&d=identicon&r=PG&f=1", "display_name": "Khalid_Zouzal", "link": "https://stackoverflow.com/users/11721368/khalid-zouzal"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1562169395, "post_id": 56873832, "comment_id": 100296407, "body": "@Rup Thank you will try that out."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1562169686, "post_id": 56873832, "comment_id": 100296575, "body": "imho already that you have a term for it is a problem &quot;If-else-ladder&quot;. Maybe its just me, but if I see more than 2 levels of nesting loops and if-else I either refactor it immediately or run. A snarky way to put it: Handling code with 5 levels of intendation is a skill you need as much as understanding code that uses <code>goto</code>. A nicer way to put it: Use functions to reduce the complexity. For example in <code>case P</code> i would put nothing but <code>print_numbers(numbers);</code>"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1562169692, "post_id": 56873832, "comment_id": 100296580, "body": "Read about <a href=\"https://en.cppreference.com/w/cpp/algorithm/find\" rel=\"nofollow noreferrer\"><code>std::find</code></a>."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1562170518, "post_id": 56873832, "comment_id": 100296973, "body": "@Khalid_Zouzal You probably could have saved hours on this by simply running the program in the debugger and stepping through line by line."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1562170112, "last_edit_date": 1562170112, "creation_date": 1562169811, "answer_id": 56874131, "question_id": 56873832, "link": "https://stackoverflow.com/questions/56873832/i-cannot-solve-the-else-part-in-my-if-else-ladder/56874131#56874131", "title": "I cannot solve the else part in my if-else ladder?", "body": "<p>The following block of code</p>\n\n<pre><code>for (auto i : numbers) {\n    if (i == wantedNum)\n        wantedNum = i;\n}\ncout &lt;&lt; \"Here's your number: \" &lt;&lt; wantedNum &lt;&lt; endl;\n\nfor (auto i : numbers) {\n    if (i != wantedNum) {\n        cout &lt;&lt; \"Searching...\" &lt;&lt; endl;\n    }\n}\ncout &lt;&lt; \"Your number is not in the list.\\n\";\n</code></pre>\n\n<p>indicates to me that you are unclear about the logic.</p>\n\n<p>You have to:</p>\n\n<ol>\n<li>Look for the item.</li>\n<li>If the item is found, set some flag to indicate that the item was found. Break out of the look when the item is found. Continuing to loop through the numbers after the item is found does not serve any purpose.</li>\n<li>Print a message as appropriate after the end of the loop.</li>\n</ol>\n\n<p>Here's an updated version</p>\n\n<pre><code>bool found = false;\nfor (auto i : numbers) {\n    if (i == wantedNum)\n    {\n       found = true;\n       break;\n    }\n}\n\nif ( found )\n{\n   cout &lt;&lt; \"Found \" &lt;&lt; wantedNum &lt;&lt; \" in the list.\\n\"\n}\nelse\n{\n   cout &lt;&lt; \"Did not find \" &lt;&lt; wantedNum &lt;&lt; \" in the list.\\n\"\n}\n</code></pre>\n\n<p>You can use <code>std::find</code> to reduce the amout of code a little bit.</p>\n\n<pre><code>bool found = (std::find(numbers.begin(), numbers.end(), wantedNum) != numbers.end());\n\nif ( found )\n{\n   cout &lt;&lt; \"Found \" &lt;&lt; wantedNum &lt;&lt; \" in the list.\\n\"\n}\nelse\n{\n   cout &lt;&lt; \"Did not find \" &lt;&lt; wantedNum &lt;&lt; \" in the list.\\n\"\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11721368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4b8414ef96b420288bfb6cfcf2b0a6?s=128&d=identicon&r=PG&f=1", "display_name": "Khalid_Zouzal", "link": "https://stackoverflow.com/users/11721368/khalid-zouzal"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "closed_date": 1562236936, "answer_count": 1, "score": -5, "last_activity_date": 1562172646, "creation_date": 1562168825, "last_edit_date": 1562172646, "question_id": 56873832, "link": "https://stackoverflow.com/questions/56873832/i-cannot-solve-the-else-part-in-my-if-else-ladder", "closed_reason": "Needs details or clarity", "title": "I cannot solve the else part in my if-else ladder?", "body": "<p>I am trying to write a simple program that iterates through the numbers in Vector to find the number the user asks for.\nI ask the user to add random numbers to a list (the vector).\nThen I ask them to enter the number they wish to find.\nI used a if else ladder to check if the Vector is empty before looping through it. Else I displayed :\"The list is empty\"\nI used a Range based for loop to loop through the numbers of the vector,\nthen I tried comparing every number in the loop to the WantedNum.\nif a number in the loop==wantedNum, I assign it to wantedNum, then display WantedNum back to the user.\nMy code displays the wanted number but it does not stop there like intended.</p>\n\n<p>The case I can't solve is when the user asks for a number that's not in the list.</p>\n\n<p>Well here's my code (I initialized the vector explicitly with bunch of random numbers until I can solve the \"Find a number\"part, then I'll move on to the \"add a number\" logic)</p>\n\n<p>I am a beginner so I'd appreciate explanations, especially what have I done wrong.. Of course advice is most welcomed.\nThank you in advice.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nint main()\n{\n    char selection {};\n    vector&lt;int&gt; numbers {10, 20, 30, 46, 78, 100, -2};\n    int wantedNum {};\n\n    cout &lt;&lt; \"Welcome to my menu: \\n\";\n    cout &lt;&lt; \"Enter F to find a number.\\nEnter P to display the numbers in the \"\n            \"list.\\nEnter Q to quit\\n\";\n\n    do\n    {\n        cout &lt;&lt; \"Enter your choice: \";\n        cin &gt;&gt; selection;\n        switch (selection)\n        {\n            case 'f':\n            case 'F':\n                cout &lt;&lt; \"Enter the number you wish to find: \";\n                cin &gt;&gt; wantedNum;\n                if (numbers.size() != 0)\n                {\n                    for (auto i : numbers)\n                    {\n                        if (i == wantedNum)\n                            wantedNum = i;\n                    }\n                    cout &lt;&lt; \"Here's your number: \" &lt;&lt; wantedNum &lt;&lt; endl;\n\n                    for (auto i : numbers)\n                    {\n                        if (i != wantedNum)\n                        {\n                            cout &lt;&lt; \"Searching...\" &lt;&lt; endl;\n                        }\n                    }\n                    cout &lt;&lt; \"Your number is not in the list.\\n\";\n                }\n                else\n                {\n                    cout &lt;&lt; \"List is empty - []\\n\";\n                }\n                break;\n            case 'p':\n            case 'P':\n                cout &lt;&lt; \"The numbers in the list are: \";\n                for (auto i : numbers)\n                {\n                    cout &lt;&lt; i &lt;&lt; \" \";\n                }\n                break;\n            case 'q':\n            case 'Q': cout &lt;&lt; \"GoodBye !\\n\"; break;\n            default: cout &lt;&lt; \"I dont recognize this input, please try again.\\n\";\n        }\n    } while (selection != 'Q' &amp;&amp; selection != 'q');\n}\n\n</code></pre>\n"}, {"tags": ["c++", "qt", "icons"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9088793"}, "edited": false, "score": 0, "creation_date": 1562197804, "post_id": 56873683, "comment_id": 100306776, "body": "Checked <code>QAbstractItemView::iconSize</code>?"}, {"owner": {"reputation": 57, "user_id": 11730909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f74f82b295e682a4d2fddb3c08bc0d7?s=128&d=identicon&r=PG&f=1", "display_name": "heavyqtuser", "link": "https://stackoverflow.com/users/11730909/heavyqtuser"}, "edited": false, "score": 0, "creation_date": 1562253789, "post_id": 56873683, "comment_id": 100328516, "body": "@replete Sorry, not sure what you&#39;re getting at. How can I use that function here?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9088793"}, "edited": false, "score": 0, "creation_date": 1562288567, "post_id": 56873683, "comment_id": 100336927, "body": "If the items are being visualized by a view that derives from <code>QAbstractItemView</code> (e.g. <code>QTreeView</code>), then perhaps that property of the view is constraining your icons. I don&#39;t know whether this is the case or not, but it is something you could easily check."}], "owner": {"reputation": 57, "user_id": 11730909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f74f82b295e682a4d2fddb3c08bc0d7?s=128&d=identicon&r=PG&f=1", "display_name": "heavyqtuser", "link": "https://stackoverflow.com/users/11730909/heavyqtuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1562168313, "creation_date": 1562168313, "question_id": 56873683, "link": "https://stackoverflow.com/questions/56873683/how-to-adjust-the-icon-size-of-a-qstandarditem-qstandarditem-has-no-seticonsiz", "title": "How to adjust the icon size of a QStandardItem? (QStandardItem has no setIconSize() method)", "body": "<p>Is it possible to increase the icon size of a QStandardItem? I have icons on some columns of a QStandardItemModel (and the columns are QStandardItems). I simply want to make the icons bigger. I've made sure that there is enough space to accommodate a bigger icon by using sizeHint(); the icon is now much smaller than the space available. </p>\n\n<p>I've tried multiple ways to make sure the icon itself is big, including using a bigger .png file and also by making the QIcon out of a QPixmap whose size I've set manually. Either way the size stays the same so I feel the problem lies within QStandardItem. </p>\n\n<p>Any help is appreciated. </p>\n"}, {"tags": ["c++", "computational-geometry", "assert", "cgal", "parameterization"], "comments": [{"owner": {"reputation": 133, "user_id": 3841173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c8adccff22da52270aa0d3734909e?s=128&d=identicon&r=PG&f=1", "display_name": "Mael", "link": "https://stackoverflow.com/users/3841173/mael"}, "edited": false, "score": 0, "creation_date": 1562225198, "post_id": 56873437, "comment_id": 100312987, "body": "LSCM requires the mesh to be a topological disk, and thus not a closed mesh. It seems you know that since you do speak of seams, but your code uses a  Surface_mesh, which cannot handle artificial seams. Could you please clarify that bit?"}, {"owner": {"reputation": 478, "user_id": 5446815, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2a57abf3b2d1ba10b18f2557afe339a2?s=128&d=identicon&r=PG&f=1", "display_name": "Matrefeytontias", "link": "https://stackoverflow.com/users/5446815/matrefeytontias"}, "reply_to_user": {"reputation": 133, "user_id": 3841173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c8adccff22da52270aa0d3734909e?s=128&d=identicon&r=PG&f=1", "display_name": "Mael", "link": "https://stackoverflow.com/users/3841173/mael"}, "edited": false, "score": 0, "creation_date": 1562239398, "post_id": 56873437, "comment_id": 100320775, "body": "Oh that&#39;s right, I forgot about that condition. The answer is simply that I&#39;m finding it pretty hard to work off the documentation and the examples. I see the examples using Seam_mesh ; using Two_vertices_parameterizer_3, is it possible to let CGAL arbitrarily chose where to make the seam cut ? Because I&#39;ll be processing a variety of meshes, I can&#39;t possibly ask for a seam file every time."}, {"owner": {"reputation": 478, "user_id": 5446815, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2a57abf3b2d1ba10b18f2557afe339a2?s=128&d=identicon&r=PG&f=1", "display_name": "Matrefeytontias", "link": "https://stackoverflow.com/users/5446815/matrefeytontias"}, "reply_to_user": {"reputation": 133, "user_id": 3841173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c8adccff22da52270aa0d3734909e?s=128&d=identicon&r=PG&f=1", "display_name": "Mael", "link": "https://stackoverflow.com/users/3841173/mael"}, "edited": false, "score": 0, "creation_date": 1562242348, "post_id": 56873437, "comment_id": 100322312, "body": "Edited OP with a new discovery."}, {"owner": {"reputation": 133, "user_id": 3841173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c8adccff22da52270aa0d3734909e?s=128&d=identicon&r=PG&f=1", "display_name": "Mael", "link": "https://stackoverflow.com/users/3841173/mael"}, "edited": false, "score": 0, "creation_date": 1562249389, "post_id": 56873437, "comment_id": 100326292, "body": "Note that with artifical seams via Seam_mesh, the parameterization is not going to be seamless in the sense that the parameterization will not glue nicely on both sides of the borders."}, {"owner": {"reputation": 133, "user_id": 3841173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c8adccff22da52270aa0d3734909e?s=128&d=identicon&r=PG&f=1", "display_name": "Mael", "link": "https://stackoverflow.com/users/3841173/mael"}, "edited": false, "score": 1, "creation_date": 1562249557, "post_id": 56873437, "comment_id": 100326385, "body": "(Pressed enter too early...) There is no automatic way to choose a seam, but you could just pick 2 random points and compute the shortest path and mark that as a seam.  Finally CGAL also has a different parameterization method intended for topological ball : Orbifold Tutte parameterization (<a href=\"https://doc.cgal.org/latest/Surface_mesh_parameterization/classCGAL_1_1Surface__mesh__parameterization_1_1Orbifold__Tutte__parameterizer__3.html\" rel=\"nofollow noreferrer\">doc.cgal.org/latest/Surface_mesh_parameterization/&hellip;</a>). In this case, you do not have to construct artifical seams, but you have to provide so-called &quot;cones&quot;."}, {"owner": {"reputation": 133, "user_id": 3841173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c8adccff22da52270aa0d3734909e?s=128&d=identicon&r=PG&f=1", "display_name": "Mael", "link": "https://stackoverflow.com/users/3841173/mael"}, "edited": false, "score": 0, "creation_date": 1562249714, "post_id": 56873437, "comment_id": 100326471, "body": "That parameterization method uses internally a seam, but the result is seamless. The cones are the equivalent of the random vertices that I was saying you could choose for LSCM and manual &quot;seaming&quot;: the internal seam will be the shortest path between the cones. Note that here like for LSCM, their position (and thus the position of the seam) will influence the quality of the output parameterization."}, {"owner": {"reputation": 478, "user_id": 5446815, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2a57abf3b2d1ba10b18f2557afe339a2?s=128&d=identicon&r=PG&f=1", "display_name": "Matrefeytontias", "link": "https://stackoverflow.com/users/5446815/matrefeytontias"}, "reply_to_user": {"reputation": 133, "user_id": 3841173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c8adccff22da52270aa0d3734909e?s=128&d=identicon&r=PG&f=1", "display_name": "Mael", "link": "https://stackoverflow.com/users/3841173/mael"}, "edited": false, "score": 0, "creation_date": 1562251967, "post_id": 56873437, "comment_id": 100327621, "body": "Noted. Right now what I&#39;m doing is checking if the mesh is a topological ball. If it is, I go with Orbifold Tutte, if it isn&#39;t I assume it&#39;s a topological disk and go for LSCM (this is reasonable given my input set). Since LSCM doesn&#39;t need a virtual border in case of topological disks, I can just ask for 2 vertex indices in CLI and be done with it. I haven&#39;t touched Orbifold Tutte yet but I&#39;ll come back to you when I do."}, {"owner": {"reputation": 133, "user_id": 3841173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c8adccff22da52270aa0d3734909e?s=128&d=identicon&r=PG&f=1", "display_name": "Mael", "link": "https://stackoverflow.com/users/3841173/mael"}, "edited": false, "score": 1, "creation_date": 1562315414, "post_id": 56873437, "comment_id": 100344007, "body": "As a side remark, you can use <a href=\"https://doc.cgal.org/latest/BGL/group__PkgBGLHelperFct.html#gae04c8044cf1eee6a84baa5b79ab99fef\" rel=\"nofollow noreferrer\">is_closed</a> and <a href=\"https://doc.cgal.org/latest/Polygon_mesh_processing/index.html#title52\" rel=\"nofollow noreferrer\">PMP::connected_components</a>. For Orbifold parameterization, you can have a look at the <a href=\"https://noamaig.github.io/html/projects/orbifold/orbifold_lowres.pdf\" rel=\"nofollow noreferrer\">papers</a> to get some inspiration on what good cone placement looks like and maybe devise some automatic way to choose them."}], "owner": {"reputation": 478, "user_id": 5446815, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2a57abf3b2d1ba10b18f2557afe339a2?s=128&d=identicon&r=PG&f=1", "display_name": "Matrefeytontias", "link": "https://stackoverflow.com/users/5446815/matrefeytontias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562242412, "creation_date": 1562167524, "last_edit_date": 1562242412, "question_id": 56873437, "link": "https://stackoverflow.com/questions/56873437/assertion-violation-with-planar-parameterization-of-triangle-mesh", "title": "Assertion violation with planar parameterization of triangle mesh", "body": "<p>I'm struggling to generate UV coordinates on a closed triangle mesh using LSCM with the latest CGAL in header-only mode, on Windows, with VS 2017. The code I have is pretty simple since I can't really have two fixed vertices for the seams, so I'm relying on the default constructor of <code>SMP::Two_vertices_parameterizer_3</code>.</p>\n\n<pre><code>typedef CGAL::Simple_cartesian&lt;double&gt; Kerneld;\ntypedef Kerneld::Point_3 Pointd;\ntypedef CGAL::Surface_mesh&lt;Pointd&gt; Meshd;\n// ...\nif (parameterizeMesh)\n{\n    std::cout &lt;&lt; \"Parameterizing mesh with Least-Squares Conformal Mapping ... \" &lt;&lt; std::endl;\n    Meshd meshd;\n    PMP::polygon_soup_to_polygon_mesh(vd, polys, meshd);\n\n    SMP::LSCM_parameterizer_3&lt;Meshd, SMP::Two_vertices_parameterizer_3&lt;Meshd&gt;&gt; param;\n    Meshd::Property_map&lt;Meshd::Vertex_index, Kerneld::Point_2&gt; uvmap = meshd.add_property_map&lt;Meshd::vertex_index, Kerneld::Point_2&gt;(\"v:uv\").first;\n    SMP::parameterize(meshd, param, PMP::longest_border(meshd).first, uvmap);\n}\n</code></pre>\n\n<p>And it's failing with :</p>\n\n<pre><code>CGAL error: assertion violation!\nExpression : _idx &lt; data_.size()\nFile       : C:\\dev\\CGAL-4.14\\include\\CGAL/Surface_mesh/Properties.h\nLine       : 206\nExplanation:\nRefer to the bug-reporting instructions at https://www.cgal.org/bug_report.html\n</code></pre>\n\n<p>I then printed the values of both <code>_idx</code> and <code>data_.size()</code> right before the assertion violation and got the interesting results of <code>4294967294</code> (ie <code>2^32 - 2</code>) and <code>49128</code> respectively. Worthy of note is  that the mesh in question holds 16376 triangular faces, and 16376 * 3 = 49128. I'm pretty stuck there ; I read the many CGAL examples that deal with planar parameterization, to no avail.</p>\n\n<p>EDIT : upon further inspection, it appears that the biggest number is actually the number returned by <code>PMP::longest_border</code>, which makes sense since I'm using a closed mesh. I'm looking into <code>Seam_mesh</code> to introduce a virtual seam in my mesh.</p>\n"}, {"tags": ["c++", "performance", "c++17", "clang++"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1562167280, "post_id": 56873187, "comment_id": 100295303, "body": "What is <code>benchmark::DoNotOptimize</code>? How does its presence affect code generation?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 2, "creation_date": 1562167355, "post_id": 56873187, "comment_id": 100295350, "body": "@NicolBolas It is part of google benchmarks code that tells the compiler not to optimize something away since most compilers will optimize out unused results.  You can see it working <a href=\"http://quick-bench.com/F0C__3bEIG0maZh_vQddQNWQUUQ\" rel=\"nofollow noreferrer\">here</a>.  You can pretty much ignore it as it should make all results &quot;equal&quot; (in the sense no function is optimized away)"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1562167629, "post_id": 56873187, "comment_id": 100295494, "body": "When in doubt, dump the asm. Ultimately it will tell you exactly what is transpiring between your code, and any optimizations thereafter. I&#39;m curious what happens when the number of items being enumerated is <i>dramatically</i> increased. Sixteen elements in a compile-time fixed-size container is pittance, and I wouldn&#39;t be surprised if the entire for-loop was unrolled."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 8, "creation_date": 1562167639, "post_id": 56873187, "comment_id": 100295500, "body": "Interestingly, GCC compiles them all to the same speed (actually slightly faster) clang does for the raw loop: <a href=\"http://quick-bench.com/UCmqDfqqWtlHOMscX01RTIHqVHU\" rel=\"nofollow noreferrer\">quick-bench.com/UCmqDfqqWtlHOMscX01RTIHqVHU</a>.  Looks like an optimization bug in clang."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1562167772, "post_id": 56873187, "comment_id": 100295568, "body": "@NathanOliver: please open a ticket to the LLVM bug tracker if you can, would be sad to see this being forgotten"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1562167926, "post_id": 56873187, "comment_id": 100295678, "body": "@VittorioRomeo Unfortunately I&#39;m not registered with them.  I&#39;m trying to get an account"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1562168125, "post_id": 56873187, "comment_id": 100295774, "body": "Note that if you increase the number of items you operate over, the difference evaporates: <a href=\"http://quick-bench.com/eC1fp41UYz7YK8WQOFfJokqfduw\" rel=\"nofollow noreferrer\">quick-bench.com/eC1fp41UYz7YK8WQOFfJokqfduw</a>"}, {"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "edited": false, "score": 2, "creation_date": 1562168168, "post_id": 56873187, "comment_id": 100295809, "body": "I cannot reproduce it. I get the exact same code for the three options when compiled outside Google Benchmark. GCC and Clang both do with an int/xmm xor, three instructions total."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1562168818, "post_id": 56873187, "comment_id": 100296136, "body": "Don&#39;t benchmark a paltry amount of data.  That doesn&#39;t really show anything.  Increase the amount to thousands.  If a small amount of data being used was valid, then bubble sort would beat quicksort every single time."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1562169107, "post_id": 56873187, "comment_id": 100296268, "body": "Here&#39;s my hypothesis: I know that <code>std::for_each</code> and <code>std::transform</code> in libstdc++ (and probably libc++) have manual loop unrolling for random access iterators. My hypothesis is that clang was unable to reroll the loop to &quot;understand&quot; it enough to emit the best vector instructions."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 4, "creation_date": 1562169513, "post_id": 56873187, "comment_id": 100296479, "body": "@VittorioRomeo Bug report submitted: <a href=\"https://bugs.llvm.org/show_bug.cgi?id=42499\" rel=\"nofollow noreferrer\">bugs.llvm.org/show_bug.cgi?id=42499</a>"}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562169722, "post_id": 56873187, "comment_id": 100296601, "body": "@NathanOliver: awesome, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": true, "score": 1, "last_activity_date": 1562366810, "creation_date": 1562366810, "answer_id": 56909923, "question_id": 56873187, "link": "https://stackoverflow.com/questions/56873187/raw-loop-on-an-array-of-bool-is-5-times-faster-than-transform-or-for-each/56909923#56909923", "title": "Raw Loop on an array of bool is 5 times faster than transform or for_each", "body": "<h1>In this example, clang vectorizes indexing but (mistakenly) fails to vectorize iterating.</h1>\n\n<p>To summarize the results, <strong>there is no difference between using a raw loop and using <code>std::transform</code> or <code>std::for_each</code>.</strong> There IS, however, a difference between using indexing and using iterating, and for the purposes of <em>this particular problem</em>, clang is better at optimizing indexing than it is at optimizing iterating because indexing gets vectorized. <code>std::transform</code> and <code>std::for_each</code> use iterating, so they end up being slower (when compiled under clang). </p>\n\n<p><strong>What's the difference between indexing and iterating?</strong> \n- Indexing is when you use an integer to index into an array\n- Iterating is when you increment a pointer from <code>begin()</code> to <code>end()</code>. </p>\n\n<p>Let's write the raw loop using indexing and using iterating, and compare the performance of iterating (with a raw loop) to indexing. </p>\n\n<pre><code>// Indexing\nfor(int i = 0; i &lt; a.size(); i++) {\n    a[i] = !a[i];\n}\n</code></pre>\n\n<pre><code>// Iterating, used by std::for_each and std::transform\nbool* begin = a.data();\nbool* end   = begin + a.size(); \nfor(; begin != end; ++begin) {\n    *begin = !*begin; \n}\n</code></pre>\n\n<p>The example using indexing is better-optimized, and runs 4-5 times faster when compiled with clang. </p>\n\n<p>In order to demonstrate this, let's add two additional tests, both using a raw loop. One will use an iterator, and the other one will use raw pointers. </p>\n\n<pre><code>\nstatic void RawLoopIt(benchmark::State&amp; state) {\n  std::array&lt;bool, 16&gt; a;\n  std::fill(a.begin(), a.end(), true); \n\n  for(auto _ : state) {\n    auto scan = a.begin(); \n    auto end = a.end(); \n    for (; scan != end; ++scan) {\n      *scan = !*scan; \n    }\n    benchmark::DoNotOptimize(a); \n  }\n }\n\nBENCHMARK(RawLoopIt); \n\nstatic void RawLoopPtr(benchmark::State&amp; state) {\n  std::array&lt;bool, 16&gt; a;\n  std::fill(a.begin(), a.end(), true); \n\n  for(auto _ : state) {\n    bool* scan = a.data(); \n    bool* end = scan + a.size(); \n    for (; scan != end; ++scan) {\n      *scan = !*scan; \n    }\n    benchmark::DoNotOptimize(a); \n  } \n}\n\nBENCHMARK(RawLoopPtr); \n</code></pre>\n\n<p>When using a pointer or an iterator from <code>begin</code> to <code>end</code>, these functions <em>identical in performance</em> to using <code>std::for_each</code> or <code>std::transform</code>.</p>\n\n<p><a href=\"http://quick-bench.com/2r7Jw0NjoyokfV_1gjOqVoaj7TM\" rel=\"nofollow noreferrer\"><strong>Clang Quick-bench results:</strong></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/WL0Am.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WL0Am.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is confirmed by running the clang benchmark locally:</p>\n\n<pre><code>me@K2SO:~/projects/scratch$ clang++ -O3 bench.cpp -lbenchmark -pthread -o clang-bench\nme@K2SO:~/projects/scratch$ ./clang-bench\n2019-07-05 16:13:27\nRunning ./clang-bench\nRun on (8 X 4000 MHz CPU s)\nCPU Caches:\n  L1 Data 32K (x4)\n  L1 Instruction 32K (x4)\n  L2 Unified 256K (x4)\n  L3 Unified 8192K (x1)\nLoad Average: 0.44, 0.55, 0.59\n-----------------------------------------------------\nBenchmark           Time             CPU   Iterations\n-----------------------------------------------------\nForEach          8.32 ns         8.32 ns     83327615\nTransform        8.29 ns         8.28 ns     82536410\nRawLoop          1.92 ns         1.92 ns    361745495\nRawLoopIt        8.31 ns         8.31 ns     81848945\nRawLoopPtr       8.28 ns         8.28 ns     82504276\n</code></pre>\n\n<h1>GCC does not have this problem.</h1>\n\n<p>For the purposes of this example, there is no fundamental difference between indexing or iterating. Both of them apply an identical transformation to the array, and the compiler <em>should</em> be able to compile them identically. </p>\n\n<p>Indeed, GCC is able to do this, with all methods running <em>faster</em> than the corresponding version compiled under clang. </p>\n\n<p><a href=\"http://quick-bench.com/zmeVSdZix6Qw7iMi1lXijPxtrWw\" rel=\"nofollow noreferrer\"><strong>GCC Quick-bench results:</strong></a>\n<a href=\"https://i.stack.imgur.com/m0WmR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m0WmR.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>GCC Local results:</strong></p>\n\n<pre><code>2019-07-05 16:13:35\nRunning ./gcc-bench\nRun on (8 X 4000 MHz CPU s)\nCPU Caches:\n  L1 Data 32K (x4)\n  L1 Instruction 32K (x4)\n  L2 Unified 256K (x4)\n  L3 Unified 8192K (x1)\nLoad Average: 0.52, 0.57, 0.60\n-----------------------------------------------------\nBenchmark           Time             CPU   Iterations\n-----------------------------------------------------\nForEach          1.43 ns         1.43 ns    484760981\nTransform        1.44 ns         1.44 ns    485788409\nRawLoop          1.43 ns         1.43 ns    484973417\nRawLoopIt        1.44 ns         1.44 ns    482685685\nRawLoopPtr       1.44 ns         1.44 ns    483736235\n</code></pre>\n\n<h1>Is indexing actually faster than iterating? No. Indexing is faster because clang vectorizes it.</h1>\n\n<p>Under the hood, <strong>neither</strong> iterating <strong>nor</strong> indexing occurs. Instead, gcc and clang <strong>vectorize</strong> the operation by treating the array as two 64-bit integers, and using a bitwise-xor on them. We can see this reflected in the assembly used to flip the bits:</p>\n\n<pre><code>       movabs $0x101010101010101,%rax\n       nopw   %cs:0x0(%rax,%rax,1)\n       xor    %rax,(%rsp)\n       xor    %rax,0x8(%rsp)\n       sub    $0x1,%rbx\n</code></pre>\n\n<p>Iterating is slower <em>when compiled by clang</em> because for some reason, <strong>clang fails to vectorize the operation when iterating is used.</strong> This is a defect in clang, and one that applies specifically to this problem. As clang improves, this discrepancy should disappear, and it's not something I would worry about for now. </p>\n\n<p>Don't micro-optimize. Let the compiler handle that, and if necessary, test whether gcc or clang produces faster code <em>for your particular use-case</em>. Neither is better for all cases. For example, clang is better at vectorizing some math operations.</p>\n"}], "owner": {"reputation": 1206, "user_id": 3047822, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/RDyN1.png?s=128&g=1", "display_name": "apramc", "link": "https://stackoverflow.com/users/3047822/apramc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 3, "accepted_answer_id": 56909923, "answer_count": 1, "score": 12, "last_activity_date": 1562366810, "creation_date": 1562166633, "last_edit_date": 1562166742, "question_id": 56873187, "link": "https://stackoverflow.com/questions/56873187/raw-loop-on-an-array-of-bool-is-5-times-faster-than-transform-or-for-each", "title": "Raw Loop on an array of bool is 5 times faster than transform or for_each", "body": "<p>Based on my previous experience with benchmarking transform and for_each, they usually perform slightly faster than raw loops and of course, they are safer, so I tried to replace all my raw loops with transform, generate and for_each. Today, I compared how fast I can flip booleans using for_each, transform and raw loops, and I got very surprising results. raw_loop performs 5 times faster than the other two. I was not really able to find a good reason why we get this massive difference? </p>\n\n<pre><code>#include &lt;array&gt;\n#include &lt;algorithm&gt;\n\n\nstatic void ForEach(benchmark::State&amp; state) {\n  std::array&lt;bool, sizeof(short) * 8&gt; a;\n  std::fill(a.begin(), a.end(), true);\n\n  for (auto _ : state) {\n    std::for_each(a.begin(), a.end(), [](auto &amp; arg) { arg = !arg; });\n    benchmark::DoNotOptimize(a);\n  }\n}\nBENCHMARK(ForEach);\n\nstatic void Transform(benchmark::State&amp; state) {\n  std::array&lt;bool, sizeof(short) * 8&gt; a;\n  std::fill(a.begin(), a.end(), true);\n\n  for (auto _ : state) {\n    std::transform(a.begin(), a.end(), a.begin(), [](auto arg) { return !arg; });\n    benchmark::DoNotOptimize(a);\n  }\n}\nBENCHMARK(Transform);\n\n\nstatic void RawLoop(benchmark::State&amp; state) {\n  std::array&lt;bool, sizeof(short) * 8&gt; a;\n  std::fill(a.begin(), a.end(), true);\n\n  for (auto _ : state) {\n    for (int i = 0; i &lt; a.size(); i++) {\n      a[i] = !a[i];\n    }\n    benchmark::DoNotOptimize(a);\n  }\n}\nBENCHMARK(RawLoop);\n</code></pre>\n\n<blockquote>\n  <p>clang++ (7.0) -O3 -libc++ (LLVM)</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/4QdWW.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/4QdWW.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "virtual-functions", "rvalue-reference", "object-lifetime", "temporary-objects"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1562166722, "post_id": 56873162, "comment_id": 100295024, "body": "<code>Derived()</code> creates a <i>temporary</i> object. An object that is destructed once the call to the <code>Foo</code> constructor is finished. Where do you think the reference <code>bref</code> is actually referencing once the temporary object is destructed?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 3, "creation_date": 1562166758, "post_id": 56873162, "comment_id": 100295043, "body": "You shouldn&#39;t assign an r-value reference to an ordinary one. Either use two ordinary references or assign the r-value reference to an object instance; if you want to profit from move semantics, you should do: <code>{ Foo(Base&amp;&amp; r) : bref(std::move(r)) { } Base bref; }</code>"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1562167352, "post_id": 56873162, "comment_id": 100295344, "body": "@Aconcagua since <code>Base</code> is pure virtual it will not compile."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1562168112, "post_id": 56873162, "comment_id": 100295768, "body": "@MarekR Then make it a <code>Derived</code> instance; anyway what&#39;s the point of the rvalue ref here? You don&#39;t want to &quot;steal&quot; an instance, avoid a copy, etc."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1562168305, "post_id": 56873162, "comment_id": 100295876, "body": "@curiousguy I&#39;m not OP just pointing out wrong comment."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1562168993, "post_id": 56873162, "comment_id": 100296219, "body": "@MarekR Yes; but even with a concrete class Base, it would probably be a logic error to convert a Derived to a Base"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1562169627, "post_id": 56873162, "comment_id": 100296544, "body": "@MarekR Was intended to present options <i>in general</i>, considered <code>Base</code> not being instantiable a different topic (seems as if I wasn&#39;t clear enough about...). Similarly didn&#39;t consider object-slicing issues even if base <i>was</i> instantiable..."}, {"owner": {"reputation": 129, "user_id": 6057626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e6627504b5b94dfb75d24cb6a262745?s=128&d=identicon&r=PG&f=1", "display_name": "Carlosio", "link": "https://stackoverflow.com/users/6057626/carlosio"}, "edited": false, "score": 0, "creation_date": 1562598458, "post_id": 56873162, "comment_id": 100415870, "body": "All, I understand now the error due to Derived() being a temporary object. I would like to be able to use the following expressions: Foo f1{Derived1()}; Foo f2{Derived2()}; f1.print() ; f2.print(); etc. Do you have any suggestion in this case ?"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 4, "last_activity_date": 1562166979, "creation_date": 1562166979, "answer_id": 56873281, "question_id": 56873162, "link": "https://stackoverflow.com/questions/56873162/rvalue-reference-and-polymorphism/56873281#56873281", "title": "rvalue reference and polymorphism", "body": "<p>The lifetime of the temporary object <code>Derived()</code> extends until the full expression that is <code>Foo f{Derived()};</code>. <code>f.bref</code> is a dangling reference after that. <code>f.print()</code> calls <code>bref.print()</code> which has undefined behaviour.</p>\n\n<p><code>Foo{Derived()}.print();</code> would be technically well defined, but storing an lvalue reference into an rvalue referred object passed to a constructor probably makes no sense.</p>\n"}, {"tags": [], "owner": {"reputation": 477, "user_id": 6082134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7ed777a2c7a8caeb94333715458192?s=128&d=identicon&r=PG&f=1", "display_name": "Mayhem", "link": "https://stackoverflow.com/users/6082134/mayhem"}, "is_accepted": false, "score": 1, "last_activity_date": 1562167641, "creation_date": 1562167641, "answer_id": 56873480, "question_id": 56873162, "link": "https://stackoverflow.com/questions/56873162/rvalue-reference-and-polymorphism/56873480#56873480", "title": "rvalue reference and polymorphism", "body": "<p><code>bref</code> is a dangling reference when you call it in <code>Foo::print()</code>. Maybe use <code>unique_ptr</code> like this.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\nstruct Base\n{\n    virtual void print()=0;\n    virtual ~Base(){}\n};\n\nstruct Derived: public Base\n{\n    void print(){std::cout &lt;&lt; \"this is Derived\\n\";}\n};\n\nstruct Foo\n{\n    Foo(std::unique_ptr&lt;Base&gt;&amp;&amp; r): bref{std::move(r)} {}\n    void print(){\n        bref-&gt;print();\n    }\n    std::unique_ptr&lt;Base&gt; bref;\n};\n\nint main()\n{\n    Foo f{std::unique_ptr&lt;Derived&gt;(new Derived)}; //or make_unique\n    f.print();\n}\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 6057626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e6627504b5b94dfb75d24cb6a262745?s=128&d=identicon&r=PG&f=1", "display_name": "Carlosio", "link": "https://stackoverflow.com/users/6057626/carlosio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 56873281, "answer_count": 2, "score": 1, "last_activity_date": 1562167995, "creation_date": 1562166548, "last_edit_date": 1562167995, "question_id": 56873162, "link": "https://stackoverflow.com/questions/56873162/rvalue-reference-and-polymorphism", "title": "rvalue reference and polymorphism", "body": "<p>When I run the following code I get the following runtime crash:</p>\n\n<p>\"pure virtual method called\nterminate called without an active exception\"</p>\n\n<p>I dont understand why polymorphism doesn't work here. Please can someone help me.</p>\n\n<pre><code>struct Base\n{\n    virtual void print()=0;\n    virtual ~Base(){}\n};\n\nstruct Derived: public Base\n{\n    void print(){cout &lt;&lt; \"this is Derived\\n\";}\n};\n\nstruct Foo\n{\n    Foo(Base&amp;&amp; r): bref{r} {}\n    void print(){\n        bref.print();\n    }\n    Base&amp; bref;\n};\n\nint main()\n{\n    Foo f{Derived()};\n    f.print(); //it crashes here with above message\n}\n</code></pre>\n"}, {"tags": ["c++", "g++", "clang"], "comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1562166117, "post_id": 56872984, "comment_id": 100294654, "body": "How do you compille it? Is <code>Flight.cpp</code> or <code>Flight.o</code> included on the commandline?"}, {"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "edited": false, "score": 0, "creation_date": 1562166629, "post_id": 56872984, "comment_id": 100294968, "body": "Also, please choose one of g++ or clang (or none, since this is not really about a particular compiler)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11441903"}, "edited": false, "score": 0, "creation_date": 1562166725, "post_id": 56872984, "comment_id": 100295026, "body": "I tried to g++ -std=c++11 -O2 -Wall %s FlightMap.cpp %s -o %s but error says clang:error..."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1562166754, "post_id": 56872984, "comment_id": 100295039, "body": "First and foremost you got this error not when compiling but when linking. This is quite important detail to understand your issue."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1562167088, "post_id": 56872984, "comment_id": 100295201, "body": "Do you try just to compile FlightMap.cpp into object file? Then you are missing <code>-c</code> parameter. Without it clang or gcc tries to build the executable"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1562167716, "post_id": 56872984, "comment_id": 100295531, "body": "Any number of references will tell you how to declare and define global variables correctly. The important point is that you <b>declare</b> them in Flight.h using <code>extern</code> and also <b>define</b> them in Flight.cpp without using <code>extern</code>. You need to do <b>both</b>. It&#39;s not hard but not something that you are likely to get right by guessing."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11441903"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1562168388, "post_id": 56872984, "comment_id": 100295921, "body": "@john Wow I resolved the problem. I declared global variables using extern in FlightMap.h and also declared without extern in FlightMap.cpp. May i get some explanation why I could resolve errors?"}, {"owner": {"reputation": 2876, "user_id": 7958961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9fc6004eafe9f7b473927ecfd65646?s=128&d=identicon&r=PG&f=1", "display_name": "Rados\u0142aw Cybulski", "link": "https://stackoverflow.com/users/7958961/rados%c5%82aw-cybulski"}, "edited": false, "score": 0, "creation_date": 1562168463, "post_id": 56872984, "comment_id": 100295964, "body": "You <b>declared</b> with <code>extern</code>, but <b>defined</b> without. Every variable / function needs exactly one definition (but can hany any number of declarations, including zero, as long as those match each other)."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1562168705, "post_id": 56872984, "comment_id": 100296079, "body": "@rocketsssss You have to understand the difference between declarations and definitions. With <code>extern</code> it&#39;s a declaration, without it a definition. Your global variable need to be defined exactly once. So you put the definition in one cpp file. But your globals can be declared as many times as you like, so you put the declarations in a header file where they can be included many times without getting multiple definition errors. All the compiler needs to see to generate code is a declaration, but the linker needs to see exactly one definition to link the program."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1562168717, "post_id": 56872984, "comment_id": 100296086, "body": "@rocketsssss  So the above method keeps the compiler and the linker happy."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11441903"}, "edited": false, "score": 0, "creation_date": 1562169365, "post_id": 56873701, "comment_id": 100296394, "body": "Thank you for your teaching!  I have a quick question. As I know, extern is used when I declared some global variables in a &quot;source file&quot; and used in another &quot;source file.&quot; But, in this situation, I declared global variables in FlightMap.h and used them in FlightMap.cpp. Even though this situation, should I use &quot;extern&quot; keyword?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562169632, "post_id": 56873701, "comment_id": 100296549, "body": "<code>extern</code> is typically used in a <code>.h</code> or <code>.hpp</code> file that is supposed to be used by more than one <code>.cpp</code> file - or if the variables themselves are referenced in the header fille. The variables that are declared that way can then be used in all <code>.cpp</code> files that includes that <code>.h</code>/<code>.hpp</code> file. Only <i>one</i> <code>.cpp</code> should actually define the variables though."}], "tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1562169028, "last_edit_date": 1562169028, "creation_date": 1562168382, "answer_id": 56873701, "question_id": 56872984, "link": "https://stackoverflow.com/questions/56872984/clang-error-linker-command-failed-with-exit-code-1-use-v-to-see-invocation/56873701#56873701", "title": "clang: error: linker command failed with exit code 1 (use -v to see invocation) *about global variables", "body": "<p>Use fully qualified names in your header file's declarations:</p>\n\n<pre><code>#ifndef LAB6_FLIGHTMAP_H\n#define LAB6_FLIGHTMAP_H\n\n//#includes ...\n\nextern std::stack&lt;std::string&gt; path;\nextern std::map&lt;std::string, std::string&gt; airport_label;\nextern std::map&lt;double, std::string&gt; distance_label;\nextern std::map&lt;std::string, double&gt; dijkstra;\n...\n#endif\n</code></pre>\n\n<p>And in <code>FlightMap.cpp</code> you need to define these global variabes:</p>\n\n<pre><code>std::stack&lt;std::string&gt; path;\nstd::map&lt;std::string, std::string&gt; airport_label;\nstd::map&lt;double, std::string&gt; distance_label;\nstd::map&lt;std::string, double&gt; dijkstra;\n</code></pre>\n\n<p><code>extern</code> tells the compiler that the variable <em>will</em> be defined somewhere, in another translation unit, and leaves resolving this up to the linker. The linker now has to find the definition in any of the compiled files, but can't since there is no definition anywhere. By actually putting the definition (that is, without <code>extern</code>) in one file (and one file only), the linker will be happy.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11441903"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562169028, "creation_date": 1562165965, "last_edit_date": 1562168118, "question_id": 56872984, "link": "https://stackoverflow.com/questions/56872984/clang-error-linker-command-failed-with-exit-code-1-use-v-to-see-invocation", "title": "clang: error: linker command failed with exit code 1 (use -v to see invocation) *about global variables", "body": "<p>I have a problem with compiling my files.\nI compiled and got this message</p>\n\n<pre><code>\"Undefined symbols for architecture x86_64:\n\"_airport_label\", referenced from:\n  FlightMap::pathfind_before(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;,             \nstd::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt; const&amp;) in FlightMap-9a7ab0.o\n  FlightMap::pathfind(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;,  \nstd::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt; const&amp;) in FlightMap-9a7ab0.o\n\"_dijkstra\", referenced from:\n  FlightMap::findShortestRoute(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, \nstd::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt; const&amp;) in FlightMap-9a7ab0.o\n  FlightMap::pathfind_before(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, \nstd::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt; const&amp;) in FlightMap-9a7ab0.o\n  FlightMap::fun_dijkstra(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;) in FlightMap-9a7ab0.o\n (maybe you meant: __ZN9FlightMap12fun_dijkstraERKNSt3__112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE)\n\"_distance_label\", referenced from:\n  FlightMap::pathfind_before(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, \nstd::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt; const&amp;) in FlightMap-9a7ab0.o\n  FlightMap::pathfind(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, \nstd::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt; const&amp;) in FlightMap-9a7ab0.o\n\"_path\", referenced from:\nFlightMap::pathfind(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, \nstd::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt; const&amp;) in FlightMap-9a7ab0.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\"\n</code></pre>\n\n<p>I think there are some problems in global variable in FlightMap.h file.<br>\n(I edited Flight.h -> FlightMap.h)\nI declared 4 global variables like</p>\n\n<pre><code>stack&lt;string&gt; path;\nmap&lt;string, string &gt; airport_label;\nmap&lt;double, string &gt; distance_label;\nmap&lt;string, double &gt; dijkstra;\n</code></pre>\n\n<p>I have already tried to put \"extern\" in front of each global variable but it does not work.</p>\n\n<p>In FlightMap.h file code(Edited Flight.h -> FlightMap.h)</p>\n\n<pre><code>#ifndef LAB6_FLIGHTMAP_H\n#define LAB6_FLIGHTMAP_H\n\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;stdexcept&gt;\n#include &lt;map&gt;\n#include &lt;list&gt;\n#include &lt;vector&gt;\n#include &lt;stack&gt;\n#include \"AdjacencyListDirectedGraph.h\"\n\n extern stack&lt;string&gt; path;\n extern map&lt;string, string &gt; airport_label;\n extern map&lt;double, string &gt; distance_label;\n extern map&lt;string, double &gt; dijkstra;\n .\n .\n .\n</code></pre>\n\n<p>Also, those global variables are used in FlightMap.cpp file.(I edited!) </p>\n\n<p>I think that is where problems occur</p>\n"}, {"tags": ["c++", "inheritance", "boost-spirit"], "answers": [{"comments": [{"owner": {"reputation": 663, "user_id": 7483509, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-rLN-a5QG95Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reidV1ZIp-ccT7ykiC9GJpJ54O-4A/mo/photo.jpg?sz=128", "display_name": "Nick Skywalker", "link": "https://stackoverflow.com/users/7483509/nick-skywalker"}, "edited": false, "score": 0, "creation_date": 1562230653, "post_id": 56875531, "comment_id": 100315818, "body": "In my question the base class does not have any attribute, I use it as an interface (like Java&#39;s <code>Interface</code>), the problem is a little bit different from the link in the first point. Why isn&#39;t it possible then?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 663, "user_id": 7483509, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-rLN-a5QG95Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reidV1ZIp-ccT7ykiC9GJpJ54O-4A/mo/photo.jpg?sz=128", "display_name": "Nick Skywalker", "link": "https://stackoverflow.com/users/7483509/nick-skywalker"}, "edited": false, "score": 0, "creation_date": 1562231613, "post_id": 56875531, "comment_id": 100316382, "body": "Nobody said it&#39;s not possible? If you use it like an interface, then by definition you&#39;re talking about the polymorphic aspect. I think my second link addresses that in full detail. The purely static inheritance aspect is trivial with no base data members (just don&#39;t mention there is a baseclass, done)."}, {"owner": {"reputation": 663, "user_id": 7483509, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-rLN-a5QG95Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reidV1ZIp-ccT7ykiC9GJpJ54O-4A/mo/photo.jpg?sz=128", "display_name": "Nick Skywalker", "link": "https://stackoverflow.com/users/7483509/nick-skywalker"}, "edited": false, "score": 0, "creation_date": 1562234332, "post_id": 56875531, "comment_id": 100318052, "body": "Yes the second answer may be more appropriated in the end. However I have not yet figure out how to make it work with <code>boost::variant</code>. Modify <code>BaseContainer</code> to store <code>variant&lt;A, B&gt;</code>?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 663, "user_id": 7483509, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-rLN-a5QG95Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reidV1ZIp-ccT7ykiC9GJpJ54O-4A/mo/photo.jpg?sz=128", "display_name": "Nick Skywalker", "link": "https://stackoverflow.com/users/7483509/nick-skywalker"}, "edited": false, "score": 0, "creation_date": 1562235762, "post_id": 56875531, "comment_id": 100318838, "body": "Do you want to change your question? Maybe you can post a new one if you&#39;re stuck with a different AST choice"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 663, "user_id": 7483509, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-rLN-a5QG95Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reidV1ZIp-ccT7ykiC9GJpJ54O-4A/mo/photo.jpg?sz=128", "display_name": "Nick Skywalker", "link": "https://stackoverflow.com/users/7483509/nick-skywalker"}, "edited": false, "score": 0, "creation_date": 1562235791, "post_id": 56875531, "comment_id": 100318849, "body": "Writing a small demo, hold on"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 663, "user_id": 7483509, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-rLN-a5QG95Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reidV1ZIp-ccT7ykiC9GJpJ54O-4A/mo/photo.jpg?sz=128", "display_name": "Nick Skywalker", "link": "https://stackoverflow.com/users/7483509/nick-skywalker"}, "edited": false, "score": 0, "creation_date": 1562237336, "post_id": 56875531, "comment_id": 100319675, "body": "There goes my lunch break :) <a href=\"https://wandbox.org/permlink/TKByJ5ZkXhTDdxen\" rel=\"nofollow noreferrer\">wandbox.org/permlink/TKByJ5ZkXhTDdxen</a>"}, {"owner": {"reputation": 663, "user_id": 7483509, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-rLN-a5QG95Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reidV1ZIp-ccT7ykiC9GJpJ54O-4A/mo/photo.jpg?sz=128", "display_name": "Nick Skywalker", "link": "https://stackoverflow.com/users/7483509/nick-skywalker"}, "edited": false, "score": 1, "creation_date": 1562244264, "post_id": 56875531, "comment_id": 100323428, "body": "Thanks a lot, I hope you took you time to lunch! I was away sorry for the delay. So using <code>variant</code> and the visitor pattern is the best solution for me, thanks again."}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 1, "last_activity_date": 1562237321, "last_edit_date": 1562237321, "creation_date": 1562176098, "answer_id": 56875531, "question_id": 56872966, "link": "https://stackoverflow.com/questions/56872966/parsing-inherited-struct-with-boost-spirit/56875531#56875531", "title": "Parsing inherited struct with boost spirit", "body": "<p>So there's two questions here, I feel:</p>\n\n<ul>\n<li>How to adapt derived classes <a href=\"https://stackoverflow.com/questions/47820378/can-i-use-boost-fusion-adapt-struct-with-inherited-stuff/47823573#47823573\">Can I use BOOST_FUSION_ADAPT_STRUCT with inherited stuff?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/23299722/how-can-i-use-polymorphic-attributes-with-boostspiritqi-parsers\">How can I use polymorphic attributes with boost::spirit::qi parsers?</a></li>\n</ul>\n\n<h2>Update</h2>\n\n<p>Small demo of approach 2 in the context of this question:</p>\n\n<p><strong><kbd><a href=\"https://wandbox.org/permlink/TKByJ5ZkXhTDdxen\" rel=\"nofollow noreferrer\">Live On Wandbox</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/spirit/include/qi.hpp&gt;\n#include &lt;boost/fusion/adapted.hpp&gt;\n#include &lt;map&gt;\n#include &lt;iomanip&gt; // std::quoted\n\nstruct Base {}; // dynamic polymorphism not required for us now, no problem if you want it\n\nstruct A : Base {\n    int value;\n    void operator()() const { std::cout &lt;&lt; \"Hello A: \" &lt;&lt; value &lt;&lt; std::endl; };\n};\n\nstruct B : Base {\n    float value;\n    void operator()() const { std::cout &lt;&lt; \"Hello B: \" &lt;&lt; value &lt;&lt; std::endl; };\n};\n\nusing Node = boost::variant&lt;A, B&gt;;\nstruct BaseContainer {\n    using Map = std::multimap&lt;std::string, Node&gt;;\n    Map container;\n};\n\nBOOST_FUSION_ADAPT_STRUCT(A, value)\nBOOST_FUSION_ADAPT_STRUCT(B, value)\nBOOST_FUSION_ADAPT_STRUCT(BaseContainer, container)\n\nnamespace qi = boost::spirit::qi;\n\ntemplate &lt;typename It&gt; \nstruct Parser : qi::grammar&lt;It, BaseContainer()&gt; {\n    Parser() : Parser::base_type(start) {\n        using namespace qi;\n        _key       = lexeme['\"' &gt;&gt; *('\\\\' &gt;&gt; char_ | ~char_('\"')) &gt;&gt; '\"'];\n        _a_node    = \"A(\" &gt;&gt; int_ &gt;&gt; \")\";\n        _b_node    = \"B(\" &gt;&gt; float_ &gt;&gt; \")\";\n        _node      = _a_node | _b_node;\n        _pair      = '{' &gt;&gt; _key &gt;&gt; ',' &gt;&gt; _node &gt;&gt; '}';\n        _container = '{' &gt;&gt; -(_pair % ',') &gt;&gt; '}';\n\n        start = skip(space) [ _container ];\n\n        BOOST_SPIRIT_DEBUG_NODES((start)(_container)(_pair)(_key)(_node)(_a_node)(_b_node))\n    }\n  private:\n    qi::rule&lt;It, BaseContainer()&gt; start;\n\n    // lexeme\n    qi::rule&lt;It, std::string()&gt; _key;\n\n    using Skipper = qi::space_type;\n    using Pair = std::pair&lt;std::string, Node&gt;;\n\n    qi::rule&lt;It, BaseContainer::Map(), Skipper&gt; _container;\n    qi::rule&lt;It, Pair(), Skipper&gt; _pair;\n    qi::rule&lt;It, Node(), Skipper&gt; _node;\n    qi::rule&lt;It, A(), Skipper&gt; _a_node;\n    qi::rule&lt;It, B(), Skipper&gt; _b_node;\n};\n\nint main() {\n    Parser&lt;std::string::const_iterator&gt; const p;\n    for (std::string const input : {\n            R\"({})\",\n            R\"({ { \"one\", A(42) } })\",\n            R\"({ { \"two\", B(3.14) } })\",\n            R\"({ { \"three\", A( -42 ) }, { \"four\", B( -3.14 ) } })\",\n            })\n    {\n        std::cout &lt;&lt; \"-------\\n\";\n        std::cout &lt;&lt; \"Parsing \" &lt;&lt; input &lt;&lt; \"\\n\";\n        auto f = begin(input), l = end(input);\n\n        BaseContainer result;\n        if (qi::parse(f, l, p, result)) {\n            for (auto const&amp; [k,v] : result.container) {\n                std::cout &lt;&lt; \" Key \" &lt;&lt; std::quoted(k) &lt;&lt; \": \";\n                boost::apply_visitor([](auto const&amp; node) { node(); }, v);\n            }\n        } else {\n            std::cout &lt;&lt; \"Parse failed\\n\";\n        }\n\n        if (f!=l) {\n            std::cout &lt;&lt; \"Remaining unparsed: \" &lt;&lt; std::quoted(std::string(f,l)) &lt;&lt; \"\\n\";\n        }\n    }\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>-------\nParsing {}\n-------\nParsing { { \"one\", A(42) } }\n Key \"one\": Hello A: 42\n-------\nParsing { { \"two\", B(3.14) } }\n Key \"two\": Hello B: 3.14\n-------\nParsing { { \"three\", A( -42 ) }, { \"four\", B( -3.14 ) } }\n Key \"four\": Hello B: -3.14\n Key \"three\": Hello A: -42\n</code></pre>\n"}], "owner": {"reputation": 663, "user_id": 7483509, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-rLN-a5QG95Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reidV1ZIp-ccT7ykiC9GJpJ54O-4A/mo/photo.jpg?sz=128", "display_name": "Nick Skywalker", "link": "https://stackoverflow.com/users/7483509/nick-skywalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 56875531, "answer_count": 1, "score": 1, "last_activity_date": 1562237321, "creation_date": 1562165902, "question_id": 56872966, "link": "https://stackoverflow.com/questions/56872966/parsing-inherited-struct-with-boost-spirit", "title": "Parsing inherited struct with boost spirit", "body": "<p>I have an abstract <code>struct Base</code> with no fields (only abstract methods) and <code>struct A</code>, <code>struct B</code> inheriting from <code>Base</code> with different fields in both.</p>\n\n<p>Is it possible to have a rule for parsing either a <code>A</code> or a <code>B</code> and store the result in a <code>shared_ptr&lt;Base&gt;</code>?</p>\n\n<p>I would like to do it in order to parse some <code>A</code> or <code>B</code> and store it in a container of <code>shared_ptr&lt;Base&gt;</code>.</p>\n\n<p>Here is a definition for the structs:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nstruct Base\n{\n  virtual void operator() const = 0;\n};\n\nstruct A : Base\n{\n  int value;\n  void operator() const override { cout &lt;&lt; \"Hello A: \" &lt;&lt; x &lt;&lt; endl; };\n};\n\nstruct B : Base\n{\n  float value;\n  void operator() const override { cout &lt;&lt; \"Hello B: \" &lt;&lt; x &lt;&lt; endl; };\n};\n\nstruct BaseContainer\n{\n  multimap&lt;string, shared_ptr&lt;Base&gt;&gt; container;\n}\n</code></pre>\n\n<p>Let's say a <code>BaseContainer</code> is  define by some input formatted like:</p>\n\n<pre><code>name: A value\nname: B value\nname: A value\n</code></pre>\n\n<p>where <code>name</code> is a placeholder for a string used as a key for the <code>multimap</code> in <code>BaseContainer</code>, then <code>A</code> or <code>B</code> is a keyword for generating a <code>struct A</code> or <code>struct B</code>, and value is the value stored in the container.</p>\n\n<p>How would I write a parser <code>BaseContainer</code>?</p>\n\n<p>The real example I want to apply it to is more complicated, <code>struct A</code> and <code>struct B</code> does not have same number of fields in it so please don't answer with something too specific to that example. \nThank you.</p>\n"}, {"tags": ["c++", "gstreamer"], "comments": [{"owner": {"reputation": 2372, "user_id": 2506522, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/930402a9a8c9d56b9a982a9070d51e23?s=128&d=identicon&r=PG", "display_name": "betontalpfa", "link": "https://stackoverflow.com/users/2506522/betontalpfa"}, "edited": false, "score": 0, "creation_date": 1562165598, "post_id": 56872832, "comment_id": 100294351, "body": "Hi and welcome to stackoverflow! Please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and reduce your code."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 2372, "user_id": 2506522, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/930402a9a8c9d56b9a982a9070d51e23?s=128&d=identicon&r=PG", "display_name": "betontalpfa", "link": "https://stackoverflow.com/users/2506522/betontalpfa"}, "edited": false, "score": 1, "creation_date": 1562166705, "post_id": 56872832, "comment_id": 100295010, "body": "@betontalpfa Looks pretty minimal to me"}, {"owner": {"reputation": 7, "user_id": 11708213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d170540d58181a6cfb99df4fa7b53f12?s=128&d=identicon&r=PG&f=1", "display_name": "Nisa Nur Erkin", "link": "https://stackoverflow.com/users/11708213/nisa-nur-erkin"}, "edited": false, "score": 0, "creation_date": 1562217899, "post_id": 56872832, "comment_id": 100310155, "body": "how can i do the synchronization?"}], "owner": {"reputation": 7, "user_id": 11708213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d170540d58181a6cfb99df4fa7b53f12?s=128&d=identicon&r=PG&f=1", "display_name": "Nisa Nur Erkin", "link": "https://stackoverflow.com/users/11708213/nisa-nur-erkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562167671, "creation_date": 1562165498, "last_edit_date": 1562167671, "question_id": 56872832, "link": "https://stackoverflow.com/questions/56872832/what-should-i-add-this-code-below-for-synchronization", "title": "What should i add this code below for synchronization?", "body": "<p>This is my code for video streaming over network in RTSP. When I open the second Vlc and stream again video start from beginning but I want to make synchronization for example The first video is in the 20th seconds, the second should start from the 20th second when I open it.</p>\n\n<p>What I must to do deal with synchronization?</p>\n\n<p>I am using VS17</p>\n\n<pre><code>#include \"pch.h\"\n#include &lt;iostream&gt;\n#include &lt;gst/gst.h&gt;\n#include &lt;gst/rtsp-server/rtsp-media.h&gt;\n#include &lt;gst/rtsp-server/rtsp-server.h&gt;\n#include &lt;gst/rtsp-server/rtsp-media-factory-uri.h&gt;\n\n #define PORT \"8554\"\n static char *port = (char *)PORT;\n\n static GOptionEntry entries[] = {\n{\"port\",'p', 0, G_OPTION_ARG_STRING, &amp;port,\"Port \" PORT \"\", \"PORT\"}, \n {NULL}  };\n\nint main(int argc, gchar * argv[])\n{\n    GMainLoop *loop;\n    GstRTSPServer *server;\n    GstRTSPMountPoints *mounts;\n    GstRTSPMediaFactoryURI *factory;\n    GOptionContext *sample;\n    GError *error = NULL;\n    gchar *uri;\n\n    sample = g_option_context_new(\"&lt;uri&gt; - Test RTSP Server, URI\");\n    g_option_context_add_main_entries(sample, entries, NULL);\n    g_option_context_add_group(sample, gst_init_get_option_group());\n    if (!g_option_context_parse(sample, &amp;argc, &amp;argv, &amp;error)) {\n        return -1;\n    }\n    loop = g_main_loop_new(NULL, FALSE);\n\n    server = gst_rtsp_server_new();\n    g_object_set(server, \"service\", port, NULL);\n\n    mounts = gst_rtsp_server_get_mount_points(server);\n\n    factory = gst_rtsp_media_factory_uri_new();\n\n    const char* streamUri = \n        \"https://www.freedesktop.org/software/gstreamer- \n         sdk/data/media/sintel_trailer-480p.webm\";\n\n    if (gst_uri_is_valid(streamUri)) {\n        uri = g_strdup(streamUri);\n    }\n    else if (g_file_test(streamUri, G_FILE_TEST_EXISTS)) {\n        uri = gst_filename_to_uri(streamUri, NULL);\n    }\n    else {\n        printf(\"There is no uri\");\n        return -1;\n    }\n\n    gst_rtsp_media_factory_uri_set_uri(factory, uri);\n    g_free(uri);\n\n    gst_rtsp_mount_points_add_factory(mounts, \"/deneme\", \n        GST_RTSP_MEDIA_FACTORY(factory));\n\n    g_object_unref(mounts);\n\n    if (gst_rtsp_server_attach(server, NULL) == 0)\n        printf(\"FAILED!\");\n\n    g_print(\"stream ready at rtsp://127.0.0.1:%s/deneme\\n\", port);\n    g_main_loop_run(loop);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "floating-point", "ieee-754"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1562179511, "post_id": 56872769, "comment_id": 100301055, "body": "Based on <i>&quot;... mantissa in 53 bits ...&quot;</i> and <i>&quot;... determine the size (at compile time)&quot;</i>, I believe OP is seeking a define or constant for the size of the mantissa in bits."}, {"owner": {"reputation": 5984, "user_id": 32836, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d3ecad86d72c5ca5e3ccbcc46a0ad66a?s=128&d=identicon&r=PG", "display_name": "Jamie", "link": "https://stackoverflow.com/users/32836/jamie"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1562270164, "post_id": 56872769, "comment_id": 100333634, "body": "@jww Yes, I <i>am</i> looking for a define or constance for the size of the signifcand (mantissa) in bits."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1562167031, "post_id": 56873123, "comment_id": 100295172, "body": "But note that knowing how many bits does not tell you which ones they are.  Also, the OP may need to account for the leading 1 bit that is implicit in normalized IEEE-754 representations."}], "tags": [], "owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1562166396, "creation_date": 1562166396, "answer_id": 56873123, "question_id": 56872769, "link": "https://stackoverflow.com/questions/56872769/how-can-the-significand-width-in-bits-of-float-double-be-determined-is-there-a/56873123#56873123", "title": "How can the significand width in bits of float, double be determined: Is there a standard definition?", "body": "<p>Use <code>FLT_MANT_DIG</code> and <code>DBL_MANT_DIG</code>, defined in <code>&lt;float.h&gt;</code>:</p>\n\n<pre><code>#include &lt;float.h&gt;\n#include &lt;stdio.h&gt;\n\n\n#if FLT_RADIX != 2\n    #error \"Floating-point base is not two.\"\n#endif\n\n\nint main(void)\n{\n    printf(\"There are %d bits in the significand of a float.\\n\",\n        FLT_MANT_DIG);\n    printf(\"There are %d bits in the significand of a double.\\n\",\n        DBL_MANT_DIG);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5984, "user_id": 32836, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d3ecad86d72c5ca5e3ccbcc46a0ad66a?s=128&d=identicon&r=PG", "display_name": "Jamie", "link": "https://stackoverflow.com/users/32836/jamie"}, "edited": false, "score": 0, "creation_date": 1562269686, "post_id": 56874107, "comment_id": 100333497, "body": "I apologise that you were forced to determine what I was asking for: I don&#39;t want to have to assume that the bit width of the mantissa is 53 bits.  I&#39;d rather have a macro that tells my code: &quot;<i>the bit width of the mantissa for a double is DBL_MANT_BIT_WIDTH</i>&quot; (say)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5984, "user_id": 32836, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d3ecad86d72c5ca5e3ccbcc46a0ad66a?s=128&d=identicon&r=PG", "display_name": "Jamie", "link": "https://stackoverflow.com/users/32836/jamie"}, "edited": false, "score": 0, "creation_date": 1562298760, "post_id": 56874107, "comment_id": 100338442, "body": "Well that would be the <code>DBL_MANT_DIG</code> macro from <code>float.h</code> that both answers reference.  Do choose Eric&#39;s answer over mine, though, as he was first, guessed correctly what you wanted, and even provided a nice example demonstrating it."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1562170064, "last_edit_date": 1562170064, "creation_date": 1562169741, "answer_id": 56874107, "question_id": 56872769, "link": "https://stackoverflow.com/questions/56872769/how-can-the-significand-width-in-bits-of-float-double-be-determined-is-there-a/56874107#56874107", "title": "How can the significand width in bits of float, double be determined: Is there a standard definition?", "body": "<blockquote>\n  <p>Is there a standard manner to determine the mantissa of a double?</p>\n</blockquote>\n\n<p>You're willing to accept a Linux-specific solution, but you claim that glibc's <code>ieee754.h</code> header does not satisfy your needs, so I conclude that the problem you are trying to solve is not extracting or conveying the bits themselves, as that header's <code>union ieee_double</code> would provide a means for you to do that.</p>\n\n<p>I read \"the mantissa\" as a different thing from \"the number of bits of mantissa\", so I conclude that <code>DBL_MANT_DIG</code> of <code>float.h</code> is not what you're looking for, either.</p>\n\n<p>The only other thing I can think of that you might mean is the <em>value</em> of the significand (mantissa), according to the standard floating point model:</p>\n\n<p><em>v</em> = (<em>sign</em>) * <em>significand</em> * <em>radix</em><sup><em>exponent</em></sup></p>\n\n<p>The <a href=\"https://linux.die.net/man/3/frexp\" rel=\"nofollow noreferrer\"><code>frexp()</code></a> function, in the C language standard since C99, serves this purpose.<sup>1</sup>  It separates a <code>double</code> into an exponent (of 2) and a significand, represented as a <code>double</code>.  For a finite, nonzero input, the absolute value of the result is in the half-open interval [0.5, 1).</p>\n\n<p><strong>Example</strong>:</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid print_parts(double d) {\n    int exp;\n    double significand = frexp(d, &amp;exp);\n\n    printf(\"%e = %f * 2^%d\\n\", d, significand, exp);\n}\n</code></pre>\n\n<p><strong><em>Sample outputs</em></strong>:</p>\n\n<blockquote>\n  <p>7.256300e+16 = 0.503507 * 2^57<br/>\n  1.200000e-03 = 0.614400 * 2^-9<br/>\n  -0.000000e+00 = -0.000000 * 2^0</p>\n</blockquote>\n\n<p>Note that although the example function does not print sufficient decimal digits to convey the significands exactly, <code>frexp()</code> itself is exact, not subject to any rounding errors.</p>\n\n<hr>\n\n<p><sup>1</sup> Technically, <code>frexp()</code> serves the purpose <em>provided that</em> <code>FLT_RADIX</code> expands to 2.  It is well-defined in any case, but if your <code>double</code> representation uses a different radix then the result of <code>frexp()</code>, though well-defined, is probably not what you're looking for.</p>\n"}, {"tags": [], "owner": {"reputation": 2876, "user_id": 7958961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9fc6004eafe9f7b473927ecfd65646?s=128&d=identicon&r=PG&f=1", "display_name": "Rados\u0142aw Cybulski", "link": "https://stackoverflow.com/users/7958961/rados%c5%82aw-cybulski"}, "is_accepted": false, "score": 2, "last_activity_date": 1562337841, "creation_date": 1562337841, "answer_id": 56905198, "question_id": 56872769, "link": "https://stackoverflow.com/questions/56872769/how-can-the-significand-width-in-bits-of-float-double-be-determined-is-there-a/56905198#56905198", "title": "How can the significand width in bits of float, double be determined: Is there a standard definition?", "body": "<p>In C++ you might use <code>std::numeric_limits&lt;double&gt;::digits</code> and <code>std::numeric_limits&lt;float&gt;::digits</code>:</p>\n\n<pre><code>#include &lt;limits&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::cout &lt;&lt; std::numeric_limits&lt;float&gt;::digits &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; std::numeric_limits&lt;double&gt;::digits &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>24\n53\n</code></pre>\n\n<p>respectively.</p>\n"}], "owner": {"reputation": 5984, "user_id": 32836, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d3ecad86d72c5ca5e3ccbcc46a0ad66a?s=128&d=identicon&r=PG", "display_name": "Jamie", "link": "https://stackoverflow.com/users/32836/jamie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 56873123, "answer_count": 3, "score": 0, "last_activity_date": 1562337841, "creation_date": 1562165322, "last_edit_date": 1562337491, "question_id": 56872769, "link": "https://stackoverflow.com/questions/56872769/how-can-the-significand-width-in-bits-of-float-double-be-determined-is-there-a", "title": "How can the significand width in bits of float, double be determined: Is there a standard definition?", "body": "<p>Is there a standard manner to determine the width of the significand of a double, in C or C++?  I am aware that IEEE-754 format of a double stores the significand in 53 bits, but I would like to avoid using a \u201cmagic\u201d number in my code.</p>\n\n<p>On Linux, the file <code>usr/include/ieee754.h</code> exists, but it describes the format using bit fields in a structure, which I cannot determine the size of (at compile time).</p>\n\n<p>A Linux-only solution is acceptable.</p>\n"}, {"tags": ["c++", "variadic-templates", "template-meta-programming"], "answers": [{"comments": [{"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 1, "creation_date": 1562165693, "post_id": 56872877, "comment_id": 100294397, "body": "That&#39;s UB with multiple <code>i++</code> in the one expression, right?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 1, "creation_date": 1562165720, "post_id": 56872877, "comment_id": 100294417, "body": "@Quimby Not when using an initializer list"}, {"owner": {"reputation": 59, "user_id": 11617392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874873303d7876eca5cdca47dcbdee3a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Tony", "link": "https://stackoverflow.com/users/11617392/dan-tony"}, "edited": false, "score": 0, "creation_date": 1562166064, "post_id": 56872877, "comment_id": 100294623, "body": "This looks very interesting! Where can I read more as to how this actually works? Or is there a simple explanation?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 1, "creation_date": 1562166069, "post_id": 56872877, "comment_id": 100294625, "body": "@Quimby No problem.  Initializer lists and comma operator list provide strong sequencing guarantees that make each element a full expression and each subsequent element sequenced after the preceding elements."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 59, "user_id": 11617392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874873303d7876eca5cdca47dcbdee3a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Tony", "link": "https://stackoverflow.com/users/11617392/dan-tony"}, "edited": false, "score": 0, "creation_date": 1562166659, "post_id": 56872877, "comment_id": 100294984, "body": "@DanTony - take also in count that the comma operator (inside the round parentheses) execute the element on the left (so call the <code>do_stuff()</code> function) but discard it&#39;s result and &quot;return&quot; the value on the right; this way you can execute functions that doesn&#39;t return a value (or return not <code>int</code> values) inside the initialization of an array of <code>int</code>&#39;s. The <code>(void)</code> before the <code>do_stuff()</code> call is in case the function return a <code>T</code> type that redefine the comma operator. The first zero is in case the <code>T...</code> list is empty (you can&#39;t initialize an <code>int[]</code> with an empty initialization list)."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 4, "last_activity_date": 1562165919, "last_edit_date": 1562165919, "creation_date": 1562165637, "answer_id": 56872877, "question_id": 56872749, "link": "https://stackoverflow.com/questions/56872749/call-right-template-specialization-for-each-type-of-a-variadic-template/56872877#56872877", "title": "Call right template specialization for each type of a variadic template", "body": "<p>What about as follows ?</p>\n\n<pre><code>template &lt;typename ... T&gt;\nvoid foo (std::vector&lt;int&gt; const &amp; p)\n{\n    assert(p.size() == sizeof...(T));\n\n    using unused = int[];\n\n    std::size_t  i{ 0u };\n\n    (void)unused { 0, ((void)do_stuff&lt;T&gt;(p[i++]), 0)... };\n}\n</code></pre>\n\n<p>If you can use C++17, see the Vittorio Romeo's answer for a more elegant and concise solution. </p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 11617392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874873303d7876eca5cdca47dcbdee3a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Tony", "link": "https://stackoverflow.com/users/11617392/dan-tony"}, "edited": false, "score": 0, "creation_date": 1562166159, "post_id": 56872911, "comment_id": 100294676, "body": "I like the fold solution, but what is happening in the second? Is that... a templated lambda function?"}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 59, "user_id": 11617392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874873303d7876eca5cdca47dcbdee3a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Tony", "link": "https://stackoverflow.com/users/11617392/dan-tony"}, "edited": false, "score": 0, "creation_date": 1562166592, "post_id": 56872911, "comment_id": 100294944, "body": "@DanTony: yes, this is a C++20 feature. In C++17 you would need to create a separate template function that takes the <code>index_sequence</code>, resulting in more boilerplate."}], "tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": true, "score": 6, "last_activity_date": 1562165878, "last_edit_date": 1562165878, "creation_date": 1562165715, "answer_id": 56872911, "question_id": 56872749, "link": "https://stackoverflow.com/questions/56872749/call-right-template-specialization-for-each-type-of-a-variadic-template/56872911#56872911", "title": "Call right template specialization for each type of a variadic template", "body": "<p>You can use a C++17 fold expression:</p>\n\n<pre><code>template &lt;typename... T&gt;\nvoid foo(const std::vector&lt;int&gt;&amp; p)\n{\n    assert(p.size() == sizeof...(T));\n\n    std::size_t i{};\n    (do_stuff&lt;T&gt;(p[i++]), ...);\n}\n</code></pre>\n\n<p><a href=\"https://gcc.godbolt.org/z/krHDZR\" rel=\"nofollow noreferrer\"><strong>live example on godbolt.org</strong></a></p>\n\n<hr>\n\n<p>Alternatively, you can avoid the mutable <code>i</code> variable with <code>std::index_sequence</code>:</p>\n\n<pre><code>template &lt;typename... T&gt;\nvoid foo(const std::vector&lt;int&gt;&amp; p)\n{\n    assert(p.size() == sizeof...(T));\n\n    [&amp;p]&lt;auto... Is&gt;(std::index_sequence&lt;Is...&gt;)\n    {\n        (do_stuff&lt;T&gt;(p[Is]), ...);\n    }(std::index_sequence_for&lt;T...&gt;{});\n}\n</code></pre>\n\n<p><a href=\"https://gcc.godbolt.org/z/EDmqCT\" rel=\"nofollow noreferrer\"><strong>live example on godbolt.org</strong></a></p>\n"}], "owner": {"reputation": 59, "user_id": 11617392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874873303d7876eca5cdca47dcbdee3a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Tony", "link": "https://stackoverflow.com/users/11617392/dan-tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 56872911, "answer_count": 2, "score": 1, "last_activity_date": 1562166225, "creation_date": 1562165283, "last_edit_date": 1562166225, "question_id": 56872749, "link": "https://stackoverflow.com/questions/56872749/call-right-template-specialization-for-each-type-of-a-variadic-template", "title": "Call right template specialization for each type of a variadic template", "body": "<p>I have a function <code>foo()</code> that takes a list of types <code>T...</code> and inside calls another (templated) function called <code>do_stuff()</code> for every element of a vector that is passed in. More specifically, we loop over the vector (of length <code>sizeof...(T)</code>), and would like to call <code>do_stuff&lt;Ti&gt;()</code> for <code>vector[i]</code>, where <code>Ti</code> is the <code>i</code>'th type in <code>T...</code></p>\n\n<p>The information is available at compile time so I guess this is possible, but how we do it nicely?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;cassert&gt;\n\ntemplate &lt;typename T&gt;\nT do_stuff(int param);\n\ntemplate &lt;&gt;\nint do_stuff(int param)\n{\n    return int(100);\n}\n\ntemplate &lt;&gt;\nstd::string do_stuff(int param)\n{\n    return std::string(\"foo\");\n}\n\ntemplate &lt;typename... T&gt;\nvoid foo(const std::vector&lt;int&gt;&amp; p)\n{\n    assert(p.size() == sizeof...(T));\n    for (int i = 0; i &lt; p.size(); ++i)\n    {\n        // Won't compile as T is not specified:\n        //do_stuff(p[i]);\n        // How do we choose the right T, in this case Ti from T...?\n    }\n}\n\nint main()\n{\n    std::vector&lt;int&gt; params = { 0,1,0,5 };\n    foo&lt;int, std::string, std::string, int&gt;(params);\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "auto"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 4, "creation_date": 1562164997, "post_id": 56872548, "comment_id": 100293948, "body": "Why do you think results are undefined?"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1562165339, "post_id": 56872548, "comment_id": 100294190, "body": "&quot;<i>Why do C++ compilers allow this when results are undefined for sure?</i>&quot; There are simpler examples of code that exhibit undefined behavior, which compiles successfully: <code>int* pa; {int a = 5; pa = &amp;a;} *pa = 1;</code>"}, {"owner": {"reputation": 73, "user_id": 10421053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TQJYXqHtong/AAAAAAAAAAI/AAAAAAAAAF0/kn8XuaEKvOY/photo.jpg?sz=128", "display_name": "Kshitij Shukla", "link": "https://stackoverflow.com/users/10421053/kshitij-shukla"}, "edited": false, "score": 0, "creation_date": 1562216883, "post_id": 56872548, "comment_id": 100309868, "body": "Actually I&#39;ve had unfortunate instances where I was trying to modify the container itself in a range based for loop and got undefined results and I assumed that the same extends to this code as well. Now that I got answers, I&#39;ll change the question to make it generic instead of asking to resolve a wrong assumption."}], "answers": [{"tags": [], "owner": {"reputation": 1395, "user_id": 3808426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6388b9d4ea9d6e02525fa212aa9d817d?s=128&d=identicon&r=PG&f=1", "display_name": "Demosthenes", "link": "https://stackoverflow.com/users/3808426/demosthenes"}, "is_accepted": true, "score": 10, "last_activity_date": 1562164882, "creation_date": 1562164882, "answer_id": 56872589, "question_id": 56872548, "link": "https://stackoverflow.com/questions/56872548/why-doesnt-range-based-for-loop-modifiy-container-elements/56872589#56872589", "title": "Why doesn&#39;t range-based for loop modifiy container elements?", "body": "<p>Your for loop copies v, then sorts it. The original is untouched. What you want is <code>for (auto &amp;v : arr)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 2, "last_activity_date": 1562166328, "last_edit_date": 1562166328, "creation_date": 1562165474, "answer_id": 56872822, "question_id": 56872548, "link": "https://stackoverflow.com/questions/56872548/why-doesnt-range-based-for-loop-modifiy-container-elements/56872822#56872822", "title": "Why doesn&#39;t range-based for loop modifiy container elements?", "body": "<blockquote>\n  <p>I recently came to know that when a data inside range based for loop is modified, the result is undefined.</p>\n</blockquote>\n\n<p>You got it quite wrong. It is Undefined Behavior if you modify container itself you iterating over (like adding or removing elements to it), not that you modify data it contains:</p>\n\n<pre><code> std::vector&lt;int&gt; v( 10 );\n for( auto i : v ) v.push_back( 10 ); // UB as v is modified, new element inserted to it\n</code></pre>\n\n<p>vs:</p>\n\n<pre><code> std::vector&lt;int&gt; v( 10 );\n for( auto &amp;i : v ) i = 123; // totally fine you modify elements inside vector\n</code></pre>\n\n<p>Rest of your question is meaningless as it is based on this wrong assumption. The reason you  do not observe data inside your vector change is different and already answered. But even if you fix your code and make it modify your container data it would be still fine.</p>\n\n<p>Pedantic note: even statement that it is UB to modify container you iterating over is too generic. You may for example delete elements in <code>std::list</code> while iterating over it and still avoid UB. But of course such code should not be written at all, as it would be quite error prone and iterating over iterators range should be done in this case.</p>\n"}, {"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1562165851, "last_edit_date": 1562165851, "creation_date": 1562165524, "answer_id": 56872839, "question_id": 56872548, "link": "https://stackoverflow.com/questions/56872548/why-doesnt-range-based-for-loop-modifiy-container-elements/56872839#56872839", "title": "Why doesn&#39;t range-based for loop modifiy container elements?", "body": "<p>Nothing here is undefined, and there is no reason for there to be a syntax error.</p>\n\n<p>Your loop iterates the outer vector <em>by value</em>, then sorts the local copy of the inner vector. It's pointless, but it's not naughty.</p>\n\n<blockquote>\n  <p>I recently came to know that when a data inside range based for loop is modified, the result is undefined.</p>\n</blockquote>\n\n<p>You can't structurally modify the thing you're iterating over, true, as that breaks the iteration.</p>\n\n<p>But that's not what you did. Even if you'd written <code>auto&amp; v : arr</code>, and thus modified the values of the inner vectors, you're still not performing any operation that disrupts the iteration of the outer vector <code>arr</code>.</p>\n\n<p>Don't write <code>arr.clear()</code> inside the loop, though!</p>\n\n<blockquote>\n  <p>Why is modification of auto iterated data not a syntax error?</p>\n</blockquote>\n\n<p>Even if your program had undefined behaviour, that's never a syntax error, and often not even a runtime error.</p>\n\n<p>But if there <em>were</em> a blanket rule stating that no mutating operations could ever be performed inside a range-based for loop, rest assured the semantics of the language would probably mandate a compile-time error to stop you from doing it (like how you cannot build a program that modifies a <code>const int</code> directly).</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 10421053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TQJYXqHtong/AAAAAAAAAAI/AAAAAAAAAF0/kn8XuaEKvOY/photo.jpg?sz=128", "display_name": "Kshitij Shukla", "link": "https://stackoverflow.com/users/10421053/kshitij-shukla"}, "edited": false, "score": 0, "creation_date": 1562217738, "post_id": 56872865, "comment_id": 100310106, "body": "Actually that did happen a couple of times with me that i tried to modify the container I was iterating and got me weird results. Hence I added that question. Anyway it is much clear now."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1562166302, "last_edit_date": 1562166302, "creation_date": 1562165587, "answer_id": 56872865, "question_id": 56872548, "link": "https://stackoverflow.com/questions/56872548/why-doesnt-range-based-for-loop-modifiy-container-elements/56872865#56872865", "title": "Why doesn&#39;t range-based for loop modifiy container elements?", "body": "<blockquote>\n  <p>Why is modification of auto iterated data not a syntax error?</p>\n</blockquote>\n\n<p>Because it is syntactically well formed to modify variables, whether the variable is a reference or not. Example:</p>\n\n<pre><code>int j = 0\nint&amp; i = j; // i refers to j\ni = 42; // OK; j is modified\n\n\nint j = 0\nint i = j; // i is a copy of j\ni = 42; // OK even though i is not reference\n        // j is not modified; only i is\n\nint j = 0\nauto i = j; // i is a copy of j\ni = 42; // OK; same as above except using auto deduced type\n        // j is not modified\n\nstd::vector&lt;int&gt; int_vec(10);\nfor(int i : int_vec)\n    i = 42; // OK; same as above except within a loop\n            // the vector is not modified\n\nfor(auto i : int_vec) // i is a copy\n    i = 42; // OK; same as above except using both auto and a loop\n            // the vector is not modified\n\nfor(auto&amp; i : int_vec) // i is a reference\n    i = 42; // OK; elements of the vector are modified\n</code></pre>\n\n<blockquote>\n  <p>I recently came to know that when a data inside range based for loop is modified, the result is undefined. </p>\n</blockquote>\n\n<p>You've come across incorrect knowledge. Modifying variables inside range based for loop does not produce an undefined result.</p>\n\n<p>There are some operations that may not be performed on the range that is being iterated, in particular those that invalidate iterators / references to elements of the iterated range. You may have been confused by this.</p>\n\n<p>The program that you show has well-defined behaviour. However, you may have intended to sort the vector elements, which you have not done successfully. In order to do that, you must <em>refer</em> to the elements of the vector, rather than make a copy. That is achieved by using a refernce:</p>\n\n<pre><code>for( auto &amp;v : arr )\n          ^ this makes the variable a reference\n</code></pre>\n\n<blockquote>\n  <p>Whereas when i sort as sort(arr[0].begin(), arr[0].end()), the result is correct.</p>\n</blockquote>\n\n<p>The subscript operator returns a <em>reference</em>.</p>\n"}], "owner": {"reputation": 73, "user_id": 10421053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TQJYXqHtong/AAAAAAAAAAI/AAAAAAAAAF0/kn8XuaEKvOY/photo.jpg?sz=128", "display_name": "Kshitij Shukla", "link": "https://stackoverflow.com/users/10421053/kshitij-shukla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 56872589, "answer_count": 4, "score": 0, "last_activity_date": 1562217429, "creation_date": 1562164732, "last_edit_date": 1562217429, "question_id": 56872548, "link": "https://stackoverflow.com/questions/56872548/why-doesnt-range-based-for-loop-modifiy-container-elements", "title": "Why doesn&#39;t range-based for loop modifiy container elements?", "body": "<p>I recently observed that modifying data inside a auto iterated vector is not yielding correct results for me. For example when i tried to sort elements of vector of vector, some elements were not sorted but the code ran successfully</p>\n\n<pre><code>vector&lt;vector&lt;int&gt; &gt; arr;\narr.push_back({38, 27});\nfor(auto v : arr)\n{\n    sort(v.begin(), v.end());\n}\n</code></pre>\n\n<p>The output of above code after sorting is still 38, 27 after sorting. Whereas when i sort as sort(arr[0].begin(), arr[0].end()), the result is correct. I compiled using gcc.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1562165041, "post_id": 56872487, "comment_id": 100293979, "body": "Try deleting <code>__declspec(dllexport)</code> and see what difference it makes."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1562165055, "post_id": 56872487, "comment_id": 100293990, "body": "<code>__declspec</code> is an MSVC compiler extension and it looks like you&#39;re using GCC."}, {"owner": {"reputation": 2643, "user_id": 3736306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b04e15baa8fe1cfac912948db67b919d?s=128&d=identicon&r=PG&f=1", "display_name": "yuqli", "link": "https://stackoverflow.com/users/3736306/yuqli"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1562165219, "post_id": 56872487, "comment_id": 100294105, "body": "@john Now it works. Thanks so much!"}, {"owner": {"reputation": 2643, "user_id": 3736306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b04e15baa8fe1cfac912948db67b919d?s=128&d=identicon&r=PG&f=1", "display_name": "yuqli", "link": "https://stackoverflow.com/users/3736306/yuqli"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1562165280, "post_id": 56872487, "comment_id": 100294148, "body": "@Quentin right I suspect that&#39;s the reason too but am not fully sure if <code>__declspec</code> works under Linux. Seems I don&#39;t need that : <a href=\"https://stackoverflow.com/questions/43610241/use-of-declspec-in-gcc-or-g-linux\" title=\"use of declspec in gcc or g linux\">stackoverflow.com/questions/43610241/&hellip;</a>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562165920, "post_id": 56872487, "comment_id": 100294549, "body": "<b><i>not fully sure if __declspec works under Linux</i></b> Since there is no MSVC linux compiler (that I know of) I would say it does not work under linux."}, {"owner": {"reputation": 2643, "user_id": 3736306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b04e15baa8fe1cfac912948db67b919d?s=128&d=identicon&r=PG&f=1", "display_name": "yuqli", "link": "https://stackoverflow.com/users/3736306/yuqli"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1562168526, "post_id": 56872487, "comment_id": 100295998, "body": "@drescherjm thanks for the clarification!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1562168730, "post_id": 56872487, "comment_id": 100296091, "body": "So we have all the answers in the comments section (which worked) and nothing in the answer section. Now what?"}], "owner": {"reputation": 2643, "user_id": 3736306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b04e15baa8fe1cfac912948db67b919d?s=128&d=identicon&r=PG&f=1", "display_name": "yuqli", "link": "https://stackoverflow.com/users/3736306/yuqli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562164891, "creation_date": 1562164543, "last_edit_date": 1562164891, "question_id": 56872487, "link": "https://stackoverflow.com/questions/56872487/expected-constructor-destructor-or-type-conversion-before-token-with-dec", "title": "expected constructor, destructor, or type conversion before \u2018(\u2019 token with __declspec(dllexport)", "body": "<p>I've looked through a few posts on this same error and it seems this happens when the compiler can't find a constructor that matches the signature? </p>\n\n<p>But I can't rule out the possibility since my case is rather different - it has a <code>__declspec(dllexport)</code> and I'm not sure if this it the culprit causing the problem. </p>\n\n<p>Here is the error message:</p>\n\n<pre><code>yuqiong@yuqiong-G7-7588:/media/yuqiong/DATA/Vignetting_corrector/C++/Vig_Correction/build$ make\nScanning dependencies of target correction\n[ 50%] Building CXX object CMakeFiles/correction.dir/Vig_Correction.cpp.o\nIn file included from /media/yuqiong/DATA/Vignetting_corrector/C++/Vig_Correction/Vig_Correction.cpp:5:0:\n/media/yuqiong/DATA/Vignetting_corrector/C++/Vig_Correction/ColorCorrection.hpp:16:10: error: expected constructor, destructor, or type conversion before \u2018(\u2019 token\n _declspec(dllexport) int VignettingCorrectionUsingRG(unsigned char* pImage, int ht, int wd,\n          ^\n/media/yuqiong/DATA/Vignetting_corrector/C++/Vig_Correction/Vig_Correction.cpp: In function \u2018int VignettingCorrect(IplImage*)\u2019:\n/media/yuqiong/DATA/Vignetting_corrector/C++/Vig_Correction/Vig_Correction.cpp:47:65: error: \u2018VignettingCorrectionUsingRG\u2019 was not declared in this scope\n  int flag=VignettingCorrectionUsingRG(pImageBuffer, sht, swd, vp);\n                                                                 ^\nCMakeFiles/correction.dir/build.make:62: recipe for target 'CMakeFiles/correction.dir/Vig_Correction.cpp.o' failed\nmake[2]: *** [CMakeFiles/correction.dir/Vig_Correction.cpp.o] Error 1\nCMakeFiles/Makefile2:72: recipe for target 'CMakeFiles/correction.dir/all' failed\nmake[1]: *** [CMakeFiles/correction.dir/all] Error 2\nMakefile:83: recipe for target 'all' failed\nmake: *** [all] Error 2\n</code></pre>\n\n<p>Here is my <code>ColorCorrection.hpp</code> file...</p>\n\n<pre><code>#ifndef COLOR_CORRECTION_HPP\n#define COLOR_CORRECTION_HPP\n\n#include &lt;vector&gt;\nusing namespace std;\n\n__declspec(dllexport) int VignettingCorrectionUsingRG(unsigned char* pImage, int ht, int wd, vector&lt;double&gt;&amp; vp);\n\n#endif\n</code></pre>\n\n<p>Thanks so much for your help in advance...</p>\n"}, {"tags": ["c#", "c++", "callback", "pinvoke", "dllimport"], "comments": [{"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1562164666, "post_id": 56872435, "comment_id": 100293730, "body": "If there are no errors, what do you mean it&#39;s crashing? I don&#39;t see any code where you&#39;re doing any kind of output, so couldn&#39;t it just be completing successfully? Do you mean the console window is closing? Add a <code>Console.ReadLine()</code> to the end of your C# program."}, {"owner": {"reputation": 21, "user_id": 7419294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RbvEU3d9Ro/AAAAAAAAAAI/AAAAAAAAABc/PIQ_azGtXRA/photo.jpg?sz=128", "display_name": "xBones", "link": "https://stackoverflow.com/users/7419294/xbones"}, "reply_to_user": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1562164913, "post_id": 56872435, "comment_id": 100293893, "body": "It&#39;s a Windows Forms application, the application exits whenever that function is ran."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1562165518, "post_id": 56872435, "comment_id": 100294297, "body": "The garbage collector probably runs somehow and your managed pointers are gone when called from managed code. Probably a duplicate of this:  <a href=\"https://stackoverflow.com/questions/4906931/nullreferenceexception-during-c-callback-to-c-sharp-function\" title=\"nullreferenceexception during c callback to c sharp function\">stackoverflow.com/questions/4906931/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 7419294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RbvEU3d9Ro/AAAAAAAAAAI/AAAAAAAAABc/PIQ_azGtXRA/photo.jpg?sz=128", "display_name": "xBones", "link": "https://stackoverflow.com/users/7419294/xbones"}, "edited": false, "score": 0, "creation_date": 1562166411, "post_id": 56872435, "comment_id": 100294847, "body": "Hmmm, that is different from what I&#39;m doing kind of though..."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562168480, "post_id": 56872435, "comment_id": 100295977, "body": "So is that C# rendition of the C++ struct exactly the same?  And I mean <i>exactly</i> the same (padding, layout, size, etc.)?  Looking and matching up the members is not proof of this."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1562168751, "post_id": 56872435, "comment_id": 100296107, "body": "Different from what?"}, {"owner": {"reputation": 21, "user_id": 7419294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RbvEU3d9Ro/AAAAAAAAAAI/AAAAAAAAABc/PIQ_azGtXRA/photo.jpg?sz=128", "display_name": "xBones", "link": "https://stackoverflow.com/users/7419294/xbones"}, "reply_to_user": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1562169291, "post_id": 56872435, "comment_id": 100296356, "body": "Different from the link you sent me. @SimonMourier   And I suppose it&#39;s the same isn&#39;t it"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1562169654, "post_id": 56872435, "comment_id": 100296558, "body": "C# <code>ulong</code> is 64 bits, C++ <code>unsigned long</code> is 32 bits. There are loads of critical sections of code missing which could be the cause of the problem. We don&#39;t know whether the calling conventions match, whether the delegates are protected from collection, and probably more potential pitfalls besides. Unfortunately it is so common for pinvoke questions to be missing critical detail."}, {"owner": {"reputation": 21, "user_id": 7419294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RbvEU3d9Ro/AAAAAAAAAAI/AAAAAAAAABc/PIQ_azGtXRA/photo.jpg?sz=128", "display_name": "xBones", "link": "https://stackoverflow.com/users/7419294/xbones"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1562169882, "post_id": 56872435, "comment_id": 100296677, "body": "@DavidHeffernan In this specific piece of code, the only thing I use is unsigned int (in the struct) and I set that as <code>int</code> but If you think that&#39;s wrong please tell me, I&#39;m sorta new to this. Apologies. And the function return value should be ulong I think. Correct me if i&#39;m wrong."}, {"owner": {"reputation": 21, "user_id": 7419294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RbvEU3d9Ro/AAAAAAAAAAI/AAAAAAAAABc/PIQ_azGtXRA/photo.jpg?sz=128", "display_name": "xBones", "link": "https://stackoverflow.com/users/7419294/xbones"}, "edited": false, "score": 0, "creation_date": 1562170014, "post_id": 56872435, "comment_id": 100296747, "body": "The calling conventions do match because I have a bunch of other functions and they all work with that convention. I&#39;m pretty sure it is correct."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1562171879, "post_id": 56872435, "comment_id": 100297637, "body": "Have you read Hans&#39; answer in the link I provided? You don&#39;t seem to fix callback references (pointer to managed functions). If you don&#39;t fix them, GC can move/destroy them as it see fits."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1562172188, "post_id": 56872435, "comment_id": 100297788, "body": "I already corrected you about the function return value. I explained why <code>ulong</code> is wrong. If you are so sure that you did everything right that you don&#39;t want to entertain criticism, then you&#39;ve come to the wrong place. It&#39;s hard enough helping at the best of times, but it&#39;s even harder, and no fun at all, when you have to try to persuade a reluctant asker about their mistakes."}, {"owner": {"reputation": 21, "user_id": 7419294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RbvEU3d9Ro/AAAAAAAAAAI/AAAAAAAAABc/PIQ_azGtXRA/photo.jpg?sz=128", "display_name": "xBones", "link": "https://stackoverflow.com/users/7419294/xbones"}, "edited": false, "score": 0, "creation_date": 1562172193, "post_id": 56872435, "comment_id": 100297789, "body": "You mean like this?  `     DPcbs cbs = new DPcbs();                 PoweredUpCB poweredUpCb = PoweredUp;                 cbs.poweredUpCB = poweredUpCb; ` Because that&#39;s basically Han&#39;s answer if I understand correctly. I don&#39;t really use direct <code>new</code> things other than that part."}, {"owner": {"reputation": 21, "user_id": 7419294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RbvEU3d9Ro/AAAAAAAAAAI/AAAAAAAAABc/PIQ_azGtXRA/photo.jpg?sz=128", "display_name": "xBones", "link": "https://stackoverflow.com/users/7419294/xbones"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1562172240, "post_id": 56872435, "comment_id": 100297818, "body": "@DavidHeffernan I can understand that it&#39;s wrong, but the fact that I have other functions with the same return value and they are working is a bit confusing to me, Ill give it a try though."}, {"owner": {"reputation": 21, "user_id": 7419294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RbvEU3d9Ro/AAAAAAAAAAI/AAAAAAAAABc/PIQ_azGtXRA/photo.jpg?sz=128", "display_name": "xBones", "link": "https://stackoverflow.com/users/7419294/xbones"}, "edited": false, "score": 0, "creation_date": 1562173105, "post_id": 56872435, "comment_id": 100298239, "body": "I have changed it into <code>uint</code> but I got the same result. Sadly."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1562174243, "post_id": 56872435, "comment_id": 100298752, "body": "You have to get everything right. Just because fixing one of many bugs doesn&#39;t solve the problem doesn&#39;t mean that you don&#39;t need to fix that one bug. With incomplete information it&#39;s not possible to give you a definitive answer fixing all defects."}, {"owner": {"reputation": 21, "user_id": 7419294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RbvEU3d9Ro/AAAAAAAAAAI/AAAAAAAAABc/PIQ_azGtXRA/photo.jpg?sz=128", "display_name": "xBones", "link": "https://stackoverflow.com/users/7419294/xbones"}, "edited": false, "score": 0, "creation_date": 1562176281, "post_id": 56872435, "comment_id": 100299636, "body": "Yeah, I understand. Is there anything else you would like to see to be able to help more? I would fix it if I knew where the problem is. I looked into everything and it seems everything is correct from my perspective."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1562176911, "post_id": 56872435, "comment_id": 100299945, "body": "I already told you what was missing. Make it easy for us with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 21, "user_id": 7419294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RbvEU3d9Ro/AAAAAAAAAAI/AAAAAAAAABc/PIQ_azGtXRA/photo.jpg?sz=128", "display_name": "xBones", "link": "https://stackoverflow.com/users/7419294/xbones"}, "edited": false, "score": 0, "creation_date": 1562509011, "post_id": 56872435, "comment_id": 100388162, "body": "I&#39;m not really sure how I can do that, since i&#39;m using a DLL I can&#39;t really share..."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7419294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RbvEU3d9Ro/AAAAAAAAAAI/AAAAAAAAABc/PIQ_azGtXRA/photo.jpg?sz=128", "display_name": "xBones", "link": "https://stackoverflow.com/users/7419294/xbones"}, "edited": false, "score": 0, "creation_date": 1562167704, "post_id": 56873254, "comment_id": 100295525, "body": "I don&#39;t really think I get what you mean, can you please clarify? Thanks."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1562169549, "post_id": 56873254, "comment_id": 100296497, "body": "So, how exactly does this answer the question?"}], "tags": [], "owner": {"reputation": 1, "user_id": 11735191, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/862c2fa806531b0df3ba77f27730605f?s=128&d=identicon&r=PG", "display_name": "marcolomew", "link": "https://stackoverflow.com/users/11735191/marcolomew"}, "is_accepted": false, "score": -1, "last_activity_date": 1562166848, "creation_date": 1562166848, "answer_id": 56873254, "question_id": 56872435, "link": "https://stackoverflow.com/questions/56872435/program-crash-when-using-dllimport-function/56873254#56873254", "title": "Program crash when using DLLImport function", "body": "<p>If you want to compile such C++ code in a DLL its better to include it in a class and give an accessor method.</p>\n\n<p>c# project could never have access to a compiled typedef struct without wrapping it!</p>\n\n<p>Be aware of your runtime compiled DLL version</p>\n"}], "owner": {"reputation": 21, "user_id": 7419294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RbvEU3d9Ro/AAAAAAAAAAI/AAAAAAAAABc/PIQ_azGtXRA/photo.jpg?sz=128", "display_name": "xBones", "link": "https://stackoverflow.com/users/7419294/xbones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562166848, "creation_date": 1562164375, "question_id": 56872435, "link": "https://stackoverflow.com/questions/56872435/program-crash-when-using-dllimport-function", "title": "Program crash when using DLLImport function", "body": "<p>I'm trying to use a function from a C++ dll that sets callbacks that I can use in the program for the future, but when I call that function the app crashes without displaying an error or anything. </p>\n\n<p>C# Code:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>\n        [DllImport(\"DocProc.dll\", CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]\n        public static extern ulong DPSetCallBacks(DPHandle hdl, IntPtr cbs);\n\n        public delegate void ConnectedCB(DPHandle hdl);\n        public delegate void DisconnectedCB(DPHandle hdl);\n        public delegate void DocCompleteCB(DPHandle hdl);\n        public delegate void DocImageCompleteCB(DPHandle hdl);\n        public delegate void DocImageSnippetCompleteCB(DPHandle hdl);\n        public delegate void DocReadCompleteCB(DPHandle hdl);\n        public delegate void ExceptionCompleteCB(DPHandle hdl);\n        public delegate void ExceptionInProgressCB(DPHandle hdl);\n        public delegate void FlowStoppedCB(DPHandle hdl);\n        public delegate void HopperEmptyCB(DPHandle hdl);\n        public delegate void IdleCB(DPHandle hdl);\n        public delegate void MachineDeadCB(DPHandle hdl);\n        public delegate void PoweredDownCB(DPHandle hdl);\n        public delegate void PoweredUpCB(DPHandle hdl);\n        public delegate void PoweringUpCB(DPHandle hdl);\n        public delegate void ReadyingCB(DPHandle hdl);\n        public delegate void ReadyToProcessCB(DPHandle hdl);\n        public delegate void StateExceptionCB(DPHandle hdl);\n        public delegate void WarningCB(DPHandle hdl);\n        public delegate void NvmReadCompleteCB(DPHandle hdl);\n        public delegate void MakeReadyToFlowCompleteCB(DPHandle hdl);\n\n        [StructLayout(LayoutKind.Sequential, CharSet=CharSet.Ansi)]\n        public struct DPcbs\n        {\n            public int size;\n            public ConnectedCB connectedCB;\n            public DisconnectedCB disconnectedCB;\n            public DocCompleteCB docCompleteCB;\n            public DocImageCompleteCB docImageComplete;\n            public DocImageSnippetCompleteCB docImageSnippetCompleteCB;\n            public DocReadCompleteCB docReadComplete;\n            public ExceptionCompleteCB exceptionCompleteCB;\n            public ExceptionInProgressCB exceptionInProgressCB;\n            public FlowStoppedCB flowStoppedCB;\n            public HopperEmptyCB hopperEmptyCB;\n            public IdleCB idleCB;\n            public MachineDeadCB machineDeadCB;\n            public PoweredDownCB poweredDownCB;\n            public PoweredUpCB poweredUpCB;\n            public PoweringUpCB poweringUpCB;\n            public ReadyingCB readyingCB;\n            public ReadyToProcessCB readyToProcessCB;\n            public StateExceptionCB stateExceptionCB;\n            public WarningCB warningCB;\n            public NvmReadCompleteCB nvmReadCompleteCB;\n            public MakeReadyToFlowCompleteCB makeReadyToFlowCompleteCB;\n        }\n</code></pre>\n\n<p>C++ Code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>typedef struct { \nunsigned int size;\n ConnectedCB connectedCB;\n DisconnectedCB disconnectedCB;\n DocCompleteCB docCompleteCB;\n DocImageCompleteCB docImageComplete;\n DocImageSnippetCompleteCB docImageSnippetCompleteCB;\n DocReadCompleteCB docReadComplete;\n ExceptionCompleteCB exceptionCompleteCB;\n ExceptionInProgressCB exceptionInProgressCB;\n FlowStoppedCB flowStoppedCB;\n HopperEmptyCB hopperEmptyCB;\n IdleCB idleCB;\n MachineDeadCB machineDeadCB;\n PoweredDownCB poweredDownCB;\n PoweredUpCB poweredUpCB;\n PoweringUpCB poweringUpCB;\n ReadyingCB readyingCB;\n ReadyToProcessCB readyToProcessCB;\n StateExceptionCB stateExceptionCB;\n WarningCB warningCB; \n NvmReadCompleteCB nvmReadCompleteCB;\n MakeReadyToFlowCompleteCB makeReadyToFlowCompleteCB;\n}\n\nunsigned long DPSetCallBacks(DPHandle hdl, DPcbs *dpcbs);\n</code></pre>\n\n<p>I use it like so:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code> DPcbs cbs = new DPcbs();\n               cbs.poweredUpCB = PoweredUp;\n\n                ptr = Marshal.AllocHGlobal(Marshal.SizeOf(cbs));\n                try\n                {\n\n                    // Copy the struct to unmanaged memory.\n                    Marshal.StructureToPtr(cbs, ptr, false);\n\n                    DPSetCallBacks(handle, ptr);\n\n                }\n                finally\n                {\n                    // Free the unmanaged memory.\n                    Marshal.FreeHGlobal(ptr);\n                }\n</code></pre>\n\n<p>Result is the application crashing without any visible errors. Any help will be appreciated. Thanks in advance!</p>\n"}, {"tags": ["c++", "c++11", "googletest"], "comments": [{"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1562164453, "post_id": 56872359, "comment_id": 100293587, "body": "Just define <code>bool operator==(const YourMap&amp; lhs, const YourMap&amp; rhs)</code> and google test will use it in <code>ASSERT_EQ</code>. Did you try it? Did it work?"}, {"owner": {"reputation": 1566, "user_id": 5299417, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/cDaMr.jpg?s=128&g=1", "display_name": "Michael Hall", "link": "https://stackoverflow.com/users/5299417/michael-hall"}, "reply_to_user": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1562164665, "post_id": 56872359, "comment_id": 100293729, "body": "Yeah, this is how I am doing it at the moment. But it feels very &quot;hacky&quot;. If this is indeed the best way then so be it, but I was hoping to find a cleaner, better-tested method using gtest."}, {"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1562165453, "post_id": 56872359, "comment_id": 100294259, "body": "This was discussed in many places and I don&#39;t see any clear conclusion: <a href=\"https://google.github.io/styleguide/cppguide.html#Operator_Overloading\" rel=\"nofollow noreferrer\">google style guide</a>, <a href=\"https://github.com/google/googletest/blob/master/googletest/docs/primer.md#binary-comparison\" rel=\"nofollow noreferrer\">gtest docs</a>. You can always do <code>ASSERT_TRUE(mapsEqual(map1, map2))</code>, but if you have in mind some clear strategy for comparison of your types, just define <code>operator==</code>. It&#39;s not hacky, just depends on your application."}], "answers": [{"tags": [], "owner": {"reputation": 2007, "user_id": 1076113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q6GH3.jpg?s=128&g=1", "display_name": "Quarra", "link": "https://stackoverflow.com/users/1076113/quarra"}, "is_accepted": false, "score": 2, "last_activity_date": 1562843102, "creation_date": 1562843102, "answer_id": 56987780, "question_id": 56872359, "link": "https://stackoverflow.com/questions/56872359/thorough-equality-testing-of-two-maps-with-googletest/56987780#56987780", "title": "Thorough equality testing of two maps with googletest", "body": "<p>You can define a matcher if <code>operator==</code> is not an option:</p>\n\n<pre><code>using mymap = std::map&lt;int, std::vector&lt;std::pair&lt;MyClass1 *, MyClass2 *&gt;&gt;&gt;;\n\nMATCHER_P(MAP_MATCHER, expected_map, \"Maps are not equal\") {\n  if (expected_map.size() != arg.size()) {\n    return false;\n  }\n  return std::all_of(expected_map.cbegin(), expected_map.cend(), [&amp;](const std::pair&lt;int, std::vector&lt;std::pair&lt;MyClass1 *, MyClass2 *&gt;&gt;&gt; &amp;item) {\n  auto arg_item = arg.find(item.first);\n    if (arg.cend() == arg_item) {\n      return false;\n    }\n    //more checks here\n  });\n}\n</code></pre>\n\n<p>And then use it:</p>\n\n<pre><code>TEST(maptest, test1) {\n  mymap m1{{1, {{new MyClass1{}, new MyClass2{}}}}};\n  mymap m2{{1, {{new MyClass1{}, new MyClass2{}}}}};\n\n  ASSERT_THAT(m1, MAP_MATCHER(m2));\n}\n</code></pre>\n"}], "owner": {"reputation": 1566, "user_id": 5299417, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/cDaMr.jpg?s=128&g=1", "display_name": "Michael Hall", "link": "https://stackoverflow.com/users/5299417/michael-hall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562843102, "creation_date": 1562164135, "question_id": 56872359, "link": "https://stackoverflow.com/questions/56872359/thorough-equality-testing-of-two-maps-with-googletest", "title": "Thorough equality testing of two maps with googletest", "body": "<p>I am wondering what the \"correct/best\" way to test equality of two <code>std::map</code>s using the googletest framework is?  </p>\n\n<p>The catch is that the <code>std::map</code> has some pointers in the values and I want to test that the thing they point to is correct across the two <code>std::map</code>s.  </p>\n\n<p>For example my map has the following signature:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::map&lt;int, std::vector&lt;std::pair&lt;MyClass1*, MyClass2*&gt;&gt;&gt;\n</code></pre>\n\n<p>So I want to make sure the values of <code>MyClass1</code> and <code>MyClass2</code> pointers are the same across the two maps I am testing.</p>\n"}, {"tags": ["c++", "c", "mongodb", "gmp", "bignum"], "answers": [{"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 1, "last_activity_date": 1562164936, "creation_date": 1562164936, "answer_id": 56872606, "question_id": 56872108, "link": "https://stackoverflow.com/questions/56872108/how-to-store-mpz-t-from-gmlib-on-a-mongo-db/56872606#56872606", "title": "How to store mpz_t from gmlib on a mongo db?", "body": "<p>It depends, on what you are planning to do. MongoDB does not have an arbitrary precision number type, so you essentially have two options:</p>\n\n<p>If the number type fits in a <strong>64-bit integer</strong>, you can use the functions</p>\n\n<pre><code>unsigned long valint = mpz_get_ui(val);\n// or\nlong valint = mpz_get_si(val);\n</code></pre>\n\n<p>to convert the number to a 64-bit integer and store it in a <code>NumberLong</code> datatype.</p>\n\n<p>Otherwise, you can always convert the number <code>val</code> to a string with</p>\n\n<pre><code>char *valstr = mpz_get_str(NULL, 10, val);\n</code></pre>\n\n<p>and store it as text in the database. This might be the safest solution, if you only want to <em>store</em> the number and do not need to process it at <em>database level</em>.</p>\n"}], "owner": {"reputation": 1385, "user_id": 8202606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aP46CW5acPM/AAAAAAAAAAI/AAAAAAAAACY/J6U8GUmqfng/photo.jpg?sz=128", "display_name": "Federico Caccia", "link": "https://stackoverflow.com/users/8202606/federico-caccia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1562164936, "creation_date": 1562163297, "question_id": 56872108, "link": "https://stackoverflow.com/questions/56872108/how-to-store-mpz-t-from-gmlib-on-a-mongo-db", "title": "How to store mpz_t from gmlib on a mongo db?", "body": "<p>I'm using GMP library to manage big numbers in a c++ code. I'm also using mongocxx client to connect and make queries to a mongodb database. How can I store a mpz_t number in a mongo database? Or even better, how can I transform mpz_t into a NumeberLong in mongodb?</p>\n"}, {"tags": ["c++", "networking", "enet"], "answers": [{"tags": [], "owner": {"reputation": 3999, "user_id": 1920003, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gkgdd.jpg?s=128&g=1", "display_name": "Lynob", "link": "https://stackoverflow.com/users/1920003/lynob"}, "is_accepted": true, "score": 0, "last_activity_date": 1562172198, "creation_date": 1562172198, "answer_id": 56874715, "question_id": 56872055, "link": "https://stackoverflow.com/questions/56872055/enet-how-many-consecutive-connections-can-enet-handle/56874715#56874715", "title": "Enet: How many consecutive connections can enet handle?", "body": "<p>I just asked Enet creator on github, a super nice guy, he replied very fast, Enet can handle 4k connections on a single host.</p>\n\n<p>I quote: </p>\n\n<p>\"Trying to do more than 4K connections on a single host would not really be\nthat efficient, because you are stressing one single OS process trying to\ndeal with all the load of them. So you might want to reconsider your\nnetworking architecture so that those connections get split over to\nmultiple hosts/servers and so they you can take advantage of parallelism.\"</p>\n"}], "owner": {"reputation": 3999, "user_id": 1920003, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gkgdd.jpg?s=128&g=1", "display_name": "Lynob", "link": "https://stackoverflow.com/users/1920003/lynob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 56874715, "answer_count": 1, "score": 0, "last_activity_date": 1562172198, "creation_date": 1562163154, "question_id": 56872055, "link": "https://stackoverflow.com/questions/56872055/enet-how-many-consecutive-connections-can-enet-handle", "title": "Enet: How many consecutive connections can enet handle?", "body": "<p>I'm using Godot game engine to create a multiplayer game, it supports UDP, TCP and websockets. According to my research UDP is the only one reliable, they use Enet.</p>\n\n<p>I didn't get a decisive answer from godot community on how many consecutive connections Enet can handle, many create a new server instance using docker per room, I don't like that</p>\n\n<p>I want to have 8 players per room, how many consecutive connections can Enet handle before that I have to create a new  docker instance? If there's no good answer, I'd like to know the safest bet before creating an instance.</p>\n"}, {"tags": ["c++", "windows", "tensorflow", "g++", "protobuf-c"], "comments": [{"owner": {"reputation": 353, "user_id": 3386680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f2ece20302cb5305e6643bdf088e10f?s=128&d=identicon&r=PG&f=1", "display_name": "rinatdobr", "link": "https://stackoverflow.com/users/3386680/rinatdobr"}, "edited": false, "score": 0, "creation_date": 1576838164, "post_id": 56871990, "comment_id": 105033828, "body": "Hi, try to build and install your own protobuf <a href=\"https://github.com/protocolbuffers/protobuf/blob/master/cmake/README.md\" rel=\"nofollow noreferrer\">github.com/protocolbuffers/protobuf/blob/master/cmake/README&zwnj;&#8203;.md</a> (accurately choose src version)"}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 2606070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d95f58e49f7bc9aac6cdc08e1af8ffaa?s=128&d=identicon&r=PG", "display_name": "chandrakant_k", "link": "https://stackoverflow.com/users/2606070/chandrakant-k"}, "is_accepted": false, "score": 2, "last_activity_date": 1599743414, "creation_date": 1599743414, "answer_id": 63830428, "question_id": 56871990, "link": "https://stackoverflow.com/questions/56871990/fatal-error-google-protobuf-port-def-inc-no-such-file-or-directory-include-g/63830428#63830428", "title": "fatal error: google/protobuf/port_def.inc: No such file or directory #include &lt;google/protobuf/port_def.inc&gt;", "body": "<p>I think you might have solved the problem by now, but for the reference of others posting one possible solution. Find the tensorflow include directory path and include it while compiling your code. You can manually check that the header file (missing in your case) is present in the include path.</p>\n<pre><code>tf_include_dir=($(python -c &quot;import tensorflow as tf; print(tf.sysconfig.get_include())&quot;))\n</code></pre>\n<p>and modify your compile command to include the tf_include_dir i.e.</p>\n<pre><code>g++ -std=c++11 -Itf_include_dir -shared zero_out.cc -o zero_out.so -fPIC ${TF_CFLAGS[@]} ${TF_LFLAGS[@]} -O2\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 11734769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdefb59d12a0d68d191775d9371c575b?s=128&d=identicon&r=PG&f=1", "display_name": "NN_05", "link": "https://stackoverflow.com/users/11734769/nn-05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5695, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1599743414, "creation_date": 1562162915, "last_edit_date": 1562163927, "question_id": 56871990, "link": "https://stackoverflow.com/questions/56871990/fatal-error-google-protobuf-port-def-inc-no-such-file-or-directory-include-g", "title": "fatal error: google/protobuf/port_def.inc: No such file or directory #include &lt;google/protobuf/port_def.inc&gt;", "body": "<p>I have windows. And I want to create an C++ op using library tensorflow. From this site <a href=\"https://www.tensorflow.org/guide/extend/op#compile_the_op_using_your_system_compiler_tensorflow_binary_installation\" rel=\"noreferrer\">https://www.tensorflow.org/guide/extend/op#compile_the_op_using_your_system_compiler_tensorflow_binary_installation</a> I understood that I should do folowing:</p>\n\n<pre><code>TF_CFLAGS=( $(python -c 'import tensorflow as tf; print(\" \".join(tf.sysconfig.get_compile_flags()))') )\nTF_LFLAGS=( $(python -c 'import tensorflow as tf; print(\" \".join(tf.sysconfig.get_link_flags()))') )\ng++ -std=c++11 -shared zero_out.cc -o zero_out.so -fPIC ${TF_CFLAGS[@]} ${TF_LFLAGS[@]} -O2\n</code></pre>\n\n<p>I did that. But I got next problem:</p>\n\n<pre><code>In file included from C:\\Python\\Python37\\lib\\site-packages\\tensorflow\\include/tensorflow/core/framework/op_def_builder.h:24,\n                 from C:\\Python\\Python37\\lib\\site-packages\\tensorflow\\include/tensorflow/core/framework/op.h:23,\n                 from zero_out.cc:4:\nC:\\Python\\Python37\\lib\\site-packages\\tensorflow\\include/tensorflow/core/framework/op_def.pb.h:10:10: fatal error: google/protobuf/port_def.inc: No such file or directory\n #include google/protobuf/port_def.inc\n          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\ncompilation terminated.\n\n</code></pre>\n\n<p>I don't understand how can I solve this problem. I would be really grateful if you can help me to solve this problem</p>\n"}, {"tags": ["c++", "linux"], "comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 2, "creation_date": 1562172202, "post_id": 56871923, "comment_id": 100297794, "body": "<i>Test runs on single isolated core so context switches do not occur</i> - you also need to run it with FIFO priority, otherwise context switches do occur. Run under <code>perf stat -ddd</code> and see the number of context switches."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11727246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tZOCLClKzLc/AAAAAAAAAAI/AAAAAAAAAJk/rIwqI_b_Vl0/photo.jpg?sz=128", "display_name": "Dmitriy Chizhov", "link": "https://stackoverflow.com/users/11727246/dmitriy-chizhov"}, "edited": false, "score": 0, "creation_date": 1562226350, "post_id": 56875039, "comment_id": 100313592, "body": "thank you, your advice to use FIFO priority is helpful. With this option both cases provide same results with slowdowns about 10 microseconds. Have you any ideas what is the reason of these delays?"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 33, "user_id": 11727246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tZOCLClKzLc/AAAAAAAAAAI/AAAAAAAAAJk/rIwqI_b_Vl0/photo.jpg?sz=128", "display_name": "Dmitriy Chizhov", "link": "https://stackoverflow.com/users/11727246/dmitriy-chizhov"}, "edited": false, "score": 0, "creation_date": 1562231527, "post_id": 56875039, "comment_id": 100316334, "body": "@DmitriyChizhov Most likely reason is the memory allocations. You may also like to try restricting your process to one NUMA node to prevent more expensive non-local NUMA memory access, e.g. <code>numactl --membind 0 --cpunodebind 0 &lt;app&gt;</code>."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 33, "user_id": 11727246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tZOCLClKzLc/AAAAAAAAAAI/AAAAAAAAAJk/rIwqI_b_Vl0/photo.jpg?sz=128", "display_name": "Dmitriy Chizhov", "link": "https://stackoverflow.com/users/11727246/dmitriy-chizhov"}, "edited": false, "score": 0, "creation_date": 1562232421, "post_id": 56875039, "comment_id": 100316860, "body": "@DmitriyChizhov Fundamentally, though, memory allocations have unpredictable costs because the requested memory may either be available in an existing arena or a syscall must be made. In the latter case your process may contend with other processes."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1562174351, "last_edit_date": 1562174351, "creation_date": 1562173719, "answer_id": 56875039, "question_id": 56871923, "link": "https://stackoverflow.com/questions/56871923/huge-latency-spikes-while-running-simple-code/56875039#56875039", "title": "Huge latency spikes while running simple code", "body": "<p>In:</p>\n\n<pre><code>TData DoMemoryOperation(bool aPerform, const TBuffer&amp; aBuffer, size_t&amp; outBufferIndex);\n</code></pre>\n\n<p>It returns a <code>std::vector&lt;char&gt;</code> by value. That involves a memory allocation and data copying. The memory allocations can do a syscall (<code>brk</code> or <code>mmap</code>) and <a href=\"https://marc.info/?l=linux-kernel&amp;m=95496636207616&amp;w=2\" rel=\"nofollow noreferrer\">memory mappings related syscalls are notorious for being slow</a>.</p>\n\n<p>When timings include syscalls one cannot expect low variance.</p>\n\n<p>You may like to run your application with <code>/usr/bin/time --verbose &lt;app&gt;</code> or <code>perf -ddd &lt;app&gt;</code> to see the number of page faults and context switches.</p>\n"}], "owner": {"reputation": 33, "user_id": 11727246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tZOCLClKzLc/AAAAAAAAAAI/AAAAAAAAAJk/rIwqI_b_Vl0/photo.jpg?sz=128", "display_name": "Dmitriy Chizhov", "link": "https://stackoverflow.com/users/11727246/dmitriy-chizhov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 56875039, "answer_count": 1, "score": 3, "last_activity_date": 1562174351, "creation_date": 1562162685, "question_id": 56871923, "link": "https://stackoverflow.com/questions/56871923/huge-latency-spikes-while-running-simple-code", "title": "Huge latency spikes while running simple code", "body": "<p>I have a simple benchmark that demonstrates performance of busywait threads. It runs in two modes: first one simply gets two timepoints sequentially, second one iterates through vector and measures duration of an iteration.\nI see that two sequential calls of <strong>clock::now()</strong> takes about 50 nanoseconds on the average and one average iteration through vector takes about 100 nanoseconds. But sometimes these operations are executed with a huge delay: about 50 microseconds in the first case and <strong>10 milliseconds (!)</strong> in the second case.</p>\n\n<p>Test runs on single isolated core so context switches do not occur. I also call mlockall in beginning of the program so I assume that page faults do not affect the performance.</p>\n\n<p>Following additional optimizations were also applied:</p>\n\n<ul>\n<li>kernel boot parameters: intel_idle.max_cstate=0 idle=halt\nirqaffinity=0,14 isolcpus=4-13,16-27 pti=off spectre_v2=off audit=0\nselinux=0 nmi_watchdog=0 nosoftlockup=0 rcu_nocb_poll rcu_nocbs=19-20\nnohz_full=19-20;</li>\n<li>rcu[^c] kernel threads moved to a housekeeping CPU core 0;</li>\n<li>network card RxTx queues moved to a housekeeping CPU core 0;</li>\n<li>writeback kernel workqueue moved to a housekeeping CPU core 0;</li>\n<li>transparent_hugepage disabled;</li>\n<li>Intel CPU HyperThreading disabled;</li>\n<li>swap file/partition is not used.</li>\n</ul>\n\n<p>Environment:</p>\n\n<pre><code>System details:\nDefault Archlinux kernel:\n5.1.9-arch1-1-ARCH #1 SMP PREEMPT Tue Jun 11 16:18:09 UTC 2019 x86_64 GNU/Linux\n\nthat has following PREEMPT and HZ settings:\nCONFIG_HZ_300=y\nCONFIG_HZ=300\nCONFIG_PREEMPT=y\n\nHardware details:\n\nRAM: 256GB\n\nCPU(s):              28\nOn-line CPU(s) list: 0-27\nThread(s) per core:  1\nCore(s) per socket:  14\nSocket(s):           2\nNUMA node(s):        2\nVendor ID:           GenuineIntel\nCPU family:          6\nModel:               79\nModel name:          Intel(R) Xeon(R) CPU E5-2690 v4 @ 2.60GHz\nStepping:            1\nCPU MHz:             3200.011\nCPU max MHz:         3500.0000\nCPU min MHz:         1200.0000\nBogoMIPS:            5202.68\nVirtualization:      VT-x\nL1d cache:           32K\nL1i cache:           32K\nL2 cache:            256K\nL3 cache:            35840K\nNUMA node0 CPU(s):   0-13\nNUMA node1 CPU(s):   14-27\n</code></pre>\n\n<p>Example code:</p>\n\n<pre><code>\n    struct TData\n    {\n        std::vector&lt;char&gt; Data;\n\n        TData() = default;\n        TData(size_t aSize)\n        {\n            for (size_t i = 0; i &lt; aSize; ++i)\n            {\n                Data.push_back(i);\n            }\n        }\n    };\n\n    using TBuffer = std::vector&lt;TData&gt;;\n\n    TData DoMemoryOperation(bool aPerform, const TBuffer&amp; aBuffer, size_t&amp; outBufferIndex)\n    {\n        if (!aPerform)\n        {\n            return TData {};\n        }\n\n        const TData&amp; result = aBuffer[outBufferIndex];\n\n        if (++outBufferIndex == aBuffer.size())\n        {\n            outBufferIndex = 0;\n        }\n\n        return result;\n    }\n\n    void WarmUp(size_t aCyclesCount, bool aPerform, const TBuffer&amp; aBuffer)\n    {\n        size_t bufferIndex = 0;\n        for (size_t i = 0; i &lt; aCyclesCount; ++i)\n        {\n            auto data = DoMemoryOperation(aPerform, aBuffer, bufferIndex);\n        }\n    }\n\n    void TestCycle(size_t aCyclesCount, bool aPerform, const TBuffer&amp; aBuffer, Measurings&amp; outStatistics)\n    {\n        size_t bufferIndex = 0;\n        for (size_t i = 0; i &lt; aCyclesCount; ++i)\n        {\n            auto t1 = std::chrono::steady_clock::now();\n            {\n            auto data = DoMemoryOperation(aPerform, aBuffer, bufferIndex);\n            }\n            auto t2 = std::chrono::steady_clock::now();\n            auto diff = std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(t2 - t1).count();\n            outStatistics.AddMeasuring(diff, t2);\n        }\n    }\n\n    int Run(int aCpu, size_t aDataSize, size_t aBufferSize, size_t aCyclesCount, bool aAllocate, bool aPerform)\n    {\n        if (mlockall(MCL_CURRENT | MCL_FUTURE))\n        {\n            throw std::runtime_error(\"mlockall failed\");\n        }\n\n        std::cout &lt;&lt; \"Test parameters\"\n            &lt;&lt; \":\\ndata size=\" &lt;&lt; aDataSize\n            &lt;&lt; \",\\nnumber of elements=\" &lt;&lt; aBufferSize\n            &lt;&lt; \",\\nbuffer size=\" &lt;&lt; aBufferSize * aDataSize\n            &lt;&lt; \",\\nnumber of cycles=\" &lt;&lt; aCyclesCount\n            &lt;&lt; \",\\nallocate=\" &lt;&lt; aAllocate\n            &lt;&lt; \",\\nperform=\" &lt;&lt; aPerform\n            &lt;&lt; \",\\nthread \";\n\n        SetCpuAffinity(aCpu);\n\n        TBuffer buffer;\n\n        if (aPerform)\n        {\n            buffer.resize(aBufferSize);\n            std::fill(buffer.begin(), buffer.end(), TData { aDataSize });\n        }\n\n        WaitForKey();\n        std::cout &lt;&lt; \"Running...\"&lt;&lt; std::endl;\n\n        WarmUp(aBufferSize * 2, aPerform, buffer);\n\n        Measurings statistics;\n        TestCycle(aCyclesCount, aPerform, buffer, statistics);\n        statistics.Print(aCyclesCount);\n\n        WaitForKey();\n\n        if (munlockall())\n        {\n            throw std::runtime_error(\"munlockall failed\");\n        }\n\n        return 0;\n    }\n\n</code></pre>\n\n<p>And following results are received:\nFirst:</p>\n\n<pre><code>StandaloneTests --run_test=MemoryAccessDelay --cpu=19 --data-size=280 --size=67108864 --count=1000000000 --allocate=1 --perform=0\nTest parameters:\ndata size=280,\nnumber of elements=67108864,\nbuffer size=18790481920,\nnumber of cycles=1000000000,\nallocate=1,\nperform=0,\nthread 14056 on cpu 19\n\nStatistics: min: 16: max: 18985: avg: 18\n0 - 10 : 0 (0 %): -\n10 - 100 : 999993494 (99 %): min: 40: max: 117130: avg: 40\n100 - 1000 : 946 (0 %): min: 380: max: 506236837: avg: 43056598\n1000 - 10000 : 5549 (0 %): min: 56876: max: 70001739: avg: 7341862\n10000 - 18985 : 11 (0 %): min: 1973150818: max: 14060001546: avg: 3644216650\n</code></pre>\n\n<p>Second:</p>\n\n<pre><code>StandaloneTests --run_test=MemoryAccessDelay --cpu=19 --data-size=280 --size=67108864 --count=1000000000 --allocate=1 --perform=1\nTest parameters:\ndata size=280,\nnumber of elements=67108864,\nbuffer size=18790481920,\nnumber of cycles=1000000000,\nallocate=1,\nperform=1,\nthread 3264 on cpu 19\n\nStatistics: min: 36: max: 4967479: avg: 48\n0 - 10 : 0 (0 %): -\n10 - 100 : 964323921 (96 %): min: 60: max: 4968567: avg: 74\n100 - 1000 : 35661548 (3 %): min: 122: max: 4972632: avg: 2023\n1000 - 10000 : 14320 (0 %): min: 1721: max: 33335158: avg: 5039338\n10000 - 100000 : 130 (0 %): min: 10010533: max: 1793333832: avg: 541179510\n100000 - 1000000 : 0 (0 %): -\n1000000 - 4967479 : 81 (0 %): min: 508197829: max: 2456672083: avg: 878824867\n</code></pre>\n\n<p>Any ideas what is the reason of such huge delays and how it may be investigated?</p>\n"}, {"tags": ["c++", "segmentation-fault", "gdb", "valgrind"], "comments": [{"owner": {"reputation": 828, "user_id": 10338287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010973d1ca809cd413c48f3008510c11?s=128&d=identicon&r=PG&f=1", "display_name": "SolidMercury", "link": "https://stackoverflow.com/users/10338287/solidmercury"}, "edited": false, "score": 1, "creation_date": 1562164009, "post_id": 56871845, "comment_id": 100293312, "body": "Your insert function gets executed recursively. There is no breaking condition with which it can return without calling insert further and this will cause the stack to get filled and finally a overflow occurs and segmentation fault occurs."}], "answers": [{"comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1562165196, "post_id": 56872383, "comment_id": 100294088, "body": "I guessing all that is wrong is a missing <code>else</code>. Should be <code>if ... else if ... else ...</code>"}, {"owner": {"reputation": 828, "user_id": 10338287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010973d1ca809cd413c48f3008510c11?s=128&d=identicon&r=PG&f=1", "display_name": "SolidMercury", "link": "https://stackoverflow.com/users/10338287/solidmercury"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1562165580, "post_id": 56872383, "comment_id": 100294336, "body": "@john The first if block is for inserting at the end of the tree. It should return after executing the statements in the first if block of insert function."}, {"owner": {"reputation": 11, "user_id": 11068359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef6aac7e13fe0849694f25a1b4e5e6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Liamen", "link": "https://stackoverflow.com/users/11068359/liamen"}, "edited": false, "score": 0, "creation_date": 1562166433, "post_id": 56872383, "comment_id": 100294859, "body": "@SolidMercury Adding the return at the end of first if block works, but I always wrote the insert in this way and I don&#39;t understand why before worked"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 11, "user_id": 11068359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef6aac7e13fe0849694f25a1b4e5e6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Liamen", "link": "https://stackoverflow.com/users/11068359/liamen"}, "edited": false, "score": 0, "creation_date": 1562167387, "post_id": 56872383, "comment_id": 100295370, "body": "@Liamen <code>if ... else if ... else ...</code> is better style than using <code>return</code>. And (a guess) I would say it worked before because you did write <code>if ... else if ... else ...</code> before."}, {"owner": {"reputation": 11, "user_id": 11068359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef6aac7e13fe0849694f25a1b4e5e6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Liamen", "link": "https://stackoverflow.com/users/11068359/liamen"}, "edited": false, "score": 0, "creation_date": 1562168952, "post_id": 56872383, "comment_id": 100296198, "body": "The problem was the last else, in the other tries, i used if..if..if, but in this case I use if, if .. else, so the last if was never called, but with else it recurses endlessly. Thank you"}], "tags": [], "owner": {"reputation": 828, "user_id": 10338287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010973d1ca809cd413c48f3008510c11?s=128&d=identicon&r=PG&f=1", "display_name": "SolidMercury", "link": "https://stackoverflow.com/users/10338287/solidmercury"}, "is_accepted": true, "score": 1, "last_activity_date": 1562164198, "creation_date": 1562164198, "answer_id": 56872383, "question_id": 56871845, "link": "https://stackoverflow.com/questions/56871845/segmentation-fault-inserting-in-binary-tree/56872383#56872383", "title": "Segmentation Fault inserting in binary tree", "body": "<p>Your <code>insert</code> function gets executed recursively. There is no breaking condition with which it can return without calling <code>insert</code> further. This will cause the stack memory to get filled up and finally an overflow occurs which is a segmentation fault.</p>\n"}], "owner": {"reputation": 11, "user_id": 11068359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef6aac7e13fe0849694f25a1b4e5e6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Liamen", "link": "https://stackoverflow.com/users/11068359/liamen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 56872383, "answer_count": 1, "score": 0, "last_activity_date": 1562164198, "creation_date": 1562162390, "question_id": 56871845, "link": "https://stackoverflow.com/questions/56871845/segmentation-fault-inserting-in-binary-tree", "title": "Segmentation Fault inserting in binary tree", "body": "<p>I'm repeating some assignement from my class about binary tree, and I encountered a problem that never showed up to me. </p>\n\n<p>At first try running the code, I've got segmentation fault. I thought about a weird loop, but I am not able to find the problem. So I've tried with gdb and valgrind, obtaining a this:\nStarting program: /home/and/Documenti/Algoritmi/Esercizi/Esame 01-02-2018/esa2 &lt; input0.txt</p>\n\n<pre><code>Starting program: /home/and/Documenti/Algoritmi/Esercizi/Esame 01-02-2018/esa2 &lt; input0.txt\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00007ffff7c65cbc in _int_malloc (av=av@entry=0x7ffff7db3c40 &lt;main_arena&gt;, bytes=bytes@entry=32) at malloc.c:3711\n3711    malloc.c: File o directory non esistente.\n(gdb) where\n#0  0x00007ffff7c65cbc in _int_malloc (av=av@entry=0x7ffff7db3c40 &lt;main_arena&gt;, bytes=bytes@entry=32) at malloc.c:3711\n#1  0x00007ffff7c67ad3 in __GI___libc_malloc (bytes=32) at malloc.c:3065\n#2  0x00007ffff7e79a25 in operator new(unsigned long) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#3  0x0000555555555240 in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6df90: 0x0) at esa_2.cpp:38\n#4  0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6df60: 0x555555b6df80) at esa_2.cpp:44\n#5  0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6df30: 0x555555b6df50) at esa_2.cpp:44\n#6  0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6df00: 0x555555b6df20) at esa_2.cpp:44\n#7  0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6ded0: 0x555555b6def0) at esa_2.cpp:44\n#8  0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dea0: 0x555555b6dec0) at esa_2.cpp:44\n#9  0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6de70: 0x555555b6de90) at esa_2.cpp:44\n#10 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6de40: 0x555555b6de60) at esa_2.cpp:44\n#11 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6de10: 0x555555b6de30) at esa_2.cpp:44\n#12 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dde0: 0x555555b6de00) at esa_2.cpp:44\n#13 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6ddb0: 0x555555b6ddd0) at esa_2.cpp:44\n#14 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dd80: 0x555555b6dda0) at esa_2.cpp:44\n#15 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dd50: 0x555555b6dd70) at esa_2.cpp:44\n#16 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dd20: 0x555555b6dd40) at esa_2.cpp:44\n#17 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dcf0: 0x555555b6dd10) at esa_2.cpp:44\n#18 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dcc0: 0x555555b6dce0) at esa_2.cpp:44\n#19 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dc90: 0x555555b6dcb0) at esa_2.cpp:44\n#20 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dc60: 0x555555b6dc80) at esa_2.cpp:44\n#21 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dc30: 0x555555b6dc50) at esa_2.cpp:44\n#22 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dc00: 0x555555b6dc20) at esa_2.cpp:44\n#23 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dbd0: 0x555555b6dbf0) at esa_2.cpp:44\n#24 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dba0: 0x555555b6dbc0) at esa_2.cpp:44\n#25 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6db70: 0x555555b6db90) at esa_2.cpp:44\n#26 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6db40: 0x555555b6db60) at esa_2.cpp:44\n#27 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6db10: 0x555555b6db30) at esa_2.cpp:44\n#28 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dae0: 0x555555b6db00) at esa_2.cpp:44\n#29 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6dab0: 0x555555b6dad0) at esa_2.cpp:44\n#30 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6da80: 0x555555b6daa0) at esa_2.cpp:44\n#31 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6da50: 0x555555b6da70) at esa_2.cpp:44\n#32 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6da20: 0x555555b6da40) at esa_2.cpp:44\n#33 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d9f0: 0x555555b6da10) at esa_2.cpp:44\n#34 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d9c0: 0x555555b6d9e0) at esa_2.cpp:44\n#35 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d990: 0x555555b6d9b0) at esa_2.cpp:44\n#36 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d960: 0x555555b6d980) at esa_2.cpp:44\n#37 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d930: 0x555555b6d950) at esa_2.cpp:44\n#38 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d900: 0x555555b6d920) at esa_2.cpp:44\n#39 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d8d0: 0x555555b6d8f0) at esa_2.cpp:44\n#40 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d8a0: 0x555555b6d8c0) at esa_2.cpp:44\n#41 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d870: 0x555555b6d890) at esa_2.cpp:44\n#42 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d840: 0x555555b6d860) at esa_2.cpp:44\n#43 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d810: 0x555555b6d830) at esa_2.cpp:44\n#44 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d7e0: 0x555555b6d800) at esa_2.cpp:44\n#45 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d7b0: 0x555555b6d7d0) at esa_2.cpp:44\n#46 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d780: 0x555555b6d7a0) at esa_2.cpp:44\n#47 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d750: 0x555555b6d770) at esa_2.cpp:44\n#48 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d720: 0x555555b6d740) at esa_2.cpp:44\n#49 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d6f0: 0x555555b6d710) at esa_2.cpp:44\n#50 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d6c0: 0x555555b6d6e0) at esa_2.cpp:44\n#51 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d690: 0x555555b6d6b0) at esa_2.cpp:44\n#52 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d660: 0x555555b6d680) at esa_2.cpp:44\n#53 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d630: 0x555555b6d650) at esa_2.cpp:44\n#54 0x00005555555552bd in BinTree::insert (this=0x7fffffffdda0, info=6, tree=@0x555555b6d600: 0x555555b6d620) at esa_2.cpp:44\n</code></pre>\n\n<p>Then I've done some research and someone suggested Valgrind, so I give it a try. This is the result:</p>\n\n<pre><code>==5605== Memcheck, a memory error detector\n==5605== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==5605== Using Valgrind-3.15.0 and LibVEX; rerun with -h for copyright info\n==5605== Command: ./esa2\n==5605== \n==5605== Stack overflow in thread #1: can't grow stack to 0x1ffe801000\n==5605== \n==5605== Process terminating with default action of signal 11 (SIGSEGV)\n==5605==  Access not within mapped region at address 0x1FFE801FE0\n==5605== Stack overflow in thread #1: can't grow stack to 0x1ffe801000\n==5605==    at 0x4A3546B: operator new(unsigned long) (vg_replace_malloc.c:344)\n==5605==  If you believe this happened as a result of a stack\n==5605==  overflow in your program's main thread (unlikely but\n==5605==  possible), you can try to increase the size of the\n==5605==  main thread stack using the --main-stacksize= flag.\n==5605==  The main thread stack size used in this run was 8388608.\n==5605== Stack overflow in thread #1: can't grow stack to 0x1ffe801000\n==5605== \n==5605== Process terminating with default action of signal 11 (SIGSEGV)\n==5605==  Access not within mapped region at address 0x1FFE801FC8\n==5605== Stack overflow in thread #1: can't grow stack to 0x1ffe801000\n==5605==    at 0x482D6E0: _vgnU_freeres (vg_preloaded.c:59)\n==5605==  If you believe this happened as a result of a stack\n==5605==  overflow in your program's main thread (unlikely but\n==5605==  possible), you can try to increase the size of the\n==5605==  main thread stack using the --main-stacksize= flag.\n==5605==  The main thread stack size used in this run was 8388608.\n==5605== \n==5605== HEAP SUMMARY:\n==5605==     in use at exit: 4,266,272 bytes in 130,923 blocks\n==5605==   total heap usage: 130,923 allocs, 0 frees, 4,266,272 bytes allocated\n==5605== \n==5605== LEAK SUMMARY:\n==5605==    definitely lost: 0 bytes in 0 blocks\n==5605==    indirectly lost: 0 bytes in 0 blocks\n==5605==      possibly lost: 0 bytes in 0 blocks\n==5605==    still reachable: 4,266,272 bytes in 130,923 blocks\n==5605==         suppressed: 0 bytes in 0 blocks\n==5605== Reachable blocks (those to which a pointer was found) are not shown.\n==5605== To see them, rerun with: --leak-check=full --show-leak-kinds=all\n==5605== \n==5605== For lists of detected and suppressed errors, rerun with: -s\n==5605== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Here is the code:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;vector&gt;\n#include&lt;algorithm&gt;\n\nusing namespace std;\n\nclass BinTree{\n    struct node{\n        int label;\n        bool concordant;\n        int nConcordant;\n        node *left;\n        node *right;\n        node(int info){\n            label = info;\n            nConcordant = 0;\n            left = right = NULL;\n        }\n    };\n\n    node *root;\n    vector&lt;int&gt; values;\n\n    void insert(int, node*&amp;);\n    bool isLeaf(node*); \n    void setConcordant(node*);\n    int countConcordant(node*);\n    void setValues(node*, vector&lt;int&gt;&amp;);\n    void printValues(vector&lt;int&gt;);\n  public:\n    BinTree(){root = NULL;};\n    void insertTree(int);\n    void output();\n};\n\nvoid BinTree::insert(int info, node *&amp;tree){\n    if(!tree){\n        tree = new node(info);\n        tree-&gt;left = tree-&gt;right = NULL;\n    }\n    if(tree-&gt;label &lt; info)\n        insert(info, tree-&gt;right);\n    else\n        insert(info, tree-&gt;left);\n};\n\nbool BinTree::isLeaf(node* tree){\n    if(!tree)\n        return false;\n    if(!(tree-&gt;left) &amp;&amp; !(tree-&gt;right))\n        return true;\n    return false;\n};\n\nvoid BinTree::setConcordant(node *tree){\n    if(!tree)\n        return;\n    if(isLeaf(tree))\n        return;\n    if(tree-&gt;left){\n        if(tree-&gt;label % 2 == (tree-&gt;left)-&gt;label % 2)\n            (tree-&gt;left)-&gt;concordant = true;\n        else\n            (tree-&gt;left)-&gt;concordant = false;\n    }\n    if(tree-&gt;right){\n        if(tree-&gt;label % 2 == (tree-&gt;right)-&gt;label % 2)\n            (tree-&gt;right)-&gt;concordant = true;\n        else\n            (tree-&gt;right)-&gt;concordant = false;\n    }\n    setConcordant(tree-&gt;left);\n    setConcordant(tree-&gt;right);\n};\n\nint BinTree::countConcordant(node* tree){\n    if(!tree)\n        return 0;\n    if(isLeaf(tree)){\n        if(tree-&gt;concordant)\n            return 1;\n        else\n            return -1;\n    }\n    tree-&gt;nConcordant += countConcordant(tree-&gt;left) + countConcordant(tree-&gt;right);\n    return tree-&gt;nConcordant;\n};\n\nvoid BinTree::setValues(node* tree, vector&lt;int&gt;&amp; values){\n    if(!tree)\n        return;\n    if(tree-&gt;nConcordant &gt;= 0)\n        values.push_back(tree-&gt;label);\n    setValues(tree-&gt;left, values);\n    setValues(tree-&gt;right, values);\n};\n\nvoid BinTree::printValues(vector&lt;int&gt; values){\n    sort(values.begin(), values.end());\n    for(int i=0; i&lt;values.size(); i++)\n        cout&lt;&lt;values[i]&lt;&lt;endl;\n};\nvoid BinTree::insertTree(int info){\n    insert(info, root);\n};\n\nvoid BinTree::output(){\n    setConcordant(root);\n    countConcordant(root);\n    setValues(root, values);\n    printValues(values);\n};\n\nint main(){\n    int dim;\n    cin &gt;&gt; dim;\n    BinTree tree;\n    for(int i=0; i&lt;dim; i++){\n        int info;\n        cin &gt;&gt; info;\n        tree.insertTree(info);\n    }\n    tree.output();\n    return 0;\n}\n</code></pre>\n\n<p>The problem seems to be in the insert function but I don't know what to do to fix it</p>\n"}, {"tags": ["c++", "arrays", "vector", "stl"], "comments": [{"owner": {"reputation": 1051, "user_id": 7192989, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d41f45e6cacfb3d4195a9878880724?s=128&d=identicon&r=PG", "display_name": "Rinat Veliakhmedov", "link": "https://stackoverflow.com/users/7192989/rinat-veliakhmedov"}, "edited": false, "score": 2, "creation_date": 1562163762, "post_id": 56871727, "comment_id": 100293155, "body": "<code>matrix.begin()</code> returns an iterator object, but you are trying to assign it to an integer. You probably wanted to write <code>int i = 0;</code> there. Same for inner loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11703982"}, "edited": false, "score": 0, "creation_date": 1562164330, "post_id": 56871727, "comment_id": 100293512, "body": "I think also that you wanted to write int i = 0;"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10502373, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TB80pFcHH-w/AAAAAAAAAAI/AAAAAAAAAm4/2ifQz188la8/photo.jpg?sz=128", "display_name": "Taher Lunawadi", "link": "https://stackoverflow.com/users/10502373/taher-lunawadi"}, "edited": false, "score": 0, "creation_date": 1562167285, "post_id": 56872405, "comment_id": 100295305, "body": "I am still not able to initialize the vector in main, kindly guide me on the issue"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 31, "user_id": 10502373, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TB80pFcHH-w/AAAAAAAAAAI/AAAAAAAAAm4/2ifQz188la8/photo.jpg?sz=128", "display_name": "Taher Lunawadi", "link": "https://stackoverflow.com/users/10502373/taher-lunawadi"}, "edited": false, "score": 0, "creation_date": 1562169108, "post_id": 56872405, "comment_id": 100296270, "body": "@taherlunawadi Works well here: <a href=\"https://godbolt.org/z/1tpDCQ\" rel=\"nofollow noreferrer\">godbolt.org/z/1tpDCQ</a> (although <code>using namespace std;</code> is a very bad idea)"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 31, "user_id": 10502373, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TB80pFcHH-w/AAAAAAAAAAI/AAAAAAAAAm4/2ifQz188la8/photo.jpg?sz=128", "display_name": "Taher Lunawadi", "link": "https://stackoverflow.com/users/10502373/taher-lunawadi"}, "edited": false, "score": 1, "creation_date": 1562169703, "post_id": 56872405, "comment_id": 100296587, "body": "@taherlunawadi Also note that your code is buggy. One of your diagonals is calculated incorrectly. You are summing up elements to the right of the diagonal you really want. You can either debug your code in a debugger, which is a very important lesson, or print many intermediate values you access. For example, print the values you sum-up, before adding them to the result. This will give you an insight of what is going on."}, {"owner": {"reputation": 31, "user_id": 10502373, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TB80pFcHH-w/AAAAAAAAAAI/AAAAAAAAAm4/2ifQz188la8/photo.jpg?sz=128", "display_name": "Taher Lunawadi", "link": "https://stackoverflow.com/users/10502373/taher-lunawadi"}, "edited": false, "score": 0, "creation_date": 1562205025, "post_id": 56872405, "comment_id": 100307878, "body": "I am not able to properly extract the bug, could you please elaborate?"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 31, "user_id": 10502373, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TB80pFcHH-w/AAAAAAAAAAI/AAAAAAAAAm4/2ifQz188la8/photo.jpg?sz=128", "display_name": "Taher Lunawadi", "link": "https://stackoverflow.com/users/10502373/taher-lunawadi"}, "edited": false, "score": 1, "creation_date": 1562214358, "post_id": 56872405, "comment_id": 100309337, "body": "@TaherLunawadi debugging is usually best performed with as small example as possible. For example 1x1 matrix, or 2x2 in your case. Examine the values in the <code>sum</code> array. Is only one diagonal wrong? Are both? Check each step (single-step in a debugger, or print every step) in one buggy diagonal at a time. Debugging is part of a life of a programmer - you must master it"}], "tags": [], "owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "is_accepted": true, "score": 2, "last_activity_date": 1562166566, "last_edit_date": 1562166566, "creation_date": 1562164274, "answer_id": 56872405, "question_id": 56871727, "link": "https://stackoverflow.com/questions/56871727/how-to-fix-invalid-operands-to-binary-expression/56872405#56872405", "title": "How to fix &#39;invalid operands to binary expression&#39;?", "body": "<p>This code has several problems.</p>\n\n<p>First, performance:</p>\n\n<pre><code>int diagonalSum(vector&lt;vector&lt;int&gt; &gt; matrix) {\n</code></pre>\n\n<p>The above copies the matrix with all its elements every time you call the function, for no apparent reason. Complexity: O(n<sup>2</sup>).</p>\n\n<p>Better pass by reference to const (complexity O(1)):</p>\n\n<pre><code>int diagonalSum(const vector&lt;vector&lt;int&gt; &gt; &amp; matrix) {\n</code></pre>\n\n<p>Then the code tries to copy an iterator object, from <code>matrix.begin()</code>, which is supposed to iterate over objects of type <code>vector&lt;int&gt;</code>, and tries to assign this iterator into an integer variable. The integer and the iterator are of incompatible types, and can't be assigned to one another, and hence the error. </p>\n\n<p>I assume you wanted to use an index instead:</p>\n\n<pre><code>for(int i = 0;i &lt; matrix.size();i++)\n{\n    for(int j = 0; j &lt; matrix[i].size();j++)\n</code></pre>\n\n<p>And even that is a bad solution, from a complexity stand-point. Your solution is O(n<sup>2</sup>), where your task can be easily performed in O(n) with one loop.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 8152293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/84HPY.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8152293/mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1562165550, "creation_date": 1562165550, "answer_id": 56872851, "question_id": 56871727, "link": "https://stackoverflow.com/questions/56871727/how-to-fix-invalid-operands-to-binary-expression/56872851#56872851", "title": "How to fix &#39;invalid operands to binary expression&#39;?", "body": "<p><strong>Vector.begin()</strong> method <strong>returns</strong> an <strong>iterator</strong> pointing to the first element in the vector. That's why you can't assign it to int variable.</p>\n\n<p>Change your for loop to this</p>\n\n<pre><code>for(int i = 0;i &lt; matrix.size();i++)\n    {\n        for(int j = 0;j &lt; matrix[i].size();j++)\n        {\n            if(i == j)\n                sum[0]+=matrix[i][j];\n            if((i+j) == (matrix.size() -1))\n                sum[1]+=matrix[i][j];\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10502373, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TB80pFcHH-w/AAAAAAAAAAI/AAAAAAAAAm4/2ifQz188la8/photo.jpg?sz=128", "display_name": "Taher Lunawadi", "link": "https://stackoverflow.com/users/10502373/taher-lunawadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 795, "favorite_count": 0, "accepted_answer_id": 56872405, "answer_count": 2, "score": 0, "last_activity_date": 1562166566, "creation_date": 1562161985, "question_id": 56871727, "link": "https://stackoverflow.com/questions/56871727/how-to-fix-invalid-operands-to-binary-expression", "title": "How to fix &#39;invalid operands to binary expression&#39;?", "body": "<p>I wrote the following program in C++ and it turned up the following errors. It probably seems to be a problem with traversing the 2D vector</p>\n\n<p>I have already tried out writing <code>int j = matrix.at(0).begin()</code> but that doesn't work as well</p>\n\n<p>I have come across the following errors</p>\n\n<pre><code> invalid operands to binary expression ('vector&lt;int&gt;::iterator' (aka '__wrap_iter&lt;int *&gt;') and 'std::__1::vector&lt;int, std::__1::allocator&lt;int&gt; &gt;::size_type' (aka 'unsigned long'))\n\n\nno viable conversion from 'std::__1::vector&lt;std::__1::vector&lt;int, std::__1::allocator&lt;int&gt; &gt;, std::__1::allocator&lt;std::__1::vector&lt;int, std::__1::allocator&lt;int&gt; &gt; &gt; &gt;::iterator' (aka '__wrap_iter&lt;std::__1::vector&lt;int, std::__1::allocator&lt;int&gt; &gt; *&gt;') to 'int'\n</code></pre>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;vector&gt;\n#include &lt;iterator&gt;\nusing namespace std;\n\nint diagonalSum(vector&lt;vector&lt;int&gt; &gt; matrix) {\n    int sum[2] = {0};\n    vector&lt;int&gt; s;\n    for(int i = matrix.begin();i &lt; matrix.size();i++)\n    {\n        for(int j = matrix[i].begin();j &lt; matrix.[i].size();j++)\n        {\n            if(i == j)\n                sum[0]+=matrix[i][j];\n            if((i+j) == matrix.size())\n                sum[1]+=matrix[i][j];\n        }\n    }\n        return (sum[0] + sum[1]);\n}\nint main()\n{\n    vector &lt;vector&lt;int&gt; &gt; matrix = {\n            {2,4,6},{4,8,12},{6,12,18}\n    };\n    int dSum = diagonalSum(matrix);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "class", "templates", "definition"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1562161636, "post_id": 56871605, "comment_id": 100291972, "body": "(1) it encapsulates an array of values, (2) the copy semantics are broken (3) use a <code>std::vector</code>, use a <code>std::vector</code>, use a <code>std::vector</code> are the 3 fixes."}, {"owner": {"reputation": 183, "user_id": 8516428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8a136c5ef4712a4a425589119e66b38?s=128&d=identicon&r=PG&f=1", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8516428/arshad"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1562161849, "post_id": 56871605, "comment_id": 100292100, "body": "2. Copy semantics are broken - means there is no mechanism to copy the encapsulated array? 3. I thought of that before, but could there be other concrete answer?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 3, "creation_date": 1562161919, "post_id": 56871605, "comment_id": 100292138, "body": "It means that rule of 3/5/0 is violated - <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/rule_of_three</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1562163325, "post_id": 56871605, "comment_id": 100292881, "body": "<i>&quot;There\u2019s a major problem in the implementation of the class.&quot;</i> <b>A</b> major problem? If you tried to innumerate all of the problems this <code>Array</code> class has, you&#39;d be at it all day. I also wouldn&#39;t know how to answer that question. How could I guess, among all of the problems present, which one the asker is asking about."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1562163453, "post_id": 56871605, "comment_id": 100292951, "body": "In addition to the major problems already pointed out, there are a few other minor stylistic issues as well: <code>data</code> should be initialized with <code>nullptr</code> rather than <code>0</code>. <code>size</code> is a bad name to use if someone adds <code>using namespace std;</code> at some point it clashes with <code>std::size</code>. The <code>if (data)</code> part of <code>if(data) delete[] data;</code> is pointless - <code>delete[] nullptr;</code> is valid and harmless. But really, just use a <code>std::vector</code> already."}, {"owner": {"reputation": 183, "user_id": 8516428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8a136c5ef4712a4a425589119e66b38?s=128&d=identicon&r=PG&f=1", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8516428/arshad"}, "edited": false, "score": 0, "creation_date": 1562163737, "post_id": 56871605, "comment_id": 100293138, "body": "Fran&#231;ois Andrieux, the constructor takes the size of the array. That means, you can loop through it. So, there should be no problem to innumerate it."}], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 8516428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8a136c5ef4712a4a425589119e66b38?s=128&d=identicon&r=PG&f=1", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8516428/arshad"}, "is_accepted": true, "score": 1, "last_activity_date": 1563137494, "last_edit_date": 1563137494, "creation_date": 1562162838, "answer_id": 56871966, "question_id": 56871605, "link": "https://stackoverflow.com/questions/56871605/what-should-be-the-answer-of-this-question/56871966#56871966", "title": "What should be the answer of this question?", "body": "<ol>\n<li>This class encapsulates an array of any kind of values. Similar to <code>RAII</code> [<a href=\"https://en.cppreference.com/w/cpp/language/raii\" rel=\"nofollow noreferrer\">See Here}</a></li>\n<li>There is no copy semantics.</li>\n<li><p>Ways to fix this problem</p>\n\n<ul>\n<li>Use <code>std::vector</code></li>\n<li>Implement \"The rule of three\"/\"The rule of five\"/\"The rule of zero\" <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">[See Here]</a></li>\n<li>Enable changing the size of the array after constructing it.</li>\n<li>Initialize with <code>nullptr</code></li>\n<li>Instead of integer, use <code>std::size</code> or <code>size_t</code></li>\n<li>Change the name of the variable <code>size</code> which might conflict with <code>std::size</code> when <code>using namespace std</code> is used.</li>\n<li>Replace <code>if(data) delete[] data;</code> with <code>delete[] data;</code> when <code>nullptr</code> is used to initialized the values.</li>\n<li>Implement throwing of <code>std::out_of_range</code> in <code>getValue</code> and <code>setValue</code></li>\n</ul></li>\n</ol>\n\n<p>Answered by: <a href=\"https://stackoverflow.com/users/2380830/bathsheba\">Bethsheba</a>, <a href=\"https://stackoverflow.com/users/432358/slava\">Slava</a>, <a href=\"https://stackoverflow.com/users/5910058/jesper-juhl\">Jesper Juhl</a>, <a href=\"https://stackoverflow.com/users/2877241/vlad-from-moscow\">Vlad from Moscow\n</a>, <a href=\"https://stackoverflow.com/users/2079303/eerorika\">eerorika</a></p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1562208799, "last_edit_date": 1562208799, "creation_date": 1562163719, "answer_id": 56872235, "question_id": 56871605, "link": "https://stackoverflow.com/questions/56871605/what-should-be-the-answer-of-this-question/56872235#56872235", "title": "What should be the answer of this question?", "body": "<blockquote>\n  <p>What is the class supposed to do?</p>\n</blockquote>\n\n<p>This is a question that cannot be conclusively determined by reading a program. Only the author knows for certain what they intended. Without documentation, at most we can make a guess.</p>\n\n<p>My guess: It is an attempt at encapsulating the allocation of a dynamic array in a RAII container. A limited and buggy version of <code>std::vector</code>.</p>\n\n<blockquote>\n  <p>There\u2019s a major problem in the implementation of the class. Can you name it?</p>\n</blockquote>\n\n<p>Here are several problems; some more major than others. Following are roughly in order of major problems first, minor problems last:</p>\n\n<ul>\n<li>The class is copyable and movable, but copying and moving results in undefined behaviour.</li>\n<li>There is no simple way of knowing whether <code>getValue</code> returns a value initialised object because that's the value at the index, or because the index is outside of bounds.</li>\n<li>It is unusable with move-only elements.</li>\n<li>It is unusable with non-default-constructible elements.</li>\n<li>It provides no iterators, so it cannot be used with standard algorithms.</li>\n<li><code>if(data)</code> in destructor is redundant.</li>\n</ul>\n\n<blockquote>\n  <p>Can you give 3 different ways of fixing this problem (Depending on the requirement specifications of that class)?</p>\n</blockquote>\n\n<p>I'm assuming that the first issue I mentioned is the one that they refer to.</p>\n\n<ul>\n<li>Delete copy/move assignment/constructor. (Not necessarily ideal, since copying and moving are probably useful operations).</li>\n<li>Or implement them in a way that doesn't result in undefined behaviour. In particular, there must be a class-invariant that a single instance has unique ownership of the pointed array.</li>\n<li>Or use <code>std::vector</code> instead. This fixes all of the minor problems as well.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1562164244, "last_edit_date": 1562164244, "creation_date": 1562163767, "answer_id": 56872248, "question_id": 56871605, "link": "https://stackoverflow.com/questions/56871605/what-should-be-the-answer-of-this-question/56872248#56872248", "title": "What should be the answer of this question?", "body": "<p>I would want to append the answer of <strong>@Arshad</strong>.</p>\n\n<p>For starters the size of the array should have the type <code>size_t</code>.</p>\n\n<p>The member functions <code>setValue</code> and <code>getValue</code> should throw the exception <code>std::out_of_range</code>.</p>\n\n<p>The function <code>getValue</code> should be overloaded for <code>const</code> and <code>non-const</code> objects and correcpondingly return either <code>const</code> or <code>non-const reference</code> to an element of the array. </p>\n\n<p>It would be better to declare (also) the <code>operator []</code>.</p>\n\n<p>It is desirable to initialize the array</p>\n\n<pre><code>data = new T[size] {};\n</code></pre>\n\n<p>Also the class shall have a member function named <code>size()</code> that returns the number of elements in the array. Otherwise the user of the class will not be able to specify correctly an index.</p>\n\n<p>And I think iterators for the class also should be mentioned.:) Otherwise the class is not very useful and can not be used with standard algorithms as for example <code>std::fill</code>.:)</p>\n"}], "owner": {"reputation": 183, "user_id": 8516428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8a136c5ef4712a4a425589119e66b38?s=128&d=identicon&r=PG&f=1", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8516428/arshad"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "closed_date": 1562164547, "accepted_answer_id": 56871966, "answer_count": 3, "score": -3, "last_activity_date": 1563137494, "creation_date": 1562161554, "last_edit_date": 1562164409, "question_id": 56871605, "link": "https://stackoverflow.com/questions/56871605/what-should-be-the-answer-of-this-question", "closed_reason": "Needs more focus", "title": "What should be the answer of this question?", "body": "<p><strong><em>Note:</strong> I got this question from a friend of mine. It was given to him in an interview exam. I'd done programming in C++ in my early days of university. Even though the question looked easy on the first glance, I couldn't find a good answer to it. That's why I'm asking here.</em></p>\n\n<p>Given this C++ code below, please answer to the following 3 questions:</p>\n\n<ul>\n<li>What is the class supposed to do?</li>\n<li>There\u2019s a major problem in the implementation of the class. Can you name it?</li>\n<li>Can you give 3 different ways of fixing this problem (Depending on the requirement specifications of that class)?</li>\n</ul>\n\n<pre><code>    template&lt;typename T&gt;\n    class Array\n    {\n     public:\n        Array(unsigned arraySize):\n            data(0), size(arraySize)\n        {\n            if(size &gt; 0)\n                data = new T[size];\n        }\n        ~Array()\n        {\n            if(data) delete[] data;\n        }\n\n        void setValue(unsigned index, const T&amp; value)\n        {\n            if(index &lt; size)\n                data[index] = value;\n        }\n\n        T getValue(unsigned index) const\n        {\n            if(index &lt; size)\n                return data[index];\n            else\n                return T();\n        }\n\n     private:\n        T* data;\n        unsigned size;\n    };\n</code></pre>\n"}, {"tags": ["c#", "c++", "dll"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 1, "creation_date": 1562163086, "post_id": 56871517, "comment_id": 100292764, "body": "&quot;<i>What and why are the attributes done the way they are?</i>&quot; That&#39;s what the documentation is for. The response to such a question should be to look up the documentation for those attributes to learn what they do or indicate. Microsoft offers a handy <a href=\"https://docs.microsoft.com/en-us/dotnet/api/?view=netframework-4.8\" rel=\"nofollow noreferrer\">.NET API browser</a> that makes it dead simple to lookup any class/type (including attribute types, of course)  and its memebers you want to know about. (Alternatively, in Visual Studio, move the text caret/cursor on an attribute you want to know more about, and hit that F1 key)"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1562163262, "post_id": 56871517, "comment_id": 100292851, "body": "A dll has multiple entry points.  Each entry point is a public function in the dll.  So the dll has two methods bar_Dll and foo_Dll and each returns an integer."}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 0, "creation_date": 1562163740, "post_id": 56871517, "comment_id": 100293144, "body": "Make a new c++/CLI .DLL (c++/CLI dlls are a hybrid of both native <i>and</i> managed code) <b>&quot;P&quot;</b> that will act as a simple <i>proxy/facade pattern</i> around your existing c/c++ .DLL <b>&quot;E&quot;</b>.  Your C# code calls the types in <b>&quot;P&quot;</b> and does not see/care about <b>&quot;E&quot;</b>.  <b>&quot;P&quot;</b> routes calls into <b>&quot;E&quot;</b> and returns results (if any) as managed types.  <b>No need to fidlle about with tedious dllexport and/or p-invoke</b>.  By the way, depending on your needs you don&#39;t need to necessarily expose all c++ methods to .NET if you don&#39;t want to.  Keep the wrapper simple"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10729819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98773a057829e3ddaebac407176861f7?s=128&d=identicon&r=PG&f=1", "display_name": "Darrick Ross", "link": "https://stackoverflow.com/users/10729819/darrick-ross"}, "edited": false, "score": 0, "creation_date": 1562171751, "post_id": 56872740, "comment_id": 100297579, "body": "So im somewhat following this, where do I fine/create the &lt;name&gt;.dll which in your example is DLLExample.dll? Do I create it?"}, {"owner": {"reputation": 39, "user_id": 9045902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87a81594052fc5d75bc027d1dbaa69bb?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/9045902/alexander"}, "reply_to_user": {"reputation": 1, "user_id": 10729819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98773a057829e3ddaebac407176861f7?s=128&d=identicon&r=PG&f=1", "display_name": "Darrick Ross", "link": "https://stackoverflow.com/users/10729819/darrick-ross"}, "edited": false, "score": 0, "creation_date": 1562224892, "post_id": 56872740, "comment_id": 100312852, "body": "The project is a Visual studio 2017 project for Windows. However, in case you do not use that, you can just browse the files either way. Stuff.sln contains 3 projects. Stuff, DLLExample and CSharpExampleUsingCpp. So setting startup project to CSharpExampleUsingCpp, you can easily follow the code along with a debugger. But in case you can&#39;t follow that along, you find all the necessary code for &quot;DLLExample&quot; in the Stuff/DLLExample directory. There is even an instructions.txt how the .dll is set up in VS2017.  Note; the project is not uploaded built. It is always assumed you do it yourself."}], "tags": [], "owner": {"reputation": 39, "user_id": 9045902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87a81594052fc5d75bc027d1dbaa69bb?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/9045902/alexander"}, "is_accepted": false, "score": 0, "last_activity_date": 1562165276, "creation_date": 1562165276, "answer_id": 56872740, "question_id": 56871517, "link": "https://stackoverflow.com/questions/56871517/how-to-call-c-code-and-the-code-it-calls-from-c/56872740#56872740", "title": "How to call C++ code, and the code it calls, from C#", "body": "<p>Alright, so you have a header and cpp which you need to use. In order to use it you have to have make the c++ into C code. This is pretty much what you see in the DLL example code that you showed. However, I do suggest that you remove the includes from the header as I'm unsure how that would translate to the C code. Put the includes in the cpp files instead.</p>\n\n<p>I find it rather difficult to answer this questions other than just showing a whole bunch of example code. Full code in: <a href=\"https://github.com/ze413X/Cpp-Code-Gems/\" rel=\"nofollow noreferrer\">https://github.com/ze413X/Cpp-Code-Gems/</a> Where \"CSharpExampleUsingCpp\" calls from MainWindow.xaml.cs the \"DLLExample\" which uses the file in the directory includes and source. </p>\n\n<p>DLL:</p>\n\n<p>The header which is exposing functions to be used:</p>\n\n<pre><code>#pragma once\n\n#define DLLExport _declspec(dllexport)\n\nextern \"C\" DLLExport void __cdecl GetCppText(char* str, int* strLength);\n\nextern \"C\" DLLExport void __cdecl DLLPrint();\n</code></pre>\n\n<p>.cpp</p>\n\n<pre><code>#include \"../includes/DLLExampleCode.h\"\n\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nvoid __cdecl GetCppText(char* str, int* strLength)\n{\n    std::string text = \"This is called from within the DLL.\\0\";\n    if (*strLength &lt; text.length() || str == nullptr)\n    {\n        return;\n    }\n    memset((void*)str, 0, (*strLength) * sizeof(char));\n    strcpy_s(str, *strLength,text.c_str());\n    *strLength = text.length();\n}\n\nvoid __cdecl DLLPrint()\n{\n    std::cout &lt;&lt; \"This is printed from inside DLLExample.dll.\\n\";\n}\n</code></pre>\n\n<p>C#:</p>\n\n<pre><code>using System.Runtime.InteropServices;\n\nnamespace CSharpExampleUsingCpp\n{\n    public partial class MainWindow : Window\n    {\nconst string PATH = \"DLLExample.dll\";\n\n[DllImport(PATH, CallingConvention = CallingConvention.Cdecl)]\npublic static unsafe extern void GetCppText(byte[] str, out System.Int32 strLength);\n\n....\n\nprivate void CppInteropButton_Click(object sender, RoutedEventArgs e)\n        {\n            System.Int32 size = 256;\n            System.Byte[] str = new byte[size];\n            for (int i = 0; i &lt; size; i++)\n            {\n                str[i] = (byte)'1';\n            }\n\n            GetCppText(str, out size);\n            string result = System.Text.Encoding.UTF8.GetString(str, 0, size);\n            CppInteropButtonTextBox.Text = result;\n}\n</code></pre>\n\n<p>Although, rereading my solution of obtaining a string might not be the best way of doing it. You could probably marshal that thing to avoid all this stupid char* conversions. I probably had some good reason at that point in time when I wrote it. That should be much easier to google though.</p>\n"}], "owner": {"reputation": 1, "user_id": 10729819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98773a057829e3ddaebac407176861f7?s=128&d=identicon&r=PG&f=1", "display_name": "Darrick Ross", "link": "https://stackoverflow.com/users/10729819/darrick-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562165276, "creation_date": 1562161241, "question_id": 56871517, "link": "https://stackoverflow.com/questions/56871517/how-to-call-c-code-and-the-code-it-calls-from-c", "title": "How to call C++ code, and the code it calls, from C#", "body": "<h3>TL;DR</h3>\n\n<p>I have legacy c++ code which does stuff (sometimes returns stuff), calls other cpp code, but is not a full class/obj. This code I cannot alter. I am making fresh c# code which I am looking to call the c++ code from. I don't understand whether to create a dll that calls the original legacy c++, or create a CLR?? which also calls the legacy cpp. Below I have example code that I have implemented (with problems). </p>\n\n<h3>Main</h3>\n\n<p>I have legacy.cpp and legacy.h which I can not alter.</p>\n\n<p>This is not a class/object and only has public functions, values, and #defines.\nlegacy.cpp and .h both #include other files and cpp libraries to do its job.</p>\n\n<p>I have a new project where I can add C#, C++ code </p>\n\n<p>I am having trouble understanding what I need to do/research in order to call any of the functions defined in legacy.cpp (or the values/defines) from within my new C# code.</p>\n\n<p>Some of what I have looked at include</p>\n\n<ul>\n<li><p>Managed CLR wrappers</p>\n\n<ul>\n<li><a href=\"https://drthitirat.wordpress.com/2013/06/03/use-c-codes-in-a-c-project-wrapping-native-c-with-a-managed-clr-wrapper/\" rel=\"nofollow noreferrer\">https://drthitirat.wordpress.com/2013/06/03/use-c-codes-in-a-c-project-wrapping-native-c-with-a-managed-clr-wrapper/</a> </li>\n<li><a href=\"https://web.archive.org/web/20140806022309/http://blogs.msdn.com/b/borisj/archive/2006/09/28/769708.aspx\" rel=\"nofollow noreferrer\">https://web.archive.org/web/20140806022309/http://blogs.msdn.com/b/borisj/archive/2006/09/28/769708.aspx</a></li>\n</ul></li>\n<li>DLLs?? \n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/16332701/how-to-call-c-dll-in-c-sharp\">How to call C++ DLL in C#</a></li>\n</ul></li>\n</ul>\n\n<h2>CLR</h2>\n\n<p>I have currently tried to create a CLR (thought I feel like it is not what I need in this situation), but I had problems in the clr_wrapper.cpp, it could not find the reference to foo() </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>//Wrapper.cpp\n\n#include \"Wrapper.h\"\n\n#include \"abs\\path\\to\\legacy\\code\\legacy.h\"\n#include \"abs\\path\\to\\legacy\\code\\legacy.cpp\"\n\nint foo_Wrapper()\n{\n    return foo(); //int foo() is declared in legacy.h and defined in legacy.cpp\n}\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#pragma once\n\n#include \"abs\\path\\to\\legacy\\code\\legacy.h\"\n#include \"abs\\path\\to\\legacy\\code\\legacy.cpp\"\n\nusing namespace System; //What things use this? \n                        //Can I just prepend System:: to whatever needs it?\nnamespace Wrapper {\n    public ref class Wrapper\n    {\n    public:\n        int foo_Wrapper();\n    };\n}\n</code></pre>\n\n<p>the foo_Wrapper() is not able to call foo(). </p>\n\n<p>My confusion with this method is that it looks like I would need to make the clr wrapper an object class with member functions that will be called as needed. Leading to a syntax of <code>obj.foo()</code>. Is this what needs to be done if I chose to do some sort of CLR wrapper?</p>\n\n<h2>DLL</h2>\n\n<p>I have also looked at making this all a dll like in (<a href=\"https://stackoverflow.com/questions/16332701/how-to-call-c-dll-in-c-sharp\">How to call C++ DLL in C#</a>)</p>\n\n<p>However I am confused on setting this up. My current idea is to have a cpp dll call the original cpp (ie create legacyDll.dll which would make calls to foo(), then my main c# would call the __declspec(dllexport) functions defined within extern \"C\" {}</p>\n\n<p>current setup (from \"How to call c dll in c sharp\")\ndllmain.cpp</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// dllmain.cpp : Defines the entry point for the DLL application.\n#include \"pch.h\"\n#include &lt;iostream&gt;\n#include &lt;Windows.h&gt;\n\nusing namespace std;\n\nextern \"C\"\n{\n    __declspec(dllexport) void bar_Dll()\n    {\n        cout &lt;&lt; \"calling bar() in legacy code\" &lt;&lt; endl;\n    }\n\n    __declspec(dllexport) int foo_Dll()\n    {\n        cout &lt;&lt; \"calling foo() in legacy code\" &lt;&lt; endl;\n        //realistically I would have,\n        //return foo()\n    }\n}\n</code></pre>\n\n<p>Class1.cs</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\nusing System.Runtime.InteropServices;\n\nnamespace Test_DLL_Calling\n{\n    class Class1\n    {\n        [DllImport(\"dllmain.dll\", CallingConvention = CallingConvention.Cdecl)]\n        public static extern void bar_Dll();\n\n        [DllImport(\"dllmain.dll\", CallingConvention = CallingConvention.Cdecl)]\n        public static extern int foo_Dll();\n\n        public static void Main(string[] arg)\n        {\n            bar_Dll(); //The specified module could not be found (Exception)\n\n            Console.WriteLine(foo_Dll()); //Im guessing this will also ^^\n        }\n    }\n}\n</code></pre>\n\n<p>This part I don't follow. What and why are the attributes done the way they are? </p>\n"}, {"tags": ["c++", "templates", "g++"], "comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 2, "creation_date": 1562161296, "post_id": 56871390, "comment_id": 100291784, "body": "Where are the specialisations defined?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1562161374, "post_id": 56871390, "comment_id": 100291829, "body": "Could you replace your code snippets with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> as a single piece of code that can be copied, pasted and compiled without the need to stitch them together?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 0, "creation_date": 1562161470, "post_id": 56871390, "comment_id": 100291883, "body": "@BiagioFesta that&#39;s probably because your example is not equivalent, there is no output in your example, therefore the compier optimizes everything away"}, {"owner": {"reputation": 10431, "user_id": 880584, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/AQCJr.jpg?s=128&g=1", "display_name": "Patrick B.", "link": "https://stackoverflow.com/users/880584/patrick-b"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1562161511, "post_id": 56871390, "comment_id": 100291908, "body": "@eerorika Specialization are in func.cpp."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 0, "creation_date": 1562161536, "post_id": 56871390, "comment_id": 100291921, "body": "@BiagioFesta Reproducible example: <a href=\"https://wandbox.org/permlink/UB2QP5i5smWLKZet\" rel=\"nofollow noreferrer\">wandbox.org/permlink/UB2QP5i5smWLKZet</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1562161565, "post_id": 56871390, "comment_id": 100291932, "body": "@PatrickB. that&#39;s the point, you should make it one file, which make things simpler for us."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1562161703, "post_id": 56871390, "comment_id": 100292007, "body": "@Jabberwocky - Making it one file doesn&#39;t reproduce the error. It should not be so easy on us that the error entirely goes away."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1562162032, "post_id": 56871390, "comment_id": 100292199, "body": "@StoryTeller this is interesting information, it should therefore be part of the question."}], "answers": [{"comments": [{"owner": {"reputation": 10431, "user_id": 880584, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/AQCJr.jpg?s=128&g=1", "display_name": "Patrick B.", "link": "https://stackoverflow.com/users/880584/patrick-b"}, "edited": false, "score": 0, "creation_date": 1562162125, "post_id": 56871600, "comment_id": 100292241, "body": "If I leave the template-function-declaration without an implementation (the real bug) without forward declaration the specializations, does this still violates something? That way my library will produce a link-error when a specialization is not provided."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 10431, "user_id": 880584, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/AQCJr.jpg?s=128&g=1", "display_name": "Patrick B.", "link": "https://stackoverflow.com/users/880584/patrick-b"}, "edited": false, "score": 0, "creation_date": 1562163710, "post_id": 56871600, "comment_id": 100293121, "body": "Well, you&#39;ll get link error if your forward declare without providing defintion, if that was your question."}], "tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": false, "score": 3, "last_activity_date": 1562162055, "last_edit_date": 1562162055, "creation_date": 1562161542, "answer_id": 56871600, "question_id": 56871390, "link": "https://stackoverflow.com/questions/56871390/why-do-compiler-options-impact-selection-of-template-implementation/56871600#56871600", "title": "Why do compiler options impact selection of template implementation?", "body": "<p>You have undefined behaviour because of ODR issues.</p>\n\n<p>ODR says that there should be only one definition for each symbol. Inline and template functions can multiple definitions but must have the same implementation, token by token. No diagnostic required if this rule is broken.</p>\n\n<p>When compiling your example, the compiler will instantiate your function. Look at this:</p>\n\n<pre><code>template &lt;int&gt;\nvoid func() { std::cerr &lt;&lt; \"default impl\\n\"; } // normally no impl here\n\nint main(void)\n{\n    func&lt;1&gt;();\n    func&lt;2&gt;();\n\n    return 0;\n}\n</code></pre>\n\n<p>This is what the compiler sees. It cannot see other cpp files. The compiler will instantiate the templates and create additional definition for your functions.</p>\n\n<p>Then your other cpp file will provide another definition that is different.</p>\n\n<p>The solution to this is to forward declare the specializations in your header:</p>\n\n<pre><code>template&lt;&gt; void func&lt;1&gt;();\ntemplate&lt;&gt; void func&lt;2&gt;();\n</code></pre>\n\n<p>This will tell the compiler that the specializations are declared elsewhere, and not to instantiate the default one.</p>\n"}, {"tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 12, "last_activity_date": 1562161561, "creation_date": 1562161561, "answer_id": 56871606, "question_id": 56871390, "link": "https://stackoverflow.com/questions/56871390/why-do-compiler-options-impact-selection-of-template-implementation/56871606#56871606", "title": "Why do compiler options impact selection of template implementation?", "body": "<p>Your code is ill-formed, no diagnostic required. So different behaviors at different optimization levels are possible.</p>\n\n<blockquote>\n  <p><strong>[temp.expl.spec]</strong></p>\n  \n  <p><a href=\"https://timsong-cpp.github.io/cppwp/n4659/temp.expl.spec#6\" rel=\"noreferrer\">6</a> If a template, a member template or a member of a class\n  template is explicitly specialized then that specialization shall be\n  declared before the first use of that specialization that would cause\n  an implicit instantiation to take place, in every translation unit in\n  which such a use occurs; no diagnostic is required. If the program\n  does not provide a definition for an explicit specialization and\n  either the specialization is used in a way that would cause an\n  implicit instantiation to take place or the member is a virtual member\n  function, the program is ill-formed, no diagnostic required. An\n  implicit instantiation is never generated for an explicit\n  specialization that is declared but not defined.</p>\n</blockquote>\n\n<p>The function template is specialized in one TU, but the other doesn't have a specialization declaration available. It's quite likely an aggressive optimizer chooses the implicit instantiation (that is available inline) instead of finding the one you created elsewhere. The solution is to declare that your specialization exists in the header.</p>\n"}], "owner": {"reputation": 10431, "user_id": 880584, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/AQCJr.jpg?s=128&g=1", "display_name": "Patrick B.", "link": "https://stackoverflow.com/users/880584/patrick-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 56871606, "answer_count": 2, "score": 10, "last_activity_date": 1562162210, "creation_date": 1562160819, "last_edit_date": 1562162210, "question_id": 56871390, "link": "https://stackoverflow.com/questions/56871390/why-do-compiler-options-impact-selection-of-template-implementation", "title": "Why do compiler options impact selection of template implementation?", "body": "<p>Depending on whether I compile with -O3 or without optimization the compiler does not select the same function-template-instanciation. Using gcc (Debian 8.3.0-6) 8.3.0.</p>\n\n<p>Due to an oversight I have a default implementation in a function template declaration:</p>\n\n<pre><code>#pragma once\n\n#include &lt;iostream&gt;\n\ntemplate &lt;int&gt;\nvoid func() { std::cerr &lt;&lt; \"default impl\\n\"; } // normally no impl here\n</code></pre>\n\n<p>And their specialisations:</p>\n\n<pre><code>#include \"func.h\"\n\ntemplate &lt;&gt;\nvoid func&lt;1&gt;()\n{\n    std::cerr &lt;&lt; \"special 1\\n\";\n}\n\ntemplate &lt;&gt;\nvoid func&lt;2&gt;()\n{\n    std::cerr &lt;&lt; \"special 2\\n\";\n}\n</code></pre>\n\n<p>And the main-function.</p>\n\n<pre><code>#include \"func.h\"\n\nint main(void)\n{\n    func&lt;1&gt;();\n    func&lt;2&gt;();\n\n    return 0;\n}\n</code></pre>\n\n<p>Compiling and running <code>g++ -Wall func.cpp main.cpp -o main &amp;&amp; ./main</code> gives:</p>\n\n<pre><code>special 1\nspecial 2\n</code></pre>\n\n<p>Using optimizations <code>g++ -O3 -Wall func.cpp main.cpp -o main &amp;&amp; ./main</code> gives:</p>\n\n<pre><code>default impl\ndefault impl\n</code></pre>\n\n<p>Is this expected? Is the code triggering an unexpected behavior I'm not aware of? </p>\n\n<p>Thanks to @NathanOliver from the comments who made a <a href=\"http://wandbox.org/permlink/UB2QP5i5smWLKZet\" rel=\"noreferrer\">Wandbox</a>. Compiling with or without optimizations shows the different output.</p>\n"}, {"tags": ["c++", "database", "performance", "sqlite"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1562161224, "post_id": 56871344, "comment_id": 100291738, "body": "&quot;<i>I would like to know if it&#39;s better to load all my data at the beginning and save it in map or vector or whatever or just make simple request.</i>&quot; What&#39;s your definition of &quot;better&quot;?"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1562161821, "post_id": 56871344, "comment_id": 100292082, "body": "For nearly all aspects of &#39;better&#39;, you should just work with the database in real time. SQLite is already pretty fast and crash-resistant."}, {"owner": {"reputation": 85, "user_id": 9271899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109101b960f36a6fe479501b4fd48939?s=128&d=identicon&r=PG&f=1", "display_name": "Alp4ga", "link": "https://stackoverflow.com/users/9271899/alp4ga"}, "edited": false, "score": 0, "creation_date": 1562162327, "post_id": 56871344, "comment_id": 100292342, "body": "I should have said faster than better"}], "answers": [{"tags": [], "owner": {"reputation": 15008, "user_id": 16582, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/febff21383acf755f8b375c322e36f2b?s=128&d=identicon&r=PG", "display_name": "ravenspoint", "link": "https://stackoverflow.com/users/16582/ravenspoint"}, "is_accepted": false, "score": 1, "last_activity_date": 1562162324, "creation_date": 1562162324, "answer_id": 56871823, "question_id": 56871344, "link": "https://stackoverflow.com/questions/56871344/load-database-or-make-request/56871823#56871823", "title": "Load Database or make request", "body": "<p>load all my data at the beginning</p>\n\n<p>PRO:</p>\n\n<ul>\n<li>faster</li>\n<li>code is simpler, so long as <strong>data does not change</strong></li>\n</ul>\n\n<p>CON:</p>\n\n<ul>\n<li>if data changes, you need to organize synchronization the two copies.</li>\n</ul>\n"}], "owner": {"reputation": 85, "user_id": 9271899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109101b960f36a6fe479501b4fd48939?s=128&d=identicon&r=PG&f=1", "display_name": "Alp4ga", "link": "https://stackoverflow.com/users/9271899/alp4ga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1562162324, "creation_date": 1562160681, "question_id": 56871344, "link": "https://stackoverflow.com/questions/56871344/load-database-or-make-request", "title": "Load Database or make request", "body": "<p>I have a sqlite database with only one table and I would like to know if it's better to load all my data at the beginning and save it in map or vector or whatever or just make simple request. I have only 255 line in my table.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1562160633, "post_id": 56871290, "comment_id": 100291346, "body": "&quot;<i>where <code>ArbitraryBase</code> can be some base class determined at compile time.</i>&quot; How is it determined? Possible solutions might depend on that."}, {"owner": {"reputation": 494, "user_id": 5182786, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/da86a062a2f7ef545f3231d18cc7025b?s=128&d=identicon&r=PG&f=1", "display_name": "qsfzy", "link": "https://stackoverflow.com/users/5182786/qsfzy"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1562160679, "post_id": 56871290, "comment_id": 100291386, "body": "Well... I&#39;m not sure exactly how it would work. I would need to specify which base class to inherit from when the derived class is constructed somehow."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1562160885, "post_id": 56871290, "comment_id": 100291515, "body": "One cannot construct derived class, before constructing the instance of base class. Base class instances are always constructed before derived class instances."}], "answers": [{"tags": [], "owner": {"reputation": 10901, "user_id": 578749, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40231a11da5f1c627fd21d6700edddff?s=128&d=identicon&r=PG", "display_name": "lvella", "link": "https://stackoverflow.com/users/578749/lvella"}, "is_accepted": false, "score": 9, "last_activity_date": 1562163047, "last_edit_date": 1562163047, "creation_date": 1562160821, "answer_id": 56871392, "question_id": 56871290, "link": "https://stackoverflow.com/questions/56871290/inherit-from-arbitrary-class-in-c/56871392#56871392", "title": "Inherit from arbitrary class in c++?", "body": "<p>If it is truly determined at compile time, you can make your derived class a template:</p>\n\n<pre><code>template&lt;class T&gt;\nclass Derived : public T {\n    public:\n        Derived() {}\n\n    ...\n};\n</code></pre>\n\n<p>You can later create instantiate this class by providing the base type:</p>\n\n<pre><code>int main() {\n    Derived&lt; ??? &gt; my_object;\n\n    ...\n}\n</code></pre>\n\n<p>Where <code>???</code> is some compile time way of getting your derived type.</p>\n"}, {"comments": [{"owner": {"reputation": 1051, "user_id": 7192989, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d41f45e6cacfb3d4195a9878880724?s=128&d=identicon&r=PG", "display_name": "Rinat Veliakhmedov", "link": "https://stackoverflow.com/users/7192989/rinat-veliakhmedov"}, "edited": false, "score": 0, "creation_date": 1562161544, "post_id": 56871417, "comment_id": 100291927, "body": "What happens if you don&#39;t write <code>using T::T;</code>?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1051, "user_id": 7192989, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d41f45e6cacfb3d4195a9878880724?s=128&d=identicon&r=PG", "display_name": "Rinat Veliakhmedov", "link": "https://stackoverflow.com/users/7192989/rinat-veliakhmedov"}, "edited": false, "score": 0, "creation_date": 1562161611, "post_id": 56871417, "comment_id": 100291957, "body": "@RinatVeliakhmedov Then it doesn&#39;t inherit from the bases(s).  I&#39;m going to remove it though since the OP updated their code with <code>Derived</code> having it&#39;s own constructor."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 5, "last_activity_date": 1562161810, "last_edit_date": 1562161810, "creation_date": 1562160896, "answer_id": 56871417, "question_id": 56871290, "link": "https://stackoverflow.com/questions/56871290/inherit-from-arbitrary-class-in-c/56871417#56871417", "title": "Inherit from arbitrary class in c++?", "body": "<p>You can do this via a template.  Using</p>\n\n<pre><code>template&lt;typename T&gt;\nclass Derived : public T\n{\npublic:\n    Derived() : T() {}\n    // or just use if actually need to provide a default constructor\n    Derived() = default;\n};\n</code></pre>\n\n<p>gives you a class that inherits from <code>T</code> and calls <code>T</code>'s default constructor.  You would create a concrete class with it like</p>\n\n<pre><code>Derived&lt;Base1&gt; d;\n</code></pre>\n\n<p>and now <code>d</code> is a <code>Derived</code> that inherits from <code>Base1</code>.</p>\n\n<p>If you need to inherit from an arbitrary number of bases then you can use a variadic template like</p>\n\n<pre><code>template&lt;typename... Bases&gt;\nclass Derived : public Bases...\n{\npublic:\n    Dervied() : Bases()... {}\n    // or just use if actually need to provide a default constructor\n    Derived() = default;\n};\n</code></pre>\n\n<p>and it would be used like</p>\n\n<pre><code>Derived&lt;Base1, Base2, ..., BaseN&gt; d;\n</code></pre>\n"}], "owner": {"reputation": 494, "user_id": 5182786, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/da86a062a2f7ef545f3231d18cc7025b?s=128&d=identicon&r=PG&f=1", "display_name": "qsfzy", "link": "https://stackoverflow.com/users/5182786/qsfzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562163047, "creation_date": 1562160512, "last_edit_date": 1562161178, "question_id": 56871290, "link": "https://stackoverflow.com/questions/56871290/inherit-from-arbitrary-class-in-c", "title": "Inherit from arbitrary class in c++?", "body": "<p>Is it possible to design a class that will inherit from any one of a group of base classes? I would like to be able to write something like:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Derived : public ArbitraryBase {\n    public:\n        Derived () : ArbitraryBase () {}\n\n    ...\n};\n</code></pre>\n\n<p>where <code>ArbitraryBase</code> can be some base class determined at compile time. I have a group of base classes that I would like to derive identical classes from. Is there a way to avoid writing an individual derived class for each of the base classes?</p>\n"}, {"tags": ["c++", "algorithm", "sorting", "quicksort"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 3, "creation_date": 1562160516, "post_id": 56871269, "comment_id": 100291262, "body": "Did you compile with optimizations enabled?"}, {"owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "edited": false, "score": 0, "creation_date": 1562160817, "post_id": 56871269, "comment_id": 100291473, "body": "You should have a look at this very interesting video: itCppCon19 - &quot;Allegro&quot; Means Both Fast and Happy. Coincidence? (Andrei Alexandrescu)"}, {"owner": {"reputation": 31, "user_id": 8855010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9RHEn.png?s=128&g=1", "display_name": "varrtix", "link": "https://stackoverflow.com/users/8855010/varrtix"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1562160900, "post_id": 56871269, "comment_id": 100291525, "body": "@AlgirdasPreid\u017eius I&#39;m not sure you&#39;re talking about sync_with_stdio and cin.tie?No, I didn&#39;t."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 5, "creation_date": 1562160974, "post_id": 56871269, "comment_id": 100291560, "body": "@varrtix &quot;<i>I&#39;m not sure you&#39;re talking about sync_with_stdio and cin.tie?</i>&quot; No, I am not. I am talking about compiler optimizations, as in -O3 compiler flag. Profiling unomptimized code is meaningless."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 2, "creation_date": 1562161079, "post_id": 56871269, "comment_id": 100291632, "body": "The in-place version shouldn&#39;t return a copy of the vector."}, {"owner": {"reputation": 31, "user_id": 8855010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9RHEn.png?s=128&g=1", "display_name": "varrtix", "link": "https://stackoverflow.com/users/8855010/varrtix"}, "reply_to_user": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "edited": false, "score": 0, "creation_date": 1562161112, "post_id": 56871269, "comment_id": 100291655, "body": "@prog-fh All right, thank you."}, {"owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1562161435, "post_id": 56871269, "comment_id": 100291857, "body": "@interjay Yes, two full copies at each recursion... ouch! ;^)"}, {"owner": {"reputation": 31, "user_id": 8855010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9RHEn.png?s=128&g=1", "display_name": "varrtix", "link": "https://stackoverflow.com/users/8855010/varrtix"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1562161907, "post_id": 56871269, "comment_id": 100292130, "body": "@interjay Isn\u2019t that &amp; a reference? like an alias? Why is a copy of vector?"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1562161955, "post_id": 56871269, "comment_id": 100292154, "body": "The function&#39;s return type isn&#39;t a reference, so it makes a copy."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1562161987, "post_id": 56871269, "comment_id": 100292172, "body": "If it takes fifty seconds to sort 100000 numbers, something is very wrong somewhere."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1562162266, "post_id": 56871269, "comment_id": 100292310, "body": "If you are not building with optimizations enabled, any timings/benchmarks/comparisons are meaningless. Turn on the optimizer and try again."}, {"owner": {"reputation": 31, "user_id": 8855010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9RHEn.png?s=128&g=1", "display_name": "varrtix", "link": "https://stackoverflow.com/users/8855010/varrtix"}, "edited": false, "score": 0, "creation_date": 1562162470, "post_id": 56871269, "comment_id": 100292420, "body": "I get it! Thanks for everyone!"}], "answers": [{"tags": [], "owner": {"reputation": 60, "user_id": 11729096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae0967f4fcedb1bd61996b0f6bbf72f6?s=128&d=identicon&r=PG&f=1", "display_name": "user11729096", "link": "https://stackoverflow.com/users/11729096/user11729096"}, "is_accepted": true, "score": 0, "last_activity_date": 1562161538, "creation_date": 1562161538, "answer_id": 56871599, "question_id": 56871269, "link": "https://stackoverflow.com/questions/56871269/why-is-in-place-quicksort-slower-than-normal-version-in-c/56871599#56871599", "title": "Why is In-place QuickSort slower than normal version in C++?", "body": "<p>Can't comment but in the the in-place version you don't need the lambda and you don't need to return the vector. Untested, with minimal changes to the original code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void exec_in_placex(vector&lt;int&gt; &amp;nums, int begin, int end) {\n    if (begin &gt;= end) {\n        return;\n    }\n\n    auto pivot_idx = begin + (end - begin) / 2;\n    auto pivot_val = nums[pivot_idx], idx_1 = begin;\n    std::swap(nums[pivot_idx], nums[end]);\n    for (auto idx_2 = begin; idx_2 &lt;= end - 1; ++idx_2) {\n        if (nums[idx_2] &gt; pivot_val) continue;\n        std::swap(nums[idx_1], nums[idx_2]);\n        idx_1++;\n    }\n    std::swap(nums[idx_1], nums[end]);\n    auto pivot = idx_1;\n\n    exec_in_placex(nums, begin, pivot - 1);\n    exec_in_placex(nums, pivot + 1, end);\n}\n\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8855010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9RHEn.png?s=128&g=1", "display_name": "varrtix", "link": "https://stackoverflow.com/users/8855010/varrtix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 56871599, "answer_count": 1, "score": 0, "last_activity_date": 1562161538, "creation_date": 1562160431, "question_id": 56871269, "link": "https://stackoverflow.com/questions/56871269/why-is-in-place-quicksort-slower-than-normal-version-in-c", "title": "Why is In-place QuickSort slower than normal version in C++?", "body": "<p>In Xcode of my macOS, I've made a timer test for quicksort.when my element's quantity is like 10, 100. Until I have set an amount like 1000, the running time of my In-place version becomes slower than another version. I'm using C++ to do this test.\nhere is the code of my main function:</p>\n\n<pre><code>    const int sort_size = 100000;\n    clock_t begin, end;\n    vector&lt;int&gt; vec_1;\n    srand((unsigned)time(NULL));\n    for (auto i = 0; i &lt; sort_size; ++i) {\n        auto r = rand() % sort_size;\n        vec_1.push_back(r);\n    }\n    vector&lt;int&gt; vec_2(vec_1);\n    begin = clock();\n    auto sort_1 = QuickSort::exec(vec_1);\n    end = clock();\n    printf(\"%lfs\\n\", (double)(end - begin) / CLOCKS_PER_SEC);\n    begin = clock();\n    auto sort_2 = QuickSort::exec_in_place(vec_2, 0, sort_size - 1);\n    end = clock();\n    printf(\"%lfs\\n\", (double)(end - begin) / CLOCKS_PER_SEC);\n</code></pre>\n\n<p>Both two functions have used static declaration.</p>\n\n<p>here is the In-place version code:</p>\n\n<pre><code>vector&lt;int&gt; QuickSort::exec_in_place(vector&lt;int&gt; &amp;nums, int begin, int end) {\n    if (begin &gt;= end) {\n        return nums;\n    }\n    auto pivot = [=, &amp;nums] () {\n        auto pivot_idx = begin + (end - begin) / 2;\n        auto pivot_val = nums[pivot_idx], idx_1 = begin;\n        std::swap(nums[pivot_idx], nums[end]);\n        for (auto idx_2 = begin; idx_2 &lt;= end - 1; ++idx_2) {\n            if (nums[idx_2] &gt; pivot_val) continue;\n            std::swap(nums[idx_1], nums[idx_2]);\n            idx_1++;\n        }\n        std::swap(nums[idx_1], nums[end]);\n        return idx_1;\n    }();\n    exec_in_place(nums, begin, pivot - 1);\n    exec_in_place(nums, pivot + 1, end);\n    return nums;\n}\n</code></pre>\n\n<p>I have tried to pull the lambda function out and packaging into another static function, but the result is still the same.</p>\n\n<p>here is my another normal version, it was also used recursive style.</p>\n\n<pre><code>vector&lt;int&gt; QuickSort::exec(const vector&lt;int&gt; &amp;nums) {\n    if (nums.size() &lt; 2) {\n        return nums;\n    }\n    auto pivot = nums[0];\n    vector&lt;int&gt; smaller;\n    vector&lt;int&gt; greater;\n    for (auto i = 1; i &lt; nums.size(); ++i) {\n        int num = nums.at(i);\n        if (num &lt; pivot) {\n            smaller.push_back(num);\n        } else {\n            greater.push_back(num);\n        }\n    }\n    auto smaller_nums = exec(smaller);\n    auto greater_nums = exec(greater);\n    smaller_nums.push_back(pivot);\n    smaller_nums.insert(smaller_nums.end(), greater_nums.begin(), \n    greater_nums.end());\n    return smaller_nums;\n}\n</code></pre>\n\n<p>Ever Since I set amount like 1000, 10000, etc. The In-place began to slow down. For example, when the amount equal to 1000, the In-place spend 0.005356sec, but the normal version used 0.001464sec. when the amount reaches like 100k, the In-place version is about 50sec, but the normal version is about 0.5sec. Could someone tell me why\uff1f</p>\n\n<p>Sorry for any grammatical mistakes, English is not my native language.</p>\n"}, {"tags": ["c++", "windows", "visual-c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1562160332, "post_id": 56871207, "comment_id": 100291158, "body": "What kind of project did you chose when you created the project?"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1562160710, "post_id": 56871207, "comment_id": 100291414, "body": "Nathan&#39;s right: you&#39;re supplying WinMain and it&#39;s expecting to link in main. Note the instructions at the top of the file tell you to compile with <code>&#47;D_WINDOWS</code> and if you selected &#39;Win32 Console App&#39; for your project then you won&#39;t have <code>_WINDOWS</code>, you&#39;ll have <code>_CONSOLE</code> or similar. You can probably just change this in your project settings, probably under the preprocessor tab."}], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 10338287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010973d1ca809cd413c48f3008510c11?s=128&d=identicon&r=PG&f=1", "display_name": "SolidMercury", "link": "https://stackoverflow.com/users/10338287/solidmercury"}, "is_accepted": false, "score": 4, "last_activity_date": 1562163572, "creation_date": 1562163572, "answer_id": 56872188, "question_id": 56871207, "link": "https://stackoverflow.com/questions/56871207/lnk2019-unresolved-external-symbol-from-msvcrtd-lib/56872188#56872188", "title": "LNK2019 unresolved external symbol from MSVCRTD.lib", "body": "<p>/SUBSYSTEM:CONSOLE)\u00a0is for console based applications. You should define <code>main</code> function in code.</p>\n\n<p>/SUBSYSTEM:WINDOWS)\u00a0is for GUI applications. You should define\u00a0<code>WinMain</code> function</p>\n\n<p>You have selected the subsytem as CONSOLE and should be WINDOWS since you have WinMain and message handler.</p>\n\n<p>You can change it under project properties</p>\n\n<pre><code>Project&gt;Properties&gt;Linker&gt;System&gt;Subsystem\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11092629"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1562174617, "creation_date": 1562160199, "last_edit_date": 1562160360, "question_id": 56871207, "link": "https://stackoverflow.com/questions/56871207/lnk2019-unresolved-external-symbol-from-msvcrtd-lib", "title": "LNK2019 unresolved external symbol from MSVCRTD.lib", "body": "<p>I am new to C++ and still trying to learn it. I have some code i copied over from <a href=\"https://docs.microsoft.com/en-us/cpp/windows/walkthrough-creating-windows-desktop-applications-cpp?view=vs-2019\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>The thing is I follow the instructions very carefully, but still get errors even tough what I do, is exactly what they tell me to do, it doesn't work.</p>\n\n<pre><code>// HelloWindowsDesktop.cpp\n// compile with: /D_UNICODE /DUNICODE /DWIN32 /D_WINDOWS /c\n\n#include &lt;windows.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;tchar.h&gt;\n\n// Global variables\n\n// The main window class name.\nstatic TCHAR szWindowClass[] = _T(\"DesktopApp\");\n\n// The string that appears in the application's title bar.\nstatic TCHAR szTitle[] = _T(\"Windows Desktop Guided Tour Application\");\n\nHINSTANCE hInst;\n\n// Forward declarations of functions included in this code module:\nLRESULT CALLBACK WndProc(HWND, UINT, WPARAM, LPARAM);\n\nint CALLBACK WinMain(\n    _In_ HINSTANCE hInstance,\n    _In_ HINSTANCE hPrevInstance,\n    _In_ LPSTR     lpCmdLine,\n    _In_ int       nCmdShow\n)\n{\n    WNDCLASSEX wcex;\n\n    wcex.cbSize = sizeof(WNDCLASSEX);\n    wcex.style = CS_HREDRAW | CS_VREDRAW;\n    wcex.lpfnWndProc = WndProc;\n    wcex.cbClsExtra = 0;\n    wcex.cbWndExtra = 0;\n    wcex.hInstance = hInstance;\n    wcex.hIcon = LoadIcon(hInstance, IDI_APPLICATION);\n    wcex.hCursor = LoadCursor(NULL, IDC_ARROW);\n    wcex.hbrBackground = (HBRUSH)(COLOR_WINDOW + 1);\n    wcex.lpszMenuName = NULL;\n    wcex.lpszClassName = szWindowClass;\n    wcex.hIconSm = LoadIcon(wcex.hInstance, IDI_APPLICATION);\n\n    if (!RegisterClassEx(&amp;wcex))\n    {\n        MessageBox(NULL,\n            _T(\"Call to RegisterClassEx failed!\"),\n            _T(\"Windows Desktop Guided Tour\"),\n            NULL);\n\n        return 1;\n    }\n\n    // Store instance handle in our global variable\n    hInst = hInstance;\n\n    // The parameters to CreateWindow explained:\n    // szWindowClass: the name of the application\n    // szTitle: the text that appears in the title bar\n    // WS_OVERLAPPEDWINDOW: the type of window to create\n    // CW_USEDEFAULT, CW_USEDEFAULT: initial position (x, y)\n    // 500, 100: initial size (width, length)\n    // NULL: the parent of this window\n    // NULL: this application does not have a menu bar\n    // hInstance: the first parameter from WinMain\n    // NULL: not used in this application\n    HWND hWnd = CreateWindow(\n        szWindowClass,\n        szTitle,\n        WS_OVERLAPPEDWINDOW,\n        CW_USEDEFAULT, CW_USEDEFAULT,\n        500, 100,\n        NULL,\n        NULL,\n        hInstance,\n        NULL\n    );\n\n    if (!hWnd)\n    {\n        MessageBox(NULL,\n            _T(\"Call to CreateWindow failed!\"),\n            _T(\"Windows Desktop Guided Tour\"),\n            NULL);\n\n        return 1;\n    }\n\n    // The parameters to ShowWindow explained:\n    // hWnd: the value returned from CreateWindow\n    // nCmdShow: the fourth parameter from WinMain\n    ShowWindow(hWnd,\n        nCmdShow);\n    UpdateWindow(hWnd);\n\n    // Main message loop:\n    MSG msg;\n    while (GetMessage(&amp;msg, NULL, 0, 0))\n    {\n        TranslateMessage(&amp;msg);\n        DispatchMessage(&amp;msg);\n    }\n\n    return (int)msg.wParam;\n}\n\n//  FUNCTION: WndProc(HWND, UINT, WPARAM, LPARAM)\n//\n//  PURPOSE:  Processes messages for the main window.\n//\n//  WM_PAINT    - Paint the main window\n//  WM_DESTROY  - post a quit message and return\nLRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)\n{\n    PAINTSTRUCT ps;\n    HDC hdc;\n    TCHAR greeting[] = _T(\"Hello, Windows desktop!\");\n\n    switch (message)\n    {\n    case WM_PAINT:\n        hdc = BeginPaint(hWnd, &amp;ps);\n\n        // Here your application is laid out.\n        // For this introduction, we just print out \"Hello, Windows desktop!\"\n        // in the top left corner.\n        TextOut(hdc,\n            5, 5,\n            greeting, _tcslen(greeting));\n        // End application-specific layout section.\n\n        EndPaint(hWnd, &amp;ps);\n        break;\n    case WM_DESTROY:\n        PostQuitMessage(0);\n        break;\n    default:\n        return DefWindowProc(hWnd, message, wParam, lParam);\n        break;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>These are the errors:</p>\n\n<p>1st error:</p>\n\n<blockquote>\n  <p>Error  LNK2019 unresolved external symbol _main referenced in function \"int >__cdecl invoke_main(void)\" (?invoke_main@@YAHXZ)  Learn1  >C:\\Users\\user\\source\\repos\\Learn1\\Learn1\\MSVCRTD.lib(exe_main.obj) 1   </p>\n</blockquote>\n\n<p>2nd error:</p>\n\n<blockquote>\n  <p>Error  LNK1120 1 unresolved externals  Learn1  >C:\\Users\\user\\source\\repos\\Learn1\\Debug\\Learn1.exe 1   </p>\n</blockquote>\n\n<p>I suspect the second error follows after the first. So if the first is solved the second will be too.</p>\n"}, {"tags": ["c++", "function", "time", "std", "qnx"], "comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1562162102, "post_id": 56871199, "comment_id": 100292234, "body": "What is the value of errno?"}, {"owner": {"reputation": 31, "user_id": 11405557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd5ae1d4d2d6d9a9c02b47ecb8e8c27?s=128&d=identicon&r=PG&f=1", "display_name": "Holiday", "link": "https://stackoverflow.com/users/11405557/holiday"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1562163211, "post_id": 56871199, "comment_id": 100292825, "body": "@eerorika The value is 3"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1562163402, "post_id": 56871199, "comment_id": 100292921, "body": "What&#39;s the error message? Use <code>strerror</code>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1562163424, "post_id": 56871199, "comment_id": 100292936, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1562163964, "post_id": 56871199, "comment_id": 100293279, "body": "POSIX only stipulates that <code>mktime</code> <i>may</i> set <code>errno</code> on failure, not that it should. The QNX documentation does not mention it at all, while also claiming POSIX compliance, so it&#39;s possible that it&#39;s not set."}, {"owner": {"reputation": 31, "user_id": 11405557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd5ae1d4d2d6d9a9c02b47ecb8e8c27?s=128&d=identicon&r=PG&f=1", "display_name": "Holiday", "link": "https://stackoverflow.com/users/11405557/holiday"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1562164413, "post_id": 56871199, "comment_id": 100293561, "body": "@eerorika Error msg: No such process"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 11405557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd5ae1d4d2d6d9a9c02b47ecb8e8c27?s=128&d=identicon&r=PG&f=1", "display_name": "Holiday", "link": "https://stackoverflow.com/users/11405557/holiday"}, "is_accepted": true, "score": 0, "last_activity_date": 1562311387, "creation_date": 1562311387, "answer_id": 56898366, "question_id": 56871199, "link": "https://stackoverflow.com/questions/56871199/stdmktime-return-1-on-qnx/56898366#56898366", "title": "std::mktime return -1 on QNX", "body": "<p>On QNX device this problem was fixed by setting to tm structure tm_isdst = 1 and tm_zone (GMT)</p>\n\n<p>Unfortunately it broke my Ubuntu build (due to timezone, on my local PC it was EET).</p>\n\n<p>Replaced receiving seconds by boost::poxis_time</p>\n\n<pre><code>    struct tm date_tm;\n    std::memset( &amp;date_tm, 0, sizeof( date_tm ) );\n    strptime(token.c_str(), \"%d%m%y\", &amp;date_tm);\n\n    boost::posix_time::time_duration diff\n        = boost::posix_time::ptime( boost::gregorian::date_from_tm( date_tm ) )\n          - boost::posix_time::ptime( boost::gregorian::date( 1970, 1, 1 ) );\n\n    date = diff.ticks( ) / boost::posix_time::time_duration::rep_type::ticks_per_second;\n\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11405557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd5ae1d4d2d6d9a9c02b47ecb8e8c27?s=128&d=identicon&r=PG&f=1", "display_name": "Holiday", "link": "https://stackoverflow.com/users/11405557/holiday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 56898366, "answer_count": 1, "score": 3, "last_activity_date": 1562311387, "creation_date": 1562160174, "last_edit_date": 1562164949, "question_id": 56871199, "link": "https://stackoverflow.com/questions/56871199/stdmktime-return-1-on-qnx", "title": "std::mktime return -1 on QNX", "body": "<p>C++11</p>\n\n<p>Have a cross platform code with usage of std::mktime on Ununtu 18 (x64) and QNX (x64)</p>\n\n<p>On Ubuntu everything is ok. But on QNX mktime returns -1. errno = 3\nWhat's wrong?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"ctime\"\n\n\nint main(int argc, char *argv[]){\n\n    const std::string token = \"100901\";\n\n    std::string dd = token.substr( 0, 2 );\n    std::string mm = token.substr( 2, 2 );\n    std::string yy = token.substr( 4, 2 );\n\n    struct std::tm date_tm = {};\n\n    date_tm.tm_mday = std::stoi( dd);\n    date_tm.tm_mon = std::stoi( mm) - 1;\n    date_tm.tm_year = std::stoi( yy) + 100;\n\n    if (std::mktime( &amp;date_tm ) == -1);\n    {\n        std::cout &lt;&lt; \"Error\";\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>P.S. Tried init struct tm as:</p>\n\n<pre><code>struct std::tm date_tm = {0};\n\nstd::memset( &amp;date_tm, 0, sizeof( date_tm ) )\n\n</code></pre>\n\n<p>Some notes:</p>\n\n<p>1) if I call <strong>mktime</strong> twice - everything will be ok (will receive time)</p>\n\n<p>2) <strong>tm</strong> structure print</p>\n\n<pre><code>tm_gmtoff: 0\ntm_hour: 0\ntm_isdst: 0\ntm_mday: 10\ntm_min: 0\ntm_mon: 8\ntm_sec: 0\ntm_wday: 0\ntm_yday: 0\ntm_year: 101\n</code></pre>\n\n<p>Are there any other (easy and fast) ways to get time in seconds for my case?</p>\n"}, {"tags": ["c++", "makefile", "compilation", "point-cloud-library"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1562160170, "post_id": 56871139, "comment_id": 100291048, "body": "What errors are you getting, <i>exactly</i>? Also can you create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that replicates the errors, and show it to us? And preferably, from a clean build (with all object and executable files removed) please show the full output from running <code>make</code>."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1562160189, "post_id": 56871139, "comment_id": 100291059, "body": "And please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 1, "user_id": 11734401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a993dd145374b39f38334a20f2899058?s=128&d=identicon&r=PG&f=1", "display_name": "isurehatemakingusernames", "link": "https://stackoverflow.com/users/11734401/isurehatemakingusernames"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1562163311, "post_id": 56871139, "comment_id": 100292873, "body": "I was writing out a long edit with all the stuff you asked for but I fixed it. Thank you for your help even if it wasn&#39;t directly related! I really appreciate it!"}, {"owner": {"reputation": 1229, "user_id": 9226753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28247b27eef49240c767833514e2ab50?s=128&d=identicon&r=PG&f=1", "display_name": "kanstar", "link": "https://stackoverflow.com/users/9226753/kanstar"}, "edited": false, "score": 0, "creation_date": 1562182720, "post_id": 56871139, "comment_id": 100302394, "body": "Just a question: why are you not using CMake but write your own Makefile? If you used CMake, you could easily avoid most of the issues you are facing."}], "owner": {"reputation": 1, "user_id": 11734401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a993dd145374b39f38334a20f2899058?s=128&d=identicon&r=PG&f=1", "display_name": "isurehatemakingusernames", "link": "https://stackoverflow.com/users/11734401/isurehatemakingusernames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 368, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562163281, "creation_date": 1562159983, "last_edit_date": 1562163281, "question_id": 56871139, "link": "https://stackoverflow.com/questions/56871139/how-can-i-have-the-pcl-includes-in-my-header-file-without-it-throwing-a-no-such", "title": "How can I have the pcl includes in my header file without it throwing a &quot;No such file or directory error&quot;?", "body": "<p>I want to integrate pcl into some code that I inherited. However, unless I put the pcl includes in the main cpp file the compiler cannot find the library and returns the \"No such file or directory\" in response to the include files. It seems like a linking issue but I'm not totally sure. I'm running Ubuntu 16.04 if that matters.</p>\n\n<p>I have moved the include statements into the cpp and called libraries within pcl and it works fine. However, I really want to have the includes in the header so I can declare a class pointcloud and the like.\nWhen I move the includes into the header file at all I get the \"No such file or directory\" error.\nIf I try to have the include in the cpp file then declare in header I get \"'pcl' does not name a type\".\nI've also tried having the include as #include  but then when the header calls foo.h the first include in foo.h generates the \"No such file or directory\" error and I get sad again.\nIn the make file I've included the paths for pcl and eigen. I have also tried compiling with the header and that didn't work.\nBelow is my Makefile.</p>\n\n<pre><code>CAS_DIR := payloads/CAS\nCAS_INCLUDES    += -I/usr/local/include  -I. \n\nSENSOR_INCLUDES := -I/usr/local/include/pcl-1.8\nSENSOR_INCLUDES += -I/usr/local/include/eigen3\n\nLDLIBS      += -L/usr/local/lib -L. -L/usr/local/include \nLDFLAGS     += -lipcx -lmemx -lzmq -lrt -lusb-1.0 -ldl -pthread -lboost_system\n\nsensor.o: $(CAS_DIR)/sensor.cpp\n    $(CXX) $(CXXFLAGS) -c $&lt; $(CAS_INCLUDES) $(SENSOR_INCLUDES)\n\nCAS_exec.o: $(CAS_DIR)/CAS_exec.cpp\n    $(CXX) $(CXXFLAGS) -c $&lt; $(CAS_INCLUDES)\n</code></pre>\n\n<p>So in conclusion, I really just want to be able to compile with all my pcl includes in the header file or at least the ones that I need to declare class stuff. Right now the compiler doesn't like it at all. I figure it is some kind of linking error but I don't have the experience to really figure this one out. If any other code would be useful please let me know! Thank you for any help you can provide!</p>\n\n<p>EDIT:\nI figured it out. So CAS_exec was calling the sensor.h file but it wasn't getting the paths to pcl and eigen3 with that compilation call. I added that and it works!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 7481, "user_id": 2527795, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8359590ce3a66e5c58407ae5c83c9bbe?s=128&d=identicon&r=PG&f=1", "display_name": "vll", "link": "https://stackoverflow.com/users/2527795/vll"}, "edited": false, "score": 0, "creation_date": 1562159980, "post_id": 56871083, "comment_id": 100290919, "body": "Have you installed gsl on your computer?"}, {"owner": {"reputation": 7481, "user_id": 2527795, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8359590ce3a66e5c58407ae5c83c9bbe?s=128&d=identicon&r=PG&f=1", "display_name": "vll", "link": "https://stackoverflow.com/users/2527795/vll"}, "edited": false, "score": 0, "creation_date": 1562160057, "post_id": 56871083, "comment_id": 100290969, "body": "See also: <a href=\"https://www.gnu.org/software/gsl/doc/html/usage.html\" rel=\"nofollow noreferrer\">gnu.org/software/gsl/doc/html/usage.html</a>"}, {"owner": {"reputation": 21, "user_id": 10846475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f27eff4eeb50109ebd9d5e432abe7b8?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/10846475/lorenzo"}, "reply_to_user": {"reputation": 7481, "user_id": 2527795, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8359590ce3a66e5c58407ae5c83c9bbe?s=128&d=identicon&r=PG&f=1", "display_name": "vll", "link": "https://stackoverflow.com/users/2527795/vll"}, "edited": false, "score": 0, "creation_date": 1562160223, "post_id": 56871083, "comment_id": 100291081, "body": "Yes I have installed it. In fact I already use gsl on the single-thread version of my code."}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1562160269, "post_id": 56871083, "comment_id": 100291117, "body": "Can you build the single-thread version with g++-9? How exactly have you installed that? GCC has supported OpenMP for years: can you try your system g++ with -fopenmp? I&#39;d be surprised if it didn&#39;t support it."}, {"owner": {"reputation": 21, "user_id": 10846475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f27eff4eeb50109ebd9d5e432abe7b8?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/10846475/lorenzo"}, "edited": false, "score": 1, "creation_date": 1562160552, "post_id": 56871083, "comment_id": 100291286, "body": "I tried to do what you have suggested. The single-thread version does not compile with g++-9 because of the error that I get in the multi-thread version."}, {"owner": {"reputation": 21, "user_id": 10846475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f27eff4eeb50109ebd9d5e432abe7b8?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/10846475/lorenzo"}, "edited": false, "score": 0, "creation_date": 1562160666, "post_id": 56871083, "comment_id": 100291372, "body": "Then I tried to compile the multi-thread version but the following error appears: clang: error: unsupported option &#39;-fopenmp&#39;"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1562161371, "post_id": 56871083, "comment_id": 100291823, "body": "Oh, so your system compiler is LLVM not GCC? Is this a Mac? (Or if this is Linux, which distribution are you using?). I&#39;d guess then that your g++-9 is set to only link static libraries and you only have a dynamic version of libgsl, a .so not an .a, or vice versa; or it&#39;s rejecting the libgsl you&#39;ve provided because it&#39;s the wrong number of bits or something else. Do you get any more errors before &quot;library not found&quot; that might be relevant? Is the -L path to libgsl definitely correct, and it&#39;s not that the system compiler is finding the library somewhere else?"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1562161884, "post_id": 56871083, "comment_id": 100292115, "body": "D&#39;oh, I&#39;d missed that your -L is for wigxjpf not gsl. I&#39;d guess then that you&#39;ve installed libgsl in /usr/local, so the library is in /usr/local/lib? And for some reason your system compiler already has /usr/local/lib in its search path but g++-9 doesn&#39;t. Try adding a <code>-L &#47;usr&#47;local&#47;lib</code> just after <code>-L ~&#47;path_to_file&#47;wigxjpf-1.9&#47;lib&#47;</code>."}, {"owner": {"reputation": 21, "user_id": 10846475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f27eff4eeb50109ebd9d5e432abe7b8?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/10846475/lorenzo"}, "edited": false, "score": 0, "creation_date": 1562162488, "post_id": 56871083, "comment_id": 100292428, "body": "Thanks now it works! Yes I have a Mac and I added what you suggested me, and now it compiles."}], "owner": {"reputation": 21, "user_id": 10846475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f27eff4eeb50109ebd9d5e432abe7b8?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/10846475/lorenzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1562159838, "creation_date": 1562159838, "question_id": 56871083, "link": "https://stackoverflow.com/questions/56871083/how-to-correctly-link-libraries-when-compling-c", "title": "How to correctly link libraries when compling c++", "body": "<p>I have written a code in c++ that makes use of the wigxjpf-1.9 package for computing some Wigner Symbols. To compile the code I use g++ and I just type</p>\n\n<pre><code>g++ file_name.cpp -o my_file -I ~/path_to_file/wigxjpf-1.9/inc/ -I /usr/local/include -L ~/path_to_file/wigxjpf-1.9/lib/ -lwigxjpf -lm -lgsl -lgslcblas\n</code></pre>\n\n<p>and it works.</p>\n\n<p>Now I'm trying to modify it in such a way that it works in parallel. To do it I use openmp. My problem is that when I try to compile the file. I type </p>\n\n<pre><code>g++-9 -fopenmp file_name.cpp -o my_file -I ~/path_to_file/wigxjpf-1.9/inc/ -I /usr/local/include -L ~/path_to_file/wigxjpf-1.9/lib/ -lwigxjpf -lm -lgsl -lgslcblas\n</code></pre>\n\n<p>but now the following error appears:</p>\n\n<pre><code>ld: library not found for -lgsl\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Am I typing something wrong? </p>\n\n<p>Please tell me if more details are needed to answer my question.</p>\n"}, {"tags": ["c++", "pdf", "visual-c++", "mfc"], "comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 1, "creation_date": 1562158882, "post_id": 56870729, "comment_id": 100290183, "body": "When you paste this url to the browser, does it go to that location?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1562158965, "post_id": 56870729, "comment_id": 100290236, "body": "What <i>exactly</i> does <code>PathName</code> point to?"}, {"owner": {"reputation": 1, "user_id": 11734530, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9lD4WGuklkg/AAAAAAAAAAI/AAAAAAAAAAs/_P-a3ECLCIY/photo.jpg?sz=128", "display_name": "Linh Ly", "link": "https://stackoverflow.com/users/11734530/linh-ly"}, "reply_to_user": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1562159081, "post_id": 56870729, "comment_id": 100290320, "body": "@MichaelChourdakis It opens to the PDF and to the named destination. So yes"}, {"owner": {"reputation": 1, "user_id": 11734530, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9lD4WGuklkg/AAAAAAAAAAI/AAAAAAAAAAs/_P-a3ECLCIY/photo.jpg?sz=128", "display_name": "Linh Ly", "link": "https://stackoverflow.com/users/11734530/linh-ly"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1562159630, "post_id": 56870729, "comment_id": 100290678, "body": "@Jabberwocky file:///C:/Users/Linh.Ly/Documents/TestFile.pdf#nameddest=na&zwnj;&#8203;meddestination"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1562159967, "post_id": 56870729, "comment_id": 100290910, "body": "@LinhLy you should mention that in the question. You can <a href=\"https://stackoverflow.com/posts/56870729/edit\">edit</a>  your question."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 2, "creation_date": 1562160064, "post_id": 56870729, "comment_id": 100290976, "body": "What program is opening the PDF? Do you have any evidence that it supports this syntax?"}, {"owner": {"reputation": 1, "user_id": 11734530, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9lD4WGuklkg/AAAAAAAAAAI/AAAAAAAAAAs/_P-a3ECLCIY/photo.jpg?sz=128", "display_name": "Linh Ly", "link": "https://stackoverflow.com/users/11734530/linh-ly"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1562160212, "post_id": 56870729, "comment_id": 100291074, "body": "@DavidHeffernan Opening the PDF in a MFC application"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1562161872, "post_id": 56870729, "comment_id": 100292111, "body": "No. You are calling <code>ShellExecute</code> from your MFC application. What program is then responding to that shell verb and opening and displaying the PDF. Do you have any evidence that it supports this syntax?"}, {"owner": {"reputation": 1, "user_id": 11734530, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9lD4WGuklkg/AAAAAAAAAAI/AAAAAAAAAAs/_P-a3ECLCIY/photo.jpg?sz=128", "display_name": "Linh Ly", "link": "https://stackoverflow.com/users/11734530/linh-ly"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1562164164, "post_id": 56870729, "comment_id": 100293397, "body": "@DavidHeffernan Sorry, Adobe Acrobat Pro. I fixed the problem. ShellExecute(NULL, _T(&quot;open&quot;), &quot;Acrobat.exe&quot;, Parameters, NULL, SW_SHOWNORMAL);  I just had to put the parameters for the PDF pathname into there."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1562164816, "post_id": 56870729, "comment_id": 100293823, "body": "@LinhLy you can answer your own question"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 2, "creation_date": 1562169505, "post_id": 56870729, "comment_id": 100296471, "body": "What happens if the program runs on a machine that does not have Acrobat Pro installed on it?"}], "owner": {"reputation": 1, "user_id": 11734530, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9lD4WGuklkg/AAAAAAAAAAI/AAAAAAAAAAs/_P-a3ECLCIY/photo.jpg?sz=128", "display_name": "Linh Ly", "link": "https://stackoverflow.com/users/11734530/linh-ly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562160087, "creation_date": 1562158825, "last_edit_date": 1562160087, "question_id": 56870729, "link": "https://stackoverflow.com/questions/56870729/cant-programmatically-open-pdf-to-a-named-destination", "title": "Can&#39;t programmatically open PDF to a named destination", "body": "<p>I use <code>ShellExecute</code> to open up my PDF. <code>Pathname</code> has the URL to the PDF and <code>#nameddest=nameddestination</code> to specify the location to open to. However, every time I open the PDF with <code>ShellExcecute</code>, it only opens to the first page rather than the location of the <code>nameddestination</code>. </p>\n\n<pre><code>CString PathName = _T(\"file:///C:/Users/Linh.Ly/Documents/TestFile.pdf#nameddest=nameddestination\");\nShellExecute(NULL, _T(\"open\"), PathName, NULL, NULL, SW_SHOWNORMAL);\n</code></pre>\n"}, {"tags": ["c++", "c++11", "initialization"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1562158499, "post_id": 56870599, "comment_id": 100289892, "body": "Use a <code>std::vector</code>.  It has a constructor that you can provide a value for  the number of objects you want to create and an object to copy into all of those objects."}, {"owner": {"reputation": 754, "user_id": 2364686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/69c53d70693ec83d97351943187285ee?s=128&d=identicon&r=PG", "display_name": "ItsTimmy", "link": "https://stackoverflow.com/users/2364686/itstimmy"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562158793, "post_id": 56870599, "comment_id": 100290118, "body": "I am working in an environment where I want to minimize usage of dynamic memory allocation. Is there a way to get this functionality of <code>std::vector</code> without dynamic allocation?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1562158845, "post_id": 56870599, "comment_id": 100290153, "body": "You could write/get a stack allocator and use that as the allocator for the vector so it doesn&#39;t use the heap."}, {"owner": {"reputation": 1051, "user_id": 7192989, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d41f45e6cacfb3d4195a9878880724?s=128&d=identicon&r=PG", "display_name": "Rinat Veliakhmedov", "link": "https://stackoverflow.com/users/7192989/rinat-veliakhmedov"}, "edited": false, "score": 0, "creation_date": 1562158982, "post_id": 56870599, "comment_id": 100290243, "body": "Using initializer list this way implies that you want to initialize every member manually. If you want to initialize all elements to one value, loop over the elements and assign that value to them."}, {"owner": {"reputation": 754, "user_id": 2364686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/69c53d70693ec83d97351943187285ee?s=128&d=identicon&r=PG", "display_name": "ItsTimmy", "link": "https://stackoverflow.com/users/2364686/itstimmy"}, "reply_to_user": {"reputation": 1051, "user_id": 7192989, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d41f45e6cacfb3d4195a9878880724?s=128&d=identicon&r=PG", "display_name": "Rinat Veliakhmedov", "link": "https://stackoverflow.com/users/7192989/rinat-veliakhmedov"}, "edited": false, "score": 0, "creation_date": 1562159122, "post_id": 56870599, "comment_id": 100290356, "body": "@RinatVeliakhmedov Is this possible? I was under the impression that, because <code>Data</code> has no default constructor, I <i>must</i> initialize it in the initializer list."}, {"owner": {"reputation": 1051, "user_id": 7192989, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d41f45e6cacfb3d4195a9878880724?s=128&d=identicon&r=PG", "display_name": "Rinat Veliakhmedov", "link": "https://stackoverflow.com/users/7192989/rinat-veliakhmedov"}, "edited": false, "score": 1, "creation_date": 1562159193, "post_id": 56870599, "comment_id": 100290402, "body": "You literally have <code>Data()</code> there, that&#39;s what default constructor is. EDIT: you had it there before you edited that away, anyway."}, {"owner": {"reputation": 754, "user_id": 2364686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/69c53d70693ec83d97351943187285ee?s=128&d=identicon&r=PG", "display_name": "ItsTimmy", "link": "https://stackoverflow.com/users/2364686/itstimmy"}, "edited": false, "score": 0, "creation_date": 1562159256, "post_id": 56870599, "comment_id": 100290454, "body": "Yes, I just realized that I accidentally left the default constructor in. I have edited my question. Sorry for the confusion!"}], "answers": [{"comments": [{"owner": {"reputation": 754, "user_id": 2364686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/69c53d70693ec83d97351943187285ee?s=128&d=identicon&r=PG", "display_name": "ItsTimmy", "link": "https://stackoverflow.com/users/2364686/itstimmy"}, "edited": false, "score": 1, "creation_date": 1562159056, "post_id": 56870790, "comment_id": 100290302, "body": "<code>Data</code> does not have a default constructor."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 754, "user_id": 2364686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/69c53d70693ec83d97351943187285ee?s=128&d=identicon&r=PG", "display_name": "ItsTimmy", "link": "https://stackoverflow.com/users/2364686/itstimmy"}, "edited": false, "score": 0, "creation_date": 1562159094, "post_id": 56870790, "comment_id": 100290331, "body": "@ItsTimmy Oh. You should change the example accordingly."}, {"owner": {"reputation": 754, "user_id": 2364686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/69c53d70693ec83d97351943187285ee?s=128&d=identicon&r=PG", "display_name": "ItsTimmy", "link": "https://stackoverflow.com/users/2364686/itstimmy"}, "edited": false, "score": 0, "creation_date": 1562159177, "post_id": 56870790, "comment_id": 100290395, "body": "Oh I see, I accidentally left that default constructor in from when I was testing. Sorry about that!"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 754, "user_id": 2364686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/69c53d70693ec83d97351943187285ee?s=128&d=identicon&r=PG", "display_name": "ItsTimmy", "link": "https://stackoverflow.com/users/2364686/itstimmy"}, "edited": false, "score": 0, "creation_date": 1562159435, "post_id": 56870790, "comment_id": 100290557, "body": "@ItsTimmy I re-wrote the answer."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1562161072, "last_edit_date": 1562161072, "creation_date": 1562158995, "answer_id": 56870790, "question_id": 56870599, "link": "https://stackoverflow.com/questions/56870599/array-of-unknown-length-in-constructor-initializer-list/56870790#56870790", "title": "Array of unknown length in constructor initializer list", "body": "<p>A simple solution is to use <code>std::vector</code>. This obviously does has the downside of introducing dynamic allocation:</p>\n\n<pre><code>std::vector&lt;Data&gt; _member;\n\nDemoClass() : _member(CONSTANT, Data(0))\n</code></pre>\n\n<p>It <em>is</em> possible to do the same without dynamic allocation, if you use a member of raw character storage (with sufficient size and alignment), and construct the elements with placement-new. That's what vector does also. It's a bit complicated however:</p>\n\n<pre><code>class DemoClass {\nprivate:\n    std::aligned_storage_t&lt;sizeof(Data), alignof(Data)&gt; storage[CONSTANT];\npublic:\n    DemoClass()\n    {\n        std::uninitialized_fill(begin(), end(), Data(0));\n    }\n\n    Data* begin() {\n        return std::launder(reinterpret_cast&lt;Data*&gt;(std::begin(storage)));\n    }\n\n    Data* end() {\n        return std::launder(reinterpret_cast&lt;Data*&gt;(std::end(storage)));\n    }\n\n    ~DemoClass() {\n        for(Data&amp; d : *this)\n            d.~Data();\n    }\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "is_accepted": false, "score": 1, "last_activity_date": 1562159517, "last_edit_date": 1562159517, "creation_date": 1562159149, "answer_id": 56870840, "question_id": 56870599, "link": "https://stackoverflow.com/questions/56870599/array-of-unknown-length-in-constructor-initializer-list/56870840#56870840", "title": "Array of unknown length in constructor initializer list", "body": "<p>The way you wrote the example code, it is not straightforward because you have created 2 constructors on <code>Data</code>.</p>\n\n<p><em>However,</em> If you change <code>Data</code> to the following (bear in mind: this is just to avoid any confusion as to which constructor gets called - you didn't provide the full code):</p>\n\n<pre><code>class Data {\npublic:\n    Data(int number = 0){}\n};\n</code></pre>\n\n<p>Now you can just brace-initalize with an empty brace:</p>\n\n<pre><code>_member{ }\n</code></pre>\n\n<p>This will make sure all the members are initialized.</p>\n\n<p>Additional I would recommend using <code>std::array&lt;Data, CONSTANT&gt;</code> instead of the c array.</p>\n"}, {"comments": [{"owner": {"reputation": 754, "user_id": 2364686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/69c53d70693ec83d97351943187285ee?s=128&d=identicon&r=PG", "display_name": "ItsTimmy", "link": "https://stackoverflow.com/users/2364686/itstimmy"}, "edited": false, "score": 1, "creation_date": 1562166254, "post_id": 56871413, "comment_id": 100294744, "body": "I&#39;ve accepted this answer because it does answer my question as written. However, it really just tells me that I should just use a simpler solution, like finding a way to implement a default constructor on <code>Data</code>. Seeing all of these answers kind of made me realize why there&#39;s no simple one-line solution to initializing an array of objects without default constructors."}], "tags": [], "owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "is_accepted": true, "score": 3, "last_activity_date": 1562160885, "creation_date": 1562160885, "answer_id": 56871413, "question_id": 56870599, "link": "https://stackoverflow.com/questions/56870599/array-of-unknown-length-in-constructor-initializer-list/56871413#56871413", "title": "Array of unknown length in constructor initializer list", "body": "<p>I found the answer to your problem <a href=\"https://stackoverflow.com/a/36950796/4165552\">here</a>. So, in your case this solution should be applied like that:</p>\n\n<pre><code>#include &lt;utility&gt;\n#include &lt;array&gt;\n\n#define CONSTANT 2\n\nclass Data {\npublic:\n    Data(int number){}\n};\n\ntemplate&lt;typename T, size_t...Ix, typename... Args&gt;\nstd::array&lt;T, sizeof...(Ix)&gt; repeat(std::index_sequence&lt;Ix...&gt;, Args &amp;&amp;... args) {\n   return {{((void)Ix, T(args...))...}};\n}\n\ntemplate&lt;typename T, size_t N&gt;\nclass initialized_array: public std::array&lt;T, N&gt; {\npublic:\n    template&lt;typename... Args&gt;\n    initialized_array(Args &amp;&amp;... args)\n        : std::array&lt;T, N&gt;(repeat&lt;T&gt;(std::make_index_sequence&lt;N&gt;(), std::forward&lt;Args&gt;(args)...)) {}\n};\n\nclass DemoClass {\nprivate:\n    initialized_array&lt;Data, CONSTANT&gt; _member;\npublic:\n    DemoClass():\n        _member(1234)\n    {\n        // stuff\n    }\n};\n</code></pre>\n\n<p>Then your <code>_member</code> is statically allocated fixed size array. That approach is a bit complicated though, so maybe someone can provide a cleaner solution.</p>\n"}], "owner": {"reputation": 754, "user_id": 2364686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/69c53d70693ec83d97351943187285ee?s=128&d=identicon&r=PG", "display_name": "ItsTimmy", "link": "https://stackoverflow.com/users/2364686/itstimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 56871413, "answer_count": 3, "score": 2, "last_activity_date": 1562161220, "creation_date": 1562158302, "last_edit_date": 1562159147, "question_id": 56870599, "link": "https://stackoverflow.com/questions/56870599/array-of-unknown-length-in-constructor-initializer-list", "title": "Array of unknown length in constructor initializer list", "body": "<p>I have a class with a member array. The length is a constant, but this constant is not known until compile time (In my actual code, this constant is defined differently for different compilation targets). The type of the array is a class with no default constructor.</p>\n\n<pre><code>#define CONSTANT 2\n\nclass Data {\npublic:\n    Data(int number){}\n};\n\nclass DemoClass {\nprivate:\n    Data _member[CONSTANT];\npublic:\n    DemoClass():\n        _member{\n            Data(0),\n            Data(0)\n        }\n    {\n        // stuff\n    }\n};\n</code></pre>\n\n<p>In this example, I can set <code>_member</code> using the initializer list. However, if the value of <code>COSNTANT</code> changes, I have to change that initializer list.</p>\n\n<p>In theory, changing <code>DemoClass</code> to have a default constructor that calls the other constructor with an argument of <code>0</code> would work for my case, because I will always call the <code>Data</code> constructor with <code>0</code>. However, I cannot change <code>DemoClass</code> because it is in an external library.</p>\n\n<p>One solution I've considered is creating the following class:</p>\n\n<pre><code>class CustomData : public Data {\npublic:\n    CustomData() : Data(0){}\n};\n</code></pre>\n\n<p>This works, but it seems a bit complicated. Is there a simpler way to initialize this array?</p>\n"}, {"tags": ["c++", "visual-c++", "event-handling", "variadic-functions"], "comments": [{"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 3, "creation_date": 1562156435, "post_id": 56869969, "comment_id": 100288632, "body": "You can use C++11? In case: what about using modern C++ variadic template features instead of old C variadic functions?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1562156448, "post_id": 56869969, "comment_id": 100288638, "body": "Do you have to use the old school C variadic functions?  C++11&#39;s variadic templates make this a lot easier and type safe.  Oh wait, it&#39;s a virtual function.  That wont work since you can&#39;t have virtual function templates :("}, {"owner": {"reputation": 110, "user_id": 8895039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dedc08b840845552319f41cf89fbe75?s=128&d=identicon&r=PG", "display_name": "SleepyMode", "link": "https://stackoverflow.com/users/8895039/sleepymode"}, "edited": false, "score": 0, "creation_date": 1562156547, "post_id": 56869969, "comment_id": 100288688, "body": "I tried using C++11&#39;s variadic templates but I kind of fucked it up no matter how I tried doing it, so I thought it&#39;s not applicable. Perhaps I just made a mistake. And, yeah, the issue is the virtual function."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1562156754, "post_id": 56869969, "comment_id": 100288809, "body": "I strongly suggest to follows the variadic template way: maybe it&#39;s a little difficult at start (but less difficult than old C way, IMHO) but it&#39;s very, very powerful."}, {"owner": {"reputation": 110, "user_id": 8895039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dedc08b840845552319f41cf89fbe75?s=128&d=identicon&r=PG", "display_name": "SleepyMode", "link": "https://stackoverflow.com/users/8895039/sleepymode"}, "edited": false, "score": 0, "creation_date": 1562156816, "post_id": 56869969, "comment_id": 100288849, "body": "As I said, it&#39;s kind of impossible with the virtual functions standing in the way. There&#39;s no real way to depreciate them in this system I&#39;ve been making, unfortunately."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1562156820, "post_id": 56869969, "comment_id": 100288851, "body": "There are a number of approaches of solving the integration between templates and virtual functions. It&#39;s a broad topic that falls under the general category of type-erasure. By erasing the template type, in some form or fashion, it becomes possible to implement the templates via a virtual function call. Like I said, it&#39;s a rather broad topic. For more information, see your C++ book."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1562163252, "post_id": 56869969, "comment_id": 100292846, "body": "This is <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY problem</a>. If you describe how the API should be used I&#39;m sure in 5 minutes someone will provide you a nice and clean implementation with variadic template. Problem is we can&#39;t &quot;unwind&quot; what it suppose to do based on this C style code."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1562163457, "post_id": 56869969, "comment_id": 100292953, "body": "And problem with your code is that you didn&#39;t use <a href=\"https://en.cppreference.com/w/cpp/utility/variadic/va_start\" rel=\"nofollow noreferrer\">va_start</a> and without it <code>va_copy</code> can&#39;t work properly."}], "answers": [{"comments": [{"owner": {"reputation": 110, "user_id": 8895039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dedc08b840845552319f41cf89fbe75?s=128&d=identicon&r=PG", "display_name": "SleepyMode", "link": "https://stackoverflow.com/users/8895039/sleepymode"}, "edited": false, "score": 0, "creation_date": 1562322691, "post_id": 56878715, "comment_id": 100347660, "body": "I am keeping it as a namespace instead of making a class without V-table to just act as a &#39;static class&#39;. I also found Singletons to be quite a pain, which is why I went with this approach. It might be important to note I&#39;ve also been trying to keep away from the standard library as much as possible."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "reply_to_user": {"reputation": 110, "user_id": 8895039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dedc08b840845552319f41cf89fbe75?s=128&d=identicon&r=PG", "display_name": "SleepyMode", "link": "https://stackoverflow.com/users/8895039/sleepymode"}, "edited": false, "score": 0, "creation_date": 1562323309, "post_id": 56878715, "comment_id": 100347918, "body": "I&#39;ve fixed missing <code>va_end</code>, sadly you can&#39;t use RAII for it: <a href=\"https://stackoverflow.com/a/12142273/1387438\">stackoverflow.com/a/12142273/1387438</a>"}], "tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": true, "score": 1, "last_activity_date": 1562323300, "last_edit_date": 1562323300, "creation_date": 1562193422, "answer_id": 56878715, "question_id": 56869969, "link": "https://stackoverflow.com/questions/56869969/what-is-the-appropriate-way-to-pass-given-vararg-parameter-to-another-function/56878715#56878715", "title": "What is the appropriate way to pass given vararg parameter to another function?", "body": "<p>Fixing your code using <code>va_list</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct CHookData_t\n{\n    virtual ~CHookData_t() {}\n    virtual void Run(CHookReturn* ret, va_list arg) = 0;\n};\n\nnamespace Hook\n{\n    using HooksList = std::unordered_map&lt;\n         std::string, \n         std::unordered_map&lt;std::string, std::unique_ptr&lt;CHookData_t&gt;&gt;;\n\n    HooksList umHookList;\n    ...\n}\n\nstd::vector&lt;CHookReturn&gt; Hook::Run(const std::string&amp; eventName, ....)\n{\n    va_list valist;\n    va_start(valist, eventName);\n\n    auto result = Hook::RunVarg(eventName, valist);\n\n    va_end(valist);\n\n    return result;\n}\n\nstd::vector&lt;CHookReturn&gt; Hook::RunVarg(const std::string&amp; eventName, va_list arg)\n{\n    int count = Hook::Count(eventName);\n    std::vector&lt;CHookReturn&gt; returnValues(count);\n\n    size_t c = 0;\n    for (auto&amp; item : umHookList.at(eventName))\n    {\n        va_list arg_copy;\n        va_copy(arg_copy, arg);\n        item.second-&gt;Run(&amp;returnValues[c], arg_copy);\n        va_end(arg_copy);\n        ++c;\n    }\n\n    return returnValues;\n}\n</code></pre>\n\n<p>I have no idea what are arguments of <code>Hook::Run</code> what <code>va_list</code> points to, so I can't you provide nice C++ solution.</p>\n\n<p>Note that <code>va_copy</code> is needed inside of loop, since some compilers (don't remembered which, possibly msvc) <code>va_list</code> behaves like a pointer and reading arguments from it will have impact on each iteration. On other compilers <code>va_list</code> behaves like a value and <code>va_copy</code> do not change anything.</p>\n\n<p><strong>offtopic</strong>: your code is to much C, you shouldn't use <code>const char*</code> but <code>std::string</code> or <code>std::string_view</code> if you are using C++17, instead <code>va_args</code> it would be better to use variadic template or <code>std::initializer_list</code>, avoid raw pointers in favor of <code>std::unique_ptr</code> and <code>std::shared_ptr</code>. I've tweaked your code a bit to cover that.<br>\nAlso <code>Hook</code> should not be a <code>namespace</code>, by the look of functions and variables it contains it should be a class, so you should fix it too.</p>\n"}], "owner": {"reputation": 110, "user_id": 8895039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dedc08b840845552319f41cf89fbe75?s=128&d=identicon&r=PG", "display_name": "SleepyMode", "link": "https://stackoverflow.com/users/8895039/sleepymode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 56878715, "answer_count": 1, "score": 2, "last_activity_date": 1562323300, "creation_date": 1562156204, "question_id": 56869969, "link": "https://stackoverflow.com/questions/56869969/what-is-the-appropriate-way-to-pass-given-vararg-parameter-to-another-function", "title": "What is the appropriate way to pass given vararg parameter to another function?", "body": "<p>I've begun works on a hook/event system in C++. This system is supposed to handle all sorts of events as notified by other parts of the application.</p>\n\n<p>The issue I've faced is with the way I want it to run.\nGenerally, I want it to be so that you call a specific function with all arguments you wish to pass on, and then that function handles calling all registered hooks of that specific event, passing them on the arguments, retrieving their result values and returning it to the original caller.</p>\n\n<p>Generally, this is how it was supposed to look:</p>\n\n<pre><code>CHookReturn* bInitializationStatus = Hook::Run(\"Initialize\", gGame);\n</code></pre>\n\n<pre><code>CHookReturn* bThinkSuccessful = Hook::Run(\"Think\");\n</code></pre>\n\n<p><br>\n<br>\nHowever, I ran into one issue.\nI set it up in such way that the <code>Run</code> function in the Hook namespace, calling the Run function of the CHookData_t structure, needs to pass on varargs. I couldn't find any other way. This is how it ended up:</p>\n\n<pre><code>union CHookReturn\n{\n    const char* m_pszValue;\n    int m_iValue;\n    float m_flValue;\n    double m_dlValue;\n    bool m_bValue;\n};\n\nstruct CHookData_t\n{\n    virtual void Run(CHookReturn* ret, ...) = 0;\n};\n\nnamespace Hook\n{\n    std::unordered_map&lt;const char*, std::unordered_map&lt;const char*, CHookData_t*&gt;&gt; umHookList;\n\n    bool Add(const char*, const char*, CHookData_t*);\n    bool Exists(const char*, const char*);\n    bool Remove(const char*, const char*);\n    int Count(const char*);\n    CHookReturn* Run(const char*, ...);\n};\n</code></pre>\n\n<p>CPP file segment of the Hook::Run function:</p>\n\n<pre><code>CHookReturn* Hook::Run(const char* eventName, ...)\n{\n    // FIXME: Look into alternative execution.\n    // This code seems more like a workaround\n    // than what I originally wanted it to be.\n\n    int count = Hook::Count(eventName);\n    CHookReturn* returnValues = new CHookReturn[count];\n    int c = 0;\n\n    unordered_map&lt;const char*, CHookData_t*&gt;::iterator itr;\n    unordered_map&lt;const char*, CHookData_t*&gt; res;\n    res = umHookList.at(eventName);\n\n    va_list valist;\n    void* args;\n    va_copy(args, valist);\n\n    for (itr = res.begin(); itr != res.end(); itr++)\n    {\n        CHookReturn returnData;\n        itr-&gt;second-&gt;Run(&amp;returnData, args);\n\n        returnValues[c] = returnData;\n        ++c;\n    }\n\n    return returnValues;\n}\n</code></pre>\n\n<p>The above code brings up two warnings which make me question if it is a good idea to execute it in this way, as well as whether there are any alternatives I should look into.</p>\n\n<p>The warnings I received were:<br>\n<code>Warning    C6001   Using uninitialized memory 'valist'.</code><br>\n<code>Warning    C6386   Buffer overrun while writing to 'returnValues':  the writable size is 'count*8' bytes, but '16' bytes might be written.</code></p>\n\n<p>Is there a better way to do this?</p>\n"}, {"tags": ["c++", "memory", "crash", "release", "dump"], "comments": [{"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 3, "creation_date": 1562155950, "post_id": 56869840, "comment_id": 100288314, "body": "What does Context:DbInstance() return? If the answer is a temp var, that would cause a crash. The code you have provided are just declarations and class, where does this get invoked from?"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1562155954, "post_id": 56869840, "comment_id": 100288320, "body": "Can you add <code>Context::DbInstance()</code> and <code>main</code> which produces the crash?"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1562156026, "post_id": 56869840, "comment_id": 100288365, "body": "When crash happens find window &quot;call stack&quot;. It will show trace how code reached point of crash. Click each position in this window and analyze the code each item on this list refers to. Currently you didn&#39;t provide enough information to solve your issue."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1562156153, "post_id": 56869840, "comment_id": 100288446, "body": "The temporary variable is the likely reason for the class, but besides that, you are most definitely required to have &quot;access to a debugger&quot; in order to develop in C++. Full stop. If you do not have a debugger, or don&#39;t know how to use one, you will not be able to accomplish much of anything, with C++."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 3, "creation_date": 1562157133, "post_id": 56869840, "comment_id": 100289037, "body": "Just a minor point: <code>class Dummy {};          &#47;&#47; 1 bytes, does not crash.</code> You aren&#39;t adding a new data member here, you&#39;re just defining a class. That doesn&#39;t take up any space."}, {"owner": {"reputation": 1563, "user_id": 388664, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ad91154eadd39e04c882615b75fc06d?s=128&d=identicon&r=PG", "display_name": "Nikola Male\u0161evi\u0107", "link": "https://stackoverflow.com/users/388664/nikola-male%c5%a1evi%c4%87"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1562157604, "post_id": 56869840, "comment_id": 100289318, "body": "@SamVarshavchik As soon as I attach the debugger, the crash does not happen, meaning I cannot use the debugger."}, {"owner": {"reputation": 1563, "user_id": 388664, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ad91154eadd39e04c882615b75fc06d?s=128&d=identicon&r=PG", "display_name": "Nikola Male\u0161evi\u0107", "link": "https://stackoverflow.com/users/388664/nikola-male%c5%a1evi%c4%87"}, "reply_to_user": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1562157696, "post_id": 56869840, "comment_id": 100289372, "body": "@Mansoor Context::DbInstance() does not return temp var, that object is valid throughout runtime. It is a singleton class."}, {"owner": {"reputation": 1563, "user_id": 388664, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ad91154eadd39e04c882615b75fc06d?s=128&d=identicon&r=PG", "display_name": "Nikola Male\u0161evi\u0107", "link": "https://stackoverflow.com/users/388664/nikola-male%c5%a1evi%c4%87"}, "edited": false, "score": 0, "creation_date": 1562157803, "post_id": 56869840, "comment_id": 100289442, "body": "Please do not mark for closure if I have failed to explain the problem enough, but let me know what kind of information would be useful instead."}, {"owner": {"reputation": 1563, "user_id": 388664, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ad91154eadd39e04c882615b75fc06d?s=128&d=identicon&r=PG", "display_name": "Nikola Male\u0161evi\u0107", "link": "https://stackoverflow.com/users/388664/nikola-male%c5%a1evi%c4%87"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1562157940, "post_id": 56869840, "comment_id": 100289537, "body": "@Kevin Not according to this: <a href=\"https://stackoverflow.com/questions/2362097/why-is-the-size-of-an-empty-class-in-c-not-zero\" title=\"why is the size of an empty class in c not zero\">stackoverflow.com/questions/2362097/&hellip;</a>"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1562158268, "post_id": 56869840, "comment_id": 100289754, "body": "@NikolaMale\u0161evi\u0107 Just because the class has a size, doesn&#39;t mean that it&#39;s existence uses any storage. It is usually the instances of the class that use storage. A nested class never increases the size of the outer class."}, {"owner": {"reputation": 1563, "user_id": 388664, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ad91154eadd39e04c882615b75fc06d?s=128&d=identicon&r=PG", "display_name": "Nikola Male\u0161evi\u0107", "link": "https://stackoverflow.com/users/388664/nikola-male%c5%a1evi%c4%87"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1562158791, "post_id": 56869840, "comment_id": 100290112, "body": "@eerorika Point taken. Thanks to both you and Kevin."}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 1, "creation_date": 1562161558, "post_id": 56869840, "comment_id": 100291930, "body": "The symptoms you describe suggest (to me at least) that the dll and the client code might not be seeing/using the same class definition for <code>Middle</code>.  Are you sure both client and dll are rebuilt correctly after the changes are made and that you are loading the correct dll?"}, {"owner": {"reputation": 1563, "user_id": 388664, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ad91154eadd39e04c882615b75fc06d?s=128&d=identicon&r=PG", "display_name": "Nikola Male\u0161evi\u0107", "link": "https://stackoverflow.com/users/388664/nikola-male%c5%a1evi%c4%87"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1562161801, "post_id": 56869840, "comment_id": 100292069, "body": "@G.M. Yes, I am sure about that everything is built correctly. The issue happens after a full clean rebuild of the whole software package."}], "answers": [{"comments": [{"owner": {"reputation": 1563, "user_id": 388664, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ad91154eadd39e04c882615b75fc06d?s=128&d=identicon&r=PG", "display_name": "Nikola Male\u0161evi\u0107", "link": "https://stackoverflow.com/users/388664/nikola-male%c5%a1evi%c4%87"}, "edited": false, "score": 0, "creation_date": 1562158204, "post_id": 56870096, "comment_id": 100289714, "body": "Without posting the entire codebase, I just cannot reproduce it - I have tried. You may be right about copying, however, the behaviour is exactly the same even if I initialize the value of one of those variables in the constructor."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 1563, "user_id": 388664, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ad91154eadd39e04c882615b75fc06d?s=128&d=identicon&r=PG", "display_name": "Nikola Male\u0161evi\u0107", "link": "https://stackoverflow.com/users/388664/nikola-male%c5%a1evi%c4%87"}, "edited": false, "score": 0, "creation_date": 1562158514, "post_id": 56870096, "comment_id": 100289901, "body": "@NikolaMale\u0161evi\u0107 Well, at least we&#39;ve solved one bug. Unfortunate that it wasn&#39;t the one that caused the crash."}, {"owner": {"reputation": 1563, "user_id": 388664, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ad91154eadd39e04c882615b75fc06d?s=128&d=identicon&r=PG", "display_name": "Nikola Male\u0161evi\u0107", "link": "https://stackoverflow.com/users/388664/nikola-male%c5%a1evi%c4%87"}, "edited": false, "score": 0, "creation_date": 1562158721, "post_id": 56870096, "comment_id": 100290051, "body": "That was not the bug, actually, the value of <code>_careTaker</code> (the original pointer in the code) was initialized from the get-go. The reason I have removed that info is to try to have a minimum class description that would cause the crash - only defining a variable at a specific place without ever accessing it is causing the crash."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1562156645, "creation_date": 1562156645, "answer_id": 56870096, "question_id": 56869840, "link": "https://stackoverflow.com/questions/56869840/defining-a-pointer-randomly-crashes-the-program/56870096#56870096", "title": "Defining a pointer randomly crashes the program", "body": "<p>You haven't provided a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a> , so this is based on some speculation, but I assume that at some point you make a copy either implicitly or explicitly.</p>\n\n<p>All of the three crash causing members are trivially constructible. Since you don't initialise them in the constructor, they are left with an indeterminate value (assuming non static storage).</p>\n\n<p>When you copy such object, the values of the members are read. Behaviour of reading an indeterminate value (of these types) is undefined. When behaviour is undefined, the program may crash. </p>\n"}, {"tags": [], "owner": {"reputation": 1563, "user_id": 388664, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ad91154eadd39e04c882615b75fc06d?s=128&d=identicon&r=PG", "display_name": "Nikola Male\u0161evi\u0107", "link": "https://stackoverflow.com/users/388664/nikola-male%c5%a1evi%c4%87"}, "is_accepted": true, "score": 0, "last_activity_date": 1562681344, "creation_date": 1562681344, "answer_id": 56954483, "question_id": 56869840, "link": "https://stackoverflow.com/questions/56869840/defining-a-pointer-randomly-crashes-the-program/56954483#56954483", "title": "Defining a pointer randomly crashes the program", "body": "<p>The issue was that there were two separate sets of <code>Derived.h</code>/<code>Derived.cpp</code> files. One of them was outdated and left lingering around, forever forgotten.</p>\n\n<p>The set I have been working on was included in the C++ project itself, but source file which was including the actual header file was using the old path.</p>\n\n<p>This resulted in discrepancy between h and cpp files, resulting in heap corruption due to different memory signatures of header file included in the project and header file actually included by one of the cpp files in the project.</p>\n\n<p>Quite a lot of debugging and headaches solved by one-line <code>#include</code> path change.</p>\n"}], "owner": {"reputation": 1563, "user_id": 388664, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ad91154eadd39e04c882615b75fc06d?s=128&d=identicon&r=PG", "display_name": "Nikola Male\u0161evi\u0107", "link": "https://stackoverflow.com/users/388664/nikola-male%c5%a1evi%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 56954483, "answer_count": 2, "score": -2, "last_activity_date": 1562681344, "creation_date": 1562155733, "last_edit_date": 1562157507, "question_id": 56869840, "link": "https://stackoverflow.com/questions/56869840/defining-a-pointer-randomly-crashes-the-program", "title": "Defining a pointer randomly crashes the program", "body": "<p>Defining a variable in a class causes a random crash during the execution of the application.</p>\n\n<p>The crash does not appear in debug mode, it only happens in release build.</p>\n\n<p>It also happens in various point of execution. I am outputing logs every now and then during execution, and they will differ from time to time.</p>\n\n<p>The class in question is the middle one in the inheritance chain:</p>\n\n<pre><code>class Base\n{\npublic:\n    virtual ~BaseClass() { }\n\n    // Quite a few virtual methods declared here.\n};\n\nclass Middle : public Base\n{\npublic:\n    virtual ~Middle() { }\n\nprotected:\n    Middle(const std::string&amp; name)\n        : _name(name)\n        , _db(Context::DbInstance())\n    {\n    }\n\n    /**\n     * Commenting out any of the following crashes or does not.\n     */\n    // CareTaker* _careTaker;   // 4 bytes, crashes.\n    // void* dummy;             // 4 bytes, crashes.\n    // int dummy;               // 4 bytes, crashes.\n    // short dummy;             // 2 bytes, crashes.\n    // class Dummy {};          // 1 bytes, does not crash.\n    //                          // 0 bytes, member removed, does not crash.\n    std::string _name;\n    // Crash also happens/does not if a variable described above put here.\n    Database&amp; _db;\n    // But not if it is here. Variable of any size is OK here.\n};\n\nclass Derived : public Middle\n{\npublic:\n    Derived() : Middle(\"Foo\") { }\n    virtual ~Derived() { }\n\n    // Some virtual methods from Base overriden here.\n};\n</code></pre>\n\n<p><strong>In a nutshell, if a variable of size 2 or more comes before <code>Database&amp; _db</code> definition, the crashes will happen. If it comes afterwards, they will not.</strong></p>\n\n<p>How would I go about to try to solve the crash without having access to a debugger in this scenario?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>The class is used in the initializer method run after a DLL is loaded. I cannot give more details than this, unfortunately.</p>\n\n<pre><code>int DllInitializer()\n{\n    // Complex code.\n\n    DbPlugger::instance().addPlug(new Derived());\n\n    // Complex code.\n}\n</code></pre>\n"}, {"tags": ["c++", "xml", "curl", "gsoap"], "comments": [{"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1562156114, "post_id": 56869836, "comment_id": 100288416, "body": "Are you sure that curl is enough  for the SOAP ? I think that you need a SOAP framework like <a href=\"http://axis.apache.org/axis2/c/core/\" rel=\"nofollow noreferrer\">Apache Axis2 for C</a> for example."}, {"owner": {"reputation": 39, "user_id": 10432574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6bd37cb933247780c96faa890c8f043?s=128&d=identicon&r=PG&f=1", "display_name": "raj", "link": "https://stackoverflow.com/users/10432574/raj"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1562159973, "post_id": 56869836, "comment_id": 100290914, "body": "Thanks for replying, in PHP  i am able to send  soap request to soap service, so like that i am trying to implement in c++ using libcurl."}, {"owner": {"reputation": 39, "user_id": 10432574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6bd37cb933247780c96faa890c8f043?s=128&d=identicon&r=PG&f=1", "display_name": "raj", "link": "https://stackoverflow.com/users/10432574/raj"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1562160048, "post_id": 56869836, "comment_id": 100290964, "body": "Actually i don&#39;t have much more idea about curl related to soap service."}, {"owner": {"reputation": 1359, "user_id": 918860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864a0d3b9707a632fd69a9f1c31e1824?s=128&d=identicon&r=PG&f=1", "display_name": "Dr. Alex RE", "link": "https://stackoverflow.com/users/918860/dr-alex-re"}, "edited": false, "score": 0, "creation_date": 1562171539, "post_id": 56869836, "comment_id": 100297476, "body": "Two things appear missing. 1) the HTTP content-type header should be &quot;text/xml; charset=utf-8&quot; (SOAP1.1) or &quot;application/soap+xml; charset=utf-8&quot; (SOAP1.2). And 2) most soap services require a SOAPAction HTTP header, which is specified in the WSDL file that defines the service. Why aren&#39;t you using a soap framework such as gsoap that works with cURL? That saves you a lot of time because it generates the code for you and handles the transport details automatically. See <a href=\"https://www.genivia.com/examples/curl/index.html\" rel=\"nofollow noreferrer\">genivia.com/examples/curl/index.html</a>"}, {"owner": {"reputation": 39, "user_id": 10432574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6bd37cb933247780c96faa890c8f043?s=128&d=identicon&r=PG&f=1", "display_name": "raj", "link": "https://stackoverflow.com/users/10432574/raj"}, "edited": false, "score": 0, "creation_date": 1562218257, "post_id": 56869836, "comment_id": 100310282, "body": "Thanks for replying, According to your suggestion , i have changed header content type,but when i have changed content-type header to  application/soap+xml; charset=utf-8&quot; after that i am getting error like &quot;  Cannot process the message because the content type &#39;application/soap+xml; charset=utf-8&#39; was not the expected type &#39;text/xml; charset=utf-8 &quot; .  For gsoap framework, i don&#39;t want to depend upon client based application, it should be run individual."}], "owner": {"reputation": 39, "user_id": 10432574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6bd37cb933247780c96faa890c8f043?s=128&d=identicon&r=PG&f=1", "display_name": "raj", "link": "https://stackoverflow.com/users/10432574/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562155714, "creation_date": 1562155714, "question_id": 56869836, "link": "https://stackoverflow.com/questions/56869836/how-to-send-soapxml-request-using-libcurl", "title": "How to send soap(xml) request using libcurl", "body": "<p>I am trying to send a SOAP request in xml format to a SOAP service using libcurl but i am getting error like\" 500 internal server error\" while posting the request in soap service.</p>\n\n<p>I have tried almost all the approaches available online.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;curl/curl.h&gt;\nint main()\n{\n    FILE * wfp = fopen(\"res.xml\", \"w+\"); //File pointer to write the soap response\n    if (!wfp) {\n        perror(\"Write File Open:\");\n        //        exit(0);\n    }\n\n    struct curl_slist *header = NULL;\n    header = curl_slist_append(header, \"Content-type: text/xml; charset=utf-8\");\n    header = curl_slist_append(header, \"SOAPAction: http://localhost:62634/Service1.svc\");\n    header = curl_slist_append(header, \"Transfer-Encoding: chunked\");\n    header = curl_slist_append(header, \"Expect:\");\n    CURL *curl;\n    CURLcode res;\n\n    curl = curl_easy_init();\n    if (curl) {\n        curl_easy_setopt(curl, CURLOPT_URL, \"http://localhost:62634/Service1.svc\");\n        curl_easy_setopt(curl, CURLOPT_POSTFIELDS, \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;&lt;soapenv:Envelope xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\" xmlns:soapenv=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\" xmlns:AddNumbers=\\\"http://localhost:62634/Service1.svc\\\"&gt;&lt;soapenv:Header/&gt;&lt;soapenv:Body&gt;&lt;AddNumbers xmlns=\\\"http://tempuri.org/\\\"&gt;&lt;number1&gt;4&lt;/number1&gt;&lt;number2&gt;5&lt;/number2&gt;&lt;/AddNumbers&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;\");\n\n        curl_easy_setopt(curl, CURLOPT_VERBOSE, 1L);\n        curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_data);  //Gets data to be written to file\n        curl_easy_setopt(curl, CURLOPT_WRITEDATA, wfp);  //Writes result to file\n        curl_easy_setopt(curl, CURLOPT_HTTPHEADER, header);\n        curl_easy_setopt(curl, CURLOPT_POSTFIELDSIZE_LARGE, (curl_off_t)-1);\n        //curl_easy_setopt(curl, CURLOPT_CUSTOMREQUEST, \"POST\");\n\n        res = curl_easy_perform(curl);\n\n        curl_easy_cleanup(curl);\n\n        return 1;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "pointers", "utf-16"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1562155406, "post_id": 56869621, "comment_id": 100287957, "body": "The return value from <code>XWF_GetMetadataEx</code> is <code>LPVOID</code>? Is it null terminated? If so, you can copy the string into <code>pointerToMetaData</code> with <a href=\"https://en.cppreference.com/w/c/string/wide/wcsncpy\" rel=\"nofollow noreferrer\"><code>wcsncpy, wcsncpy_s</code></a>. However, there are other issues...."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1562155837, "post_id": 56869621, "comment_id": 100288237, "body": "You probbaly want this: <code>WCHAR MetaData[1024]; wcsncpy(MetaData, (WCHAR*)XWF_GetMetadataEx(hItem, 0), 1024);</code> but it&#39;s hard to tell without more information. Also the specification <i>&quot;...UTF-16 plain text or null-terminated ASCII HTML code&quot;</i> is very strange but at least unclear. You need to grasp at least the basics of pointers, otherwise you&#39;ll have a hard time modifying this piece of software."}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 1, "creation_date": 1562155909, "post_id": 56869621, "comment_id": 100288290, "body": "<code>WCHAR* pointerToMetaData[1024] = (WCHAR[]*) XWF_GetMetadataEx(hItem, 0);</code> That line seems incorrect. LPVOID is not an array of pointers. <code>WCHAR* pointerToMetaData[1024]</code> Is an array of pointers."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1562355858, "last_edit_date": 1562355858, "creation_date": 1562355543, "answer_id": 56908465, "question_id": 56869621, "link": "https://stackoverflow.com/questions/56869621/working-with-a-pointer-to-a-buffer-filled-with-utf-16-plain-text/56908465#56908465", "title": "working with a pointer to a buffer filled with utf 16 plain text", "body": "<p><code>XWF_GetMetadataEx()</code> returns an <code>LPVOID</code> (aka <code>void*</code>) because it can return one of two different data formats: UTF-16 plain text (handled with <code>wchar_t*</code>) or ASCII HTML (handled with <code>char*</code>).  Per the <a href=\"https://www.x-ways.net/forensics/x-tensions/XWF_functions.html\" rel=\"nofollow noreferrer\">documentation</a> for <code>XWF_GetMetadataEx()</code>:</p>\n\n<blockquote>\n  <pre class=\"lang-c prettyprint-override\"><code>LPVOID XWF_GetMetadataEx(\n  HANDLE hItem,\n  PDWORD lpnFlags\n);    \n</code></pre>\n  \n  <p>Available in v18.9 and later. Can extract extensive internal metadata of files of various types, exactly as seen in Details mode in X-Ways Forensics, typically much more than GetMetadata. Fills a memory buffer with either null-terminated UTF-16 plain text or null-terminated ASCII HTML code, and returns a pointer to it. You may parse the buffer to retrieve specific metadata that you need. The format may theoretically change from one version to the other. You must release the allocated memory by passing that pointer to XWF_ReleaseMem when you do not need it any more. If no metadata is extracted, the return value is NULL instead.</p>\n  \n  <p>Unlike XWF_GetMetadata, this function is thread-safe. Unlike XWF_GetExtractedMetadata, the file must have been opened with XWF_OpenItem because this function reads from the file contents, not from data stored in the volume snapshot. The metadata is taken from the very file that contains it, for example in the case of zip-style Office documents from the XML files.</p>\n  \n  <p><strong><code>lpnFlags</code> points to flags for input and output. The only currently defined input flag is 0x01. It tells X-Ways Forensics to extract only a subset of the available metadata, as shown in the software in the Metadata column. The resulting buffer currently contains always UTF-16 plain text. If the flag is not set, the complete metadata as seen in Details mode is extracted. The resulting buffer can be of either above-mentioned formats.</strong></p>\n  \n  <p><strong>The only currently defined output flag is 0x01 (indicating, if set, that the resulting buffer is HTML-formatted ASCII instead of UTF-16 plain text). If any of the 8 highest bits are set, you should not touch the resulting buffer, just release it with XWF_ReleaseMem. The output flags are valid only if the function was successful, i.e. if it has returned a pointer.</strong></p>\n</blockquote>\n\n<p>So, you need to either:</p>\n\n<ol>\n<li><p>explicitly request the desired output format and cast to that specific type:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>DWORD flags = 1; // &lt;-- want UTF-16 only\nwchar_t *Utf16PlainTextMetaData = (wchar_t*) XWF_GetMetadataEx(hItem, &amp;flags);\nif (Utf16PlainTextMetaData)\n{\n    if ((flags &amp; 0xFF000000) == 0) // is the buffer usable?\n    {\n        // use Utf16PlainTextMetaData as needed...\n    }\n\n    XWF_ReleaseMem(Utf16PlainTextMetaData);\n}\n</code></pre></li>\n<li><p>detect which format is being output and then cast accordingly:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>DWORD flags = 0; // &lt;-- want either format\nLPVOID pointerToMetaData = XWF_GetMetadataEx(hItem, &amp;flags);\nif (pointerToMetaData)\n{\n    if ((flags &amp; 0xFF000000) == 0) // is the buffer usable?\n    {\n        if (flags &amp; 1)\n        {\n            char *HtmlAsciiMetaData = (char*) pointerToMetaData;\n            // use HtmlAsciiMetaData as needed...\n        }\n        else\n        {\n            wchar_t *Utf16PlainTextMetaData = (wchar_t*) pointerToMetaData;\n            // use Utf16PlainTextMetaData as needed...\n        }\n    }\n\n    XWF_ReleaseMem(pointerToMetaData);\n}\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 7, "user_id": 9857571, "user_type": "registered", "profile_image": "https://graph.facebook.com/1652004391501438/picture?type=large", "display_name": "Marcus Stelzer", "link": "https://stackoverflow.com/users/9857571/marcus-stelzer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562355858, "creation_date": 1562155012, "last_edit_date": 1562155164, "question_id": 56869621, "link": "https://stackoverflow.com/questions/56869621/working-with-a-pointer-to-a-buffer-filled-with-utf-16-plain-text", "title": "working with a pointer to a buffer filled with utf 16 plain text", "body": "<p>got some problem while working on a c++ project.\ni got a function from a framework which fills a \"memory buffer with either null-terminated UTF-16 plain text or null-terminated ASCII HTML code, and returns a pointer to it\"(info from documentation).</p>\n\n<p>i am not so familiar with the pointer topic so i tried to do something like this:</p>\n\n<pre><code>WCHAR* pointerToMetaData[1024] = (WCHAR[]*) XWF_GetMetadataEx(hItem, 0);\ncurrentFile.metaData = *pointerToMetaData;\n</code></pre>\n\n<p>i know that the return value is a LPVOID so i have to convert the return value to the correct datatype...but sadly this works not quite qell...</p>\n\n<p>maybe some more confident user could help me solving this problem?!</p>\n"}, {"tags": ["c++", "opencv", "camera", "zbar", "pose-estimation"], "comments": [{"owner": {"reputation": 9770, "user_id": 888688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e1a439c266dcf5015373dbeae410ff5?s=128&d=identicon&r=PG", "display_name": "api55", "link": "https://stackoverflow.com/users/888688/api55"}, "edited": false, "score": 1, "creation_date": 1562155438, "post_id": 56869579, "comment_id": 100287979, "body": "two image points? AFAIK it should be at least 4 points for most of the PnP algorithms (I think one of them accepts 3). Read the <a href=\"https://docs.opencv.org/3.4.6/d9/d0c/group__calib3d.html#ga549c2075fac14829ff4a58bc931c033d\" rel=\"nofollow noreferrer\">note</a> to see the points needed"}], "answers": [{"tags": [], "owner": {"reputation": 607, "user_id": 9540764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYKdE.jpg?s=128&g=1", "display_name": "User", "link": "https://stackoverflow.com/users/9540764/user"}, "is_accepted": true, "score": 1, "last_activity_date": 1562157823, "creation_date": 1562157823, "answer_id": 56870452, "question_id": 56869579, "link": "https://stackoverflow.com/questions/56869579/opencv-solvepnp-method-returns-nan-values/56870452#56870452", "title": "OpenCV solvePnP method returns NaN values", "body": "<p>As api55 said in his comment the problem was the number of points. Adding the other 2 corners worked.</p>\n"}], "owner": {"reputation": 607, "user_id": 9540764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYKdE.jpg?s=128&g=1", "display_name": "User", "link": "https://stackoverflow.com/users/9540764/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 56870452, "answer_count": 1, "score": 1, "last_activity_date": 1562157823, "creation_date": 1562154891, "question_id": 56869579, "link": "https://stackoverflow.com/questions/56869579/opencv-solvepnp-method-returns-nan-values", "title": "OpenCV solvePnP method returns NaN values", "body": "<p>I'm doing barcode detection using <code>zbar</code> library with <code>opencv</code> in C++. The barcode detection is working good and I'm getting results like that</p>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/lzJVR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lzJVR.png\" alt=\"result\"></a></p>\n\n<hr>\n\n<p>Now I want to use <code>cv::solvePnP</code> to get the pose of my camera (already calibrated). As 3D points I'm using a template in which, at program start, I compute the same barcode detection and I take the top left corner and bottom right corner. I then compute the world coordinates of these two points with respect to the center of the barcode in this way:</p>\n\n<pre><code>(pt.x - imageSize.width / 2) * px_to_mm,\n(pt.y - imageSize.height / 2) * px_to_mm,\n0.\n</code></pre>\n\n<p><code>imageSize</code> is the size of the barcode (in pixels), <code>px_to_mm</code> is the ratio \"length in meters of the barcode height divided by the total number of pixel of the barcode height\" and <code>pt</code> is the point (either top left or bottom right).</p>\n\n<p>The template is</p>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/DYZtl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DYZtl.png\" alt=\"template\"></a></p>\n\n<hr>\n\n<p>I checked that the resulting point of the barcode detection are correct. The world coordinates are <code>top_left =[0.054160003, 0.025360001, 0], bottom_right = [0.085200004, 0.046080004, 0]</code>. I assume that these are correct since the dimensions in pixels of the barcode are <code>388 x 200</code> and the height in meters is <code>0.016</code>.</p>\n\n<hr>\n\n<p>When I run <code>cv::solvePnP</code> I get these results </p>\n\n<pre><code>translation: [-nan, -nan, -nan] \nrotation: [-nan, nan, -nan;\n           -nan, -nan, nan;\n           nan, -nan, -nan]\n</code></pre>\n\n<p>The input of the method are the two image points of the barcode detection and the two world points computed using the template. What is the problem?</p>\n"}, {"tags": ["c++", "flashlight", "arrayfire"], "comments": [{"owner": {"reputation": 895, "user_id": 523374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377b5253e762126ff00e01ac20d3da44?s=128&d=identicon&r=PG", "display_name": "Umar Arshad", "link": "https://stackoverflow.com/users/523374/umar-arshad"}, "edited": false, "score": 1, "creation_date": 1562166142, "post_id": 56869510, "comment_id": 100294672, "body": "You are reading from 2-10 but writing to 2-27. The sizes are different here aren&#39;t they?"}, {"owner": {"reputation": 45, "user_id": 10635451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJecT.jpg?s=128&g=1", "display_name": "Dana Mark", "link": "https://stackoverflow.com/users/10635451/dana-mark"}, "reply_to_user": {"reputation": 895, "user_id": 523374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377b5253e762126ff00e01ac20d3da44?s=128&d=identicon&r=PG", "display_name": "Umar Arshad", "link": "https://stackoverflow.com/users/523374/umar-arshad"}, "edited": false, "score": 0, "creation_date": 1562167385, "post_id": 56869510, "comment_id": 100295367, "body": "Ah thanks, it&#39;s typo"}, {"owner": {"reputation": 895, "user_id": 523374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377b5253e762126ff00e01ac20d3da44?s=128&d=identicon&r=PG", "display_name": "Umar Arshad", "link": "https://stackoverflow.com/users/523374/umar-arshad"}, "edited": false, "score": 1, "creation_date": 1562255805, "post_id": 56869510, "comment_id": 100329393, "body": "I implemented this using just ArrayFire and everything looked fine in v3.6.4"}], "owner": {"reputation": 45, "user_id": 10635451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJecT.jpg?s=128&g=1", "display_name": "Dana Mark", "link": "https://stackoverflow.com/users/10635451/dana-mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562167407, "creation_date": 1562154707, "last_edit_date": 1562167407, "question_id": 56869510, "link": "https://stackoverflow.com/questions/56869510/problem-about-value-assignment-in-arrayfire", "title": "Problem about value assignment in Arrayfire", "body": "<p>I'm using Arrayfire and Flashlight evaluating a network.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>auto tmp = output(af::seq(2, 10), af::span, af::span, af::span);\nauto softmax_tmp = fl::softmax(tmp, 0);\noutput(af::seq(2,10),af::span,af::span,af::span)=softmax_tmp;\n</code></pre>\n\n<p><code>output</code> is a tensor with the shape of (12,100,1,1). Now I want to pull out the (2,10) dims of the tensor and for the extracted 100 9-dim vectors, apply softmax operation to them. Then put them back. Codes above.</p>\n\n<p>Problem is that the 3rd line doesn't work. <code>softmax_tmp</code> is the right value, but the assignment operator in the 3rd line just failed. Exactly it can pass the compilation successfully, but <code>output</code> remains the old value as in 1st line.</p>\n\n<p>Who could help me? A lot thanks really. </p>\n"}, {"tags": ["c++", "boost"], "comments": [{"owner": {"reputation": 659, "user_id": 10870835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IlVhK.png?s=128&g=1", "display_name": "Chef Gladiator", "link": "https://stackoverflow.com/users/10870835/chef-gladiator"}, "edited": false, "score": 0, "creation_date": 1562155952, "post_id": 56869509, "comment_id": 100288317, "body": "This is a database idiom. Why not just using (one of the many very good) c++ API&#39;s to SQLite? Or at least describe the solution as based on the relational database. Assuming key-value store is for some reason not adequate ... And as the minimum tell is which C++ are you &quot;allowed&quot; to use."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 659, "user_id": 10870835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IlVhK.png?s=128&g=1", "display_name": "Chef Gladiator", "link": "https://stackoverflow.com/users/10870835/chef-gladiator"}, "edited": false, "score": 0, "creation_date": 1562156294, "post_id": 56869509, "comment_id": 100288552, "body": "@ChefGladiator They are trying to use an object of type <code>Subnet6Collection</code> provided by some library, not re-write the library to use SQL instead"}], "answers": [{"tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": false, "score": 1, "last_activity_date": 1562156625, "last_edit_date": 1562156625, "creation_date": 1562155126, "answer_id": 56869665, "question_id": 56869509, "link": "https://stackoverflow.com/questions/56869509/how-to-retrieve-element-from-boostmulti-index-container/56869665#56869665", "title": "How to retrieve element from boost::multi_index_container", "body": "<p>Yes, Mutli-index can be a difficult beast to work with. As I wrote in <a href=\"https://stackoverflow.com/a/39510606/1782465\">a different answer</a>, \"Boost.Multi-index offers an extremely customisable interface, at the cost of offering an extremely complex interface.\"</p>\n\n<p>Basically, when you want to access the contents of the container, you do it through one of its indices. You therefore start by obtaining a reference to the index which you want to use (the on tagged <code>SubnetSubnetIdIndexTag</code> in your case), and then treat that index pretty much like a container. Which container that is depends on the index's type. For an oredered unique index (as in your case), that would be somewhat like <code>std::map</code> (but with iterators pointing to values only), or like <code>std::set</code> with a transparent comparator which only compares IDs.</p>\n\n<p>Here's what it looks like in code:</p>\n\n<pre><code>Subnet6Collection coll = something();\nSubnetID idToLookFor = something2();\n\nauto&amp; indexById = coll.index&lt;SubnetSubnetIdIndexTag&gt;();\nauto it = index.find(idToLookFor);\nif (it != index.end()) {\n  Subnet6Ptr p = *it;\n} else {\n  // No such ID found\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4756, "user_id": 213114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wWib4.jpg?s=128&g=1", "display_name": "Joaqu&#237;n M L&#243;pez Mu&#241;oz", "link": "https://stackoverflow.com/users/213114/joaqu%c3%adn-m-l%c3%b3pez-mu%c3%b1oz"}, "edited": false, "score": 0, "creation_date": 1562185279, "post_id": 56870324, "comment_id": 100303335, "body": "s/<code>coll.index</code>/<code>coll.get</code>, s/<code>index</code>/<code>indexById</code>, read the docs"}], "tags": [], "owner": {"reputation": 11, "user_id": 11734139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1db7ccf714c8c36494f11b57efb01588?s=128&d=identicon&r=PG&f=1", "display_name": "hlepme", "link": "https://stackoverflow.com/users/11734139/hlepme"}, "is_accepted": false, "score": 0, "last_activity_date": 1562157390, "creation_date": 1562157390, "answer_id": 56870324, "question_id": 56869509, "link": "https://stackoverflow.com/questions/56869509/how-to-retrieve-element-from-boostmulti-index-container/56870324#56870324", "title": "How to retrieve element from boost::multi_index_container", "body": "<p>Thanks for answering.</p>\n\n<p>I tried the following (SubnetID is just uint32_t so I used 10 for test):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>SubnetID id = 10;\nSubnet6Collection coll;\n\nauto&amp; indexById = coll.index&lt;SubnetSubnetIdIndexTag&gt;();\nauto it = index.find(id);\nif (it != index.end()) {\n  Subnet6Ptr p = *it;\n} else {\n  // No such ID found\n}\n</code></pre>\n\n<p>but it does not compile:</p>\n\n<p>Opt18_lease_select.cc:38:24: error: invalid use of \u2018struct boost::multi_index::multi_index_container, boost::multi_index::indexed_by >, boost::multi_index::ordered_unique, boost::multi_index::const_mem_fun >, boost::multi_index::ordered_unique, boost::multi_index::const_mem_fun, &amp;isc::dhcp::Subnet::toText> > > >::index\u2019</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>auto&amp; indexById = coll.index&lt;SubnetSubnetIdIndexTag&gt;();\n                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>Opt18_lease_select.cc:39:17: error: overloaded function with no contextual type information</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code> auto it = index.find(id);\n                 ^~~~\n</code></pre>\n\n<p>Opt18_lease_select.cc:40:17: error: overloaded function with no contextual type information</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code> if (it != index.end()) {\n                 ^~~\n</code></pre>\n\n<p>Seems like index() find(), end() can't be used this way, or maybe I'm just missing some header file?</p>\n"}], "owner": {"reputation": 11, "user_id": 11734139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1db7ccf714c8c36494f11b57efb01588?s=128&d=identicon&r=PG&f=1", "display_name": "hlepme", "link": "https://stackoverflow.com/users/11734139/hlepme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562391790, "creation_date": 1562154705, "last_edit_date": 1562391790, "question_id": 56869509, "link": "https://stackoverflow.com/questions/56869509/how-to-retrieve-element-from-boostmulti-index-container", "title": "How to retrieve element from boost::multi_index_container", "body": "<p>I'm trying to retrieve a value from a <code>boost::multi_index_container</code>, using a unique numerical id index. I've never used <code>boost::multi_index_container</code> before so I have some trouble understanding how they work. They seem to work a bit like a database, all I want to do is to retrieve an item by specifying the id. Any help would be greatly appreciated.</p>\n\n<p>This is the datatype:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>typedef boost::multi_index_container&lt;\n    // Multi index container holds pointers to the subnets.\n    Subnet6Ptr,\n    // The following holds all indexes.\n    boost::multi_index::indexed_by&lt;\n        // First is the random access index allowing for accessing\n        // objects just like we'd do with a vector.\n        boost::multi_index::random_access&lt;\n            boost::multi_index::tag&lt;SubnetRandomAccessIndexTag&gt;\n        &gt;,\n        // Second index allows for searching using subnet identifier.\n        boost::multi_index::ordered_unique&lt;\n            boost::multi_index::tag&lt;SubnetSubnetIdIndexTag&gt;,\n            boost::multi_index::const_mem_fun&lt;Subnet, SubnetID, &amp;Subnet::getID&gt;\n        &gt;,\n        // Third index allows for searching using an output from toText function.\n        boost::multi_index::ordered_unique&lt;\n            boost::multi_index::tag&lt;SubnetPrefixIndexTag&gt;,\n            boost::multi_index::const_mem_fun&lt;Subnet, std::string, &amp;Subnet::toText&gt;\n        &gt;\n    &gt;\n&gt; Subnet6Collection;\n</code></pre>\n\n<p>The <code>Subnet6Collection</code> object is created when a dhcpv6-server (KEA) loads its config file. This file contains an optional numerical id value for each subnet, <code>SubnetID</code> in the datatype.</p>\n\n<p>I would like to retrieve a <code>Subnet6Ptr</code> by specifying <code>SubnetID</code>.</p>\n"}, {"tags": ["c++", "visual-studio"], "comments": [{"owner": {"reputation": 2755, "user_id": 2682312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M37ut.png?s=128&g=1", "display_name": "Axalo", "link": "https://stackoverflow.com/users/2682312/axalo"}, "edited": false, "score": 0, "creation_date": 1562155078, "post_id": 56869485, "comment_id": 100287744, "body": "Create a new project and compare?"}, {"owner": {"reputation": 31, "user_id": 11734185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7835092b0fb9f8546fe8ed7738c104ec?s=128&d=identicon&r=PG&f=1", "display_name": "levi_code", "link": "https://stackoverflow.com/users/11734185/levi-code"}, "reply_to_user": {"reputation": 2755, "user_id": 2682312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M37ut.png?s=128&g=1", "display_name": "Axalo", "link": "https://stackoverflow.com/users/2682312/axalo"}, "edited": false, "score": 0, "creation_date": 1562155976, "post_id": 56869485, "comment_id": 100288338, "body": "I tried and it does not work."}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1562156179, "post_id": 56869485, "comment_id": 100288469, "body": "I&#39;ve always known the most recent VS versions to be buggy until like two years after release. So it could just be a bug."}, {"owner": {"reputation": 6673, "user_id": 777689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19JOo.jpg?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/777689/petert"}, "edited": false, "score": 0, "creation_date": 1562156617, "post_id": 56869485, "comment_id": 100288731, "body": "Make sure you have the C++ workload installed, do a repair install, create a new project and then include the contents of the *.vcxproj file in your question"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 4599309, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a8f2b351caf91b60b13f9470a3475f6b?s=128&d=identicon&r=PG&f=1", "display_name": "Unknownguy", "link": "https://stackoverflow.com/users/4599309/unknownguy"}, "edited": false, "score": 0, "creation_date": 1587054579, "post_id": 59424800, "comment_id": 108364963, "body": "I installed Visual studio in a new laptop with english but still I have this problem."}], "tags": [], "owner": {"reputation": 43, "user_id": 3707057, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7928a3d83639f236c3f457feb4617e0d?s=128&d=identicon&r=PG&f=1", "display_name": "MattLance", "link": "https://stackoverflow.com/users/3707057/mattlance"}, "is_accepted": false, "score": 0, "last_activity_date": 1576842467, "creation_date": 1576842467, "answer_id": 59424800, "question_id": 56869485, "link": "https://stackoverflow.com/questions/56869485/why-are-the-project-defaults-settings-in-vs-2019-missing/59424800#59424800", "title": "Why are the &quot;Project Defaults&quot; settings in VS 2019 missing?", "body": "<p>Sorry, this may be a little late:</p>\n\n<p>Make sure that Visual Studio 2019 is installed with the same language as other already installed Visual Studio versions. Otherwise, incorrect project setting dialogs can occur, for example.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 13498330, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GiH0OR8VL_24Q47KlESzAvFhPsBuNmwwuQOVpz5fg=k-s128", "display_name": "JEREDEK", "link": "https://stackoverflow.com/users/13498330/jeredek"}, "edited": false, "score": 0, "creation_date": 1609160208, "post_id": 65466708, "comment_id": 115762102, "body": "I don&#39;t see what i was looking for. Any other ideas? In my case, i&#39;m looking for the &quot;Character Set&quot;  EDIT: nevermind, it was in Advanced"}, {"owner": {"reputation": 29, "user_id": 7053992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a119342ba532bff13dd260cbf54f9fef?s=128&d=identicon&r=PG&f=1", "display_name": "pgreinhard", "link": "https://stackoverflow.com/users/7053992/pgreinhard"}, "reply_to_user": {"reputation": 55, "user_id": 13498330, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GiH0OR8VL_24Q47KlESzAvFhPsBuNmwwuQOVpz5fg=k-s128", "display_name": "JEREDEK", "link": "https://stackoverflow.com/users/13498330/jeredek"}, "edited": false, "score": 0, "creation_date": 1609263329, "post_id": 65466708, "comment_id": 115794859, "body": "I just double checked,  the &quot;All Options&quot; section has &quot;All Options&quot; even those in Advanced. If the question is answered please mark the answer accepted."}], "tags": [], "owner": {"reputation": 29, "user_id": 7053992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a119342ba532bff13dd260cbf54f9fef?s=128&d=identicon&r=PG&f=1", "display_name": "pgreinhard", "link": "https://stackoverflow.com/users/7053992/pgreinhard"}, "is_accepted": false, "score": 1, "last_activity_date": 1609078710, "creation_date": 1609078710, "answer_id": 65466708, "question_id": 56869485, "link": "https://stackoverflow.com/questions/56869485/why-are-the-project-defaults-settings-in-vs-2019-missing/65466708#65466708", "title": "Why are the &quot;Project Defaults&quot; settings in VS 2019 missing?", "body": "<p>If you click on the C/C++ &gt; All Options (second to last) you can find what you are looking for; in my case it was Additional include directories.\n<a href=\"https://i.stack.imgur.com/n4F01.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n4F01.png\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 31, "user_id": 11734185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7835092b0fb9f8546fe8ed7738c104ec?s=128&d=identicon&r=PG&f=1", "display_name": "levi_code", "link": "https://stackoverflow.com/users/11734185/levi-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1609078710, "creation_date": 1562154634, "last_edit_date": 1562166400, "question_id": 56869485, "link": "https://stackoverflow.com/questions/56869485/why-are-the-project-defaults-settings-in-vs-2019-missing", "title": "Why are the &quot;Project Defaults&quot; settings in VS 2019 missing?", "body": "<p>I can't find the Project Defaults settings in Visual Studio 2019. I saw them in pictures or YouTube videos, but I can't find them in my Visual Studio Configuration Properties.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RIfjq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RIfjq.png\" alt=\"http://prntscr.com/oa01l5\"></a></p>\n\n<p>I have already Googled for this issue, but I can't find anything.</p>\n"}, {"tags": ["c++", "windows", "file-copying"], "comments": [{"owner": {"reputation": 828, "user_id": 10338287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010973d1ca809cd413c48f3008510c11?s=128&d=identicon&r=PG&f=1", "display_name": "SolidMercury", "link": "https://stackoverflow.com/users/10338287/solidmercury"}, "edited": false, "score": 0, "creation_date": 1562153995, "post_id": 56869251, "comment_id": 100287132, "body": "Check whether the destination path exists. CopyFile won&#39;t create folder or subfolders."}, {"owner": {"reputation": 74, "user_id": 10641939, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364723136992195/picture?type=large", "display_name": "Nikos Issaris", "link": "https://stackoverflow.com/users/10641939/nikos-issaris"}, "reply_to_user": {"reputation": 828, "user_id": 10338287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010973d1ca809cd413c48f3008510c11?s=128&d=identicon&r=PG&f=1", "display_name": "SolidMercury", "link": "https://stackoverflow.com/users/10338287/solidmercury"}, "edited": false, "score": 0, "creation_date": 1562154139, "post_id": 56869251, "comment_id": 100287220, "body": "The destination path exists. Also if the destination path doesn&#39;t exist the error number is 3 (PATH_NOT_FOUND)"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562154280, "post_id": 56869251, "comment_id": 100287300, "body": "Can you see the file using Explorer?"}, {"owner": {"reputation": 828, "user_id": 10338287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010973d1ca809cd413c48f3008510c11?s=128&d=identicon&r=PG&f=1", "display_name": "SolidMercury", "link": "https://stackoverflow.com/users/10338287/solidmercury"}, "edited": false, "score": 0, "creation_date": 1562154304, "post_id": 56869251, "comment_id": 100287307, "body": "Print floc just before CopyFile and check the path."}, {"owner": {"reputation": 74, "user_id": 10641939, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364723136992195/picture?type=large", "display_name": "Nikos Issaris", "link": "https://stackoverflow.com/users/10641939/nikos-issaris"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562154347, "post_id": 56869251, "comment_id": 100287327, "body": "@TedLyngmo yes and I can also open it with fopen and get its content"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562154588, "post_id": 56869251, "comment_id": 100287475, "body": "@NikosIssaris Ok, just checking. Windows has a <i>Compatibility Files/VirtualStore</i> layer that, when active, can mess things up so that you can open files from a program using a certain path, but it&#39;ll be invisible to other programs since the real path is hidden: <a href=\"https://stackoverflow.com/questions/53526601/stdofstream-dont-show-error-on-permission-denied-c/53527576#53527576\">Compatibility Files</a>."}, {"owner": {"reputation": 74, "user_id": 10641939, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364723136992195/picture?type=large", "display_name": "Nikos Issaris", "link": "https://stackoverflow.com/users/10641939/nikos-issaris"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562155516, "post_id": 56869251, "comment_id": 100288023, "body": "@TedLyngmo virtual store is almost empty. even when the program runs."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1562155654, "post_id": 56869251, "comment_id": 100288115, "body": "The casting from <code>const char*</code> to <code>LPCTSTR</code>  makes me suspect that your <code>LPCTSTR</code> is really a <code>const wchar_t*</code>. Try using this and see what happens: <code>CopyFileA(floc_cstr, destinationpath.c_str(), false);</code>"}, {"owner": {"reputation": 74, "user_id": 10641939, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364723136992195/picture?type=large", "display_name": "Nikos Issaris", "link": "https://stackoverflow.com/users/10641939/nikos-issaris"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562156304, "post_id": 56869251, "comment_id": 100288558, "body": "@TedLyngmo this change works for the files which their names are from English characters but doesn&#39;t work for the other files (Greek characters)"}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1562156367, "post_id": 56869251, "comment_id": 100288596, "body": "Is your file path unicode or multibyte?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1562156577, "post_id": 56869251, "comment_id": 100288705, "body": "@NikosIssaris Ah... Ok, then you should probably use <code>std::wstring</code>s instead in your project. Also, take a look at <code>std::filesystem::file_copy</code> with takes <code>std::filesystem::path</code> arguments which should work as-is with <code>L&quot;paths&quot;</code> and plain <code>&quot;paths&quot;</code>."}, {"owner": {"reputation": 74, "user_id": 10641939, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364723136992195/picture?type=large", "display_name": "Nikos Issaris", "link": "https://stackoverflow.com/users/10641939/nikos-issaris"}, "reply_to_user": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1562156638, "post_id": 56869251, "comment_id": 100288746, "body": "@Nina yes it contains English and Greek characters, at the start of the program I have <code>std::setlocale(LC_ALL, &quot;en_US.utf8&quot;); std::locale::global(std::locale(&quot;en_US.utf8&quot;));</code>"}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1562156671, "post_id": 56869251, "comment_id": 100288768, "body": "@NikosIssaris Then use CopyFileW and std::wstring. You might still be able to use std::string but you should definitely use CopyFileW."}], "answers": [{"comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1562164073, "post_id": 56871479, "comment_id": 100293342, "body": "Great that it worked out. Note that <code>&lt;filesystem&gt;</code> has a lot of neat functions. I&#39;m not sure what <code>split_file_folder_name</code> in your code does but it may already exist in one way or another in <a href=\"https://en.cppreference.com/w/cpp/filesystem/path\" rel=\"nofollow noreferrer\">std::filesystem::path</a>"}], "tags": [], "owner": {"reputation": 74, "user_id": 10641939, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364723136992195/picture?type=large", "display_name": "Nikos Issaris", "link": "https://stackoverflow.com/users/10641939/nikos-issaris"}, "is_accepted": true, "score": 0, "last_activity_date": 1562161123, "creation_date": 1562161123, "answer_id": 56871479, "question_id": 56869251, "link": "https://stackoverflow.com/questions/56869251/copyfile-cant-found-the-file-while-i-can-open-it-from-fopen/56871479#56871479", "title": "CopyFile cant found the file while i can open it from fopen", "body": "<p>Thanks for the help at the comments, the solution was to use <code>std::filesystem::copy_file(i,destinationpath);</code> instead  of<br>\n<code>CopyFile(floc , (LPCTSTR)destinationpath.c_str(), false);</code>\nUse of <em>wstring</em> wasnt necessary. So the code now is like that:   </p>\n\n<pre><code>void Folder::copy_files(std::string destination) {\n    const char* floc_cstr = NULL;\n    bool error = false;\n    std::string destinationpath;\n    for (std::string i : Get_files_paths()) {\n        try {\n            destinationpath = destination;\n            destinationpath.append(split_file_folder_name(i));\n            error = fs::copy_file(i, destinationpath);\n            if (error == false) {\n                print_last_error(GetLastError());\n            }\n        }\n        catch(std::exception e) {\n#ifdef DEBUG\n            std::cout &lt;&lt; \"[DEBUG]\" &lt;&lt; e.what() &lt;&lt;std::endl;\n#endif\n            std::cout &lt;&lt; \"file exist\\n\";\n            continue;\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 74, "user_id": 10641939, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364723136992195/picture?type=large", "display_name": "Nikos Issaris", "link": "https://stackoverflow.com/users/10641939/nikos-issaris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 56871479, "answer_count": 1, "score": 0, "last_activity_date": 1562161123, "creation_date": 1562153843, "question_id": 56869251, "link": "https://stackoverflow.com/questions/56869251/copyfile-cant-found-the-file-while-i-can-open-it-from-fopen", "title": "CopyFile cant found the file while i can open it from fopen", "body": "<p>I try to create a program that creates a backup of a folder. The problem is that when I try to use CopyFile function I get error 2 (FILE_NOT_FOUND) but I can open the file using the fopen and the exact same path. I also use utf-8 format.</p>\n\n<pre><code>\nvoid Folder::copy_files(std::string destination) {\n\n    bool error = false;\n    std::string destinationpath = destination;\n    for (std::string i : Get_files_paths()) {\n        std::string destinationpath = destination;\n        destinationpath.append(split_file_folder_name(i));\n\n\n#ifdef DEBUG\n        char str[100];\n        const char* floc_cstr = i.c_str();\n        LPCTSTR floc = (LPCTSTR)floc_cstr;\n        printf(\"\\t[DEBUG]FILE_LOC_PATH: %s\\n\", floc_cstr);\n        std::cout &lt;&lt; \"\\t[DEBUG]memory loc\" &lt;&lt; floc &lt;&lt; std::endl;\n#pragma warning(disable : 4996)\n        FILE* fp = fopen(floc_cstr, \"r\");\n        if (fp == NULL) {\n            printf(\"file not found\");\n            exit(1);\n        }\n        else {\n            printf(\"file found \\n\");\n            fscanf(fp, \"%s\", str);\n            printf(\"%s\", str);\n        }\n        fclose(fp);\n        print_last_error(GetLastError());\n#endif\n        error = CopyFile(floc , (LPCTSTR)destinationpath.c_str(), false);\n        if (error == false) {\n            print_last_error(GetLastError());\n        }\n    }\n\n}\n</code></pre>\n\n<p>From this code, I should expect to copy the file but I get the FILE_NOT_FOUND.\ndoes anybody know why this is happening? (if you need any other part of the code let me know)</p>\n"}, {"tags": ["c++", "gstreamer"], "answers": [{"tags": [], "owner": {"reputation": 1113, "user_id": 3336541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a2fe96f859a541bd9f0fb375800922d?s=128&d=identicon&r=PG", "display_name": "Prabhakar Lad", "link": "https://stackoverflow.com/users/3336541/prabhakar-lad"}, "is_accepted": false, "score": 0, "last_activity_date": 1562233829, "creation_date": 1562233829, "answer_id": 56885246, "question_id": 56869211, "link": "https://stackoverflow.com/questions/56869211/how-can-i-create-a-buffer-and-make-syncronize-stream/56885246#56885246", "title": "how can i create a buffer and make syncronize stream", "body": "<p>you need to set the factory as shared, you can do this calling the below function:</p>\n\n<pre><code>/* make the factory shared as we will stream same data */\ngst_rtsp_media_factory_set_shared(factory, TRUE);\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11708213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d170540d58181a6cfb99df4fa7b53f12?s=128&d=identicon&r=PG&f=1", "display_name": "Nisa Nur Erkin", "link": "https://stackoverflow.com/users/11708213/nisa-nur-erkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562233829, "creation_date": 1562153697, "last_edit_date": 1562161032, "question_id": 56869211, "link": "https://stackoverflow.com/questions/56869211/how-can-i-create-a-buffer-and-make-syncronize-stream", "title": "how can i create a buffer and make syncronize stream", "body": "<p>There is my video streaming example over a network.</p>\n\n<p>When I open the second VlC and stream again video start from the beginning but  I want to make synchronization, for example, The first video is in the 20th.</p>\n\n<p>seconds, the second should start from the 20th second when I open it.\nI am working on windows Visual Studio 2017.\nHow can I deal with this problem?</p>\n\n<pre><code>#include \"pch.h\"\n#include &lt;iostream&gt;\n#include &lt;gst/gst.h&gt;\n#include &lt;gst/rtsp-server/rtsp-media.h&gt;\n#include &lt;gst/rtsp-server/rtsp-server.h&gt;\n#include &lt;gst/rtsp-server/rtsp-media-factory-uri.h&gt;\n\n #define PORT \"8554\"\nstatic char *port = (char *)PORT;\n\nstatic GOptionEntry entries[] = {\n{\"port\",'p', 0, G_OPTION_ARG_STRING, &amp;port,\"Port \" PORT \"\", \"PORT\"}, \n{NULL} };\n\nint main(int argc, gchar * argv[])\n{\nGMainLoop *loop;\nGstRTSPServer *server;\nGstRTSPMountPoints *mounts;\nGstRTSPMediaFactoryURI *factory;\nGOptionContext *sample;\nGError *error = NULL;\ngchar *uri;\n\nsample = g_option_context_new(\"&lt;uri&gt; - Test RTSP Server, URI\");\ng_option_context_add_main_entries(sample, entries, NULL);\ng_option_context_add_group(sample, gst_init_get_option_group());\nif (!g_option_context_parse(sample, &amp;argc, &amp;argv, &amp;error)) {\n    return -1;\n}\nloop = g_main_loop_new(NULL, FALSE);\n\nserver = gst_rtsp_server_new();\ng_object_set(server, \"service\", port, NULL);\n\nmounts = gst_rtsp_server_get_mount_points(server);\n\nfactory = gst_rtsp_media_factory_uri_new();\n\nconst char* streamUri = \"https://www.freedesktop.org/software/gstreamer-sdk/data/media/sintel_trailer-480p.webm\";\n\nif (gst_uri_is_valid(streamUri)) {\n    uri = g_strdup(streamUri);\n}\nelse if (g_file_test(streamUri, G_FILE_TEST_EXISTS)) {\n    uri = gst_filename_to_uri(streamUri, NULL);\n}\nelse {\n    printf(\"There is no uri\");\n    return -1;\n}\n\ngst_rtsp_media_factory_uri_set_uri(factory, uri);\ng_free(uri);\n\ngst_rtsp_mount_points_add_factory(mounts, \"/deneme\", GST_RTSP_MEDIA_FACTORY(factory));\n\ng_object_unref(mounts);\n\nif (gst_rtsp_server_attach(server, NULL) == 0)\n    printf(\"FAILED!\");\n\ng_print(\"stream ready at rtsp://127.0.0.1:%s/deneme\\n\", port);\ng_main_loop_run(loop);\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "http", "cookies", "libcurl"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1562155268, "post_id": 56869205, "comment_id": 100287866, "body": "Can you see if <code>curl_getdate</code> exhibits the same problem? And what <code>sizeof(time_t)</code> is on Android?"}, {"owner": {"reputation": 23, "user_id": 9859411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6014e0f00210e986e1a69dd6213ab36e?s=128&d=identicon&r=PG&f=1", "display_name": "JanB", "link": "https://stackoverflow.com/users/9859411/janb"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1562163302, "post_id": 56869205, "comment_id": 100292868, "body": "@Botje thanks a lot, I didn&#39;t know <code>curl_getdate</code> existed. Yes, it has the same issue and the docs say it returns -1 for any year &gt; 2037 if <code>sizeof(time_t)</code> is 32 bit. Which it is for android. If you post an answer to this effect, I will accept it :)"}], "answers": [{"tags": [], "owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "is_accepted": true, "score": 0, "last_activity_date": 1562165158, "creation_date": 1562165158, "answer_id": 56872698, "question_id": 56869205, "link": "https://stackoverflow.com/questions/56869205/libcurl-cookie-expiry-on-android/56872698#56872698", "title": "libcurl cookie expiry on android", "body": "<p><code>curl_setopt</code> calls <code>Curl_cookie_add</code>, which in turn calls <code>curl_getdate</code> for \"Set-Cookie\"-style input.\nThis function eventually ends up <a href=\"https://github.com/curl/curl/blob/c9c5304dd4747cbe75d2f24be85920d572fcb5b8/lib/parsedate.c#L511\" rel=\"nofollow noreferrer\">here</a> with the following code:</p>\n\n<pre><code>/* a signed 32 bit time_t can only hold dates to the beginning of 2038 */\nif(yearnum &gt; 2037) {\n  *output = TIME_T_MAX;\n  return PARSEDATE_LATER;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9859411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6014e0f00210e986e1a69dd6213ab36e?s=128&d=identicon&r=PG&f=1", "display_name": "JanB", "link": "https://stackoverflow.com/users/9859411/janb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56872698, "answer_count": 1, "score": 1, "last_activity_date": 1562165158, "creation_date": 1562153674, "question_id": 56869205, "link": "https://stackoverflow.com/questions/56869205/libcurl-cookie-expiry-on-android", "title": "libcurl cookie expiry on android", "body": "<p>I am seeing weird behavior with libcurls cookie engine under android, while it works properly in iOS.</p>\n\n<p>The parsing of the cookies expiry date seems not to work in Android when the expiry year is 2038 or higher. I am aware of the int overflow problem with unix timestamps, but that should only occur on January 19th of 2038. With libcurl, as soon as I go to January 1st 2038 00:00 AM the issue occurs.</p>\n\n<p>The following is not the exact original code, because that is more complex. But the cookie strings and curl calls are exactly the same.</p>\n\n<pre><code>// ...create the curl handle...\n\n// Add test cookies in Set-Cookie syntax, because the issue seems to have to do with expiry parsing\nstatic const std::string border = \"Tue, 19-Jan-2087 03:14:08 GMT\";\nstatic const std::string borderP1 = \"Fri, 01-Jan-2038 00:00:00 GMT\";\nstatic const std::string borderM1 = \"Thu, 31-Dec-2037 23:59:59 GMT\";\ncurl_easy_setopt(curlHandle, CURLOPT_COOKIELIST, (\"Set-Cookie: my1=border;Domain=10.101.32.24;Path=/;Expires=\" + border).c_str());\ncurl_easy_setopt(curlHandle, CURLOPT_COOKIELIST, (\"Set-Cookie: my2=borderP1;Domain=10.101.32.24;Path=/;Expires=\" + borderP1).c_str());\ncurl_easy_setopt(curlHandle, CURLOPT_COOKIELIST, (\"Set-Cookie: my3=borderM1;Domain=10.101.32.24;Path=/;Expires=\" + borderM1).c_str());\n\n// Add another cookie in netscape syntax to compare (this one expires on July 10, 3145 9:20:00 AM)\ncurl_easy_setopt(curlHandle, CURLOPT_COOKIELIST, \"10.101.32.24\\tFALSE\\t/\\tFALSE\\t37095873600\\ttest\\tcookie\")\n\n// Code to print all cookies known to curl for test purposes:\n\nstruct curl_slist *cookies;\ncurl_easy_getinfo(curlHandle, CURLINFO_COOKIELIST, &amp;cookies);\nfor (auto c = cookies; c; c = c-&gt;next) {\n    LogStream::debug(\"Cookie\") &lt;&lt; c-&gt;data;\n}\ncurl_slist_free_all(cookies);\n</code></pre>\n\n<p>The resulting lines in the log look like this:</p>\n\n<pre><code>Cookie: 10.101.32.24    FALSE   /   FALSE   0   my1 border\nCookie: 10.101.32.24    FALSE   /   FALSE   0   my2 borderP1\nCookie: 10.101.32.24    FALSE   /   FALSE   2145916799  my3 borderM1\nCookie: 10.101.32.24    FALSE   /   FALSE   37095873600 test    cookie\n</code></pre>\n\n<p>So for the first 2 cookies, which are year 2038 or older, the expiry results in 0. This means they are treated as session cookies, which is bad for me. Weirdly, this does not seem to be caused by 32 bit int overflow, because with the netscape syntax, much larger expiry values are supported.</p>\n\n<p>I can't share the exact build setup for libcurl, but it was derived from the scripts used here and is still fairly similar: <a href=\"https://github.com/gcesarmza/curl-android-ios\" rel=\"nofollow noreferrer\">https://github.com/gcesarmza/curl-android-ios</a> . We use this setup to build iOS and Android binaries of libcurl (version 7.62.0). Again, with the iOS binaries it works fine (all cookies have correct expiry).</p>\n\n<p>In the actual code I also validate the return of <code>curl_easy_setopt</code> and it's successfull. If you need more of the setup code I can try to put together a more complete example, but it will take a bit of time.</p>\n\n<p>Does anyone know what could cause this?</p>\n"}, {"tags": ["c++", "file", "boost", "directory"], "comments": [{"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 2, "creation_date": 1562153881, "post_id": 56869177, "comment_id": 100287075, "body": "<code>std::</code> is missing before vector, string etc."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 1, "creation_date": 1562155400, "post_id": 56869177, "comment_id": 100287952, "body": "rafix07 <a href=\"https://wandbox.org/permlink/KCEAdDVtrtfqXG8d\" rel=\"nofollow noreferrer\">is right</a>."}, {"owner": {"reputation": 376, "user_id": 9377932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3jKf9.jpg?s=128&g=1", "display_name": "Roger Almengor", "link": "https://stackoverflow.com/users/9377932/roger-almengor"}, "edited": false, "score": 0, "creation_date": 1562155643, "post_id": 56869177, "comment_id": 100288106, "body": "It solved the problem! But still having an error message:"}, {"owner": {"reputation": 376, "user_id": 9377932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3jKf9.jpg?s=128&g=1", "display_name": "Roger Almengor", "link": "https://stackoverflow.com/users/9377932/roger-almengor"}, "edited": false, "score": 0, "creation_date": 1562155717, "post_id": 56869177, "comment_id": 100288155, "body": "I mean, solved the first Error. But now I received: C:\\Users\\&lt;myname&gt;\\AppData\\Local\\Temp\\ccFogf1c.o:create_list.&zwnj;&#8203;cpp:(.text+0xd9): undefined reference to &#39;boost::filesystem::path::extension() const&#39;"}, {"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 2, "creation_date": 1562155909, "post_id": 56869177, "comment_id": 100288292, "body": "@RogerAlmengor Now you have linker errors, you need to add these libraries <code>-lboost_system</code> and <code>-lboost_filesystem</code> as linker option to build your application."}, {"owner": {"reputation": 376, "user_id": 9377932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3jKf9.jpg?s=128&g=1", "display_name": "Roger Almengor", "link": "https://stackoverflow.com/users/9377932/roger-almengor"}, "edited": false, "score": 0, "creation_date": 1562156043, "post_id": 56869177, "comment_id": 100288375, "body": "Thank you very much, I will work on that. Hopefully it will compile."}], "owner": {"reputation": 376, "user_id": 9377932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3jKf9.jpg?s=128&g=1", "display_name": "Roger Almengor", "link": "https://stackoverflow.com/users/9377932/roger-almengor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562153828, "creation_date": 1562153550, "last_edit_date": 1562153828, "question_id": 56869177, "link": "https://stackoverflow.com/questions/56869177/cannot-create-a-list-of-files-within-a-directory-with-boost", "title": "Cannot create a list of files within a directory with boost", "body": "<p>I just copied the following code snippet from other question posted in Stackoverflow. And I wanted to know how to create a list of files within a directory that contains a common ending. I finished understanding how to set my project so it can include the library boost. \nHowever when running my code I get the following error message:</p>\n\n<pre><code>D:\\CPP_Dev\\Create_Virtual_Raster\\Create_Virtual_Raster\\create_list.cpp:26:66: error: 'ret' was not declared in this scope\nif (fs::is_regular_file(*it) &amp;&amp; it-&gt;path().extension() == ext) ret.push_back(it-&gt;path().filename());\n</code></pre>\n\n<p>The code snippet I just run is this one:</p>\n\n<p>I already set the library boost to be included in my code. \nI checked problems with semicolons and data type declarations. </p>\n\n<pre><code>#define BOOST_FILESYSTEM_VERSION 3\n#define BOOST_FILESYSTEM_NO_DEPRECATED \n#include &lt;boost/filesystem.hpp&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;boost/filesystem.hpp&gt;\n\n\nnamespace fs = ::boost::filesystem;\n\n// return the filenames of all files that have the specified extension\n// in the specified directory and all subdirectories\n\nstring path = \"D:/_TEST_MOSAICING_S1_TOOL/S1A_IW_SLC__1SDV_20180111T043843_20180111T043910_020102_02245A_1664\";\nstring ext = \".tif\";\n\nvoid get_all(const fs::path&amp; root, const string&amp; ext, vector&lt;fs::path&gt;&amp;   ret)\n{\n    if (!fs::exists(root) || !fs::is_directory(root)) return;\n\n    fs::recursive_directory_iterator it(root);\n    fs::recursive_directory_iterator endit;\n\n    while (it != endit)\n    {\n        if (fs::is_regular_file(*it) &amp;&amp; it-&gt;path().extension() == ext) ret.push_back(it-&gt;path().filename());\n       ++it;\n\n    }\n}\n</code></pre>\n\n<p>I just expected a list of three files included in the directory.</p>\n"}, {"tags": ["c++", "arrays", "integer"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 3, "creation_date": 1562153679, "post_id": 56869175, "comment_id": 100286938, "body": "<code>arr[i]</code> accesses the array out of bounds on the last iteration when <code>i == N</code>."}, {"owner": {"reputation": 311, "user_id": 11630848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38aff2511098597fa8ce472473a042b2?s=128&d=identicon&r=PG&f=1", "display_name": "amlucas", "link": "https://stackoverflow.com/users/11630848/amlucas"}, "edited": false, "score": 1, "creation_date": 1562153685, "post_id": 56869175, "comment_id": 100286940, "body": "your check loop goes until <code>i &lt;= N</code> which is out of the bounds."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1562153686, "post_id": 56869175, "comment_id": 100286941, "body": "fwiw, there is <a href=\"https://en.cppreference.com/w/cpp/algorithm/is_sorted\" rel=\"nofollow noreferrer\"><code>std::is_sorted</code></a>. is this an exercise?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1562153736, "post_id": 56869175, "comment_id": 100286984, "body": "Also note that arrays of non-constant size are not in the standard C++ and don&#39;t work on some compilers. Consider using <code>std::vector</code> instead."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1562153791, "post_id": 56869175, "comment_id": 100287028, "body": "<code>int arr[N];</code> -- Your program won&#39;t sort anything, since this is not allowed in C++."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562153883, "post_id": 56869175, "comment_id": 100287077, "body": "@PaulMcKenzie come on, it is not standard c++, but a compiler extension, as such it is not the nicest thing, but it does work on compilers that have the extension."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1562153923, "post_id": 56869175, "comment_id": 100287092, "body": "@formerlyknownas_463035818 I guess the many programmers who have Visual C++ are sad to hear that."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562154002, "post_id": 56869175, "comment_id": 100287139, "body": "@PaulMcKenzie that&#39;s right, when I try to run someone&#39;s snippet I often have to replace the VLAs first."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1562154212, "post_id": 56869175, "comment_id": 100287256, "body": "@Blaze That&#39;s just one of the drawbacks from using syntax like that, and that is painstakingly having to convert all of the usage of VLA&#39;s to vector if the helping hand uses Visual C++.  Then imagine the post that&#39;s riddled with that syntax -- a good portion of whoever could help here just move on to another question."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1562155271, "post_id": 56869175, "comment_id": 100287868, "body": "@PaulMcKenzie In principle I do agree with you, even with a compiler that has the extension I do not see a single good reason to use it"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1562155665, "post_id": 56869175, "comment_id": 100288123, "body": "You need to embrace zero based  counting. Doing it any other way is pure madness. You also need to throw away your C++ learning material and get a good book from the <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">SO recommended list</a>. There are no variable length arrays in C++, and <code>printf</code> and <code>scanf</code> are not in the <code>&lt;iostreams&gt;</code> header (and are not recommended anyway)."}], "answers": [{"comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1562154163, "post_id": 56869275, "comment_id": 100287230, "body": "Also, <code>scanf()</code> may fail but there&#39;s no error checking for that."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 1, "last_activity_date": 1562153918, "creation_date": 1562153918, "answer_id": 56869275, "question_id": 56869175, "link": "https://stackoverflow.com/questions/56869175/sorting-integers-in-an-array-but-its-not-working-for-some-cases/56869275#56869275", "title": "Sorting integers in an array. But its not working for some cases", "body": "<p>You have an off by one error where you skip the first element of your array and go one past the last element. If your array has <code>N</code> elements, it goes from <code>array[0]</code> to <code>array[N-1]</code>. Change this here:</p>\n\n<pre><code>for(i = 1; i &lt;= N; i++){\n</code></pre>\n\n<p>To this here:</p>\n\n<pre><code>for(i = 0; i &lt; N; i++){\n</code></pre>\n\n<p>The second <code>for(i = 1; i &lt;= N; i++)</code> where you do the check can start at <code>1</code> since you look at <code>arr[i - 1]</code> within, but it should be <code>i &lt; N</code> instead of <code>i &lt;= N</code> nevertheless.</p>\n\n<p>Furthermore, <code>int arr[N];</code> doesn't work in C++ (some compilers will tolerate it, but not all of them). Try <code>std::vector&lt;int&gt; arr(N);</code>  instead.</p>\n"}], "owner": {"reputation": 11, "user_id": 10678284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--cRaad9ARGw/AAAAAAAAAAI/AAAAAAAAAT0/An2yLMgqZnE/photo.jpg?sz=128", "display_name": "TheIneptCoder", "link": "https://stackoverflow.com/users/10678284/theineptcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1569584419, "creation_date": 1562153545, "last_edit_date": 1569584419, "question_id": 56869175, "link": "https://stackoverflow.com/questions/56869175/sorting-integers-in-an-array-but-its-not-working-for-some-cases", "title": "Sorting integers in an array. But its not working for some cases", "body": "<p>So I've written this to print \"Yes when the code is in ascending order and \"No\" when it is not. But if I start with equal values in the beginning, the program prints an incorrect result. I don't understand why the if statement runs even if the condition isn't met.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main()\n{\n    int N, i;\n    scanf(\"%d\", &amp;N);\n    int arr[N];\n\n    for(i = 1; i &lt;= N; i++)\n    {\n        scanf(\"%d\", &amp;arr[i - 1]);\n    }\n\n    for(i = 1; i &lt;= N; i++)\n    {\n\n        if(arr[i - 1] &gt; arr[i])\n        {\n            printf(\"No\");\n            return 0;\n        }\n    }\n\n    printf(\"Yes\");\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "reference"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1562153477, "post_id": 56869094, "comment_id": 100286823, "body": "This is a very broad and subjective question, and depends a lot on the context, design and use-case. There&#39;s no true &quot;right&quot; or &quot;wrong&quot; way to do this."}, {"owner": {"reputation": 539, "user_id": 11424134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bddfb4b9fe78da33d52f53e1106a8?s=128&d=identicon&r=PG&f=1", "display_name": "Raffallo", "link": "https://stackoverflow.com/users/11424134/raffallo"}, "edited": false, "score": 0, "creation_date": 1562153624, "post_id": 56869094, "comment_id": 100286905, "body": "When I have pointers or small objects like <code>int</code>, <code>double</code> I pass it by <code>void foo(T obj);</code> or <code>void foo(const T obj);</code>, in other cases I use <code>void foo(T&amp; obj);</code> or <code>void foo(const T&amp; obj);</code>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1562153715, "post_id": 56869094, "comment_id": 100286965, "body": "<i>avoid invoking copy constructors, move constructors, assignment operators, creating temporaries etc</i> -- For certain types, you will still incur construction, even if the parameter is a reference.  For example, for <code>const T&amp;</code>, the <code>T</code> is a <code>std::string</code>, and you pass a string-literal like <code>&quot;abc&quot;</code>."}, {"owner": {"reputation": 2858, "user_id": 3358499, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fa794782e1c5f1e6978843d286dc5ad9?s=128&d=identicon&r=PG&f=1", "display_name": "WBuck", "link": "https://stackoverflow.com/users/3358499/wbuck"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1562155079, "post_id": 56869094, "comment_id": 100287745, "body": "As @Someprogrammerdude said, it really depends. For example, if my function worked with a string i&#39;d make the function argument an <code>std::string_view</code>. If my function worked with a container (like a <code>vector</code>) my function argument would be a <code>span&lt;T&gt;</code> (C++20) or iterators. If I wanted a <code>readonly</code> variable I&#39;d probably take it as a <code>T const&amp;</code> assuming the parameter wasn&#39;t something like an <code>int</code> for example. If I know I&#39;ll be <code>moving</code> a variable into the function i&#39;ll take it by value.. There really is no single, default way to do this"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1562158695, "post_id": 56869094, "comment_id": 100290037, "body": "The first two are the same; the compiler ignores top-level <code>const</code> in argument lists in function declarations. In a function <b>definition</b> the <code>const</code> prevents modifying <code>obj</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11313931"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1562158904, "post_id": 56869094, "comment_id": 100290203, "body": "@PeteBecker So cv-qualifiers <i>must</i> be present in the function definition to actually apply?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1562158996, "post_id": 56869094, "comment_id": 100290257, "body": "@YanB. -- yes, top-level cv-qualifiers on arguments only matter in a function <b>definition</b>. But let&#39;s not go further down that rabbit hole; I probably shouldn&#39;t have mentioned it in the first place."}], "answers": [{"tags": [], "owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "is_accepted": true, "score": 5, "last_activity_date": 1562160038, "last_edit_date": 1562160038, "creation_date": 1562155808, "answer_id": 56869870, "question_id": 56869094, "link": "https://stackoverflow.com/questions/56869094/most-efficient-way-to-take-parameters-in-modern-c/56869870#56869870", "title": "Most efficient way to take parameters in modern C++?", "body": "<p>There is a reason why all these combinations for parameter declaration exist. It just depends on what you need:</p>\n\n<ul>\n<li><code>void foo(T obj);</code>\n\n<ul>\n<li>the caller doesn't want <code>obj</code> to be modified [so it's copied]</li>\n<li><code>foo</code> <strong>can modify</strong> <code>obj</code> [it's a copy]</li>\n<li>if <code>foo</code> doesn't modify <code>obj</code> this is <em>still</em> prefered over <code>const T&amp;</code> - assuming <strong><code>T</code> is small</strong> (fits 1-2 CPU registers)</li>\n</ul></li>\n</ul>\n\n<hr>\n\n<ul>\n<li><code>void foo(const T obj);</code>\n\n<ul>\n<li>the caller doesn't want <code>obj</code> to be modified [so it's copied]</li>\n<li><code>foo</code> <strong>can't modify</strong> <code>obj</code></li>\n<li>remember, <code>const</code> is often to help you find errors. That's why this is generally used to avoid accidentely modifying <code>obj</code>. (e.g. <code>if (obj = 5)</code>)</li>\n</ul></li>\n</ul>\n\n<hr>\n\n<ul>\n<li><code>void foo(T&amp; obj);</code>\n\n<ul>\n<li>the caller expects a change to <code>obj</code></li>\n<li><code>foo</code> <strong>can modify</strong> <code>obj</code></li>\n<li>a reference means no copying. So this is useful for passing expensive-to-copy objects. However, this could be slow for small types (<code>int</code>, <code>double</code> etc.) meaning a pass-by-copy would be better.</li>\n</ul></li>\n</ul>\n\n<hr>\n\n<ul>\n<li><code>void foo(const T&amp; obj);</code>\n\n<ul>\n<li>the caller doesn't want <code>obj</code> to be modified</li>\n<li><code>foo</code> <strong>can't modify</strong> <code>obj</code></li>\n<li>a reference means no copying. Since it's unmodifiable, this is the perfect way to parameterize large read-only containers. So: very cheap for expensive-to-copy objects, could be slow for small types.</li>\n</ul></li>\n</ul>\n\n<hr>\n\n<ul>\n<li><code>void foo(T&amp;&amp; obj);</code>\n\n<ul>\n<li>the caller doesn't care what happens to <code>obj</code> and has no problems if it's empty afterwards</li>\n<li><code>foo</code> <strong>can modify</strong> <code>obj</code> by stealing the data by moving the information to another place.</li>\n</ul></li>\n</ul>\n\n<hr>\n\n<ul>\n<li><code>void foo(const T&amp;&amp; obj);</code>\n\n<ul>\n<li><code>foo</code> <strong>can't modify</strong> <code>obj</code>, which makes this rarely useful</li>\n<li>however, this disallows lvalues to be passed as arguments.</li>\n</ul></li>\n</ul>\n\n<hr>\n\n<p>There are many special cases so this is in-no-way a complete list.</p>\n\n<hr>\n\n<p>some extra bits:</p>\n\n<ul>\n<li><strong><a href=\"https://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom\">copy-swap-idiom</a></strong></li>\n<li><code>(const T&amp; obj)</code> is often worse than just <code>(T obj)</code> for many reasons. But remember the caller can always let <code>T</code> simply be <a href=\"https://en.cppreference.com/w/cpp/utility/functional/reference_wrapper\" rel=\"nofollow noreferrer\"><code>std::reference_wrapper&lt;const T&gt;</code></a> to avoid copying. This could break the function, though.</li>\n<li>even when you don't <a href=\"https://en.cppreference.com/w/cpp/utility/move\" rel=\"nofollow noreferrer\"><code>std::move</code></a> there is a lot of moving going on - assuming the type has the necessary operators.</li>\n<li>Functions / Lambdas? Pass by value: <code>template &lt;typename F&gt; void execute(F f) { f(); }</code></li>\n</ul>\n\n<hr>\n\n<p>Finally, worth sharing is this flow chart made by <a href=\"https://www.youtube.com/channel/UCKTehwyGCKF-b2wo0RKwrcg\" rel=\"nofollow noreferrer\">Bisqwit</a> from <a href=\"https://www.youtube.com/watch?v=w1Cw3KFPh1A&amp;t=378s\" rel=\"nofollow noreferrer\">this video</a> which makes for a nice graphic:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MhK9L.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MhK9L.jpg\" alt=\"parameter declaration flow chart\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 0, "last_activity_date": 1562165407, "last_edit_date": 1562165407, "creation_date": 1562165252, "answer_id": 56872732, "question_id": 56869094, "link": "https://stackoverflow.com/questions/56869094/most-efficient-way-to-take-parameters-in-modern-c/56872732#56872732", "title": "Most efficient way to take parameters in modern C++?", "body": "<blockquote>\n  <p>Most efficient way to take parameters in modern C++?</p>\n</blockquote>\n\n<p>The <em>most efficient</em> way depends on the type of the parameter and whether the parameter will be modified.  </p>\n\n<p>For types that will fit into the processor's register, passing by copy is the most efficient. (The compiler may choose to pass variables in registers rather than the stack.)  </p>\n\n<p>For larger types, including the cases when the parameter will be modified, passing by reference is efficient (and safe).  Passing by pointer is efficient, but is not as safe as passing by reference.  </p>\n\n<p>For many parameters, consider placing them into a structure and passing the structure to the function (via reference or const reference).  </p>\n\n<p>The processor is most efficient when using data types that fit inside a register.  </p>\n\n<p><em>Note:  This is a micro-optimization, generally reserved for time critical applications.  Prefer to work on robustness and correctness before worrying about the efficiency of passing parameters.</em>  </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11313931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 1, "accepted_answer_id": 56869870, "answer_count": 2, "score": 1, "last_activity_date": 1562165407, "creation_date": 1562153246, "last_edit_date": 1562153599, "question_id": 56869094, "link": "https://stackoverflow.com/questions/56869094/most-efficient-way-to-take-parameters-in-modern-c", "title": "Most efficient way to take parameters in modern C++?", "body": "<p>Parameters can be taken in many different ways:</p>\n\n<pre><code>void foo(T obj);\nvoid foo(const T obj);\nvoid foo(T&amp; obj);\nvoid foo(const T&amp; obj);\nvoid foo(T&amp;&amp; obj);\nvoid foo(const T&amp;&amp; obj);\n</code></pre>\n\n<p>I didn't include taking a parameter via a pointer because a pointer could already be the type <code>T</code>.</p>\n\n<p>The first two ways are taking the object by value which will cause the object to get copied (if not optimized by a smart compiler).</p>\n\n<p>The other ways take the object by reference (the first two by a l-value reference and the last two as a r-value reference) which should omit making any copies. The <code>const</code> qualified versions promise not to modify the referenced object.</p>\n\n<p>If I want my function to be able to take as parameters all kinds of values (variables, temporaries returned from functions, literals etc.) what should be its prototype for a not-object-modifying version (<code>const</code>) and a potentially-object-modifying version (not <code>const</code>) version, if I want it to be the most efficent (avoid invoking copy constructors, move constructors, assignment operators, creating temporaries etc.)?</p>\n\n<p>I'm not sure which type of references should I use. If this is a subjective question I am looking for pros and cons of each approach.</p>\n"}, {"tags": ["c++", "templates", "c++17"], "answers": [{"tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 2, "last_activity_date": 1562154739, "last_edit_date": 1562154739, "creation_date": 1562153354, "answer_id": 56869123, "question_id": 56869067, "link": "https://stackoverflow.com/questions/56869067/c-template-non-type-parameter-with-condition/56869123#56869123", "title": "C++ template non-type parameter with condition", "body": "<p>You're looking for</p>\n\n<pre><code>CallbackFn&lt;std::conditional_t&lt;std::is_same_v&lt;T, int&gt;, float, double&gt;&gt;\n</code></pre>\n"}], "owner": {"reputation": 8388, "user_id": 1130231, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gHygY.png?s=128&g=1", "display_name": "Martin Perry", "link": "https://stackoverflow.com/users/1130231/martin-perry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 56869123, "answer_count": 1, "score": 1, "last_activity_date": 1562154739, "creation_date": 1562153174, "last_edit_date": 1562153255, "question_id": 56869067, "link": "https://stackoverflow.com/questions/56869067/c-template-non-type-parameter-with-condition", "title": "C++ template non-type parameter with condition", "body": "<p>I have non-type template with function pointer defined as:</p>\n\n<pre><code>template&lt;typename T&gt;\nusing CallbackFn = T (*)(T);\n\ntemplate &lt;CallbackFn&lt;float&gt; Fn&gt;\nstatic void run(float * data, size_t dataLen)\n{\n    float dataMax = Fn(data[0]);\n    for (size_t i = 1; i &lt; dataLen; i++)\n    {\n        dataMax = std::max(dataMax, Fn(data[i]));\n    }\n    printf(\"%f\\n\", dataMax);\n};\n\nfloat * someData = new float[10];\nrun&lt;std::sin&gt;(someData, 10);\nrun&lt;std::cos&gt;(someData, 10);\n</code></pre>\n\n<p>Is possible to do something like:</p>\n\n<pre><code>template &lt;typename T, CallbackFn&lt;std::is_same&lt;T, int&gt; ? float : double&gt; Fn&gt;\nstatic void run(T * data, size_t dataLen)\n{\n    T dataMax = Fn(data[0]);\n    for (size_t i = 1; i &lt; dataLen; i++)\n    {\n        dataMax = std::max(dataMax, Fn(data[i]));\n    }\n    printf(\"%f\\n\", dataMax);\n};\n\nint * someDataInt = new int[10];\nrun&lt;int, std::sin&gt;(someDataInt, 10);\n</code></pre>\n\n<p>It is a stupid example with <code>int</code>, but my actuall code is more complex and I am looking if there is a way how to do the <code>is_same</code> condition.</p>\n"}, {"tags": ["c++", "c", "clion"], "comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 2, "creation_date": 1562153042, "post_id": 56869010, "comment_id": 100286568, "body": "C++ is not <i>that</i> automated like Java. You have to setup the includes/libraries etc manually."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1562154568, "post_id": 56869010, "comment_id": 100287460, "body": "It is not typical for standard library source code to be present on your system.  Also, there is a much greater diversity of C standard library implementations than there are of Java standard library implementations, and although glibc&#39;s source is available, most implementations&#39; is not.  Program to the interface, not to a particular implementation."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1562156543, "post_id": 56869010, "comment_id": 100288684, "body": "And if you could do that with glibc, you&#39;d probably wind up qualified to be a glibc maintainer.  Given the wide variety of platforms glibc supports, finding the actual implementation of a library call for your specific architecture can be challenging, and automating that even more so.  And that&#39;s just the C run-time library..."}, {"owner": {"reputation": 123, "user_id": 4853293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QZ6DmZmt6FI/AAAAAAAAAAI/AAAAAAAAABc/Nwje4OvkAgo/photo.jpg?sz=128", "display_name": "RenYuZhuo", "link": "https://stackoverflow.com/users/4853293/renyuzhuo"}, "edited": false, "score": 1, "creation_date": 1588560574, "post_id": 56869010, "comment_id": 108936055, "body": "It is difficult to jump the standard library implication, but you can download the standard library implication if you want to look for some code.  <a href=\"https://www.gnu.org/software/libc/\" rel=\"nofollow noreferrer\">gnu.org/software/libc</a>"}], "owner": {"reputation": 935, "user_id": 9225379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b56343fbe3088bb85db6759811b36685?s=128&d=identicon&r=PG&f=1", "display_name": "EnDelt64", "link": "https://stackoverflow.com/users/9225379/endelt64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562152938, "creation_date": 1562152938, "question_id": 56869010, "link": "https://stackoverflow.com/questions/56869010/clion-way-to-go-to-c-c-standard-library-implementation", "title": "CLion - Way to go to C/C++ standard library implementation", "body": "<p>In Java project with IntelliJ IDEA, I can go to the definition of any declared functions by <code>Ctrl+click</code>. But in CLion, I can see only header files.</p>\n\n<p>Is there any way to connect <code>glibc</code> to CLion so I can see the implementation of the functions? I'm using gcc and g++ compiler.</p>\n"}, {"tags": ["c++", "qt", "qml"], "comments": [{"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 2, "creation_date": 1562154144, "post_id": 56868853, "comment_id": 100287221, "body": "I guess it&#39;s wrong idea to recreate the list to only clear the view. You have to operate with the queue data instead. The best way is to implement custom QAbstractItemModel  model."}, {"owner": {"reputation": 642, "user_id": 11612635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f136489237361b04dcbe6ec6e2d4c0ad?s=128&d=identicon&r=PG&f=1", "display_name": "DaszuOne", "link": "https://stackoverflow.com/users/11612635/daszuone"}, "reply_to_user": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 0, "creation_date": 1562155102, "post_id": 56868853, "comment_id": 100287763, "body": "@folibis Thank you for your reply. I know what you&#39;re thinking about, but documentation says: &quot;There is no way for the view to know that the contents of a QList has changed. If the QList changes, it is necessary to <b>reset the model by calling QQmlContext::setContextProperty() again</b>.&quot; so if there is such possibility, I thought there is nothing wrong with delete objects and reset context property to clear the view."}, {"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 0, "creation_date": 1562157317, "post_id": 56868853, "comment_id": 100289146, "body": "Maybe, maybe ... but you see that this approach cause to problems. What for example should happen between clearing the list and resetting the property? What if <code>ListView</code> will repaint its contect in this time and will call to queueStatesModel.at(1), for example?"}, {"owner": {"reputation": 642, "user_id": 11612635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f136489237361b04dcbe6ec6e2d4c0ad?s=128&d=identicon&r=PG&f=1", "display_name": "DaszuOne", "link": "https://stackoverflow.com/users/11612635/daszuone"}, "reply_to_user": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 0, "creation_date": 1562231633, "post_id": 56868853, "comment_id": 100316392, "body": "@folibis You are absolutely right, but in my case it may be little overstatement to implement QAbstractItemModel , for now QList it&#39;s enough - data source is SOAP API and I don&#39;t need to refreshing objects, I need to display them only once, during request. I&#39;ve found a solution, I will write below."}], "answers": [{"tags": [], "owner": {"reputation": 642, "user_id": 11612635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f136489237361b04dcbe6ec6e2d4c0ad?s=128&d=identicon&r=PG&f=1", "display_name": "DaszuOne", "link": "https://stackoverflow.com/users/11612635/daszuone"}, "is_accepted": false, "score": 0, "last_activity_date": 1562232422, "creation_date": 1562232422, "answer_id": 56884789, "question_id": 56868853, "link": "https://stackoverflow.com/questions/56868853/qt-qml-application-crashes-when-qlist-objects-in-context-property-are-deleted/56884789#56884789", "title": "Qt QML application crashes when QList objects in context property are deleted", "body": "<p>I've found some solution - not very elegant but working.</p>\n\n<p>Before <code>QList::clear()</code> I do copy of pointers from that list to another QList. Then I <code>clear()</code> first list and set context property. After that I perform <code>qDeleteAll</code> and <code>clear()</code> at second list. More or less like this:</p>\n\n<pre><code>this-&gt;queueStatesCache = this-&gt;queueStates;\nthis-&gt;queueStates.clear();\ng-&gt;appEngine-&gt;rootContext()-&gt;setContextProperty(\"queueStatesModel\", QVariant::fromValue(this-&gt;queueStates));\nqDeleteAll(this-&gt;queueStatesCache);\nthis-&gt;queueStatesCache.clear();\n</code></pre>\n"}], "owner": {"reputation": 642, "user_id": 11612635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f136489237361b04dcbe6ec6e2d4c0ad?s=128&d=identicon&r=PG&f=1", "display_name": "DaszuOne", "link": "https://stackoverflow.com/users/11612635/daszuone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 368, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562232422, "creation_date": 1562152315, "question_id": 56868853, "link": "https://stackoverflow.com/questions/56868853/qt-qml-application-crashes-when-qlist-objects-in-context-property-are-deleted", "title": "Qt QML application crashes when QList objects in context property are deleted", "body": "<p>I have QML ListView with some model (which are <code>QList&lt;QObject*&gt;</code>) provided by context property:</p>\n\n<pre><code>g-&gt;appEngine-&gt;rootContext()-&gt;setContextProperty(\"queueStatesModel\", QVariant::fromValue(this-&gt;queueStates));\n</code></pre>\n\n<p>Everything going well until I'm trying to clear the ListView. I'm doing this like that:</p>\n\n<pre><code>qDeleteAll(this-&gt;queueStates);\nthis-&gt;queueStates.clear();\n</code></pre>\n\n<p>and then again I'm setting context property with empty QList, which causing application crash. When I'm doing the same without deleting all objects with qDeleteAll everything going well, ListView is clear, application not crashing, but objects remains and I'm loosing pointers to them.</p>\n\n<p>What's could be wrong with that?</p>\n"}]