[{"tags": ["c++", "c++11", "inheritance", "constructor", "using-declaration"], "comments": [{"owner": {"reputation": 3118, "user_id": 1253415, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87096d37b6aed093f1b142c6a9bfae91?s=128&d=identicon&r=PG", "display_name": "jcai", "link": "https://stackoverflow.com/users/1253415/jcai"}, "edited": false, "score": 1, "creation_date": 1530746533, "post_id": 51181682, "comment_id": 89345687, "body": "What compiler / flags? After adding <code>A (const A&amp;) { }</code>, I only see one line of output: <a href=\"https://wandbox.org/permlink/ex8AyRHqF1ChsNcc\" rel=\"nofollow noreferrer\">wandbox.org/permlink/ex8AyRHqF1ChsNcc</a> (the const ref version is being called)"}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 1, "creation_date": 1530746573, "post_id": 51181682, "comment_id": 89345693, "body": "Not sure, but latest gcc and clang will both call the const-ref version on <a href=\"https://wandbox.org/\" rel=\"nofollow noreferrer\">wandbox</a>"}, {"owner": {"reputation": 1241, "user_id": 1008966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d946ead65e7f775142938c4dd570791?s=128&d=identicon&r=PG", "display_name": "Dan R", "link": "https://stackoverflow.com/users/1008966/dan-r"}, "reply_to_user": {"reputation": 3118, "user_id": 1253415, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87096d37b6aed093f1b142c6a9bfae91?s=128&d=identicon&r=PG", "display_name": "jcai", "link": "https://stackoverflow.com/users/1253415/jcai"}, "edited": false, "score": 0, "creation_date": 1530747080, "post_id": 51181682, "comment_id": 89345810, "body": "@Arcinde Thanks for the link to wandbox! It seems that the behavior is as I described until gcc 7 (I was using gcc 5.4). So I guess it was a bug in the compiler? Or is it unspecified behavior?"}, {"owner": {"reputation": 1241, "user_id": 1008966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d946ead65e7f775142938c4dd570791?s=128&d=identicon&r=PG", "display_name": "Dan R", "link": "https://stackoverflow.com/users/1008966/dan-r"}, "reply_to_user": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1530747245, "post_id": 51181682, "comment_id": 89345853, "body": "@super It looks like the behavior changed as of GCC 7 and clang 4.0. I&#39;m still not sure whether this was a bug (in both compilers) or unspecified behavior."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1530748179, "post_id": 51181682, "comment_id": 89345993, "body": "It was always possible to have <code>A(A&amp;)</code> and <code>A(A const&amp;)</code>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1530749413, "post_id": 51181682, "comment_id": 89346179, "body": "<a href=\"http://coliru.stacked-crooked.com/a/e0281d9388e114c1\" rel=\"nofollow noreferrer\">Demo</a> showing both expected and unexpected result depending of version of compiler."}, {"owner": {"reputation": 1241, "user_id": 1008966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d946ead65e7f775142938c4dd570791?s=128&d=identicon&r=PG", "display_name": "Dan R", "link": "https://stackoverflow.com/users/1008966/dan-r"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1530770900, "post_id": 51181682, "comment_id": 89350463, "body": "@M.M My note about having multiple copy constructors being somehow new in C++11 is based on the documentation <a href=\"https://en.cppreference.com/w/cpp/language/copy_constructor\" rel=\"nofollow noreferrer\">here</a>. I think you could always have both constructors but only since C++11 are they both considered to be copy constructors."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1530774484, "post_id": 51181682, "comment_id": 89352309, "body": "@DanRoche I assume the section you refer to is supposed to indicate that <code>= default;</code> was added in C++11. You could still have the two user-provided copy constructors in C++03. In fact section 12.8/2  of the C++03 standard has an example of exactly that."}], "answers": [{"comments": [{"owner": {"reputation": 1241, "user_id": 1008966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d946ead65e7f775142938c4dd570791?s=128&d=identicon&r=PG", "display_name": "Dan R", "link": "https://stackoverflow.com/users/1008966/dan-r"}, "edited": false, "score": 1, "creation_date": 1530747640, "post_id": 51181786, "comment_id": 89345915, "body": "Thanks for the useful link from the docs. But the behavior is exactly the opposite of what you have here - the template constructor is chosen only in the <b>second</b> case, when both ctors are present. (It seems this was maybe a compiler bug that has been fixed in more recent versions?)"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 1241, "user_id": 1008966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d946ead65e7f775142938c4dd570791?s=128&d=identicon&r=PG", "display_name": "Dan R", "link": "https://stackoverflow.com/users/1008966/dan-r"}, "edited": false, "score": 1, "creation_date": 1530748966, "post_id": 51181786, "comment_id": 89346117, "body": "@DanRoche: There is also a defect. so old compilers might still implement that."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 6, "last_activity_date": 1530748827, "last_edit_date": 1530748827, "creation_date": 1530747404, "answer_id": 51181786, "question_id": 51181682, "link": "https://stackoverflow.com/questions/51181682/surprising-behavior-in-multiple-copy-constructor-inheritance/51181786#51181786", "title": "Surprising behavior in multiple copy constructor inheritance", "body": "<p>From <a href=\"https://en.cppreference.com/w/cpp/language/using_declaration\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/using_declaration</a></p>\n\n<blockquote>\n  <p>If one of the inherited constructors of Base happens to have the signature that matches a copy/move constructor of the Derived, it does not prevent implicit generation of Derived copy/move constructor (which then hides the inherited version, similar to using operator=).</p>\n</blockquote>\n\n<p>So</p>\n\n<pre><code>struct C :public A { using A::A; };\n</code></pre>\n\n<p>is</p>\n\n<pre><code>struct C :public A\n{\n    using A::A;\n    C(const C&amp;) = default;\n    C(C&amp;&amp;) = default;\n};\n</code></pre>\n\n<p>where <code>C(const C&amp;) = default;</code> is similar to</p>\n\n<pre><code>C(const C&amp; c) : A(static_cast&lt;const A&amp;&gt;(c)) {}\n</code></pre>\n\n<p>So with</p>\n\n<pre><code>struct A {\n  template &lt;typename... Args&gt;\n  A (Args&amp;&amp;... args)\n  { std::cout &lt;&lt; \"non-default ctor called\\n\"; }\n\n  A (A&amp;) { std::cout &lt;&lt; \"copy ctor from non-const ref\\n\"; }\n};\n</code></pre>\n\n<p>template constructor is chosen, but</p>\n\n<pre><code>struct A {\n  template &lt;typename... Args&gt;\n  A (Args&amp;&amp;... args)\n  { std::cout &lt;&lt; \"non-default ctor called\\n\"; }\n\n  A (const A&amp;) { std::cout &lt;&lt; \"copy ctor from const ref\\n\"; }\n  A (A&amp;) { std::cout &lt;&lt; \"copy ctor from non-const ref\\n\"; }\n};\n</code></pre>\n\n<p><code>A (const A&amp;)</code> is chosen.</p>\n\n<p>As you can notice, there is also a defect:</p>\n\n<blockquote>\n  <p>The semantics of inheriting constructors were retroactively changed by a defect report against C++11. Previously, an inheriting constructor declaration caused a set of synthesized constructor declarations to be injected into the derived class, which caused redundant argument copies/moves, had problematic interactions with some forms of SFINAE, and in some cases can be unimplementable on major ABIs. Older compilers may still implement the previous semantics.</p>\n</blockquote>\n\n<p><a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0136r1.html\" rel=\"nofollow noreferrer\">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0136r1.html</a></p>\n\n<p>With that defect, your class C would be</p>\n\n<pre><code>struct C :public A\n{\n    using A::A;\n\n    template &lt;typename ...Ts&gt;\n    C(Ts&amp;&amp;... ts) : A(std::forward&lt;Ts&gt;(ts)...) {} // Inherited.\n\n    C(const C&amp;) = default;\n    C(C&amp;&amp;) = default;\n};\n</code></pre>\n\n<p>So you call <code>C(C&amp; c) : A(c) {}</code> (after template substitution).</p>\n"}], "owner": {"reputation": 1241, "user_id": 1008966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d946ead65e7f775142938c4dd570791?s=128&d=identicon&r=PG", "display_name": "Dan R", "link": "https://stackoverflow.com/users/1008966/dan-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 51181786, "answer_count": 1, "score": 3, "last_activity_date": 1530749063, "creation_date": 1530746099, "last_edit_date": 1530749063, "question_id": 51181682, "link": "https://stackoverflow.com/questions/51181682/surprising-behavior-in-multiple-copy-constructor-inheritance", "title": "Surprising behavior in multiple copy constructor inheritance", "body": "<p>Starting with C++11, there can be two copy constructors, one taking a parameter of type <code>T&amp;</code>, and one taking a parameter of type <code>const T&amp;</code>.</p>\n\n<p>I have a situation where (seemingly) <strong>adding a second copy constructor causes neither one to get called</strong>, when the constructors are inherited in a derived class. The copy constructor is overridden by a templatized constructor when both are present.</p>\n\n<p>Here is a MWE:</p>\n\n<pre><code>struct A {\n  template &lt;typename... Args&gt;\n  A (Args&amp;&amp;... args)\n  { std::cout &lt;&lt; \"non-default ctor called\\n\"; }\n\n  A (A&amp;) { std::cout &lt;&lt; \"copy ctor from non-const ref\\n\"; }\n};\n\nstruct C :public A { using A::A; };\n\nint main() {\n  C c1;\n  C c2(c1);\n}\n</code></pre>\n\n<p>Running this code, we see output</p>\n\n<pre><code>non-default ctor called\ncopy ctor from non-const ref\n</code></pre>\n\n<p>which is as expected.</p>\n\n<p>However, adding an additional constructor to <code>struct A</code> as follows:</p>\n\n<pre><code>  A (const A&amp;) { }\n</code></pre>\n\n<p>somehow causes the other copy constructor not to get called, so the output becomes</p>\n\n<pre><code>non-default ctor called\nnon-default ctor called\n</code></pre>\n\n<p>In my use case, I want to inherit all the constructors from a base class into a derived class, including the copy constructors and anything else. But it seems that somehow the two copy constructors don't get inherited when they are both present. What is going on here?</p>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 30567, "user_id": 151019, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ab97924548209ed725801c0a08c40d1e?s=128&d=identicon&r=PG", "display_name": "mmmmmm", "link": "https://stackoverflow.com/users/151019/mmmmmm"}, "edited": false, "score": 0, "creation_date": 1530744322, "post_id": 51181488, "comment_id": 89345341, "body": "Try <code>#include &quot;botan&#47;sha2_64.h&quot;</code>"}, {"owner": {"reputation": 832, "user_id": 7090396, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh5.googleusercontent.com/-7p0-qadgndM/AAAAAAAAAAI/AAAAAAAAAFY/M3cg5o3f6o8/photo.jpg?sz=128", "display_name": "Eric Brown", "link": "https://stackoverflow.com/users/7090396/eric-brown"}, "reply_to_user": {"reputation": 30567, "user_id": 151019, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ab97924548209ed725801c0a08c40d1e?s=128&d=identicon&r=PG", "display_name": "mmmmmm", "link": "https://stackoverflow.com/users/151019/mmmmmm"}, "edited": false, "score": 0, "creation_date": 1530744426, "post_id": 51181488, "comment_id": 89345364, "body": "Same error occurs, can&#39;t find the file"}, {"owner": {"reputation": 1801, "user_id": 7433460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h0Epz.jpg?s=128&g=1", "display_name": "Hossein Golshani", "link": "https://stackoverflow.com/users/7433460/hossein-golshani"}, "edited": false, "score": 0, "creation_date": 1530745312, "post_id": 51181488, "comment_id": 89345495, "body": "Check case sensitivity. <code>Botan</code> vs <code>botan</code>"}, {"owner": {"reputation": 832, "user_id": 7090396, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh5.googleusercontent.com/-7p0-qadgndM/AAAAAAAAAAI/AAAAAAAAAFY/M3cg5o3f6o8/photo.jpg?sz=128", "display_name": "Eric Brown", "link": "https://stackoverflow.com/users/7090396/eric-brown"}, "edited": false, "score": 0, "creation_date": 1530745479, "post_id": 51181488, "comment_id": 89345519, "body": "The case sensitivity is correct. The folder with the Botan files in it, the first one, is Botan, with a capital B and the second one is botan with a lower case b. Again, these were both added by the Clion autofill, so Clion confirmed that this is in fact the correct path to the file."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1530745927, "post_id": 51181488, "comment_id": 89345591, "body": "From what you have written in your question, try <code>#include &quot;.&#47;Botan&#47;include&#47;botan&#47;sha2_64.h</code> (or even just plain <code>#include &quot;Botan&#47;include&#47;botan&#47;sha2_64.h&quot;</code>)"}, {"owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "edited": false, "score": 0, "creation_date": 1530746125, "post_id": 51181488, "comment_id": 89345619, "body": "<a href=\"https://github.com/randombit/botan/issues/1453\" rel=\"nofollow noreferrer\">github.com/randombit/botan/issues/1453</a>"}], "owner": {"reputation": 832, "user_id": 7090396, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh5.googleusercontent.com/-7p0-qadgndM/AAAAAAAAAAI/AAAAAAAAAFY/M3cg5o3f6o8/photo.jpg?sz=128", "display_name": "Eric Brown", "link": "https://stackoverflow.com/users/7090396/eric-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530744316, "creation_date": 1530744169, "last_edit_date": 1530744316, "question_id": 51181488, "link": "https://stackoverflow.com/questions/51181488/c-cannot-open-include-file-when-file-location-is-correct", "title": "c++ Cannot open include file when file location is correct", "body": "<p>I have been trying to include Botan files into my project, but so far, it hasn't been working because it can't find the files. I am using Clion IDE with Cmake and in the CmakeLists.txt file, I have included the relative path to the files I want to add:</p>\n\n<pre><code>include_directories(./Botan/include)\n</code></pre>\n\n<p>From there, I want to add the sha2_64.h file to one of my header files, so I have the following in my header file:</p>\n\n<pre><code>#include &lt;botan/sha2_64.h&gt;\n</code></pre>\n\n<p>The autofill worked properly in Clion and it found <code>botan/sha2_64.h</code> but when it came time to build the project, I get the error \"Cannot open include file: 'botan/sha2_64.h': No such file or directory\" Why can the autofill find the file, but the compiler can't? I even tried accessing the file by using:</p>\n\n<pre><code>#include \"../Botan/include/botan/sha2_64.h\" //Relative path from my header file to sha2_64.h\n</code></pre>\n\n<p>This still resulted in the file not being found. I know that this path is correct as Clion's autofill finds it no problem. I just can't figure out why the compiler can't find the file.</p>\n"}, {"tags": ["c++", "qt", "encryption", "botan"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10034187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73145b07d6724fd01791441ddbaf7c7a?s=128&d=identicon&r=PG&f=1", "display_name": "UKbasedUser", "link": "https://stackoverflow.com/users/10034187/ukbaseduser"}, "edited": false, "score": 0, "creation_date": 1530825649, "post_id": 51182293, "comment_id": 89381739, "body": "Jack thanks for this really appreciated I was getting worn down with that. Now I have a strange  <code>error: undefined reference to </code>BotanWrapper::DecryptFileW(QString, QString)`  a global search doesn&#39;t even show that anywhere in the whole QT project?  Anyway - thanks again!"}, {"owner": {"reputation": 7856, "user_id": 152148, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/79a9be2b7f68794b926b7e08d4f7cfb7?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Lloyd", "link": "https://stackoverflow.com/users/152148/jack-lloyd"}, "reply_to_user": {"reputation": 23, "user_id": 10034187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73145b07d6724fd01791441ddbaf7c7a?s=128&d=identicon&r=PG&f=1", "display_name": "UKbasedUser", "link": "https://stackoverflow.com/users/10034187/ukbaseduser"}, "edited": false, "score": 0, "creation_date": 1530887053, "post_id": 51182293, "comment_id": 89405909, "body": "Sorry I don&#39;t know anything about the Qt wrapper, but one thing to look at is <code>DecryptFileW</code> is a Windows API, it is possible Windows header is doing something like <code>#define DecryptFile DecryptFileW</code>, so <code>#undef DecryptFile</code> may do it."}, {"owner": {"reputation": 23, "user_id": 10034187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73145b07d6724fd01791441ddbaf7c7a?s=128&d=identicon&r=PG&f=1", "display_name": "UKbasedUser", "link": "https://stackoverflow.com/users/10034187/ukbaseduser"}, "edited": false, "score": 0, "creation_date": 1530903750, "post_id": 51182293, "comment_id": 89413767, "body": "Thanks again Jack. I asked on Qt forum but no reply so I posted back to your solution here.  I have just tracked it to the DecryptFile definition in winbase.h so I renamed the botanwrapper to DecryptFileW and that worked. I don&#39;t know where the original FileW suffix came from though I have lost track to be honest. I need to consider which is the best way undefine or leave as is and post a clash bug on github for wrapper.  Wish I could award likes/stars/credits here I would throw a bundle your way."}], "tags": [], "owner": {"reputation": 7856, "user_id": 152148, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/79a9be2b7f68794b926b7e08d4f7cfb7?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Lloyd", "link": "https://stackoverflow.com/users/152148/jack-lloyd"}, "is_accepted": true, "score": 1, "last_activity_date": 1530753905, "creation_date": 1530753905, "answer_id": 51182293, "question_id": 51181330, "link": "https://stackoverflow.com/questions/51181330/using-botan-c-in-qt-to-encrypt-files/51182293#51182293", "title": "Using Botan C++ in QT to encrypt files", "body": "<p>The problem is Windows API defines a macro <code>X942_DH_PARAMETERS</code> which conflicts with this enum. (In fact the enum was renamed in later releases of Botan, to avoid this issue <a href=\"https://github.com/randombit/botan/issues/482\" rel=\"nofollow noreferrer\">https://github.com/randombit/botan/issues/482</a>).</p>\n\n<p>You can work around it by using <code>#undef X942_DH_PARAMETERS</code> before including the Botan headers.</p>\n"}], "owner": {"reputation": 23, "user_id": 10034187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73145b07d6724fd01791441ddbaf7c7a?s=128&d=identicon&r=PG&f=1", "display_name": "UKbasedUser", "link": "https://stackoverflow.com/users/10034187/ukbaseduser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 51182293, "answer_count": 1, "score": 2, "last_activity_date": 1530771309, "creation_date": 1530742675, "last_edit_date": 1530771309, "question_id": 51181330, "link": "https://stackoverflow.com/questions/51181330/using-botan-c-in-qt-to-encrypt-files", "title": "Using Botan C++ in QT to encrypt files", "body": "<p>I'm using <strong><code>Qt Creator 4.6.1</code></strong> on Windows 10<br>\nBased on <strong><code>Qt 5.10.1 (MSVC 2015, 32 bit)</code></strong><br>\nBuilt on <strong><code>May 2 2018 04:24:33</code></strong><br>\n<code>qmake</code> with <code>mingw491_32</code>  </p>\n\n<p>There is a project from the web which makes use of a <code>botanwrapper</code> with the include <code>Botan.pri</code> </p>\n\n<p>The full code is quite long so not possible to post here but it is available at <a href=\"http://www.voidrealms.com/index.php?r=source/view&amp;id=1\" rel=\"nofollow noreferrer\">http://www.voidrealms.com/index.php?r=source/view&amp;id=1</a> as a zip file. </p>\n\n<p>That all works and encrypts files but when I bring the files into my my project I get a huge number of compile errors such as those below.</p>\n\n<pre><code>botan.h:9380: error: expected identifier before '(' token\n          X942_DH_PARAMETERS = ANSI_X9_42,\n          ^\n</code></pre>\n\n<p>and <code>error: expected '}' before '(' token which points to the line</code></p>\n\n<pre><code>enum Format {\n         ANSI_X9_42,\n         ANSI_X9_57,\n         PKCS_3,\n\n         DSA_PARAMETERS = ANSI_X9_57,\n         DH_PARAMETERS = ANSI_X9_42,\n         X942_DH_PARAMETERS = ANSI_X9_42, // Error points to here\n         PKCS3_DH_PARAMETERS = PKCS_3\n      };\n</code></pre>\n\n<p>Also lots of errors relating to the <code>const</code> such as</p>\n\n<pre><code>error: non-member function 'bool Botan::verify_group(Botan::RandomNumberGenerator&amp;, bool)' cannot have cv-qualifier\n\nbool verify_group(RandomNumberGenerator&amp; rng, bool strong) const;  \n</code></pre>\n\n<p>Which points to the code below</p>\n\n<hr>\n\n<pre><code>bool verify_group(RandomNumberGenerator&amp; rng, bool strong) const;\n</code></pre>\n\n<p>I have checked the .pro files for the includes and I have the same files setup as the project that compiles and runs on the same setup. I have the same <code>botan.pri</code> file included which contains</p>\n\n<pre><code>win32 {\n    DEFINES += BOTAN_TARGET_OS_IS_WINDOWS \\\n        BOTAN_TARGET_OS_HAS_LOADLIBRARY BOTAN_TARGET_OS_HAS_WIN32_GET_SYSTEMTIME \\\n        BOTAN_TARGET_OS_HAS_WIN32_VIRTUAL_LOCK BOTAN_HAS_DYNAMICALLY_LOADED_ENGINE \\\n        BOTAN_HAS_DYNAMIC_LOADER BOTAN_HAS_ENTROPY_SRC_CAPI BOTAN_HAS_ENTROPY_SRC_WIN32 \\\n        BOTAN_HAS_MUTEX_WIN32\n\n    win32-msvc* {\n        QMAKE_CXXFLAGS += -wd4251 -wd4290 -wd4250\n        DEFINES += BOTAN_BUILD_COMPILER_IS_MSVC BOTAN_TARGET_OS_HAS_GMTIME_S\n    } else {\n        QMAKE_CFLAGS += -fpermissive -finline-functions -Wno-long-long\n        QMAKE_CXXFLAGS += -fpermissive -finline-functions -Wno-long-long\n    }\n    LIBS += -ladvapi32 -luser32\n}\n</code></pre>\n\n<p>I have read that removing the <code>const</code> will remove 1 or more errors but I don't understand why this is broken on the same setup that happily compiles the <code>botan.h</code> and runs the build and encrypts files. Could someone help with how to start to troubleshoot this. Help appreciated. Thanks in advance.</p>\n"}, {"tags": ["java", "c++", "optimization", "stl"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 5, "creation_date": 1530741595, "post_id": 51181151, "comment_id": 89344787, "body": "Your claim that calling a getter function requires more CPU cycles is false with any compiler that isn&#39;t ancient. Inlining this is trivial nowadays. You can see this for yourself by looking at generated assembly and/or measuring."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1530741912, "post_id": 51181151, "comment_id": 89344867, "body": "How would you stop an application updating <code>size</code> and thereby corrupting the state of the vector?"}, {"owner": {"reputation": 3023, "user_id": 5587393, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1d83bf6603c6c7a002ab8e18e418e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Luzzara", "link": "https://stackoverflow.com/users/5587393/marco-luzzara"}, "edited": false, "score": 0, "creation_date": 1530741958, "post_id": 51181151, "comment_id": 89344872, "body": "<code>length</code> field is declared as <code>final</code> but in C++ the <code>final</code> keyword does not exist and its behaviour, as far as I know, cannot be emulated. Moreover, in C++ there is not the concept of <code>readonly</code> property(as in C# for example)."}, {"owner": {"reputation": 49, "user_id": 5758472, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-P0nlyQLOnOE/AAAAAAAAAAI/AAAAAAAAS58/CegyDH-AWrs/photo.jpg?sz=128", "display_name": "sam", "link": "https://stackoverflow.com/users/5758472/sam"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1530742253, "post_id": 51181151, "comment_id": 89344950, "body": "@RichardCritten I don&#39;t know much about Java programming. How does a Java class prevent length variable to be updated its outside? If it&#39;s updated, it will also cause to violate memory."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 3, "creation_date": 1530742612, "post_id": 51181151, "comment_id": 89345022, "body": "The nearest Java class to std::vector is ArrayList, size of an array list is a method call.  I think you need to check your assumption that Java uses a size property for mutable objects."}, {"owner": {"reputation": 3320, "user_id": 3480808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbca64f49de22131b4b51fddfa8a7df4?s=128&d=identicon&r=PG", "display_name": "Michael Doubez", "link": "https://stackoverflow.com/users/3480808/michael-doubez"}, "edited": false, "score": 1, "creation_date": 1530742682, "post_id": 51181151, "comment_id": 89345038, "body": "As a matter of fact the final keyword does exists and I can emulate a read-only property very easily but why bother when a plain function does the job at no cost ?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1530743354, "post_id": 51181151, "comment_id": 89345167, "body": "<a href=\"https://en.cppreference.com/w/cpp/language/final\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/final</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1530743647, "post_id": 51181151, "comment_id": 89345209, "body": "Also consider writing that loop as <code>for (int value: v)</code> and letting the compiler and runtime worry about how big  <code>v</code> is."}, {"owner": {"reputation": 49, "user_id": 5758472, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-P0nlyQLOnOE/AAAAAAAAAAI/AAAAAAAAS58/CegyDH-AWrs/photo.jpg?sz=128", "display_name": "sam", "link": "https://stackoverflow.com/users/5758472/sam"}, "edited": false, "score": 0, "creation_date": 1530757372, "post_id": 51181151, "comment_id": 89347366, "body": "Why is my question voted down to -4? What is wrong in my question?"}], "answers": [{"comments": [{"owner": {"reputation": 3320, "user_id": 3480808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbca64f49de22131b4b51fddfa8a7df4?s=128&d=identicon&r=PG", "display_name": "Michael Doubez", "link": "https://stackoverflow.com/users/3480808/michael-doubez"}, "edited": false, "score": 0, "creation_date": 1530742916, "post_id": 51181253, "comment_id": 89345088, "body": "I can define a nested class with a size member value which implicitely convert to the const reference of the size field. it would uselessly tie the implementation of std::vector to ptr+size field implementation."}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "reply_to_user": {"reputation": 3320, "user_id": 3480808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbca64f49de22131b4b51fddfa8a7df4?s=128&d=identicon&r=PG", "display_name": "Michael Doubez", "link": "https://stackoverflow.com/users/3480808/michael-doubez"}, "edited": false, "score": 0, "creation_date": 1530743021, "post_id": 51181253, "comment_id": 89345116, "body": "That also has lots of downsides.  For instance, template type deduction and <code>auto</code> variables won&#39;t work as expected."}], "tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": true, "score": 2, "last_activity_date": 1530742588, "last_edit_date": 1530742588, "creation_date": 1530742080, "answer_id": 51181253, "question_id": 51181151, "link": "https://stackoverflow.com/questions/51181151/why-doesnt-vector-support-size-as-member-variable-like-length-variable-in-a-java/51181253#51181253", "title": "Why doesnt vector support size as member variable like length variable in a Java class, instead a function size()?", "body": "<blockquote>\n  <p>Why doesn't std::vector or other containers have length as a member variable, instead of a function?</p>\n</blockquote>\n\n<p>Because it would be writable if it was a public member variable.  Since it makes no sense to write to the size member of a vector, the designers made the size member private and provided a <code>size()</code> method to read its value.  A java array's <code>length</code> member is declared <code>final</code> so you can't change it.  You could do the same thing in C++ with a <code>const</code> length member, but <code>std::vector</code> needs to be able to change its <code>length</code>, so that doesn't make sense either.  That's the same reason java's <code>ArrayList</code> class uses a <code>size()</code> method rather than a public member (that and so that it can provide dynamic dispatch through the <code>List</code> interface).</p>\n\n<blockquote>\n  <p>Reading a vector's size using a function is more costly than a member variable.</p>\n</blockquote>\n\n<p>It really isn't.  The method's definition is available at the point of the call, so the call will almost certainly be inlined by any decent compiler.  In the end, the compiler will end up generating the exact same machine code for a public member variable or an accessor method.</p>\n"}, {"tags": [], "owner": {"reputation": 583, "user_id": 1948525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5bccd182ec2401b4f8e031067b45d1?s=128&d=identicon&r=PG", "display_name": "SJHowe", "link": "https://stackoverflow.com/users/1948525/sjhowe"}, "is_accepted": false, "score": 0, "last_activity_date": 1530756994, "creation_date": 1530756994, "answer_id": 51182585, "question_id": 51181151, "link": "https://stackoverflow.com/questions/51181151/why-doesnt-vector-support-size-as-member-variable-like-length-variable-in-a-java/51182585#51182585", "title": "Why doesnt vector support size as member variable like length variable in a Java class, instead a function size()?", "body": "<blockquote>\n  <p>Why doesn't std::vector or other containers have length as a member\n  variable, instead of a function?</p>\n</blockquote>\n\n<p>Because if length was member, it has 2 downsides:\n(i) sizeof(vector) will be bigger because of this member.\n(ii) any operations than change the vector: clear(), insert(), erase(), push_back(), pop_back(), emplace_back() swap() will have to adjust this member which would make these operations slower.</p>\n\n<p>It is not necessarily slower either because if size() is implemented as  wrapper function returning member data, this will be inlined by a good compiler.</p>\n\n<p>As it stands, vector is typically implemented as 3 pointers: a pointer to the start of a memory block, a pointer to just beyond the last valid element and a pointer to just beyond the end of the memory block. size() is then the difference between the last valid element and the start of the memory block (in terms of number of elements). It is similar to ptrdiff_t.</p>\n\n<p>Member functions give freedom to the vendor to implement as they see best, making sure they comply with the ISO C++ standard.</p>\n"}], "owner": {"reputation": 49, "user_id": 5758472, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-P0nlyQLOnOE/AAAAAAAAAAI/AAAAAAAAS58/CegyDH-AWrs/photo.jpg?sz=128", "display_name": "sam", "link": "https://stackoverflow.com/users/5758472/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "closed_date": 1530769985, "accepted_answer_id": 51181253, "answer_count": 2, "score": -6, "last_activity_date": 1530756994, "creation_date": 1530741299, "last_edit_date": 1530742925, "question_id": 51181151, "link": "https://stackoverflow.com/questions/51181151/why-doesnt-vector-support-size-as-member-variable-like-length-variable-in-a-java", "closed_reason": "Needs details or clarity", "title": "Why doesnt vector support size as member variable like length variable in a Java class, instead a function size()?", "body": "<p>Why doesn't <code>std::vector</code> or other containers have <code>length</code> as a member variable, instead of a function? Reading a vector's size using a function is more costly than a member variable.</p>\n\n<pre><code>vector&lt;int&gt; v;\n....\nfor (int i = 0; i &lt; v.size(); i++) {\n....\n}\n</code></pre>\n\n<p>In the above example, it should always call <code>size()</code> function, and it requires more CPU cycle. I think Java library uses more optimized approach in this than C++ STL in the design.</p>\n\n<p>I understand it has a private member function and library designers likely wanted to restrict to access from outside of a class.</p>\n\n<p>Any comment/idea?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1530740447, "post_id": 51181008, "comment_id": 89344504, "body": "You should submit a bug report to the library developers."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1530740515, "post_id": 51181008, "comment_id": 89344527, "body": "The only thing you can do is implement a facade in your code for this library that only includes their header files, and your header file with your facade&#39;s interface, then write your main C++ code to use the facade."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1530740554, "post_id": 51181008, "comment_id": 89344538, "body": "You can try defining <code>_STDINT_H</code> as a workaround. Or maybe it is supposed to be defined though a config header of some kind. <code>systemdeps.h</code> file is a total mess..."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 7, "creation_date": 1530740614, "post_id": 51181008, "comment_id": 89344552, "body": "Just guessing, but if you add <code>#include &lt;stdint.h&gt;</code> before any of those Jack headers the problem will probably be fixed. That way you&#39;ll get the definitions of those types from <code>&lt;stdint.h&gt;</code> as well as the include guard (assuming that they&#39;re right that the name of the include guard is <code>_STDINT_H</code>)."}, {"owner": {"reputation": 65, "user_id": 6015512, "user_type": "registered", "profile_image": "https://graph.facebook.com/1696136883991665/picture?type=large", "display_name": "Chris Walker", "link": "https://stackoverflow.com/users/6015512/chris-walker"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1530741791, "post_id": 51181008, "comment_id": 89344831, "body": "@PeteBecker Checking the referenced <code>stdint.h</code>, the guard is <code>_STDINT</code>, not <code>STDINT_H</code>! Doh! Will definetely contact the developers. Thanks much - never would have figured this out myself. Is it worth adding this as an answer? Or just closing the Q?"}, {"owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1530742898, "post_id": 51181008, "comment_id": 89345083, "body": "Chris and @PeteBecker: it is worth promoting Pete&#39;s comment to an answer. It can be really useful to people using Jack."}], "answers": [{"tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": true, "score": 3, "last_activity_date": 1530762665, "creation_date": 1530762665, "answer_id": 51183150, "question_id": 51181008, "link": "https://stackoverflow.com/questions/51181008/c-third-party-library-typedef-conflicts-with-standard-stdin-h/51183150#51183150", "title": "C++ third party library typedef conflicts with standard stdin.h", "body": "<p>That <code>\u201dsystemdeps.h\u201d</code>does a rather bad job of providing those typedefs. From your comment, it\u2019s checking for the wrong include guard. Even if it was right, you\u2019d run into problems if you included <code>&lt;stdint.h&gt;</code> after that header. So you have to do two things. First, wherever you use any of those <code>jack</code> headers, add <code>#include &lt;stdint.h&gt;</code> <strong>before</strong> you include the <code>jack</code> headers. And second, immediately after <code>#include &lt;stdint.h&gt;</code> add <code>#define _STDINT_H</code>. That way you get the typedefs from the compiler\u2019s header and you tell <code>\u201dsystemdeps.h\u201d</code> not to provide its own definitions. That\u2019s tedious and error-prone, so you might consider creating your own header that does all of that in one place.</p>\n"}], "owner": {"reputation": 65, "user_id": 6015512, "user_type": "registered", "profile_image": "https://graph.facebook.com/1696136883991665/picture?type=large", "display_name": "Chris Walker", "link": "https://stackoverflow.com/users/6015512/chris-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "accepted_answer_id": 51183150, "answer_count": 1, "score": 1, "last_activity_date": 1530762665, "creation_date": 1530740242, "question_id": 51181008, "link": "https://stackoverflow.com/questions/51181008/c-third-party-library-typedef-conflicts-with-standard-stdin-h", "title": "C++ third party library typedef conflicts with standard stdin.h", "body": "<h2>The issue</h2>\n\n<p>I'm attempting to write a program that listens to audio streams created using <a href=\"https://github.com/jackaudio/jack2\" rel=\"nofollow noreferrer\">JACK audio server</a>. The package works fine when consumed on it's own, however when I attempt to use it in a file alongside a reference to a standard c++ lib such as iostream, typedef conflict errors are thrown between the 3rd party lib and stdint.h.</p>\n\n<p>For the file, I'm using <code>jack/jack.h</code> and <code>jack/types.h</code>, both from the JACK package. They include references to the <code>systemdeps.h</code> file (expanded on below), which is the source of the error.</p>\n\n<p>I've attempted to find solutions online, however nothing seems to work. Any insights into what may be causing this, or a point in the right direction to fix the issue would be greatly appreciated.</p>\n\n<h3>Error messages</h3>\n\n<pre><code>2&gt;\\Jack\\includes\\jack/systemdeps.h(69): error C2371: 'int8_t': redefinition; different basic types (compiling source file src\\jack\\jack_interface.cpp)\n\n2&gt;stdint.h(17): note: see declaration of 'int8_t' (compiling source file src\\jack\\jack_interface.cpp)\n\n2&gt;\\Jack\\includes\\jack/systemdeps.h(73): error C2371: 'int32_t': redefinition; different basic types (compiling source file src\\jack\\jack_interface.cpp)\n\n2&gt;stdint.h(19): note: see declaration of 'int32_t' (compiling source file src\\jack\\jack_interface.cpp)\n\n2&gt;\\Jack\\includes\\jack/systemdeps.h(74): error C2371: 'uint32_t': redefinition; different basic types (compiling source file src\\jack\\jack_interface.cpp)\n\n2&gt;stdint.h(23): note: see declaration of 'uint32_t' (compiling source file src\\jack\\jack_interface.cpp)\n</code></pre>\n\n<h3>My implementation</h3>\n\n<pre><code>// jack_interface.cpp\n#include &lt;iostream&gt;\n#include \"jack/jack.h\"                // Core library .h\n#include \"jack/types.h\"               // library types .h\n#include \"jack/jack_interface.h\"      // My .h extending the lib\n\nnamespace jack \n{\n}\n</code></pre>\n\n<p>This is the bare minimum I can write to cause the errors to be thrown. </p>\n\n<p>jack_interface.h is empty.</p>\n\n<p>jack.h and types.h both include references to systemdeps.h, where the conflict is being created.</p>\n\n<p>The errors are <strong>only</strong> thrown when both the library and any standard C++ file that references stdint.h are both included, e.g. iostream. If I remove iostream, the library functions 100%.</p>\n\n<p>The libraries I'm using from the 3rd party package are for 32 bit Windows. I'm compiling for 32 bit using Visual Studio 2017.</p>\n\n<h3>systemdeps.h</h3>\n\n<p>The library header file where the conflicts are being thrown. The lines throwing the errors have been marked below. <a href=\"https://github.com/jackaudio/jack2/blob/master/common/jack/systemdeps.h\" rel=\"nofollow noreferrer\">See file on github here.</a></p>\n\n<pre><code>#if defined(_WIN32) &amp;&amp; !defined(__CYGWIN__) &amp;&amp; !defined(GNU_WIN32)\n\n#include &lt;windows.h&gt;\n\n#ifdef _MSC_VER     /* Microsoft compiler */\n    #define __inline__ inline\n    #if (!defined(int8_t) &amp;&amp; !defined(_STDINT_H))\n        #define __int8_t_defined\n        typedef char int8_t;                 &lt;-- ERROR\n        typedef unsigned char uint8_t;\n        typedef short int16_t;\n        typedef unsigned short uint16_t;\n        typedef long int32_t;                &lt;-- ERROR\n        typedef unsigned long uint32_t;      &lt;-- ERROR\n        typedef LONGLONG int64_t;\n        typedef ULONGLONG uint64_t;\n    #endif\n</code></pre>\n"}, {"tags": ["c++", "macos", "cmake", "linker-errors"], "comments": [{"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530739924, "post_id": 51180680, "comment_id": 89344371, "body": "Maybe the default c++ standard version has changed, are you selecting explicitely a version of the c++ standard in the CMakeFile, or are you letting CMake chose one? (please include the CMakeFile)"}, {"owner": {"reputation": 796, "user_id": 3124459, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/P0T9Y.jpg?s=128&g=1", "display_name": "Dovahkiin", "link": "https://stackoverflow.com/users/3124459/dovahkiin"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530761208, "post_id": 51180680, "comment_id": 89347984, "body": "I don&#39;t think that&#39;s the issue, as I tried with and without the <code>-std=c++1y</code> line. @OlivierSohn"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530763283, "post_id": 51180680, "comment_id": 89348338, "body": "Use a verbose build option, find out what commands actually run at compilation and link stages, and proceed from there."}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 2, "creation_date": 1530774274, "post_id": 51180680, "comment_id": 89352188, "body": "@Dovahkiin according to <a href=\"https://gcc.gnu.org/onlinedocs/gcc/C-Dialect-Options.html#index-std-108\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/C-Dialect-Options.html#index-std-&zwnj;&#8203;108</a> <code>c++1y</code> is deprecated, you should probably use <code>c++14</code> instead"}, {"owner": {"reputation": 796, "user_id": 3124459, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/P0T9Y.jpg?s=128&g=1", "display_name": "Dovahkiin", "link": "https://stackoverflow.com/users/3124459/dovahkiin"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530878938, "post_id": 51180680, "comment_id": 89400830, "body": "Okay, I tried it, but it didn&#39;t change the error. @OlivierSohn"}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530884527, "post_id": 51180680, "comment_id": 89404341, "body": "Maybe some compilation unit (or some library you link with) has seen headers from a different version of the C++ (there were changes on basic_string in c++17, this is what makes me think about that)."}, {"owner": {"reputation": 1714, "user_id": 7404323, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jYEFn.png?s=128&g=1", "display_name": "sailfish009", "link": "https://stackoverflow.com/users/7404323/sailfish009"}, "edited": false, "score": 0, "creation_date": 1531017838, "post_id": 51180680, "comment_id": 89436762, "body": "<a href=\"https://stackoverflow.com/questions/27508451/cmake-error-undefined-symbols-for-x86-64\" title=\"cmake error undefined symbols for x86 64\">stackoverflow.com/questions/27508451/&hellip;</a>"}, {"owner": {"reputation": 796, "user_id": 3124459, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/P0T9Y.jpg?s=128&g=1", "display_name": "Dovahkiin", "link": "https://stackoverflow.com/users/3124459/dovahkiin"}, "reply_to_user": {"reputation": 1714, "user_id": 7404323, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jYEFn.png?s=128&g=1", "display_name": "sailfish009", "link": "https://stackoverflow.com/users/7404323/sailfish009"}, "edited": false, "score": 0, "creation_date": 1531097540, "post_id": 51180680, "comment_id": 89453130, "body": "That doesn&#39;t really apply to this problem... @sailfish009"}, {"owner": {"reputation": 1714, "user_id": 7404323, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jYEFn.png?s=128&g=1", "display_name": "sailfish009", "link": "https://stackoverflow.com/users/7404323/sailfish009"}, "edited": false, "score": 0, "creation_date": 1531101947, "post_id": 51180680, "comment_id": 89453812, "body": "@Dovahkiin good to know."}, {"owner": {"reputation": 4097, "user_id": 2646505, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/XGEyF.jpg?s=128&g=1", "display_name": "Tom de Geus", "link": "https://stackoverflow.com/users/2646505/tom-de-geus"}, "edited": false, "score": 0, "creation_date": 1531571017, "post_id": 51180680, "comment_id": 89651371, "body": "What would help here is a minimal reproducible example. Also, maybe a bit naively, have you removed all (temporary) build files of the porject after updating?"}], "answers": [{"tags": [], "owner": {"reputation": 796, "user_id": 3124459, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/P0T9Y.jpg?s=128&g=1", "display_name": "Dovahkiin", "link": "https://stackoverflow.com/users/3124459/dovahkiin"}, "is_accepted": true, "score": -1, "last_activity_date": 1531098377, "creation_date": 1531098377, "answer_id": 51237154, "question_id": 51180680, "link": "https://stackoverflow.com/questions/51180680/updating-cmake-seems-to-have-broke-my-program/51237154#51237154", "title": "Updating CMake (seems to have) broke my program", "body": "<p>Well, I'm not sure why it worked, but all of the functions in the program were marked <code>static</code> and removing that made the errors go away. Go figure.</p>\n"}], "owner": {"reputation": 796, "user_id": 3124459, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/P0T9Y.jpg?s=128&g=1", "display_name": "Dovahkiin", "link": "https://stackoverflow.com/users/3124459/dovahkiin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 51237154, "answer_count": 1, "score": 2, "last_activity_date": 1531098377, "creation_date": 1530737928, "last_edit_date": 1531016588, "question_id": 51180680, "link": "https://stackoverflow.com/questions/51180680/updating-cmake-seems-to-have-broke-my-program", "title": "Updating CMake (seems to have) broke my program", "body": "<p>I updated from CMake 3.6 to whatever the latest version is (3.12.0-rc2) and now one of my programs won't compile.</p>\n\n<p>The weird thing is, the error message shows undefined symbols from in the standard library itself. Here's the error message:</p>\n\n<pre><code>Undefined symbols for architecture x86_64:\n  \"std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;::basic_string(char const*)\", referenced from:\n      GetName() in ncc.cpp.o\n      Expression() in ncc.cpp.o\n      Term() in ncc.cpp.o\n      GetNum() in ncc.cpp.o\n  \"std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;::basic_string()\", referenced from:\n      GetName() in ncc.cpp.o\n      GetNum() in ncc.cpp.o\n  \"std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;::operator+=(char)\", referenced from:\n      GetName() in ncc.cpp.o\n      GetNum() in ncc.cpp.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake[2]: *** [ncc] Error 1\nmake[1]: *** [CMakeFiles/ncc.dir/all] Error 2\nmake: *** [all] Error 2\n</code></pre>\n\n<p>How do I fix this? Do I need to link to a different version of the standard library? And if so, how I tell CMake that?</p>\n\n<p>Here's my CMakeLists.txt file:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.0)\n\nproject(ncc)\n\nadd_definitions(-std=c++14)\n\nadd_subdirectory(${CMAKE_SOURCE_DIR}/src/)\n\nadd_executable(ncc ${CompSource})\nadd_executable(ncc-opt ${OptSource})\nadd_executable(nci ${IntSource})\n</code></pre>\n\n<p>I tried it with the <code>add_definitions</code> line and without it, which didn't seem to make a difference.</p>\n\n<p>This is the relevant output from running <code>make VERBOSE=1</code>:</p>\n\n<pre><code>Scanning dependencies of target ncc\n/Applications/Xcode.app/Contents/Developer/usr/bin/make -f CMakeFiles/ncc.dir/build.make CMakeFiles/ncc.dir/build\n[ 83%] Building CXX object CMakeFiles/ncc.dir/src/ncc.cpp.o\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++    -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.12.sdk   -std=c++14 -o CMakeFiles/ncc.dir/src/ncc.cpp.o -c /Users/nepps/Dropbox/Projects/ncc/src/ncc.cpp\n[100%] Linking CXX executable ncc\n/usr/local/bin/cmake -E cmake_link_script CMakeFiles/ncc.dir/link.txt --verbose=1\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++   -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.12.sdk -Wl,-search_paths_first -Wl,-headerpad_max_install_names  CMakeFiles/ncc.dir/src/ncc.cpp.o  -o ncc \nUndefined symbols for architecture x86_64:\n(same errors as above)\n</code></pre>\n\n<p>Feel free to comment if you need more information. I'm using a MacBook pro running MacOS 10.13.3.</p>\n"}, {"tags": ["c++", "boost", "boost-graph"], "answers": [{"comments": [{"owner": {"reputation": 2862, "user_id": 4858640, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c3eef6d48a6bc20ea9c2c2825dc9c6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4858640/peter"}, "edited": false, "score": 0, "creation_date": 1530775288, "post_id": 51182007, "comment_id": 89352794, "body": "Okay, this makes it very clear. Thank you.  Also the `operator&lt;&lt; is a remnant that should not have been part of my question, I&#39;ll leave it in so that your answer makes more sense."}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 2, "last_activity_date": 1530750190, "creation_date": 1530750190, "answer_id": 51182007, "question_id": 51180222, "link": "https://stackoverflow.com/questions/51180222/bgl-unable-to-access-bundled-vertex-properties/51182007#51182007", "title": "BGL: Unable to access bundled vertex properties", "body": "<p>Using <code>property&lt;tag, type&gt;</code> is <strong>not</strong> a bundled property\u00b9.</p>\n\n<p>All those examples you are talking about will be using this style:</p>\n\n<pre><code>typedef boost::adjacency_list&lt;\n    edge_selector, vertex_selector, boost::bidirectionalS,\n    VertexProperty, EdgeProperty&gt; adjacency_type;\n</code></pre>\n\n<blockquote>\n  <p><strong>Note</strong> you had <code>edge_selector</code> and <code>vertex_selector</code> reversed.</p>\n</blockquote>\n\n<p>Of course, now you can't forward-declare. So you need to find another way to acces the graph traits before you have defined the adjacency_list itself:'</p>\n\n<pre><code>typedef boost::adjacency_list_traits&lt;edge_selector, vertex_selector, boost::bidirectionalS&gt; traits;\n</code></pre>\n\n<p>So you can have the size types ahead of time:</p>\n\n<pre><code>typedef traits::vertices_size_type size_type;\ntypedef traits::edges_size_type    edges_size_type;\n</code></pre>\n\n<h2>Demo</h2>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/b0a7a5ec9c0221dc\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/graph/adjacency_list.hpp&gt;\n#include &lt;iostream&gt;\n\nstruct ArchGraph;\n\nclass Graph\n{\n    friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const ArchGraph &amp;);\n\n    struct VertexProperty;\n    struct EdgeProperty;\n\n    typedef boost::vecS vertex_selector;\n    typedef boost::vecS edge_selector;\n\n    typedef boost::adjacency_list_traits&lt;edge_selector, vertex_selector, boost::bidirectionalS&gt; traits;\n\n    typedef traits::vertices_size_type size_type;\n    typedef traits::edges_size_type    edges_size_type;\n\n    struct VertexProperty {\n        size_type id;\n    };\n\n    struct EdgeProperty {\n        edges_size_type index;\n        size_type id;\n    };\n\n    typedef boost::adjacency_list&lt;\n        edge_selector, vertex_selector, boost::bidirectionalS,\n        VertexProperty, EdgeProperty&gt; adjacency_type;\n\n  public:\n    Graph() : _adj(3) {\n        for (auto vd : boost::make_iterator_range(vertices(_adj)))\n            _adj[vd].id = (vd+1)*10;\n    }\n    void foo() const;\n\n  private:\n    adjacency_type _adj;\n};\n\nvoid Graph::foo() const\n{\n    for (auto v : boost::make_iterator_range(boost::vertices(_adj))) {\n        std::cout &lt;&lt; _adj[v].id &lt;&lt; \" \";\n    }\n}\n\nint main() {\n    Graph g;\n\n    g.foo();\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>10 20 30 \n</code></pre>\n\n<hr>\n\n<p>\u00b9  (On the contrary, it's the old-style what's called \"interior property\" if I remember correctly)</p>\n"}], "owner": {"reputation": 2862, "user_id": 4858640, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c3eef6d48a6bc20ea9c2c2825dc9c6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4858640/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 51182007, "answer_count": 1, "score": 1, "last_activity_date": 1530750190, "creation_date": 1530734739, "question_id": 51180222, "link": "https://stackoverflow.com/questions/51180222/bgl-unable-to-access-bundled-vertex-properties", "title": "BGL: Unable to access bundled vertex properties", "body": "<p>I have a dummy class defined as such:</p>\n\n<pre><code>class Graph\n{\n  friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const ArchGraph &amp;);\n\n  struct VertexProperty;\n  struct EdgeProperty;\n\n  typedef boost::vecS vertex_selector;\n  typedef boost::vecS edge_selector;\n\n  typedef boost::property&lt;boost::vertex_name_t, VertexProperty&gt; vertex_property;\n  typedef boost::property&lt;boost::edge_name_t, EdgeProperty&gt; edge_property;\n\n  typedef boost::adjacency_list&lt;\n    vertex_selector, edge_selector, boost::bidirectionalS,\n    vertex_property, edge_property&gt; adjacency_type;\n\n  typedef size_t size_type;\n\n  struct VertexProperty {\n    size_type id;\n  };\n\n  struct EdgeProperty {\n    adjacency_type::edges_size_type index;\n    size_type id;\n  };\n\npublic:\n  void foo() const;\n\nprivate:\n  adjacency_type _adj;\n};\n</code></pre>\n\n<p>And in it's <code>foo</code> method I try to iterate over all vertices in the adjacency list <code>_adj</code> and print the <code>id</code> member of each vertex property:</p>\n\n<pre><code>void Graph::foo() const\n{\n  for (auto v : boost::make_iterator_range(boost::vertices(_adj))) {\n    std::cout &lt;&lt; _adj[v].id;\n  }\n}\n</code></pre>\n\n<p>This does not compile, apparently <code>_adj[v]</code> has type <code>const struct boost::no_property</code> which is not what I expected.</p>\n\n<p>This seems a little ridiculous to me, seeing as there seem to many examples floating around  which seem take exactly this approach.</p>\n\n<p>I'm using Boost 1.67.0, can anybody enlighten me as to what I'm doing wrong here? The documentation is not very helpful in this regard.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 2, "creation_date": 1530735153, "post_id": 51180121, "comment_id": 89342939, "body": "Related: <a href=\"https://stackoverflow.com/questions/21355037/why-does-unique-ptr-take-two-template-parameters-when-shared-ptr-only-takes-one\">Why does unique_ptr take two template parameters when shared_ptr only takes one?</a>"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1530735394, "post_id": 51180121, "comment_id": 89343030, "body": "@JesperJuhl: Except precisely <i>not</i> in the OP&#39;s case."}], "answers": [{"comments": [{"owner": {"reputation": 2001, "user_id": 383689, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0c2bbd52fe81c4908f89636976ba8712?s=128&d=identicon&r=PG", "display_name": "Grim Fandango", "link": "https://stackoverflow.com/users/383689/grim-fandango"}, "edited": false, "score": 0, "creation_date": 1530734736, "post_id": 51180186, "comment_id": 89342819, "body": "Yes, but why don&#39;t I have to do this instantiation in std::shared_ptr ?"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 2001, "user_id": 383689, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0c2bbd52fe81c4908f89636976ba8712?s=128&d=identicon&r=PG", "display_name": "Grim Fandango", "link": "https://stackoverflow.com/users/383689/grim-fandango"}, "edited": false, "score": 1, "creation_date": 1530735046, "post_id": 51180186, "comment_id": 89342906, "body": "@GrimFandango Because they handle deleters differently. For <code>unique_ptr</code> deleter is a part of the type while <code>shared_ptr</code> embeds deleter into implicitly created shared state so deleter type is not part of the type. For <code>shared_ptr</code> different shared states might be instantiated based on deleter supplied into constructor."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1530861262, "post_id": 51180186, "comment_id": 89390761, "body": "I like the use of <code>decltype</code> here - very neat."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1530861539, "post_id": 51180186, "comment_id": 89390897, "body": "<i><code>shared_ptr</code> embeds deleter into implicitly created shared state</i> right, I understand that now, but why does it do it differently, there seems to be no obvious reason?  I guess it&#39;s just history,  <code>shared_ptr</code> dating back to C++03 and all.  I think we could say they got it wrong back then."}], "tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": false, "score": 2, "last_activity_date": 1530734508, "creation_date": 1530734508, "answer_id": 51180186, "question_id": 51180121, "link": "https://stackoverflow.com/questions/51180121/assymetry-between-stdshared-ptr-and-stdunique-ptr-constructors/51180186#51180186", "title": "assymetry between std::shared_ptr and std::unique_ptr constructors", "body": "<p>You should supply deleter type</p>\n\n<pre><code>std::unique_ptr&lt;Y, decltype(&amp;special_delete)&gt; o{new Y{}, &amp;special_delete};\n</code></pre>\n\n<p>Note that replacing <code>tr1::shared_ptr&lt;X&gt; o(new X);</code> with <code>std::unique_ptr&lt;X&gt; o(new X);</code> is not a good idea and is not supposed to work in general. <code>std::unique_ptr</code> is more like a replacement for <code>auto_ptr</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1530746367, "post_id": 51180281, "comment_id": 89345658, "body": "And possibly something like: <code>template &lt;auto f&gt; struct Deleter { template &lt;typename T&gt; void operator()(T* p) {f(p);} };</code> and then <code>using YDeleter = Deleter&lt;&amp;special_delete&gt;;</code>."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1530775275, "post_id": 51180281, "comment_id": 89352781, "body": "Isn&#39;t this answer pretty much what the OP had in the first place? (Which I myself saw nothing wrong with)."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1530826199, "post_id": 51180281, "comment_id": 89381950, "body": "@PaulSanders: How so? My deleter is stateless, the OP&#39;s is not."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1530826825, "post_id": 51180281, "comment_id": 89382154, "body": "Oh right, I see it now, thanks.  I myself did it the same way as you a while back, don&quot;t know why I forgot that."}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 4, "last_activity_date": 1530735143, "creation_date": 1530735143, "answer_id": 51180281, "question_id": 51180121, "link": "https://stackoverflow.com/questions/51180121/assymetry-between-stdshared-ptr-and-stdunique-ptr-constructors/51180281#51180281", "title": "assymetry between std::shared_ptr and std::unique_ptr constructors", "body": "<p>The <code>shared_ptr</code> template type-erases the deleter. There's only one single type <code>shared_ptr&lt;T&gt;</code> for any kind of deleter you want. It's a very heavy-weight (and expensive) tool.</p>\n\n<p>By contrast, the <code>unique_ptr</code> makes the deleter part of the type, and so it has no dynamic call overhead. A <code>unique_ptr&lt;T, D&gt;</code> is very nearly as cheap as a raw pointer.</p>\n\n<p>Note that you can construct a <code>shared_ptr&lt;T&gt;</code> from a <code>unique_ptr&lt;T, D&gt;</code> rvalue for <em>any</em> deleter type <code>D</code>.</p>\n\n<hr>\n\n<p>Random commentary on your solutions: neither solution is great. Using the function pointer as the deleter needlessly makes the deleter a <em>dynamic</em> part of your unique_ptr state. The <code>std::function</code> case is even worse, using an entire type-erasing virtual dispatch mechanism for the deletion -- keeping in mind that you know <em>statically</em> how to delete!</p>\n\n<p>The better solution is to make the deleter part of the <em>type</em>, not part of the value, by writing your own type:</p>\n\n<pre><code>struct YDeleter { void operator()(Y* p) { special_delete(p); } };\n\nstd::unique_ptr&lt;Y, YDeleter&gt; p(new Y);   // or presumaby some special factory\n</code></pre>\n\n<p>That way, the entire deletion logic is known at compile time and can be inlined as much as possible, without <em>additional</em> function call indirection.</p>\n"}], "owner": {"reputation": 2001, "user_id": 383689, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0c2bbd52fe81c4908f89636976ba8712?s=128&d=identicon&r=PG", "display_name": "Grim Fandango", "link": "https://stackoverflow.com/users/383689/grim-fandango"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1530735143, "creation_date": 1530734150, "question_id": 51180121, "link": "https://stackoverflow.com/questions/51180121/assymetry-between-stdshared-ptr-and-stdunique-ptr-constructors", "title": "assymetry between std::shared_ptr and std::unique_ptr constructors", "body": "<p>During C++03 we did not have <code>unique_ptr</code>, so I had used the <code>tr1::shared_ptr</code> instead.</p>\n\n<p>Now, in C++11, in such cases, I am replacing calls like this:</p>\n\n<pre><code>tr1::shared_ptr&lt;X&gt; o(new X); \n</code></pre>\n\n<p>with</p>\n\n<pre><code>std::unique_ptr&lt;X&gt; o(new X);\n</code></pre>\n\n<p>Unfortunately, for some reason, I cannot replace cases containg a deleter, where the deleter is a function:</p>\n\n<pre><code>void special_delete(Y *p) { ... }\n\ntr1::shared_ptr&lt;Y&gt; o(new Y(), special_delete); \n\n\nstd::unique_ptr&lt;Y&gt; o(new Y(), special_delete);  // does not compile\nstd::unique_ptr&lt;Y, std::function&lt;void(Y*)&gt; &gt; o(new Y(), special_delete);  // this compiles\n</code></pre>\n\n<p>Why does this happen?\nIs there a homogeneous way I can replace all shared_ptr constructors with unique_ptr constructors ?</p>\n\n<p>I have created <strong>this</strong>, but I am not really happy about it..</p>\n\n<pre><code>template &lt;class Y&gt;\nusing unique_ptr_with_deleter = std::unique_ptr&lt;Y, std::function&lt;void(Y*)&gt; &gt;;\n\nunique_ptr_with_deleter&lt;Y&gt; o(new Y(), special_delete);  // this compiles\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1530734148, "post_id": 51180109, "comment_id": 89342622, "body": "Do these have a common base-class? Could they have one? If so it&#39;s easy. If not the answer is basically &quot;no&quot;."}, {"owner": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 1, "creation_date": 1530734334, "post_id": 51180109, "comment_id": 89342682, "body": "You can always design a wrapper class to expose them in a common interface."}, {"owner": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 2, "creation_date": 1530734540, "post_id": 51180109, "comment_id": 89342745, "body": "<a href=\"https://github.com/esp8266/Arduino/blob/master/cores/esp8266/HardwareSerial.h\" rel=\"nofollow noreferrer\">HardwareSerial</a> and <a href=\"https://github.com/espressif/arduino-esp32/blob/master/libraries/BluetoothSerial/src/BluetoothSerial.h\" rel=\"nofollow noreferrer\">BluetoothSerial</a> both seem derived from <a href=\"https://github.com/esp8266/Arduino/blob/master/cores/esp8266/Stream.h\" rel=\"nofollow noreferrer\">Stream</a>, so perhaps <code>Stream &amp;Debugger</code> should work just fine?"}, {"owner": {"reputation": 387, "user_id": 4611356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ov8Z3C9Hge0/AAAAAAAAAAI/AAAAAAAAAJE/M0IAkvKcd9o/photo.jpg?sz=128", "display_name": "david", "link": "https://stackoverflow.com/users/4611356/david"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1530734657, "post_id": 51180109, "comment_id": 89342793, "body": "@tadman yeah these two class are derived from the same class"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1530734731, "post_id": 51180109, "comment_id": 89342816, "body": "Then if that&#39;s a pointer it&#39;ll be pretty easy to assign. C++ shouldn&#39;t complain."}, {"owner": {"reputation": 387, "user_id": 4611356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ov8Z3C9Hge0/AAAAAAAAAAI/AAAAAAAAAJE/M0IAkvKcd9o/photo.jpg?sz=128", "display_name": "david", "link": "https://stackoverflow.com/users/4611356/david"}, "reply_to_user": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 0, "creation_date": 1530735282, "post_id": 51180109, "comment_id": 89342997, "body": "@orhtej2 you are right they are both derived from Stream i compiled Stream *Debugger and it sent error"}, {"owner": {"reputation": 387, "user_id": 4611356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ov8Z3C9Hge0/AAAAAAAAAAI/AAAAAAAAAJE/M0IAkvKcd9o/photo.jpg?sz=128", "display_name": "david", "link": "https://stackoverflow.com/users/4611356/david"}, "edited": false, "score": 0, "creation_date": 1530735300, "post_id": 51180109, "comment_id": 89343002, "body": "BluetoothSerial.cpp.o:(.bss.client+0x0): multiple definition of `client"}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 2, "creation_date": 1530735649, "post_id": 51180109, "comment_id": 89343113, "body": "include the full error and relevant code in your question"}, {"owner": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 2, "creation_date": 1530736295, "post_id": 51180109, "comment_id": 89343294, "body": "Create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, because that sounds like you messed up something unrelated. If <code>class B</code> and <code>class C</code> both inherit from <code>class A</code>, then <code>A *a = new B()</code> <i>will</i> work; likewise, if you have <code>B b</code>, then <code>A *a = &amp;b</code> will as well."}, {"owner": {"reputation": 387, "user_id": 4611356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ov8Z3C9Hge0/AAAAAAAAAAI/AAAAAAAAAJE/M0IAkvKcd9o/photo.jpg?sz=128", "display_name": "david", "link": "https://stackoverflow.com/users/4611356/david"}, "edited": false, "score": 0, "creation_date": 1530737725, "post_id": 51180109, "comment_id": 89343692, "body": "@ Nic Hartley you are totally right. i wrote a minimal program and it worked thanks to all especially you and orhtej2"}], "answers": [{"tags": [], "owner": {"reputation": 387, "user_id": 4611356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ov8Z3C9Hge0/AAAAAAAAAAI/AAAAAAAAAJE/M0IAkvKcd9o/photo.jpg?sz=128", "display_name": "david", "link": "https://stackoverflow.com/users/4611356/david"}, "is_accepted": true, "score": 1, "last_activity_date": 1530739231, "creation_date": 1530739231, "answer_id": 51180868, "question_id": 51180109, "link": "https://stackoverflow.com/questions/51180109/how-to-assign-two-different-type-variable-to-one-variable-in-c/51180868#51180868", "title": "How to assign two different type variable to one variable in c++", "body": "<p>based on Comments and the fact that HardwareSerial and BluetoothSerial class are both derived from Stream class, I added </p>\n\n<pre><code>Stream *Debugger\n</code></pre>\n\n<p>and it worked</p>\n"}], "owner": {"reputation": 387, "user_id": 4611356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ov8Z3C9Hge0/AAAAAAAAAAI/AAAAAAAAAJE/M0IAkvKcd9o/photo.jpg?sz=128", "display_name": "david", "link": "https://stackoverflow.com/users/4611356/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 51180868, "answer_count": 1, "score": 0, "last_activity_date": 1530739231, "creation_date": 1530734082, "last_edit_date": 1530739171, "question_id": 51180109, "link": "https://stackoverflow.com/questions/51180109/how-to-assign-two-different-type-variable-to-one-variable-in-c", "title": "How to assign two different type variable to one variable in c++", "body": "<p>I wrote a program that uses a normal Serial port and a Bluetooth Serial Port to send logs to UART and Bluetooth respectively</p>\n\n<pre><code>HardwareSerial Serial;\nBluetoothSerial SerialBT;\n</code></pre>\n\n<p>for example when i want to send something with them i write this</p>\n\n<pre><code>Serial.println(\"Hello World\"); //prints Hello world in normal Serial port\nSerialBT.println(\"Hello World\"); // prints Hello World in Bluetooth serial\n</code></pre>\n\n<p>i defined some preprocessors that checks whether Bluetooth or Normal Serial port is active and if one of them is active print in the active one</p>\n\n<p>my problem is here that i want to declare a variable like \"Debugger\" that i can assign it with \"SerialBT\" or \"Serial\" to write something like this</p>\n\n<p>somewere in my init function</p>\n\n<pre><code>#if BLUETOOTHDEBUG\nDebugger=&amp;SerialBT;\n#else\nDebugger=&amp;Serial;\n#endif\n</code></pre>\n\n<p>and in code</p>\n\n<pre><code>Debbugger-&gt;println(\"Hello World\")\n</code></pre>\n\n<p>instead of using if in whole code</p>\n"}, {"tags": ["c++", "c++11", "search"], "comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1530735535, "post_id": 51180011, "comment_id": 89343076, "body": "How did you test <code>is_pal(...)</code>?"}, {"owner": {"reputation": 67, "user_id": 9926394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVY6g.jpg?s=128&g=1", "display_name": "Andy N.", "link": "https://stackoverflow.com/users/9926394/andy-n"}, "reply_to_user": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1530736213, "post_id": 51180011, "comment_id": 89343272, "body": "What do you mean by this? I first converted the square of the original number to the correct base, and then put that into is_pal to test if it is a palindrome."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1530736556, "post_id": 51180011, "comment_id": 89343371, "body": "A note on <code>convert</code>,  all those <code>pow</code>s are going to be brutally slow and imprecise. <code>pow</code> operates on floating point numbers and you may find the results are off just a little bit (like 24.99999999 instead of 25) and then get rounded down. You can write your own function that computes purely integer powers <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/stoul\" rel=\"nofollow noreferrer\">or you can use <code>std::stoul</code></a>"}, {"owner": {"reputation": 67, "user_id": 9926394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVY6g.jpg?s=128&g=1", "display_name": "Andy N.", "link": "https://stackoverflow.com/users/9926394/andy-n"}, "edited": false, "score": 0, "creation_date": 1530736795, "post_id": 51180011, "comment_id": 89343438, "body": "thank you for the suggestion, I will write my own power function. But, does anyone know why the output is empty? Thanks!"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1530736841, "post_id": 51180011, "comment_id": 89343448, "body": "What Beta is getting at is have you tested <code>is_pal</code> on it&#39;s own with known values to ensure that it works?"}, {"owner": {"reputation": 67, "user_id": 9926394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVY6g.jpg?s=128&g=1", "display_name": "Andy N.", "link": "https://stackoverflow.com/users/9926394/andy-n"}, "edited": false, "score": 0, "creation_date": 1530737083, "post_id": 51180011, "comment_id": 89343506, "body": "I am doing that now... and I will tell the results soon."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1530737171, "post_id": 51180011, "comment_id": 89343527, "body": "Example, in base 2 101010101 is a palindrome. In decimal this number is 341, so if you call <code>is_pal(341)</code>, do you get true? Start with proving the math, then worry about writing files."}, {"owner": {"reputation": 67, "user_id": 9926394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVY6g.jpg?s=128&g=1", "display_name": "Andy N.", "link": "https://stackoverflow.com/users/9926394/andy-n"}, "edited": false, "score": 0, "creation_date": 1530737499, "post_id": 51180011, "comment_id": 89343626, "body": "thank you, I will work to verify this, and will get back asap with results (probably in around 1 hour)."}, {"owner": {"reputation": 67, "user_id": 9926394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVY6g.jpg?s=128&g=1", "display_name": "Andy N.", "link": "https://stackoverflow.com/users/9926394/andy-n"}, "edited": false, "score": 0, "creation_date": 1530737779, "post_id": 51180011, "comment_id": 89343710, "body": "by the way, when I call is_pal I am directly feeding it the argument in the changed base form, by calling convert on the decimal number and then putting the result into is_pal."}, {"owner": {"reputation": 67, "user_id": 9926394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVY6g.jpg?s=128&g=1", "display_name": "Andy N.", "link": "https://stackoverflow.com/users/9926394/andy-n"}, "edited": false, "score": 0, "creation_date": 1530738625, "post_id": 51180011, "comment_id": 89343972, "body": "I figured out a big part of it: my convert function was actually converting from the changed base to decimal form, but it wasn&#39;t doing even that correctly! I will work to fix this now, and back with the results. Thanks!"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1530738628, "post_id": 51180011, "comment_id": 89343975, "body": "At the very least, calculate your result once and then use the calculated result if you need to output it. Calling <code>convert(to_string((pow(i, 2))</code> twice is terribly inefficient. An added bonus of caching intermediate results is that you can more easily see them in the debugger."}, {"owner": {"reputation": 67, "user_id": 9926394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVY6g.jpg?s=128&g=1", "display_name": "Andy N.", "link": "https://stackoverflow.com/users/9926394/andy-n"}, "edited": false, "score": 0, "creation_date": 1530738769, "post_id": 51180011, "comment_id": 89344022, "body": "I am going to edit the post to show my updated code with my new power function, and comments to explain the sections for anyone that would need it. NOTE: the convert function is still incorrect, I will be working on this right after."}, {"owner": {"reputation": 3320, "user_id": 3480808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbca64f49de22131b4b51fddfa8a7df4?s=128&d=identicon&r=PG", "display_name": "Michael Doubez", "link": "https://stackoverflow.com/users/3480808/michael-doubez"}, "edited": false, "score": 1, "creation_date": 1530740438, "post_id": 51180011, "comment_id": 89344502, "body": "Your function to test if a number is a palindrom is terribly complicated: std::equal(str.begin(), str.end(),str.rbegin()) should be enough. And don&#39;t use pow(); what&#39;s wrong with i*i ?"}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1530741667, "post_id": 51181132, "comment_id": 89344803, "body": "The real genius of this approach is it takes a number and returns a string. The asker has numbers (1 through 300) as inputs and strings are much easier to test for palindromic behaviour (test that the outermost characters match and then work your way in to the middle)"}], "tags": [], "owner": {"reputation": 3320, "user_id": 3480808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbca64f49de22131b4b51fddfa8a7df4?s=128&d=identicon&r=PG", "display_name": "Michael Doubez", "link": "https://stackoverflow.com/users/3480808/michael-doubez"}, "is_accepted": false, "score": 1, "last_activity_date": 1530742270, "last_edit_date": 1530742270, "creation_date": 1530741135, "answer_id": 51181132, "question_id": 51180011, "link": "https://stackoverflow.com/questions/51180011/empty-output-file-on-complete-search-task/51181132#51181132", "title": "empty output file on complete search task", "body": "<p>In addition to my comments, the usual pattern for converting a number to base B is of the form:</p>\n\n<pre><code>std::string convert_base(int B, int num)\n{\n    assert(B&gt;1&amp;&amp;num&gt;=0);\n    char const digits[] =\"0123456789AB...Z\";\n    std::vector&lt;char&gt; str;\n    do\n    {\n        int const d = num%B;\n        num /= B;\n        str.push_back(digits[d]);\n    } while(num);\n\n    return std::string(str.rbegin(), str.rend());\n}\n</code></pre>\n\n<p>Complete answer is then:</p>\n\n<pre><code>bool is_pal(std::string const &amp; str)\n{\n    return std::equal(str.cbegin(), str.cend(), std.crbegin());\n}\n\nint const pow2_i = i*i;\nstd::string const pow2_baseB = convert_base(B, pow2_i);\nif(is_pal(pow2_baseB)) ...\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 9926394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVY6g.jpg?s=128&g=1", "display_name": "Andy N.", "link": "https://stackoverflow.com/users/9926394/andy-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1530742270, "creation_date": 1530733392, "last_edit_date": 1530738859, "question_id": 51180011, "link": "https://stackoverflow.com/questions/51180011/empty-output-file-on-complete-search-task", "title": "empty output file on complete search task", "body": "<p>I am working on a complete search problem, and have looked through the code, but could not figure out why my program keeps coming in with an empty output file error. Could anyone please help me find why this is happening? The problem statement is below, and then after that is my code.</p>\n\n<p><strong>PROBLEM STATEMENT</strong>: Palindromes are numbers that read the same forwards as backwards. The number 12321 is a typical palindrome.</p>\n\n<p>Given a number base B (2 &lt;= B &lt;= 20 base 10), print all the integers N (1 &lt;= N &lt;= 300 base 10) such that the square of N is palindromic when expressed in base B; also print the value of that palindromic square. Use the letters 'A', 'B', and so on to represent the digits 10, 11, and so on.</p>\n\n<p>Print both the number and its square in base B.</p>\n\n<p><strong>MY CODE:</strong> </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n#include &lt;algorithm&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\n//utility function to raise number to a power\nint power(int first, int second)\n{\n    int total = 1;\n    for (int i = 0; i &lt; second; i++)\n    {\n        total *= first;\n    }\n    return total;\n}\n\n//convert the number to the proper base\nint convert(string num, int base1)\n{\n    int sum = 0;\n    for (int i = num.size() - 1; i &gt;= 0; i--)\n        sum += num[i] * power(base1, num.size() - i);\n    return sum;\n}\n\n//test if converted number is a palindrome\nbool is_pal(int number)\n{\n    //if the #ofdigits is even\n    if (number % 2 == 0)\n    {\n        int mid = (to_string(number).size()) / 2;\n        string str_num = to_string(number);\n        string half1;\n        for (int i = 0; i &lt; mid; i++)\n            half1 += str_num[i];\n        string half2;\n        for (int i = str_num.size()-1; i &gt; mid-1; i--)\n            half2 += str_num[i];\n        if (half1 == half2)\n            return true;\n        return false;\n    }\n    //if the #ofdigits is odd\n    else\n    {\n        int mid1 = (to_string(number).size() - 1) / 2;\n        int mid2 = (to_string(number).size() + 1) / 2;\n        string str_num = to_string(number);\n        string half1;\n        for (int i = 0; i &lt; mid1; i++)\n        {\n            half1 += str_num[i];\n        }\n        string half2;\n        for (int i = str_num.size()-1; i &gt; mid2-1; i--)\n        {\n            half2 += str_num[i];\n        }\n        if (half1 == half2)\n            return true;\n        return false;\n    }\n}\nint main()\n{\n    ofstream fout(\"palsquare.out\");\n    ifstream fin(\"palsquare.in\");\n    int base;\n    fin &gt;&gt; base;\n\n    for (int i = 1; i &lt; 300; i++)\n    {\n        if (is_pal(convert(to_string((power(i, 2))), base)))\n        {\n            fout &lt;&lt; convert(to_string(i), base) &lt;&lt; \" \" &lt;&lt; convert(to_string(power(i, 2)), base) &lt;&lt; \"\\n\";\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "image", "exception", "cimg"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530732908, "post_id": 51179907, "comment_id": 89342242, "body": "Simplify and <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>. An important simplification you should start with: Don&#39;t use threads. In fact, you should always make sure your algorithms work single-threaded before you start using threads. Another simplification is to not write to much code at once before testing. Start small, add new things in small, small baby-steps, and test between each baby-step."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530733116, "post_id": 51179907, "comment_id": 89342307, "body": "Also, don&#39;t try to save space by using abbreviation, especially if they don&#39;t really save much (and only in the source code itself). For example, why use <code>wtrk</code> instead of the perfectly find <code>watermark</code>? The latter is <i>much</i> easier to understand what it is than the cryptic <code>wtrk</code>. Compilers these days can handle symbols longer than six characters."}, {"owner": {"reputation": 691, "user_id": 2941936, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5dfd667ee988b9d1a6d6fea9c706ec?s=128&d=identicon&r=PG&f=1", "display_name": "g_rmz", "link": "https://stackoverflow.com/users/2941936/g-rmz"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530733372, "post_id": 51179907, "comment_id": 89342384, "body": "@Someprogrammerdude As I wrote, I&#39;ve already written the sequential version of the program. It is in the main function, and it starts when the parallelism degree is 1. I appreciate your suggestions, but I continue to don&#39;t understand why this exceptions are launched. I&#39;ve tested every line of code and this problem persists. For the debugging part I&#39;ve used lldb, and still found nothing."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530734168, "post_id": 51179907, "comment_id": 89342629, "body": "It seems that the exception happens when you attempt to save the image. What is the file-name you try to use at that time? Is it a valid name? Is it a valid path? You&#39;re allowed to write to that path and file? Does every part of the path exist? Do the file already exist?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530734385, "post_id": 51179907, "comment_id": 89342701, "body": "Oh, and should you really unlock <code>IO_MUTEX</code> before you actually <i>do</i> any IO (i.e. save the image to file)?"}, {"owner": {"reputation": 691, "user_id": 2941936, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5dfd667ee988b9d1a6d6fea9c706ec?s=128&d=identicon&r=PG&f=1", "display_name": "g_rmz", "link": "https://stackoverflow.com/users/2941936/g-rmz"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530734512, "post_id": 51179907, "comment_id": 89342733, "body": "@Someprogrammerdude In order to save an image I use a c_string, for example, like this ../output_dir/1.jpg, where 1.jpg is an image I take from the directory in which all the images to be processed are contained, and ../output_dir is the destination directory I pass in input and, in case it doesn&#39;t exists, is created. And yes, the critical sections is resolved before any IO operation."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530734597, "post_id": 51179907, "comment_id": 89342761, "body": "All you do in the <code>IO_MUTEX</code> &quot;critical section&quot; is <i>print a string</i>, and you print some values that aren&#39;t even thread-sensitive (<code>id</code> is passed by value, and <code>fname</code> is a local variable). That mutex just doesn&#39;t make any sense there. And to be certain that it works okay, <i>check</i> the actual value of <code>output_dir + &quot;&#47;&quot; + fname</code> (note that the casts aren&#39;t needed)."}, {"owner": {"reputation": 691, "user_id": 2941936, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5dfd667ee988b9d1a6d6fea9c706ec?s=128&d=identicon&r=PG&f=1", "display_name": "g_rmz", "link": "https://stackoverflow.com/users/2941936/g-rmz"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530734690, "post_id": 51179907, "comment_id": 89342800, "body": "@Someprogrammerdude I use the critical section to access the images queue, which is shared among all threads and hence requires a lock to be accessed."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530734734, "post_id": 51179907, "comment_id": 89342818, "body": "And I don&#39;t talk about <code>IMAGE_MUTEX</code>, but the (in the code you show) useless <code>IO_MUTEX</code>."}, {"owner": {"reputation": 691, "user_id": 2941936, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5dfd667ee988b9d1a6d6fea9c706ec?s=128&d=identicon&r=PG&f=1", "display_name": "g_rmz", "link": "https://stackoverflow.com/users/2941936/g-rmz"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530734828, "post_id": 51179907, "comment_id": 89342834, "body": "@Someprogrammerdude Oh yes, I was using that mutex in order to debug the code and print without the interleaving of the threads."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530735146, "post_id": 51179907, "comment_id": 89342938, "body": "Anyway, my best recommendation is still to scale back and simplify. Comment out all of the code in the thread function. Then add back one little bit att a time, testing multiple times before adding back the next little bit. Once you start to get the exceptions again then you at least should have narrowed down the problematic parts. And one of the early bits you should put back in is the writing of the (empty!) image."}], "answers": [{"comments": [{"owner": {"reputation": 691, "user_id": 2941936, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5dfd667ee988b9d1a6d6fea9c706ec?s=128&d=identicon&r=PG&f=1", "display_name": "g_rmz", "link": "https://stackoverflow.com/users/2941936/g-rmz"}, "edited": false, "score": 0, "creation_date": 1531296509, "post_id": 51256609, "comment_id": 89537966, "body": "I&#39;ve come to the same conclusion as yours. While trying to solve the issue I&#39;ve putted the saving function between a try/catch block, in which the catch-part also apply the saving function, and this has solved the problem, for now. I&#39;ve not considered the use of another mutex for the saving function in order to optimize the performance of the program. I&#39;ll mark your answer as correct, thank you :)"}, {"owner": {"reputation": 7041, "user_id": 314290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5ffde821f0f9670e601b19f1731a6849?s=128&d=identicon&r=PG", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/314290/mikhail"}, "reply_to_user": {"reputation": 691, "user_id": 2941936, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5dfd667ee988b9d1a6d6fea9c706ec?s=128&d=identicon&r=PG&f=1", "display_name": "g_rmz", "link": "https://stackoverflow.com/users/2941936/g-rmz"}, "edited": false, "score": 0, "creation_date": 1531336826, "post_id": 51256609, "comment_id": 89563237, "body": "@g_rmz as a friendly word of apocryphal advice, your code will probably benefit from multi threads. 1) The saving jpeg command performs a substantial amount of computation when compressing the data 2) most IO system are made of many layers that need to be saturated to achieve peak performance (even a single HDD needs to be saturated to keep the head always writing). You gotta call libjpeg-turbo directly."}], "tags": [], "owner": {"reputation": 7041, "user_id": 314290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5ffde821f0f9670e601b19f1731a6849?s=128&d=identicon&r=PG", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/314290/mikhail"}, "is_accepted": true, "score": 0, "last_activity_date": 1531191145, "creation_date": 1531191145, "answer_id": 51256609, "question_id": 51179907, "link": "https://stackoverflow.com/questions/51179907/cimg-throwing-cimgioexception-at-random/51256609#51256609", "title": "Cimg throwing CImgIOException at random", "body": "<p>I suspect the write command isn't thread safe. For example, most jpeg encoders/decoders use a structure which needs to be made for each thread, here they might be shared. Despite the claims on the cimg website, it is not immediately obvious if/how this taken into consideration.</p>\n\n<p>I'd test the hypothesis by serializing execution of the <code>.save_jpeg</code> command, although the solution will come from not using cimg, but instead calling libjpeg-turbo directly:</p>\n\n<pre><code>//somewhere in global\nstd::mutex protect_save_image;\n\n//At your section\n{\n    std::unique_lock lk(protect_save_image);\n    img.save_jpeg(((std::string)argv[4] + (std::string)\"/\" + fname).c_str());`\n}\n</code></pre>\n\n<p>Also if the thread count is really high (aka <code>par_degree</code> > 1000), you might exceed the maximum number of available file descriptions causing IO failure.</p>\n"}], "owner": {"reputation": 691, "user_id": 2941936, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5dfd667ee988b9d1a6d6fea9c706ec?s=128&d=identicon&r=PG&f=1", "display_name": "g_rmz", "link": "https://stackoverflow.com/users/2941936/g-rmz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 51256609, "answer_count": 1, "score": 1, "last_activity_date": 1531191145, "creation_date": 1530732711, "question_id": 51179907, "link": "https://stackoverflow.com/questions/51179907/cimg-throwing-cimgioexception-at-random", "title": "Cimg throwing CImgIOException at random", "body": "<p>I have some code that runs a bunch of threads in parallel. Each thread execute a function in order to copy a \"watermark\" over an image loaded from a directory, and save the modified image in another directory, specified by the user. In order to achieve the result I have to use the CImg library. I can't figure out why sometimes CImg throws <code>CImgIOException</code> like <code>CImg&lt;unsigned char&gt;::save_other(): Failed to save file</code>, or <code>CImg&lt;unsigned char&gt;::save_jpeg(): Failed to save file</code>. I have imagemagick installed, so there shouldn't be a problem to save and open images using the jpeg/jpg format.</p>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;atomic&gt;\n#include &lt;chrono&gt;\n#include \"CImg.h\"\n#include &lt;cstdlib&gt;\n#include &lt;filesystem&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n#include &lt;mutex&gt;\n#include &lt;optional&gt;\n#include &lt;queue&gt;\n#include &lt;string&gt;\n#include &lt;thread&gt;\n#include &lt;typeinfo&gt;\n\nusing namespace cimg_library;\n\nstd::mutex IMAGES_MUTEX, IO_MUTEX;\nstd::atomic_int PROCESSED_IMAGES = 0;\n\nvoid apply_watermark(std::queue&lt;std::string&gt;&amp; images, CImg&lt;unsigned char&gt;&amp; watermark, int workload, \\\n                     std::string output_dir, int id) {\n    std::queue&lt;std::string&gt; to_process;\n    int counter = 0;\n    bool stop = false;\n    CImg&lt;unsigned char&gt; img;\n\n    while (!stop) {\n        IMAGES_MUTEX.lock();\n        while(counter &lt; workload) {\n            if (images.empty()) {\n                std::cout &lt;&lt; \"Thread \" &lt;&lt; id &lt;&lt; \": founded empty queue\" &lt;&lt; std::endl;\n                counter = workload;\n                stop = true;\n            } else {\n                std::cout &lt;&lt; \"Thread \" &lt;&lt; id &lt;&lt; \": aquiring image\" &lt;&lt; images.front() &lt;&lt; std::endl;\n                to_process.push(images.front());\n                images.pop();\n                counter += 1;\n            }\n        }\n        IMAGES_MUTEX.unlock();\n\n        counter = 0;\n\n        while(!(to_process.empty())) {\n            img.assign(to_process.front().c_str());\n\n            if (!(img.width() != 1024 || img.height() != 768)) {\n                cimg_forXY(watermark, x, y) {\n                    int R = (int)watermark(x, y, 0, 0);\n\n                    if (R != 255) {\n                        img(x, y, 0, 0) = 0;\n                        img(x, y, 0, 1) = 0;\n                        img(x, y, 0, 2) = 0;\n                    }\n                }\n\n                std::string fname = to_process.front().substr(to_process.front().find_last_of('/') + 1);\n\n                IO_MUTEX.lock();\n                std::cout &lt;&lt; \"Thread \" &lt;&lt; id &lt;&lt; \": saving image \" &lt;&lt; fname &lt;&lt; std::endl;\n                IO_MUTEX.unlock();\n\n                img.save_jpeg(((std::string)output_dir + (std::string)\"/\" + fname).c_str());\n                to_process.pop();\n                PROCESSED_IMAGES += 1;\n            } else {\n                to_process.pop();\n            }\n            img.clear();\n        }\n    }\n    return;\n}\n\nint main(int argc, char const *argv[]) {\n    auto completion_time_start = std::chrono::high_resolution_clock::now();\n\n    if (argc != 5) {\n        std::cout &lt;&lt; \"MISSING PARAMETERS!\" &lt;&lt; std::endl;\n\n        return -1;\n    }\n\n    int par_degree = std::atoi(argv[3]);\n\n    if (!(std::filesystem::exists(argv[2]))) {\n        std::cout &lt;&lt; \"WATERMARK NOT FOUND!\" &lt;&lt; std::endl;\n\n        return -1;\n    }\n\n    CImg&lt;unsigned char&gt; wtrk(argv[2]);\n    std::queue&lt;std::string&gt; images;\n\n    if (!(std::filesystem::exists(argv[1]))) {\n        std::cout &lt;&lt; \"IMAGES' DIRECTORY NOT FOUND!\" &lt;&lt; std::endl;\n\n        return -1;\n    }\n\n    for (auto&amp; path : std::filesystem::directory_iterator(argv[1])) {\n        std::string fname = path.path().string().substr(path.path().string().find_last_of('/') + 1);\n\n        if (fname != \".DS_Store\") {\n            images.push(path.path().string());\n        }\n    }\n\n    if (!(std::filesystem::exists((std::string)argv[4]))) {\n        std::filesystem::create_directory((std::string)argv[4]);\n    }\n\n    if (par_degree == 1) {\n        while(!(images.empty())) {\n            CImg&lt;unsigned char&gt; img(images.front().c_str());\n\n            if (!(img.width() != 1024 || img.height() != 768)) {\n                cimg_forXY(wtrk, x, y) {\n                    int R = (int)wtrk(x, y, 0, 0);\n\n                    if (R != 255) {\n                        img(x, y, 0, 0) = 0;\n                        img(x, y, 0, 1) = 0;\n                        img(x, y, 0, 2) = 0;\n                    }\n                }\n\n                std::string fname = images.front().substr(images.front().find_last_of('/') + 1);\n                img.save_jpeg(((std::string)argv[4] + (std::string)\"/\" + fname).c_str());\n                images.pop();\n                PROCESSED_IMAGES += 1;\n            } else {\n                images.pop();\n            }\n        }\n    } else {\n        int workload = (int)images.size() / par_degree;\n        std::thread workers[par_degree];\n\n        for (int i = 0; i &lt; par_degree; i++) {\n            workers[i] = std::thread(apply_watermark, std::ref(images), std::ref(wtrk), workload, \\\n                                     (std::string)argv[4], i);\n        }\n\n        for (int i = 0; i &lt; par_degree; i++) {\n            workers[i].join();\n        }\n    }\n\n    auto completion_time_end = std::chrono::high_resolution_clock::now();\n    std::chrono::duration&lt;double, std::ratio&lt;1&gt;&gt; completion_time = completion_time_end - \\\n                                                                   completion_time_start;\n\n    std::cout &lt;&lt; \"\\nPARALLELISM DEGREE: \" &lt;&lt; par_degree &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"COMPLETION TIME: \" &lt;&lt; completion_time.count() &lt;&lt; \" SECONDS\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"PROCESSED IMAGES: \" &lt;&lt; PROCESSED_IMAGES &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>All the exceptions are throwed during the saving of an image, I'm quite new to the C++ language, and I really have no clue. Running the program with only one thread, the main one, doesn't create any problem. </p>\n\n<p>This is an example of launch command:</p>\n\n<p><code>./test ../imgs ../watermark.jpg 4 ../output_dir</code></p>\n\n<p>Any help will be appreciated.</p>\n"}, {"tags": ["c++", "objective-c", "macos", "qt"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1530732629, "post_id": 51179879, "comment_id": 89342153, "body": "And your <i>specific</i> question is, what?"}, {"owner": {"reputation": 2717, "user_id": 5041316, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/8IrT2.jpg?s=128&g=1", "display_name": "Semyon Tikhonenko", "link": "https://stackoverflow.com/users/5041316/semyon-tikhonenko"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1530732671, "post_id": 51179879, "comment_id": 89342162, "body": "The question is why it doesn&#39;t show up. I didn&#39;t modify an example and it doesn&#39;t work"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1530732776, "post_id": 51179879, "comment_id": 89342203, "body": "Have you <i>considered</i> that just <i>maybe</i> the example doesn&#39;t work? Sounds like time to break out the debugger."}, {"owner": {"reputation": 2717, "user_id": 5041316, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/8IrT2.jpg?s=128&g=1", "display_name": "Semyon Tikhonenko", "link": "https://stackoverflow.com/users/5041316/semyon-tikhonenko"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1530732808, "post_id": 51179879, "comment_id": 89342212, "body": "Yes. That&#39;s what I thought"}, {"owner": {"reputation": 5711, "user_id": 680519, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2cc8408cef2441e188c6ae1255098584?s=128&d=identicon&r=PG", "display_name": "harism", "link": "https://stackoverflow.com/users/680519/harism"}, "edited": false, "score": 0, "creation_date": 1531675903, "post_id": 51179879, "comment_id": 89673684, "body": "Which Qt version are you using? I&#39;ve been facing somewhat similar behaviour with  Qt 5.10.x and Qt 5.11.x whereas Qt 5.9.6 works just fine with the same code."}, {"owner": {"reputation": 2717, "user_id": 5041316, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/8IrT2.jpg?s=128&g=1", "display_name": "Semyon Tikhonenko", "link": "https://stackoverflow.com/users/5041316/semyon-tikhonenko"}, "edited": false, "score": 0, "creation_date": 1531676076, "post_id": 51179879, "comment_id": 89673719, "body": "I am using 5.11. Do you have any workground how to fix it?"}, {"owner": {"reputation": 5711, "user_id": 680519, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2cc8408cef2441e188c6ae1255098584?s=128&d=identicon&r=PG", "display_name": "harism", "link": "https://stackoverflow.com/users/680519/harism"}, "edited": false, "score": 0, "creation_date": 1531676521, "post_id": 51179879, "comment_id": 89673828, "body": "Unfortunately best I&#39;ve managed do is stick with Qt 5.9.6 - if that version works better for you too. However there are a few QMacCocoaViewContainer related issues on Qt issues tracker for 5.9.x versions too.."}], "owner": {"reputation": 2717, "user_id": 5041316, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/8IrT2.jpg?s=128&g=1", "display_name": "Semyon Tikhonenko", "link": "https://stackoverflow.com/users/5041316/semyon-tikhonenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530732690, "creation_date": 1530732512, "last_edit_date": 1530732690, "question_id": 51179879, "link": "https://stackoverflow.com/questions/51179879/qmaccocoaviewcontainer-doesnt-show", "title": "QMacCocoaViewContainer doesn&#39;t show", "body": "<p>I built an official example qmaccocoaviewcontainer provided by Qt from QtCreator and I see nothing, but an empty window. MacOS High Sierra 10.13.5.\nQMacCocoaViewContainer simply doesn't show up.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;AppKit/AppKit.h&gt;\n#include &lt;QtWidgets&gt;\n#include &lt;QMacCocoaViewContainer&gt;\n\nclass WindowWidget : public QWidget\n{\npublic:\n    WindowWidget()\n    {\n        QMacCocoaViewContainer *cocoaViewContainer = new QMacCocoaViewContainer(0, this);\n        cocoaViewContainer-&gt;move(100, 100);\n        cocoaViewContainer-&gt;resize(300, 300);\n        NSTextView *text = [[NSTextView alloc] initWithFrame : NSMakeRect(0, 0, 300, 300)];\n        [text setString:@\"the string\"];\n        cocoaViewContainer-&gt;setCocoaView(text);\n    }\n};\n\nint main(int argc, char *argv[])\n{\n    QApplication app(argc, argv);\n\n    WindowWidget widget;\n    widget.show();\n\n    return app.exec();\n}\n</code></pre>\n\n<p>What is wrong?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 9, "creation_date": 1530731858, "post_id": 51179753, "comment_id": 89341957, "body": "Have you tried entering, for example, <code>1.25</code>?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1530732888, "post_id": 51179753, "comment_id": 89342237, "body": "The first step in debugging this kind of problem is understanding your input. The code should display the value of <code>y</code> so that you can pin down more precisely where the problem is occurring. If the answer by @tadman is correct, showing the value of <code>y</code> would have shown you the problem."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1530732151, "creation_date": 1530732151, "answer_id": 51179813, "question_id": 51179753, "link": "https://stackoverflow.com/questions/51179753/float-behaving-like-int-c/51179813#51179813", "title": "Float behaving like int (C++)", "body": "<p>C++ is going to use \"American\" decimal notation by default, so <code>1,25</code> is interpreted as <code>1</code> not <code>1.25</code>.</p>\n\n<p>You'll need to enter <code>1.25</code> or convert the <code>,</code> to a <code>.</code> before parsing.</p>\n"}], "owner": {"reputation": 3, "user_id": 10033757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hACkxdMNWek/AAAAAAAAAAI/AAAAAAAAAKQ/-wMal9_nELI/photo.jpg?sz=128", "display_name": "\u0414\u0435\u0431\u0435\u043b\u0438 \u0422\u0430\u0431\u0430\u045f\u0438\u0458\u0430", "link": "https://stackoverflow.com/users/10033757/%d0%94%d0%b5%d0%b1%d0%b5%d0%bb%d0%b8-%d0%a2%d0%b0%d0%b1%d0%b0%d1%9f%d0%b8%d1%98%d0%b0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 51179813, "answer_count": 1, "score": -2, "last_activity_date": 1530732151, "creation_date": 1530731802, "question_id": 51179753, "link": "https://stackoverflow.com/questions/51179753/float-behaving-like-int-c", "title": "Float behaving like int (C++)", "body": "<p>I'm practising using float and i made console application which should double the number user entered.For some reason,when i enter number like 1,25,program outputs 2 (likee its int,and not float) instead of 2,5.</p>\n\n<p>Code (I use Microsoft Visual Studio):</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n\nfloat racun(float x)\n{\n    return x * 2;\n}\n\nint main()\n{\n    float y;\n    std::cin &gt;&gt; y;\n    std::cout &lt;&lt; racun(y) &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>thanks in advance</p>\n"}, {"tags": ["c++", "oop", "inheritance", "overloading", "abstract"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1530730212, "post_id": 51179500, "comment_id": 89341478, "body": "Are you talking about &quot;dynamic dispatching&quot;, &quot;generics&quot; and/or &quot;template functions&quot; or &quot;function overrides&quot;? Those are common object-oriented techniques. You may want to explore various <a href=\"https://en.wikipedia.org/wiki/Design_Patterns\" rel=\"nofollow noreferrer\">design patterns</a> that can be used here."}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 8854357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a045b2b03a8f275efcfea0a21cd80f68?s=128&d=identicon&r=PG&f=1", "display_name": "frogengine773", "link": "https://stackoverflow.com/users/8854357/frogengine773"}, "edited": false, "score": 0, "creation_date": 1530731035, "post_id": 51179610, "comment_id": 89341742, "body": "Interesting, so it seems what I was missing was the unique pointer, and the override statement, which I didn&#39;t even know was a thing. How exactly does a unique pointer work, and what does it do for me in this example?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 317, "user_id": 8854357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a045b2b03a8f275efcfea0a21cd80f68?s=128&d=identicon&r=PG&f=1", "display_name": "frogengine773", "link": "https://stackoverflow.com/users/8854357/frogengine773"}, "edited": false, "score": 0, "creation_date": 1530731270, "post_id": 51179610, "comment_id": 89341818, "body": "<code>std::unique_ptr</code> handles memory for you, so no <code>new</code>/<code>delete</code>. In your sample, you will even have problem as <code>&amp;s</code> doesn&#39;t require <code>delete</code>whereas <code>new Stage(...)</code> would."}, {"owner": {"reputation": 1512, "user_id": 7885750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/43lAl.jpg?s=128&g=1", "display_name": "Stephen M. Webb", "link": "https://stackoverflow.com/users/7885750/stephen-m-webb"}, "edited": false, "score": 0, "creation_date": 1530731352, "post_id": 51179610, "comment_id": 89341845, "body": "I think what you were missing was the concept of polymorphism.  Using a smart pointer is only an implementation detail of this particular example."}, {"owner": {"reputation": 317, "user_id": 8854357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a045b2b03a8f275efcfea0a21cd80f68?s=128&d=identicon&r=PG&f=1", "display_name": "frogengine773", "link": "https://stackoverflow.com/users/8854357/frogengine773"}, "edited": false, "score": 0, "creation_date": 1530732820, "post_id": 51179610, "comment_id": 89342215, "body": "This ended up working for me. I just needed to add #include &lt;memory&gt; and change the compiler to use c++14, and it works perfectly, thank you."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 1, "last_activity_date": 1530735030, "last_edit_date": 1530735030, "creation_date": 1530730795, "answer_id": 51179610, "question_id": 51179500, "link": "https://stackoverflow.com/questions/51179500/c-how-to-have-seperate-versions-of-the-same-method/51179610#51179610", "title": "C++ how to have seperate versions of the same method?", "body": "<p>It seems you want to use polymorphism:</p>\n\n<pre><code>class IStage\n{\npublic:\n    virtual ~IStage() = default;\n    virtual void handle_shutdown() = 0;\n    // ...\n};\n\nclass Stage1 : public IStage\n{\npublic:\n    void handle_shutdown() override { /*Implementation1*/ }\n    // ...\n};\n\nclass Stage2 : public IStage\n{\npublic:\n    void handle_shutdown() override { /*Implementation1*/ }\n    // ...\n};\n</code></pre>\n\n<p>And then </p>\n\n<pre><code>struct EventHandler\n{\n    std::unique_ptr&lt;IStage&gt; stage;\n    // ...\n};\n\nEventHandler event_handler;\nevent_handler.stage = std::make_unique&lt;Stage1&gt;();\n\nif (event == SHUTDOWN) {\n    event_handler.stage-&gt;handle_shutdown();\n}\n\n// Later\nevent_handler.stage = std::make_unique&lt;Stage2&gt;();\n\nif (event == SHUTDOWN) {\n    event_handler.stage-&gt;handle_shutdown();\n}\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 8854357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a045b2b03a8f275efcfea0a21cd80f68?s=128&d=identicon&r=PG&f=1", "display_name": "frogengine773", "link": "https://stackoverflow.com/users/8854357/frogengine773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 51179610, "answer_count": 1, "score": 0, "last_activity_date": 1530735030, "creation_date": 1530730094, "question_id": 51179500, "link": "https://stackoverflow.com/questions/51179500/c-how-to-have-seperate-versions-of-the-same-method", "title": "C++ how to have seperate versions of the same method?", "body": "<p>I'm sorry if I don't know the right word for what I'm trying to accomplish.</p>\n\n<p>Basically I have an event handler object which only has a single member. The member is a Stage object.</p>\n\n<p>When the event handler receives an event, I want it to simply use the stage object to call the relevant method. For example:</p>\n\n<pre><code>Event event; //this event is not part of my code, but rather the library I'm using.\n\nStage s;                    // my custom class object\n\nEventHandler event_handler; //also my custom class object\nevent_handler.stage = &amp;s;\n\nif(event == SHUTDOWN) {\n    event_handler.stage-&gt;handle_shutdown();\n}\n</code></pre>\n\n<p>So what I'm trying to accomplish is that, there will be seperate scopes that my program goes into over time, and I want each scope to have access to the event_handler such that they can do something like:</p>\n\n<pre><code>void some_other_scope(EventHandler* eh) {\n    Stage* some_new_stage = new Stage(...);\n    eh-&gt;stage = some_new_stage;\n}\n</code></pre>\n\n<p>This way, the original event code stays the same, and the event handler will be calling handle_shutdown on a different object than it was originally going to.</p>\n\n<p>So what I want to do is to overload the handle_shutdown method so that there can be different implementations of it. I know how basic overloading works, it can be done by specifying different parameters, but is there any way to have different definitions of the same class method based on the file that the object was created in?</p>\n\n<p>I was hoping to have several files, each with their own some_other_scope() function, and each file can redefine the handle_shutdown method to do different things based on what that file needs.</p>\n\n<p>I'm sure there's a way to do what I want, I just don't know the right words to use.</p>\n"}, {"tags": ["c++", "algorithm", "vector"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 2, "creation_date": 1530730125, "post_id": 51179482, "comment_id": 89341446, "body": "Is there a specific reason you need to use a vector instead of a map here?"}, {"owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 1, "creation_date": 1530730193, "post_id": 51179482, "comment_id": 89341469, "body": "What is the error?"}, {"owner": {"reputation": 381, "user_id": 9629245, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UIobdmipCvQ/AAAAAAAAAAI/AAAAAAAAACQ/HnSiJyeFkHE/photo.jpg?sz=128", "display_name": "Zeeshan Hayat", "link": "https://stackoverflow.com/users/9629245/zeeshan-hayat"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1530730281, "post_id": 51179482, "comment_id": 89341495, "body": "@Frank, no specific reason. It is used everywhere in my actual program."}, {"owner": {"reputation": 381, "user_id": 9629245, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UIobdmipCvQ/AAAAAAAAAAI/AAAAAAAAACQ/HnSiJyeFkHE/photo.jpg?sz=128", "display_name": "Zeeshan Hayat", "link": "https://stackoverflow.com/users/9629245/zeeshan-hayat"}, "reply_to_user": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 1, "creation_date": 1530730358, "post_id": 51179482, "comment_id": 89341517, "body": "@neo, <code>&#39;std::replace&#39;: no matching overloaded function found </code>"}, {"owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 1, "creation_date": 1530731783, "post_id": 51179482, "comment_id": 89341932, "body": "As for the error, additional info should be posted in the question body and not in the comments."}, {"owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 0, "creation_date": 1530731819, "post_id": 51179482, "comment_id": 89341949, "body": "And for the map/vector thing, just use a std::map. It&#39;ll make your life much easier."}, {"owner": {"reputation": 381, "user_id": 9629245, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UIobdmipCvQ/AAAAAAAAAAI/AAAAAAAAACQ/HnSiJyeFkHE/photo.jpg?sz=128", "display_name": "Zeeshan Hayat", "link": "https://stackoverflow.com/users/9629245/zeeshan-hayat"}, "reply_to_user": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "edited": false, "score": 0, "creation_date": 1530732064, "post_id": 51179482, "comment_id": 89341996, "body": "@Neo How can you solve it with <code>std::map</code> if you have your own custom data type?"}, {"owner": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 1, "creation_date": 1530732311, "post_id": 51179482, "comment_id": 89342060, "body": "<code>std::replace_if(data_vector.begin(), data_vector.end(), [&amp;info_3](auto&amp;&amp;el) {return el.getGroup() == info_3.getGroup(); }, info_3);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2836, "user_id": 3529197, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ceed214a6e603c456a8ebaacc036b407?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/3529197/neo"}, "is_accepted": false, "score": 0, "last_activity_date": 1530732332, "creation_date": 1530732332, "answer_id": 51179845, "question_id": 51179482, "link": "https://stackoverflow.com/questions/51179482/c-match-and-replace-element-by-value-in-custom-data-type-vector/51179845#51179845", "title": "C++ - match and replace element by value in custom data type vector", "body": "<p>You should use <code>std::map</code>, where the group is the key and the rest of the data is the value.  </p>\n\n<p>This way, when you insert to the map a new item is added unless its group number already exist and then it replaces the existing item.  </p>\n\n<pre><code>class data\n{\n    public:\n        bool condition;\n        int time;\n        friend bool operator==(const data&amp; lhs, const data&amp; rhs);\n        data(bool c, int t) \n        {\n            condition = c;\n            time = t;\n        }\n};\n</code></pre>\n\n<p>and then use <code>std::map&lt;int, Data&gt;</code> as the container.  </p>\n\n<p>You could also implement a wrapper class having a <code>std::map&lt;int, Data&gt;</code> as a private member, implementing insertion and iteration (and possibly deletion etc.), and then you could use outside of it an <code>ExtendedData</code> or whatever, which is implemented as you implemented <code>Data</code> at first.</p>\n"}, {"tags": [], "owner": {"reputation": 3142, "user_id": 2311167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rZpVr.jpg?s=128&g=1", "display_name": "Adrian W", "link": "https://stackoverflow.com/users/2311167/adrian-w"}, "is_accepted": false, "score": 1, "last_activity_date": 1530732941, "creation_date": 1530732941, "answer_id": 51179952, "question_id": 51179482, "link": "https://stackoverflow.com/questions/51179482/c-match-and-replace-element-by-value-in-custom-data-type-vector/51179952#51179952", "title": "C++ - match and replace element by value in custom data type vector", "body": "<p>According to <a href=\"https://en.cppreference.com/w/cpp/algorithm/replace\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/algorithm/replace</a> the third parameter to <code>std::replace()</code> is <code>const T&amp; old_value</code>. You are passing the entire vector. That's why you get <code>no matching overloaded function found</code>.</p>\n"}], "owner": {"reputation": 381, "user_id": 9629245, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UIobdmipCvQ/AAAAAAAAAAI/AAAAAAAAACQ/HnSiJyeFkHE/photo.jpg?sz=128", "display_name": "Zeeshan Hayat", "link": "https://stackoverflow.com/users/9629245/zeeshan-hayat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530732941, "creation_date": 1530729983, "last_edit_date": 1530731897, "question_id": 51179482, "link": "https://stackoverflow.com/questions/51179482/c-match-and-replace-element-by-value-in-custom-data-type-vector", "title": "C++ - match and replace element by value in custom data type vector", "body": "<p>I have a vector which contains data for different groups. If I insert new data for a group into a vector it should replace the old data with a new one for the same group number. For this particular example <code>std::replace</code> gives an error <code>std::replace': no matching overloaded function found</code></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n\nclass data\n{\n    public:\n        int group;\n        bool condition;\n        int time;\n        friend bool operator==(const data&amp; lhs, const data&amp; rhs);\n        data(int g, bool c, int t) \n        {\n            group = g;\n            condition = c;\n            time = t;\n        }\n};\n\nbool  operator==(const data&amp; lhs, const data&amp; rhs)\n{\n    return lhs.group == rhs.group;\n}\nint main(int argc, char**)\n{\n    data info_1(10, true , 1);\n    data info_2(20, true, 1);\n    data info_3(10, false, 4);\n\n    std::vector&lt;data&gt; data_vector;\n\n    data_vector.push_back(info_1);\n    data_vector.push_back(info_2);\n\n    std::replace(data_vector.begin(), data_vector.end(), data_vector ,info_3);\n\n    std::cout &lt;&lt; \"vector size: \" &lt;&lt; data_vector.size() &lt;&lt; \"\\n\";\n    for (int i = 0; i &lt; data_vector.size(); i++)\n    {\n        std::cout &lt;&lt; \"group number: \" &lt;&lt; data_vector[i].group &lt;&lt; std::boolalpha &lt;&lt; \" condition: \" &lt;&lt; data_vector[i].condition &lt;&lt; \"\\n\";\n    }\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1530731072, "post_id": 51179451, "comment_id": 89341758, "body": "<code>department[departmentCount].createDepartment(); if (std::any_of(department, department + departmentCount, [&amp;](const auto&amp; d){ return d.departmentID == department[departmentCount].departmentID; })) { std::cout &lt;&lt; &quot;id already present\\n&quot;; } else             ++departmentCount;</code>"}, {"owner": {"reputation": 1038, "user_id": 9775850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbb2fe93c368d757bc6e0cfe6eaa68a?s=128&d=identicon&r=PG&f=1", "display_name": "skeller", "link": "https://stackoverflow.com/users/9775850/skeller"}, "edited": false, "score": 0, "creation_date": 1530731399, "post_id": 51179451, "comment_id": 89341856, "body": "use a vector, this way you do not have to set a fixed limit in advance"}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1530734940, "post_id": 51179908, "comment_id": 89342872, "body": "I recommend marking what you changed and explaining why you changed it . Otherwise you have a code only answer, and those tend to produce <a href=\"https://en.wikipedia.org/wiki/Cargo_cult_programming\" rel=\"nofollow noreferrer\">Cargo Cult Programmers</a> instead of useful, thinking human beings."}], "tags": [], "owner": {"reputation": 371, "user_id": 8535697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jjl2PFhqqKY/AAAAAAAAAAI/AAAAAAAAACM/ftDbp-lGZTw/photo.jpg?sz=128", "display_name": "Dhanushka Dayawansha", "link": "https://stackoverflow.com/users/8535697/dhanushka-dayawansha"}, "is_accepted": false, "score": 0, "last_activity_date": 1530734688, "last_edit_date": 1530734688, "creation_date": 1530732711, "answer_id": 51179908, "question_id": 51179451, "link": "https://stackoverflow.com/questions/51179451/c-array-object-checking-values/51179908#51179908", "title": "C++ Array Object Checking Values", "body": "<p>try this one</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\n// Employee Class\nclass Employee\n{\nprivate:\n    string employeeID;\n    string employeeName;\n    string employeeDepartmentID;\n    double employeeSalary;\n    int employeeAge;\n\npublic:\n    void createEmployee()\n    {\n        cout &lt;&lt; \"Please Enter Employee Details:\" &lt;&lt; endl;\n\n        cout &lt;&lt; \"Employee ID : \";\n        cin &gt;&gt; employeeID;\n\n        cout &lt;&lt; \"Employee Name :\";\n        cin &gt;&gt; employeeName;\n\n        cout &lt;&lt; \"Salary: $\";\n        cin &gt;&gt; employeeSalary;\n\n        cout &lt;&lt; \"Age : \";\n        cin &gt;&gt; employeeAge;\n\n        cout &lt;&lt; \"Department ID : \";\n        cin &gt;&gt; employeeDepartmentID;\n    }\n\n\n};\n\n// Department Class\nclass Department\n{\nprivate:\n    string departmentID;\n    string departmentName;\n    string departmentHeadName;\n\npublic:\n    void createDepartment()\n    {\n        cout &lt;&lt; \"Please Enter Department Details: \\n\";\n\n        cout &lt;&lt; \"Department ID : \";\n        cin &gt;&gt; departmentID;\n\n        cout &lt;&lt; \"Department Name : \";\n        cin &gt;&gt; departmentName;\n\n        cout &lt;&lt; \"Head of Department : \";\n        cin &gt;&gt; departmentHeadName;\n    }\n\n      public:\n        string getDepartmentID(){\n\n            return departmentID;\n\n          }\n};\n\n\n// Function prototype\nvoid displayMenu(); \n\n// Client main function\nint main()\n{\n    Employee employee[5];\n    Department department[3];\n\n\n    int choice;\n    int departmentCount = 0;\n    int employeeCount = 0;\n\n    while (true)\n    {\n        displayMenu();\n        cin &gt;&gt; choice;\n\n        if (choice == 1 &amp;&amp; departmentCount &lt; 3)\n        {\n            department[departmentCount].createDepartment();\n\n            for(int i=0;i&lt;departmentCount;i++)\n           {\n                if(department[i].getDepartmentID()==department[departmentCount].getDepartmentID())\n                 {\n\n                    cout&lt;&lt;\"already exists......................... \\n\";\n                 }\n\n            }\n\n\n            departmentCount = departmentCount + 1;\n        }\n        else if (choice == 1 &amp;&amp; departmentCount &gt;= 3)\n        {\n            cout &lt;&lt; \"\\nThe array is full, you can not add any more Departments.\" &lt;&lt; endl;\n        }\n        else if (choice == 2 &amp;&amp; employeeCount &lt; 5)\n        {\n            employee[employeeCount].createEmployee();\n            employeeCount = employeeCount + 1;\n        }\n        else if (choice == 2 &amp;&amp; employeeCount &gt;= 5)\n        {\n            cout &lt;&lt; \"The array is full, you can not add any more Employees.\" &lt;&lt; endl;\n        }\n        else if (choice == 6)\n        {\n            cout &lt;&lt; \"Thank you, goodbye.\" &lt;&lt; endl;\n            break;\n        }\n    }\n    return 0;\n}\n\n// Display menu function\nvoid displayMenu()\n{\n    cout &lt;&lt; \"1. Create Department\" &lt;&lt; endl;\n    cout &lt;&lt; \"2. Create Employee\" &lt;&lt; endl;\n    cout &lt;&lt; \"3. Write Out Data File\" &lt;&lt; endl;\n    cout &lt;&lt; \"4. Read In Data File\" &lt;&lt; endl;\n    cout &lt;&lt; \"5. Display Salary Report\" &lt;&lt; endl;\n    cout &lt;&lt; \"6. -- Quit -- \" &lt;&lt; endl;\n    cout &lt;&lt; \"Please make a selection : \";\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 371, "user_id": 8535697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jjl2PFhqqKY/AAAAAAAAAAI/AAAAAAAAACM/ftDbp-lGZTw/photo.jpg?sz=128", "display_name": "Dhanushka Dayawansha", "link": "https://stackoverflow.com/users/8535697/dhanushka-dayawansha"}, "is_accepted": false, "score": 0, "last_activity_date": 1530770483, "last_edit_date": 1530770483, "creation_date": 1530766315, "answer_id": 51183587, "question_id": 51179451, "link": "https://stackoverflow.com/questions/51179451/c-array-object-checking-values/51183587#51183587", "title": "C++ Array Object Checking Values", "body": "<p>I used  getDepartmentID function in Department Class to get department id from each department object</p>\n\n<pre><code>public:\n        string getDepartmentID(){\n\n            return departmentID;\n\n          }\n</code></pre>\n\n<p>there should be return type is string.because you have created departmentID as a string.</p>\n\n<p>and I used For Loop in main function to compare relevant department id already exists or not</p>\n\n<pre><code>for(int i=0;i&lt;departmentCount;i++)\n           {\n                if(department[i].getDepartmentID()==department[departmentCount].getDepartmentID())\n                 {\n\n                    cout&lt;&lt;\"already exists......................... \\n\";\n                 }\n\n            }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9983559, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7aB3j62JP1k/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0uA2TjYGH5uD6rM7rvvjWT_gP72w/mo/photo.jpg?sz=128", "display_name": "Eric Tran", "link": "https://stackoverflow.com/users/9983559/eric-tran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1530770483, "creation_date": 1530729800, "last_edit_date": 1530733731, "question_id": 51179451, "link": "https://stackoverflow.com/questions/51179451/c-array-object-checking-values", "title": "C++ Array Object Checking Values", "body": "<p>I am supposed to write a program with two classes, <code>Employee</code> and <code>Department</code>. When the <code>main()</code> function runs, it asks the user to choose one of the six numbered options that are displayed and creates arrays for <code>Employee</code> and <code>Department</code> objects. I'm disregarding every other option except option 1, the Create Department Option, so the focus of this issue will be the <code>Department</code> class and the <code>Department department[3]</code> array. </p>\n\n<p>There is a <code>while</code> loop in the <code>main()</code> function that continuously runs until the user decides to exit. If the user enters option 1, a <code>Department</code> array object is created, and then the user also enters the <code>departmentID</code>, <code>departmentName</code>, and <code>departmentHeadName</code> for that object. The <code>while</code> loop notifies the user if the array has three <code>Employee</code> objects. However, I am having difficulties because each <code>departmentID</code> needs to be unique. For example, I cannot enter 1 for the first array object's <code>departmentID</code>, and then enter 1 again for the second array object's <code>departmentID</code>. How do I check if the user's <code>departmentID</code> input already exists in a previous object?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\n// Employee Class\nclass Employee\n{\nprivate:\n    string employeeID;\n    string employeeName;\n    string employeeDepartmentID;\n    double employeeSalary;\n    int employeeAge;\n\npublic:\n    void createEmployee()\n    {\n        cout &lt;&lt; \"Please Enter Employee Details:\" &lt;&lt; endl;\n\n        cout &lt;&lt; \"Employee ID : \";\n        cin &gt;&gt; employeeID;\n\n        cout &lt;&lt; \"Employee Name :\";\n        cin &gt;&gt; employeeName;\n\n        cout &lt;&lt; \"Salary: $\";\n        cin &gt;&gt; employeeSalary;\n\n        cout &lt;&lt; \"Age : \";\n        cin &gt;&gt; employeeAge;\n\n        cout &lt;&lt; \"Department ID : \";\n        cin &gt;&gt; employeeDepartmentID;\n    }\n};\n\n// Department Class\nclass Department\n{\nprivate:\n    string departmentID;\n    string departmentName;\n    string departmentHeadName;\n\npublic:\n    void createDepartment()\n    {\n        cout &lt;&lt; \"Please Enter Department Details: \\n\";\n\n        cout &lt;&lt; \"Department ID : \";\n        cin &gt;&gt; departmentID;\n\n        cout &lt;&lt; \"Department Name : \";\n        cin &gt;&gt; departmentName;\n\n        cout &lt;&lt; \"Head of Department : \";\n        cin &gt;&gt; departmentHeadName;\n    }\n};\n\n// Function prototype\nvoid displayMenu(); \n\n// Client main function\nint main()\n{\n    Employee employee[5];\n    Department department[3];\n\n    int choice;\n    int departmentCount = 0;\n    int employeeCount = 0;\n\n    while (true)\n    {\n        displayMenu();\n        cin &gt;&gt; choice;\n\n        if (choice == 1 &amp;&amp; departmentCount &lt; 3)\n        {\n            department[departmentCount].createDepartment();\n            departmentCount = departmentCount + 1;\n        }\n        else if (choice == 1 &amp;&amp; departmentCount &gt;= 3)\n        {\n            cout &lt;&lt; \"\\nThe array is full, you can not add any more Departments.\" &lt;&lt; endl;\n        }\n        else if (choice == 2 &amp;&amp; employeeCount &lt; 5)\n        {\n            employee[employeeCount].createEmployee();\n            employeeCount = employeeCount + 1;\n        }\n        else if (choice == 2 &amp;&amp; employeeCount &gt;= 5)\n        {\n            cout &lt;&lt; \"The array is full, you can not add any more Employees.\" &lt;&lt; endl;\n        }\n        else if (choice == 6)\n        {\n            cout &lt;&lt; \"Thank you, goodbye.\" &lt;&lt; endl;\n            break;\n        }\n    }\n    return 0;\n}\n\n// Display menu function\nvoid displayMenu()\n{\n    cout &lt;&lt; \"1. Create Department\" &lt;&lt; endl;\n    cout &lt;&lt; \"2. Create Employee\" &lt;&lt; endl;\n    cout &lt;&lt; \"3. Write Out Data File\" &lt;&lt; endl;\n    cout &lt;&lt; \"4. Read In Data File\" &lt;&lt; endl;\n    cout &lt;&lt; \"5. Display Salary Report\" &lt;&lt; endl;\n    cout &lt;&lt; \"6. -- Quit -- \" &lt;&lt; endl;\n    cout &lt;&lt; \"Please make a selection : \";\n}\n</code></pre>\n"}, {"tags": ["c++", "file", "exception", "error-handling", "ofstream"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1530729684, "post_id": 51179401, "comment_id": 89341277, "body": "This is more an operating-system dependent thing."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 2, "creation_date": 1530730326, "post_id": 51179401, "comment_id": 89341510, "body": "When you create a new empty file, everything is an &quot;unexisting position&quot;. It is not <i>that</i> special to start to write only from the beginning. Some operating systems will keep just the parts you have written as a <a href=\"https://en.wikipedia.org/wiki/Sparse_file\" rel=\"nofollow noreferrer\">sparse file</a>. Others might fill out the holes on disk with some padding, like zeros."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1530730967, "post_id": 51179401, "comment_id": 89341713, "body": "tell and seek are interesting at the best of times. There are no guarantees that the numbers they use make much sense. All that&#39;s guaranteed is if you use the same number on the same stream you get the same place in the stream, if that place still exists."}], "answers": [{"comments": [{"owner": {"reputation": 1493, "user_id": 10032505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/clhpj.jpg?s=128&g=1", "display_name": "Mohammad", "link": "https://stackoverflow.com/users/10032505/mohammad"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1530733236, "post_id": 51179669, "comment_id": 89342341, "body": "dude ! i&#39;ve just compile it"}, {"owner": {"reputation": 1493, "user_id": 10032505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/clhpj.jpg?s=128&g=1", "display_name": "Mohammad", "link": "https://stackoverflow.com/users/10032505/mohammad"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1530733778, "post_id": 51179669, "comment_id": 89342511, "body": "@Kasata Ata , i&#39;ve just made it easy to you to compile it and change the code to get what you want."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1530734625, "post_id": 51179669, "comment_id": 89342776, "body": "When I ran a modified version on Windows (g++4.9), that&#39;s really similar to the current edit, I got a file full of nulls that ends with the data written right where I placed it. The thing is you can&#39;t count on this behaviour.  Precisely what is going to happen is not defined by the C++ Standard."}], "tags": [], "owner": {"reputation": 1493, "user_id": 10032505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/clhpj.jpg?s=128&g=1", "display_name": "Mohammad", "link": "https://stackoverflow.com/users/10032505/mohammad"}, "is_accepted": false, "score": 0, "last_activity_date": 1530733624, "last_edit_date": 1530733624, "creation_date": 1530731144, "answer_id": 51179669, "question_id": 51179401, "link": "https://stackoverflow.com/questions/51179401/stdofstream-setting-seekp-to-wrong-position/51179669#51179669", "title": "std::ofstream - setting seekp to wrong position", "body": "<p>I've just debug it :</p>\n\n<pre><code>  #include &lt;fstream&gt;      // std::ofstream\n  #include &lt;iostream&gt;\n  using namespace std;\n  int main () {\n\n  std::ofstream outfile;\n  outfile.open (\"C:\\\\Users\\\\Mohammad\\\\Desktop\\\\test.txt\");\n  outfile.seekp(1234);\n  if (outfile.is_open())\n  {\n  outfile.write (\"This is an apple\",16);\n  outfile.write (\" sam\",4);\n  outfile.close();\n  cout&lt;&lt;\"done\";\n  }\n  if(!outfile)\n   {\n   cout&lt;&lt;\"error!\";\n   }\n   return 0;\n   }\n</code></pre>\n\n<p>and result is \"done\" in console without any error.\neven when the file doesn't exist in the path it doesn't have any error.</p>\n\n<p>compile photo :\n<a href=\"https://pasteboard.co/HsWql4y.png\" rel=\"nofollow noreferrer\">https://pasteboard.co/HsWql4y.png</a></p>\n"}], "owner": {"reputation": 165, "user_id": 10023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d88fe0ff393523aee72bf40dd983b3d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kasata Ata", "link": "https://stackoverflow.com/users/10023636/kasata-ata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530733624, "creation_date": 1530729490, "question_id": 51179401, "link": "https://stackoverflow.com/questions/51179401/stdofstream-setting-seekp-to-wrong-position", "title": "std::ofstream - setting seekp to wrong position", "body": "<p>I have read information from cpp reference, but I could not find answear for my question. I want to know what is guaranteed to happen if I have empty file and try to write something at unexisting position, like that:</p>\n\n<pre><code>std::ofstream stream(path);\nstream.seekp(1234);\nstream.write(whatever, sizeof(whatever));\n</code></pre>\n\n<p>I am asking my question due to exception handling.</p>\n"}, {"tags": ["c++", "mingw"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1530729300, "post_id": 51179316, "comment_id": 89341139, "body": "Welcome to macro substitution. Microsoft has a ton of macros that, 20 years ago, made it easy to switch code between good ol&#39; ANSI (suffixed with A) and unicode (suffixed with W) by calling a function with no suffix at all.  Looks like you&#39;ve tripped over one."}, {"owner": {"reputation": 78, "user_id": 8443047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41046f0a1889a098da7f7d5edae58315?s=128&d=identicon&r=PG&f=1", "display_name": "Trytio", "link": "https://stackoverflow.com/users/8443047/trytio"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1530729410, "post_id": 51179316, "comment_id": 89341175, "body": "But it is very strange, because I used this function before in other files, and I had no problem; It is only when I use it in this file that it cause me this problem..."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1530729547, "post_id": 51179316, "comment_id": 89341231, "body": "Likely a file you included in this file defines (or includes a field that defines) the  <code>#define LoadImage LoadImageA</code> macro."}, {"owner": {"reputation": 78, "user_id": 8443047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41046f0a1889a098da7f7d5edae58315?s=128&d=identicon&r=PG&f=1", "display_name": "Trytio", "link": "https://stackoverflow.com/users/8443047/trytio"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1530729855, "post_id": 51179316, "comment_id": 89341337, "body": "Ok, I found it. It is because of <code>pthread.h</code>. Thank you."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1530739894, "post_id": 51179316, "comment_id": 89344359, "body": "@Trytio -- the actual culprit is <code>&quot;windows.h&quot;</code>. It&#39;s possible that <code>pthread.h</code> pulls that header in, but it seems unlikely."}, {"owner": {"reputation": 78, "user_id": 8443047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41046f0a1889a098da7f7d5edae58315?s=128&d=identicon&r=PG&f=1", "display_name": "Trytio", "link": "https://stackoverflow.com/users/8443047/trytio"}, "edited": false, "score": 0, "creation_date": 1530747125, "post_id": 51179316, "comment_id": 89345822, "body": "No, I checked all the <code>include</code>: <code>pthread.h -&gt; _ptw32.h -&gt; ptw32_errno.h -&gt; winsock.h -&gt; windows.h</code>."}], "owner": {"reputation": 78, "user_id": 8443047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41046f0a1889a098da7f7d5edae58315?s=128&d=identicon&r=PG&f=1", "display_name": "Trytio", "link": "https://stackoverflow.com/users/8443047/trytio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "closed_date": 1530729222, "answer_count": 0, "score": 0, "last_activity_date": 1530729091, "creation_date": 1530729091, "question_id": 51179316, "link": "https://stackoverflow.com/questions/51179316/mingw-unexpected-a-character-at-the-end-of-function-declaration", "closed_reason": "Duplicate", "title": "MinGW unexpected &quot;A&quot; character at the end of function declaration", "body": "<p>I'm using MinGW to compile my <code>.cpp</code> and I keep having this error:</p>\n\n<pre><code>In file included from c:\\mingw\\include\\_mingw.h:73:0,\n             from c:\\mingw\\include\\wchar.h:53,\n             from c:\\mingw\\lib\\gcc\\mingw32\\6.3.0\\include\\c++\\cwchar:44,\n             from c:\\mingw\\lib\\gcc\\mingw32\\6.3.0\\include\\c++\\bits\\postypes.h:40,\n             from c:\\mingw\\lib\\gcc\\mingw32\\6.3.0\\include\\c++\\iosfwd:40,\n             from c:\\mingw\\lib\\gcc\\mingw32\\6.3.0\\include\\c++\\ios:38,\n             from c:\\mingw\\lib\\gcc\\mingw32\\6.3.0\\include\\c++\\ostream:38,\n             from c:\\mingw\\lib\\gcc\\mingw32\\6.3.0\\include\\c++\\iostream:39,\n             from file.hpp:6,\n             from file.cpp:1:\nfile.cpp: In constructor 'File::File(bool, std::__cxx11::string)':\nfile.cpp:19:37: error: 'class X' has no member named 'LoadImageA'; did you mean 'LoadImage'?\nImage image= m_X.LoadImage(\"image.png\");\n</code></pre>\n\n<p>It just make no sense, because you can obviously see that there is no <code>A</code> in <code>LoadImage</code>.</p>\n\n<p>When I put the <code>A</code>, the code compile, but I don't want to put a random letter at the end of my function name.</p>\n\n<p>It look like an encoding problem, but I'm very not sure.</p>\n\n<p>Why MinGW can't compile this code which contain obviously no error?</p>\n"}, {"tags": ["c++", "c++14", "stdvector", "move-semantics", "reinterpret-cast"], "comments": [{"owner": {"reputation": 5685, "user_id": 827280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c39ecec1f8d62bf8b6b27ba05904990?s=128&d=identicon&r=PG", "display_name": "Museful", "link": "https://stackoverflow.com/users/827280/museful"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1530728904, "post_id": 51179092, "comment_id": 89340977, "body": "@Fran&#231;oisAndrieux Indeed I want to preserve the value of each element. But don&#39;t <code>int32_t</code> and <code>uint32_t</code> have the same representation for integers mutually expressible? (i.e. from [0  2^31-1])"}, {"owner": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 0, "creation_date": 1530729134, "post_id": 51179092, "comment_id": 89341076, "body": "Is that guaranteed? Nothing in range [2^31, 2^32-1]?"}, {"owner": {"reputation": 5685, "user_id": 827280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c39ecec1f8d62bf8b6b27ba05904990?s=128&d=identicon&r=PG", "display_name": "Museful", "link": "https://stackoverflow.com/users/827280/museful"}, "reply_to_user": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 1, "creation_date": 1530729283, "post_id": 51179092, "comment_id": 89341131, "body": "@JHBonarius The desired behavior is for the stolen memory to be reinterpreted as-is."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1530729453, "post_id": 51179092, "comment_id": 89341197, "body": "Does this discussion about the types matter if the <code>size()</code> (but not the <code>capacity()</code>) of the object to be stolen from is zero? Not even the <code>sizeof</code> the types matter in this case (but the alignment does): all <code>vector&lt;T&gt;</code> holds in this case is raw memory. But there is no legal way to get it."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1530729659, "post_id": 51179092, "comment_id": 89341270, "body": "@Museful It seems you are right about that (<a href=\"https://timsong-cpp.github.io/cppwp/basic.types#basic.fundamental-3\" rel=\"nofollow noreferrer\">6.7.1 3</a>). It also seems like <a href=\"https://en.cppreference.com/w/cpp/language/reinterpret_cast#Type_aliasing\" rel=\"nofollow noreferrer\">type aliasing rules</a> make an exception allowed simultaneous <code>signed</code> and <code>unsigned</code> pointers to the same object. Specifically for fundamental integral types, I can&#39;t seem to find a reason this can&#39;t conceptually work. Though the interface of <code>std::vector</code> won&#39;t allow such a thing."}, {"owner": {"reputation": 2298, "user_id": 6427477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oYQ8Y.png?s=128&g=1", "display_name": "C.M.", "link": "https://stackoverflow.com/users/6427477/c-m"}, "edited": false, "score": 0, "creation_date": 1530729727, "post_id": 51179092, "comment_id": 89341289, "body": "@Museful there is no portable way to do that, but if <code>uint32_t</code> is &quot;compatible with&quot; <code>int32_t</code> <i>and</i> <code>vector&lt;uint32_t&gt;</code> is &quot;compatible with&quot; <code>vector&lt;int32_t&gt;</code> -- you can invoke vector&#39;s move ctor on <code>std::move(*reinterpret_cast&lt;vector&lt;T&gt;*&gt;(&amp;other.v))</code> and it should work. Pretty sure this will work for most popular platforms. Alas, there is no <code>static_assert</code> for &quot;sameness&quot; of vector&lt;int32_t&gt; and vector&lt;uint32_t&gt;... If you ever go this way -- you better put huge 2-page comment there..."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 2298, "user_id": 6427477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oYQ8Y.png?s=128&g=1", "display_name": "C.M.", "link": "https://stackoverflow.com/users/6427477/c-m"}, "edited": false, "score": 1, "creation_date": 1530729858, "post_id": 51179092, "comment_id": 89341338, "body": "@C.M. You can&#39;t <code>reinterpret_cast</code> a <code>std::vector&lt;T&gt;</code> pointer or reference to another <code>std::vector&lt;U&gt;</code> pointer or reference unless <code>T</code> and <code>U</code> are the same type. It&#39;s always undefined behavior to dereference the resulting pointer."}, {"owner": {"reputation": 2298, "user_id": 6427477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oYQ8Y.png?s=128&g=1", "display_name": "C.M.", "link": "https://stackoverflow.com/users/6427477/c-m"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1530729914, "post_id": 51179092, "comment_id": 89341361, "body": "@Fran&#231;oisAndrieux pretty sure I should be able to do it for pointer to <code>std::vector</code>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 2298, "user_id": 6427477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oYQ8Y.png?s=128&g=1", "display_name": "C.M.", "link": "https://stackoverflow.com/users/6427477/c-m"}, "edited": false, "score": 0, "creation_date": 1530729994, "post_id": 51179092, "comment_id": 89341397, "body": "@C.M. <code>reinterpret_cast</code> is only allowed in <a href=\"https://en.cppreference.com/w/cpp/language/reinterpret_cast#Explanation\" rel=\"nofollow noreferrer\">these cases</a>. None of them allow what you are proposing."}, {"owner": {"reputation": 2298, "user_id": 6427477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oYQ8Y.png?s=128&g=1", "display_name": "C.M.", "link": "https://stackoverflow.com/users/6427477/c-m"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1530730166, "post_id": 51179092, "comment_id": 89341460, "body": "@Fran&#231;oisAndrieux What about case #5?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 2298, "user_id": 6427477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oYQ8Y.png?s=128&g=1", "display_name": "C.M.", "link": "https://stackoverflow.com/users/6427477/c-m"}, "edited": false, "score": 0, "creation_date": 1530730191, "post_id": 51179092, "comment_id": 89341468, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/174365/discussion-between-francois-andrieux-and-c-m\">continue this discussion in chat</a>."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1530744461, "post_id": 51179092, "comment_id": 89345372, "body": "Why do you want to do this thing? It makes no sense. If you merely want to keep allocated memory, then simply write your own custom allocator and use that for either vector, destroy the old one and create the new one, but let your allocator keep the memory."}], "answers": [{"comments": [{"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1530729771, "post_id": 51179264, "comment_id": 89341306, "body": "should the template parameter <code>T</code> of the constructor of <code>buffer&lt;T&gt;</code> not be named differently? or not be present at all?"}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1530730032, "post_id": 51179264, "comment_id": 89341418, "body": "I don&#39;t see the benefit of the type-erasure here, you use <code>std::unique_ptr&lt;void, void(*)(void*)&gt;</code> to emulate a reinterpret cast, it doesn&#39;t provide more safety. And the usual <code>reinterpret_cast</code> approach is very common."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 1, "creation_date": 1530730190, "post_id": 51179264, "comment_id": 89341467, "body": "@liliscent I don&#39;t reinterpret the <code>vector</code> itself, I reinterpret the buffer the vector owns.  The buffer is a pile of plain old data; the vector is an opaque type created by the C++ std library.  I personally find reinterpreting a buffer far less insane than reinterpreting a type within <code>std</code>.  It seems <i>likely</i> that the binary layout of a <code>std::vector&lt;uint32_t&gt;</code> and a <code>std::vector&lt;int32_t&gt;</code> is similar, which is why it is <i>likely</i> to work, but <b>nobody</b> is going to guarantee that.  On the other hand, it is reasonable that a buffer of contiguous <code>int32_t</code> and <code>uint32_t</code> are identical."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1530730324, "post_id": 51179264, "comment_id": 89341509, "body": "@Walter Thanks, fixed.  Possibly I should compile my code.  ;)"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 2, "creation_date": 1530730447, "post_id": 51179264, "comment_id": 89341539, "body": "@Museful It is deep UB; time travel could occur.  Your code is inlined, and the compiler proves that nobody has modified a <code>std::vector&lt;int32_t&gt;</code>.  After all, <code>evil_steal_memory</code> only modifies a <code>vector&lt;uint32_t&gt;</code>.  So as you checked <code>.empty()</code> on a <code>int32_t</code> vector 10 lines ago, and we check again in 5 lines, we can skip that check; logically, there was no way for it to become empty without executing undefined behavior.  In short, it is an evil violation of the type system, and those are <i>dangerous</i>."}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1530731208, "post_id": 51179264, "comment_id": 89341803, "body": "@Yakk-AdamNevraumont Writing custom wrapper for <code>std::vector</code> looks very awkward to me. And the compiler would be insane if <code>std::vector&lt;uint32_t&gt;</code> and <code>std::vector&lt;int32_t&gt;</code> has different structures... But it&#39;s an interesting answer, +1"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1530731735, "post_id": 51179264, "comment_id": 89341916, "body": "@liliscent don&#39;t underestimate the compilers ability to notice that &quot;this specific thing you do <i>here</i> has UB, thus I can freely do this <i>other crazy thing</i> <i>over here</i>&quot;. As soon as the program invokes UB <i>anywhere</i> you&#39;ve bought yourself a ticket to crazy-land."}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1530733639, "post_id": 51179264, "comment_id": 89342472, "body": "@JesperJuhl I won&#39;t underestimate UB, but I won&#39;t be obsessed either. Something like this is just <i>practically safe</i>, otherwise many code will be broken if compilers deliberately do some crazy stuff. I doubt you haven&#39;t written reinterpret cast for <code>std::vector</code> before."}, {"owner": {"reputation": 2298, "user_id": 6427477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oYQ8Y.png?s=128&g=1", "display_name": "C.M.", "link": "https://stackoverflow.com/users/6427477/c-m"}, "edited": false, "score": 0, "creation_date": 1530734931, "post_id": 51179264, "comment_id": 89342869, "body": "<code>evil_steal_memory</code> may be correct (depending on (1) vector implementation (2) compiler vendor). See <a href=\"https://chat.stackoverflow.com/rooms/174365/discussion-between-francois-andrieux-and-c-m\">this discussion</a> (most importantly around 14:24 mark)"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1530734961, "post_id": 51179264, "comment_id": 89342881, "body": "Reinterpreting integral types as their signed/unsigned counterparts is implementation-defined behavior. The iffy part is they&#39;re an array, which seems practically safe."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1530736241, "post_id": 51179264, "comment_id": 89343283, "body": "@liliscent It is actually a custom wrapper for an owning contiguous buffer of <code>T</code>; you can store a <code>std::array&lt;T,N&gt;</code> a <code>std::string&lt;C,T&gt;</code> or a raw <code>T*, size_t</code> or a <code>T[N]</code> in it.  It is similar to <code>gsl::span&lt;T&gt;</code>, except it owns its buffer.  I just implemented the vector ctor."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1530736437, "post_id": 51179264, "comment_id": 89343340, "body": "@PasserBy Yes, the array part is questionable; to be fair, the current status of low level array rules in the C++ standard is horridly broken to the point that implementing a <code>std::vector</code> is impossible in-language."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1530736620, "post_id": 51179264, "comment_id": 89343394, "body": "@liliscent Note that the two vectors can have the same structure and things still blow up: because that cast is a strict aliasing violation, and aliasing is used to prove that values are not modified by currently existing compilers, the risk I see is that the compiler <i>proves the state of the vector of signed ints was not changed by the <code>evil_steal_memory</code></i>.  That is a perfectly valid conclusion.  You never modified a <code>vector&lt;int32_t&gt;</code> along any path that executes defined behavior; thus it is unmodified.  But it was also modified.  And then your program blows up."}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1530739062, "post_id": 51179264, "comment_id": 89344104, "body": "@Yakk-AdamNevraumont It&#39;s kind of like the consequence of placement <code>new</code>, after <code>evil_steal_memory</code>, you can&#39;t access the underlying object with the old reference. That seems to be a reasonable restriction."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1530739424, "post_id": 51179264, "comment_id": 89344202, "body": "@liliscent Well, then either destructor doesn&#39;t run, or you leak memory.  :)  It is UB all the way down."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 5, "last_activity_date": 1530730890, "last_edit_date": 1530730890, "creation_date": 1530728813, "answer_id": 51179264, "question_id": 51179092, "link": "https://stackoverflow.com/questions/51179092/how-to-let-a-stdvectorint32-t-take-memory-from-a-stdvectoruint32-t/51179264#51179264", "title": "How to let a `std::vector&lt;int32_t&gt;` take memory from a `std::vector&lt;uint32_t&gt;&amp;&amp;`?", "body": "<p>There is no legal way to do this in C++; you can only move buffers from a <code>std::vector</code> to another <code>std::vector</code> of the exact same type.</p>\n\n<p>There are a variety of ways you can hack this.  The most illegal and evil would be</p>\n\n<pre><code>std::vector&lt;uint32_t&gt; evil_steal_memory( std::vector&lt;int32_t&gt;&amp;&amp; in ) {\n  return reinterpret_cast&lt; std::vector&lt;uint32_t&gt;&amp;&amp; &gt;(in);\n}\n</code></pre>\n\n<p>or something similar.</p>\n\n<p>A less evil way would be to forget it is a <code>std::vector</code> at all.</p>\n\n<pre><code>template&lt;class T&gt;\nstruct buffer {\n  template&lt;class A&gt;\n  buffer( std::vector&lt;T,A&gt; vec ):\n    m_begin( vec.data() ),\n    m_end( m_begin + vec.size() )\n  {\n    m_state = std::unique_ptr&lt;void, void(*)(void*)&gt;(\n      new std::vector&lt;T,A&gt;( std::move(vec) ),\n      [](void* ptr){\n        delete static_cast&lt;std::vector&lt;T,A&gt;*&gt;(ptr);\n      }\n    );\n  }\n  buffer(buffer&amp;&amp;)=default;\n  buffer&amp; operator=(buffer&amp;&amp;)=default;\n  ~buffer() = default;\n  T* begin() const { return m_begin; }\n  T* end() const { return m_end; }\n  std::size_t size() const { return begin()==end(); }\n  bool empty() const { return size()==0; }\n  T* data() const { return m_begin; }\n  T&amp; operator[](std::size_t i) const {\n    return data()[i];\n  }\n  explicit operator bool() const { return (bool)m_state; }\n\n  template&lt;class U&gt;\n  using is_buffer_compatible = std::integral_constant&lt;bool,\n    sizeof(U)==sizeof(T)\n    &amp;&amp; alignof(U)==alignof(T)\n    &amp;&amp; !std::is_pointer&lt;T&gt;{}\n  &gt;;\n  template&lt;class U,\n    std::enable_if_t&lt; is_buffer_compatible&lt;U&gt;{}, bool &gt; = true\n  &gt;\n  buffer reinterpret( buffer&lt;U&gt; o ) {\n    return {std::move(o.m_state), reinterpret_cast&lt;T*&gt;(o.m_begin()),reinterpret_cast&lt;T*&gt;(o.m_end())};\n  }\nprivate:\n  buffer(std::unique_ptr&lt;void, void(*)(void*)&gt; state, T* b, T* e):\n    m_state(std::move(state)),\n    m_begin(begin),\n    m_end(end)\n  {}\n  std::unique_ptr&lt;void, void(*)(void*)&gt; m_state;\n  T* m_begin = 0;\n  T* m_end = 0;\n};\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/82a73c2d8091ff2a\" rel=\"nofollow noreferrer\">live example</a>: this type erases a buffer of <code>T</code>.</p>\n\n<pre><code>template&lt;class T&gt;\nstruct raster {\n  buffer&lt;T&gt; v;\n\n  template&lt;typename U, typename = std::enable_if_t&lt;sizeof(T) == sizeof(U)&gt;&gt;\n  raster(raster&lt;U&gt;&amp;&amp; other):\n    v( buffer&lt;T&gt;::reinterpret( std::move(other).v ) )\n  {}\n};\n</code></pre>\n\n<p>note that my <code>buffer</code> has a memory allocation in it; compared to millions of elements that is cheap.  It is also move-only. </p>\n\n<p>The memory allocation can be eliminated through careful use of the small buffer optimization.</p>\n\n<p>I'd leave it move-only (who wants to accidentally copy a million elements?) and maybe write</p>\n\n<pre><code>buffer clone() const;\n</code></pre>\n\n<p>which creates a new buffer with the same contents.</p>\n\n<p>Note that instead of a <code>const buffer&lt;int&gt;</code> you should use a <code>buffer&lt;const int&gt;</code> under the above design.  You can change that by duplicating the <code>begin() const</code> methods to have const and non-const versions.</p>\n\n<p>This solution relies on your belief that reinterpreting a buffer of <code>int32_t</code>s as a buffer of <code>uint32_t</code>s (or vice versa) doesn't mess with anything.  Your compiler may provide this guarantee, but the C++ standard <strong>does not</strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1530800460, "creation_date": 1530800460, "answer_id": 51193696, "question_id": 51179092, "link": "https://stackoverflow.com/questions/51179092/how-to-let-a-stdvectorint32-t-take-memory-from-a-stdvectoruint32-t/51193696#51193696", "title": "How to let a `std::vector&lt;int32_t&gt;` take memory from a `std::vector&lt;uint32_t&gt;&amp;&amp;`?", "body": "<p>The problem is that the implementation of the vector template itself may be specialised for the type. For some weird whacky reason we don't understand today, the top-level vector might need an extra member not provided in vector, so simply reinterpret casting will not work safely.</p>\n\n<p>Another evil approach might be to look at the Allocator of your two vectors. \nIf this was  </p>\n\n<ul>\n<li>a custom allocator you had written and both were a derived class from vector</li>\n<li>and you wrote an overload in the class for swap and =&amp;&amp;</li>\n<li>within which you created wrapped tmp vectors to swap with</li>\n<li>and detected that the Allocator was being called within those temporary objects constructors/destructors, and on the same thread</li>\n<li>to release and reallocate the same sized array</li>\n</ul>\n\n<p>Then, perhaps you could legitimately pass the memory buffer between them without resetting the content.</p>\n\n<p>But that is a lot of fragile work!</p>\n"}], "owner": {"reputation": 5685, "user_id": 827280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c39ecec1f8d62bf8b6b27ba05904990?s=128&d=identicon&r=PG", "display_name": "Museful", "link": "https://stackoverflow.com/users/827280/museful"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1530800460, "creation_date": 1530727929, "question_id": 51179092, "link": "https://stackoverflow.com/questions/51179092/how-to-let-a-stdvectorint32-t-take-memory-from-a-stdvectoruint32-t", "title": "How to let a `std::vector&lt;int32_t&gt;` take memory from a `std::vector&lt;uint32_t&gt;&amp;&amp;`?", "body": "<pre><code>template&lt;typename T&gt;\nstruct raster {\n    std::vector&lt;T&gt; v;\n\n    template&lt;typename U, typename = std::enable_if_t&lt;sizeof(T) == sizeof(U)&gt;&gt;\n    raster(raster&lt;U&gt;&amp;&amp; other){\n        // What code goes here?\n    }\n}\n</code></pre>\n\n<p>Suppose we have <code>raster&lt;uint32_t&gt; r</code> such that <code>r.v.size()</code> is in the millions, and a guarantee that all its elements are within <code>int32_t</code>'s range. Is it possible for <code>raster&lt;int32_t&gt;::raster(raster&lt;uint32_t&gt;&amp;&amp; other)</code> to avoid copying the memory backing <code>other.v</code>?</p>\n\n<p>Or should I just do something like <code>*reinterpret_cast&lt;raster&lt;int32_t&gt;*&gt;(&amp;r)</code> instead of calling that constructor?</p>\n"}, {"tags": ["c++", "comparator", "priority-queue", "min-heap", "max-heap"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 1, "creation_date": 1530727591, "post_id": 51178986, "comment_id": 89340524, "body": "The first part of your statement is correct. However to get a min heap you&#39;d need to pass <code>std::greater</code> otherwise by default <code>std::less</code> creates max heap behavior. This is stated in the <a href=\"https://en.cppreference.com/w/cpp/container/priority_queue\" rel=\"nofollow noreferrer\">documentation</a>"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1530732512, "post_id": 51178986, "comment_id": 89342123, "body": "Note that the assumption that returning true leaves the order unchanged is not valid. The two items are not required to be passed in the same order as their appearance in the original vector."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1530746044, "post_id": 51178986, "comment_id": 89345607, "body": "<code>std::priority_queue</code> is simply a max heap by default. There isn&#39;t really more to explain."}], "answers": [{"tags": [], "owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "is_accepted": false, "score": 1, "last_activity_date": 1530728177, "creation_date": 1530728177, "answer_id": 51179142, "question_id": 51178986, "link": "https://stackoverflow.com/questions/51178986/comparators-in-sort-function-and-priority-queue-c/51179142#51179142", "title": "comparators in sort function and priority queue c++", "body": "<p>According to <a href=\"https://en.cppreference.com/w/cpp/container/priority_queue\" rel=\"nofollow noreferrer\">this online documentation</a>, the C++ library class <code>std::priority_queue</code> returns the <em>largest</em> element first in the sense that the comparator orders smaller elements before larger elements. From above link:</p>\n\n<blockquote>\n  <p>Note that the Compare parameter is defined such that it returns true\n  if its first argument comes before its second argument in a weak\n  ordering. But because the priority queue outputs largest elements\n  first, the elements that \"come before\" are actually output last. That\n  is, the front of the queue contains the \"last\" element according to\n  the weak ordering imposed by Compare.</p>\n</blockquote>\n\n<p>Thus <code>std::priority_queue&lt;T,std::less&lt;T&gt;&gt;</code> makes a max-heap and prioritizes larger elements.</p>\n"}], "owner": {"reputation": 49, "user_id": 7687068, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EFNXh8j4Fxw/AAAAAAAAAAI/AAAAAAAAABY/K4DY3yjKZS8/photo.jpg?sz=128", "display_name": "Zixin Liu", "link": "https://stackoverflow.com/users/7687068/zixin-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1530728177, "creation_date": 1530727437, "question_id": 51178986, "link": "https://stackoverflow.com/questions/51178986/comparators-in-sort-function-and-priority-queue-c", "title": "comparators in sort function and priority queue c++", "body": "<p>In C++ Sort function, the third optional parameter is a comparator used to sort the objects. If we pass in less as the comparator, we will get objects in increasing order. (if the comparator is evaluated to be true, the positions won't be changed, otherwise elements will be swaped!)  Is my understanding correct?</p>\n\n<p>Following the same fashion, if we pass a less comparator to priority queue, we should get a min-heap,(if the underlying data structure is chosen to be vector, objects are sorted in increasing order. If we call top(), the first element of vector will be returned, which is the smallest number. Therefore, I think it is a min heap) why do we get a max heap?  </p>\n"}, {"tags": ["c++", "memory-leaks", "windbg"], "comments": [{"owner": {"reputation": 663, "user_id": 841876, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f354a0c48f10e5cb50a88a99d653d019?s=128&d=identicon&r=PG", "display_name": "cardinalPilot", "link": "https://stackoverflow.com/users/841876/cardinalpilot"}, "reply_to_user": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1530754567, "post_id": 51178758, "comment_id": 89346972, "body": "@ThomasWeller - the &#39;Enable page heap&#39; step came right from windbg.info.  <a href=\"http://windbg.info/doc/1-common-cmds.html#20_memory_heap\" rel=\"nofollow noreferrer\">windbg.info/doc/1-common-cmds.html#20_memory_heap</a>.  Is that not authoritative, or is it out of date?"}, {"owner": {"reputation": 663, "user_id": 841876, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f354a0c48f10e5cb50a88a99d653d019?s=128&d=identicon&r=PG", "display_name": "cardinalPilot", "link": "https://stackoverflow.com/users/841876/cardinalpilot"}, "reply_to_user": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1530800987, "post_id": 51178758, "comment_id": 89369151, "body": "@ThomasWeller &#39;dps&#39; did the trick.  If you want to post a solution, I&#39;ll be happy to accept it.  Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "is_accepted": true, "score": 1, "last_activity_date": 1530860025, "creation_date": 1530860025, "answer_id": 51204592, "question_id": 51178758, "link": "https://stackoverflow.com/questions/51178758/windbg-dds-unable-to-get-source-where-memory-allocated/51204592#51204592", "title": "windbg dds - unable to get source where memory allocated", "body": "<p><code>dds</code> is the command for <strong>d</strong>ump <strong>D</strong>WORD and interpret as <strong>s</strong>tack. This may work for 32 bit applications.</p>\n\n<p>Your application is a 64 bit application. I can see this from addresses like <code>00007ff7'b1400000</code> which contain a backtick. So you should use <code>dqs</code> (dump quad words and interpret as stack).</p>\n\n<p>Even better is <code>dps</code> (dump pointer size and interpret as stack), since it will use 32 or 64 bit depending on the architecture of your application.</p>\n"}], "owner": {"reputation": 663, "user_id": 841876, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f354a0c48f10e5cb50a88a99d653d019?s=128&d=identicon&r=PG", "display_name": "cardinalPilot", "link": "https://stackoverflow.com/users/841876/cardinalpilot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 51204592, "answer_count": 1, "score": 1, "last_activity_date": 1530860025, "creation_date": 1530726266, "last_edit_date": 1530729834, "question_id": 51178758, "link": "https://stackoverflow.com/questions/51178758/windbg-dds-unable-to-get-source-where-memory-allocated", "title": "windbg dds - unable to get source where memory allocated", "body": "<p>I'm following the directions on windbg.info to try and find the source corresponding to a memory allocation/leak in my program.  I set up a test case with leaky code to try and demonstrate this.  I can get part of the way there, but not able to see actual source.</p>\n\n<p>The C++ code in question is a debug build (optimization turned off, etc).   Called multiple times.</p>\n\n<pre><code>class test\n{\npublic:\n    int Allocate() \n    {\n        pai = new int[128];\n        pasz = new char[128];\n    } \n\nprivate:\n    int * pai = nullptr;\n    char * pasz = nullptr;\n};\n</code></pre>\n\n<p>I'm following the directions on windbg.info (shortened):</p>\n\n<blockquote>\n  <ol>\n  <li>To get source information you must additionally enable page heap in step 1 (gflags.exe /i MyApp.exe +ust +hpa)\n  ...</li>\n  <li>Do a !heap -flt s [Size]. [Size]=AllocSize determined previously. This command will list down all blocks with that particular size.</li>\n  <li>Do a !heap -p -a [UserAddr] to get the stack trace from where you have allocated that much bytes. Use the [UserAddr] that you got in previous step</li>\n  <li>Do a dt ntdll!_DPH_HEAP_BLOCK StackTrace [MyHeapBlockAddr], where [MyHeapBlockAddr] is the DPH_HEAP_BLOCK address retrieved in step 3.</li>\n  <li>Do a dds [StackTrace]\", where [StackTrace] is the value retrieved in previous step.\n  Note that dds will dump the stack with source information included.</li>\n  </ol>\n</blockquote>\n\n<p>I do have all symbols loaded correctly:</p>\n\n<pre><code>00007ff7`b1400000 00007ff7`b142b000   ConsoleApplication1 C (private pdb symbols)  c:\\...\n00007ff8`37ae0000 00007ff8`37c9e000   ucrtbased   (private pdb symbols)  c:\\...\n00007ff8`39d20000 00007ff8`39e16000   MSVCP140D   (private pdb symbols)  c:\\...\n00007ff8`40e30000 00007ff8`40e9e000   verifier   (private pdb symbols)  c:\\...\n00007ff8`40ec0000 00007ff8`40ee2000   VCRUNTIME140D   (private pdb symbols) c:\\...\n00007ff8`6a410000 00007ff8`6a62d000   KERNELBASE   (private pdb symbols) c:\\...\n00007ff8`6b4c0000 00007ff8`6b56c000   KERNEL32   (private pdb symbols) c:\\...\n00007ff8`6d9e0000 00007ff8`6dbb1000   ntdll      (private pdb symbols)  c:\\...\n</code></pre>\n\n<p>I do see a 'good' stack that shows the call to test::Allocate:</p>\n\n<pre><code>0:004&gt; !heap -flt s 2034\n_DPH_HEAP_ROOT @ 272d60e1000\nFreed and decommitted blocks\n  DPH_HEAP_BLOCK : VirtAddr VirtSize\nBusy allocations\n  DPH_HEAP_BLOCK : UserAddr  UserSize - VirtAddr VirtSize\n    00000272d60ecf70 : 00000272d6467fc0 0000000000002034 - 00000272d6467000 0000000000004000\n\n0:004&gt; !heap -p -a  00000272d6467fc0 \naddress 00000272d6467fc0 found in\n_DPH_HEAP_ROOT @ 272d60e1000\nin busy allocation (  DPH_HEAP_BLOCK:         UserAddr         UserSize -         VirtAddr         VirtSize)\n                         272d60ecf70:      272d6467fc0             2034 -      272d6467000             4000\n...\n00007ff7b14142a8 ConsoleApplication1!test::Allocate+0x0000000000000048\n00007ff7b141495a ConsoleApplication1!main+0x000000000000008a\n...\n</code></pre>\n\n<p>I thought I might be able to now get the source of this memory allocation:</p>\n\n<pre><code>0:004&gt; dt ntdll!_DPH_HEAP_BLOCK StackTrace 00000272d60ecf70 \n+0x060 StackTrace : 0x00000272`d2f106d0 _RTL_TRACE_BLOCK\n\n0:004&gt; dds  0x00000272`d2f106d0 \n00000272`d2f106d0  00000000\n00000272`d2f106d4  00000000\n00000272`d2f106d8  00008804\n...\n</code></pre>\n\n<p>No source even though I do have 'source file path' set.  I have not found any examples of what a successful case looks like.  Have I done something wrong in the environment set up, or the commands?</p>\n\n<p>windbg version: 6.12.0002.633 AMD64.  x64 test executable.  </p>\n"}, {"tags": ["c++", "vector", "tree", "genetic-algorithm"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1530724276, "post_id": 51178217, "comment_id": 89339303, "body": "<i>My problem is that sometimes it runs and completes fine and sometimes it just hangs and doesn&#39;t do anything</i> -- Which more than likely means your program has one or more bugs.  Advice -- debug your program with <i>known</i> data that produces the problem, not randomized data.  By using randomized data, you cannot center on the issue easily.  Log the values you use when you use random data that causes the issue, then rewrite your program to hardcode those values so that you get a consistent failing case."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1530724774, "post_id": 51178217, "comment_id": 89339529, "body": "There are cases where you don\u2019t assign values to all members of a <code>node</code>."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1530725240, "post_id": 51178217, "comment_id": 89339713, "body": "And to add to @molbdnilo comment, you could check this by printing out the values of <code>op</code> <code>p</code>, etc. before you return from the <code>node</code> constructor, to confirm exactly what values are being used.  If one of those values is &quot;wild&quot;, then this is one way to confirm you&#39;re using an uninitialized value.  Or you can initialize everything to <code>-1</code> and see if any of those values remain <code>-1</code>, again confirming you did not set all the values in the constructor.  It&#39;s all about debugging and learning how to  debug code."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1530725278, "post_id": 51178217, "comment_id": 89339723, "body": "Out of curiosity, what was the performance of the Python code versus the C++ code?  In my experience, typically, Python takes twice as long to run.  But there can be mitigating factors that may make it have parity with C++, or C++ may be significantly faster (an order of magnitude, perhaps even two orders of magnitude).  And that&#39;s with &quot;everything else being equal&quot; (e.g., same algorithm; appropriate data structures)."}], "answers": [{"tags": [], "owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "is_accepted": false, "score": 0, "last_activity_date": 1530726564, "creation_date": 1530726564, "answer_id": 51178807, "question_id": 51178217, "link": "https://stackoverflow.com/questions/51178217/c-script-sometimes-runs-and-sometimes-hangs/51178807#51178807", "title": "C++ script sometimes runs and sometimes hangs", "body": "<p>As indicated by @molbdnilo, your <code>node</code> constructor is susceptible to having variables that are uninitialized after the constructor returns.  You then use the <code>node</code> instance variable(s) here in <code>grow_tree</code>:</p>\n\n<p><code>for (int j = 0; j &lt; n.req_ch; j++) {</code></p>\n\n<p>If <code>n.req_ch</code> is an uninitialized or \"wild\" value, the loop could go on for a very long time.  Imagine if <code>n.req_ch</code> came back with a value of something close to (assuming 32-bit integers), <code>2^32 - 1</code>.  Your loop will be going on for over 2,000,000,000 iterations.</p>\n\n<p>To confirm this, if you initialized your member of variables of <code>node</code> to a value, you can easily output those variables to see if the initial value was changed.  If the value wasn't changed, this confirms you are using uninitialized values in your <code>grow_tree</code> function.</p>\n\n<p>Example:</p>\n\n<pre><code>node(int p, int rem_depth) :type(-100), op(-100), req_ch(-100) // Initialize everything to -100\n{\n   // your code\n ...\n   // now check if all the variables have been initialized (values were changed from -100)\n   if ( type == -100 || op == -100 || req_ch == -100 )\n   {\n       std::cout &lt;&lt; \"Oops.  I'm using uninitialized values for p = \" &lt;&lt; p &lt;&lt; \n      \" rem_depth = \" &lt;&lt; rem_depth &lt;&lt; \"\\n\";\n       std::cout &lt;&lt; type &lt;&lt; \" \" &lt;&lt; op &lt;&lt; \" \" &lt;&lt; req_ch &lt;&lt; \"\\n\\n\";\n    }   \n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/78ca430af8f5b11d\" rel=\"nofollow noreferrer\">Here is your code, modified with the check.</a></p>\n\n<p>As you can see, your <code>node</code> constructor does not set all the values, and you wind up using those values later on in <code>grow_tree</code>.</p>\n\n<p>So the answer to your issue is to go back and plug up the hole in the <code>node</code> constructor so that your variables are initialized.  </p>\n"}], "owner": {"reputation": 69, "user_id": 4208326, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-FPoA79sZBbk/AAAAAAAAAAI/AAAAAAAAC-k/MYDZnBtWnG8/photo.jpg?sz=128", "display_name": "Sam Naughton B", "link": "https://stackoverflow.com/users/4208326/sam-naughton-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1530726564, "creation_date": 1530723446, "question_id": 51178217, "link": "https://stackoverflow.com/questions/51178217/c-script-sometimes-runs-and-sometimes-hangs", "title": "C++ script sometimes runs and sometimes hangs", "body": "<p>I'm trying to do some genetic programming in C++. I've put together a version of this code in Python and it worked fine (it was just FAR TOO SLOW). The basic premise is viewing programs as tree-like expressions and evolving those.</p>\n\n<p>Here is the code to create just one candidate tree (trees are stored as vectors of nodes which point to their children by the index of the child node in the same vector) (see grow_tree function):</p>\n\n<p>This code compiles fine :) I'm compiling using g++ to get an a.out file which I run using ./a.out</p>\n\n<p>My problem is that sometimes it runs and completes fine and sometimes it just hangs and doesn't do anything (doesn't give me an error either)</p>\n\n<p>Any help on this would be greatly appreciated! Thanks!</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;map&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;cstdlib&gt;\n#include &lt;ctime&gt;\n#include &lt;math.h&gt;\n\nconst int MAX_TREE_DEPTH = 5;\n\nint randint(int min, int max) {\n    return (rand() % ((max - min) + 1)) + min;\n}\n\nstruct node {\n    int type, op, req_ch;\n    std::vector&lt;int&gt; ch;\n    std::map&lt;std::string, float&gt; params;\n    node(int p, int rem_depth) {\n        if ((p == -1) || (p == 0)) {\n            req_ch = 2;\n            if (rem_depth &gt;= 2) { \n                type = randint(0, 1); \n                if (type == 0) { \n                    op = randint(0, 1); \n                } else if (type == 1) { \n                    op = randint(2, 5); \n                }\n            } else { \n                type = 1; \n                op = randint(2, 5); \n            }\n        } else if (p == 1) { \n            type = 2;  \n            if (rem_depth &gt;= 1) { \n                op =  randint(6, 11); \n            } else { op = 11; }\n            if ((op &gt;= 6) &amp;&amp; (op &lt;= 10)) { \n                req_ch = 2; \n            } else if (op &gt;= 11) { req_ch = 0; }\n        }\n    }    \n};\n\nvoid grow_tree(std::vector&lt;node&gt;* func, int p, int rem_depth) {\n    node n(p, rem_depth);\n    func-&gt;push_back(n);\n    int i = func-&gt;size() - 1;\n    for (int j = 0; j &lt; n.req_ch; j++) {\n        func-&gt;at(i).ch.push_back(func-&gt;size());\n        grow_tree(func, n.type, rem_depth - 1);\n    }\n}\n\n\nstruct rule {\n    float score;\n    bool scored;\n    std::vector&lt;node&gt; func;\n    rule(int m) {\n        if (m == 0) { // Random initialisation\n            int depth = randint(2, MAX_TREE_DEPTH);\n            grow_tree(&amp;func, -1, depth);\n        }\n    }\n};\n\n\nint main(void) {\n    srand(time(NULL));  // Seed the random number generator\n    int depth = randint(2, MAX_TREE_DEPTH);\n    std::vector&lt;node&gt; f;\n    grow_tree(&amp;f, -1, depth);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "xaml", "uwp", "initializecomponent"], "comments": [{"owner": {"reputation": 25248, "user_id": 7254781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FsIFV.jpg?s=128&g=1", "display_name": "Nico Zhu - MSFT", "link": "https://stackoverflow.com/users/7254781/nico-zhu-msft"}, "edited": false, "score": 1, "creation_date": 1530758479, "post_id": 51178149, "comment_id": 89347538, "body": "Have you tried clean your solution and rebuild it ?"}, {"owner": {"reputation": 111, "user_id": 6342380, "user_type": "registered", "profile_image": "https://graph.facebook.com/912366072218796/picture?type=large", "display_name": "Carlos Hernandez Perez", "link": "https://stackoverflow.com/users/6342380/carlos-hernandez-perez"}, "reply_to_user": {"reputation": 25248, "user_id": 7254781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FsIFV.jpg?s=128&g=1", "display_name": "Nico Zhu - MSFT", "link": "https://stackoverflow.com/users/7254781/nico-zhu-msft"}, "edited": false, "score": 0, "creation_date": 1531135379, "post_id": 51178149, "comment_id": 89467143, "body": "I tried your solution it didn&#39;t solve the problem right away but it gave me some new error messages that led me to the solution. Thank you @NicoZhu-MSFT"}, {"owner": {"reputation": 25248, "user_id": 7254781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FsIFV.jpg?s=128&g=1", "display_name": "Nico Zhu - MSFT", "link": "https://stackoverflow.com/users/7254781/nico-zhu-msft"}, "edited": false, "score": 0, "creation_date": 1531201986, "post_id": 51178149, "comment_id": 89494667, "body": "I found the same issue in <a href=\"https://social.msdn.microsoft.com/Forums/windowsapps/en-US/f81a6999-0d4d-46ed-8d3d-49136a59a412/uwp-crashes-at-initializecomponent-c?forum=wpdevelop\" rel=\"nofollow noreferrer\">MSDN</a>, And it has been replied. If you have solved your issue please fell free post your answer here and accepted it."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 6342380, "user_type": "registered", "profile_image": "https://graph.facebook.com/912366072218796/picture?type=large", "display_name": "Carlos Hernandez Perez", "link": "https://stackoverflow.com/users/6342380/carlos-hernandez-perez"}, "is_accepted": true, "score": 0, "last_activity_date": 1531217652, "creation_date": 1531217652, "answer_id": 51262634, "question_id": 51178149, "link": "https://stackoverflow.com/questions/51178149/uwp-crashes-at-initializecomponent-c/51262634#51262634", "title": "UWP crashes at InitializeComponent() [C++]", "body": "<p>My problem came with my XAML code, I was trying to apply a \"Style: TextBlockStyle\" to a TextBox.</p>\n"}], "owner": {"reputation": 111, "user_id": 6342380, "user_type": "registered", "profile_image": "https://graph.facebook.com/912366072218796/picture?type=large", "display_name": "Carlos Hernandez Perez", "link": "https://stackoverflow.com/users/6342380/carlos-hernandez-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 51262634, "answer_count": 1, "score": 1, "last_activity_date": 1531217652, "creation_date": 1530723125, "question_id": 51178149, "link": "https://stackoverflow.com/questions/51178149/uwp-crashes-at-initializecomponent-c", "title": "UWP crashes at InitializeComponent() [C++]", "body": "<p>This is the weirdes error I've gotten so far while working on UWP. I was happily working when I ran my code to check some new changes. After the app executed the InitializeComponent() method it crashed. I went on the debugger mode and tried to narrow down what could be the cause of the problem.</p>\n\n<p>The InitializeComponent() function looks like this:</p>\n\n<pre><code>    void ::SDKTemplate::Scenario3_DataBaseHandling::InitializeComponent(){\n    if (_contentLoaded)\n    {\n        return;\n    }\n    _contentLoaded = true;\n    ::Windows::Foundation::Uri^ resourceLocator = ref new ::Windows::Foundation::Uri(L\"ms-appx:///Scenario3_DataBaseHandling.xaml\");\n    ::Windows::UI::Xaml::Application::LoadComponent(this, resourceLocator, ::Windows::UI::Xaml::Controls::Primitives::ComponentResourceLocation::Application);\n}\n</code></pre>\n\n<p>After a few attempts I found that the error was coming after the last line was executed:</p>\n\n<pre><code>  ::Windows::UI::Xaml::Application::LoadComponent(this, resourceLocator, ::Windows::UI::Xaml::Controls::Primitives::ComponentResourceLocation::Application);\n</code></pre>\n\n<p>I am quite new to UWP programming so I don't understand what is the problem. From what I read on the documentation this line loads the components used on the XAML. But I don't understand why this problem is suddenly appearing now or its nature.</p>\n\n<p>Could anyone give me directions to solve my problem?</p>\n"}, {"tags": ["c++", "utf-8"], "answers": [{"comments": [{"owner": {"reputation": 11371, "user_id": 481061, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c4876d67fda212cee59d97ac5a676c2d?s=128&d=identicon&r=PG", "display_name": "Felix Dombek", "link": "https://stackoverflow.com/users/481061/felix-dombek"}, "edited": false, "score": 0, "creation_date": 1530725175, "post_id": 51178510, "comment_id": 89339676, "body": "As far as I understand it, OP has actual literal backslashes and numbers in their string and needs to parse these numbers into unicode first, so this doesn&#39;t help much"}, {"owner": {"reputation": 5440, "user_id": 860566, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7b3c9600bd9d213f52750ac083c1ac28?s=128&d=identicon&r=PG", "display_name": "Thomas Russell", "link": "https://stackoverflow.com/users/860566/thomas-russell"}, "reply_to_user": {"reputation": 11371, "user_id": 481061, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c4876d67fda212cee59d97ac5a676c2d?s=128&d=identicon&r=PG", "display_name": "Felix Dombek", "link": "https://stackoverflow.com/users/481061/felix-dombek"}, "edited": false, "score": 1, "creation_date": 1530725223, "post_id": 51178510, "comment_id": 89339703, "body": "Oh right, I misunderstood - I thought the OP was stating that their string contained the code-points corresponding to those characters! I will leave this here until we get further clarification."}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "edited": false, "score": 0, "creation_date": 1530727961, "post_id": 51178510, "comment_id": 89340636, "body": "It is not clear enough, what is utf8String? If I pass &quot;\\320\\272\\320\\276&quot; I get std::bad_conversion."}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "edited": false, "score": 0, "creation_date": 1530728283, "post_id": 51178510, "comment_id": 89340744, "body": "Looks like I should also use std::regex"}, {"owner": {"reputation": 11371, "user_id": 481061, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c4876d67fda212cee59d97ac5a676c2d?s=128&d=identicon&r=PG", "display_name": "Felix Dombek", "link": "https://stackoverflow.com/users/481061/felix-dombek"}, "reply_to_user": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "edited": false, "score": 0, "creation_date": 1530728389, "post_id": 51178510, "comment_id": 89340771, "body": "@AlexeyStarinsky see my answer on how to do it with a regex, however <code>std::regex</code> doesn&#39;t have a handy overload which accepts a replacer function. So I used Boost."}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "edited": false, "score": 0, "creation_date": 1530736811, "post_id": 51178510, "comment_id": 89343443, "body": "Still cannot figure out what it actually does, see <a href=\"http://rextester.com/live/OHBE38330\" rel=\"nofollow noreferrer\">rextester.com/live/OHBE38330</a>. Why the output is empty?"}], "tags": [], "owner": {"reputation": 5440, "user_id": 860566, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7b3c9600bd9d213f52750ac083c1ac28?s=128&d=identicon&r=PG", "display_name": "Thomas Russell", "link": "https://stackoverflow.com/users/860566/thomas-russell"}, "is_accepted": false, "score": 1, "last_activity_date": 1530724924, "creation_date": 1530724924, "answer_id": 51178510, "question_id": 51178033, "link": "https://stackoverflow.com/questions/51178033/how-to-convert-a-text-like-320-272-320-276-320-274-to-stdwstring-in-c/51178510#51178510", "title": "How to convert a text like &quot;\\320\\272\\320\\276\\320\\274...&quot; to std::wstring in C++?", "body": "<p>If you have a <code>std::string</code> containing UTF-8 code-points and you wish to convert this to <code>std::wstring</code> you can do this in the following way, using the <a href=\"https://en.cppreference.com/w/cpp/locale/codecvt_utf8\" rel=\"nofollow noreferrer\"><code>std::codecvt_utf8</code></a> facet and the <a href=\"https://en.cppreference.com/w/cpp/locale/wstring_convert\" rel=\"nofollow noreferrer\"><code>std::wstring_convert</code></a> class template:</p>\n\n<pre><code>#include &lt;locale&gt;\nstd::wstring convert(const std::string&amp; utf8String) {\n    std::wstring_convert&lt;std::codecvt_utf8&lt;wchar_t&gt;&gt; converter{};\n    return converter.from_bytes(utf8String);\n}\n</code></pre>\n\n<p>The format of the resulting <code>std::wstring</code> will either be UCS2 (on Windows platforms) or UCS4 (most non-Windows platforms).</p>\n\n<p>Note, that the <code>std::codecvt_utf8</code> facet is deprecated as of C++17, and instead consumers are encouraged to rely on specialized unicode/text-processing libraries. But this should suffice for now.</p>\n"}, {"comments": [{"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "edited": false, "score": 0, "creation_date": 1530735426, "post_id": 51178738, "comment_id": 89343042, "body": "converted the string to &quot;Invalid user &#208;&#186;&#208;&#190;&#208;&#188;&#208;&#188;&#209;&#208;&#189;&#208;&#184;&#208;&#183;&#208;&#188; from 172.28.60.28 port 62291\\n&quot;, but utf8Converter.from_bytes() still throws &quot;bad conversion&quot;. strange... what can be wrong....?"}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "edited": false, "score": 0, "creation_date": 1530738240, "post_id": 51178738, "comment_id": 89343858, "body": "The conversion itself works fine, but looks like sometimes I get not a valid UTF8 strings. So the both answers are very good! But you answered first."}], "tags": [], "owner": {"reputation": 11371, "user_id": 481061, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c4876d67fda212cee59d97ac5a676c2d?s=128&d=identicon&r=PG", "display_name": "Felix Dombek", "link": "https://stackoverflow.com/users/481061/felix-dombek"}, "is_accepted": true, "score": 2, "last_activity_date": 1530908470, "last_edit_date": 1530908470, "creation_date": 1530726123, "answer_id": 51178738, "question_id": 51178033, "link": "https://stackoverflow.com/questions/51178033/how-to-convert-a-text-like-320-272-320-276-320-274-to-stdwstring-in-c/51178738#51178738", "title": "How to convert a text like &quot;\\320\\272\\320\\276\\320\\274...&quot; to std::wstring in C++?", "body": "<p>The numbers after the backslashes are the UTF-8 byte sequence values of the Cyrillic letters, each byte represented as an octal number.</p>\n\n<p>You could for example use a regex replace to replace each <code>\\ooo</code> with its value so that you get a real UTF-8 string out:</p>\n\n<p><a href=\"https://wandbox.org/permlink/SsVWYmC7Ofg41qaD\" rel=\"nofollow noreferrer\">See it on Wandbox</a></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;boost/regex.hpp&gt;\n\nint main()\n{\n    std::string const source = R\"(Invalid user \\320\\272\\320\\276\\320\\274\\320\\274\\321\\320\\275\\320\\270\\320\\267\\320\\274 from 172.28.60.28 port 50712)\";\n    boost::regex const re(R\"(\\\\\\d\\d\\d)\");\n\n    auto const replacer = [](boost::smatch const&amp; match, auto it) {\n        auto const byteVal = std::stoi(&amp;match[0].str()[1], 0, 8);\n        *it = static_cast&lt;char&gt;(byteVal);\n        return ++it;\n    };\n    std::string const out = boost::regex_replace(source, re, replacer);\n\n    std::cout &lt;&lt; out &lt;&lt; std::endl;\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>If you really need to, you can then convert this <code>std::string</code> to <code>std::wstring</code> using e.g. <a href=\"https://stackoverflow.com/a/51178510/481061\">Thomas</a>'s method.</p>\n"}], "owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 51178738, "answer_count": 2, "score": 1, "last_activity_date": 1530908470, "creation_date": 1530722578, "last_edit_date": 1530723053, "question_id": 51178033, "link": "https://stackoverflow.com/questions/51178033/how-to-convert-a-text-like-320-272-320-276-320-274-to-stdwstring-in-c", "title": "How to convert a text like &quot;\\320\\272\\320\\276\\320\\274...&quot; to std::wstring in C++?", "body": "<p>I am working on a code that processes message from Ubuntu, some of the messages contains, for example:</p>\n\n<p><em>localhost sshd 1658 - -  Invalid user \\320\\272\\320\\276\\320\\274\\320\\274\\321\\320\\275\\320\\270\\320\\267\\320\\274 from 172.28.60.28 port 50712 ]</em></p>\n\n<p>where \"\\320\\272\\320\\276\\320\\274\\320\\274\\321\\320\\275\\320\\270\\320\\267\\320\\274\" is the user name that originally is in Russian. How to convert it to std::wstring?</p>\n"}, {"tags": ["c++", "vector", "c++14", "smart-pointers", "unique-ptr"], "comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 4, "creation_date": 1530722608, "post_id": 51177969, "comment_id": 89338637, "body": "I would use the second + reserve call"}, {"owner": {"reputation": 314, "user_id": 5228740, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nnUZy.png?s=128&g=1", "display_name": "Hannes Hauptmann", "link": "https://stackoverflow.com/users/5228740/hannes-hauptmann"}, "edited": false, "score": 0, "creation_date": 1530722635, "post_id": 51177969, "comment_id": 89338657, "body": "In the first method, you can use for(auto &amp;it : vec)"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1530723007, "post_id": 51177969, "comment_id": 89338808, "body": "Barring ultra-smart compilers, the second alternative will involve frequent reallocation of the vector as it grows. You can avoid this by reserving space beforehand. As for <code>push_back</code> vs <code>emplace_back</code>, <a href=\"https://godbolt.org/g/4VmWGV\" rel=\"nofollow noreferrer\">gcc produces identical code in both cases</a>."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1530723046, "post_id": 51177969, "comment_id": 89338827, "body": "Are you sure that\u2019s C++11? The <code>make_unique</code> function <a href=\"https://en.cppreference.com/w/cpp/memory/unique_ptr/make_unique\" rel=\"nofollow noreferrer\">wasn\u2019t standardized until C++14</a>."}, {"owner": {"reputation": 658, "user_id": 7624196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca192bf44a9bb2b243a6cd8813e2c643?s=128&d=identicon&r=PG&f=1", "display_name": "orematasaburo", "link": "https://stackoverflow.com/users/7624196/orematasaburo"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1530723605, "post_id": 51177969, "comment_id": 89339054, "body": "@DanielH edited it. I&#39;m a beginner, sorry."}], "answers": [{"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1530722983, "post_id": 51178084, "comment_id": 89338798, "body": "<code>push_back</code> can only be less efficient because of the checks of capacity and incrementing the size for each element."}, {"owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 4, "creation_date": 1530723113, "post_id": 51178084, "comment_id": 89338858, "body": "Perhaps.  We&#39;d have to measure to be sure.  Using the first method, we have to 0 fill 40 million bytes of memory, and I suspect this will outweigh the additional computational complexity in the second method."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1530723476, "post_id": 51178084, "comment_id": 89339004, "body": "The performance difference is <a href=\"http://quick-bench.com/gpOyhwvMfHKVY5Up4hBs1Trn-vI\" rel=\"nofollow noreferrer\">extremely marginal</a> at best. At least in that benchmark configuration."}], "tags": [], "owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "is_accepted": true, "score": 7, "last_activity_date": 1530723111, "last_edit_date": 1530723111, "creation_date": 1530722821, "answer_id": 51178084, "question_id": 51177969, "link": "https://stackoverflow.com/questions/51177969/proper-way-to-initialize-a-vector-of-unique-pointers-in-c14/51178084#51178084", "title": "Proper way to initialize a vector of unique pointers in C++14", "body": "<p>Either way works.  The second is marginally more efficient <em>if</em> you reserve the correct capacity first.  Personally, I think the standard algorithms are more expressive.  I would do it like this:</p>\n\n<pre><code>std::vector&lt;std::unique_ptr&lt;int&gt;&gt; vec;\nvec.reserve(N);\nstd::generate_n(std::back_inserter(vec), N, [] { return std::make_unique&lt;int&gt;(); });\n</code></pre>\n"}], "owner": {"reputation": 658, "user_id": 7624196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca192bf44a9bb2b243a6cd8813e2c643?s=128&d=identicon&r=PG&f=1", "display_name": "orematasaburo", "link": "https://stackoverflow.com/users/7624196/orematasaburo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1586, "favorite_count": 1, "accepted_answer_id": 51178084, "answer_count": 1, "score": 1, "last_activity_date": 1530725218, "creation_date": 1530722199, "last_edit_date": 1530725218, "question_id": 51177969, "link": "https://stackoverflow.com/questions/51177969/proper-way-to-initialize-a-vector-of-unique-pointers-in-c14", "title": "Proper way to initialize a vector of unique pointers in C++14", "body": "<p>For initializing a vector of unique pointers in C++14, I can consider the following two ways. Which method is better?</p>\n\n<pre><code>#include&lt;memory&gt;\n#include&lt;vector&gt;\nusing namespace std;\n\nint main(){\n\n  const int N = 10000000;\n\n  {//first method\n    vector&lt;unique_ptr&lt;int&gt;&gt; vec(N);\n    for(auto it=vec.begin(); it!=vec.end();++it){\n      auto ptr = make_unique&lt;int&gt;();\n      *it = std::move(ptr);\n    }\n  }\n\n  {//second method\n    vector&lt;unique_ptr&lt;int&gt;&gt; vec;\n    for(int i=0; i&lt;N; i++){\n      vec.push_back(make_unique&lt;int&gt;());\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["c++", "eigen", "eigen3"], "comments": [{"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 3, "creation_date": 1530722563, "post_id": 51177826, "comment_id": 89338613, "body": "Did you compile without <code>-DNDEBUG</code> and with or without optimizations? Read how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. E.g., start with the non-working code and remove parts until it works (then insert them again, and remove other parts) -- do the same for the compile-flags. You may have undefined behavior after the <code>cout</code>, which means, even with <code>std::endl</code> you don&#39;t see the result. Insert a <code>int dummy; std::cin &gt;&gt; dummy;</code> to be sure, it executes that line."}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 1, "creation_date": 1530734006, "post_id": 51177826, "comment_id": 89342578, "body": "Looks like you are using an old version of Eigen, so first make sure you are using the latest release (3.3.4) or even the head of the 3.3 branch."}, {"owner": {"reputation": 167, "user_id": 4610716, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/318e46619794c838204b4c6acc4775dd?s=128&d=identicon&r=PG&f=1", "display_name": "lesurp", "link": "https://stackoverflow.com/users/4610716/lesurp"}, "reply_to_user": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 1, "creation_date": 1530782452, "post_id": 51177826, "comment_id": 89356936, "body": "@ggael Wow updating did fix my issue. I have <i>no</i> idea what version I was using (I was convinced it was 3.3.4). I updated reluctantly, thinking it wouldn&#39;t do any good. Would it be possible to add the version number somewhere? Or maybe it already is and I didn&#39;t find it? The issue with header-only libs is that you tend to drop the files without any CMake file/.git folder and when stuff breaks you have no idea what&#39;s what. Anyway, thank you!"}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 1, "creation_date": 1530789168, "post_id": 51177826, "comment_id": 89361246, "body": "@pLesur The version number is hidden in <code>Eigen&#47;src&#47;Core&#47;util&#47;Macros.h</code> (the first actual macros that get defined)."}, {"owner": {"reputation": 167, "user_id": 4610716, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/318e46619794c838204b4c6acc4775dd?s=128&d=identicon&r=PG&f=1", "display_name": "lesurp", "link": "https://stackoverflow.com/users/4610716/lesurp"}, "edited": false, "score": 0, "creation_date": 1530791546, "post_id": 51177826, "comment_id": 89362861, "body": "Why, I was using  3.2.8. Anyway, thank you, once more"}], "owner": {"reputation": 167, "user_id": 4610716, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/318e46619794c838204b4c6acc4775dd?s=128&d=identicon&r=PG&f=1", "display_name": "lesurp", "link": "https://stackoverflow.com/users/4610716/lesurp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1530721514, "creation_date": 1530721514, "question_id": 51177826, "link": "https://stackoverflow.com/questions/51177826/eigen-multiplication-hanging", "title": "Eigen multiplication hanging", "body": "<p>Here's the problematic function (a bit modified during my debug attempts):</p>\n\n<pre><code>// note: using MatrixX = Eigen::MatrixXd;\nVectorX Foo::bar(const MatrixX &amp;mat,\n                                                const VectorX &amp;b,\n                                                const MatrixX &amp;D,\n                                                MatrixX &amp;cov,\n                                                double *chisq,\n                                                double *cond)\n{\n    std::cout &lt;&lt; \"size of the matrices....\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"D row/col: \" &lt;&lt; D.rows() &lt;&lt; '/' &lt;&lt; D.cols() &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"mat row/col: \" &lt;&lt; mat.rows() &lt;&lt; '/' &lt;&lt; mat.cols() &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"D: \" &lt;&lt; std::endl;\n    std::cout &lt;&lt; D &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"mat: \" &lt;&lt; std::endl;\n    std::cout &lt;&lt; mat &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"And A = D*mat:\" &lt;&lt; std::endl;\n    MatrixX A = D * mat;\n    std::cout &lt;&lt; A &lt;&lt; std::endl;\n\n    return {}; // of course we do more here but to make debugging easier yknow...\n}\n</code></pre>\n\n<p>What happens is <em>the last cout is never displayed</em>.\nOf course you will say the matrix sizes must be incompatible, and of course I wish it was that simple:</p>\n\n<pre><code>size of the matrices....\nD row/col: 4/4\nmat row/col: 4/3\nD: \n1 0 0 0\n0 1 0 0\n0 0 1 0\n0 0 0 1\nmat: \n        -1          0  0.0377692\n        -0         -1  -0.218875\n -0.958009 -0.0190212  -0.292296\n  0.148245  -0.896453  -0.473009\nAnd A = D*mat:\n^C\n</code></pre>\n\n<p>So A should be computed without issue as a 4*3 matrix.</p>\n\n<p>I tried to reproduce this with this trivial piece of code:</p>\n\n<pre><code>#include &lt;eigen3/Eigen/Eigen&gt;\n#include &lt;iostream&gt;\n\nusing M = Eigen::MatrixXd;\n\nvoid stupid_piece_of_shit(M const &amp;mat, M const &amp;D_)\n{\n    M A_ = D_ * mat;\n    std::cout &lt;&lt; A_ &lt;&lt; std::endl; // making sure A_ is actually evaluated\n}\n\nint main(int argc, char *argv[])\n{\n    auto mat = M(4, 3);\n    auto D_ = M(4, 4);\n\n    mat &lt;&lt; -1, 0, 0.0377692,\n        -0, -1, -0.218875,\n        -0.958009, -0.0190212, -0.292296,\n        0.148245, -0.896453, -0.473009;\n\n    D_ &lt;&lt; 1, 0, 0, 0,\n        0, 1, 0, 0,\n        0, 0, 1, 0,\n        0, 0, 0, 1;\n\n    wat(mat, D_);\n    return 0;\n}\n</code></pre>\n\n<p><em>Of course</em> this sample works perfectly fine.</p>\n\n<p>So I ran the thing with gdb, ^C while the program was hanging, then got the backtrace:</p>\n\n<pre><code>Thread 1 \"foo\" received signal SIGINT, Interrupt.\n0x00007ffff6fa2be3 in Eigen::internal::gebp_kernel&lt;double, double, long, Eigen::internal::blas_data_mapper&lt;double, long, 0, 0&gt;, 4, 4, false, false&gt;::operator()(Eigen::internal::blas_data_mapper&lt;double, long\n, 0, 0&gt; const&amp;, double const*, double const*, long, long, long, double, long, long, long, long) () from blabla\n\n(gdb) bt\n#0  0x00007ffff6fa2be3 in Eigen::internal::gebp_kernel&lt;double, double, long, Eigen::internal::blas_data_mapper&lt;double, long, 0, 0&gt;, 4, 4, false, false&gt;::operator()(Eigen::internal::blas_data_mapper&lt;double,\nlong, 0, 0&gt; const&amp;, double const*, double const*, long, long, long, double, long, long, long, long) () from blabla.so\n\n#1  0x00007ffff6fa8c83 in Eigen::internal::general_matrix_matrix_product&lt;long, double, 0, false, double, 0, false, 0&gt;::run(long, long, long, double const*, long, double const*, long, double*, long, double,\nEigen::internal::level3_blocking&lt;double, double&gt;&amp;, Eigen::internal::GemmParallelInfo&lt;long&gt;*) () from blabla.so\n\n#2  0x00007fffcdfb2002 in Eigen::internal::gemm_functor&lt;double, long, Eigen::internal::general_matrix_matrix_product&lt;long, double, 0, false, double, 0, false, 0&gt;, Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, E\nigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, Eigen::internal::gemm_blocking_space&lt;0, double, double, -1, -1, -1, 1, false&gt; &gt;::operator() (this=0x7fffffff9f50, row=0, ro\nws=4, col=0, cols=3, info=0x0) at project/3rdparty/eigen3/Eigen/src/Core/products/GeneralMatrixMatrix.h:223\n\n#3  0x00007fffcdfb11d6 in Eigen::internal::parallelize_gemm&lt;true, Eigen::internal::gemm_functor&lt;double, long, Eigen::internal::general_matrix_matrix_product&lt;long, double, 0, false, double, 0, false, 0&gt;, Eig\nen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, Eigen::internal::gemm_blocking_space&lt;0, double, double, -1, -1, -1, 1, false&gt; &gt;, lo\nng&gt; (func=..., rows=4, cols=3, transpose=false) at project/3rdparty/eigen3/Eigen/src/Core/products/Parallelizer.h:96\n\n#4  0x00007fffcdfb1074 in Eigen::GeneralProduct&lt;Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, 5&gt;::scaleAndAddTo&lt;Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt; &gt; (this=0x7ffff\nfffa770, dst=Eigen::Matrix&lt;double,4,3,ColMajor&gt; (data ptr: 0x161b3000) = {...}, alpha=@0x7fffffffa048: 1) at project/3rdparty/eigen3/Eigen/src/Core/products/GeneralMatrixMatrix.h:\n427\n\n#5  0x00007fffcdfb0e20 in Eigen::ProductBase&lt;Eigen::GeneralProduct&lt;Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, 5&gt;, Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, Eigen::Ma\ntrix&lt;double, -1, -1, 0, -1, -1&gt; &gt;::scaleAndAddTo&lt;Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt; &gt; (this=0x7fffffffa770, dst=Eigen::Matrix&lt;double,4,3,ColMajor&gt; (data ptr: 0x161b3000) = {...}, alpha=@0x7fffffffa048\n: 1) at project/3rdparty/eigen3/Eigen/src/Core/ProductBase.h:118\n\n#6  0x00007fffcdfb0db6 in Eigen::ProductBase&lt;Eigen::GeneralProduct&lt;Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, 5&gt;, Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, Eigen::Ma\ntrix&lt;double, -1, -1, 0, -1, -1&gt; &gt;::evalTo&lt;Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt; &gt; (this=0x7fffffffa770, dst=Eigen::Matrix&lt;double,4,3,ColMajor&gt; (data ptr: 0x161b3000) = {...}) at project/3rdparty/eigen3/Eigen/src/Core/ProductBase.h:109\n\n#7  0x00007fffcdf7c4ea in Eigen::ProductBase&lt;Eigen::GeneralProduct&lt;Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, 5&gt;, Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt;, Eigen::Ma\ntrix&lt;double, -1, -1, 0, -1, -1&gt; &gt;::operator Eigen::Matrix&lt;double, -1, -1, 0, -1, -1&gt; const&amp; (this=0x7fffffffa770) at project/3rdparty/eigen3/Eigen/src/Core/ProductBase.h:127\n\n#8  0x00007fffcdf79cd7 in Bar::bar2 (mat=Eigen::Matrix&lt;double,4,3,ColMajor&gt; (data ptr: 0x1528cdc0) = {...}, b=Eigen::Matrix&lt;double,4,1,ColMajor&gt; (data ptr: 0x1513e5b0) = {...}, D=Eigen::Matri\nx&lt;double,4,4,ColMajor&gt; (data ptr: 0x16172b20) = {...}, cov=Eigen::Matrix&lt;double,3,3,ColMajor&gt; (data ptr: 0x161b8400) = {...}, chisq=0x7fffffffa968, cond=0x7fffffffa960) at project\nsomefile.cpp\n\n#9  0x00007fffcdf79906 in Bar::bar (poses=std::vector of length 2, capacity 2 = {...}, image_points=std::vector of length 2, capacity 2 = {...}, point_3d_W=Eigen::Matrix&lt;doubl\ne,3,1,ColMajor&gt; (data ptr: 0x7fffffffc320) = {...}, covariance_W=Eigen::Matrix&lt;double,3,3,ColMajor&gt; (data ptr: 0x7fffffffc338) = {...}) at somefile2.cpp\n\n#10 0x000000000041d10e in main (argc=1, argv=0x7fffffffd9c8) at project/applications/bar/src/main.cpp:376\n</code></pre>\n\n<p>Some more details:</p>\n\n<ul>\n<li>The CPU usage of my  program is at 100% when it's hanging</li>\n<li>The code works fine (according to my colleague) on Windows (VC 14)</li>\n<li>The issue is met with both clang and gcc</li>\n<li>The matrices passed as parameters are declared on the stack (<em>not</em> from a struct) so it shouldn't be some weird allocator problem</li>\n</ul>\n\n<p>I will try to go into the Eigen call stack tomorrow, and find what's happening but from what I've seen this is <em>tedious</em> to do (and gdb doesn't load Eigen::internal for some reason). So if anybody has pointers/solutions to this quite strange issue... Well thank you for making my Thursday that much nicer</p>\n"}, {"tags": ["c++", "json", "qt"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9896445, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FIkgNkPBNTQ/AAAAAAAAAAI/AAAAAAAAABk/bAlxlCdQu1g/photo.jpg?sz=128", "display_name": "Asier", "link": "https://stackoverflow.com/users/9896445/asier"}, "is_accepted": false, "score": 0, "last_activity_date": 1530728422, "creation_date": 1530728422, "answer_id": 51179192, "question_id": 51177749, "link": "https://stackoverflow.com/questions/51177749/reading-and-saving-data-from-a-json/51179192#51179192", "title": "Reading and saving data from a Json", "body": "<p>I ended up doing this, it works, looks horrible and it probably is super ineficient, but... it works :)</p>\n\n<pre><code>void Basico::on_pushButtonCargar_clicked()\n{\n    QFile file(\"DatosBasico.json\");\n    //Leer el archivoo que tiene el Json\n    if(!file.open(QFile::ReadOnly)){\n        qDebug()&lt;&lt; \"Error, No se puede abrir el fichero.\";\n        return;\n    }\n\n    QJsonDocument jsonDoc = QJsonDocument::fromJson(file.readAll());\n    d.demanda = jsonDoc.object().value(\"0 - Demanda\").toDouble();\n    d.ref_demanda = jsonDoc.object().value(\"0.1 - Ref. Temporal Demanda\").toString();\n    d.Ts = jsonDoc.object().value(\"1 - Tiempo de Suministro\").toDouble();\n    d.ref_Ts = jsonDoc.object().value(\"1.1 - Ref. Temporal Ts\").toString();\n    d.Cp = jsonDoc.object().value(\"2 - Coste de Posesion\").toDouble();\n    d.ref_Cp = jsonDoc.object().value(\"2.1 - Ref. Temporal Cp\").toString();\n    d.Tipo_Cp = jsonDoc.object().value(\"2.2 - Tipo de Coste de Posesion\").toString();\n    d.Ce = jsonDoc.object().value(\"3 - Coste Unitario de Emision\").toDouble();\n    d.PrecioUCompra = jsonDoc.object().value(\"4 - Precio Unitario de compra\").toDouble();\n    file.close();\n\n    QString demanda_cargada=QString::number(d.demanda);\n    ui-&gt;lineEditDemanda-&gt;setText(demanda_cargada);\n\n    ui-&gt;comboBoxDemanda-&gt;setCurrentText(d.ref_demanda);\n\n    QString Ts_cargado=QString::number(d.Ts);\n    ui-&gt;lineEditTS-&gt;setText(Ts_cargado);\n\n    ui-&gt;comboBoxTS-&gt;setCurrentText(d.ref_Ts);\n\n    QString Cp_cargado=QString::number(d.Cp);\n    ui-&gt;lineEditCP-&gt;setText(Cp_cargado);\n\n    ui-&gt;comboBoxCP-&gt;setCurrentText(d.ref_Cp);\n\n    if (d.Tipo_Cp == \"Dependiente\")\n    {\n        ui-&gt;checkBoxDependiente-&gt;click();\n    }\n\n    if (d.Tipo_Cp == \"Independiente\")\n    {\n        ui-&gt;checkBoxIndependiente-&gt;click();\n    }\n\n    QString CE_cargado=QString::number(d.Ce);\n    ui-&gt;lineEditCe-&gt;setText(CE_cargado);\n\n    QString PUC_cargado=QString::number(d.PrecioUCompra);\n    ui-&gt;lineEditPrecioUCompra-&gt;setText(PUC_cargado);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9896445, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FIkgNkPBNTQ/AAAAAAAAAAI/AAAAAAAAABk/bAlxlCdQu1g/photo.jpg?sz=128", "display_name": "Asier", "link": "https://stackoverflow.com/users/9896445/asier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530732151, "creation_date": 1530721194, "last_edit_date": 1530732151, "question_id": 51177749, "link": "https://stackoverflow.com/questions/51177749/reading-and-saving-data-from-a-json", "title": "Reading and saving data from a Json", "body": "<p>I have a .json document with data from my program that I want to reload in it. It looks like this:</p>\n\n<pre><code>{\n    \"0 - Demanda\": 100,\n    \"0.1 - Ref. Temporal Demanda\": \"Mensual\",\n    \"1 - Tiempo de Suministro\": 2,\n    \"1.1 - Ref. Temporal Ts\": \"Diario\",\n    \"2 - Coste de Posesion\": 20,\n    \"2.1 - Ref. Temporal Cp\": \"Semanal\",\n    \"2.2 - Tipo de Coste de Posesion\": \"Dependiente\",\n    \"3 - Coste Unitario de Emision\": 20,\n    \"4 - Precio Unitario de compra\": 30\n}\n</code></pre>\n\n<p>To obtain this data I have filled each respective QLineEdit, QComboBox and QCheckBox, now I want to read the file I generated using this code:</p>\n\n<pre><code>void WResultados_Basico::on_pushButtonGuardar_clicked()\n{\n    QJsonObject recordObject;\n    recordObject.insert(\"0 - Demanda\", QJsonValue::fromVariant(d.demanda_original));   //d.anything is class with data\n    recordObject.insert(\"0.1 - Ref. Temporal Demanda\", QJsonValue::fromVariant(d.ref_demanda));\n    recordObject.insert(\"1 - Tiempo de Suministro\", QJsonValue::fromVariant(d.Ts_original));\n    recordObject.insert(\"1.1 - Ref. Temporal Ts\", QJsonValue::fromVariant(d.ref_Ts));\n    recordObject.insert(\"2 - Coste de Posesion\", QJsonValue::fromVariant(d.Cp_original));\n    recordObject.insert(\"2.1 - Ref. Temporal Cp\", QJsonValue::fromVariant(d.ref_Cp));\n    recordObject.insert(\"2.2 - Tipo de Coste de Posesion\", QJsonValue::fromVariant(d.Tipo_Cp));\n    recordObject.insert(\"3 - Coste Unitario de Emision\", QJsonValue::fromVariant(d.Ce));\n    recordObject.insert(\"4 - Precio Unitario de compra\", QJsonValue::fromVariant(d.PrecioUCompra));\n\n    QJsonDocument doc(recordObject);\n    qDebug() &lt;&lt; doc.toJson();\n\n   QByteArray ba=doc.toJson();\n   QFile fid;\n   fid.setFileName(\"DatosBasico.json\");\n\n   if (fid.open(QIODevice::WriteOnly))\n   {\n        fid.write(ba);\n        fid.close();\n   }\n}\n</code></pre>\n\n<p>So, my goal is to refill the respective ComboBox, etc with the data I read. Maybe something like this could work but I don\u00b4t know how to assign a variable to each individual value:</p>\n\n<pre><code>{\n    QFile fid;\n    QByteArray ba;\n    fid.open(\"DatosBasico.json\"::ReadOnly);\n    ba=fid.readAll();\n    doc.fromByteArray(ba);\n    fid.close();\n}\n</code></pre>\n\n<p>Thank you for the help and patience</p>\n"}, {"tags": ["c++", "memory", "clang", "llvm", "address-sanitizer"], "comments": [{"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "edited": false, "score": 0, "creation_date": 1530721985, "post_id": 51177708, "comment_id": 89338364, "body": "Note that some compilers may catch the use of the uninitialized variable: GCC (<a href=\"https://godbolt.org/g/YXk4z1\" rel=\"nofollow noreferrer\">godbolt.org/g/YXk4z1</a>) and MSVC (<a href=\"https://godbolt.org/g/UPmBK6\" rel=\"nofollow noreferrer\">godbolt.org/g/UPmBK6</a>)."}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1530721993, "post_id": 51177708, "comment_id": 89338371, "body": "I am a little surprised the first example doesn&#39;t generate an error because <code>itoa()</code> should require some branch on the data in order to know when to stop. (maybe that&#39;s performed in the pre-compiled part of libc++?)"}, {"owner": {"reputation": 1062, "user_id": 4482655, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-xw9BuCVIPOY/AAAAAAAAAAI/AAAAAAAAAJ0/Ol8fswZG3KQ/photo.jpg?sz=128", "display_name": "Deepankar Arya", "link": "https://stackoverflow.com/users/4482655/deepankar-arya"}, "reply_to_user": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "edited": false, "score": 0, "creation_date": 1530722391, "post_id": 51177708, "comment_id": 89338539, "body": "@Acorn With a tool like a MSan, I am expecting run time debugging, what you suggest is true but it is a compile time check."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1530722463, "post_id": 51177708, "comment_id": 89338575, "body": "Seems like a bug, you could log it"}, {"owner": {"reputation": 1062, "user_id": 4482655, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-xw9BuCVIPOY/AAAAAAAAAAI/AAAAAAAAAJ0/Ol8fswZG3KQ/photo.jpg?sz=128", "display_name": "Deepankar Arya", "link": "https://stackoverflow.com/users/4482655/deepankar-arya"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1530722609, "post_id": 51177708, "comment_id": 89338639, "body": "@JVApen As per MSan docs, it is not really a bug since no &quot;branching&quot; is taking place in the first code snippet. My main point is regarding MSan."}, {"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "edited": false, "score": 0, "creation_date": 1530722880, "post_id": 51177708, "comment_id": 89338750, "body": "@DeepankarArya: Sure, but I am not sure why would you not prefer to catch it earlier."}, {"owner": {"reputation": 1062, "user_id": 4482655, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-xw9BuCVIPOY/AAAAAAAAAAI/AAAAAAAAAJ0/Ol8fswZG3KQ/photo.jpg?sz=128", "display_name": "Deepankar Arya", "link": "https://stackoverflow.com/users/4482655/deepankar-arya"}, "edited": false, "score": 0, "creation_date": 1530723134, "post_id": 51177708, "comment_id": 89338870, "body": "I get your point. It&#39;s just that it would be convenient to have a single comprehensive tool(MSan) on which one could rely to catch different sorts of errors. Also, I feel a bit more confident with run time checks since I feel compile time checks are a bonus and not that thorough."}, {"owner": {"reputation": 6958, "user_id": 857727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3772f7ef99bd17c1e77d77edbf76c13d?s=128&d=identicon&r=PG&f=1", "display_name": "arnt", "link": "https://stackoverflow.com/users/857727/arnt"}, "edited": false, "score": 0, "creation_date": 1530723717, "post_id": 51177708, "comment_id": 89339099, "body": "What does &quot;this type of error&quot; mean? Clearly it is something more than the  branching decisions MSan currently reports, and if I understand you correctly you don&#39;t want it to include logic and arithemetic."}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 1, "creation_date": 1530723724, "post_id": 51177708, "comment_id": 89339102, "body": "Front-loading as much work (including validation) as possible to compile-time is one of the most fundamental aspect of C++. Tools like MSan are good safety nets, but they should never be your primary means of catching errors. (I think your question is still valid though, just replying to your sentiment about compile vs runtime checking)"}, {"owner": {"reputation": 1062, "user_id": 4482655, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-xw9BuCVIPOY/AAAAAAAAAAI/AAAAAAAAAJ0/Ol8fswZG3KQ/photo.jpg?sz=128", "display_name": "Deepankar Arya", "link": "https://stackoverflow.com/users/4482655/deepankar-arya"}, "edited": false, "score": 0, "creation_date": 1530724084, "post_id": 51177708, "comment_id": 89339233, "body": "yeah. I assume it&#39;s a bug then that clang is not giving a warning."}, {"owner": {"reputation": 6958, "user_id": 857727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3772f7ef99bd17c1e77d77edbf76c13d?s=128&d=identicon&r=PG&f=1", "display_name": "arnt", "link": "https://stackoverflow.com/users/857727/arnt"}, "edited": false, "score": 0, "creation_date": 1530724236, "post_id": 51177708, "comment_id": 89339281, "body": "Are yo sure the code that outputs decimal digits is compiled with msan?"}, {"owner": {"reputation": 1062, "user_id": 4482655, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-xw9BuCVIPOY/AAAAAAAAAAI/AAAAAAAAAJ0/Ol8fswZG3KQ/photo.jpg?sz=128", "display_name": "Deepankar Arya", "link": "https://stackoverflow.com/users/4482655/deepankar-arya"}, "reply_to_user": {"reputation": 6958, "user_id": 857727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3772f7ef99bd17c1e77d77edbf76c13d?s=128&d=identicon&r=PG&f=1", "display_name": "arnt", "link": "https://stackoverflow.com/users/857727/arnt"}, "edited": false, "score": 0, "creation_date": 1530727747, "post_id": 51177708, "comment_id": 89340577, "body": "@arnt yes it is compiled with msan"}, {"owner": {"reputation": 6958, "user_id": 857727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3772f7ef99bd17c1e77d77edbf76c13d?s=128&d=identicon&r=PG&f=1", "display_name": "arnt", "link": "https://stackoverflow.com/users/857727/arnt"}, "edited": false, "score": 0, "creation_date": 1530735269, "post_id": 51177708, "comment_id": 89342989, "body": "Curious. How does the function look?"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10464405, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/717cbf4db8468c5de38076cdf3ac7b14?s=128&d=identicon&r=PG", "display_name": "Nick Lewycky", "link": "https://stackoverflow.com/users/10464405/nick-lewycky"}, "is_accepted": false, "score": 0, "last_activity_date": 1538795672, "creation_date": 1538795672, "answer_id": 52675399, "question_id": 51177708, "link": "https://stackoverflow.com/questions/51177708/make-clangs-memory-sanitizer-report-unitialised-variable-use-without-it-decidin/52675399#52675399", "title": "Make clang&#39;s Memory Sanitizer report unitialised variable use without it deciding branching", "body": "<p>It sounds like your C++ library wasn't built with MSan. Unlike ASan and UBSan, MSan requires that the whole program was built with msan enabled. Think of it like having a different ABI, you shouldn't link two programs built with different msan settings. The one exception is libc for which msan adds \"interceptors\" to make it work.</p>\n\n<p>If you write your own code which you want to integrate with msan by reporting an error where msan normally wouldn't (say, in a function which makes a copy but you know the data needs to be initialized) then you can use __msan_check_mem_is_initialized from the msan_interface.h file: <a href=\"https://github.com/llvm-mirror/compiler-rt/blob/master/include/sanitizer/msan_interface.h\" rel=\"nofollow noreferrer\">https://github.com/llvm-mirror/compiler-rt/blob/master/include/sanitizer/msan_interface.h</a></p>\n"}], "owner": {"reputation": 1062, "user_id": 4482655, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-xw9BuCVIPOY/AAAAAAAAAAI/AAAAAAAAAJ0/Ol8fswZG3KQ/photo.jpg?sz=128", "display_name": "Deepankar Arya", "link": "https://stackoverflow.com/users/4482655/deepankar-arya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1538795672, "creation_date": 1530721022, "question_id": 51177708, "link": "https://stackoverflow.com/questions/51177708/make-clangs-memory-sanitizer-report-unitialised-variable-use-without-it-decidin", "title": "Make clang&#39;s Memory Sanitizer report unitialised variable use without it deciding branching", "body": "<p>I was experimenting with Clang 6.0's Memory Sanitizer(MSan). \nCode is compiled with </p>\n\n<pre><code>clang++ memsans.cpp -std=c++14 -o memsans -g -fsanitize=memory -fno-omit-frame-pointer -Weverything\n</code></pre>\n\n<p>on Ubuntu 18.04. As per the MSan <a href=\"https://github.com/google/sanitizers/wiki/MemorySanitizer\" rel=\"nofollow noreferrer\">documentation</a> </p>\n\n<blockquote>\n  <p>It will tolerate copying of uninitialized memory, and also simple\n  logic and arithmetic operations with it. In general, MemorySanitizer\n  silently tracks the spread of uninitialized data in memory, and\n  reports a warning when a code branch is taken (or not taken) depending\n  on an uninitialized value.</p>\n</blockquote>\n\n<p>So the following code does not generate any error</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass Test {\npublic:\n    int x;\n};\n\nint main() {\n    Test t;\n    std::cout &lt;&lt; t.x;\n    std::cout &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>But this will </p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass Test {\npublic:\n    int x;\n};\n\nint main() {\n    Test t;\n    if(t.x) {\n        std::cout &lt;&lt; t.x;\n    }\n    std::cout &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>Ideally one would like both of these code samples to generate some sort of error since both are \"using\" an uninitialised variable in the sense that the first one is printing it. This code is a small test code and hence the error in the first code is obvious, however if it were a large codebase with a similar error, MSan would totally miss this. Is there any hack to force MSan to report this type of error as well ?</p>\n"}, {"tags": ["c++", "string", "search", "vector", "substring"], "comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1530721471, "post_id": 51177659, "comment_id": 89338163, "body": "What happens when you step through it with a debugger?"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 3, "creation_date": 1530721513, "post_id": 51177659, "comment_id": 89338177, "body": "<code>string::substr()</code> takes an index and a length, not two indices."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1530723089, "post_id": 51177659, "comment_id": 89338847, "body": "<code>for (int i = 0; i &lt; str.size(); i++) { for (int j = i + 1; j &lt;= str.size(); j++)</code> -- <code>O(n^2)</code> solutions are usually frowned upon by &quot;software dev&quot; interviewers."}, {"owner": {"reputation": 195, "user_id": 4013522, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/02f42a76091dffaa578626f3542e5de0?s=128&d=identicon&r=PG&f=1", "display_name": "windy401", "link": "https://stackoverflow.com/users/4013522/windy401"}, "edited": false, "score": 0, "creation_date": 1530727337, "post_id": 51177659, "comment_id": 89340457, "body": "Uhg n^2, yea that is bad. Guess I need to do some searching and figure out how else it can be done... Thanks for pointing that out."}], "answers": [{"tags": [], "owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "is_accepted": true, "score": 1, "last_activity_date": 1530721929, "creation_date": 1530721929, "answer_id": 51177920, "question_id": 51177659, "link": "https://stackoverflow.com/questions/51177659/finding-smallest-substring-containing-all-characters-in-a-vector-page-1-of-1/51177920#51177920", "title": "Finding Smallest Substring Containing All Characters In A Vector Page 1 of 1", "body": "<p>As mentioned in the comments, ensure that you properly call <code>str.substr()</code>; you need to pass in the starting index of the substring and its <strong>length</strong>, not its ending index. </p>\n\n<p>So instead of:</p>\n\n<pre><code>string sub = str.substr(i, j);\n</code></pre>\n\n<p>Make sure you pass in the length:</p>\n\n<pre><code>string sub = str.substr(i, j - i);\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 4013522, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/02f42a76091dffaa578626f3542e5de0?s=128&d=identicon&r=PG&f=1", "display_name": "windy401", "link": "https://stackoverflow.com/users/4013522/windy401"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 51177920, "answer_count": 1, "score": -1, "last_activity_date": 1530721929, "creation_date": 1530720784, "question_id": 51177659, "link": "https://stackoverflow.com/questions/51177659/finding-smallest-substring-containing-all-characters-in-a-vector-page-1-of-1", "title": "Finding Smallest Substring Containing All Characters In A Vector Page 1 of 1", "body": "<p>I came across this problem on a list of software dev interview example problems and have been trying to solve it. I came up with a version that works in most cases, but one of my test cases is failing and I can't figure out whats going wrong. </p>\n\n<p>Failing test:</p>\n\n<blockquote>\n  <p>Input: [\"A\",\"B\",\"C\"], \"ADOBECODEBANCDDD\"</p>\n  \n  <p>Expected result: \"BANC\"</p>\n  \n  <p>Program output: \"ADOBEC\"</p>\n</blockquote>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nstring getShortestUniqueSubstring( const vector&lt;char&gt;&amp; arr, const string &amp;str )\n{\n  int minsize = str.size() + 1;\n  string minstr = \"\";\n\n  if (str.size() &gt;= arr.size())\n  {\n      for (int i = 0; i &lt; str.size(); i++)\n      {\n          for (int j = i + 1; j &lt;= str.size(); j++)\n          {\n                if (j - i &gt;= arr.size())\n                {\n                    string sub = str.substr(i, j);\n                    bool found = true;\n\n                    for (int k = 0; k &lt; arr.size(); k++)\n                    {\n                        if (sub.find(arr[k]) == string::npos)\n                            found = false;\n                    }\n\n                    if (found == true &amp;&amp; sub.size() &lt; minsize)\n                    {\n                        if (minsize == arr.size())\n                            return sub;\n\n                        minsize = sub.size();\n                        minstr = sub;\n                        break;\n                    }\n                }\n            }\n        }\n  }\n  return minstr;\n}\n\nint main()\n{\n  string inputstr = \"ADOBECODEBANCDDD\";\n  vector&lt;char&gt; arr = {'A', 'B', 'C'};\n\n  cout &lt;&lt; getShortestUniqueSubstring(arr, inputstr);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "sdl", "vulkan"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 4, "creation_date": 1530720802, "post_id": 51177377, "comment_id": 89337884, "body": "You should enable some layers and setup debugging callbacks so that Vulkan can tell you what you are doing wrong."}], "answers": [{"tags": [], "owner": {"reputation": 5299, "user_id": 126546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5300f94d7227aca52dfe170ce14a225c?s=128&d=identicon&r=PG", "display_name": "Jesse Hall", "link": "https://stackoverflow.com/users/126546/jesse-hall"}, "is_accepted": false, "score": 1, "last_activity_date": 1530810991, "creation_date": 1530810991, "answer_id": 51196832, "question_id": 51177377, "link": "https://stackoverflow.com/questions/51177377/vulkan-crash-program/51196832#51196832", "title": "Vulkan Crash Program", "body": "<p>The value of <code>graphics_queue_node_index</code> is 2000 when you call <code>vkGetDeviceQueue</code>. That's most likely not a valid queue index.</p>\n\n<pre><code>VkDeviceQueueCreateInfo q;\n// ...\nq.queueFamilyIndex = graphics_queue_node_index,\n// ...\ngraphicsQueueNodeIndex = 2000;\ngraphics_queue_node_index = graphicsQueueNodeIndex;\n// ...\nvkGetPhysicalDeviceSurfaceSupportKHR(gpu, queue_props-&gt;queueCount, surface, &amp;supportsPresent[i]);\ngraphics_queue_node_index = graphicsQueueNodeIndex; // redundant?\n// ...\nvkGetDeviceQueue(device, graphics_queue_node_index, queue_props-&gt;queueCount, &amp;queu_);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7483535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RcDAt.jpg?s=128&g=1", "display_name": "robot123", "link": "https://stackoverflow.com/users/7483535/robot123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1530810991, "creation_date": 1530719611, "last_edit_date": 1530748866, "question_id": 51177377, "link": "https://stackoverflow.com/questions/51177377/vulkan-crash-program", "title": "Vulkan Crash Program", "body": "<p>I'm starting a game engine with Vulkan and SDL2. My program is crashing in a very specific part of my code. I'm really new in the Vulkan API and i have tried several modifications with no success. If someone could help me, here I give the full code and the part that I think it is crashing.</p>\n\n<pre><code>// GE_Base.cpp : Defines the entry point for the console application.\n//\n#include \"stdafx.h\"\n#include &lt;vulkan/vulkan.h&gt;\n#include &lt;SDL.h&gt;\n#include &lt;glm.hpp&gt;\n#include &lt;SDL_vulkan.h&gt;\n#include \"GE_code_class.h\"\n\n\n#define WIDTH 1280\n#define HEIGHT 720\n\n\n\n\nint main(int argc, char *argv[])\n{   \n    SDL_Init(SDL_INIT_EVERYTHING);\n\n    if (SDL_Init(SDL_INIT_VIDEO) != 0) {\n        SDL_Log(\"Couldn't initialize SDL: %s\", SDL_GetError());\n        SDL_Quit();\n        return -1;\n    }   \n\n    SDL_Window * window = SDL_CreateWindow(\"GE_Base\", SDL_WINDOWPOS_CENTERED, SDL_WINDOWPOS_CENTERED,\n        WIDTH, HEIGHT, SDL_WINDOW_VULKAN);\n\n    ////////////////////////////////\n\n    //VULKAN SETUP\n\n    const char* instanceExtensionNames[] = {\n        VK_KHR_SURFACE_EXTENSION_NAME,\n    };\n\n    VkApplicationInfo ai = {};\n    ai.sType = VK_STRUCTURE_TYPE_APPLICATION_INFO;\n    ai.pNext = nullptr;\n    ai.pApplicationName = \"SDL Vulkan\";\n    ai.applicationVersion = 1;\n    ai.pEngineName = \"SDLV\";\n    ai.engineVersion = 1;\n    ai.apiVersion = VK_MAKE_VERSION(1, 0, 3);\n\n    VkInstanceCreateInfo ici = {};\n    ici.sType = VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO;\n    ici.pNext = nullptr;\n    ici.flags = 0;\n    ici.pApplicationInfo = &amp;ai;\n    ici.enabledLayerCount = 0;\n    ici.ppEnabledLayerNames = nullptr;\n    ici.enabledExtensionCount = 0;\n    ici.ppEnabledExtensionNames = nullptr;\n\n    VkInstance instance;\n    vkCreateInstance(&amp;ici, nullptr, &amp;instance);\n\n    //CHECK PHYSICAL DEVICE (GRAFIC CARD)\n\n    VK_DEFINE_HANDLE(VkPhysicalDevice);\n\n    uint32_t deviceCount = 1;\n    VkPhysicalDevice gpu;\n\n    //VkPhysicalDevice *physical_devices = (VkPhysicalDevice*)malloc(sizeof(deviceCount)); \n\n    VkPhysicalDevice *physical_devices = (VkPhysicalDevice*)malloc(sizeof(deviceCount));\n    vkEnumeratePhysicalDevices(instance, &amp;deviceCount, physical_devices);\n    gpu = physical_devices[0];\n\n\n    //CHECK QUEUE FAMILIES\n\n    uint32_t graphics_queue_node_index;\n\n    /*if (queue_props-&gt;queueCount &lt;= 0) queue_props-&gt;queueCount = 1;*/\n\n    uint32_t amountOfFamilies = 0;\n\n    vkGetPhysicalDeviceQueueFamilyProperties(gpu, &amp;amountOfFamilies, NULL);\n    VkQueueFamilyProperties *queue_props = new VkQueueFamilyProperties[amountOfFamilies];\n    vkGetPhysicalDeviceQueueFamilyProperties(gpu, &amp;amountOfFamilies, queue_props);\n    assert(queue_props-&gt;queueCount &gt;= 1);\n\n    VkPhysicalDeviceFeatures features;\n    vkGetPhysicalDeviceFeatures(gpu, &amp;features);\n\n    uint32_t graphicsQueueNodeIndex = UINT32_MAX;\n\n    unsigned int i;\n\n    for (i = 0; i &lt; queue_props-&gt;queueCount; i++) {\n        if ((queue_props[i].queueFlags &amp; VK_QUEUE_GRAPHICS_BIT) != 0) {\n            if (graphicsQueueNodeIndex == UINT32_MAX)\n                graphicsQueueNodeIndex = i;\n        }\n    }\n\n    graphics_queue_node_index = graphicsQueueNodeIndex;\n\n    //LOGICAL DEVICE\n\n    VkDevice device;\n\n    float queue_priorities[1] = { 0.0 };\n\n    VkDeviceQueueCreateInfo q;\n\n    q.sType = VK_STRUCTURE_TYPE_DEVICE_QUEUE_CREATE_INFO,\n    q.pNext = nullptr,\n    q.queueFamilyIndex = graphics_queue_node_index,\n    q.queueCount = 1,\n    q.pQueuePriorities = queue_priorities;\n\n\n    graphicsQueueNodeIndex = 2000;\n    graphics_queue_node_index = graphicsQueueNodeIndex;\n\n    //CREATE &amp; INSTANTIATE DEVICE\n\n    VkDeviceCreateInfo d;\n\n    d.sType = VK_STRUCTURE_TYPE_DEVICE_CREATE_INFO,\n    d.pNext = nullptr,\n    d.queueCreateInfoCount = 1,\n    d.pQueueCreateInfos = &amp;q,\n    d.enabledLayerCount = 1,\n    d.ppEnabledLayerNames = nullptr,\n    d.enabledExtensionCount = 1,\n    d.ppEnabledExtensionNames = (const char *const *) instanceExtensionNames,\n    d.pEnabledFeatures = nullptr;\n\n    vkCreateDevice(gpu, &amp;d, nullptr, &amp;device);\n\n    //SURFACE WINDOW\n\n    VkSurfaceKHR surface;\n\n    SDL_Vulkan_CreateSurface(window, (SDL_vulkanInstance)&amp;ici, (SDL_vulkanSurface*)&amp;surface);\n\n    //PRESENTATION QUEU\n\n    VkBool32 *supportsPresent = new VkBool32[queue_props-&gt;queueCount];\n\n    vkGetPhysicalDeviceSurfaceSupportKHR(gpu, queue_props-&gt;queueCount, surface, &amp;supportsPresent[i]);\n    graphics_queue_node_index = graphicsQueueNodeIndex;\n\n    //QUEUE\n\n    VK_DEFINE_HANDLE(VkQueue)\n\n    VkQueue queu_;\n    vkGetDeviceQueue(device, graphics_queue_node_index, queue_props-&gt;queueCount, &amp;queu_);\n\n    ////////////////////////////////\n\n    GE_class *engine;\n\n    engine = new GE_class();\n    engine-&gt;Init(1280, 720);\n\n    bool quit_app = false;\n\n    while (!quit_app) {\n\n        SDL_Event eve;\n\n        while (SDL_PollEvent(&amp;eve)) {\n\n            switch (eve.type) {\n            case SDL_WINDOWEVENT:\n                if (eve.window.event == SDL_WINDOWEVENT_RESIZED) {\n\n                }\n                break;\n            case SDL_QUIT:\n                quit_app = true;\n                break;\n            }\n        }\n\n        //double currentTime = (double)SDL_GetTicks() / 1000.0;\n        //GLrender(currentTime);\n\n        //double currentTime = (double) SDL_GetTicks() / 1000.0;\n        //myRenderCode(currentTime);\n\n        //SDL_GL_SwapWindow(window);\n        /*vkQueuePresentKHR()*/\n\n\n\n\n    }\n\n    //SDL_DestroyWindow(window);\n    //SDL_Quit();\n\n\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n<pre><code>   VkQueue queu_;\n    vkGetDeviceQueue(device, graphics_queue_node_index, queue_props-queueCount, &amp;queu_);\n</code></pre>\n</blockquote>\n\n<p>These are the lines that I think it's crashing. I guess in the previous lines I did\nsomething wrong or I'm not initializing some variable. I'm not really sure.</p>\n"}, {"tags": ["c++", "mfc", "mdi"], "comments": [{"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1530723726, "post_id": 51177263, "comment_id": 89339103, "body": "I will say I did something like this a long time ago (using vc++ 6.0), but I am not sure it is possible any longer, it required building a custom build of the MFC library. The requirement that a serialized document be backed by a disk file has long been a major peeve of mine when it comes to using MFC."}, {"owner": {"reputation": 9, "user_id": 9989621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-48TmZwTQTag/AAAAAAAAAAI/AAAAAAAADgw/0IsEiaiZcNc/photo.jpg?sz=128", "display_name": "nicstratis", "link": "https://stackoverflow.com/users/9989621/nicstratis"}, "reply_to_user": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1530724213, "post_id": 51177263, "comment_id": 89339277, "body": "The solution I found is to CreateNewDocument with CMultiDocTemplate and then CreateNewFrame for this document."}, {"owner": {"reputation": 1499, "user_id": 1372577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4819b4e5fd753e26319b41b632182e0?s=128&d=identicon&r=PG", "display_name": "Constantine Georgiou", "link": "https://stackoverflow.com/users/1372577/constantine-georgiou"}, "edited": false, "score": 0, "creation_date": 1530729467, "post_id": 51177263, "comment_id": 89341206, "body": "I had developed an MFC app with multiple document and view types, a long time ago. Basically you need one doc-template for each doctype/viewtype combination. And you need to keep the doc-template instances you create during initialization, if you want to create a view window of a certain type. As for creating documents from data acquired from a source other than a disk-file, you need to dig deep into the MFC code, check what can be changed (eg what is virtual), and if not, write your own functions. Check what CWinApp::OnFileNew and OnFileOpen do. Override or take code snippets from there."}, {"owner": {"reputation": 13397, "user_id": 2287576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iCua4.jpg?s=128&g=1", "display_name": "Andrew Truckle", "link": "https://stackoverflow.com/users/2287576/andrew-truckle"}, "edited": false, "score": 0, "creation_date": 1530740358, "post_id": 51177263, "comment_id": 89344475, "body": "You can also switch the view for the document to another based on the document type."}, {"owner": {"reputation": 9, "user_id": 9989621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-48TmZwTQTag/AAAAAAAAAAI/AAAAAAAADgw/0IsEiaiZcNc/photo.jpg?sz=128", "display_name": "nicstratis", "link": "https://stackoverflow.com/users/9989621/nicstratis"}, "reply_to_user": {"reputation": 1499, "user_id": 1372577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4819b4e5fd753e26319b41b632182e0?s=128&d=identicon&r=PG", "display_name": "Constantine Georgiou", "link": "https://stackoverflow.com/users/1372577/constantine-georgiou"}, "edited": false, "score": 0, "creation_date": 1530856193, "post_id": 51177263, "comment_id": 89388526, "body": "@ConstantineGeorgiou Thanks a lot for the reply. I will follow your suggestion.  I think about this solution before but I was looking if there is a simpler way to do this."}, {"owner": {"reputation": 9, "user_id": 9989621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-48TmZwTQTag/AAAAAAAAAAI/AAAAAAAADgw/0IsEiaiZcNc/photo.jpg?sz=128", "display_name": "nicstratis", "link": "https://stackoverflow.com/users/9989621/nicstratis"}, "reply_to_user": {"reputation": 13397, "user_id": 2287576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iCua4.jpg?s=128&g=1", "display_name": "Andrew Truckle", "link": "https://stackoverflow.com/users/2287576/andrew-truckle"}, "edited": false, "score": 0, "creation_date": 1530856366, "post_id": 51177263, "comment_id": 89388577, "body": "@AndrewTruckle thanks for the reply. The main problem is to find a way to use MDI and the functionality without having my data on the disk. what you suggest is a step I will probably need in the future."}], "answers": [{"tags": [], "owner": {"reputation": 13397, "user_id": 2287576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iCua4.jpg?s=128&g=1", "display_name": "Andrew Truckle", "link": "https://stackoverflow.com/users/2287576/andrew-truckle"}, "is_accepted": false, "score": 1, "last_activity_date": 1530740633, "creation_date": 1530740633, "answer_id": 51181055, "question_id": 51177263, "link": "https://stackoverflow.com/questions/51177263/c-mfc-mdi-data-as-document-not-on-disk/51181055#51181055", "title": "C++ MFC MDI data as Document not on disk", "body": "<p>I am not sure if this is what you might be looking for, but I used code like this to change the view to a different one based on the document being loaded:</p>\n\n<pre><code>BOOL CCommunityTalksDoc::SwitchToView(CRuntimeClass* pNewViewClass)\n{\n    POSITION        rPos;\n    CView           *pOldActiveView;\n    CFrameWnd       *pChild;\n    CCreateContext  context;\n    BOOL            bAutoDelete;\n\n    rPos = GetFirstViewPosition();\n    pOldActiveView = GetNextView(rPos);\n    pChild = pOldActiveView-&gt;GetParentFrame();\n\n    // If we're already displaying this kind of view, no need to go further.\n    if (pOldActiveView-&gt;IsKindOf(pNewViewClass))\n        return TRUE;\n\n    // Set flag so that document will not be deleted when view is destroyed.\n    bAutoDelete = m_bAutoDelete;\n    m_bAutoDelete = FALSE;\n    // Delete existing view\n    pOldActiveView-&gt;DestroyWindow();\n    // restore flag\n    m_bAutoDelete = bAutoDelete;\n\n    // Create new view.\n    m_pScriptView = (CScriptParseView*)pNewViewClass-&gt;CreateObject();\n    if (m_pScriptView == nullptr)\n    {\n        TRACE1(\"Warning: Dynamic create of view type %s failed\\n\", pNewViewClass-&gt;m_lpszClassName);\n        return FALSE;\n    }\n\n    // we must ensure the popup dialogues don't display\n    m_pScriptView-&gt;SetBuildMode(FALSE);\n\n    // Draw new view.\n    context.m_pNewViewClass = pNewViewClass;\n    context.m_pCurrentDoc = this;\n    context.m_pNewDocTemplate = nullptr;\n    context.m_pLastView = nullptr;\n    context.m_pCurrentFrame = pChild;\n    if (!m_pScriptView-&gt;Create(nullptr, nullptr, AFX_WS_DEFAULT_VIEW, CRect(0, 0, 0, 0), \n                pChild, AFX_IDW_PANE_FIRST, &amp;context))\n    {\n        TRACE0(\"Warning: couldn't create view for frame\\n\");\n        delete m_pScriptView;\n        m_pScriptView = nullptr;\n        return FALSE; \n    }\n\n    m_pScriptView-&gt;SendMessage(WM_INITIALUPDATE, 0, 0);  // WM_INITIALUPDATE is defined in afxpriv.h\n    pChild-&gt;RecalcLayout();\n    m_pScriptView-&gt;UpdateWindow();\n    pChild-&gt;SetActiveView(m_pScriptView);\n    return TRUE;\n}\n</code></pre>\n\n<p>You use it like:</p>\n\n<pre><code>CRuntimeClass *pNewViewClass = RUNTIME_CLASS(CScriptParseView);\nif (!SwitchToView(pNewViewClass))\n{\n    // fail, don't know why it would fail\n    ASSERT(FALSE);\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9989621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-48TmZwTQTag/AAAAAAAAAAI/AAAAAAAADgw/0IsEiaiZcNc/photo.jpg?sz=128", "display_name": "nicstratis", "link": "https://stackoverflow.com/users/9989621/nicstratis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "closed_date": 1530773428, "answer_count": 1, "score": -1, "last_activity_date": 1530740633, "creation_date": 1530719167, "question_id": 51177263, "link": "https://stackoverflow.com/questions/51177263/c-mfc-mdi-data-as-document-not-on-disk", "closed_reason": "Not suitable for this site", "title": "C++ MFC MDI data as Document not on disk", "body": "<p>I would like to use MFC MDI but my data (Document) is not on the disk. </p>\n\n<p>I have functions that generate data according to the input. \nData of type A, type B etc.</p>\n\n<p>I would like to open a new tab for every new data generated.</p>\n\n<p>For example, if the input of the generated data is X, I would like to open a new tab with the name X on it. If the X exists, I would like to activate (bring front) the X tab as the MDI already does.</p>\n\n<p>My idea is to have multiple CMultiDocTemplate. Each one generated by different CDocument/CView derived class. </p>\n\n<p>I am looking for a solution to overload the open/new function so instead of opening a file from disk, ask from my functions to generate the data (CDocument).</p>\n\n<p>Also, I don't want the user to choose between CMultiDocTemplate/Cview but I want to choose which one to use for the new tab. </p>\n"}, {"tags": ["c++", "parsing", "ifstream", "seekg"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1530719140, "post_id": 51177238, "comment_id": 89337129, "body": "You would use the same thing you would use to store the position in a very small file. The size of the file makes no material difference, whatsoever."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1530719227, "post_id": 51177238, "comment_id": 89337181, "body": "@SamVarshavchik: That&#39;s not entirely true.  For large files (especially once over 2GB) you need to be more careful with the data type you use to store the position."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1530719235, "post_id": 51177238, "comment_id": 89337184, "body": "Looks like that you have the <a href=\"https://stackoverflow.com/questions/tagged/seekg\">seekg</a> tag?"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1530719303, "post_id": 51177238, "comment_id": 89337217, "body": "<a href=\"https://stackoverflow.com/questions/10669673/saving-off-the-current-read-position-so-i-can-seek-to-it-later\">Possible d</a>... that&#39;s C."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1530719685, "post_id": 51177238, "comment_id": 89337424, "body": "<i>I load the file in the ifstream and then getlines</i> -- As soon as you said this about &quot;getlines&quot;, inefficiency rears its head.  Read the answer given by @BenVoigt"}, {"owner": {"reputation": 107, "user_id": 9061958, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212710197602408/picture?type=large", "display_name": "Sadikov", "link": "https://stackoverflow.com/users/9061958/sadikov"}, "edited": false, "score": 0, "creation_date": 1530720028, "post_id": 51177238, "comment_id": 89337596, "body": "I know, and this was something I could live with until today. I wasn&#39;t aware that the files in question would grow in size like so."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1530720350, "post_id": 51177238, "comment_id": 89337729, "body": "@Sadikov -- First, does the file in question have a fixed line length?  If so, you don&#39;t need <code>getline</code>, as you can simply use the offset to calculate which line / column you&#39;re on in the file."}, {"owner": {"reputation": 107, "user_id": 9061958, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212710197602408/picture?type=large", "display_name": "Sadikov", "link": "https://stackoverflow.com/users/9061958/sadikov"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1530720479, "post_id": 51177238, "comment_id": 89337775, "body": "@SamVarshavchik I don&#39;t think it is really useful to write efficient code and optimizations for it, when processing very small file. But I edited the  question, thanks for the input."}, {"owner": {"reputation": 107, "user_id": 9061958, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212710197602408/picture?type=large", "display_name": "Sadikov", "link": "https://stackoverflow.com/users/9061958/sadikov"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1530720580, "post_id": 51177238, "comment_id": 89337818, "body": "@PaulMcKenzie The line length is not fixed, and neither is the d-offset mentioned in the question. Both of them vary through the file."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1530721383, "post_id": 51177238, "comment_id": 89338119, "body": "There&#39;s nothing in my comment that suggested that the way to restore the position in a small file is to read it again. I repeat: you would use the same thing you would use to store the position in a very small file. You already have a <code>seekg</code> tag on your question, which indicates that you are familiar with how to save and restore file positions, no matter how big or small the files are. So what part of &quot;use seekg&quot; you are unclear about?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1530722115, "post_id": 51177238, "comment_id": 89338424, "body": "@SamVarshavchik: <code>seekg()</code> will result in the library reading from the front of the file again, if any translations are in effect.  (If no translations are in effect then it is a QoI issue, nothing actually requires the standard library to special case the no-translation setup to be fast; a brain-dead implementation could use the generic code path that reads from the beginning for all cases)"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 9061958, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212710197602408/picture?type=large", "display_name": "Sadikov", "link": "https://stackoverflow.com/users/9061958/sadikov"}, "edited": false, "score": 0, "creation_date": 1530719833, "post_id": 51177335, "comment_id": 89337505, "body": "Can you elaborate a bit more on the number used by the OS to perform file I/O? How to access this number? If I turn off the standard text mode, will I still be able to use getline function?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 107, "user_id": 9061958, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212710197602408/picture?type=large", "display_name": "Sadikov", "link": "https://stackoverflow.com/users/9061958/sadikov"}, "edited": false, "score": 1, "creation_date": 1530721182, "post_id": 51177335, "comment_id": 89338043, "body": "@Sadikov: If you turn off newline conversion, nothing stops you from calling <code>getline()</code>, but depending on the software that generated your file, line endings might be \\r\\n, \\r, or \\n, instead of just \\n, which will affect the parameters to getline.  The number used by the OS to perform file I/O is the file position that the standard library passes to the OS file I/O functions, for example on Windows that would be the <code>Offset</code> and <code>OffsetHigh</code> members of an <code>OVERLAPPED</code> structure.  When translations are turned off, the logical position used by <code>tell</code> and <code>seek</code> is the same as the OS position."}, {"owner": {"reputation": 107, "user_id": 9061958, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212710197602408/picture?type=large", "display_name": "Sadikov", "link": "https://stackoverflow.com/users/9061958/sadikov"}, "edited": false, "score": 0, "creation_date": 1530723049, "post_id": 51177335, "comment_id": 89338829, "body": "So to recap, it the translation is on, the standard library also goes through the file and counts N-offset? If the tranlsation is off it jumps to the position immediately. We need to read the file in the binary mode like this std::ifstream ifs(&quot;foo.txt&quot;, std::ios::binary); Thanks Ben!"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 107, "user_id": 9061958, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212710197602408/picture?type=large", "display_name": "Sadikov", "link": "https://stackoverflow.com/users/9061958/sadikov"}, "edited": false, "score": 1, "creation_date": 1530723569, "post_id": 51177335, "comment_id": 89339040, "body": "@Sadikov: That is the expectation, although it is possible to have a brain-dead library that doesn&#39;t implement the &quot;jump immediately&quot; path and just counts from the beginning whether translation is on or off.  Simply measuring how long <code>seekg(large number)</code> + a small fixed-length read takes should let you easily test whether you&#39;re hitting the fast path."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1530802806, "post_id": 51177335, "comment_id": 89370547, "body": "Do you have a reference for this claim? I was under the impression that if you call seek using a position returned by tell, you will restore the file position precisely (unless your multibyte encoding is contextual), regardless of translation."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1530814974, "post_id": 51177335, "comment_id": 89377139, "body": "@rici: Yes, you will restore the file position precisely, and the library will have to reprocess the entire file from the beginning to find that precise position  (a &quot;Schlemiel the Painter&#39;s algorithm&quot;).  The question excludes doing that, by saying &quot;instantly&quot; and describing in detail problems with quadratic performance."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1530834708, "post_id": 51177335, "comment_id": 89383984, "body": "@Ben: I really don&#39;t believe that to be the case, which is why I&#39;d like to see a reference rather than your assertion. For text files, you can only seekg to a position previously returned by a previous seekpos or seekoff, and that will be a value appropriate for resetting the file position to its former value, without having to call on Schlemiel&#39;s services."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1530834988, "post_id": 51177335, "comment_id": 89384046, "body": "C++ eventually defers to the C library here, so it&#39;s worth quoting section 7.21.9.4 para. 2 of the C standard, which describes the return value of ftell: &quot;For a text stream, its file position indicator contains unspecified information, usable by the <code>fseek</code> function for returning the file position indicator for the stream to its position at the time of the <code>ftell</code> call; the difference between two such return values is not necessarily a meaningful measure of the number of characters written or read.&quot;"}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": true, "score": 3, "last_activity_date": 1530722187, "last_edit_date": 1530722187, "creation_date": 1530719409, "answer_id": 51177335, "question_id": 51177238, "link": "https://stackoverflow.com/questions/51177238/fast-accessing-file-position-in-ifs-c/51177335#51177335", "title": "Fast accessing file position in ifs() C++", "body": "<p>You can't do this with newline translation enabled (what the Standard calls \"text mode\"), because seeking back to the position requires the standard library to scan through the entire front of the file to find N characters-not-double-counting-newlines.  Translations of variable length encodings (e.g. between UTF-8 and UCS) cause a similar problem.</p>\n\n<p>The solution is to turn off newline translation (what the Standard calls \"binary mode\") and any other translations that involve variable-length encodings, and handle these yourself.  With all translations turned off, the \"file position\" is the number directly used by the OS to perform file I/O, and therefore has the potential to be very efficient (whether it actually is efficient depends on the standard library implementation details).</p>\n"}], "owner": {"reputation": 107, "user_id": 9061958, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212710197602408/picture?type=large", "display_name": "Sadikov", "link": "https://stackoverflow.com/users/9061958/sadikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 51177335, "answer_count": 1, "score": 0, "last_activity_date": 1530722187, "creation_date": 1530719079, "last_edit_date": 1530720259, "question_id": 51177238, "link": "https://stackoverflow.com/questions/51177238/fast-accessing-file-position-in-ifs-c", "title": "Fast accessing file position in ifs() C++", "body": "<p>Info: What is the best way to store a position in a txt file, close the file, and later open it at the same position using c++?</p>\n\n<p>I have a large text file that I need to parse in chunks and feed into some system. As of now, I load the file in the ifstream and then getlines until I find the data I need (let's say data is at position {x}). After this I close the file, process the data, and now I need to continue feeding the data from the big file. So I open the file again, and getlines until I get to position {x+d} this time ( d is the offset from the data I read)... </p>\n\n<p>Instead of going through file once, it is easy to see, that I go (1d + 2d + ... + (N-1)d + Nd) ~ d*N^2 times through the file. Now I want to save the position in the file after d, close the file, and then instantly open the file at the same position. What can be used for this? </p>\n"}, {"tags": ["c++", "type-punning"], "comments": [{"owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 0, "creation_date": 1530719206, "post_id": 51177138, "comment_id": 89337171, "body": "there are multiple things that doesn&#39;t look like c++ in this code"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1530719531, "post_id": 51177138, "comment_id": 89337344, "body": "I have tried to remove all the HTML entity encoding from your code, but the reinterpret_cast line still looks wrong.  Can you fix it please."}, {"owner": {"reputation": 31, "user_id": 8579435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85d691008ef526cf52d6832818a52b1b?s=128&d=identicon&r=PG&f=1", "display_name": "JohnBee", "link": "https://stackoverflow.com/users/8579435/johnbee"}, "edited": false, "score": 0, "creation_date": 1530720247, "post_id": 51177138, "comment_id": 89337687, "body": "Thank you Martin, I have changed the line."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1530721035, "post_id": 51177138, "comment_id": 89337975, "body": "Why do you need to wrap <code>my_map::value_type</code>? You can just use an alias of <code>my_map::reference</code>"}, {"owner": {"reputation": 31, "user_id": 8579435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85d691008ef526cf52d6832818a52b1b?s=128&d=identicon&r=PG&f=1", "display_name": "JohnBee", "link": "https://stackoverflow.com/users/8579435/johnbee"}, "edited": false, "score": 0, "creation_date": 1530721363, "post_id": 51177138, "comment_id": 89338110, "body": "From my understanding, using a class or a struct with a names that describe the usage is preferable, which in my opinion, the member variables of std::pair does not provide. I want to give the entries more meaningful names. I could for instance name the member function &quot;key&quot; and &quot;value&quot;."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1530721606, "post_id": 51177138, "comment_id": 89338213, "body": "I&#39;d write free functions like <code>my_map::key_type &amp; MeaningfulNameHere(my_map::iterator)</code> (or <code>my_map::reference</code>) in that case"}, {"owner": {"reputation": 31, "user_id": 8579435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85d691008ef526cf52d6832818a52b1b?s=128&d=identicon&r=PG&f=1", "display_name": "JohnBee", "link": "https://stackoverflow.com/users/8579435/johnbee"}, "edited": false, "score": 0, "creation_date": 1530721891, "post_id": 51177138, "comment_id": 89338321, "body": "But I would like to access both they key and value type, such such that I could call the wrapper class something meaningful such as &quot;entry&quot;."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530723608, "post_id": 51177138, "comment_id": 89339055, "body": "You can wrap <code>value_type&amp;</code> and pass around the wrapper by value. I would recommend leaving the standard library idioms alone though. People already understand them. There&#39;s nothing wrong with exposing them in your code."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8579435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85d691008ef526cf52d6832818a52b1b?s=128&d=identicon&r=PG&f=1", "display_name": "JohnBee", "link": "https://stackoverflow.com/users/8579435/johnbee"}, "edited": false, "score": 0, "creation_date": 1530721775, "post_id": 51177805, "comment_id": 89338279, "body": "Thank you for your response, I am not asking about the details of find, all code presented have just been there for demonstration. The issue is to do with converting a reference from the pair to the reference of the wrapper containing the pair, and if such a conversion would be prone to undefined behaviour due to type compatibility. I still appreciate the answer."}], "tags": [], "owner": {"reputation": 17031, "user_id": 185915, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/207045374ab195353388d9fcc77af9c5?s=128&d=identicon&r=PG", "display_name": "Chad", "link": "https://stackoverflow.com/users/185915/chad"}, "is_accepted": false, "score": 2, "last_activity_date": 1530721445, "creation_date": 1530721445, "answer_id": 51177805, "question_id": 51177138, "link": "https://stackoverflow.com/questions/51177138/c-type-punning-with-classes/51177805#51177805", "title": "C++ type punning with classes", "body": "<p>So you <em>could</em> clean this up, but I wouldn't suggest it:</p>\n\n<pre><code>#include &lt;unordered_map&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\ntemplate &lt;class Key, class Value&gt;\nclass wrapper\n{\npublic:\n   explicit wrapper(std::pair&lt;const Key, Value&gt;&amp; kvp)\n      : _key{kvp.first}\n      , _value{kvp.second}\n   {}\n\n   const Key&amp; key() const { return _key; }\n   Value&amp; value()         { return _value; }\n\nprivate:\n   const Key&amp; _key;\n   Value&amp; _value;\n};\n\nint main()\n{\n   unordered_map&lt;int,int&gt; m;\n\n   m[1] = 1;\n   m[3] = 3;\n\n   auto it = m.find(1);\n\n   wrapper w{*it};\n   w.value() = 30;\n\n   std::cout &lt;&lt; w.key() &lt;&lt; \" -&gt; \" &lt;&lt; w.value() &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>The above effectively hides the <code>pair</code> from users of your class.  It doesn't deal with exceptions (<code>find()</code> returning <code>end()</code> for example), and makes no guarantees about lifetimes.  It's marginally better than what you have because it doesn't require a <code>reinterpret_cast</code> to an unrelated type.</p>\n\n<p>However, <code>map</code>, <code>unordered_map</code>, <code>set</code>, etc. storing returning iterators as pairs is just part of library -- it's the canonical form and I don't see the benefit of shielding people from it.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 8579435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85d691008ef526cf52d6832818a52b1b?s=128&d=identicon&r=PG&f=1", "display_name": "JohnBee", "link": "https://stackoverflow.com/users/8579435/johnbee"}, "edited": false, "score": 0, "creation_date": 1530721979, "post_id": 51177907, "comment_id": 89338361, "body": "But a forward iterator must return a reference when dereferenced, hence I don&#39;t believe that it would be viable for a custom forward iterator."}, {"owner": {"reputation": 2282, "user_id": 6646408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6BakX.png?s=128&g=1", "display_name": "besc", "link": "https://stackoverflow.com/users/6646408/besc"}, "edited": false, "score": 0, "creation_date": 1530724629, "post_id": 51177907, "comment_id": 89339460, "body": "+1 for mentioning UB right away. It\u2019s more or less safe to assume that type punning like that is simply not allowed in C++."}, {"owner": {"reputation": 31, "user_id": 8579435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85d691008ef526cf52d6832818a52b1b?s=128&d=identicon&r=PG&f=1", "display_name": "JohnBee", "link": "https://stackoverflow.com/users/8579435/johnbee"}, "edited": false, "score": 0, "creation_date": 1530726271, "post_id": 51177907, "comment_id": 89340116, "body": "Does the wrapper and the wrappee having the same size and layout suggest that the types are compatible?"}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": true, "score": 2, "last_activity_date": 1530722586, "last_edit_date": 1530722586, "creation_date": 1530721890, "answer_id": 51177907, "question_id": 51177138, "link": "https://stackoverflow.com/questions/51177138/c-type-punning-with-classes/51177907#51177907", "title": "C++ type punning with classes", "body": "<p>This absolutely is undefined behaviour.</p>\n\n<p>Seriously rethink your priorities. </p>\n\n<p>Some free functions of the form</p>\n\n<pre><code>const my_map::key_type &amp; MeaningfulNameHere(my_map::reference)\n</code></pre>\n\n<p>will go a long way to giving you meaningful names.</p>\n\n<p>If you <em>must</em> wrap the standard library with different names, just use a non-explicit constructor, and store references.</p>\n\n<pre><code>template &lt;typename Map&gt;\nclass entry final\n{\nprivate:\n    typename Map::reference ref;\npublic:\n    entry(Map::reference ref) : ref(ref) {}\n\n    const typename Map::key_type &amp; key()\n    {\n        return ref.first;\n    }\n    typename Map::mapped_type &amp; value()\n    {\n        return ref.second;\n    }\n};\n</code></pre>\n\n<p>If you <em>really need</em> the iterator to dereference to <code>entry</code> you can. But you can just implicitly instantiate <code>entry</code>s from the <code>Map::reference</code>s returned by <code>Map::iterator::operator*</code>, you don't need a custom iterator.</p>\n\n<pre><code>template &lt;typename Map&gt;\nclass entry_iterator\n{\nprivate:\n    typename Map::iterator it;\n    entry&lt;Map&gt; entry;\npublic:\n    entry&lt;Map&gt;&amp; operator*() { return entry; }\n    entry_iterator operator++() { ++it; entry = *it; return *this; }\n    // etc\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8579435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85d691008ef526cf52d6832818a52b1b?s=128&d=identicon&r=PG&f=1", "display_name": "JohnBee", "link": "https://stackoverflow.com/users/8579435/johnbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 51177907, "answer_count": 2, "score": 1, "last_activity_date": 1530722633, "creation_date": 1530718662, "last_edit_date": 1530722633, "question_id": 51177138, "link": "https://stackoverflow.com/questions/51177138/c-type-punning-with-classes", "title": "C++ type punning with classes", "body": "<p>I am writing some C++ code which wraps the std::unordered_map type, where I want to hide the underlying type and present it as another type. More specifically, I want to wrap the std::pair from the std::unordered_map with another type. For the sake of argument, lets suppose the wrapper looks like this...</p>\n\n<pre><code>template &lt;typename ActualT &gt;\nclass wrapper final\n{\nprivate:\n    ActualT actual_;\npublic:\n    //Some constructors...\n    typename ActualT::first_type &amp; get_first()\n    {\n        return actual_.first;\n    }\n    typename ActualT::second_type &amp; get_second()\n    {\n        return actual_.second;\n    }\n};\n</code></pre>\n\n<p>My reasoning is that since the wrapper class only has a member which is the exact type which it is wrapping, converting a reference from the original type to the wrapper type should be fine, but the type compatibility for structs states that the members should have the same type and name for the types to be compatible. Would using type-punning in this fashion potentially cause undefined behaviour or alignment issues?</p>\n\n<pre><code>using my_map = std::unordered_map &lt; int, int &gt;;\nmy_map m;\n//Do some inserts...\nreinterpret_cast&lt;wrapper&lt;typename my_map::value_type&gt;&amp;&gt;(*m.find(10)).get_second() = 1.0;\n</code></pre>\n\n<p>I want client code to be allowed to access the entries of a map without knowing about the pair which is returned by the map. I also want to write a custom forward iterator, hence I need to return a reference to the entry. Would converting the reference to the pair to a reference to a class which act as a wrapper be considered dangerous?</p>\n\n<p>Is there perhaps a better approach to accomplishing this?</p>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 95, "user_id": 1264582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1nFCZ.jpg?s=128&g=1", "display_name": "ketza", "link": "https://stackoverflow.com/users/1264582/ketza"}, "edited": false, "score": 0, "creation_date": 1551196410, "post_id": 51177112, "comment_id": 96547867, "body": "I had a similar issue and in my case the mask was faulty. Interestingly, it worked if I just declared <code>Mat mask</code> and passed that to the addTemplate function. You could try that, but actually I think yours is looking well. Maybe you could try with only using the ColorGradient modality first, to further isolate the problem?"}, {"owner": {"reputation": 21, "user_id": 10032836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea841923ebad246e19963872194a3e8?s=128&d=identicon&r=PG&f=1", "display_name": "petew", "link": "https://stackoverflow.com/users/10032836/petew"}, "reply_to_user": {"reputation": 95, "user_id": 1264582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1nFCZ.jpg?s=128&g=1", "display_name": "ketza", "link": "https://stackoverflow.com/users/1264582/ketza"}, "edited": false, "score": 0, "creation_date": 1551284255, "post_id": 51177112, "comment_id": 96586725, "body": "Thanks man, I got past this a while back. There were actually two separate issues here that were causing issues and both had to be solved concurrently for it to work. One was the size, as the algorithm is optimised for 800x600 images (I think) and fails to generate any matches with much different sizing... and the second, I can&#39;t actually remember!"}], "owner": {"reputation": 21, "user_id": 10032836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea841923ebad246e19963872194a3e8?s=128&d=identicon&r=PG&f=1", "display_name": "petew", "link": "https://stackoverflow.com/users/10032836/petew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 644, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1561371726, "creation_date": 1530718562, "last_edit_date": 1530719876, "question_id": 51177112, "link": "https://stackoverflow.com/questions/51177112/opencv-c-linemod-problems-loading-templates", "title": "Opencv c++ linemod- problems loading templates", "body": "<p>I'm attempting to implement the linemod algorithm for textureless object recognition from OpenCV, but I'm having some trouble adding the templates (training images to match- effectively) to the detector.</p>\n\n<p>There appear to be a number of ways to instantiate the main detector class:</p>\n\n<pre><code>linemod::Detector detector; //empty constructor\n\nlinemod::Detector detector (Modalities, T_pyramid); //regular constructor\n\nPtr&lt;linemod::Detector&gt; detector\ndetector= linemod::getDefaultLINEMOD //Setting a pointer to a default version\n</code></pre>\n\n<p>Then add the template:</p>\n\n<pre><code>int templ_id = detector.addTemplate(sources,class_id,mask)\nint templ_id = detector-&gt;addTemplate(sources,class_id,mask)\n</code></pre>\n\n<p>My issue is that the template adding fails UNLESS I use the empty constructor version, in which case it seems to work fine. Unfortunately I'm not really sure how I'd use the empty constructor, it seems to be built around loading from file. The default version, or otherwise the one I constructed are what I want to work with.</p>\n\n<p>Weird point but attempting to add the template will add a class_ID to the detector even if the template loading fails- this returns -1 on templ_id and calls of numTemplates are 0.. but numClasses starts 0 and goes up to 1 even if the template fails to add.</p>\n\n<p>I've tried fiddling with this endlessly but can't seem to get it working. I'm new to c++ so it's possible I'm missing some obvious context or easy solution.</p>\n\n<p>This is the reference for the detector class and all the other linemod classes, functions etc:\n<a href=\"https://docs.opencv.org/3.4/d7/d07/classcv_1_1linemod_1_1Detector.html\" rel=\"nofollow noreferrer\">https://docs.opencv.org/3.4/d7/d07/classcv_1_1linemod_1_1Detector.html</a></p>\n\n<p>and the full code:</p>\n\n<pre><code>//LINEMOD LOAD TEMPLATE TO DETECTOR CLASS\n\n/*\nLoosely based on http://answers.opencv.org/question/17424/opencv-cvlinemod-throwing-runtime-errors/\nCode displays:\n-Appropriate libraries\n-How to instantiate the detector class from opencv\n-How to load a template from file to the detector\nNext stage is to load full set for one or many objects, or to test matching capability.\nPW: 02/07/18\n*/\n\n#include &lt;iostream&gt;\n#include \"opencv2/core/core.hpp\"\n#include \"opencv2/core/utility.hpp\"\n#include \"opencv2/highgui.hpp\"\n#include \"opencv2/imgproc.hpp\"\n#include \"opencv2/rgbd.hpp\"\n\nusing namespace std;\nusing namespace cv;\n\nstring train_path = \"/home/pete/work/data/train/15/rgb/0500.png\";\nstring test_path = \"/home/pete/work/data/test/\";\nstring test_image = \"/home/pete/work/pxw762/linemod/test_image.jpeg\";     \n\nint main() \n{\n\n//Load in image(s) \nMat rgb;\nMat depth;\nrgb = imread(\"/home/pete/work/data/train/15/rgb/0500.png\", CV_LOAD_IMAGE_COLOR);\ndepth = imread(\"/home/pete/work/data/train/15/depth/0500.png\", CV_LOAD_IMAGE_ANYDEPTH);\nvector&lt;Mat&gt; sources; \nsources.push_back(rgb);\nsources.push_back(depth); //Put images into source vector\n\n//Create mask\nMat gray, mask;\ncvtColor(rgb,gray, CV_BGR2GRAY);\nthreshold(gray,mask,0,1,THRESH_BINARY);\nmask.convertTo(mask, CV_8U);\n\n//Add a template\ncv::Ptr&lt;cv::linemod::Detector&gt; detector;\ndetector=linemod::getDefaultLINEMOD();\n\nstring class_id = \"15\";\nint templ_ID = detector-&gt;addTemplate(sources, class_id, mask); //Add a template to the detector\ncout&lt;&lt;templ_ID&lt;&lt;endl;\n\n//Testing section\nstring num_classes= to_string(detector-&gt;numClasses());\nstring num_templates= to_string(detector-&gt;numTemplates());\ncout&lt;&lt;\"Number of classes: \"&lt;&lt;num_classes&lt;&lt;endl;\ncout&lt;&lt;\"Number of Templates: \"&lt;&lt;num_templates&lt;&lt;endl; \nreturn 0;\n}\n</code></pre>\n\n<p>Has anyone got any ideas of what might be going wrong here?</p>\n\n<p>Thanks,\nPete</p>\n"}, {"tags": ["c++", "sfml"], "comments": [{"owner": {"reputation": 696, "user_id": 9039975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GpmNP.jpg?s=128&g=1", "display_name": "Artory", "link": "https://stackoverflow.com/users/9039975/artory"}, "edited": false, "score": 0, "creation_date": 1530718606, "post_id": 51177073, "comment_id": 89336861, "body": "Can you show us the code where you make the car spawn ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9553863"}, "reply_to_user": {"reputation": 696, "user_id": 9039975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GpmNP.jpg?s=128&g=1", "display_name": "Artory", "link": "https://stackoverflow.com/users/9039975/artory"}, "edited": false, "score": 0, "creation_date": 1530718679, "post_id": 51177073, "comment_id": 89336896, "body": "Sure, give me one second"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9553863"}, "edited": false, "score": 0, "creation_date": 1530718936, "post_id": 51177144, "comment_id": 89337023, "body": "Should the spawnCar() function be in Player.h or Player.cpp?"}, {"owner": {"reputation": 578, "user_id": 9753863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0e7yy.jpg?s=128&g=1", "display_name": "ractiv", "link": "https://stackoverflow.com/users/9753863/ractiv"}, "edited": false, "score": 0, "creation_date": 1530719033, "post_id": 51177144, "comment_id": 89337067, "body": "It depends how you organize your code. I recommend you to set your attributes private and add getters and setters to your class. What I use to do is to declare the attributes and methods in the header file and implement them is a .cpp file."}], "tags": [], "owner": {"reputation": 578, "user_id": 9753863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0e7yy.jpg?s=128&g=1", "display_name": "ractiv", "link": "https://stackoverflow.com/users/9753863/ractiv"}, "is_accepted": false, "score": 0, "last_activity_date": 1530719781, "last_edit_date": 1530719781, "creation_date": 1530718694, "answer_id": 51177144, "question_id": 51177073, "link": "https://stackoverflow.com/questions/51177073/problems-with-getposition-in-sfml/51177144#51177144", "title": "Problems with getPosition() in SFML", "body": "<p>We miss the <code>main</code> function to know exactly what happens when the car spawns but I think that you initialize the car in the Player constructor and does not move it when the player presses 'C'.</p>\n\n<p>You should have something like that :</p>\n\n<pre><code>if(event.key.code == sf::Keyboard::C) {\n    player.spawnCar();\n}\n</code></pre>\n\n<p>and in your <code>spawnCar()</code> function :</p>\n\n<pre><code>carSprite.setPosition(normalSprite.getPosition());\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>As I said in my comment, you should use getters and setters to access to your attributes. According to your current main.cpp, you should have this :</p>\n\n<pre><code>if (event.key.code == sf::Keyboard::C)\n{\n    thePlayer.car = true;\n    thePlayer.spring = false;\n    thePlayer.rocket = false;\n    thePlayer.normal = false;\n    carSprite.setPosition(normalSprite.getPosition());\n    break;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9553863"}, "edited": false, "score": 0, "creation_date": 1530719090, "post_id": 51177224, "comment_id": 89337097, "body": "Works perfectly! Thanks!"}, {"owner": {"reputation": 696, "user_id": 9039975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GpmNP.jpg?s=128&g=1", "display_name": "Artory", "link": "https://stackoverflow.com/users/9039975/artory"}, "edited": false, "score": 0, "creation_date": 1530719305, "post_id": 51177224, "comment_id": 89337218, "body": "About &quot;good pratices&quot; of coding, your code is working but you should organize it differently"}], "tags": [], "owner": {"reputation": 696, "user_id": 9039975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GpmNP.jpg?s=128&g=1", "display_name": "Artory", "link": "https://stackoverflow.com/users/9039975/artory"}, "is_accepted": true, "score": 1, "last_activity_date": 1530719328, "last_edit_date": 1530719328, "creation_date": 1530719004, "answer_id": 51177224, "question_id": 51177073, "link": "https://stackoverflow.com/questions/51177073/problems-with-getposition-in-sfml/51177224#51177224", "title": "Problems with getPosition() in SFML", "body": "<p>Before drawing the car you should adjust its position to your player position :</p>\n\n<pre><code>if (thePlayer.car)\n{\n    thePlayer.carSprite.setPosition(thePlayer.normalSprite.getPosition());\n    window.draw(thePlayer.carSprite);\n}\n</code></pre>\n\n<p>But as ractiv said, you should organize your code differently. I suggest you to learn more about c++ \"good pratices\" before trying to do this kind of games.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9553863"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 51177224, "answer_count": 2, "score": 0, "last_activity_date": 1530719781, "creation_date": 1530718368, "last_edit_date": 1530718782, "question_id": 51177073, "link": "https://stackoverflow.com/questions/51177073/problems-with-getposition-in-sfml", "title": "Problems with getPosition() in SFML", "body": "<p>I'm new to c++ so I'm a bit confused on this one. I'm trying to have the player spawn, then when the user presses \"C\", the player switches with a car. What's happening currently is the player is initially spawning in the correct location, then the car is spawning where the player initially spawned, not where it currently is. However, since I'm using the function <code>getPosition()</code>, I would assume it would spawn in the current position of the player.</p>\n\n<p>Player.h:</p>\n\n<pre><code>#pragma once\n#include &lt;SFML\\Graphics.hpp&gt;\n#include &lt;string&gt;\nclass player {\n\npublic:\n    sf::Texture normalTexture;\n    sf::Sprite normalSprite;\n    sf::Texture carTexture;\n    sf::Sprite carSprite;\n    sf::Texture springTexture;\n    sf::Sprite springSprite;\n    sf::Texture rocketTexture;\n    sf::Sprite rocketSprite;\n    sf::IntRect normalRect[1];\n    sf::IntRect carRect[1];\n    sf::IntRect springRect[1];\n    sf::IntRect rocketRect[1];\n\n\nbool rocket=false;\nbool car=false;\nbool spring=false;\nbool normal=false;\n\nplayer();\nplayer(sf::Vector2f position, std::string normalFileLoc, std::string carFileLoc, std::string springFileLoc, std::string rocketFileLoc);\n\nvoid update();\n};\n</code></pre>\n\n<p>Player.cpp:</p>\n\n<pre><code>#include \"Player.h\"\n\nplayer::player() : player::player(sf::Vector2f(100, 0), \"player.jpg\", \"car.png\", \"spring.png\", \"rocket.png\") {\n}\n\nplayer::player(sf::Vector2f position, std::string normalFileLoc, std::string \ncarFileLoc, std::string springFileLoc, std::string rocketFileLoc)\n{\nnormalTexture.loadFromFile(normalFileLoc);\nnormalRect[0] = sf::IntRect(0, 0, 64, 128);\nnormalSprite.setTexture(normalTexture);\nnormalSprite.setTextureRect(normalRect[0]);\nnormalSprite.setOrigin(0,0);\nnormalSprite.setScale(1, 1);\nnormalSprite.setPosition(position.x, position.y);\n\ncarTexture.loadFromFile(carFileLoc);\ncarRect[0] = sf::IntRect(0, 0, 64, 64);\ncarSprite.setTexture(carTexture);\ncarSprite.setTextureRect(carRect[0]);\ncarSprite.setOrigin(0, -64);\ncarSprite.setScale(1, 1);\ncarSprite.setPosition(normalSprite.getPosition().x, normalSprite.getPosition().y);\n\n}\n</code></pre>\n\n<p>Main.cpp I know it looks gross, I plan on making it look nicer later:</p>\n\n<pre><code>#include &lt;SFML/Graphics.hpp&gt;\n#include &lt;SFML\\Graphics\\Rect.hpp&gt;\n#include \"player.h\"\nint main()\n{\nsf::RenderWindow window(sf::VideoMode(750, 750), \"SFML Works!\");\n\nplayer thePlayer;\n\nconst float gravity = .001;\nint groundheight = 500;\nsf::Vector2f velocity(sf::Vector2f(0, 0));\n\nthePlayer.normal = true;\n\n\nwhile (window.isOpen())\n{\n    sf::Event event;\n    while (window.pollEvent(event))\n    {\n        if (event.type == sf::Event::Closed)\n            window.close();\n\n        if (event.type == sf::Event::KeyPressed)\n        {\n            if (thePlayer.car &amp;&amp; event.key.code == sf::Keyboard::C)\n            {\n                thePlayer.car = false;\n                thePlayer.spring = false;\n                thePlayer.rocket = false;\n                thePlayer.normal = true;\n                break;\n            }\n            if (thePlayer.spring &amp;&amp; event.key.code == sf::Keyboard::S)\n            {\n                thePlayer.car = false;\n                thePlayer.spring = false;\n                thePlayer.rocket = false;\n                thePlayer.normal = true;\n                break;\n            }\n            if (thePlayer.rocket &amp;&amp; event.key.code == sf::Keyboard::R)\n            {\n                thePlayer.car = false;\n                thePlayer.spring = false;\n                thePlayer.rocket = false;\n                thePlayer.normal = true;\n                break;\n            }\n            if (event.key.code == sf::Keyboard::C)\n            {\n                thePlayer.car = true;\n                thePlayer.spring = false;\n                thePlayer.rocket = false;\n                thePlayer.normal = false;\n                break;\n            }\n            if (event.key.code == sf::Keyboard::R)\n            {\n                thePlayer.car = false;\n                thePlayer.spring = false;\n                thePlayer.rocket = true;\n                thePlayer.normal = false;\n                break;\n            }\n            if (event.key.code == sf::Keyboard::S)\n            {\n                thePlayer.car = false;\n                thePlayer.spring = true;\n                thePlayer.rocket = false;\n                thePlayer.normal = false;\n                break;\n            }\n\n        }\n\n    }\n\n\n\n    if (thePlayer.normal)\n    {\n        velocity.x = 0;\n        thePlayer.normalSprite.move(velocity.x, velocity.y);\n        if (thePlayer.normalSprite.getPosition().y &lt; groundheight)\n        {\n            velocity.y += gravity;\n        }\n        else\n        {\n            thePlayer.normalSprite.setPosition(thePlayer.normalSprite.getPosition().x, groundheight);\n            velocity.y = 0;\n        }\n\n    }\n\n    if (thePlayer.car)\n    {\n        thePlayer.carSprite.move(velocity.x, velocity.y);\n        if (thePlayer.carSprite.getPosition().y &lt; groundheight)\n        {\n            velocity.y += gravity;\n        }\n        else\n        {\n            thePlayer.carSprite.setPosition(thePlayer.carSprite.getPosition().x, groundheight);\n            velocity.y = 0;\n        }\n\n    }\n\n    window.clear();\n    if (thePlayer.normal)\n    {\n        window.draw(thePlayer.normalSprite);\n    }\n    if (thePlayer.car)\n    {\n        window.draw(thePlayer.carSprite);\n    }\n\n    window.display();\n}\n}\n</code></pre>\n\n<p>Thanks so much!</p>\n"}, {"tags": ["c++", "linux", "sed", "wildcard", "poco-libraries"], "comments": [{"owner": {"reputation": 1067, "user_id": 5213135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a6f3e6fb0cad9e3fbbed7cdad9ea5f?s=128&d=identicon&r=PG&f=1", "display_name": "Lee HoYo", "link": "https://stackoverflow.com/users/5213135/lee-hoyo"}, "edited": false, "score": 0, "creation_date": 1530800769, "post_id": 51176981, "comment_id": 89368989, "body": "I guess it may be a double quotes issue. <code>ls &quot;&#47;va*&quot;</code> and <code>ls &#47;va*</code> is different."}, {"owner": {"reputation": 1083, "user_id": 3768183, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1eaa13c75e1733a620a8546168582bec?s=128&d=identicon&r=PG&f=1", "display_name": "dk13", "link": "https://stackoverflow.com/users/3768183/dk13"}, "reply_to_user": {"reputation": 1067, "user_id": 5213135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a6f3e6fb0cad9e3fbbed7cdad9ea5f?s=128&d=identicon&r=PG&f=1", "display_name": "Lee HoYo", "link": "https://stackoverflow.com/users/5213135/lee-hoyo"}, "edited": false, "score": 0, "creation_date": 1530806649, "post_id": 51176981, "comment_id": 89373008, "body": "@Lee HoYo So you mean that I should insert the &quot;/sys/class/net/enp0s3/statistics/*&quot; into double quotes or something else ?"}, {"owner": {"reputation": 1067, "user_id": 5213135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a6f3e6fb0cad9e3fbbed7cdad9ea5f?s=128&d=identicon&r=PG&f=1", "display_name": "Lee HoYo", "link": "https://stackoverflow.com/users/5213135/lee-hoyo"}, "edited": false, "score": 0, "creation_date": 1530883276, "post_id": 51176981, "comment_id": 89403519, "body": "don&#39;t use double quotes if these is a wildcard <code>*</code>"}], "owner": {"reputation": 1083, "user_id": 3768183, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1eaa13c75e1733a620a8546168582bec?s=128&d=identicon&r=PG&f=1", "display_name": "dk13", "link": "https://stackoverflow.com/users/3768183/dk13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530718019, "creation_date": 1530718019, "question_id": 51176981, "link": "https://stackoverflow.com/questions/51176981/how-to-use-poco-processhandle-with-sed-linux-command-that-contains-asterisk-widl", "title": "How to use Poco ProcessHandle with sed linux command that contains asterisk widlcard", "body": "<p>I want to create a c++ app for ubuntu 16.04  that retrieves data from folder /sys/class/net/eth0/statistics/. Specifically I need to get rx_bytes and rx_packets. The command that I have tried succesfully in terminal is the following:</p>\n\n<pre><code>sed -n -e 3p -e 13p /sys/class/net/enp0s3/statistics/*\n</code></pre>\n\n<p>I tried to give the same command using Poco ProcessHandle method using the following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include \"Poco/Exception.h\"\n#include \"Poco/Process.h\"\n#include \"Poco/Pipe.h\"\n#include \"Poco/PipeStream.h\"\n\nusing namespace std;\nusing Poco::Process;\nusing Poco::ProcessHandle;\nusing Poco::Pipe;\nusing Poco::PipeInputStream;\nusing Poco::PipeOutputStream;\nusing Poco::Exception;\n\nint main(int argc, char** argv)\n\n{\n\n    try {\n\n        std::vector&lt;std::string&gt; args;\n\n        std::string cmd = \"sed\";\n\n        args.push_back(\"-n\");\n        args.push_back(\"-e\");\n        args.push_back(\"3p\");\n        args.push_back(\"-e\");\n        args.push_back(\"15p\");\n        args.push_back(\"/sys/class/net/enp0s3/statistics/*\");\n\n        Pipe outPipe;\n\n        ProcessHandle ph = Process::launch(cmd, args, 0, &amp;outPipe, 0);\n\n        PipeInputStream istr(outPipe);\n\n        std::string s;\n        int c = istr.get();\n        while (c != -1) {\n            s += (char)c;\n            c = istr.get();\n        }\n        std::cout &lt;&lt; \"string is \" &lt;&lt; s &lt;&lt; std::endl;\n        return 0;\n    }\n\n    catch (Poco::Exception&amp; exc)\n\n    {\n\n        std::cerr &lt;&lt; exc.displayText() &lt;&lt; exc.code() &lt;&lt; string(exc.name()) &lt;&lt; std::endl;\n\n        return 1;\n    }\n</code></pre>\n\n<p>However I get the error message:</p>\n\n<pre><code>sed: can't read /sys/class/net/enp0s3/statistics/*: No such file or directory\n</code></pre>\n\n<p>When I try the code with a specific file I get the correct strings.\nI know that there is the command cat alternative but is there any way for the above code to work succesfully.</p>\n"}, {"tags": ["c++", "performance", "image-processing", "visual-c++"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1530717876, "post_id": 51176899, "comment_id": 89336502, "body": "If you are only ever going to want to do this on x86 then you might consider using SIMD (SSE/AVX)."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 3, "creation_date": 1530721343, "post_id": 51176899, "comment_id": 89338098, "body": "This does not work. You are overwriting input data before you read it. This will only work correctly if you loop backwards, start at the back of the array."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 3, "creation_date": 1530722022, "post_id": 51176899, "comment_id": 89338381, "body": "To speed up the code, don\u2019t multiply, simply copy the one byte to the lower and upper byte of the output word."}, {"owner": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1530726575, "post_id": 51176899, "comment_id": 89340203, "body": "@Cris Luengo: You are right. I wrote this code on stackoverflow because I only had the &quot;optimized&quot; version. I think it is fixed now. Copying did take longer than multiplying because you need to [copy, shift, or] or you have to seperate memory writes."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 4, "creation_date": 1530726972, "post_id": 51176899, "comment_id": 89340338, "body": "Use bit shift, not divide.  The compiler can&#39;t optimize it for you, because they are not equivalent after integral promotion kicks in and converts both operands to <code>signed int</code>."}, {"owner": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1530775965, "post_id": 51176899, "comment_id": 89353182, "body": "@Ben Voigt: Bitshifting instead of multiplying improved my test code throughput from 150% (compared to the reference implementation) to over 800%. So <code>a = (uint16_t{b} &lt;&lt; 8) | b</code> is about 5 times faster than <code>a = b * 0x101</code>. Tank you - I did not expect this."}, {"owner": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "edited": false, "score": 0, "creation_date": 1530776390, "post_id": 51176899, "comment_id": 89353445, "body": "Strange: for word to dword the multiplication (* 0x10001) is two times faster than the shifting !?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1574063397, "post_id": 51176899, "comment_id": 104082312, "body": "Perhaps multiplying is simpler for the compiler to grok and auto-vectorize?  Otherwise scalar <code>imul</code> has 1 per clock throughput and costs 1 uop, but shift + OR costs multiple uops, and you probably bottleneck on the front-end.   Also, SSE4.2 has an instruction for this, <code>pmovzxbw</code>, or even byte to dword directly with <code>pmovzxbd</code>.  Or AVX2 can do the same thing for vectors twice as wide (producing a 32-byte output vector per instruction).  Use Intel&#39;s intrinsics for this."}], "answers": [{"comments": [{"owner": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "edited": false, "score": 0, "creation_date": 1530726699, "post_id": 51178128, "comment_id": 89340243, "body": "I am so sorry for the error in <code>simpleBytesToWords</code>. Wrote it directly on stackoverflow and did not iterate in the right direction X-(. Should be correct now."}, {"owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "reply_to_user": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "edited": false, "score": 0, "creation_date": 1530737550, "post_id": 51178128, "comment_id": 89343646, "body": "@AndreasH.That&#39;s no problem. Iterating forward or backward has roughly the same complexity, so execution time comparisons above still apply. And this was the question finally."}, {"owner": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "edited": false, "score": 0, "creation_date": 1530769614, "post_id": 51178128, "comment_id": 89349973, "body": "I&#39;ve tested your table method on my Pentium G4650 (home PC) an its a little bit slower than the simpleBytesToWords. The G4650 did a max of 2.4 GPixel/Second with any method. This is exactly the DDR clock. I&#39;ll try it again on my office PC with a i7-6700. (Visual C++ Optimization settings are at maximum)"}, {"owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "reply_to_user": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "edited": false, "score": 0, "creation_date": 1530772845, "post_id": 51178128, "comment_id": 89351387, "body": "@AndreasH.It&#39;s interesting to see these ivergences depending on the test environments. Well, if it doesn&#39;t help I&#39;ll withdraw this answer. Bits shifting, as Ben Voigt suggested comment, is an intersting approach to explore."}, {"owner": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "edited": false, "score": 0, "creation_date": 1530775878, "post_id": 51178128, "comment_id": 89353134, "body": "Bitshifting instead of multiplying improved my test code from 150% (compared to the reference implementation) to over 800%. So <code>a = (uint16_t{b} &lt;&lt; 8) | b</code> is about 5 times faster than <code>a = b * 0x101</code>. I did not expect this."}, {"owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "reply_to_user": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "edited": false, "score": 0, "creation_date": 1530776070, "post_id": 51178128, "comment_id": 89353244, "body": "@AndreasH Hey that&#39;s great! So I&#39;ll withdraw this answer. The strange thing is that using a table should be even faster than shifting. Are you sure you didn&#39;t include the table computation, just done once at startup time, in your bench?"}, {"owner": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "edited": false, "score": 0, "creation_date": 1530776534, "post_id": 51178128, "comment_id": 89353530, "body": "I did the table calculation in a lambda and used a global std::array for the table (which should be optimized away). My initialization looked like <code>static const auto WordTable = []() { auto result = std::array&lt;uint16_t, 256&gt;{}; ...; return result; };</code>. The function itself used a <code>const auto tbl = WordTable.data();</code> as first statement."}, {"owner": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "edited": false, "score": 0, "creation_date": 1530776720, "post_id": 51178128, "comment_id": 89353633, "body": "I really would like to accept your answert to appreciate your work but I am afraid it I cannot because it does not really solve the problem. So I just gave it an upvote. However, we can still leave it here for future reference."}, {"owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "reply_to_user": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "edited": false, "score": 0, "creation_date": 1530779436, "post_id": 51178128, "comment_id": 89355177, "body": "@AndreasH. That&#39;s kind of you, but I agree with you: this shouldn&#39;t be the accepted answer as it does not solve the problem you are facing. That&#39;s life :-) Thanks a lot!"}], "tags": [], "owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "is_accepted": false, "score": 1, "last_activity_date": 1530723443, "last_edit_date": 1530723443, "creation_date": 1530722996, "answer_id": 51178128, "question_id": 51176899, "link": "https://stackoverflow.com/questions/51176899/converting-an-array-of-bytes-uint8-t-into-an-array-of-words-uint16-t-and-vic/51178128#51178128", "title": "Converting an array of bytes (uint8_t) into an array of words (uint16_t) and vice versa", "body": "<p>I tried two things after having compiled your code (I just renamed <code>bytesToWords()</code>, which is now <code>groupedBytesToWords()</code> below):</p>\n\n<ul>\n<li><p>Test of your two functions: they don't produce the same results. With <code>simpleBytesToWords()</code> I end up with a zero-filled array. With <code>groupedBytesToWords()</code> I end up with an alternance of valid results and zeros.</p></li>\n<li><p>Without changing them, assuming a bugfix wouldn't change their complexity, I tried a third one I wrote and that uses a precalculated <code>uint8_t</code> -> <code>uint16_t</code> table that has to be built initially: </p></li>\n</ul>\n\n<p>Here is this table. It's a small one as it only has 255 entries, one per possible <code>uint8_t</code>:</p>\n\n<pre><code>// Build a precalculation table for each possible uint8_t -&gt; uint16_t conversion \nconst size_t sizeTable(std::numeric_limits&lt;uint8_t&gt;::max());\n\nuint16_t * precalc_table = new uint16_t[sizeTable];\n\nfor (uint16_t i = 0; i &lt; sizeTable; ++i)\n{\n    precalc_table[i] = i * 0x101;\n}\n</code></pre>\n\n<p>The third function I tried is below:</p>\n\n<pre><code>void hopefullyFastBytesToWords(uint16_t *ptr, size_t pixelCount, uint16_t const * precalc_table)\n{\n    for (size_t i = 0; i &lt; pixelCount; ++i)\n    {\n        ptr[i] = precalc_table[ptr[i]];\n    }\n}\n</code></pre>\n\n<p>I tested it of course, and the results it produces look according to the description you made in your original post. This function is called by passing the same parameters as we do for the two other functions, plus the precalculated conversion table:</p>\n\n<pre><code>hopefullyFastBytesToWords(buffer, sizeBuf, precalc_table);\n</code></pre>\n\n<p>Then I did some comparisons, using a 500000000 <code>uint16_t</code> long array, initially filled with random <code>uint8_t</code> values. Here is an example using the <code>simpleBytesToWords()</code> you wrote:</p>\n\n<pre><code>fillBuffer(buffer, sizeBuf);\nbegin = clock();\nsimpleBytesToWords(buffer, sizeBuf);\nend = clock();\nstd::cout &lt;&lt; \"simpleBytesToWords(): \" &lt;&lt; (double(end - begin) / CLOCKS_PER_SEC) &lt;&lt; std::endl;\n</code></pre>\n\n<p>I obtained the following results (you'll see I used a small and slow laptop). Here are three example but they are all consistantly producing values of similar magnitude:</p>\n\n<pre><code>$ Sandbox.exe\nsimpleBytesToWords(): 0.681\ngroupedBytesToWords(): 1.2\nhopefullyFastBytesToWords(): 0.461\n\n$ Sandbox.exe\nsimpleBytesToWords(): 0.737\ngroupedBytesToWords(): 1.251\nhopefullyFastBytesToWords(): 0.414\n\n$ Sandbox.exe\nsimpleBytesToWords(): 0.582\ngroupedBytesToWords(): 1.173\nhopefullyFastBytesToWords(): 0.436\n</code></pre>\n\n<p>This doesn't stand for a real actual and valid benchmark of course, but it shows that your \"grouped\" function is slower on my machine, which is not in accordance with the results you obtained. It also shows than precalculating the multiplications instead of casting/multiplying on the fly helps a little.</p>\n"}], "owner": {"reputation": 1574, "user_id": 6172310, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2-U1BpQmAw/AAAAAAAAAAI/AAAAAAAABXE/ZiY6MpBP3ek/photo.jpg?sz=128", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/6172310/andreas-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530726491, "creation_date": 1530717738, "last_edit_date": 1530726491, "question_id": 51176899, "link": "https://stackoverflow.com/questions/51176899/converting-an-array-of-bytes-uint8-t-into-an-array-of-words-uint16-t-and-vic", "title": "Converting an array of bytes (uint8_t) into an array of words (uint16_t) and vice versa", "body": "<p>I have a very time critical piece of code to optimize which does convert arrays of bytes into arrays of words and vice versa. The operation is used to convert between 8 and 16-bit image data.</p>\n\n<p>The array is qword aligned and large enough to store the result.</p>\n\n<p>The conversion from byte to word requires a multiplication with 257 (so 0 is converted to 0 and 255 gets 65535)</p>\n\n<p>A simple solution could be</p>\n\n<pre><code>void simpleBytesToWords(void *ptr, int pixelCount)\n{\n    for (int i = pixelCount - 1; i &gt;= 0; --i)\n        reinterpret_cast&lt;uint16_t*&gt;(ptr)[i] = reinterpret_cast&lt;uint8_t*&gt;(ptr)[i] * 0x101;\n}\n</code></pre>\n\n<p>I also tried to increase performance by converting 4 bytes at once to make use of 64 bit registers:</p>\n\n<pre><code>void bytesToWords(void *ptr, int pixelCount)\n{\n    const auto fastCount = pixelCount / 4;\n\n    if (fastCount &gt; 0)\n    {\n        for (int f = fastCount-1; f &gt;= 0; --f)\n        {\n            auto bytes = uint64_t{ reinterpret_cast&lt;const uint32_t*&gt;(ptr)[f] };\n\n            auto r2 = uint64_t{ bytes &amp; 0xFF };\n            bytes &lt;&lt;= 8;\n            r2 |= bytes &amp; 0xFF0000;\n            bytes &lt;&lt;= 8;\n            r2 |= bytes &amp; 0xFF00000000ull;\n            bytes &lt;&lt;= 8;\n            r2 |= bytes &amp; 0xFF000000000000ull;\n\n            r2 *= 0x101;\n\n            reinterpret_cast&lt;uint64_t*&gt;(ptr)[f] = r2; \n        }\n    }\n\n    if (pixelCount % 4)\n    {\n        auto source = reinterpret_cast&lt;const uint8_t*&gt;(ptr);\n        auto target = reinterpret_cast&lt;uint16_t*&gt;(ptr);\n\n        for (int i = fastCount * 4; i &lt; pixelCount; ++i)\n        {\n            target[i] = (source[i] &lt;&lt; 8) | source[i];\n        }\n    }\n\n}\n</code></pre>\n\n<p>It is working and it is slightly faster than the simple solution.</p>\n\n<p>The other direction (words to bytes) is done with this code:</p>\n\n<pre><code>for (int i = 0; i &lt; pixelCount; ++i)\n    reinterpret_cast&lt;uint8_t*&gt;(bufferPtr)[i] = reinterpret_cast&lt;uint16_t*&gt;(bufferPtr)[i] / 256;\n</code></pre>\n\n<p>I have been searching for compiler intrinsics to speed up this conversion, but have not found anything usefull. Are there any other ways to improve the performance of this conversion?</p>\n"}, {"tags": ["c++", "serialization", "boost", "deserialization", "boost-serialization"], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 986234, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44317fce798ac87610f01e7a4f15d1a0?s=128&d=identicon&r=PG", "display_name": "segfault", "link": "https://stackoverflow.com/users/986234/segfault"}, "edited": false, "score": 0, "creation_date": 1530731528, "post_id": 51179286, "comment_id": 89341882, "body": "The class is polymorphic, thank you ! The problem is <i>load_construct_data()</i> deserializes the params passed to the constructor, while I need runtime param."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 359, "user_id": 986234, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44317fce798ac87610f01e7a4f15d1a0?s=128&d=identicon&r=PG", "display_name": "segfault", "link": "https://stackoverflow.com/users/986234/segfault"}, "edited": false, "score": 0, "creation_date": 1530744226, "post_id": 51179286, "comment_id": 89345317, "body": "Huh. So, you explicitly want to inject data not present in the archive? Why would it be a problem to serialize the <code>m_another</code> inside the <code>save_construct_data</code>? Object tracking with alias detection will do the rest automatically. I&#39;d suggest creating a self-contained example showing what you have, and what you would like to happen instead."}, {"owner": {"reputation": 359, "user_id": 986234, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44317fce798ac87610f01e7a4f15d1a0?s=128&d=identicon&r=PG", "display_name": "segfault", "link": "https://stackoverflow.com/users/986234/segfault"}, "edited": false, "score": 0, "creation_date": 1530773256, "post_id": 51179286, "comment_id": 89351589, "body": "It is a problem, because (in my case) <i>m_another</i> is a pointer to an object that contains the object being deserialized. So (in my case) <i>m_another</i> is deserialized earlier, and all I need is to pass pointer to <i>m_another</i>."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 359, "user_id": 986234, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44317fce798ac87610f01e7a4f15d1a0?s=128&d=identicon&r=PG", "display_name": "segfault", "link": "https://stackoverflow.com/users/986234/segfault"}, "edited": false, "score": 0, "creation_date": 1530793070, "post_id": 51179286, "comment_id": 89363844, "body": "So? I already answered that. Are you trying to convince me that, no, your problem is hard or unsolvable? You&#39;re out of luck, because this site is about sharing solutions, not just problems."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 359, "user_id": 986234, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44317fce798ac87610f01e7a4f15d1a0?s=128&d=identicon&r=PG", "display_name": "segfault", "link": "https://stackoverflow.com/users/986234/segfault"}, "edited": false, "score": 0, "creation_date": 1530793201, "post_id": 51179286, "comment_id": 89363912, "body": "Showing what you have would help. So in absence of that, let me make up some examples that should probably help you: <a href=\"http://coliru.stacked-crooked.com/a/7dea4346e1dc3336\" rel=\"nofollow noreferrer\">Object tracking just works</a>. It will be slightly more cumbersome <a href=\"http://coliru.stacked-crooked.com/a/cb689944ece1d3fc\" rel=\"nofollow noreferrer\">with friend declarations if <code>m_another</code> is  protected</a>."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 359, "user_id": 986234, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44317fce798ac87610f01e7a4f15d1a0?s=128&d=identicon&r=PG", "display_name": "segfault", "link": "https://stackoverflow.com/users/986234/segfault"}, "edited": false, "score": 0, "creation_date": 1530793281, "post_id": 51179286, "comment_id": 89363961, "body": "Regardless, object tracking still just works. To make that point all the way, it <b>even</b> works if you <a href=\"http://coliru.stacked-crooked.com/a/0107c8b3d01b5fb1\" rel=\"nofollow noreferrer\">have cyclic references back to the object being deserialized  from inside the <code>OtherClass</code></a>. All the while without leaking or double serializations. Neat, huh?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 359, "user_id": 986234, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44317fce798ac87610f01e7a4f15d1a0?s=128&d=identicon&r=PG", "display_name": "segfault", "link": "https://stackoverflow.com/users/986234/segfault"}, "edited": false, "score": 0, "creation_date": 1530793632, "post_id": 51179286, "comment_id": 89364169, "body": "Of course to be secure about the memory management it&#39;s better to use smart pointers. <a href=\"http://coliru.stacked-crooked.com/a/60952376f15411fd\" rel=\"nofollow noreferrer\">That&#39;s not a problem either</a>"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 0, "last_activity_date": 1530728932, "last_edit_date": 1592644375, "creation_date": 1530728932, "answer_id": 51179286, "question_id": 51176897, "link": "https://stackoverflow.com/questions/51176897/c-boost-serialization-of-subclass-by-base-class-pointer/51179286#51179286", "title": "C++ boost serialization of subclass by base class pointer", "body": "<p>First off, to get polymorphic behaviour of the class you <strong>need</strong> have a <a href=\"https://en.cppreference.com/w/cpp/language/object#Polymorphic_objects\" rel=\"nofollow noreferrer\">polymorphic type</a>. This logical requirement is <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/serialization/doc/serialization.html#derivedpointers\" rel=\"nofollow noreferrer\">stated in the documentation</a>:</p>\n<blockquote>\n<p>It turns out that the kind of object serialized depends upon whether the base class (base in this case) is polymophic or not. If base is not polymorphic, that is if it has no virtual functions, then an object of the type base will be serialized. Information in any derived classes will be lost. If this is what is desired <strong>(it usually isn't)</strong> then no other effort is required.</p>\n<p><strong>If the base class is polymorphic</strong>, an object of the most derived type (derived_one or derived_two in this case) will be serialized. The question of which type of object is to be serialized is (almost) automatically handled by the library.</p>\n<p>[...]</p>\n</blockquote>\n<p>The obvious way to enforce this is to have the virtual destructor (<a href=\"https://stackoverflow.com/questions/461203/when-to-use-virtual-destructors?rq=1\">When to use virtual destructors?</a>).</p>\n<hr />\n<p>Next up, to (de)serialize types using a non-default constructor, use <code>save_construct_data</code>/<code>load_construct_data</code>. Again, the <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/serialization/doc/serialization.html#constructors\" rel=\"nofollow noreferrer\">docs</a> are a good start.</p>\n"}], "owner": {"reputation": 359, "user_id": 986234, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44317fce798ac87610f01e7a4f15d1a0?s=128&d=identicon&r=PG", "display_name": "segfault", "link": "https://stackoverflow.com/users/986234/segfault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530728932, "creation_date": 1530717716, "question_id": 51176897, "link": "https://stackoverflow.com/questions/51176897/c-boost-serialization-of-subclass-by-base-class-pointer", "title": "C++ boost serialization of subclass by base class pointer", "body": "<p>I perform serialization / deserialization of a subclass object by a pointer to its base class. Everything works Ok, yet I miss one feature: adding a runtime parameter to the constructor of the object being deserialized, example:  </p>\n\n<pre><code>class Base {  \npublic:  \n    Base(AnotherClass* another)  \n        :m_another(another)  \n    {}  \nprotected:  \n    AnotherClass* m_another;  \n};  \nclass Derived : public Base {  \npublic:  \n    Derived(AnotherClass* another)  \n        :Base(another)  \n    {}  \n    Derived()  \n        :Base(nullptr)  \n    {}  \nprivate:  \n    /* different other members */  \n};  \nBOOST_CLASS_EXPORT(Derived);  \n...  \n</code></pre>\n\n<p>My normal way to create a Derived object is:  </p>\n\n<pre><code>Base* obj = new Derived(anotherObj);  \n</code></pre>\n\n<p>The deserialization goes like this:  </p>\n\n<pre><code>Base* obj;\nar &gt;&gt; obj;  \n</code></pre>\n\n<p>The default constructor will be called (Derived()), and deserialization proceeds, BUT m_another is not deserialized, it should be passed to the constructor, all the other fields are deserialized.<br>\nMoreover, I cannot set m_another after the deserialization, because it actually influences the deserialization.<br>\nI can pass reference to anotherObj via a global variable - ugly, but works.<br>\nIs there any way to solve it in a not so ugly manner ?</p>\n"}, {"tags": ["c++", "gcc", "ldd", "nm"], "comments": [{"owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "edited": false, "score": 1, "creation_date": 1530717676, "post_id": 51176841, "comment_id": 89336394, "body": "Did you try not to integrate libstdc and libstdc++ into your own lib? It would probably make things easier, unless your lib uses recent features from libstdc and libstdc++ that are unlikely to exist in old systems."}, {"owner": {"reputation": 299, "user_id": 3990838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca850212cf1cdabbd83e1386ae41f1d?s=128&d=identicon&r=PG&f=1", "display_name": "pawel_j", "link": "https://stackoverflow.com/users/3990838/pawel-j"}, "reply_to_user": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "edited": false, "score": 0, "creation_date": 1530717731, "post_id": 51176841, "comment_id": 89336426, "body": "-static-libgcc -static-libstdc++ make these libs integrated. There is no dependency on them."}, {"owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "edited": false, "score": 1, "creation_date": 1530717934, "post_id": 51176841, "comment_id": 89336534, "body": "I found this: <a href=\"https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=623280\" rel=\"nofollow noreferrer\">bugs.debian.org/cgi-bin/bugreport.cgi?bug=623280</a>: &quot;/usr/lib/libstdc++.so.6: undefined symbol: _ZNSt8messagesIcE2idE, version GLIBCXX_3.4&quot;, in 2011. What I don&#39;t manage to determine right now is whether the issue you are facing would occur if you were not integrating tge static standard libs but use those present on the old system at link time."}], "owner": {"reputation": 299, "user_id": 3990838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca850212cf1cdabbd83e1386ae41f1d?s=128&d=identicon&r=PG&f=1", "display_name": "pawel_j", "link": "https://stackoverflow.com/users/3990838/pawel-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1530717448, "creation_date": 1530717448, "question_id": 51176841, "link": "https://stackoverflow.com/questions/51176841/unique-global-symbol-when-linking-with-static-libstd", "title": "Unique global symbol when linking with static libstd", "body": "<p>I am building a shared library for another system. I wanted to make it linked as static, including all the libstdc and libstdc++, so I can use it as-is on another, older linux. However, when I linked it with below options:</p>\n\n<pre><code>/app/localstorage/dev/gcc/4.8.5/bin/g++ -fPIC -static-libgcc -static-libstdc++ -fno-gnu-unique -shared -Wl,-soname,libsgxstconnector.so -o libsgxstconnector.so one.o two.o -ldl -lrt\n</code></pre>\n\n<p>On the older linux I cannot load the library. The error message states</p>\n\n<pre><code>libsgxstconnector.so: undefined symbol: _ZNSt8messagesIcE2idE\n</code></pre>\n\n<p>nm -a on the older server shows:</p>\n\n<pre><code>0000000000411c20 ? _ZNSt8messagesIcE2idE\n</code></pre>\n\n<p>this ? flag means that ld does not know it and this is probably the reason it cannot load. On my build linux it shows that it is a unique global symbol (flag u)</p>\n\n<pre><code>0000000000411c20 u _ZNSt8messagesIcE2idE\n</code></pre>\n\n<p>Hence the question: is there any possibility to eliminate this feature from my linked library? And are there any good practices to build linux-agnostic binaries? Maybe -fno-gnu-unique should be in different place?</p>\n\n<p>ldd output is the same on all systems:</p>\n\n<pre><code>linux-vdso.so.1 =&gt;  (0x00007ffd23dac000)\nlibdl.so.2 =&gt; /lib64/libdl.so.2 (0x00007fed7ce12000)\nlibrt.so.1 =&gt; /lib64/librt.so.1 (0x00007fed7cc09000)\nlibm.so.6 =&gt; /lib64/libm.so.6 (0x00007fed7c985000)\nlibc.so.6 =&gt; /lib64/libc.so.6 (0x00007fed7c5f1000)\n/lib64/ld-linux-x86-64.so.2 (0x00000030c4800000)\nlibpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007fed7c3d3000)\n</code></pre>\n"}, {"tags": ["c++", "windows-10", "wasapi"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1530721572, "post_id": 51176811, "comment_id": 89338198, "body": "Hopefully &amp;amp; is not actually in the source code you tried, be careful copy/pasting code from a web site.  Very important to pay attention to HRESULT, it tells you why a function failed.  Declare the pointer correctly first, should be IMMDeviceEnumerator* ppv.  And pass it correctly to CoCreateInstance(), last argument should be (void**)&amp;ppv.  Once you have a valid pointer, be sure to not use a C or C++ cast, use its QueryInterface() function."}], "answers": [{"tags": [], "owner": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "is_accepted": true, "score": 0, "last_activity_date": 1530721134, "creation_date": 1530721134, "answer_id": 51177737, "question_id": 51176811, "link": "https://stackoverflow.com/questions/51176811/how-do-i-use-get-access-to-audio-devices-through-the-mmdevice-api/51177737#51177737", "title": "How do I use get access to audio devices through the MMDevice API?", "body": "<p>Relatively good code snippet <a href=\"https://github.com/zerofox/github/blob/830cdc3d54e4ebe78f831ca6c1834305ca532318/test%202/test%202/VolumeEdit.cpp#L25\" rel=\"nofollow noreferrer\">from there</a>:</p>\n\n<pre><code>CoInitialize(NULL);\nIMMDeviceEnumerator *deviceEnumerator = NULL;\nhr = CoCreateInstance(__uuidof(MMDeviceEnumerator), NULL, CLSCTX_INPROC_SERVER, \n    __uuidof(IMMDeviceEnumerator), (LPVOID *)&amp;deviceEnumerator);\nIMMDevice *defaultDevice = NULL;\nhr = deviceEnumerator-&gt;GetDefaultAudioEndpoint(eRender, eConsole, &amp;defaultDevice);\n...\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9750324, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Will", "link": "https://stackoverflow.com/users/9750324/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1159, "favorite_count": 0, "accepted_answer_id": 51177737, "answer_count": 1, "score": 0, "last_activity_date": 1530721134, "creation_date": 1530717349, "question_id": 51176811, "link": "https://stackoverflow.com/questions/51176811/how-do-i-use-get-access-to-audio-devices-through-the-mmdevice-api", "title": "How do I use get access to audio devices through the MMDevice API?", "body": "<p>I am trying to manage the audio streams with a program, but I am having trouble even getting access to an audio device. As a side note I am new to C++ and I learned coding in Java so I'm new to the idea of pointers as well as the ideas of the HRESULT and other windows stuff. On <a href=\"https://docs.microsoft.com/en-us/windows/desktop/coreaudio/stream-management\" rel=\"nofollow noreferrer\">this</a> page it says that I must first enumerate an audio endpoint device. I then did some more searching to find out how to do so and was lead to the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/CoreAudio/enumerating-audio-devices\" rel=\"nofollow noreferrer\">Enumerating Audio Devices</a> page. That page told me to use the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/CoreAudio/mmdevice-api\" rel=\"nofollow noreferrer\">MMDevice API</a>. This page shows this code:</p>\n\n<pre><code>const CLSID CLSID_MMDeviceEnumerator = __uuidof(MMDeviceEnumerator);\nconst IID IID_IMMDeviceEnumerator = __uuidof(IMMDeviceEnumerator);\nhr = CoCreateInstance(\n     CLSID_MMDeviceEnumerator, NULL,\n     CLSCTX_ALL, IID_IMMDeviceEnumerator,\n     (void**)&amp;amp;pEnumerator);\n</code></pre>\n\n<p>I tried to use this and the </p>\n\n<pre><code>(void**)&amp;amp;pEnumerator\n</code></pre>\n\n<p>did not work, so I found some other code that used a </p>\n\n<pre><code>reinterpret_cast&lt;&gt;();\n</code></pre>\n\n<p>in order to deal with this error. But the problem that I am running into is that I am not getting a pointer. My code is below.</p>\n\n<pre><code>CoInitializeEx(NULL, COINIT_MULTITHREADED);\n\nIMMDeviceEnumerator *pEnumerator;\n\nconst CLSID CLSID_MMDeviceEnumerator = __uuidof(MMDeviceEnumerator);\nconst IID IID_IMMDeviceEnumerator = __uuidof(IMMDeviceEnumerator);\n\n//print CLSID to see if I get any ids\nstd::cout &lt;&lt; CLSID_MMDeviceEnumerator.Data1 &lt;&lt; \"\\n\";\nstd::cout &lt;&lt; CLSID_MMDeviceEnumerator.Data2 &lt;&lt; \"\\n\";\nstd::cout &lt;&lt; CLSID_MMDeviceEnumerator.Data3 &lt;&lt; \"\\n\";\nstd::cout &lt;&lt; CLSID_MMDeviceEnumerator.Data4 &lt;&lt; \"\\n\";\n\n//temp variable to hold the result of the CoCreateInstance call\nLPVOID *ppv = NULL;\n\nHRESULT retrivedDeviceEnumerator = CoCreateInstance(\n    CLSID_MMDeviceEnumerator,\n    NULL,\n    CLSCTX_ALL,\n    IID_IMMDeviceEnumerator,\n    ppv\n);\n//I'm sure there is a better way to print and end the line\n//print mem location to see if I am getting a result\nstd::cout &lt;&lt; ppv &lt;&lt; \"\\n\";\n//cast the result to correct type\npEnumerator = (reinterpret_cast&lt;IMMDeviceEnumerator*&gt;(ppv));\n</code></pre>\n\n<p>This code prints some numbers for the CLSID lines so I think that those are getting the correct values, but I am getting 00000000 when I print the ppv pointer.</p>\n"}, {"tags": ["c++", "sorting", "stl", "stl-algorithm"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1530717186, "post_id": 51176716, "comment_id": 89336140, "body": "Get a <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list/388282#388282\">few good C++ books</a> to read, and learn C++ properly from the beginning. Then you will also learn what&#39;s wrong with the code you now have."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1530717650, "post_id": 51176716, "comment_id": 89336379, "body": "Different letters could have the same frequency. Maybe do a normal <code>sort(begin, end)</code> followed by a <code>stable_sort(begin, end, frequency_test)</code> according to frequency?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1530717829, "post_id": 51176716, "comment_id": 89336481, "body": "<code>if (a &gt; b) return false; else return true;</code> --&gt; <code>return a &lt;= b;</code>."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1530782297, "post_id": 51176716, "comment_id": 89356820, "body": "A <a href=\"https://en.cppreference.com/w/cpp/named_req/Compare\" rel=\"nofollow noreferrer\">Compare</a> predicate must return <code>false</code> if you are comparing a value to itself, yours does not. Just <code>return freq[c1] &lt; freq[c2];</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "is_accepted": false, "score": 1, "last_activity_date": 1530720223, "last_edit_date": 1530720223, "creation_date": 1530717570, "answer_id": 51176872, "question_id": 51176716, "link": "https://stackoverflow.com/questions/51176716/stl-sort-function-in-c-wrt-strings/51176872#51176872", "title": "STL sort function in C++ wrt strings", "body": "<p>Use a lambda to capture <code>this</code>:</p>\n\n<pre><code>sort(s.begin(),s.end(),[this](auto a, auto b) -&gt; bool { return helper(a,b); });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 583, "user_id": 1948525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5bccd182ec2401b4f8e031067b45d1?s=128&d=identicon&r=PG", "display_name": "SJHowe", "link": "https://stackoverflow.com/users/1948525/sjhowe"}, "is_accepted": false, "score": 0, "last_activity_date": 1530775520, "last_edit_date": 1530775520, "creation_date": 1530722537, "answer_id": 51178028, "question_id": 51176716, "link": "https://stackoverflow.com/questions/51176716/stl-sort-function-in-c-wrt-strings/51178028#51178028", "title": "STL sort function in C++ wrt strings", "body": "<blockquote>\n  <p>Why is the call to my function wrong? I have used the sort() function\n  before, but not to strings. Is my 'helper()' function incorrect?</p>\n</blockquote>\n\n<p>Because helper is member function of Solution. When you do this</p>\n\n<pre><code>sort(s.begin(),s.end(),helper);\n</code></pre>\n\n<p>you are basically doing this</p>\n\n<pre><code>sort(s.begin(),s.end(),this-&gt;helper);\n</code></pre>\n\n<p>The 3rd parameter to sort needs to be a standalone function, a predicate, a functor or a lambda. It cannnot be a non-static member of a class</p>\n\n<p>This code, cleaned up, works. Note the statics</p>\n\n<pre><code>class Solution {\npublic:\n    // using thread_local so that each thread\n    // has its own global variable.\n    static thread_local std::unordered_map&lt;char, int&gt; freq;\n\n    static bool helper(char c1, char c2) {\n        return (freq[c1]&lt;freq[c2]);\n    }\n\n    std::string frequencySort(std::string s)\n    {\n        freq.clear();\n\n        for (char c : s)\n            ++freq[c];\n\n        std::sort(s.begin(), s.end(), helper);\n\n        return s;\n    }\n};\n\n// definition\nstd::unordered_map&lt;char, int&gt; Solution::freq;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 0, "last_activity_date": 1530782841, "creation_date": 1530782841, "answer_id": 51187832, "question_id": 51176716, "link": "https://stackoverflow.com/questions/51176716/stl-sort-function-in-c-wrt-strings/51187832#51187832", "title": "STL sort function in C++ wrt strings", "body": "<p>Member functions have a hidden parameter that becomes <code>this</code>. You need either expose the state more widely, or write a capturing lambda</p>\n\n<p>Also a <a href=\"https://en.cppreference.com/w/cpp/named_req/Compare\" rel=\"nofollow noreferrer\">Compare</a> predicate must return false if you are comparing a value to itself, yours does not.</p>\n\n<pre><code>class Solution {\npublic:\n    string frequencySort(string s) {\n\n        unordered_map&lt;char,int&gt; freq;\n\n        for(char c:s)\n        {\n            freq[c]++;\n        }\n\n        sort(s.begin(),s.end(),[&amp;freq](char lhs, char rhs){ return freq[lhs] &lt; freq[rhs]; });\n\n        return s;\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10032901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nqk2nP4s1JE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1bR6Jx4upMCWH0tY6ieNez1sdJlQ/mo/photo.jpg?sz=128", "display_name": "Sannidhi Kumar", "link": "https://stackoverflow.com/users/10032901/sannidhi-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1530782841, "creation_date": 1530716996, "last_edit_date": 1530733963, "question_id": 51176716, "link": "https://stackoverflow.com/questions/51176716/stl-sort-function-in-c-wrt-strings", "title": "STL sort function in C++ wrt strings", "body": "<p>So I've been trying to sort a string based on the frequency of its characters.   However the online judge I've been using shows me the error<br>\n<code>Line 17: invalid use of non-static member function 'bool olution::helper(char, char)'</code><br>\nWhy is the call to my function wrong? I have used the <code>sort()</code> function before, but not to strings. Is my <code>helper()</code> function incorrect?  </p>\n\n<pre><code>class Solution {\npublic:\nunordered_map&lt;char,int&gt; freq;\n\nbool helper(char c1,char c2){\n    if(freq[c1]&gt;freq[c2]) return false;\n    else return true;\n}\nstring frequencySort(string s) {\n\n    for(char c:s)\n    {\n        freq[c]++;\n    }\n\n    sort(s.begin(),s.end(),helper);\n\n    return s;\n}\n};\n</code></pre>\n"}, {"tags": ["c++", "opengl", "coordinate-transformation", "orthographic"], "comments": [{"owner": {"reputation": 82151, "user_id": 128511, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/KwGaJ.png?s=128&g=1", "display_name": "gman", "link": "https://stackoverflow.com/users/128511/gman"}, "edited": false, "score": 0, "creation_date": 1530726938, "post_id": 51176674, "comment_id": 89340324, "body": "As Rabbid76 mentions the fixed function pipeline is deprecated. Suggested you learn the modern one. Good lessons here: <a href=\"http://learnopengl.com/\" rel=\"nofollow noreferrer\">learnopengl.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2569, "user_id": 5556905, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8fb333bb0d166b1b2386c42c4cd9fdaf?s=128&d=identicon&r=PG&f=1", "display_name": "jinglei", "link": "https://stackoverflow.com/users/5556905/jinglei"}, "edited": false, "score": 0, "creation_date": 1530761299, "post_id": 51177911, "comment_id": 89347998, "body": "Hi, thanks for the detailed explanation. So the <code>near</code> and <code>far</code> parameters of <code>glOrtho()</code> is actually defining the near/far clipping distances from the eye and their signs mean whether the viewing volume (I suppose this is the same as the frustum?) is in front of /behind the eye, instead of actual coordinates in the space?"}, {"owner": {"reputation": 2569, "user_id": 5556905, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8fb333bb0d166b1b2386c42c4cd9fdaf?s=128&d=identicon&r=PG&f=1", "display_name": "jinglei", "link": "https://stackoverflow.com/users/5556905/jinglei"}, "edited": false, "score": 0, "creation_date": 1530761888, "post_id": 51177911, "comment_id": 89348099, "body": "Also I&#39;m still a little confused about what you mean by &quot;the z-axis is inverted by the projection matrix&quot;. I mean, the projection matrix defines a frustum and maps the 3D frustum to a 2D plane (clip space?). And the z-axis is inverted when coordinates are transformed from that 2D plane to the NDC space. I suppose this is because NDC uses left-handed coordinate system. So, I think the &quot;inversion&quot; does not influence the <code>view-&gt;clip</code> process and the signs of the <code>near</code>/<code>far</code> param is not related with this inversion of z-axis. (I&#39;m just so confused of whether should I use positive/negative value.)"}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "reply_to_user": {"reputation": 2569, "user_id": 5556905, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8fb333bb0d166b1b2386c42c4cd9fdaf?s=128&d=identicon&r=PG&f=1", "display_name": "jinglei", "link": "https://stackoverflow.com/users/5556905/jinglei"}, "edited": false, "score": 1, "creation_date": 1530764131, "post_id": 51177911, "comment_id": 89348524, "body": "@Jinglei.Y Use a view matrix and positive values for the near and far plane. The part <code>-2&#47;(f-n)</code> invertes the z-coordiante when a vertex is transformed by the projection matrix."}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "reply_to_user": {"reputation": 2569, "user_id": 5556905, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8fb333bb0d166b1b2386c42c4cd9fdaf?s=128&d=identicon&r=PG&f=1", "display_name": "jinglei", "link": "https://stackoverflow.com/users/5556905/jinglei"}, "edited": false, "score": 1, "creation_date": 1530765213, "post_id": 51177911, "comment_id": 89348726, "body": "@Jinglei.Y At orthographic projection there is no &quot;frustum&quot;, because a frustum is a truncated pyramid. The view volume at orthographic projection is a box. At perspective projection it would be a frustum."}], "tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 2, "last_activity_date": 1530725970, "last_edit_date": 1530725970, "creation_date": 1530721902, "answer_id": 51177911, "question_id": 51176674, "link": "https://stackoverflow.com/questions/51176674/opengl-camera-cannot-see-object-when-glortho-is-used/51177911#51177911", "title": "opengl - camera cannot see object when glOrtho is used", "body": "<p>First of all note, that the fixed function pipeline matrix stack and drawing by <code>glBegin</code>/<code>glEnd</code> sequences is deprecated since more than 10 years.\nRead about <a href=\"https://www.khronos.org/opengl/wiki/Fixed_Function_Pipeline\" rel=\"nofollow noreferrer\">Fixed Function Pipeline</a> and see <a href=\"https://www.khronos.org/opengl/wiki/Vertex_Specification\" rel=\"nofollow noreferrer\">Vertex Specification</a> for a state of the art way of rendering.</p>\n\n<hr>\n\n<p>If you use a view matrix like this:</p>\n\n<pre><code>gluLookAt(0, 0, 2, 0, 0, 0, 0, 1, 0);\n</code></pre>\n\n<p>Then the values for the near and the far plane have to be positive when you set up the the projection matrix,</p>\n\n<pre><code>glOrtho(-2, 2, -2, 2, 0.1, 2.0);\n</code></pre>\n\n<p>because, <code>gluLookAt</code> transforms the vertices to view space (in view space the z axis points out of the viewport), but the projection matrix inverts the z-axis. </p>\n\n<p>But be careful, since the triangle is at <code>z=0</code></p>\n\n<pre><code>(0,1,0), (1,0,0), (-1,0,0)\n</code></pre>\n\n<p>and the distance from the camera to the triangle is 2, because  of the view matrix, the triangle is placed exactly on the far plane (which is 2.0 too). I recommend to increase the distance to the far plane from 2.0 to (e.g.) 3.0:</p>\n\n<pre><code>glOrtho(-2, 2, -2, 2, 0.1, 3.0);\n</code></pre>\n\n<hr>\n\n<p>If you change the view matrix, </p>\n\n<pre><code>gluLookAt(0, 0, -2, 0, 0, 0, 0, 1, 0);\n</code></pre>\n\n<p>then still the (view space) z-axis points out of the viewport, but you look at the \"back\" side of the triangle. The triangle is still in the center of the view (0, 0, 0), but the camera position has changed. The triangle is still in front of the camera.</p>\n\n<p>If you would do </p>\n\n<pre><code>gluLookAt(0, 0, 2, 0, 0, 4, 0, 1, 0);\n</code></pre>\n\n<p>then you would look away from the triangle. You would have to project the backside of the view to the viewport to \"see\" the triangle (<code>glOrtho(-2, 2, -2, 2, -0.1, -3.0);</code>).</p>\n\n<hr>\n\n<p>Further note, that <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glOrtho.xml\" rel=\"nofollow noreferrer\"><code>glOrtho</code></a> multiplies the current matrix  by the orthographic projection matrix. This means you should set the identity matrix, before you use <code>glOrtho</code>, as you do it with the model view matrix:</p>\n\n<pre><code>glMatrixMode(GL_PROJECTION);\nglLoadIdentity();\nglOrtho(-2, 2, -2, 2, 0.1, 2.0);\n</code></pre>\n\n<hr>\n\n<p><strong>Explanation</strong></p>\n\n<p>The projection, view and model matrix interact together to present the objects (meshes) of a scene on the viewport.\nThe model matrix defines the position orientation and scale of a single object (mesh) in the worldspace of the scene.\nThe view matrix defines the position and viewing direction of the observer (viewer) within the scene.\nThe projection matrix defines the area (volume) with respect to the observer (viewer) projected onto the viewport.</p>\n\n<p>At orthographic projection, this area (volume) is defined by 6 distances (left, right, bottom, top, near and far) to the viewer's position.</p>\n\n<p><strong>View matrix</strong></p>\n\n<p>The view coordinates system describes the direction and position from which the scene is looked at. The view matrix transforms from the wolrd space to the view (eye) space. </p>\n\n<p>If the coordiante system of the view space is a <a href=\"https://en.wikipedia.org/wiki/Right-hand_rule\" rel=\"nofollow noreferrer\">Right-handed</a> system, then the X-axis points to the left, the Y-axis up and the Z-axis out of the view (Note in a right hand system the Z-Axis is the cross product of the X-Axis and the Y-Axis). </p>\n\n<p><a href=\"https://i.stack.imgur.com/U5PSt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U5PSt.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Projection matrix</strong></p>\n\n<p>The projection matrix describes the mapping from 3D points of the view on a scene, to 2D points on the viewport. It transforms from eye space to the clip space, and the coordinates in the clip space are transformed to the normalized device coordinates (NDC) by dividing with the <code>w</code> component of the clip coordinates. The NDC are in range (-1,-1,-1) to (1,1,1).<br/> Every geometry which is out of the clippspace is clipped.<br/></p>\n\n<p>At Orthographic Projection the coordinates in the view space are linearly mapped to clip space coordinates and the clip space coordinates are equal to the normalized device coordinates, because the <code>w</code> component is 1 (for a cartesian input coordinate).<br/>\nThe values for left, right, bottom, top, near and far define a box. All the geometry which is inside the volume of the box is \"visible\" on the viewport. </p>\n\n<p><a href=\"https://i.stack.imgur.com/QlZlU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QlZlU.png\" alt=\"enter image description here\"></a></p>\n\n<p>The Orthographic Projection Matrix looks like this:</p>\n\n<pre><code>r = right, l = left, b = bottom, t = top, n = near, f = far \n\n2/(r-l)         0               0               0\n0               2/(t-b)         0               0\n0               0               -2/(f-n)        0\n-(r+l)/(r-l)    -(t+b)/(t-b)    -(f+n)/(f-n)    1\n</code></pre>\n\n<p>The z-axis is inverted by the projection matrix.</p>\n"}], "owner": {"reputation": 2569, "user_id": 5556905, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8fb333bb0d166b1b2386c42c4cd9fdaf?s=128&d=identicon&r=PG&f=1", "display_name": "jinglei", "link": "https://stackoverflow.com/users/5556905/jinglei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1061, "favorite_count": 0, "accepted_answer_id": 51177911, "answer_count": 1, "score": 1, "last_activity_date": 1531053072, "creation_date": 1530716881, "last_edit_date": 1531053072, "question_id": 51176674, "link": "https://stackoverflow.com/questions/51176674/opengl-camera-cannot-see-object-when-glortho-is-used", "title": "opengl - camera cannot see object when glOrtho is used", "body": "<p>I'm new to <em>OpenGL</em> and I'm trying to understand how the projection matrix works in it.</p>\n\n<p>To create a simple case, I define a triangle in the world space and its coordinates are:</p>\n\n<blockquote>\n  <p>(0,1,0), (1,0,0), (-1,0,0)</p>\n</blockquote>\n\n<p>I set the modelview matrix and projection matrix as below:</p>\n\n<pre><code>glMatrixMode(GL_MODELVIEW);\nglLoadIdentity();\ngluLookAt(\n    0, 0, 2,\n    0, 0, 0,\n    0, 1, 0);\nglMatrixMode(GL_PROJECTION);\nglOrtho(-2, 2, -2, 2, -0.1, -2.0); // does not work\n// glOrtho(-2, 2, -2, 2, 0.1, 2.0); // works\n</code></pre>\n\n<p>From my understanding, <code>gluLookAt()</code> is used to set the viewing matrix. Since <code>OpenGL</code> does not have a concept of \"camera\", and thus it transforms the entire world to reach the effect of a camera. In the above code, I assume the \"camera\" is at (0,0,2), looking at (0,0,0). So <em>OpenGL</em> internally moves the triangle backwards along <code>z</code> axis to <code>z=-2</code>.</p>\n\n<p>To define a view frustum, <code>glOrtho()</code> get 6 parameters. To make the triangle visible in the frustum, I set the <code>near</code> and <code>far</code> value to <code>-0.1</code> and <code>-2.0</code> respectively and this should indicate that the frustum include <code>[-0.1, -2.0]</code> on <code>z</code> axis.</p>\n\n<hr>\n\n<p>I searched for similar questions and found out someone states that the last two parameters of <code>glOrtho()</code> is in fact <code>-near</code> and <code>-far</code>. But if this is correct, the following code should work(<strong>but it doesn't</strong>):</p>\n\n<pre><code>glMatrixMode(GL_MODELVIEW);\nglLoadIdentity();\ngluLookAt(\n    0, 0, -2, // changed 2 to -2, thus the triangle should be transformed to z=2?\n    0, 0, 0,\n    0, 1, 0);\nglMatrixMode(GL_PROJECTION);\nglOrtho(-2, 2, -2, 2, -0.1, -2.0); // -near=-0.1, -far=-2.0, thus the frustum should include [0.1, 2.0], thus include the triangle\n</code></pre>\n\n<p><strong>If I'm correct, the triangle should be drawn on the screen, so there must be something wrong with my code. Can anyone help?</strong></p>\n"}, {"tags": ["c++", "templates", "variadic-templates", "c++17", "static-assert"], "comments": [{"owner": {"reputation": 505, "user_id": 3065592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60527c78c08542c8f4de56f9082e69d?s=128&d=identicon&r=PG&f=1", "display_name": "wtom", "link": "https://stackoverflow.com/users/3065592/wtom"}, "edited": false, "score": 0, "creation_date": 1530721030, "post_id": 51176572, "comment_id": 89337970, "body": "template&lt;typename T, class... ArgTypes, typename Func&gt; void Example(Func) { \t// func can have params, or have no params \tstatic_assert(std::is_same&lt; \t\tstd::invoke_result&lt;Func, ArgTypes...&gt;::type, \t\tstd::unique_ptr&lt;T&gt;&gt;::value, \t\t&quot;Not a unique pointer to type &#39;T&#39;&quot;); }"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1530722000, "post_id": 51176572, "comment_id": 89338376, "body": "Please do not completely rewrite questions that have already been answered.  Ask a new question."}, {"owner": {"reputation": 299, "user_id": 1781858, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4e915fa31a5ba020ed60ff3c3e689bba?s=128&d=identicon&r=PG", "display_name": "GreekFire", "link": "https://stackoverflow.com/users/1781858/greekfire"}, "edited": false, "score": 0, "creation_date": 1530722681, "post_id": 51176572, "comment_id": 89338677, "body": "@Adam Nevraumont will do next time."}], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 1781858, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4e915fa31a5ba020ed60ff3c3e689bba?s=128&d=identicon&r=PG", "display_name": "GreekFire", "link": "https://stackoverflow.com/users/1781858/greekfire"}, "edited": false, "score": 0, "creation_date": 1530720371, "post_id": 51176730, "comment_id": 89337737, "body": "Thanks for the response, it works for the original code posted. But not for what I was intending. I posted a more direct code example based on a factory with registration that I was thinking would benefit by ensuring the return type matches the template type for the &#39;Register&#39; method."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 299, "user_id": 1781858, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4e915fa31a5ba020ed60ff3c3e689bba?s=128&d=identicon&r=PG", "display_name": "GreekFire", "link": "https://stackoverflow.com/users/1781858/greekfire"}, "edited": false, "score": 0, "creation_date": 1530721947, "post_id": 51176730, "comment_id": 89338348, "body": "@greek as a general rule, if someone answers the question as posed, upvote, check mark.  If your real problem is something else, create a new question eith the original problem fixed.  Double check if is a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 299, "user_id": 1781858, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4e915fa31a5ba020ed60ff3c3e689bba?s=128&d=identicon&r=PG", "display_name": "GreekFire", "link": "https://stackoverflow.com/users/1781858/greekfire"}, "edited": false, "score": 0, "creation_date": 1530722603, "post_id": 51176730, "comment_id": 89338635, "body": "@Adam Nevraumont I will do that next time. I thought the original example was &#39;minimal&#39; enough, but it turned out not to be..."}], "tags": [], "owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "is_accepted": false, "score": 2, "last_activity_date": 1530717468, "last_edit_date": 1530717468, "creation_date": 1530717038, "answer_id": 51176730, "question_id": 51176572, "link": "https://stackoverflow.com/questions/51176572/c17-invoke-result-and-static-assert-for-template-func-param/51176730#51176730", "title": "C++17 invoke_result and static_assert for template func param", "body": "<p>you had an extra <code>()</code> on</p>\n\n<pre><code>static_assert(std::is_same&lt;decltype(result), std::unique_ptr&lt;T&gt;/* here */ &gt;::value, \"Not a unique pointer to type 'T'\");\n</code></pre>\n\n<p>and</p>\n\n<pre><code>typename std::invoke_result&lt;Func/* here */&gt;::type result;\n</code></pre>\n\n<p><code>A</code> and <code>A()</code> are two different types. <code>A()</code> is a function returning a <code>A</code> and taking no arguments.</p>\n\n<p>the final code should be</p>\n\n<pre><code>#include &lt;type_traits&gt;\n#include &lt;memory&gt;\n\nusing namespace std;\n\ntemplate&lt;typename T, typename Func&gt;\nvoid Example(Func)\n{\n    // func can have params, or have no params\n    typename std::invoke_result&lt;Func&gt;::type result;\n    static_assert(std::is_same&lt;decltype(result), std::unique_ptr&lt;T&gt; &gt;::value, \"Not a unique pointer to type 'T'\"); // can't get this correct (tried different variations, looked over stackoverflow, etc.)\n}\n\nclass Foo\n{\npublic:\n    Foo(int i)\n        : My_I(i)\n    {\n    }\n\n    Foo()\n        : My_I(99)\n    {\n    }\n\n    ~Foo() = default;\n\n    int My_I;\n};\n\nunique_ptr&lt;Foo&gt; CreateWithInt()\n{\n    return make_unique&lt;Foo&gt;(11);\n}\n\nint main()\n{\n    Example&lt;Foo&gt;(&amp;CreateWithInt);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 299, "user_id": 1781858, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4e915fa31a5ba020ed60ff3c3e689bba?s=128&d=identicon&r=PG", "display_name": "GreekFire", "link": "https://stackoverflow.com/users/1781858/greekfire"}, "edited": false, "score": 0, "creation_date": 1530721287, "post_id": 51177690, "comment_id": 89338078, "body": "Thanks max66, I changed the code example to better illustrate my question. There is a factory with a &#39;Register&#39; method that has the issue with the static_assert."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 299, "user_id": 1781858, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4e915fa31a5ba020ed60ff3c3e689bba?s=128&d=identicon&r=PG", "display_name": "GreekFire", "link": "https://stackoverflow.com/users/1781858/greekfire"}, "edited": false, "score": 0, "creation_date": 1530722054, "post_id": 51177690, "comment_id": 89338397, "body": "@GreekFire - cannot reproduce: for me works; try with <code>static_assert(std::is_same&lt;typename baz&lt;Func&gt;::retType, std::unique_ptr&lt;My_Type&gt;&gt;::value,  &quot;!&quot;);</code>; give me some minutes and I propose another (C++17 only) solution; but this one should works also with you <code>Register()</code>"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 299, "user_id": 1781858, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4e915fa31a5ba020ed60ff3c3e689bba?s=128&d=identicon&r=PG", "display_name": "GreekFire", "link": "https://stackoverflow.com/users/1781858/greekfire"}, "edited": false, "score": 0, "creation_date": 1530722709, "post_id": 51177690, "comment_id": 89338684, "body": "@GreekFire - answer improved with a second (C++17 only) solution; both of they works, for me, with your code."}, {"owner": {"reputation": 299, "user_id": 1781858, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4e915fa31a5ba020ed60ff3c3e689bba?s=128&d=identicon&r=PG", "display_name": "GreekFire", "link": "https://stackoverflow.com/users/1781858/greekfire"}, "edited": false, "score": 0, "creation_date": 1530722874, "post_id": 51177690, "comment_id": 89338743, "body": "Wow, the c++17 solution is slick... works wonderfully! (for Register() method)"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 299, "user_id": 1781858, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4e915fa31a5ba020ed60ff3c3e689bba?s=128&d=identicon&r=PG", "display_name": "GreekFire", "link": "https://stackoverflow.com/users/1781858/greekfire"}, "edited": false, "score": 0, "creation_date": 1530723264, "post_id": 51177690, "comment_id": 89338918, "body": "@GreekFire - great improvement C++17 deduction guides!"}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 1, "last_activity_date": 1530722644, "last_edit_date": 1530722644, "creation_date": 1530720920, "answer_id": 51177690, "question_id": 51176572, "link": "https://stackoverflow.com/questions/51176572/c17-invoke-result-and-static-assert-for-template-func-param/51177690#51177690", "title": "C++17 invoke_result and static_assert for template func param", "body": "<p>This doesn't work in all functional cases but, with function pointers, should work.</p>\n\n<p>If you define a custom template as follows</p>\n\n<pre><code>template &lt;typename&gt;\nstruct baz;\n\ntemplate &lt;typename R, typename ... Args&gt;\nstruct baz&lt;R(*)(Args...)&gt;\n { using retType = R; };\n</code></pre>\n\n<p>your example become</p>\n\n<pre><code>template &lt;typename T, typename Func&gt;\nvoid Example(Func func)\n {\n   static_assert(std::is_same&lt;typename baz&lt;Func&gt;::retType,\n                              std::unique_ptr&lt;T&gt;&gt;::value,  \"!\");\n }\n</code></pre>\n\n<p>The following is a full compiling example</p>\n\n<pre><code>#include &lt;type_traits&gt;\n#include &lt;memory&gt;\n\ntemplate &lt;typename&gt;\nstruct baz;\n\ntemplate &lt;typename R, typename ... Args&gt;\nstruct baz&lt;R(*)(Args...)&gt;\n { using retType = R; };\n\ntemplate &lt;typename T, typename Func&gt;\nvoid Example(Func func)\n {\n   static_assert(std::is_same&lt;typename baz&lt;Func&gt;::retType,\n                              std::unique_ptr&lt;T&gt;&gt;::value,  \"!\");\n }\n\nstruct Foo\n {\n   Foo (int i) : My_I{i}\n    { }\n\n   Foo () : My_I{99}\n    { }\n\n   ~Foo() = default;\n\n   int My_I;\n };\n\nstd::unique_ptr&lt;Foo&gt; bar0 ()\n{ return std::make_unique&lt;Foo&gt;(11); }\n\nstd::unique_ptr&lt;Foo&gt; bar1 (int)\n{ return std::make_unique&lt;Foo&gt;(11); }\n\nstd::unique_ptr&lt;Foo&gt; bar2 (int, long)\n{ return std::make_unique&lt;Foo&gt;(11); }\n\nint main ()\n {\n   Example&lt;Foo&gt;(&amp;bar0);\n   Example&lt;Foo&gt;(&amp;bar1);\n   Example&lt;Foo&gt;(&amp;bar2);\n }\n</code></pre>\n\n<p>Unfortunately this solution works only with function pointers and not with (by example) lambda function (when not convertible to function pointers) or classes with <code>operator()</code>.</p>\n\n<p>If you can use C++17 -- and I suppose is your case, if you use <code>std::invoke_result</code> -- you can also use automatic deduction guides for <code>std::function</code>. </p>\n\n<p>So, in C++17, you can forget the <code>baz</code> struct and simply write</p>\n\n<pre><code>template &lt;typename T, typename Func&gt;\nvoid Example(Func func)\n {        \n   static_assert(std::is_same&lt;\n       typename decltype(std::function{func})::result_type,\n       std::unique_ptr&lt;T&gt;&gt;::value,  \"!\");\n }\n</code></pre>\n\n<p>or, in your <code>Register()</code> method</p>\n\n<pre><code>template&lt;typename My_Type, typename Func&gt;\nstatic bool Register(Func func)\n{\n    static_assert(std::is_same&lt;\n       typename decltype(std::function{func})::result_type,\n       std::unique_ptr&lt;My_Type&gt;&gt;::value,  \"!\");\n\n    bool isRegistered = false;\n\n    if (GetCreateFunctions().end() == GetCreateFunctions().find(typeid(My_Type)))\n    {\n        GetCreateFunctions()[typeid(My_Type)] = reinterpret_cast&lt;void*&gt;(func);\n        isRegistered = true;\n    }\n\n    return isRegistered;\n}\n</code></pre>\n"}], "owner": {"reputation": 299, "user_id": 1781858, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4e915fa31a5ba020ed60ff3c3e689bba?s=128&d=identicon&r=PG", "display_name": "GreekFire", "link": "https://stackoverflow.com/users/1781858/greekfire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1285, "favorite_count": 1, "accepted_answer_id": 51177690, "answer_count": 2, "score": 4, "last_activity_date": 1530722809, "creation_date": 1530716546, "last_edit_date": 1530722809, "question_id": 51176572, "link": "https://stackoverflow.com/questions/51176572/c17-invoke-result-and-static-assert-for-template-func-param", "title": "C++17 invoke_result and static_assert for template func param", "body": "<p>This is purely for gaining more knowledge when doing generic programming. How can I ensure the return type of a function passed in as a template argument to another function, which can take a different number of params (0 to N).</p>\n\n<p>EDIT:\nI am trying to use <code>std::invoke_result</code> and <code>static_assert()</code> to ensure the proper return type for registered factory methods. I've used a better example than the first one posted to give more clarity.</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;memory&gt;\n#include &lt;typeindex&gt;\n#include &lt;typeinfo&gt;\n#include &lt;unordered_map&gt;\n\nusing namespace std;\n\nclass Factory final\n{\npublic:\n    template&lt;typename My_Type, typename Func&gt;\n    static bool Register(Func func)\n    {\n        // issue is these two lines of code, when trying to register Derived1 and Derived2 create functions\n        typename invoke_result&lt;Func&gt;::type result;\n        static_assert(is_same&lt;decltype(result), unique_ptr&lt;My_Type&gt;&gt;::value, \"Not a unique pointer to type 'My_Type'\");\n\n        bool isRegistered = false;\n\n        if (GetCreateFunctions().end() == GetCreateFunctions().find(typeid(My_Type)))\n        {\n            GetCreateFunctions()[typeid(My_Type)] = reinterpret_cast&lt;void*&gt;(func);\n            isRegistered = true;\n        }\n\n        return isRegistered;\n    }\n\n    template&lt;typename My_Type, typename... Args&gt;\n    static unique_ptr&lt;My_Type&gt; Create(Args&amp;&amp;... args)\n    {\n        unique_ptr&lt;My_Type&gt; type = nullptr;\n        auto iter = GetCreateFunctions().find(typeid(My_Type));\n\n        if (GetCreateFunctions().end() != iter)\n        {\n            typedef unique_ptr&lt;My_Type&gt;(*create_func)(Args&amp;&amp;...);\n            auto create = reinterpret_cast&lt;create_func&gt;(iter-&gt;second);\n            type = create(forward&lt;Args&gt;(args)...);\n        }\n\n        return type;\n    }\n\nprivate:\n    static unordered_map&lt;type_index, void*&gt;&amp; GetCreateFunctions()\n    {\n        static unordered_map&lt;type_index, void*&gt; map;\n        return map;\n    }\n};\n\nclass Base\n{\npublic:\n    Base(unique_ptr&lt;string&gt;&amp;&amp; moveString)\n        :\n        _moveString(move(moveString))\n    {\n    }\n\n    virtual ~Base() = default;\n    virtual void DoSomething() const = 0;\n\nprotected:\n    unique_ptr&lt;string&gt; _moveString;\n};\n\nclass Derived1 final : public Base\n{\npublic:\n    Derived1(unique_ptr&lt;string&gt;&amp;&amp; moveString)\n        :\n        Base(move(moveString))\n    {\n    }\n\n    ~Derived1() = default;\n\n    void DoSomething() const override\n    {\n        if (_moveString)\n        {\n            // do something...\n        }\n    }\n\nprivate:\n    static const bool _isRegistered;\n\n    static unique_ptr&lt;Derived1&gt; Create(unique_ptr&lt;string&gt;&amp;&amp; moveString)\n    {\n        return make_unique&lt;Derived1&gt;(move(moveString));\n    }\n};\n\nconst bool Derived1::_isRegistered = Factory::template Register&lt;Derived1&gt;(&amp;Derived1::Create);\n\nclass Derived2 final : public Base\n{\npublic:\n    Derived2()\n        :\n        Base(make_unique&lt;string&gt;(\"Default\"))\n    {\n    }\n\n    ~Derived2() = default;\n\n    void DoSomething() const override\n    {\n        if (_moveString)\n        {\n            // do something...\n        }\n    }\n\nprivate:\n    static const bool _isRegistered;\n\n    static unique_ptr&lt;Derived2&gt; Create()\n    {\n        return make_unique&lt;Derived2&gt;();\n    }\n};\n\nconst bool Derived2::_isRegistered = Factory::template Register&lt;Derived2&gt;(&amp;Derived2::Create);\n\n\nint main(int argc, char** argv)\n{\n    string moveString = \"moveString\";\n    unique_ptr&lt;Base&gt; myBase_Derived1 = Factory::template Create&lt;Derived1&gt;(make_unique&lt;string&gt;(move(moveString)));\n    unique_ptr&lt;Base&gt; myBase_Derived2 = Factory::template Create&lt;Derived2&gt;();\n\n    if (myBase_Derived1)\n        printf(\"Success\\n\");\n\n    if (myBase_Derived2)\n        printf(\"Success\\n\");\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "doxygen"], "answers": [{"tags": [], "owner": {"reputation": 5891, "user_id": 1657886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d48ba7c8258ef5c613ba129411a6b0?s=128&d=identicon&r=PG", "display_name": "albert", "link": "https://stackoverflow.com/users/1657886/albert"}, "is_accepted": false, "score": 0, "last_activity_date": 1530719347, "creation_date": 1530719347, "answer_id": 51177316, "question_id": 51176208, "link": "https://stackoverflow.com/questions/51176208/how-can-i-configure-doxygen-to-include-typedefs-of-classes-in-the-class-index/51177316#51177316", "title": "How can I configure Doxygen to include typedefs of classes in the &quot;Class Index&quot;?", "body": "<p>A <code>typedef</code> is not a <code>class</code> and this is not foreseen.\nA not so nice solution as it does not mention that the <code>MonthlyYieldMap</code> is a <code>typedef</code> but says that it is a function  (I don't how acceptable this is in your case) is:</p>\n\n<pre><code>/**\n  * @class MonthlyYieldMap\n  */\n/**\n  * some documentation\n  * \\relates MonthlyYieldMap\n  */\ntypedef std::map&lt;std::string /* month name */, std::string /* yield */&gt; MonthlyYieldMap;\n</code></pre>\n"}], "owner": {"reputation": 724, "user_id": 1165262, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2bb3dcbb60d53a71f7171bad32aac7b1?s=128&d=identicon&r=PG", "display_name": "Louis Strous", "link": "https://stackoverflow.com/users/1165262/louis-strous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530778945, "creation_date": 1530715272, "last_edit_date": 1530778945, "question_id": 51176208, "link": "https://stackoverflow.com/questions/51176208/how-can-i-configure-doxygen-to-include-typedefs-of-classes-in-the-class-index", "title": "How can I configure Doxygen to include typedefs of classes in the &quot;Class Index&quot;?", "body": "<p>How can I configure Doxygen to include typedefs of classes in the \"Class Index\" web page?   For example, if the code has</p>\n\n<pre><code>typedef std::map&lt;std::string /* month name */, std::string /* yield */&gt; MonthlyYieldMap;\n</code></pre>\n\n<p>somewhere, then <code>MonthlyYieldMap</code> acts like a class, so it seems reasonable to include it in the Class Index just like the other names that refer to classes.  </p>\n\n<p>If I'm inspecting someone else's code and see the name of something that acts like a class but that is unfamiliar to me, then I pull up the Class Index to look for details of the class, but if the name is a typedef then it is not shown.</p>\n\n<p>I can still find information about the mysterious name through the Doxygen search bar on the Class Index web page, but it would be more convenient if it were mentioned in the Class Index.</p>\n\n<p>I've looked through the configuration file and found two that mention typedefs (INLINE_SIMPLE_STRUCTS and TYPEDEF_HIDE_STRUCT) but they don't address my problem.</p>\n\n<p>ADDED 2018-07-05:</p>\n\n<p>If I can edit the code, then I can change the typedef to a class inheriting the other class:</p>\n\n<pre><code>class MonthlyYieldMap : public std::map&lt;std::string, std::string&gt; { }\n</code></pre>\n\n<p>and then it is included in the Class Index.  I don't know if there is a performance or executable size penalty for doing this.  And this doesn't help if I cannot edit the code.</p>\n"}, {"tags": ["c++", "input", "precision", "cin"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 8, "creation_date": 1530715073, "post_id": 51176073, "comment_id": 89335006, "body": "<a href=\"http://en.cppreference.com/w/cpp/string/basic_string/getline\" rel=\"nofollow noreferrer\">Read a whole line</a>, and try to <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/stof\" rel=\"nofollow noreferrer\">parse it as a floating point number</a>. Follow the links, read the documentation."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 3, "creation_date": 1530717100, "post_id": 51176073, "comment_id": 89336086, "body": "&#39;&quot;45&quot;` <b>is</b> a valid text representation of a floating-point value. The <b>next</b> attempted read will fail, because <code>&#39;*&#39;</code> cannot be part of a valid floating-point value, and there are no valid characters preceding it."}], "owner": {"reputation": 41, "user_id": 10032665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a48e437e957ad9efd85b044b0dc475f?s=128&d=identicon&r=PG&f=1", "display_name": "CD&#39;A", "link": "https://stackoverflow.com/users/10032665/cda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530733113, "creation_date": 1530714779, "last_edit_date": 1530733113, "question_id": 51176073, "link": "https://stackoverflow.com/questions/51176073/determine-if-input-is-numeric", "title": "Determine if input is numeric", "body": "<p>The below code should essentially repeat whatever double precision numerical value I pump in. But when I use \"45*45\" as input, for example, it will give me an output of \"Value is 45\", dropping everything after the *. I want it to return it as \"Not a double precision numerical value\". How could I do that? Any help would be appreciated!</p>\n\n<pre><code>#include &lt;iostream&gt;     \n#include &lt;iomanip&gt;   \n#include &lt;cmath&gt;   \n#include &lt;cstdlib&gt;   \n#include &lt;cstring&gt; \n\nusing namespace std; \n\n\nint main() {\n    double number1; //Initialize Numerical Value\n\nstd::cout &lt;&lt; \"Please input a double precision numerical value :\";   \nstd::cin &gt;&gt; number1;\nif (!cin) {\n    cout &lt;&lt; \"Not a double precision numerical value\" &lt;&lt; endl;\n}\nelse if (cin) {\n    cout &lt;&lt; \"Value is: \" &lt;&lt; number1;\n}\nelse {\n    cout &lt;&lt; \"Error\";\n}\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "opencv", "camera-calibration", "levenberg-marquardt"], "comments": [{"owner": {"reputation": 1158, "user_id": 2235356, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rq9Vj.jpg?s=128&g=1", "display_name": "TEH EMPRAH", "link": "https://stackoverflow.com/users/2235356/teh-emprah"}, "edited": false, "score": 0, "creation_date": 1530714890, "post_id": 51175888, "comment_id": 89334904, "body": "Do you have any problem in implementing something, or you want SO to google explanation or code for you? On the same page, explanation for what each cell and row means, is given."}, {"owner": {"reputation": 1, "user_id": 5263462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cc9354a6457c3baad874481c8bcc4b?s=128&d=identicon&r=PG&f=1", "display_name": "d&#246;ne sar\u0131&#231;am", "link": "https://stackoverflow.com/users/5263462/d%c3%b6ne-sar%c4%b1%c3%a7am"}, "reply_to_user": {"reputation": 1158, "user_id": 2235356, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rq9Vj.jpg?s=128&g=1", "display_name": "TEH EMPRAH", "link": "https://stackoverflow.com/users/2235356/teh-emprah"}, "edited": false, "score": 0, "creation_date": 1531139666, "post_id": 51175888, "comment_id": 89469899, "body": "I just wondered how the expression implements on code. And where it be implemented?"}, {"owner": {"reputation": 1, "user_id": 5263462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cc9354a6457c3baad874481c8bcc4b?s=128&d=identicon&r=PG&f=1", "display_name": "d&#246;ne sar\u0131&#231;am", "link": "https://stackoverflow.com/users/5263462/d%c3%b6ne-sar%c4%b1%c3%a7am"}, "reply_to_user": {"reputation": 1158, "user_id": 2235356, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rq9Vj.jpg?s=128&g=1", "display_name": "TEH EMPRAH", "link": "https://stackoverflow.com/users/2235356/teh-emprah"}, "edited": false, "score": 0, "creation_date": 1531140098, "post_id": 51175888, "comment_id": 89470186, "body": "I just wondered how the expression is in each cell implements on code. And where it be implemented in openCV calibration module as a code? And I couldn&#39;t see enough explanation to understand. I know w, a, X, P() and p() means."}], "answers": [{"tags": [], "owner": {"reputation": 341, "user_id": 1352896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qTjD1.jpg?s=128&g=1", "display_name": "Shmuel Fine", "link": "https://stackoverflow.com/users/1352896/shmuel-fine"}, "is_accepted": false, "score": 0, "last_activity_date": 1530790705, "creation_date": 1530790705, "answer_id": 51190392, "question_id": 51175888, "link": "https://stackoverflow.com/questions/51175888/levenberg-marquardt-in-calibration-opencv/51190392#51190392", "title": "Levenberg Marquardt in calibration opencv", "body": "<p>Levenberg Marquardt is a classical algorithm for non-linear optimization. OpenCV indeed uses it for camera calibration. One should understand the algorithm in general before diving into its usage in OpenCV.\nSpecifically, the matrix that you've pointed out is the Jacobian, a generalization of one dimensional derivative to multidimensional function.</p>\n"}], "owner": {"reputation": 1, "user_id": 5263462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cc9354a6457c3baad874481c8bcc4b?s=128&d=identicon&r=PG&f=1", "display_name": "d&#246;ne sar\u0131&#231;am", "link": "https://stackoverflow.com/users/5263462/d%c3%b6ne-sar%c4%b1%c3%a7am"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 797, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530790705, "creation_date": 1530714112, "question_id": 51175888, "link": "https://stackoverflow.com/questions/51175888/levenberg-marquardt-in-calibration-opencv", "title": "Levenberg Marquardt in calibration opencv", "body": "<p>I tried to understand Levenberg-Marquardt algorithm implementation in OpenCv Camera Calibration.\nIn W.Burger's paper-> <a href=\"http://staff.fh-hagenberg.at/burger/publications/reports/2016Calibration/Burger-CameraCalibration-20160516.pdf\" rel=\"nofollow noreferrer\">here</a> </p>\n\n<p>I saw <a href=\"https://i.stack.imgur.com/xCcet.jpg\" rel=\"nofollow noreferrer\">this</a> Matrix in page 24.</p>\n\n<p>So what does    theoretically mean of this matrix' each cell?</p>\n\n<p>And how it implemented in openCv code.</p>\n"}, {"tags": ["c++", "point-cloud-library", "lidar"], "comments": [{"owner": {"reputation": 1684, "user_id": 4669135, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d9d4ff76c8827f4adfc6218ba952aefc?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Devillers", "link": "https://stackoverflow.com/users/4669135/gabriel-devillers"}, "edited": false, "score": 0, "creation_date": 1530739199, "post_id": 51175775, "comment_id": 89344138, "body": "Could you add a link to reference the &quot;GPS mouse&quot; that you are mentioning ?"}, {"owner": {"reputation": 41, "user_id": 9606476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WJUKf0hAjGI/AAAAAAAAAAI/AAAAAAAAAyA/i28Q8t3kdyA/photo.jpg?sz=128", "display_name": "Lakshman ram", "link": "https://stackoverflow.com/users/9606476/lakshman-ram"}, "reply_to_user": {"reputation": 1684, "user_id": 4669135, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d9d4ff76c8827f4adfc6218ba952aefc?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Devillers", "link": "https://stackoverflow.com/users/4669135/gabriel-devillers"}, "edited": false, "score": 0, "creation_date": 1530769407, "post_id": 51175775, "comment_id": 89349888, "body": "<a href=\"https://buy.garmin.com/en-US/US/p/27594\" rel=\"nofollow noreferrer\">buy.garmin.com/en-US/US/p/27594</a> The garmin mouse that comes with the stock Velodyne sensor"}], "answers": [{"tags": [], "owner": {"reputation": 1684, "user_id": 4669135, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d9d4ff76c8827f4adfc6218ba952aefc?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Devillers", "link": "https://stackoverflow.com/users/4669135/gabriel-devillers"}, "is_accepted": false, "score": 2, "last_activity_date": 1530793809, "creation_date": 1530793809, "answer_id": 51191366, "question_id": 51175775, "link": "https://stackoverflow.com/questions/51175775/imu-data-with-velodyne-in-pcl/51191366#51191366", "title": "IMU Data with Velodyne in PCL", "body": "<p>I guess you are speaking about the IMU that is embedded in the Velodyne 32E (<a href=\"https://answers.ros.org/question/94421/how-to-interpret-the-accelerator-raw-data-in-hdl-32e/\" rel=\"nofollow noreferrer\">yes there is one inside!</a>). So I do not think that having access to a GPS module will affect that (of course you could use the IMU data and the GPS data together but that is another story).</p>\n\n<p>Then I am sorry but, <a href=\"http://unanancyowen.com/en/pcl-with-velodyne/#comment-1994\" rel=\"nofollow noreferrer\">no</a>, you cannot use <a href=\"http://docs.pointclouds.org/1.8.1/classpcl_1_1_h_d_l_grabber.html\" rel=\"nofollow noreferrer\">HDLGrabber</a> from PCL to read the HDL-32E IMU.</p>\n\n<p>It is also <a href=\"https://github.com/ros-drivers/velodyne/issues/24\" rel=\"nofollow noreferrer\">not currently implemented</a> in ROS.</p>\n\n<p>Maybe have a look at <a href=\"https://github.com/Kitware/VeloView\" rel=\"nofollow noreferrer\">Veloview</a> which is an open-source software developed by Kitware for Velodyne. At <a href=\"https://github.com/Kitware/VeloView/blob/cbdbe68cede38caf5d5dbf2d14dd9519a51a6024/VelodyneHDL/vtkVelodyneHDLPositionReader.cxx#L150\" rel=\"nofollow noreferrer\">this line</a> in <code>vtkVelodyneHDLPositionReader.cxx</code> you can see that the gyroscopic information is extracted from a data packet. There is also mention of acceleration data.\nYou can also access this data using Veloview directly (tested using the <a href=\"https://www.paraview.org/veloview/\" rel=\"nofollow noreferrer\">compiled package</a> and sample file <a href=\"http://velodynelidar.com/downloads.html\" rel=\"nofollow noreferrer\">from Velodyne</a>): Open the .pcap file, chose \"HDL-32\" when the \"Sensor Configuration\" window opens, then open the spreadsheet with \"Tools\" > \"Spreadsheet\", then set \"Showing\" to \"Position\".</p>\n\n<p><em>Disclamer: I am doing my internship at Kitware</em></p>\n\n<p>Beware though that this data is \"raw\" and you may have some processing to do before using it as if it was coming from any commercial IMU. If that proves difficult you should consider investing in a consumer grade (10$) or industry grade IMU (1000$).</p>\n\n<p><a href=\"https://i.stack.imgur.com/kGLo0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kGLo0.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 41, "user_id": 9606476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WJUKf0hAjGI/AAAAAAAAAAI/AAAAAAAAAyA/i28Q8t3kdyA/photo.jpg?sz=128", "display_name": "Lakshman ram", "link": "https://stackoverflow.com/users/9606476/lakshman-ram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1532525707, "creation_date": 1530713716, "last_edit_date": 1532525707, "question_id": 51175775, "link": "https://stackoverflow.com/questions/51175775/imu-data-with-velodyne-in-pcl", "title": "IMU Data with Velodyne in PCL", "body": "<p>I am using the Velodyne <code>HDL-32E</code> with the Velodyne grabber with GPS mouse connected to the sensor. Is there any way I can access the <code>IMU</code> data from the grabber or should I implement it myself?</p>\n\n<p>Please share your experience.</p>\n"}, {"tags": ["c++", "c++11", "memory", "memory-management", "bad-alloc"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 4, "creation_date": 1530713496, "post_id": 51175664, "comment_id": 89334090, "body": "Are you sure that your OS allows you to allocate 47 billion elements <i>contiguously</i>? And even if the OS allows it, are you sure that the memory has that much free space in a single place? (The exception would indicate the answer is <b>no</b>)"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 9, "creation_date": 1530713559, "post_id": 51175664, "comment_id": 89334122, "body": "You need <code>sizeof(std::tuple&lt;long unsigned int, long unsigned int&gt;)</code> multiplied by 47 billion bytes of <i>contiguous</i> memory available. On a 64-bit machine (with 64-bit <code>long</code>) that&#39;s well over 750 GiB of memory as one single available chunk."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 5, "creation_date": 1530713560, "post_id": 51175664, "comment_id": 89334124, "body": "By my back of the napkin calculation, you&#39;ll need about 800 GB of RAM in your machine."}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 1, "creation_date": 1530713595, "post_id": 51175664, "comment_id": 89334146, "body": "Platform/Compiler? On Linux that would required more memory than on Windows"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1530713689, "post_id": 51175664, "comment_id": 89334196, "body": "All in all, you probably need to rethink your algorithm and your need to have all the elements in memory at the same time."}, {"owner": {"reputation": 552, "user_id": 3469484, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hVilu.jpg?s=128&g=1", "display_name": "gioaudino", "link": "https://stackoverflow.com/users/3469484/gioaudino"}, "edited": false, "score": 0, "creation_date": 1530713889, "post_id": 51175664, "comment_id": 89334304, "body": "You are all so right. Thing is I&#39;m building this huge thing cause it&#39;s a parameter for a function of a legacy library. The machine I&#39;m using runs Fedora 27. At first I tried to call <code>push_back</code> on the vector adding a single element at a time but got the same result (in 2hrs instead of straight away though, of course)"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1530714128, "post_id": 51175664, "comment_id": 89334424, "body": "Does your Fedora 27 run on a machine with at least one terabyte of RAM? If your answer to this question is &quot;no&quot;, then you can&#39;t use a vector. Forget it. It&#39;s not going to work. It&#39;s a waste of time. You&#39;ll need to figure out some other way, that does not use vectors, to do whatever you need to be done. Unless you have a terabyte of RAM in your machine, you can&#39;t use vectors, you can&#39;t use any container, pretty much."}, {"owner": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1530714258, "post_id": 51175664, "comment_id": 89334505, "body": "what @Eljay said, if <code>long int</code> is 32 bit and no alignment bytes are wasted the vector you are trying to allocate is 380gb, so memory IS an issue even in your case where you have only 250 mb of RAM (and if you are on linux 64bit ABI, <code>unsigned long int</code> is double that size)"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1530714441, "post_id": 51175664, "comment_id": 89334623, "body": "@gioaudino If your legacy library API requires an array of nearly a hundred billion elements, then I suspect the most likely scenario is you misunderstand how that library is supposed to be used. The fact that you are building a vector of <code>std::tuple</code> as a parameter for an old library is also suspicious."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1530722874, "post_id": 51175664, "comment_id": 89338745, "body": "Do you <b>need</b> all the data in memory <i>at once</i>?  Can you process the data in blocks or chunks?"}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1530713722, "post_id": 51175763, "comment_id": 89334218, "body": "What about <code>std::deque</code>?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1530713768, "post_id": 51175763, "comment_id": 89334241, "body": "@Fran&#231;oisAndrieux: I&#39;d worry about the element access times."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1530713819, "post_id": 51175763, "comment_id": 89334269, "body": "Element access complexity is constant for <code>std::deque</code>. A linked-list based solution would likely have access time problems though."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1530713861, "post_id": 51175763, "comment_id": 89334293, "body": "@Fran&#231;oisAndrieux: Thinking some more on this, a std::vector of (not necessarily bare) pointers would be a good starting point."}, {"owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 5, "creation_date": 1530713982, "post_id": 51175763, "comment_id": 89334352, "body": "i don&#39;t think continuous memory is an issue because the you will never allocate 750G in one page. the OS will probably have to split into multiple pages so the address would be continuous in virtual address space but not in real address space"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 0, "creation_date": 1530714039, "post_id": 51175763, "comment_id": 89334388, "body": "@Tyker: On that point we&#39;ll have to agree to disagree. I&#39;m careful enough to point out that you&#39;ll still get a problem with most operating systems, even with virtualisation. Fortunately that point is trivial to verify."}, {"owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 0, "creation_date": 1530714359, "post_id": 51175763, "comment_id": 89334571, "body": "@Bathsheba probably depends on how much RAM is Available and the page size used by the OS"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 2438, "user_id": 6517320, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/5AiJr.jpg?s=128&g=1", "display_name": "Ivan Rubinson", "link": "https://stackoverflow.com/users/6517320/ivan-rubinson"}, "edited": false, "score": 0, "creation_date": 1530714686, "post_id": 51175763, "comment_id": 89334784, "body": "@IvanRubinson: Yes, that looks promising on a cursory glance. I don&#39;t think Boost has something, but worth checking there too."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 2, "creation_date": 1530728629, "post_id": 51175763, "comment_id": 89340854, "body": "Why do you think that contiguous memory is the problem? On a 64-bit machine, the address space is very-very huge. Even if the OS doesn&#39;t use the whole 64-bit, like the usual 48-bit address space is more than enough."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1530730018, "post_id": 51175763, "comment_id": 89341409, "body": "@geza: Well the OP <i>observes</i> a problem which is pretty trivial to replicate. Reality is good enough for me."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 1, "creation_date": 1530732944, "post_id": 51175763, "comment_id": 89342254, "body": "Sorry, I don&#39;t understand what you mean by &quot;Reality is good enough for me.&quot;. OP doesn&#39;t have the adequate amount of memory, so the OS refuses the allocation. Continuity doesn&#39;t matter here in my opinion. As I&#39;ve said, a 48-bit address space is easily enough to hold a 1TB buffer."}, {"owner": {"reputation": 1103, "user_id": 3847255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5ae0e1317d8f367da0af2a68990222?s=128&d=identicon&r=PG&f=1", "display_name": "pooya13", "link": "https://stackoverflow.com/users/3847255/pooya13"}, "edited": false, "score": 0, "creation_date": 1565225961, "post_id": 51175763, "comment_id": 101289321, "body": "Could you clarify whether you have any reason other than the OPs question for your claim that it is required for the memory to be contiguous? If you are basing this on the question it would be better to clarify that as a guess in your answer. Your wording suggests that you are presenting it as a priori knowledge: &quot;you require that memory to be contiguous. Even with memory virtualisation, that&#39;s unlikely&quot;"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1530713800, "last_edit_date": 1530713800, "creation_date": 1530713668, "answer_id": 51175763, "question_id": 51175664, "link": "https://stackoverflow.com/questions/51175664/c-creating-huge-vector/51175763#51175763", "title": "C++ creating huge vector", "body": "<p>You may well have a machine with a lot of memory but the problem is that you require that memory to be <em>contiguous</em>. </p>\n\n<p>Even with memory virtualisation, that's unlikely.</p>\n\n<p>For that amount of data, you'll need to use a different storage container. You could roll your own based on a linked list of vectors that subdivide the data, a vector of pointers to subdivided vectors of your tuples, or find a library that has such a construction already built.</p>\n"}, {"comments": [{"owner": {"reputation": 755, "user_id": 5295802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b667253d9b84a8154a93254e7050c72?s=128&d=identicon&r=PG&f=1", "display_name": "Sander", "link": "https://stackoverflow.com/users/5295802/sander"}, "edited": false, "score": 0, "creation_date": 1530716369, "post_id": 51176088, "comment_id": 89335689, "body": "Nice solution, but it will likely be very slow... And depending on what the program does it might just become a simple copy of data that is already on disk. In that case it might be a better solution to modify the individual values directly in the input file."}, {"owner": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "reply_to_user": {"reputation": 755, "user_id": 5295802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b667253d9b84a8154a93254e7050c72?s=128&d=identicon&r=PG&f=1", "display_name": "Sander", "link": "https://stackoverflow.com/users/5295802/sander"}, "edited": false, "score": 2, "creation_date": 1530716974, "post_id": 51176088, "comment_id": 89336016, "body": "@Sander whether it will be slow or not depends solely on what the algorithm does. Note that since you have a working set bigger than your main memory you need to have some disk access anyway. If your algorithm can be executed in a streaming fashion, or some other predictable memory access pattern, you might get better results by explicitly implementing that, but in most cases you&#39;ll end up implementing a poor caching mechanism of a disk data structure, which the operating system probably can make better: memory mapping is pretty fast compared to stream io"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1530730845, "post_id": 51176088, "comment_id": 89341663, "body": "Or just add the necessary amount of swap, can be tried very easily."}], "tags": [], "owner": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "is_accepted": false, "score": 11, "last_activity_date": 1530715673, "last_edit_date": 1530715673, "creation_date": 1530714819, "answer_id": 51176088, "question_id": 51175664, "link": "https://stackoverflow.com/questions/51175664/c-creating-huge-vector/51176088#51176088", "title": "C++ creating huge vector", "body": "<p>47 billion tuples times 16 bytes each tuple is 780 billion bytes, which is about 760 gb. Your machine has less than 1/3 of the memory required for that, so you really need another approach, regardless of the reason your program crashes.</p>\n\n<p>A proposal I can give you is to use a memory mapped file of 1TB to store that array, and if you really need to use a vector as interface you might write a custom allocator for it that uses the mapped memory. That should sort out your lack of main memory in a quasi-transparent way. If your interface requires a standard vector, with standard allocators, you are better re-designing that.</p>\n\n<p>Another point to add, check what value you have for <code>ulimit</code> for the user running the process, because it might have a more strict limit of virtual memory than 760 gb.</p>\n"}], "owner": {"reputation": 552, "user_id": 3469484, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hVilu.jpg?s=128&g=1", "display_name": "gioaudino", "link": "https://stackoverflow.com/users/3469484/gioaudino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1825, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1575500627, "creation_date": 1530713359, "question_id": 51175664, "link": "https://stackoverflow.com/questions/51175664/c-creating-huge-vector", "title": "C++ creating huge vector", "body": "<p>For a process I'm trying to run I need to have a <code>std::vector</code> of <code>std::tuple&lt;long unsigned int, long unsigned int&gt;</code>. The test I'm doing right now should create a vector of 47,614,527,250 (around 47 billion) tuples but actually crashes right there on creation with the error <code>terminate called after throwing an instance of 'std::bad_alloc'</code>. My goal is to use this script with a vector roughly twice that size. The code is this:</p>\n\n<pre><code>arc_vector = std::vector&lt;std::tuple&lt;long unsigned int, long unsigned int&gt;&gt;(arcs);\n</code></pre>\n\n<p>where <code>arcs</code> is a <code>long unsigned int</code> with the cited value.</p>\n\n<p>Can I, and in that case how do I, increase the memory size? This script is running on a 40-core machine with something like 200GB of memory so I know memory itself is not an issue. </p>\n"}, {"tags": ["c#", "c++", "windows", "cursor", "mouse"], "comments": [{"owner": {"reputation": 1152, "user_id": 4078718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7090024e46e43bf86eace985087357e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/4078718/ian"}, "edited": false, "score": 0, "creation_date": 1530714131, "post_id": 51175641, "comment_id": 89334426, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1179197/block-nullify-mouse-movement-click-in-c-sharp\" title=\"block nullify mouse movement click in c sharp\">stackoverflow.com/questions/1179197/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 6453170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f78b5407df575177822f95574e99e797?s=128&d=identicon&r=PG&f=1", "display_name": "Sim&#227;o Ferreira", "link": "https://stackoverflow.com/users/6453170/sim%c3%a3o-ferreira"}, "edited": false, "score": 0, "creation_date": 1530723621, "post_id": 51177754, "comment_id": 89339059, "body": "Thank you, but that methods only will disable the cursor on application window. I want to disable/hide the mouse without an application opened. For example, I want to have a method in a dll to show/hide or enable/disable mouse."}, {"owner": {"reputation": 1816, "user_id": 9684373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81c00dae403a944000836295b99f1151?s=128&d=identicon&r=PG&f=1", "display_name": "Prany", "link": "https://stackoverflow.com/users/9684373/prany"}, "reply_to_user": {"reputation": 149, "user_id": 6453170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f78b5407df575177822f95574e99e797?s=128&d=identicon&r=PG&f=1", "display_name": "Sim&#227;o Ferreira", "link": "https://stackoverflow.com/users/6453170/sim%c3%a3o-ferreira"}, "edited": false, "score": 0, "creation_date": 1530725333, "post_id": 51177754, "comment_id": 89339741, "body": "Oh I see. Then this wiill help - <a href=\"https://www.sevenforums.com/customization/183676-hide-mouse-pointer-bootup.html\" rel=\"nofollow noreferrer\">sevenforums.com/customization/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1816, "user_id": 9684373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81c00dae403a944000836295b99f1151?s=128&d=identicon&r=PG&f=1", "display_name": "Prany", "link": "https://stackoverflow.com/users/9684373/prany"}, "is_accepted": false, "score": 0, "last_activity_date": 1530721233, "creation_date": 1530721233, "answer_id": 51177754, "question_id": 51175641, "link": "https://stackoverflow.com/questions/51175641/disable-mouse-cursor-windows-7-10/51177754#51177754", "title": "Disable Mouse Cursor (Windows 7/10)", "body": "<p>According to MSDN, there is <code>Cursor.Hide()</code> <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.cursor.hide(v=vs.110).aspx?cs-save-lang=1&amp;cs-lang=csharp#code-snippet-2\" rel=\"nofollow noreferrer\">method</a> in c#.</p>\n\n<p>If you use WPF application, then you have to set the cursor property to <code>Cursor = Cursors.None;</code></p>\n"}], "owner": {"reputation": 149, "user_id": 6453170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f78b5407df575177822f95574e99e797?s=128&d=identicon&r=PG&f=1", "display_name": "Sim&#227;o Ferreira", "link": "https://stackoverflow.com/users/6453170/sim%c3%a3o-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 363, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530721233, "creation_date": 1530713263, "question_id": 51175641, "link": "https://stackoverflow.com/questions/51175641/disable-mouse-cursor-windows-7-10", "title": "Disable Mouse Cursor (Windows 7/10)", "body": "<p>I have a touch screen and I want to disable or hide the mouse cursor for all windows screens and not only for my application screen.</p>\n\n<p>How can I do it programmatically with C/C++ or C#? or with command line?</p>\n"}, {"tags": ["c++", "boost", "template-meta-programming", "boost-msm"], "answers": [{"tags": [], "owner": {"reputation": 2569, "user_id": 1922763, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75228956a9f2a90a98b473672b91d807?s=128&d=identicon&r=PG", "display_name": "Takatoshi Kondo", "link": "https://stackoverflow.com/users/1922763/takatoshi-kondo"}, "is_accepted": true, "score": 1, "last_activity_date": 1530793585, "creation_date": 1530793585, "answer_id": 51191297, "question_id": 51175109, "link": "https://stackoverflow.com/questions/51175109/how-to-exit-a-submachine-in-a-hierarchial-sm-that-is-split-into-multiple-files/51191297#51191297", "title": "How to exit a submachine in a hierarchial-SM that is split into multiple files? (using boost::MSM)", "body": "<p>You need to define <code>msm::back::state_machine</code> at <strong>outside</strong> of the <code>msmf::state_machine_def</code>.</p>\n\n<p>Here is the updated version of your example:</p>\n\n<p><a href=\"https://wandbox.org/permlink/DktAL169yjFNnmfl\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/DktAL169yjFNnmfl</a></p>\n\n<p>There are four updated points.</p>\n\n<p>In <code>state2.h</code> (1)</p>\n\n<pre><code>// 1. move msm::back::state_machine to fsm\n// typedef msm::back::state_machine&lt;State2_&gt; State2;\n</code></pre>\n\n<p>In <code>myfsm.h</code> (2, 3, 4)</p>\n\n<pre><code>struct State2m : State2_ {}; // 2. replaced State2 to State2_\ntypedef msm::back::state_machine&lt;State2m&gt; State2mm; // 3. define backend here\n\n\n// Transition table\nstruct transition_table:mpl::vector&lt;\n     // 4. updated transition table using State2mm\n     msmf::Row &lt; State1, Event1, State2mm, msmf::none, msmf::none &gt;,\n     msmf::Row &lt; State2mm, Event2, State1, msmf::none, msmf::none &gt;,\n     msmf::Row &lt; State2mm::exit_pt\n                 &lt;State2mm::Exit2&gt;, msmf::none, State1, msmf::none, msmf::none &gt;\n&gt;{};\n</code></pre>\n\n<p>In this case, you can do more elegant way. You can remove <code>struct State2m : State2_ {};</code> inheritance.</p>\n\n<p>Here is the code:</p>\n\n<p><a href=\"https://wandbox.org/permlink/FO7lEELLtLhiismu\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/FO7lEELLtLhiismu</a></p>\n\n<p>You can define <code>State2</code> as follows and use <code>State2</code> in the transition table.</p>\n\n<pre><code>typedef msm::back::state_machine&lt;State2_&gt; State2;\n\n// Transition table\nstruct transition_table:mpl::vector&lt;\n      msmf::Row &lt; State1, Event1, State2, msmf::none, msmf::none &gt;,\n      msmf::Row &lt; State2, Event2, State1, msmf::none, msmf::none &gt;,\n      msmf::Row &lt; State2::exit_pt\n                  &lt;State2::Exit2&gt;, msmf::none, State1, msmf::none, msmf::none &gt;\n&gt;{};\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6818466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac691b317a7d97b13ec48b187bcd135?s=128&d=identicon&r=PG&f=1", "display_name": "qwa", "link": "https://stackoverflow.com/users/6818466/qwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 51191297, "answer_count": 1, "score": 0, "last_activity_date": 1530793585, "creation_date": 1530711628, "last_edit_date": 1530711932, "question_id": 51175109, "link": "https://stackoverflow.com/questions/51175109/how-to-exit-a-submachine-in-a-hierarchial-sm-that-is-split-into-multiple-files", "title": "How to exit a submachine in a hierarchial-SM that is split into multiple files? (using boost::MSM)", "body": "<p>There is a good tutorial that explains how we can use the \"exit-pseudo-state\" to exit from a submachine using <code>boost::MSM</code>, <a href=\"http://redboltz.wikidot.com/exit-point-pseudo-state\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>But I need to split my SM into multiple files, to keep it manageable, and here is where the problem arises.</p>\n\n<p>When the sub-SM is defined in the main fsm file, everything works fine, i.e. exiting from the \"exit-pseudo-state\" results in a an exit from the sub-SM into the next state(<a href=\"https://wandbox.org/permlink/1KFCiGKV7du6ieBw\" rel=\"nofollow noreferrer\">sample code</a>)</p>\n\n<p>Implementing the sub-SM in a separate file, where I have to make an extra level of dummy inheritance, causes problems. \nThis time the transition to the exit-pseudo-state in the internal sub-SM does not trigger an exit to the the next state in the parent-SM. <a href=\"https://wandbox.org/permlink/kDJ4xiUI9MuqA5TL\" rel=\"nofollow noreferrer\">Here</a> is a sample code showing the problem.</p>\n\n<p>As you can see from the output below, <code>State2::on_exit()</code> is missing at the end after exiting substate21</p>\n\n<pre><code>Testing boost::msm ...\nState1::on_entry()\nState1::on_exit()\nState2::on_entry()\nSubState21::on_entry()\nSubState21::on_exit()\n</code></pre>\n\n<p>Thanks for your help in advance</p>\n\n<p>Code included:</p>\n\n<p>main file:</p>\n\n<pre><code>#include \"myfsm.h\"\n\nint main()\n{    \n    std::cout &lt;&lt; \"Testing boost::msm ...\" &lt;&lt; std::endl;\n    MyFsm fsm;\n    fsm.start();\n\n    fsm.process_event(Event1());\n    fsm.process_event(Event3());\n    //fsm.process_event(Event2());\n}\n</code></pre>\n\n<p>main fsm:</p>\n\n<pre><code>#include &lt;boost/msm/back/state_machine.hpp&gt;\n#include &lt;boost/msm/front/state_machine_def.hpp&gt;\n#include &lt;boost/msm/front/functor_row.hpp&gt;\n\n#include \"state2.h\"\n#include \"events.h\"\n\nnamespace msm = boost::msm;\nnamespace msmf = boost::msm::front;\nnamespace mpl = boost::mpl;\n\nstruct MyFsm_ : msmf::state_machine_def&lt;MyFsm_&gt;\n{\n    struct State1 : msmf::state&lt;&gt;{\n        template&lt;class Event, class Fsm&gt; void on_entry(const Event&amp;, Fsm&amp;) const {std::cout &lt;&lt; \"State1::on_entry()\" &lt;&lt; std::endl;}\n        template&lt;class Event, class Fsm&gt; void on_exit(const Event&amp;, Fsm&amp;) const {std::cout &lt;&lt; \"State1::on_exit()\" &lt;&lt; std::endl;}\n    };    \n\n    struct State2m : State2 {};\n\n   // Set initial state\n   typedef State1 initial_state;\n\n   // Transition table\n   struct transition_table:mpl::vector&lt;\n         msmf::Row &lt; State1, Event1, State2m, msmf::none, msmf::none &gt;,\n         msmf::Row &lt; State2m, Event2, State1, msmf::none, msmf::none &gt;,\n         msmf::Row &lt; State2::exit_pt\n                     &lt;State2_::Exit2&gt;, msmf::none, State1, msmf::none, msmf::none &gt;\n   &gt;{};\n\n  template&lt;class Event, class Fsm&gt;\n   void no_transition(Event const&amp;, Fsm&amp;, int state){\n       std::cout&lt;&lt;\"no_transiton detected from state: \"&lt;&lt; state &lt;&lt; std::endl;\n   }\n\n};\n// Pick a back-end\ntypedef msm::back::state_machine&lt;MyFsm_&gt; MyFsm;    \n</code></pre>\n\n<p>sub-SM i.e. state2.h:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;boost/msm/back/state_machine.hpp&gt;\n#include &lt;boost/msm/front/state_machine_def.hpp&gt;\n#include &lt;boost/msm/front/functor_row.hpp&gt;\n#include \"events.h\"\n\nnamespace msm = boost::msm;\nnamespace msmf = boost::msm::front;\nnamespace mpl = boost::mpl;\n\n\nstruct State2_ : msmf::state_machine_def&lt;State2_&gt;{\n        template&lt;class Event, class Fsm&gt; void on_entry(const Event&amp;, Fsm&amp;) const {std::cout &lt;&lt; \"State2::on_entry()\" &lt;&lt; std::endl;}\n        template&lt;class Event, class Fsm&gt; void on_exit(const Event&amp;, Fsm&amp;) const {std::cout &lt;&lt; \"State2::on_exit()\" &lt;&lt; std::endl;}\n\n        struct SubState21 : msmf::state&lt;&gt;{\n            template&lt;class Event, class Fsm&gt; void on_entry(const Event&amp;, Fsm&amp;) const {std::cout &lt;&lt; \"SubState21::on_entry()\" &lt;&lt;std::endl;}\n            template&lt;class Event, class Fsm&gt; void on_exit(const Event&amp;, Fsm&amp;) const {std::cout &lt;&lt; \"SubState21::on_exit()\" &lt;&lt; std::endl;}\n        };\n        typedef mpl::vector&lt;SubState21&gt; initial_state;\n        struct Exit2 : msmf::exit_pseudo_state&lt;msmf::none&gt; {};\n\n        struct transition_table:mpl::vector&lt;\n            msmf::Row &lt; SubState21, Event3, Exit2, msmf::none, msmf::none &gt;\n           &gt;{};\n\n    };\n    typedef msm::back::state_machine&lt;State2_&gt; State2;\n</code></pre>\n"}, {"tags": ["c++", "image", "qt", "image-processing", "raw-data"], "comments": [{"owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "edited": false, "score": 0, "creation_date": 1530742877, "post_id": 51175108, "comment_id": 89345079, "body": "I&#39;m pretty sure that Qt can&#39;t do 12 bit greyscale. You&#39;ll have to process it down to 8 bits first, then use Format_Grayscale8 in the call to create the image. Format_Mono will definitely not work, it&#39;s for 1 bit images."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1531076827, "post_id": 51175108, "comment_id": 89449276, "body": "Do you know if it is packed 12-bit or 12 significant bits stored in 16-bit ints?"}, {"owner": {"reputation": 1756, "user_id": 5233188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OS2a7.png?s=128&g=1", "display_name": "goulashsoup", "link": "https://stackoverflow.com/users/5233188/goulashsoup"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1531080374, "post_id": 51175108, "comment_id": 89450127, "body": "@CrisLuengo Thanks for that question, have not thought about it... The 12 bit are stored within 16 bits."}], "answers": [{"tags": [], "owner": {"reputation": 1756, "user_id": 5233188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OS2a7.png?s=128&g=1", "display_name": "goulashsoup", "link": "https://stackoverflow.com/users/5233188/goulashsoup"}, "is_accepted": true, "score": 1, "last_activity_date": 1532079211, "creation_date": 1532079211, "answer_id": 51439525, "question_id": 51175108, "link": "https://stackoverflow.com/questions/51175108/qt-transform-void-pointer-raw-data-to-qimage-and-display-it-on-label/51439525#51439525", "title": "Qt - Transform void pointer (raw data) to QImage and display it on label", "body": "<p>Here is a working solution:</p>\n\n<pre><code>cv::Mat openCvImage(1024, 1280, CV_16UC1, imageInfos.pDatas);\nopenCvImage.convertTo(openCvImage, CV_8UC1, 0.04);\nQImage qImage = QImage(\n    openCvImage.data,\n    1280,\n    1024,\n    QImage::Format_Grayscale8\n);\nimageLabel.setPixmap(QPixmap::fromImage(img));\nif(!imageLabel.isVisible()) {\n    imageLabel.show();\n}\n</code></pre>\n"}], "owner": {"reputation": 1756, "user_id": 5233188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OS2a7.png?s=128&g=1", "display_name": "goulashsoup", "link": "https://stackoverflow.com/users/5233188/goulashsoup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 1, "accepted_answer_id": 51439525, "answer_count": 1, "score": 1, "last_activity_date": 1532079211, "creation_date": 1530711622, "last_edit_date": 1531072662, "question_id": 51175108, "link": "https://stackoverflow.com/questions/51175108/qt-transform-void-pointer-raw-data-to-qimage-and-display-it-on-label", "title": "Qt - Transform void pointer (raw data) to QImage and display it on label", "body": "<p>I access a camera via USB using a library from the manufacturer. I receive the information about an image via a struct:</p>\n\n<pre><code>typedef struct\n{\n    /*! Buffer handle which contains new data. */\n    BUFF_HANDLE hBuffer;    \n\n    /* Pointer to the beginning of the image datas (including MetaDatas(1024 bytes) if any) */\n    void * pDatas; \n\n    /*! Total Buffer Payload size in bytes (including image, MetaDatas(1024 bytes) and additional bytes required by USB3 protocol */\n    size_t iImageSize;\n\n    /*! Width of the image (not including metadata) */\n    size_t iImageWidth;\n\n    /*! Height of the image */\n    size_t iImageHeight;\n\n    /*! Pixel Type */\n    tImagePixelType eImagePixelType;\n\n    /*! Line Pitch: corresponds to the number of bytes between two consecutive lines\n      \\note if MetaDatas are not activated, Line Pitch is equal to iImageWidth*eImagePixelType\n      \\note else MetaDatas are located immediately after the number of bytes corresponding to iImageWidth*eImagePixelType\n    */\n    size_t iLinePitch;\n\n    /*! Buffer BlockId */\n    unsigned long long iBlockId;\n\n    ...\n\n} tImageInfos;\n</code></pre>\n\n<p>All information i have about the image come from <code>tImageInfos</code> struct comments so there are now additional information elsewhere. I know from the <code>tImagePixelType</code> that the <em>image pixel type</em> is <code>12 bit: Mono12</code>:</p>\n\n<pre><code>/*! Image Pixel Type */\ntypedef enum\n{\n    ...\n    /*! Pixel Type 12 bit: Mono12 */\n    eMono12   = 3\n} tImagePixelType;\n</code></pre>\n\n<p>My goal is to display the image on a <code>QLabel</code> but first i have to use the raw data (<code>pData</code>) and turn it into an image.</p>\n\n<p>With my current approach i just get displayed stripes maybe due wrong processing of the raw data. The procedure happens in a member function of a <code>QMainWindow</code> class:</p>\n\n<pre><code>void TragVisMain::setImageAndShowPicture(QString message, tImageInfos imageInfos)\n{\n    // Some message\n    addMessageLineToLogOutput(message);\n\n    // Create image from raw data\n    QImage *img = new QImage(\n                (uchar *) imageInfos.pDatas, \n                static_cast&lt;int&gt;(imageInfos.iImageWidth), \n                static_cast&lt;int&gt;(imageInfos.iImageHeight), \n                QImage::Format_Mono\n    );\n\n    ui-&gt;logOutput-&gt;appendPlainText(\n        QString(\"image infos: [ height: %1, width: %2, iLinePitch: %3, adress: %4 ]\")\n        .arg(\n                    // image height\n                    QString::number(img-&gt;height()),\n\n                    // output width\n                    QString::number(img-&gt;width()),\n\n                    // iLinePitch\n                    QString::number(imageInfos.iLinePitch),\n\n                    // address of pData\n                    QString(\"0x%1\").arg((quintptr)imageInfos.pDatas, QT_POINTER_SIZE * 2, 16, QChar('0'))\n        )\n    );\n\n\n    this-&gt;iv.setImageFromQImage(*img);\n    this-&gt;iv.show();\n\n    // pixel type is 3 =&gt; 12 bit: Mono12\n    ui-&gt;logOutput-&gt;appendPlainText(QString(\"tImagePixelType: \").append(QString::number(imageInfos.eImagePixelType)));\n}\n</code></pre>\n\n<p><code>setImageFromQImage</code>:</p>\n\n<pre><code>void ImageViewer::setImageFromQImage(QImage image)\n{\n    this-&gt;ui-&gt;imageLabel-&gt;setPixmap(QPixmap::fromImage(image));\n}\n</code></pre>\n\n<p>Here is some output I gathered from an image:</p>\n\n<pre><code>image infos: [ height: 1024, width: 1280, iLinePitch: 2560, adress: 0x00000175da5b3040 ]\ntImagePixelType: 3\n</code></pre>\n\n<p>Do you know how to transform the image data from void pointer correctly?\nThen please, enlighten me...</p>\n"}, {"tags": ["c++", "c++11", "c++14", "language-lawyer", "bit-shift"], "comments": [{"owner": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "edited": false, "score": 3, "creation_date": 1530711976, "post_id": 51175044, "comment_id": 89333107, "body": "Please note that <code>undefined behavior</code> is not the same as <code>implementation-de\ufb01ned result</code>. The former can literally make anything happen, the latter ensures that the result is documented in the compiler/architecture you are using (if it is compliant). As an example, <code>sizeof int</code> is implementation-defined, <code>*nullptr</code> is undefined"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "edited": false, "score": 1, "creation_date": 1530925491, "post_id": 51175044, "comment_id": 89419376, "body": "@pqnet: We all may know what you meant twith the last one, though I really want to point out that <code>*nullptr</code> is ill-formed, while <code>*(int*)nullptr</code> is UB."}], "answers": [{"comments": [{"owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "edited": false, "score": 0, "creation_date": 1530712763, "post_id": 51175303, "comment_id": 89333627, "body": "And the same standard defines that <code>bitset&lt;N&gt; operator&gt;&gt;(size_t pos) const noexcept</code> returns <code>bitset&lt;N&gt;(*this) &gt;&gt;= pos</code> (see <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4296.pdf\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4296.pdf</a>, page 539)."}], "tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": true, "score": 9, "last_activity_date": 1530712654, "last_edit_date": 1530712654, "creation_date": 1530712220, "answer_id": 51175303, "question_id": 51175044, "link": "https://stackoverflow.com/questions/51175044/is-shifting-stdbitsetn-more-than-n-positions-undefined-behavior/51175303#51175303", "title": "Is shifting std::bitset&lt;N&gt; more than N positions undefined behavior?", "body": "<p>The result is defined as 0 by the standard, <a href=\"https://timsong-cpp.github.io/cppwp/n4140/template.bitset#bitset.members-9\" rel=\"noreferrer\">[bitset.members]/9</a>:</p>\n\n<blockquote>\n  <p>bitset&amp; operator>>=(size_t pos) noexcept;</p>\n  \n  <p>9 Effects: Replaces each bit at position I in *this with a value\n  determined as follows:</p>\n  \n  <p>(9.1) If pos >= N - I, the new value is zero;</p>\n  \n  <p>(9.2) If pos &lt; N - I, the new value is the previous value of the bit\n  at position I + pos.</p>\n</blockquote>\n"}], "owner": {"reputation": 1004, "user_id": 1346140, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ddb62abef8adc073e864a497b3f990ed?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/1346140/alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 51175303, "answer_count": 1, "score": 4, "last_activity_date": 1530924509, "creation_date": 1530711412, "last_edit_date": 1530924509, "question_id": 51175044, "link": "https://stackoverflow.com/questions/51175044/is-shifting-stdbitsetn-more-than-n-positions-undefined-behavior", "title": "Is shifting std::bitset&lt;N&gt; more than N positions undefined behavior?", "body": "<p>As discussed in <a href=\"https://stackoverflow.com/questions/18918256/is-right-shift-undefined-behavior-if-the-count-is-larger-than-the-width-of-the-t\">Is right shift undefined behavior if the count is larger than the width of the type?</a>, shifting a value is undefined if the number of bit shifts exceeds the effective operand size.</p>\n\n<p>Thus, in the following, the value of <code>bar</code> is undefined:</p>\n\n<pre><code>uint32_t foo = 123;\nuint32_t bar = (foo &gt;&gt; 33);\n</code></pre>\n\n<p>Are such shift operations well defined for <code>std::bitset</code>? As in:</p>\n\n<pre><code>std::bitset&lt;32&gt; foo(123);\nstd::bitset&lt;32&gt; bar(foo &gt;&gt; 33);\n</code></pre>\n\n<p>And in which official document can I find such information?</p>\n\n<p>The case is not explicitly stated on cppreference (<a href=\"https://en.cppreference.com/w/cpp/utility/bitset/operator_ltltgtgt\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/utility/bitset/operator_ltltgtgt</a>).</p>\n"}, {"tags": ["python", "c++", "vtk", "openmesh"], "comments": [{"owner": {"reputation": 832, "user_id": 3077540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fMo4X.png?s=128&g=1", "display_name": "jsb", "link": "https://stackoverflow.com/users/3077540/jsb"}, "edited": false, "score": 1, "creation_date": 1530887876, "post_id": 51174821, "comment_id": 89406333, "body": "The VTK writer was indeed disabled in OpenMesh. Alex submitted a patch and the writer is now enabled in the new openmesh-python version <a href=\"https://pypi.org/project/openmesh/1.1.1/\" rel=\"nofollow noreferrer\">1.1.1</a>. Note that there&#39;s currently only a writer and no reader."}, {"owner": {"reputation": 185, "user_id": 9517942, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IjxNnup_x7Q/AAAAAAAAAAI/AAAAAAAAAFo/bjTK7XKxEeE/photo.jpg?sz=128", "display_name": "CDuvert", "link": "https://stackoverflow.com/users/9517942/cduvert"}, "reply_to_user": {"reputation": 832, "user_id": 3077540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fMo4X.png?s=128&g=1", "display_name": "jsb", "link": "https://stackoverflow.com/users/3077540/jsb"}, "edited": false, "score": 0, "creation_date": 1531398783, "post_id": 51174821, "comment_id": 89588120, "body": "Thanks, it works just fine. This answers my question."}], "owner": {"reputation": 185, "user_id": 9517942, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IjxNnup_x7Q/AAAAAAAAAAI/AAAAAAAAAFo/bjTK7XKxEeE/photo.jpg?sz=128", "display_name": "CDuvert", "link": "https://stackoverflow.com/users/9517942/cduvert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1530789093, "creation_date": 1530710704, "last_edit_date": 1530789093, "question_id": 51174821, "link": "https://stackoverflow.com/questions/51174821/is-it-possible-to-save-a-mesh-in-a-vtk-file-using-openmesh-with-python-or-c", "title": "Is it possible to save a mesh in a .vtk file using openmesh with python or C++?", "body": "<p>I am working with openmesh in Python (installed with pip) and in C++ (openmesh version 7.0). I must save a mesh under .vtk extension. Openmesh <a href=\"http://www.openmesh.org/media/Documentations/OpenMesh-7.0-Documentation/a03948.html\" rel=\"nofollow noreferrer\">documentation</a> says it is possible, but as far as I have tried, it does not work. Here is my piece of python code : </p>\n\n<pre><code>import openmesh as OM\n\nmesh = OM.TriMesh()\n\n#Add some vertices\nvh0 = mesh.add_vertex([0,0,0])\nvh1 = mesh.add_vertex([0,1,1])\nvh2 = mesh.add_vertex([1,0,1])\nvh3 = mesh.add_vertex([1,1,0])\n\n#Add some faces (we are building a tetrahedron here)\nmesh.add_face(vh0,vh1,vh2)\nmesh.add_face(vh0,vh2,vh3)\nmesh.add_face(vh0,vh3,vh1)\nmesh.add_face(vh1,vh3,vh2)\n\nOM.write_mesh('TEST_MESH.vtk',mesh)\n</code></pre>\n\n<p>It does not write <code>TEST_MESH.vtk</code> in my folder, or anywhere else. When I try with '.ply' or '.om', or any other extension supposedly supported according to openmesh documentation it works just fine. So, I don't get why it does not work, has anybody have any clue? Is '.vtk' extension not supported from openmesh writer after all?</p>\n\n<p><strong>EDIT :</strong> </p>\n\n<p>Exploring further openmesh GitLab I found that the vtk writer was committed in C++ branch <a href=\"https://www.graphics.rwth-aachen.de:9000/OpenMesh/OpenMesh/commit/377bf721acfddcc6ed56b07dc8dad1385def0b0e\" rel=\"nofollow noreferrer\">in 2014</a>, but in a <a href=\"https://www.graphics.rwth-aachen.de:9000/OpenMesh/openmesh-python/commit/5d358812a6ad90bbcf5c74f65edb1fca7624603c#f0327d6d0ac219d8adab85673cc81c02ccdac798\" rel=\"nofollow noreferrer\">recent commit</a> from python-binding branch, some (deleted) info implies vtk writer is not supported.\nI am a bit confused, did they give up vtk writter, with no changelog notification? (In that case, one should update their <a href=\"http://www.openmesh.org/media/Documentations/OpenMesh-7.0-Documentation/a03948.html\" rel=\"nofollow noreferrer\">documentation</a>) </p>\n\n<p>Thanks for helping,</p>\n\n<p>Charles.</p>\n"}, {"tags": ["c++", "r", "boost"], "comments": [{"owner": {"reputation": 2204, "user_id": 8253769, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-i8_au0WQ7fE/AAAAAAAAAAI/AAAAAAAAAag/HlZZLXkkMhc/photo.jpg?sz=128", "display_name": "kluu", "link": "https://stackoverflow.com/users/8253769/kluu"}, "edited": false, "score": 3, "creation_date": 1530711421, "post_id": 51174804, "comment_id": 89332784, "body": "Are you using Rcpp? If yes you can try to include the <code>boost</code> headers by adding <code>LinkingTo: Rcpp, BH</code> to your DESCRIPTION file."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1530715229, "post_id": 51174804, "comment_id": 89335091, "body": "Also add <code>&#47;&#47; [[Rcpp::depends(BH)]]</code> at the beginning."}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1530724730, "post_id": 51174804, "comment_id": 89339504, "body": "@St&#233;phaneLaurent That would be used for a single file together with <code>sourceCpp</code>, not for a package."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1530725823, "post_id": 51174804, "comment_id": 89339939, "body": "@RalfStubner I use that in a package of mine. So this is useless? Ok, I didn&#39;t know."}], "owner": {"reputation": 798, "user_id": 1584253, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/788a85c7d7c1f703d312f06e7b6570fa?s=128&d=identicon&r=PG", "display_name": "user1584253", "link": "https://stackoverflow.com/users/1584253/user1584253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1530767262, "answer_count": 0, "score": 0, "last_activity_date": 1530710659, "creation_date": 1530710659, "question_id": 51174804, "link": "https://stackoverflow.com/questions/51174804/referencing-boost-library-when-create-r-package-for-c-code", "closed_reason": "Duplicate", "title": "Referencing boost library when create R package for C++ code", "body": "<p>I am creating an R package which calls C++ function. The code in C++ reference a boost library. </p>\n\n<pre><code>Rcpp.package.skeleton(\"cpackage\")\nRcpp::compileAttributes()\n</code></pre>\n\n<p>Copied relevant .cpp and .h files in src folder\nI have build the file successfully using</p>\n\n<pre><code>    R CMD build cproject\n\nWhen I install the package it gives me following error:\n\n&gt; R CMD INSTALL cproject_1.0.tar.gz\nIn R CMD INSTALL\n* installing to library 'C:/Users/user1/Documents/R/win-library/3.4'\n* installing *source* package 'cproject' ...\n** libs\n\n*** arch - i386\nc:/Rtools/mingw_32/bin/g++  -I\"C:/PROGRA~1/R/R-34~1.3/include\" -DNDEBUG  -I\"C:/Users/user1/Documents/R/win-library/3.4/Rcpp/include\"        -O2 -Wall  -mtune=generic -c abc.cpp -o abc.o\nIn file included from abc.cpp:1:0:\nEuler.h:6:53: fatal error: boost/math/special_functions/binomial.hpp: No such file or directory\n #include &lt;boost/math/special_functions/binomial.hpp&gt;\n                                                     ^\ncompilation terminated.\nmake: *** [C:/PROGRA~1/R/R-34~1.3/etc/i386/Makeconf:215: abc.o] Error 1\nWarning: running command 'make -f \"C:/PROGRA~1/R/R-34~1.3/etc/i386/Makeconf\" -f \"C:/PROGRA~1/R/R-34~1.3/share/make/winshlib.mk\" SHLIB_LDFLAGS='$(SHLIB_CXXLDFLAGS)' SHLIB_LD='$(SHLIB_CXXLD)' SHLIB=\"cproject.dll\" OBJECTS=\"abc.o abcT.o RcppExports.o rcpp_hello_world.o\"' had status 2\nERROR: compilation failed for package 'cproject'\n* removing 'C:/Users/user1/Documents/R/win-library/3.4/cproject'\n</code></pre>\n\n<p>How can I reference boost library while building the package?</p>\n"}, {"tags": ["c++", "r"], "comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 2, "creation_date": 1530710444, "post_id": 51174670, "comment_id": 89332157, "body": "What error did it give you?"}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1530714348, "post_id": 51174670, "comment_id": 89334564, "body": "When I add <code>library(inline)</code> to your code in order to make <code>cfunction</code> known, I get a different error message. Please show us your real code plus error message."}], "answers": [{"tags": [], "owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "is_accepted": false, "score": 1, "last_activity_date": 1530718787, "last_edit_date": 1530718787, "creation_date": 1530715301, "answer_id": 51176216, "question_id": 51174670, "link": "https://stackoverflow.com/questions/51174670/execute-c-code-in-r/51176216#51176216", "title": "Execute C++ code in R", "body": "<p>If you really want to execute some C++ code, then you can use <code>Rcpp::evalCpp</code>:</p>\n\n<pre><code>Rcpp::evalCpp(\"boost::math::binomial_coefficient&lt;double&gt;(25, 3)\", \n              depends=\"BH\", \n              include=\"#include &lt;boost/math/special_functions/binomial.hpp&gt;\")\n#&gt; [1] 2300\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7616021"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1530718787, "creation_date": 1530710218, "last_edit_date": 1530711441, "question_id": 51174670, "link": "https://stackoverflow.com/questions/51174670/execute-c-code-in-r", "title": "Execute C++ code in R", "body": "<p>I am trying to execute c++ function using boost library in R. I've also installed boost header file package (BH). When I try to execute the code it give me the following error:</p>\n\n<pre><code>src &lt;- '\n  #include &lt;Rcpp.h&gt;\n#include &lt;boost/math/special_functions/binomial.hpp&gt; \nfor (unsigned long i = 0; i &lt; 5; ++i) {     \nboost::math::binomial_coefficient&lt;double&gt;(25, i);\n}'\nsillyExp &lt;- cfunction(signature(), src, convention = \".C\") \n</code></pre>\n\n<p>Where I am going wrong?</p>\n\n<p>Edit: Following is the error</p>\n\n<pre><code>Error in compileCode(f, code, language, verbose) :\u00a0\n\u00a0\u00a0Compilation ERROR, function(s)/method(s) not created! file68b0697546bd.cpp:11:54: fatal error: boost/math/special_functions/binomial.hpp: No such file or directory\n\u00a0#include &lt;boost/math/special_functions/binomial.hpp&gt;\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0^\ncompilation terminated.\nmake: *** [C:/PROGRA~1/R/R-34~1.3/etc/x64/Makeconf:215: file68b0697546bd.o] Error 1\nWarning message:\nrunning command 'make -f \"C:/PROGRA~1/R/R-34~1.3/etc/x64/Makeconf\" -f \"C:/PROGRA~1/R/R-34~1.3/share/make/winshlib.mk\" SHLIB_LDFLAGS='$(SHLIB_CXXLDFLAGS)' SHLIB_LD='$(SHLIB_CXXLD)' SHLIB=\"file68b0697546bd.dll\" WIN=64 TCLBIN=64 OBJECTS=\"file68b0697546bd.o\"' had status 2\u00a0\n</code></pre>\n"}, {"tags": ["c++", "openmp"], "comments": [{"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 4, "creation_date": 1530710582, "post_id": 51174556, "comment_id": 89332249, "body": "Welcome to Stack Overflow! Questions seeking debugging help (&quot;<b>why isn&#39;t this code working?</b>&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it <b>in the question itself</b>. Questions without a <b>clear problem statement</b> are not useful to other readers. See: <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530711337, "post_id": 51174556, "comment_id": 89332726, "body": "can you include the prototype of <code>RUN_PAR</code> ?"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1530711531, "post_id": 51174556, "comment_id": 89332852, "body": "Please consider the differences between processes and threads. OpenMP uses the threads, <b>not</b> processes. This makes your question difficult to understand."}, {"owner": {"reputation": 3152, "user_id": 1377706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bhJMC.png?s=128&g=1", "display_name": "Pharap", "link": "https://stackoverflow.com/users/1377706/pharap"}, "edited": false, "score": 0, "creation_date": 1530713890, "post_id": 51174556, "comment_id": 89334306, "body": "Can you include the definition of <code>Vcopia</code>? And are you sure that semicolon after <code>void MARCH::RUN_PAR(double zt,double **Vxy,int mt,int red_yred,int RANK)</code> and before the <code>{</code> isn&#39;t causing a problem?"}], "owner": {"reputation": 81, "user_id": 10032067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SoAqZ_VZHhU/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0Xgs6AZWCnPOyvLZRFZ7g-5NEIcw/mo/photo.jpg?sz=128", "display_name": "ACC_80", "link": "https://stackoverflow.com/users/10032067/acc-80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530714830, "creation_date": 1530709866, "last_edit_date": 1530714830, "question_id": 51174556, "link": "https://stackoverflow.com/questions/51174556/strange-results-when-i-call-a-c-class-method-inside-an-openmp-loop", "title": "Strange results when I call a C ++ class method inside an openmp loop", "body": "<p>Good Morning people.</p>\n\n<p>I made a code that run in a single thread mode and I'm trying to adapt it in a multiple threads mode. \nI'm running a method quite similar to the MARCH::RUN_PAR in single thread mode with good results, but when I'm trying to execute in a multiple threads mode (using Openmp) the results are too strange.</p>\n\n<p>Someone can help me in this question?</p>\n\n<p>Follow bellow my piece of code:</p>\n\n<pre><code>void MI_MARCH::RUN_PARALELO(double zt,double ***Vpar,int mt,int red_yred,int prof,int tam) {\n\n        int RANK, numero_proc_parall;\n        int shift,cont,m,rredy;\n        //start the number of (possible) threads\n        numero_proc_parall = tam;   \n        //shift the loop of threads\n        shift = 0;\n        //the necessary total number of threads\n        cont = prof;\n        //set the number of threads\n        omp_set_num_threads(numero_proc_parall);    \n        //argument initialization    \n        rredy = red_yred;   \n\n        MARCH VETOR_MARCH[numero_proc_parall];  //vector of class   \n\n        //open the parallel section\n        #pragma omp parallel shared(cont,shift,numero_proc_parall) private(red_yred,RANK,m)\n        {\n\n            while(cont &gt; 0)\n            {\n\n                #pragma omp critical\n                std::cout&lt;&lt;\"[MI_MARCH RUN_PAR] loop cont \"&lt;&lt;cont&lt;&lt;\" shift \"&lt;&lt;shift&lt;&lt;\" numero_proc_parall \"&lt;&lt;numero_proc_parall&lt;&lt;\"\\n\";           \n                #pragma omp for\n                for(m=0;m&lt;numero_proc_parall;m++) //loop de profundidade\n                {\n                    //atualize the rank \n                    RANK = omp_get_thread_num();\n                    //set the reference\n                    red_yred = rredy + m + shift            \n                    //run the method of the MARCH class\n                    VETOR_MARCH[m].RUN_PAR(zt,Vpar[m],mt,red_yred,RANK + shift);                \n                }   \n                //execute only in the master thread\n                #pragma omp master\n                {\n                    //increment the shift variable\n                    shift = shift + numero_proc_parall;\n                    //decrement the loop control\n                    cont = cont - numero_proc_parall;\n                    //verify if the process is greater than controller  \n                    if(cont&lt;numero_proc_parall)\n                    {\n                        //set a new number of parallel process\n                        numero_proc_parall = cont;\n                    }                               \n                }\n                #pragma omp barrier //waiting other process\n            }       \n        }\n    }   \n</code></pre>\n\n<p>The MARCH::RUN_PAR method is:</p>\n\n<pre><code>    void MARCH::RUN_PAR(double zt,double **Vxy,int mt,int red_yred,int RANK);\n    {\n\n        int xf,yf;    \n        xf = 100;\n        yf = 100; \n\n        //execute this piece of code in critical mode\n        #pragma omp critical\n        {       \n\n            for(int i=0;i&lt;xf;i++)\n            {\n                 for(int j=0;j&lt;yf;j++)\n                {           \n                    Vcopia[i][j] = Vxy[i][j];  //Vcopia is a member of MARCH class\n                }\n            }\n\n        }\n\n        V_H(Vcopia,xf,yf,red_yred); //this method is a member of MARCH class\n\n        CALC(mt,zt,RANK); //this method is a member of MARCH class\n\n    }\n\n...\n    class MARCH{\n    public: \n    ...\n      void RUN_PAR(double zt,double **Vxy,int mt,int red_yred,int RANK);\n\n    private:    \n    ...\n      double **Vcopia;\n    ...\n      void V_H(double **Vcopia,int xf,int yf,int red_yred); \n\n      void CALC(int mt,double zt,int RANK); \n    };\n</code></pre>\n\n<p>The incorrect results, apparently, are appearing in a sequential mode.</p>\n\n<p>The correct result in a single thread mode is a image like this: <a href=\"https://i.stack.imgur.com/FHgkm.png\" rel=\"nofollow noreferrer\">correct image</a></p>\n\n<p>The incorrect using multiple threads is a image like this: <a href=\"https://i.stack.imgur.com/aCA0D.png\" rel=\"nofollow noreferrer\">incorrect image</a></p>\n"}, {"tags": ["c++", "opencv", "image-processing", "filtering", "fft"], "comments": [{"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 1, "creation_date": 1530714423, "post_id": 51174347, "comment_id": 89334611, "body": "Switch the normalization and cropping \u2014 crop first, normalize after. The normalization is the only thing in your code that affects the contrast, any other effect is neutralized by the normalization."}, {"owner": {"reputation": 11, "user_id": 10028152, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NofiAANfqwc/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0plCDqMXXdvJoTRFfB_83AFM8C0w/mo/photo.jpg?sz=128", "display_name": "larry0514", "link": "https://stackoverflow.com/users/10028152/larry0514"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1530722906, "post_id": 51174347, "comment_id": 89338761, "body": "Thanks@CrisLuengo, tried, seems not the reason, result did not change"}], "owner": {"reputation": 11, "user_id": 10028152, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NofiAANfqwc/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0plCDqMXXdvJoTRFfB_83AFM8C0w/mo/photo.jpg?sz=128", "display_name": "larry0514", "link": "https://stackoverflow.com/users/10028152/larry0514"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 845, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1530711036, "creation_date": 1530709262, "last_edit_date": 1530711036, "question_id": 51174347, "link": "https://stackoverflow.com/questions/51174347/opencv-c-dft-bandpass-filtered-image-showing-reduced-intensity", "title": "OpenCV C++: DFT Bandpass Filtered Image Showing Reduced Intensity", "body": "<p>I am trying to design a bandpass filter to remove some low frequency components and high frequency noise from the inpout image:</p>\n\n<p><img src=\"https://i.stack.imgur.com/S1DVy.png\" alt=\"input_image\"></p>\n\n<p>I want to get rid of the large darker spot on the left side of the image, the bright row by row information is useful and should be kept after the filtering.</p>\n\n<p>This is the filtered image:</p>\n\n<p><img src=\"https://i.stack.imgur.com/EIpdD.png\" alt=\"filtered_image\"></p>\n\n<p>The filter seems to have removed the dark spot, but the problem is that the intensity of the bright pixels obviously has been reduced which is not what I want, I want to keep the contrast between the bright rows and the dark background. </p>\n\n<p>I have not much experience with image filtering in frequency domain. I don't know whether this result is normal when low-frequency signal has been removed? The code snippet has been attached. </p>\n\n<pre><code>void fft_filtering(cv::Mat img_gray, cv::Mat img_alpha) {\n    int M = GetOptimalDftSize(img_gray.rows);\n    int N = GetOptimalDftSize(img_gray.cols);\n    cv::Mat img_gray_padded;\n    cv::Mat planes[2];\n    cv::copyMakeBorder(img_gray, img_gray_padded, 0, M - img_gray.rows, 0,\n            N - img_gray.cols, cv::BORDER_CONSTANT, cv::Scalar::all(0));\n    planes[0] = cv::Mat_&lt;float&gt;(img_gray_padded);\n    planes[1] = cv::Mat::zeros(img_gray_padded.size(), CV_32F);\n    cv::Mat img_complex;\n    cv::merge(planes, 2, img_complex);\n    cv::dft(img_complex, img_complex);\n\n    cv::Mat filter(img_complex.size(), CV_32F);\n    int f3_inpixel, f2_inpixel, f1_inpixel;\n    CreateGaussianFilter(filter, img_alpha, FilterType::kBandPass, f3_inpixel, f2_inpixel, f1_inpixel);\n\n    // Apply filter\n    shiftDFT(img_complex);\n    cv::mulSpectrums(img_complex, filter, img_complex, 0);\n    shiftDFT(img_complex);\n\n    // Do inverse DFT on the filtered image\n    cv::idft(img_complex, img_complex);\n    // Split into planes and extract plane 0 as output image\n    cv::split(img_complex, planes);\n    cv::Mat img_out;\n    cv::normalize(planes[0], img_out, 0, 1, CV_MINMAX);\n    cv::Rect img_roi(0, 0, img_gray.cols, img_gray.rows);\n    img_filtered = img_out(img_roi); \n}\n\nvoid CreateGaussianFilter(cv::Mat&amp; filter, cv::Mat img_alpha, FilterType filter_type,\n        float cutoff_f_low_InPixels, float cutoff_f_high_InPixels, float cutoff_f_center_InPixels){\n    cv::Mat gf(filter.size(), CV_32F);\n    cv::Point centre(filter.cols / 2, filter.rows / 2);\n    for(int u = 0; u &lt; gf.rows; u++) {\n        for(int v = 0; v &lt; gf.cols; v++) {\n            switch (filter_type) {\n            case FilterType::kHighPass:\n                gf.at&lt;float&gt;(u, v) = 1- GaussianCoeff(u - centre.y, v - centre.x, cutoff_f_low_InPixels);\n                break;\n            case FilterType::kLowPass:\n                gf.at&lt;float&gt;(u, v) = GaussianCoeff(u - centre.y, v - centre.x, cutoff_f_high_InPixels);\n                break;\n            case FilterType::kBandPass:\n                gf.at&lt;float&gt;(u, v) = GaussianCoeff(u - centre.y, v - centre.x, cutoff_f_high_InPixels) -\n                GaussianCoeff(u - centre.y, v - centre.x, cutoff_f_low_InPixels);\n                break;\n            }\n        }\n    }\n    // Keep the center pixel\n    gf.at&lt;float&gt;(centre.y, centre.x) = 1.0;\n\n    cv::Mat toMerge[] = {gf, gf};\n    merge(toMerge, 2, filter);\n}\n</code></pre>\n"}, {"tags": ["c++", "cairo"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 4729299, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/974597502550689/picture?type=large", "display_name": "Nikhil Augustine", "link": "https://stackoverflow.com/users/4729299/nikhil-augustine"}, "edited": false, "score": 0, "creation_date": 1531204840, "post_id": 51223992, "comment_id": 89495750, "body": "Could you please elaborate more on this, Seems like I need to link fontconfig to my application to use this function."}, {"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "reply_to_user": {"reputation": 147, "user_id": 4729299, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/974597502550689/picture?type=large", "display_name": "Nikhil Augustine", "link": "https://stackoverflow.com/users/4729299/nikhil-augustine"}, "edited": false, "score": 1, "creation_date": 1531296242, "post_id": 51223992, "comment_id": 89537812, "body": "Fontconfig is used by cairo, so it is already used at runtime. And according to your valgrind output, fontconfig is in the backtrace for your leak. So yes, you have to link against fontconfig, but you already transitively link to fontconfig anyway."}, {"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "reply_to_user": {"reputation": 147, "user_id": 4729299, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/974597502550689/picture?type=large", "display_name": "Nikhil Augustine", "link": "https://stackoverflow.com/users/4729299/nikhil-augustine"}, "edited": false, "score": 1, "creation_date": 1531296352, "post_id": 51223992, "comment_id": 89537879, "body": "And for what is going on: Similar to cairo, fontconfig has some caches that it does not automatically free. Cairo cannot call FcFini() for you, because you could be using fontconfig also directly and not just through cairo."}], "tags": [], "owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "is_accepted": true, "score": 1, "last_activity_date": 1530972607, "creation_date": 1530972607, "answer_id": 51223992, "question_id": 51174295, "link": "https://stackoverflow.com/questions/51174295/cairo-show-text-memory-leak/51223992#51223992", "title": "cairo_show_text memory leak", "body": "<blockquote>\n  <p>Seems like calling cairo_debug_reset_static_data (); will suppress some errors as mentioned here. But now I'm facing another valgrind error from fontconfig , no idea how to fix it.</p>\n</blockquote>\n\n<p>Call <code>FcFini()</code> (after <code>cairo_debug_reset_static_data()</code>).</p>\n"}], "owner": {"reputation": 147, "user_id": 4729299, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/974597502550689/picture?type=large", "display_name": "Nikhil Augustine", "link": "https://stackoverflow.com/users/4729299/nikhil-augustine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 51223992, "answer_count": 1, "score": 0, "last_activity_date": 1530972607, "creation_date": 1530709130, "last_edit_date": 1530712783, "question_id": 51174295, "link": "https://stackoverflow.com/questions/51174295/cairo-show-text-memory-leak", "title": "cairo_show_text memory leak", "body": "<p>For the below code</p>\n\n<pre><code>bool CustomCairoRenderer::renderString(const std::string &amp;str,const Coordinates &amp;renderFrom)\n{\n    if(cairo_surface_status(_surface)!= CAIRO_STATUS_SUCCESS||cairo_status(_cr)!=CAIRO_STATUS_SUCCESS)\n    {\n        return false;\n    }\n    cairo_move_to (_cr,renderFrom.x, renderFrom.y);\n    cairo_show_text (_cr, str.c_str());\n    return true;\n}\n</code></pre>\n\n<p>I'm getting the following valgrind error</p>\n\n<pre><code>==919== HEAP SUMMARY:\n==919==     in use at exit: 578,997 bytes in 4,390 blocks\n==919==   total heap usage: 20,456 allocs, 16,066 frees, 5,505,886 \n          bytes allocated\n==919== \n==919== 288 (256 direct, 32 indirect) bytes in 1 blocks are definitely lost in loss record 123 of 212\n==919==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==919==    by 0x670B0B9: ??? (in /usr/lib/x86_64-linux- gnu/libfontconfig.so.1.9.0)\n==919==    by 0x670B829: ??? (in /usr/lib/x86_64-linux- gnu/libfontconfig.so.1.9.0)\n==919==    by 0x670CD4A: ??? (in /usr/lib/x86_64-linux- gnu/libfontconfig.so.1.9.0)\n==919==    by 0x671219B: ??? (in /usr/lib/x86_64-linux- gnu/libfontconfig.so.1.9.0)\n==919==    by 0x7FB0A9B: ??? (in /lib/x86_64-linux- gnu/libexpat.so.1.6.0)\n==919==    by 0x7FB13AB: ??? (in /lib/x86_64-linux- gnu/libexpat.so.1.6.0)\n==919==    by 0x7FB2CCD: ??? (in /lib/x86_64-linux- gnu/libexpat.so.1.6.0)\n==919==    by 0x7FB3424: ??? (in /lib/x86_64-linux- gnu/libexpat.so.1.6.0)\n==919==    by 0x7FB572A: XML_ParseBuffer (in /lib/x86_64-linux- gnu/libexpat.so.1.6.0)\n==919==    by 0x671152A: FcConfigParseAndLoad (in /usr/lib/x86_64-linux-gnu/libfontconfig.so.1.9.0)\n==919==    by 0x6711836: FcConfigParseAndLoad (in /usr/lib/x86_64- linux-gnu/libfontconfig.so.1.9.0)\n==919== \n==919== 353 (256 direct, 97 indirect) bytes in 1 blocks are definitely lost in loss record 138 of 212\n==919==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==919==    by 0x670B0B9: ??? (in /usr/lib/x86_64-linux- gnu/libfontconfig.so.1.9.0)\n==919==    by 0x670B829: ??? (in /usr/lib/x86_64-linux- gnu/libfontconfig.so.1.9.0)\n==919==    by 0x670C47A: FcPatternDuplicate (in /usr/lib/x86_64-linux- gnu/libfontconfig.so.1.9.0)\n==919==    by 0x514BFB2: ??? (in /usr/lib/x86_64-linux- gnu/libcairo.so.2.11400.6)\n==919==    by 0x514C19D: ??? (in /usr/lib/x86_64-linux- gnu/libcairo.so.2.11400.6)\n==919==    by 0x5110107: cairo_toy_font_face_create (in /usr/lib/x86_64-linux-gnu/libcairo.so.2.11400.6)\n==919==    by 0x50BFD6F: ??? (in /usr/lib/x86_64-linux-        gnu/libcairo.so.2.11400.6)\n==919==    by 0x50C2C60: ??? (in /usr/lib/x86_64-linux- gnu/libcairo.so.2.11400.6)\n==919==    by 0x50BB0FF: ??? (in /usr/lib/x86_64-linux- gnu/libcairo.so.2.11400.6)\n==919==    by 0x50B5242: cairo_show_text (in /usr/lib/x86_64-linux- gnu/libcairo.so.2.11400.6)\n==919==    by 0x44A978: CustomCairoRenderer::renderString(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, Coordinates const&amp;, ) (customcairorenderer.cpp:166)\n==919== \n==919== LEAK SUMMARY:\n==919==    definitely lost: 512 bytes in 2 blocks\n==919==    indirectly lost: 129 bytes in 5 blocks\n==919==      possibly lost: 0 bytes in 0 blocks\n==919==    still reachable: 578,356 bytes in 4,383 blocks\n==919==         suppressed: 0 bytes in 0 blocks\n==919== Reachable blocks (those to which a pointer was found) are not shown.\n</code></pre>\n\n<p>This function particularly renders only the given string. The cairo/surface creation and destruction is done in the class constructor and destructor.\nCould anyone spot what I'm doing wrong in this code?\nI'm using cairo version 1.14.6 on Ubuntu 16.04LTS</p>\n\n<p><strong>Update:</strong> Seems like calling <code>cairo_debug_reset_static_data ();</code> will suppress some errors as mentioned <a href=\"https://www.cairographics.org/manual/cairo-Error-handling.html#cairo-debug-reset-static-data\" rel=\"nofollow noreferrer\">here</a>. But now  I'm facing another valgrind error from fontconfig , no idea how to fix it.</p>\n\n<pre><code>==4546== HEAP SUMMARY:\n==4546==     in use at exit: 489,708 bytes in 4,130 blocks\n==4546==   total heap usage: 24,149 allocs, 20,019 frees, 5,806,541 bytes allocated\n==4546== \n==4546== 288 (256 direct, 32 indirect) bytes in 1 blocks are definitely lost in loss record 88 of 132\n==4546==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==4546==    by 0x670B0B9: ??? (in /usr/lib/x86_64-linux-gnu/libfontconfig.so.1.9.0)\n==4546==    by 0x670B829: ??? (in /usr/lib/x86_64-linux-gnu/libfontconfig.so.1.9.0)\n==4546==    by 0x670CD4A: ??? (in /usr/lib/x86_64-linux-gnu/libfontconfig.so.1.9.0)\n==4546==    by 0x671219B: ??? (in /usr/lib/x86_64-linux-gnu/libfontconfig.so.1.9.0)\n==4546==    by 0x7FB0A9B: ??? (in /lib/x86_64-linux-gnu/libexpat.so.1.6.0)\n==4546==    by 0x7FB13AB: ??? (in /lib/x86_64-linux-gnu/libexpat.so.1.6.0)\n==4546==    by 0x7FB2CCD: ??? (in /lib/x86_64-linux-gnu/libexpat.so.1.6.0)\n==4546==    by 0x7FB3424: ??? (in /lib/x86_64-linux-gnu/libexpat.so.1.6.0)\n==4546==    by 0x7FB572A: XML_ParseBuffer (in /lib/x86_64-linux-gnu/libexpat.so.1.6.0)\n==4546==    by 0x671152A: FcConfigParseAndLoad (in /usr/lib/x86_64-linux-gnu/libfontconfig.so.1.9.0)\n==4546==    by 0x6711836: FcConfigParseAndLoad (in /usr/lib/x86_64-linux-gnu/libfontconfig.so.1.9.0)\n==4546== \n==4546== LEAK SUMMARY:\n==4546==    definitely lost: 256 bytes in 1 blocks\n==4546==    indirectly lost: 32 bytes in 1 blocks\n==4546==      possibly lost: 0 bytes in 0 blocks\n==4546==    still reachable: 489,420 bytes in 4,128 blocks\n==4546==         suppressed: 0 bytes in 0 blocks\n==4546== Reachable blocks (those to which a pointer was found) are not shown.\n</code></pre>\n"}, {"tags": ["c++", "c++11", "move-semantics"], "comments": [{"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1530709362, "post_id": 51174204, "comment_id": 89331453, "body": "too early in the morning to think, but the explicit destructor may prevent the move constructor from being implicitly created. <a href=\"https://en.cppreference.com/w/cpp/language/move_constructor\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/move_constructor</a>"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 9, "creation_date": 1530709566, "post_id": 51174204, "comment_id": 89331585, "body": "Lifetime extension only applies when the reference binds directly to a temporary."}, {"owner": {"reputation": 582, "user_id": 2056153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ce7100485e2ab5bc89afdfb1b6cc9d9?s=128&d=identicon&r=PG", "display_name": "Markus", "link": "https://stackoverflow.com/users/2056153/markus"}, "reply_to_user": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1530709572, "post_id": 51174204, "comment_id": 89331587, "body": "@KennyOstrom I tried with explicitly generating the default move constructor via <code>Foo(Foo&amp;&amp;) = default;</code> and it produced the same result."}, {"owner": {"reputation": 4121, "user_id": 4290866, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0727d9acdc35a0359d0703da9e11f239?s=128&d=identicon&r=PG&f=1", "display_name": "user32434999", "link": "https://stackoverflow.com/users/4290866/user32434999"}, "edited": false, "score": 0, "creation_date": 1530710114, "post_id": 51174204, "comment_id": 89331935, "body": "Why would the lifetime of a foo-reference exceed the line const Foo&amp; foo = pass_through({&quot;some string&quot;}); ?"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1530711036, "post_id": 51174204, "comment_id": 89332534, "body": "Imagine if you only had the declaration of <code>pass_through()</code> available. There&#39;s no way to know there&#39;s a link between the parameter RValue ref and the result RValue ref, and the lifetime of the temporary <code>Foo</code> must still be resolved at <b>compile time</b>, so the compiler has no choice but to be pessimistic about it."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1530711256, "post_id": 51174204, "comment_id": 89332677, "body": "You can pass it as an argument because the lifetime of a temporary lasts until the end of the &quot;full-expression&quot; it&#39;s created in. (Very informally, &quot;until the next semicolon&quot;.) No extension is necessary."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 4121, "user_id": 4290866, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0727d9acdc35a0359d0703da9e11f239?s=128&d=identicon&r=PG&f=1", "display_name": "user32434999", "link": "https://stackoverflow.com/users/4290866/user32434999"}, "edited": false, "score": 0, "creation_date": 1530717590, "post_id": 51174204, "comment_id": 89336349, "body": "@Pi -- in <code>const Foo&amp; foo = Foo():</code> the lifetime of the temporary object created by <code>Foo()</code> is extended, so it remains valid as long as <code>foo</code> does. That&#39;s called &quot;lifetime extension&quot;. This question involves creating a temporary <code>Foo</code> object indirectly, and, as comments have said, that doesn&#39;t result in lifetime extension."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1530741841, "post_id": 51174204, "comment_id": 89344844, "body": "Static analysis ought to be able to detect this, I predict we will see compilers able to warn about this in future"}], "answers": [{"tags": [], "owner": {"reputation": 1230, "user_id": 3958860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iLugv.jpg?s=128&g=1", "display_name": "Fibbles", "link": "https://stackoverflow.com/users/3958860/fibbles"}, "is_accepted": true, "score": 3, "last_activity_date": 1530723632, "last_edit_date": 1592644375, "creation_date": 1530722992, "answer_id": 51178125, "question_id": 51174204, "link": "https://stackoverflow.com/questions/51174204/why-cant-i-bind-a-const-lvalue-reference-to-a-function-returning-t/51178125#51178125", "title": "Why can&#39;t I bind a const lvalue reference to a function returning T&amp;&amp;?", "body": "<p>From the standard:</p>\n<blockquote>\n<p><strong>15.2 Temporary objects</strong></p>\n<pre><code>6.9 A temporary object bound to a reference parameter in a function call persists \n    until the completion of the full-expression containing the call.\n</code></pre>\n</blockquote>\n<p>Essentially what it's saying is that because you passed in a temporary object and then didn't extend its lifetime (say, by moving it into an lvalue) then its lifetime only lasts until the first <code>;</code> after the call to <code>pass_through</code> in your code. After this point you are left with <code>foo</code> as a dangling reference.</p>\n<pre><code>int main()\n{\n    const Foo&amp; foo = pass_through({&quot;some string&quot;}); // &quot;some string&quot; lifetime ends here\n    std::cout &lt;&lt; &quot;before scope end&quot; &lt;&lt; std::endl;\n}\n</code></pre>\n<p>As to whether it is good practice to to return an rvalue reference I believe these two answers already go into detail on the subject:</p>\n<p><a href=\"https://stackoverflow.com/questions/30094067/should-i-return-an-rvalue-reference-parameter-by-rvalue-reference\" title=\"Should I return an rvalue reference parameter by rvalue reference?\">Should I return an rvalue reference parameter by rvalue reference?</a></p>\n<p><a href=\"https://stackoverflow.com/questions/1116641/is-returning-by-rvalue-reference-more-efficient\" title=\"Is returning by rvalue reference more efficient?\">Is returning by rvalue reference more efficient?</a></p>\n"}], "owner": {"reputation": 582, "user_id": 2056153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ce7100485e2ab5bc89afdfb1b6cc9d9?s=128&d=identicon&r=PG", "display_name": "Markus", "link": "https://stackoverflow.com/users/2056153/markus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 51178125, "answer_count": 1, "score": 8, "last_activity_date": 1530723632, "creation_date": 1530708810, "last_edit_date": 1530714380, "question_id": 51174204, "link": "https://stackoverflow.com/questions/51174204/why-cant-i-bind-a-const-lvalue-reference-to-a-function-returning-t", "title": "Why can&#39;t I bind a const lvalue reference to a function returning T&amp;&amp;?", "body": "<p>I was binding some return value of a function to a const lvalue reference, but the object was deleted, before the lifetime of the const lvalue reference ended.</p>\n\n<p>In the following example the Foo object is destroyed before the lifetime of <code>foo</code> ends:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstruct Foo\n{\n    ~Foo()\n    {\n        std::cout &lt;&lt; \"Foo destroyed: \" &lt;&lt; name &lt;&lt; std::endl;\n    }\n    std::string name;\n};\n\nFoo&amp;&amp; pass_through(Foo&amp;&amp; foo)\n{\n    return std::move(foo);\n}\n\nint main()\n{\n    const Foo&amp; foo = pass_through({\"some string\"});\n    std::cout &lt;&lt; \"before scope end\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<blockquote>\n  <p>Foo destroyed: some string<br>\n  before scope end</p>\n</blockquote>\n\n<p>live on coliru: <a href=\"http://coliru.stacked-crooked.com/a/0e771c4efa77ed6a\" rel=\"nofollow noreferrer\" title=\"live on coliru\">1</a></p>\n\n<p>I thought you can bind <code>const T&amp;</code> to anything. Is it bad practice to return <code>T&amp;&amp;</code> and should returning by value be preferred?</p>\n\n<p>I stumbled across this in the cpprestsdk here:</p>\n\n<pre><code>inline utility::string_t&amp;&amp; to_string_t(std::string &amp;&amp;s) { return std::move(s); }\n</code></pre>\n\n<p><a href=\"https://github.com/Microsoft/cpprestsdk/blob/master/Release/include/cpprest/asyncrt_utils.h#L109\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/cpprestsdk/blob/master/Release/include/cpprest/asyncrt_utils.h#L109</a></p>\n\n<p>Very confusing, because the windows version of <code>to_string_t</code> (dispatched by preprocessor macros) <strong>returned by value</strong>:</p>\n\n<pre><code>_ASYNCRTIMP utility::string_t __cdecl to_string_t(std::string &amp;&amp;s);\n</code></pre>\n\n<p>Edit:\nWhy does it work when passing the result of <code>pass_through</code> to a function taking <code>const Foo&amp;</code>? The lifetime is extended in this case?</p>\n"}, {"tags": ["c++", "multithreading"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530709505, "post_id": 51174191, "comment_id": 89331542, "body": "@OlivierSohn Wrong, that constructor also locks the mutex."}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1530709548, "post_id": 51174191, "comment_id": 89331573, "body": "@SombreroChicken Oups let me read the doc again :), then the second part of my comment applies"}, {"owner": {"reputation": 381, "user_id": 9629245, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UIobdmipCvQ/AAAAAAAAAAI/AAAAAAAAACQ/HnSiJyeFkHE/photo.jpg?sz=128", "display_name": "Zeeshan Hayat", "link": "https://stackoverflow.com/users/9629245/zeeshan-hayat"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1530709789, "post_id": 51174191, "comment_id": 89331710, "body": "@SombreroChicken, there is a bug, thanks for the help :)"}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1530710010, "post_id": 51174191, "comment_id": 89331858, "body": "Deleted my comments as my diagnostic was wrong. @SombreroChicken your deleted answer was the right one (but since the question has been edited, now it is bug-free I think)."}, {"owner": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1530710717, "post_id": 51174191, "comment_id": 89332331, "body": "@PeteBecker Ok, then I delete my answer"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 2, "creation_date": 1530710812, "post_id": 51174191, "comment_id": 89332380, "body": "@JHBonarius -- no; calling either of the notify functions while holding the lock is just fine. A waiting thread won&#39;t run until the mutex is released, but there&#39;s no problem with releasing the mutex after the call to notify. In this code, the mutex is released by the destructor of the <code>lk</code> object when the test function returns. Inside the <code>wait</code> call, once the notify triggers a thread, the code locks the mutex, which can mean waiting until the mutex has been released. After it locks the mutex, <code>wait</code> returns and the waiting thread resumes execution."}, {"owner": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 0, "creation_date": 1530710913, "post_id": 51174191, "comment_id": 89332463, "body": "The code compiles and runs OK for me: <a href=\"http://rextester.com/PZEF80434\" rel=\"nofollow noreferrer\">live example</a>"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 0, "creation_date": 1530712425, "post_id": 51174191, "comment_id": 89333426, "body": "@JHBonarius You should notify while mutex is held to maintain fair queuing. Otherwise another thread may reap that notification before the queued up threads. It is poor advice to unlock the mutex before notifying."}, {"owner": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1530713268, "post_id": 51174191, "comment_id": 89333937, "body": "@MaximEgorushkin. I will delete the comment. But I got it <a href=\"https://en.cppreference.com/w/cpp/thread/condition_variable\" rel=\"nofollow noreferrer\">here</a>. Poor advice from that source??"}, {"owner": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1530714000, "post_id": 51174191, "comment_id": 89334364, "body": "@MaximEgorushkin do you have a link to any elaboration or an example of how release mutex before notifying variable may hinder fair scheduling, because I cannot figure out in which cases that would happen"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "edited": false, "score": 2, "creation_date": 1530715094, "post_id": 51174191, "comment_id": 89335019, "body": "@pqnet <a href=\"https://en.cppreference.com/w/cpp/thread/condition_variable/notify_one\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/thread/condition_variable/notify_o&zwnj;&#8203;ne</a>: <i>Notifying while under the lock may nevertheless be necessary when precise scheduling of events is required</i>."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "edited": false, "score": 2, "creation_date": 1530715151, "post_id": 51174191, "comment_id": 89335053, "body": "@pqnet <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_cond_broadcast.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799/functions/&hellip;</a>: <i>however, if predictable scheduling behavior is required, then that mutex shall be locked by the thread calling pthread_cond_broadcast() or pthread_cond_signal().</i>"}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 1, "creation_date": 1530738155, "post_id": 51174191, "comment_id": 89343831, "body": "For clarification, in the initial question, there was a bug : <code>std::thread t2(test2);</code> was <code>std::thread t2(test1);</code>, but it was edited since so it doesn&#39;t make any sense now..."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1531171846, "post_id": 51174191, "comment_id": 89487498, "body": "This question makes no sense now, as the code is fine (except spurious wakeup is when the condition is false). Waste of time. Voting to delete."}], "answers": [{"tags": [], "owner": {"reputation": 7041, "user_id": 314290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5ffde821f0f9670e601b19f1731a6849?s=128&d=identicon&r=PG", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/314290/mikhail"}, "is_accepted": false, "score": 1, "last_activity_date": 1531168121, "last_edit_date": 1531168121, "creation_date": 1530913878, "answer_id": 51218039, "question_id": 51174191, "link": "https://stackoverflow.com/questions/51174191/c-stdcondition-variable-notified-by-different-threads/51218039#51218039", "title": "C++ - std::condition_variable notified by different threads", "body": "<p>Try this code. Note that a condition variable accepts a predicate that first checks if the the condition is met, and then takes the lock. When you notify the variable, it runs the predicate (without taking the lock), if the condition is true,  the thread will own the lock else the calling thread will keep waiting for the next notification. </p>\n\n<pre><code>#include &lt;chrono&gt;\n#include &lt;condition_variable&gt;\n#include &lt;iostream&gt;\n#include &lt;mutex&gt;\n#include &lt;thread&gt;\n\nauto is_ready_1=false;\nauto is_ready_2=false;\nstd::mutex m;\nstd::condition_variable cv;\n\nvoid test1()\n{\n    std::this_thread::sleep_for(std::chrono::seconds(3));\n    std::unique_lock&lt;std::mutex&gt; lk(m);\n    is_ready_1 = true;\n    cv.notify_one();\n}\nvoid test2()\n{\n    std::this_thread::sleep_for(std::chrono::seconds(6));\n    std::unique_lock&lt;std::mutex&gt; lk(m);\n    is_ready_2 = true;\n    cv.notify_one();\n}\n\nint main()\n{\n    std::thread t1(test1);\n    std::thread t2(test2);\n\n    std::unique_lock&lt;std::mutex&gt; lk(m);\n    cv.wait(lk, [] {\n        if (!is_ready_1)\n        {\n            std::cout &lt;&lt; \"Spurious 1\" &lt;&lt; std::endl;\n        }\n        return is_ready_1;\n    });\n    //preceding line must clear before this is executed\n    cv.wait(lk, [] {\n        if (!is_ready_2)\n        {\n            std::cout &lt;&lt; \"Spurious 1\" &lt;&lt; std::endl;\n        }\n        return is_ready_2;\n    });\n\n    t1.join();\n    t2.join();\n    system(\"pause\");\n}\n</code></pre>\n\n<p>Also on Windows 10, I see two spurious wakeup events, I suspect these happen when the thread is woken up from sleep.</p>\n"}], "owner": {"reputation": 381, "user_id": 9629245, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UIobdmipCvQ/AAAAAAAAAAI/AAAAAAAAACQ/HnSiJyeFkHE/photo.jpg?sz=128", "display_name": "Zeeshan Hayat", "link": "https://stackoverflow.com/users/9629245/zeeshan-hayat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531168121, "creation_date": 1530708765, "last_edit_date": 1530709806, "question_id": 51174191, "link": "https://stackoverflow.com/questions/51174191/c-stdcondition-variable-notified-by-different-threads", "title": "C++ - std::condition_variable notified by different threads", "body": "<p>I am trying to notify an event from two different threads. Main thread wakes up on first <code>notify_one()</code> call but not on the second one. Is this the right way to use condition variable?</p>\n\n<pre><code>#include &lt;chrono&gt;\n#include &lt;condition_variable&gt;\n#include &lt;iostream&gt;\n#include &lt;mutex&gt;\n#include &lt;thread&gt;\n\nbool is_ready_1(false);\nbool is_ready_2(false);\nstd::mutex m;\nstd::condition_variable cv;\n\nvoid test1()\n{\n    std::this_thread::sleep_for(std::chrono::seconds(3));\n    std::unique_lock&lt;std::mutex&gt; lk(m);\n    is_ready_1 = true;\n    cv.notify_one();\n}\nvoid test2()\n{\n    std::this_thread::sleep_for(std::chrono::seconds(6));\n    std::unique_lock&lt;std::mutex&gt; lk(m);\n    is_ready_2 = true;\n    cv.notify_one();\n}\n\nint main()\n{\n    std::thread t1(test1);\n    std::thread t2(test2);\n\n    std::unique_lock&lt;std::mutex&gt; lk(m);\n    while (!is_ready_1)\n    {\n        cv.wait(lk);\n        if (is_ready_1)\n            std::cout &lt;&lt; \"Spurious wake-1 up!\\n\";\n    }\n\n    while (!is_ready_2)\n    {\n         cv.wait(lk);\n         if (is_ready_2)\n         std::cout &lt;&lt; \"Spurious wake-2 up!\\n\";\n    }\n    t1.join(); \n    t2.join();\n    system(\"pause\");\n}\n</code></pre>\n"}, {"tags": ["c++", "linux"], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 3905428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YtVcx.png?s=128&g=1", "display_name": "RSteele", "link": "https://stackoverflow.com/users/3905428/rsteele"}, "is_accepted": true, "score": 3, "last_activity_date": 1530716942, "creation_date": 1530716942, "answer_id": 51176693, "question_id": 51174163, "link": "https://stackoverflow.com/questions/51174163/wordexp-and-strings-with-spaces/51176693#51176693", "title": "wordexp and strings with spaces", "body": "<p>The reason your code removes the double spaces in your path is because your for loop adds only a single space after every word, regardless of the actual number of spaces. A possible solution to this problem would be to locate all the spaces in your path string beforehand, and then add them in. For example, you could use something like this:</p>\n\n<pre><code>std::string spaces[p.we_wordc];\nuint32_t pos = path.find(\" \", 0);\nuint32_t j=0;\n\nwhile(pos!=std::string::npos){\n\n    while(path.at(pos)==' '){\n    spaces[j]+=\" \";\n    pos++;\n    }\n\n    pos=path.find(\" \", pos+1);\n    j++;\n}\n</code></pre>\n\n<p>to iterate through your path using std::string::find and store the spaces in a string array. Then, you could modify the line in your for loop to</p>\n\n<pre><code>result += spaces[i-1] + std::string(p.we_wordv[i]);\n</code></pre>\n\n<p>to add in the appropriate number of spaces.</p>\n"}, {"tags": [], "owner": {"reputation": 899, "user_id": 7561577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4a245cd8b14a5fba97b5c1336a7161?s=128&d=identicon&r=PG&f=1", "display_name": "login_not_failed", "link": "https://stackoverflow.com/users/7561577/login-not-failed"}, "is_accepted": false, "score": 0, "last_activity_date": 1533907886, "creation_date": 1533907886, "answer_id": 51787710, "question_id": 51174163, "link": "https://stackoverflow.com/questions/51174163/wordexp-and-strings-with-spaces/51787710#51787710", "title": "wordexp and strings with spaces", "body": "<p>If you want to preserve spaces in an unusually named file, enclose it in braces: <code>std::string teststring = \"\\\"~/filename  with   spaces\\\"\";</code>. But it doesn't make sense to note how many spaces there were in an original string, since you'll have to skip pairs of <code>\"</code> and basically redo what <code>wordexp()</code> does. Leaving multiple spaces in a command doesn't make much sense: <code>ls -al</code> is exactly the same as <code>ls   -al</code>, so the trimming is justified. And the OP's code is perfectly valid -- no need to add anything else.</p>\n\n<p>P.S. Decided to add this as a note because I fell in the same pit as OP.</p>\n"}], "owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 51176693, "answer_count": 2, "score": 3, "last_activity_date": 1533907886, "creation_date": 1530708712, "question_id": 51174163, "link": "https://stackoverflow.com/questions/51174163/wordexp-and-strings-with-spaces", "title": "wordexp and strings with spaces", "body": "<p>I am trying to expand variables in a <code>string</code> that contains a unix file path. For example the string is:</p>\n\n<pre><code>std::string path = \"$HOME/Folder  With  Two  Spaces  Next  To  Each  Other\".\n</code></pre>\n\n<p>This is my code for <code>wordexp</code> I use:</p>\n\n<pre><code>#include &lt;wordexp.h&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nstd::string env_subst(const std::string &amp;path)\n{\n        std::string result = \"\";\n        wordexp_t p;\n        if (!::wordexp(path.c_str(), &amp;p, 0))\n        {\n                if (p.we_wordc &gt;= 1)\n                {\n                        result = std::string(p.we_wordv[0]);\n                        for (uint32_t i = 1; i &lt; p.we_wordc; ++i)\n                        {\n                                result += \" \" + std::string(p.we_wordv[i]);\n                        }\n                }\n                ::wordfree(&amp;p);\n                return result;\n        }\n        else\n        {\n                // Illegal chars found\n                return path;\n        }\n}\n\nint main()\n{\n        std::string teststring = \"$HOME/Folder  With  Two  Spaces  Next  To  Each  Other\";\n        std::string result = env_subst(teststring);\n        std::cout &lt;&lt; \"Result: \" &lt;&lt; result &lt;&lt; std::endl;\n        return 0;\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>Result: /home/nidhoegger/Folder With Two Spaces Next To Each Other\n</code></pre>\n\n<p>You see, that whereas there were two spaces between the words in the input, there is now only a single space.</p>\n\n<p>Is there an easy way to fix that?</p>\n"}, {"tags": ["c++", "arrays", "data-structures", "heap-memory"], "comments": [{"owner": {"reputation": 318, "user_id": 9913960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1671b1a81da1037f6c800da77d270f7?s=128&d=identicon&r=PG&f=1", "display_name": "user30701", "link": "https://stackoverflow.com/users/9913960/user30701"}, "edited": false, "score": 1, "creation_date": 1530708313, "post_id": 51174009, "comment_id": 89330783, "body": "Can you provide a sample code to show your problem ?"}, {"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1530708317, "post_id": 51174009, "comment_id": 89330785, "body": "This will depend on your compiler, compiler options and platform on which it runs."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1530708320, "post_id": 51174009, "comment_id": 89330789, "body": "Please show some code, I&#39;m not sure what you mean by &quot;default value of array&quot;. Array of what?"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1530708357, "post_id": 51174009, "comment_id": 89330820, "body": "To be pedantic, it is called free store, not heap. C++ is designed for abstract hardware."}, {"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1530708393, "post_id": 51174009, "comment_id": 89330845, "body": "In a release build of C++, the values in variables are generally undefined, and don&#39;t have specified defaults."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1530708407, "post_id": 51174009, "comment_id": 89330857, "body": "There are no &quot;default values&quot; for arrays on the heap. <code>static</code> arrays are explicitly zero-initialized. Everything else&#39;s default is random garbage."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1530708443, "post_id": 51174009, "comment_id": 89330879, "body": "<code>int* p = new int[10];</code> then p[0..9] contain indeterminate values. There is no default."}], "answers": [{"tags": [], "owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "is_accepted": false, "score": 1, "last_activity_date": 1530708511, "creation_date": 1530708511, "answer_id": 51174104, "question_id": 51174009, "link": "https://stackoverflow.com/questions/51174009/what-is-default-value-of-array-on-heap-in-c/51174104#51174104", "title": "What is Default value of array on heap in c++?", "body": "<p>The <a href=\"https://en.cppreference.com/w/cpp/container/array\" rel=\"nofollow noreferrer\">doc</a> of the std::array constructor says it:</p>\n\n<blockquote>\n  <p>initializes the array following the rules of aggregate initialization (note that default initialization may result in indeterminate values for non-class T)</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 10032205, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y66X7lHoA58/AAAAAAAAAAI/AAAAAAAABnM/7ViQQH19V-8/photo.jpg?sz=128", "display_name": "pravince singh", "link": "https://stackoverflow.com/users/10032205/pravince-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "closed_date": 1530708563, "answer_count": 1, "score": -4, "last_activity_date": 1530708511, "creation_date": 1530708225, "question_id": 51174009, "link": "https://stackoverflow.com/questions/51174009/what-is-default-value-of-array-on-heap-in-c", "closed_reason": "Needs details or clarity", "title": "What is Default value of array on heap in c++?", "body": "<p>When I print the default value of array on heap memory I'm getting random big numbers in code block. I know that the default value of array is 0 but I am getting random number . </p>\n"}, {"tags": ["c++", "c", "freertos"], "comments": [{"owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "edited": false, "score": 0, "creation_date": 1530707976, "post_id": 51173936, "comment_id": 89330553, "body": "Release is set at &quot;-O1&quot; if it helps"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1530708227, "post_id": 51173936, "comment_id": 89330732, "body": "You fix it using <code>new</code>? Then tag the question as C++"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1530708604, "post_id": 51173936, "comment_id": 89330976, "body": "If I undertand the documentation corectly then <code>xTaskCreate</code> does not block and returns after creating the task. Then <code>main</code> is exited and now <code>MyStruct s;</code>, which was on the stack of <code>main</code> doesn&#39;t exist anymore. I also wonder what happens when <code>main</code> is exited as normally the program now ends."}, {"owner": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1530708790, "post_id": 51173936, "comment_id": 89331091, "body": "@PaulOgilvie normally, there is a <code>vTaskStartScheduler()</code> function that needs to be called in the main after creating the tasks, not really sure if this is the missing point."}, {"owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1530708822, "post_id": 51173936, "comment_id": 89331111, "body": "@PaulOgilvie : I should have mentioned that main does not exist, I&#39;ve stripped out the code to only show how I&#39;m passing the struct, sorry"}, {"owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "reply_to_user": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 0, "creation_date": 1530708848, "post_id": 51173936, "comment_id": 89331123, "body": "@MikevanDyke: yes exactly, I&#39;ll edit my code"}], "answers": [{"comments": [{"owner": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 0, "creation_date": 1530780902, "post_id": 51176465, "comment_id": 89355958, "body": "hmm, but the variable should still exist when the task is executing, since the stack frame of the main function is the last one to be exited?"}, {"owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "reply_to_user": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 0, "creation_date": 1530781029, "post_id": 51176465, "comment_id": 89356039, "body": "It&#39;s what we though :-/"}], "tags": [], "owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "is_accepted": false, "score": 3, "last_activity_date": 1530716171, "creation_date": 1530716171, "answer_id": 51176465, "question_id": 51173936, "link": "https://stackoverflow.com/questions/51173936/freertos-crash-only-in-release/51176465#51176465", "title": "FreeRTOS crash only in Release", "body": "<p>I'm so stupid, it's written on FreeRTOS' doc:\n<a href=\"https://www.freertos.org/a00125.html\" rel=\"nofollow noreferrer\">https://www.freertos.org/a00125.html</a></p>\n\n<blockquote>\n  <p>so it is not valid to pass the address of a stack variable.</p>\n</blockquote>\n"}], "owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1530716171, "creation_date": 1530707952, "last_edit_date": 1530708899, "question_id": 51173936, "link": "https://stackoverflow.com/questions/51173936/freertos-crash-only-in-release", "title": "FreeRTOS crash only in Release", "body": "<p>I have this code that crash only in Release:</p>\n\n<pre><code>int main() \n{\n  MyStruct s;\n  s.field = bla;\n\n  xTaskCreate(TestTask, \"TestTask\", 2000, &amp;s, 1, 0);\n\n  // other tasks creation\n  vTaskStartScheduler();\n}\n\n\nvoid TestTask(void *p) \n{\n  // some delay\n  MyStruct* s = (MyStruct*)p;\n  another_func(s-&gt;field); // hard fault\n}\n</code></pre>\n\n<p>I manage to fix it like this:</p>\n\n<pre><code>int main()\n{\n  MyStruct* s = new MyStruct();\n  s-&gt;field = bla;\n  xTaskCreate(TestTask, \"TestTask\", 2000, s, 1, 0);\n\n  // other tasks creation\n  vTaskStartScheduler();\n}\n</code></pre>\n\n<p>I don't understand why. Did I fixed it or workaround a memory corruption that can still be there?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "windows", "docker", "dll", "docker-for-windows"], "comments": [{"owner": {"reputation": 2865, "user_id": 1807374, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sAIFS.jpg?s=128&g=1", "display_name": "Gregory Suvalian", "link": "https://stackoverflow.com/users/1807374/gregory-suvalian"}, "edited": false, "score": 0, "creation_date": 1530708473, "post_id": 51173889, "comment_id": 89330892, "body": "You can try new full Windows image <a href=\"https://www.theregister.co.uk/2018/06/28/microsoft_releases_new_containerised_cut_of_windows_server/\" rel=\"nofollow noreferrer\">theregister.co.uk/2018/06/28/&hellip;</a>"}, {"owner": {"reputation": 41, "user_id": 10004597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--MCrWnY-888/AAAAAAAAAAI/AAAAAAAAMiI/XTdU4laU7Ac/photo.jpg?sz=128", "display_name": "Harshavardhan Ghorpade", "link": "https://stackoverflow.com/users/10004597/harshavardhan-ghorpade"}, "reply_to_user": {"reputation": 2865, "user_id": 1807374, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sAIFS.jpg?s=128&g=1", "display_name": "Gregory Suvalian", "link": "https://stackoverflow.com/users/1807374/gregory-suvalian"}, "edited": false, "score": 1, "creation_date": 1531386969, "post_id": 51173889, "comment_id": 89580200, "body": "Thanks, but in order to use this insider docker image. we should use latest insider build OS on host machine as well, which I think is not suitable solution in our case.  So I think we should wait for Windows to publish the new docker image with more functionalities supported."}, {"owner": {"reputation": 2865, "user_id": 1807374, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sAIFS.jpg?s=128&g=1", "display_name": "Gregory Suvalian", "link": "https://stackoverflow.com/users/1807374/gregory-suvalian"}, "edited": false, "score": 0, "creation_date": 1531399213, "post_id": 51173889, "comment_id": 89588406, "body": "Yes, but this will give you a headstart as far as understanding if your functionality is even duable in that image"}, {"owner": {"reputation": 41, "user_id": 10004597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--MCrWnY-888/AAAAAAAAAAI/AAAAAAAAMiI/XTdU4laU7Ac/photo.jpg?sz=128", "display_name": "Harshavardhan Ghorpade", "link": "https://stackoverflow.com/users/10004597/harshavardhan-ghorpade"}, "reply_to_user": {"reputation": 2865, "user_id": 1807374, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sAIFS.jpg?s=128&g=1", "display_name": "Gregory Suvalian", "link": "https://stackoverflow.com/users/1807374/gregory-suvalian"}, "edited": false, "score": 0, "creation_date": 1532507275, "post_id": 51173889, "comment_id": 89996785, "body": "Thanks @GregorySuvalian .. I will try this.. do you know Amazon or Azure AMI with latest windows server insider build pre-installed ? or do we need to try it locally (on virtual machine may be) ?"}, {"owner": {"reputation": 2865, "user_id": 1807374, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sAIFS.jpg?s=128&g=1", "display_name": "Gregory Suvalian", "link": "https://stackoverflow.com/users/1807374/gregory-suvalian"}, "edited": false, "score": 0, "creation_date": 1532520701, "post_id": 51173889, "comment_id": 90005711, "body": "I don&#39;t believe any of cloud providers have insider images running"}], "answers": [{"comments": [{"owner": {"reputation": 8969, "user_id": 23893, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/253f97806e9b33d1cb88fa751fb3c74e?s=128&d=identicon&r=PG", "display_name": "sebagomez", "link": "https://stackoverflow.com/users/23893/sebagomez"}, "edited": false, "score": 0, "creation_date": 1548165353, "post_id": 51514343, "comment_id": 95439292, "body": "I&#39;m facing this same problem... is your answer still valid? Have those newer images been released yet?"}], "tags": [], "owner": {"reputation": 41, "user_id": 10004597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--MCrWnY-888/AAAAAAAAAAI/AAAAAAAAMiI/XTdU4laU7Ac/photo.jpg?sz=128", "display_name": "Harshavardhan Ghorpade", "link": "https://stackoverflow.com/users/10004597/harshavardhan-ghorpade"}, "is_accepted": false, "score": 2, "last_activity_date": 1532507626, "creation_date": 1532507626, "answer_id": 51514343, "question_id": 51173889, "link": "https://stackoverflow.com/questions/51173889/how-to-install-all-dependent-binaries-required-to-execute-native-c-dll-exe-on/51514343#51514343", "title": "How to install all dependent binaries required to execute native C++ DLL/EXE on windowsservercore Docker image", "body": "<p>For now with the current released windows server docker images you can not execute native binaries which are dependent on above mentioned system libs. For this to work on released windows server docker containers, we have to wait for next windows docker image (with much large footprint and more functionalities available) to be released.</p>\n"}], "owner": {"reputation": 41, "user_id": 10004597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--MCrWnY-888/AAAAAAAAAAI/AAAAAAAAMiI/XTdU4laU7Ac/photo.jpg?sz=128", "display_name": "Harshavardhan Ghorpade", "link": "https://stackoverflow.com/users/10004597/harshavardhan-ghorpade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1532507626, "creation_date": 1530707809, "question_id": 51173889, "link": "https://stackoverflow.com/questions/51173889/how-to-install-all-dependent-binaries-required-to-execute-native-c-dll-exe-on", "title": "How to install all dependent binaries required to execute native C++ DLL/EXE on windowsservercore Docker image", "body": "<p>I am facing issue while using native C++ DLL into the C# .NET core app on windowsservercore Docker container. Getting following error when try to call exposed API from the native DLL using pInvoke from C# .NET Core application. </p>\n\n<p>Error : Unable to load DLL 'MyDLL': The specified module could not be found. (Exception from HRESULT: 0x8007007E)</p>\n\n<p>Problem : my windows docker container (build from windowsservercore base image) has one C# .net core service running .. on the specific POST request.. I need to call function from native C++ DLL, I am calling it using pInvoke. now the problem is the native DLL is not loading because some of its dependencies are missing in the container image.. I tried installing possible VC++ redistributables .. but it does not solve the problem.. so while checking complete dependency tree (using dependency walker) I came to know that some system libs are missing in the windowsservercore base docker image.\nfollowing is the list of some of missing libs form docker container.</p>\n\n<pre><code>c:\\windows\\system32\\ELSCORE.DLL\nc:\\windows\\system32\\DEVMGR.DLL\nc:\\windows\\system32\\DCOMP.DLL\nc:\\windows\\system32\\DSREG.DLL\nc:\\windows\\system32\\SHDOCVW.DLL\nc:\\windows\\system32\\COREUICOMPONENTS.DLL\nc:\\windows\\system32\\POLICYMANAGER.DLL\nc:\\windows\\system32\\OPENGL32.DLL\n</code></pre>\n\n<p>So my question is, How to solve those system level lib dependencies on container ? I understand that for obvious reasons (minimizing the image size) those libs are excluded from the base windowsservercore docker image. But is there any standard way/installer/package that install missing system libs to my docker image ? or should I go with dirty manually copy all the required libs to system32 folder </p>\n\n<p>PS : This same code works on host machine (windows server 2016) after installing VC++ redistributable, its just that its not working on windowsservercore Docker container (even after installation of mentioned VC++ redistributable).</p>\n\n<p>Thanks,\n-Harsh</p>\n"}, {"tags": ["c++", "linux", "gcc", "clang", "llvm"], "comments": [{"owner": {"reputation": 1125, "user_id": 4441477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92182839b265074948295c7bf513548?s=128&d=identicon&r=PG", "display_name": "jw_", "link": "https://stackoverflow.com/users/4441477/jw"}, "edited": false, "score": 0, "creation_date": 1575536299, "post_id": 51173869, "comment_id": 104601889, "body": "A ref from Bing: <a href=\"https://gcc.gnu.org/gcc-3.0/libgcc.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/gcc-3.0/libgcc.html</a> and <a href=\"https://compiler-rt.llvm.org/\" rel=\"nofollow noreferrer\">compiler-rt.llvm.org</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2667, "user_id": 572332, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ede4acd1b1775241fa41834dd1406fef?s=128&d=identicon&r=PG&f=1", "display_name": "robor", "link": "https://stackoverflow.com/users/572332/robor"}, "edited": false, "score": 0, "creation_date": 1530708729, "post_id": 51174029, "comment_id": 89331047, "body": "When I call clang with -v there is a call to ld.lld which I thought is the llvm linker. Does ld.lld still use the GNU ld?"}, {"owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "edited": false, "score": 0, "creation_date": 1530709191, "post_id": 51174029, "comment_id": 89331348, "body": "If the linker is invoked with <code>-lgcc</code>, it must look for libgcc, even if it later notices that none of the objects of libgcc are referenced and thus not linked into the final executable. I assume the developers did not bother to differentiate the call based on the linker being used."}, {"owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "reply_to_user": {"reputation": 2667, "user_id": 572332, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ede4acd1b1775241fa41834dd1406fef?s=128&d=identicon&r=PG&f=1", "display_name": "robor", "link": "https://stackoverflow.com/users/572332/robor"}, "edited": false, "score": 1, "creation_date": 1530709317, "post_id": 51174029, "comment_id": 89331428, "body": "@robor78 Yes, ld.lld is the LLVM linker. It seems it still uses libgcc even though they don&#39;t mention it: <a href=\"https://lld.llvm.org/\" rel=\"nofollow noreferrer\">lld.llvm.org</a> - Maybe an issue to report if not done already."}, {"owner": {"reputation": 6958, "user_id": 857727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3772f7ef99bd17c1e77d77edbf76c13d?s=128&d=identicon&r=PG&f=1", "display_name": "arnt", "link": "https://stackoverflow.com/users/857727/arnt"}, "edited": false, "score": 5, "creation_date": 1530710745, "post_id": 51174029, "comment_id": 89332349, "body": "libgcc contains system-specific code/information the current llvm contributors don&#39;t particularly want to duplicate or keep in sync, but your program often needs. This is sort of intentional, in the sense that it&#39;s known and that working on it isn&#39;t a priority for any of the developers. If someone were to step up with a functional patch, things might change."}], "tags": [], "owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "is_accepted": false, "score": 10, "last_activity_date": 1530709951, "last_edit_date": 1530709951, "creation_date": 1530708293, "answer_id": 51174029, "question_id": 51173869, "link": "https://stackoverflow.com/questions/51173869/why-does-clang-still-need-libgcc-a-to-compile-my-code/51174029#51174029", "title": "Why does clang still need libgcc.a to compile my code?", "body": "<p>Clang does not come with a linker, it relies on <code>ld</code> instead. And <code>ld</code> depends on <code>libgcc.a</code> and/or <code>libgcc.so</code> on your system (regardless this is the <a href=\"https://lld.llvm.org/\" rel=\"noreferrer\">LLVM linker</a> <code>ld.lld</code> or GNU ld). This is the reason why you have this error message.</p>\n\n<p>So the answer is actually:</p>\n\n<blockquote>\n  <p>(a) the linker requires libgcc to do its own linking work</p>\n</blockquote>\n\n<p>A lot more details on this are available <a href=\"http://www.omniprog.info/clang_no_gcc.html\" rel=\"noreferrer\">here at omniprog.info</a>:</p>\n\n<blockquote>\n  <p>If we want to get rid of GCC and use clang as our default compiler on\n  the system, we may have to make some adjustments on some RPM-based\n  systems. Clang does not provide a linker, but relies on the system's\n  linker, typically ld, to link executables. This is the case even on\n  FreeBSD and Mac OS X systems where Clang is the default compiler. We\n  can see this using the -v option to clang++. Now, ld won't work\n  without the following files:</p>\n  \n  <blockquote>\n    <p>libgcc.a<br>\n    libgcc_s.so<br>\n    [...]</p>\n  </blockquote>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "is_accepted": true, "score": 3, "last_activity_date": 1530730600, "creation_date": 1530730600, "answer_id": 51179578, "question_id": 51173869, "link": "https://stackoverflow.com/questions/51173869/why-does-clang-still-need-libgcc-a-to-compile-my-code/51179578#51179578", "title": "Why does clang still need libgcc.a to compile my code?", "body": "<p>You must compile with the option <code>-nodefaultlib</code> or <code>-nostdlibs</code>.</p>\n\n<p>Here a quote from <a href=\"https://gcc.gnu.org/onlinedocs/gcc-8.1.0/gcc/Link-Options.html#Link-Options\" rel=\"nofollow noreferrer\">GCC documentation</a> (clang interface is just the same):</p>\n\n<blockquote>\n  <p>One of the standard libraries bypassed by <code>-nostdlib</code> and <code>-nodefaultlibs</code> is <code>libgcc.a</code>, a library of internal subroutines which GCC uses to overcome shortcomings of particular machines, or special needs for some languages. </p>\n</blockquote>\n\n<p>You may have to <a href=\"https://gcc.gnu.org/onlinedocs/gccint/Initialization.html\" rel=\"nofollow noreferrer\">execute c++ static initialization routines</a> and/or use what is provided by the object files <code>crt&lt;x&gt;.o</code> in the lib directory. These files are part of <code>libc</code> and provides executable entry point.</p>\n"}, {"comments": [{"owner": {"reputation": 1775, "user_id": 5066895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bHw56.png?s=128&g=1", "display_name": "Dieter Meemken", "link": "https://stackoverflow.com/users/5066895/dieter-meemken"}, "edited": false, "score": 0, "creation_date": 1560865690, "post_id": 56650306, "comment_id": 99871053, "body": "Can you explain a bit more?"}, {"owner": {"reputation": 1, "user_id": 7058135, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KlWZmZNeoR8/AAAAAAAAAAI/AAAAAAAAADM/IPn9weK4ra4/photo.jpg?sz=128", "display_name": "hameed abbasi", "link": "https://stackoverflow.com/users/7058135/hameed-abbasi"}, "reply_to_user": {"reputation": 1775, "user_id": 5066895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bHw56.png?s=128&g=1", "display_name": "Dieter Meemken", "link": "https://stackoverflow.com/users/5066895/dieter-meemken"}, "edited": false, "score": 0, "creation_date": 1567935992, "post_id": 56650306, "comment_id": 102109443, "body": "Sorry for late answer. all I remember is that, in latest Qt at time(5.11) compiling with latest Android NDK should be OK as the documentations said. but it didn&#39;t work with errors of not finding things related to GCC. after digging and not finding answer, I replaced latest Android NDK-r20 with an earlier one NDK-r19 and surprisingly it worked!"}], "tags": [], "owner": {"reputation": 1, "user_id": 7058135, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KlWZmZNeoR8/AAAAAAAAAAI/AAAAAAAAADM/IPn9weK4ra4/photo.jpg?sz=128", "display_name": "hameed abbasi", "link": "https://stackoverflow.com/users/7058135/hameed-abbasi"}, "is_accepted": false, "score": 0, "last_activity_date": 1567936027, "last_edit_date": 1567936027, "creation_date": 1560864503, "answer_id": 56650306, "question_id": 51173869, "link": "https://stackoverflow.com/questions/51173869/why-does-clang-still-need-libgcc-a-to-compile-my-code/56650306#56650306", "title": "Why does clang still need libgcc.a to compile my code?", "body": "<p>Just in case\nI use Qt and for running apps on Android with Qt versions greater than 5.11, had this problem with the latest Android Sdk and NDK-r20c. and after some struggles, finally it worked with NDK-r19c.</p>\n"}], "owner": {"reputation": 2667, "user_id": 572332, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ede4acd1b1775241fa41834dd1406fef?s=128&d=identicon&r=PG&f=1", "display_name": "robor", "link": "https://stackoverflow.com/users/572332/robor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3755, "favorite_count": 4, "accepted_answer_id": 51179578, "answer_count": 3, "score": 15, "last_activity_date": 1567936027, "creation_date": 1530707737, "question_id": 51173869, "link": "https://stackoverflow.com/questions/51173869/why-does-clang-still-need-libgcc-a-to-compile-my-code", "title": "Why does clang still need libgcc.a to compile my code?", "body": "<pre><code>int main(int argc, char **argv)\n{\n    return 0;\n}\n</code></pre>\n\n<p>I cross compile (host= linux x86_64, target= linux aarch64)</p>\n\n<p><code>/path/to/clang --target=aarch64-linux-gnu -v main.cpp -o main -fuse-ld=lld  -L./libs -lc -lc_nonshared -Xlinker -Map=a.map</code></p>\n\n<p>In the -L./libs folder I've put all the dependencies from the target. When I exclude libgcc.a this linker error happens</p>\n\n<p><code>ld.lld: error: unable to find library -lgcc</code></p>\n\n<p>I've added the -Map option to get information about the linked static libraries. In the map file I cannot see references to libgcc.a ... but I battle to read the map file. There are plenty of lines with <code>&lt;internal&gt;</code>. Not sure what those are.  See a.map at the bottom</p>\n\n<p><strong>Questions</strong></p>\n\n<ol>\n<li>Why is libgcc.a still required for such a simple program? I read <a href=\"https://gcc.gnu.org/onlinedocs/gccint/Libgcc.html\" rel=\"noreferrer\">1</a> and <a href=\"https://stackoverflow.com/questions/9414625/do-i-really-need-libgcc\">2</a> and I looked at <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html#Other-Builtins\" rel=\"noreferrer\">3</a>.</li>\n<li>Does \n\n<ul>\n<li>(a) the linker require libgcc to do its own linking work, or </li>\n<li>(b) does the linker use libgcc because my code requires something that is provided for by libgcc</li>\n<li>I think it's (b), but I just want to be sure.</li>\n</ul></li>\n</ol>\n\n<hr>\n\n<p>a.map</p>\n\n<pre><code>     VMA              LMA     Size Align Out     In      Symbol\n   10270            10270       1b     1 .interp\n   10270            10270       1b     1         &lt;internal&gt;:(.interp)\n   10290            10290       a8     8 .dynsym\n   10290            10290       a8     8         &lt;internal&gt;:(.dynsym)\n   10338            10338        e     2 .gnu.version\n   10338            10338        e     2         &lt;internal&gt;:(.gnu.version)\n   10348            10348       20     4 .gnu.version_r\n   10348            10348       20     4         &lt;internal&gt;:(.gnu.version_r)\n   10368            10368       1c     8 .gnu.hash\n   10368            10368       1c     8         &lt;internal&gt;:(.gnu.hash)\n   10384            10384       87     1 .dynstr\n   10384            10384       87     1         &lt;internal&gt;:(.dynstr)\n   10410            10410       18     8 .rela.dyn\n   10410            10410       18     8         &lt;internal&gt;:(.rela.dyn)\n   10428            10428       48     8 .rela.plt\n   10428            10428       48     8         &lt;internal&gt;:(.rela.plt)\n   10470            10470       20     4 .note.ABI-tag\n   10470            10470       20     4         crt1.o:(.note.ABI-tag)\n   10470            10470        0     1                 $d\n   10490            10490        4     4 .rodata\n   10490            10490        4     4         &lt;internal&gt;:(.rodata)\n   10494            10494        c     4 .eh_frame_hdr\n   10494            10494        c     4         &lt;internal&gt;:(.eh_frame_hdr)\n   104a0            104a0        4     4 .eh_frame\n   20000            20000      210     8 .text\n   20000            20000       48     8         crt1.o:(.text)\n   20000            20000        0     1                 $x\n   20000            20000        0     1                 _start\n   2002c            2002c        0     1                 $d\n   20048            20048       14     4         crti.o:(.text)\n   20048            20048        0     1                 $x\n   20048            20048       14     1                 call_weak_fn\n   20060            20060       e0     8         crtbegin.o:(.text)\n   20060            20060        0     1                 $x\n   20060            20060        0     1                 deregister_tm_clones\n   20090            20090        0     1                 $d\n   20098            20098        0     1                 $x\n   20098            20098        0     1                 register_tm_clones\n   200d0            200d0        0     1                 $d\n   200d8            200d8        0     1                 $x\n   200d8            200d8        0     1                 __do_global_dtors_aux\n   20108            20108        0     1                 frame_dummy\n   20138            20138        0     1                 $d\n   20140            20140       54     4         /tmp/main-762849.o:(.text)\n   20140            20140        0     1                 $x.0\n   20140            20140       10     1                 do_math(int*)\n   20150            20150       44     1                 main\n   20194            20194       7c     4         ./libs/libc_nonshared.a(elf-init.oS):(.text)\n   20194            20194        0     1                 $x\n   20194            20194       78     1                 __libc_csu_init\n   2020c            2020c        4     1                 __libc_csu_fini\n   20210            20210        0     1         crtend.o:(.text)\n   20210            20210        0     1         crtn.o:(.text)\n   20210            20210       14     4 .init\n   20210            20210        c     4         crti.o:(.init)\n   20210            20210        0     1                 $x\n   20210            20210        0     1                 _init\n   2021c            2021c        8     1         crtn.o:(.init)\n   2021c            2021c        0     1                 $x\n   20224            20224       10     4 .fini\n   20224            20224        8     4         crti.o:(.fini)\n   20224            20224        0     1                 $x\n   20224            20224        0     1                 _fini\n   2022c            2022c        8     1         crtn.o:(.fini)\n   2022c            2022c        0     1                 $x\n   20240            20240       50    16 .plt\n   20240            20240       50    16         &lt;internal&gt;:(.plt)\n   30000            30000       10     8 .data\n   30000            30000        4     1         crt1.o:(.data)\n   30000            30000        0     1                 data_start\n   30000            30000        0     1                 __data_start\n   30004            30004        0     1         crti.o:(.data)\n   30008            30008        8     8         crtbegin.o:(.data)\n   30008            30008        0     1                 $d\n   30008            30008        0     1                 __dso_handle\n   30010            30010        0     1         ./libs/libc_nonshared.a(elf-init.oS):(.data)\n   30010            30010        0     1         crtend.o:(.data)\n   30010            30010        0     1         crtn.o:(.data)\n   30010            30010        0     8 .tm_clone_table\n   30010            30010        0     8         crtbegin.o:(.tm_clone_table)\n   30010            30010        0     1                 __TMC_LIST__\n   30010            30010        0     8         crtend.o:(.tm_clone_table)\n   30010            30010        0     1                 __TMC_END__\n   30010            30010       30     8 .got.plt\n   30010            30010       30     8         &lt;internal&gt;:(.got.plt)\n   40000            40000        8     8 .jcr\n   40000            40000        0     8         crtbegin.o:(.jcr)\n   40000            40000        0     1                 __JCR_LIST__\n   40000            40000        8     8         crtend.o:(.jcr)\n   40000            40000        0     1                 $d\n   40000            40000        0     1                 __JCR_END__\n   40008            40008        8     8 .fini_array\n   40008            40008        8     8         crtbegin.o:(.fini_array)\n   40008            40008        0     1                 $d\n   40008            40008        0     1                 __do_global_dtors_aux_fini_array_entry\n   40010            40010        8     8 .init_array\n   40010            40010        8     8         crtbegin.o:(.init_array)\n   40010            40010        0     1                 $d\n   40010            40010        0     1                 __frame_dummy_init_array_entry\n   40018            40018      180     8 .dynamic\n   40018            40018      180     8         &lt;internal&gt;:(.dynamic)\n   40198            40198        8     8 .got\n   40198            40198        8     8         &lt;internal&gt;:(.got)\n   50000            50000        1     1 .bss\n   50000            50000        0     1         crt1.o:(.bss)\n   50000            50000        0     1         crti.o:(.bss)\n   50000            50000        1     1         crtbegin.o:(.bss)\n   50000            50000        1     1                 completed.7557\n   50000            50000        0     1                 $d\n   50001            50001        0     1         ./libs/libc_nonshared.a(elf-init.oS):(.bss)\n   50001            50001        0     1         crtend.o:(.bss)\n   50001            50001        0     1         crtn.o:(.bss)\n       0                0       24     1 .gnu_debuglink\n       0                0        c     1         crt1.o:(.gnu_debuglink)\n       c                c        c     1         crti.o:(.gnu_debuglink)\n      18               18        c     1         crtn.o:(.gnu_debuglink)\n       0                0       9d     1 .comment\n       0                0       9d     1         &lt;internal&gt;:(.comment)\n       0                0      5b8     8 .symtab\n       0                0      5b8     8         &lt;internal&gt;:(.symtab)\n       0                0      119     1 .shstrtab\n       0                0      119     1         &lt;internal&gt;:(.shstrtab)\n       0                0      228     1 .strtab\n       0                0      228     1         &lt;internal&gt;:(.strtab)\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 369, "user_id": 10028853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GZN0.jpg?s=128&g=1", "display_name": "Stahp", "link": "https://stackoverflow.com/users/10028853/stahp"}, "edited": false, "score": 0, "creation_date": 1530706615, "post_id": 51173481, "comment_id": 89329681, "body": "I made mistake in the title - im sorry. I meant inherit class :("}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1530706760, "post_id": 51173481, "comment_id": 89329776, "body": "If you made a mistake in your title, <a href=\"https://stackoverflow.com/posts/51173481/edit\">edit</a> your post to fix it. Commenting on it is just white noise."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 2, "creation_date": 1530706806, "post_id": 51173481, "comment_id": 89329801, "body": "A derived class can&#39;t access <code>private</code> members of a base class.   They can access <code>protected</code> members.   Derived classes are not friends.   Any parent who has had hostile children would understand the need to keep some things private, even from descendants.   It goes the same way, philosophically, in software design"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1530708545, "post_id": 51173481, "comment_id": 89330932, "body": "@Peter <i>Descendants can&#39;t access your privates, but good friends can!</i> -- It&#39;s worn out, but you deserved it :p"}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1530737994, "post_id": 51173481, "comment_id": 89343772, "body": "@Peter any child who has hostile parents understands that need, too :)"}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1530707312, "post_id": 51173539, "comment_id": 89330136, "body": "The side note is superior to the main note."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1530707378, "post_id": 51173539, "comment_id": 89330181, "body": "I think the idiomatic way can be made more idiomatic. Or in other words: &quot;y u ignore z&quot;?"}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1530707630, "post_id": 51173539, "comment_id": 89330349, "body": "@StoryTeller I didn&#39;t get it, what do you mean?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1530707721, "post_id": 51173539, "comment_id": 89330408, "body": "Ah, apologies. I was indulging my like for internet memes. Like <a href=\"http://knowyourmeme.com/memes/y-u-no-guy\" rel=\"nofollow noreferrer\">this</a> and <a href=\"http://knowyourmeme.com/memes/y-u-do-dis\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1530707721, "post_id": 51173539, "comment_id": 89330409, "body": "@Bathsheba I agree, but I wanted to answer the question first, in order not for the answer to be flagged as &quot;off-topic&quot; !"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1530707783, "post_id": 51173539, "comment_id": 89330444, "body": "@OlivierSohn: It wouldn&#39;t be. If I were you, I&#39;d start with &quot;The best way, by a country mile, is to write your constructor&quot;, followed by your third snippet, then the text that currently forms the first part of your answer."}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1530708036, "post_id": 51173539, "comment_id": 89330587, "body": "@Bathsheba I like it the way it is, because it gradually leads to the best solution imho, which is probably easier to follow for the author of the question."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1530708097, "post_id": 51173539, "comment_id": 89330650, "body": "@OlivierSohn: Well it&#39;s your answer innit. But do bear in mind that we are building a Q &amp; A site here; helping the OP ought to be regarded as a corollary. And I&#39;d upvote if you re-ordered it."}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1530708240, "post_id": 51173539, "comment_id": 89330742, "body": "@Bathsheba with the current wording of the question, I think my answer is quite appropriate : the title says that a member cannot be accessed, and I explain how to access the member. Straightforward. Then, I explain that there are ways to keep encapsulation here."}], "tags": [], "owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "is_accepted": false, "score": 2, "last_activity_date": 1530707600, "last_edit_date": 1530707600, "creation_date": 1530706693, "answer_id": 51173539, "question_id": 51173481, "link": "https://stackoverflow.com/questions/51173481/constructor-cant-access-inherit-class-private-int/51173539#51173539", "title": "Constructor can&#39;t access inherit class private int", "body": "<p>To make <code>x</code> and <code>y</code> accessible to derived classes, you should make them protected:</p>\n\n<pre><code>class Point\n{\nprotected:\n    int x, y;\npublic:\n    Point();\n    Point(int x, int y);\n    int getX();\n    int getY();\n};\n</code></pre>\n\n<p>By default, the visibility of a class member is <code>private</code> (note that this is different from the struct default where a struct member is <code>public</code> by default). On that topic, see <a href=\"https://stackoverflow.com/questions/1247745/default-visibility-of-c-class-struct-members\">this answer</a>.</p>\n\n<p>And as a side note, the idiomatic way to initialize <code>x</code> and <code>y</code> would be to write:</p>\n\n<pre><code>Point3D(int x ,int y, int z) : pt::Point(x,y)\n{\n    this-&gt;z=z;\n}\n</code></pre>\n\n<p>Then, you don't need to make <code>x</code> and <code>y</code> protected, they can remain private.</p>\n\n<p>You can even write it like that:</p>\n\n<pre><code>Point3D(int x ,int y, int z) : pt::Point(x,y), z(z)\n{}\n</code></pre>\n"}], "owner": {"reputation": 369, "user_id": 10028853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GZN0.jpg?s=128&g=1", "display_name": "Stahp", "link": "https://stackoverflow.com/users/10028853/stahp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530708335, "creation_date": 1530706538, "last_edit_date": 1530708335, "question_id": 51173481, "link": "https://stackoverflow.com/questions/51173481/constructor-cant-access-inherit-class-private-int", "title": "Constructor can&#39;t access inherit class private int", "body": "<p>Class Point is working correctly, It is creating x, y point. Code:</p>\n\n<p>point.h file</p>\n\n<pre><code>#ifndef POINT_H\n#define POINT_H\n\nnamespace pt\n{\n    class Point\n    {\n        int x, y;\n    public:\n        Point();\n        Point(int x, int y);\n        int getX();\n        int getY();\n    };\n}\n#endif // POINT_H\n</code></pre>\n\n<p>point.cpp file</p>\n\n<pre><code>#include \"point.h\"\n\npt::Point::Point()\n{\n    this-&gt;x = this-&gt;y = 0;\n}\n\npt::Point::Point(int x, int y)\n{\n    this-&gt;x=x;\n    this-&gt;y=y;\n}\n\nint pt::Point::getX()\n{\n    return this-&gt;x;\n}\n\nint pt::Point::getY()\n{\n    return this-&gt;y;\n}\n</code></pre>\n\n<p>Meanwhile when I try to create new Point3D class in main that will inherit from Point x, y coordinates and add z to create third dimension, new constructor cant get access to x, y of Point class. Errors are:\n1. 'int pt::Point::x' is private at first and second this-> in Point3D constr.\n2. Both are 'out of context' </p>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"point.h\"\n\nint main()\n{\n    class Point3D : public pt::Point\n    {\n        int z;\n    public:\n        getZ()\n        {\n            return this-&gt;z;\n        }\n\n        Point3D(int x ,int y, int z)\n        {\n            this-&gt;x=x;\n            this-&gt;y=y;\n            this-&gt;z=z;\n        }\n    };\n    return 0;\n}\n</code></pre>\n\n<p>Thanks for help.</p>\n"}, {"tags": ["c++", "shared-ptr", "biometrics", "make-shared", "facial-identification"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 4, "creation_date": 1530706466, "post_id": 51173434, "comment_id": 89329584, "body": "One question per question on stackoverflow.com, please."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 1, "creation_date": 1530706581, "post_id": 51173434, "comment_id": 89329659, "body": "Consider Code Review SE instead. Avoid cross posting."}, {"owner": {"reputation": 432, "user_id": 4961684, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10206530057031335/picture?type=large", "display_name": "Carlos Ost", "link": "https://stackoverflow.com/users/4961684/carlos-ost"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1530706592, "post_id": 51173434, "comment_id": 89329663, "body": "@SamVarshavchik All 5 questions are related to the same context. Why replicate the context 5 times? Sorry, but seems that you didn&#39;t even read everything. Thank you anyway."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 3, "creation_date": 1530706629, "post_id": 51173434, "comment_id": 89329691, "body": "Neither have I. You should take into account what @SamVarshavchik said. As-is, this is too broad for SO format."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1530708106, "post_id": 51173434, "comment_id": 89330653, "body": "The advice is relevant because that&#39;s how the model and <a href=\"https://stackoverflow.com/help/closed-questions\">scope of SO is defined</a>."}], "answers": [{"comments": [{"owner": {"reputation": 432, "user_id": 4961684, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10206530057031335/picture?type=large", "display_name": "Carlos Ost", "link": "https://stackoverflow.com/users/4961684/carlos-ost"}, "edited": false, "score": 0, "creation_date": 1530710480, "post_id": 51174087, "comment_id": 89332180, "body": "The comments made by NIST, suggests the use of make_shared inside the implementation. Why you recommend to use shared_ptr inside the implementation? Would it be a better approach?"}, {"owner": {"reputation": 3204, "user_id": 2228338, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-b3jn9hCpWYU/AAAAAAAAAAI/AAAAAAAAAAs/-1U-aoxnBOc/photo.jpg?sz=128", "display_name": "Yuki", "link": "https://stackoverflow.com/users/2228338/yuki"}, "reply_to_user": {"reputation": 432, "user_id": 4961684, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10206530057031335/picture?type=large", "display_name": "Carlos Ost", "link": "https://stackoverflow.com/users/4961684/carlos-ost"}, "edited": false, "score": 0, "creation_date": 1530711638, "post_id": 51174087, "comment_id": 89332916, "body": "The former is just shorter.))"}], "tags": [], "owner": {"reputation": 3204, "user_id": 2228338, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-b3jn9hCpWYU/AAAAAAAAAAI/AAAAAAAAAAs/-1U-aoxnBOc/photo.jpg?sz=128", "display_name": "Yuki", "link": "https://stackoverflow.com/users/2228338/yuki"}, "is_accepted": false, "score": 1, "last_activity_date": 1530711606, "last_edit_date": 1530711606, "creation_date": 1530708465, "answer_id": 51174087, "question_id": 51173434, "link": "https://stackoverflow.com/questions/51173434/c-interfaces-factory-function-implementation/51174087#51174087", "title": "C++ interface&#39;s factory function implementation", "body": "<p>I think you can just do the following:</p>\n\n<pre><code>std::shared_ptr&lt;Interface&gt; Implementation::getImplementation() {\n  return std::make_shared&lt;Implementation&gt;();\n}\n\nint main() {\n    auto interface = Implementation::getImplementation();\n}\n</code></pre>\n\n<p>And <code>interface</code> will be of type <code>std::shared_ptr&lt;Interface&gt;</code>. You can further pass it around.</p>\n"}], "owner": {"reputation": 432, "user_id": 4961684, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10206530057031335/picture?type=large", "display_name": "Carlos Ost", "link": "https://stackoverflow.com/users/4961684/carlos-ost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "closed_date": 1530792418, "answer_count": 1, "score": 0, "last_activity_date": 1530795191, "creation_date": 1530706383, "last_edit_date": 1530795191, "question_id": 51173434, "link": "https://stackoverflow.com/questions/51173434/c-interfaces-factory-function-implementation", "closed_reason": "Needs more focus", "title": "C++ interface&#39;s factory function implementation", "body": "<p><strong>Contextualization:</strong></p>\n\n<p>I am working on an algorithm of facial recognition and NIST is the organization that is trying to standardize the tests, measurement and comparison among all available algorithms. In order to be tested and compared, I need to implement their interface, which is available in <a href=\"https://github.com/usnistgov/frvt\" rel=\"nofollow noreferrer\">FRVT Project</a>, more specifically at <a href=\"https://github.com/usnistgov/frvt/tree/master/11_verification\" rel=\"nofollow noreferrer\">frvt11.h</a> file.</p>\n\n<p><strong>frvt11.h</strong> Relevant code for this question:</p>\n\n<pre><code>namespace FRVT {\n\n//...A lot of code defining ReturnStatus, ReturnCode, etc.\n\n/**\n* @brief\n* The interface to FRVT 1:1 implementation\n*\n* @details\n* The submission software under test will implement this interface by\n* sub-classing this class and implementing each method therein.\n*/\nclass Interface {\npublic:\n   virtual ~Interface() {}\n\n   virtual ReturnStatus\n    initialize(const std::string &amp;configDir) = 0;\n\n   /**\n   * @brief\n   * Factory method to return a managed pointer to the Interface object.\n   * @details\n   * This function is implemented by the submitted library and must return\n   * a managed pointer to the Interface object.\n   *\n   * @note\n   * A possible implementation might be:\n   * return (std::make_shared&lt;Implementation&gt;());\n   */\n   static std::shared_ptr&lt;Interface&gt;\n   getImplementation();\n};\n}\n</code></pre>\n\n<p><strong>implementation.h</strong> Relevant code of the implementation I am developing:</p>\n\n<pre><code>#include \"frvt11.h\"\nusing namespace FRVT;\n\nstruct Implementation : public Interface {\n\n    ReturnStatus\n    initialize(const std::string &amp;configDir) override;\n\n    static std::shared_ptr&lt;Interface&gt;\n    getImplementation();\n};\n</code></pre>\n\n<p><strong>implementation.cpp</strong> Relevant code of the implementation I am developing:</p>\n\n<pre><code>#include \"implementation.h\"\nusing namespace FRVT;\n\nReturnStatus\nImplementation::initialize(\n    const std::string &amp;configDir) {\n        return ReturnStatus(ReturnCode::Success,\" - initialize\");\n}\n\nstd::shared_ptr&lt;Interface&gt;\nImplementation::getImplementation() {\n    return (std::make_shared&lt;Implementation&gt;());\n}\n</code></pre>\n\n<p>Finally my question:</p>\n\n<p><strong>Question:</strong> How to implement getImplementation() in order to return the referred \"managed pointer to the Interface object\"?</p>\n"}, {"tags": ["java", "c++", "max"], "comments": [{"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 2, "creation_date": 1530706332, "post_id": 51173395, "comment_id": 89329505, "body": "Unfortunately, SO is not a code translation service. I suggest you take the <a href=\"https://stackoverflow.com/tour\">tour</a> and visit the <a href=\"https://stackoverflow.com/help\">help center</a> and don&#39;t use unrelated tags such as <code>java</code> and <code>c++</code>. Welcome to SO."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1530706408, "post_id": 51173395, "comment_id": 89329552, "body": "<a href=\"https://juristr.com/blog/2008/03/java-generics-c-class-templates-vs-java/\" rel=\"nofollow noreferrer\">juristr.com/blog/2008/03/&hellip;</a>"}, {"owner": {"reputation": 33331, "user_id": 1898563, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d99204bcce923f40f5c72b7f80121644?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1898563/michael"}, "edited": false, "score": 2, "creation_date": 1530706421, "post_id": 51173395, "comment_id": 89329566, "body": "Java doesn&#39;t have templates. It has generics which are similar but more restricted."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1530706545, "post_id": 51173395, "comment_id": 89329630, "body": "Java has a different object model. It doesn&#39;t really need the same notion of templates that C++ has. Your question feels a little XY-like to me."}, {"owner": {"reputation": 3354, "user_id": 1993392, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/1ZcA5.jpg?s=128&g=1", "display_name": "M. le Rutte", "link": "https://stackoverflow.com/users/1993392/m-le-rutte"}, "edited": false, "score": 0, "creation_date": 1530706974, "post_id": 51173395, "comment_id": 89329929, "body": "Use the functions already available in <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Math.html#max-double-double-\" rel=\"nofollow noreferrer\"><code>java.lang.Math</code></a>?"}, {"owner": {"reputation": 9, "user_id": 10032029, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4A8zdqYP3v4/AAAAAAAAAAI/AAAAAAAAAAc/uZ1sKqAvoog/photo.jpg?sz=128", "display_name": "xychen", "link": "https://stackoverflow.com/users/10032029/xychen"}, "reply_to_user": {"reputation": 3354, "user_id": 1993392, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/1ZcA5.jpg?s=128&g=1", "display_name": "M. le Rutte", "link": "https://stackoverflow.com/users/1993392/m-le-rutte"}, "edited": false, "score": 0, "creation_date": 1530708944, "post_id": 51173395, "comment_id": 89331191, "body": "@M. le Rutte. I want to ask another question. now I have a function void swap(int[] arr , int i , int j ). If I have other array type to change some element. what i show do?"}], "answers": [{"comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1530706453, "post_id": 51173446, "comment_id": 89329578, "body": "How does this realize the OP&#39;s <code>max</code> function?"}, {"owner": {"reputation": 185, "user_id": 9602261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eugene Mart", "link": "https://stackoverflow.com/users/9602261/eugene-mart"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1530706565, "post_id": 51173446, "comment_id": 89329642, "body": "public T max(T a, T b) {          return (a&gt;b) ? a : b;     }"}, {"owner": {"reputation": 185, "user_id": 9602261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eugene Mart", "link": "https://stackoverflow.com/users/9602261/eugene-mart"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1530706596, "post_id": 51173446, "comment_id": 89329665, "body": "What is the problem with your function? Why does it not work? Are there any errors?"}, {"owner": {"reputation": 1019, "user_id": 816855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21cdf26bdaf7452f2ace9cd1cb63b0e0?s=128&d=identicon&r=PG", "display_name": "Rosme", "link": "https://stackoverflow.com/users/816855/rosme"}, "edited": false, "score": 2, "creation_date": 1530706986, "post_id": 51173446, "comment_id": 89329941, "body": "You didn&#39;t provide an actual answer. You just said use generics and provided a generic example that has nothing to do with the max function OP&#39;s trying to reproduce."}, {"owner": {"reputation": 4255, "user_id": 2838289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b29129a40a7e4aac388c4a1bbc85afc?s=128&d=identicon&r=PG&f=1", "display_name": "LuCio", "link": "https://stackoverflow.com/users/2838289/lucio"}, "edited": false, "score": 2, "creation_date": 1530707454, "post_id": 51173446, "comment_id": 89330227, "body": "@EugeneMart The code in your comment don&#39;t even compile because of several errors. Main reason: <code>T</code> is a parameter for non primitive types whereas the binary operator <code>&gt;</code> may only be used with primitve numbers."}], "tags": [], "owner": {"reputation": 185, "user_id": 9602261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eugene Mart", "link": "https://stackoverflow.com/users/9602261/eugene-mart"}, "is_accepted": false, "score": -2, "last_activity_date": 1530706419, "creation_date": 1530706419, "answer_id": 51173446, "question_id": 51173395, "link": "https://stackoverflow.com/questions/51173395/java-how-to-realize-function-template-like-c/51173446#51173446", "title": "Java how to realize function template like C++", "body": "<p>Use generics. They are like templates but work in runtime</p>\n\n<pre><code>    package test; \n\nclass BoxPrinter&lt;T&gt; { \n    private T val; \n\n    public BoxPrinter(T arg) { \n        val = arg; \n    } \n\n    public String toString() { \n        return \"{\" + val + \"}\"; \n    } \n\n    public T getValue() { \n        return val; \n    } \n    } \n</code></pre>\n\n<p><a href=\"https://www.geeksforgeeks.org/generics-in-java/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/generics-in-java/</a> <br>\nMore examples here</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 10032029, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4A8zdqYP3v4/AAAAAAAAAAI/AAAAAAAAAAc/uZ1sKqAvoog/photo.jpg?sz=128", "display_name": "xychen", "link": "https://stackoverflow.com/users/10032029/xychen"}, "edited": false, "score": 0, "creation_date": 1530708091, "post_id": 51173494, "comment_id": 89330639, "body": "thanks a lot. I want to ask another question. If i have a function void swap(int[] arr ,int i ,int j ). How can I expand to any array that I can use this swap function."}, {"owner": {"reputation": 33331, "user_id": 1898563, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d99204bcce923f40f5c72b7f80121644?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1898563/michael"}, "reply_to_user": {"reputation": 9, "user_id": 10032029, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4A8zdqYP3v4/AAAAAAAAAAI/AAAAAAAAAAc/uZ1sKqAvoog/photo.jpg?sz=128", "display_name": "xychen", "link": "https://stackoverflow.com/users/10032029/xychen"}, "edited": false, "score": 1, "creation_date": 1530708615, "post_id": 51173494, "comment_id": 89330981, "body": "@xychen &quot;I want to ask another question&quot; there&#39;s <a href=\"https://stackoverflow.com/questions/ask\">already a good way for you to do that</a> ;)"}], "tags": [], "owner": {"reputation": 33331, "user_id": 1898563, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d99204bcce923f40f5c72b7f80121644?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1898563/michael"}, "is_accepted": false, "score": 2, "last_activity_date": 1530706578, "creation_date": 1530706578, "answer_id": 51173494, "question_id": 51173395, "link": "https://stackoverflow.com/questions/51173395/java-how-to-realize-function-template-like-c/51173494#51173494", "title": "Java how to realize function template like C++", "body": "<p>You can use generics. Because generics do not work with primitives, and objects cannot be compared with greater-than and less-than operators, we must instead restrict the input types to <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Comparable.html\" rel=\"nofollow noreferrer\"><code>Comparable</code>s</a> (things which can be compared) so that we can use the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Comparable.html#compareTo-T-\" rel=\"nofollow noreferrer\"><code>compareTo</code></a> method instead:</p>\n\n<pre><code>public static &lt;T extends Comparable&lt;T&gt;&gt; T max(T first, T second)\n{\n    return first.compareTo(second) &gt;= 0 ? first : second;\n}\n</code></pre>\n\n<p>Sample usage:</p>\n\n<pre><code>max(1, 2)\n</code></pre>\n\n<p>will <a href=\"https://docs.oracle.com/javase/tutorial/java/data/autoboxing.html\" rel=\"nofollow noreferrer\">autobox</a> the primitives to <a href=\"https://docs.oracle.com/javase/8/docs/api/?java/lang/Integer.html\" rel=\"nofollow noreferrer\"><code>Integer</code>s</a> (which do implement <code>Comparable&lt;Integer&gt;</code>) and return 2.</p>\n"}, {"comments": [{"owner": {"reputation": 33331, "user_id": 1898563, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d99204bcce923f40f5c72b7f80121644?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1898563/michael"}, "edited": false, "score": 0, "creation_date": 1530707056, "post_id": 51173497, "comment_id": 89329998, "body": "Just FYI, the convention of the contracts of most (maybe all) <code>max</code> implementations I&#39;ve seen is to return the first argument if the two are equal. Yours returns the second. (Not a problem for <code>Number</code>s, but potentially could be for other <code>Comparable</code> types)"}, {"owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "reply_to_user": {"reputation": 33331, "user_id": 1898563, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d99204bcce923f40f5c72b7f80121644?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1898563/michael"}, "edited": false, "score": 0, "creation_date": 1530707555, "post_id": 51173497, "comment_id": 89330303, "body": "@Michael I was following OP&#39;s c++ code as close as possible, but I agree with this comment"}], "tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": false, "score": 1, "last_activity_date": 1530706587, "creation_date": 1530706587, "answer_id": 51173497, "question_id": 51173395, "link": "https://stackoverflow.com/questions/51173395/java-how-to-realize-function-template-like-c/51173497#51173497", "title": "Java how to realize function template like C++", "body": "<p>The underlying assumption in the <a href=\"/questions/tagged/c%2b%2b\" class=\"post-tag\" title=\"show questions tagged &#39;c++&#39;\" rel=\"tag\">c++</a> code is that the <code>T</code> type supports the <code>&gt;</code> operator. Java doesn't have operator overloading, but the equivalent would be to limit the code to <code>T</code>s that implement the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Comparable.html\" rel=\"nofollow noreferrer\"><code>Comparable</code></a> interface:</p>\n\n<pre><code>public static &lt;T extends Comparable&lt;T&gt;&gt; T max(T x, T y)\n{\n    if (x.compareTo(y) &gt; 0) {\n        return x;\n    }\n    return y;\n}\n</code></pre>\n\n<p>Or, alternatively, allow the caller to pass a custom <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html\" rel=\"nofollow noreferrer\"><code>Comparator</code></a>:</p>\n\n<pre><code>public static &lt;T&gt; T max(T x, T y, Comparator&lt;T&gt; cmp)\n{\n    if (cmp.compare(x, y) &gt; 0) {\n        return x;\n    }\n    return y;\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10032029, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4A8zdqYP3v4/AAAAAAAAAAI/AAAAAAAAAAc/uZ1sKqAvoog/photo.jpg?sz=128", "display_name": "xychen", "link": "https://stackoverflow.com/users/10032029/xychen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "answer_count": 3, "score": -4, "last_activity_date": 1530706743, "creation_date": 1530706225, "last_edit_date": 1530706743, "question_id": 51173395, "link": "https://stackoverflow.com/questions/51173395/java-how-to-realize-function-template-like-c", "title": "Java how to realize function template like C++", "body": "<p>My English is not good. So I try to explain my question in code. Please try to answer me in code. It makes me understand easily.</p>\n\n<p>I have a question: In C++\uff0cwe can realize that like these codes.</p>\n\n<pre><code>int max(int x,int y)\n{\n   return (x&gt;y)?x:y;\n}\nfloat max(float x,float y)\n{\n   return (x&gt;y)?x:y;\n}\n</code></pre>\n\n<p>I can do this to expand code </p>\n\n<pre><code>template &lt;class T&gt;\nT max(T x, T y)\n{\nreturn (x&gt;y)?x:y;\n}\n</code></pre>\n\n<p>How can I realize the similar function in Java.</p>\n"}, {"tags": ["c++", "fixed-size-types"], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 10023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d88fe0ff393523aee72bf40dd983b3d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kasata Ata", "link": "https://stackoverflow.com/users/10023636/kasata-ata"}, "edited": false, "score": 0, "creation_date": 1530706405, "post_id": 51173407, "comment_id": 89329550, "body": "I just realized how stupid the second question was. *8_t is releated to number of bits. :)"}, {"owner": {"reputation": 165, "user_id": 10023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d88fe0ff393523aee72bf40dd983b3d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kasata Ata", "link": "https://stackoverflow.com/users/10023636/kasata-ata"}, "edited": false, "score": 0, "creation_date": 1530706476, "post_id": 51173407, "comment_id": 89329592, "body": "But how does probable scenario look like? Considering windows, linux, and mac, both x86 and x64, are those types rather supported or not?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 165, "user_id": 10023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d88fe0ff393523aee72bf40dd983b3d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kasata Ata", "link": "https://stackoverflow.com/users/10023636/kasata-ata"}, "edited": false, "score": 1, "creation_date": 1530706692, "post_id": 51173407, "comment_id": 89329733, "body": "@KasataAta On all &quot;normal&quot; platforms, all of the common types exist. If you have to target more exotic systems like an IBM mainframe (<code>CHARBIT == 9</code> iirc) or embedded systems like digital cameras, things might look different. But you&#39;ll know when you get there."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1530706697, "post_id": 51173407, "comment_id": 89329736, "body": "If you&#39;re only interested in x86 platforms, you&#39;ll be able to use all the types mentioned.  Platforms lacking 8-bit types tend to be DSPs or mainframes (possibly some minis, too), and you should use the more portable types if there&#39;s any chance your code might be compiled for those."}], "tags": [], "owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "is_accepted": false, "score": 3, "last_activity_date": 1530706733, "last_edit_date": 1530706733, "creation_date": 1530706292, "answer_id": 51173407, "question_id": 51173366, "link": "https://stackoverflow.com/questions/51173366/understanding-fixed-width-integer-types/51173407#51173407", "title": "Understanding fixed width integer types", "body": "<p>If the implementation does not provide the type you used, it will not exist and your code will not compile. Manual porting will be needed in this case.</p>\n\n<p>Regarding your second question: while we know that <code>sizeof(char) == 1</code>, it is not guaranteed that <code>char</code> has exactly eight bits; it can have more than that. If that is the case <code>int8_t</code> and friends will not exist.</p>\n\n<p>Note that there are other types that might provide sufficient guarantees for your use case if you don't need to know the exact width, such as <code>int_least8_t</code> or <code>int_fast8_t</code>. Those leave the implementation some more freedom, making them more portable.</p>\n\n<p>However, if you are targeting a platform on which common integer types do not exist, you should know that in advance anyway; so it is not worth spending too much time working around those most likely irrelevant issues. Those platforms are relatively exotic.</p>\n"}], "owner": {"reputation": 165, "user_id": 10023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d88fe0ff393523aee72bf40dd983b3d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kasata Ata", "link": "https://stackoverflow.com/users/10023636/kasata-ata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1530707571, "creation_date": 1530706110, "last_edit_date": 1530707571, "question_id": 51173366, "link": "https://stackoverflow.com/questions/51173366/understanding-fixed-width-integer-types", "title": "Understanding fixed width integer types", "body": "<p>I understand the idea of fixed width types, but I am little confused by the explanation provided by the reference:</p>\n\n<blockquote>\n  <p>signed integer type with width of exactly 8, 16, 32 and 64 bits respectively\n  with no padding bits and using 2's complement for negative values\n  <strong>(provided only if the implementation directly supports the type)</strong></p>\n</blockquote>\n\n<p>So as far as I understand, if I was able to compile an application, everything should work on platforms which are able to run it. There are my questions:</p>\n\n<ol>\n<li>What if some platform does not provide support for those types? Is some kind of alignment used or can the application not at all?</li>\n<li>If we have a guarantee that <code>sizeof(char)</code> is exactly one byte on every platform, regardless of byte size which can be different among platforms, does it mean that <code>int8_t</code> and <code>uint8_t</code> are guaranteed to be available everywhere?</li>\n</ol>\n"}, {"tags": ["c++", "parent-child", "metaprogramming", "variadic-templates"], "answers": [{"tags": [], "owner": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "is_accepted": false, "score": 0, "last_activity_date": 1530709445, "creation_date": 1530709445, "answer_id": 51174413, "question_id": 51173345, "link": "https://stackoverflow.com/questions/51173345/getting-original-type-of-this-object/51174413#51174413", "title": "getting original type of this object", "body": "<p>OK, I've thought a lot about this, and decided to add the original type as another template argument.\nSo the class signature will be something like:</p>\n\n<pre><code>template&lt;typename TOwnTag, typename TParentTag, typename... TParentTags, typename... TChildTags&gt;\nclass Obj&lt;TOwnTag, std::tuple&lt;TParentTag, TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;\n    : public Obj&lt;TOwnTag, std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;\n{\n    using TOwn = typename TOwnTag::obj_type;\n</code></pre>\n\n<p>This seems to fix my issue, as I can now use </p>\n\n<pre><code>reinterpret_cast&lt;TOwn* const&gt;(this)\n</code></pre>\n\n<p>The complete working code then becomes:</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n\ntemplate&lt;class T&gt;\nusing prtVector = std::vector&lt;T*&gt;;\n\nclass BaseObject {\npublic:\n    virtual prtVector&lt;BaseObject&gt; getAllParents() const = 0;\n    virtual prtVector&lt;BaseObject&gt; getAllChildren() const = 0;\n    virtual void removeAllParents() = 0;\n    virtual void removeAllChildren() = 0;\n};\n\ntemplate&lt;typename TOwnTag, typename TParentTuple, typename TChilderenTuple&gt;\nclass Obj;\n\ntemplate&lt;typename TOwnTag, typename TParentTag, typename... TParentTags, typename... TChildTags&gt;\nclass Obj&lt;TOwnTag, std::tuple&lt;TParentTag, TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;\n    : public Obj&lt;TOwnTag, std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;\n{\n    using TOwn = typename TOwnTag::obj_type;\n    using TParent = typename TParentTag::obj_type;\n    prtVector&lt;TParent&gt; parentsPtrs;\npublic:\n    //prevent base function hiding\n    using Obj&lt;TOwnTag, std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;::addParent;\n    using Obj&lt;TOwnTag, std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;::removeParent;\n\n    void addParent(TParent* const parentPtr) { parentsPtrs.push_back(parentPtr); }\n    void removeParent(TParent const* const parentPtr) {\n        auto it = std::find(std::cbegin(parentsPtrs), std::cend(parentsPtrs), parentPtr);\n        if (it != std::cend(parentsPtrs)) parentsPtrs.erase(it);\n    }\n\n    virtual prtVector&lt;BaseObject&gt; getAllParents() const override {\n        auto result = Obj&lt;TOwnTag, std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;::getAllParents();\n        result.insert(std::begin(result), std::cbegin(parentsPtrs), std::cend(parentsPtrs));\n        return result;\n    }\n    virtual prtVector&lt;BaseObject&gt; getAllChildren() const override {\n        return Obj&lt;TOwnTag, std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;::getAllChildren();\n    }\n    virtual void removeAllParents() override {\n        Obj&lt;TOwnTag, std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;::removeAllParents();\n        for (auto&amp;&amp; parent : parentsPtrs) parent-&gt;removeChild(reinterpret_cast&lt;TOwn* const&gt;(this));\n    }\n    virtual void removeAllChildren() override {\n        Obj&lt;TOwnTag, std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;::removeAllChildren();\n    }\n};\n\ntemplate&lt;typename TOwnTag, typename TChildTag, typename... TChildTags&gt;\nclass Obj&lt;TOwnTag, std::tuple&lt;&gt;, std::tuple&lt;TChildTag, TChildTags...&gt;&gt;\n    : public Obj&lt;TOwnTag, std::tuple&lt;&gt;, std::tuple&lt;TChildTags...&gt;&gt;\n{\n    using TOwn = typename TOwnTag::obj_type;\n    using TChild = typename TChildTag::obj_type;\n    prtVector&lt;TChild&gt; childrenPtrs;\npublic:\n    void addParent() {}\n    void removeParent() {}\n    //prevent base function hiding\n    using Obj&lt;TOwnTag, std::tuple&lt;&gt;, std::tuple&lt;TChildTags...&gt;&gt;::addChild;\n    using Obj&lt;TOwnTag, std::tuple&lt;&gt;, std::tuple&lt;TChildTags...&gt;&gt;::removeChild;\n\n    void addChild(TChild* const childPtr) { childrenPtrs.push_back(childPtr); }\n    void removeChild(TChild const* const childPtr) {\n        auto it = std::find(std::cbegin(childrenPtrs), std::cend(childrenPtrs), childPtr);\n        if (it != std::cend(childrenPtrs)) childrenPtrs.erase(it);\n    }\n\n    virtual prtVector&lt;BaseObject&gt; getAllParents() const override {\n        return Obj&lt;TOwnTag, std::tuple&lt;&gt;, std::tuple&lt;TChildTags...&gt;&gt;::getAllParents();\n    }\n    virtual prtVector&lt;BaseObject&gt; getAllChildren() const override {\n        auto result = Obj&lt;TOwnTag, std::tuple&lt;&gt;, std::tuple&lt;TChildTags...&gt;&gt;::getAllChildren();\n        result.insert(std::begin(result), std::cbegin(childrenPtrs), std::cend(childrenPtrs));\n        return result;\n    }\n    virtual void removeAllParents() override {}\n    virtual void removeAllChildren() override {\n        Obj&lt;TOwnTag, std::tuple&lt;&gt;, std::tuple&lt;TChildTags...&gt;&gt;::removeAllChildren();\n        for (auto&amp;&amp; child : childrenPtrs) child-&gt;removeParent(reinterpret_cast&lt;TOwn* const&gt;(this));\n    }\n};\n\ntemplate&lt;typename TOwnTag&gt;\nclass Obj&lt;TOwnTag, std::tuple&lt;&gt;, std::tuple&lt;&gt;&gt; : public BaseObject {\npublic:\n    void addChild() {}\n    void removeChild() {}\n    void addParent() {}\n    void removeParent() {}\n    //\n    virtual prtVector&lt;BaseObject&gt; getAllParents() const override {\n        return prtVector&lt;BaseObject&gt;();\n    }\n    virtual prtVector&lt;BaseObject&gt; getAllChildren() const override {\n        return prtVector&lt;BaseObject&gt;();\n    }\n    virtual void removeAllParents() override {}\n    virtual void removeAllChildren() override {}\n};\n\nstruct Human_tag;\nstruct Tree_tag;\nstruct Dog_tag;\nstruct Parasite_tag;\n\nusing Human = Obj&lt;Human_tag, std::tuple&lt;&gt;, std::tuple&lt;Tree_tag, Dog_tag&gt;&gt;;\nusing Tree = Obj&lt;Tree_tag, std::tuple&lt;Human_tag&gt;, std::tuple&lt;&gt;&gt;;\nusing Dog = Obj&lt;Dog_tag, std::tuple&lt;Human_tag&gt;, std::tuple&lt;Parasite_tag&gt;&gt;;\nusing Parasite = Obj&lt;Parasite_tag, std::tuple&lt;Dog_tag&gt;, std::tuple&lt;&gt;&gt;;\n\nstruct Human_tag { using obj_type = Human; };\nstruct Tree_tag { using obj_type = Tree; };\nstruct Dog_tag { using obj_type = Dog; };\nstruct Parasite_tag { using obj_type = Parasite; };\n\ntemplate&lt;class A, class B&gt;\nvoid addRelation(A* const a, B* const b)\n{\n    a-&gt;addChild(b);\n    b-&gt;addParent(a);\n}\n\n#include &lt;iostream&gt;\nint main() {\n    Human h1;\n    Dog d1, d2;\n    //Parasite p1;\n\n    addRelation(&amp;h1, &amp;d1);\n    addRelation(&amp;h1, &amp;d2);\n    //addRelation(&amp;h1, &amp;p1); // compiler error\n    auto result = h1.getAllChildren();\n    std::cout &lt;&lt; result.size() &lt;&lt; \"\\n\"; //print 2\n    d1.removeAllParents();\n    result = h1.getAllChildren();\n    std::cout &lt;&lt; result.size() &lt;&lt; \"\\n\"; //print 1\n\n    std::cin.ignore();\n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/eWVXrEX8wkrUYiXg\" rel=\"nofollow noreferrer\">Live Example</a></p>\n"}, {"comments": [{"owner": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 0, "creation_date": 1530735521, "post_id": 51180093, "comment_id": 89343071, "body": "Wow, very nice, this way no casting is required. thank you. <a href=\"https://stackoverflow.com/questions/51161645/conflictions-declaration-redefinition-different-basic-types\">I was trying this before</a>, but since I&#39;m not familiar with things like <code>std::get&lt;std::vector&lt;T*&gt;&gt;(parents)</code> and <code>std::apply</code> (and did not find any posts suggesting their use) I couldn&#39;t get it to work. Hence my solution below."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 1, "creation_date": 1530736537, "post_id": 51180093, "comment_id": 89343366, "body": "Btw, I think you need the <code>OwnTag</code>, else you might have problem with <code>using Tree = Obj&lt;std::tuple&lt;Human_tag&gt;, std::tuple&lt;&gt;&gt;; using House = Obj&lt;std::tuple&lt;Human_tag&gt;, std::tuple&lt;&gt;&gt;;</code> (<code>House</code> and <code>Tree</code> would be the same object)."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 1, "last_activity_date": 1530734522, "last_edit_date": 1530734522, "creation_date": 1530733963, "answer_id": 51180093, "question_id": 51173345, "link": "https://stackoverflow.com/questions/51173345/getting-original-type-of-this-object/51180093#51180093", "title": "getting original type of this object", "body": "<p>With C++17, you may do (without cast):</p>\n\n<pre><code>template&lt;typename TParentTuple, typename TChilderenTuple&gt;\nclass Obj;\n\ntemplate&lt;typename... ParentTags,\n         typename... ChildTags&gt;\nclass Obj&lt;std::tuple&lt;ParentTags...&gt;, std::tuple&lt;ChildTags...&gt;&gt; : public BaseObject\n{\n    std::tuple&lt;std::vector&lt;typename ParentTags::obj_type*&gt;...&gt; parents;\n    std::tuple&lt;std::vector&lt;typename ChildTags::obj_type*&gt;...&gt; children;\n\npublic:\n\n    template &lt;typename T&gt;\n    void addParent(T* parent) { std::get&lt;std::vector&lt;T*&gt;&gt;(parents).push_back(parent); }\n\n    template &lt;typename T&gt;\n    void removeParent(const T* parent) {\n        auto&amp; v = std::get&lt;std::vector&lt;T*&gt;&gt;(parents);\n        auto it = std::find(std::cbegin(v), std::cend(v), parent);\n        if (it != std::cend(v)) { v.erase(it); }\n    }\n\n    template &lt;typename T&gt;\n    void addChild(T* child) { std::get&lt;std::vector&lt;T*&gt;&gt;(children).push_back(child); }\n\n    template &lt;typename T&gt;\n    void removeChild(const T* child) {\n        auto&amp; v = std::get&lt;std::vector&lt;T*&gt;&gt;(children);\n        auto it = std::find(std::cbegin(v), std::cend(v), child);\n        if (it != std::cend(v)) { v.erase(it); }\n    }\n\n    std::vector&lt;BaseObject*&gt; getAllParents() const override {\n        std::vector&lt;BaseObject*&gt; res;\n\n        std::apply([&amp;](auto&amp;... v){ (res.insert(res.end(), v.begin(), v.end()), ...); },\n                   parents);\n        return res;\n    }\n    std::vector&lt;BaseObject*&gt; getAllChildren() const override {\n        std::vector&lt;BaseObject*&gt; res;\n\n        std::apply([&amp;](auto&amp;... v){ (res.insert(res.end(), v.begin(), v.end()), ...); },\n                   children);\n        return res;\n    }\n\n    void removeAllParents() override {\n        std::apply(\n            [this](auto&amp;... v)\n            {\n                [[maybe_unused]] auto clean = [this](auto&amp; v) {\n                    for (auto* parent : v) {\n                        parent-&gt;removeChild(this);\n                    }\n                    v.clear();\n                };\n                (clean(v), ...);\n            },\n            parents);\n    }\n\n    void removeAllChildren() override {\n        std::apply(\n            [this](auto&amp;... v)\n            {\n                [[maybe_unused]] auto clean = [this](auto&amp; v) {\n                    for (auto* child : v) {\n                        child-&gt;removeParent(this);\n                    }\n                    v.clear();\n                };\n                ( clean(v), ...);\n            },\n            children);\n    }\n};\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/670914821562e8ea\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<p>With C++14, it would be more verbose to replace the \"for_each_tuple\" done with <code>std::apply</code> and folding expression.</p>\n\n<p>and in C++11, even more with <code>std::get&lt;T&gt;(tuple)</code>.</p>\n"}], "owner": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 51180093, "answer_count": 2, "score": 1, "last_activity_date": 1530734522, "creation_date": 1530706028, "question_id": 51173345, "link": "https://stackoverflow.com/questions/51173345/getting-original-type-of-this-object", "title": "getting original type of this object", "body": "<p>I'm trying to use metaprogramming to prevent duplicate code in a parent-child structure. I got it working up to a certain point. </p>\n\n<p>The code shown at the bottom compilers and runt correctly, but some relations (<code>/*Tree_tag,*/</code> and <code>/*Parasite_tag*/</code>) are commented out. If uncommented, MSVS2017 shows</p>\n\n<pre><code>error C2664: 'void Obj&lt;std::tuple&lt;Human_tag&gt;,std::tuple&lt;&gt;&gt;::removeParent(const Obj&lt;std::tuple&lt;&gt;,std::tuple&lt;Tree_tag,Dog_tag&gt;&gt; *const )': cannot convert argument 1 from 'Obj&lt;std::tuple&lt;&gt;,std::tuple&lt;Dog_tag&gt;&gt; *' to 'const Obj&lt;std::tuple&lt;&gt;,std::tuple&lt;Tree_tag,Dog_tag&gt;&gt; *const '\nnote: Types pointed to are unrelated; conversion requires reinterpret_cast, C-style cast or function-style cast\n</code></pre>\n\n<p>and G++ shows</p>\n\n<pre><code>In instantiation of \u2018void Obj&lt;std::tuple&lt;&gt;, std::tuple&lt;_El0, _El ...&gt; ::removeAllChildren() [with TChildTag = Dog_tag; TChildTags = {}]\u2019:\nMain.cpp:126:1:   required from here\nMain.cpp:73:43: error: invalid conversion from \u2018Obj&lt;std::tuple&lt;&gt;, std::tuple&lt;Dog_tag&gt; &gt;*\u2019 to \u2018const TParent* {aka const Obj&lt;std::tuple&lt;&gt;, std::tuple&lt;Tree_tag, Dog_tag&gt; &gt;*}\u2019 [-fpermissive]\n    for (auto&amp;&amp; child : childrenPtrs) child-&gt;removeParent(this);\n</code></pre>\n\n<p>The problem is with the <code>this</code> type qualifiers. Because I iteratively strip off template arguments with for instance</p>\n\n<pre><code>class Obj&lt;std::tuple&lt;&gt;, std::tuple&lt;TChildTag, TChildTags...&gt;&gt;\n: public Obj&lt;std::tuple&lt;&gt;, std::tuple&lt;TChildTags...&gt;&gt;\n</code></pre>\n\n<p>the resulting <code>this</code> of the base type does not match the original type. Like the error shows: the original type of <code>Human</code> = <code>Obj&lt;std::tuple&lt;&gt;,std::tuple&lt;Tree_tag,Dog_tag&gt;&gt;</code>. However, due to the iterative stripping, the type of <code>this</code> in the base is <code>Obj&lt;std::tuple&lt;&gt;,std::tuple&lt;Dog_tag&gt;&gt;</code>.</p>\n\n<p>I tried to use <code>reinterpret_cast</code> as suggested:</p>\n\n<pre><code>template&lt;typename T&gt;\nvoid addParent(T* const parentPtr) {\n    parentsPtrs.push_back(reinterpret_cast&lt;TParent* const&gt;(parentPtr));\n}\ntemplate&lt;typename T&gt;\nvoid removeParent(T const* const parentPtr) {\n    auto it = std::find(std::cbegin(parentsPtrs), std::cend(parentsPtrs),\n        reinterpret_cast&lt;TParent const* const&gt;(parentPtr));\n    if (it != std::cend(parentsPtrs)) parentsPtrs.erase(it);\n}\n</code></pre>\n\n<p>But then the problem is that <strong>everything</strong> is cast to an allowed parameter. I.e. this code works:</p>\n\n<pre><code>int main() {\n    Human h1;\n    Parasite p1;\n    addRelation(&amp;h1, &amp;p1);\n}\n</code></pre>\n\n<p>...Which should not be possible, as <code>Human</code> and <code>Parasite</code> are not related directly.</p>\n\n<p>So how can I correctly keep the <code>this</code> type qualifiers of the top (most derivative) class, complying to <code>Human</code>, <code>Dog</code>, etc types?</p>\n\n<p>Working code(with comments):</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;vector&gt;\n\ntemplate&lt;class T&gt;\nusing prtVector = std::vector&lt;T*&gt;;\n\nclass BaseObject {\npublic:\n    virtual prtVector&lt;BaseObject&gt; getAllParents() const = 0;\n    virtual prtVector&lt;BaseObject&gt; getAllChildren() const = 0;\n    virtual void removeAllParents() = 0;\n    virtual void removeAllChildren() = 0;\n};\n\ntemplate&lt;typename TParentTuple, typename TChilderenTuple&gt;\nclass Obj;\n\ntemplate&lt;typename TParentTag, typename... TParentTags, typename... TChildTags&gt;\nclass Obj&lt;std::tuple&lt;TParentTag, TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;\n    : public Obj&lt;std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;\n{\n    using TParent = typename TParentTag::obj_type;\n    prtVector&lt;TParent&gt; parentsPtrs;\npublic:\n    void addParent(TParent* const parentPtr) { parentsPtrs.push_back(parentPtr); }\n    void removeParent(TParent const* const parentPtr) {\n        auto it = std::find(std::cbegin(parentsPtrs), std::cend(parentsPtrs), parentPtr);\n        if (it != std::cend(parentsPtrs)) parentsPtrs.erase(it);\n    }\n\n    virtual prtVector&lt;BaseObject&gt; getAllParents() const override {\n        auto result = Obj&lt;std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;::getAllParents();\n        result.insert(std::begin(result), std::cbegin(parentsPtrs), std::cend(parentsPtrs));\n        return result;\n    }\n    virtual prtVector&lt;BaseObject&gt; getAllChildren() const override {\n        return Obj&lt;std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;::getAllChildren();\n    }\n    virtual void removeAllParents() override {\n        Obj&lt;std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;::removeAllParents();\n        for (auto&amp;&amp; parent : parentsPtrs) parent-&gt;removeChild(this);\n    }\n    virtual void removeAllChildren() override {\n        Obj&lt;std::tuple&lt;TParentTags...&gt;, std::tuple&lt;TChildTags...&gt;&gt;::removeAllChildren();\n    }\n};\n\ntemplate&lt;typename TChildTag, typename... TChildTags&gt;\nclass Obj&lt;std::tuple&lt;&gt;, std::tuple&lt;TChildTag, TChildTags...&gt;&gt;\n    : public Obj&lt;std::tuple&lt;&gt;, std::tuple&lt;TChildTags...&gt;&gt;\n{\n    using TChild = typename TChildTag::obj_type;\n    prtVector&lt;TChild&gt; childrenPtrs;\npublic:\n    void addChild(TChild* const childPtr) { childrenPtrs.push_back(childPtr); }\n    void removeChild(TChild const* const childPtr) {\n        auto it = std::find(std::cbegin(childrenPtrs), std::cend(childrenPtrs), childPtr);\n        if (it != std::cend(childrenPtrs)) childrenPtrs.erase(it);\n    }\n\n    virtual prtVector&lt;BaseObject&gt; getAllParents() const override {\n        return Obj&lt;std::tuple&lt;&gt;, std::tuple&lt;TChildTags...&gt;&gt;::getAllChildren();\n    }\n    virtual prtVector&lt;BaseObject&gt; getAllChildren() const override {\n        auto result = Obj&lt;std::tuple&lt;&gt;, std::tuple&lt;TChildTags...&gt;&gt;::getAllChildren();\n        result.insert(std::begin(result), std::cbegin(childrenPtrs), std::cend(childrenPtrs));\n        return result;\n    }\n    virtual void removeAllParents() override {}\n    virtual void removeAllChildren() override {\n        Obj&lt;std::tuple&lt;&gt;, std::tuple&lt;TChildTags...&gt;&gt;::removeAllChildren();\n        for (auto&amp;&amp; child : childrenPtrs) child-&gt;removeParent(this);\n    }\n};\n\ntemplate&lt;&gt;\nclass Obj&lt;std::tuple&lt;&gt;, std::tuple&lt;&gt;&gt; : public BaseObject {\npublic:\n    virtual prtVector&lt;BaseObject&gt; getAllParents() const override {\n        return prtVector&lt;BaseObject&gt;();\n    }\n    virtual prtVector&lt;BaseObject&gt; getAllChildren() const override {\n        return prtVector&lt;BaseObject&gt;();\n    }\n    virtual void removeAllParents() override {}\n    virtual void removeAllChildren() override {}\n};\n\nstruct Human_tag;\nstruct Tree_tag;\nstruct Dog_tag;\nstruct Parasite_tag;\n\nusing Human = Obj&lt;std::tuple&lt;&gt;, std::tuple&lt;/*Tree_tag,*/ Dog_tag&gt;&gt;;\nusing Tree = Obj&lt;std::tuple&lt;Human_tag&gt;, std::tuple&lt;&gt;&gt;;\nusing Dog = Obj&lt;std::tuple&lt;Human_tag&gt;, std::tuple&lt;/*Parasite_tag*/&gt;&gt;;\nusing Parasite = Obj&lt;std::tuple&lt;Dog_tag&gt;, std::tuple&lt;&gt;&gt;;\n\nstruct Human_tag { using obj_type = Human; };\nstruct Tree_tag { using obj_type = Tree; };\nstruct Dog_tag { using obj_type = Dog; };\nstruct Parasite_tag { using obj_type = Parasite; };\n\ntemplate&lt;class A, class B&gt;\nvoid addRelation(A* a, B* b)\n{\n    a-&gt;addChild(b);\n    b-&gt;addParent(a);\n}\n\n#include &lt;iostream&gt;\nint main() {\n    Human h1;\n    Dog d1, d2;\n\n    addRelation(&amp;h1, &amp;d1);\n    addRelation(&amp;h1, &amp;d2);\n    auto result = h1.getAllChildren();\n    std::cout &lt;&lt; result.size() &lt;&lt; \"\\n\"; //print 2\n    d1.removeAllParents();\n    result = h1.getAllChildren();\n    std::cout &lt;&lt; result.size() &lt;&lt; \"\\n\"; //print 1\n\n    std::cin.ignore();\n}\n</code></pre>\n"}, {"tags": ["c++", "android-ndk", "g++", "cross-compiling"], "comments": [{"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 2, "creation_date": 1530706039, "post_id": 51173318, "comment_id": 89329323, "body": "shouldn&#39;t it be declared <code>extern &quot;C&quot;</code> ?"}, {"owner": {"reputation": 149, "user_id": 7899308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb0880d1751ce771eda2ea5c8422e84?s=128&d=identicon&r=PG&f=1", "display_name": "Xudong Shao", "link": "https://stackoverflow.com/users/7899308/xudong-shao"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 1, "creation_date": 1530754830, "post_id": 51173318, "comment_id": 89347002, "body": "Yeah, you are right. It&#39;s probably because the .so is a C shared library. Thanks!"}], "owner": {"reputation": 149, "user_id": 7899308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb0880d1751ce771eda2ea5c8422e84?s=128&d=identicon&r=PG&f=1", "display_name": "Xudong Shao", "link": "https://stackoverflow.com/users/7899308/xudong-shao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1530713409, "creation_date": 1530705944, "question_id": 51173318, "link": "https://stackoverflow.com/questions/51173318/aarch64-linux-android-g-cant-find-an-exported-function", "title": "aarch64-linux-android-g++ can&#39;t find an exported function", "body": "<p>everyone. I am using aarch64-linux-android-g++ to compile a binary.\nThe code is this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint diag_wakelock_destroy();\n\nint main(int argc, char **argv){\n    printf(\"hello world\");\n    char mystring[] = \"hi\";\n    int result = diag_wakelock_destroy();\n\n    printf(\"finish! return: %d\\n\", result);\n\n    return 0;\n}\n</code></pre>\n\n<p>The function diag_wakelock_destroy is defined in libdiag.so as we can see from IDA or just use \"nm -D libdiag.so\". But when I compiled it with this command</p>\n\n<pre><code>aarch64-linux-android-g++ --sysroot=$SYSROOT -g -fpie -pie -o exe_fine hi_diag.cpp libdiag.so liblog.so libcutils.so libc++.so libm.so libc.so ld-android.so -ldl -L.\n</code></pre>\n\n<p>I got this error.</p>\n\n<pre><code>/tmp/ccUb4ImK.o: In function `main':\n/home/sam/Documents/test/lib-diag/hi_diag.cpp:13: undefined reference to \n`diag_wakelock_destroy()'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>So it can't find that exported function! This is weird. Can anyone help me ? Thanks!</p>\n"}, {"tags": ["c++", "qt", "qcustomplot"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4853414"}, "edited": false, "score": 0, "creation_date": 1530718778, "post_id": 51175560, "comment_id": 89336950, "body": "It worked as I wanted, thanks a lot. Although, it was displaying y for x.         &#39;double y= r-&gt;axis(QCPAxis::atLeft)-&gt;pixelToCoord(event-&gt;x());&#39;. Thanks."}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 1, "last_activity_date": 1530771654, "last_edit_date": 1530771654, "creation_date": 1530712991, "answer_id": 51175560, "question_id": 51173216, "link": "https://stackoverflow.com/questions/51173216/how-can-i-display-a-key-value-pair-on-a-tooltip-across-two-graphs/51175560#51175560", "title": "How can I display a key/value pair on a ToolTip across two graphs?", "body": "<p>What you have to do is verify that QCPAxisRect is above the cursor. and then get the axes of each QCPAxisRect and then the values:</p>\n\n<pre><code>void showToolTip(QMouseEvent *event){\n    for(QCPLayoutElement *element : plotLayout()-&gt;elements(true)){\n        QCPAxisRect *axisRect = static_cast&lt;QCPAxisRect *&gt;(element);\n        if(axisRect){\n            if(axisRect-&gt;rect().contains(event-&gt;pos())){\n                double x= axisRect-&gt;axis(QCPAxis::atBottom)-&gt;pixelToCoord(event-&gt;x());\n                double y= axisRect-&gt;axis(QCPAxis::atLeft)-&gt;pixelToCoord(event-&gt;y());\n                setToolTip(tr(\"%1,%2\").arg(x).arg(y));\n                break;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>#include \"qcustomplot.h\"\n\n#include &lt;QApplication&gt;\n\nclass ChartWidget: public QCustomPlot{\npublic:\n    ChartWidget(QWidget *parent=nullptr):QCustomPlot(parent){\n\n        plotLayout()-&gt;clear();\n        QCPAxisRect *leftAxisRect = new QCPAxisRect(this);\n        QCPAxisRect *rightAxisRect = new QCPAxisRect(this);\n        plotLayout()-&gt;addElement(0, 0, leftAxisRect);\n        plotLayout()-&gt;addElement(0, 1, rightAxisRect);\n\n        QVector&lt;QCPGraphData&gt; dataCos(100);\n\n        for(int i=0; i&lt;dataCos.size(); ++i){\n            dataCos[i].key = i/(double)(dataCos.size()-1)*10-5.0;\n            dataCos[i].value = qCos(dataCos[i].key);\n        }\n\n        QCPGraph *mainGraphCos = addGraph(leftAxisRect-&gt;axis(QCPAxis::atBottom), leftAxisRect-&gt;axis(QCPAxis::atLeft));\n        mainGraphCos-&gt;data()-&gt;set(dataCos);\n        mainGraphCos-&gt;valueAxis()-&gt;setRange(-1, 1);\n        mainGraphCos-&gt;rescaleKeyAxis();\n        mainGraphCos-&gt;setPen(QPen(QColor(\"blue\"), 2));\n\n        QVector&lt;QCPGraphData&gt; dataExp(100);\n\n        for(int i=0; i&lt;dataExp.size(); ++i){\n            dataExp[i].key = i/(double)(dataExp.size()-1)*10-5.0;\n            dataExp[i].value = qExp(dataExp[i].key)*qCos(dataExp[i].key);\n        }\n\n        QCPGraph *mainGraphExp = addGraph(rightAxisRect-&gt;axis(QCPAxis::atBottom), rightAxisRect-&gt;axis(QCPAxis::atLeft));\n        mainGraphExp-&gt;data()-&gt;set(dataExp);\n        mainGraphExp-&gt;keyAxis()-&gt;setRange(-5, 5);\n        mainGraphExp-&gt;rescaleValueAxis();\n        mainGraphExp-&gt;setPen(QPen(QColor(\"red\"), 2));\n\n        connect(this, &amp;ChartWidget::mouseMove, this, &amp;ChartWidget::showToolTip);\n    }\nprivate:\n    void showToolTip(QMouseEvent *event){\n        for(QCPLayoutElement *element : plotLayout()-&gt;elements(true)){\n            QCPAxisRect *axisRect = static_cast&lt;QCPAxisRect *&gt;(element);\n            if(axisRect){\n                if(axisRect-&gt;rect().contains(event-&gt;pos())){\n                    double x= axisRect-&gt;axis(QCPAxis::atBottom)-&gt;pixelToCoord(event-&gt;x());\n                    double y= axisRect-&gt;axis(QCPAxis::atLeft)-&gt;pixelToCoord(event-&gt;y());\n                    setToolTip(tr(\"%1,%2\").arg(x).arg(y));\n                    break;\n                }\n            }\n        }\n    }\n};\nint main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n\n    ChartWidget w;\n    w.resize(640, 480);\n    w.show();\n\n    return a.exec();\n}\n</code></pre>\n\n<p>In the following <a href=\"https://github.com/eyllanesc/stackoverflow/tree/master/51173216\" rel=\"nofollow noreferrer\">link</a> you can find the complete example</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4853414"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 1, "accepted_answer_id": 51175560, "answer_count": 1, "score": 4, "last_activity_date": 1530771654, "creation_date": 1530705672, "last_edit_date": 1530705900, "question_id": 51173216, "link": "https://stackoverflow.com/questions/51173216/how-can-i-display-a-key-value-pair-on-a-tooltip-across-two-graphs", "title": "How can I display a key/value pair on a ToolTip across two graphs?", "body": "<p>I am using QCustomPlot to display to graphs, each with a different Key/Value Pairs. On the mouse hover, I am expecting to see the key/value pairs per graph, but instead, I am seeing the first graph on the right as shown on the picture</p>\n\n<p><img src=\"https://i.stack.imgur.com/C71H9.png\" alt=\"\"></p>\n\n<p>How can I do this to make it work better? </p>\n\n<p><strong>What I expected to be the behavior</strong></p>\n\n<p>For the graph to show the key/value pair for each graph, as the mouse cursor is placed on it.</p>\n\n<p><strong>What I have tried so far</strong></p>\n\n<p>Signal/Slot connection</p>\n\n<pre><code>connect(this,&amp;QCustomPlot::mouseMove,this,&amp;ChartWidget::showToolTip);\n</code></pre>\n\n<p>showToolTip slot implementation</p>\n\n<pre><code>   void ChartWidget::showToolTip(QMouseEvent *event){\n      double x = xAxis-&gt;pixelToCoord(event-&gt;pos().x());\n      double y = yAxis-&gt;pixelToCoord(event-&gt;pos().y());\n\n     if(x&gt;0&amp;&amp;y&gt;0 &amp;&amp; x&lt;xAxis-&gt;range().upper) \n     setToolTip(tr(\"%1,%2\").arg(x).arg(y));}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "vssdk"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1530706673, "post_id": 51173203, "comment_id": 89329717, "body": "This change has been rife with integration problems.  Also a big issue with the DbgHelp api and the debuggers provided by the Windows group.  Far, far removed from the DevDiv division.  Heavy smell of a skunk works project in a very big company."}], "answers": [{"tags": [], "owner": {"reputation": 279, "user_id": 6772880, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/o3pZP.jpg?s=128&g=1", "display_name": "Lalindu", "link": "https://stackoverflow.com/users/6772880/lalindu"}, "is_accepted": false, "score": 0, "last_activity_date": 1531369065, "creation_date": 1531369065, "answer_id": 51297233, "question_id": 51173203, "link": "https://stackoverflow.com/questions/51173203/vclinkertool-generatedebuginformation-property-does-not-support-debugfull-and-d/51297233#51297233", "title": "VCLinkerTool.GenerateDebugInformation Property does not support DEBUG:FULL and DEBUG:FASTLINK", "body": "<p>The only way to achieve this seems to be the use of <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.vcprojectengine.ivcrulepropertystorage?view=visualstudiosdk-2017\" rel=\"nofollow noreferrer\">IVCRulePropertyStorage Interface</a></p>\n\n<p>Instructions are <a href=\"https://msdn.microsoft.com/en-us/library/dn655034.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 279, "user_id": 6772880, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/o3pZP.jpg?s=128&g=1", "display_name": "Lalindu", "link": "https://stackoverflow.com/users/6772880/lalindu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 421, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531369065, "creation_date": 1530705641, "last_edit_date": 1530867582, "question_id": 51173203, "link": "https://stackoverflow.com/questions/51173203/vclinkertool-generatedebuginformation-property-does-not-support-debugfull-and-d", "title": "VCLinkerTool.GenerateDebugInformation Property does not support DEBUG:FULL and DEBUG:FASTLINK", "body": "<p>I'm using VS SDK to set project properties of a VS C++ project file. I want to set C++ linker properties Debug information. Following seems to be the required property I have to set:\n<a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.vcprojectengine.vclinkertool.generatedebuginformation?view=visualstudiosdk-2017#remarks\" rel=\"nofollow noreferrer\">VCLinkerTool.GenerateDebugInformation</a></p>\n\n<p>However, as you can see this is a boolean property. But debug information allows 4 values to be set to this by VS:</p>\n\n<ol>\n<li>No </li>\n<li>Debug </li>\n<li>Debug Full</li>\n<li>Fastlink</li>\n</ol>\n\n<p>I want to set Debug Full, but unable to do so since VCLinkerTool.GenerateDebugInformation does not accept string values. Anybody know any other way to achieve this?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1530706109, "post_id": 51173121, "comment_id": 89329366, "body": "<code>input &gt;&gt; index[count];</code> reads a word (e.g. a string till a whitespace is found) and not a line."}, {"owner": {"reputation": 306, "user_id": 8920642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f53897055fff2d7752c4916ecf6347a?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Shirodkar", "link": "https://stackoverflow.com/users/8920642/ashish-shirodkar"}, "edited": false, "score": 1, "creation_date": 1530707095, "post_id": 51173121, "comment_id": 89330027, "body": "<code>int count = 0;</code> should be defined inside <code>while(true){}</code> loop then press ctrl+c to exit. Do you want that infinite while loop?"}, {"owner": {"reputation": 91, "user_id": 9618437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff66778a04db4be0b9e5f0207c4aee5?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Tworkowski", "link": "https://stackoverflow.com/users/9618437/oliver-tworkowski"}, "edited": false, "score": 0, "creation_date": 1530707555, "post_id": 51173121, "comment_id": 89330302, "body": "Ok so apparently you are right. I forgot to reset the counter. Thanks a lot!"}, {"owner": {"reputation": 505, "user_id": 3065592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60527c78c08542c8f4de56f9082e69d?s=128&d=identicon&r=PG&f=1", "display_name": "wtom", "link": "https://stackoverflow.com/users/3065592/wtom"}, "edited": false, "score": 0, "creation_date": 1530707747, "post_id": 51173121, "comment_id": 89330429, "body": "<a href=\"https://stackoverflow.com/questions/20902945/reading-a-string-from-file-c\" title=\"reading a string from file c\">stackoverflow.com/questions/20902945/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 9618437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff66778a04db4be0b9e5f0207c4aee5?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Tworkowski", "link": "https://stackoverflow.com/users/9618437/oliver-tworkowski"}, "edited": false, "score": 0, "creation_date": 1530707307, "post_id": 51173265, "comment_id": 89330130, "body": "It does have an end: while(the endoffile isnt reached){increment} So thath cant be the problem :/"}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "reply_to_user": {"reputation": 91, "user_id": 9618437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff66778a04db4be0b9e5f0207c4aee5?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Tworkowski", "link": "https://stackoverflow.com/users/9618437/oliver-tworkowski"}, "edited": false, "score": 0, "creation_date": 1530707577, "post_id": 51173265, "comment_id": 89330321, "body": "I meant the outer loop <code>while (true)</code>"}, {"owner": {"reputation": 91, "user_id": 9618437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff66778a04db4be0b9e5f0207c4aee5?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Tworkowski", "link": "https://stackoverflow.com/users/9618437/oliver-tworkowski"}, "edited": false, "score": 0, "creation_date": 1530707733, "post_id": 51173265, "comment_id": 89330419, "body": "Ok i read your answer again and from what i understand you might be right. I found the problem. As you said: the counter needs to be reset everytime the while loop starts over so that the array index starts at 0 evertyime we loop through."}], "tags": [], "owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "is_accepted": true, "score": 1, "last_activity_date": 1530705810, "creation_date": 1530705810, "answer_id": 51173265, "question_id": 51173121, "link": "https://stackoverflow.com/questions/51173121/how-can-i-read-strings-from-a-txt-file-in-a-loop-in-c/51173265#51173265", "title": "How can I read strings from a .txt file in a loop in C++", "body": "<p>The problem I see with this code is that you don't break the endless loop, like ever. Because of that you keep on incrementing the <code>count</code> and it finally goes out of range for your string array called <code>index</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "is_accepted": false, "score": 0, "last_activity_date": 1530709961, "last_edit_date": 1530709961, "creation_date": 1530707904, "answer_id": 51173919, "question_id": 51173121, "link": "https://stackoverflow.com/questions/51173121/how-can-i-read-strings-from-a-txt-file-in-a-loop-in-c/51173919#51173919", "title": "How can I read strings from a .txt file in a loop in C++", "body": "<p>Look at the following code, I think it does your mission but it's simpler:</p>\n\n<pre><code>string strBuff[8];\nint count = 0;\nfstream f(\"c:\\\\file.txt\", ios::in);\nif (!f.is_open()) {\n    cout &lt;&lt; \"The file cannot be read\" &lt;&lt; endl;\n    exit(-1);\n}\nwhile (getline(f, strBuff[count])) {\n    count++;\n}\n\ncout &lt;&lt; strBuff[3] &lt;&lt; endl;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 0, "last_activity_date": 1530707962, "creation_date": 1530707962, "answer_id": 51173939, "question_id": 51173121, "link": "https://stackoverflow.com/questions/51173121/how-can-i-read-strings-from-a-txt-file-in-a-loop-in-c/51173939#51173939", "title": "How can I read strings from a .txt file in a loop in C++", "body": "<p>When extracting from a stream, you should check the result, rather than testing beforehand.</p>\n\n<p>You don't need to call <code>open</code>, the constructor that accepts a string does that. You don't need to call <code>close</code>, the destructor does that.</p>\n\n<p>You should only output lines you have read.</p>\n\n<p>Note that you should stop <em>both</em> if your file runs out of lines, or if you have read 8 lines</p>\n\n<p>You can discard most of what you have written. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n\nint main()\n{\n    string index[8];\n    std::size_t count = 0;   \n    for(std::ifstream input(\"passData.txt\"); (count &lt; 8) &amp;&amp; std::getline(input, index[count]); ++count)\n    { \n        // this space intentionally blank\n    }\n    for(std::size_t i = 0; i &lt; count; ++i)\n    {\n        std::cout &lt;&lt; index[i] &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 9618437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff66778a04db4be0b9e5f0207c4aee5?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Tworkowski", "link": "https://stackoverflow.com/users/9618437/oliver-tworkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 51173265, "answer_count": 3, "score": 0, "last_activity_date": 1530709961, "creation_date": 1530705388, "last_edit_date": 1530705667, "question_id": 51173121, "link": "https://stackoverflow.com/questions/51173121/how-can-i-read-strings-from-a-txt-file-in-a-loop-in-c", "title": "How can I read strings from a .txt file in a loop in C++", "body": "<p>My Code:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nstring index[8];\n\nint main() {\n    int count = 0;\n    ifstream input;\n    //input.open(\"passData.txt\");\n    while (true) {\n        input.open(\"passData.txt\");\n        if (!input) {\n            cout &lt;&lt; \"ERROR\" &lt;&lt; endl;\n            system(\"pause\");\n            exit(-1);\n        }\n        else {\n            if (input.is_open()) {\n                while (!input.eof()) {\n                    input &gt;&gt; index[count];\n                    count++;\n                }\n            }\n            for (int i = 0; i &lt; 8; i++) {\n                cout &lt;&lt; index[i] &lt;&lt; endl;\n            }\n        }\n        input.close();\n    }\n    return 0;\n}\n</code></pre>\n\n<p>My approach: opening the file in the beginning and then close it as soon as the lines where read. Also every line should be a single entry in the array.</p>\n\n<p>However, I get an error in a file called \"xutility\" in an iterator.\nThe output is the \"passData.txt\" file, only that its read once and then the error appears. </p>\n\n<p>So, my question: how can I read every line of the file in an array entry, in a loop?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["python", "c++", "xcode", "sh"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8721540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72feeb311b74a06d2525a26a635c6621?s=128&d=identicon&r=PG&f=1", "display_name": "acini", "link": "https://stackoverflow.com/users/8721540/acini"}, "edited": false, "score": 0, "creation_date": 1530708878, "post_id": 51173090, "comment_id": 89331142, "body": "under &quot;which python&quot; I get &quot;/anaconda/bin/python&quot; instead of &quot;anaconda3/lib/python3.6&quot; that I would like.... But is there a way ti &quot;momentarily&quot; change the path? Or to state it explicitly at the beginning of the my_script.sh file?"}, {"owner": {"reputation": 652, "user_id": 5757857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ca141e3116b23f14656644ddd0f679?s=128&d=identicon&r=PG&f=1", "display_name": "dilkash", "link": "https://stackoverflow.com/users/5757857/dilkash"}, "edited": false, "score": 0, "creation_date": 1530710022, "post_id": 51173090, "comment_id": 89331863, "body": "if you want to run only once, you can run:  /anaconda3/lib/python3.6/python my_script.py"}, {"owner": {"reputation": 49, "user_id": 8721540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72feeb311b74a06d2525a26a635c6621?s=128&d=identicon&r=PG&f=1", "display_name": "acini", "link": "https://stackoverflow.com/users/8721540/acini"}, "edited": false, "score": 0, "creation_date": 1530710563, "post_id": 51173090, "comment_id": 89332232, "body": "I get a &quot;no such file or directory&quot;. However under &quot;ls /anaconda3/lib/python3.6&quot; it lists the right files"}], "tags": [], "owner": {"reputation": 25, "user_id": 4002617, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007231150528/picture?type=large", "display_name": "varun Mulayithara Sadasivan", "link": "https://stackoverflow.com/users/4002617/varun-mulayithara-sadasivan"}, "is_accepted": false, "score": 1, "last_activity_date": 1530706500, "last_edit_date": 1530706500, "creation_date": 1530705308, "answer_id": 51173090, "question_id": 51172944, "link": "https://stackoverflow.com/questions/51172944/run-py-script-via-sh-import-module-error/51173090#51173090", "title": "Run .py script via sh import module error", "body": "<p>First, check the python which you are calling the script with is pointing to the anaconda python and it is of the same version you are expecting it to be. You can do \"which python\" command in Linux and Mac to which the path which points to python. It if is pointing to some different version or build of python than the one which you are expecting then add the needed path to the system environment PATH variable. In Linux and Mac this can be done by adding the following line in the .bashrc file at the /home/ folder:</p>\n\n<pre><code>export PATH=/your/python/path:$PATH\n</code></pre>\n\n<p>And then source the .bashrc file.\n    source .bashrc</p>\n\n<p>If you are on a operating system like cent os ,breaking the default python path can break your yum so be careful before changing it.</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 8721540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72feeb311b74a06d2525a26a635c6621?s=128&d=identicon&r=PG&f=1", "display_name": "acini", "link": "https://stackoverflow.com/users/8721540/acini"}, "edited": false, "score": 0, "creation_date": 1530898714, "post_id": 51192077, "comment_id": 89411787, "body": "I&#39;m sorry, but you&#39;re answering another question or I&#39;m not understanding your point..?"}], "tags": [], "owner": {"reputation": 1, "user_id": 9179663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71685e15e0152d9d905c5f37a42faef6?s=128&d=identicon&r=PG&f=1", "display_name": "A.beer", "link": "https://stackoverflow.com/users/9179663/a-beer"}, "is_accepted": false, "score": 0, "last_activity_date": 1530795890, "creation_date": 1530795890, "answer_id": 51192077, "question_id": 51172944, "link": "https://stackoverflow.com/questions/51172944/run-py-script-via-sh-import-module-error/51192077#51192077", "title": "Run .py script via sh import module error", "body": "<p>I am running a script in PyCharm and under the Project Interpretor I have the path \nC:\\envs\\conda\\keras2\\python.exe</p>\n\n<p>When I try to run the script via ssh on the server I get a 'no module named' error. I get \n/usr/bin/python as the ans to 'which python' on the server itself. Could you tell me which path I must add for the script to run properly?</p>\n"}], "owner": {"reputation": 49, "user_id": 8721540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72feeb311b74a06d2525a26a635c6621?s=128&d=identicon&r=PG&f=1", "display_name": "acini", "link": "https://stackoverflow.com/users/8721540/acini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1530795890, "creation_date": 1530704858, "last_edit_date": 1530710168, "question_id": 51172944, "link": "https://stackoverflow.com/questions/51172944/run-py-script-via-sh-import-module-error", "title": "Run .py script via sh import module error", "body": "<p>This is a very basic question on how to code in python and run your script from a very beginner. \nI'm writing a script using Xcode9.4.1 which is supposed to be for python3.6. I then have an sh script run.sh, in the same folder of the script (say \"my_folder\") which simply looks like</p>\n\n<pre><code>python my_script.py\n</code></pre>\n\n<p>The python script looks like</p>\n\n<pre><code>from tick.base import TimeFunction\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nv = np.arange(0., 10., 1.)\nf_v = v + 1\nu = TimeFunction((v, f_v))\nplt.plot(v, u.value(v))\nprint('donne!\\n')\n</code></pre>\n\n<p>But as I try to run my_script.sh from the terminal I get a \"ImportError: No module named tick.base\" error. \nBut the tick folder is actually present in \"my_computer/anaconda3/lib/python3.6/site-packages\" and up to last week I was using Spyder from anaconda navigator and everything was correctly working, so no \"import error\" occurred. </p>\n\n<p>The question is quite trivial, in some sense it simply is \"what's the typical procedure to code and run python script and how modules are supposed to be imported-downloaded when running on a given machine?\"</p>\n\n<p>I need it since my script is to be run on another machine through ssh and using my laptop to make some attempts. Up to last year I used to work in C and only need to move some folders with code and .h files. </p>\n\n<p>Thank for help!</p>\n\n<p>EDIT 1:\nFrom the Spyder 3.2.7 setting, where the script was giving non problem, I printed the </p>\n\n<pre><code>import sys\nprint(sys.path)\n</code></pre>\n\n<p>The -manually- copied the content to the sys.path variable in my_script.py and rerun 'run.sh' and now getting a new (strange) error:</p>\n\n<pre><code>Traceback (most recent call last):\n[...]\n File \"/Users/my_computer/anaconda3/lib/python3.6/site-packages/tick/array/build/array.py\", line 106\ndef tick_double_array_to_file(_file: 'std::string', array: 'ArrayDouble const &amp;') -&gt; \"void\":\n                                   ^\nSyntaxError: invalid syntax\n</code></pre>\n"}, {"tags": ["c++", "vector", "std-pair"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1530704895, "post_id": 51172900, "comment_id": 89328567, "body": "<code>p.erase(p.end());</code> is in both cases an access out of bounds, therefore it invokes undefined behaviour."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 8, "creation_date": 1530704900, "post_id": 51172900, "comment_id": 89328572, "body": "This code is just horrible. You should stay away from sites preaching this nonsense."}, {"owner": {"reputation": 5, "user_id": 7801092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2r9eEG1Vdn4/AAAAAAAAAAI/AAAAAAAAANU/HdRsydXWVlU/photo.jpg?sz=128", "display_name": "vikas choudhary", "link": "https://stackoverflow.com/users/7801092/vikas-choudhary"}, "edited": false, "score": 0, "creation_date": 1530705661, "post_id": 51172900, "comment_id": 89329082, "body": "Below code is running fine with output 30 60 !!"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1530705930, "post_id": 51172900, "comment_id": 89329240, "body": "One possible effect of undefined behaviour is &quot;running fine&quot;. Another one is &quot;appearing to run fine, but crashing on a different system or compiler&quot;."}, {"owner": {"reputation": 5, "user_id": 7801092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2r9eEG1Vdn4/AAAAAAAAAAI/AAAAAAAAANU/HdRsydXWVlU/photo.jpg?sz=128", "display_name": "vikas choudhary", "link": "https://stackoverflow.com/users/7801092/vikas-choudhary"}, "edited": false, "score": 0, "creation_date": 1530706048, "post_id": 51172900, "comment_id": 89329328, "body": "I have checked it on many online compilers but the output is same!!"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7801092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2r9eEG1Vdn4/AAAAAAAAAAI/AAAAAAAAANU/HdRsydXWVlU/photo.jpg?sz=128", "display_name": "vikas choudhary", "link": "https://stackoverflow.com/users/7801092/vikas-choudhary"}, "edited": false, "score": 0, "creation_date": 1530706409, "post_id": 51172985, "comment_id": 89329554, "body": "My doubt is why the p.erase(p.end()) is not giving any error in case of vector of pairs and erasing the last element??"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 5, "user_id": 7801092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2r9eEG1Vdn4/AAAAAAAAAAI/AAAAAAAAANU/HdRsydXWVlU/photo.jpg?sz=128", "display_name": "vikas choudhary", "link": "https://stackoverflow.com/users/7801092/vikas-choudhary"}, "edited": false, "score": 1, "creation_date": 1530706491, "post_id": 51172985, "comment_id": 89329601, "body": "@vikaschoudhary Because the behaviour is <i>undefined</i>. Just like <code>int a[4]; a[6] = 10</code> is undefined. This might work, or fail, or crash or anything. It is not worth discussing what undefined behaviour might or might not do."}], "tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": false, "score": 3, "last_activity_date": 1530706552, "last_edit_date": 1530706552, "creation_date": 1530704989, "answer_id": 51172985, "question_id": 51172900, "link": "https://stackoverflow.com/questions/51172900/difference-in-erasing-an-element-from-a-vector-and-a-vector-of-pairs/51172985#51172985", "title": "Difference in erasing an element from a vector and a vector of pairs", "body": "<p>From <a href=\"https://en.cppreference.com/w/cpp/container/vector/erase\" rel=\"nofollow noreferrer\"><code>std::vector::erase</code></a> :</p>\n\n<blockquote>\n  <p>The iterator pos must be valid and dereferenceable. Thus the end() iterator (which is valid, but is not dereferencable) cannot be used as a value for pos.</p>\n</blockquote>\n\n<p>So your code is invalid in both cases and invokes <a href=\"https://en.cppreference.com/w/cpp/language/ub\" rel=\"nofollow noreferrer\"><em>undefined behaviour</em></a>. This means anything can happen including crash, work, or whatever it wants.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 7801092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2r9eEG1Vdn4/AAAAAAAAAAI/AAAAAAAAANU/HdRsydXWVlU/photo.jpg?sz=128", "display_name": "vikas choudhary", "link": "https://stackoverflow.com/users/7801092/vikas-choudhary"}, "edited": false, "score": 0, "creation_date": 1530705944, "post_id": 51173188, "comment_id": 89329250, "body": "Please check the outputs of the program. It will work always and won&#39;t output garbage values."}, {"owner": {"reputation": 5, "user_id": 7801092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2r9eEG1Vdn4/AAAAAAAAAAI/AAAAAAAAANU/HdRsydXWVlU/photo.jpg?sz=128", "display_name": "vikas choudhary", "link": "https://stackoverflow.com/users/7801092/vikas-choudhary"}, "edited": false, "score": 0, "creation_date": 1530706110, "post_id": 51173188, "comment_id": 89329367, "body": "I have checked it on many online compilers but the output is same!!"}, {"owner": {"reputation": 5, "user_id": 7801092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2r9eEG1Vdn4/AAAAAAAAAAI/AAAAAAAAANU/HdRsydXWVlU/photo.jpg?sz=128", "display_name": "vikas choudhary", "link": "https://stackoverflow.com/users/7801092/vikas-choudhary"}, "edited": false, "score": 0, "creation_date": 1530706389, "post_id": 51173188, "comment_id": 89329537, "body": "My doubt is why the p.erase(p.end()) is not giving any error in case of vector of pairs??"}, {"owner": {"reputation": 5, "user_id": 7801092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2r9eEG1Vdn4/AAAAAAAAAAI/AAAAAAAAANU/HdRsydXWVlU/photo.jpg?sz=128", "display_name": "vikas choudhary", "link": "https://stackoverflow.com/users/7801092/vikas-choudhary"}, "edited": false, "score": 0, "creation_date": 1530706536, "post_id": 51173188, "comment_id": 89329626, "body": "Because p.end() does not point to last element it points to position next to last element."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 5, "user_id": 7801092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2r9eEG1Vdn4/AAAAAAAAAAI/AAAAAAAAANU/HdRsydXWVlU/photo.jpg?sz=128", "display_name": "vikas choudhary", "link": "https://stackoverflow.com/users/7801092/vikas-choudhary"}, "edited": false, "score": 0, "creation_date": 1530706614, "post_id": 51173188, "comment_id": 89329679, "body": "@vikaschoudhary but as I already said in my answer, that is not guaranteed to give any error. Why would you expect an error when there is no guarantee that there would be an error?"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1530706936, "last_edit_date": 1530706936, "creation_date": 1530705599, "answer_id": 51173188, "question_id": 51172900, "link": "https://stackoverflow.com/questions/51172900/difference-in-erasing-an-element-from-a-vector-and-a-vector-of-pairs/51173188#51173188", "title": "Difference in erasing an element from a vector and a vector of pairs", "body": "<blockquote>\n  <p>The above code throws error as it is understood that ...</p>\n</blockquote>\n\n<p>That code is not guaranteed to \"throw an error\". Rather, the behaviour is undefined. Throwing an error is one possible behaviour. If it does throw an error, you can count yourself lucky as it might have been difficult to find your bug otherwise.</p>\n\n<blockquote>\n  <p>... as it is understood that p.end() point to null pointer.</p>\n</blockquote>\n\n<p>No, <code>p.end()</code> does not \"point to a null pointer\". It points to the end of the vector, where <em>end of the vector</em> is defined as the position after the last element.</p>\n\n<blockquote>\n  <p>While this code below is running fine and output is 30 60. Can anyone explain this?</p>\n</blockquote>\n\n<p>\"Running fine\" and \"output is 30 60\" are possible behaviours when behaviour is undefined. Everything is a possible behaviour when it is undefined. But of course, there is no guarantee that it will run fine. As far as the language is concerned, the program could just as well not be running fine tomorrow.</p>\n\n<blockquote>\n  <p>I have checked it on many online compilers but the output is same!!</p>\n</blockquote>\n\n<p>Ouput being the same on many online compilers is also possible behaviour when behaviour is undefined. There is no guarantee that some compiler would behave differently, just as much as there is no guarantee for them behaving the same.</p>\n\n<p>No matter how many compilers you try, it is impossible to verify that a program is correct simply by executing it and observing the output that you hoped for. The only way to prove a program correct, is to verify <em>all</em> pre-conditions and invariants imposed on the program are satisfied.</p>\n"}], "owner": {"reputation": 5, "user_id": 7801092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2r9eEG1Vdn4/AAAAAAAAAAI/AAAAAAAAANU/HdRsydXWVlU/photo.jpg?sz=128", "display_name": "vikas choudhary", "link": "https://stackoverflow.com/users/7801092/vikas-choudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1530706936, "creation_date": 1530704695, "last_edit_date": 1530705763, "question_id": 51172900, "link": "https://stackoverflow.com/questions/51172900/difference-in-erasing-an-element-from-a-vector-and-a-vector-of-pairs", "title": "Difference in erasing an element from a vector and a vector of pairs", "body": "<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\nint main() \n{\n    vector&lt;int&gt;p;\n    p.push_back(30);\n    p.push_back(60);\n    p.push_back(20);\n\n    p.erase(p.end());\n\n    for(int i = 0; i &lt; p.size(); ++i)\n    cout&lt;&lt;p[i]&lt;&lt;\" \";\n}\n</code></pre>\n\n<p>The above code throws error as it is understood that p.end() point to null pointer.</p>\n\n<p>While this code below is running fine and output is 30 60. Can anyone explain this?</p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n#define mp make_pair\nint main() \n{\n    vector&lt;pair&lt;int,int&gt;&gt;p;\n    p.push_back(mp(30,2));\n    p.push_back(mp(60,5));\n    p.push_back(mp(20,7));\n\n    p.erase(p.end());\n\n    for(int i = 0; i &lt; p.size(); ++i)\n    cout&lt;&lt;p[i].first&lt;&lt;\" \";\n}\n</code></pre>\n"}, {"tags": ["c++", "lambda"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1530704947, "post_id": 51172880, "comment_id": 89328599, "body": "As I read your question, I think you are asking what is/how does a lambda work?  This is probably too broad for SO."}, {"owner": {"reputation": 357, "user_id": 4604859, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10206053714163180/picture?type=large", "display_name": "selbolder", "link": "https://stackoverflow.com/users/4604859/selbolder"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1530705587, "post_id": 51172880, "comment_id": 89329032, "body": "No, I undestand how to use it, but I want to undestand how a Lamda enables the access to the capure clause. What is the is the equivalent in c++ 03? How could I rewrite a lamda with a static callback function?"}], "answers": [{"tags": [], "owner": {"reputation": 549, "user_id": 1295063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3qx8i.png?s=128&g=1", "display_name": "Ralara", "link": "https://stackoverflow.com/users/1295063/ralara"}, "is_accepted": true, "score": 3, "last_activity_date": 1530705635, "last_edit_date": 1530705635, "creation_date": 1530705274, "answer_id": 51173073, "question_id": 51172880, "link": "https://stackoverflow.com/questions/51172880/c-lambda-how-is-the-capture-clause-deep-inside/51173073#51173073", "title": "C++ Lambda, how is the capture clause deep inside", "body": "<p><a href=\"https://en.cppreference.com/w/cpp/language/lambda\" rel=\"nofollow noreferrer\">This cpp reference page</a> explains how Lambda expressions are formed, the following is from the <em>captures</em> section (my emphasis):</p>\n\n<blockquote>\n  <p>[&amp;] captures all automatic variables used in the body of the lambda by reference and <strong>current object by reference if exists</strong></p>\n</blockquote>\n\n<p>If you are asking specifically how does the compiler capture variables when declaring them in a Lambda then <a href=\"https://blog.feabhas.com/2014/03/demystifying-c-lambdas/\" rel=\"nofollow noreferrer\">this</a> is a useful resource. From that page:</p>\n\n<blockquote>\n  <p>When you add a capture list to a lambda the compiler adds appropriate member variables to the lambda-functor class and a constructor for initialising these variables.<a href=\"https://i.stack.imgur.com/F6QXC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F6QXC.png\" alt=\"enter image description here\"></a></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 505, "user_id": 3065592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60527c78c08542c8f4de56f9082e69d?s=128&d=identicon&r=PG&f=1", "display_name": "wtom", "link": "https://stackoverflow.com/users/3065592/wtom"}, "is_accepted": false, "score": 0, "last_activity_date": 1530706222, "last_edit_date": 1530706222, "creation_date": 1530705831, "answer_id": 51173272, "question_id": 51172880, "link": "https://stackoverflow.com/questions/51172880/c-lambda-how-is-the-capture-clause-deep-inside/51173272#51173272", "title": "C++ Lambda, how is the capture clause deep inside", "body": "<blockquote>\n  <p>No, I undestand how to use it, but I want to undestand how a Lamda\n  enables the access to the capure clause. What is the is the equivalent\n  in c++ 03? How could I rewrite a lamda with a static callback\n  function? \u2013 selbolder</p>\n</blockquote>\n\n<p>Look at <a href=\"https://www.boost.org/doc/libs/1_66_0/libs/bind/doc/html/bind.html\" rel=\"nofollow noreferrer\">boost bind</a></p>\n\n<p>And <a href=\"https://stackoverflow.com/questions/10692121/c-bind-function-for-use-as-argument-of-other-function\">here</a></p>\n"}], "owner": {"reputation": 357, "user_id": 4604859, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10206053714163180/picture?type=large", "display_name": "selbolder", "link": "https://stackoverflow.com/users/4604859/selbolder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 51173073, "answer_count": 2, "score": 0, "last_activity_date": 1530770349, "creation_date": 1530704642, "last_edit_date": 1530770349, "question_id": 51172880, "link": "https://stackoverflow.com/questions/51172880/c-lambda-how-is-the-capture-clause-deep-inside", "title": "C++ Lambda, how is the capture clause deep inside", "body": "<p>When I have a callback function like this:</p>\n\n<pre><code>using MessageCallback =\n    std::function&lt;void(const Message &amp;, uint64_t deliveryTag, bool redelivered)&gt;;\n</code></pre>\n\n<p>I could declare a static callback function inside a class:</p>\n\n<pre><code>static void MessageCB(const AMQP::Message &amp;message,\n                      uint64_t deliveryTag,\n                      bool redelivered)\n{...}\n</code></pre>\n\n<p>But I'm not able to access any Member variables inside this Callback Function.</p>\n\n<p>When I write a Lambda Function like this:</p>\n\n<pre><code> auto MessageCB= [&amp;](const AMQP::Message &amp;message,\n                      uint64_t deliveryTag,\n                      bool redelivered)\n {...}\n</code></pre>\n\n<p>I could then use any member variables from the context where I declared the lambda.</p>\n\n<p>How is this working?\nHow exactly is the capture clause working?</p>\n\n<p>What is the difference to a static callback function?</p>\n"}, {"tags": ["c++", "pointers", "initialization"], "comments": [{"owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "edited": false, "score": 1, "creation_date": 1530704033, "post_id": 51172677, "comment_id": 89328005, "body": "it is possible that the random address could have been null_ptr. That meaning, the memory left over at the location that the pointer was declared could have originally been 0."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1530704669, "post_id": 51172677, "comment_id": 89328430, "body": "Who said <code>0</code> is not garbage?"}, {"owner": {"reputation": 9, "user_id": 10031867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fbbc6d3e810c66f6d4921ffb8434d1?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Wilkinson", "link": "https://stackoverflow.com/users/10031867/jack-wilkinson"}, "edited": false, "score": 0, "creation_date": 1530704866, "post_id": 51172677, "comment_id": 89328546, "body": "It is so, ackward for me because now it always shows 0 and about one week before the pointer was really pointing to some random address. That is why i am interested why it like that."}], "answers": [{"comments": [{"owner": {"reputation": 4121, "user_id": 4290866, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0727d9acdc35a0359d0703da9e11f239?s=128&d=identicon&r=PG&f=1", "display_name": "user32434999", "link": "https://stackoverflow.com/users/4290866/user32434999"}, "edited": false, "score": 0, "creation_date": 1530704304, "post_id": 51172729, "comment_id": 89328204, "body": "It is also interesting to read <a href=\"https://stackoverflow.com/questions/6004816/kernel-zeroes-memory\">this</a> which explains why you often still get 0."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 4121, "user_id": 4290866, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0727d9acdc35a0359d0703da9e11f239?s=128&d=identicon&r=PG&f=1", "display_name": "user32434999", "link": "https://stackoverflow.com/users/4290866/user32434999"}, "edited": false, "score": 0, "creation_date": 1530705109, "post_id": 51172729, "comment_id": 89328724, "body": "Agree @Pi, injected that into the question. Hope you like it now."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1530705217, "post_id": 51172729, "comment_id": 89328793, "body": "Actually, an answer with that link would have been more useful on the dupe target than it is here."}, {"owner": {"reputation": 4121, "user_id": 4290866, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0727d9acdc35a0359d0703da9e11f239?s=128&d=identicon&r=PG&f=1", "display_name": "user32434999", "link": "https://stackoverflow.com/users/4290866/user32434999"}, "edited": false, "score": 0, "creation_date": 1530705440, "post_id": 51172729, "comment_id": 89328944, "body": "@gsamaras Never disliked it ;)"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1530705679, "post_id": 51172729, "comment_id": 89329095, "body": "I attempted to answer there too @BaummitAugen, but I need to catch the bus now! Pi that&#39;s good, thanks!"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 0, "last_activity_date": 1530705068, "last_edit_date": 1530705068, "creation_date": 1530704086, "answer_id": 51172729, "question_id": 51172677, "link": "https://stackoverflow.com/questions/51172677/uninitialized-pointer-points-to-zero/51172729#51172729", "title": "Uninitialized pointer, points to zero", "body": "<p>This code invokes <em>Undefined Behavior</em> (UB), since the pointer is used uninitialized.</p>\n\n<p>The compiler should emit a warning, when a warning flag is used, like <code>-Wall</code> for example:</p>\n\n<pre><code>warning: 'pt' is used uninitialized in this function [-Wuninitialized]\n     std::cout &lt;&lt; pt &lt;&lt; std::endl;\n                  ^~\n</code></pre>\n\n<p>It just happens, that at this run, on your system, it had the behavior of a null pointer. That means that the garbage value the pointer takes, happens to be 0. However, notice that, <a href=\"https://stackoverflow.com/questions/6004816/kernel-zeroes-memory\">kernel zeroes appear relatively often</a>.</p>\n"}], "owner": {"reputation": 9, "user_id": 10031867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fbbc6d3e810c66f6d4921ffb8434d1?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Wilkinson", "link": "https://stackoverflow.com/users/10031867/jack-wilkinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "closed_date": 1530704133, "answer_count": 1, "score": 0, "last_activity_date": 1530705068, "creation_date": 1530703933, "question_id": 51172677, "link": "https://stackoverflow.com/questions/51172677/uninitialized-pointer-points-to-zero", "closed_reason": "Duplicate", "title": "Uninitialized pointer, points to zero", "body": "<pre><code>#include &lt;iostream&gt;\nint main() {\n    int* pt;\n    std::cout &lt;&lt; pt &lt;&lt; std::endl;\n    if(pt)\n        std::cout &lt;&lt; \"true\" &lt;&lt; std::endl;\n    else\n        std::cout &lt;&lt; \"false\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>This code fragment evaulate to false. What is more it prints 0 in</p>\n\n<pre><code>    std::cout &lt;&lt; pt &lt;&lt; std::endl;\n</code></pre>\n\n<p>I thought that uninitialized pointers points to some random address, which may contain garbage value. In this case it points to 0 value like i would assign it to nullptr. Could someone clarify this for me?</p>\n"}, {"tags": ["c++", "c++11", "templates", "sfinae"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 2, "creation_date": 1530704581, "post_id": 51172669, "comment_id": 89328375, "body": "do you actually need to know whether the conversion happened with an explicitly defined conversion operator ?"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 2, "creation_date": 1530704728, "post_id": 51172669, "comment_id": 89328462, "body": "<code>std::is_convertible</code> from type_traits is already implemented..."}], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 4, "last_activity_date": 1530706431, "creation_date": 1530706431, "answer_id": 51173452, "question_id": 51172669, "link": "https://stackoverflow.com/questions/51172669/detect-implementation-of-conversion-operator/51173452#51173452", "title": "Detect implementation of conversion operator", "body": "<blockquote>\n  <p>But, here I just check that I can convert, not that the conversion operator is defined.</p>\n</blockquote>\n\n<p>So why don't you check the existence of the operator?</p>\n\n<pre><code>  template &lt;typename U&gt;\n  static auto check (U * t)\n     -&gt; decltype( t-&gt;operator D(), std::true_type{} );\n</code></pre>\n\n<p>Off topic suggestion: instead of</p>\n\n<pre><code>   static constexpr bool value \n      = std::is_same&lt;decltype(check&lt;T&gt;(nullptr)), std::true_type&gt;::value;\n</code></pre>\n\n<p>you can simply write</p>\n\n<pre><code>   static constexpr bool value = decltype(check&lt;T&gt;(nullptr))::value;\n</code></pre>\n\n<p>The following is a full compiling example</p>\n\n<pre><code>#include &lt;map&gt;\n#include &lt;string&gt;\n\nstruct Foo\n { operator std::map&lt;std::string, std::string&gt; () { return {}; } };\n\ntemplate &lt;typename T, typename D&gt;\nstruct can_convert_to\n {\n   private:\n      template &lt;typename U&gt;\n      static auto check (U * t)\n         -&gt; decltype( t-&gt;operator D(), std::true_type{} );\n\n      template &lt;typename&gt;\n      static std::false_type check (...);\n\n   public:\n      static constexpr bool value = decltype(check&lt;T&gt;(nullptr))::value;\n };\n\nint main ()\n {\n   using mss = std::map&lt;std::string, std::string&gt;;\n\n   static_assert( false == can_convert_to&lt;Foo, int&gt;::value, \"!\" );\n   static_assert(  true == can_convert_to&lt;Foo, mss&gt;::value, \"!\" );\n }\n</code></pre>\n"}], "owner": {"reputation": 994, "user_id": 2090149, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a150348e638af139d36c3c523d1ed574?s=128&d=identicon&r=PG", "display_name": "thorsan", "link": "https://stackoverflow.com/users/2090149/thorsan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "accepted_answer_id": 51173452, "answer_count": 1, "score": 1, "last_activity_date": 1530706746, "creation_date": 1530703911, "last_edit_date": 1530706746, "question_id": 51172669, "link": "https://stackoverflow.com/questions/51172669/detect-implementation-of-conversion-operator", "title": "Detect implementation of conversion operator", "body": "<p>I want to detect if a class implements the conversion operator for a specific type, e.g.</p>\n\n<pre><code>struct Foo\n{\n    operator std::map&lt;std::string, std::string&gt; () { ... }\n}\n</code></pre>\n\n<p>I have implemented the following structure that I can used to detect this and use to select template functions to be used.</p>\n\n<pre><code>template&lt;class T, class D&gt;\nstruct can_convert_to\n{\nprivate:\n    template&lt;typename U&gt; static auto check(U* t) -&gt; decltype( static_cast&lt;D&gt;(*t), std::true_type());\n    template&lt;typename U&gt; static std::false_type check(...);\npublic:\n    static constexpr bool value = std::is_same&lt;decltype(check&lt;T&gt;(nullptr)), std::true_type&gt;::value;\n};\n</code></pre>\n\n<p>But, here I just check that I can convert, not that the conversion operator is defined. Is there a better way to do this?</p>\n"}, {"tags": ["c++", "port"], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 4372035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889f129a1a206b88354005a2c1052986?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/4372035/chrisb"}, "is_accepted": false, "score": 1, "last_activity_date": 1530707761, "last_edit_date": 1530707761, "creation_date": 1530704242, "answer_id": 51172772, "question_id": 51172653, "link": "https://stackoverflow.com/questions/51172653/communicating-with-the-com-port-in-c/51172772#51172772", "title": "Communicating with the COM PORT in C++", "body": "<p>Boost has a nice library and examples for it: <a href=\"https://www.boost.org/doc/libs/1_65_0/doc/html/boost_asio/overview/serial_ports.html\" rel=\"nofollow noreferrer\">https://www.boost.org/doc/libs/1_65_0/doc/html/boost_asio/overview/serial_ports.html</a></p>\n\n<p>An example for the usage of the boost library was posted here: <a href=\"https://stackoverflow.com/questions/29706262/clear-input-data-from-serial-port-in-boostasio\">Clear input data from serial port in boost::asio</a></p>\n\n<pre><code>#include &lt;boost/asio.hpp&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\nusing namespace boost::asio;\n\nint main()\n{\n    io_service io_service;\n    serial_port port(io_service, \"/dev/ttyACM0\");\n    port.set_option(serial_port_base::baud_rate(9600));\n    vector&lt;char&gt; buf(1);\n    read(port, buffer(buf));\n    cout &lt;&lt; (int) buf[0] &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>same can be done with write:</p>\n\n<pre><code>std::string s;\nwrite(port,buffer(s.c_str(),s.size()));\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6512529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ac3085695e3db1f89f798cf83ed1da5?s=128&d=identicon&r=PG&f=1", "display_name": "Alf\u0105s Noblik", "link": "https://stackoverflow.com/users/6512529/alf%c4%85s-noblik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1530707761, "creation_date": 1530703845, "last_edit_date": 1530706076, "question_id": 51172653, "link": "https://stackoverflow.com/questions/51172653/communicating-with-the-com-port-in-c", "title": "Communicating with the COM PORT in C++", "body": "<p>I have to write a program sending messages to the UART converter connected on the COM PORT in C++. I'm actually stuck from the very beggining. I haven't ever dome anything like that and I didn't manage to find any examples.\nCould anyone help me out?\nAppreciate any help ;)</p>\n"}, {"tags": ["javascript", "c++", "node.js", "sockets"], "answers": [{"tags": [], "owner": {"reputation": 2195, "user_id": 1632985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/cdc7679fc0d0522b753d3720b6ebc379?s=128&d=identicon&r=PG", "display_name": "CCoder", "link": "https://stackoverflow.com/users/1632985/ccoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1530704763, "last_edit_date": 1530704763, "creation_date": 1530704072, "answer_id": 51172723, "question_id": 51172640, "link": "https://stackoverflow.com/questions/51172640/will-data-sent-received-through-a-socket-written-in-different-languages-be-under/51172723#51172723", "title": "will data sent/received through a socket written in different languages be understood both ends?", "body": "<p>Yes.It is possible to achieve that. You will have to <a href=\"https://en.wikipedia.org/wiki/Serialization\" rel=\"nofollow noreferrer\">serialize</a> the data from the client side and send the serialized data to the server. On the server side de-serialize the received data to get the original data structure.</p>\n\n<p>There are multiple libraries which facilitate this. <a href=\"https://thrift.apache.org/\" rel=\"nofollow noreferrer\">Thrift</a> is one such example. There are other libraries like Avro, Protobuf etc. You can experiment with a few of them and find out which best suits your requirements.</p>\n\n<p>These libraries generally use an <a href=\"https://en.wikipedia.org/wiki/Interface_description_language\" rel=\"nofollow noreferrer\">Interface Definition Language</a> to define the interface which may include services and data structures. Then they can generate code in multiple languages for you to use the interface.</p>\n\n<p>For the record, I have personally used thrift to communicate between a C++ server and Javascript client. It works fine. </p>\n"}], "owner": {"reputation": 361, "user_id": 7697453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5842e070aeb88e6e4fc776021a2fac40?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Volz", "link": "https://stackoverflow.com/users/7697453/ben-volz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530704763, "creation_date": 1530703809, "question_id": 51172640, "link": "https://stackoverflow.com/questions/51172640/will-data-sent-received-through-a-socket-written-in-different-languages-be-under", "title": "will data sent/received through a socket written in different languages be understood both ends?", "body": "<p>If i use a socket to connect two programs(c++ and java script using node.js in my case) written in different languages. will the inputted data come out the same the other end ? </p>\n"}, {"tags": ["c++", "qt", "compiler-errors", "include", "header-files"], "comments": [{"owner": {"reputation": 2272, "user_id": 5562045, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/rWILr.png?s=128&g=1", "display_name": "rustyMagnet", "link": "https://stackoverflow.com/users/5562045/rustymagnet"}, "edited": false, "score": 0, "creation_date": 1568809339, "post_id": 51172635, "comment_id": 102392202, "body": "I hit the same error on a Friday afternoon. I stupidly deleted the <code>#endif &#47;* foobar_h *&#47;</code> out."}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 3825485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/224796f559a4f5114a223dfec73489dc?s=128&d=identicon&r=PG&f=1", "display_name": "Maubeh", "link": "https://stackoverflow.com/users/3825485/maubeh"}, "edited": false, "score": 1, "creation_date": 1543056927, "post_id": 51172770, "comment_id": 93786758, "body": "Thanks. Your answer guided me to reduce the includes.  I used <code>namespaces</code> to solve the issue."}, {"owner": {"reputation": 139, "user_id": 8619627, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9ebf8d9694fde0301d096c3bebac306e?s=128&d=identicon&r=PG", "display_name": "MNCODE", "link": "https://stackoverflow.com/users/8619627/mncode"}, "reply_to_user": {"reputation": 313, "user_id": 3825485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/224796f559a4f5114a223dfec73489dc?s=128&d=identicon&r=PG&f=1", "display_name": "Maubeh", "link": "https://stackoverflow.com/users/3825485/maubeh"}, "edited": false, "score": 0, "creation_date": 1568639388, "post_id": 51172770, "comment_id": 102326982, "body": "@Maubeh what do you mean you solve this with namespaces?"}, {"owner": {"reputation": 313, "user_id": 3825485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/224796f559a4f5114a223dfec73489dc?s=128&d=identicon&r=PG&f=1", "display_name": "Maubeh", "link": "https://stackoverflow.com/users/3825485/maubeh"}, "reply_to_user": {"reputation": 139, "user_id": 8619627, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9ebf8d9694fde0301d096c3bebac306e?s=128&d=identicon&r=PG", "display_name": "MNCODE", "link": "https://stackoverflow.com/users/8619627/mncode"}, "edited": false, "score": 0, "creation_date": 1569000429, "post_id": 51172770, "comment_id": 102467777, "body": "@MNCODE Sorry for the late reply. The following link helped me resolve the issue.  <a href=\"http://www.cplusplus.com/forum/articles/10627/\" rel=\"nofollow noreferrer\">cplusplus.com/forum/articles/10627</a>"}], "tags": [], "owner": {"reputation": 307, "user_id": 9540586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d970a23cb61a7876521fcfe76683a50?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita", "link": "https://stackoverflow.com/users/9540586/nikita"}, "is_accepted": true, "score": 5, "last_activity_date": 1530704239, "creation_date": 1530704239, "answer_id": 51172770, "question_id": 51172635, "link": "https://stackoverflow.com/questions/51172635/error-unterminated-conditional-directive-in-cross-referencing-headers/51172770#51172770", "title": "Error &quot;Unterminated conditional directive&quot; in cross-referencing headers", "body": "<p>The problem is solved. </p>\n\n<p>I just moved one of <code>#include</code> from the header to the source file, and it has worked.</p>\n\n<p><strong>plotmarker.h</strong></p>\n\n<pre><code>#ifndef PLOTMARKER_H\n#define PLOTMARKER_H\n\n#include &lt;QObject&gt;\n\nclass Plotter;\n\nclass PlotMarker : public QObject\n{\n    // ...\n    Plotter* m_attachedPlot;    \n    // ...\n};\n\n#endif // PLOTMARKER_H\n</code></pre>\n\n<p>// ...</p>\n\n<p><strong>plotmarker.cpp</strong></p>\n\n<pre><code>#include \"plotmarker.h\"\n#include \"plotter.h\"\n// ...\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 9540586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d970a23cb61a7876521fcfe76683a50?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita", "link": "https://stackoverflow.com/users/9540586/nikita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23839, "favorite_count": 2, "accepted_answer_id": 51172770, "answer_count": 1, "score": 4, "last_activity_date": 1535091466, "creation_date": 1530703793, "last_edit_date": 1535091466, "question_id": 51172635, "link": "https://stackoverflow.com/questions/51172635/error-unterminated-conditional-directive-in-cross-referencing-headers", "title": "Error &quot;Unterminated conditional directive&quot; in cross-referencing headers", "body": "<p>There are two classes that are related to each other in their headers:</p>\n\n<p><strong>PlotMarker</strong></p>\n\n<pre><code>#ifndef PLOTMARKER_H\n#define PLOTMARKER_H\n\n#include &lt;QObject&gt;\n#include \"plotter.h\"\n\nclass Plotter;\n\nclass PlotMarker : public QObject\n{\n    // ...\n    Plotter* m_attachedPlot;    \n    // ...\n};\n\n#endif // PLOTMARKER_H\n</code></pre>\n\n<p><strong>Plotter</strong></p>\n\n<pre><code>#ifndef PLOTTER_H\n#define PLOTTER_H\n\n// ...\n#include \"plotmarker.h\"\n// ...\n\nclass PlotMarker;\n\nclass Plotter : public QQuickPaintedItem\n{\n    // ...\n    QLinkedList&lt;PlotMarker*&gt; m_markerList;\n    // ...\n};\n\n#endif // PLOTTER_H\n</code></pre>\n\n<p>The program is compiled well, but it's got a error <code>error: unterminated conditional directive</code> in <code>#ifndef</code> and the code of classes in the IDE isn't highlighted because of it.</p>\n\n<p>If I remove <code>#include \"plotter.h\"</code> in PlotMarker's header or <code>#include \"plotmarker.h\"</code> in Plotter's header, Qt Creator highlights the code as usual, but the compilating fails because of errors about invalid use of incomplete type.</p>\n\n<p>Could you please tell me what's wrong? I think it's because of wrong headers cross-referencing, but I ran into <a href=\"https://stackoverflow.com/questions/1429336/cross-referencing-included-headers-in-c-program\">this</a> and it didn't help me.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 1907, "user_id": 1278112, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e3d3976fda1b5e2cb21d4a357425063a?s=128&d=identicon&r=PG", "display_name": "Shihe Zhang", "link": "https://stackoverflow.com/users/1278112/shihe-zhang"}, "edited": false, "score": 0, "creation_date": 1530703355, "post_id": 51172447, "comment_id": 89327562, "body": "Check your project path, make sure they are valid to Qt."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1530703390, "post_id": 51172447, "comment_id": 89327593, "body": "Do you have mscv2012 installed?"}, {"owner": {"reputation": 1145, "user_id": 2509099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b943869aa8e032e04aae5d8b637d47c?s=128&d=identicon&r=PG", "display_name": "rafael gonzalez", "link": "https://stackoverflow.com/users/2509099/rafael-gonzalez"}, "edited": false, "score": 0, "creation_date": 1530703403, "post_id": 51172447, "comment_id": 89327600, "body": "yes. you need visual studio to be able to compile code."}, {"owner": {"reputation": 9, "user_id": 9355845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671d30fdcd2e805856ae01ee2741a4fb?s=128&d=identicon&r=PG&f=1", "display_name": "arman", "link": "https://stackoverflow.com/users/9355845/arman"}, "edited": false, "score": 0, "creation_date": 1530703802, "post_id": 51172447, "comment_id": 89327855, "body": "no i have not installed microsoft visual studio 2012 , after installed msvc 2012 , i have to use visual studio or i can use Qt Creator IDE ?"}, {"owner": {"reputation": 1145, "user_id": 2509099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b943869aa8e032e04aae5d8b637d47c?s=128&d=identicon&r=PG", "display_name": "rafael gonzalez", "link": "https://stackoverflow.com/users/2509099/rafael-gonzalez"}, "edited": false, "score": 0, "creation_date": 1530711376, "post_id": 51172447, "comment_id": 89332753, "body": "you can use Qt Creator IDE. you can also use visual studio if you want. but you need to install an addon."}], "owner": {"reputation": 9, "user_id": 9355845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671d30fdcd2e805856ae01ee2741a4fb?s=128&d=identicon&r=PG&f=1", "display_name": "arman", "link": "https://stackoverflow.com/users/9355845/arman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1530703241, "creation_date": 1530703241, "question_id": 51172447, "link": "https://stackoverflow.com/questions/51172447/install-qt-5-5-1-msvc-2012-on-windows-x86", "title": "install qt 5.5.1 msvc 2012 on windows x86", "body": "<p>Does QT windows (x86) need microsoft visual studio 2012 ? <br>\nI have installed qt-opensource-windows-x86-msvc2012-5.5.1 and when trying to build a project get this error :</p>\n\n<pre><code>    15:49:29: Configuration is faulty. Check the Issues view for details.\nError while building/deploying project untitled1 (kit: Desktop Qt 5.5.1 MSVC2012 32bit)\nWhen executing step \"Make\"\n</code></pre>\n"}, {"tags": ["c++", "c++14", "unique-ptr"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1530723560, "post_id": 51172341, "comment_id": 89339036, "body": "Related to <a href=\"https://stackoverflow.com/questions/51170417/in-c-what-do-braces-on-the-left-hand-side-of-a-variable-declaration-mean\">what-do-braces-on-the-left-hand-side-of-a-variable-declarati&zwnj;&#8203;on-mean</a>"}, {"owner": {"reputation": 1948, "user_id": 7042963, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CgsFk.jpg?s=128&g=1", "display_name": "BartekPL", "link": "https://stackoverflow.com/users/7042963/bartekpl"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1530723876, "post_id": 51172341, "comment_id": 89339155, "body": "@Jarod42 I know that, because I checked that question and I got this fragment of code meanwhile."}], "answers": [{"comments": [{"owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 0, "creation_date": 1530703281, "post_id": 51172370, "comment_id": 89327517, "body": "Good question is: why is not assignment operator deleted for r-values? I guess it is an overlook in the standard"}, {"owner": {"reputation": 1948, "user_id": 7042963, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CgsFk.jpg?s=128&g=1", "display_name": "BartekPL", "link": "https://stackoverflow.com/users/7042963/bartekpl"}, "edited": false, "score": 0, "creation_date": 1530703335, "post_id": 51172370, "comment_id": 89327553, "body": "&quot;call to an overloaded member function&quot;? What does it mean? Where is it overloaded?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 1, "creation_date": 1530703362, "post_id": 51172370, "comment_id": 89327568, "body": "@bartop - Because assignment to r-values can actually be useful. If you return a proxy object with overloaded assignment, for one example."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1948, "user_id": 7042963, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CgsFk.jpg?s=128&g=1", "display_name": "BartekPL", "link": "https://stackoverflow.com/users/7042963/bartekpl"}, "edited": false, "score": 0, "creation_date": 1530703448, "post_id": 51172370, "comment_id": 89327638, "body": "@BartekPL - Classes either define <code>operator=</code> or get the compiler generated one."}, {"owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 2, "creation_date": 1530703558, "post_id": 51172370, "comment_id": 89327722, "body": "@StoryTeller But wait a second. I agree that for some r-values it may make sense. It just disagree it makes sense for <code>unique_ptr</code>"}, {"owner": {"reputation": 1948, "user_id": 7042963, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CgsFk.jpg?s=128&g=1", "display_name": "BartekPL", "link": "https://stackoverflow.com/users/7042963/bartekpl"}, "edited": false, "score": 0, "creation_date": 1530703587, "post_id": 51172370, "comment_id": 89327742, "body": "@StoryTeller I know that, but it is weird for me if it is generated for r-values. What is the parameter of that operator?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 6, "creation_date": 1530704236, "post_id": 51172370, "comment_id": 89328158, "body": "@bartop - Code needs to protect users from Murphy, not Machiavelli."}, {"owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 0, "creation_date": 1530704334, "post_id": 51172370, "comment_id": 89328226, "body": "@StoryTeller I do think disallowing this construction by deleting overload for r-value would make <code>unique_ptr</code> usage safer. It would protect from stupid errors"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 0, "creation_date": 1530704419, "post_id": 51172370, "comment_id": 89328275, "body": "@bartop - Those don&#39;t come up that often in practice. But if you feel this is well worth it, there is always the option of writing a proposal to the C++ standard&#39;s committee. It would have to cover more types in the standard library I think, to carry some more weight though."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 10, "last_activity_date": 1530704799, "last_edit_date": 1530704799, "creation_date": 1530702998, "answer_id": 51172370, "question_id": 51172341, "link": "https://stackoverflow.com/questions/51172341/what-is-going-on-here-i-assign-result-to-result-in-c/51172370#51172370", "title": "What is going on here? I assign result to result in C++", "body": "<blockquote>\n  <p>I thought that return of make_unique is r-value...</p>\n</blockquote>\n\n<p>It is. But for class types like <code>std::unique_ptr&lt;...&gt;</code>, the assignment is a call to an overloaded member function. You can pass rvalues as arguments to functions. And more specifically, call member functions on rvalues.</p>\n\n<hr>\n\n<p>As an example, when you examine <code>std::bitset</code>, you see that its <code>reference</code> type is in fact a class type. The assignment operator for that type is overloaded. It accepts a <code>bool</code>, but in fact performs a bit-wise operation to manipulate a flag in the packed memory of the <code>bitset</code>.</p>\n\n<hr>\n\n<p>It works for <code>unique_ptr</code> rvalues because it's overloaded (and is implicitly generated for other class types) without any ref-qualifiers. I.e.</p>\n\n<pre><code>unique_ptr&amp; operator=( unique_ptr&amp;&amp; r ) noexcept;\n</code></pre>\n\n<p>... and not... </p>\n\n<pre><code>unique_ptr&amp; operator=( unique_ptr&amp;&amp; r ) &amp; noexcept;\n// Can only be used on lvalues, no overload for rvalues\n</code></pre>\n\n<p>Which would have been for very little gain. And it's unlikely that the implicitly generated one would ever be for lvalues only. A lot of code (some that even predates C++11) uses assignment on rvalues, without ref-qualifying the operators. So that would break existing code bases.</p>\n"}], "owner": {"reputation": 1948, "user_id": 7042963, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CgsFk.jpg?s=128&g=1", "display_name": "BartekPL", "link": "https://stackoverflow.com/users/7042963/bartekpl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 1, "accepted_answer_id": 51172370, "answer_count": 1, "score": 9, "last_activity_date": 1530733016, "creation_date": 1530702905, "last_edit_date": 1530733016, "question_id": 51172341, "link": "https://stackoverflow.com/questions/51172341/what-is-going-on-here-i-assign-result-to-result-in-c", "title": "What is going on here? I assign result to result in C++", "body": "<p>Could you tell me what is going on here? And why it is possible?</p>\n\n<pre><code>std::make_unique&lt;int&gt;(1) = std::make_unique&lt;int&gt;(1);\n</code></pre>\n\n<p>I thought that <code>make_unique</code> returned an r-value...</p>\n\n<p><strong>Edit:</strong>\nCould you provide some useful example of this construction?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1043, "user_id": 7742987, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cda94a2733ee551a94d437561510f27?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit", "link": "https://stackoverflow.com/users/7742987/mohit"}, "edited": false, "score": 4, "creation_date": 1530703229, "post_id": 51172302, "comment_id": 89327475, "body": "You should use <code>A&lt;T&gt;</code> instead of <code>A</code>  in the line <code>B(int i): A{i}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1043, "user_id": 7742987, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cda94a2733ee551a94d437561510f27?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit", "link": "https://stackoverflow.com/users/7742987/mohit"}, "is_accepted": false, "score": 1, "last_activity_date": 1530703448, "creation_date": 1530703448, "answer_id": 51172517, "question_id": 51172302, "link": "https://stackoverflow.com/questions/51172302/accessing-template-base-classs-constructor-from-derived-class/51172517#51172517", "title": "Accessing template base class&#39;s constructor from derived class", "body": "<p>The injected class name will only work within that class not the derived class so change the code to following: </p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\n\ntemplate&lt;typename T&gt;\nclass A                     /// base class\n{\npublic:\n    A(int i)\n    {\n    }\n};\n\n\ntemplate&lt;typename T&gt;\nclass B : public A&lt;T&gt;         /// derived class\n{\npublic:\n    B(int i) :\n        A&lt;T&gt; {i} // added &lt;T&gt;\n    {\n    }\n};\n\n\nint main()\n{\n    A&lt;int&gt; a {5};\n    B&lt;int&gt; b {10};\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1530704575, "post_id": 51172638, "comment_id": 89328372, "body": "The <code>using base = A&lt;T&gt;;</code> idiom is very useful in real world use cases where the template argument list is long and used more than once. It saves repetition and make code maintenance easier because if something changes, you have to change it only once (DRY principle)."}], "tags": [], "owner": {"reputation": 7526, "user_id": 4108376, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/163807162a115b27e50f5f5f2b90de26?s=128&d=identicon&r=PG&f=1", "display_name": "tmlen", "link": "https://stackoverflow.com/users/4108376/tmlen"}, "is_accepted": true, "score": 4, "last_activity_date": 1530704148, "last_edit_date": 1530704148, "creation_date": 1530703802, "answer_id": 51172638, "question_id": 51172302, "link": "https://stackoverflow.com/questions/51172302/accessing-template-base-classs-constructor-from-derived-class/51172638#51172638", "title": "Accessing template base class&#39;s constructor from derived class", "body": "<p>The name of the base class, when used in <code>B&lt;T&gt;</code>'s constructor, is a <em>dependent name</em>, because what it refers to depends on the template argument <code>T</code>. See <a href=\"https://en.cppreference.com/w/cpp/language/dependent_name\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/dependent_name</a>.</p>\n\n<p>The name lookup rules are different. Names are not available in the current scope (i.e. the constructor of <code>B&lt;T&gt;</code>), if they depend on template arguments of the current scope (<code>T</code>).</p>\n\n<p>In that case the entire full name needs to be specified in <code>B</code>:</p>\n\n<pre><code>template&lt;typename T&gt;\nclass B : public A&lt;T&gt;         /// derived class\n{\npublic:\n    B(int i) :\n        A&lt;T&gt; {i}\n    {\n    }\n};\n</code></pre>\n\n<hr>\n\n<p>The same is true when accessing members of the base class in the derived class, for example it is necessary to do:</p>\n\n<pre><code>template&lt;typename T&gt;\nclass B : public A&lt;T&gt;\n{\npublic:\n    void f()\n    {\n        A&lt;T&gt;::g();  // defined in A\n    }\n};\n</code></pre>\n\n<p>In that case <code>this-&gt;g()</code> does also work, but it can have a different meaning.</p>\n\n<p>It may be useful to define a typedef of the base class as a member of <code>B&lt;T&gt;</code>, for example:</p>\n\n<pre><code>class B : public A&lt;T&gt;         /// derived class\n{\n    using base = A&lt;T&gt;;\npublic:\n    B(int i) :\n        base {i}\n    {\n    }\n};\n</code></pre>\n\n<p>Then the base class's template arguments need to be repeated only one time in the code.</p>\n"}], "owner": {"reputation": 691, "user_id": 9102144, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/cca508351edb6d6fead84c96a336e56c?s=128&d=identicon&r=PG&f=1", "display_name": "SSteven", "link": "https://stackoverflow.com/users/9102144/ssteven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "accepted_answer_id": 51172638, "answer_count": 2, "score": 3, "last_activity_date": 1530704148, "creation_date": 1530702789, "question_id": 51172302, "link": "https://stackoverflow.com/questions/51172302/accessing-template-base-classs-constructor-from-derived-class", "title": "Accessing template base class&#39;s constructor from derived class", "body": "<p>Please consider the following scenario:<br>\n1) A parameterized base class A&lt;T><br>\n2) A parameterized derived class B&lt;T> deriving from A&lt;T>.</p>\n\n<p>When the derived class' ctor tries to reference the base class, a compilation error occurs:</p>\n\n<pre><code>/** Examines how to invoke the Base class ctor\n    from the Derived class,\n    when both classes are templates.\n*/\n\n#include &lt;iostream&gt;\n\nusing namespace std;\n\n\ntemplate&lt;typename T&gt;\nclass A                     /// base class\n{\npublic:\n    A(int i)\n    {\n    }\n};\n\n\ntemplate&lt;typename T&gt;\nclass B : public A&lt;T&gt;         /// derived class\n{\npublic:\n    B(int i) :\n        A {i}\n    {\n    }\n};\n\n\nint main()\n{\n    A&lt;int&gt; a {5};\n    B&lt;int&gt; b {10};\n}\n</code></pre>\n\n<p><br/>Errors:</p>\n\n<pre><code>\\main.cpp||In constructor 'B&lt;T&gt;::B(int)':|\n\\main.cpp|26|error: class 'B&lt;T&gt;' does not have any field named 'A'|\n\n\\main.cpp||In instantiation of 'B&lt;T&gt;::B(int) [with T = int]':|\n\\main.cpp|35|required from here|\n\\main.cpp|26|error: no matching function for call to 'A&lt;int&gt;::A()'|\n\n\\main.cpp|26|note: candidates are:|\n\\main.cpp|15|note: A&lt;T&gt;::A(int) [with T = int]|\n\\main.cpp|15|note:   candidate expects 1 argument, 0 provided|\n\\main.cpp|12|note: constexpr A&lt;int&gt;::A(const A&lt;int&gt;&amp;)|\n\\main.cpp|12|note:   candidate expects 1 argument, 0 provided|\n\\main.cpp|12|note: constexpr A&lt;int&gt;::A(A&lt;int&gt;&amp;&amp;)|\n\\main.cpp|12|note:   candidate expects 1 argument, 0 provided|\n||=== Build failed: 2 error(s), 2 warning(s) (0 minute(s), 0 second(s)) ===|\n</code></pre>\n\n<p><br/>The compiler interprets the B class's ctor as initializing a field A in the B class, rather than as invoking the A class' ctor.</p>\n\n<p>How can this be fixed?</p>\n"}, {"tags": ["c++", "c", "openssl", "dtls", "wolfssl"], "answers": [{"tags": [], "owner": {"reputation": 648, "user_id": 9968825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6d0332ac7d53381e1a5b84b320fd135?s=128&d=identicon&r=PG", "display_name": "chrysn", "link": "https://stackoverflow.com/users/9968825/chrysn"}, "is_accepted": true, "score": 0, "last_activity_date": 1532522053, "creation_date": 1532522053, "answer_id": 51519020, "question_id": 51172291, "link": "https://stackoverflow.com/questions/51172291/how-detect-received-message-in-dtls/51519020#51519020", "title": "How detect received message in DTLS?", "body": "<p>In nonblocking operation, you typically have a point in the program where it waits for any of the nonblocking file descriptors to report availability of data.</p>\n\n<p>In the example you linked, that's the <code>select(...)</code> line. In practice, you either have such a central select yourself, or have the main loop run by another library to which you pass the descriptors of whose readiness you want to be notified (eg. in GTK that might be <a href=\"https://developer.gnome.org/glib/stable/glib-The-Main-Event-Loop.html#g-source-add-unix-fd\" rel=\"nofollow noreferrer\">g_source_add_unix_fd</a>).</p>\n"}], "owner": {"reputation": 13, "user_id": 9940905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y78EdRswvfw/AAAAAAAAAAI/AAAAAAAAAAA/JcjcDgE3aGU/photo.jpg?sz=128", "display_name": "Anton", "link": "https://stackoverflow.com/users/9940905/anton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 51519020, "answer_count": 1, "score": -6, "last_activity_date": 1532522053, "creation_date": 1530702743, "last_edit_date": 1530704733, "question_id": 51172291, "link": "https://stackoverflow.com/questions/51172291/how-detect-received-message-in-dtls", "title": "How detect received message in DTLS?", "body": "<p>I implement DTLS protocol for CoAP on C, C++.\nAs I see I can use OpenSSL or WolfSSL.\nFor example WolfSSL:</p>\n\n<p><a href=\"https://github.com/wolfSSL/wolfssl-examples/blob/master/dtls/client-dtls-nonblocking.c\" rel=\"nofollow noreferrer\">https://github.com/wolfSSL/wolfssl-examples/blob/master/dtls/client-dtls-nonblocking.c</a></p>\n\n<p>But how I can detect that some message has been sent to me?</p>\n"}, {"tags": ["c++", "stl", "stdvector", "stdset"], "comments": [{"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530702653, "post_id": 51172214, "comment_id": 89327125, "body": "Did you debug DateOrderSorter to see if it works well?"}, {"owner": {"reputation": 140, "user_id": 3986685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c8b7fd610afb090b13abf4ae7f4a85?s=128&d=identicon&r=PG&f=1", "display_name": "Algorithmic", "link": "https://stackoverflow.com/users/3986685/algorithmic"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530702770, "post_id": 51172214, "comment_id": 89327200, "body": "Yes, I printed out the set and was able to verify that it sorts it in date order"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1530702868, "post_id": 51172214, "comment_id": 89327255, "body": "What happens if multiple files have the same date associated with them?"}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 1, "creation_date": 1530702929, "post_id": 51172214, "comment_id": 89327294, "body": "My guess is that <code>stat</code> returns an error (which is not checked by the code), maybe because <code>path</code> is not initialized to a given directory, but default initialized to <code>&quot;&quot;</code>."}, {"owner": {"reputation": 140, "user_id": 3986685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c8b7fd610afb090b13abf4ae7f4a85?s=128&d=identicon&r=PG&f=1", "display_name": "Algorithmic", "link": "https://stackoverflow.com/users/3986685/algorithmic"}, "edited": false, "score": 0, "creation_date": 1530702964, "post_id": 51172214, "comment_id": 89327321, "body": "I have ensured that they don&#39;t have the same date but my working sorter checks for this and defaults back to alphabetical sort if the dates are the same"}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 2, "creation_date": 1530703363, "post_id": 51172214, "comment_id": 89327569, "body": "Can you show the code where <code>path</code> is assigned?"}, {"owner": {"reputation": 1779, "user_id": 1065992, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sWiDT.png?s=128&g=1", "display_name": "Blood-HaZaRd", "link": "https://stackoverflow.com/users/1065992/blood-hazard"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530703662, "post_id": 51172214, "comment_id": 89327780, "body": "@OlivierSohn jussted, what about the content of <code>Path</code> ? does it point to the right Parent Path ?"}, {"owner": {"reputation": 140, "user_id": 3986685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c8b7fd610afb090b13abf4ae7f4a85?s=128&d=identicon&r=PG&f=1", "display_name": "Algorithmic", "link": "https://stackoverflow.com/users/3986685/algorithmic"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530703812, "post_id": 51172214, "comment_id": 89327863, "body": "@OlivierSohn: I&#39;ve added the part where I assign path now"}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530703921, "post_id": 51172214, "comment_id": 89327939, "body": "@Algorithmic yes but what you wrote doesn&#39;t do what you think it does : use a debugger and see what happens in the comparison function (it&#39;s a different instance, and note that <code>path</code> is not static)."}, {"owner": {"reputation": 140, "user_id": 3986685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c8b7fd610afb090b13abf4ae7f4a85?s=128&d=identicon&r=PG&f=1", "display_name": "Algorithmic", "link": "https://stackoverflow.com/users/3986685/algorithmic"}, "edited": false, "score": 0, "creation_date": 1530704701, "post_id": 51172214, "comment_id": 89328449, "body": "ok, I see that we&#39;re getting a bit fixated on the path issue but consider this to be working as expected. I have verified that it does, I just can&#39;t replicate my entire set of code here."}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 1, "creation_date": 1530704940, "post_id": 51172214, "comment_id": 89328593, "body": "@Algorithmic I&#39;m not convinced, can you test the return value of <code>stat</code>, to verify that the function succeeds (i.e returns zero)?"}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530705461, "post_id": 51172214, "comment_id": 89328954, "body": "@Algorithmic see my answer on how to fix, imho."}], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 3986685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c8b7fd610afb090b13abf4ae7f4a85?s=128&d=identicon&r=PG&f=1", "display_name": "Algorithmic", "link": "https://stackoverflow.com/users/3986685/algorithmic"}, "edited": false, "score": 0, "creation_date": 1530704115, "post_id": 51172620, "comment_id": 89328064, "body": "I used touch File_name.txt to ensure that the times are different. So I&#39;m skeptical that the problem relates to the file names/dates being the same."}], "tags": [], "owner": {"reputation": 3204, "user_id": 2228338, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-b3jn9hCpWYU/AAAAAAAAAAI/AAAAAAAAAAs/-1U-aoxnBOc/photo.jpg?sz=128", "display_name": "Yuki", "link": "https://stackoverflow.com/users/2228338/yuki"}, "is_accepted": false, "score": 0, "last_activity_date": 1530703755, "creation_date": 1530703755, "answer_id": 51172620, "question_id": 51172214, "link": "https://stackoverflow.com/questions/51172214/how-do-i-insert-stdvector-into-a-stdset-which-has-a-custom-sort-function/51172620#51172620", "title": "How do I Insert std::vector into a std::set which has a custom sort function", "body": "<p>Because <code>ctime</code> suggests that it is Posix time, that is of second scale. Of course, two different files might have the same value of this time, that actually means the last time the file's status has changed. Try to use <a href=\"https://en.cppreference.com/w/cpp/container/multiset\" rel=\"nofollow noreferrer\"><code>std::mutiset</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 140, "user_id": 3986685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c8b7fd610afb090b13abf4ae7f4a85?s=128&d=identicon&r=PG&f=1", "display_name": "Algorithmic", "link": "https://stackoverflow.com/users/3986685/algorithmic"}, "edited": false, "score": 1, "creation_date": 1530705529, "post_id": 51172830, "comment_id": 89328992, "body": "Actually, you were right. It was about that path variable not being initialized. Thanks so much!"}, {"owner": {"reputation": 140, "user_id": 3986685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c8b7fd610afb090b13abf4ae7f4a85?s=128&d=identicon&r=PG&f=1", "display_name": "Algorithmic", "link": "https://stackoverflow.com/users/3986685/algorithmic"}, "edited": false, "score": 1, "creation_date": 1530706215, "post_id": 51172830, "comment_id": 89329434, "body": "do you mind if I delete this question? It could be quite misleading for someone who&#39;s just trying to insert a vector into a set..."}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "reply_to_user": {"reputation": 140, "user_id": 3986685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c8b7fd610afb090b13abf4ae7f4a85?s=128&d=identicon&r=PG&f=1", "display_name": "Algorithmic", "link": "https://stackoverflow.com/users/3986685/algorithmic"}, "edited": false, "score": 1, "creation_date": 1530706343, "post_id": 51172830, "comment_id": 89329511, "body": "@Algorithmic maybe change the title. Or delete the question, if you want I don&#39;t mind."}], "tags": [], "owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "is_accepted": true, "score": 2, "last_activity_date": 1530737887, "last_edit_date": 1530737887, "creation_date": 1530704428, "answer_id": 51172830, "question_id": 51172214, "link": "https://stackoverflow.com/questions/51172214/how-do-i-insert-stdvector-into-a-stdset-which-has-a-custom-sort-function/51172830#51172830", "title": "How do I Insert std::vector into a std::set which has a custom sort function", "body": "<p>The <code>path</code> member of the comparison function is default-initialized to \"\", hence <code>stat</code> errors (the error goes unnoticed because the return value is not checked in the code), and <code>buf_stat1.st_ctime &lt; buf_stat2.st_ctime</code> is comparing uninitialized memory.</p>\n\n<p>Which means that the comparison function can return true for both <code>a &lt; b</code> and <code>a &gt; b</code> : this violates a rule of <a href=\"https://en.wikipedia.org/wiki/Weak_ordering\" rel=\"nofollow noreferrer\">strict weak ordering</a>, hence you observe this weird behaviour.</p>\n\n<p>To fix this, you can make <code>path</code> a static member, and verify that <code>stat</code> doesn't error, like so :</p>\n\n<pre><code>struct DateOrderSorter\n{\n    bool operator()(const std::string&amp; file1, const std::string&amp; file2)\n    {\n        struct stat buf_stat1;\n        struct stat buf_stat2;\n        std::string fullpath1 = path + file1;\n        std::string fullpath2 = path + file2;\n        int r = stat(&amp;fullpath1[0], &amp;buf_stat1);\n        assert(r==0);\n        r = stat(&amp;fullpath2[0], &amp;buf_stat2);\n        assert(r==0);\n        return buf_stat1.st_ctime &lt; buf_stat2.st_ctime;\n    }\n    static std::string path;\n};\n</code></pre>\n\n<p>and initialize it like so:</p>\n\n<pre><code>DateOrderSorter::path = \"...\";\n</code></pre>\n"}], "owner": {"reputation": 140, "user_id": 3986685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c8b7fd610afb090b13abf4ae7f4a85?s=128&d=identicon&r=PG&f=1", "display_name": "Algorithmic", "link": "https://stackoverflow.com/users/3986685/algorithmic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 51172830, "answer_count": 2, "score": 0, "last_activity_date": 1530762394, "creation_date": 1530702462, "last_edit_date": 1530762394, "question_id": 51172214, "link": "https://stackoverflow.com/questions/51172214/how-do-i-insert-stdvector-into-a-stdset-which-has-a-custom-sort-function", "title": "How do I Insert std::vector into a std::set which has a custom sort function", "body": "<p><strong>Note that the problem here has been solved and it had nothing to do with the insert but rather an uninitialized struct member variable! Hopefully this question and its answer might help another rookie avoid such a mistake.</strong></p>\n\n<p>I want to insert a std::vector of file names into a std::set that has a customer sorter struct for ordering files by date instead of alphabetically.</p>\n\n<p>With the default alphabetical ordering I can simply insert a vector into my set using:</p>\n\n<pre><code>std::set&lt;std::string&gt; mySet;\nstd::vector&lt;std::string&gt; myVector;\n\nmyVector.push_back(\"Banana.txt\");\nmyVector.push_back(\"Apple.txt\");\nmyVector.push_back(\"Cat.txt\");\n\nmySet.insert(myVector.begin(), myVector.end());\n</code></pre>\n\n<p>And this would give me exactly what I would expect: A std::set of file names that would be ordered alphabetically.</p>\n\n<p>Now if I have a custom sorter that sorts by date instead of file name, like so:</p>\n\n<pre><code>struct DateOrderSorter\n{\n    bool operator()(const std::string&amp; file1, const std::string&amp; file2)\n    {\n        struct stat buf_stat1;\n        struct stat buf_stat2;\n        std::string fullpath1 = path + file1;\n        std::string fullpath2 = path + file2;\n        stat(&amp;fullpath1[0], &amp;buf_stat1);\n        stat(&amp;fullpath2[0], &amp;buf_stat2);\n        return buf_stat1.st_ctime &lt; buf_stat2.st_ctime;\n    }\n    std::string path;\n};\n</code></pre>\n\n<p>And I declare my set as:   </p>\n\n<pre><code>std::set&lt;std::string, DateOrderSorter&gt;\n</code></pre>\n\n<p>and then declare an instance of DateOrderSorter:</p>\n\n<pre><code>DateOrderSorter dateOrderSorter;\ndateOrderSorter.path = \"C:/random_path_that_has_been_verified_to_work\"\n</code></pre>\n\n<p>When I do the same insertion:</p>\n\n<pre><code>mySet.insert(myVector.begin(), myVector.end());\n</code></pre>\n\n<p>It returns just the first and the last files sorted by date. So just myVector.begin() and myVector.end().</p>\n\n<ol>\n<li>First of all, why this behavior?</li>\n<li>What can I do to get the vector inserted into my set ordered through my customer sorter.</li>\n</ol>\n\n<p>I've tried </p>\n\n<pre><code>std::vector&lt;std::string&gt;::iterator vector_it = myVector.begin();\nstd::vector&lt;std::string&gt;::iterator vector_end = myVector.end();\nfor (; vector_it!= vector_end; ++vector_it) {\n    mySet.insert(*vector_it);\n}\n</code></pre>\n\n<p>But this didn't copy the vector fully and the order was very weird. It didn't follow name or date order..</p>\n"}, {"tags": ["c++", "bad-alloc"], "comments": [{"owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "edited": false, "score": 2, "creation_date": 1530701476, "post_id": 51171868, "comment_id": 89326360, "body": "It would be best to share some (relevant) code for us to have a chance to help"}, {"owner": {"reputation": 3, "user_id": 9289570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf6d5277154516130d5cb428ecf9609?s=128&d=identicon&r=PG&f=1", "display_name": "JiLight", "link": "https://stackoverflow.com/users/9289570/jilight"}, "edited": false, "score": 0, "creation_date": 1530701570, "post_id": 51171868, "comment_id": 89326426, "body": "Sorry i meant MB (i edited my question)"}, {"owner": {"reputation": 1747, "user_id": 6800303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86ffb4271b65f9121097792b5f77af1?s=128&d=identicon&r=PG&f=1", "display_name": "NitinSingh", "link": "https://stackoverflow.com/users/6800303/nitinsingh"}, "edited": false, "score": 0, "creation_date": 1530701998, "post_id": 51171868, "comment_id": 89326708, "body": "For the 2nd exception, there must be some extra information which points out the reason why app must end (different from first)"}, {"owner": {"reputation": 3, "user_id": 9289570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf6d5277154516130d5cb428ecf9609?s=128&d=identicon&r=PG&f=1", "display_name": "JiLight", "link": "https://stackoverflow.com/users/9289570/jilight"}, "edited": false, "score": 0, "creation_date": 1530702124, "post_id": 51171868, "comment_id": 89326787, "body": "I get the same bad alloc message, only it continues to run until it crashes"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9289570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf6d5277154516130d5cb428ecf9609?s=128&d=identicon&r=PG&f=1", "display_name": "JiLight", "link": "https://stackoverflow.com/users/9289570/jilight"}, "edited": false, "score": 0, "creation_date": 1530701896, "post_id": 51171992, "comment_id": 89326633, "body": "I understand this, which is why I had the try catch(bad alloc). The issue is that when the exception is throw I expect everything to return to the state before the bad_alloc happens. Which is not the case since I can&#39;t relaunch the application a second time."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 3, "user_id": 9289570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf6d5277154516130d5cb428ecf9609?s=128&d=identicon&r=PG&f=1", "display_name": "JiLight", "link": "https://stackoverflow.com/users/9289570/jilight"}, "edited": false, "score": 0, "creation_date": 1530701938, "post_id": 51171992, "comment_id": 89326664, "body": "<i>&quot;I can&#39;t relaunch the application a second time&quot;</i> - what is preventing you from doing this?"}, {"owner": {"reputation": 3, "user_id": 9289570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf6d5277154516130d5cb428ecf9609?s=128&d=identicon&r=PG&f=1", "display_name": "JiLight", "link": "https://stackoverflow.com/users/9289570/jilight"}, "edited": false, "score": 0, "creation_date": 1530702076, "post_id": 51171992, "comment_id": 89326747, "body": "When I relaunch it a second time I get the the error message but there is something still running (the application doesn&#39;t stop) then crashes."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 3, "user_id": 9289570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf6d5277154516130d5cb428ecf9609?s=128&d=identicon&r=PG&f=1", "display_name": "JiLight", "link": "https://stackoverflow.com/users/9289570/jilight"}, "edited": false, "score": 0, "creation_date": 1530702237, "post_id": 51171992, "comment_id": 89326870, "body": "@LightJecht You should investigate the crash then... Your question actually turns out to be an XY problem."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 3, "user_id": 9289570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf6d5277154516130d5cb428ecf9609?s=128&d=identicon&r=PG&f=1", "display_name": "JiLight", "link": "https://stackoverflow.com/users/9289570/jilight"}, "edited": false, "score": 0, "creation_date": 1530702313, "post_id": 51171992, "comment_id": 89326923, "body": "@LightJecht related:  <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}], "tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": false, "score": 1, "last_activity_date": 1530701904, "last_edit_date": 1530701904, "creation_date": 1530701734, "answer_id": 51171992, "question_id": 51171868, "link": "https://stackoverflow.com/questions/51171868/c-bad-alloc-applicaition-failure/51171992#51171992", "title": "c++ bad alloc applicaition failure", "body": "<p>Now then array of 260 of 14Mb objects would require about 4Gb of RAM. And the tricky part is that it must be a solid block. So it could be not available due to memory fragmentation even if amount of free RAM is sufficient. You should try using non-contiguous container, such as <code>std::list</code> instead or <code>std::vector&lt;std::unique_ptr&lt;obj_t&gt;&gt;</code>. Application is usable regardless of amount of times exceptions are thrown (assuming that they are caught). And with greater granularity of allocations it should be less likely to fail to allocate memory.</p>\n"}], "owner": {"reputation": 3, "user_id": 9289570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf6d5277154516130d5cb428ecf9609?s=128&d=identicon&r=PG&f=1", "display_name": "JiLight", "link": "https://stackoverflow.com/users/9289570/jilight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1530701904, "creation_date": 1530701366, "last_edit_date": 1530701547, "question_id": 51171868, "link": "https://stackoverflow.com/questions/51171868/c-bad-alloc-applicaition-failure", "title": "c++ bad alloc applicaition failure", "body": "<p>I have a piece of code where I dynamically create some relatively big objects (14MB) and populate a vector with them (of size 260). I am getting a bad alloc exception which I am catching. The application is still usable after my first throw, then when I relaunch it the bad alloc exception is thrown once again but the application is not usable anymore.\nDo you know if there is a way to keep it usable even after the exception is thrown (no matter the number of times it is thrown).</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "c", "swift"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1530705793, "post_id": 51171787, "comment_id": 89329161, "body": "This is not C.. it&#39;s C++ or C# i guess."}, {"owner": {"reputation": 2473, "user_id": 1824565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e2c67135c7db0abfe784397503f20733?s=128&d=identicon&r=PG", "display_name": "Reimond Hill", "link": "https://stackoverflow.com/users/1824565/reimond-hill"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1530709936, "post_id": 51171787, "comment_id": 89331808, "body": "sorry i am go change the tag then"}], "answers": [{"comments": [{"owner": {"reputation": 2473, "user_id": 1824565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e2c67135c7db0abfe784397503f20733?s=128&d=identicon&r=PG", "display_name": "Reimond Hill", "link": "https://stackoverflow.com/users/1824565/reimond-hill"}, "edited": false, "score": 0, "creation_date": 1530970195, "post_id": 51216612, "comment_id": 89427645, "body": "I see, I have been doing some testing and I more or less assumed It was something like that but that explanation makes it more understandable! Thank you"}], "tags": [], "owner": {"reputation": 1323, "user_id": 6900902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a5448d619d9cd1bd6341a384301587?s=128&d=identicon&r=PG&f=1", "display_name": "bscothern", "link": "https://stackoverflow.com/users/6900902/bscothern"}, "is_accepted": true, "score": 2, "last_activity_date": 1530905275, "creation_date": 1530905275, "answer_id": 51216612, "question_id": 51171787, "link": "https://stackoverflow.com/questions/51171787/takeretainedvalue-or-takeunretainedvalue-in-swift-with-c-library/51216612#51216612", "title": "takeRetainedValue() or takeUnretainedValue() in Swift with C++ Library", "body": "<p>You need to pass in a retained value if you want your <code>ClassCallback</code> to exist even if all your Swift references to it go away, this creates a memory leak without proper cleanup logic also being added in. If you pass an unretained value then if all of your swift references have gone away when you try to get back your <code>ClassCallback</code> you will crash.</p>\n\n<p>In your callback, you can take an unretained reference to get the object assuming you want it to continue to exist with its current reference count at the end of scope. If you take a retained reference the reference count will decrement and destroy the object if that was the last reference.</p>\n\n<p>What I generally do is pass in a retained reference and take an unretained reference until I am ready to dispose of the callback object. When that happens I take the retained value of the context pointer (<code>aPtr</code> in your case) to balance the retained pass and replace it with a new appropriate value.</p>\n"}], "owner": {"reputation": 2473, "user_id": 1824565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e2c67135c7db0abfe784397503f20733?s=128&d=identicon&r=PG", "display_name": "Reimond Hill", "link": "https://stackoverflow.com/users/1824565/reimond-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 1, "accepted_answer_id": 51216612, "answer_count": 1, "score": 0, "last_activity_date": 1530905275, "creation_date": 1530701068, "last_edit_date": 1530710066, "question_id": 51171787, "link": "https://stackoverflow.com/questions/51171787/takeretainedvalue-or-takeunretainedvalue-in-swift-with-c-library", "title": "takeRetainedValue() or takeUnretainedValue() in Swift with C++ Library", "body": "<p>I am working on a Swift project that uses a C library wrapped In a C++. </p>\n\n<ul>\n<li><p>The library offers you the possibility to get/set variables synchronously and asynchronously. </p></li>\n<li><p>The Library as callback methods that notifies when and even has happened.</p></li>\n</ul>\n\n<p>I have this function in swift:</p>\n\n<pre><code>/*** Convert const void* To Any T ***/\n\nfunc bridgeToTypeRetained&lt;T : AnyObject&gt;(ptr : UnsafeMutableRawPointer) -&gt; T {\n   return Unmanaged&lt;T&gt;.fromOpaque(ptr).takeRetainedValue()\n}\n\nfunc bridgeToTypeUnretained&lt;T : AnyObject&gt;(ptr : UnsafeRawPointer) -&gt; T {\n   return Unmanaged&lt;T&gt;.fromOpaque(ptr).takeUnretainedValue()\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>/*** Convert const void* To Any T ***/\nfunc bridgeToPointerRetained&lt;T : AnyObject&gt;(obj : T) -&gt; UnsafeMutableRawPointer {\n    return UnsafeMutableRawPointer(Unmanaged.passRetained(obj).toOpaque())\n}\n\nfunc bridgeToPointerUnretained&lt;T : AnyObject&gt;(obj : T) -&gt; UnsafeMutableRawPointer {\n    return UnsafeMutableRawPointer(Unmanaged.passUnretained(obj).toOpaque())\n}\n</code></pre>\n\n<p>For Implementing Callbacks from the Library, In the Library I have the following definitions:</p>\n\n<pre><code>DllExport void STDCALL CpProxyAvOpenhomeOrgInfo1SetPropertyTrackCountChanged(THandle aHandle, OhNetCallback aCallback, void* aPtr);\n\ntypedef void (STDCALL *OhNetCallback)(void* aPtr);\n</code></pre>\n\n<p>Then in swift I use the following Code:</p>\n\n<pre><code> CpProxyAvOpenhomeOrgInfo1SetPropertyTrackCountChanged(myHandle, { (pointer) in\n\n if pointer != nil{\n    let myClass:MyClass = bridgeToTypeRetained(ptr: pointer!)\n    myClass.aValu = 0 //CRASH BAD ACCESS\n    let myClass:MyClass = bridgeToTypeUnretained(ptr: pointer!)\n    myClass.aValu = 0 //NO CRASH\n }\n\n }, bridgeToPointerRetained(obj: self))\n</code></pre>\n\n<p>And for implementing an asynchronously action, In the Library I have they following definitions:</p>\n\n<pre><code>DllExport void STDCALL CpProxyAvOpenhomeOrgInfo1BeginCounters(THandle aHandle, OhNetCallbackAsync aCallback, void* aPtr);\n\ntypedef void (STDCALL *OhNetCallbackAsync)(void* aPtr, OhNetHandleAsync aAsync);\n</code></pre>\n\n<p>Then swift I use the following code</p>\n\n<pre><code>    let classCallback = ClassCallback()\n    classCallback.classObject = self\n\n    CpProxyAvOpenhomeOrgInfo1BeginCounters(prxHandleId, { (pointer, ohNetAsync) in\n\n        if pointer != nil &amp;&amp; ohNetAsync != nil{\n\n            let classCallback : ClassCallback = bridgeToTypeRetained(ptr: pointer!)\n            classCallback.classObject.aValue = 1 //NO CRASH\n\n        }\n\n\n    }, bridgeToPointerRetained(obj: classCallback))\n</code></pre>\n\n<p>So My questions would be: </p>\n\n<ul>\n<li>When do I have to use takeRetainedValue() or takeUnretainedValue() according to info I can get from the C++ Library?</li>\n</ul>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "arrays", "visual-c++", "struct"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1530701136, "post_id": 51171751, "comment_id": 89326149, "body": "Code compiles fine here. Well, once you put it into a function."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1530702275, "post_id": 51171751, "comment_id": 89326896, "body": "@Ron The function that is missing from the code in the question"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1530702769, "post_id": 51171751, "comment_id": 89327198, "body": "@Ron Doesn&#39;t matter. That code needs to live in a function of some form."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1530702858, "post_id": 51171751, "comment_id": 89327247, "body": "@DavidHeffernan I always felt your intellect and drive would be better entertained with C++. I wonder why you still haven&#39;t made the switch from Delphi? Plenty to explore in the C++ realm."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1530702977, "post_id": 51171751, "comment_id": 89327331, "body": "@Ron A million lines of code are holding me back........ Not that I am a massive fan of C++. I find it to have more complexity that I like. I do like the fact that C++ compilers tend to produce faster code than the useless Delphi compiler. Flip side though, as a Win32 programmer, I think VCL is still way ahead of anything else."}], "answers": [{"tags": [], "owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "is_accepted": true, "score": 0, "last_activity_date": 1530701125, "creation_date": 1530701125, "answer_id": 51171802, "question_id": 51171751, "link": "https://stackoverflow.com/questions/51171751/c-structure-arrays-this-declaration-has-no-storage-class-or-type-specifier/51171802#51171802", "title": "c++ Structure Arrays - &quot;This declaration has no storage class or type specifier&quot;", "body": "<p>Because you're not in a function: replace</p>\n\n<pre><code>testArray[1].letter = 'v';\n</code></pre>\n\n<p>by</p>\n\n<pre><code>int main() {\n    testArray[1].letter = 'v';\n    return 0;\n}\n</code></pre>\n\n<p>and it compiles allright.</p>\n"}, {"tags": [], "owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "is_accepted": false, "score": 2, "last_activity_date": 1530703398, "last_edit_date": 1530703398, "creation_date": 1530702629, "answer_id": 51172265, "question_id": 51171751, "link": "https://stackoverflow.com/questions/51171751/c-structure-arrays-this-declaration-has-no-storage-class-or-type-specifier/51172265#51172265", "title": "c++ Structure Arrays - &quot;This declaration has no storage class or type specifier&quot;", "body": "<p>This is a <a href=\"https://en.cppreference.com/w/cpp/language/statements\" rel=\"nofollow noreferrer\">statement</a>:</p>\n\n<pre><code>testArray[1].letter = 'v';\n</code></pre>\n\n<p>Statements are to be executed inside functions (function body) and not in some arbitrary global namespace as you have it now. Move your statement inside a main program <a href=\"https://en.cppreference.com/w/cpp/language/main_function\" rel=\"nofollow noreferrer\">entry point function</a>, a <a href=\"https://en.cppreference.com/w/cpp/language/lambda\" rel=\"nofollow noreferrer\">lambda</a>, a free standing <a href=\"https://en.cppreference.com/w/cpp/language/functions\" rel=\"nofollow noreferrer\">function</a> or a <a href=\"https://en.cppreference.com/w/cpp/language/class\" rel=\"nofollow noreferrer\">class</a> member function body. </p>\n\n<p>Alternatively, use the <a href=\"https://en.cppreference.com/w/cpp/language/aggregate_initialization\" rel=\"nofollow noreferrer\">aggregate initialization</a> to initialize your array:</p>\n\n<pre><code>frequents testArray[2] = {{ 1, 'a' }, { 2, 'b' }};\n</code></pre>\n\n<p>or without the extra braces: </p>\n\n<pre><code>frequents testArray[2] = { 1, 'a', 2, 'b' };\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9729886, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jirikai Naito", "link": "https://stackoverflow.com/users/9729886/jirikai-naito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 0, "accepted_answer_id": 51171802, "answer_count": 2, "score": 0, "last_activity_date": 1530703398, "creation_date": 1530700944, "question_id": 51171751, "link": "https://stackoverflow.com/questions/51171751/c-structure-arrays-this-declaration-has-no-storage-class-or-type-specifier", "title": "c++ Structure Arrays - &quot;This declaration has no storage class or type specifier&quot;", "body": "<p>I'm having trouble with struct arrays. this is the code I have that produces 2 red error lines.</p>\n\n<pre><code>    struct frequents\n{\n    int count;\n    char letter;\n};\n\nfrequents testArray[2];\ntestArray[1].letter = 'v';   \n</code></pre>\n\n<p>The error appears under testArray which has the declaration error and under '.' which mentions that it expected a ';'.</p>\n"}, {"tags": ["c++", "pointers", "auto"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 7, "creation_date": 1530701057, "post_id": 51171746, "comment_id": 89326090, "body": "auto only deduces the type for you, it doesn&#39;t do anything else."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 3, "creation_date": 1530701255, "post_id": 51171746, "comment_id": 89326218, "body": "<i>&quot;If I have this line&quot;</i> You should not have this line. Use RAII. If you must use pointers, use smart pointers."}], "answers": [{"tags": [], "owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "is_accepted": true, "score": 5, "last_activity_date": 1530701257, "creation_date": 1530701257, "answer_id": 51171842, "question_id": 51171746, "link": "https://stackoverflow.com/questions/51171746/the-new-auto-keyword-pointer-does-delete-itself/51171842#51171842", "title": "the new auto keyword pointer does delete itself?", "body": "<p><code>auto</code> has nothing to do with <code>auto_ptr</code>, it just tells the compiler to deduce a type.</p>\n\n<p>So yes, in the example you provide, <code>delete</code> is needed.</p>\n\n<p>Slightly off-topic : you mention <code>auto_ptr</code> (this one is deprecated) and <code>shared_ptr</code>, but there is also <code>unique_ptr</code> which is quite handy because it's very lightweight (practically no overhead), and can be used when there is a single owner.</p>\n"}], "owner": {"reputation": 10749, "user_id": 1106247, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/upOkK.png?s=128&g=1", "display_name": "Mario M", "link": "https://stackoverflow.com/users/1106247/mario-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 51171842, "answer_count": 1, "score": 0, "last_activity_date": 1530701257, "creation_date": 1530700924, "question_id": 51171746, "link": "https://stackoverflow.com/questions/51171746/the-new-auto-keyword-pointer-does-delete-itself", "title": "the new auto keyword pointer does delete itself?", "body": "<p>If I have this line</p>\n\n<pre><code>auto* f = new boost::posix_time::time_input_facet(\"%d %b %Y %H:%M:%S\");\n</code></pre>\n\n<p>do I have to delete the pointer? or it cleans up itself?</p>\n\n<pre><code>delete f; // ??\n</code></pre>\n\n<p>I know that auto_ptr and shared_ptr are deleted automatically, but I don't know about auto</p>\n"}, {"tags": ["c++", "sockets", "g++"], "answers": [{"comments": [{"owner": {"reputation": 3321, "user_id": 4383820, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3Ul5Q.png?s=128&g=1", "display_name": "Lasitha Yapa", "link": "https://stackoverflow.com/users/4383820/lasitha-yapa"}, "edited": false, "score": 0, "creation_date": 1530702813, "post_id": 51172219, "comment_id": 89327222, "body": "But there&#39;s no function called close()"}, {"owner": {"reputation": 1205, "user_id": 2575630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iI59n.jpg?s=128&g=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/2575630/robert"}, "edited": false, "score": 1, "creation_date": 1530702937, "post_id": 51172219, "comment_id": 89327299, "body": "There is a close-function you can use for sockets: <a href=\"http://pubs.opengroup.org/onlinepubs/009696899/functions/close.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/009696899/functions/close.html</a>&zwnj;&#8203;."}, {"owner": {"reputation": 3321, "user_id": 4383820, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3Ul5Q.png?s=128&g=1", "display_name": "Lasitha Yapa", "link": "https://stackoverflow.com/users/4383820/lasitha-yapa"}, "edited": false, "score": 0, "creation_date": 1530704535, "post_id": 51172219, "comment_id": 89328351, "body": "Thanks. This is the answer.  Just a suggestion. Your answer would be more valuable if you add where <code>close()</code> is taken from and how to print <code>errno</code>"}], "tags": [], "owner": {"reputation": 1573, "user_id": 752318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31de368b1bbb9988477511b2c59d61c0?s=128&d=identicon&r=PG", "display_name": "pure cuteness", "link": "https://stackoverflow.com/users/752318/pure-cuteness"}, "is_accepted": true, "score": 1, "last_activity_date": 1530702471, "creation_date": 1530702471, "answer_id": 51172219, "question_id": 51171707, "link": "https://stackoverflow.com/questions/51171707/reconnection-does-not-work-as-expected/51172219#51172219", "title": "Reconnection does not work as expected", "body": "<p>Close socket and set it to -1 before reconnecting. So modify your <code>send_data</code> function like this:</p>\n\n<pre><code>close(sock);\nsock = -1;\nstart(\"127.0.0.1\", 9090);\n</code></pre>\n\n<p>Also socket function always return -1 on failure. You should print <code>errno</code> instead of returned code</p>\n"}], "owner": {"reputation": 3321, "user_id": 4383820, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3Ul5Q.png?s=128&g=1", "display_name": "Lasitha Yapa", "link": "https://stackoverflow.com/users/4383820/lasitha-yapa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 51172219, "answer_count": 1, "score": 0, "last_activity_date": 1530702471, "creation_date": 1530700778, "question_id": 51171707, "link": "https://stackoverflow.com/questions/51171707/reconnection-does-not-work-as-expected", "title": "Reconnection does not work as expected", "body": "<p>I am using sys/socket.h for sending heartbeats to a server repeatedly.<br>\nConnection work fine. Problem occurs when server restart.<br>\nThis is my code.</p>\n\n<pre><code>bool HbClient::start(const char *address, int port)\n{\n   //create socket if it is not already created\n   if(sock == -1)\n   {\n      sock = socket(AF_INET , SOCK_STREAM , 0);\n      if (sock == -1)\n      {\n         printf(\"Could not create socket object\");\n         return false;\n      }\n\n      printf(\"Socket object created\\n\");\n   }\n\n   server.sin_addr.s_addr = inet_addr( address );\n   server.sin_family = AF_INET;\n   server.sin_port = htons( port );\n\n   return connect_to_server();\n}\n\nbool HbClient::connect_to_server()\n{\n   int status = connect(sock , (struct sockaddr *)&amp;server , sizeof(server));\n\n   cout &lt;&lt; \"returned status: \" &lt;&lt; status &lt;&lt; endl &lt;&lt; flush;\n   if (status &lt; 0)\n   {\n      cout &lt;&lt; \"Error. Connection failed.\" &lt;&lt; endl &lt;&lt; flush;\n      return false;\n   }\n\n   cout &lt;&lt; \"Connected to server\" &lt;&lt; endl &lt;&lt; flush;\n   return true;\n}\n\nbool HbClient::send_data(const char *data)\n{\n   int res = send(sock , data , strlen(data) , MSG_NOSIGNAL);\n   if( res &lt; 0)\n   {\n      cout &lt;&lt; \"Data sending failed, status: \" &lt;&lt; res &lt;&lt; endl &lt;&lt; flush;\n      start(\"127.0.0.1\", 9090);\n      return false;\n   }\n   cout &lt;&lt; \"Data send\" &lt;&lt; endl &lt;&lt; flush;\n\n   return true;\n}\n</code></pre>\n\n<p>send_data() function is invoked repeatedly. Until server restart this works fine. But when server restart these outputs were printed repeatedly.</p>\n\n<pre><code>Data sending failed, status: -1\nreturned status: -1\nError. Connection failed.\n</code></pre>\n\n<p>I am using Ubuntu 16.04 OS and g++ compiler. Can you point out what the issue here?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 2, "creation_date": 1530700789, "post_id": 51171664, "comment_id": 89325901, "body": "If <code>LPOLESTR</code> is <code>wchar_t*</code>, you can&#39;t assign a <code>const wchar_t*</code> to it. You could remove the <code>const</code>ness by casting if you are sure it will not be changed by the function. Otherwise, why not use a <code>wchar_t*</code> or <code>wchar_t[]</code> without const?"}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "reply_to_user": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 1, "creation_date": 1530700870, "post_id": 51171664, "comment_id": 89325951, "body": "@KarstenKoop Ok and how would I do that. Sorry I&#39;m a noob."}, {"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 2, "creation_date": 1530700892, "post_id": 51171664, "comment_id": 89325974, "body": "<a href=\"https://stackoverflow.com/questions/1607266/whats-the-meaning-of-bstr-lpcolestr-and-others\">See also this question</a>. It seems a <code>LPOLESTR</code> implies something about the way it was allocated, similar to <code>BSTR</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 2, "creation_date": 1530700953, "post_id": 51171664, "comment_id": 89326021, "body": "@KarstenKoop: A <code>BSTR</code> is a very different beast indeed, containing a header before the actual string section."}, {"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 1, "creation_date": 1530700983, "post_id": 51171664, "comment_id": 89326046, "body": "Are you using some framework like MFC or ATL? Then there should be helper classes for this."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 1, "creation_date": 1530700986, "post_id": 51171664, "comment_id": 89326048, "body": "@ I saw something on BSTR earlier"}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "reply_to_user": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 0, "creation_date": 1530701514, "post_id": 51171664, "comment_id": 89326386, "body": "@KarstenKoop I&#39;m not using either MFC or ATL."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1530701604, "post_id": 51171664, "comment_id": 89326454, "body": "const violation in C++ (not in C), consider <code>LPCOLESTR</code>."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1530701745, "post_id": 51171664, "comment_id": 89326536, "body": "So why do I see sample code without the <code>const_cast</code> and it seems to work for them?"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1530702043, "post_id": 51171664, "comment_id": 89326723, "body": "use <code>demo( OLESTR(&quot;Visible&quot;) )</code> and check that you have  UNICODE macro defined."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1530702224, "post_id": 51171664, "comment_id": 89326860, "body": "@VictorGubin #define OLESTR(str) L ## str, argument of type &quot;const wchar_t *&quot; is incompatible with parameter of type &quot;LPOLESTR&quot;. I think I must be missing something fundamental in my setup that others normally have."}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1530701664, "post_id": 51171743, "comment_id": 89326480, "body": "D_Bester: If I were you I would only take the const_cast at the point of invocation of an API funcion, then check the function documentation to make sure it doesn&#39;t modify the string."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1530701818, "post_id": 51171743, "comment_id": 89326578, "body": "@PasserBy: Removed, and fixed with the proper Windows typedef."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 1, "creation_date": 1530704581, "post_id": 51171743, "comment_id": 89328373, "body": "This actually doesn&#39;t work for me until I use <code>LPOLESTR lVis = const_cast &lt;wchar_t *&gt;(L&quot;Visible&quot;);</code> so maybe edit that in. Or maybe there&#39;s another reason for that."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1530704606, "post_id": 51171743, "comment_id": 89328390, "body": "I did check to make sure I have UNICODE macro defined"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1530704973, "post_id": 51171743, "comment_id": 89328620, "body": "@D_Bester: Note the <b>C</b> in LPCOLESTR"}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1530705157, "post_id": 51171743, "comment_id": 89328757, "body": "Well then I would need <code>demo(const_cast &lt;LPOLESTR&gt; (lVis2))</code> because the argument needs to be <code>LPOLESTR</code>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1530705219, "post_id": 51171743, "comment_id": 89328796, "body": "Indeed. At the function call site I&#39;d probably use a C-style cast ;-)"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 5, "last_activity_date": 1530705111, "last_edit_date": 1530705111, "creation_date": 1530700904, "answer_id": 51171743, "question_id": 51171664, "link": "https://stackoverflow.com/questions/51171664/how-do-i-create-a-variable-or-constant-of-type-lpolestr/51171743#51171743", "title": "How do I create a variable or constant of type LPOLESTR?", "body": "<p>The problem you have is that <code>LPOLESTR</code> is a <code>typedef</code> for <code>wchar_t*</code>.</p>\n\n<p>A compiler will not allow you to convert a <code>const wchar_t*</code> to a <code>wchar_t*</code> <em>without</em> an explicit <code>const_cast</code>.</p>\n\n<p>Writing, using an alternative type <code>LPCOLESTR</code>:</p>\n\n<pre><code>LPCOLESTR lVis = L\"Visible\";\n</code></pre>\n\n<p>will fix the immediate compilation error as would the more Windows-like and probably preferred by Windows programmers.</p>\n\n<p>Using a <code>const_cast</code> is, in general, not advisable but you will get away with it if the function documentation states that it does not attempt to modify the data passed to it.</p>\n"}], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1007, "favorite_count": 0, "accepted_answer_id": 51171743, "answer_count": 1, "score": 4, "last_activity_date": 1530705111, "creation_date": 1530700614, "last_edit_date": 1592644375, "question_id": 51171664, "link": "https://stackoverflow.com/questions/51171664/how-do-i-create-a-variable-or-constant-of-type-lpolestr", "title": "How do I create a variable or constant of type LPOLESTR?", "body": "<p>I need <code>LPOLESTR</code> (Long Pointer OLE String) as an argument to a simple function call.</p>\n<p>According to <a href=\"https://www.codeproject.com/Articles/3004/The-Complete-Guide-to-C-Strings-Part-II-String-Wra\" rel=\"nofollow noreferrer\">The Complete Guide to C++ Strings, Part II - String Wrapper Classes</a></p>\n<blockquote>\n<p>OLECHAR is a Unicode character (wchar_t)</p>\n<p>LPOLESTR is a string of OLECHAR (OLECHAR*)</p>\n</blockquote>\n<p>So I should be able to do this:</p>\n<pre><code>int demo(LPOLESTR ptName) {\n    return 1;\n}\n\nint main(){\n    \n    demo(L&quot;Visible&quot;);\n}\n</code></pre>\n<p>But I'm getting a compile error:</p>\n<blockquote>\n<p>(const wchar_t[8])L&quot;Visible&quot;</p>\n<p>argument of type &quot;const wchar_t *&quot; is incompatible with parameter of type &quot;LPOLESTR&quot;</p>\n</blockquote>\n<p>or maybe I'll try a variable:</p>\n<pre><code>LPOLESTR lVis = L&quot;Visible&quot;;\n</code></pre>\n<p>But I get this compiler error:</p>\n<blockquote>\n<p>(const wchar_t[8])L&quot;Visible&quot;</p>\n<p>a value of type &quot;const wchar_t *&quot; cannot be used to initialize an entity of type &quot;LPOLESTR&quot;</p>\n</blockquote>\n<p>I have <code>#include &lt;string&gt;</code> at the top.</p>\n<p>This seems like it should be a simple thing but I've been Googling all morning and can't find the answer. How do I create a variable or constant of type LPOLESTR in C++?</p>\n"}, {"tags": ["c++", "sfml", "noise"], "comments": [{"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530701873, "post_id": 51171383, "comment_id": 89326617, "body": "maybe you should do something in the else branch to set it to another texture, or is it pre-initialized? please show the code :) Also, where is the code for <code>FastNoise</code> ? Are you using this class correctly?"}, {"owner": {"reputation": 41, "user_id": 9782736, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yZvIYrmCbP0/AAAAAAAAAAI/AAAAAAAAAEE/Jena5V63bnc/photo.jpg?sz=128", "display_name": "Cow Nation", "link": "https://stackoverflow.com/users/9782736/cow-nation"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530702542, "post_id": 51171383, "comment_id": 89327053, "body": "<a href=\"https://github.com/Auburns/FastNoise\" rel=\"nofollow noreferrer\">github.com/Auburns/FastNoise</a>"}, {"owner": {"reputation": 41, "user_id": 9782736, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yZvIYrmCbP0/AAAAAAAAAAI/AAAAAAAAAEE/Jena5V63bnc/photo.jpg?sz=128", "display_name": "Cow Nation", "link": "https://stackoverflow.com/users/9782736/cow-nation"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530702652, "post_id": 51171383, "comment_id": 89327122, "body": "It still is all grass even if I have an else block which sets the tex to dirt. I&#39;m not sure if I&#39;m doing it right, that&#39;s why I came here."}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530703623, "post_id": 51171383, "comment_id": 89327764, "body": "Are you sure <code>Map[x][y].Sprite.getPosition().x</code>and <code>Map[x][y].Sprite.getPosition().y</code> are integers? if they are floating points between 0 and 1 that would explain it. Or maybe you need to set the noise type, like in the tutorial : <a href=\"https://github.com/Auburns/FastNoise/wiki\" rel=\"nofollow noreferrer\">github.com/Auburns/FastNoise/wiki</a>"}, {"owner": {"reputation": 41, "user_id": 9782736, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yZvIYrmCbP0/AAAAAAAAAAI/AAAAAAAAAEE/Jena5V63bnc/photo.jpg?sz=128", "display_name": "Cow Nation", "link": "https://stackoverflow.com/users/9782736/cow-nation"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530731169, "post_id": 51171383, "comment_id": 89341784, "body": "GrassNoise.SetNoiseType(FastNoise::SimplexFractal); \tGrassNoise.SetSeed((rand() % 100000)); \tGrassNoise.SetFrequency(0.15);"}, {"owner": {"reputation": 41, "user_id": 9782736, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yZvIYrmCbP0/AAAAAAAAAAI/AAAAAAAAAEE/Jena5V63bnc/photo.jpg?sz=128", "display_name": "Cow Nation", "link": "https://stackoverflow.com/users/9782736/cow-nation"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530731178, "post_id": 51171383, "comment_id": 89341789, "body": "GrassHeightMap[x][y] = GrassNoise.GetValue(x, y);"}, {"owner": {"reputation": 41, "user_id": 9782736, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yZvIYrmCbP0/AAAAAAAAAAI/AAAAAAAAAEE/Jena5V63bnc/photo.jpg?sz=128", "display_name": "Cow Nation", "link": "https://stackoverflow.com/users/9782736/cow-nation"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530731190, "post_id": 51171383, "comment_id": 89341794, "body": "if (GrassHeightMap[x][y] &gt; 0.5) { /* generate grass */ }"}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530738245, "post_id": 51171383, "comment_id": 89343859, "body": "I think you can write an answer yourself, to answer your question."}], "answers": [{"tags": [], "owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "is_accepted": false, "score": 0, "last_activity_date": 1530739224, "creation_date": 1530739224, "answer_id": 51180866, "question_id": 51171383, "link": "https://stackoverflow.com/questions/51171383/cant-get-fastnoise-to-work-for-grass-patches/51180866#51180866", "title": "Can&#39;t get FastNoise to work for grass patches", "body": "<p>For the record, the problem was that the arguments passed to <code>GrassNoise.GetValue</code> were floating points in the [0,1] range, whereas the function expects integers.</p>\n"}], "owner": {"reputation": 41, "user_id": 9782736, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yZvIYrmCbP0/AAAAAAAAAAI/AAAAAAAAAEE/Jena5V63bnc/photo.jpg?sz=128", "display_name": "Cow Nation", "link": "https://stackoverflow.com/users/9782736/cow-nation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530739224, "creation_date": 1530699767, "last_edit_date": 1530702765, "question_id": 51171383, "link": "https://stackoverflow.com/questions/51171383/cant-get-fastnoise-to-work-for-grass-patches", "title": "Can&#39;t get FastNoise to work for grass patches", "body": "<p>I have been trying to implement noise based grass patches all day. Before I just had it pick random tiles, but they looked bad because they weren't in patches.</p>\n\n<pre><code>FastNoise GrassNoise;\nfor (int x = 0; x &lt; MapSizeX; x++) {\n    for (int y = 0; y &lt; MapSizeY; y++) {\n        if (GrassNoise.GetValue(Map[x][y].Sprite.getPosition().x, Map[x][y].Sprite.getPosition().y) &gt; 0.5) {\n            Map[x][y].Sprite.setTexture(*Grass);\n        }\n    }\n}\n</code></pre>\n\n<p>I'm pretty sure that I'm just not generating the Noise correctly. With that code, all of the tiles get turned grass. I'm looking for just a few patches.</p>\n\n<p>github.com/Auburns/FastNoise</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c++", "windows", "winapi", "64-bit", "portable-executable"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1530743457, "post_id": 51171363, "comment_id": 89345187, "body": "you already have <code>RVA</code> of exception. you not need convert it to offset. <code>IMAGE_RUNTIME_FUNCTION_ENTRY* pRFs = (IMAGE_RUNTIME_FUNCTION_ENTRY*)                             GetPtrFromRVA64(pExceptDir-&gt;VirtualAddress, pNtHeader, lpBaseAddress);</code> this line is error. must be <code>IMAGE_RUNTIME_FUNCTION_ENTRY* pRFs = (IMAGE_RUNTIME_FUNCTION_ENTRY*)(lpBaseAddress+pExceptDir-&gt;Vi&zwnj;&#8203;rtualAddress);</code>"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1530744029, "post_id": 51171363, "comment_id": 89345281, "body": "@RbMm: Thanks. I tried it as well. But it points me in the wrong memory location as well. For some reason it is <code>0x1800</code> bytes short of what the actual function table is (I take it from the return pointer from <code>RtlLookupFunctionEntry</code> when I scroll up to its top.) So I&#39;m not sure where that error in  <code>0x1800</code> bytes comes from?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1530957529, "post_id": 51171363, "comment_id": 89424509, "body": "no, with <code>IMAGE_RUNTIME_FUNCTION_ENTRY* pRFs = (IMAGE_RUNTIME_FUNCTION_ENTRY*)(lpBaseAddress+pExceptDir-&gt;Vi&zwnj;&#8203;rtualAddress);</code> we get correct address"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1530958115, "post_id": 51171363, "comment_id": 89424674, "body": "some example code of unwind - <a href=\"https://pastebin.com/5wBDstpG\" rel=\"nofollow noreferrer\">pastebin.com/5wBDstpG</a>"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531005845, "post_id": 51171363, "comment_id": 89435256, "body": "@RbMm: Again, in my tests, the <code>lpBaseAddress+pExceptDir-&gt;VirtualAddress</code> part points to a correct function table <b>only</b> in a release build of this test console project. If I have the same standard console project built for <code>debug</code> it points to an empty area of memory. My guess is that the debug build uses <code>RtlAddFunctionTable()</code> or <code>RtlAddGrowableFunctionTable()</code> to add dynamic/JIT functions which re-allocates the function table. (Just a guess.) As for the code you posted, it works because you&#39;re using <code>RtlLookupFunctionEntry()</code> that does what I&#39;m trying to emulate here."}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531006072, "post_id": 51171363, "comment_id": 89435296, "body": "I was able to find <code>RtlLookupFunctionTable()</code> function that is imported from <code>ntdll.dll</code> but 1. it&#39;s undocumented, and 2. I don&#39;t really know which parameters to call it with. Otherwise it may be doing exactly what I&#39;m asking here."}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531006450, "post_id": 51171363, "comment_id": 89435359, "body": "From the research that I&#39;ve done so far, it looks like what Microsoft was trying to do with the function table in x64 was to <a href=\"http://uninformed.org/index.cgi?v=8&amp;a=2&amp;p=20\" rel=\"nofollow noreferrer\">cache it internally</a>. Thus the <code>IMAGE_DIRECTORY_ENTRY_EXCEPTION</code> section in PE32+ has just a static starter info, which may be later relocated if new JIT function definitions are added later."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531021242, "post_id": 51171363, "comment_id": 89437135, "body": "no, you mistake. nothing relocated"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531070096, "post_id": 51171363, "comment_id": 89447690, "body": "@RbMm: Well, how is it my mistake? If I build the code I posted above as <code>debug</code> console project in VS2017 community and replace <code>GetPtrFromRVA64()</code> with <code>IMAGE_RUNTIME_FUNCTION_ENTRY* pRFs = (IMAGE_RUNTIME_FUNCTION_ENTRY*)(lpBaseAddress+pExceptDir-&gt;Vi&zwnj;&#8203;rtualAddress);</code> <a href=\"https://i.imgur.com/aggJR9t.png\" rel=\"nofollow noreferrer\">here&#39;s what I get</a>. <code>pRFs</code> points to an empty memory. Building a <code>release</code> <a href=\"https://i.imgur.com/FK6Y3Bg.png\" rel=\"nofollow noreferrer\">changes things</a>."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531070940, "post_id": 51171363, "comment_id": 89447913, "body": "you use different code. in one screenshot i view <code>pDataDirectory = pIOH32-&gt;DataDirectory</code> - no such line in your posted code and another screen. begin from use same code. post binary files"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531071376, "post_id": 51171363, "comment_id": 89447999, "body": "if you paste your test binary code, which incorrect calc this - i can say where mistake exactly"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531083867, "post_id": 51171363, "comment_id": 89450892, "body": "@RbMm: Thanks. You might be right. I could&#39;ve been repeating the same mistake over and over. But I still don&#39;t see it. <a href=\"https://mega.nz/#!SbBlRQZS!tMiypvCY8cl4zoBt5mauaC3780-2-HPAuPchRSeZIvo\" rel=\"nofollow noreferrer\">Here&#39;s</a> the entire VS2017 solution that I&#39;m using with two binary builds: release and debug."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531084543, "post_id": 51171363, "comment_id": 89451026, "body": "simply open your debug build in peviewer. you can see that this data (inside <code>.pdata</code> section) is all zero. it initially zero in PE. (for example use <a href=\"http://www.andreybazhan.com/pe-internals.html\" rel=\"nofollow noreferrer\">andreybazhan.com/pe-internals.html</a>)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531084910, "post_id": 51171363, "comment_id": 89451106, "body": "so in code which access <code>IMAGE_DIRECTORY_ENTRY_EXCEPTION</code> no errors. question why this data is all 0 filled in exe. may be some build or compile options.. but in my builds i never view this (however i for example never use incremental linking, etc. may be something affect this. also look your another pe in peviewer"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531085042, "post_id": 51171363, "comment_id": 89451128, "body": "no. it not all 0. begin from 1e800 rva not 0 data. think this is effect or incremental linking or some like this. play with link options - remove incremental, etc - move to release options one by one and found which exactly give this effect. anyway all 0 runtime function data formal also valid"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531102584, "post_id": 51171363, "comment_id": 89453905, "body": "@RbMm: OK, thanks. I should&#39;ve checked it with PE viewer as well. Still, in despite of the <code>.pdata</code> section being empty, <code>RtlLookupFunctionEntry</code> function works and points to a filled function table. Also exceptions and stack unwinding work with that section being empty. There must be some undocumented flag in the PE32+ that we&#39;re not aware of. That&#39;s what I&#39;m trying to get to the bottom of."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1531115320, "post_id": 51171363, "comment_id": 89456544, "body": "read my comments - section not empty. it begin with 0 but not empty. exist data."}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531116129, "post_id": 51171363, "comment_id": 89456811, "body": "@RbMm: I can see that. I pointed this out in one of the first comments that the actual data is 0x1800 bytes off from the <code>IMAGE_RUNTIME_FUNCTION_ENTRY* pRFs</code> pointer. Are those zeros an expected behavior though?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531116498, "post_id": 51171363, "comment_id": 89456937, "body": "yes, why not ? and it not prevent <code>RtlLookupFunctionEntry</code> found valid entry. i guess this because incremental linking or may be some another build options. try change this for found exactly"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531163854, "post_id": 51171363, "comment_id": 89484078, "body": "@RbMm: OK, I&#39;ll play with it thanks. My curiosity at this point is this -- what would happen if I use <code>RtlAddFunctionTable()</code> to add more functions than the space left in the <code>.pdata</code> section? Did you have any experience with it?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531164240, "post_id": 51171363, "comment_id": 89484240, "body": "<code>RtlAddFunctionTable</code> add table not to pe but in memory"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531164704, "post_id": 51171363, "comment_id": 89484441, "body": "@RbMm: So does it mean that there&#39;s more than one function table for a module?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531164815, "post_id": 51171363, "comment_id": 89484501, "body": "every x64 <i>PE</i> have self function table. <code>RtlAddFunctionTable</code> let add additional tables for functions not located in any module (function table for dynamically generated code)"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531165531, "post_id": 51171363, "comment_id": 89484843, "body": "@RbMm: And do you know if there is a way to get a pointer to the head of that other &quot;self function table&quot;?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531166164, "post_id": 51171363, "comment_id": 89485127, "body": "for what ? simply call <code>RtlLookupFunctionEntry</code> for get entry for <i>rip</i>"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531167482, "post_id": 51171363, "comment_id": 89485760, "body": "@RbMm: My problem with <code>RtlLookupFunctionEntry</code> is that it assumes current function and stack pointer, where in my case I might need to use a previous snapshot of the stack as a byte array is mem. But, like I said earlier, there&#39;s undocumented <code>RtlLookupFunctionTable</code> which may do the trick. I just need to re its input parameters. But that&#39;s beside the point ....... Hey, a little follow-up question. I&#39;m assuming that there&#39;s no JIT&#39;ing and thus <code>RtlAddFunctionTable</code> equivalent in the kernel space. Only the static <code>.pdata</code> section w/function table in the mapped images. Is my assumption correct?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531167915, "post_id": 51171363, "comment_id": 89485944, "body": "<code>RtlLookupFunctionEntry</code> take <code>ControlPc</code> from you. no any &quot;current function&quot; stack pointer it al all not use"}], "owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1530699675, "creation_date": 1530699675, "question_id": 51171363, "link": "https://stackoverflow.com/questions/51171363/how-to-look-up-64-bit-modules-function-table-when-its-mapped-in-memory", "title": "How to look up 64-bit module&#39;s function table when it&#39;s mapped in memory?", "body": "<p>My goal is to understand <a href=\"https://msdn.microsoft.com/en-us/library/8ydc79k6.aspx\" rel=\"nofollow noreferrer\">stack unwinding</a> in 64-bit PE32+ executable format in Windows, or how the following API can calculate addresses of a function prologue, body, epilogue, etc.:</p>\n\n<pre><code>CONTEXT context = {0};\nRtlCaptureContext(&amp;context);\n\nDWORD64 ImgBase = 0;\nRUNTIME_FUNCTION* pRTFn = RtlLookupFunctionEntry(context.Rip, &amp;ImgBase, NULL);\n_tprintf(L\"Prologue=0x%p\\n\", (void*)(ImgBase + pRTFn-&gt;BeginAddress));\n</code></pre>\n\n<p>I know that the <a href=\"https://msdn.microsoft.com/en-us/library/ssa62fwe.aspx\" rel=\"nofollow noreferrer\">information</a> on the offsets of all <em>non-leaf</em> functions used by the linker <a href=\"https://blogs.msdn.microsoft.com/ntdebugging/2010/05/12/x64-manual-stack-reconstruction-and-stack-walking/\" rel=\"nofollow noreferrer\">is included</a> in the PE32+ header in the exceptions directory. So I tried to write my own function to parse it. I got to this point where I got stumped:</p>\n\n<pre><code>//INFO -- must be compiled as x64 only!\n\nvoid GetFunctionTable(BYTE* lpBaseAddress, size_t szImageSz)\n{\n    if(lpBaseAddress)\n    {\n        if(szImageSz &gt; sizeof(IMAGE_DOS_HEADER))\n        {\n            IMAGE_DOS_HEADER* pDOSHeader = (IMAGE_DOS_HEADER*)lpBaseAddress;\n            if(pDOSHeader-&gt;e_magic == IMAGE_DOS_SIGNATURE)\n            {\n                IMAGE_NT_HEADERS* pNtHeader = (IMAGE_NT_HEADERS*)((BYTE*)pDOSHeader + pDOSHeader-&gt;e_lfanew);\n\n                PIMAGE_DATA_DIRECTORY pDataDirectories = NULL;\n                if(pNtHeader-&gt;OptionalHeader.Magic == IMAGE_NT_OPTIONAL_HDR64_MAGIC)\n                {\n                    //64-bit image only\n                    IMAGE_NT_HEADERS64* pHdr64 = (IMAGE_NT_HEADERS64*)pNtHeader;\n                    IMAGE_OPTIONAL_HEADER64* pIOH64 = &amp;pHdr64-&gt;OptionalHeader;\n                    pDataDirectories = pIOH64-&gt;DataDirectory;\n\n                    IMAGE_DATA_DIRECTORY* pExceptDir = &amp;pDataDirectories[IMAGE_DIRECTORY_ENTRY_EXCEPTION];\n                    if(pExceptDir-&gt;VirtualAddress &amp;&amp;\n                        pExceptDir-&gt;Size)\n                    {\n                        IMAGE_RUNTIME_FUNCTION_ENTRY* pRFs = (IMAGE_RUNTIME_FUNCTION_ENTRY*)\n                            GetPtrFromRVA64(pExceptDir-&gt;VirtualAddress, pNtHeader, lpBaseAddress);\n\n                        //'pRFs' = should point to an array of RUNTIME_FUNCTION structs\n                        //         but in my case it points to an empty region of memory with all zeros.\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>with the following helper functions:</p>\n\n<pre><code>PIMAGE_SECTION_HEADER GetEnclosingSectionHeader64(DWORD_PTR rva, PIMAGE_NT_HEADERS64 pNTHeader)\n{\n    PIMAGE_SECTION_HEADER section = IMAGE_FIRST_SECTION(pNTHeader);\n    unsigned int i;\n\n    for ( i=0; i &lt; pNTHeader-&gt;FileHeader.NumberOfSections; i++, section++ )\n    {\n        if ( (rva &gt;= section-&gt;VirtualAddress) &amp;&amp; \n                (rva &lt; (section-&gt;VirtualAddress + section-&gt;Misc.VirtualSize)))\n            return section;\n    }\n\n    return 0;\n}\n\nLPVOID GetPtrFromRVA64(DWORD rva, const void* pNTHeader, const void* imageBase)\n{\n    PIMAGE_SECTION_HEADER pSectionHdr;\n    INT_PTR delta;\n\n    pSectionHdr = GetEnclosingSectionHeader64( rva, (PIMAGE_NT_HEADERS64)pNTHeader );\n    if ( !pSectionHdr )\n        return 0;\n\n    delta = (INT_PTR)(pSectionHdr-&gt;VirtualAddress - pSectionHdr-&gt;PointerToRawData);\n    return (PVOID) ( (BYTE*)imageBase + rva - delta );\n}\n</code></pre>\n\n<p>So I'm testing it on the self executable:</p>\n\n<pre><code>HMODULE hMod = ::GetModuleHandle(NULL);\nMODULEINFO mi = {0};\nif(::GetModuleInformation(::GetCurrentProcess(), hMod, &amp;mi, sizeof(mi)))\n{\n    GetFunctionTable((BYTE*)hMod, mi.SizeOfImage);\n}\n</code></pre>\n\n<p>But the problem is that inside my <code>GetFunctionTable</code> when I try to look up the function table mapped in memory in the <code>IMAGE_DIRECTORY_ENTRY_EXCEPTION</code> directory, I'm getting a pointer (i.e. <code>IMAGE_RUNTIME_FUNCTION_ENTRY*</code>) to an empty region of memory. I must be not translating the rva address correctly.</p>\n\n<p>So anyone who knows how PE32+ header is mapped in memory, can please show what am I doing wrong there?</p>\n"}, {"tags": ["c++", "linux", "timezone", "dst", "timezone-offset"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530699651, "post_id": 51171218, "comment_id": 89325222, "body": "You need two settings: The region or country, which decides when the DST changes happen. And the current time zone, which defines the standard time offset from UTC. If DST is in effect (known from the first setting), add one hour to the current local time (as calculated by the time zone). However, once you&#39;ve done all that, then throw your code code handling time and time zones. Time and date is much harder than it seems, so I really recommend you try to find a library which will handle it all for you."}, {"owner": {"reputation": 505, "user_id": 3065592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60527c78c08542c8f4de56f9082e69d?s=128&d=identicon&r=PG&f=1", "display_name": "wtom", "link": "https://stackoverflow.com/users/3065592/wtom"}, "edited": false, "score": 0, "creation_date": 1530699894, "post_id": 51171218, "comment_id": 89325393, "body": "will that help? <a href=\"https://superuser.com/questions/294984/how-to-make-an-application-detect-if-system-time-has-changed-in-linux\" title=\"how to make an application detect if system time has changed in linux\">superuser.com/questions/294984/&hellip;</a>"}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 1, "creation_date": 1530700161, "post_id": 51171218, "comment_id": 89325518, "body": "About the calculating offset part: you can calculate the timestamp of the next DST change and cache it. Then every time you use the time, you just compare it to cached timestamp. If lower, DST didn&#39;t change, if higher, update your offset and compute next DST change."}], "answers": [{"comments": [{"owner": {"reputation": 310, "user_id": 967018, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/469e4e8a589df4f5ef6a95ae7172c37d?s=128&d=identicon&r=PG", "display_name": "Srini2k6", "link": "https://stackoverflow.com/users/967018/srini2k6"}, "edited": false, "score": 0, "creation_date": 1530848370, "post_id": 51175495, "comment_id": 89386567, "body": "Thanks for the answer. I don&#39;t have the choice to upgrade the compiler."}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "reply_to_user": {"reputation": 310, "user_id": 967018, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/469e4e8a589df4f5ef6a95ae7172c37d?s=128&d=identicon&r=PG", "display_name": "Srini2k6", "link": "https://stackoverflow.com/users/967018/srini2k6"}, "edited": false, "score": 0, "creation_date": 1530850442, "post_id": 51175495, "comment_id": 89386989, "body": "Not even to C++11?!  My sincerest condolences."}], "tags": [], "owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "is_accepted": false, "score": 1, "last_activity_date": 1530715926, "last_edit_date": 1530715926, "creation_date": 1530712788, "answer_id": 51175495, "question_id": 51171218, "link": "https://stackoverflow.com/questions/51171218/detecting-dst-changes-in-c/51175495#51175495", "title": "Detecting DST changes in C++", "body": "<p>Using the draft C++20 <code>&lt;chrono&gt;</code> facilities you can discover the <code>std::chrono::system_clock::time_point</code> for the next UTC offset change for <em>any</em> time zone, and then <code>std::this_thread::sleep_until</code> that <code>time_point</code>.  When you wake, do whatever it is you want to do, such as compute a new UTC offset.</p>\n\n<p>The new draft C++20 <code>&lt;chrono&gt;</code> library has been prototyped and is <a href=\"https://howardhinnant.github.io/date/tz.html\" rel=\"nofollow noreferrer\">available as a free, open-source library</a> under <code>namespace date</code>.  This library is portable across VS, gcc and clang, and operates with C++11 and later.</p>\n\n<p>Here is a sketch of how this might be coded:</p>\n\n<pre><code>#include \"date/tz.h\"\n#include &lt;thread&gt;\n\ntemplate &lt;class F&gt;\nvoid\non_utc_offset_change(date::time_zone const* tz, F f)\n{\n    using namespace date;\n    using namespace std;\n    using namespace std::chrono;\n    while (true)\n    {\n        auto info = tz-&gt;get_info(system_clock::now());\n        f(info);\n        this_thread::sleep_until(info.end);\n    }\n}\n</code></pre>\n\n<p>A <a href=\"https://howardhinnant.github.io/date/tz.html#time_zone\" rel=\"nofollow noreferrer\"><code>time_zone</code></a> has a <code>get_info(system_clock::time_point)</code> member function that returns a <a href=\"https://howardhinnant.github.io/date/tz.html#sys_info\" rel=\"nofollow noreferrer\"><code>sys_info</code></a>.  The <a href=\"https://howardhinnant.github.io/date/tz.html#sys_info\" rel=\"nofollow noreferrer\"><code>sys_info</code></a> contains all information about a <a href=\"https://howardhinnant.github.io/date/tz.html#time_zone\" rel=\"nofollow noreferrer\"><code>time_zone</code></a> for a particular point in time:</p>\n\n<pre><code>struct sys_info\n{\n    sys_seconds          begin;\n    sys_seconds          end;\n    std::chrono::seconds offset;\n    std::chrono::minutes save;\n    std::string          abbrev;\n};\n</code></pre>\n\n<p>The <code>begin</code> and <code>end</code> members are <code>seconds</code>-precision <code>system_clock</code> <code>time_point</code>s that delineate the range <code>[begin, end)</code> for which this <code>time_zone</code> has this UTC <code>offset</code> and abbreviation (<code>abbrev</code>).</p>\n\n<p>This function might be called like this:</p>\n\n<pre><code>auto lambda = [](date::sys_info const&amp; info)\n              {\n                  using namespace date;\n                  std::cerr &lt;&lt; \"Current UTC offset: \" &lt;&lt; info.offset &lt;&lt; '\\n';\n                  std::cerr &lt;&lt; \"Current tz abbreviation: \" &lt;&lt; info.abbrev &lt;&lt; '\\n';\n                  std::cerr &lt;&lt; \"Sleeping until \" &lt;&lt; info.end &lt;&lt; \" UTC\\n\";\n              };\nstd::thread{on_utc_offset_change&lt;decltype(lambda)&gt;,\n            date::current_zone(),\n            lambda}.detach();\n</code></pre>\n\n<p>This detaches a <code>thread</code> that runs forever and every time the UTC offset changes for the computer's current <code>time_zone</code> (at the time the thread was launched), it prints out current information, for example.</p>\n\n<pre><code>Current UTC offset: -14400s\nCurrent tz abbreviation: EDT\nSleeping until 2018-11-04 06:00:00 UTC\n</code></pre>\n\n<p>Alternatively you could run this for a specific <code>time_zone</code> which is not the computer's currently set <code>time_zone</code> with:</p>\n\n<pre><code>std::thread{on_utc_offset_change&lt;decltype(lambda)&gt;,\n            date::locate_zone(\"America/New_York\"),\n            lambda}.detach();\n</code></pre>\n"}], "owner": {"reputation": 310, "user_id": 967018, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/469e4e8a589df4f5ef6a95ae7172c37d?s=128&d=identicon&r=PG", "display_name": "Srini2k6", "link": "https://stackoverflow.com/users/967018/srini2k6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1530715926, "creation_date": 1530699280, "question_id": 51171218, "link": "https://stackoverflow.com/questions/51171218/detecting-dst-changes-in-c", "title": "Detecting DST changes in C++", "body": "<p>I am working on c++ real time application which is doing lot of date manipulations. For performance reasons, I made the UTC offset as configurable value which is read only once at the time of application initialization. But it is causing issues in DST zones. </p>\n\n<p>When DST Changes happens, My UTC offset variable contain wrong value. \nCalculating the Offset every time is not a optimal solution for me. </p>\n\n<p>So is there anyway to notify my application about DST changes? So I can calculate the offset only when it need to modified.</p>\n"}, {"tags": ["c++", "stl", "undefined-reference", "stdmap", "icc"], "comments": [{"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530700258, "post_id": 51171206, "comment_id": 89325573, "body": "maybe you need to specify which standard of C++ you want to use : <code>-std=c++17</code> for example"}, {"owner": {"reputation": 41, "user_id": 10031332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5a586f3a79289e7865eb0a2fc23a59?s=128&d=identicon&r=PG&f=1", "display_name": "AndyMN", "link": "https://stackoverflow.com/users/10031332/andymn"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530700487, "post_id": 51171206, "comment_id": 89325704, "body": "@OlivierSohn I tried this and I get the exact same errors as above."}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530700878, "post_id": 51171206, "comment_id": 89325963, "body": "I think I get it, you are using <code>-I&#47;usr&#47;include&#47;x86_64-linux-gnu&#47;c++&#47;8</code> : then you should also specify the path to the standard library you want to use, else you&#39;re not guaranteed to have the one that corresponds to the right version. Btw what if you removed the <code>-I</code> option?"}, {"owner": {"reputation": 41, "user_id": 10031332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5a586f3a79289e7865eb0a2fc23a59?s=128&d=identicon&r=PG&f=1", "display_name": "AndyMN", "link": "https://stackoverflow.com/users/10031332/andymn"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530701388, "post_id": 51171206, "comment_id": 89326307, "body": "@OlivierSohn If I remove the -I option I get the following result      In file included from /usr/include/c++/8/bits/stl_tree.h(63),                      from /usr/include/c++/8/map(60),                      from main.cpp(2):     /usr/include/c++/8/bits/stl_algobase.h(59): catastrophic error: cannot open     source file &quot;bits/c++config.h&quot;      #include &lt;bits/c++config.h&gt;                                 ^      compilation aborted for main.cpp (code 4)"}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530701584, "post_id": 51171206, "comment_id": 89326439, "body": "ok, this looks related? <a href=\"https://stackoverflow.com/questions/19660431/cannot-open-source-file-bits-cconfig-h-error-with-icpc\" title=\"cannot open source file bits cconfig h error with icpc\">stackoverflow.com/questions/19660431/&hellip;</a>"}, {"owner": {"reputation": 41, "user_id": 10031332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5a586f3a79289e7865eb0a2fc23a59?s=128&d=identicon&r=PG&f=1", "display_name": "AndyMN", "link": "https://stackoverflow.com/users/10031332/andymn"}, "reply_to_user": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 0, "creation_date": 1530703479, "post_id": 51171206, "comment_id": 89327667, "body": "Yes, and this is also where I found I had to have this -I option to the folder where the config is. But I get different errors while for that person it seems to be solved."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 10031332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5a586f3a79289e7865eb0a2fc23a59?s=128&d=identicon&r=PG&f=1", "display_name": "AndyMN", "link": "https://stackoverflow.com/users/10031332/andymn"}, "is_accepted": true, "score": 2, "last_activity_date": 1531152169, "creation_date": 1531152169, "answer_id": 51249716, "question_id": 51171206, "link": "https://stackoverflow.com/questions/51171206/icpc-identifier-node-allocator-is-undefined-when-compiling-c-file-using/51249716#51249716", "title": "ICPC: &quot;identifier &quot;_Node_allocator&quot; is undefined&quot; when compiling C++ file using std::map with icpc", "body": "<p>The problem was answered by <a href=\"https://software.intel.com/en-us/forums/intel-c-compiler/topic/781739#comment-1924480\" rel=\"nofollow noreferrer\">someone on the intel forums</a>:</p>\n\n<p>icc 18.0.3 does not support gcc-8 even though using the following bash command:</p>\n\n<pre><code>&gt; icpc -v\nicpc version 18.0.3 (gcc version 8.1.0 compatibility)\n</code></pre>\n\n<p>makes it seem that it does.</p>\n\n<p>icc 18 support gcc 4.3 to 6.3.</p>\n\n<p>To solve this without changing my default gcc version I did the following:</p>\n\n<p>First I installed gcc 6 on my Ubuntu 16.04 machine:</p>\n\n<pre><code>sudo apt-get install gcc-6 g++-6\n</code></pre>\n\n<p>Then I added the following flag to my compiler flags:</p>\n\n<pre><code>-gxx-name=/usr/bin/g++-6\n</code></pre>\n\n<p>And changed the version of the include directory to 6 instead of 8:</p>\n\n<pre><code>-I /usr/include/x86_64-linux-gnu/c++/6\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10031332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5a586f3a79289e7865eb0a2fc23a59?s=128&d=identicon&r=PG&f=1", "display_name": "AndyMN", "link": "https://stackoverflow.com/users/10031332/andymn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 51249716, "answer_count": 1, "score": 2, "last_activity_date": 1531152169, "creation_date": 1530699229, "last_edit_date": 1530699560, "question_id": 51171206, "link": "https://stackoverflow.com/questions/51171206/icpc-identifier-node-allocator-is-undefined-when-compiling-c-file-using", "title": "ICPC: &quot;identifier &quot;_Node_allocator&quot; is undefined&quot; when compiling C++ file using std::map with icpc", "body": "<p>I am trying to compile the following code:</p>\n\n<pre><code>#include &lt;map&gt;\n\nint main() {\n  std::map&lt;double, double&gt; test;\n\n  return 0;\n}\n</code></pre>\n\n<p>using the following command:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>icpc -I /usr/include/x86_64-linux-gnu/c++/8  main.cpp -o test\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>/usr/include/c++/8/bits/stl_tree.h(700): error: identifier \n\"_Node_allocator\" is undefined\n            _GLIBCXX_NOEXCEPT_IF(\n\n            ^\n          detected during instantiation of \"std::_Rb_tree&lt;_Key, _Val, \n_KeyOfValue, _Compare, _Alloc&gt;::_Rb_tree_impl&lt;_Key_compare, \n&lt;unnamed&gt;&gt;::_Rb_tree_impl() [with _Key=double, _Val=std::pair&lt;const \ndouble, double&gt;, _KeyOfValue=std::_Select1st&lt;std::pair&lt;const double,double&gt;&gt;, _Compare=std::less&lt;double&gt;, Alloc=std::allocator&lt;std::pair&lt;const double, double&gt;&gt;,_Key_compare=std::less&lt;double&gt;, &lt;unnamed&gt;=true]\"\nat line 6 of \"main.cpp\"\n</code></pre>\n\n<p>together with a handful of type traits errors like the following:</p>\n\n<pre><code>/usr/include/c++/8/type_traits(921): error: not a class or struct name\n      : public __is_default_constructible_atom&lt;_Tp&gt;::type\n               ^\n          detected during:\n            instantiation of class \n\"std::__is_default_constructible_safe&lt;_Tp, false&gt; [with _Tp=&lt;error-\ntype&gt;]\" at line 927\n            instantiation of class \"std::is_default_constructible&lt;_Tp&gt; \n[with _Tp=&lt;error-type&gt;]\" at line 144\n            instantiation of class \"std::__and_&lt;_B1, _B2&gt; [with \n_B1=std::is_default_constructible&lt;&lt;error-type&gt;&gt;, \n_B2=std::__is_nt_default_constructible_impl&lt;&lt;error-type&gt;, false&gt;]\" at \nline 995\n            instantiation of class \n\"std::is_nothrow_default_constructible&lt;_Tp&gt; [with _Tp=&lt;error-type&gt;]\" \nat line 700 of \"/usr/include/c++/8/bits/stl_tree.h\"\n            instantiation of \"std::_Rb_tree&lt;_Key, _Val, _KeyOfValue, \n_Compare, _Alloc&gt;::_Rb_tree_impl&lt;_Key_compare, \n&lt;unnamed&gt;&gt;::_Rb_tree_impl() [with _Key=double, _Val=std::pair&lt;const \ndouble, double&gt;, _Key\nOfValue=std::_Select1st&lt;std::pair&lt;const double, double&gt;&gt;, \n_Compare=std::less&lt;double&gt;, _Alloc=std::allocator&lt;std::pair&lt;const \ndouble, double&gt;&gt;, _Key_compare=std::less&lt;double&gt;, &lt;unnamed&gt;=true]\" at \nline 6 of \"\nmain.cpp\"\n</code></pre>\n\n<p>This code compiles without a problem using g++.</p>\n\n<p>The result of icpc and g++ version commands give the following:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>&gt; icpc -v\nicpc version 18.0.3 (gcc version 8.1.0 compatibility)\n\n&gt; g++ -v\nUsing built-in specs.\nCOLLECT_GCC=g++\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/8/lto-wrapper\nOFFLOAD_TARGET_NAMES=nvptx-none\nOFFLOAD_TARGET_DEFAULT=1\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu \n8.1.0-5ubuntu1~16.04' --with-bugurl=file:///usr/share/doc/gcc-\n8/README.Bugs --enable-\nlanguages=c,ada,c++,go,brig,d,fortran,objc,obj-c++ --prefix=/usr --\nwith-gcc-major-version-only --program-suffix=-8 --program-\nprefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --\nlibexecdir=/usr/lib --without-included-gettext --enable-\nthreads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --\nenable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-\ntime=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object \n--disable-vtable-verify --enable-libmpx --enable-plugin --with-\nsystem-zlib --with-target-system-zlib --enable-objc-gc=auto --\nenable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 \n--with-multilib-list=m32,m64,mx32 --enable-multilib --with-\ntune=generic --enable-offload-targets=nvptx-none --without-cuda-\ndriver --enable-checking=release --build=x86_64-linux-gnu --\nhost=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 8.1.0 (Ubuntu 8.1.0-5ubuntu1~16.04) \n</code></pre>\n\n<p>So my icpc and g++ version are compatible. I also didn't forget to source the <code>compilervars.sh</code> file of icpc.</p>\n\n<p>I can't find any post with this error, also not on the Intel site. Is there a specific library needed to add to icpc that is not added automatically to be able to use <code>std::map</code>?</p>\n\n<p>I've tried adding <code>-lstdc++</code> myself in the compilation command but this didn't work.</p>\n"}, {"tags": ["c++", "templates", "sfinae"], "answers": [{"comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1530699065, "post_id": 51171102, "comment_id": 89324838, "body": "Nice catch, fixing the <code>move</code> for <code>forward</code>."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 5, "last_activity_date": 1530698930, "creation_date": 1530698930, "answer_id": 51171102, "question_id": 51170934, "link": "https://stackoverflow.com/questions/51170934/enable-template-only-if-the-return-expression-is-valid/51171102#51171102", "title": "Enable template only if the return expression is valid", "body": "<p>You might add overload to force type (and so unique available overload is chosen):</p>\n\n<pre><code>struct OstreamWrapper {\n    explicit OstreamWrapper(std::ostream &amp;out) : out(out) {}\n\n    template&lt; typename T &gt;\n    decltype(auto) operator&lt;&lt;(T &amp;&amp;arg) {\n        return out &lt;&lt; std::forward&lt;T&gt;(arg);\n    }\n\n    decltype(auto) operator&lt;&lt;(std::ostream&amp; (&amp;arg)(std::ostream&amp;)) {\n        return out &lt;&lt; arg;\n    }\n\n    std::ostream &amp;out;\n};\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/24fac2881cec38fd\" rel=\"noreferrer\">Demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1530699072, "creation_date": 1530699072, "answer_id": 51171146, "question_id": 51170934, "link": "https://stackoverflow.com/questions/51170934/enable-template-only-if-the-return-expression-is-valid/51171146#51171146", "title": "Enable template only if the return expression is valid", "body": "<p><code>std::endl</code> is not overloaded. It's a function template that's declared like this:</p>\n\n<pre><code>template&lt; class CharT, class Traits &gt;\nstd::basic_ostream&lt;CharT, Traits&gt;&amp; endl( std::basic_ostream&lt;CharT, Traits&gt;&amp; os );\n</code></pre>\n\n<p>The reason it works directly for <code>std::ostream</code> is that the appropriate <code>operator &lt;&lt;</code> (the one for stream manipulators) is a regular member function (though generated from the <code>basic_ostream</code> template for <code>char</code>). It expects a concrete manipulator type. Template argument deduction can be used with this parameter type to deduce the arguments of the correct <code>endl</code> specialization.</p>\n\n<p>Since you seem to support only <code>std::ostream</code>, the solution in <a href=\"https://stackoverflow.com/a/51171102/817643\">@Jarod42's answer</a> is the way to go.</p>\n"}], "owner": {"reputation": 1026, "user_id": 807307, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/decd3ea69d3387db2ffb5394ab7abebd?s=128&d=identicon&r=PG", "display_name": "Giovanni Mascellani", "link": "https://stackoverflow.com/users/807307/giovanni-mascellani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 51171102, "answer_count": 2, "score": 0, "last_activity_date": 1530699072, "creation_date": 1530698375, "question_id": 51170934, "link": "https://stackoverflow.com/questions/51170934/enable-template-only-if-the-return-expression-is-valid", "title": "Enable template only if the return expression is valid", "body": "<p>I want to write a wrapper over <code>std::ostream</code> in this style:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct OstreamWrapper {\n  OstreamWrapper(std::ostream &amp;out) : out(out) {}\n\n  template&lt; typename T &gt;\n  decltype(auto) operator&lt;&lt;(T &amp;&amp;arg) {\n    return out &lt;&lt; std::move&lt; T &gt;(arg);\n  }\n\n  std::ostream &amp;out;\n};\n\nint main() {\n  OstreamWrapper wrap(std::cout);\n  wrap &lt;&lt; \"Hello, world!\";  // This works\n  wrap &lt;&lt; std::endl;        // This does not work\n  return 0;\n}\n</code></pre>\n\n<p>The problem with this approach is that it does not work (for example) with <code>std::endl</code>, because (as I get it) <code>std::endl</code> is overloaded, and the compiler does not know how to resolve the overload when it evaluates the template.</p>\n\n<p>I believe that this situation can be fixed with some clever SFINAE, but I cannot find something that works. I think I need something like \"enable this template only when <code>cout &lt;&lt; arg</code> is a well formed expression\", but I do not know how to express that.</p>\n\n<p>For example, I tried this:</p>\n\n<pre><code>  template&lt; typename T,\n            typename = decltype(out &lt;&lt; arg) &gt;\n  decltype(auto) operator&lt;&lt;(T &amp;&amp;arg) {\n    return out &lt;&lt; std::move&lt; T &gt;(arg);\n  }\n</code></pre>\n\n<p>But this is not ok, because then the template expressions are evaluated, arg is not yet defined.</p>\n\n<pre><code>  template&lt; typename T,\n            typename = decltype(out &lt;&lt; std::declval&lt; T &gt;()) &gt;\n  decltype(auto) operator&lt;&lt;(T &amp;&amp;arg) {\n    return out &lt;&lt; std::move&lt; T &gt;(arg);\n  }\n</code></pre>\n\n<p>This compiles, but does not do what I want, because it requires the type <code>T</code> to be known, while my problem actually lies in establishing how to overload its parameter.</p>\n\n<p>I have also tried more obscure conditions based on <code>std::enable_if</code> and <code>std::is_invocable</code> and <code>std::result_of</code>, but they introduced a lot of errors I could not understand and it probably would be pointless to summary here all the attempts.</p>\n\n<p>Is there a way to do this thing properly? Possibly with C++14, so the codebase remains more backward compatbile, but if C++17 is necessary it is ok as well.</p>\n"}, {"tags": ["c++", "c++11", "stdset"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1530697646, "post_id": 51170679, "comment_id": 89323927, "body": "You have to use the resulting iterator from your function to update <code>it</code> correctly.(but you risk to iterate on the new item too)"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1530697650, "post_id": 51170679, "comment_id": 89323933, "body": "What&#39;s the point of doing this in-place to begin with?"}, {"owner": {"reputation": 550, "user_id": 9459321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/427432d9d02a8eb9861905dabfce27e4?s=128&d=identicon&r=PG&f=1", "display_name": "Software_t", "link": "https://stackoverflow.com/users/9459321/software-t"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1530697814, "post_id": 51170679, "comment_id": 89324037, "body": "@Jarod42 Now it&#39;s ok according to what you say? (I edited the question)"}, {"owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1530697814, "post_id": 51170679, "comment_id": 89324038, "body": "Is space a constraint? This is a bad idea like you mention, a new <code>set</code> would be an easy solution."}, {"owner": {"reputation": 18542, "user_id": 47351, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/fab8190589ada198cbf1a69b981a8670?s=128&d=identicon&r=PG", "display_name": "RvdK", "link": "https://stackoverflow.com/users/47351/rvdk"}, "edited": false, "score": 0, "creation_date": 1530697824, "post_id": 51170679, "comment_id": 89324047, "body": "Well std::set works by keeping all the items in order according to the object&#39;s &lt; operator. If you remove and add a new item, the set order will be different..."}, {"owner": {"reputation": 550, "user_id": 9459321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/427432d9d02a8eb9861905dabfce27e4?s=128&d=identicon&r=PG&f=1", "display_name": "Software_t", "link": "https://stackoverflow.com/users/9459321/software-t"}, "reply_to_user": {"reputation": 18542, "user_id": 47351, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/fab8190589ada198cbf1a69b981a8670?s=128&d=identicon&r=PG", "display_name": "RvdK", "link": "https://stackoverflow.com/users/47351/rvdk"}, "edited": false, "score": 0, "creation_date": 1530697872, "post_id": 51170679, "comment_id": 89324085, "body": "@RvdK And hence I asked this qeustion, how can I do it in despite to this fact?"}, {"owner": {"reputation": 18542, "user_id": 47351, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/fab8190589ada198cbf1a69b981a8670?s=128&d=identicon&r=PG", "display_name": "RvdK", "link": "https://stackoverflow.com/users/47351/rvdk"}, "edited": false, "score": 0, "creation_date": 1530697984, "post_id": 51170679, "comment_id": 89324167, "body": "Well easiest to create a new std::set, and store the new T object in it."}, {"owner": {"reputation": 550, "user_id": 9459321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/427432d9d02a8eb9861905dabfce27e4?s=128&d=identicon&r=PG&f=1", "display_name": "Software_t", "link": "https://stackoverflow.com/users/9459321/software-t"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1530698000, "post_id": 51170679, "comment_id": 89324176, "body": "@Jarod42 Ok , you right, so can you explain how to do it? (I understand what you mean, but don&#39;t understand how to do it. But, I do&#39;nt think that it&#39;s going to solve the problem - like that explaing in the comment of &quot;Rvdk&quot;."}, {"owner": {"reputation": 550, "user_id": 9459321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/427432d9d02a8eb9861905dabfce27e4?s=128&d=identicon&r=PG&f=1", "display_name": "Software_t", "link": "https://stackoverflow.com/users/9459321/software-t"}, "edited": false, "score": 0, "creation_date": 1530698208, "post_id": 51170679, "comment_id": 89324317, "body": "@MaximEgorushkin Ok , like that I writed in my question, after that I writed this code, I already understood that it&#39;s &quot;it&#39;s bad way&quot; (like that I mentioned in my question) , and hence, I am looking for a better way to do it. (I mentioned the example only for explain what I mean while I say &quot;to change a set during iterations&quot; - this is the first way that I thought for how to do it)"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1530698326, "post_id": 51170679, "comment_id": 89324398, "body": "@MaximEgorushkin: That depends how <code>operator &lt;</code> and <code>operator +</code> are implemented. (with something like <code>std::set&lt;int, std::greater&lt;&gt;&gt;</code>, it would be ok)."}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1530698448, "post_id": 51170824, "comment_id": 89324486, "body": "Since C++11, <code>s = std::move(s2);</code> is enough ;-)"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1530700121, "post_id": 51170824, "comment_id": 89325502, "body": "@Jarod42 It is longer, is it better though?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1530724857, "post_id": 51170824, "comment_id": 89339562, "body": "Intention is clearer, (swap is a valid implementation of move assignment BTW). moment of destruction of original data might also differ (extended to <code>s2</code> lifetime with the <code>swap</code>)."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 7, "last_activity_date": 1530700798, "last_edit_date": 1530700798, "creation_date": 1530697989, "answer_id": 51170824, "question_id": 51170679, "link": "https://stackoverflow.com/questions/51170679/what-is-the-best-way-to-change-a-set-during-iterations/51170824#51170824", "title": "What is the best way to change a set during iterations?", "body": "<p>Your loop may result in almost endless loop because you keep adding larger elements at the back of your set. Until <code>T + T</code> overflows.</p>\n\n<p>Correct way is to create a new set:</p>\n\n<pre><code>std::set&lt;T&gt; s; \nstd::set&lt;T&gt; s2; \nfor(auto const&amp; elem : s)\n    s2.insert(elem + elem);\ns.swap(s2);\n</code></pre>\n\n<p>With <code>boost::range</code> it is a one-liner:</p>\n\n<pre><code>#include &lt;boost/range/adaptor/transformed.hpp&gt;\n// ...\nstd::set&lt;int&gt; s;\ns = boost::copy_range&lt;std::set&lt;int&gt;&gt;(s | boost::adaptors::transformed([](int x) { return x + x; }));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 2, "creation_date": 1530698364, "post_id": 51170897, "comment_id": 89324427, "body": "<code>s = std::move(modified_s);</code> would be closer to the original&#39;s intent  instead of <code>clear</code>."}], "tags": [], "owner": {"reputation": 18542, "user_id": 47351, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/fab8190589ada198cbf1a69b981a8670?s=128&d=identicon&r=PG", "display_name": "RvdK", "link": "https://stackoverflow.com/users/47351/rvdk"}, "is_accepted": true, "score": 0, "last_activity_date": 1530707254, "last_edit_date": 1530707254, "creation_date": 1530698279, "answer_id": 51170897, "question_id": 51170679, "link": "https://stackoverflow.com/questions/51170679/what-is-the-best-way-to-change-a-set-during-iterations/51170897#51170897", "title": "What is the best way to change a set during iterations?", "body": "<p>Just have a copy std:set</p>\n\n<pre><code>std::set&lt;T&gt; s;\nstd::set&lt;T&gt; modified_s;\nfor (std::set&lt;T&gt;::iterator it = s.begin(); it != s.end(); it++) {\n    modified_s.insert(*it+ *it);\n}\ns = std::move(modified_s);\n</code></pre>\n\n<p>Edit:\nAdded <code>std::move</code> as improvement from @Jodocus</p>\n"}], "owner": {"reputation": 550, "user_id": 9459321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/427432d9d02a8eb9861905dabfce27e4?s=128&d=identicon&r=PG&f=1", "display_name": "Software_t", "link": "https://stackoverflow.com/users/9459321/software-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "accepted_answer_id": 51170897, "answer_count": 2, "score": 1, "last_activity_date": 1530707254, "creation_date": 1530697536, "last_edit_date": 1530697898, "question_id": 51170679, "link": "https://stackoverflow.com/questions/51170679/what-is-the-best-way-to-change-a-set-during-iterations", "title": "What is the best way to change a set during iterations?", "body": "<p>Given <code>std::set</code> , what is the best way to change the set during time-iteration?<br>\nFor example:  </p>\n\n<pre><code>std::set&lt;T&gt; s;  // T is a some type (it's not important for the question).\n// insertions to s\nfor (std::set&lt;T&gt;::iterator it = s.begin(); it != s.end(); it++) {\n        T saveIt(*it);\n        s.erase(*it);\n        s.insert( saveIt + saveIt );  // operator+ that defined at `T`\n}\n</code></pre>\n\n<p>According to what that I  read in some sources, it's bad way because that: the removing from the set may change the structure of the set.  </p>\n\n<p>So what is the better (/best) way to do it?  </p>\n"}, {"tags": ["c++", "winapi", "ipc", "named-pipes"], "comments": [{"owner": {"reputation": 331, "user_id": 8231265, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/cr6PJ.jpg?s=128&g=1", "display_name": "Hello Everyone", "link": "https://stackoverflow.com/users/8231265/hello-everyone"}, "edited": false, "score": 0, "creation_date": 1530698983, "post_id": 51170607, "comment_id": 89324795, "body": "<code>PIPE_TYPE_BYTE</code> can&#39;t be used with <code>PIPE_READMODE_MESSAGE</code>.  You need code to call <code>CreateNamedPipe</code> and <code>ConnectNamedPipe</code> on your server to wait for your client connection. If the connection succeeds then loop to call read from the pipe to get the client message (i.e your struct data) process it then write back to your pipe to tell it about the input request. This is an example, looks very easy to understand. <a href=\"https://docs.microsoft.com/en-us/windows/desktop/ipc/multithreaded-pipe-server\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/ipc/&hellip;</a>"}, {"owner": {"reputation": 73, "user_id": 7362822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b1014cd5833d6deae59021d6b1dc3b?s=128&d=identicon&r=PG&f=1", "display_name": "Mayank", "link": "https://stackoverflow.com/users/7362822/mayank"}, "reply_to_user": {"reputation": 331, "user_id": 8231265, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/cr6PJ.jpg?s=128&g=1", "display_name": "Hello Everyone", "link": "https://stackoverflow.com/users/8231265/hello-everyone"}, "edited": false, "score": 0, "creation_date": 1530699217, "post_id": 51170607, "comment_id": 89324939, "body": "I know they can&#39;t be used together. What I meant to say is, should I replace PIPE_TYPE_BYTE and PIPE_READMODE_BYTE both with PIPE_TYPE_BYTE and PIPE_READMODE_MESSAGE respectively if I&#39;m sending struct data."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1530700181, "post_id": 51170607, "comment_id": 89325533, "body": "If those are <code>std::string</code> objects, you had best devise a <i>protocol</i> for marshaling their data over that pipe, because you certainly aren&#39;t going to just send it by address or reference. That&#39;s a recipe that will simply not work."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7362822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b1014cd5833d6deae59021d6b1dc3b?s=128&d=identicon&r=PG&f=1", "display_name": "Mayank", "link": "https://stackoverflow.com/users/7362822/mayank"}, "edited": false, "score": 0, "creation_date": 1530702237, "post_id": 51171563, "comment_id": 89326872, "body": "Can you please elaborate on first method?"}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 73, "user_id": 7362822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b1014cd5833d6deae59021d6b1dc3b?s=128&d=identicon&r=PG&f=1", "display_name": "Mayank", "link": "https://stackoverflow.com/users/7362822/mayank"}, "edited": false, "score": 1, "creation_date": 1530703207, "post_id": 51171563, "comment_id": 89327463, "body": "The first method should be pretty easy, you just copy <code>mylogdata.messageText.c_str()</code> to the correct field with something like <code>StringCchCopy</code> and at the other end you just do <code>mylogdata.messageText = pipestruct.message;</code> This is basic C++ and is not pipe specific."}, {"owner": {"reputation": 73, "user_id": 7362822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b1014cd5833d6deae59021d6b1dc3b?s=128&d=identicon&r=PG&f=1", "display_name": "Mayank", "link": "https://stackoverflow.com/users/7362822/mayank"}, "edited": false, "score": 0, "creation_date": 1530773744, "post_id": 51171563, "comment_id": 89351849, "body": "I&#39;m new to programming word so can you provide any sample program that is passing struct over pipes or some links that I can refer to? @Anders"}, {"owner": {"reputation": 592, "user_id": 9953712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zXEAZ.jpg?s=128&g=1", "display_name": "ImmortaleVBR", "link": "https://stackoverflow.com/users/9953712/immortalevbr"}, "reply_to_user": {"reputation": 73, "user_id": 7362822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b1014cd5833d6deae59021d6b1dc3b?s=128&d=identicon&r=PG&f=1", "display_name": "Mayank", "link": "https://stackoverflow.com/users/7362822/mayank"}, "edited": false, "score": 1, "creation_date": 1530819618, "post_id": 51171563, "comment_id": 89379230, "body": "@Mayank If you can&#39;t do it even now after being told how by Anders (who explained it in the most simple way possible for you to understand), you may as well focus on more practice with programming and come back to it later on when you have more XP under your belt, otherwise you&#39;ll end up spending loads of time only to get an buggy implementation which will fail on you sooner or later. Alternatively, look for open-source libraries which offer IPC support via a few helper routines you can just call and be done with it (there&#39;s many around on places like GitHub, just do a search for it)."}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": false, "score": 2, "last_activity_date": 1530700309, "creation_date": 1530700309, "answer_id": 51171563, "question_id": 51170607, "link": "https://stackoverflow.com/questions/51170607/passing-struct-data-type-to-named-pipes-in-c/51171563#51171563", "title": "Passing struct data type to named pipes in C++", "body": "<p>You cannot pass instances of a class across the wire.</p>\n\n<p>You basically have two options.</p>\n\n<p>A) Use fixed size buffers:</p>\n\n<pre><code>struct mydata {\n  char message[200];\n  char name[50];\n  int time;\n};\n</code></pre>\n\n<p>and just send <code>sizeof(mydata)</code> across the pipe.</p>\n\n<p>B) Marshal the data in a different format:</p>\n\n<pre><code>struct mywiredata {\n  int messageoffset;\n  int nameoffset;\n  int time;\n  char buffer[ANYSIZE_ARRAY]; //blogs.msdn.microsoft.com/oldnewthing/20040826-00/?p=38043\n};\n</code></pre>\n\n<p>Here you basically have a fixed header portion with all the strings stored as bytes at the end. You find the start of a string by accessing the buffer at the appropriate offset. You need marshalling code at each end of the pipe to convert to/from your <code>EventLogEntry</code> and <code>mywiredata</code> structs.</p>\n"}], "owner": {"reputation": 73, "user_id": 7362822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b1014cd5833d6deae59021d6b1dc3b?s=128&d=identicon&r=PG&f=1", "display_name": "Mayank", "link": "https://stackoverflow.com/users/7362822/mayank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1033, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530700309, "creation_date": 1530697298, "question_id": 51170607, "link": "https://stackoverflow.com/questions/51170607/passing-struct-data-type-to-named-pipes-in-c", "title": "Passing struct data type to named pipes in C++", "body": "<p>I found one sample program that passes string from client to server in named pipes. How can I pass a struct data type through named pipes in c++?</p>\n\n<p>WriteFile function of client looks like this:</p>\n\n<pre><code>WriteFile(hPipe,TEXT(\"Hello Pipe\\n\"),12,&amp;dwWritten,NULL);\n</code></pre>\n\n<p>ReadFile function of server looks like this:</p>\n\n<pre><code>while (ReadFile(hPipe, buffer, sizeof(buffer)-1, &amp;dwRead, NULL))\n</code></pre>\n\n<p>The structure I need to pass looks like this:</p>\n\n<pre><code>struct EventLogEntry \n   {\n       string date;\n       string time;\n       string subsystem;\n       unsigned long eventType;\n       string majorFunction;\n       string messageText;\n       unsigned long timeStamp; //Added for TimeZone Corrections\n   };\n</code></pre>\n\n<p>In <code>CreateNamedPipe()</code> I'm using <code>PIPE_TYPE_BYTE</code> <code>PIPE_READMODE_BYTE</code> pipe mode.  Do I need to change them to <code>PIPE_TYPE_BYTE</code> and <code>PIPE_READMODE_MESSAGE</code>?</p>\n"}]